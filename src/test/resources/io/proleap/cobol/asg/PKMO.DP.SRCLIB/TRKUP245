000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.   TRKUP245.                                                  
000600 AUTHOR.       MICHAEL MACHNIK.                                           
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                                   
000800 DATE-WRITTEN. JAN 1999.                                                  
000900 DATE-COMPILED.                                                           
001000******************************************************************        
001100******************************************************************        
001000*  CHANGE LOG:                                                   *        
001000*                                                                *        
001200*  11/05/2003 TKMA643 - VISWA KARUTURI                           *        
001300*     REMOVED LOGIC THAT PERTAINS TO COLUMNS FRGT_CHRG_AMT AND   *        
001400*     CONSLR_CHRG_AMT AND ADDED DOC_RCVD_ORGN_TMST.              *        
001000*  09/26/2022 JEAN KURK             CHG0274607                   *        
001000*     RECOMPILE FOR UPGRADE                                      *        
001001******************************************************************        
001600 ENVIRONMENT DIVISION.                                                    
001700******************************************************************        
001800                                                                          
001900 CONFIGURATION SECTION.                                                   
002000                                                                          
002100 SOURCE-COMPUTER.        IBM-3090.                                        
002200 OBJECT-COMPUTER.        IBM-3090.                                        
002300                                                                          
002400 INPUT-OUTPUT SECTION.                                                    
002500                                                                          
002600 FILE-CONTROL.                                                            
002700                                                                          
002800     SELECT TR027-CUSTOMS-FILE                                            
002900         ASSIGN TO INP01.                                                 
003000                                                                          
003100******************************************************************        
003200 DATA DIVISION.                                                           
003300******************************************************************        
003400                                                                          
003500 FILE SECTION.                                                            
003600                                                                          
003700 FD  TR027-CUSTOMS-FILE                                                   
003800     RECORDING MODE IS F                                                  
003900     LABEL RECORDS ARE STANDARD                                           
004000     BLOCK CONTAINS 0 RECORDS.                                            
004100                                                                          
004200 01  TR027-CUSTOMS-RECORD        PIC X(300).                              
004300                                                                          
004400******************************************************************        
004500 WORKING-STORAGE SECTION.                                                 
004600******************************************************************        
004700                                                                          
004800******************************************************************        
004900*  DB2 FORMATTED MESSAGE AREA                                             
005000******************************************************************        
005100     COPY DPWS004.                                                        
005200                                                                          
005300******************************************************************        
005400*  COMMUNICATIONS AREA FOR DB2                                            
005500******************************************************************        
005600     EXEC SQL                                                             
005700          INCLUDE SQLCA                                                   
005800     END-EXEC.                                                            
005900                                                                          
006000******************************************************************        
006100*  DB2 TABLE DECLARATION -                                                
006200*      (TIMCSEN)                                                          
006300******************************************************************        
006400     EXEC SQL                                                             
006500          INCLUDE TIMCSEN                                                 
006600     END-EXEC.                                                            
006700                                                                          
006800******************************************************************        
006900*  DB2 TABLE DECLARATION -                                                
007000*      (TPLNSHP)                                                          
007100******************************************************************        
007200     EXEC SQL                                                             
007300          INCLUDE TPLNSHP                                                 
007400     END-EXEC.                                                            
007500                                                                          
007600******************************************************************        
007700*  DB2 TABLE DECLARATION -                                                
007800*      (TEXTENT)                                                          
007900******************************************************************        
008000     EXEC SQL                                                             
008100          INCLUDE TEXTENT                                                 
008200     END-EXEC.                                                            
008300                                                                          
008400******************************************************************        
008500*  DB2 TABLE DECLARATION -                                                
008600*      (TIMFOB)                                                           
008700******************************************************************        
008800     EXEC SQL                                                             
008900          INCLUDE TIMFOB                                                  
009000     END-EXEC.                                                            
009100                                                                          
009200******************************************************************        
009300*  DB2 TABLE DECLARATION -                                                
009400*      (TIMCSBL)                                                          
009500******************************************************************        
009600     EXEC SQL                                                             
009700          INCLUDE TIMCSBL                                                 
009800     END-EXEC.                                                            
009900                                                                          
010000******************************************************************        
010100*  DB2 TABLE DECLARATION -                                                
010200*      (TIMCSCN)                                                          
010300******************************************************************        
010400     EXEC SQL                                                             
010500          INCLUDE TIMCSCN                                                 
010600     END-EXEC.                                                            
010700                                                                          
010800******************************************************************        
010900*  DB2 TABLE DECLARATION -                                                
011000*      (TIMCSPO)                                                          
011100******************************************************************        
011200     EXEC SQL                                                             
011300          INCLUDE TIMCSPO                                                 
011400     END-EXEC.                                                            
011500                                                                          
011600******************************************************************        
011700*  DB2 TABLE DECLARATION -                                                
011800*      (TIMCNPO) IMPORTS CONTAINER PO TABLE                               
011900******************************************************************        
012000     EXEC SQL                                                             
012100          INCLUDE TIMCNPO                                                 
012200     END-EXEC.                                                            
012300                                                                          
012400******************************************************************        
012500*  DB2 TABLE DECLARATION -                                                
012600*      (TIMCNTK) IMPORTS CONTAINER TRACKING TABLE                         
012700******************************************************************        
012800     EXEC SQL                                                             
012900          INCLUDE TIMCNTK                                                 
013000     END-EXEC.                                                            
013100                                                                          
013101******************************************************************        
013102*  DB2 TABLE DECLARATION -                                                
013103*      (TIMRCPO) IMPORTS RECEIVING PO TABLE                               
013104******************************************************************        
013105     EXEC SQL                                                             
013106          INCLUDE TIMRCPO                                                 
013107     END-EXEC.                                                            
013108                                                                          
013109******************************************************************        
013110*  DB2 TABLE DECLARATION -                                                
013111*      (TIMBKPO) IMPORTS BOOKING PO TABLE                                 
013112******************************************************************        
013113     EXEC SQL                                                             
013114          INCLUDE TIMBKPO                                                 
013115     END-EXEC.                                                            
013116                                                                          
013200******************************************************************        
013300*  DB2 TABLE DECLARATION -                                                
013400*      (TAUCNPO) IMPORTS AUDIT CONTAINER PO TABLE                         
013500******************************************************************        
013600     EXEC SQL                                                             
013700          INCLUDE TAUCNPO                                                 
013800     END-EXEC.                                                            
013900                                                                          
014000******************************************************************        
014100*  DB2 TABLE DECLARATION -                                                
014200*      (TAUCSEN)                                                          
014300******************************************************************        
014400     EXEC SQL                                                             
014500          INCLUDE TAUCSEN                                                 
014600     END-EXEC.                                                            
014700                                                                          
014800******************************************************************        
014900*  DB2 TABLE DECLARATION -                                                
015000*      (TAUCSBL)                                                          
015100******************************************************************        
015200     EXEC SQL                                                             
015300          INCLUDE TAUCSBL                                                 
015400     END-EXEC.                                                            
015500                                                                          
015600******************************************************************        
015700*  DB2 TABLE DECLARATION -                                                
015800*      (TAUCSCN)                                                          
015900******************************************************************        
016000     EXEC SQL                                                             
016100          INCLUDE TAUCSCN                                                 
016200     END-EXEC.                                                            
016300                                                                          
016400******************************************************************        
016500*  DB2 TABLE DECLARATION -                                                
016600*      (TAUCSPO)                                                          
016700******************************************************************        
016800     EXEC SQL                                                             
016900          INCLUDE TAUCSPO                                                 
017000     END-EXEC.                                                            
017100                                                                          
017200******************************************************************        
017300*  DB2 TABLE DECLARATION -                                                
017400*      (TPURCHS)                                                          
017500******************************************************************        
017600     EXEC SQL                                                             
017700          INCLUDE TPURCHS                                                 
017800     END-EXEC.                                                            
017900                                                                          
018000******************************************************************        
018100*  DB2 TABLE DECLARATION - DETAIL AND ERROR REPORT WORK TABLE.            
018200*      (TOUTTRA)                                                          
018300******************************************************************        
018400     EXEC SQL                                                             
018500          INCLUDE TOUTTRA                                                 
018600     END-EXEC.                                                            
018700                                                                          
018800******************************************************************        
018900*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)        
019000*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT             
019100*  INTERVALS.                                                             
019200******************************************************************        
019300     EXEC SQL                                                             
019400         INCLUDE TCKRSTCN                                                 
019500     END-EXEC.                                                            
019600                                                                          
019700******************************************************************        
019800*  DB2 TABLE DECLARATION - CHECKPOINT RESTART         (TCKRSTINF)         
019900*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT             
020000*  INTERVALS.                                                             
020100******************************************************************        
020200     EXEC SQL                                                             
020300         INCLUDE TCKRSTIN                                                 
020400     END-EXEC.                                                            
020500                                                                          
020600******************************************************************        
020700*   EDITED IMPORT CUSTOMS DATA RECORD LAYOUT.                             
020800******************************************************************        
020900     COPY TRRD027.                                                        
021000 EJECT                                                                    
021100                                                                          
021200******************************************************************        
021300*  CUSTOMS DATA DETAIL/ERROR REPORT RECORD.                      *        
021400*  USED TO FORMAT THE DETAIL/ERROR REPORT RECORDS.  LATER THIS   *        
021500*  TABLE IS DUMPED TO A FLAT FILE AND SORTED WITH THE DETAIL/    *        
021600*  ERROR FILE FROM THE EDIT PROGRAM.  THE SORTED FILE IS USED AS *        
021700*  INPUT TO THE ERROR AND DETAIL REPORT PROGRAMS WHICH CREATE AN *        
021800*  ERROR AND A DETAIL REPORT OF CUSTOMS DATA.                    *        
021900******************************************************************        
022000     COPY TRRD241.                                                        
022100 EJECT                                                                    
022200*****************************************************************         
022300*    SUPPLY CHAIN MANAGEMENT (SCM) MQ MESSAGE RECORD                      
022400*****************************************************************         
022500     COPY TRRD405.                                                        
022600 EJECT                                                                    
022700                                                                          
022800******************************************************************        
022900*  DB2 TABLE DECLARATION - SCM MQ SERIES MSG WORK TABLE                   
023000*      (TRTW_CSTM_CKPR)                                                   
023100******************************************************************        
023200     EXEC SQL                                                             
023300          INCLUDE TRT00040                                                
023400     END-EXEC.                                                            
023500 EJECT                                                                    
023600                                                                          
023700 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
023800                                                   COMP SYNC.             
023900 01  PA-PROGRAM-ACCUMULATORS.                                             
024000     05  PA-TOTALS.                                                       
024100                                                                          
024200         10 PA-TOTAL-COMMITS          PIC  S9(13)  VALUE +0               
024300                                                     COMP-3.              
024400         10 PA-TOTAL-RECS-READ       PIC S9(13)   VALUE +0                
024500                                                     COMP-3.              
024600         10 PA-TOTAL-ISA-RECS-READ    PIC  S9(13)  VALUE +0               
024700                                                     COMP-3.              
024800         10 PA-TOT-ENF-RECS-READ      PIC  S9(13)  VALUE +0               
024900                                                     COMP-3.              
025000         10 PA-TOT-EXD-RECS-READ      PIC  S9(13)  VALUE +0               
025100                                                     COMP-3.              
025200         10 PA-TOT-REJ-RECS-READ      PIC  S9(13)  VALUE +0               
025300                                                     COMP-3.              
025400         10 PA-TOT-ECR-RECS-READ      PIC  S9(13)  VALUE +0               
025500                                                     COMP-3.              
025600         10 PA-TOT-RLS-RECS-READ      PIC  S9(13)  VALUE +0               
025700                                                     COMP-3.              
025800         10 PA-TOT-LIQ-RECS-READ      PIC  S9(13)  VALUE +0               
025900                                                     COMP-3.              
026000         10 PA-TOT-LSU-RECS-READ      PIC  S9(13)  VALUE +0               
026100                                                     COMP-3.              
026200         10 PA-TOT-ENFBOL-RECS-READ   PIC  S9(13)  VALUE +0               
026300                                                     COMP-3.              
026400         10 PA-TOT-ENFCON-RECS-READ   PIC  S9(13)  VALUE +0               
026500                                                     COMP-3.              
026600         10 PA-TOT-DOP-RECS-READ      PIC  S9(13)  VALUE +0               
026700                                                     COMP-3.              
026800         10 PA-TOT-ENFPO-RECS-READ    PIC  S9(13)  VALUE +0               
026900                                                     COMP-3.              
027000         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0               
027100                                                     COMP-3.              
027200         10 PA-TOTAL-WARN-COUNT       PIC  S9(13)  VALUE +0               
027300                                                     COMP-3.              
027400         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0               
027500                                                     COMP-3.              
027600         10 PA-TOT-TRN-TYP-A          PIC  S9(13)  VALUE +0               
027700                                                     COMP-3.              
027800         10 PA-TOT-TRN-TYP-C          PIC  S9(13)  VALUE +0               
027900                                                     COMP-3.              
028000         10 PA-TOT-TRN-TYP-D          PIC  S9(13)  VALUE +0               
028100                                                     COMP-3.              
028200         10 PA-TOT-TOUTTRA-INSERTS    PIC  S9(13)  VALUE +0               
028300                                                     COMP-3.              
028400         10 PA-TOT-AUCSEN-INSERTS    PIC  S9(13)  VALUE +0                
028500                                                     COMP-3.              
028600         10 PA-TOT-AUCSBL-INSERTS    PIC  S9(13)  VALUE +0                
028700                                                     COMP-3.              
028800         10 PA-TOT-AUCSCN-INSERTS    PIC  S9(13)  VALUE +0                
028900                                                     COMP-3.              
029000         10 PA-TOT-AUCSPO-INSERTS    PIC  S9(13)  VALUE +0                
029100                                                     COMP-3.              
029200         10 PA-TOT-AUCNPO-INSERTS    PIC  S9(13)  VALUE +0                
029300                                                     COMP-3.              
029400         10 PA-TOT-IMCSBL-INSERTS    PIC  S9(13)  VALUE +0                
029500                                                     COMP-3.              
029600         10 PA-TOT-IMCSCN-INSERTS    PIC  S9(13)  VALUE +0                
029700                                                     COMP-3.              
029800         10 PA-TOT-IMCSPO-INSERTS    PIC  S9(13)  VALUE +0                
029900                                                     COMP-3.              
030000         10 PA-TOT-IMCNPO-INSERTS    PIC  S9(13)  VALUE +0                
030100                                                     COMP-3.              
030200         10 PA-TOT-IMCNPO-UPDATES    PIC  S9(13)  VALUE +0                
030300                                                     COMP-3.              
030400                                                                          
030500 01  PS-PROGRAM-SWITCHES.                                                 
030600     05  PS-UPDATE-AUDIT-SW            PIC  X(01)    VALUE 'N'.           
030700         88  PS-NEED-TO-UPDATE-AUDIT                 VALUE 'Y'.           
030800         88  PS-NO-NEED-TO-UPDATE-AUDIT              VALUE 'N'.           
030900     05  PS-EOC-HBOL-SW                PIC  X(01)    VALUE 'N'.           
031000         88  PS-EOC-HBOL-CURSOR                      VALUE 'Y'.           
031100         88  PS-EOC-HBOL-CURSOR-NO                   VALUE 'N'.           
031200     05  PS-EOC-SW                     PIC  X(01)    VALUE 'N'.           
031300         88  PS-CURSOR-IS-OPEN                       VALUE 'Y'.           
031400         88  PS-CURSOR-IS-NOT-OPEN                   VALUE 'N'.           
031500     05  PS-RECORD-SW                  PIC  X(01)    VALUE 'N'.           
031600         88  PS-OK-RECORD                            VALUE 'Y'.           
031700         88  PS-BAD-RECORD                           VALUE 'N'.           
031800     05  PS-EOC-MBOL-SW                PIC  X(01)    VALUE 'N'.           
031900         88  PS-EOC-MBOL-CURSOR                      VALUE 'Y'.           
032000         88  PS-EOC-MBOL-CURSOR-NO                   VALUE 'N'.           
032100     05  PS-END-OF-INPUT-SW            PIC  X(01)    VALUE 'N'.           
032200         88  PS-END-OF-INPUT                         VALUE 'Y'.           
032300         88  PS-END-OF-INPUT-NO                      VALUE 'N'.           
032400     05  PS-KEY-BREAK-SW               PIC  X(01)    VALUE 'N'.           
032500         88  PS-KEY-BREAK                            VALUE 'Y'.           
032600         88  PS-NO-KEY-BREAK                         VALUE 'N'.           
032700     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.           
032800         88  NORMAL-RUN                              VALUE '0'.           
032900         88  RESTART-RUN                             VALUE '9'.           
033000     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.           
033100         88  COMMITS-TAKEN                           VALUE 'T'.           
033200         88  NO-COMMITS-TAKEN                        VALUE 'N'.           
033300     05  PS-SAME-COMMIT-FIELDS-SW      PIC  X(01)    VALUE 'N'.           
033400         88  PS-SAME-COMMIT-FIELDS                   VALUE 'Y'.           
033500         88  PS-NOT-SAME-COMMIT-FIELDS               VALUE 'N'.           
033600     05  PS-MBOL-FOUND-SW              PIC  X(01)    VALUE 'N'.           
033700         88  PS-MBOL-FOUND                           VALUE 'Y'.           
033800         88  PS-MBOL-NOT-FOUND                       VALUE 'N'.           
033900     05  PS-GOOD-RECORD-SW             PIC X(01)     VALUE 'N'.           
034000         88  PS-GOOD-RECORD                          VALUE 'Y'.           
034100         88  PS-GOOD-RECORD-NO                       VALUE 'N'.           
034200     05  PS-TIMCSEN-AVAIL-SW           PIC X(01)     VALUE 'N'.           
034300         88  PS-TIMCSEN-AVAIL                        VALUE 'Y'.           
034400         88  PS-TIMCSEN-NOT-AVAIL                    VALUE 'N'.           
034500     05  PS-TIMCSBL-AVAIL-SW           PIC X(01)     VALUE 'N'.           
034600         88  PS-TIMCSBL-AVAIL                        VALUE 'Y'.           
034700         88  PS-TIMCSBL-NOT-AVAIL                    VALUE 'N'.           
034800     05  PS-TIMCSCN-AVAIL-SW           PIC X(01)     VALUE 'N'.           
034900         88  PS-TIMCSCN-AVAIL                        VALUE 'Y'.           
035000         88  PS-TIMCSCN-NOT-AVAIL                    VALUE 'N'.           
035100     05  PS-TIMCSPO-AVAIL-SW           PIC X(01)     VALUE 'N'.           
035200         88  PS-TIMCSPO-AVAIL                        VALUE 'Y'.           
035300         88  PS-TIMCSPO-NOT-AVAIL                    VALUE 'N'.           
035400     05  PS-PO-AVAIL-SW                PIC X(01)     VALUE 'N'.           
035500         88  PS-PO-AVAIL                             VALUE 'Y'.           
035600         88  PS-PO-NOT-AVAIL                         VALUE 'N'.           
035700         88  PS-PO-NOT-FOUND                         VALUE 'X'.           
035800     05  PS-INSERT-TIMCSEN-SW          PIC X(01)     VALUE 'N'.           
035900         88  PS-INSERT-TIMCSEN                       VALUE 'Y'.           
036000         88  PS-DONT-INSERT-TIMCSEN                  VALUE 'N'.           
036100     05  PS-DELETE-TIMCSEN-SW          PIC X(01)     VALUE 'N'.           
036200         88  PS-DELETE-TIMCSEN                       VALUE 'Y'.           
036300         88  PS-DONT-DELETE-TIMCSEN                  VALUE 'N'.           
036400     05  PS-UPDATE-TIMCSEN-SW          PIC X(01)     VALUE 'N'.           
036500         88  PS-UPDATE-TIMCSEN                       VALUE 'Y'.           
036600         88  PS-DONT-UPDATE-TIMCSEN                  VALUE 'N'.           
036700     05  PS-INSERT-TIMCSBL-SW          PIC X(01)     VALUE 'N'.           
036800         88  PS-INSERT-TIMCSBL                       VALUE 'Y'.           
036900         88  PS-DONT-INSERT-TIMCSBL                  VALUE 'N'.           
037000     05  PS-DELETE-TIMCSBL-SW          PIC X(01)     VALUE 'N'.           
037100         88  PS-DELETE-TIMCSBL                       VALUE 'Y'.           
037200         88  PS-DONT-DELETE-TIMCSBL                  VALUE 'N'.           
037300     05  PS-UPDATE-TIMCSBL-SW          PIC X(01)     VALUE 'N'.           
037400         88  PS-UPDATE-TIMCSBL                       VALUE 'Y'.           
037500         88  PS-DONT-UPDATE-TIMCSBL                  VALUE 'N'.           
037600     05  PS-INSERT-TIMCSCN-SW          PIC X(01)     VALUE 'N'.           
037700         88  PS-INSERT-TIMCSCN                       VALUE 'Y'.           
037800         88  PS-DONT-INSERT-TIMCSCN                  VALUE 'N'.           
037900     05  PS-DELETE-TIMCSCN-SW          PIC X(01)     VALUE 'N'.           
038000         88  PS-DELETE-TIMCSCN                       VALUE 'Y'.           
038100         88  PS-DONT-DELETE-TIMCSCN                  VALUE 'N'.           
038200     05  PS-UPDATE-TIMCSCN-SW          PIC X(01)     VALUE 'N'.           
038300         88  PS-UPDATE-TIMCSCN                       VALUE 'Y'.           
038400         88  PS-DONT-UPDATE-TIMCSCN                  VALUE 'N'.           
038500     05  PS-INSERT-TIMCSPO-SW          PIC X(01)     VALUE 'N'.           
038600         88  PS-INSERT-TIMCSPO                       VALUE 'Y'.           
038700         88  PS-DONT-INSERT-TIMCSPO                  VALUE 'N'.           
038800     05  PS-DELETE-TIMCSPO-SW          PIC X(01)     VALUE 'N'.           
038900         88  PS-DELETE-TIMCSPO                       VALUE 'Y'.           
039000         88  PS-DONT-DELETE-TIMCSPO                  VALUE 'N'.           
039100     05  PS-UPDATE-TIMCSPO-SW          PIC X(01)     VALUE 'N'.           
039200         88  PS-UPDATE-TIMCSPO                       VALUE 'Y'.           
039300         88  PS-DONT-UPDATE-TIMCSPO                  VALUE 'N'.           
039400     05  PS-GONE-SW                    PIC X(01)     VALUE 'N'.           
039500         88  PS-EVERYTHING-GONE                      VALUE 'Y'.           
039600         88  PS-EVERYTHING-NOT-GONE                  VALUE 'N'.           
039700     05  PS-TIMCSEN-TRIP-TYP-FOUND-SW   PIC X(01)    VALUE 'N'.           
039800         88  PS-TIMCSEN-TRIP-TYP-FOUND               VALUE 'Y'.           
039900         88  PS-TIMCSEN-TRIP-TYP-FOUND-NO            VALUE 'N'.           
040000     05  PS-EOC-TIMCNPO-D-CN-CSR-SW     PIC X(01)    VALUE 'N'.           
040100         88  PS-EOC-TIMCNPO-D-CN-CSR                 VALUE 'Y'.           
040200         88  PS-EOC-TIMCNPO-D-CN-CSR-NO              VALUE 'N'.           
040300     05  PS-EOC-TIMCNPO-D-PO-CSR-SW     PIC X(01)    VALUE 'N'.           
040400         88  PS-EOC-TIMCNPO-D-PO-CSR                 VALUE 'Y'.           
040500         88  PS-EOC-TIMCNPO-D-PO-CSR-NO              VALUE 'N'.           
040600     05  PS-EOC-TIMCNPO-CSR-SW          PIC X(01)    VALUE 'N'.           
040700         88  PS-EOC-TIMCNPO-CSR                      VALUE 'Y'.           
040800         88  PS-EOC-TIMCNPO-CSR-NO                   VALUE 'N'.           
040900     05  PS-TIMCNPO-ROWS-EXIST-SW       PIC X(01)    VALUE 'N'.           
041000         88  PS-TIMCNPO-ROWS-EXIST                   VALUE 'Y'.           
041100         88  PS-TIMCNPO-ROWS-EXIST-NO                VALUE 'N'.           
041200     05  PS-EOC-MLTPL-ENTRY-SW          PIC X(01)    VALUE 'N'.           
041300         88  PS-EOC-MLTPL-ENTRY                      VALUE 'Y'.           
041400         88  PS-EOC-MLTPL-ENTRY-NO                   VALUE 'N'.           
041500     05  PS-CSPO-OR-CSCN-INSERTED-SW   PIC  X(01)    VALUE 'N'.           
041600         88  PS-CSPO-OR-CSCN-INSERTED                VALUE 'Y'.           
041700         88  PS-CSPO-OR-CSCN-INSERTED-NO             VALUE 'N'.           
041800     05  PS-ENTR-ID-FOR-CN-DEL-FOUND-SW PIC X(01)    VALUE 'N'.           
041900         88  PS-ENTR-ID-FOR-CN-DEL-FOUND             VALUE 'Y'.           
042000         88  PS-ENTR-ID-FOR-CN-DEL-FOUND-NO          VALUE 'N'.           
042100     05  PS-ENTR-ID-FOR-PO-DEL-FOUND-SW PIC X(01)    VALUE 'N'.           
042200         88  PS-ENTR-ID-FOR-PO-DEL-FOUND             VALUE 'Y'.           
042300         88  PS-ENTR-ID-FOR-PO-DEL-FOUND-NO          VALUE 'N'.           
042400     05  PS-GOOD-ENF-ADD-SW            PIC  X(01)    VALUE 'N'.           
042500         88  PS-GOOD-ENF-ADD                         VALUE 'Y'.           
042600         88  PS-GOOD-ENF-ADD-NO                      VALUE 'N'.           
042700     05  PS-GOOD-ENF-CHANGE-SW         PIC  X(01)    VALUE 'N'.           
042800         88  PS-GOOD-ENF-CHANGE                      VALUE 'Y'.           
042900         88  PS-GOOD-ENF-CHANGE-NO                   VALUE 'N'.           
043000     05  PS-TRIP-TYPE                  PIC  X(01)    VALUE ' '.           
043100         88  PS-TRIP-TYPE-AIR                        VALUE 'A'.           
043200         88  PS-TRIP-TYPE-BLANK                      VALUE ' '.           
043300     05  PS-PO-FOUND-SW                PIC  X(01)    VALUE 'N'.           
043400         88  PS-PO-FOUND                             VALUE 'Y'.           
043500         88  PS-PO-NOTFND                            VALUE 'N'.           
043600     05  PS-SCM-END-OF-CSCN-SW         PIC  X(01)    VALUE 'N'.           
043700         88  PS-SCM-END-OF-CSCN                      VALUE 'Y'.           
043800         88  PS-SCM-END-OF-CSCN-NO                   VALUE 'N'.           
043900     05  PS-SCM-END-OF-CSPO-SW         PIC  X(01)    VALUE 'N'.           
044000         88  PS-SCM-END-OF-CSPO                      VALUE 'Y'.           
044100         88  PS-SCM-END-OF-CSPO-NO                   VALUE 'N'.           
044200     05  PS-SCM-CSPO-FOUND-SW          PIC  X(01)    VALUE 'N'.           
044300         88  PS-SCM-CSPO-FOUND                       VALUE 'Y'.           
044400         88  PS-SCM-CSPO-FOUND-NO                    VALUE 'N'.           
044500                                                                          
044600 01  PC-PROGRAM-CONSTANTS.                                                
044700     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE                  
044800         'TRKUP245'.                                                      
044900     05  PC-10                       PIC X(02)     VALUE '10'.            
045000     05  PC-20                       PIC X(02)     VALUE '20'.            
045100     05  PC-30                       PIC X(02)     VALUE '30'.            
045200     05  PC-40                       PIC X(02)     VALUE '40'.            
045300     05  PC-A                        PIC X(01)     VALUE 'A'.             
045400     05  PC-C                        PIC X(01)     VALUE 'C'.             
045500     05  PC-D                        PIC X(01)     VALUE 'D'.             
045600     05  PC-E                        PIC X(01)     VALUE 'E'.             
045700     05  PC-O                        PIC X(01)     VALUE 'O'.             
045800     05  PC-U                        PIC X(01)     VALUE 'U'.             
045900     05  PC-DOP                      PIC X(06)     VALUE 'DOP   '.        
046000     05  PC-DPU                      PIC X(06)     VALUE 'DPU   '.        
046100     05  PC-FRL                      PIC X(06)     VALUE 'FRL   '.        
046200     05  PC-DLV                      PIC X(06)     VALUE 'DLV   '.        
046300     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.           
046400     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.           
046500     05  PC-DASH                     PIC X(01)     VALUE '-'.             
046600     05  PC-DECIMAL                  PIC X(01)     VALUE '.'.             
046700     05  PC-DEFAULT-SECONDS          PIC X(10)     VALUE                  
046800                                     '.00.000000'.                        
046900     05  PC-DEFAULT-TMST             PIC X(26)     VALUE                  
047000                                     '0001-01-01-00.00.00.000000'.        
047100     05  PC-DEFAULT-DTE              PIC X(10)     VALUE                  
047200                                     '0001-01-01'.                        
047300     05  PC-DEFAULT-DTE-NO-DASHES    PIC X(08)     VALUE                  
047400                                     '00010101'.                          
047500     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5               
047600                                                     COMP-3.              
047700     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.             
047800     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.             
047900                                                                          
048000     05  PC-FOB-SCAC-MSG.                                                 
048100         10  PC-FIL1        PIC X(12)  VALUE 'KOHLS FOB= '.               
048200         10  PC-FOB         PIC X(03)  VALUE SPACE.                       
048300         10  PC-FIL2        PIC X(03)  VALUE SPACE.                       
048400         10  PC-FIL3        PIC X(13)  VALUE 'CONSOL SCAC= '.             
048500         10  PC-SCAC        PIC X(04)  VALUE SPACE.                       
048600         10  PC-FIL4        PIC X(02)  VALUE SPACE.                       
048700         10  PC-FIL5        PIC X(04)  VALUE 'PO= '.                      
048800         10  PC-PO          PIC X(09)  VALUE SPACE.                       
048900                                                                          
049000 01  PC-PROGRAM-VARIABLES.                                                
049100     05  PV-CURRENT-TMST             PIC X(26)  VALUE SPACES.             
049200                                                                          
049300     05  PV-CLR-CONTNR-ID            PIC X(12)  VALUE SPACES.             
049400     05  PV-CLR-CONTNR-SEQ-NBR       PIC S9(4)  COMP VALUE 0.             
049500     05  PV-CLR-ORGN-SHPD-FR-CDE     PIC X(3)   VALUE SPACES.             
049600     05  PV-CLR-EXTL-REF-NBR         PIC X(15)  VALUE SPACES.             
049700     05  PV-CLR-PO-NBR-COMP          PIC S9(9) COMP.                      
049800                                                                          
049900 01  PV-LAST-TRAN.                                                        
050000     05  PV-HOLD-ENTRY-ID            PIC X(12)  VALUE SPACES.             
050100     05  PV-HOLD-ENT-ID              PIC S9(09) VALUE 0 COMP.             
050200     05  PV-HOLD-MBOL                PIC X(30)  VALUE SPACES.             
050300     05  PV-HOLD-HBOL                PIC X(30)  VALUE SPACES.             
050400     05  PV-HOLD-CONTAINER           PIC X(12)  VALUE SPACES.             
050500     05  PV-HOLD-PO                  PIC S9(09) VALUE 0 COMP.             
050600     05  PV-HOLD-EXTL-REF-NBR        PIC X(15)  VALUE SPACES.             
050700     05  PV-HOLD-ENF-FILD-DTE        PIC X(8)   VALUE SPACES.             
050800                                                                          
050900 01  WORK-FIELDS.                                                         
051000     05  W-IMCSCN-CONTNR-ID          PIC X(12)  VALUE SPACES.             
051100     05  W-IMCNPO-CONTNR-SEQ-NBR     PIC S9(4)  COMP VALUE 0.             
051200     05  W-IMCNTK-ORGN-SHPD-FR-CDE   PIC X(3)   VALUE SPACES.             
051300     05  W-TR027-ENFPO-PO-NBR.                                            
051400         10  W-TR027-ENFPO-PO-NBR-9  PIC S9(9)       VALUE 0.             
051500     05  W-TR027-ENFPO-PO-NBR-COMP   PIC S9(9) COMP.                      
051600     05  W-LOOK-UP-CONTNR-ID         PIC X(12)  VALUE SPACES.             
051700                                                                          
051800 01  PV-LAST-TRAN.                                                        
051900     05  PV-LAST-TRAN-ENF                PIC X(01)  VALUE SPACES.         
052000     05  PV-LAST-TRAN-ENFBOL             PIC X(01)  VALUE SPACES.         
052100     05  PV-LAST-TRAN-ENFCON             PIC X(01)  VALUE SPACES.         
052200     05  PV-LAST-TRAN-DOP                PIC X(01)  VALUE SPACES.         
052300     05  PV-LAST-TRAN-ENFPO              PIC X(01)  VALUE SPACES.         
052400     05  PV-LAST-MBOL                    PIC X(30)  VALUE SPACES.         
052500     05  PV-LAST-HBOL                    PIC X(30)  VALUE SPACES.         
052600     05  PV-LAST-CONTAINER               PIC X(12)  VALUE SPACES.         
052700     05  PV-LAST-PO                      PIC 9(09)  VALUE 0.              
052800     05  PV-LAST-EXTL-REF-NBR            PIC X(15)  VALUE SPACES.         
052900     05  PV-HOLD-ENTRY-TYP-FROM-ENF      PIC X(02)  VALUE SPACES.         
053000                                                                          
053100 01  PV-PROGRAM-VARIABLES.                                                
053200     05  PV-PO-NBR                   PIC S9(09) VALUE 0 COMP.             
053300     05  PV-FOB-CDE                  PIC X(03)     VALUE SPACES.          
053400     05  PV-SCAC-CDE                 PIC X(04)     VALUE SPACES.          
053500                                                                          
053600     05  PV-EDI-RECORDS              PIC  X(03).                          
053700         88  EDI-RECORD                            VALUE 'CTT',           
053800                                                         'IEA',           
053900                                                         'ISA'.           
054000     05  PV-TMST                     PIC X(26)     VALUE SPACES.          
054100     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.          
054200     05  PV-HOLD-ENTR-ID-FOR-CNPO-UPD  PIC X(12)   VALUE SPACES.          
054300     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.          
054400     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0               
054500                                                    COMP SYNC.            
054600                                                                          
054700     05  PV-FORMAT-TMST.                                                  
054800         10  PV-FORMAT-TMST-DTE.                                          
054900             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.          
055000             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.             
055100             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.          
055200             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.             
055300             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.          
055400             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.             
055500         10  PV-FORMAT-TMST-TM.                                           
055600             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.          
055700             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.             
055800             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.          
055900             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE                  
056000                                                     '.00.000000'.        
056100     05  PV-REFORMAT-TMST.                                                
056200         10  PV-REFORMAT-TMST-DTE.                                        
056300             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.        
056400             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.        
056500             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.        
056600         10  PV-REFORMAT-TMST-TM.                                         
056700             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.        
056800             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.        
056900                                                                          
057000     05  PV-REFORMAT-TO-DB2-DTE.                                          
057100         10  PV-REFORMAT-TO-DB2-CY    PIC X(04)  VALUE SPACES.            
057200         10  PV-REFORMAT-TODB2-DASH1  PIC X(01)  VALUE '-'.               
057300         10  PV-REFORMAT-TO-DB2-MM    PIC X(02)  VALUE SPACES.            
057400         10  PV-REFORMAT-TODB2-DASH2  PIC X(01)  VALUE '-'.               
057500         10  PV-REFORMAT-TO-DB2-DD    PIC X(02)  VALUE SPACES.            
057600                                                                          
057700     05  PV-REFORMAT-10BYTE-FIELD     PIC X(10)  VALUE SPACES.            
057800                                                                          
057900 01  CKPT-RESTART-INFO.                                                   
058000     05  CR-INPUT-FILE-SW            PIC X(01)     VALUE 'I'.             
058100         88  INPUT-CUSTOMS-FILE                    VALUE 'I'.             
058200     05  CR-CUSTOMS-RECS-WORKED      PIC 9(09)     VALUE ZERO.            
058300                                                                          
058400*********************************************************                 
058500* THESE THREE CURSORS ARE USED IN DELETING ALL SUBORDINATE                
058600* ROWS RELATED TO A TIMCSEN ROW                                           
058700*********************************************************                 
058800     EXEC SQL                                                             
058900        DECLARE BOL CURSOR FOR                                            
059000            SELECT  CSTM_ENTR_ID                                          
059100                   ,MSTR_BOL_NBR                                          
059200                   ,HSE_BOL_NBR                                           
059300                   ,CRE_BY_USR_ID                                         
059400                   ,CRE_TMST                                              
059500                   ,LAST_UPD_BY_USR_ID                                    
059600                   ,LAST_UPD_TMST                                         
059700            FROM   TIMCSBL                                                
059800            WHERE  CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID                   
059900     END-EXEC.                                                            
060000                                                                          
060100     EXEC SQL                                                             
060200        DECLARE CON CURSOR FOR                                            
060300            SELECT   CSTM_ENTR_ID                                         
060400                    ,CONTNR_ID                                            
060500                    ,CRE_BY_USR_ID                                        
060600                    ,CRE_TMST                                             
060700                    ,LAST_UPD_BY_USR_ID                                   
060800                    ,LAST_UPD_TMST                                        
060900                    ,DO_TO_DCONSLR_TMST                                   
061000            FROM   TIMCSCN                                                
061100            WHERE  CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID                   
061200     END-EXEC.                                                            
061300                                                                          
061400                                                                          
061500     EXEC SQL                                                             
061600        DECLARE PO CURSOR FOR                                             
061700            SELECT    CSTM_ENTR_ID                                        
061800                     ,PO_NBR                                              
061900                     ,EXTL_REF_NBR                                        
062000                     ,CRE_BY_USR_ID                                       
062100                     ,CRE_TMST                                            
062200                     ,LAST_UPD_BY_USR_ID                                  
062300                     ,LAST_UPD_TMST                                       
062400            FROM   TIMCSPO                                                
062500            WHERE  CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID                   
062600     END-EXEC.                                                            
062700                                                                          
062800     EXEC SQL                                                             
062900        DECLARE PO2 CURSOR FOR                                            
063000            SELECT    PO_NBR                                              
063100                     ,EXTL_REF_NBR                                        
063200            FROM   TIMCSPO                                                
063300            WHERE  CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID                   
063400     END-EXEC.                                                            
063500                                                                          
063600     EXEC SQL                                                             
063700        DECLARE TIMCNPO_CSR CURSOR FOR                                    
063800            SELECT    A.CONTNR_ID                                         
063900                     ,A.CONTNR_SEQ_NBR                                    
064000                     ,A.PO_NBR                                            
064100                     ,A.CSTM_ENTR_ID                                      
064200                     ,A.MSTR_BOL_NBR                                      
064300                     ,A.HSE_BOL_NBR                                       
064400                     ,A.LTR_OF_CR_NBR                                     
064500                     ,A.PO_RCVD_DELY_TMST                                 
064600                     ,A.PO_C_O_PROD_CDE                                   
064700                     ,A.PO_CART_CNT                                       
064800                     ,A.PO_CBMT_QTY                                       
064900                     ,A.PO_WT_KGRM_QTY                                    
065000                     ,A.PO_UNT_QTY                                        
065100                     ,A.CRE_BY_USR_ID                                     
065200                     ,A.CRE_TMST                                          
065300                     ,A.LAST_UPD_BY_USR_ID                                
065400                     ,A.LAST_UPD_TMST                                     
065500                     ,A.EXTL_REF_NBR                                      
065600                     ,A.BKR_FRGT_RLSE_CDE                                 
065700                     ,A.DO_RCVD_CDE                                       
065800                     ,A.CONTNR_PU_CDE                                     
065900                     ,A.ACTL_POE_DELY_CDE                                 
066000                     ,A.DVN_CDE                                           
066100                     ,A.DCONSLR_RET_CDE                                   
066200                     ,A.SPLT_XMIT_CDE                                     
066300                     ,A.DOC_RCVD_ORGN_TMST                                
066400            FROM  TIMCNPO   A                                             
066500            INNER JOIN TIMCSPO  B                                         
066600              ON A.PO_NBR  = B.PO_NBR                                     
066700            INNER JOIN TIMCSCN  C                                         
066800              ON A.CONTNR_ID = C.CONTNR_ID                                
066900             AND B.CSTM_ENTR_ID  =  C.CSTM_ENTR_ID                        
067000             WHERE  B.CSTM_ENTR_ID = :PV-HOLD-ENTR-ID-FOR-CNPO-UPD        
067100     END-EXEC.                                                            
067200                                                                          
067300     EXEC SQL                                                             
067400        DECLARE TIMCNPO_D_CN_CSR CURSOR FOR                               
067500            SELECT    A.CONTNR_ID                                         
067600                     ,A.CONTNR_SEQ_NBR                                    
067700                     ,A.PO_NBR                                            
067800                     ,A.CSTM_ENTR_ID                                      
067900                     ,A.MSTR_BOL_NBR                                      
068000                     ,A.HSE_BOL_NBR                                       
068100                     ,A.LTR_OF_CR_NBR                                     
068200                     ,A.PO_RCVD_DELY_TMST                                 
068300                     ,A.PO_C_O_PROD_CDE                                   
068400                     ,A.PO_CART_CNT                                       
068500                     ,A.PO_CBMT_QTY                                       
068600                     ,A.PO_WT_KGRM_QTY                                    
068700                     ,A.PO_UNT_QTY                                        
068800                     ,A.CRE_BY_USR_ID                                     
068900                     ,A.CRE_TMST                                          
069000                     ,A.LAST_UPD_BY_USR_ID                                
069100                     ,A.LAST_UPD_TMST                                     
069200                     ,A.EXTL_REF_NBR                                      
069300                     ,A.BKR_FRGT_RLSE_CDE                                 
069400                     ,A.DO_RCVD_CDE                                       
069500                     ,A.CONTNR_PU_CDE                                     
069600                     ,A.ACTL_POE_DELY_CDE                                 
069700                     ,A.DVN_CDE                                           
069800                     ,A.DCONSLR_RET_CDE                                   
069900                     ,A.SPLT_XMIT_CDE                                     
070000                     ,A.DOC_RCVD_ORGN_TMST                                
070100            FROM  TIMCNPO   A                                             
070200             WHERE A.CSTM_ENTR_ID = :IMCSCN-CSTM-ENTR-ID                  
070300             AND   A.CONTNR_ID    = :IMCSCN-CONTNR-ID                     
070400     END-EXEC.                                                            
070500                                                                          
070600     EXEC SQL                                                             
070700        DECLARE TIMCNPO_D_PO_CSR CURSOR FOR                               
070800            SELECT    A.CONTNR_ID                                         
070900                     ,A.CONTNR_SEQ_NBR                                    
071000                     ,A.PO_NBR                                            
071100                     ,A.CSTM_ENTR_ID                                      
071200                     ,A.MSTR_BOL_NBR                                      
071300                     ,A.HSE_BOL_NBR                                       
071400                     ,A.LTR_OF_CR_NBR                                     
071500                     ,A.PO_RCVD_DELY_TMST                                 
071600                     ,A.PO_C_O_PROD_CDE                                   
071700                     ,A.PO_CART_CNT                                       
071800                     ,A.PO_CBMT_QTY                                       
071900                     ,A.PO_WT_KGRM_QTY                                    
072000                     ,A.PO_UNT_QTY                                        
072100                     ,A.CRE_BY_USR_ID                                     
072200                     ,A.CRE_TMST                                          
072300                     ,A.LAST_UPD_BY_USR_ID                                
072400                     ,A.LAST_UPD_TMST                                     
072500                     ,A.EXTL_REF_NBR                                      
072600                     ,A.BKR_FRGT_RLSE_CDE                                 
072700                     ,A.DO_RCVD_CDE                                       
072800                     ,A.CONTNR_PU_CDE                                     
072900                     ,A.ACTL_POE_DELY_CDE                                 
073000                     ,A.DVN_CDE                                           
073100                     ,A.DCONSLR_RET_CDE                                   
073200                     ,A.SPLT_XMIT_CDE                                     
073300                     ,A.DOC_RCVD_ORGN_TMST                                
073400            FROM  TIMCNPO   A                                             
073500             WHERE A.CSTM_ENTR_ID = :IMCSPO-CSTM-ENTR-ID                  
073600             AND   A.PO_NBR       = :IMCSPO-PO-NBR                        
073700     END-EXEC.                                                            
073800                                                                          
073900                                                                          
074000*********************************************************                 
074100* THIS CURSOR IS TO FIND CONTAINER/PO COMBINATIONS ON                     
074200* MULTIPLE CUSTOMS ENTRIES.                                               
074300*********************************************************                 
074400     EXEC SQL                                                             
074500        DECLARE  MLTPL_WRN_CSR  CURSOR FOR                                
074600           SELECT DISTINCT                                                
074700             Z.CSTM_ENTR_ID                                               
074800           , X.CONTNR_ID                                                  
074900           , Z.PO_NBR                                                     
075000              FROM                                                        
075100                   TIMCSPO   Z                                            
075200                 , TIMCSCN   X                                            
075300                WHERE Z.CSTM_ENTR_ID <>                                   
075400                                :PV-HOLD-ENTR-ID-FOR-CNPO-UPD             
075500                AND Z.CSTM_ENTR_ID    =  X.CSTM_ENTR_ID                   
075600                AND EXISTS                                                
075700                 (SELECT B.CSTM_ENTR_ID                                   
075800              FROM                                                        
075900                   TIMCNPO   A                                            
076000                ,  TIMCSCN   B                                            
076100                ,  TIMCSPO   C                                            
076200                WHERE B.CSTM_ENTR_ID  =                                   
076300                                   :PV-HOLD-ENTR-ID-FOR-CNPO-UPD          
076400                  AND A.PO_NBR        =  Z.PO_NBR                         
076500                  AND A.PO_NBR        =  C.PO_NBR                         
076600                  AND A.CONTNR_ID     =  B.CONTNR_ID                      
076700                  AND A.CONTNR_ID     =  X.CONTNR_ID                      
076800                  AND B.CSTM_ENTR_ID  =  C.CSTM_ENTR_ID)                  
076900     END-EXEC.                                                            
077000*********************************************************                 
077100* THIS CURSOR IS TO FIND ROW WITH SAME ENTRY ID AND                       
077200* SELECT THE PO.                                                          
077300*********************************************************                 
077400     EXEC SQL                                                             
077500        DECLARE PO_CSR CURSOR FOR                                         
077600            SELECT    PO_NBR                                              
077700            FROM   TIMCSPO                                                
077800            WHERE  CSTM_ENTR_ID = :PV-HOLD-ENTR-ID-FOR-CNPO-UPD           
077900     END-EXEC.                                                            
078000*-----------------------------------------------------------------        
078100*  CURSOR DECLARATION TO SELECT THE FOB AND SCAC CODE FOR A               
078200*  GIVEN P.O. NUMBER.                                                     
078300*-----------------------------------------------------------------        
078400                                                                          
078500     EXEC SQL                                                             
078600          DECLARE FOB_SCAC_CSR CURSOR FOR                                 
078700             SELECT DISTINCT                                              
078800                    A.FOB_CDE                                             
078900                   ,C.SCAC_CDE                                            
079000               FROM TPLNSHP  A                                            
079100                   ,TIMFOB   B                                            
079200                   ,TEXTENT  C                                            
079300              WHERE A.PO_NBR              = :IMCNPO-PO-NBR                
079400                AND A.VER_STATUS_CDE      = :PC-A                         
079500                AND A.FOB_CDE             = B.FOB_CDE                     
079600                AND B.CONSLR_ENT_ID       = C.ENT_ID                      
079700     END-EXEC.                                                            
079800                                                                          
079900     EXEC SQL                                                             
080000          DECLARE CSTM_CONTNR_CSR CURSOR FOR                              
080100             SELECT CONTNR_ID                                             
080200               FROM TIMCSCN                                               
080300              WHERE CSTM_ENTR_ID = :TR027-ENFPO-CSTM-ENTR-ID              
080400     END-EXEC.                                                            
080500                                                                          
080600                                                                          
080700                                                                          
080800******************************************************************        
080900 PROCEDURE DIVISION.                                                      
081000******************************************************************        
081100*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *        
081200******************************************************************        
081300 0000-PROGRAM-MAINLINE.                                                   
081400                                                                          
081500     PERFORM 1000-INITIALIZE.                                             
081600                                                                          
081700     PERFORM 2000-PROCESS-CUSTOMS-RECORDS                                 
081800         UNTIL PS-END-OF-INPUT.                                           
081900                                                                          
082000     PERFORM 8000-EOJ-ROUTINE.                                            
082100     STOP RUN.                                                            
082200                                                                          
082300******************************************************************        
082400*  OPEN FILES, INITIALIZE FIELDS, AND DOES OTHER BEGINNING OF    *        
082500*  JOB PROCESSES.                                                *        
082600******************************************************************        
082700 1000-INITIALIZE.                                                         
082800                                                                          
082900     OPEN INPUT TR027-CUSTOMS-FILE.                                       
083000                                                                          
083100     PERFORM 4000-GET-CHECKPOINT-CNTL.                                    
083200                                                                          
083300     MOVE PV-CKPT-STAT-CODE TO PS-RUN-TYPE-SW.                            
083400                                                                          
083500     IF RESTART-RUN                                                       
083600         PERFORM 4110-CHECKPOINT-RESTART                                  
083700     ELSE                                                                 
083800         PERFORM 1010-CONTINUE-INITIALIZE                                 
083900     END-IF.                                                              
084000                                                                          
084100     PERFORM 4020-SET-COMMIT-TIME.                                        
084200                                                                          
084300 1010-CONTINUE-INITIALIZE.                                                
084400                                                                          
084500     SET PS-GOOD-RECORD-NO TO TRUE.                                       
084600***************************************                                   
084700* FIRST READ TO PRIME PROCESSING                                          
084800***************************************                                   
084900                                                                          
085000     PERFORM 6000-READ-CUSTOMS-FILE                                       
085100        UNTIL PS-GOOD-RECORD OR                                           
085200              PS-END-OF-INPUT                                             
085300                                                                          
085400***************************************                                   
085500* SAVE KEYS                                                               
085600***************************************                                   
085700     MOVE TR027-ENF-CSTM-ENTR-ID TO PV-HOLD-ENTRY-ID.                     
085800     MOVE TR027-ENF-ENT-ID       TO PV-HOLD-ENT-ID.                       
085900                                                                          
086000***************************************                                   
086100* SEE IF TIMCSEN ROW IS AVAILABLE, IF NOT                                 
086200* IT MAY HAVE TO BE CREATED                                               
086300***************************************                                   
086400     PERFORM 7140-SELECT-TIMCSEN.                                         
086500                                                                          
086600***************************************                                   
086700* PREPARE TO CREATE AUDIT ENTRY                                           
086800***************************************                                   
086900     IF PS-TIMCSEN-AVAIL                                                  
087000        PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                              
087100     END-IF.                                                              
087200                                                                          
087300***************************************                                   
087400* SAVE LAST TRANSACTION CODE                                              
087500***************************************                                   
087600     EVALUATE TR027-ENF-REC-TYP-CDE                                       
087700        WHEN 'ENF   '                                                     
087800        WHEN 'EXD   '                                                     
087900        WHEN 'REJ   '                                                     
088000        WHEN 'ECR   '                                                     
088100        WHEN 'RLS   '                                                     
088200        WHEN 'LIQ   '                                                     
088300        WHEN 'LSU   '                                                     
088400           MOVE TR027-ENF-TRN-TYP TO PV-LAST-TRAN-ENF                     
088500        WHEN 'ENFBOL'                                                     
088600           MOVE TR027-ENFBOL-TRN-TYP TO PV-LAST-TRAN-ENFBOL               
088700           MOVE TR027-ENFBOL-MSTR-BOL-NBR TO                              
088800              PV-LAST-MBOL                                                
088900              PV-HOLD-MBOL                                                
089000           MOVE TR027-ENFBOL-HSE-BOL-NBR  TO                              
089100              PV-LAST-HBOL                                                
089200              PV-HOLD-HBOL                                                
089300        WHEN 'ENFCON'                                                     
089400        WHEN 'DOP   '                                                     
089500           MOVE TR027-ENFCON-TRN-TYP   TO PV-LAST-TRAN-ENFCON             
089600           MOVE TR027-ENFCON-CONTNR-ID TO PV-LAST-CONTAINER               
089700                                          PV-HOLD-CONTAINER               
089800        WHEN 'ENFPO '                                                     
089900           MOVE TR027-ENFPO-TRN-TYP  TO PV-LAST-TRAN-ENFPO                
090000           MOVE TR027-ENFPO-PO-NBR   TO PV-LAST-PO                        
090100                                        PV-HOLD-PO                        
090200           MOVE TR027-ENFPO-EXTL-REF-NBR                                  
090300                                     TO PV-LAST-EXTL-REF-NBR              
090400                                        PV-HOLD-EXTL-REF-NBR              
090500     END-EVALUATE.                                                        
090600                                                                          
090700******************************************************************        
090800* MAIN PROCESSING PARAGRAPH.                                     *        
090900******************************************************************        
091000 2000-PROCESS-CUSTOMS-RECORDS.                                            
091100                                                                          
091200***************************************                                   
091300* MOVE RECORD INFO TO TR241 REC IN                                        
091400* PREPARATION FOR DETAIL OR ERROR OUTPUT                                  
091500***************************************                                   
091600     PERFORM 5000-MOVE-TO-TR241.                                          
091700                                                                          
091800***************************************                                   
091900* EVALUATE REC TYPE TO DETERMINE PROCESSING                               
092000***************************************                                   
092100     EVALUATE TR027-ENF-REC-TYP-CDE                                       
092200        WHEN 'ENF   '                                                     
092300           PERFORM 2010-PROCESS-ENF                                       
092400        WHEN 'ENFBOL'                                                     
092500           PERFORM 2015-PROCESS-ENFBOL                                    
092600        WHEN 'ENFCON'                                                     
092700           PERFORM 2020-PROCESS-ENFCON                                    
092800        WHEN 'DOP   '                                                     
092900           PERFORM 2023-PROCESS-DOP                                       
093000        WHEN 'ENFPO '                                                     
093100           PERFORM 2025-PROCESS-ENFPO                                     
093200        WHEN 'EXD   '                                                     
093300           PERFORM 2030-PROCESS-EXD                                       
093400        WHEN 'REJ   '                                                     
093500           PERFORM 2035-PROCESS-REJ                                       
093600        WHEN 'ECR   '                                                     
093700           PERFORM 2040-PROCESS-ECR                                       
093800        WHEN 'RLS   '                                                     
093900           PERFORM 2045-PROCESS-RLS                                       
094000        WHEN 'LIQ   '                                                     
094100           PERFORM 2050-PROCESS-LIQ                                       
094200        WHEN 'LSU   '                                                     
094300           PERFORM 2055-PROCESS-LSU                                       
094400     END-EVALUATE.                                                        
094500                                                                          
094600***************************************                                   
094700* READ NEXT RECORD                                                        
094800***************************************                                   
094900                                                                          
095000     SET PS-GOOD-RECORD-NO TO TRUE.                                       
095100     PERFORM 6000-READ-CUSTOMS-FILE                                       
095200        UNTIL PS-GOOD-RECORD OR                                           
095300              PS-END-OF-INPUT.                                            
095400                                                                          
095500     MOVE 'N' TO PS-TIMCSBL-AVAIL-SW.                                     
095600     MOVE 'N' TO PS-TIMCSPO-AVAIL-SW.                                     
095700                                                                          
095800***************************************                                   
095900* CHECK WHETHER KEY IS THE SAME                                           
096000***************************************                                   
096100     IF (TR027-ENF-CSTM-ENTR-ID = PV-HOLD-ENTRY-ID) AND                   
096200        NOT PS-END-OF-INPUT                                               
096300                                                                          
096400        EVALUATE TR027-ENF-REC-TYP-CDE                                    
096500           WHEN 'ENF   '                                                  
096600           WHEN 'EXD   '                                                  
096700           WHEN 'REJ   '                                                  
096800           WHEN 'ECR   '                                                  
096900           WHEN 'RLS   '                                                  
097000           WHEN 'LIQ   '                                                  
097100           WHEN 'LSU   '                                                  
097200***************************************                                   
097300* CHECK WHETHER TRANSACTION THE SAME                                      
097400***************************************                                   
097500              IF TR027-ENF-TRN-TYP = PV-LAST-TRAN-ENF                     
097600                 CONTINUE                                                 
097700              ELSE                                                        
097800***************************************                                   
097900* SINCE KEY IS THE SAME AND TRANSACTION                                   
098000* IS DIFFERENT, PROCESS RECORD(S)                                         
098100***************************************                                   
098200                 MOVE TR027-ENF-TRN-TYP TO PV-LAST-TRAN-ENF               
098300                 IF PS-DELETE-TIMCSEN                                     
098400                    PERFORM 7999-SET-CURRENT-TMST                         
098500                    IF PS-INSERT-TIMCSEN                                  
098600                       INITIALIZE DCLTIMCSEN                              
098700                    ELSE                                                  
098800                       PERFORM 7020-DELETE-TIMCSEN                        
098900                    END-IF                                                
099000                    MOVE PC-D TO AUCSEN-AUD-FUNC-CDE                      
099100                    PERFORM 7060-INSERT-TAUCSEN                           
099200                    MOVE 'N' TO PS-TIMCSEN-AVAIL-SW                       
099300                                PS-INSERT-TIMCSEN-SW                      
099400                                PS-UPDATE-TIMCSEN-SW                      
099500                                PS-DELETE-TIMCSEN-SW                      
099600                 END-IF                                                   
099700                 IF PS-INSERT-TIMCSEN                                     
099800                    PERFORM 7999-SET-CURRENT-TMST                         
099900                    PERFORM 7000-INSERT-TIMCSEN                           
100000                    PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                  
100100                    MOVE 'N' TO PS-INSERT-TIMCSEN-SW                      
100200                                PS-UPDATE-TIMCSEN-SW                      
100300                                PS-DELETE-TIMCSEN-SW                      
100400                 END-IF                                                   
100500                 IF PS-UPDATE-TIMCSEN                                     
100600                    PERFORM 7999-SET-CURRENT-TMST                         
100700                    PERFORM 7010-UPDATE-TIMCSEN                           
100800                    MOVE PC-U TO AUCSEN-AUD-FUNC-CDE                      
100900                    PERFORM 7060-INSERT-TAUCSEN                           
101000                    PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                  
101100                    MOVE 'N' TO PS-INSERT-TIMCSEN-SW                      
101200                                PS-UPDATE-TIMCSEN-SW                      
101300                                PS-DELETE-TIMCSEN-SW                      
101400                 END-IF                                                   
101500              END-IF                                                      
101600           WHEN 'ENFBOL'                                                  
101700              IF (TR027-ENFBOL-TRN-TYP = PV-LAST-TRAN-ENFBOL) AND         
101800                 (TR027-ENFBOL-MSTR-BOL-NBR = PV-LAST-MBOL)   AND         
101900                 (TR027-ENFBOL-HSE-BOL-NBR = PV-LAST-HBOL)                
102000                 CONTINUE                                                 
102100              ELSE                                                        
102200                 MOVE TR027-ENFBOL-TRN-TYP  TO PV-LAST-TRAN-ENFBOL        
102300                 MOVE TR027-ENFBOL-MSTR-BOL-NBR TO PV-LAST-MBOL           
102400                                                   PV-HOLD-MBOL           
102500                 MOVE TR027-ENFBOL-HSE-BOL-NBR  TO PV-LAST-HBOL           
102600                                                   PV-HOLD-HBOL           
102700                 IF PS-DELETE-TIMCSBL                                     
102800                    PERFORM 7999-SET-CURRENT-TMST                         
102900                    IF PS-INSERT-TIMCSBL                                  
103000                       INITIALIZE DCLTIMCSBL                              
103100                    ELSE                                                  
103200                       PERFORM 7110-DELETE-TIMCSBL                        
103300                    END-IF                                                
103400                    MOVE PC-D TO AUCSBL-AUD-FUNC-CDE                      
103500                    PERFORM 7070-INSERT-TAUCSBL                           
103600                    MOVE 'N' TO PS-TIMCSBL-AVAIL-SW                       
103700                                PS-INSERT-TIMCSBL-SW                      
103800                                PS-UPDATE-TIMCSBL-SW                      
103900                                PS-DELETE-TIMCSBL-SW                      
104000                 END-IF                                                   
104100                 IF PS-INSERT-TIMCSBL                                     
104200                    PERFORM 7999-SET-CURRENT-TMST                         
104300                    PERFORM 7030-INSERT-TIMCSBL                           
104400                    MOVE 'N' TO PS-TIMCSBL-AVAIL-SW                       
104500                                PS-INSERT-TIMCSBL-SW                      
104600                                PS-UPDATE-TIMCSBL-SW                      
104700                                PS-DELETE-TIMCSBL-SW                      
104800                 END-IF                                                   
104900              END-IF                                                      
105000           WHEN 'ENFCON'                                                  
105100           WHEN 'DOP   '                                                  
105200              IF (TR027-ENFCON-TRN-TYP = PV-LAST-TRAN-ENFCON) AND         
105300                 (TR027-ENFCON-CONTNR-ID = PV-LAST-CONTAINER)             
105400                 CONTINUE                                                 
105500              ELSE                                                        
105600                 IF TR027-ENFCON-CONTNR-ID = PV-LAST-CONTAINER            
105700                    CONTINUE                                              
105800                 ELSE                                                     
105900                    MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                       
106000                 END-IF                                                   
106100                 MOVE TR027-ENFCON-TRN-TYP TO PV-LAST-TRAN-ENFCON         
106200                 MOVE TR027-ENFCON-CONTNR-ID TO PV-LAST-CONTAINER         
106300                                                PV-HOLD-CONTAINER         
106400                 IF PS-DELETE-TIMCSCN                                     
106500                    PERFORM 7999-SET-CURRENT-TMST                         
106600                    IF PS-INSERT-TIMCSCN  OR                              
106700                       PS-UPDATE-TIMCSCN                                  
106800                       INITIALIZE DCLTIMCSCN                              
106900                    ELSE                                                  
107000                       SET PS-ENTR-ID-FOR-CN-DEL-FOUND-NO TO TRUE         
107100                       PERFORM 7120-DELETE-TIMCSCN                        
107200                    END-IF                                                
107300                    MOVE PC-D TO AUCSCN-AUD-FUNC-CDE                      
107400                    PERFORM 7080-INSERT-TAUCSCN                           
107500                    IF PS-ENTR-ID-FOR-CN-DEL-FOUND                        
107600                       SET PS-EOC-TIMCNPO-D-CN-CSR-NO TO TRUE             
107700                       PERFORM 7220-OPEN-TIMCNPO-D-CN-CURSOR              
107800                       PERFORM 7221-FETCH-TIMCNPO-D-CN-CURSOR             
107900                         UNTIL PS-EOC-TIMCNPO-D-CN-CSR                    
108000                       PERFORM 7222-CLOSE-TIMCNPO-D-CN-CURSOR             
108100                    END-IF                                                
108200                    MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                       
108300                                PS-INSERT-TIMCSCN-SW                      
108400                                PS-UPDATE-TIMCSCN-SW                      
108500                                PS-DELETE-TIMCSCN-SW                      
108600                 END-IF                                                   
108700                 IF PS-INSERT-TIMCSCN                                     
108800                    PERFORM 7999-SET-CURRENT-TMST                         
108900                    PERFORM 7040-INSERT-TIMCSCN                           
109000                    SET PS-CSPO-OR-CSCN-INSERTED TO TRUE                  
109100                    MOVE IMCSCN-CSTM-ENTR-ID TO                           
109200                              PV-HOLD-ENTR-ID-FOR-CNPO-UPD                
109300                    MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                       
109400                                PS-INSERT-TIMCSCN-SW                      
109500                                PS-UPDATE-TIMCSCN-SW                      
109600                                PS-DELETE-TIMCSCN-SW                      
109700                 END-IF                                                   
109800                 IF PS-UPDATE-TIMCSCN                                     
109900                    PERFORM 7999-SET-CURRENT-TMST                         
110000                    PERFORM 7350-UPDATE-TIMCSCN                           
110100                    MOVE PC-U TO AUCSCN-AUD-FUNC-CDE                      
110200                    PERFORM 7080-INSERT-TAUCSCN                           
110300                    MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                       
110400                                PS-INSERT-TIMCSCN-SW                      
110500                                PS-UPDATE-TIMCSCN-SW                      
110600                                PS-DELETE-TIMCSCN-SW                      
110700                 END-IF                                                   
110800              END-IF                                                      
110900           WHEN 'ENFPO '                                                  
111000              IF (TR027-ENFPO-TRN-TYP = PV-LAST-TRAN-ENFPO) AND           
111100                 (TR027-ENFPO-PO-NBR = PV-LAST-PO) AND                    
111200                 (TR027-ENFPO-EXTL-REF-NBR =                              
111300                                    PV-LAST-EXTL-REF-NBR)                 
111400                 CONTINUE                                                 
111500              ELSE                                                        
111600                 MOVE TR027-ENFPO-TRN-TYP TO PV-LAST-TRAN-ENFPO           
111700                 MOVE TR027-ENFPO-PO-NBR TO PV-LAST-PO                    
111800                                            PV-HOLD-PO                    
111900                 MOVE TR027-ENFPO-EXTL-REF-NBR                            
112000                                        TO PV-LAST-EXTL-REF-NBR           
112100                                           PV-HOLD-EXTL-REF-NBR           
112200                 IF PS-DELETE-TIMCSPO                                     
112300                    PERFORM 7999-SET-CURRENT-TMST                         
112400                    IF PS-DELETE-TIMCSPO                                  
112500                       INITIALIZE DCLTIMCSPO                              
112600                    ELSE                                                  
112700                       SET PS-ENTR-ID-FOR-CN-DEL-FOUND-NO TO TRUE         
112800                       PERFORM 7130-DELETE-TIMCSPO                        
112900                    END-IF                                                
113000                    MOVE PC-D TO AUCSCN-AUD-FUNC-CDE                      
113100                    PERFORM 7090-INSERT-TAUCSPO                           
113200                    IF PS-ENTR-ID-FOR-PO-DEL-FOUND                        
113300                       SET PS-EOC-TIMCNPO-D-PO-CSR-NO     TO TRUE         
113400                       PERFORM 7230-OPEN-TIMCNPO-D-PO-CURSOR              
113500                       PERFORM 7231-FETCH-TIMCNPO-D-PO-CURSOR             
113600                         UNTIL PS-EOC-TIMCNPO-D-PO-CSR                    
113700                       PERFORM 7232-CLOSE-TIMCNPO-D-PO-CURSOR             
113800                    END-IF                                                
113900                    MOVE 'N' TO PS-TIMCSPO-AVAIL-SW                       
114000                                PS-INSERT-TIMCSPO-SW                      
114100                                PS-UPDATE-TIMCSPO-SW                      
114200                                PS-DELETE-TIMCSPO-SW                      
114300                 END-IF                                                   
114400                 IF PS-INSERT-TIMCSPO                                     
114500                    PERFORM 7999-SET-CURRENT-TMST                         
114600                    PERFORM 7050-INSERT-TIMCSPO                           
114700                    SET PS-CSPO-OR-CSCN-INSERTED TO TRUE                  
114800                    MOVE IMCSPO-CSTM-ENTR-ID TO                           
114900                              PV-HOLD-ENTR-ID-FOR-CNPO-UPD                
115000                    MOVE 'N' TO PS-TIMCSPO-AVAIL-SW                       
115100                                PS-INSERT-TIMCSPO-SW                      
115200                                PS-UPDATE-TIMCSPO-SW                      
115300                                PS-DELETE-TIMCSPO-SW                      
115400                 END-IF                                                   
115500              END-IF                                                      
115600        END-EVALUATE                                                      
115700     ELSE                                                                 
115800***************************************                                   
115900* SINCE KEY HAS CHANGED,                                                  
116000* PROCESS RECORD(S)                                                       
116100***************************************                                   
116200        MOVE 'N' TO PS-TIMCSEN-AVAIL-SW                                   
116300        SET PS-EVERYTHING-NOT-GONE TO TRUE                                
116400                                                                          
116500        MOVE TR027-ENF-CSTM-ENTR-ID TO PV-HOLD-ENTRY-ID                   
116600        MOVE TR027-ENF-ENT-ID TO PV-HOLD-ENT-ID                           
116700        EVALUATE TR027-ENF-REC-TYP-CDE                                    
116800           WHEN 'ENF   '                                                  
116900           WHEN 'EXD   '                                                  
117000           WHEN 'REJ   '                                                  
117100           WHEN 'ECR   '                                                  
117200           WHEN 'RLS   '                                                  
117300           WHEN 'LIQ   '                                                  
117400           WHEN 'LSU   '                                                  
117500              MOVE TR027-ENF-TRN-TYP TO PV-LAST-TRAN-ENF                  
117600           WHEN 'ENFBOL'                                                  
117700              MOVE TR027-ENFBOL-TRN-TYP TO PV-LAST-TRAN-ENFBOL            
117800              MOVE TR027-ENFBOL-MSTR-BOL-NBR TO                           
117900                 PV-LAST-MBOL                                             
118000                 PV-HOLD-MBOL                                             
118100              MOVE TR027-ENFBOL-HSE-BOL-NBR  TO                           
118200                 PV-LAST-HBOL                                             
118300                 PV-HOLD-HBOL                                             
118400           WHEN 'ENFCON'                                                  
118500           WHEN 'DOP   '                                                  
118600              MOVE TR027-ENFCON-TRN-TYP   TO PV-LAST-TRAN-ENFCON          
118700              MOVE TR027-ENFCON-CONTNR-ID TO PV-LAST-CONTAINER            
118800                                             PV-HOLD-CONTAINER            
118900              MOVE 'N'                    TO PS-TIMCSCN-AVAIL-SW          
119000           WHEN 'ENFPO '                                                  
119100              MOVE TR027-ENFPO-TRN-TYP  TO PV-LAST-TRAN-ENFPO             
119200              MOVE TR027-ENFPO-PO-NBR   TO PV-LAST-PO                     
119300                                           PV-HOLD-PO                     
119400              MOVE TR027-ENFPO-EXTL-REF-NBR                               
119500                                        TO PV-LAST-EXTL-REF-NBR           
119600                                           PV-HOLD-EXTL-REF-NBR           
119700        END-EVALUATE                                                      
119800        IF PS-DELETE-TIMCSEN                                              
119900           PERFORM 7999-SET-CURRENT-TMST                                  
120000           IF PS-INSERT-TIMCSEN                                           
120100              INITIALIZE DCLTIMCSEN                                       
120200           ELSE                                                           
120300              PERFORM 7020-DELETE-TIMCSEN                                 
120400           END-IF                                                         
120500           MOVE PC-D TO AUCSEN-AUD-FUNC-CDE                               
120600           PERFORM 7060-INSERT-TAUCSEN                                    
120700           MOVE 'N' TO PS-TIMCSEN-AVAIL-SW                                
120800                       PS-INSERT-TIMCSEN-SW                               
120900                       PS-UPDATE-TIMCSEN-SW                               
121000                       PS-DELETE-TIMCSEN-SW                               
121100        END-IF                                                            
121200        IF PS-INSERT-TIMCSEN                                              
121300           PERFORM 7999-SET-CURRENT-TMST                                  
121400           PERFORM 7000-INSERT-TIMCSEN                                    
121500           MOVE 'N' TO PS-TIMCSEN-AVAIL-SW                                
121600                       PS-INSERT-TIMCSEN-SW                               
121700                       PS-UPDATE-TIMCSEN-SW                               
121800                       PS-DELETE-TIMCSEN-SW                               
121900        END-IF                                                            
122000        IF PS-DELETE-TIMCSBL                                              
122100           PERFORM 7999-SET-CURRENT-TMST                                  
122200           MOVE PC-D TO AUCSBL-AUD-FUNC-CDE                               
122300           IF PS-INSERT-TIMCSBL                                           
122400              INITIALIZE DCLTIMCSBL                                       
122500           ELSE                                                           
122600              PERFORM 7110-DELETE-TIMCSBL                                 
122700           END-IF                                                         
122800           PERFORM 7070-INSERT-TAUCSBL                                    
122900           MOVE 'N' TO PS-TIMCSBL-AVAIL-SW                                
123000                       PS-INSERT-TIMCSBL-SW                               
123100                       PS-UPDATE-TIMCSBL-SW                               
123200                       PS-DELETE-TIMCSBL-SW                               
123300        END-IF                                                            
123400        IF PS-UPDATE-TIMCSEN                                              
123500           PERFORM 7999-SET-CURRENT-TMST                                  
123600           MOVE PC-U TO AUCSEN-AUD-FUNC-CDE                               
123700           PERFORM 7010-UPDATE-TIMCSEN                                    
123800           PERFORM 7060-INSERT-TAUCSEN                                    
123900           MOVE 'N' TO PS-TIMCSEN-AVAIL-SW                                
124000                       PS-INSERT-TIMCSEN-SW                               
124100                       PS-UPDATE-TIMCSEN-SW                               
124200                       PS-DELETE-TIMCSEN-SW                               
124300        END-IF                                                            
124400        IF PS-INSERT-TIMCSBL                                              
124500           PERFORM 7999-SET-CURRENT-TMST                                  
124600           PERFORM 7030-INSERT-TIMCSBL                                    
124700           MOVE 'N' TO PS-TIMCSBL-AVAIL-SW                                
124800                          PS-INSERT-TIMCSBL-SW                            
124900                          PS-UPDATE-TIMCSBL-SW                            
125000                          PS-DELETE-TIMCSBL-SW                            
125100        END-IF                                                            
125200        IF PS-DELETE-TIMCSCN                                              
125300           PERFORM 7999-SET-CURRENT-TMST                                  
125400           MOVE PC-D TO AUCSCN-AUD-FUNC-CDE                               
125500           IF PS-INSERT-TIMCSCN   OR                                      
125600              PS-UPDATE-TIMCSCN                                           
125700              INITIALIZE DCLTIMCSCN                                       
125800           ELSE                                                           
125900              SET PS-ENTR-ID-FOR-CN-DEL-FOUND-NO TO TRUE                  
126000              PERFORM 7120-DELETE-TIMCSCN                                 
126100           END-IF                                                         
126200           PERFORM 7080-INSERT-TAUCSCN                                    
126300           IF PS-ENTR-ID-FOR-CN-DEL-FOUND                                 
126400              SET PS-EOC-TIMCNPO-D-CN-CSR-NO TO TRUE                      
126500              PERFORM 7220-OPEN-TIMCNPO-D-CN-CURSOR                       
126600              PERFORM 7221-FETCH-TIMCNPO-D-CN-CURSOR                      
126700                UNTIL PS-EOC-TIMCNPO-D-CN-CSR                             
126800              PERFORM 7222-CLOSE-TIMCNPO-D-CN-CURSOR                      
126900           END-IF                                                         
127000           MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                                
127100                       PS-INSERT-TIMCSCN-SW                               
127200                       PS-UPDATE-TIMCSCN-SW                               
127300                       PS-DELETE-TIMCSCN-SW                               
127400        END-IF                                                            
127500        IF PS-INSERT-TIMCSCN                                              
127600           PERFORM 7999-SET-CURRENT-TMST                                  
127700           PERFORM 7040-INSERT-TIMCSCN                                    
127800           SET PS-CSPO-OR-CSCN-INSERTED TO TRUE                           
127900           MOVE IMCSCN-CSTM-ENTR-ID TO                                    
128000                         PV-HOLD-ENTR-ID-FOR-CNPO-UPD                     
128100           MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                                
128200                       PS-INSERT-TIMCSCN-SW                               
128300                       PS-UPDATE-TIMCSCN-SW                               
128400                       PS-DELETE-TIMCSCN-SW                               
128500        END-IF                                                            
128600        IF PS-UPDATE-TIMCSCN                                              
128700           PERFORM 7999-SET-CURRENT-TMST                                  
128800           PERFORM 7350-UPDATE-TIMCSCN                                    
128900           MOVE PC-U TO AUCSCN-AUD-FUNC-CDE                               
129000           PERFORM 7080-INSERT-TAUCSCN                                    
129100           MOVE 'N' TO PS-TIMCSCN-AVAIL-SW                                
129200                       PS-INSERT-TIMCSCN-SW                               
129300                       PS-UPDATE-TIMCSCN-SW                               
129400                       PS-DELETE-TIMCSCN-SW                               
129500        END-IF                                                            
129600        IF PS-DELETE-TIMCSPO                                              
129700           PERFORM 7999-SET-CURRENT-TMST                                  
129800           MOVE PC-D TO AUCSCN-AUD-FUNC-CDE                               
129900           IF PS-INSERT-TIMCSPO                                           
130000              INITIALIZE DCLTIMCSPO                                       
130100           ELSE                                                           
130200              SET PS-ENTR-ID-FOR-CN-DEL-FOUND-NO TO TRUE                  
130300              PERFORM 7130-DELETE-TIMCSPO                                 
130400           END-IF                                                         
130500           PERFORM 7090-INSERT-TAUCSPO                                    
130600           IF PS-ENTR-ID-FOR-PO-DEL-FOUND                                 
130700              SET PS-EOC-TIMCNPO-D-PO-CSR-NO     TO TRUE                  
130800              PERFORM 7230-OPEN-TIMCNPO-D-PO-CURSOR                       
130900              PERFORM 7231-FETCH-TIMCNPO-D-PO-CURSOR                      
131000                UNTIL PS-EOC-TIMCNPO-D-PO-CSR                             
131100              PERFORM 7232-CLOSE-TIMCNPO-D-PO-CURSOR                      
131200           END-IF                                                         
131300           MOVE 'N' TO PS-TIMCSPO-AVAIL-SW                                
131400                       PS-INSERT-TIMCSPO-SW                               
131500                       PS-UPDATE-TIMCSPO-SW                               
131600                       PS-DELETE-TIMCSPO-SW                               
131700        END-IF                                                            
131800        IF PS-INSERT-TIMCSPO                                              
131900           PERFORM 7999-SET-CURRENT-TMST                                  
132000           PERFORM 7050-INSERT-TIMCSPO                                    
132100           SET PS-CSPO-OR-CSCN-INSERTED TO TRUE                           
132200           MOVE IMCSPO-CSTM-ENTR-ID TO                                    
132300                         PV-HOLD-ENTR-ID-FOR-CNPO-UPD                     
132400           MOVE 'N' TO PS-TIMCSPO-AVAIL-SW                                
132500                       PS-INSERT-TIMCSPO-SW                               
132600                       PS-UPDATE-TIMCSPO-SW                               
132700                       PS-DELETE-TIMCSPO-SW                               
132800        END-IF                                                            
132900                                                                          
133000*       *********************************************                     
133100*       * IF TIMCSCN OR TIMCSPO ROWS WERE INSERTED  *                     
133200*       * PROCESS A CURSOR TO SEE IF THERE ARE      *                     
133300*       * OTHER ENTRY ID'S FOR THE SAME CONTAINER   *                     
133400*       * AND PO COMBINATION.                       *                     
133500*       *********************************************                     
133600        IF PS-CSPO-OR-CSCN-INSERTED                                       
133700          PERFORM 5540-CHECK-FOR-MULT-ENTRIES                             
133800        END-IF                                                            
133900                                                                          
134000*       *********************************************                     
134100*       * IF TIMCSCN OR TIMCSPO ROWS WERE INSERTED  *                     
134200*       * PROCESS ANOTHER CURSOR TO MATCH UP WITH   *                     
134300*       * TIMCNPO ROWS TO ADD THE CUSTOMS ENTRY ID. *                     
134400*       * SKIP THIS LOGIC FOR AIR SHIPMENTS.        *                     
134500*       *********************************************                     
134600        IF PS-CSPO-OR-CSCN-INSERTED                                       
134700          IF PS-TRIP-TYPE-BLANK                                           
134800*             *****************************************                   
134900*             * IF PS-TRIP-TYPE IS BLANK, IT MEANS NO *                   
135000*             * ENF WAS SENT, SO SELECT OFF TIMCSEN.  *                   
135100*             *****************************************                   
135200              SET PS-TIMCSEN-TRIP-TYP-FOUND-NO TO TRUE                    
135300              PERFORM 7300-CHECK-TIMCSEN-TRIP-TYP                         
135400              IF PS-TIMCSEN-TRIP-TYP-FOUND                                
135500                 MOVE IMCSEN-MOM-TRIP-TYP-CDE                             
135600                                       TO PS-TRIP-TYPE                    
135700              END-IF                                                      
135800          END-IF                                                          
135900                                                                          
136000          IF PS-TRIP-TYPE-AIR                                             
136100            CONTINUE                                                      
136200          ELSE                                                            
136300            PERFORM 7200-OPEN-TIMCNPO-CURSOR                              
136400            SET PS-EOC-TIMCNPO-CSR-NO TO TRUE                             
136500            SET PS-TIMCNPO-ROWS-EXIST-NO TO TRUE                          
136600            PERFORM 7201-FETCH-TIMCNPO-CURSOR                             
136700              UNTIL PS-EOC-TIMCNPO-CSR                                    
136800            IF PS-TIMCNPO-ROWS-EXIST                                      
136900               CONTINUE                                                   
137000            ELSE                                                          
137100               PERFORM 6128-CLEAR-ERROR-FIELDS                            
137200               PERFORM 6130-ERROR-30                                      
137300               PERFORM 7100-INSERT-TOUTTRA-RPT                            
137400*              *********************************                          
137500*              * NOW GO CHECK IF PO ON TIMCNPO *                          
137600*              *********************************                          
137700               PERFORM 7450-OPEN-PO-CSR                                   
137800               PERFORM 7455-FETCH-PO-CSR                                  
137900               PERFORM 7460-CLOSE-PO-CSR                                  
138000               IF PS-PO-FOUND                                             
138100*                  *********************************                      
138200*                  * GO GET FOB AND SCAC AND PRINT *                      
138300*                  * NEW MSG (ERROR MESSAGE # 38)  *                      
138400*                  * UNDER 'UNABLE TO MATCH' MSG.  *                      
138500*                  * (ERROR MESSAGE # 30)          *                      
138600*                  *********************************                      
138700                   PERFORM 7500-OPEN-FOB-SCAC                             
138800                   PERFORM 7505-FETCH-FOB-SCAC                            
138900                   PERFORM 7510-CLOSE-FOB-SCAC                            
139000                   SET PS-PO-NOTFND  TO TRUE                              
139100               END-IF                                                     
139200            END-IF                                                        
139300            PERFORM 7202-CLOSE-TIMCNPO-CURSOR                             
139400          END-IF                                                          
139500        END-IF                                                            
139600                                                                          
139700        SET PS-CSPO-OR-CSCN-INSERTED-NO TO TRUE                           
139800        SET PS-TRIP-TYPE-BLANK TO TRUE                                    
139900*       ***************************************                           
140000*       * AT THIS POINT A UNIT OF WORK HAS BEEN                           
140100*       * COMPLETED, CHECK IF TIME FOR COMMIT                             
140200*       ***************************************                           
140300        PERFORM 4100-COMMIT-CHECK                                         
140400                                                                          
140500***************************************                                   
140600* IF NOT EOF FOR THE INPUT FILE                                           
140700* RESET ENTRY TYPE IF ENF REC  AND                                        
140800* SEE IF TIMCSEN ROW EXISTS FOR NEXT RECORD                               
140900********************************************                              
141000        IF PS-END-OF-INPUT                                                
141100           CONTINUE                                                       
141200        ELSE                                                              
141300           INITIALIZE PV-HOLD-ENTRY-TYP-FROM-ENF                          
141400           IF TR027-ENF-REC-TYP-CDE = 'ENF   '                            
141500             MOVE TR027-ENF-ENTR-TYP-CDE                                  
141600                               TO PV-HOLD-ENTRY-TYP-FROM-ENF              
141700           END-IF                                                         
141800           PERFORM 7140-SELECT-TIMCSEN                                    
141900           IF PS-TIMCSEN-AVAIL                                            
142000              PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                        
142100           END-IF                                                         
142200        END-IF                                                            
142300     END-IF.                                                              
142400                                                                          
142500                                                                          
142600******************************************************************        
142700* PROCESS ENF                                                             
142800******************************************************************        
142900* IF TIMCSEN AVAILABLE                                                    
143000*    IF ADD TRANSACTION                                                   
143100*       IF FILD-TMST IS DEFAULT TMST                                      
143200*          MOVE TMST TO FILD-TMST                                         
143300*          WRITE DETAIL                                                   
143400*          SET PROCESS SW                                                 
143500*       ELSE                                                              
143600*          ERROR                                                          
143700*    IF CHG TRANSACTION                                                   
143800*       IF FILD-TMST = INPUT RECORD                                       
143900*          ERROR                                                          
144000*       ELSE                                                              
144100*          MOVE TMST TO FILD-TMST                                         
144200*          WRITE DETAIL                                                   
144300*          SET PROCESS SW                                                 
144400*    IF DEL TRANSACTION                                                   
144500*       SET PROCESS SW                                                    
144600*       DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                        
144700*       WRITE DETAIL                                                      
144800* ELSE                                                                    
144900*    IF ADD TRANSACTION                                                   
145000*       CREATE TIMCSEN                                                    
145100*       PREPARE FOR AUDIT                                                 
145200*       SET PROCESS SW                                                    
145300*       WRITE DETAIL                                                      
145400*    IF CHG TRANSACTION                                                   
145500*       CREATE TIMCSEN                                                    
145600*       SET PROCESS SW                                                    
145700*       WRITE DETAIL                                                      
145800*       ERROR                                                             
145900*    IF DEL TRANSACTION                                                   
146000*       ERROR                                                             
146100******************************************************************        
146200 2010-PROCESS-ENF.                                                        
146300                                                                          
146400     SET PS-GOOD-ENF-ADD-NO       TO TRUE.                                
146500     SET PS-GOOD-ENF-CHANGE-NO    TO TRUE.                                
146600     MOVE TR027-ENF-MOM-TRIP-TYP-CDE                                      
146700                                TO PS-TRIP-TYPE.                          
146800     IF PS-TIMCSEN-AVAIL                                                  
146900*       *********************************************                     
147000*       *              ADD  ENF                     *                     
147100*       *********************************************                     
147200        IF TR027-ENF-TRN-TYP = 'A'                                        
147300*          ******************************************                     
147400*          * IF FILED TIMESTAMP DEFAULT - MOVE THE  *                     
147500*          * DATA  AND SET GOOD ADD SWITCH.         *                     
147600*          ******************************************                     
147700           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST                          
147800              MOVE PV-FORMAT-TMST TO IMCSEN-FILD-TMST                     
147900              SET PS-GOOD-ENF-ADD     TO TRUE                             
148000           END-IF                                                         
148100*          ******************************************                     
148200*          * IF VALID TRIP TYPE & TBL = SPACES,     *                     
148300*          * MOVE DATA AND SET GOOD ADD TO TRUE.    *                     
148400*          ******************************************                     
148500           IF TR027-ENF-MOM-TRIP-TYP-VALID                                
148600             IF IMCSEN-MOM-TRIP-TYP-CDE = SPACES                          
148700                MOVE TR027-ENF-MOM-TRIP-TYP-CDE                           
148800                               TO IMCSEN-MOM-TRIP-TYP-CDE                 
148900                SET PS-GOOD-ENF-ADD     TO TRUE                           
149000             END-IF                                                       
149100           END-IF                                                         
149200*          ******************************************                     
149300*          * IF ENTRY TYPE CODE DESCRIPTION NOT =   *                     
149400*          * SPACES, IT MEANS THE CODE IS VALID, SO *                     
149500*          * IF ENTRY TYPE = CODE SPACES ON TABLE   *                     
149600*          * MOVE THE DATA AND SET GOOD ADD SWITCH. *                     
149700*          ******************************************                     
149800           IF TR027-ENF-ENTR-TYP-DESC  = SPACES                           
149900              CONTINUE                                                    
150000           ELSE                                                           
150100             IF IMCSEN-ENTR-TYP-CDE = SPACES                              
150200                MOVE TR027-ENF-ENTR-TYP-CDE                               
150300                                    TO IMCSEN-ENTR-TYP-CDE                
150400                SET PS-GOOD-ENF-ADD     TO TRUE                           
150500             END-IF                                                       
150600           END-IF                                                         
150700*          *********************************************                  
150800*          * IF ANY ADDS WERE OK, WRITE A DETAIL REPT  *                  
150900*          * LINE AND SET SOME SWITCHES.               *                  
151000*          *********************************************                  
151100           IF PS-GOOD-ENF-ADD                                             
151200              IF PS-INSERT-TIMCSEN                                        
151300                 CONTINUE                                                 
151400              ELSE                                                        
151500                 SET PS-UPDATE-TIMCSEN TO TRUE                            
151600              END-IF                                                      
151700              PERFORM 6128-CLEAR-ERROR-FIELDS                             
151800              MOVE 'D' TO TR241-RPT-TYP                                   
151900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
152000           ELSE                                                           
152100              MOVE 'ENTRY FILD DATA'                                      
152200                                 TO TR241-DATA-IN-ERROR                   
152300              MOVE TR027-ENF-CSTM-ENTR-ID                                 
152400                                 TO TR241-DATA-VALUE                      
152500              PERFORM 6101-ERROR-2                                        
152600           END-IF                                                         
152700        END-IF                                                            
152800*       *********************************************                     
152900*       *              CHANGE ENF                   *                     
153000*       *********************************************                     
153100        IF TR027-ENF-TRN-TYP = 'C'                                        
153200*          ******************************************                     
153300*          * IF FILED TIMESTAMP CHANGED - MOVE THE  *                     
153400*          * DATA AND SET GOOD CHANGE SWITCH.       *                     
153500*          ******************************************                     
153600           IF IMCSEN-FILD-TMST = PV-FORMAT-TMST                           
153700              CONTINUE                                                    
153800           ELSE                                                           
153900              MOVE PV-FORMAT-TMST TO IMCSEN-FILD-TMST                     
154000              SET PS-GOOD-ENF-CHANGE    TO TRUE                           
154100           END-IF                                                         
154200*          ******************************************                     
154300*          * IF VALID TRIP TYPE & IT CHANGED, MOVE  *                     
154400*          * DATA AND SET GOOD CHANGE TO TRUE.      *                     
154500*          ******************************************                     
154600           IF TR027-ENF-MOM-TRIP-TYP-VALID                                
154700             IF IMCSEN-MOM-TRIP-TYP-CDE =                                 
154800                                  TR027-ENF-MOM-TRIP-TYP-CDE              
154900                CONTINUE                                                  
155000             ELSE                                                         
155100                MOVE TR027-ENF-MOM-TRIP-TYP-CDE                           
155200                               TO IMCSEN-MOM-TRIP-TYP-CDE                 
155300                SET PS-GOOD-ENF-CHANGE    TO TRUE                         
155400             END-IF                                                       
155500           END-IF                                                         
155600*          ******************************************                     
155700*          * IF ENTRY TYPE CODE DESCRIPTION NOT =   *                     
155800*          * SPACES, IT MEANS THE CODE IS VALID, SO *                     
155900*          * IF ENTRY TYPE = CODE CHANGED ON TABLE  *                     
156000*          * MOVE THE DATA AND SET GOOD CHG SWITCH. *                     
156100*          ******************************************                     
156200           IF TR027-ENF-ENTR-TYP-DESC  = SPACES                           
156300              CONTINUE                                                    
156400           ELSE                                                           
156500             IF IMCSEN-ENTR-TYP-CDE =                                     
156600                                 TR027-ENF-ENTR-TYP-CDE                   
156700                CONTINUE                                                  
156800             ELSE                                                         
156900                MOVE TR027-ENF-ENTR-TYP-CDE                               
157000                                    TO IMCSEN-ENTR-TYP-CDE                
157100                SET PS-GOOD-ENF-ADD     TO TRUE                           
157200             END-IF                                                       
157300           END-IF                                                         
157400*          *********************************************                  
157500*          * IF ANY CHANGES WERE OK, WRITE A DETAIL    *                  
157600*          * REPORT LINE AND SET SOME SWITCHES.        *                  
157700*          *********************************************                  
157800           IF PS-GOOD-ENF-CHANGE                                          
157900              IF PS-INSERT-TIMCSEN                                        
158000                 CONTINUE                                                 
158100              ELSE                                                        
158200                 SET PS-UPDATE-TIMCSEN TO TRUE                            
158300              END-IF                                                      
158400              PERFORM 6128-CLEAR-ERROR-FIELDS                             
158500              MOVE 'D' TO TR241-RPT-TYP                                   
158600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
158700           ELSE                                                           
158800              MOVE 'ENTRY FILD DATA'                                      
158900                                 TO TR241-DATA-IN-ERROR                   
159000              MOVE TR027-ENF-CSTM-ENTR-ID                                 
159100                                 TO TR241-DATA-VALUE                      
159200              PERFORM 6101-ERROR-2                                        
159300           END-IF                                                         
159400        END-IF                                                            
159500*       *********************************************                     
159600*       *              DELETE ENF                   *                     
159700*       *********************************************                     
159800        IF TR027-ENF-TRN-TYP = 'D'                                        
159900           SET PS-DELETE-TIMCSEN TO TRUE                                  
160000           MOVE PV-HOLD-ENTRY-ID TO                                       
160100                PV-HOLD-ENTR-ID-FOR-CNPO-UPD                              
160200           PERFORM 2060-DELETE-SUBORDINATE-TABLES                         
160300           PERFORM 6128-CLEAR-ERROR-FIELDS                                
160400           MOVE 'D' TO TR241-RPT-TYP                                      
160500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
160600           PERFORM 7605-SCM-CSTM-DELETED-MSG                              
160700           SET PS-EVERYTHING-GONE TO TRUE                                 
160800        END-IF                                                            
160900*    **********************************************                       
161000*    *          TIMCSEN ROW NOT AVAILABLE         *                       
161100*    **********************************************                       
161200     ELSE                                                                 
161300        IF TR027-ENF-TRN-TYP = 'A'                                        
161400           PERFORM 5500-CREATE-TIMCSEN                                    
161500           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
161600           PERFORM 6128-CLEAR-ERROR-FIELDS                                
161700           MOVE 'D' TO TR241-RPT-TYP                                      
161800           PERFORM 7100-INSERT-TOUTTRA-RPT                                
161900           SET PS-TIMCSEN-AVAIL TO TRUE                                   
162000        END-IF                                                            
162100        IF TR027-ENF-TRN-TYP = 'C'                                        
162200           PERFORM 5500-CREATE-TIMCSEN                                    
162300           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
162400           SET PS-TIMCSEN-AVAIL TO TRUE                                   
162500           PERFORM 6128-CLEAR-ERROR-FIELDS                                
162600           MOVE 'D' TO TR241-RPT-TYP                                      
162700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
162800           PERFORM 6102-ERROR-3                                           
162900           PERFORM 7100-INSERT-TOUTTRA-RPT                                
163000        END-IF                                                            
163100        IF TR027-ENF-TRN-TYP = 'D'                                        
163200           PERFORM 6103-ERROR-4                                           
163300           PERFORM 7100-INSERT-TOUTTRA-RPT                                
163400        END-IF                                                            
163500     END-IF.                                                              
163600******************************************************************        
163700* PROCESS ENFBOL.                                                         
163800******************************************************************        
163900* IF TIMCSBL AVAILABLE                                                    
164000*    PREPARE FOR AUDIT                                                    
164100* IF TIMCSEN AVAILABLE                                                    
164200*    IF ADD TRANSACTION                                                   
164300*       IF TIMCSBL AVAILABLE                                              
164400*          ERROR                                                          
164500*       ELSE                                                              
164600*          CREATE TIMCSBL                                                 
164700*          PREPARE FOR AUDIT                                              
164800*          SET PROCESS SW                                                 
164900*          WRITE DETAIL                                                   
165000*    IF CHG TRANSACTION                                                   
165100*       IF TIMCSBL AVAILABLE                                              
165200*          ERROR                                                          
165300*       ELSE                                                              
165400*          CREATE TIMCSBL                                                 
165500*          PREPARE FOR AUDIT                                              
165600*          SET PROCESS SW                                                 
165700*          WRITE DETAIL                                                   
165800*    IF DEL TRANSACTION                                                   
165900*       IF TIMCSBL AVAILABLE                                              
166000*          SET PROCESS SW                                                 
166100*          WRITE DETAIL                                                   
166200*       ELSE                                                              
166300*          IF ALREADY DELETED                                             
166400*             CONTINUE                                                    
166500*          ELSE                                                           
166600*             ERROR                                                       
166700* ELSE                                                                    
166800*    IF ADD TRANSACTION                                                   
166900*       CREATE TIMCSEN                                                    
167000*       IF TIMCSBL AVAILABLE                                              
167100*          ERROR                                                          
167200*       ELSE                                                              
167300*          CREATE TIMCSBL                                                 
167400*          PREPARE FOR AUDIT                                              
167500*          SET PROCESS SW                                                 
167600*          WRITE DETAIL                                                   
167700*    IF CHG TRANSACTION                                                   
167800*       CREATE TIMCSEN                                                    
167900*       IF TIMCSBL AVAILABLE                                              
168000*          ERROR                                                          
168100*       ELSE                                                              
168200*          CREATE TIMCSBL                                                 
168300*          PREPARE FOR AUDIT                                              
168400*          SET PROCESS SW                                                 
168500*          WRITE DETAIL                                                   
168600*    IF DEL TRANSACTION                                                   
168700*       IF TIMCSBL AVAILABLE                                              
168800*          SET PROCESS SW                                                 
168900*          WRITE DETAIL                                                   
169000*       ELSE                                                              
169100*          IF ALREADY DELETED                                             
169200*             CONTINUE                                                    
169300*          ELSE                                                           
169400*             ERROR                                                       
169500******************************************************************        
169600 2015-PROCESS-ENFBOL.                                                     
169700                                                                          
169800     IF PS-TIMCSBL-AVAIL                                                  
169900        CONTINUE                                                          
170000     ELSE                                                                 
170100        PERFORM 7150-SELECT-TIMCSBL                                       
170200        IF PS-TIMCSBL-AVAIL                                               
170300           PERFORM 5200-MOVE-TIMCSBL-TO-TAUCSBL                           
170400        END-IF                                                            
170500     END-IF.                                                              
170600     IF PS-TIMCSEN-AVAIL                                                  
170700        IF TR027-ENFBOL-TRN-TYP = 'A'                                     
170800           IF PS-TIMCSBL-AVAIL                                            
170900              PERFORM 6106-ERROR-7                                        
171000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
171100           ELSE                                                           
171200              PERFORM 5510-CREATE-TIMCSBL                                 
171300              PERFORM 5200-MOVE-TIMCSBL-TO-TAUCSBL                        
171400              PERFORM 6128-CLEAR-ERROR-FIELDS                             
171500              MOVE 'D' TO TR241-RPT-TYP                                   
171600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
171700           END-IF                                                         
171800        END-IF                                                            
171900        IF TR027-ENF-TRN-TYP = 'C'                                        
172000           IF PS-TIMCSBL-AVAIL                                            
172100              PERFORM 6108-ERROR-9                                        
172200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
172300           ELSE                                                           
172400              PERFORM 6115-ERROR-16                                       
172500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
172600              PERFORM 5510-CREATE-TIMCSBL                                 
172700              PERFORM 5200-MOVE-TIMCSBL-TO-TAUCSBL                        
172800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
172900              MOVE 'D' TO TR241-RPT-TYP                                   
173000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
173100           END-IF                                                         
173200        END-IF                                                            
173300        IF TR027-ENF-TRN-TYP = 'D'                                        
173400           IF PS-TIMCSBL-AVAIL                                            
173500              SET PS-DELETE-TIMCSBL TO TRUE                               
173600              PERFORM 6128-CLEAR-ERROR-FIELDS                             
173700              MOVE 'D' TO TR241-RPT-TYP                                   
173800              PERFORM 7100-INSERT-TOUTTRA-RPT                             
173900           ELSE                                                           
174000              IF PS-EVERYTHING-GONE                                       
174100                 CONTINUE                                                 
174200              ELSE                                                        
174300                 PERFORM 6107-ERROR-8                                     
174400                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
174500              END-IF                                                      
174600           END-IF                                                         
174700        END-IF                                                            
174800     ELSE                                                                 
174900        IF TR027-ENFBOL-TRN-TYP = 'A'                                     
175000           PERFORM 5500-CREATE-TIMCSEN                                    
175100           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
175200           SET PS-TIMCSEN-AVAIL TO TRUE                                   
175300           IF PS-TIMCSBL-AVAIL                                            
175400              PERFORM 6106-ERROR-7                                        
175500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
175600           ELSE                                                           
175700              PERFORM 5510-CREATE-TIMCSBL                                 
175800              PERFORM 5200-MOVE-TIMCSBL-TO-TAUCSBL                        
175900              PERFORM 6128-CLEAR-ERROR-FIELDS                             
176000              MOVE 'D' TO TR241-RPT-TYP                                   
176100              PERFORM 7100-INSERT-TOUTTRA-RPT                             
176200              PERFORM 6104-ERROR-5                                        
176300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
176400           END-IF                                                         
176500        END-IF                                                            
176600        IF TR027-ENF-TRN-TYP = 'C'                                        
176700           PERFORM 5500-CREATE-TIMCSEN                                    
176800           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
176900           SET PS-TIMCSEN-AVAIL TO TRUE                                   
177000           IF PS-TIMCSBL-AVAIL                                            
177100              PERFORM 6108-ERROR-9                                        
177200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
177300           ELSE                                                           
177400              PERFORM 6115-ERROR-16                                       
177500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
177600              PERFORM 5510-CREATE-TIMCSBL                                 
177700              PERFORM 5200-MOVE-TIMCSBL-TO-TAUCSBL                        
177800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
177900              MOVE 'D' TO TR241-RPT-TYP                                   
178000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
178100              PERFORM 6104-ERROR-5                                        
178200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
178300           END-IF                                                         
178400        END-IF                                                            
178500        IF TR027-ENF-TRN-TYP = 'D'                                        
178600           IF PS-TIMCSBL-AVAIL                                            
178700              SET PS-DELETE-TIMCSBL TO TRUE                               
178800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
178900              MOVE 'D' TO TR241-RPT-TYP                                   
179000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
179100           ELSE                                                           
179200              IF PS-EVERYTHING-GONE                                       
179300                 CONTINUE                                                 
179400              ELSE                                                        
179500                 PERFORM 6107-ERROR-8                                     
179600                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
179700              END-IF                                                      
179800           END-IF                                                         
179900        END-IF                                                            
180000     END-IF.                                                              
180100******************************************************************        
180200* PROCESS ENFCON.                                                         
180300******************************************************************        
180400* IF TIMCSCN AVAILABLE                                                    
180500*    PREPARE FOR AUDIT                                                    
180600* IF TIMCSEN AVAILABLE                                                    
180700*    IF ADD TRANSACTION                                                   
180800*       IF TIMCSCN AVAILABLE                                              
180900*          ERROR                                                          
181000*       ELSE                                                              
181100*          CREATE TIMCSCN                                                 
181200*          PREPARE FOR AUDIT                                              
181300*          SET PROCESS SW                                                 
181400*          WRITE DETAIL                                                   
181500*    IF CHG TRANSACTION                                                   
181600*       IF TIMCSCN AVAILABLE                                              
181700*          ERROR                                                          
181800*       ELSE                                                              
181900*          CREATE TIMCSCN                                                 
182000*          PREPARE FOR AUDIT                                              
182100*          SET PROCESS SW                                                 
182200*          WRITE DETAIL                                                   
182300*    IF DEL TRANSACTION                                                   
182400*       IF TIMCSCN AVAILABLE                                              
182500*          SET PROCESS SW                                                 
182600*          WRITE DETAIL                                                   
182700*       ELSE                                                              
182800*          IF ALREADY DELETED                                             
182900*             CONTINUE                                                    
183000*          ELSE                                                           
183100*             ERROR                                                       
183200* ELSE                                                                    
183300*    IF ADD TRANSACTION                                                   
183400*       CREATE TIMCSEN                                                    
183500*       IF TIMCSCN AVAILABLE                                              
183600*          ERROR                                                          
183700*       ELSE                                                              
183800*          CREATE TIMCSCN                                                 
183900*          PREPARE FOR AUDIT                                              
184000*          SET PROCESS SW                                                 
184100*          WRITE DETAIL                                                   
184200*    IF CHG TRANSACTION                                                   
184300*       CREATE TIMCSEN                                                    
184400*       IF TIMCSCN AVAILABLE                                              
184500*          ERROR                                                          
184600*       ELSE                                                              
184700*          CREATE TIMCSCN                                                 
184800*          PREPARE FOR AUDIT                                              
184900*          SET PROCESS SW                                                 
185000*          WRITE DETAIL                                                   
185100*    IF DEL TRANSACTION                                                   
185200*       IF TIMCSCN AVAILABLE                                              
185300*          SET PROCESS SW                                                 
185400*          WRITE DETAIL                                                   
185500*       ELSE                                                              
185600*          IF ALREADY DELETED                                             
185700*             CONTINUE                                                    
185800*          ELSE                                                           
185900*             ERROR                                                       
186000******************************************************************        
186100 2020-PROCESS-ENFCON.                                                     
186200                                                                          
186300     IF PS-TIMCSCN-AVAIL                                                  
186400        CONTINUE                                                          
186500     ELSE                                                                 
186600        PERFORM 7160-SELECT-TIMCSCN                                       
186700        IF PS-TIMCSCN-AVAIL                                               
186800           PERFORM 5300-MOVE-TIMCSCN-TO-TAUCSCN                           
186900        END-IF                                                            
187000     END-IF.                                                              
187100                                                                          
187200     IF PS-TIMCSEN-AVAIL                                                  
187300        IF TR027-ENFCON-TRN-TYP = 'A'                                     
187400           IF PS-TIMCSCN-AVAIL                                            
187500              PERFORM 6109-ERROR-10                                       
187600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
187700           ELSE                                                           
187800              MOVE TR027-ENFCON-CSTM-ENTR-ID                              
187900                          TO IMCSCN-CSTM-ENTR-ID                          
188000              MOVE TR027-ENFCON-CONTNR-ID                                 
188100                          TO IMCSCN-CONTNR-ID                             
188200              MOVE PC-DEFAULT-TMST                                        
188300                          TO IMCSCN-DO-TO-DCONSLR-TMST                    
188400              PERFORM 5520-CREATE-AND-REPORT-TIMCSCN                      
188500           END-IF                                                         
188600        END-IF                                                            
188700        IF TR027-ENF-TRN-TYP = 'C'                                        
188800           IF PS-TIMCSCN-AVAIL                                            
188900              PERFORM 6111-ERROR-12                                       
189000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
189100           ELSE                                                           
189200              PERFORM 6117-ERROR-18                                       
189300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
189400              MOVE TR027-ENFCON-CSTM-ENTR-ID                              
189500                          TO IMCSCN-CSTM-ENTR-ID                          
189600              MOVE TR027-ENFCON-CONTNR-ID                                 
189700                          TO IMCSCN-CONTNR-ID                             
189800              PERFORM 5520-CREATE-AND-REPORT-TIMCSCN                      
189900           END-IF                                                         
190000        END-IF                                                            
190100        IF TR027-ENF-TRN-TYP = 'D'                                        
190200           IF PS-TIMCSCN-AVAIL                                            
190300              SET PS-DELETE-TIMCSCN TO TRUE                               
190400              PERFORM 6128-CLEAR-ERROR-FIELDS                             
190500              MOVE 'D' TO TR241-RPT-TYP                                   
190600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
190700           ELSE                                                           
190800              IF PS-EVERYTHING-GONE                                       
190900                 CONTINUE                                                 
191000              ELSE                                                        
191100                 PERFORM 6110-ERROR-11                                    
191200                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
191300              END-IF                                                      
191400           END-IF                                                         
191500        END-IF                                                            
191600     ELSE                                                                 
191700        IF TR027-ENFCON-TRN-TYP = 'A'                                     
191800           PERFORM 5500-CREATE-TIMCSEN                                    
191900           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
192000           SET PS-TIMCSEN-AVAIL TO TRUE                                   
192100           IF PS-TIMCSCN-AVAIL                                            
192200              PERFORM 6109-ERROR-10                                       
192300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
192400           ELSE                                                           
192500              MOVE TR027-ENFCON-CSTM-ENTR-ID                              
192600                          TO IMCSCN-CSTM-ENTR-ID                          
192700              MOVE TR027-ENFCON-CONTNR-ID                                 
192800                          TO IMCSCN-CONTNR-ID                             
192900              MOVE PC-DEFAULT-TMST                                        
193000                          TO IMCSCN-DO-TO-DCONSLR-TMST                    
193100              PERFORM 5520-CREATE-AND-REPORT-TIMCSCN                      
193200              PERFORM 6104-ERROR-5                                        
193300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
193400           END-IF                                                         
193500        END-IF                                                            
193600        IF TR027-ENF-TRN-TYP = 'C'                                        
193700           PERFORM 5500-CREATE-TIMCSEN                                    
193800           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
193900           SET PS-TIMCSEN-AVAIL TO TRUE                                   
194000           IF PS-TIMCSCN-AVAIL                                            
194100              PERFORM 6111-ERROR-12                                       
194200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
194300           ELSE                                                           
194400              PERFORM 6117-ERROR-18                                       
194500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
194600              MOVE TR027-ENFCON-CSTM-ENTR-ID                              
194700                          TO IMCSCN-CSTM-ENTR-ID                          
194800              MOVE TR027-ENFCON-CONTNR-ID                                 
194900                          TO IMCSCN-CONTNR-ID                             
195000              PERFORM 5520-CREATE-AND-REPORT-TIMCSCN                      
195100              PERFORM 6104-ERROR-5                                        
195200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
195300           END-IF                                                         
195400        END-IF                                                            
195500        IF TR027-ENF-TRN-TYP = 'D'                                        
195600           IF PS-TIMCSCN-AVAIL                                            
195700              SET PS-DELETE-TIMCSCN TO TRUE                               
195800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
195900              MOVE 'D' TO TR241-RPT-TYP                                   
196000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
196100           ELSE                                                           
196200              IF PS-EVERYTHING-GONE                                       
196300                 CONTINUE                                                 
196400              ELSE                                                        
196500                 PERFORM 6110-ERROR-11                                    
196600                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
196700              END-IF                                                      
196800           END-IF                                                         
196900        END-IF                                                            
197000     END-IF.                                                              
197100******************************************************************        
197200 2023-PROCESS-DOP.                                                        
197300                                                                          
197400     IF PS-TIMCSCN-AVAIL                                                  
197500        CONTINUE                                                          
197600     ELSE                                                                 
197700        PERFORM 7160-SELECT-TIMCSCN                                       
197800        IF PS-TIMCSCN-AVAIL                                               
197900           PERFORM 5300-MOVE-TIMCSCN-TO-TAUCSCN                           
198000        END-IF                                                            
198100     END-IF.                                                              
198200                                                                          
198300     IF TR027-ENFCON-TRN-TYP = 'A'                                        
198400        IF PS-TIMCSCN-AVAIL                                               
198500          IF IMCSCN-DO-TO-DCONSLR-TMST = PC-DEFAULT-TMST                  
198600              MOVE PV-FORMAT-TMST  TO IMCSCN-DO-TO-DCONSLR-TMST           
198700              IF PS-INSERT-TIMCSCN                                        
198800                 CONTINUE                                                 
198900              ELSE                                                        
199000                 SET PS-UPDATE-TIMCSCN TO TRUE                            
199100              END-IF                                                      
199200              PERFORM 6128-CLEAR-ERROR-FIELDS                             
199300              MOVE 'D' TO TR241-RPT-TYP                                   
199400              PERFORM 7100-INSERT-TOUTTRA-RPT                             
199500          ELSE                                                            
199600             PERFORM 6131-ERROR-31                                        
199700             PERFORM 7100-INSERT-TOUTTRA-RPT                              
199800          END-IF                                                          
199900        ELSE                                                              
200000           PERFORM 6132-ERROR-32                                          
200100           PERFORM 7100-INSERT-TOUTTRA-RPT                                
200200***        MOVE PV-FORMAT-TMST   TO IMCSCN-DO-TO-DCONSLR-TMST             
200300***        MOVE TR027-DOP-CSTM-ENTR-ID                                    
200400***                              TO IMCSCN-CSTM-ENTR-ID                   
200500***        MOVE TR027-DOP-CONTNR-ID                                       
200600***                              TO IMCSCN-CONTNR-ID                      
200700***        PERFORM 5520-CREATE-AND-REPORT-TIMCSCN                         
200800        END-IF                                                            
200900     END-IF.                                                              
201000                                                                          
201100     IF TR027-ENFCON-TRN-TYP = 'C'                                        
201200        IF PS-TIMCSCN-AVAIL                                               
201300          IF IMCSCN-DO-TO-DCONSLR-TMST   NOT =   PV-FORMAT-TMST           
201400             MOVE PV-FORMAT-TMST   TO IMCSCN-DO-TO-DCONSLR-TMST           
201500              IF PS-INSERT-TIMCSEN                                        
201600                 CONTINUE                                                 
201700              ELSE                                                        
201800                 SET PS-UPDATE-TIMCSCN TO TRUE                            
201900              END-IF                                                      
202000              PERFORM 6128-CLEAR-ERROR-FIELDS                             
202100              MOVE 'D' TO TR241-RPT-TYP                                   
202200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
202300          ELSE                                                            
202400             PERFORM 6134-ERROR-34                                        
202500             PERFORM 7100-INSERT-TOUTTRA-RPT                              
202600          END-IF                                                          
202700        ELSE                                                              
202800           PERFORM 6133-ERROR-33                                          
202900           PERFORM 7100-INSERT-TOUTTRA-RPT                                
203000***        MOVE PV-FORMAT-TMST   TO IMCSCN-DO-TO-DCONSLR-TMST             
203100***        MOVE TR027-DOP-CSTM-ENTR-ID                                    
203200***                              TO IMCSCN-CSTM-ENTR-ID                   
203300***        MOVE TR027-DOP-CONTNR-ID                                       
203400***                              TO IMCSCN-CONTNR-ID                      
203500***        PERFORM 5520-CREATE-AND-REPORT-TIMCSCN                         
203600        END-IF                                                            
203700     END-IF.                                                              
203800                                                                          
203900     IF TR027-ENFCON-TRN-TYP = 'D'                                        
204000        IF PS-TIMCSCN-AVAIL                                               
204100          IF IMCSCN-DO-TO-DCONSLR-TMST  =  PC-DEFAULT-TMST                
204200             PERFORM 6135-ERROR-35                                        
204300             PERFORM 7100-INSERT-TOUTTRA-RPT                              
204400          ELSE                                                            
204500             MOVE PC-DEFAULT-TMST  TO IMCSCN-DO-TO-DCONSLR-TMST           
204600              IF PS-INSERT-TIMCSCN                                        
204700                 CONTINUE                                                 
204800              ELSE                                                        
204900                 SET PS-UPDATE-TIMCSCN TO TRUE                            
205000              END-IF                                                      
205100              PERFORM 6128-CLEAR-ERROR-FIELDS                             
205200              MOVE 'D' TO TR241-RPT-TYP                                   
205300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
205400          END-IF                                                          
205500        ELSE                                                              
205600           IF PS-EVERYTHING-GONE                                          
205700            OR PS-DELETE-TIMCSCN                                          
205800              CONTINUE                                                    
205900           ELSE                                                           
206000              PERFORM 6110-ERROR-11                                       
206100              PERFORM 7100-INSERT-TOUTTRA-RPT                             
206200           END-IF                                                         
206300        END-IF                                                            
206400     END-IF.                                                              
206500******************************************************************        
206600* PROCESS ENFPO.                                                          
206700******************************************************************        
206800* IF TIMCSPO AVAILABLE                                                    
206900*    PREPARE FOR AUDIT                                                    
207000* IF TIMCSEN AVAILABLE                                                    
207100*    IF ADD TRANSACTION                                                   
207200*       IF TIMCSPO AVAILABLE                                              
207300*          ERROR                                                          
207400*       ELSE                                                              
207500*          CREATE TIMCSPO                                                 
207600*          PREPARE FOR AUDIT                                              
207700*          SET PROCESS SW                                                 
207800*          WRITE DETAIL                                                   
207900*    IF CHG TRANSACTION                                                   
208000*       IF TIMCSPO AVAILABLE                                              
208100*          ERROR                                                          
208200*       ELSE                                                              
208300*          CREATE TIMCSPO                                                 
208400*          PREPARE FOR AUDIT                                              
208500*          SET PROCESS SW                                                 
208600*          WRITE DETAIL                                                   
208700*    IF DEL TRANSACTION                                                   
208800*       IF TIMCSPO AVAILABLE                                              
208900*          SET PROCESS SW                                                 
209000*          WRITE DETAIL                                                   
209100*       ELSE                                                              
209200*          IF ALREADY DELETED                                             
209300*             CONTINUE                                                    
209400*          ELSE                                                           
209500*             ERROR                                                       
209600* ELSE                                                                    
209700*    IF ADD TRANSACTION                                                   
209800*       CREATE TIMCSEN                                                    
209900*       IF TIMCSPO AVAILABLE                                              
210000*          ERROR                                                          
210100*       ELSE                                                              
210200*          CREATE TIMCSPO                                                 
210300*          PREPARE FOR AUDIT                                              
210400*          SET PROCESS SW                                                 
210500*          WRITE DETAIL                                                   
210600*    IF CHG TRANSACTION                                                   
210700*       CREATE TIMCSEN                                                    
210800*       IF TIMCSPO AVAILABLE                                              
210900*          ERROR                                                          
211000*       ELSE                                                              
211100*          CREATE TIMCSPO                                                 
211200*          PREPARE FOR AUDIT                                              
211300*          SET PROCESS SW                                                 
211400*          WRITE DETAIL                                                   
211500*    IF DEL TRANSACTION                                                   
211600*       IF TIMCSPO AVAILABLE                                              
211700*          SET PROCESS SW                                                 
211800*          WRITE DETAIL                                                   
211900*       ELSE                                                              
212000*          IF ALREADY DELETED                                             
212100*             CONTINUE                                                    
212200*          ELSE                                                           
212300*             ERROR                                                       
212400******************************************************************        
212500 2025-PROCESS-ENFPO.                                                      
212600     MOVE TR027-ENFPO-PO-NBR TO PURCHS-PO-NBR.                            
212700     PERFORM 7190-SELECT-TPURCHS.                                         
212800     IF PS-PO-NOT-AVAIL                                                   
212900        PERFORM 6124-ERROR-25                                             
213000        PERFORM 7100-INSERT-TOUTTRA-RPT                                   
213100     END-IF.                                                              
213200     IF PS-PO-NOT-FOUND                                                   
213300        PERFORM 6125-ERROR-26                                             
213400        PERFORM 7100-INSERT-TOUTTRA-RPT                                   
213500     END-IF.                                                              
213600                                                                          
213700     PERFORM 7170-SELECT-TIMCSPO                                          
213800     IF PS-TIMCSPO-AVAIL                                                  
213900        PERFORM 5400-MOVE-TIMCSPO-TO-TAUCSPO                              
214000     END-IF.                                                              
214100                                                                          
214200     IF PS-TIMCSEN-AVAIL                                                  
214300        IF TR027-ENFPO-TRN-TYP = 'A'                                      
214400           IF PS-TIMCSPO-AVAIL                                            
214500              PERFORM 6112-ERROR-13                                       
214600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
214700           ELSE                                                           
214800              PERFORM 5530-CREATE-TIMCSPO                                 
214900              PERFORM 5400-MOVE-TIMCSPO-TO-TAUCSPO                        
215000              PERFORM 6128-CLEAR-ERROR-FIELDS                             
215100              MOVE 'D' TO TR241-RPT-TYP                                   
215200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
215300              PERFORM 7520-SCM-PROCESS-ENFPO-ADD                          
215400           END-IF                                                         
215500        END-IF                                                            
215600        IF TR027-ENF-TRN-TYP = 'C'                                        
215700           IF PS-TIMCSPO-AVAIL                                            
215800              PERFORM 6114-ERROR-15                                       
215900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
216000           ELSE                                                           
216100              PERFORM 6116-ERROR-17                                       
216200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
216300              PERFORM 5530-CREATE-TIMCSPO                                 
216400              PERFORM 5400-MOVE-TIMCSPO-TO-TAUCSPO                        
216500              PERFORM 6128-CLEAR-ERROR-FIELDS                             
216600              MOVE 'D' TO TR241-RPT-TYP                                   
216700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
216800* THIS IS REALLY AN ADD NOT A CHANGE                                      
216900              PERFORM 7520-SCM-PROCESS-ENFPO-ADD                          
217000           END-IF                                                         
217100        END-IF                                                            
217200        IF TR027-ENF-TRN-TYP = 'D'                                        
217300           IF PS-TIMCSPO-AVAIL                                            
217400              SET PS-DELETE-TIMCSPO TO TRUE                               
217500              PERFORM 6128-CLEAR-ERROR-FIELDS                             
217600              MOVE 'D' TO TR241-RPT-TYP                                   
217700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
217800              PERFORM 7610-DEL-SCM-CUSTOMS-FILED-MSG                      
217900           ELSE                                                           
218000              IF PS-EVERYTHING-GONE                                       
218100                 CONTINUE                                                 
218200              ELSE                                                        
218300                 PERFORM 6113-ERROR-14                                    
218400                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
218500              END-IF                                                      
218600           END-IF                                                         
218700        END-IF                                                            
218800     ELSE                                                                 
218900        IF TR027-ENFPO-TRN-TYP = 'A'                                      
219000           PERFORM 5500-CREATE-TIMCSEN                                    
219100           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
219200           SET PS-TIMCSEN-AVAIL TO TRUE                                   
219300           IF PS-TIMCSPO-AVAIL                                            
219400              PERFORM 6112-ERROR-13                                       
219500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
219600           ELSE                                                           
219700              PERFORM 5530-CREATE-TIMCSPO                                 
219800              PERFORM 5400-MOVE-TIMCSPO-TO-TAUCSPO                        
219900              PERFORM 6128-CLEAR-ERROR-FIELDS                             
220000              MOVE 'D' TO TR241-RPT-TYP                                   
220100              PERFORM 7100-INSERT-TOUTTRA-RPT                             
220200              PERFORM 6104-ERROR-5                                        
220300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
220400              PERFORM 7520-SCM-PROCESS-ENFPO-ADD                          
220500           END-IF                                                         
220600        END-IF                                                            
220700        IF TR027-ENF-TRN-TYP = 'C'                                        
220800           PERFORM 5500-CREATE-TIMCSEN                                    
220900           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
221000           SET PS-TIMCSEN-AVAIL TO TRUE                                   
221100           IF PS-TIMCSPO-AVAIL                                            
221200              PERFORM 6114-ERROR-15                                       
221300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
221400           ELSE                                                           
221500              PERFORM 6116-ERROR-17                                       
221600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
221700              PERFORM 5530-CREATE-TIMCSPO                                 
221800              PERFORM 5400-MOVE-TIMCSPO-TO-TAUCSPO                        
221900              PERFORM 6128-CLEAR-ERROR-FIELDS                             
222000              MOVE 'D' TO TR241-RPT-TYP                                   
222100              PERFORM 7100-INSERT-TOUTTRA-RPT                             
222200              PERFORM 6104-ERROR-5                                        
222300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
222400* THIS IS REALLY AN ADD                                                   
222500              PERFORM 7520-SCM-PROCESS-ENFPO-ADD                          
222600           END-IF                                                         
222700        END-IF                                                            
222800        IF TR027-ENF-TRN-TYP = 'D'                                        
222900           IF PS-TIMCSPO-AVAIL                                            
223000              SET PS-DELETE-TIMCSPO TO TRUE                               
223100              PERFORM 6128-CLEAR-ERROR-FIELDS                             
223200              MOVE 'D' TO TR241-RPT-TYP                                   
223300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
223400              PERFORM 7610-DEL-SCM-CUSTOMS-FILED-MSG                      
223500           ELSE                                                           
223600              IF PS-EVERYTHING-GONE                                       
223700                 CONTINUE                                                 
223800              ELSE                                                        
223900                 PERFORM 6113-ERROR-14                                    
224000                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
224100              END-IF                                                      
224200           END-IF                                                         
224300        END-IF                                                            
224400     END-IF.                                                              
224500******************************************************************        
224600* PROCESS EXD                                                             
224700******************************************************************        
224800* IF TIMCSEN AVAILABLE                                                    
224900*    IF ADD TRANSACTION                                                   
225000*       IF EXM-TMST IS DEFAULT TMST                                       
225100*          MOVE TMST TO EXM-TMST                                          
225200*          WRITE DETAIL                                                   
225300*          SET PROCESS SW                                                 
225400*       ELSE                                                              
225500*          ERROR                                                          
225600*    IF CHG TRANSACTION                                                   
225700*       IF EXM-TMST = INPUT RECORD                                        
225800*          ERROR                                                          
225900*       ELSE                                                              
226000*          MOVE TMST TO EXM-TMST                                          
226100*          WRITE DETAIL                                                   
226200*          SET PROCESS SW                                                 
226300*    IF DEL TRANSACTION                                                   
226400*       SET PROCESS SW                                                    
226500*       WRITE DETAIL                                                      
226600*       IF ALL TMSTS DEFAULT                                              
226700*          DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                     
226800*          ERROR                                                          
226900* ELSE                                                                    
227000*    IF ADD TRANSACTION                                                   
227100*       CREATE TIMCSEN                                                    
227200*       PREPARE FOR AUDIT                                                 
227300*       SET PROCESS SW                                                    
227400*       WRITE DETAIL                                                      
227500*       ERROR                                                             
227600*    IF CHG TRANSACTION                                                   
227700*       CREATE TIMCSEN                                                    
227800*       SET PROCESS SW                                                    
227900*       WRITE DETAIL                                                      
228000*       ERROR                                                             
228100*    IF DEL TRANSACTION                                                   
228200*       IF ALREADY DELETED                                                
228300*          CONTINUE                                                       
228400*       ELSE                                                              
228500*          ERROR                                                          
228600******************************************************************        
228700 2030-PROCESS-EXD.                                                        
228800                                                                          
228900     IF PS-TIMCSEN-AVAIL                                                  
229000        IF TR027-EXD-TRN-TYP = 'A'                                        
229100           IF IMCSEN-EXM-TMST = PC-DEFAULT-TMST                           
229200              MOVE PV-FORMAT-TMST TO IMCSEN-EXM-TMST                      
229300              IF PS-INSERT-TIMCSEN                                        
229400                 CONTINUE                                                 
229500              ELSE                                                        
229600                 SET PS-UPDATE-TIMCSEN TO TRUE                            
229700              END-IF                                                      
229800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
229900              MOVE 'D' TO TR241-RPT-TYP                                   
230000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
230100           ELSE                                                           
230200              PERFORM 6118-ERROR-19                                       
230300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
230400           END-IF                                                         
230500        END-IF                                                            
230600        IF TR027-EXD-TRN-TYP = 'C'                                        
230700           IF IMCSEN-EXM-TMST = PV-FORMAT-TMST                            
230800              MOVE 'CSTMS EXAM TMST'                                      
230900                                 TO TR241-DATA-IN-ERROR                   
231000              MOVE PV-FORMAT-TMST                                         
231100                                 TO TR241-DATA-VALUE                      
231200              PERFORM 6101-ERROR-2                                        
231300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
231400           ELSE                                                           
231500              MOVE PV-FORMAT-TMST TO IMCSEN-EXM-TMST                      
231600              IF PS-INSERT-TIMCSEN                                        
231700                 CONTINUE                                                 
231800              ELSE                                                        
231900                 SET PS-UPDATE-TIMCSEN TO TRUE                            
232000              END-IF                                                      
232100              PERFORM 6128-CLEAR-ERROR-FIELDS                             
232200              MOVE 'D' TO TR241-RPT-TYP                                   
232300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
232400           END-IF                                                         
232500        END-IF                                                            
232600        IF TR027-EXD-TRN-TYP = 'D'                                        
232700           IF IMCSEN-EXM-TMST = PC-DEFAULT-TMST                           
232800              PERFORM 6105-ERROR-6                                        
232900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
233000           ELSE                                                           
233100              MOVE PC-DEFAULT-TMST TO IMCSEN-EXM-TMST                     
233200              IF PS-INSERT-TIMCSEN                                        
233300                 CONTINUE                                                 
233400              ELSE                                                        
233500                 SET PS-UPDATE-TIMCSEN TO TRUE                            
233600              END-IF                                                      
233700              PERFORM 6128-CLEAR-ERROR-FIELDS                             
233800              MOVE 'D' TO TR241-RPT-TYP                                   
233900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
234000           END-IF                                                         
234100           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST       AND                
234200              IMCSEN-EXM-TMST = PC-DEFAULT-TMST        AND                
234300              IMCSEN-REJ-TMST = PC-DEFAULT-TMST        AND                
234400              IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST    AND                
234500              IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST   AND                
234600              IMCSEN-LQDN-TMST = PC-DEFAULT-TMST       AND                
234700              IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
234800              SET PS-DELETE-TIMCSEN TO TRUE                               
234900              PERFORM 2060-DELETE-SUBORDINATE-TABLES                      
235000              PERFORM 6128-CLEAR-ERROR-FIELDS                             
235100              SET PS-EVERYTHING-GONE TO TRUE                              
235200              PERFORM 6129-ERROR-27                                       
235300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
235400           END-IF                                                         
235500        END-IF                                                            
235600     ELSE                                                                 
235700        IF TR027-EXD-TRN-TYP = 'A'                                        
235800           PERFORM 5500-CREATE-TIMCSEN                                    
235900           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
236000           SET PS-TIMCSEN-AVAIL TO TRUE                                   
236100           PERFORM 6128-CLEAR-ERROR-FIELDS                                
236200           MOVE 'D' TO TR241-RPT-TYP                                      
236300           PERFORM 7100-INSERT-TOUTTRA-RPT                                
236400           PERFORM 6104-ERROR-5                                           
236500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
236600        END-IF                                                            
236700        IF TR027-EXD-TRN-TYP = 'C'                                        
236800           PERFORM 5500-CREATE-TIMCSEN                                    
236900           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
237000           SET PS-TIMCSEN-AVAIL TO TRUE                                   
237100           PERFORM 6128-CLEAR-ERROR-FIELDS                                
237200           MOVE 'D' TO TR241-RPT-TYP                                      
237300           PERFORM 7100-INSERT-TOUTTRA-RPT                                
237400           PERFORM 6102-ERROR-3                                           
237500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
237600        END-IF                                                            
237700        IF TR027-EXD-TRN-TYP = 'D'                                        
237800           IF PS-EVERYTHING-GONE                                          
237900              CONTINUE                                                    
238000           ELSE                                                           
238100              PERFORM 6103-ERROR-4                                        
238200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
238300           END-IF                                                         
238400        END-IF                                                            
238500     END-IF.                                                              
238600******************************************************************        
238700* PROCESS REJ                                                             
238800******************************************************************        
238900* IF TIMCSEN AVAILABLE                                                    
239000*    IF ADD TRANSACTION                                                   
239100*       IF REJ-TMST IS DEFAULT TMST                                       
239200*          MOVE TMST TO REJ-TMST                                          
239300*          MOVE DESC TO REJ-DESC                                          
239400*          WRITE DETAIL                                                   
239500*          SET PROCESS SW                                                 
239600*       ELSE                                                              
239700*          ERROR                                                          
239800*    IF CHG TRANSACTION                                                   
239900*       IF REJ-TMST = INPUT RECORD                                        
240000*          ERROR                                                          
240100*       ELSE                                                              
240200*          MOVE TMST TO REJ-TMST                                          
240300*          MOVE DESC TO REJ-DESC                                          
240400*          WRITE DETAIL                                                   
240500*          SET PROCESS SW                                                 
240600*    IF DEL TRANSACTION                                                   
240700*       SET PROCESS SW                                                    
240800*       WRITE DETAIL                                                      
240900*       IF ALL TMSTS DEFAULT                                              
241000*          DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                     
241100*          ERROR                                                          
241200* ELSE                                                                    
241300*    IF ADD TRANSACTION                                                   
241400*       CREATE TIMCSEN                                                    
241500*       PREPARE FOR AUDIT                                                 
241600*       SET PROCESS SW                                                    
241700*       WRITE DETAIL                                                      
241800*       ERROR                                                             
241900*    IF CHG TRANSACTION                                                   
242000*       CREATE TIMCSEN                                                    
242100*       SET PROCESS SW                                                    
242200*       WRITE DETAIL                                                      
242300*       ERROR                                                             
242400*    IF DEL TRANSACTION                                                   
242500*       IF ALREADY DELETED                                                
242600*          CONTINUE                                                       
242700*       ELSE                                                              
242800*          ERROR                                                          
242900******************************************************************        
243000 2035-PROCESS-REJ.                                                        
243100                                                                          
243200     IF PS-TIMCSEN-AVAIL                                                  
243300        IF TR027-REJ-TRN-TYP = 'A'                                        
243400           IF IMCSEN-REJ-TMST = PC-DEFAULT-TMST                           
243500              MOVE PV-FORMAT-TMST TO IMCSEN-REJ-TMST                      
243600              MOVE TR027-REJ-REJ-DESC TO IMCSEN-REJ-DESC                  
243700              IF PS-INSERT-TIMCSEN                                        
243800                 CONTINUE                                                 
243900              ELSE                                                        
244000                 SET PS-UPDATE-TIMCSEN TO TRUE                            
244100              END-IF                                                      
244200              PERFORM 6128-CLEAR-ERROR-FIELDS                             
244300              MOVE 'D' TO TR241-RPT-TYP                                   
244400              PERFORM 7100-INSERT-TOUTTRA-RPT                             
244500           ELSE                                                           
244600              PERFORM 6119-ERROR-20                                       
244700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
244800           END-IF                                                         
244900        END-IF                                                            
245000        IF TR027-REJ-TRN-TYP = 'C'                                        
245100           IF IMCSEN-REJ-TMST = PV-FORMAT-TMST                            
245200              MOVE 'CSTMS REJ TMST'                                       
245300                                 TO TR241-DATA-IN-ERROR                   
245400              MOVE PV-FORMAT-TMST                                         
245500                                 TO TR241-DATA-VALUE                      
245600              PERFORM 6101-ERROR-2                                        
245700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
245800           ELSE                                                           
245900              MOVE PV-FORMAT-TMST TO IMCSEN-REJ-TMST                      
246000              MOVE TR027-REJ-REJ-DESC TO IMCSEN-REJ-DESC                  
246100              IF PS-INSERT-TIMCSEN                                        
246200                 CONTINUE                                                 
246300              ELSE                                                        
246400                 SET PS-UPDATE-TIMCSEN TO TRUE                            
246500              END-IF                                                      
246600              PERFORM 6128-CLEAR-ERROR-FIELDS                             
246700              MOVE 'D' TO TR241-RPT-TYP                                   
246800              PERFORM 7100-INSERT-TOUTTRA-RPT                             
246900           END-IF                                                         
247000        END-IF                                                            
247100        IF TR027-REJ-TRN-TYP = 'D'                                        
247200           IF IMCSEN-REJ-TMST = PC-DEFAULT-TMST                           
247300              PERFORM 6105-ERROR-6                                        
247400              PERFORM 7100-INSERT-TOUTTRA-RPT                             
247500           ELSE                                                           
247600              MOVE PC-DEFAULT-TMST TO IMCSEN-REJ-TMST                     
247700              MOVE SPACES          TO IMCSEN-REJ-DESC                     
247800              IF PS-INSERT-TIMCSEN                                        
247900                 CONTINUE                                                 
248000              ELSE                                                        
248100                 SET PS-UPDATE-TIMCSEN TO TRUE                            
248200              END-IF                                                      
248300              PERFORM 6128-CLEAR-ERROR-FIELDS                             
248400              MOVE 'D' TO TR241-RPT-TYP                                   
248500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
248600           END-IF                                                         
248700           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST       AND                
248800              IMCSEN-EXM-TMST = PC-DEFAULT-TMST        AND                
248900              IMCSEN-REJ-TMST = PC-DEFAULT-TMST        AND                
249000              IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST    AND                
249100              IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST   AND                
249200              IMCSEN-LQDN-TMST = PC-DEFAULT-TMST       AND                
249300              IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
249400              SET PS-DELETE-TIMCSEN TO TRUE                               
249500              PERFORM 2060-DELETE-SUBORDINATE-TABLES                      
249600              PERFORM 6128-CLEAR-ERROR-FIELDS                             
249700              SET PS-EVERYTHING-GONE TO TRUE                              
249800              PERFORM 6129-ERROR-27                                       
249900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
250000           END-IF                                                         
250100        END-IF                                                            
250200     ELSE                                                                 
250300        IF TR027-REJ-TRN-TYP = 'A'                                        
250400           PERFORM 5500-CREATE-TIMCSEN                                    
250500           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
250600           SET PS-TIMCSEN-AVAIL TO TRUE                                   
250700           PERFORM 6128-CLEAR-ERROR-FIELDS                                
250800           MOVE 'D' TO TR241-RPT-TYP                                      
250900           PERFORM 7100-INSERT-TOUTTRA-RPT                                
251000           PERFORM 6104-ERROR-5                                           
251100           PERFORM 7100-INSERT-TOUTTRA-RPT                                
251200        END-IF                                                            
251300        IF TR027-REJ-TRN-TYP = 'C'                                        
251400           PERFORM 5500-CREATE-TIMCSEN                                    
251500           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
251600           SET PS-TIMCSEN-AVAIL TO TRUE                                   
251700           PERFORM 6128-CLEAR-ERROR-FIELDS                                
251800           MOVE 'D' TO TR241-RPT-TYP                                      
251900           PERFORM 7100-INSERT-TOUTTRA-RPT                                
252000           PERFORM 6102-ERROR-3                                           
252100           PERFORM 7100-INSERT-TOUTTRA-RPT                                
252200        END-IF                                                            
252300        IF TR027-REJ-TRN-TYP = 'D'                                        
252400           IF PS-EVERYTHING-GONE                                          
252500              CONTINUE                                                    
252600           ELSE                                                           
252700              PERFORM 6103-ERROR-4                                        
252800              PERFORM 7100-INSERT-TOUTTRA-RPT                             
252900           END-IF                                                         
253000        END-IF                                                            
253100     END-IF.                                                              
253200******************************************************************        
253300* PROCESS ECR                                                             
253400******************************************************************        
253500* IF TIMCSEN AVAILABLE                                                    
253600*    IF ADD TRANSACTION                                                   
253700*       IF EST-CLR-TMST IS DEFAULT TMST                                   
253800*          MOVE TMST TO EST-CLR-TMST                                      
253900*          WRITE DETAIL                                                   
254000*          SET PROCESS SW                                                 
254100*       ELSE                                                              
254200*          ERROR                                                          
254300*    IF CHG TRANSACTION                                                   
254400*       IF EST-CLR-TMST = INPUT RECORD                                    
254500*          ERROR                                                          
254600*       ELSE                                                              
254700*          MOVE TMST TO EST-CLR-TMST                                      
254800*          WRITE DETAIL                                                   
254900*          SET PROCESS SW                                                 
255000*    IF DEL TRANSACTION                                                   
255100*       SET PROCESS SW                                                    
255200*       WRITE DETAIL                                                      
255300*       IF ALL TMSTS DEFAULT                                              
255400*          DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                     
255500*          ERROR                                                          
255600* ELSE                                                                    
255700*    IF ADD TRANSACTION                                                   
255800*       CREATE TIMCSEN                                                    
255900*       PREPARE FOR AUDIT                                                 
256000*       SET PROCESS SW                                                    
256100*       WRITE DETAIL                                                      
256200*       ERROR                                                             
256300*    IF CHG TRANSACTION                                                   
256400*       CREATE TIMCSEN                                                    
256500*       SET PROCESS SW                                                    
256600*       WRITE DETAIL                                                      
256700*       ERROR                                                             
256800*    IF DEL TRANSACTION                                                   
256900*       IF ALREADY DELETED                                                
257000*          CONTINUE                                                       
257100*       ELSE                                                              
257200*          ERROR                                                          
257300******************************************************************        
257400 2040-PROCESS-ECR.                                                        
257500                                                                          
257600     IF PS-TIMCSEN-AVAIL                                                  
257700        IF TR027-ECR-TRN-TYP = 'A'                                        
257800           IF IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST                       
257900              MOVE PV-FORMAT-TMST TO IMCSEN-EST-CLR-TMST                  
258000              IF PS-INSERT-TIMCSEN                                        
258100                 CONTINUE                                                 
258200              ELSE                                                        
258300                 SET PS-UPDATE-TIMCSEN TO TRUE                            
258400              END-IF                                                      
258500              PERFORM 6128-CLEAR-ERROR-FIELDS                             
258600              MOVE 'D' TO TR241-RPT-TYP                                   
258700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
258800           ELSE                                                           
258900              PERFORM 6120-ERROR-21                                       
259000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
259100           END-IF                                                         
259200        END-IF                                                            
259300        IF TR027-ECR-TRN-TYP = 'C'                                        
259400           IF IMCSEN-EST-CLR-TMST = PV-FORMAT-TMST                        
259500              MOVE 'EST CLEAR TMST'                                       
259600                                 TO TR241-DATA-IN-ERROR                   
259700              MOVE PV-FORMAT-TMST                                         
259800                                 TO TR241-DATA-VALUE                      
259900              PERFORM 6101-ERROR-2                                        
260000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
260100           ELSE                                                           
260200              MOVE PV-FORMAT-TMST TO IMCSEN-EST-CLR-TMST                  
260300              IF PS-INSERT-TIMCSEN                                        
260400                 CONTINUE                                                 
260500              ELSE                                                        
260600                 SET PS-UPDATE-TIMCSEN TO TRUE                            
260700              END-IF                                                      
260800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
260900              MOVE 'D' TO TR241-RPT-TYP                                   
261000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
261100           END-IF                                                         
261200        END-IF                                                            
261300        IF TR027-ECR-TRN-TYP = 'D'                                        
261400           IF IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST                       
261500              PERFORM 6105-ERROR-6                                        
261600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
261700           ELSE                                                           
261800              MOVE PC-DEFAULT-TMST TO IMCSEN-EST-CLR-TMST                 
261900              IF PS-INSERT-TIMCSEN                                        
262000                 CONTINUE                                                 
262100              ELSE                                                        
262200                 SET PS-UPDATE-TIMCSEN TO TRUE                            
262300              END-IF                                                      
262400              PERFORM 6128-CLEAR-ERROR-FIELDS                             
262500              MOVE 'D' TO TR241-RPT-TYP                                   
262600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
262700           END-IF                                                         
262800           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST       AND                
262900              IMCSEN-EXM-TMST = PC-DEFAULT-TMST        AND                
263000              IMCSEN-REJ-TMST = PC-DEFAULT-TMST        AND                
263100              IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST    AND                
263200              IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST   AND                
263300              IMCSEN-LQDN-TMST = PC-DEFAULT-TMST       AND                
263400              IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
263500              SET PS-DELETE-TIMCSEN TO TRUE                               
263600              PERFORM 2060-DELETE-SUBORDINATE-TABLES                      
263700              PERFORM 6128-CLEAR-ERROR-FIELDS                             
263800              SET PS-EVERYTHING-GONE TO TRUE                              
263900              PERFORM 6129-ERROR-27                                       
264000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
264100           END-IF                                                         
264200        END-IF                                                            
264300     ELSE                                                                 
264400        IF TR027-ECR-TRN-TYP = 'A'                                        
264500           PERFORM 5500-CREATE-TIMCSEN                                    
264600           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
264700           SET PS-TIMCSEN-AVAIL TO TRUE                                   
264800           PERFORM 6128-CLEAR-ERROR-FIELDS                                
264900           MOVE 'D' TO TR241-RPT-TYP                                      
265000           PERFORM 7100-INSERT-TOUTTRA-RPT                                
265100           PERFORM 6104-ERROR-5                                           
265200           PERFORM 7100-INSERT-TOUTTRA-RPT                                
265300        END-IF                                                            
265400        IF TR027-ECR-TRN-TYP = 'C'                                        
265500           PERFORM 5500-CREATE-TIMCSEN                                    
265600           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
265700           SET PS-TIMCSEN-AVAIL TO TRUE                                   
265800           PERFORM 6128-CLEAR-ERROR-FIELDS                                
265900           MOVE 'D' TO TR241-RPT-TYP                                      
266000           PERFORM 7100-INSERT-TOUTTRA-RPT                                
266100           PERFORM 6102-ERROR-3                                           
266200           PERFORM 7100-INSERT-TOUTTRA-RPT                                
266300        END-IF                                                            
266400        IF TR027-ECR-TRN-TYP = 'D'                                        
266500           IF PS-EVERYTHING-GONE                                          
266600              CONTINUE                                                    
266700           ELSE                                                           
266800              PERFORM 6103-ERROR-4                                        
266900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
267000           END-IF                                                         
267100        END-IF                                                            
267200     END-IF.                                                              
267300******************************************************************        
267400* PROCESS RLS                                                             
267500******************************************************************        
267600* IF TIMCSEN AVAILABLE                                                    
267700*    IF ADD TRANSACTION                                                   
267800*       IF ACT-CLR-TMST IS DEFAULT TMST                                   
267900*          MOVE TMST TO ACT-CLR-TMST                                      
268000*          WRITE DETAIL                                                   
268100*          SET PROCESS SW                                                 
268200*       ELSE                                                              
268300*          ERROR                                                          
268400*    IF CHG TRANSACTION                                                   
268500*       IF ACT-CLR-TMST = INPUT RECORD                                    
268600*          ERROR                                                          
268700*       ELSE                                                              
268800*          MOVE TMST TO ACT-CLR-TMST                                      
268900*          WRITE DETAIL                                                   
269000*          SET PROCESS SW                                                 
269100*    IF DEL TRANSACTION                                                   
269200*       SET PROCESS SW                                                    
269300*       WRITE DETAIL                                                      
269400*       IF ALL TMSTS DEFAULT                                              
269500*          DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                     
269600*          ERROR                                                          
269700* ELSE                                                                    
269800*    IF ADD TRANSACTION                                                   
269900*       CREATE TIMCSEN                                                    
270000*       PREPARE FOR AUDIT                                                 
270100*       SET PROCESS SW                                                    
270200*       WRITE DETAIL                                                      
270300*       ERROR                                                             
270400*    IF CHG TRANSACTION                                                   
270500*       CREATE TIMCSEN                                                    
270600*       SET PROCESS SW                                                    
270700*       WRITE DETAIL                                                      
270800*       ERROR                                                             
270900*    IF DEL TRANSACTION                                                   
271000*       IF ALREADY DELETED                                                
271100*          CONTINUE                                                       
271200*       ELSE                                                              
271300*          ERROR                                                          
271400******************************************************************        
271500 2045-PROCESS-RLS.                                                        
271600                                                                          
271700     IF PS-TIMCSEN-AVAIL                                                  
271800        IF TR027-RLS-TRN-TYP = 'A'                                        
271900           IF IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST                      
272000                MOVE PV-FORMAT-TMST TO IMCSEN-ACTL-CLR-TMST               
272100                PERFORM 7705-ADD-SCM-CSTM-CLEARED-MSG                     
272200              IF PS-INSERT-TIMCSEN                                        
272300                 CONTINUE                                                 
272400              ELSE                                                        
272500                 SET PS-UPDATE-TIMCSEN TO TRUE                            
272600              END-IF                                                      
272700              PERFORM 6128-CLEAR-ERROR-FIELDS                             
272800              MOVE 'D' TO TR241-RPT-TYP                                   
272900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
273000           ELSE                                                           
273100              PERFORM 6121-ERROR-22                                       
273200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
273300           END-IF                                                         
273400        END-IF                                                            
273500        IF TR027-RLS-TRN-TYP = 'C'                                        
273600           IF IMCSEN-ACTL-CLR-TMST = PV-FORMAT-TMST                       
273700              MOVE 'ACTL CLEAR TMST'                                      
273800                                 TO TR241-DATA-IN-ERROR                   
273900              MOVE PV-FORMAT-TMST                                         
274000                                 TO TR241-DATA-VALUE                      
274100              PERFORM 6101-ERROR-2                                        
274200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
274300           ELSE                                                           
274400              MOVE PV-FORMAT-TMST TO IMCSEN-ACTL-CLR-TMST                 
274500              IF PS-INSERT-TIMCSEN                                        
274600                 CONTINUE                                                 
274700              ELSE                                                        
274800                 SET PS-UPDATE-TIMCSEN TO TRUE                            
274900              END-IF                                                      
275000              PERFORM 6128-CLEAR-ERROR-FIELDS                             
275100              MOVE 'D' TO TR241-RPT-TYP                                   
275200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
275300              PERFORM 7625-CHG-SCM-CSTM-CLEARED-MSG                       
275400           END-IF                                                         
275500        END-IF                                                            
275600        IF TR027-RLS-TRN-TYP = 'D'                                        
275700           IF IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST                      
275800              PERFORM 6105-ERROR-6                                        
275900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
276000           ELSE                                                           
276100              MOVE PC-DEFAULT-TMST TO IMCSEN-ACTL-CLR-TMST                
276200              PERFORM 7630-DEL-SCM-CSTM-CLEARED-MSG                       
276300              IF PS-INSERT-TIMCSEN                                        
276400                 CONTINUE                                                 
276500              ELSE                                                        
276600                 SET PS-UPDATE-TIMCSEN TO TRUE                            
276700              END-IF                                                      
276800              PERFORM 6128-CLEAR-ERROR-FIELDS                             
276900              MOVE 'D' TO TR241-RPT-TYP                                   
277000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
277100           END-IF                                                         
277200           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST       AND                
277300              IMCSEN-EXM-TMST = PC-DEFAULT-TMST        AND                
277400              IMCSEN-REJ-TMST = PC-DEFAULT-TMST        AND                
277500              IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST    AND                
277600              IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST   AND                
277700              IMCSEN-LQDN-TMST = PC-DEFAULT-TMST       AND                
277800              IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
277900              SET PS-DELETE-TIMCSEN TO TRUE                               
278000              PERFORM 2060-DELETE-SUBORDINATE-TABLES                      
278100              PERFORM 6128-CLEAR-ERROR-FIELDS                             
278200              SET PS-EVERYTHING-GONE TO TRUE                              
278300              PERFORM 6129-ERROR-27                                       
278400              PERFORM 7100-INSERT-TOUTTRA-RPT                             
278500           END-IF                                                         
278600        END-IF                                                            
278700     ELSE                                                                 
278800        IF TR027-RLS-TRN-TYP = 'A'                                        
278900           PERFORM 7705-ADD-SCM-CSTM-CLEARED-MSG                          
279000           PERFORM 5500-CREATE-TIMCSEN                                    
279100           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
279200           SET PS-TIMCSEN-AVAIL TO TRUE                                   
279300           PERFORM 6128-CLEAR-ERROR-FIELDS                                
279400           MOVE 'D' TO TR241-RPT-TYP                                      
279500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
279600           PERFORM 6104-ERROR-5                                           
279700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
279800        END-IF                                                            
279900        IF TR027-RLS-TRN-TYP = 'C'                                        
280000           PERFORM 5500-CREATE-TIMCSEN                                    
280100           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
280200           SET PS-TIMCSEN-AVAIL TO TRUE                                   
280300           PERFORM 6128-CLEAR-ERROR-FIELDS                                
280400           MOVE 'D' TO TR241-RPT-TYP                                      
280500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
280600           PERFORM 6102-ERROR-3                                           
280700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
280800* THIS IS REALLY AN ADD NOT A CHANGE                                      
280900           PERFORM 7705-ADD-SCM-CSTM-CLEARED-MSG                          
281000        END-IF                                                            
281100        IF TR027-RLS-TRN-TYP = 'D'                                        
281200           IF PS-EVERYTHING-GONE                                          
281300              CONTINUE                                                    
281400           ELSE                                                           
281500              PERFORM 6103-ERROR-4                                        
281600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
281700           END-IF                                                         
281800        END-IF                                                            
281900     END-IF.                                                              
282000******************************************************************        
282100* PROCESS LIQ                                                             
282200******************************************************************        
282300* IF TIMCSEN AVAILABLE                                                    
282400*    IF ADD TRANSACTION                                                   
282500*       IF LQDN-TMST IS DEFAULT TMST                                      
282600*          MOVE TMST TO LQDN-TMST                                         
282700*          WRITE DETAIL                                                   
282800*          SET PROCESS SW                                                 
282900*       ELSE                                                              
283000*          ERROR                                                          
283100*    IF CHG TRANSACTION                                                   
283200*       IF LQDN-TMST = INPUT RECORD                                       
283300*          ERROR                                                          
283400*       ELSE                                                              
283500*          MOVE TMST TO LQDN-TMST                                         
283600*          WRITE DETAIL                                                   
283700*          SET PROCESS SW                                                 
283800*    IF DEL TRANSACTION                                                   
283900*       SET PROCESS SW                                                    
284000*       WRITE DETAIL                                                      
284100*       IF ALL TMSTS DEFAULT                                              
284200*          DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                     
284300*          ERROR                                                          
284400* ELSE                                                                    
284500*    IF ADD TRANSACTION                                                   
284600*       CREATE TIMCSEN                                                    
284700*       PREPARE FOR AUDIT                                                 
284800*       SET PROCESS SW                                                    
284900*       WRITE DETAIL                                                      
285000*       ERROR                                                             
285100*    IF CHG TRANSACTION                                                   
285200*       CREATE TIMCSEN                                                    
285300*       SET PROCESS SW                                                    
285400*       WRITE DETAIL                                                      
285500*       ERROR                                                             
285600*    IF DEL TRANSACTION                                                   
285700*       IF ALREADY DELETED                                                
285800*          CONTINUE                                                       
285900*       ELSE                                                              
286000*          ERROR                                                          
286100******************************************************************        
286200 2050-PROCESS-LIQ.                                                        
286300                                                                          
286400     IF PS-TIMCSEN-AVAIL                                                  
286500        IF TR027-LIQ-TRN-TYP = 'A'                                        
286600           IF IMCSEN-LQDN-TMST = PC-DEFAULT-TMST                          
286700              MOVE PV-FORMAT-TMST TO IMCSEN-LQDN-TMST                     
286800              IF PS-INSERT-TIMCSEN                                        
286900                 CONTINUE                                                 
287000              ELSE                                                        
287100                 SET PS-UPDATE-TIMCSEN TO TRUE                            
287200              END-IF                                                      
287300              PERFORM 6128-CLEAR-ERROR-FIELDS                             
287400              MOVE 'D' TO TR241-RPT-TYP                                   
287500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
287600           ELSE                                                           
287700              PERFORM 6123-ERROR-24                                       
287800              PERFORM 7100-INSERT-TOUTTRA-RPT                             
287900           END-IF                                                         
288000        END-IF                                                            
288100        IF TR027-LIQ-TRN-TYP = 'C'                                        
288200           IF IMCSEN-LQDN-TMST = PV-FORMAT-TMST                           
288300              MOVE 'CSTMS LQDN TMST'                                      
288400                                 TO TR241-DATA-IN-ERROR                   
288500              MOVE PV-FORMAT-TMST                                         
288600                                 TO TR241-DATA-VALUE                      
288700              PERFORM 6101-ERROR-2                                        
288800              PERFORM 7100-INSERT-TOUTTRA-RPT                             
288900           ELSE                                                           
289000              MOVE PV-FORMAT-TMST TO IMCSEN-LQDN-TMST                     
289100              IF PS-INSERT-TIMCSEN                                        
289200                 CONTINUE                                                 
289300              ELSE                                                        
289400                 SET PS-UPDATE-TIMCSEN TO TRUE                            
289500              END-IF                                                      
289600              MOVE 'D' TO TR241-RPT-TYP                                   
289700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
289800           END-IF                                                         
289900        END-IF                                                            
290000        IF TR027-LIQ-TRN-TYP = 'D'                                        
290100           IF IMCSEN-LQDN-TMST = PC-DEFAULT-TMST                          
290200              PERFORM 6105-ERROR-6                                        
290300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
290400           ELSE                                                           
290500              MOVE PC-DEFAULT-TMST TO IMCSEN-LQDN-TMST                    
290600              IF PS-INSERT-TIMCSEN                                        
290700                 CONTINUE                                                 
290800              ELSE                                                        
290900                 SET PS-UPDATE-TIMCSEN TO TRUE                            
291000              END-IF                                                      
291100              PERFORM 6128-CLEAR-ERROR-FIELDS                             
291200              MOVE 'D' TO TR241-RPT-TYP                                   
291300              PERFORM 7100-INSERT-TOUTTRA-RPT                             
291400           END-IF                                                         
291500           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST       AND                
291600              IMCSEN-EXM-TMST = PC-DEFAULT-TMST        AND                
291700              IMCSEN-REJ-TMST = PC-DEFAULT-TMST        AND                
291800              IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST    AND                
291900              IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST   AND                
292000              IMCSEN-LQDN-TMST = PC-DEFAULT-TMST       AND                
292100              IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
292200              SET PS-DELETE-TIMCSEN TO TRUE                               
292300              PERFORM 2060-DELETE-SUBORDINATE-TABLES                      
292400              PERFORM 6128-CLEAR-ERROR-FIELDS                             
292500              SET PS-EVERYTHING-GONE TO TRUE                              
292600              PERFORM 6129-ERROR-27                                       
292700              PERFORM 7100-INSERT-TOUTTRA-RPT                             
292800           END-IF                                                         
292900        END-IF                                                            
293000     ELSE                                                                 
293100        IF TR027-LIQ-TRN-TYP = 'A'                                        
293200           PERFORM 5500-CREATE-TIMCSEN                                    
293300           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
293400           SET PS-TIMCSEN-AVAIL TO TRUE                                   
293500           PERFORM 6128-CLEAR-ERROR-FIELDS                                
293600           MOVE 'D' TO TR241-RPT-TYP                                      
293700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
293800           PERFORM 6104-ERROR-5                                           
293900           PERFORM 7100-INSERT-TOUTTRA-RPT                                
294000        END-IF                                                            
294100        IF TR027-LIQ-TRN-TYP = 'C'                                        
294200           PERFORM 5500-CREATE-TIMCSEN                                    
294300           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
294400           SET PS-TIMCSEN-AVAIL TO TRUE                                   
294500           PERFORM 6128-CLEAR-ERROR-FIELDS                                
294600           MOVE 'D' TO TR241-RPT-TYP                                      
294700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
294800           PERFORM 6102-ERROR-3                                           
294900           PERFORM 7100-INSERT-TOUTTRA-RPT                                
295000        END-IF                                                            
295100        IF TR027-LIQ-TRN-TYP = 'D'                                        
295200           IF PS-EVERYTHING-GONE                                          
295300              CONTINUE                                                    
295400           ELSE                                                           
295500              PERFORM 6103-ERROR-4                                        
295600              PERFORM 7100-INSERT-TOUTTRA-RPT                             
295700           END-IF                                                         
295800        END-IF                                                            
295900     END-IF.                                                              
296000******************************************************************        
296100* PROCESS LSU                                                             
296200******************************************************************        
296300* IF TIMCSEN AVAILABLE                                                    
296400*    IF ADD TRANSACTION                                                   
296500*       IF LQDN-SSPNN-TMST IS DEFAULT TMST                                
296600*          MOVE TMST TO LQDN-SSPNN-TMST                                   
296700*          MOVE DESC TO LQDN-SSPNN-DESC                                   
296800*          WRITE DETAIL                                                   
296900*          SET PROCESS SW                                                 
297000*       ELSE                                                              
297100*          ERROR                                                          
297200*    IF CHG TRANSACTION                                                   
297300*       IF LQDN-SSPNN-TMST = INPUT RECORD                                 
297400*          ERROR                                                          
297500*       ELSE                                                              
297600*          MOVE TMST TO LQDN-SSPNN-TMST                                   
297700*          MOVE DESC TO LQDN-SSPNN-DESC                                   
297800*          WRITE DETAIL                                                   
297900*          SET PROCESS SW                                                 
298000*    IF DEL TRANSACTION                                                   
298100*       SET PROCESS SW                                                    
298200*       WRITE DETAIL                                                      
298300*       IF ALL TMSTS DEFAULT                                              
298400*          DELETE SUBORDINATE TABLE ROWS (BOL,CON,PO)                     
298500*          ERROR                                                          
298600* ELSE                                                                    
298700*    IF ADD TRANSACTION                                                   
298800*       CREATE TIMCSEN                                                    
298900*       PREPARE FOR AUDIT                                                 
299000*       SET PROCESS SW                                                    
299100*       WRITE DETAIL                                                      
299200*       ERROR                                                             
299300*    IF CHG TRANSACTION                                                   
299400*       CREATE TIMCSEN                                                    
299500*       SET PROCESS SW                                                    
299600*       WRITE DETAIL                                                      
299700*       ERROR                                                             
299800*    IF DEL TRANSACTION                                                   
299900*       IF ALREADY DELETED                                                
300000*          CONTINUE                                                       
300100*       ELSE                                                              
300200*          ERROR                                                          
300300******************************************************************        
300400 2055-PROCESS-LSU.                                                        
300500                                                                          
300600     IF PS-TIMCSEN-AVAIL                                                  
300700        IF TR027-LSU-TRN-TYP = 'A'                                        
300800           IF IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
300900              MOVE PV-FORMAT-TMST TO IMCSEN-LQDN-SSPNN-TMST               
301000              MOVE TR027-LSU-LQDN-SSPNN-DESC TO                           
301100                 IMCSEN-LQDN-SSPNN-DESC                                   
301200              IF PS-INSERT-TIMCSEN                                        
301300                 CONTINUE                                                 
301400              ELSE                                                        
301500                 SET PS-UPDATE-TIMCSEN TO TRUE                            
301600              END-IF                                                      
301700              PERFORM 6128-CLEAR-ERROR-FIELDS                             
301800              MOVE 'D' TO TR241-RPT-TYP                                   
301900              PERFORM 7100-INSERT-TOUTTRA-RPT                             
302000           ELSE                                                           
302100              PERFORM 6122-ERROR-23                                       
302200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
302300           END-IF                                                         
302400        END-IF                                                            
302500        IF TR027-LSU-TRN-TYP = 'C'                                        
302600           IF IMCSEN-LQDN-SSPNN-TMST = PV-FORMAT-TMST                     
302700              MOVE 'LQDN SSPNN TMST'                                      
302800                                 TO TR241-DATA-IN-ERROR                   
302900              MOVE PV-FORMAT-TMST                                         
303000                                 TO TR241-DATA-VALUE                      
303100              PERFORM 6101-ERROR-2                                        
303200              PERFORM 7100-INSERT-TOUTTRA-RPT                             
303300           ELSE                                                           
303400              MOVE PV-FORMAT-TMST TO IMCSEN-LQDN-SSPNN-TMST               
303500              MOVE TR027-LSU-LQDN-SSPNN-DESC TO                           
303600                 IMCSEN-LQDN-SSPNN-DESC                                   
303700              IF PS-INSERT-TIMCSEN                                        
303800                 CONTINUE                                                 
303900              ELSE                                                        
304000                 SET PS-UPDATE-TIMCSEN TO TRUE                            
304100              END-IF                                                      
304200              PERFORM 6128-CLEAR-ERROR-FIELDS                             
304300              MOVE 'D' TO TR241-RPT-TYP                                   
304400              PERFORM 7100-INSERT-TOUTTRA-RPT                             
304500           END-IF                                                         
304600        END-IF                                                            
304700        IF TR027-LSU-TRN-TYP = 'D'                                        
304800           IF IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
304900              PERFORM 6105-ERROR-6                                        
305000              PERFORM 7100-INSERT-TOUTTRA-RPT                             
305100           ELSE                                                           
305200              MOVE PC-DEFAULT-TMST TO IMCSEN-LQDN-SSPNN-TMST              
305300              MOVE SPACES          TO IMCSEN-LQDN-SSPNN-DESC              
305400              IF PS-INSERT-TIMCSEN                                        
305500                 CONTINUE                                                 
305600              ELSE                                                        
305700                 SET PS-UPDATE-TIMCSEN TO TRUE                            
305800              END-IF                                                      
305900              PERFORM 6128-CLEAR-ERROR-FIELDS                             
306000              MOVE 'D' TO TR241-RPT-TYP                                   
306100              PERFORM 7100-INSERT-TOUTTRA-RPT                             
306200           END-IF                                                         
306300           IF IMCSEN-FILD-TMST = PC-DEFAULT-TMST       AND                
306400              IMCSEN-EXM-TMST = PC-DEFAULT-TMST        AND                
306500              IMCSEN-REJ-TMST = PC-DEFAULT-TMST        AND                
306600              IMCSEN-EST-CLR-TMST = PC-DEFAULT-TMST    AND                
306700              IMCSEN-ACTL-CLR-TMST = PC-DEFAULT-TMST   AND                
306800              IMCSEN-LQDN-TMST = PC-DEFAULT-TMST       AND                
306900              IMCSEN-LQDN-SSPNN-TMST = PC-DEFAULT-TMST                    
307000              SET PS-DELETE-TIMCSEN TO TRUE                               
307100              PERFORM 2060-DELETE-SUBORDINATE-TABLES                      
307200              PERFORM 6128-CLEAR-ERROR-FIELDS                             
307300              SET PS-EVERYTHING-GONE TO TRUE                              
307400              PERFORM 6129-ERROR-27                                       
307500              PERFORM 7100-INSERT-TOUTTRA-RPT                             
307600           END-IF                                                         
307700        END-IF                                                            
307800     ELSE                                                                 
307900        IF TR027-LSU-TRN-TYP = 'A'                                        
308000           PERFORM 5500-CREATE-TIMCSEN                                    
308100           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
308200           SET PS-TIMCSEN-AVAIL TO TRUE                                   
308300           PERFORM 6128-CLEAR-ERROR-FIELDS                                
308400           MOVE 'D' TO TR241-RPT-TYP                                      
308500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
308600           PERFORM 6104-ERROR-5                                           
308700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
308800        END-IF                                                            
308900        IF TR027-LSU-TRN-TYP = 'C'                                        
309000           PERFORM 5500-CREATE-TIMCSEN                                    
309100           PERFORM 5100-MOVE-TIMCSEN-TO-TAUCSEN                           
309200           SET PS-TIMCSEN-AVAIL TO TRUE                                   
309300           PERFORM 6128-CLEAR-ERROR-FIELDS                                
309400           MOVE 'D' TO TR241-RPT-TYP                                      
309500           PERFORM 7100-INSERT-TOUTTRA-RPT                                
309600           PERFORM 6102-ERROR-3                                           
309700           PERFORM 7100-INSERT-TOUTTRA-RPT                                
309800        END-IF                                                            
309900        IF TR027-LSU-TRN-TYP = 'D'                                        
310000           IF PS-EVERYTHING-GONE                                          
310100              CONTINUE                                                    
310200           ELSE                                                           
310300              PERFORM 6103-ERROR-4                                        
310400              PERFORM 7100-INSERT-TOUTTRA-RPT                             
310500           END-IF                                                         
310600        END-IF                                                            
310700     END-IF.                                                              
310800******************************************************************        
310900* DELETE TIMCSBL, TIMCSCN AND TIMCSPO ROWS                                
311000* IN THE CASE OF A 'ENF' DELETE OR ALL TMST FIELDS BEING DEFAULT          
311100* ON TIMCSEN ROW.                                                         
311200******************************************************************        
311300 2060-DELETE-SUBORDINATE-TABLES.                                          
311400     PERFORM 7175-OPEN-BOL-CURSOR.                                        
311500     PERFORM                                                              
311600        UNTIL SQLCODE > 0                                                 
311700        PERFORM 7177-FETCH-BOL-CURSOR                                     
311800        IF SQLCODE = 0                                                    
311900           PERFORM 7110-DELETE-TIMCSBL                                    
312000        END-IF                                                            
312100        IF SQLCODE = 0                                                    
312200           PERFORM 5200-MOVE-TIMCSBL-TO-TAUCSBL                           
312300           PERFORM 7999-SET-CURRENT-TMST                                  
312400           MOVE PC-D TO AUCSBL-AUD-FUNC-CDE                               
312500           PERFORM 7070-INSERT-TAUCSBL                                    
312600        END-IF                                                            
312700     END-PERFORM.                                                         
312800     PERFORM 7176-CLOSE-BOL-CURSOR.                                       
312900     PERFORM 7180-OPEN-CON-CURSOR.                                        
313000     PERFORM                                                              
313100        UNTIL SQLCODE > 0                                                 
313200        PERFORM 7182-FETCH-CON-CURSOR                                     
313300        IF SQLCODE = 0                                                    
313400           SET PS-ENTR-ID-FOR-CN-DEL-FOUND-NO TO TRUE                     
313500           PERFORM 7120-DELETE-TIMCSCN                                    
313600        END-IF                                                            
313700        IF SQLCODE = 0                                                    
313800           PERFORM 5300-MOVE-TIMCSCN-TO-TAUCSCN                           
313900           PERFORM 7999-SET-CURRENT-TMST                                  
314000           MOVE PC-D TO AUCSCN-AUD-FUNC-CDE                               
314100           PERFORM 7080-INSERT-TAUCSCN                                    
314200           IF PS-ENTR-ID-FOR-CN-DEL-FOUND                                 
314300              SET PS-EOC-TIMCNPO-D-CN-CSR-NO TO TRUE                      
314400              PERFORM 7220-OPEN-TIMCNPO-D-CN-CURSOR                       
314500              PERFORM 7221-FETCH-TIMCNPO-D-CN-CURSOR                      
314600                UNTIL PS-EOC-TIMCNPO-D-CN-CSR                             
314700              PERFORM 7222-CLOSE-TIMCNPO-D-CN-CURSOR                      
314800           END-IF                                                         
314900        END-IF                                                            
315000     END-PERFORM.                                                         
315100     PERFORM 7181-CLOSE-CON-CURSOR.                                       
315200     PERFORM 7185-OPEN-PO-CURSOR.                                         
315300     PERFORM                                                              
315400        UNTIL SQLCODE > 0                                                 
315500        PERFORM 7187-FETCH-PO-CURSOR                                      
315600        IF SQLCODE = 0                                                    
315700           SET PS-ENTR-ID-FOR-CN-DEL-FOUND-NO TO TRUE                     
315800           PERFORM 7130-DELETE-TIMCSPO                                    
315900        END-IF                                                            
316000        IF SQLCODE = 0                                                    
316100           PERFORM 5400-MOVE-TIMCSPO-TO-TAUCSPO                           
316200           PERFORM 7999-SET-CURRENT-TMST                                  
316300           MOVE PC-D TO AUCSPO-AUD-FUNC-CDE                               
316400           PERFORM 7090-INSERT-TAUCSPO                                    
316500           IF PS-ENTR-ID-FOR-PO-DEL-FOUND                                 
316600              SET PS-EOC-TIMCNPO-D-PO-CSR-NO     TO TRUE                  
316700              PERFORM 7230-OPEN-TIMCNPO-D-PO-CURSOR                       
316800              PERFORM 7231-FETCH-TIMCNPO-D-PO-CURSOR                      
316900                UNTIL PS-EOC-TIMCNPO-D-PO-CSR                             
317000              PERFORM 7232-CLOSE-TIMCNPO-D-PO-CURSOR                      
317100           END-IF                                                         
317200        END-IF                                                            
317300     END-PERFORM.                                                         
317400     PERFORM 7186-CLOSE-PO-CURSOR.                                        
317500                                                                          
317600******************************************************************        
317700*    SELECT CHECKPOINT RESTART CONTROL INFORMATION.              *        
317800******************************************************************        
317900 4000-GET-CHECKPOINT-CNTL.                                                
318000                                                                          
318100     PERFORM WITH TEST AFTER                                              
318200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
318300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                     
318400                 SQLCODE = ZERO                                           
318500                                                                          
318600         EXEC SQL                                                         
318700           SELECT  CKPT_STAT_CODE                                         
318800             INTO :PV-CKPT-STAT-CODE                                      
318900             FROM  TCKRSTCNTL                                             
319000            WHERE  PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                   
319100         END-EXEC                                                         
319200                                                                          
319300         EVALUATE TRUE                                                    
319400             WHEN SQLCODE = ZERO                                          
319500             WHEN SQLCODE = -904                                          
319600             WHEN SQLCODE = -913                                          
319700                  CONTINUE                                                
319800                                                                          
319900             WHEN SQLWARN0 NOT EQUAL SPACE                                
320000             WHEN SQLCODE NOT EQUAL ZERO                                  
320100                 DISPLAY '**************************************'         
320200                 DISPLAY '** ABEND                            **'         
320300                 DISPLAY '** PROGRAM = TRKUP245               **'         
320400                 DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT- **'         
320500                 DISPLAY '**                  CNTL            **'         
320600                 DISPLAY '** SELECT FROM TCKRSTCNTL           **'         
320700                 DISPLAY '**CKPT-STAT-CODE ='                             
320800                 DISPLAY              TCKRSTCNTL-CKPT-STAT-CODE           
320900                 DISPLAY '**************************************'         
321000                 PERFORM 9100-SQL-ABEND                                   
321100         END-EVALUATE                                                     
321200     END-PERFORM.                                                         
321300                                                                          
321400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
321500         SQLCODE NOT = ZERO                                               
321600         DISPLAY '****************************************'               
321700         DISPLAY '** MAX RETRIES EXCEEDED ON SELECT     **'               
321800         DISPLAY '** FROM TCKRSTCNTL                    **'               
321900         DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT-CNTL*'               
322000         DISPLAY '****************************************'               
322100         PERFORM 9100-SQL-ABEND                                           
322200     END-IF.                                                              
322300                                                                          
322400 EJECT                                                                    
322500                                                                          
322600******************************************************************        
322700*    SELECT CHECKPOINT RESTART WORKING STORAGE DESCRIPTION INFO  *        
322800******************************************************************        
322900 4010-GET-CHECKPOINT-INFO.                                                
323000                                                                          
323100     PERFORM                                                              
323200         WITH TEST AFTER                                                  
323300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
323400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
323500                 SQLCODE = ZERO                                           
323600                                                                          
323700         EXEC SQL                                                         
323800           SELECT WORK_STRG_DESC                                          
323900           INTO :TCKRSTINF-WORK-STRG-DESC                                 
324000           FROM TCKRSTINF                                                 
324100           WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                     
324200         END-EXEC                                                         
324300                                                                          
324400         EVALUATE TRUE                                                    
324500             WHEN SQLCODE = ZERO                                          
324600             WHEN SQLCODE = -904                                          
324700             WHEN SQLCODE = -913                                          
324800                  CONTINUE                                                
324900                                                                          
325000             WHEN SQLWARN0 NOT EQUAL SPACE                                
325100             WHEN SQLCODE NOT EQUAL ZERO                                  
325200                 DISPLAY '**************************************'         
325300                 DISPLAY '** ABEND                            **'         
325400                 DISPLAY '** PROGRAM = TRKUP245               **'         
325500                 DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT- **'         
325600                 DISPLAY '**                  INFO            **'         
325700                 DISPLAY '** SELECT FROM TCKRSTINF            **'         
325800                 DISPLAY '**************************************'         
325900                 PERFORM 9100-SQL-ABEND                                   
326000         END-EVALUATE                                                     
326100     END-PERFORM.                                                         
326200                                                                          
326300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
326400         SQLCODE NOT = ZERO                                               
326500         DISPLAY '****************************************'               
326600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
326700         DISPLAY '** SELECT FROM TCKRSTINF              **'               
326800         DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT-INFO*'               
326900         DISPLAY '****************************************'               
327000         PERFORM 9100-SQL-ABEND                                           
327100     END-IF.                                                              
327200                                                                          
327300 EJECT                                                                    
327400******************************************************************        
327500*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *        
327600******************************************************************        
327700 4020-SET-COMMIT-TIME.                                                    
327800                                                                          
327900      EXEC SQL                                                            
328000          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
328100          INTO :PV-HOLD-TMST                                              
328200          FROM TCKRSTCNTL                                                 
328300          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                      
328400      END-EXEC.                                                           
328500                                                                          
328600     EVALUATE TRUE                                                        
328700         WHEN SQLWARN0 NOT EQUAL SPACE                                    
328800         WHEN SQLCODE NOT EQUAL ZERO                                      
328900     DISPLAY '**********************************'                         
329000     DISPLAY '** ABEND **'                                                
329100     DISPLAY '** PROGRAM = TRKUP245 **'                                   
329200     DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME**'                      
329300     DISPLAY '**UNSUCESSFUL SET OF COMMIT INTERVAL**'                     
329400     DISPLAY '**********************************'                         
329500                                                                          
329600             PERFORM 9100-SQL-ABEND                                       
329700     END-EVALUATE.                                                        
329800                                                                          
329900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
330000         SQLCODE NOT = ZERO                                               
330100         DISPLAY '****************************************'               
330200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
330300         DISPLAY '** SELECT FROM TCKRSTCNTL             **'               
330400         DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME   **'               
330500         DISPLAY '****************************************'               
330600         PERFORM 9100-SQL-ABEND                                           
330700     END-IF.                                                              
330800                                                                          
330900 EJECT                                                                    
331000******************************************************************        
331100*    CHECK TO SEE IF A COMMIT SHOULD BE TAKEN.                   *        
331200******************************************************************        
331300 4100-COMMIT-CHECK.                                                       
331400                                                                          
331500     EXEC SQL                                                             
331600       SET :PV-TMST = CURRENT TIMESTAMP                                   
331700     END-EXEC.                                                            
331800                                                                          
331900     EVALUATE TRUE                                                        
332000         WHEN SQLWARN0 NOT EQUAL SPACE                                    
332100         WHEN SQLCODE NOT EQUAL ZERO                                      
332200     DISPLAY '**********************************'                         
332300     DISPLAY '** ABEND **'                                                
332400     DISPLAY '** PROGRAM = TRKUP245***'                                   
332500     DISPLAY '** PARAGRAPH = 4100-COMMIT-CHECK**'                         
332600     DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'                          
332700     DISPLAY '**********************************'                         
332800                                                                          
332900             PERFORM 9100-SQL-ABEND                                       
333000     END-EVALUATE.                                                        
333100                                                                          
333200     IF PV-TMST > PV-HOLD-TMST                                            
333300         IF NO-COMMITS-TAKEN                                              
333400             MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE                 
333500             PERFORM 4200-UPDATE-TCKRSTCNTL                               
333600             SET COMMITS-TAKEN TO TRUE                                    
333700         END-IF                                                           
333800        PERFORM 4210-UPDATE-TCKRSTINF                                     
333900        PERFORM 4300-COMMIT                                               
334000        MOVE PA-TOTAL-RECS-READ TO                                        
334100           CR-CUSTOMS-RECS-WORKED                                         
334200        DISPLAY 'COMMIT TAKEN AT '                                        
334300        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)        
334400         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)        
334500        DISPLAY 'RECS READ => ' PA-TOTAL-RECS-READ                        
334600        DISPLAY '**********************************'                      
334700        PERFORM 4020-SET-COMMIT-TIME                                      
334800     END-IF.                                                              
334900                                                                          
335000 EJECT                                                                    
335100******************************************************************        
335200*    CHECK TO SEE IF A CHECKPOINT RESTART SHOULD BE DONE.        *        
335300******************************************************************        
335400 4110-CHECKPOINT-RESTART.                                                 
335500                                                                          
335600     PERFORM 4010-GET-CHECKPOINT-INFO.                                    
335700     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.             
335800                                                                          
335900     DISPLAY '***********************************************'.           
336000     DISPLAY '** TRKUP245 CHECKPOINT RESTART **'.                         
336100     DISPLAY '** CUSTOMS RECS BYPASSED ON RESTART = '.                    
336200     DISPLAY  CR-CUSTOMS-RECS-WORKED.                                     
336300     DISPLAY '***********************************************'.           
336400                                                                          
336500     IF INPUT-CUSTOMS-FILE                                                
336600         PERFORM 6000-READ-CUSTOMS-FILE                                   
336700             CR-CUSTOMS-RECS-WORKED TIMES                                 
336800     ELSE                                                                 
336900         MOVE CR-CUSTOMS-RECS-WORKED TO PA-TOTAL-RECS-READ                
337000         SET PS-END-OF-INPUT TO TRUE                                      
337100     END-IF.                                                              
337200 EJECT                                                                    
337300******************************************************************        
337400*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *        
337500*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *        
337600******************************************************************        
337700 4200-UPDATE-TCKRSTCNTL.                                                  
337800                                                                          
337900     PERFORM WITH TEST AFTER                                              
338000             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
338100             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
338200                     SQLCODE = ZERO                                       
338300                                                                          
338400         EXEC SQL                                                         
338500             UPDATE TCKRSTCNTL                                            
338600             SET CKPT_STAT_CODE = :PV-CKPT-STAT-CODE                      
338700             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME              
338800         END-EXEC                                                         
338900                                                                          
339000         EVALUATE TRUE                                                    
339100             WHEN SQLCODE = ZERO                                          
339200             WHEN SQLCODE = -904                                          
339300             WHEN SQLCODE = -913                                          
339400                  CONTINUE                                                
339500                                                                          
339600             WHEN SQLWARN0 NOT EQUAL SPACE                                
339700             WHEN SQLCODE NOT EQUAL ZERO                                  
339800                 DISPLAY '**************************************'         
339900                 DISPLAY '** ABEND                            **'         
340000                 DISPLAY '** PROGRAM = TRKUP245               **'         
340100                 DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL*'         
340200                 DISPLAY '** UPDATE TCKRSTCNTL                **'         
340300                 DISPLAY '**' PV-CKPT-STAT-CODE                           
340400                 DISPLAY '**************************************'         
340500                 PERFORM 9100-SQL-ABEND                                   
340600         END-EVALUATE                                                     
340700     END-PERFORM.                                                         
340800                                                                          
340900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
341000         SQLCODE NOT = ZERO                                               
341100         DISPLAY '****************************************'               
341200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
341300         DISPLAY '** UPDATE TO TCKRSTCNTL               **'               
341400         DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL **'               
341500         DISPLAY '**' PV-CKPT-STAT-CODE                                   
341600         DISPLAY '****************************************'               
341700         PERFORM 9100-SQL-ABEND                                           
341800     END-IF.                                                              
341900                                                                          
342000 EJECT                                                                    
342100******************************************************************        
342200*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING     *        
342300*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE CURRENT INPUT *        
342400*    FILE RECORD COUNTS AND THE FILE PROCESSOR INDICATOR.        *        
342500******************************************************************        
342600 4210-UPDATE-TCKRSTINF.                                                   
342700                                                                          
342800     IF PA-TOTAL-RECS-READ > 0                                            
342900        MOVE PA-TOTAL-RECS-READ TO                                        
343000           CR-CUSTOMS-RECS-WORKED                                         
343100     ELSE                                                                 
343200        MOVE 0 TO CR-CUSTOMS-RECS-WORKED                                  
343300     END-IF.                                                              
343400     MOVE CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.           
343500     MOVE 4022                TO TCKRSTINF-WORK-STRG-DESC-LEN.            
343600                                                                          
343700     PERFORM WITH TEST AFTER                                              
343800             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
343900             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
344000                     SQLCODE = ZERO                                       
344100                                                                          
344200         EXEC SQL                                                         
344300             UPDATE TCKRSTINF                                             
344400             SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC             
344500             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME              
344600         END-EXEC                                                         
344700                                                                          
344800         EVALUATE TRUE                                                    
344900             WHEN SQLCODE = ZERO                                          
345000             WHEN SQLCODE = -904                                          
345100             WHEN SQLCODE = -913                                          
345200                  CONTINUE                                                
345300                                                                          
345400             WHEN SQLWARN0 NOT EQUAL SPACE                                
345500             WHEN SQLCODE NOT EQUAL ZERO                                  
345600                 DISPLAY '**************************************'         
345700                 DISPLAY '** ABEND                            **'         
345800                 DISPLAY '** PROGRAM = TRKUP245               **'         
345900                 DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF**'         
346000                 DISPLAY '** UPDATE TCKRSTINF                 **'         
346100                 DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                    
346200                 DISPLAY '**************************************'         
346300                 PERFORM 9100-SQL-ABEND                                   
346400         END-EVALUATE                                                     
346500     END-PERFORM.                                                         
346600                                                                          
346700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
346800         SQLCODE NOT = ZERO                                               
346900         DISPLAY '****************************************'               
347000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
347100         DISPLAY '** UPDATE TCKRSTINF                   **'               
347200         DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF  **'               
347300         DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                            
347400         DISPLAY '****************************************'               
347500         PERFORM 9100-SQL-ABEND                                           
347600     END-IF.                                                              
347700                                                                          
347800 EJECT                                                                    
347900******************************************************************        
348000*  ISSUES AN SQL COMMIT AFTER A LOGICAL UNIT OF WORK HAS BEEN    *        
348100*  COMPLETED.                                                    *        
348200******************************************************************        
348300 4300-COMMIT.                                                             
348400                                                                          
348500     EXEC SQL                                                             
348600         COMMIT                                                           
348700     END-EXEC.                                                            
348800                                                                          
348900     EVALUATE TRUE                                                        
349000         WHEN SQLWARN0 NOT EQUAL SPACE                                    
349100         WHEN SQLCODE NOT EQUAL ZERO                                      
349200     DISPLAY '**********************************'                         
349300     DISPLAY '**********************************'                         
349400     DISPLAY '** ABEND **'                                                
349500     DISPLAY '** PROGRAM = TRKUP245 **'                                   
349600     DISPLAY '** PARAGRAPH = 4300-COMMIT**'                               
349700     DISPLAY '**UNSUCCESSFUL COMMIT**'                                    
349800     DISPLAY '**********************************'                         
349900             PERFORM 9100-SQL-ABEND                                       
350000         WHEN SQLCODE EQUAL ZERO                                          
350100             ADD +1 TO PA-TOTAL-COMMITS                                   
350200     END-EVALUATE.                                                        
350300                                                                          
350400 EJECT                                                                    
350500*****************************************************************         
350600* MOVE THE FIELDS THAT ARE UNIQUE TO EACH RECORD TYPE.                    
350700* THIS COMPLETES THE RECORD SETUP PRIOR TO INSERTING TO THE               
350800* DB2 WORKTABLE (TOUTTRA).                                                
350900*****************************************************************         
351000 5000-MOVE-TO-TR241.                                                      
351100                                                                          
351200     INITIALIZE TR241-RECORD.                                             
351300                                                                          
351400     EVALUATE TR027-ENF-REC-TYP-CDE                                       
351500        WHEN 'ENF   '                                                     
351600           MOVE TR027-ENF-TRN-TYP TO                                      
351700              TR241-TRN-TYP                                               
351800           MOVE TR027-ENF-PROCESS-SEQ-NBR TO                              
351900              TR241-PROCESS-SEQ-NBR                                       
352000           MOVE TR027-ENF-CSTM-ENTR-ID TO                                 
352100              TR241-CSTM-ENTR-ID                                          
352200           MOVE TR027-ENF-BKR-REF-NBR TO                                  
352300              TR241-BKR-REF-NBR                                           
352400           MOVE TR027-ENF-REC-TYP-CDE TO                                  
352500              TR241-REC-TYP-ENF-CDE                                       
352600           MOVE TR027-ENF-SEQ-NBR TO                                      
352700              TR241-ENF-SEQ-NBR                                           
352800           MOVE SPACES TO                                                 
352900              TR241-ENF-3RD-PARTY-CDE                                     
353000           MOVE TR027-ENF-FILD-DTE TO                                     
353100              TR241-ENF-FILD-DTE                                          
353200           MOVE TR027-ENF-FILD-TM TO                                      
353300           TR241-ENF-FILD-TM                                              
353400           MOVE TR027-ENF-POE-STD-EDI-CDE TO                              
353500              TR241-POE-STD-EDI-CDE                                       
353600           MOVE TR027-ENF-POE-NM TO TR241-POE-NM                          
353700           MOVE TR027-ENF-ENTR-TYP-DESC                                   
353800                                     TO TR241-ENF-ENTR-TYP-DESC           
353900           MOVE TR027-ENF-ENTR-TYP-CDE                                    
354000                                     TO TR241-ENF-ENTR-TYP-CDE            
354100           MOVE TR027-ENF-MOM-TRIP-TYP-CDE                                
354200                                 TO TR241-ENF-MOM-TRIP-TYP-CDE            
354300           MOVE TR027-ENF-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
354400        WHEN 'ENFBOL'                                                     
354500           MOVE TR027-ENFBOL-TRN-TYP TO                                   
354600              TR241-TRN-TYP                                               
354700           MOVE TR027-ENFBOL-PROCESS-SEQ-NBR TO                           
354800              TR241-PROCESS-SEQ-NBR                                       
354900           MOVE TR027-ENFBOL-CSTM-ENTR-ID TO                              
355000              TR241-CSTM-ENTR-ID                                          
355100           MOVE TR027-ENFBOL-BKR-REF-NBR TO                               
355200              TR241-BKR-REF-NBR                                           
355300           MOVE TR027-ENFBOL-REC-TYP-CDE TO                               
355400              TR241-REC-TYP-ENFBOL-CDE                                    
355500           MOVE TR027-ENFBOL-SEQ-NBR TO                                   
355600              TR241-ENFBOL-SEQ-NBR                                        
355700           MOVE SPACES TO                                                 
355800              TR241-ENFBOL-3RD-PARTY-CDE                                  
355900           MOVE TR027-ENFBOL-MSTR-BOL-NBR TO                              
356000              TR241-ENFBOL-MSTR-BOL-NBR                                   
356100           MOVE TR027-ENFBOL-HSE-BOL-NBR TO                               
356200              TR241-ENFBOL-HSE-BOL-NBR                                    
356300           MOVE TR027-ENFBOL-CARR-SCAC-ID                                 
356400                       TO TR241-ENFBOL-CARR-SCAC-ID                       
356500           MOVE TR027-ENFBOL-POE-STD-EDI-CDE TO                           
356600              TR241-POE-STD-EDI-CDE                                       
356700           MOVE TR027-ENFBOL-POE-NM TO TR241-POE-NM                       
356800           MOVE TR027-ENFBOL-ENT-ID TO TR241-DAT-SRC-ENT-ID               
356900        WHEN 'ENFCON'                                                     
357000           MOVE TR027-ENFCON-TRN-TYP TO                                   
357100              TR241-TRN-TYP                                               
357200           MOVE TR027-ENFCON-PROCESS-SEQ-NBR TO                           
357300              TR241-PROCESS-SEQ-NBR                                       
357400           MOVE TR027-ENFCON-CSTM-ENTR-ID TO                              
357500              TR241-CSTM-ENTR-ID                                          
357600           MOVE TR027-ENFCON-BKR-REF-NBR TO                               
357700              TR241-BKR-REF-NBR                                           
357800           MOVE TR027-ENFCON-REC-TYP-CDE TO                               
357900              TR241-REC-TYP-ENFCON-CDE                                    
358000           MOVE TR027-ENFCON-SEQ-NBR TO                                   
358100              TR241-ENFCON-SEQ-NBR                                        
358200           MOVE SPACES TO                                                 
358300              TR241-ENFCON-3RD-PARTY-CDE                                  
358400           MOVE TR027-ENFCON-CONTNR-ID TO                                 
358500              TR241-ENFCON-CONTNR-ID                                      
358600           MOVE TR027-ENFCON-POE-STD-EDI-CDE TO                           
358700              TR241-POE-STD-EDI-CDE                                       
358800           MOVE TR027-ENFCON-POE-NM TO TR241-POE-NM                       
358900           MOVE TR027-ENFCON-ENT-ID TO TR241-DAT-SRC-ENT-ID               
359000        WHEN 'DOP   '                                                     
359100           MOVE TR027-DOP-TRN-TYP TO                                      
359200              TR241-TRN-TYP                                               
359300           MOVE TR027-DOP-PROCESS-SEQ-NBR TO                              
359400              TR241-PROCESS-SEQ-NBR                                       
359500           MOVE TR027-DOP-CSTM-ENTR-ID TO                                 
359600              TR241-CSTM-ENTR-ID                                          
359700           MOVE TR027-DOP-BKR-REF-NBR TO                                  
359800              TR241-BKR-REF-NBR                                           
359900           MOVE TR027-DOP-REC-TYP-CDE TO                                  
360000              TR241-REC-TYP-DOP-CDE                                       
360100           MOVE TR027-DOP-SEQ-NBR TO                                      
360200              TR241-DOP-SEQ-NBR                                           
360300           MOVE SPACES TO                                                 
360400              TR241-DOP-3RD-PARTY-CDE                                     
360500           MOVE TR027-DOP-CONTNR-ID TO                                    
360600              TR241-DOP-CONTNR-ID                                         
360700           MOVE TR027-DOP-POE-STD-EDI-CDE TO                              
360800              TR241-POE-STD-EDI-CDE                                       
360900           MOVE TR027-DOP-POE-NM TO TR241-POE-NM                          
361000           MOVE TR027-DOP-DELY-ORD-SNT-DTE                                
361100                                 TO TR241-DOP-DELY-SNT-DTE                
361200           MOVE TR027-DOP-DELY-ORD-SNT-TM                                 
361300                                 TO TR241-DOP-DELY-SNT-TM                 
361400           MOVE TR027-DOP-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
361500        WHEN 'ENFPO '                                                     
361600           MOVE TR027-ENFPO-TRN-TYP TO                                    
361700              TR241-TRN-TYP                                               
361800           MOVE TR027-ENFPO-PROCESS-SEQ-NBR TO                            
361900              TR241-PROCESS-SEQ-NBR                                       
362000           MOVE TR027-ENFPO-CSTM-ENTR-ID TO                               
362100              TR241-CSTM-ENTR-ID                                          
362200           MOVE TR027-ENFPO-BKR-REF-NBR TO                                
362300              TR241-BKR-REF-NBR                                           
362400           MOVE TR027-ENFPO-REC-TYP-CDE TO                                
362500              TR241-REC-TYP-ENFPO-CDE                                     
362600           MOVE TR027-ENFPO-SEQ-NBR TO                                    
362700              TR241-ENFPO-SEQ-NBR                                         
362800           MOVE TR027-ENFPO-FOB-CDE TO                                    
362900              TR241-ENFPO-FOB-CDE                                         
363000           MOVE SPACES TO                                                 
363100              TR241-ENFPO-3RD-PARTY-CDE                                   
363200           MOVE TR027-ENFPO-PO-NBR TO                                     
363300              TR241-ENFPO-PO-NBR                                          
363400           MOVE TR027-ENFPO-EXTL-REF-NBR TO                               
363500              TR241-ENFPO-EXTL-REF-NBR                                    
363600           MOVE TR027-ENFPO-POE-STD-EDI-CDE TO                            
363700              TR241-POE-STD-EDI-CDE                                       
363800           MOVE TR027-ENFPO-POE-NM TO TR241-POE-NM                        
363900           MOVE TR027-ENFPO-ENT-ID TO TR241-DAT-SRC-ENT-ID                
364000        WHEN 'EXD   '                                                     
364100           MOVE TR027-EXD-TRN-TYP TO                                      
364200              TR241-TRN-TYP                                               
364300           MOVE TR027-EXD-PROCESS-SEQ-NBR TO                              
364400              TR241-PROCESS-SEQ-NBR                                       
364500           MOVE TR027-EXD-CSTM-ENTR-ID TO                                 
364600              TR241-CSTM-ENTR-ID                                          
364700           MOVE TR027-EXD-BKR-REF-NBR TO                                  
364800              TR241-BKR-REF-NBR                                           
364900           MOVE TR027-EXD-REC-TYP-CDE TO                                  
365000              TR241-REC-TYP-EXD-CDE                                       
365100           MOVE TR027-EXD-SEQ-NBR TO                                      
365200              TR241-EXD-SEQ-NBR                                           
365300           MOVE SPACES TO                                                 
365400              TR241-EXD-3RD-PARTY-CDE                                     
365500           MOVE TR027-EXD-EXM-DTE TO                                      
365600              TR241-EXD-EXM-DTE                                           
365700           MOVE TR027-EXD-EXM-TM TO                                       
365800              TR241-EXD-EXM-TM                                            
365900           MOVE TR027-EXD-POE-STD-EDI-CDE TO                              
366000              TR241-POE-STD-EDI-CDE                                       
366100           MOVE TR027-EXD-POE-NM TO TR241-POE-NM                          
366200           MOVE TR027-EXD-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
366300        WHEN 'REJ   '                                                     
366400           MOVE TR027-REJ-TRN-TYP  TO                                     
366500              TR241-TRN-TYP                                               
366600           MOVE TR027-REJ-PROCESS-SEQ-NBR TO                              
366700              TR241-PROCESS-SEQ-NBR                                       
366800           MOVE TR027-REJ-CSTM-ENTR-ID TO                                 
366900              TR241-CSTM-ENTR-ID                                          
367000           MOVE TR027-REJ-BKR-REF-NBR TO                                  
367100              TR241-BKR-REF-NBR                                           
367200           MOVE TR027-REJ-REC-TYP-CDE TO                                  
367300              TR241-REC-TYP-REJ-CDE                                       
367400           MOVE TR027-REJ-SEQ-NBR TO                                      
367500              TR241-REJ-SEQ-NBR                                           
367600           MOVE SPACES TO                                                 
367700              TR241-REJ-3RD-PARTY-CDE                                     
367800           MOVE TR027-REJ-REJ-DTE TO                                      
367900              TR241-REJ-REJ-DTE                                           
368000           MOVE TR027-REJ-REJ-TM TO                                       
368100              TR241-REJ-REJ-TM                                            
368200           MOVE TR027-REJ-REJ-DESC TO                                     
368300              TR241-REJ-REJ-DESC                                          
368400           MOVE TR027-REJ-POE-STD-EDI-CDE TO                              
368500              TR241-POE-STD-EDI-CDE                                       
368600           MOVE TR027-REJ-POE-NM TO TR241-POE-NM                          
368700           MOVE TR027-REJ-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
368800        WHEN 'ECR   '                                                     
368900           MOVE TR027-ECR-TRN-TYP TO                                      
369000              TR241-TRN-TYP                                               
369100           MOVE TR027-ECR-PROCESS-SEQ-NBR TO                              
369200              TR241-PROCESS-SEQ-NBR                                       
369300           MOVE TR027-ECR-CSTM-ENTR-ID TO                                 
369400              TR241-CSTM-ENTR-ID                                          
369500           MOVE TR027-ECR-BKR-REF-NBR TO                                  
369600              TR241-BKR-REF-NBR                                           
369700           MOVE TR027-ECR-REC-TYP-CDE TO                                  
369800              TR241-REC-TYP-ECR-CDE                                       
369900           MOVE TR027-ECR-SEQ-NBR TO                                      
370000              TR241-ECR-SEQ-NBR                                           
370100           MOVE SPACES TO                                                 
370200              TR241-ECR-3RD-PARTY-CDE                                     
370300           MOVE TR027-ECR-EST-CLR-DTE TO                                  
370400              TR241-ECR-EST-CLR-DTE                                       
370500           MOVE TR027-ECR-EST-CLR-TM TO                                   
370600              TR241-ECR-EST-CLR-TM                                        
370700           MOVE TR027-ECR-POE-STD-EDI-CDE TO                              
370800              TR241-POE-STD-EDI-CDE                                       
370900           MOVE TR027-ECR-POE-NM TO TR241-POE-NM                          
371000           MOVE TR027-ECR-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
371100        WHEN 'RLS   '                                                     
371200           MOVE TR027-RLS-TRN-TYP TO                                      
371300              TR241-TRN-TYP                                               
371400           MOVE TR027-RLS-PROCESS-SEQ-NBR TO                              
371500              TR241-PROCESS-SEQ-NBR                                       
371600           MOVE TR027-RLS-CSTM-ENTR-ID TO                                 
371700              TR241-CSTM-ENTR-ID                                          
371800           MOVE TR027-RLS-BKR-REF-NBR TO                                  
371900              TR241-BKR-REF-NBR                                           
372000           MOVE TR027-RLS-REC-TYP-CDE TO                                  
372100              TR241-REC-TYP-RLS-CDE                                       
372200           MOVE TR027-RLS-SEQ-NBR TO                                      
372300              TR241-RLS-SEQ-NBR                                           
372400           MOVE SPACES TO                                                 
372500              TR241-RLS-3RD-PARTY-CDE                                     
372600           MOVE TR027-RLS-ACTL-CLR-DTE TO                                 
372700              TR241-RLS-ACTL-CLR-DTE                                      
372800           MOVE TR027-RLS-ACTL-CLR-TM TO                                  
372900              TR241-RLS-ACTL-CLR-TM                                       
373000           MOVE TR027-RLS-POE-STD-EDI-CDE TO                              
373100              TR241-POE-STD-EDI-CDE                                       
373200           MOVE TR027-RLS-POE-NM TO TR241-POE-NM                          
373300           MOVE TR027-RLS-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
373400        WHEN 'LIQ   '                                                     
373500           MOVE TR027-LIQ-TRN-TYP TO                                      
373600              TR241-TRN-TYP                                               
373700           MOVE TR027-LIQ-PROCESS-SEQ-NBR TO                              
373800              TR241-PROCESS-SEQ-NBR                                       
373900           MOVE TR027-LIQ-CSTM-ENTR-ID TO                                 
374000              TR241-CSTM-ENTR-ID                                          
374100           MOVE TR027-LIQ-BKR-REF-NBR TO                                  
374200              TR241-BKR-REF-NBR                                           
374300           MOVE TR027-LIQ-REC-TYP-CDE TO                                  
374400              TR241-REC-TYP-LIQ-CDE                                       
374500           MOVE TR027-LIQ-SEQ-NBR TO                                      
374600              TR241-LIQ-SEQ-NBR                                           
374700           MOVE TR027-LIQ-BKR-REF-NBR TO                                  
374800              TR241-LIQ-3RD-PARTY-CDE                                     
374900           MOVE TR027-LIQ-LQDN-DTE TO                                     
375000              TR241-LIQ-LQDN-DTE                                          
375100           MOVE TR027-LIQ-LQDN-TM TO                                      
375200              TR241-LIQ-LQDN-TM                                           
375300           MOVE TR027-LIQ-POE-STD-EDI-CDE TO                              
375400              TR241-POE-STD-EDI-CDE                                       
375500           MOVE TR027-LIQ-POE-NM TO TR241-POE-NM                          
375600           MOVE TR027-LIQ-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
375700        WHEN 'LSU   '                                                     
375800           MOVE TR027-LSU-TRN-TYP TO                                      
375900              TR241-TRN-TYP                                               
376000           MOVE TR027-LSU-PROCESS-SEQ-NBR TO                              
376100              TR241-PROCESS-SEQ-NBR                                       
376200           MOVE TR027-LSU-CSTM-ENTR-ID TO                                 
376300              TR241-CSTM-ENTR-ID                                          
376400           MOVE TR027-LSU-BKR-REF-NBR TO                                  
376500              TR241-BKR-REF-NBR                                           
376600           MOVE TR027-LSU-REC-TYP-CDE TO                                  
376700              TR241-REC-TYP-LSU-CDE                                       
376800           MOVE TR027-LSU-SEQ-NBR TO                                      
376900              TR241-LSU-SEQ-NBR                                           
377000           MOVE SPACES TO                                                 
377100              TR241-LSU-3RD-PARTY-CDE                                     
377200           MOVE TR027-LSU-LQDN-SSPNN-DTE TO                               
377300              TR241-LSU-LQDN-SSPNN-DTE                                    
377400           MOVE TR027-LSU-LQDN-SSPNN-TM TO                                
377500              TR241-LSU-LQDN-SSPNN-TM                                     
377600           MOVE TR027-LSU-LQDN-SSPNN-DESC TO                              
377700              TR241-LSU-LQDN-SSPNN-DESC                                   
377800           MOVE TR027-LSU-POE-STD-EDI-CDE TO                              
377900              TR241-POE-STD-EDI-CDE                                       
378000           MOVE TR027-LSU-POE-NM TO TR241-POE-NM                          
378100           MOVE TR027-LSU-ENT-ID TO TR241-DAT-SRC-ENT-ID                  
378200     END-EVALUATE.                                                        
378300     PERFORM 6128-CLEAR-ERROR-FIELDS.                                     
378400                                                                          
378500                                                                          
378600 EJECT                                                                    
378700******************************************************************        
378800* MOVE TIMCSEN TO TAUCSEN                                                 
378900******************************************************************        
379000 5100-MOVE-TIMCSEN-TO-TAUCSEN.                                            
379100                                                                          
379200     INITIALIZE DCLTAUCSEN.                                               
379300                                                                          
379400     MOVE IMCSEN-CSTM-ENTR-ID       TO AUCSEN-CSTM-ENTR-ID.               
379500     MOVE IMCSEN-ENT-ID             TO AUCSEN-ENT-ID.                     
379600     MOVE IMCSEN-BKR-REF-NBR        TO AUCSEN-BKR-REF-NBR.                
379700     MOVE IMCSEN-FILD-TMST          TO AUCSEN-FILD-TMST.                  
379800     MOVE IMCSEN-EST-CLR-TMST       TO AUCSEN-EST-CLR-TMST.               
379900     MOVE IMCSEN-ACTL-CLR-TMST      TO AUCSEN-ACTL-CLR-TMST.              
380000     MOVE IMCSEN-EXM-TMST           TO AUCSEN-EXM-TMST.                   
380100     MOVE IMCSEN-REJ-TMST           TO AUCSEN-REJ-TMST.                   
380200     MOVE IMCSEN-REJ-DESC           TO AUCSEN-REJ-DESC.                   
380300     MOVE IMCSEN-LQDN-TMST          TO AUCSEN-LQDN-TMST.                  
380400     MOVE IMCSEN-LQDN-SSPNN-TMST    TO AUCSEN-LQDN-SSPNN-TMST.            
380500     MOVE IMCSEN-LQDN-SSPNN-DESC    TO AUCSEN-LQDN-SSPNN-DESC.            
380600     MOVE IMCSEN-DAT-SRC-ENT-ID     TO AUCSEN-DAT-SRC-ENT-ID.             
380700     MOVE IMCSEN-MOM-DEST-POE-CDE   TO AUCSEN-MOM-DEST-POE-CDE.           
380800     MOVE IMCSEN-LAST-UPD-BY-USR-ID TO AUCSEN-LAST-UPD-BY-USR-ID.         
380900     MOVE IMCSEN-LAST-UPD-TMST      TO AUCSEN-LAST-UPD-TMST.              
381000     MOVE IMCSEN-MOM-TRIP-TYP-CDE   TO AUCSEN-MOM-TRIP-TYP-CDE.           
381100     MOVE IMCSEN-ENTR-TYP-CDE       TO AUCSEN-ENTR-TYP-CDE.               
381200                                                                          
381300                                                                          
381400******************************************************************        
381500* MOVE TIMCSBL TO TAUCSBL                                                 
381600******************************************************************        
381700                                                                          
381800 5200-MOVE-TIMCSBL-TO-TAUCSBL.                                            
381900                                                                          
382000     INITIALIZE DCLTAUCSBL.                                               
382100                                                                          
382200     MOVE IMCSBL-CSTM-ENTR-ID       TO AUCSBL-CSTM-ENTR-ID.               
382300     MOVE IMCSBL-MSTR-BOL-NBR       TO AUCSBL-MSTR-BOL-NBR.               
382400     MOVE IMCSBL-HSE-BOL-NBR        TO AUCSBL-HSE-BOL-NBR.                
382500     MOVE IMCSBL-LAST-UPD-BY-USR-ID TO AUCSBL-LAST-UPD-BY-USR-ID.         
382600     MOVE IMCSBL-LAST-UPD-TMST      TO AUCSBL-LAST-UPD-TMST.              
382700                                                                          
382800******************************************************************        
382900* MOVE TIMCSCN TO TAUCSCN                                                 
383000******************************************************************        
383100 5300-MOVE-TIMCSCN-TO-TAUCSCN.                                            
383200                                                                          
383300     INITIALIZE DCLTAUCSCN.                                               
383400                                                                          
383500     MOVE IMCSCN-CSTM-ENTR-ID       TO AUCSCN-CSTM-ENTR-ID.               
383600     MOVE IMCSCN-CONTNR-ID          TO AUCSCN-CONTNR-ID.                  
383700     MOVE IMCSCN-DO-TO-DCONSLR-TMST TO AUCSCN-DO-TO-DCONSLR-TMST.         
383800     MOVE IMCSCN-LAST-UPD-BY-USR-ID TO AUCSCN-LAST-UPD-BY-USR-ID.         
383900     MOVE IMCSCN-LAST-UPD-TMST      TO AUCSCN-LAST-UPD-TMST.              
384000                                                                          
384100******************************************************************        
384200* MOVE TIMCSPO TO TAUCSPO                                                 
384300******************************************************************        
384400 5400-MOVE-TIMCSPO-TO-TAUCSPO.                                            
384500                                                                          
384600     INITIALIZE DCLTAUCSPO.                                               
384700                                                                          
384800     MOVE IMCSPO-CSTM-ENTR-ID       TO AUCSPO-CSTM-ENTR-ID.               
384900     MOVE IMCSPO-PO-NBR             TO AUCSPO-PO-NBR.                     
385000     MOVE IMCSPO-LAST-UPD-BY-USR-ID TO AUCSPO-LAST-UPD-BY-USR-ID.         
385100     MOVE IMCSPO-LAST-UPD-TMST      TO AUCSPO-LAST-UPD-TMST.              
385200******************************************************************        
385300* MOVE TIMCNPO TO TAUCNPO                                                 
385400******************************************************************        
385500 5410-MOVE-TIMCNPO-TO-TAUCNPO.                                            
385600                                                                          
385700     MOVE IMCNPO-CONTNR-ID          TO AUCNPO-CONTNR-ID.                  
385800     MOVE IMCNPO-CONTNR-SEQ-NBR     TO AUCNPO-CONTNR-SEQ-NBR.             
385900     MOVE IMCNPO-PO-NBR             TO AUCNPO-PO-NBR.                     
386000     MOVE IMCNPO-CSTM-ENTR-ID       TO AUCNPO-CSTM-ENTR-ID.               
386100     MOVE IMCNPO-MSTR-BOL-NBR       TO AUCNPO-MSTR-BOL-NBR.               
386200     MOVE IMCNPO-HSE-BOL-NBR        TO AUCNPO-HSE-BOL-NBR.                
386300     MOVE IMCNPO-LTR-OF-CR-NBR      TO AUCNPO-LTR-OF-CR-NBR.              
386400     MOVE IMCNPO-PO-RCVD-DELY-TMST  TO AUCNPO-PO-RCVD-DELY-TMST.          
386500     MOVE IMCNPO-PO-C-O-PROD-CDE    TO AUCNPO-PO-C-O-PROD-CDE.            
386600     MOVE IMCNPO-PO-CART-CNT        TO AUCNPO-PO-CART-CNT.                
386700     MOVE IMCNPO-PO-CBMT-QTY        TO AUCNPO-PO-CBMT-QTY.                
386800     MOVE IMCNPO-PO-WT-KGRM-QTY     TO AUCNPO-PO-WT-KGRM-QTY.             
386900     MOVE IMCNPO-PO-UNT-QTY         TO AUCNPO-PO-UNT-QTY.                 
387000     MOVE IMCNPO-LAST-UPD-BY-USR-ID TO AUCNPO-LAST-UPD-BY-USR-ID.         
387100     MOVE IMCNPO-LAST-UPD-TMST      TO AUCNPO-LAST-UPD-TMST.              
387200     MOVE IMCNPO-EXTL-REF-NBR       TO AUCNPO-EXTL-REF-NBR.               
387300     MOVE IMCNPO-BKR-FRGT-RLSE-CDE  TO AUCNPO-BKR-FRGT-RLSE-CDE.          
387400     MOVE IMCNPO-DO-RCVD-CDE        TO AUCNPO-DO-RCVD-CDE.                
387500     MOVE IMCNPO-CONTNR-PU-CDE      TO AUCNPO-CONTNR-PU-CDE.              
387600     MOVE IMCNPO-ACTL-POE-DELY-CDE  TO AUCNPO-ACTL-POE-DELY-CDE.          
387700     MOVE IMCNPO-DVN-CDE            TO AUCNPO-DVN-CDE.                    
387800     MOVE IMCNPO-DCONSLR-RET-CDE    TO AUCNPO-DCONSLR-RET-CDE.            
387900     MOVE IMCNPO-SPLT-XMIT-CDE      TO AUCNPO-SPLT-XMIT-CDE.              
388000     MOVE IMCNPO-DOC-RCVD-ORGN-TMST TO AUCNPO-DOC-RCVD-ORGN-TMST.         
388100                                                                          
388200******************************************************************        
388300* CREATE TIMCSEN                                                          
388400******************************************************************        
388500 5500-CREATE-TIMCSEN.                                                     
388600                                                                          
388700     INITIALIZE DCLTIMCSEN.                                               
388800                                                                          
388900     MOVE TR027-ENF-CSTM-ENTR-ID  TO IMCSEN-CSTM-ENTR-ID                  
389000     MOVE TR027-ENF-ENT-ID        TO IMCSEN-ENT-ID                        
389100     MOVE PC-CURRENT-PROGRAM-NAME TO IMCSEN-CRE-BY-USR-ID                 
389200                                     IMCSEN-LAST-UPD-BY-USR-ID            
389300     SET PS-INSERT-TIMCSEN        TO TRUE                                 
389400                                                                          
389500     MOVE PC-DEFAULT-TMST TO IMCSEN-FILD-TMST                             
389600                             IMCSEN-EXM-TMST                              
389700                             IMCSEN-REJ-TMST                              
389800                             IMCSEN-EST-CLR-TMST                          
389900                             IMCSEN-ACTL-CLR-TMST                         
390000                             IMCSEN-LQDN-TMST                             
390100                             IMCSEN-LQDN-SSPNN-TMST                       
390200                             IMCSEN-CRE-TMST                              
390300                             IMCSEN-LQDN-SSPNN-TMST                       
390400                             IMCSEN-LAST-UPD-TMST.                        
390500                                                                          
390600     EVALUATE TR027-ENF-REC-TYP-CDE                                       
390700        WHEN 'ENF   '                                                     
390800           MOVE TR027-ENF-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
390900           MOVE PV-FORMAT-TMST        TO IMCSEN-FILD-TMST                 
391000           MOVE TR027-ENF-POE-STD-EDI-CDE TO                              
391100              IMCSEN-MOM-DEST-POE-CDE                                     
391200           MOVE TR027-ENF-ENTR-TYP-CDE                                    
391300                                 TO IMCSEN-ENTR-TYP-CDE                   
391400           MOVE TR027-ENF-MOM-TRIP-TYP-CDE                                
391500                                 TO IMCSEN-MOM-TRIP-TYP-CDE               
391600        WHEN 'EXD   '                                                     
391700           MOVE TR027-EXD-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
391800           MOVE PV-FORMAT-TMST        TO IMCSEN-EXM-TMST                  
391900           MOVE TR027-EXD-POE-STD-EDI-CDE TO                              
392000              IMCSEN-MOM-DEST-POE-CDE                                     
392100        WHEN 'REJ   '                                                     
392200           MOVE TR027-REJ-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
392300           MOVE PV-FORMAT-TMST        TO IMCSEN-REJ-TMST                  
392400           MOVE TR027-REJ-REJ-DESC    TO IMCSEN-REJ-DESC                  
392500           MOVE TR027-REJ-POE-STD-EDI-CDE TO                              
392600              IMCSEN-MOM-DEST-POE-CDE                                     
392700        WHEN 'ECR   '                                                     
392800           MOVE TR027-ECR-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
392900           MOVE PV-FORMAT-TMST        TO IMCSEN-EST-CLR-TMST              
393000           MOVE TR027-ECR-POE-STD-EDI-CDE TO                              
393100              IMCSEN-MOM-DEST-POE-CDE                                     
393200        WHEN 'RLS   '                                                     
393300           MOVE TR027-RLS-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
393400           MOVE PV-FORMAT-TMST        TO IMCSEN-ACTL-CLR-TMST             
393500           MOVE TR027-RLS-POE-STD-EDI-CDE TO                              
393600              IMCSEN-MOM-DEST-POE-CDE                                     
393700        WHEN 'LIQ   '                                                     
393800           MOVE TR027-LIQ-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
393900           MOVE PV-FORMAT-TMST        TO IMCSEN-LQDN-TMST                 
394000           MOVE TR027-LIQ-POE-STD-EDI-CDE TO                              
394100              IMCSEN-MOM-DEST-POE-CDE                                     
394200        WHEN 'LSU   '                                                     
394300           MOVE TR027-LSU-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR               
394400           MOVE PV-FORMAT-TMST        TO IMCSEN-LQDN-SSPNN-TMST           
394500           MOVE TR027-LSU-LQDN-SSPNN-DESC TO                              
394600              IMCSEN-LQDN-SSPNN-DESC                                      
394700           MOVE TR027-LSU-POE-STD-EDI-CDE TO                              
394800              IMCSEN-MOM-DEST-POE-CDE                                     
394900        WHEN 'ENFBOL'                                                     
395000           MOVE TR027-ENFBOL-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR            
395100           MOVE TR027-ENFBOL-POE-STD-EDI-CDE TO                           
395200              IMCSEN-MOM-DEST-POE-CDE                                     
395300        WHEN 'ENFCON'                                                     
395400           MOVE TR027-ENFCON-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR            
395500           MOVE TR027-ENFCON-POE-STD-EDI-CDE TO                           
395600              IMCSEN-MOM-DEST-POE-CDE                                     
395700        WHEN 'ENFPO '                                                     
395800           MOVE TR027-ENFPO-BKR-REF-NBR TO IMCSEN-BKR-REF-NBR             
395900           MOVE TR027-ENFPO-POE-STD-EDI-CDE TO                            
396000              IMCSEN-MOM-DEST-POE-CDE                                     
396100     END-EVALUATE.                                                        
396200******************************************************************        
396300* CREATE TIMCSBL                                                          
396400******************************************************************        
396500 5510-CREATE-TIMCSBL.                                                     
396600                                                                          
396700     INITIALIZE DCLTIMCSBL.                                               
396800                                                                          
396900     MOVE TR027-ENFBOL-CSTM-ENTR-ID  TO IMCSBL-CSTM-ENTR-ID.              
397000     MOVE TR027-ENFBOL-MSTR-BOL-NBR  TO IMCSBL-MSTR-BOL-NBR.              
397100     MOVE TR027-ENFBOL-HSE-BOL-NBR   TO IMCSBL-HSE-BOL-NBR.               
397200     MOVE PC-CURRENT-PROGRAM-NAME    TO IMCSBL-CRE-BY-USR-ID              
397300                                        IMCSBL-LAST-UPD-BY-USR-ID.        
397400     SET PS-INSERT-TIMCSBL           TO TRUE.                             
397500     SET PS-TIMCSBL-AVAIL            TO TRUE.                             
397600                                                                          
397700******************************************************************        
397800* CREATE TIMCSCN                                                          
397900******************************************************************        
398000                                                                          
398100 5520-CREATE-AND-REPORT-TIMCSCN.                                          
398200                                                                          
398300                                                                          
398400     MOVE PC-CURRENT-PROGRAM-NAME    TO IMCSCN-CRE-BY-USR-ID              
398500                                        IMCSCN-LAST-UPD-BY-USR-ID.        
398600     SET PS-INSERT-TIMCSCN           TO TRUE.                             
398700     SET PS-TIMCSCN-AVAIL            TO TRUE.                             
398800     PERFORM 5300-MOVE-TIMCSCN-TO-TAUCSCN.                                
398900     PERFORM 6128-CLEAR-ERROR-FIELDS.                                     
399000     MOVE 'D' TO TR241-RPT-TYP.                                           
399100     PERFORM 7100-INSERT-TOUTTRA-RPT.                                     
399200                                                                          
399300******************************************************************        
399400* CREATE TIMCSPO                                                          
399500******************************************************************        
399600                                                                          
399700 5530-CREATE-TIMCSPO.                                                     
399800                                                                          
399900     INITIALIZE DCLTIMCSPO.                                               
400000                                                                          
400100     MOVE TR027-ENFPO-CSTM-ENTR-ID  TO IMCSPO-CSTM-ENTR-ID.               
400200     MOVE TR027-ENFPO-PO-NBR        TO IMCSPO-PO-NBR.                     
400300     MOVE TR027-ENFPO-EXTL-REF-NBR  TO IMCSPO-EXTL-REF-NBR.               
400400     MOVE PC-CURRENT-PROGRAM-NAME   TO IMCSPO-CRE-BY-USR-ID               
400500                                       IMCSPO-LAST-UPD-BY-USR-ID.         
400600     SET PS-INSERT-TIMCSPO          TO TRUE.                              
400700     SET PS-TIMCSPO-AVAIL           TO TRUE.                              
400800                                                                          
400900******************************************************************        
401000* CREATE WARNINGS FOR CONT/POS ON MULTIPLE CUSTOMS ENTRIES.               
401100******************************************************************        
401200                                                                          
401300 5540-CHECK-FOR-MULT-ENTRIES.                                             
401400                                                                          
401500     PERFORM 7400-OPEN-MLTPL-ENTRY-WRN-CSR.                               
401600     SET PS-EOC-MLTPL-ENTRY-NO     TO TRUE.                               
401700     PERFORM UNTIL PS-EOC-MLTPL-ENTRY                                     
401800       PERFORM 7410-FETCH-MLTPL-ENTRY-WRN-CSR                             
401900       IF PS-EOC-MLTPL-ENTRY                                              
402000          CONTINUE                                                        
402100       ELSE                                                               
402200          PERFORM 5545-BUILD-MLT-RPT-LINES                                
402300       END-IF                                                             
402400     END-PERFORM.                                                         
402500     PERFORM  7420-CLOSE-MLTPL-ENTRY-WRN-CSR.                             
402600                                                                          
402700******************************************************************        
402800* EACH LINE IN THE CURSOR GETS 3 WARNING LINES ON THE REPORT -            
402900* ONE EACH FOR CUSTOMS ENTRY ID, CONTAINER AND PO.                        
403000******************************************************************        
403100 5545-BUILD-MLT-RPT-LINES.                                                
403200                                                                          
403300     SET TR241-MLT-WRN-TYP-ENTRID   TO TRUE.                              
403400     MOVE 'CSTMS ENTRY ID '      TO TR241-DATA-IN-ERROR.                  
403500     MOVE IMCSPO-CSTM-ENTR-ID    TO TR241-DATA-VALUE.                     
403600     PERFORM 6140-ERROR-40.                                               
403700     PERFORM 7100-INSERT-TOUTTRA-RPT.                                     
403800                                                                          
403900     SET TR241-MLT-WRN-TYP-CNTNR    TO TRUE.                              
404000     MOVE 'CONTAINER      '      TO TR241-DATA-IN-ERROR.                  
404100     MOVE IMCSCN-CONTNR-ID       TO TR241-DATA-VALUE.                     
404200     PERFORM 6140-ERROR-40.                                               
404300     PERFORM 7100-INSERT-TOUTTRA-RPT.                                     
404400                                                                          
404500     SET TR241-MLT-WRN-TYP-PO       TO TRUE.                              
404600     MOVE 'PO NUMBER      '      TO TR241-DATA-IN-ERROR.                  
404700     MOVE IMCSPO-PO-NBR          TO TR241-DATA-VALUE.                     
404800     PERFORM 6140-ERROR-40.                                               
404900     PERFORM 7100-INSERT-TOUTTRA-RPT.                                     
405000                                                                          
405100******************************************************************        
405200* READ THE CUSTOMS FILE.                                                  
405300******************************************************************        
405400 6000-READ-CUSTOMS-FILE.                                                  
405500     READ TR027-CUSTOMS-FILE                                              
405600         INTO TR027-REC-TYP-ENF                                           
405700         AT END                                                           
405800           SET PS-END-OF-INPUT TO TRUE.                                   
405900                                                                          
406000     IF PS-END-OF-INPUT                                                   
406100         CONTINUE                                                         
406200     ELSE                                                                 
406300                                                                          
406400         ADD +1 TO PA-TOTAL-RECS-READ                                     
406500         EVALUATE TR027-ENF-TRN-TYP                                       
406600            WHEN 'A'                                                      
406700               ADD +1 TO PA-TOT-TRN-TYP-A                                 
406800            WHEN 'C'                                                      
406900               ADD +1 TO PA-TOT-TRN-TYP-C                                 
407000            WHEN 'D'                                                      
407100               ADD +1 TO PA-TOT-TRN-TYP-D                                 
407200         END-EVALUATE                                                     
407300         MOVE TR027-REC-TYP-ENF (1:3) TO PV-EDI-RECORDS                   
407400         IF EDI-RECORD                                                    
407500             ADD +1 TO PA-TOTAL-ISA-RECS-READ                             
407600         ELSE                                                             
407700            SET PS-GOOD-RECORD TO TRUE                                    
407800            EVALUATE TR027-ENF-REC-TYP-CDE                                
407900               WHEN 'ENF   '                                              
408000                  ADD +1 TO PA-TOT-ENF-RECS-READ                          
408100                  MOVE TR027-ENF-FILD-DTE                                 
408200                      TO PV-HOLD-ENF-FILD-DTE                             
408300                  MOVE TR027-ENF-FILD-DTE (1:4) TO                        
408400                     PV-FORMAT-TMST-DTE-CY                                
408500                  MOVE TR027-ENF-FILD-DTE (5:2) TO                        
408600                     PV-FORMAT-TMST-DTE-MM                                
408700                  MOVE TR027-ENF-FILD-DTE (7:2) TO                        
408800                     PV-FORMAT-TMST-DTE-DD                                
408900                  MOVE TR027-ENF-FILD-TM (1:2) TO                         
409000                     PV-FORMAT-TMST-TM-HH                                 
409100                  MOVE TR027-ENF-FILD-TM (3:2) TO                         
409200                     PV-FORMAT-TMST-TM-MM                                 
409300               WHEN 'ENFBOL'                                              
409400                  ADD +1 TO PA-TOT-ENFBOL-RECS-READ                       
409500               WHEN 'ENFCON'                                              
409600                  ADD +1 TO PA-TOT-ENFCON-RECS-READ                       
409700               WHEN 'DOP   '                                              
409800                  ADD +1 TO PA-TOT-DOP-RECS-READ                          
409900                  MOVE TR027-DOP-DELY-ORD-SNT-DTE (1:4) TO                
410000                     PV-FORMAT-TMST-DTE-CY                                
410100                  MOVE TR027-DOP-DELY-ORD-SNT-DTE (5:2) TO                
410200                     PV-FORMAT-TMST-DTE-MM                                
410300                  MOVE TR027-DOP-DELY-ORD-SNT-DTE (7:2) TO                
410400                     PV-FORMAT-TMST-DTE-DD                                
410500                  MOVE TR027-DOP-DELY-ORD-SNT-TM (1:2) TO                 
410600                     PV-FORMAT-TMST-TM-HH                                 
410700                  MOVE TR027-DOP-DELY-ORD-SNT-TM (3:2) TO                 
410800                     PV-FORMAT-TMST-TM-MM                                 
410900               WHEN 'ENFPO '                                              
411000                  ADD +1 TO PA-TOT-ENFPO-RECS-READ                        
411100               WHEN 'EXD   '                                              
411200                  ADD +1 TO PA-TOT-EXD-RECS-READ                          
411300                  MOVE TR027-EXD-EXM-DTE (1:4) TO                         
411400                     PV-FORMAT-TMST-DTE-CY                                
411500                  MOVE TR027-EXD-EXM-DTE (5:2) TO                         
411600                     PV-FORMAT-TMST-DTE-MM                                
411700                  MOVE TR027-EXD-EXM-DTE (7:2) TO                         
411800                     PV-FORMAT-TMST-DTE-DD                                
411900                  MOVE TR027-EXD-EXM-TM (1:2) TO                          
412000                     PV-FORMAT-TMST-TM-HH                                 
412100                  MOVE TR027-EXD-EXM-TM (3:2) TO                          
412200                     PV-FORMAT-TMST-TM-MM                                 
412300               WHEN 'REJ   '                                              
412400                  ADD +1 TO PA-TOT-REJ-RECS-READ                          
412500                  MOVE TR027-REJ-REJ-DTE (1:4) TO                         
412600                     PV-FORMAT-TMST-DTE-CY                                
412700                  MOVE TR027-REJ-REJ-DTE (5:2) TO                         
412800                     PV-FORMAT-TMST-DTE-MM                                
412900                  MOVE TR027-REJ-REJ-DTE (7:2) TO                         
413000                     PV-FORMAT-TMST-DTE-DD                                
413100                  MOVE TR027-REJ-REJ-TM (1:2) TO                          
413200                     PV-FORMAT-TMST-TM-HH                                 
413300                  MOVE TR027-REJ-REJ-TM (3:2) TO                          
413400                     PV-FORMAT-TMST-TM-MM                                 
413500               WHEN 'ECR   '                                              
413600                  ADD +1 TO PA-TOT-ECR-RECS-READ                          
413700                  MOVE TR027-ECR-EST-CLR-DTE (1:4) TO                     
413800                     PV-FORMAT-TMST-DTE-CY                                
413900                  MOVE TR027-ECR-EST-CLR-DTE (5:2) TO                     
414000                     PV-FORMAT-TMST-DTE-MM                                
414100                  MOVE TR027-ECR-EST-CLR-DTE (7:2) TO                     
414200                     PV-FORMAT-TMST-DTE-DD                                
414300                  MOVE TR027-ECR-EST-CLR-TM (1:2) TO                      
414400                     PV-FORMAT-TMST-TM-HH                                 
414500                  MOVE TR027-ECR-EST-CLR-TM (3:2) TO                      
414600                     PV-FORMAT-TMST-TM-MM                                 
414700               WHEN 'RLS   '                                              
414800                  ADD +1 TO PA-TOT-RLS-RECS-READ                          
414900                  MOVE TR027-RLS-ACTL-CLR-DTE (1:4) TO                    
415000                     PV-FORMAT-TMST-DTE-CY                                
415100                  MOVE TR027-RLS-ACTL-CLR-DTE (5:2) TO                    
415200                     PV-FORMAT-TMST-DTE-MM                                
415300                  MOVE TR027-RLS-ACTL-CLR-DTE (7:2) TO                    
415400                     PV-FORMAT-TMST-DTE-DD                                
415500                  MOVE TR027-RLS-ACTL-CLR-TM (1:2) TO                     
415600                     PV-FORMAT-TMST-TM-HH                                 
415700                  MOVE TR027-RLS-ACTL-CLR-TM (3:2) TO                     
415800                     PV-FORMAT-TMST-TM-MM                                 
415900               WHEN 'LIQ   '                                              
416000                  ADD +1 TO PA-TOT-LIQ-RECS-READ                          
416100                  MOVE TR027-LIQ-LQDN-DTE (1:4) TO                        
416200                     PV-FORMAT-TMST-DTE-CY                                
416300                  MOVE TR027-LIQ-LQDN-DTE (5:2) TO                        
416400                     PV-FORMAT-TMST-DTE-MM                                
416500                  MOVE TR027-LIQ-LQDN-DTE (7:2) TO                        
416600                     PV-FORMAT-TMST-DTE-DD                                
416700                  MOVE TR027-LIQ-LQDN-TM (1:2) TO                         
416800                     PV-FORMAT-TMST-TM-HH                                 
416900                  MOVE TR027-LIQ-LQDN-TM (3:2) TO                         
417000                     PV-FORMAT-TMST-TM-MM                                 
417100               WHEN 'LSU   '                                              
417200                  ADD +1 TO PA-TOT-LSU-RECS-READ                          
417300                  MOVE TR027-LSU-LQDN-SSPNN-DTE (1:4) TO                  
417400                     PV-FORMAT-TMST-DTE-CY                                
417500                  MOVE TR027-LSU-LQDN-SSPNN-DTE (5:2) TO                  
417600                     PV-FORMAT-TMST-DTE-MM                                
417700                  MOVE TR027-LSU-LQDN-SSPNN-DTE (7:2) TO                  
417800                     PV-FORMAT-TMST-DTE-DD                                
417900                  MOVE TR027-LSU-LQDN-SSPNN-TM (1:2) TO                   
418000                     PV-FORMAT-TMST-TM-HH                                 
418100                  MOVE TR027-LSU-LQDN-SSPNN-TM (3:2) TO                   
418200                     PV-FORMAT-TMST-TM-MM                                 
418300            END-EVALUATE                                                  
418400         END-IF                                                           
418500     END-IF.                                                              
418600                                                                          
418700*****************************************************************         
418800* ERROR MESSAGE # 1                                                       
418900*                       NOT USED AT THIS TIME                             
419000*****************************************************************         
419100*6100-ERROR-1.                                                            
419200***                                                                       
419300***  MOVE PC-E                   TO TR241-RPT-TYP.                        
419400***  MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
419500***  MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
419600***  MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
419700***  MOVE 'ADD SENT-ENTRY PREVIOUSLY SENT-NOT PROCESSED'                  
419800***                              TO TR241-ERROR-MSG.                      
419900***  ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
420000*****************************************************************         
420100* ERROR MESSAGE # 2                                                       
420200*****************************************************************         
420300 6101-ERROR-2.                                                            
420400                                                                          
420500     MOVE PC-E                   TO TR241-RPT-TYP.                        
420600     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
420700     MOVE 'CHANGE SENT - NOTHING CHANGED - NOT PROCESSED'                 
420800                                 TO TR241-ERROR-MSG.                      
420900     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
421000*****************************************************************         
421100* ERROR MESSAGE # 3                                                       
421200*****************************************************************         
421300 6102-ERROR-3.                                                            
421400                                                                          
421500     MOVE PC-E                   TO TR241-RPT-TYP.                        
421600     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
421700     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
421800     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
421900     MOVE 'ENTRY CHANGE SENT - NOT FND - ENTRY ADDED'                     
422000                                 TO TR241-ERROR-MSG.                      
422100     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
422200*****************************************************************         
422300* ERROR MESSAGE # 4                                                       
422400*****************************************************************         
422500 6103-ERROR-4.                                                            
422600                                                                          
422700     MOVE PC-E                   TO TR241-RPT-TYP.                        
422800     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
422900     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
423000     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
423100     MOVE 'DELETE SENT-CUSTOMS ENTRY NOT FND-NOT PROCESSED'               
423200                                 TO TR241-ERROR-MSG.                      
423300     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
423400*****************************************************************         
423500* ERROR MESSAGE # 5                                                       
423600*****************************************************************         
423700 6104-ERROR-5.                                                            
423800                                                                          
423900     MOVE PC-E                   TO TR241-RPT-TYP.                        
424000     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
424100     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
424200     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
424300     MOVE 'OTHR CSTMS ENTRY INFO SNT BFORE FILED DT-PROCESSED'            
424400                                 TO TR241-ERROR-MSG.                      
424500     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
424600*****************************************************************         
424700* ERROR MESSAGE # 6                                                       
424800*****************************************************************         
424900 6105-ERROR-6.                                                            
425000                                                                          
425100     MOVE PC-E                   TO TR241-RPT-TYP.                        
425200     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
425300     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
425400     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
425500     MOVE 'DELETE SENT - NO DATA TO DELETE - NOT PROCESSED'               
425600                                 TO TR241-ERROR-MSG.                      
425700     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
425800*****************************************************************         
425900* ERROR MESSAGE # 7                                                       
426000*****************************************************************         
426100 6106-ERROR-7.                                                            
426200                                                                          
426300     MOVE PC-E                   TO TR241-RPT-TYP.                        
426400     MOVE 'BILL OF LADING'       TO TR241-DATA-IN-ERROR.                  
426500     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
426600     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
426700     MOVE 'ADD SENT-BOL PREVIOUSLY SENT-NOT PROCESSED'                    
426800                                 TO TR241-ERROR-MSG.                      
426900     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
427000*****************************************************************         
427100* ERROR MESSAGE # 8                                                       
427200*****************************************************************         
427300 6107-ERROR-8.                                                            
427400                                                                          
427500     MOVE PC-E                   TO TR241-RPT-TYP.                        
427600     MOVE 'BILL OF LADING'       TO TR241-DATA-IN-ERROR.                  
427700     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
427800     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
427900     MOVE 'DELETE SENT - BOL NOT FND - NOT PROCESSED'                     
428000                                 TO TR241-ERROR-MSG.                      
428100     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
428200*****************************************************************         
428300* ERROR MESSAGE # 9                                                       
428400*****************************************************************         
428500 6108-ERROR-9.                                                            
428600                                                                          
428700     MOVE PC-E                   TO TR241-RPT-TYP.                        
428800     MOVE 'BILL OF LADING'       TO TR241-DATA-IN-ERROR.                  
428900     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
429000     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
429100     MOVE 'BOL CHANGE SENT-NOT ALLOWED-NOT PROCESSED'                     
429200                                 TO TR241-ERROR-MSG.                      
429300     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
429400*****************************************************************         
429500* ERROR MESSAGE # 10                                                      
429600*****************************************************************         
429700 6109-ERROR-10.                                                           
429800                                                                          
429900     MOVE PC-E                   TO TR241-RPT-TYP.                        
430000     MOVE 'CONTAINER'            TO TR241-DATA-IN-ERROR.                  
430100     MOVE TR027-ENFCON-CONTNR-ID TO TR241-DATA-VALUE.                     
430200     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
430300     MOVE 'ADD SENT-CONTAINER PREVIOUSLY SENT-NOT PROCESSED'              
430400                                 TO TR241-ERROR-MSG.                      
430500     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
430600*****************************************************************         
430700* ERROR MESSAGE # 11                                                      
430800*****************************************************************         
430900 6110-ERROR-11.                                                           
431000                                                                          
431100     MOVE PC-E                   TO TR241-RPT-TYP.                        
431200     MOVE 'CONTAINER'            TO TR241-DATA-IN-ERROR.                  
431300     MOVE TR027-ENFCON-CONTNR-ID TO TR241-DATA-VALUE.                     
431400     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
431500     MOVE 'DELETE SENT - CONTAINER NOT FND - NOT PROCESSED'               
431600                                 TO TR241-ERROR-MSG.                      
431700     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
431800*****************************************************************         
431900* ERROR MESSAGE # 12                                                      
432000*****************************************************************         
432100 6111-ERROR-12.                                                           
432200                                                                          
432300     MOVE PC-E                   TO TR241-RPT-TYP.                        
432400     MOVE 'CONTAINER'            TO TR241-DATA-IN-ERROR.                  
432500     MOVE TR027-ENFCON-CONTNR-ID TO TR241-DATA-VALUE.                     
432600     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
432700     MOVE 'CONTAINER CHANGE SENT-NOT ALLOWED-NOT PROCESSED'               
432800                                 TO TR241-ERROR-MSG.                      
432900     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
433000*****************************************************************         
433100* ERROR MESSAGE # 13                                                      
433200*****************************************************************         
433300 6112-ERROR-13.                                                           
433400                                                                          
433500     MOVE PC-E                   TO TR241-RPT-TYP.                        
433600     MOVE 'PO NUMBER'            TO TR241-DATA-IN-ERROR.                  
433700     MOVE TR027-ENFPO-PO-NBR     TO TR241-DATA-VALUE.                     
433800     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
433900     MOVE 'ADD SENT-PO PREVIOUSLY SENT-NOT PROCESSED'                     
434000                                 TO TR241-ERROR-MSG.                      
434100     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
434200*****************************************************************         
434300* ERROR MESSAGE # 14                                                      
434400*****************************************************************         
434500 6113-ERROR-14.                                                           
434600                                                                          
434700     MOVE PC-E                   TO TR241-RPT-TYP.                        
434800     MOVE 'PO NUMBER'            TO TR241-DATA-IN-ERROR.                  
434900     MOVE TR027-ENFPO-PO-NBR     TO TR241-DATA-VALUE.                     
435000     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
435100     MOVE 'DELETE SENT - PO NOT FND - NOT PROCESSED'                      
435200                                 TO TR241-ERROR-MSG.                      
435300     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
435400*****************************************************************         
435500* ERROR MESSAGE # 15                                                      
435600*****************************************************************         
435700 6114-ERROR-15.                                                           
435800                                                                          
435900     MOVE PC-E                   TO TR241-RPT-TYP.                        
436000     MOVE 'PO NUMBER'            TO TR241-DATA-IN-ERROR.                  
436100     MOVE TR027-ENFPO-PO-NBR     TO TR241-DATA-VALUE.                     
436200     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
436300     MOVE 'PO CHANGE SENT-NOT ALLOWED-NOT PROCESSED'                      
436400                                 TO TR241-ERROR-MSG.                      
436500     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
436600*****************************************************************         
436700* ERROR MESSAGE # 16                                                      
436800*****************************************************************         
436900 6115-ERROR-16.                                                           
437000                                                                          
437100     MOVE PC-E                   TO TR241-RPT-TYP.                        
437200     MOVE 'BILL OF LADING'       TO TR241-DATA-IN-ERROR.                  
437300     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
437400     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
437500     MOVE 'BOL CHANGE SENT - NOT FND - BOL ADDED'                         
437600                                 TO TR241-ERROR-MSG.                      
437700     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
437800*****************************************************************         
437900* ERROR MESSAGE # 17                                                      
438000*****************************************************************         
438100 6116-ERROR-17.                                                           
438200                                                                          
438300     MOVE PC-E                   TO TR241-RPT-TYP.                        
438400     MOVE 'PO NUMBER'            TO TR241-DATA-IN-ERROR.                  
438500     MOVE TR027-ENFPO-PO-NBR     TO TR241-DATA-VALUE.                     
438600     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
438700     MOVE 'PO CHANGE SENT - NOT FND - PO ADDED'                           
438800                                 TO TR241-ERROR-MSG.                      
438900     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
439000*****************************************************************         
439100* ERROR MESSAGE # 18                                                      
439200*****************************************************************         
439300 6117-ERROR-18.                                                           
439400                                                                          
439500     MOVE PC-E                   TO TR241-RPT-TYP.                        
439600     MOVE 'CONTAINER'            TO TR241-DATA-IN-ERROR.                  
439700     MOVE TR027-ENFCON-CONTNR-ID TO TR241-DATA-VALUE.                     
439800     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
439900     MOVE 'CONTAINER CHANGE SENT - NOT FND - CONTAINER ADDED'             
440000                                 TO TR241-ERROR-MSG.                      
440100     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
440200*****************************************************************         
440300* ERROR MESSAGE # 19                                                      
440400*****************************************************************         
440500 6118-ERROR-19.                                                           
440600                                                                          
440700     MOVE PC-E                   TO TR241-RPT-TYP.                        
440800     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
440900     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
441000     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
441100     MOVE 'ADD SENT-CSTMS EXAM PREVIOUSLY SENT-NOT PROCESSED'             
441200                                 TO TR241-ERROR-MSG.                      
441300     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
441400*****************************************************************         
441500* ERROR MESSAGE # 20                                                      
441600*****************************************************************         
441700 6119-ERROR-20.                                                           
441800                                                                          
441900     MOVE PC-E                   TO TR241-RPT-TYP.                        
442000     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
442100     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
442200     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
442300     MOVE 'ADD SENT-CSTMS REJ PREVIOUSLY SENT-NOT PROCESSED'              
442400                                 TO TR241-ERROR-MSG.                      
442500     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
442600*****************************************************************         
442700* ERROR MESSAGE # 21                                                      
442800*****************************************************************         
442900 6120-ERROR-21.                                                           
443000                                                                          
443100     MOVE PC-E                   TO TR241-RPT-TYP.                        
443200     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
443300     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
443400     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
443500     MOVE 'ADD SENT-EST CSTMS CLEAR PREV SENT-NOT PROCESSED'              
443600                                 TO TR241-ERROR-MSG.                      
443700     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
443800*****************************************************************         
443900* ERROR MESSAGE # 22                                                      
444000*****************************************************************         
444100 6121-ERROR-22.                                                           
444200                                                                          
444300     MOVE PC-E                   TO TR241-RPT-TYP.                        
444400     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
444500     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
444600     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
444700     MOVE 'ADD SENT-ACT CSTMS CLEAR PREV SENT-NOT PROCESSED'              
444800                                 TO TR241-ERROR-MSG.                      
444900     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
445000*****************************************************************         
445100* ERROR MESSAGE # 23                                                      
445200*****************************************************************         
445300 6122-ERROR-23.                                                           
445400                                                                          
445500     MOVE PC-E                   TO TR241-RPT-TYP.                        
445600     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
445700     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
445800     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
445900     MOVE 'ADD SENT-LIQ SUSP PREVIOUSLY SENT-NOT PROCESSED'               
446000                                 TO TR241-ERROR-MSG.                      
446100     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
446200*****************************************************************         
446300* ERROR MESSAGE # 24                                                      
446400*****************************************************************         
446500 6123-ERROR-24.                                                           
446600                                                                          
446700     MOVE PC-E                   TO TR241-RPT-TYP.                        
446800     MOVE 'CSTMS ENTRY ID'       TO TR241-DATA-IN-ERROR.                  
446900     MOVE TR027-ENF-CSTM-ENTR-ID TO TR241-DATA-VALUE.                     
447000     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
447100     MOVE 'ADD SENT-CSTMS LIQ PREVIOUSLY SENT-NOT PROCESSED'              
447200                                 TO TR241-ERROR-MSG.                      
447300     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
447400*****************************************************************         
447500* ERROR MESSAGE # 25                                                      
447600*****************************************************************         
447700 6124-ERROR-25.                                                           
447800                                                                          
447900     MOVE PC-E                   TO TR241-RPT-TYP.                        
448000     MOVE 'PO NUMBER'            TO TR241-DATA-IN-ERROR.                  
448100     MOVE TR027-ENFPO-PO-NBR     TO TR241-DATA-VALUE.                     
448200     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
448300     MOVE 'PO NOT ACTIVE OR APPROVED ON MAINFRAME'                        
448400                                 TO TR241-ERROR-MSG.                      
448500     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
448600*****************************************************************         
448700* ERROR MESSAGE # 26                                                      
448800*****************************************************************         
448900 6125-ERROR-26.                                                           
449000                                                                          
449100     MOVE PC-E                   TO TR241-RPT-TYP.                        
449200     MOVE 'PO NUMBER'            TO TR241-DATA-IN-ERROR.                  
449300     MOVE TR027-ENFPO-PO-NBR     TO TR241-DATA-VALUE.                     
449400     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
449500     MOVE 'PO NOT ON MAINFRAME'                                           
449600                                 TO TR241-ERROR-MSG.                      
449700     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
449800*****************************************************************         
449900* CLEAR ERROR FIELDS                                                      
450000*****************************************************************         
450100 6128-CLEAR-ERROR-FIELDS.                                                 
450200                                                                          
450300     MOVE SPACES                TO TR241-RPT-TYP                          
450400                                   TR241-DATA-IN-ERROR                    
450500                                   TR241-DATA-VALUE                       
450600                                   TR241-ERROR-TYPE                       
450700                                   TR241-ERROR-MSG.                       
450800*****************************************************************         
450900* ERROR MESSAGE # 27                                                      
451000*****************************************************************         
451100 6129-ERROR-27.                                                           
451200                                                                          
451300     MOVE PC-E                   TO TR241-RPT-TYP.                        
451400     MOVE 'RECORD TYPE'          TO TR241-DATA-IN-ERROR.                  
451500     MOVE TR027-ENF-REC-TYP-CDE  TO TR241-DATA-VALUE.                     
451600     MOVE PC-WARNING             TO TR241-ERROR-TYPE.                     
451700     MOVE 'ALL ENTRY, BOL, CONTNR AND PO DATA DELETED'                    
451800                                 TO TR241-ERROR-MSG.                      
451900     ADD +1                      TO PA-TOTAL-WARN-COUNT.                  
452000                                                                          
452100*****************************************************************         
452200* ERROR MESSAGE # 30                                                      
452300*****************************************************************         
452400 6130-ERROR-30.                                                           
452500                                                                          
452600     MOVE PC-E                      TO TR241-RPT-TYP.                     
452700     SET TR241-REC-TYP-MLT-CDE-MLT  TO TRUE.                              
452800     SET TR241-MLT-WRN-TYP-ENTRID   TO TRUE.                              
452900     MOVE 'CSTMS ENTRY ID '         TO TR241-DATA-IN-ERROR.               
453000     MOVE PV-HOLD-ENTR-ID-FOR-CNPO-UPD                                    
453100                                  TO TR241-DATA-VALUE.                    
453200     MOVE PC-WARNING              TO TR241-ERROR-TYPE.                    
453300     MOVE   'UNABLE TO MATCH CUSTOMS DATA WITH CNTNR MANIFEST'            
453400                                  TO TR241-ERROR-MSG.                     
453500     ADD +1                       TO PA-TOTAL-WARN-COUNT.                 
453600                                                                          
453700*****************************************************************         
453800* ERROR MESSAGE # 31                                                      
453900*****************************************************************         
454000 6131-ERROR-31.                                                           
454100                                                                          
454200     MOVE PC-E                   TO TR241-RPT-TYP.                        
454300     MOVE 'DELY ORD SNT DT'      TO TR241-DATA-IN-ERROR.                  
454400     MOVE TR027-DOP-DELY-ORD-SNT-DTE                                      
454500                                 TO TR241-DATA-VALUE.                     
454600     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
454700     MOVE 'ADD SENT, DATA PREVIOUSLY SENT-NOT PROCESSED'                  
454800                                 TO TR241-ERROR-MSG.                      
454900     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
455000                                                                          
455100*****************************************************************         
455200* ERROR MESSAGE # 32                                                      
455300*****************************************************************         
455400 6132-ERROR-32.                                                           
455500                                                                          
455600     MOVE PC-E                   TO TR241-RPT-TYP.                        
455700     MOVE 'DELY ORD SNT DT'      TO TR241-DATA-IN-ERROR.                  
455800     MOVE TR027-DOP-DELY-ORD-SNT-DTE                                      
455900                                 TO TR241-DATA-VALUE.                     
456000     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
456100     MOVE 'DELY ORD SNT DTE SNT BFR CUST CNTNR- NOT PROCESSED'            
456200                                 TO TR241-ERROR-MSG.                      
456300     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
456400                                                                          
456500*****************************************************************         
456600* ERROR MESSAGE # 33                                                      
456700*****************************************************************         
456800 6133-ERROR-33.                                                           
456900                                                                          
457000     MOVE PC-E                   TO TR241-RPT-TYP.                        
457100     MOVE 'DELY ORD SNT DT'      TO TR241-DATA-IN-ERROR.                  
457200     MOVE TR027-DOP-DELY-ORD-SNT-DTE                                      
457300                                 TO TR241-DATA-VALUE.                     
457400     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
457500     MOVE 'CONTAINER CHANGE SENT-NOT FOUND - NOT PROCESSED'               
457600                                 TO TR241-ERROR-MSG.                      
457700     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
457800                                                                          
457900*****************************************************************         
458000* ERROR MESSAGE # 34                                                      
458100*****************************************************************         
458200 6134-ERROR-34.                                                           
458300                                                                          
458400     MOVE PC-E                   TO TR241-RPT-TYP.                        
458500     MOVE 'DELY ORD SNT DT'      TO TR241-DATA-IN-ERROR.                  
458600     MOVE TR027-DOP-DELY-ORD-SNT-DTE                                      
458700                                 TO TR241-DATA-VALUE.                     
458800     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
458900     MOVE 'CHANGE SENT - NOTHING CHANGED - NOT PROCESSED'                 
459000                                 TO TR241-ERROR-MSG.                      
459100     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
459200                                                                          
459300*****************************************************************         
459400* ERROR MESSAGE # 35                                                      
459500*****************************************************************         
459600 6135-ERROR-35.                                                           
459700                                                                          
459800     MOVE PC-E                   TO TR241-RPT-TYP.                        
459900     MOVE 'DELY ORD SNT DT'      TO TR241-DATA-IN-ERROR.                  
460000     MOVE TR027-DOP-DELY-ORD-SNT-DTE                                      
460100                                 TO TR241-DATA-VALUE.                     
460200     MOVE PC-ERROR               TO TR241-ERROR-TYPE.                     
460300     MOVE 'DELETE SENT - NO DATA TO DELETE - NOT PROCESSED'               
460400                                 TO TR241-ERROR-MSG.                      
460500     ADD +1                      TO PA-TOTAL-ERROR-COUNT.                 
460600                                                                          
460700*****************************************************************         
460800* ERROR MESSAGE # 36   OPEN                                               
460900*****************************************************************         
461000*6136-ERROR-36.                                                           
461100***                                                                       
461200***  MOVE PC-E                        TO TR241-RPT-TYP.                   
461300***  MOVE '              '            TO TR241-DATA-IN-ERROR.             
461400***  MOVE                             TO TR241-DATA-VALUE.                
461500***  MOVE PC-WARNING                  TO TR241-ERROR-TYPE.                
461600***  MOVE                             TO TR241-ERROR-MSG.                 
461700***  ADD +1                           TO PA-TOTAL-WARN-COUNT.             
461800*****************************************************************         
461900* ERROR MESSAGE # 37  OPEN                                                
462000*****************************************************************         
462100*6137-ERROR-37.                                                           
462200***                                                                       
462300***  MOVE PC-E                        TO TR241-RPT-TYP.                   
462400***  MOVE 'MOM TRIP TYPE '            TO TR241-DATA-IN-ERROR.             
462500***  MOVE TR027-ENF-MOM-TRIP-TYP-CDE  TO TR241-DATA-VALUE.                
462600***  MOVE PC-WARNING                  TO TR241-ERROR-TYPE.                
462700***  MOVE 'INVALID DATA SENT'         TO TR241-ERROR-MSG.                 
462800***  ADD +1                           TO PA-TOTAL-WARN-COUNT.             
462900*****************************************************************         
463000* ERROR MESSAGE # 38                                                      
463100*****************************************************************         
463200 6138-ERROR-38.                                                           
463300                                                                          
463400     MOVE PC-E                      TO TR241-RPT-TYP.                     
463500     SET TR241-REC-TYP-MLT-CDE-MLT  TO TRUE.                              
463600     SET TR241-MLT-WRN-TYP-ENTRID   TO TRUE.                              
463700     MOVE '***'                     TO TR241-DATA-IN-ERROR.               
463800     MOVE '***'                   TO TR241-DATA-VALUE.                    
463900     MOVE PC-WARNING              TO TR241-ERROR-TYPE.                    
464000     MOVE PV-FOB-CDE              TO PC-FOB.                              
464100     MOVE PV-SCAC-CDE             TO PC-SCAC.                             
464200     MOVE PV-PO-NBR               TO PC-PO.                               
464300     MOVE PC-FOB-SCAC-MSG         TO TR241-ERROR-MSG.                     
464400     ADD +1                       TO PA-TOTAL-WARN-COUNT.                 
464500                                                                          
464600*****************************************************************         
464700* ERROR MESSAGE # 40                                                      
464800*****************************************************************         
464900 6140-ERROR-40.                                                           
465000                                                                          
465100     MOVE PC-E                        TO TR241-RPT-TYP.                   
465200     MOVE PC-WARNING                  TO TR241-ERROR-TYPE.                
465300     SET TR241-REC-TYP-MLT-CDE-MLT    TO TRUE.                            
465400     MOVE 'PO/CONTAINER ON OTHER CUSTOMS ENTRIES'                         
465500                                      TO TR241-ERROR-MSG.                 
465600     ADD +1                           TO PA-TOTAL-WARN-COUNT.             
465700******************************************************************        
465800*  INSERT TIMCSEN                                                         
465900******************************************************************        
466000 7000-INSERT-TIMCSEN.                                                     
466100                                                                          
466200     MOVE PV-CURRENT-TMST TO IMCSEN-LAST-UPD-TMST                         
466300                             IMCSEN-CRE-TMST.                             
466400                                                                          
466500     PERFORM                                                              
466600         WITH TEST AFTER                                                  
466700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
466800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
466900                 SQLCODE = ZERO                     OR                    
467000                 SQLCODE = +100                                           
467100         EXEC SQL                                                         
467200             INSERT INTO TIMCSEN                                          
467300                    (CSTM_ENTR_ID                                         
467400                    ,ENT_ID                                               
467500                    ,BKR_REF_NBR                                          
467600                    ,FILD_TMST                                            
467700                    ,EST_CLR_TMST                                         
467800                    ,ACTL_CLR_TMST                                        
467900                    ,EXM_TMST                                             
468000                    ,REJ_TMST                                             
468100                    ,REJ_DESC                                             
468200                    ,LQDN_TMST                                            
468300                    ,LQDN_SSPNN_TMST                                      
468400                    ,LQDN_SSPNN_DESC                                      
468500                    ,DAT_SRC_ENT_ID                                       
468600                    ,CRE_BY_USR_ID                                        
468700                    ,CRE_TMST                                             
468800                    ,LAST_UPD_BY_USR_ID                                   
468900                    ,LAST_UPD_TMST                                        
469000                    ,MOM_DEST_POE_CDE                                     
469100                    ,MOM_TRIP_TYP_CDE                                     
469200                    ,ENTR_TYP_CDE)                                        
469300             VALUES                                                       
469400                  (:IMCSEN-CSTM-ENTR-ID,                                  
469500                   :IMCSEN-ENT-ID,                                        
469600                   :IMCSEN-BKR-REF-NBR,                                   
469700                   :IMCSEN-FILD-TMST,                                     
469800                   :IMCSEN-EST-CLR-TMST,                                  
469900                   :IMCSEN-ACTL-CLR-TMST,                                 
470000                   :IMCSEN-EXM-TMST,                                      
470100                   :IMCSEN-REJ-TMST,                                      
470200                   :IMCSEN-REJ-DESC,                                      
470300                   :IMCSEN-LQDN-TMST,                                     
470400                   :IMCSEN-LQDN-SSPNN-TMST,                               
470500                   :IMCSEN-LQDN-SSPNN-DESC,                               
470600                   :IMCSEN-DAT-SRC-ENT-ID,                                
470700                   :IMCSEN-CRE-BY-USR-ID,                                 
470800                   :IMCSEN-CRE-TMST,                                      
470900                   :IMCSEN-LAST-UPD-BY-USR-ID,                            
471000                   :IMCSEN-LAST-UPD-TMST,                                 
471100                   :IMCSEN-MOM-DEST-POE-CDE,                              
471200                   :IMCSEN-MOM-TRIP-TYP-CDE,                              
471300                   :IMCSEN-ENTR-TYP-CDE)                                  
471400         END-EXEC                                                         
471500         EVALUATE TRUE                                                    
471600             WHEN SQLCODE = ZERO                                          
471700             WHEN SQLCODE = -904                                          
471800             WHEN SQLCODE = -913                                          
471900                 CONTINUE                                                 
472000                                                                          
472100             WHEN SQLWARN0 NOT EQUAL SPACE                                
472200             WHEN SQLCODE NOT EQUAL ZERO                                  
472300                 DISPLAY '***************************************'        
472400                 DISPLAY '** ABEND                               '        
472500                 DISPLAY '** PROGRAM = TRKUP245                  '        
472600                 DISPLAY '** PARA = 7000-INSERT-TIMCSEN          '        
472700                 DISPLAY '** INSERT TIMCSEN                      '        
472800                 DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID             
472900                 DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                   
473000                 DISPLAY '***************************************'        
473100                 PERFORM 9100-SQL-ABEND                                   
473200         END-EVALUATE                                                     
473300     END-PERFORM.                                                         
473400                                                                          
473500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
473600         SQLCODE NOT = ZERO                                               
473700         DISPLAY '****************************************'               
473800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
473900         DISPLAY '** INSERT FROM TIMCSEN                  '               
474000         DISPLAY '** PROGRAM = TRKUP245                   '               
474100         DISPLAY '** PARA = 7000-INSERT-TIMCSEN           '               
474200         DISPLAY '** UPDATE TIMCSEN                       '               
474300         DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID                     
474400         DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                           
474500         DISPLAY '****************************************'               
474600         PERFORM 9100-SQL-ABEND                                           
474700     END-IF.                                                              
474800                                                                          
474900******************************************************************        
475000*  UPDATE TIMCSEN                                                         
475100******************************************************************        
475200 7010-UPDATE-TIMCSEN.                                                     
475300                                                                          
475400     MOVE PC-CURRENT-PROGRAM-NAME TO IMCSEN-LAST-UPD-BY-USR-ID.           
475500     MOVE PV-CURRENT-TMST         TO IMCSEN-LAST-UPD-TMST.                
475600                                                                          
475700     PERFORM                                                              
475800         WITH TEST AFTER                                                  
475900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
476000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
476100                 SQLCODE = ZERO                     OR                    
476200                 SQLCODE = +100                                           
476300         EXEC SQL                                                         
476400             UPDATE TIMCSEN                                               
476500             SET FILD_TMST          = :IMCSEN-FILD-TMST,                  
476600                 EST_CLR_TMST       = :IMCSEN-EST-CLR-TMST,               
476700                 ACTL_CLR_TMST      = :IMCSEN-ACTL-CLR-TMST,              
476800                 EXM_TMST           = :IMCSEN-EXM-TMST,                   
476900                 REJ_TMST           = :IMCSEN-REJ-TMST,                   
477000                 REJ_DESC           = :IMCSEN-REJ-DESC,                   
477100                 LQDN_TMST          = :IMCSEN-LQDN-TMST,                  
477200                 LQDN_SSPNN_TMST    = :IMCSEN-LQDN-SSPNN-TMST,            
477300                 LQDN_SSPNN_DESC    = :IMCSEN-LQDN-SSPNN-DESC,            
477400                 LAST_UPD_BY_USR_ID = :IMCSEN-LAST-UPD-BY-USR-ID,         
477500                 LAST_UPD_TMST      = :IMCSEN-LAST-UPD-TMST,              
477600                 MOM_TRIP_TYP_CDE   = :IMCSEN-MOM-TRIP-TYP-CDE,           
477700                 ENTR_TYP_CDE       = :IMCSEN-ENTR-TYP-CDE                
477800             WHERE CSTM_ENTR_ID     = :IMCSEN-CSTM-ENTR-ID                
477900         END-EXEC                                                         
478000                                                                          
478100         EVALUATE TRUE                                                    
478200             WHEN SQLCODE = ZERO                                          
478300             WHEN SQLCODE = -904                                          
478400             WHEN SQLCODE = -913                                          
478500                 CONTINUE                                                 
478600             WHEN SQLWARN0 NOT EQUAL SPACE                                
478700             WHEN SQLCODE NOT EQUAL ZERO                                  
478800                 DISPLAY '***************************************'        
478900                 DISPLAY '** ABEND                               '        
479000                 DISPLAY '** PROGRAM = TRKUP245                  '        
479100                 DISPLAY '** PARA = 7010-UPDATE-TIMCSEN          '        
479200                 DISPLAY '** UPDATE TIMCSEN                      '        
479300                 DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID             
479400                 DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                   
479500                 DISPLAY '***************************************'        
479600                 PERFORM 9100-SQL-ABEND                                   
479700         END-EVALUATE                                                     
479800     END-PERFORM.                                                         
479900                                                                          
480000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
480100         (SQLCODE NOT = ZERO AND                                          
480200          SQLCODE NOT = +100)                                             
480300         DISPLAY '****************************************'               
480400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
480500         DISPLAY '** UPDATE FROM TIMCSEN                  '               
480600         DISPLAY '** PROGRAM = TRKUP245                   '               
480700         DISPLAY '** PARA = 7010-UPDATE-TIMCSEN           '               
480800         DISPLAY '** UPDATE TIMCSEN                       '               
480900         DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID                     
481000         DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                           
481100         DISPLAY '****************************************'               
481200         PERFORM 9100-SQL-ABEND                                           
481300     END-IF.                                                              
481400******************************************************************        
481500*  DELETE TIMCSEN                                                         
481600******************************************************************        
481700 7020-DELETE-TIMCSEN.                                                     
481800                                                                          
481900     PERFORM                                                              
482000         WITH TEST AFTER                                                  
482100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
482200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
482300                 SQLCODE = ZERO                     OR                    
482400                 SQLCODE = +100                                           
482500         EXEC SQL                                                         
482600             DELETE FROM TIMCSEN                                          
482700             WHERE CSTM_ENTR_ID     = :IMCSEN-CSTM-ENTR-ID                
482800         END-EXEC                                                         
482900         EVALUATE TRUE                                                    
483000             WHEN SQLCODE = ZERO                                          
483100             WHEN SQLCODE = +100                                          
483200             WHEN SQLCODE = -904                                          
483300             WHEN SQLCODE = -913                                          
483400                 CONTINUE                                                 
483500             WHEN SQLWARN0 NOT EQUAL SPACE                                
483600             WHEN SQLCODE NOT EQUAL ZERO                                  
483700                 DISPLAY '***************************************'        
483800                 DISPLAY '** ABEND                               '        
483900                 DISPLAY '** PROGRAM = TRKUP245                  '        
484000                 DISPLAY '** PARA = 7020-DELETE-TIMCSEN          '        
484100                 DISPLAY '** DELETE TIMCSEN                      '        
484200                 DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID             
484300                 DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                   
484400                 DISPLAY '***************************************'        
484500                 PERFORM 9100-SQL-ABEND                                   
484600         END-EVALUATE                                                     
484700     END-PERFORM.                                                         
484800                                                                          
484900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
485000         (SQLCODE NOT = ZERO AND                                          
485100          SQLCODE NOT = +100)                                             
485200         DISPLAY '****************************************'               
485300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
485400         DISPLAY '** DELETE FROM TIMCSEN                  '               
485500         DISPLAY '** PROGRAM = TRKUP245                   '               
485600         DISPLAY '** PARA = 7020-DELETE-TIMCSEN           '               
485700         DISPLAY '** DELETE TIMCSEN                       '               
485800         DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID                     
485900         DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                           
486000         DISPLAY '****************************************'               
486100         PERFORM 9100-SQL-ABEND                                           
486200     END-IF.                                                              
486300******************************************************************        
486400*  INSERT TIMCSBL                                                         
486500******************************************************************        
486600 7030-INSERT-TIMCSBL.                                                     
486700                                                                          
486800     MOVE PV-CURRENT-TMST TO IMCSBL-LAST-UPD-TMST                         
486900                             IMCSBL-CRE-TMST.                             
487000     PERFORM                                                              
487100         WITH TEST AFTER                                                  
487200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
487300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
487400                 SQLCODE = ZERO                     OR                    
487500                 SQLCODE = +100                                           
487600         EXEC SQL                                                         
487700             INSERT INTO TIMCSBL                                          
487800                   ( CSTM_ENTR_ID                                         
487900                    ,MSTR_BOL_NBR                                         
488000                    ,HSE_BOL_NBR                                          
488100                    ,CRE_BY_USR_ID                                        
488200                    ,CRE_TMST                                             
488300                    ,LAST_UPD_BY_USR_ID                                   
488400                    ,LAST_UPD_TMST)                                       
488500             VALUES                                                       
488600                  (:IMCSBL-CSTM-ENTR-ID,                                  
488700                   :IMCSBL-MSTR-BOL-NBR,                                  
488800                   :IMCSBL-HSE-BOL-NBR,                                   
488900                   :IMCSBL-CRE-BY-USR-ID,                                 
489000                   :IMCSBL-CRE-TMST,                                      
489100                   :IMCSBL-LAST-UPD-BY-USR-ID,                            
489200                   :IMCSBL-LAST-UPD-TMST)                                 
489300         END-EXEC                                                         
489400         EVALUATE TRUE                                                    
489500             WHEN SQLCODE = ZERO                                          
489600                 ADD +1 TO PA-TOT-IMCSBL-INSERTS                          
489700             WHEN SQLCODE = -904                                          
489800             WHEN SQLCODE = -913                                          
489900                 CONTINUE                                                 
490000             WHEN SQLWARN0 NOT EQUAL SPACE                                
490100             WHEN SQLCODE NOT EQUAL ZERO                                  
490200                 DISPLAY '***************************************'        
490300                 DISPLAY '** ABEND                               '        
490400                 DISPLAY '** PROGRAM = TRKUP245                  '        
490500                 DISPLAY '** PARA = 7030-INSERT-TIMCSBL          '        
490600                 DISPLAY '** INSERT TIMCSBL                      '        
490700                 DISPLAY '** ENTRY ID = ' IMCSBL-CSTM-ENTR-ID             
490800                 DISPLAY '***************************************'        
490900                 PERFORM 9100-SQL-ABEND                                   
491000         END-EVALUATE                                                     
491100     END-PERFORM.                                                         
491200                                                                          
491300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
491400         SQLCODE NOT = ZERO                                               
491500         DISPLAY '****************************************'               
491600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
491700         DISPLAY '** INSERT FROM TIMCSBL                  '               
491800         DISPLAY '** PROGRAM = TRKUP245                   '               
491900         DISPLAY '** PARA = 7030-INSERT-TIMCSBL           '               
492000         DISPLAY '** UPDATE TIMCSBL                       '               
492100         DISPLAY '** ENTRY ID = ' IMCSBL-CSTM-ENTR-ID                     
492200         DISPLAY '****************************************'               
492300         PERFORM 9100-SQL-ABEND                                           
492400     END-IF.                                                              
492500******************************************************************        
492600*  INSERT TIMCSCN                                                         
492700******************************************************************        
492800 7040-INSERT-TIMCSCN.                                                     
492900                                                                          
493000     MOVE PV-CURRENT-TMST TO IMCSCN-LAST-UPD-TMST                         
493100                             IMCSCN-CRE-TMST.                             
493200                                                                          
493300     PERFORM                                                              
493400         WITH TEST AFTER                                                  
493500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
493600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
493700                 SQLCODE = ZERO                     OR                    
493800                 SQLCODE = +100                                           
493900         EXEC SQL                                                         
494000             INSERT INTO TIMCSCN                                          
494100                   ( CSTM_ENTR_ID                                         
494200                    ,CONTNR_ID                                            
494300                    ,CRE_BY_USR_ID                                        
494400                    ,CRE_TMST                                             
494500                    ,LAST_UPD_BY_USR_ID                                   
494600                    ,LAST_UPD_TMST                                        
494700                    ,DO_TO_DCONSLR_TMST)                                  
494800             VALUES                                                       
494900                  (:IMCSCN-CSTM-ENTR-ID,                                  
495000                   :IMCSCN-CONTNR-ID,                                     
495100                   :IMCSCN-CRE-BY-USR-ID,                                 
495200                   :IMCSCN-CRE-TMST,                                      
495300                   :IMCSCN-LAST-UPD-BY-USR-ID,                            
495400                   :IMCSCN-LAST-UPD-TMST,                                 
495500                   :IMCSCN-DO-TO-DCONSLR-TMST)                            
495600         END-EXEC                                                         
495700         EVALUATE TRUE                                                    
495800             WHEN SQLCODE = ZERO                                          
495900                 ADD +1 TO PA-TOT-IMCSCN-INSERTS                          
496000             WHEN SQLCODE = -904                                          
496100             WHEN SQLCODE = -913                                          
496200                 CONTINUE                                                 
496300             WHEN SQLWARN0 NOT EQUAL SPACE                                
496400             WHEN SQLCODE NOT EQUAL ZERO                                  
496500                 DISPLAY '***************************************'        
496600                 DISPLAY '** ABEND                               '        
496700                 DISPLAY '** PROGRAM = TRKUP245                  '        
496800                 DISPLAY '** PARA = 7040-INSERT-TIMCSCN          '        
496900                 DISPLAY '** INSERT TIMCSCN                      '        
497000                 DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID             
497100                 DISPLAY '***************************************'        
497200                 PERFORM 9100-SQL-ABEND                                   
497300         END-EVALUATE                                                     
497400     END-PERFORM.                                                         
497500                                                                          
497600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
497700         SQLCODE NOT = ZERO                                               
497800         DISPLAY '****************************************'               
497900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
498000         DISPLAY '** INSERT FROM TIMCSCN                  '               
498100         DISPLAY '** PROGRAM = TRKUP245                   '               
498200         DISPLAY '** PARA = 7040-INSERT-TIMCSCN           '               
498300         DISPLAY '** UPDATE TIMCSCN                       '               
498400         DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID                     
498500         DISPLAY '****************************************'               
498600         PERFORM 9100-SQL-ABEND                                           
498700     END-IF.                                                              
498800******************************************************************        
498900*  INSERT TIMCSPO                                                         
499000******************************************************************        
499100 7050-INSERT-TIMCSPO.                                                     
499200                                                                          
499300     MOVE PV-CURRENT-TMST TO IMCSPO-LAST-UPD-TMST                         
499400                             IMCSPO-CRE-TMST.                             
499500                                                                          
499600     PERFORM                                                              
499700         WITH TEST AFTER                                                  
499800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
499900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
500000                 SQLCODE = ZERO                     OR                    
500100                 SQLCODE = +100                                           
500200         EXEC SQL                                                         
500300             INSERT INTO TIMCSPO                                          
500400                   ( CSTM_ENTR_ID                                         
500500                    ,PO_NBR                                               
500600                    ,EXTL_REF_NBR                                         
500700                    ,CRE_BY_USR_ID                                        
500800                    ,CRE_TMST                                             
500900                    ,LAST_UPD_BY_USR_ID                                   
501000                    ,LAST_UPD_TMST)                                       
501100             VALUES                                                       
501200                  (:IMCSPO-CSTM-ENTR-ID,                                  
501300                   :IMCSPO-PO-NBR,                                        
501400                   :IMCSPO-EXTL-REF-NBR,                                  
501500                   :IMCSPO-CRE-BY-USR-ID,                                 
501600                   :IMCSPO-CRE-TMST,                                      
501700                   :IMCSPO-LAST-UPD-BY-USR-ID,                            
501800                   :IMCSPO-LAST-UPD-TMST)                                 
501900         END-EXEC                                                         
502000                                                                          
502100         EVALUATE TRUE                                                    
502200             WHEN SQLCODE = ZERO                                          
502300                 ADD +1 TO PA-TOT-IMCSPO-INSERTS                          
502400             WHEN SQLCODE = -904                                          
502500             WHEN SQLCODE = -913                                          
502600                 CONTINUE                                                 
502700             WHEN SQLWARN0 NOT EQUAL SPACE                                
502800             WHEN SQLCODE NOT EQUAL ZERO                                  
502900                 DISPLAY '***************************************'        
503000                 DISPLAY '** ABEND                               '        
503100                 DISPLAY '** PROGRAM = TRKUP245                  '        
503200                 DISPLAY '** PARA = 7050-INSERT-TIMCSPO          '        
503300                 DISPLAY '** INSERT TIMCSPO                      '        
503400                 DISPLAY '** ENTRY ID = ' IMCSPO-CSTM-ENTR-ID             
503500                 DISPLAY '***************************************'        
503600                 PERFORM 9100-SQL-ABEND                                   
503700         END-EVALUATE                                                     
503800     END-PERFORM.                                                         
503900                                                                          
504000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
504100         SQLCODE NOT = ZERO                                               
504200         DISPLAY '****************************************'               
504300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
504400         DISPLAY '** INSERT FROM TIMCSPO                  '               
504500         DISPLAY '** PROGRAM = TRKUP245                   '               
504600         DISPLAY '** PARA = 7050-INSERT-TIMCSPO           '               
504700         DISPLAY '** UPDATE TIMCSPO                       '               
504800         DISPLAY '** ENTRY ID = ' IMCSPO-CSTM-ENTR-ID                     
504900         DISPLAY '****************************************'               
505000         PERFORM 9100-SQL-ABEND                                           
505100     END-IF.                                                              
505200******************************************************************        
505300* INSERT TAUCSEN                                                          
505400******************************************************************        
505500 7060-INSERT-TAUCSEN.                                                     
505600                                                                          
505700     MOVE PV-CURRENT-TMST      TO AUCSEN-AUD-TMST.                        
505800                                                                          
505900     PERFORM                                                              
506000         WITH TEST AFTER                                                  
506100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
506200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
506300                 SQLCODE = ZERO                                           
506400                                                                          
506500         EXEC SQL                                                         
506600             INSERT INTO TAUCSEN                                          
506700                   ( CSTM_ENTR_ID                                         
506800                    ,ENT_ID                                               
506900                    ,BKR_REF_NBR                                          
507000                    ,FILD_TMST                                            
507100                    ,EST_CLR_TMST                                         
507200                    ,ACTL_CLR_TMST                                        
507300                    ,EXM_TMST                                             
507400                    ,REJ_TMST                                             
507500                    ,REJ_DESC                                             
507600                    ,LQDN_TMST                                            
507700                    ,LQDN_SSPNN_TMST                                      
507800                    ,LQDN_SSPNN_DESC                                      
507900                    ,DAT_SRC_ENT_ID                                       
508000                    ,LAST_UPD_BY_USR_ID                                   
508100                    ,LAST_UPD_TMST                                        
508200                    ,AUD_FUNC_CDE                                         
508300                    ,AUD_TMST                                             
508400                    ,MOM_TRIP_TYP_CDE                                     
508500                    ,ENTR_TYP_CDE                                         
508600                    ,MOM_DEST_POE_CDE)                                    
508700             VALUES                                                       
508800                  (:AUCSEN-CSTM-ENTR-ID,                                  
508900                   :AUCSEN-ENT-ID,                                        
509000                   :AUCSEN-BKR-REF-NBR,                                   
509100                   :AUCSEN-FILD-TMST,                                     
509200                   :AUCSEN-EST-CLR-TMST,                                  
509300                   :AUCSEN-ACTL-CLR-TMST,                                 
509400                   :AUCSEN-EXM-TMST,                                      
509500                   :AUCSEN-REJ-TMST,                                      
509600                   :AUCSEN-REJ-DESC,                                      
509700                   :AUCSEN-LQDN-TMST,                                     
509800                   :AUCSEN-LQDN-SSPNN-TMST,                               
509900                   :AUCSEN-LQDN-SSPNN-DESC,                               
510000                   :AUCSEN-DAT-SRC-ENT-ID,                                
510100                   :AUCSEN-LAST-UPD-BY-USR-ID,                            
510200                   :AUCSEN-LAST-UPD-TMST,                                 
510300                   :AUCSEN-AUD-FUNC-CDE,                                  
510400                   :AUCSEN-AUD-TMST,                                      
510500                   :AUCSEN-MOM-TRIP-TYP-CDE,                              
510600                   :AUCSEN-ENTR-TYP-CDE,                                  
510700                   :AUCSEN-MOM-DEST-POE-CDE)                              
510800         END-EXEC                                                         
510900                                                                          
511000         EVALUATE TRUE                                                    
511100             WHEN SQLCODE = ZERO                                          
511200                 ADD +1 TO PA-TOT-AUCSEN-INSERTS                          
511300             WHEN SQLCODE = -904                                          
511400             WHEN SQLCODE = -913                                          
511500                 CONTINUE                                                 
511600             WHEN SQLWARN0 NOT EQUAL SPACE                                
511700             WHEN SQLCODE NOT EQUAL ZERO                                  
511800                 DISPLAY '***************************************'        
511900                 DISPLAY '** ABEND                               '        
512000                 DISPLAY '** PROGRAM = TRKUP245                  '        
512100                 DISPLAY '** PARA = 7060-INSERT-TAUCSEN          '        
512200                 DISPLAY '** INSERT TAUCSEN                      '        
512300                 DISPLAY '** ENTRY ID = ' AUCSEN-CSTM-ENTR-ID             
512400                 DISPLAY '** ENT ID   = ' AUCSEN-ENT-ID                   
512500                 DISPLAY '***************************************'        
512600                 PERFORM 9100-SQL-ABEND                                   
512700         END-EVALUATE                                                     
512800     END-PERFORM.                                                         
512900                                                                          
513000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
513100         SQLCODE NOT = ZERO                                               
513200         DISPLAY '****************************************'               
513300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
513400         DISPLAY '** INSERT FROM TAUCSEN                  '               
513500         DISPLAY '** PROGRAM = TRKUP245                   '               
513600         DISPLAY '** PARA = 7060-INSERT-TAUCSEN           '               
513700         DISPLAY '** UPDATE TAUCSEN                       '               
513800         DISPLAY '** ENTRY ID = ' AUCSEN-CSTM-ENTR-ID                     
513900         DISPLAY '** ENT ID   = ' AUCSEN-ENT-ID                           
514000         DISPLAY '****************************************'               
514100         PERFORM 9100-SQL-ABEND                                           
514200     END-IF.                                                              
514300******************************************************************        
514400* INSERT TAUCSBL                                                          
514500******************************************************************        
514600 7070-INSERT-TAUCSBL.                                                     
514700                                                                          
514800     MOVE PV-CURRENT-TMST      TO AUCSBL-AUD-TMST.                        
514900                                                                          
515000     PERFORM                                                              
515100         WITH TEST AFTER                                                  
515200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
515300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
515400                 SQLCODE = ZERO                                           
515500                                                                          
515600         EXEC SQL                                                         
515700             INSERT INTO TAUCSBL                                          
515800                   ( CSTM_ENTR_ID                                         
515900                    ,MSTR_BOL_NBR                                         
516000                    ,HSE_BOL_NBR                                          
516100                    ,LAST_UPD_BY_USR_ID                                   
516200                    ,LAST_UPD_TMST                                        
516300                    ,AUD_FUNC_CDE                                         
516400                    ,AUD_TMST)                                            
516500             VALUES                                                       
516600                  (:AUCSBL-CSTM-ENTR-ID,                                  
516700                   :AUCSBL-MSTR-BOL-NBR,                                  
516800                   :AUCSBL-HSE-BOL-NBR,                                   
516900                   :AUCSBL-LAST-UPD-BY-USR-ID,                            
517000                   :AUCSBL-LAST-UPD-TMST,                                 
517100                   :AUCSBL-AUD-FUNC-CDE,                                  
517200                   :AUCSBL-AUD-TMST)                                      
517300         END-EXEC                                                         
517400                                                                          
517500         EVALUATE TRUE                                                    
517600             WHEN SQLCODE = ZERO                                          
517700                 ADD +1 TO PA-TOT-AUCSBL-INSERTS                          
517800             WHEN SQLCODE = -904                                          
517900             WHEN SQLCODE = -913                                          
518000                 CONTINUE                                                 
518100             WHEN SQLWARN0 NOT EQUAL SPACE                                
518200             WHEN SQLCODE NOT EQUAL ZERO                                  
518300                 DISPLAY '***************************************'        
518400                 DISPLAY '** ABEND                               '        
518500                 DISPLAY '** PROGRAM = TRKUP245                  '        
518600                 DISPLAY '** PARA = 7070-INSERT-TAUCSBL          '        
518700                 DISPLAY '** INSERT TAUCSBL                      '        
518800                 DISPLAY '** ENTRY ID = ' AUCSBL-CSTM-ENTR-ID             
518900                 DISPLAY '***************************************'        
519000                 PERFORM 9100-SQL-ABEND                                   
519100         END-EVALUATE                                                     
519200     END-PERFORM.                                                         
519300                                                                          
519400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
519500         SQLCODE NOT = ZERO                                               
519600         DISPLAY '****************************************'               
519700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
519800         DISPLAY '** INSERT FROM TAUCSBL                  '               
519900         DISPLAY '** PROGRAM = TRKUP245                   '               
520000         DISPLAY '** PARA = 7070-INSERT-TAUCSBL           '               
520100         DISPLAY '** UPDATE TAUCSBL                       '               
520200         DISPLAY '** ENTRY ID = ' AUCSBL-CSTM-ENTR-ID                     
520300         DISPLAY '****************************************'               
520400         PERFORM 9100-SQL-ABEND                                           
520500     END-IF.                                                              
520600******************************************************************        
520700* INSERT TAUCSCN                                                          
520800******************************************************************        
520900 7080-INSERT-TAUCSCN.                                                     
521000                                                                          
521100     MOVE PV-CURRENT-TMST      TO AUCSCN-AUD-TMST.                        
521200                                                                          
521300     PERFORM                                                              
521400         WITH TEST AFTER                                                  
521500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
521600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
521700                 SQLCODE = ZERO                                           
521800                                                                          
521900         EXEC SQL                                                         
522000             INSERT INTO TAUCSCN                                          
522100                   ( CSTM_ENTR_ID                                         
522200                    ,CONTNR_ID                                            
522300                    ,LAST_UPD_BY_USR_ID                                   
522400                    ,LAST_UPD_TMST                                        
522500                    ,AUD_FUNC_CDE                                         
522600                    ,AUD_TMST                                             
522700                    ,DO_TO_DCONSLR_TMST)                                  
522800             VALUES                                                       
522900                  (:AUCSCN-CSTM-ENTR-ID,                                  
523000                   :AUCSCN-CONTNR-ID,                                     
523100                   :AUCSCN-LAST-UPD-BY-USR-ID,                            
523200                   :AUCSCN-LAST-UPD-TMST,                                 
523300                   :AUCSCN-AUD-FUNC-CDE,                                  
523400                   :AUCSCN-AUD-TMST,                                      
523500                   :AUCSCN-DO-TO-DCONSLR-TMST)                            
523600         END-EXEC                                                         
523700                                                                          
523800         EVALUATE TRUE                                                    
523900             WHEN SQLCODE = ZERO                                          
524000                 ADD +1 TO PA-TOT-AUCSCN-INSERTS                          
524100             WHEN SQLCODE = -904                                          
524200             WHEN SQLCODE = -913                                          
524300                 CONTINUE                                                 
524400             WHEN SQLWARN0 NOT EQUAL SPACE                                
524500             WHEN SQLCODE NOT EQUAL ZERO                                  
524600                 DISPLAY '***************************************'        
524700                 DISPLAY '** ABEND                               '        
524800                 DISPLAY '** PROGRAM = TRKUP245                  '        
524900                 DISPLAY '** PARA = 7080-INSERT-TAUCSCN          '        
525000                 DISPLAY '** INSERT TAUCSCN                      '        
525100                 DISPLAY '** ENTRY ID = ' AUCSCN-CSTM-ENTR-ID             
525200                 DISPLAY '***************************************'        
525300                 PERFORM 9100-SQL-ABEND                                   
525400         END-EVALUATE                                                     
525500     END-PERFORM.                                                         
525600                                                                          
525700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
525800         SQLCODE NOT = ZERO                                               
525900         DISPLAY '****************************************'               
526000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
526100         DISPLAY '** INSERT FROM TAUCSCN                  '               
526200         DISPLAY '** PROGRAM = TRKUP245                   '               
526300         DISPLAY '** PARA = 7080-INSERT-TAUCSCN           '               
526400         DISPLAY '** UPDATE TAUCSCN                       '               
526500         DISPLAY '** ENTRY ID = ' AUCSCN-CSTM-ENTR-ID                     
526600         DISPLAY '****************************************'               
526700         PERFORM 9100-SQL-ABEND                                           
526800     END-IF.                                                              
526900******************************************************************        
527000* INSERT TAUCSPO                                                          
527100******************************************************************        
527200 7090-INSERT-TAUCSPO.                                                     
527300                                                                          
527400     MOVE PV-CURRENT-TMST      TO AUCSPO-AUD-TMST.                        
527500                                                                          
527600     PERFORM                                                              
527700         WITH TEST AFTER                                                  
527800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
527900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
528000                 SQLCODE = ZERO                                           
528100                                                                          
528200         EXEC SQL                                                         
528300             INSERT INTO TAUCSPO                                          
528400                   ( CSTM_ENTR_ID                                         
528500                    ,PO_NBR                                               
528600                    ,EXTL_REF_NBR                                         
528700                    ,LAST_UPD_BY_USR_ID                                   
528800                    ,LAST_UPD_TMST                                        
528900                    ,AUD_FUNC_CDE                                         
529000                    ,AUD_TMST)                                            
529100             VALUES                                                       
529200                  (:AUCSPO-CSTM-ENTR-ID,                                  
529300                   :AUCSPO-PO-NBR,                                        
529400                   :AUCSPO-EXTL-REF-NBR,                                  
529500                   :AUCSPO-LAST-UPD-BY-USR-ID,                            
529600                   :AUCSPO-LAST-UPD-TMST,                                 
529700                   :AUCSPO-AUD-FUNC-CDE,                                  
529800                   :AUCSPO-AUD-TMST)                                      
529900         END-EXEC                                                         
530000                                                                          
530100         EVALUATE TRUE                                                    
530200             WHEN SQLCODE = ZERO                                          
530300                 ADD +1 TO PA-TOT-AUCSPO-INSERTS                          
530400             WHEN SQLCODE = -904                                          
530500             WHEN SQLCODE = -913                                          
530600                 CONTINUE                                                 
530700             WHEN SQLWARN0 NOT EQUAL SPACE                                
530800             WHEN SQLCODE NOT EQUAL ZERO                                  
530900                 DISPLAY '***************************************'        
531000                 DISPLAY '** ABEND                               '        
531100                 DISPLAY '** PROGRAM = TRKUP245                  '        
531200                 DISPLAY '** PARA = 7090-INSERT-TAUCSPO          '        
531300                 DISPLAY '** INSERT TAUCSPO                      '        
531400                 DISPLAY '** ENTRY ID = ' AUCSPO-CSTM-ENTR-ID             
531500                 DISPLAY '***************************************'        
531600                 PERFORM 9100-SQL-ABEND                                   
531700         END-EVALUATE                                                     
531800     END-PERFORM.                                                         
531900                                                                          
532000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
532100         SQLCODE NOT = ZERO                                               
532200         DISPLAY '****************************************'               
532300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
532400         DISPLAY '** INSERT FROM TAUCSPO                  '               
532500         DISPLAY '** PROGRAM = TRKUP245                   '               
532600         DISPLAY '** PARA = 7090-INSERT-TAUCSPO           '               
532700         DISPLAY '** UPDATE TAUCSPO                       '               
532800         DISPLAY '** ENTRY ID = ' AUCSPO-CSTM-ENTR-ID                     
532900         DISPLAY '****************************************'               
533000         PERFORM 9100-SQL-ABEND                                           
533100     END-IF.                                                              
533200                                                                          
533300 EJECT                                                                    
533400******************************************************************        
533500* INSERT TAUCNPO                                                          
533600******************************************************************        
533700                                                                          
533800 7095-INSERT-TAUCNPO.                                                     
533900                                                                          
534000     MOVE PC-U                 TO AUCNPO-AUD-FUNC-CDE.                    
534100     MOVE PV-CURRENT-TMST      TO AUCNPO-AUD-TMST.                        
534200                                                                          
534300     PERFORM                                                              
534400         WITH TEST AFTER                                                  
534500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
534600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
534700                 SQLCODE = ZERO                                           
534800                                                                          
534900         EXEC SQL                                                         
535000             INSERT INTO TAUCNPO                                          
535100                   ( CONTNR_ID                                            
535200                    ,CONTNR_SEQ_NBR                                       
535300                    ,PO_NBR                                               
535400                    ,CSTM_ENTR_ID                                         
535500                    ,MSTR_BOL_NBR                                         
535600                    ,HSE_BOL_NBR                                          
535700                    ,LTR_OF_CR_NBR                                        
535800                    ,PO_RCVD_DELY_TMST                                    
535900                    ,PO_C_O_PROD_CDE                                      
536000                    ,PO_CART_CNT                                          
536100                    ,PO_CBMT_QTY                                          
536200                    ,PO_WT_KGRM_QTY                                       
536300                    ,PO_UNT_QTY                                           
536400                    ,LAST_UPD_BY_USR_ID                                   
536500                    ,LAST_UPD_TMST                                        
536600                    ,AUD_FUNC_CDE                                         
536700                    ,AUD_TMST                                             
536800                    ,EXTL_REF_NBR                                         
536900                    ,BKR_FRGT_RLSE_CDE                                    
537000                    ,DO_RCVD_CDE                                          
537100                    ,CONTNR_PU_CDE                                        
537200                    ,ACTL_POE_DELY_CDE                                    
537300                    ,DVN_CDE                                              
537400                    ,DCONSLR_RET_CDE                                      
537500                    ,SPLT_XMIT_CDE                                        
537600                    ,DOC_RCVD_ORGN_TMST)                                  
537700             VALUES                                                       
537800                  ( :AUCNPO-CONTNR-ID,                                    
537900                    :AUCNPO-CONTNR-SEQ-NBR,                               
538000                    :AUCNPO-PO-NBR,                                       
538100                    :AUCNPO-CSTM-ENTR-ID,                                 
538200                    :AUCNPO-MSTR-BOL-NBR,                                 
538300                    :AUCNPO-HSE-BOL-NBR,                                  
538400                    :AUCNPO-LTR-OF-CR-NBR,                                
538500                    :AUCNPO-PO-RCVD-DELY-TMST,                            
538600                    :AUCNPO-PO-C-O-PROD-CDE,                              
538700                    :AUCNPO-PO-CART-CNT,                                  
538800                    :AUCNPO-PO-CBMT-QTY,                                  
538900                    :AUCNPO-PO-WT-KGRM-QTY,                               
539000                    :AUCNPO-PO-UNT-QTY,                                   
539100                    :AUCNPO-LAST-UPD-BY-USR-ID,                           
539200                    :AUCNPO-LAST-UPD-TMST,                                
539300                    :PC-U,                                                
539400                    :PV-CURRENT-TMST,                                     
539500                    :AUCNPO-EXTL-REF-NBR,                                 
539600                    :AUCNPO-BKR-FRGT-RLSE-CDE,                            
539700                    :AUCNPO-DO-RCVD-CDE,                                  
539800                    :AUCNPO-CONTNR-PU-CDE,                                
539900                    :AUCNPO-ACTL-POE-DELY-CDE,                            
540000                    :AUCNPO-DVN-CDE,                                      
540100                    :AUCNPO-DCONSLR-RET-CDE,                              
540200                    :AUCNPO-SPLT-XMIT-CDE,                                
540300                    :AUCNPO-DOC-RCVD-ORGN-TMST)                           
540400         END-EXEC                                                         
540500                                                                          
540600         EVALUATE TRUE                                                    
540700             WHEN SQLCODE = ZERO                                          
540800                 ADD +1 TO PA-TOT-AUCNPO-INSERTS                          
540900                 DISPLAY 'SUCCESSFUL TAUCNPO AUDIT'                       
541000                     PV-HOLD-ENTRY-ID                                     
541100             WHEN SQLCODE = -904                                          
541200             WHEN SQLCODE = -913                                          
541300                 CONTINUE                                                 
541400             WHEN SQLWARN0 NOT EQUAL SPACE                                
541500             WHEN SQLCODE NOT EQUAL ZERO                                  
541600                DISPLAY '***************************************'         
541700                DISPLAY '** ABEND                               '         
541800                DISPLAY '** PROGRAM = TRKUP245                  '         
541900                DISPLAY '** PARA = 7095-INSERT-TAUCNPO          '         
542000                DISPLAY '** INSERT TAUCNPO                      '         
542100                DISPLAY '** CNTR ID      = ' AUCNPO-CONTNR-ID             
542200                DISPLAY '** CNTR SEQ NBR = ' AUCNPO-CONTNR-SEQ-NBR        
542300                DISPLAY '** PO NBR       = ' AUCNPO-PO-NBR                
542400                DISPLAY '** DCLGEN       = ' DCLTAUCNPO                   
542500                DISPLAY '***************************************'         
542600                PERFORM 9100-SQL-ABEND                                    
542700         END-EVALUATE                                                     
542800     END-PERFORM.                                                         
542900                                                                          
543000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
543100         SQLCODE NOT = ZERO                                               
543200         DISPLAY '****************************************'               
543300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
543400         DISPLAY '** INSERT FROM TAUCNPO                  '               
543500         DISPLAY '** PROGRAM = TRKUP245                   '               
543600         DISPLAY '** PARA = 7095-INSERT-TAUCNPO           '               
543700         DISPLAY '** UPDATE TAUCNPO                       '               
543800         DISPLAY '** CNTR ID      = ' IMCNPO-CONTNR-ID                    
543900         DISPLAY '** CNTR SEQ NBR = ' IMCNPO-CONTNR-SEQ-NBR               
544000         DISPLAY '** PO NBR       = ' IMCNPO-PO-NBR                       
544100         DISPLAY '****************************************'               
544200         PERFORM 9100-SQL-ABEND                                           
544300     END-IF.                                                              
544400                                                                          
544500                                                                          
544600 EJECT                                                                    
544700******************************************************************        
544800* INSERT TOUTTRA                                                          
544900******************************************************************        
545000 7100-INSERT-TOUTTRA-RPT.                                                 
545100                                                                          
545200     MOVE TR241-CSTM-RPT-PAR-1-ODR TO OUTTRA-CSTM-RPT-PAR-1-ODR.          
545300     MOVE TR241-CSTM-RPT-PAR-2-ODR TO OUTTRA-CSTM-RPT-PAR-2-ODR.          
545400                                                                          
545500     IF TR241-RPT-TYP = 'D'                                               
545600        ADD +1 TO PA-TOTAL-DETAIL-COUNT                                   
545700     END-IF.                                                              
545800                                                                          
545900     PERFORM                                                              
546000        WITH TEST AFTER                                                   
546100        VARYING PV-RETRY-COUNTER FROM 1 BY 1                              
546200        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                     
546300                 SQLCODE = ZERO                                           
546400                                                                          
546500     EXEC SQL                                                             
546600         INSERT INTO TOUTTRA                                              
546700             (CSTM_RPT_PAR_1_ODR                                          
546800             ,CSTM_RPT_PAR_2_ODR)                                         
546900            VALUES  (:OUTTRA-CSTM-RPT-PAR-1-ODR                           
547000                    ,:OUTTRA-CSTM-RPT-PAR-2-ODR)                          
547100     END-EXEC                                                             
547200                                                                          
547300         EVALUATE TRUE                                                    
547400             WHEN SQLCODE = ZERO                                          
547500                ADD +1 TO PA-TOT-TOUTTRA-INSERTS                          
547600             WHEN SQLCODE = -904                                          
547700             WHEN SQLCODE = -913                                          
547800                 CONTINUE                                                 
547900             WHEN SQLWARN0 NOT EQUAL SPACE                                
548000             WHEN SQLCODE NOT EQUAL ZERO                                  
548100                 DISPLAY '***************************************'        
548200                 DISPLAY '** ABEND                               '        
548300                 DISPLAY '** PROGRAM = TRKUP245                  '        
548400                 DISPLAY '** PARA = 7100-INSERT-TOUTTRA-RPT      '        
548500                 DISPLAY '** INSERT INTO TOUTTRA                 '        
548600                 DISPLAY '***************************************'        
548700                 PERFORM 9100-SQL-ABEND                                   
548800         END-EVALUATE                                                     
548900     END-PERFORM.                                                         
549000                                                                          
549100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
549200         (SQLCODE NOT = ZERO)                                             
549300         DISPLAY '****************************************'               
549400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
549500         DISPLAY '** INSERT FROM TAUCSEN                  '               
549600         DISPLAY '** PROGRAM = TRKUP245                   '               
549700         DISPLAY '** PARA = 7100-INSERT-TOUTTRA-RPT       '               
549800         DISPLAY '** INSERT TOUTTRA                       '               
549900         DISPLAY '****************************************'               
550000      PERFORM 9100-SQL-ABEND                                              
550100     END-IF.                                                              
550200******************************************************************        
550300*  DELETE TIMCSBL                                                         
550400******************************************************************        
550500 7110-DELETE-TIMCSBL.                                                     
550600                                                                          
550700     PERFORM                                                              
550800         WITH TEST AFTER                                                  
550900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
551000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
551100                 SQLCODE = ZERO                     OR                    
551200                 SQLCODE = +100                                           
551300         EXEC SQL                                                         
551400             DELETE FROM TIMCSBL                                          
551500             WHERE CSTM_ENTR_ID     = :IMCSBL-CSTM-ENTR-ID AND            
551600                   MSTR_BOL_NBR     = :IMCSBL-MSTR-BOL-NBR AND            
551700                   HSE_BOL_NBR      = :IMCSBL-HSE-BOL-NBR                 
551800         END-EXEC                                                         
551900         EVALUATE TRUE                                                    
552000             WHEN SQLCODE = ZERO                                          
552100             WHEN SQLCODE = +100                                          
552200             WHEN SQLCODE = -904                                          
552300             WHEN SQLCODE = -913                                          
552400                 CONTINUE                                                 
552500             WHEN SQLWARN0 NOT EQUAL SPACE                                
552600             WHEN SQLCODE NOT EQUAL ZERO                                  
552700                 DISPLAY '***************************************'        
552800                 DISPLAY '** ABEND                               '        
552900                 DISPLAY '** PROGRAM = TRKUP245                  '        
553000                 DISPLAY '** PARA = 7110-DELETE-TIMCSBL          '        
553100                 DISPLAY '** DELETE TIMCSBL                      '        
553200                 DISPLAY '** ENTRY ID = ' IMCSBL-CSTM-ENTR-ID             
553300                 DISPLAY '***************************************'        
553400                 PERFORM 9100-SQL-ABEND                                   
553500         END-EVALUATE                                                     
553600     END-PERFORM.                                                         
553700                                                                          
553800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
553900         (SQLCODE NOT = ZERO AND                                          
554000          SQLCODE NOT = +100)                                             
554100         DISPLAY '****************************************'               
554200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
554300         DISPLAY '** DELETE FROM TIMCSBL                  '               
554400         DISPLAY '** PROGRAM = TRKUP245                   '               
554500         DISPLAY '** PARA = 7110-DELETE-TIMCSBL           '               
554600         DISPLAY '** DELETE TIMCSBL                       '               
554700         DISPLAY '** ENTRY ID = ' IMCSBL-CSTM-ENTR-ID                     
554800         DISPLAY '****************************************'               
554900         PERFORM 9100-SQL-ABEND                                           
555000     END-IF.                                                              
555100******************************************************************        
555200*  DELETE TIMCSCN                                                         
555300******************************************************************        
555400 7120-DELETE-TIMCSCN.                                                     
555500                                                                          
555600     PERFORM                                                              
555700         WITH TEST AFTER                                                  
555800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
555900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
556000                 SQLCODE = ZERO                     OR                    
556100                 SQLCODE = +100                                           
556200         EXEC SQL                                                         
556300             DELETE FROM TIMCSCN                                          
556400             WHERE CSTM_ENTR_ID     = :IMCSCN-CSTM-ENTR-ID AND            
556500                   CONTNR_ID        = :IMCSCN-CONTNR-ID                   
556600         END-EXEC                                                         
556700                                                                          
556800         EVALUATE TRUE                                                    
556900             WHEN SQLCODE = ZERO                                          
557000                 SET PS-ENTR-ID-FOR-CN-DEL-FOUND   TO TRUE                
557100             WHEN SQLCODE = +100                                          
557200             WHEN SQLCODE = -904                                          
557300             WHEN SQLCODE = -913                                          
557400                 CONTINUE                                                 
557500             WHEN SQLWARN0 NOT EQUAL SPACE                                
557600             WHEN SQLCODE NOT EQUAL ZERO                                  
557700                 DISPLAY '***************************************'        
557800                 DISPLAY '** ABEND                               '        
557900                 DISPLAY '** PROGRAM = TRKUP245                  '        
558000                 DISPLAY '** PARA = 7120-DELETE-TIMCSCN          '        
558100                 DISPLAY '** DELETE TIMCSCN                      '        
558200                 DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID             
558300                 DISPLAY '***************************************'        
558400                 PERFORM 9100-SQL-ABEND                                   
558500         END-EVALUATE                                                     
558600     END-PERFORM.                                                         
558700                                                                          
558800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
558900         (SQLCODE NOT = ZERO AND                                          
559000          SQLCODE NOT = +100)                                             
559100         DISPLAY '****************************************'               
559200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
559300         DISPLAY '** DELETE FROM TIMCSCN                  '               
559400         DISPLAY '** PROGRAM = TRKUP245                   '               
559500         DISPLAY '** PARA = 7120-DELETE-TIMCSCN           '               
559600         DISPLAY '** DELETE TIMCSCN                       '               
559700         DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID                     
559800         DISPLAY '****************************************'               
559900         PERFORM 9100-SQL-ABEND                                           
560000     END-IF.                                                              
560100******************************************************************        
560200*  DELETE TIMCSPO                                                         
560300******************************************************************        
560400 7130-DELETE-TIMCSPO.                                                     
560500     PERFORM                                                              
560600         WITH TEST AFTER                                                  
560700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
560800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
560900                 SQLCODE = ZERO                     OR                    
561000                 SQLCODE = +100                                           
561100         EXEC SQL                                                         
561200             DELETE FROM TIMCSPO                                          
561300             WHERE CSTM_ENTR_ID     = :IMCSPO-CSTM-ENTR-ID                
561400              AND  PO_NBR           = :IMCSPO-PO-NBR                      
561500              AND  EXTL_REF_NBR     = :IMCSPO-EXTL-REF-NBR                
561600         END-EXEC                                                         
561700         EVALUATE TRUE                                                    
561800             WHEN SQLCODE = ZERO                                          
561900                 SET PS-ENTR-ID-FOR-PO-DEL-FOUND  TO TRUE                 
562000             WHEN SQLCODE = +100                                          
562100             WHEN SQLCODE = -904                                          
562200             WHEN SQLCODE = -913                                          
562300                 CONTINUE                                                 
562400             WHEN SQLWARN0 NOT EQUAL SPACE                                
562500             WHEN SQLCODE NOT EQUAL ZERO                                  
562600                 DISPLAY '***************************************'        
562700                 DISPLAY '** ABEND                               '        
562800                 DISPLAY '** PROGRAM = TRKUP245                  '        
562900                 DISPLAY '** PARA = 7130-DELETE-TIMCSPO          '        
563000                 DISPLAY '** DELETE TIMCSPO                      '        
563100                 DISPLAY '** ENTRY ID = ' IMCSPO-CSTM-ENTR-ID             
563200                 DISPLAY '***************************************'        
563300                 PERFORM 9100-SQL-ABEND                                   
563400         END-EVALUATE                                                     
563500     END-PERFORM.                                                         
563600                                                                          
563700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
563800         (SQLCODE NOT = ZERO AND                                          
563900          SQLCODE NOT = +100)                                             
564000         DISPLAY '****************************************'               
564100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
564200         DISPLAY '** DELETE FROM TIMCSPO                  '               
564300         DISPLAY '** PROGRAM = TRKUP245                   '               
564400         DISPLAY '** PARA = 7130-DELETE-TIMCSPO           '               
564500         DISPLAY '** DELETE TIMCSPO                       '               
564600         DISPLAY '** ENTRY ID = ' IMCSPO-CSTM-ENTR-ID                     
564700         DISPLAY '****************************************'               
564800         PERFORM 9100-SQL-ABEND                                           
564900     END-IF.                                                              
565000******************************************************************        
565100*  SELECT TIMCSEN                                                         
565200******************************************************************        
565300 7140-SELECT-TIMCSEN.                                                     
565400                                                                          
565500     PERFORM                                                              
565600         WITH TEST AFTER                                                  
565700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
565800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
565900                 SQLCODE = ZERO                     OR                    
566000                 SQLCODE = +100                                           
566100         EXEC SQL                                                         
566200             SELECT CSTM_ENTR_ID                                          
566300                    ,ENT_ID                                               
566400                    ,BKR_REF_NBR                                          
566500                    ,FILD_TMST                                            
566600                    ,EST_CLR_TMST                                         
566700                    ,ACTL_CLR_TMST                                        
566800                    ,EXM_TMST                                             
566900                    ,REJ_TMST                                             
567000                    ,REJ_DESC                                             
567100                    ,LQDN_TMST                                            
567200                    ,LQDN_SSPNN_TMST                                      
567300                    ,LQDN_SSPNN_DESC                                      
567400                    ,DAT_SRC_ENT_ID                                       
567500                    ,CRE_BY_USR_ID                                        
567600                    ,CRE_TMST                                             
567700                    ,LAST_UPD_BY_USR_ID                                   
567800                    ,LAST_UPD_TMST                                        
567900                    ,MOM_DEST_POE_CDE                                     
568000                    ,MOM_TRIP_TYP_CDE                                     
568100                    ,ENTR_TYP_CDE                                         
568200              INTO  :IMCSEN-CSTM-ENTR-ID,                                 
568300                    :IMCSEN-ENT-ID,                                       
568400                    :IMCSEN-BKR-REF-NBR,                                  
568500                    :IMCSEN-FILD-TMST,                                    
568600                    :IMCSEN-EST-CLR-TMST,                                 
568700                    :IMCSEN-ACTL-CLR-TMST,                                
568800                    :IMCSEN-EXM-TMST,                                     
568900                    :IMCSEN-REJ-TMST,                                     
569000                    :IMCSEN-REJ-DESC,                                     
569100                    :IMCSEN-LQDN-TMST,                                    
569200                    :IMCSEN-LQDN-SSPNN-TMST,                              
569300                    :IMCSEN-LQDN-SSPNN-DESC,                              
569400                    :IMCSEN-DAT-SRC-ENT-ID,                               
569500                    :IMCSEN-CRE-BY-USR-ID,                                
569600                    :IMCSEN-CRE-TMST,                                     
569700                    :IMCSEN-LAST-UPD-BY-USR-ID,                           
569800                    :IMCSEN-LAST-UPD-TMST,                                
569900                    :IMCSEN-MOM-DEST-POE-CDE,                             
570000                    :IMCSEN-MOM-TRIP-TYP-CDE,                             
570100                    :IMCSEN-ENTR-TYP-CDE                                  
570200              FROM  TIMCSEN                                               
570300              WHERE CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID                  
570400          END-EXEC                                                        
570500          EVALUATE TRUE                                                   
570600              WHEN SQLCODE = ZERO                                         
570700                 SET PS-TIMCSEN-AVAIL TO TRUE                             
570800              WHEN SQLCODE = +100                                         
570900                 SET PS-TIMCSEN-NOT-AVAIL TO TRUE                         
571000              WHEN SQLWARN0 NOT EQUAL SPACE                               
571100              WHEN SQLCODE NOT EQUAL ZERO                                 
571200                  DISPLAY '*************************************'         
571300                  DISPLAY '** ABEND                             '         
571400                  DISPLAY '** PROGRAM = TRKUP245                '         
571500                  DISPLAY '** PARA = 7140-SELECT-TIMCSEN        '         
571600                  DISPLAY '** DELETE TIMCSPO                    '         
571700                  DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID            
571800                  DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                  
571900                  DISPLAY '*************************************'         
572000                  PERFORM 9100-SQL-ABEND                                  
572100          END-EVALUATE                                                    
572200     END-PERFORM.                                                         
572300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
572400         (SQLCODE NOT = ZERO AND                                          
572500          SQLCODE NOT = +100)                                             
572600         DISPLAY '****************************************'               
572700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
572800         DISPLAY '** DELETE FROM TIMCSPO                  '               
572900         DISPLAY '** PROGRAM = TRKUP245                   '               
573000         DISPLAY '** PARA = 7140-SELECT-TIMCSEN           '               
573100         DISPLAY '** DELETE TIMCSPO                       '               
573200         DISPLAY '** ENTRY ID = ' IMCSEN-CSTM-ENTR-ID                     
573300         DISPLAY '** ENT ID   = ' IMCSEN-ENT-ID                           
573400         DISPLAY '****************************************'               
573500         PERFORM 9100-SQL-ABEND                                           
573600     END-IF.                                                              
573700                                                                          
573800******************************************************************        
573900*  SELECT TIMCSBL                                                         
574000******************************************************************        
574100 7150-SELECT-TIMCSBL.                                                     
574200                                                                          
574300     PERFORM                                                              
574400         WITH TEST AFTER                                                  
574500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
574600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
574700                 SQLCODE = ZERO                     OR                    
574800                 SQLCODE = +100                                           
574900         EXEC SQL                                                         
575000             SELECT  CSTM_ENTR_ID                                         
575100                    ,MSTR_BOL_NBR                                         
575200                    ,HSE_BOL_NBR                                          
575300                    ,CRE_BY_USR_ID                                        
575400                    ,CRE_TMST                                             
575500                    ,LAST_UPD_BY_USR_ID                                   
575600                    ,LAST_UPD_TMST                                        
575700              INTO :IMCSBL-CSTM-ENTR-ID,                                  
575800                   :IMCSBL-MSTR-BOL-NBR,                                  
575900                   :IMCSBL-HSE-BOL-NBR,                                   
576000                   :IMCSBL-CRE-BY-USR-ID,                                 
576100                   :IMCSBL-CRE-TMST,                                      
576200                   :IMCSBL-LAST-UPD-BY-USR-ID,                            
576300                   :IMCSBL-LAST-UPD-TMST                                  
576400              FROM  TIMCSBL                                               
576500              WHERE CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID    AND           
576600                    MSTR_BOL_NBR     = :PV-HOLD-MBOL        AND           
576700                    HSE_BOL_NBR      = :PV-HOLD-HBOL                      
576800          END-EXEC                                                        
576900          EVALUATE TRUE                                                   
577000              WHEN SQLCODE = ZERO                                         
577100                 SET PS-TIMCSBL-AVAIL TO TRUE                             
577200              WHEN SQLCODE = +100                                         
577300                 SET PS-TIMCSBL-NOT-AVAIL TO TRUE                         
577400              WHEN SQLWARN0 NOT EQUAL SPACE                               
577500              WHEN SQLCODE NOT EQUAL ZERO                                 
577600                  DISPLAY '*************************************'         
577700                  DISPLAY '** ABEND                             '         
577800                  DISPLAY '** PROGRAM = TRKUP245                '         
577900                  DISPLAY '** PARA = 7150-SELECT-TIMCSBL        '         
578000                  DISPLAY '** DELETE TIMCSPO                    '         
578100                  DISPLAY '** ENTRY ID = ' IMCSBL-CSTM-ENTR-ID            
578200                  DISPLAY '** MBOL     = ' IMCSBL-MSTR-BOL-NBR            
578300                  DISPLAY '** HBOL     = ' IMCSBL-HSE-BOL-NBR             
578400                  DISPLAY '*************************************'         
578500                  PERFORM 9100-SQL-ABEND                                  
578600          END-EVALUATE                                                    
578700     END-PERFORM.                                                         
578800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
578900         (SQLCODE NOT = ZERO AND                                          
579000          SQLCODE NOT = +100)                                             
579100         DISPLAY '****************************************'               
579200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
579300         DISPLAY '** DELETE FROM TIMCSPO                  '               
579400         DISPLAY '** PROGRAM = TRKUP245                   '               
579500         DISPLAY '** PARA = 7150-SELECT-TIMCSBL           '               
579600         DISPLAY '** DELETE TIMCSPO                       '               
579700         DISPLAY '** ENTRY ID = ' IMCSBL-CSTM-ENTR-ID                     
579800         DISPLAY '** MBOL     = ' IMCSBL-MSTR-BOL-NBR                     
579900         DISPLAY '** HBOL     = ' IMCSBL-HSE-BOL-NBR                      
580000         DISPLAY '****************************************'               
580100         PERFORM 9100-SQL-ABEND                                           
580200     END-IF.                                                              
580300                                                                          
580400******************************************************************        
580500*  SELECT TIMCSCN                                                         
580600******************************************************************        
580700 7160-SELECT-TIMCSCN.                                                     
580800                                                                          
580900     INITIALIZE DCLTIMCSCN.                                               
581000                                                                          
581100     PERFORM                                                              
581200         WITH TEST AFTER                                                  
581300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
581400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
581500                 SQLCODE = ZERO                     OR                    
581600                 SQLCODE = +100                                           
581700         EXEC SQL                                                         
581800             SELECT  CSTM_ENTR_ID                                         
581900                    ,CONTNR_ID                                            
582000                    ,CRE_BY_USR_ID                                        
582100                    ,CRE_TMST                                             
582200                    ,LAST_UPD_BY_USR_ID                                   
582300                    ,LAST_UPD_TMST                                        
582400                    ,DO_TO_DCONSLR_TMST                                   
582500              INTO :IMCSCN-CSTM-ENTR-ID                                   
582600                  ,:IMCSCN-CONTNR-ID                                      
582700                  ,:IMCSCN-CRE-BY-USR-ID                                  
582800                  ,:IMCSCN-CRE-TMST                                       
582900                  ,:IMCSCN-LAST-UPD-BY-USR-ID                             
583000                  ,:IMCSCN-LAST-UPD-TMST                                  
583100                  ,:IMCSCN-DO-TO-DCONSLR-TMST                             
583200              FROM  TIMCSCN                                               
583300              WHERE CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID AND              
583400                    CONTNR_ID        = :PV-HOLD-CONTAINER                 
583500          END-EXEC                                                        
583600          EVALUATE TRUE                                                   
583700              WHEN SQLCODE = ZERO                                         
583800                 SET PS-TIMCSCN-AVAIL TO TRUE                             
583900              WHEN SQLCODE = +100                                         
584000                 SET PS-TIMCSCN-NOT-AVAIL TO TRUE                         
584100              WHEN SQLWARN0 NOT EQUAL SPACE                               
584200              WHEN SQLCODE NOT EQUAL ZERO                                 
584300                  DISPLAY '*************************************'         
584400                  DISPLAY '** ABEND                             '         
584500                  DISPLAY '** PROGRAM = TRKUP245                '         
584600                  DISPLAY '** PARA = 7160-SELECT-TIMCSCN        '         
584700                  DISPLAY '** SELECT TIMCSCN                    '         
584800                  DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID            
584900                  DISPLAY '** CONTNR ID= ' IMCSCN-CONTNR-ID               
585000                  DISPLAY '*************************************'         
585100                  PERFORM 9100-SQL-ABEND                                  
585200          END-EVALUATE                                                    
585300     END-PERFORM.                                                         
585400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
585500         (SQLCODE NOT = ZERO AND                                          
585600          SQLCODE NOT = +100)                                             
585700         DISPLAY '****************************************'               
585800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
585900         DISPLAY '** DELETE FROM TIMCSPO                  '               
586000         DISPLAY '** PROGRAM = TRKUP245                   '               
586100         DISPLAY '** PARA = 7160-SELECT-TIMCSCN           '               
586200         DISPLAY '** SELECT TIMCSCN                       '               
586300         DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID                     
586400         DISPLAY '** CONTNR ID= ' IMCSCN-CONTNR-ID                        
586500         DISPLAY '****************************************'               
586600         PERFORM 9100-SQL-ABEND                                           
586700     END-IF.                                                              
586800                                                                          
586900******************************************************************        
587000*  SELECT TIMCSPO                                                         
587100******************************************************************        
587200                                                                          
587300 7170-SELECT-TIMCSPO.                                                     
587400                                                                          
587500     PERFORM                                                              
587600         WITH TEST AFTER                                                  
587700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
587800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
587900                 SQLCODE = ZERO                     OR                    
588000                 SQLCODE = +100                                           
588100         EXEC SQL                                                         
588200             SELECT  CSTM_ENTR_ID                                         
588300                    ,PO_NBR                                               
588400                    ,EXTL_REF_NBR                                         
588500                    ,CRE_BY_USR_ID                                        
588600                    ,CRE_TMST                                             
588700                    ,LAST_UPD_BY_USR_ID                                   
588800                    ,LAST_UPD_TMST                                        
588900              INTO :IMCSPO-CSTM-ENTR-ID,                                  
589000                   :IMCSPO-PO-NBR,                                        
589100                   :IMCSPO-EXTL-REF-NBR,                                  
589200                   :IMCSPO-CRE-BY-USR-ID,                                 
589300                   :IMCSPO-CRE-TMST,                                      
589400                   :IMCSPO-LAST-UPD-BY-USR-ID,                            
589500                   :IMCSPO-LAST-UPD-TMST                                  
589600              FROM  TIMCSPO                                               
589700              WHERE CSTM_ENTR_ID     = :PV-HOLD-ENTRY-ID                  
589800               AND  PO_NBR           = :PV-HOLD-PO                        
589900               AND  EXTL_REF_NBR     = :PV-HOLD-EXTL-REF-NBR              
590000          END-EXEC                                                        
590100          EVALUATE TRUE                                                   
590200              WHEN SQLCODE = ZERO                                         
590300                 SET PS-TIMCSPO-AVAIL TO TRUE                             
590400              WHEN SQLCODE = +100                                         
590500                 SET PS-TIMCSPO-NOT-AVAIL TO TRUE                         
590600              WHEN SQLWARN0 NOT EQUAL SPACE                               
590700              WHEN SQLCODE NOT EQUAL ZERO                                 
590800                  DISPLAY '*************************************'         
590900                  DISPLAY '** ABEND                             '         
591000                  DISPLAY '** PROGRAM = TRKUP245                '         
591100                  DISPLAY '** PARA = 7170-SELECT-TIMCSPO        '         
591200                  DISPLAY '** DELETE TIMCSPO                    '         
591300                  DISPLAY '** ENTRY ID = ' IMCSPO-CSTM-ENTR-ID            
591400                  DISPLAY '** PO NUMBER   = ' IMCSPO-PO-NBR               
591500                  DISPLAY '*************************************'         
591600                  PERFORM 9100-SQL-ABEND                                  
591700          END-EVALUATE                                                    
591800     END-PERFORM.                                                         
591900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
592000         (SQLCODE NOT = ZERO AND                                          
592100          SQLCODE NOT = +100)                                             
592200         DISPLAY '****************************************'               
592300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
592400         DISPLAY '** DELETE FROM TIMCSPO                  '               
592500         DISPLAY '** PROGRAM = TRKUP245                   '               
592600         DISPLAY '** PARA = 7170-SELECT-TIMCSPO           '               
592700         DISPLAY '** DELETE TIMCSPO                       '               
592800         DISPLAY '** ENTRY ID = ' IMCSPO-CSTM-ENTR-ID                     
592900         DISPLAY '** PO NUMBER   = ' IMCSPO-PO-NBR                        
593000         DISPLAY '****************************************'               
593100         PERFORM 9100-SQL-ABEND                                           
593200     END-IF.                                                              
593300                                                                          
593400******************************************************************        
593500* OPEN BOL CURSOR                                                         
593600******************************************************************        
593700 7175-OPEN-BOL-CURSOR.                                                    
593800     EXEC SQL                                                             
593900         OPEN BOL                                                         
594000     END-EXEC.                                                            
594100                                                                          
594200     EVALUATE TRUE                                                        
594300        WHEN SQLWARN0 NOT EQUAL SPACE                                     
594400        WHEN SQLCODE NOT EQUAL ZERO                                       
594500           DISPLAY '** ABEND                             '                
594600           DISPLAY '** PROGRAM = TRKUP245                '                
594700           DISPLAY '** PARAGRAPH = 7175-OPEN-BOL-CURSOR  '                
594800           PERFORM 9100-SQL-ABEND                                         
594900     END-EVALUATE.                                                        
595000******************************************************************        
595100* CLOSE BOL CURSOR                                                        
595200******************************************************************        
595300 7176-CLOSE-BOL-CURSOR.                                                   
595400     EXEC SQL                                                             
595500       CLOSE BOL                                                          
595600     END-EXEC.                                                            
595700                                                                          
595800     EVALUATE TRUE                                                        
595900        WHEN SQLWARN0 NOT EQUAL SPACE                                     
596000        WHEN SQLCODE NOT EQUAL ZERO                                       
596100           DISPLAY '** ABEND                              '               
596200           DISPLAY '** PROGRAM = TRKUP245                 '               
596300           DISPLAY '** PARAGRAPH = 7176-CLOSE-BOL-CURSOR  '               
596400           PERFORM 9100-SQL-ABEND                                         
596500     END-EVALUATE.                                                        
596600****************************************************************          
596700* FETCH BOL CURSOR                                                        
596800****************************************************************          
596900 7177-FETCH-BOL-CURSOR.                                                   
597000     EXEC SQL                                                             
597100         FETCH BOL                                                        
597200              INTO :IMCSBL-CSTM-ENTR-ID,                                  
597300                   :IMCSBL-MSTR-BOL-NBR,                                  
597400                   :IMCSBL-HSE-BOL-NBR,                                   
597500                   :IMCSBL-CRE-BY-USR-ID,                                 
597600                   :IMCSBL-CRE-TMST,                                      
597700                   :IMCSBL-LAST-UPD-BY-USR-ID,                            
597800                   :IMCSBL-LAST-UPD-TMST                                  
597900     END-EXEC.                                                            
598000     EVALUATE TRUE                                                        
598100        WHEN SQLCODE = ZERO                                               
598200        WHEN SQLCODE = +100                                               
598300           CONTINUE                                                       
598400        WHEN SQLWARN0 NOT EQUAL SPACE                                     
598500        WHEN SQLCODE NOT EQUAL ZERO                                       
598600           DISPLAY '** ABEND                              '               
598700           DISPLAY '** PROGRAM = TRKUP245                 '               
598800           DISPLAY '** PARAGRAPH = 7177-FETCH-BOL-CURSOR  '               
598900           PERFORM 9100-SQL-ABEND                                         
599000     END-EVALUATE.                                                        
599100******************************************************************        
599200* OPEN CON CURSOR                                                         
599300******************************************************************        
599400 7180-OPEN-CON-CURSOR.                                                    
599500     EXEC SQL                                                             
599600         OPEN CON                                                         
599700     END-EXEC.                                                            
599800                                                                          
599900     EVALUATE TRUE                                                        
600000        WHEN SQLWARN0 NOT EQUAL SPACE                                     
600100        WHEN SQLCODE NOT EQUAL ZERO                                       
600200           DISPLAY '** ABEND                             '                
600300           DISPLAY '** PROGRAM = TRKUP245                '                
600400           DISPLAY '** PARAGRAPH = 7180-OPEN-CON-CURSOR  '                
600500           PERFORM 9100-SQL-ABEND                                         
600600     END-EVALUATE.                                                        
600700******************************************************************        
600800* CLOSE CON CURSOR                                                        
600900******************************************************************        
601000 7181-CLOSE-CON-CURSOR.                                                   
601100     EXEC SQL                                                             
601200       CLOSE CON                                                          
601300     END-EXEC.                                                            
601400                                                                          
601500     EVALUATE TRUE                                                        
601600        WHEN SQLWARN0 NOT EQUAL SPACE                                     
601700        WHEN SQLCODE NOT EQUAL ZERO                                       
601800           DISPLAY '** ABEND                              '               
601900           DISPLAY '** PROGRAM = TRKUP245                 '               
602000           DISPLAY '** PARAGRAPH = 7181-CLOSE-CON-CURSOR  '               
602100           PERFORM 9100-SQL-ABEND                                         
602200     END-EVALUATE.                                                        
602300****************************************************************          
602400* FETCH CON CURSOR                                                        
602500****************************************************************          
602600 7182-FETCH-CON-CURSOR.                                                   
602700     EXEC SQL                                                             
602800         FETCH CON                                                        
602900              INTO :IMCSCN-CSTM-ENTR-ID,                                  
603000                   :IMCSCN-CONTNR-ID,                                     
603100                   :IMCSCN-CRE-BY-USR-ID,                                 
603200                   :IMCSCN-CRE-TMST,                                      
603300                   :IMCSCN-LAST-UPD-BY-USR-ID,                            
603400                   :IMCSCN-LAST-UPD-TMST,                                 
603500                   :IMCSCN-DO-TO-DCONSLR-TMST                             
603600     END-EXEC.                                                            
603700     EVALUATE TRUE                                                        
603800        WHEN SQLCODE = ZERO                                               
603900        WHEN SQLCODE = +100                                               
604000           CONTINUE                                                       
604100        WHEN SQLWARN0 NOT EQUAL SPACE                                     
604200        WHEN SQLCODE NOT EQUAL ZERO                                       
604300           DISPLAY '** ABEND                              '               
604400           DISPLAY '** PROGRAM = TRKUP245                 '               
604500           DISPLAY '** PARAGRAPH = 7182-FETCH-CON-CURSOR  '               
604600           PERFORM 9100-SQL-ABEND                                         
604700     END-EVALUATE.                                                        
604800******************************************************************        
604900* OPEN PO CURSOR                                                          
605000******************************************************************        
605100 7185-OPEN-PO-CURSOR.                                                     
605200     EXEC SQL                                                             
605300         OPEN PO                                                          
605400     END-EXEC.                                                            
605500                                                                          
605600     EVALUATE TRUE                                                        
605700        WHEN SQLWARN0 NOT EQUAL SPACE                                     
605800        WHEN SQLCODE NOT EQUAL ZERO                                       
605900           DISPLAY '** ABEND                             '                
606000           DISPLAY '** PROGRAM = TRKUP245                '                
606100           DISPLAY '** PARAGRAPH = 7185-OPEN-PO-CURSOR   '                
606200           PERFORM 9100-SQL-ABEND                                         
606300     END-EVALUATE.                                                        
606400******************************************************************        
606500* CLOSE PO CURSOR                                                         
606600******************************************************************        
606700 7186-CLOSE-PO-CURSOR.                                                    
606800     EXEC SQL                                                             
606900       CLOSE PO                                                           
607000     END-EXEC.                                                            
607100                                                                          
607200     EVALUATE TRUE                                                        
607300        WHEN SQLWARN0 NOT EQUAL SPACE                                     
607400        WHEN SQLCODE NOT EQUAL ZERO                                       
607500           DISPLAY '** ABEND                              '               
607600           DISPLAY '** PROGRAM = TRKUP245                 '               
607700           DISPLAY '** PARAGRAPH = 7186-CLOSE-PO-CURSOR   '               
607800           PERFORM 9100-SQL-ABEND                                         
607900     END-EVALUATE.                                                        
608000****************************************************************          
608100* FETCH PO CURSOR                                                         
608200****************************************************************          
608300 7187-FETCH-PO-CURSOR.                                                    
608400     EXEC SQL                                                             
608500         FETCH PO                                                         
608600              INTO :IMCSPO-CSTM-ENTR-ID,                                  
608700                   :IMCSPO-PO-NBR,                                        
608800                   :IMCSPO-EXTL-REF-NBR,                                  
608900                   :IMCSPO-CRE-BY-USR-ID,                                 
609000                   :IMCSPO-CRE-TMST,                                      
609100                   :IMCSPO-LAST-UPD-BY-USR-ID,                            
609200                   :IMCSPO-LAST-UPD-TMST                                  
609300     END-EXEC.                                                            
609400     EVALUATE TRUE                                                        
609500        WHEN SQLCODE = ZERO                                               
609600        WHEN SQLCODE = +100                                               
609700           CONTINUE                                                       
609800        WHEN SQLWARN0 NOT EQUAL SPACE                                     
609900        WHEN SQLCODE NOT EQUAL ZERO                                       
610000           DISPLAY '** ABEND                              '               
610100           DISPLAY '** PROGRAM = TRKUP245                 '               
610200           DISPLAY '** PARAGRAPH = 7187-FETCH-PO-CURSOR  '                
610300           PERFORM 9100-SQL-ABEND                                         
610400     END-EVALUATE.                                                        
610500                                                                          
610600****************************************************************          
610700* SELECT TPURCHS                                                          
610800****************************************************************          
610900                                                                          
611000 7190-SELECT-TPURCHS.                                                     
611100                                                                          
611200     PERFORM                                                              
611300         WITH TEST AFTER                                                  
611400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
611500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
611600                 SQLCODE = ZERO                     OR                    
611700                 SQLCODE = +100                                           
611800                                                                          
611900         EXEC SQL                                                         
612000             SELECT PO_NBR,                                               
612100                    STATUS_CDE                                            
612200              INTO :PURCHS-PO-NBR,                                        
612300                   :PURCHS-STATUS-CDE                                     
612400                                                                          
612500               FROM TPURCHS                                               
612600              WHERE PO_NBR           = :PURCHS-PO-NBR AND                 
612700                    VER_STATUS_CDE   = 'A'                                
612800         END-EXEC                                                         
612900                                                                          
613000         EVALUATE TRUE                                                    
613100             WHEN SQLCODE = ZERO                                          
613200                IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                       
613300                   SET PS-PO-AVAIL TO TRUE                                
613400                ELSE                                                      
613500                   SET PS-PO-NOT-AVAIL TO TRUE                            
613600                END-IF                                                    
613700             WHEN SQLCODE = +100                                          
613800                SET PS-PO-NOT-FOUND TO TRUE                               
613900             WHEN SQLWARN0 NOT EQUAL SPACE                                
614000             WHEN SQLCODE NOT EQUAL ZERO                                  
614100                 DISPLAY '**************************************'         
614200                 DISPLAY '** ABEND                              '         
614300                 DISPLAY '** PROGRAM = TRKUP245                 '         
614400                 DISPLAY '** PARAGRAPH = 7190-SELECT-TPURCHS    '         
614500                 DISPLAY '** SELECT FROM TPURCHS                '         
614600                 DISPLAY '**************************************'         
614700                 PERFORM 9100-SQL-ABEND                                   
614800         END-EVALUATE                                                     
614900     END-PERFORM.                                                         
615000                                                                          
615100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
615200         (SQLCODE NOT = ZERO AND                                          
615300             SQLCODE NOT = +100)                                          
615400         DISPLAY '****************************************'               
615500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
615600         DISPLAY '** SELECT FROM TPURCHS                  '               
615700         DISPLAY '** PARAGRAPH = 7190-SELECT-TPURCHS      '               
615800         DISPLAY '****************************************'               
615900         PERFORM 9100-SQL-ABEND                                           
616000     END-IF.                                                              
616100******************************************************************        
616200* OPEN THE TIMCNPO_CSR.                                          *        
616300******************************************************************        
616400 7200-OPEN-TIMCNPO-CURSOR.                                                
616500                                                                          
616600     EXEC SQL                                                             
616700          OPEN TIMCNPO_CSR                                                
616800     END-EXEC.                                                            
616900                                                                          
617000     EVALUATE TRUE                                                        
617100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
617200         WHEN SQLCODE  NOT EQUAL ZERO                                     
617300             DISPLAY '** ***************************************'         
617400             DISPLAY '** ABEND                                **'         
617500             DISPLAY '** PROGRAM = TRKUP245                   **'         
617600             DISPLAY '** PARAGRAPH = 7200-OPEN-TIMCNPO-CURSOR **'         
617700             DISPLAY '** ***************************************'         
617800             PERFORM 9100-SQL-ABEND                                       
617900     END-EVALUATE.                                                        
618000                                                                          
618100******************************************************************        
618200* FETCH THE TIMCNPO_CSR.                                         *        
618300******************************************************************        
618400 7201-FETCH-TIMCNPO-CURSOR.                                               
618500                                                                          
618600     INITIALIZE DCLTIMCNPO.                                               
618700     EXEC SQL                                                             
618800          FETCH TIMCNPO_CSR                                               
618900              INTO :IMCNPO-CONTNR-ID,                                     
619000                   :IMCNPO-CONTNR-SEQ-NBR,                                
619100                   :IMCNPO-PO-NBR,                                        
619200                   :IMCNPO-CSTM-ENTR-ID,                                  
619300                   :IMCNPO-MSTR-BOL-NBR,                                  
619400                   :IMCNPO-HSE-BOL-NBR,                                   
619500                   :IMCNPO-LTR-OF-CR-NBR,                                 
619600                   :IMCNPO-PO-RCVD-DELY-TMST,                             
619700                   :IMCNPO-PO-C-O-PROD-CDE,                               
619800                   :IMCNPO-PO-CART-CNT,                                   
619900                   :IMCNPO-PO-CBMT-QTY,                                   
620000                   :IMCNPO-PO-WT-KGRM-QTY,                                
620100                   :IMCNPO-PO-UNT-QTY,                                    
620200                   :IMCNPO-CRE-BY-USR-ID,                                 
620300                   :IMCNPO-CRE-TMST,                                      
620400                   :IMCNPO-LAST-UPD-BY-USR-ID,                            
620500                   :IMCNPO-LAST-UPD-TMST,                                 
620600                   :IMCNPO-EXTL-REF-NBR,                                  
620700                   :IMCNPO-BKR-FRGT-RLSE-CDE,                             
620800                   :IMCNPO-DO-RCVD-CDE,                                   
620900                   :IMCNPO-CONTNR-PU-CDE,                                 
621000                   :IMCNPO-ACTL-POE-DELY-CDE,                             
621100                   :IMCNPO-DVN-CDE,                                       
621200                   :IMCNPO-DCONSLR-RET-CDE,                               
621300                   :IMCNPO-SPLT-XMIT-CDE,                                 
621400                   :IMCNPO-DOC-RCVD-ORGN-TMST                             
621500     END-EXEC.                                                            
621600                                                                          
621700     EVALUATE TRUE                                                        
621800         WHEN SQLCODE = ZERO                                              
621900                PERFORM 7205-CSTM-ENTR-UPDATE                             
622000                SET PS-TIMCNPO-ROWS-EXIST   TO TRUE                       
622100         WHEN SQLCODE = +100                                              
622200                SET PS-EOC-TIMCNPO-CSR            TO TRUE                 
622300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
622400         WHEN SQLCODE  NOT EQUAL ZERO                                     
622500             DISPLAY '** ****************************************'        
622600             DISPLAY '** ABEND                                 **'        
622700             DISPLAY '** PROGRAM = TRKUP245                    **'        
622800             DISPLAY '** PARAGRAPH = 7201-FETCH-TIMCNPO-CURSOR **'        
622900             DISPLAY '** ****************************************'        
623000             PERFORM 9100-SQL-ABEND                                       
623100     END-EVALUATE.                                                        
623200                                                                          
623300 EJECT                                                                    
623400                                                                          
623500******************************************************************        
623600* CLOSE THE TIMCNPO_CSR.                                         *        
623700******************************************************************        
623800 7202-CLOSE-TIMCNPO-CURSOR.                                               
623900                                                                          
624000     EXEC SQL                                                             
624100         CLOSE TIMCNPO_CSR                                                
624200     END-EXEC.                                                            
624300                                                                          
624400     EVALUATE TRUE                                                        
624500         WHEN SQLWARN0 NOT EQUAL SPACE                                    
624600         WHEN SQLCODE  NOT EQUAL ZERO                                     
624700             DISPLAY '** ***************************************'         
624800             DISPLAY '** ABEND                                **'         
624900             DISPLAY '** PROGRAM = TRKUP245                   **'         
625000             DISPLAY '** PARAGRAPH = 7202-CLOSE-TIMCNPO-CURSOR**'         
625100             DISPLAY '** ***************************************'         
625200             PERFORM 9100-SQL-ABEND                                       
625300     END-EVALUATE.                                                        
625400                                                                          
625500******************************************************************        
625600* ADD THE CSTM_ENTR_ID TO TIMCNPO WHEN A NEW ROW IS ADDED TO              
625700* TIMCSCN OR TIMCSPO.                                                     
625800******************************************************************        
625900 7205-CSTM-ENTR-UPDATE.                                                   
626000                                                                          
626100     IF IMCNPO-CSTM-ENTR-ID = SPACES                                      
626200      OR PV-HOLD-ENTRY-TYP-FROM-ENF  = '32'                               
626300       PERFORM 5410-MOVE-TIMCNPO-TO-TAUCNPO                               
626400       PERFORM 7095-INSERT-TAUCNPO                                        
626500       MOVE PV-HOLD-ENTR-ID-FOR-CNPO-UPD TO IMCNPO-CSTM-ENTR-ID           
626600       PERFORM 7310-UPDATE-TIMCNPO                                        
626700     END-IF.                                                              
626800                                                                          
626900******************************************************************        
627000* OPEN THE TIMCNPO_D_CN_CSR.                                     *        
627100******************************************************************        
627200 7220-OPEN-TIMCNPO-D-CN-CURSOR.                                           
627300                                                                          
627400     EXEC SQL                                                             
627500          OPEN TIMCNPO_D_CN_CSR                                           
627600     END-EXEC.                                                            
627700                                                                          
627800     EVALUATE TRUE                                                        
627900         WHEN SQLWARN0 NOT EQUAL SPACE                                    
628000         WHEN SQLCODE  NOT EQUAL ZERO                                     
628100          DISPLAY '** *******************************************'        
628200          DISPLAY '** ABEND                                    **'        
628300          DISPLAY '** PROGRAM = TRKUP245                       **'        
628400          DISPLAY '** PARAGRAPH = 7220-OPEN-TIMCNPO-D-CN-CURSOR**'        
628500          DISPLAY '** *******************************************'        
628600          PERFORM 9100-SQL-ABEND                                          
628700     END-EVALUATE.                                                        
628800                                                                          
628900******************************************************************        
629000* FETCH THE TIMCNPO_D_CN_CSR.                                    *        
629100******************************************************************        
629200 7221-FETCH-TIMCNPO-D-CN-CURSOR.                                          
629300                                                                          
629400     INITIALIZE DCLTIMCNPO.                                               
629500                                                                          
629600     EXEC SQL                                                             
629700          FETCH TIMCNPO_D_CN_CSR                                          
629800              INTO    :IMCNPO-CONTNR-ID                                   
629900                     ,:IMCNPO-CONTNR-SEQ-NBR                              
630000                     ,:IMCNPO-PO-NBR                                      
630100                     ,:IMCNPO-CSTM-ENTR-ID                                
630200                     ,:IMCNPO-MSTR-BOL-NBR                                
630300                     ,:IMCNPO-HSE-BOL-NBR                                 
630400                     ,:IMCNPO-LTR-OF-CR-NBR                               
630500                     ,:IMCNPO-PO-RCVD-DELY-TMST                           
630600                     ,:IMCNPO-PO-C-O-PROD-CDE                             
630700                     ,:IMCNPO-PO-CART-CNT                                 
630800                     ,:IMCNPO-PO-CBMT-QTY                                 
630900                     ,:IMCNPO-PO-WT-KGRM-QTY                              
631000                     ,:IMCNPO-PO-UNT-QTY                                  
631100                     ,:IMCNPO-CRE-BY-USR-ID                               
631200                     ,:IMCNPO-CRE-TMST                                    
631300                     ,:IMCNPO-LAST-UPD-BY-USR-ID                          
631400                     ,:IMCNPO-LAST-UPD-TMST                               
631500                     ,:IMCNPO-EXTL-REF-NBR                                
631600                     ,:IMCNPO-BKR-FRGT-RLSE-CDE                           
631700                     ,:IMCNPO-DO-RCVD-CDE                                 
631800                     ,:IMCNPO-CONTNR-PU-CDE                               
631900                     ,:IMCNPO-ACTL-POE-DELY-CDE                           
632000                     ,:IMCNPO-DVN-CDE                                     
632100                     ,:IMCNPO-DCONSLR-RET-CDE                             
632200                     ,:IMCNPO-SPLT-XMIT-CDE                               
632300                     ,:IMCNPO-DOC-RCVD-ORGN-TMST                          
632400     END-EXEC.                                                            
632500                                                                          
632600     EVALUATE TRUE                                                        
632700         WHEN SQLCODE = ZERO                                              
632800             PERFORM 7225-CSCN-ENTR-ID-DELETE                             
632900         WHEN SQLCODE = +100                                              
633000             SET PS-EOC-TIMCNPO-D-CN-CSR  TO TRUE                         
633100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
633200         WHEN SQLCODE  NOT EQUAL ZERO                                     
633300         DISPLAY '** ********************************************'        
633400         DISPLAY '** ABEND                                     **'        
633500         DISPLAY '** PROGRAM = TRKUP245                        **'        
633600         DISPLAY '** PARAGRAPH = 7221-FETCH-TIMCNPO-D-CN-CURSOR**'        
633700         DISPLAY '** ********************************************'        
633800         PERFORM 9100-SQL-ABEND                                           
633900     END-EVALUATE.                                                        
634000                                                                          
634100 EJECT                                                                    
634200                                                                          
634300******************************************************************        
634400* CLOSE THE TIMCNPO_D_CN_CSR.                                    *        
634500******************************************************************        
634600 7222-CLOSE-TIMCNPO-D-CN-CURSOR.                                          
634700                                                                          
634800     EXEC SQL                                                             
634900         CLOSE TIMCNPO_D_CN_CSR                                           
635000     END-EXEC.                                                            
635100                                                                          
635200     EVALUATE TRUE                                                        
635300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
635400         WHEN SQLCODE  NOT EQUAL ZERO                                     
635500         DISPLAY '** ********************************************'        
635600         DISPLAY '** ABEND                                     **'        
635700         DISPLAY '** PROGRAM = TRKUP245                        **'        
635800         DISPLAY '** PARAGRAPH = 7222-CLOSE-TIMCNPO-D-CN-CURSOR**'        
635900         DISPLAY '** ********************************************'        
636000         PERFORM 9100-SQL-ABEND                                           
636100     END-EVALUATE.                                                        
636200                                                                          
636300******************************************************************        
636400* DELETE THE CSTM_ENTR_ID FOR TIMCNPO FOR EVERY DELETE OF TIMCSCN         
636500******************************************************************        
636600 7225-CSCN-ENTR-ID-DELETE.                                                
636700                                                                          
636800     IF IMCNPO-CSTM-ENTR-ID = SPACES                                      
636900        CONTINUE                                                          
637000     ELSE                                                                 
637100        PERFORM 5410-MOVE-TIMCNPO-TO-TAUCNPO                              
637200        PERFORM 7095-INSERT-TAUCNPO                                       
637300        MOVE SPACES TO IMCNPO-CSTM-ENTR-ID                                
637400        PERFORM 7310-UPDATE-TIMCNPO                                       
637500     END-IF.                                                              
637600                                                                          
637700 EJECT                                                                    
637800                                                                          
637900******************************************************************        
638000* OPEN THE TIMCNPO_D_PO_CSR.                                     *        
638100******************************************************************        
638200 7230-OPEN-TIMCNPO-D-PO-CURSOR.                                           
638300                                                                          
638400     EXEC SQL                                                             
638500          OPEN TIMCNPO_D_PO_CSR                                           
638600     END-EXEC.                                                            
638700                                                                          
638800     EVALUATE TRUE                                                        
638900         WHEN SQLWARN0 NOT EQUAL SPACE                                    
639000         WHEN SQLCODE  NOT EQUAL ZERO                                     
639100          DISPLAY '** *******************************************'        
639200          DISPLAY '** ABEND                                    **'        
639300          DISPLAY '** PROGRAM = TRKUP245                       **'        
639400          DISPLAY '** PARAGRAPH = 7230-OPEN-TIMCNPO-D-PO-CURSOR**'        
639500          DISPLAY '** *******************************************'        
639600          PERFORM 9100-SQL-ABEND                                          
639700     END-EVALUATE.                                                        
639800                                                                          
639900******************************************************************        
640000* FETCH THE TIMCNPO_D_PO_CSR.                                    *        
640100******************************************************************        
640200 7231-FETCH-TIMCNPO-D-PO-CURSOR.                                          
640300                                                                          
640400     INITIALIZE DCLTIMCNPO.                                               
640500                                                                          
640600     EXEC SQL                                                             
640700          FETCH TIMCNPO_D_PO_CSR                                          
640800              INTO    :IMCNPO-CONTNR-ID                                   
640900                     ,:IMCNPO-CONTNR-SEQ-NBR                              
641000                     ,:IMCNPO-PO-NBR                                      
641100                     ,:IMCNPO-CSTM-ENTR-ID                                
641200                     ,:IMCNPO-MSTR-BOL-NBR                                
641300                     ,:IMCNPO-HSE-BOL-NBR                                 
641400                     ,:IMCNPO-LTR-OF-CR-NBR                               
641500                     ,:IMCNPO-PO-RCVD-DELY-TMST                           
641600                     ,:IMCNPO-PO-C-O-PROD-CDE                             
641700                     ,:IMCNPO-PO-CART-CNT                                 
641800                     ,:IMCNPO-PO-CBMT-QTY                                 
641900                     ,:IMCNPO-PO-WT-KGRM-QTY                              
642000                     ,:IMCNPO-PO-UNT-QTY                                  
642100                     ,:IMCNPO-CRE-BY-USR-ID                               
642200                     ,:IMCNPO-CRE-TMST                                    
642300                     ,:IMCNPO-LAST-UPD-BY-USR-ID                          
642400                     ,:IMCNPO-LAST-UPD-TMST                               
642500                     ,:IMCNPO-EXTL-REF-NBR                                
642600                     ,:IMCNPO-BKR-FRGT-RLSE-CDE                           
642700                     ,:IMCNPO-DO-RCVD-CDE                                 
642800                     ,:IMCNPO-CONTNR-PU-CDE                               
642900                     ,:IMCNPO-ACTL-POE-DELY-CDE                           
643000                     ,:IMCNPO-DVN-CDE                                     
643100                     ,:IMCNPO-DCONSLR-RET-CDE                             
643200                     ,:IMCNPO-SPLT-XMIT-CDE                               
643300                     ,:IMCNPO-DOC-RCVD-ORGN-TMST                          
643400     END-EXEC.                                                            
643500                                                                          
643600     EVALUATE TRUE                                                        
643700         WHEN SQLCODE = ZERO                                              
643800             PERFORM 7235-CSPO-ENTR-ID-DELETE                             
643900         WHEN SQLCODE = +100                                              
644000             SET PS-EOC-TIMCNPO-D-PO-CSR   TO TRUE                        
644100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
644200         WHEN SQLCODE  NOT EQUAL ZERO                                     
644300         DISPLAY '** ********************************************'        
644400         DISPLAY '** ABEND                                     **'        
644500         DISPLAY '** PROGRAM = TRKUP245                        **'        
644600         DISPLAY '** PARAGRAPH = 7231-FETCH-TIMCNPO-D-PO-CURSOR**'        
644700         DISPLAY '** ********************************************'        
644800         PERFORM 9100-SQL-ABEND                                           
644900     END-EVALUATE.                                                        
645000                                                                          
645100 EJECT                                                                    
645200                                                                          
645300******************************************************************        
645400* CLOSE THE TIMCNPO_D_PO_CSR.                                    *        
645500******************************************************************        
645600 7232-CLOSE-TIMCNPO-D-PO-CURSOR.                                          
645700                                                                          
645800     EXEC SQL                                                             
645900         CLOSE TIMCNPO_D_PO_CSR                                           
646000     END-EXEC.                                                            
646100                                                                          
646200     EVALUATE TRUE                                                        
646300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
646400         WHEN SQLCODE  NOT EQUAL ZERO                                     
646500           DISPLAY '** ******************************************'        
646600           DISPLAY '** ABEND                                   **'        
646700           DISPLAY '** PROGRAM = TRKUP245                      **'        
646800           DISPLAY '** PARAGRAPH = 7232-CLOSE-TIMCNPO-D-PO-CURSOR'        
646900           DISPLAY '** ******************************************'        
647000           PERFORM 9100-SQL-ABEND                                         
647100     END-EVALUATE.                                                        
647200                                                                          
647300******************************************************************        
647400* DELETE THE ENTR_ID FOR TIMCNPO FOR EVERY DELETE OF TIMCSPO              
647500******************************************************************        
647600 7235-CSPO-ENTR-ID-DELETE.                                                
647700                                                                          
647800     IF IMCNPO-CSTM-ENTR-ID = SPACES                                      
647900        CONTINUE                                                          
648000     ELSE                                                                 
648100        PERFORM 5410-MOVE-TIMCNPO-TO-TAUCNPO                              
648200        PERFORM 7095-INSERT-TAUCNPO                                       
648300        MOVE SPACES TO IMCNPO-CSTM-ENTR-ID                                
648400        PERFORM 7310-UPDATE-TIMCNPO                                       
648500     END-IF.                                                              
648600                                                                          
648700 EJECT                                                                    
648800                                                                          
648900******************************************************************        
649000*  SELECT TIMCSEN FOR A TRIP TYP CHECK.                                   
649100******************************************************************        
649200 7300-CHECK-TIMCSEN-TRIP-TYP.                                             
649300                                                                          
649400     PERFORM                                                              
649500         WITH TEST AFTER                                                  
649600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
649700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
649800                 SQLCODE = ZERO                     OR                    
649900                 SQLCODE = +100                                           
650000         EXEC SQL                                                         
650100             SELECT MOM_TRIP_TYP_CDE                                      
650200              INTO :IMCSEN-MOM-TRIP-TYP-CDE                               
650300              FROM  TIMCSEN                                               
650400              WHERE CSTM_ENTR_ID = :PV-HOLD-ENTR-ID-FOR-CNPO-UPD          
650500          END-EXEC                                                        
650600          EVALUATE TRUE                                                   
650700              WHEN SQLCODE = ZERO                                         
650800                 SET PS-TIMCSEN-TRIP-TYP-FOUND      TO TRUE               
650900              WHEN SQLCODE = +100                                         
651000                 CONTINUE                                                 
651100              WHEN SQLWARN0 NOT EQUAL SPACE                               
651200              WHEN SQLCODE NOT EQUAL ZERO                                 
651300                  DISPLAY '*************************************'         
651400                  DISPLAY '** ABEND                             '         
651500                  DISPLAY '** PROGRAM = TRKUP245                '         
651600                  DISPLAY '** PARA = 7300-CHECK-TIMCSEN-TRIP-TYP'         
651700                  DISPLAY '** SELECT TIMCSEN                    '         
651800                  DISPLAY '** ENTRY ID = ' PV-HOLD-ENTRY-ID               
651900                  DISPLAY '*************************************'         
652000                  PERFORM 9100-SQL-ABEND                                  
652100          END-EVALUATE                                                    
652200     END-PERFORM.                                                         
652300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
652400         (SQLCODE NOT = ZERO AND                                          
652500          SQLCODE NOT = +100)                                             
652600         DISPLAY '****************************************'               
652700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
652800         DISPLAY '** SELECT FROM TIMCSEN                  '               
652900         DISPLAY '** PROGRAM = TRKUP245                   '               
653000         DISPLAY '** PARA = 7300-CHECK-TIMCSEN-TRIP-TYP   '               
653100         DISPLAY '** SELECT TIMCSEN                       '               
653200         DISPLAY '** ENTRY ID = ' PV-HOLD-ENTRY-ID                        
653300         DISPLAY '****************************************'               
653400         PERFORM 9100-SQL-ABEND                                           
653500     END-IF.                                                              
653600******************************************************************        
653700*  UPDATE TIMCNPO                                                         
653800******************************************************************        
653900 7310-UPDATE-TIMCNPO.                                                     
654000                                                                          
654100     MOVE PC-CURRENT-PROGRAM-NAME TO IMCNPO-LAST-UPD-BY-USR-ID.           
654200     MOVE PV-CURRENT-TMST         TO IMCNPO-LAST-UPD-TMST.                
654300                                                                          
654400     PERFORM                                                              
654500         WITH TEST AFTER                                                  
654600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
654700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
654800                 SQLCODE = ZERO                     OR                    
654900                 SQLCODE = +100                                           
655000         EXEC SQL                                                         
655100            UPDATE TIMCNPO                                                
655200            SET CSTM_ENTR_ID         = :IMCNPO-CSTM-ENTR-ID,              
655300                LAST_UPD_BY_USR_ID   = :IMCNPO-LAST-UPD-BY-USR-ID,        
655400                LAST_UPD_TMST        = :IMCNPO-LAST-UPD-TMST              
655500            WHERE CONTNR_ID          = :IMCNPO-CONTNR-ID                  
655600              AND CONTNR_SEQ_NBR     = :IMCNPO-CONTNR-SEQ-NBR             
655700              AND PO_NBR             = :IMCNPO-PO-NBR                     
655800         END-EXEC                                                         
655900                                                                          
656000         EVALUATE TRUE                                                    
656100             WHEN SQLCODE = ZERO                                          
656200                 ADD +1 TO PA-TOT-IMCNPO-UPDATES                          
656300             WHEN SQLCODE = -904                                          
656400             WHEN SQLCODE = -913                                          
656500                 CONTINUE                                                 
656600             WHEN SQLWARN0 NOT EQUAL SPACE                                
656700             WHEN SQLCODE NOT EQUAL ZERO                                  
656800                DISPLAY '***************************************'         
656900                DISPLAY '** ABEND                               '         
657000                DISPLAY '** PROGRAM = TRKUP245                  '         
657100                DISPLAY '** PARA = 7310-UPDATE-TIMCNPO          '         
657200                DISPLAY '** UPDATE TIMCNPO                      '         
657300                DISPLAY '** CNTR ID      = ' IMCNPO-CONTNR-ID             
657400                DISPLAY '** CNTR SEQ NBR = ' IMCNPO-CONTNR-SEQ-NBR        
657500                DISPLAY '** PO NBR       = ' IMCNPO-PO-NBR                
657600                DISPLAY '***************************************'         
657700                PERFORM 9100-SQL-ABEND                                    
657800         END-EVALUATE                                                     
657900     END-PERFORM.                                                         
658000                                                                          
658100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
658200         (SQLCODE NOT = ZERO AND                                          
658300          SQLCODE NOT = +100)                                             
658400         DISPLAY '****************************************'               
658500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
658600         DISPLAY '** UPDATE FROM TIMCSEN                  '               
658700         DISPLAY '** PROGRAM = TRKUP245                   '               
658800         DISPLAY '** PARA = 7310-UPDATE-TIMCNPO           '               
658900         DISPLAY '** UPDATE TIMCSEN                       '               
659000         DISPLAY '** CNTR ID      = ' IMCNPO-CONTNR-ID                    
659100         DISPLAY '** CNTR SEQ NBR = ' IMCNPO-CONTNR-SEQ-NBR               
659200         DISPLAY '** PO NBR       = ' IMCNPO-PO-NBR                       
659300         DISPLAY '****************************************'               
659400         PERFORM 9100-SQL-ABEND                                           
659500     END-IF.                                                              
659600                                                                          
659700******************************************************************        
659800*  UPDATE TIMCSCN                                                         
659900******************************************************************        
660000 7350-UPDATE-TIMCSCN.                                                     
660100                                                                          
660200     MOVE PC-CURRENT-PROGRAM-NAME TO IMCSCN-LAST-UPD-BY-USR-ID.           
660300     MOVE PV-CURRENT-TMST         TO IMCSCN-LAST-UPD-TMST.                
660400                                                                          
660500     PERFORM                                                              
660600         WITH TEST AFTER                                                  
660700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
660800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
660900                 SQLCODE = ZERO                     OR                    
661000                 SQLCODE = +100                                           
661100         EXEC SQL                                                         
661200             UPDATE TIMCSCN                                               
661300             SET DO_TO_DCONSLR_TMST = :IMCSCN-DO-TO-DCONSLR-TMST          
661400                ,LAST_UPD_BY_USR_ID = :IMCSCN-LAST-UPD-BY-USR-ID          
661500                ,LAST_UPD_TMST      = :IMCSCN-LAST-UPD-TMST               
661600             WHERE CSTM_ENTR_ID     = :IMCSCN-CSTM-ENTR-ID                
661700               AND CONTNR_ID        = :IMCSCN-CONTNR-ID                   
661800         END-EXEC                                                         
661900                                                                          
662000         EVALUATE TRUE                                                    
662100             WHEN SQLCODE = ZERO                                          
662200             WHEN SQLCODE = -904                                          
662300             WHEN SQLCODE = -913                                          
662400                 CONTINUE                                                 
662500             WHEN SQLWARN0 NOT EQUAL SPACE                                
662600             WHEN SQLCODE NOT EQUAL ZERO                                  
662700                 DISPLAY '***************************************'        
662800                 DISPLAY '** ABEND                               '        
662900                 DISPLAY '** PROGRAM = TRKUP245                  '        
663000                 DISPLAY '** PARA = 7350-UPDATE-TIMCSCN          '        
663100                 DISPLAY '** UPDATE TIMCSCN                      '        
663200                 DISPLAY '** ENTRY ID  = ' IMCSCN-CSTM-ENTR-ID            
663300                 DISPLAY '** CONTAINER = ' IMCSCN-CONTNR-ID               
663400                 DISPLAY '***************************************'        
663500                 PERFORM 9100-SQL-ABEND                                   
663600         END-EVALUATE                                                     
663700     END-PERFORM.                                                         
663800                                                                          
663900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
664000         (SQLCODE NOT = ZERO AND                                          
664100          SQLCODE NOT = +100)                                             
664200         DISPLAY '****************************************'               
664300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '               
664400         DISPLAY '** UPDATE FROM TIMCSCN                  '               
664500         DISPLAY '** PROGRAM = TRKUP245                   '               
664600         DISPLAY '** PARA = 7350-UPDATE-TIMCSCN           '               
664700         DISPLAY '** UPDATE TIMCSCN                       '               
664800         DISPLAY '** ENTRY ID  = ' IMCSCN-CSTM-ENTR-ID                    
664900         DISPLAY '** CONTAINER = ' IMCSCN-CONTNR-ID                       
665000         DISPLAY '****************************************'               
665100         PERFORM 9100-SQL-ABEND                                           
665200     END-IF.                                                              
665300******************************************************************        
665400 7400-OPEN-MLTPL-ENTRY-WRN-CSR.                                           
665500                                                                          
665600     EXEC SQL                                                             
665700          OPEN MLTPL_WRN_CSR                                              
665800     END-EXEC.                                                            
665900                                                                          
666000     EVALUATE TRUE                                                        
666100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
666200         WHEN SQLCODE  NOT EQUAL ZERO                                     
666300          DISPLAY '** *******************************************'        
666400          DISPLAY '** ABEND                                    **'        
666500          DISPLAY '** PROGRAM = TRKUP245                       **'        
666600          DISPLAY '** PARAGRAPH = 7400-OPEN-MLTPL-ENTRY-WRN-CSR**'        
666700          DISPLAY '** *******************************************'        
666800          PERFORM 9100-SQL-ABEND                                          
666900     END-EVALUATE.                                                        
667000                                                                          
667100******************************************************************        
667200 7410-FETCH-MLTPL-ENTRY-WRN-CSR.                                          
667300                                                                          
667400     EXEC SQL                                                             
667500          FETCH MLTPL_WRN_CSR                                             
667600              INTO    :IMCSPO-CSTM-ENTR-ID                                
667700                     ,:IMCSCN-CONTNR-ID                                   
667800                     ,:IMCNPO-PO-NBR                                      
667900     END-EXEC.                                                            
668000                                                                          
668100     EVALUATE TRUE                                                        
668200         WHEN SQLCODE = ZERO                                              
668300             CONTINUE                                                     
668400         WHEN SQLCODE = +100                                              
668500             SET PS-EOC-MLTPL-ENTRY        TO TRUE                        
668600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
668700         WHEN SQLCODE  NOT EQUAL ZERO                                     
668800         DISPLAY '** ********************************************'        
668900         DISPLAY '** ABEND                                     **'        
669000         DISPLAY '** PROGRAM = TRKUP245                        **'        
669100         DISPLAY '** PARAGRAPH = 7410-FETCH-MLTPL-ENTRY-WRN-CSR**'        
669200         DISPLAY '** ********************************************'        
669300         PERFORM 9100-SQL-ABEND                                           
669400     END-EVALUATE.                                                        
669500                                                                          
669600******************************************************************        
669700 7420-CLOSE-MLTPL-ENTRY-WRN-CSR.                                          
669800                                                                          
669900     EXEC SQL                                                             
670000         CLOSE MLTPL_WRN_CSR                                              
670100     END-EXEC.                                                            
670200                                                                          
670300     EVALUATE TRUE                                                        
670400         WHEN SQLWARN0 NOT EQUAL SPACE                                    
670500         WHEN SQLCODE  NOT EQUAL ZERO                                     
670600           DISPLAY '** ******************************************'        
670700           DISPLAY '** ABEND                                   **'        
670800           DISPLAY '** PROGRAM = TRKUP245                      **'        
670900           DISPLAY '** PARAGRAPH = 7232-CLOSE-TIMCNPO-D-PO-CURSOR'        
671000           DISPLAY '** ******************************************'        
671100           PERFORM 9100-SQL-ABEND                                         
671200     END-EVALUATE.                                                        
671300                                                                          
671400******************************************************************        
671500*   OPEN  PO-CSR CURSOR                                          *        
671600******************************************************************        
671700                                                                          
671800 7450-OPEN-PO-CSR.                                                        
671900                                                                          
672000     EXEC SQL                                                             
672100         OPEN PO_CSR                                                      
672200     END-EXEC                                                             
672300                                                                          
672400     EVALUATE TRUE                                                        
672500         WHEN SQLCODE = ZERO                                              
672600             CONTINUE                                                     
672700         WHEN SQLWARN0 NOT EQUAL SPACE                                    
672800         WHEN SQLCODE NOT EQUAL ZERO                                      
672900             DISPLAY '**************************************'             
673000             DISPLAY '** ABEND                            **'             
673100             DISPLAY '** PROGRAM = TRKUP245               **'             
673200             DISPLAY '** PARAGRAPH = 7450-OPEN-PO-CSR     **'             
673300             DISPLAY '**************************************'             
673400             PERFORM 9100-SQL-ABEND                                       
673500                                                                          
673600     END-EVALUATE.                                                        
673700                                                                          
673800******************************************************************        
673900* FETCH PO-CSR.                                                  *        
674000******************************************************************        
674100 7455-FETCH-PO-CSR.                                                       
674200                                                                          
674300         EXEC SQL                                                         
674400             FETCH PO_CSR                                                 
674500               INTO :PV-PO-NBR                                            
674600         END-EXEC                                                         
674700                                                                          
674800         EVALUATE TRUE                                                    
674900             WHEN SQLCODE = +0                                            
675000                 MOVE PV-PO-NBR  TO IMCNPO-PO-NBR                         
675100                 SET PS-PO-FOUND TO TRUE                                  
675200             WHEN SQLCODE = +100                                          
675300                 CONTINUE                                                 
675400             WHEN SQLWARN0 NOT EQUAL SPACE                                
675500             WHEN SQLCODE NOT EQUAL ZERO                                  
675600                 DISPLAY '**************************************'         
675700                 DISPLAY '** ABEND                            **'         
675800                 DISPLAY '** PROGRAM = TRKUP245               **'         
675900                 DISPLAY '** PARAGRAPH = 7455-FETCH-PO-CSR    **'         
676000                 DISPLAY '**************************************'         
676100                 PERFORM 9100-SQL-ABEND                                   
676200         END-EVALUATE.                                                    
676300******************************************************************        
676400*   CLOSE PO-CSR                                                 *        
676500******************************************************************        
676600                                                                          
676700 7460-CLOSE-PO-CSR.                                                       
676800                                                                          
676900     EXEC SQL                                                             
677000        CLOSE PO_CSR                                                      
677100     END-EXEC                                                             
677200                                                                          
677300     EVALUATE TRUE                                                        
677400         WHEN SQLCODE = ZERO                                              
677500             CONTINUE                                                     
677600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
677700         WHEN SQLCODE NOT EQUAL ZERO                                      
677800             DISPLAY '**************************************'             
677900             DISPLAY '** ABEND                            **'             
678000             DISPLAY '** PROGRAM = TRKUP245               **'             
678100             DISPLAY '** PARAGRAPH = 7460-CLOSE-PO-CSR    **'             
678200             DISPLAY '**************************************'             
678300             PERFORM 9100-SQL-ABEND                                       
678400                                                                          
678500     END-EVALUATE.                                                        
678600                                                                          
678700******************************************************************        
678800*   OPEN  FOB AND SCAC CURSOR                                    *        
678900******************************************************************        
679000                                                                          
679100 7500-OPEN-FOB-SCAC.                                                      
679200                                                                          
679300     EXEC SQL                                                             
679400         OPEN FOB_SCAC_CSR                                                
679500     END-EXEC                                                             
679600                                                                          
679700     EVALUATE TRUE                                                        
679800         WHEN SQLCODE = ZERO                                              
679900             CONTINUE                                                     
680000         WHEN SQLWARN0 NOT EQUAL SPACE                                    
680100         WHEN SQLCODE NOT EQUAL ZERO                                      
680200             DISPLAY '**************************************'             
680300             DISPLAY '** ABEND                            **'             
680400             DISPLAY '** PROGRAM = TRKUP245               **'             
680500             DISPLAY '** PARAGRAPH = 7500-OPEN-FOB-SCAC   **'             
680600             DISPLAY '**************************************'             
680700             PERFORM 9100-SQL-ABEND                                       
680800                                                                          
680900     END-EVALUATE.                                                        
681000                                                                          
681100******************************************************************        
681200* FETCH FOB-SCAC.                                                *        
681300******************************************************************        
681400 7505-FETCH-FOB-SCAC.                                                     
681500                                                                          
681600         EXEC SQL                                                         
681700             FETCH FOB_SCAC_CSR                                           
681800               INTO :PV-FOB-CDE                                           
681900                   ,:PV-SCAC-CDE                                          
682000         END-EXEC                                                         
682100                                                                          
682200         EVALUATE TRUE                                                    
682300             WHEN SQLCODE = +0                                            
682400                 PERFORM 6138-ERROR-38                                    
682500                 PERFORM 7100-INSERT-TOUTTRA-RPT                          
682600             WHEN SQLCODE = +100                                          
682700                 MOVE SPACES TO PV-FOB-CDE                                
682800                                PV-SCAC-CDE                               
682900             WHEN SQLWARN0 NOT EQUAL SPACE                                
683000             WHEN SQLCODE NOT EQUAL ZERO                                  
683100                 DISPLAY '**************************************'         
683200                 DISPLAY '** ABEND                            **'         
683300                 DISPLAY '** PROGRAM = TRKUP245               **'         
683400                 DISPLAY '** PARAGRAPH = 7505-FETCH-FOB-SCAC  **'         
683500                 DISPLAY '**************************************'         
683600                 PERFORM 9100-SQL-ABEND                                   
683700         END-EVALUATE.                                                    
683800                                                                          
683900******************************************************************        
684000*   CLOSE FOB-SCAC                                               *        
684100******************************************************************        
684200                                                                          
684300 7510-CLOSE-FOB-SCAC.                                                     
684400                                                                          
684500     EXEC SQL                                                             
684600        CLOSE FOB_SCAC_CSR                                                
684700     END-EXEC                                                             
684800                                                                          
684900     EVALUATE TRUE                                                        
685000         WHEN SQLCODE = ZERO                                              
685100             CONTINUE                                                     
685200         WHEN SQLWARN0 NOT EQUAL SPACE                                    
685300         WHEN SQLCODE NOT EQUAL ZERO                                      
685400             DISPLAY '**************************************'             
685500             DISPLAY '** ABEND                            **'             
685600             DISPLAY '** PROGRAM = TRKUP245               **'             
685700             DISPLAY '** PARAGRAPH = 7510-CLOSE-FOB-SCAC  **'             
685800             DISPLAY '**************************************'             
685900             PERFORM 9100-SQL-ABEND                                       
686000                                                                          
686100     END-EVALUATE.                                                        
686200******************************************************************        
686300* GET ALL CONTAINERS FOR THE ENTRY. GET THE ORGN_SHPD_FR_CDE FOR          
686400* EACH CONTAINER.  THEN INSERT A SCM MESSAGE FOR EACH.                    
686500******************************************************************        
686600 7520-SCM-PROCESS-ENFPO-ADD.                                              
686700*                                                                         
686800*  IF THIS IS AN AIR SHIPMENT, CREATE SCM MESSAGE WITH                    
686900*  LIMITED INFORMATION                                                    
687000*                                                                         
687100     IF IMCSEN-MOM-TRIP-TYP-CDE = 'A'                                     
687200        PERFORM 7604-SCM-NO-REL-CSTM-FILED-MSG                            
687300     ELSE                                                                 
687400        PERFORM 7522-SCM-OPEN-CSTM-CNTNR-CSR                              
687500                                                                          
687600        SET PS-SCM-END-OF-CSCN-NO            TO TRUE                      
687700        PERFORM 7524-SCM-FETCH-CSTM-CNTNR-CSR                             
687800            UNTIL PS-SCM-END-OF-CSCN                                      
687900                                                                          
688000        PERFORM 7529-SCM-CLOS-CSTM-CNTNR-CSR                              
688100     END-IF.                                                              
688200                                                                          
688300******************************************************************        
688400* OPEN THE CSTM-CNTNR-CSR                                        *        
688500******************************************************************        
688600 7522-SCM-OPEN-CSTM-CNTNR-CSR.                                            
688700                                                                          
688800     EXEC SQL                                                             
688900          OPEN CSTM_CONTNR_CSR                                            
689000     END-EXEC.                                                            
689100                                                                          
689200     EVALUATE TRUE                                                        
689300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
689400         WHEN SQLCODE  NOT EQUAL ZERO                                     
689500             DISPLAY '** ***************************************'         
689600             DISPLAY '** ABEND                                **'         
689700             DISPLAY '** PROGRAM = TRKUP245                   **'         
689800             DISPLAY '** PARA = 7522-SCM-OPEN-CSTM-CNTNR-CSR  **' **'     
689900             DISPLAY '** ***************************************'         
690000             PERFORM 9100-SQL-ABEND                                       
690100     END-EVALUATE.                                                        
690200                                                                          
690300******************************************************************        
690400* FETCH ROWS FROM THE CSTM_CONTNR_CSR TO GET CONTAINERS                   
690500* FROM THE TIMCSCN TABLE.  WHEN A CONTAINER IS FOUND,                     
690600* CALL A ROUTINE TO GET THE ORIGIN SHIPPED FROM CODE                      
690700* AN EXTRA PERFORM OF PARA 7626 IS DONE TO ACCOUNT FOR                    
690800* THE CONTAINER IN THE IMCSCN HOLD AREA AND NOT YET IN THE                
690900* TIMCSCN TABLE                                                           
691000******************************************************************        
691100 7524-SCM-FETCH-CSTM-CNTNR-CSR.                                           
691200                                                                          
691300     EXEC SQL                                                             
691400        FETCH CSTM_CONTNR_CSR                                             
691500         INTO :W-LOOK-UP-CONTNR-ID                                        
691600     END-EXEC                                                             
691700                                                                          
691800     EVALUATE TRUE                                                        
691900         WHEN SQLCODE = ZERO                                              
692000             PERFORM 7526-SCM-GET-ORGN-SHPD                               
692100         WHEN SQLCODE = +100                                              
692200             SET PS-SCM-END-OF-CSCN    TO TRUE                            
692210             IF IMCSCN-CSTM-ENTR-ID =  TR027-ENFPO-CSTM-ENTR-ID           
692300                 MOVE IMCSCN-CONTNR-ID TO W-LOOK-UP-CONTNR-ID             
692400                 PERFORM 7526-SCM-GET-ORGN-SHPD                           
692410             END-IF                                                       
692500         WHEN SQLWARN0 NOT EQUAL SPACE                                    
692600         WHEN SQLCODE  NOT EQUAL ZERO                                     
692700             DISPLAY '** ****************************************'        
692800             DISPLAY '** ABEND                                 **'        
692900             DISPLAY '** PROGRAM = TRKUP245                    **'        
693000             DISPLAY '** PARA = 7524-SCM-FETCH-CSTM-CNTNR-CSR  **'.**'    
693100             DISPLAY '** ****************************************'        
693200             PERFORM 9100-SQL-ABEND                                       
693300     END-EVALUATE.                                                        
693400                                                                          
693500 EJECT                                                                    
693600                                                                          
693700******************************************************************        
693800* SELECT THE ORGN_SHPD_FR_CDE (CFS/CY) FROM THE CNTK             *        
693900******************************************************************        
694000 7526-SCM-GET-ORGN-SHPD.                                                  
694100     MOVE TR027-ENFPO-PO-NBR      TO W-TR027-ENFPO-PO-NBR                 
694200     MOVE W-TR027-ENFPO-PO-NBR-9  TO W-TR027-ENFPO-PO-NBR-COMP            
694300     EXEC SQL                                                             
694400         SELECT  X.ORGN_SHPD_FR_CDE                                       
694500                ,A.CONTNR_SEQ_NBR                                         
694600           INTO :W-IMCNTK-ORGN-SHPD-FR-CDE                                
694700               ,:W-IMCNPO-CONTNR-SEQ-NBR                                  
694800           FROM TIMCNPO A                                                 
694900               ,TIMCNTK X                                                 
695000          WHERE                                                           
695100                A.PO_NBR          = :W-TR027-ENFPO-PO-NBR-COMP            
695200            AND A.EXTL_REF_NBR    = :TR027-ENFPO-EXTL-REF-NBR             
695300            AND A.CONTNR_ID       = X.CONTNR_ID                           
695400            AND A.CONTNR_ID       = :W-LOOK-UP-CONTNR-ID                  
695500            AND A.CONTNR_SEQ_NBR  = X.CONTNR_SEQ_NBR                      
695600     END-EXEC.                                                            
695700                                                                          
695800     EVALUATE TRUE                                                        
695900         WHEN SQLCODE = ZERO                                              
696000            PERFORM 7600-ADD-SCM-CUSTOMS-FILED-MSG                        
696100         WHEN SQLCODE = +100                                              
696200**************  LOOK ON TIMRCPO FOR THE ORGN-SHPD-FR-CDE                  
696210            PERFORM 7527-SCM-GET-ORGN-SHPD-RCPO                           
696300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
696400         WHEN SQLCODE NOT EQUAL ZERO                                      
696500            DISPLAY '**************************************'              
696600            DISPLAY '** ABEND                              '              
696700            DISPLAY '** PROGRAM = TRKUP245                 '              
696800            DISPLAY '** PARA = 7526-SCM-GET-ORGN-SHPD      '        '     
696900            DISPLAY '** SELECT TIMCSCN FOR ORGN_SHPD_FR_CDE'              
697000            DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID                  
697100            DISPLAY '** CONTNR ID= ' IMCSCN-CONTNR-ID                     
697200            DISPLAY '**************************************'              
697300            PERFORM 9100-SQL-ABEND                                        
697400     END-EVALUATE.                                                        
697500                                                                          
697501******************************************************************        
697502* THE ORGN_SHPD_FR_CDE (CFS/CY) WAS NOT FOUND ON TIMCNTK         *        
697503* TRY FINDING THE ORGN_SHPD_FR_CDE (CFS/CY) ON TIMRCPO           *        
697504******************************************************************        
697505 7527-SCM-GET-ORGN-SHPD-RCPO.                                             
697506     MOVE TR027-ENFPO-PO-NBR      TO W-TR027-ENFPO-PO-NBR                 
697507     MOVE W-TR027-ENFPO-PO-NBR-9  TO W-TR027-ENFPO-PO-NBR-COMP            
697508     MOVE SPACES                  TO W-IMCNTK-ORGN-SHPD-FR-CDE            
697509     EXEC SQL                                                             
697510         SELECT  X.ORGN_SHPD_FR_CDE                                       
697511           INTO :W-IMCNTK-ORGN-SHPD-FR-CDE                                
697513           FROM TIMRCPO X                                                 
697514          WHERE                                                           
697515                X.PO_NBR          = :W-TR027-ENFPO-PO-NBR-COMP            
697516            AND X.EXTL_REF_NBR    = :TR027-ENFPO-EXTL-REF-NBR             
697519     END-EXEC.                                                            
697520                                                                          
697521     EVALUATE TRUE                                                        
697522         WHEN SQLCODE = ZERO                                              
697525            MOVE SPACES TO W-LOOK-UP-CONTNR-ID                            
697526            MOVE ZEROS  TO W-IMCNPO-CONTNR-SEQ-NBR                        
697527            PERFORM 7600-ADD-SCM-CUSTOMS-FILED-MSG                        
697528         WHEN SQLCODE = +100                                              
697529*** START ****  EMERGENCY FIX 04/01/06 MIKE FRIESS                        
697530         WHEN SQLCODE = -811                                              
697531***  END  ****  EMERGENCY FIX 04/01/06 MIKE FRIESS                        
697532**************  LOOK ON TIMBKPO FOR THE ORGN-SHPD-FR-CDE                  
697533            PERFORM 7528-SCM-GET-ORGN-SHPD-BKPO                           
697534         WHEN SQLWARN0 NOT EQUAL SPACE                                    
697535         WHEN SQLCODE NOT EQUAL ZERO                                      
697536            DISPLAY '**************************************'              
697537            DISPLAY '** ABEND                              '              
697538            DISPLAY '** PROGRAM = TRKUP245                 '              
697539            DISPLAY '** PARA = 7527-SCM-GET-ORGN-SHPD-RCPO '        '     
697540            DISPLAY '** SELECT TIMRCPO FOR ORGN_SHPD_FR_CDE'              
697541            DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID                  
697542            DISPLAY '** PO-NBR   = ' TR027-ENFPO-PO-NBR                   
697543            DISPLAY '** EXT REF# = ' TR027-ENFPO-EXTL-REF-NBR             
697544            DISPLAY '**************************************'              
697545            PERFORM 9100-SQL-ABEND                                        
697546     END-EVALUATE.                                                        
697547                                                                          
697548******************************************************************        
697549* THE ORGN_SHPD_FR_CDE (CFS/CY) WAS NOT FOUND ON TIMCNTK OR      *        
697550* TIMRCPO TRY FINDING THE ORGN_SHPD_FR_CDE (CFS/CY) ON TIMBKPO   *        
697551******************************************************************        
697552 7528-SCM-GET-ORGN-SHPD-BKPO.                                             
697553     MOVE TR027-ENFPO-PO-NBR      TO W-TR027-ENFPO-PO-NBR                 
697554     MOVE W-TR027-ENFPO-PO-NBR-9  TO W-TR027-ENFPO-PO-NBR-COMP            
697555     MOVE SPACES                  TO W-IMCNTK-ORGN-SHPD-FR-CDE            
697556     EXEC SQL                                                             
697557         SELECT  X.ORGN_SHPD_FR_CDE                                       
697558           INTO :W-IMCNTK-ORGN-SHPD-FR-CDE                                
697560           FROM TIMBKPO X                                                 
697561          WHERE                                                           
697562                X.PO_NBR          = :W-TR027-ENFPO-PO-NBR-COMP            
697563            AND X.EXTL_REF_NBR    = :TR027-ENFPO-EXTL-REF-NBR             
697566     END-EXEC.                                                            
697567                                                                          
697568     EVALUATE TRUE                                                        
697569         WHEN SQLCODE = ZERO                                              
697570            MOVE SPACES TO W-LOOK-UP-CONTNR-ID                            
697571            MOVE ZEROS  TO W-IMCNPO-CONTNR-SEQ-NBR                        
697572            PERFORM 7600-ADD-SCM-CUSTOMS-FILED-MSG                        
697573         WHEN SQLCODE = +100                                              
697574*** START ****  EMERGENCY FIX 04/01/06 MIKE FRIESS                        
697575         WHEN SQLCODE = -811                                              
697576***  END  ****  EMERGENCY FIX 04/01/06 MIKE FRIESS                        
697577            PERFORM 7604-SCM-NO-REL-CSTM-FILED-MSG                        
697578         WHEN SQLWARN0 NOT EQUAL SPACE                                    
697579         WHEN SQLCODE NOT EQUAL ZERO                                      
697580            DISPLAY '**************************************'              
697581            DISPLAY '** ABEND                              '              
697582            DISPLAY '** PROGRAM = TRKUP245                 '              
697583            DISPLAY '** PARA = 7528-SCM-GET-ORGN-SHPD-BKPO '        '     
697584            DISPLAY '** SELECT TIMBKPO FOR ORGN_SHPD_FR_CDE'              
697585            DISPLAY '** ENTRY ID = ' IMCSCN-CSTM-ENTR-ID                  
697586            DISPLAY '** PO-NBR   = ' TR027-ENFPO-PO-NBR                   
697587            DISPLAY '** EXT REF# = ' TR027-ENFPO-EXTL-REF-NBR             
697588            DISPLAY '**************************************'              
697589            PERFORM 9100-SQL-ABEND                                        
697590     END-EVALUATE.                                                        
697591                                                                          
697600                                                                          
697700******************************************************************        
697800* CLOSE THE GET-CONTNR_CSR.                                      *        
697900******************************************************************        
698000 7529-SCM-CLOS-CSTM-CNTNR-CSR.                                            
698100                                                                          
698200     EXEC SQL                                                             
698300         CLOSE CSTM_CONTNR_CSR                                            
698400     END-EXEC.                                                            
698500                                                                          
698600     EVALUATE TRUE                                                        
698700         WHEN SQLWARN0 NOT EQUAL SPACE                                    
698800         WHEN SQLCODE  NOT EQUAL ZERO                                     
698900             DISPLAY '** ***************************************'         
699000             DISPLAY '** ABEND                                **'         
699100             DISPLAY '** PROGRAM = TRKUP245                   **'         
699200             DISPLAY '** PARA = 7529-SCM-CLOS-CSTM-CNTNR-CSR  **' ' .**'*'
699300             DISPLAY '** ***************************************'         
699400             PERFORM 9100-SQL-ABEND                                       
699500     END-EVALUATE.                                                        
699600                                                                          
699700                                                                          
699800******************************************************************08560024
699900*    FORMAT MQ MESSAGE FOR ENFPO                                 *08570018
700000******************************************************************08580018
700100 7600-ADD-SCM-CUSTOMS-FILED-MSG.                                  08590018
700200     INITIALIZE TR405-MESSAGE-LAYOUT                                      
700300     MOVE 'A'                         TO TR405-ACTN-CDE                   
700400     MOVE 'CUSTOMS FILED'             TO TR405-EVENT-TYP                  
700500     MOVE TR027-ENFPO-PO-NBR          TO TR405-PO-NBR                     
700600     MOVE TR027-ENFPO-EXTL-REF-NBR    TO TR405-EXTL-REF-NBR               
700700     MOVE W-IMCNTK-ORGN-SHPD-FR-CDE   TO TR405-ORGN-SHPD-FR-CDE           
700800     MOVE W-LOOK-UP-CONTNR-ID         TO TR405-CONTNR-ID                  
700900     MOVE W-IMCNPO-CONTNR-SEQ-NBR     TO TR405-CONTNR-SEQ-NBR             
701000     MOVE TR027-ENFPO-CSTM-ENTR-ID    TO TR405-CSTM-ENTR-ID               
701100     MOVE PV-HOLD-ENF-FILD-DTE        TO TR405-EVENT-DTE                  
701200     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
701300     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
701400 EJECT                                                                    
701500******************************************************************08560024
701600*    FORMAT MQ MESSAGE FOR ENFPO 'AIR' SHIPMENTS                 *08570018
701700*    OR SHIPMENTS FROM BRAZIL OR OTHERS WHO DIDN'T HAVE          *08570018
701800*    CONTAINER/POS IN TIMCNPO AND TIMCNTK  NO RELATIONSHIPS      *        
701900*    NO RELATIONSHIPS                                            *        
702000******************************************************************08580018
702100 7604-SCM-NO-REL-CSTM-FILED-MSG.                                          
702200     INITIALIZE TR405-MESSAGE-LAYOUT                                      
702300     MOVE 'A'                         TO TR405-ACTN-CDE                   
702400     MOVE 'CUSTOMS FILED'             TO TR405-EVENT-TYP                  
702500     MOVE TR027-ENFPO-PO-NBR          TO TR405-PO-NBR                     
702600     MOVE TR027-ENFPO-CSTM-ENTR-ID    TO TR405-CSTM-ENTR-ID               
702700     MOVE PV-HOLD-ENF-FILD-DTE        TO TR405-EVENT-DTE                  
702800     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
702900     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
703000                                                                          
703100******************************************************************08560024
703200*    FORMAT MQ MESSAGE FOR ENF - ACTUAL CUSTOMS CLEARANCE DATE   *08570018
703300******************************************************************08580018
703400 7605-SCM-CSTM-DELETED-MSG.                                       08590018
703500     INITIALIZE TR405-MESSAGE-LAYOUT                                      
703600     MOVE 'D'                           TO TR405-ACTN-CDE                 
703700     MOVE 'CUSTOMS DELETED'             TO TR405-EVENT-TYP                
703800     MOVE TR027-ENF-CSTM-ENTR-ID        TO TR405-CSTM-ENTR-ID             
703900     MOVE TR405-MESSAGE-LAYOUT       TO TRT00040-CKPR-REC-1-TXT           
704000     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
704100 EJECT                                                                    
704200******************************************************************08560024
704300*    FORMAT MQ MESSAGE FOR ENFPO                                 *08570018
704400******************************************************************08580018
704500 7610-DEL-SCM-CUSTOMS-FILED-MSG.                                  08590018
704600     INITIALIZE TR405-MESSAGE-LAYOUT                                      
704700     MOVE 'D'                           TO TR405-ACTN-CDE                 
704800     MOVE 'CUSTOMS RELATIONSHIP DEL'    TO TR405-EVENT-TYP                
704900     MOVE TR027-ENFPO-CSTM-ENTR-ID      TO TR405-CSTM-ENTR-ID             
705000     MOVE TR027-ENFPO-PO-NBR            TO TR405-PO-NBR                   
705100     MOVE TR027-ENFPO-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
705200     PERFORM 7611-SCM-GET-ORGN-SHPD                                       
705300     MOVE W-IMCNTK-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
705400     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
705500     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
705600 EJECT                                                                    
705700******************************************************************        
705800* SELECT THE ORGN_SHPD_FR_CDE (CFS/CY) FROM THE CNTK             *        
705900******************************************************************        
706000 7611-SCM-GET-ORGN-SHPD.                                                  
706100     MOVE TR027-ENFPO-PO-NBR      TO W-TR027-ENFPO-PO-NBR                 
706200     MOVE W-TR027-ENFPO-PO-NBR-9  TO W-TR027-ENFPO-PO-NBR-COMP            
706300     EXEC SQL                                                             
706400         SELECT  X.ORGN_SHPD_FR_CDE                                       
706500                                                                          
706600           INTO :W-IMCNTK-ORGN-SHPD-FR-CDE                                
706700                                                                          
706800           FROM TIMCNPO A                                                 
706900               ,TIMCNTK X                                                 
707000          WHERE                                                           
707100                A.PO_NBR          = :W-TR027-ENFPO-PO-NBR-COMP            
707200            AND A.EXTL_REF_NBR    = :TR027-ENFPO-EXTL-REF-NBR             
707300            AND A.CONTNR_ID       = X.CONTNR_ID                           
707400            AND A.CONTNR_SEQ_NBR  = X.CONTNR_SEQ_NBR                      
707500     END-EXEC.                                                            
707600                                                                          
707700     EVALUATE TRUE                                                        
707800         WHEN SQLCODE = ZERO                                              
707900            CONTINUE                                                      
708000         WHEN SQLCODE = +100                                              
708100            CONTINUE                                                      
708200         WHEN SQLWARN0 NOT EQUAL SPACE                                    
708300         WHEN SQLCODE NOT EQUAL ZERO                                      
708400            DISPLAY '**************************************'              
708500            DISPLAY '** ABEND                              '              
708600            DISPLAY '** PROGRAM = TRKUP245                 '              
708700            DISPLAY '** PARA = 7611-SCM-GET-ORGN-SHPD      '        '     
708800            DISPLAY '**************************************'              
708900            PERFORM 9100-SQL-ABEND                                        
709000     END-EVALUATE.                                                        
709100                                                                          
709200 EJECT                                                                    
709300******************************************************************08560024
709400*    FORMAT MQ MESSAGE FOR RLS - ACTUAL CUSTOMS CLEARANCE DATE   *08570018
709500******************************************************************08580018
709600 7625-CHG-SCM-CSTM-CLEARED-MSG.                                   08590018
709700     INITIALIZE TR405-MESSAGE-LAYOUT                                      
709800     MOVE 'C'                           TO TR405-ACTN-CDE                 
709900     MOVE 'CUSTOMS CLEARED'             TO TR405-EVENT-TYP                
710000     MOVE TR027-RLS-CSTM-ENTR-ID        TO TR405-CSTM-ENTR-ID             
710100     MOVE TR027-RLS-ACTL-CLR-DTE        TO TR405-EVENT-DTE                
710200     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
710300     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
710400 EJECT                                                                    
710500******************************************************************08560024
710600*    FORMAT MQ MESSAGE FOR RLS(DEL) ACTUAL CUSTOMS CLEARANCE DATE*08570018
710700******************************************************************08580018
710800 7630-DEL-SCM-CSTM-CLEARED-MSG.                                   08590018
710900     INITIALIZE TR405-MESSAGE-LAYOUT                                      
711000     MOVE 'D'                           TO TR405-ACTN-CDE                 
711100     MOVE 'CUSTOMS CLEARED'             TO TR405-EVENT-TYP                
711200     MOVE TR027-RLS-CSTM-ENTR-ID        TO TR405-CSTM-ENTR-ID             
711300     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
711400     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
711500                                                                          
711600                                                                          
711700 EJECT                                                                    
711800******************************************************************08560024
711900*    FORMAT MQ MESSAGE FOR ENFPO SHIPMENTS FROM BRAZIL OR OTHERS *08570018
712000*    WHO DIDN'T SEND OTHER NOTIFICATIONS                         *08570018
712100******************************************************************08580018
712200 7640-SCM-OTHER-CSTM-FILED-MSG.                                           
712300     INITIALIZE TR405-MESSAGE-LAYOUT                                      
712400     MOVE 'A'                         TO TR405-ACTN-CDE                   
712500     MOVE 'CUSTOMS FILED'             TO TR405-EVENT-TYP                  
712600     MOVE TR027-ENFPO-PO-NBR          TO TR405-PO-NBR                     
712700     MOVE TR027-ENFPO-CSTM-ENTR-ID    TO TR405-CSTM-ENTR-ID               
712800     MOVE PV-HOLD-ENF-FILD-DTE        TO TR405-EVENT-DTE                  
712900     MOVE IMCSCN-CONTNR-ID            TO TR405-CONTNR-ID                  
713000     MOVE IMCNPO-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR             
713100     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
713200     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
713300                                                                          
713400 EJECT                                                                    
713500******************************************************************08560024
713600******************************************************************08560024
713700*    FORMAT MQ MESSAGE FOR DOP - DELIVERY ORDER PREPARED         *08570018
713800******************************************************************08580018
713900*7680-ADD-SCM-DOP-MSG.                                            08590018
714000*    IF TR027-DOP-TRN-TYP-ADD                                             
714100*      IF TR027-DOP-REC-TYP-CDE-DOP                                       
714200*        INITIALIZE TR405-MESSAGE-LAYOUT                                  
714300*        MOVE 'A'                         TO TR405-ACTN-CDE               
714400*        MOVE 'CONTNR DELY ORDER CREATED' TO TR405-EVENT-TYP              
714500*        MOVE TR027-DOP-CSTM-ENTR-ID      TO TR405-CSTM-ENTR-ID           
714600*        MOVE TR027-DOP-DELY-ORD-SNT-DTE  TO TR405-EVENT-DTE              
714700*        MOVE TR027-DOP-CONTNR-ID         TO TR405-CONTNR-ID              
714800*        MOVE TR027-DOP-SEQ-NBR           TO TR405-SEQ-NBR                
714900*        MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT             
715000*        PERFORM 7700-INSERT-SCM-MESSAGE                                  
715100*      END-IF                                                             
715200*    END-IF.                                                              
715300*EJECT                                                                    
715400******************************************************************08560024
715500*    FORMAT MQ MESSAGE FOR DOP - DELIVERY ORDER PREPARED         *08570018
715600******************************************************************08580018
715700*7685-CHG-SCM-DOP-MSG.                                            08590018
715800*    IF TR027-DOP-TRN-TYP-CHG                                             
715900*      IF TR027-DOP-REC-TYP-CDE-DOP                                       
716000*        INITIALIZE TR405-MESSAGE-LAYOUT                                  
716100*        MOVE 'C'                         TO TR405-ACTN-CDE               
716200*        MOVE 'CONTNR DELY ORDER CREATED' TO TR405-EVENT-TYP              
716300*        MOVE TR027-DOP-CSTM-ENTR-ID      TO TR405-CSTM-ENTR-ID           
716400*        MOVE TR027-DOP-DELY-ORD-SNT-DTE  TO TR405-EVENT-DTE              
716500*        MOVE TR027-DOP-CONTNR-ID         TO TR405-CONTNR-ID              
716600*        MOVE TR027-DOP-SEQ-NBR           TO TR405-SEQ-NBR                
716700*        MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT             
716800*        PERFORM 7700-INSERT-SCM-MESSAGE                                  
716900*      END-IF                                                             
717000*    END-IF.                                                              
717100*EJECT                                                                    
717200******************************************************************08560024
717300*    FORMAT MQ MESSAGE FOR DOP - DELIVERY ORDER PREPARED         *08570018
717400******************************************************************08580018
717500*7690-DEL-SCM-DOP-MSG.                                            08590018
717600*    IF TR027-DOP-TRN-TYP-DEL                                             
717700*      IF TR027-DOP-REC-TYP-CDE-DOP                                       
717800*        INITIALIZE TR405-MESSAGE-LAYOUT                                  
717900*        MOVE 'D'                         TO TR405-ACTN-CDE               
718000*        MOVE 'CONTNR DELY ORDER CREATED' TO TR405-EVENT-TYP              
718100*        MOVE TR027-DOP-CSTM-ENTR-ID      TO TR405-CSTM-ENTR-ID           
718200*        MOVE TR027-DOP-CONTNR-ID         TO TR405-CONTNR-ID              
718300*        MOVE TR027-DOP-SEQ-NBR           TO TR405-SEQ-NBR                
718400*        MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT             
718500*        PERFORM 7700-INSERT-SCM-MESSAGE                                  
718600*      END-IF                                                             
718700*    END-IF.                                                              
718800*EJECT                                                                    
718900*****************************************************************         
719000* INSERT ROW INTO TRTW_CSTM_CKPR, THE WORKTABLE FOR                       
719100* SCM MQ PO TRIGGER FILE.                                                 
719200*****************************************************************         
719300 7700-INSERT-SCM-MESSAGE.                                                 
719400                                                                          
719500     PERFORM                                                              
719600         WITH TEST AFTER                                                  
719700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
719800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
719900                 SQLCODE = ZERO                                           
720000         EXEC SQL                                                         
720100              INSERT INTO TRTW_CSTM_CKPR                                  
720200                         (CKPR_REC_1_TXT)                                 
720300                 VALUES  (:TRT00040-CKPR-REC-1-TXT)                       
720400         END-EXEC                                                         
720500         EVALUATE TRUE                                                    
720600             WHEN SQLCODE = ZERO                                          
720700                 CONTINUE                                                 
720800                                                                          
720900             WHEN SQLWARN0 NOT EQUAL SPACE                                
721000             WHEN SQLCODE NOT EQUAL ZERO                                  
721100                 DISPLAY '**************************************'         
721200                 DISPLAY '** ABEND                            **'         
721300                 DISPLAY '** PROGRAM = TRKUP245               **'         
721400                 DISPLAY '** PARAGRAPH = 7700-INSERT-SCM-     **'         
721500                 DISPLAY '**                  MESSAGE         **'         
721600                 DISPLAY '** INSERT TRTW_CSTM_CKPR            **'         
721700                 DISPLAY '** TR405-RECORD = '                             
721800                 DISPLAY '*'    TR405-ACTN-CDE                            
721900                 DISPLAY '*'    TR405-EVENT-TYP                           
722000                 DISPLAY '*'    TR405-PO-NBR                              
722100                 DISPLAY '*'    TR405-EXTL-REF-NBR                        
722200                 DISPLAY '**************************************'         
722300                 PERFORM 9100-SQL-ABEND                                   
722400         END-EVALUATE                                                     
722500     END-PERFORM.                                                         
722600                                                                          
722700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
722800         SQLCODE NOT = ZERO                                               
722900         DISPLAY '****************************************'               
723000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
723100         DISPLAY '** INSERT INTO TRTW_CSTM_CKPR         **'               
723200         DISPLAY '** PARAGRAPH = 7700-INSERT-SCM-MESSAGE**'               
723300         DISPLAY '** TR405-RECORD = '                                     
723400         DISPLAY '*'    TR405-ACTN-CDE                                    
723500         DISPLAY '*'    TR405-EVENT-TYP                                   
723600         DISPLAY '*'    TR405-PO-NBR                                      
723700         DISPLAY '*'    TR405-EXTL-REF-NBR                                
723800         DISPLAY '****************************************'               
723900         PERFORM 9100-SQL-ABEND                                           
724000     END-IF.                                                              
724100                                                                          
724200 EJECT                                                                    
724300                                                                          
724400******************************************************************08560024
724500*    FORMAT MQ MESSAGE FOR RLS - ACTUAL CUSTOMS CLEARANCE DATE   *08570018
724600*    RLS WITH NO PREVIOUS FILED WILL NOT CREATE PO SHIPMENT      *08570018
724700*    AND CONTAINER RELATIONSHIPS FOR OMC                         *08570018
724800******************************************************************08580018
724900 7705-ADD-SCM-CSTM-CLEARED-MSG.                                   08590018
725000                                                                  08590018
725400     SET PS-SCM-END-OF-CSPO-NO TO TRUE                                    
725500     SET PS-SCM-CSPO-FOUND-NO TO TRUE                                     
725600     PERFORM 7710-OPEN-PO2-CURSOR                                         
725700     PERFORM 7715-FETCH-PO2-CURSOR                                        
725800                  UNTIL PS-SCM-END-OF-CSPO                                
725900     PERFORM 7720-CLOSE-PO2-CURSOR.                                       
726900                                                                  08590018
727000 7710-OPEN-PO2-CURSOR.                                                    
727100                                                                          
727200     EXEC SQL                                                             
727300         OPEN PO2                                                         
727400     END-EXEC.                                                            
727500                                                                          
727600     EVALUATE TRUE                                                        
727700        WHEN SQLWARN0 NOT EQUAL SPACE                                     
727800        WHEN SQLCODE NOT EQUAL ZERO                                       
727900           DISPLAY '** ABEND                             '                
728000           DISPLAY '** PROGRAM = TRKUP245                '                
728100           DISPLAY '** PARAGRAPH = 7710-OPEN-PO2-CURSOR  '                
728200           PERFORM 9100-SQL-ABEND                                         
728300     END-EVALUATE.                                                        
728400                                                                          
728500 7715-FETCH-PO2-CURSOR.                                                   
728700                                                                          
728800     EXEC SQL                                                             
728900        FETCH PO2                                                         
729000         INTO :PV-CLR-PO-NBR-COMP,                                        
729100              :PV-CLR-EXTL-REF-NBR                                        
729200     END-EXEC                                                             
729300                                                                          
729700                                                                          
729800     EVALUATE TRUE                                                        
729900         WHEN SQLCODE = ZERO                                              
730000             SET PS-SCM-CSPO-FOUND TO TRUE                                
730100             PERFORM 7730-SCM-ADD-CLR-PO-ONLY-MSG                         
730200         WHEN SQLCODE = +100                                              
730300             PERFORM 7725-SCM-ADD-CLR-FROM-HOLD                           
730400             SET PS-SCM-END-OF-CSPO    TO TRUE                            
730500         WHEN SQLWARN0 NOT EQUAL SPACE                                    
730600         WHEN SQLCODE  NOT EQUAL ZERO                                     
730700             DISPLAY '** ****************************************'        
730800             DISPLAY '** ABEND                                 **'        
730900             DISPLAY '** PROGRAM = TRKUP245                    **'        
731000             DISPLAY '** PARA = 7715-FETCH-PO2-CURSOR          **'.**'    
731100             DISPLAY '** ****************************************'        
731200             PERFORM 9100-SQL-ABEND                                       
731300     END-EVALUATE.                                                        
731400                                                                          
731500                                                                          
731600 7720-CLOSE-PO2-CURSOR.                                                   
731700                                                                          
731800     EXEC SQL                                                             
731900         CLOSE PO2                                                        
732000     END-EXEC.                                                            
732100                                                                          
732200     EVALUATE TRUE                                                        
732300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
732400         WHEN SQLCODE  NOT EQUAL ZERO                                     
732500             DISPLAY '** ***************************************'         
732600             DISPLAY '** ABEND                                **'         
732700             DISPLAY '** PROGRAM = TRKUP245                   **'         
732800             DISPLAY '** PARA = 7720-CLOSE-PO2-CURSOR         **' ' .**'*'
732900             DISPLAY '** ***************************************'         
733000             PERFORM 9100-SQL-ABEND                                       
733100     END-EVALUATE.                                                        
733200                                                                          
733300 EJECT                                                                    
733400***********************************************************       08590018
733500***** LOGIC BELOW WILL CREATE SCM MESSAGE FOR PO IN THE           08590018
733600***** HOLD AREA AND NOT YET INSERTED TO DB2.                      08590018
733700***** IF THERE IS NO PO IN THE HOLD AREA AND NONE WERE FOUND      08590018
733800***** IN DB2 SEND A MESSAGE WITHOUT THE PO NUMBER. THIS WILL      08590018
733900***** ERROR OUT IN THE OMC.                                       08590018
734000***********************************************************       08590018
734100 7725-SCM-ADD-CLR-FROM-HOLD.                                              
734200                                                                          
734300     IF IMCSPO-CSTM-ENTR-ID = TR027-RLS-CSTM-ENTR-ID                      
734400         AND PS-INSERT-TIMCSPO                                            
734500             MOVE IMCSPO-PO-NBR TO PV-CLR-PO-NBR-COMP                     
734600             PERFORM 7730-SCM-ADD-CLR-PO-ONLY-MSG                         
734700     ELSE                                                                 
734800         IF PS-SCM-CSPO-FOUND-NO                                          
734810             PERFORM 7735-SCM-ADD-CLR-SHORT-MSG                           
734820         END-IF                                                           
734830     END-IF.                                                              
734850                                                                          
734900 7730-SCM-ADD-CLR-PO-ONLY-MSG.                                            
735000                                                                          
735100     INITIALIZE TR405-MESSAGE-LAYOUT                                      
735200     MOVE 'A'                       TO TR405-ACTN-CDE                     
735300     MOVE 'CUSTOMS CLEARED'         TO TR405-EVENT-TYP                    
735400     MOVE TR027-RLS-CSTM-ENTR-ID    TO TR405-CSTM-ENTR-ID                 
735500     MOVE TR027-RLS-ACTL-CLR-DTE    TO TR405-EVENT-DTE                    
735600     MOVE PV-CLR-PO-NBR-COMP        TO TR405-PO-NBR                       
735700     MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT                 
735800     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
735900                                                                          
736000                                                                          
736100***********************************************************               
736200*    MESSAGE BELOW WILL ERROR OUT IN OMC BECAUSE THERE IS *               
736300*    NO PO NUMBER, SENDS ONLY THE CUSTOMS ENTRY ID        *               
736400***********************************************************               
736500                                                                          
736600 7735-SCM-ADD-CLR-SHORT-MSG.                                              
736700                                                                          
736800     IF PS-SCM-CSPO-FOUND-NO                                              
736900         INITIALIZE TR405-MESSAGE-LAYOUT                                  
737000         MOVE 'A'                       TO TR405-ACTN-CDE                 
737100         MOVE 'CUSTOMS CLEARED'         TO TR405-EVENT-TYP                
737200         MOVE TR027-RLS-CSTM-ENTR-ID    TO TR405-CSTM-ENTR-ID             
737300         MOVE TR027-RLS-ACTL-CLR-DTE    TO TR405-EVENT-DTE                
737400         MOVE TR405-MESSAGE-LAYOUT TO TRT00040-CKPR-REC-1-TXT             
737500         PERFORM 7700-INSERT-SCM-MESSAGE.                                 
737600                                                                          
737700 EJECT                                                                    
737800******************************************************************        
737900* SET THE CURRENT TIMESTAMP.                                     *        
738000******************************************************************        
738100 7999-SET-CURRENT-TMST.                                                   
738200                                                                          
738300          EXEC SQL                                                        
738400              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                    
738500          END-EXEC                                                        
738600                                                                          
738700         EVALUATE TRUE                                                    
738800             WHEN SQLCODE = ZERO                                          
738900                 CONTINUE                                                 
739000             WHEN SQLWARN0 NOT EQUAL SPACE                                
739100             WHEN SQLCODE NOT EQUAL ZERO                                  
739200                 DISPLAY '**************************************'         
739300                 DISPLAY '** ABEND                              '         
739400                 DISPLAY '** PROGRAM = TRKUP245                 '         
739500                 DISPLAY '** PARAGRAPH = 7999-SET-CURRENT-TMST  '         
739600                 DISPLAY '** SET CURRENT TIMESTAMP              '         
739700                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST           
739800                 DISPLAY '**************************************'         
739900                 PERFORM 9100-SQL-ABEND                                   
740000         END-EVALUATE.                                                    
740100                                                                          
740200 EJECT                                                                    
740300******************************************************************        
740400* TAKES A FINAL COMMIT, CLOSES THE INPUT FILE, AND DISPLAYS      *        
740500* MISCELLANEOUS JOB SUMMARY INFORMATION.                         *        
740600* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *        
740700* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *        
740800* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *        
740900* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*        
741000* NO RETURN CODE OR MESSAGE IS SENT.                             *        
741100******************************************************************        
741200 8000-EOJ-ROUTINE.                                                        
741300                                                                          
741400     PERFORM 7999-SET-CURRENT-TMST.                                       
741500     PERFORM 4300-COMMIT.                                                 
741600     DISPLAY 'COMMIT TAKEN AT EOJ'.                                       
741700     DISPLAY  PV-CURRENT-TMST (6:2) '/'                                   
741800              PV-CURRENT-TMST (9:2) '/'                                   
741900              PV-CURRENT-TMST (3:2) '  '                                  
742000              PV-CURRENT-TMST (12:2) ':'                                  
742100              PV-CURRENT-TMST (15:2) ':'                                  
742200              PV-CURRENT-TMST (18:2).                                     
742300                                                                          
742400     CLOSE TR027-CUSTOMS-FILE.                                            
742500                                                                          
742600     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.                      
742700     PERFORM 4200-UPDATE-TCKRSTCNTL.                                      
742800                                                                          
742900     DISPLAY '**************************************'.                    
743000     DISPLAY '** TRKUP245 SUMMARY **'.                                    
743100     DISPLAY 'TOTAL ISA RECORDS      = ' PA-TOTAL-ISA-RECS-READ.          
743200     DISPLAY 'TOTAL RECORDS READ     = ' PA-TOTAL-RECS-READ.              
743300     DISPLAY '**************************************'.                    
743400*                                                                         
743500     DISPLAY 'TOTAL ADD    TRANS     = ' PA-TOT-TRN-TYP-A.                
743600     DISPLAY 'TOTAL CHANGE TRANS     = ' PA-TOT-TRN-TYP-C.                
743700     DISPLAY 'TOTAL DELETE TRANS     = ' PA-TOT-TRN-TYP-D.                
743800     DISPLAY '**************************************'.                    
743900*                                                                         
744000     DISPLAY 'TOTAL TOUTTRA INSERTS  = ' PA-TOT-TOUTTRA-INSERTS.          
744100     DISPLAY 'TOTAL TIMCNPO INSERTS  = ' PA-TOT-IMCNPO-INSERTS.           
744200     DISPLAY 'TOTAL TIMCNPO UPDATE   = ' PA-TOT-IMCNPO-UPDATES.           
744300     DISPLAY 'TOTAL TAUCNPO INSERTS  = ' PA-TOT-AUCNPO-INSERTS.           
744400     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.            
744500     DISPLAY 'TOTAL WARNING COUNT    = ' PA-TOTAL-WARN-COUNT.             
744600     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.           
744700     DISPLAY '**************************************'.                    
744800     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS.                
744900 EJECT                                                                    
745000******************************************************************        
745100* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *        
745200* ERROR OR WARNING CODE OCCURS.                                  *        
745300******************************************************************        
745400 9100-SQL-ABEND.                                                          
745500******************************************************************        
745600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *        
745700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *        
745800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *        
745900* FORMAT.                                                        *        
746000******************************************************************        
746100                                                                          
746200     COPY DPPD004.                                                        
746300                                                                          
746400     MOVE +4013 TO ABEND-CODE.                                            
746500     CALL 'ILBOABN0' USING ABEND-CODE.                                    
