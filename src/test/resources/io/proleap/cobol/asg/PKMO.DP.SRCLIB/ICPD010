      ******************************************************************        
      * PROCEDURE DIVISION COPYBOOK OF ROUTINE TO CONVERT TIMEZONE              
      * WHILE CONSIDERING AREAS THAT DO NOT ADHERE TO DAYLIGHT SAVINGS          
      * TIME.  USED WITH WORKING STORAGE COPYBOOK CNVRTZWS.                     
      ******************************************************************        
       9000-TIMEZONE-CONVERSION-SETUP.                                          
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = CURRENT TIMESTAMP                     
           END-EXEC.                                                            
      **** THIS FUNCTION PUTS THE DIFFERENCE (IN HOURS) BETWEEN GMT AND         
      **** AND CST INTO ICWS010-CURR-TMZONE-TZC. 5 HRS MEANS DST IS IN          
      **** EFFECT AND 6 HRS MEANS DST IS NOT IN EFFECT.                         
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMZONE-TZC = CURRENT TIMEZONE                    
           END-EXEC.                                                            
      *****                                                                     
           IF ICWS010-DST-TZC                                                   
             DISPLAY 'DAYLIGHT SAVINGS TIME IS IN EFFECT'                       
           ELSE                                                                 
             DISPLAY 'DAYLIGHT SAVINGS TIME IS NOT IN EFFECT'.                  
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC             
                                    ICWS010-CTZ-TMST-TZC.                       
      *    ADD 1 TO ICWS010-CURR-HH-WORK-TZC.                                   
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP + 1 HOUR)          
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-ETZ-TMST-TZC.                  
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
      *    SUBTRACT 1 FROM ICWS010-CURR-HH-WORK-TZC.                            
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 1 HOUR)          
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-MTZ-TMST-TZC.                  
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
      *    SUBTRACT 2 FROM ICWS010-CURR-HH-WORK-TZC.                            
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 2 HOURS)         
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-PTZ-TMST-TZC.                  
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
      *    SUBTRACT 3 FROM ICWS010-CURR-HH-WORK-TZC.                            
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 3 HOURS)         
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-ATZ-TMST-TZC.                  
      ******************************************************************        
      * IF DAYLIGHT SAVINGS TIME IS IN EFFECT, BUT, A SPECIFIC AREA             
      * DOESN'T UTILIZE DST THE FOLLOWING ADJUSTMENT MUST BE MADE.              
      ******************************************************************        
      * THESE VARIABLES SHOULD ONLY BE USED IF DST IS IN EFFECT AND THE         
      * LOCATION IN QUESTION DOES NOT ADHERE TO DST.                            
      ******************************************************************        
      * USED IF DST IN EFFECT, BUT, STORE IN ETZ DOESN'T USE DST.               
      *    SUBTRACT 1 FROM ICWS010-CURR-HH-WORK-TZC.                            
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = CURRENT TIMESTAMP                     
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
           MOVE ICWS010-CURR-TMST-TZC TO                                        
                ICWS010-ETZ-TMST-NO-DST-TZC.                                    
      * USED IF DST IN EFFECT, BUT, STORE IN CTZ DOESN'T USE DST.               
      *    SUBTRACT 1 FROM ICWS010-CURR-HH-WORK-TZC.                            
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 1 HOUR)          
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO                                        
                ICWS010-CTZ-TMST-NO-DST-TZC.                                    
      *    SUBTRACT 2 FROM ICWS010-CURR-HH-WORK-TZC.                            
      * USED IF DST IN EFFECT, BUT, STORE IN MTZ DOESN'T USE DST.               
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 2 HOURS)         
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO                                        
                ICWS010-MTZ-TMST-NO-DST-TZC.                                    
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
      *    SUBTRACT 3 FROM ICWS010-CURR-HH-WORK-TZC.                            
      * USED IF DST IN EFFECT, BUT, STORE IN PTZ DOESN'T USE DST.               
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 3 HOURS)         
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO                                        
                ICWS010-PTZ-TMST-NO-DST-TZC.                                    
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
      *    SUBTRACT 4 FROM ICWS010-CURR-HH-WORK-TZC.                            
      * USED IF DST IN EFFECT, BUT, STORE IN ATZ DOESN'T USE DST.               
           EXEC SQL                                                             
             SET :ICWS010-CURR-TMST-TZC = (CURRENT TIMESTAMP - 4 HOURS)         
           END-EXEC.                                                            
           MOVE ICWS010-CURR-TMST-TZC TO                                        
                ICWS010-ATZ-TMST-NO-DST-TZC.                                    
           MOVE ICWS010-CURR-TMST-TZC TO ICWS010-CURR-TMST-WORK-TZC.            
           DISPLAY 'ETZ       -' ICWS010-ETZ-TMST-TZC.                          
           DISPLAY 'CTZ       -' ICWS010-CTZ-TMST-TZC.                          
           DISPLAY 'MTZ       -' ICWS010-MTZ-TMST-TZC.                          
           DISPLAY 'PTZ       -' ICWS010-PTZ-TMST-TZC.                          
           DISPLAY 'ATZ       -' ICWS010-ATZ-TMST-TZC.                          
           DISPLAY 'ETZ-NO-DST-' ICWS010-ETZ-TMST-NO-DST-TZC.                   
           DISPLAY 'CTZ-NO-DST-' ICWS010-CTZ-TMST-NO-DST-TZC.                   
           DISPLAY 'MTZ-NO-DST-' ICWS010-MTZ-TMST-NO-DST-TZC.                   
           DISPLAY 'PTZ-NO-DST-' ICWS010-PTZ-TMST-NO-DST-TZC.                   
           DISPLAY 'ATZ-NO-DST-' ICWS010-ATZ-TMST-NO-DST-TZC.                   
                                                                                
      ******************************************************************        
      * PROCEDURE DIVISION COPYBOOK OF ROUTINE TO CONVERT TIMEZONE              
      * WHILE CONSIDERING AREAS THAT DO NOT ADHERE TO DAYLIGHT SAVINGS          
      * TIME.  USED WITH WORKING STORAGE COPYBOOK CNVRTZWS.                     
      ******************************************************************        
       9000-TIMEZONE-CONVERSION.                                                
           IF ICWS010-ST-TZC                                                    
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'EST'                             
               MOVE ICWS010-ETZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST           
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'CST'                             
               MOVE ICWS010-CTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST           
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'MST'                             
               MOVE ICWS010-MTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST           
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'PST'                             
               MOVE ICWS010-PTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST           
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'AST'                             
               MOVE ICWS010-ATZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST           
             ELSE                                                               
               MOVE ICWS010-CTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST           
               DISPLAY 'INVALID TIME ZONE- '                                    
                       ICWS010-TZC-TZ-IN-TM-ZN-CDE                              
           ELSE                                                                 
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'EST'                             
               IF ICWS010-TZC-TZ-IND-ST-IND = 'Y'                               
                 MOVE ICWS010-ETZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST         
               ELSE                                                             
                 MOVE ICWS010-ETZ-TMST-NO-DST-TZC TO                            
                      ICWS010-TZC-LOCATION-TMST                                 
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'CST'                             
               IF ICWS010-TZC-TZ-IND-ST-IND = 'Y'                               
                 MOVE ICWS010-CTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST         
               ELSE                                                             
                 MOVE ICWS010-CTZ-TMST-NO-DST-TZC TO                            
                      ICWS010-TZC-LOCATION-TMST                                 
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'MST'                             
               IF ICWS010-TZC-TZ-IND-ST-IND = 'Y'                               
                 MOVE ICWS010-MTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST         
               ELSE                                                             
                 MOVE ICWS010-MTZ-TMST-NO-DST-TZC TO                            
                      ICWS010-TZC-LOCATION-TMST                                 
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'PST'                             
               IF ICWS010-TZC-TZ-IND-ST-IND = 'Y'                               
                 MOVE ICWS010-PTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST         
               ELSE                                                             
                 MOVE ICWS010-PTZ-TMST-NO-DST-TZC TO                            
                      ICWS010-TZC-LOCATION-TMST                                 
             ELSE                                                               
             IF ICWS010-TZC-TZ-IN-TM-ZN-CDE = 'AST'                             
               IF ICWS010-TZC-TZ-IND-ST-IND = 'Y'                               
                 MOVE ICWS010-ATZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST         
               ELSE                                                             
                 MOVE ICWS010-ATZ-TMST-NO-DST-TZC TO                            
                      ICWS010-TZC-LOCATION-TMST                                 
             ELSE                                                               
               IF ICWS010-TZC-TZ-IND-ST-IND = 'Y'                               
                 MOVE ICWS010-CTZ-TMST-TZC TO ICWS010-TZC-LOCATION-TMST         
               ELSE                                                             
                 MOVE ICWS010-CTZ-TMST-NO-DST-TZC TO                            
                      ICWS010-TZC-LOCATION-TMST                                 
               END-IF                                                           
               DISPLAY 'INVALID TIME ZONE- '                                    
                       ICWS010-TZC-TZ-IN-TM-ZN-CDE.                             
