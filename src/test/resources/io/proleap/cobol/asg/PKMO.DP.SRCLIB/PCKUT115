000100******************************************************************00010086
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030087
000400 PROGRAM-ID.    PCKUT115.                                         00040028
000500 AUTHOR.        JIM ARENDT.                                       00050028
000600 DATE-WRITTEN.  FEB, 2018.                                        00060028
000700                                                                  00070000
000800******************************************************************00080087
000900*   THIS PROGRAM EXTRACTS DATA TO DISPLAY THOSE PO'S AND          00090084
001000*   CARTON COUNTS WHICH ARE STILL SITTING IN FLAT WAITING FOR     00100084
001100*   EAS TAGS.                                                     00110084
001200******************************************************************00120087
001300                                                                  00130000
001400******************************************************************00140087
001500 ENVIRONMENT DIVISION.                                            00150000
001600******************************************************************00160087
001700                                                                  00170000
001800******************************************************************00180087
001900 INPUT-OUTPUT SECTION.                                            00190000
002000******************************************************************00200087
002100                                                                  00210000
002200******************************************************************00220087
002300 FILE-CONTROL.                                                    00230000
002400******************************************************************00240087
002500     SELECT EXTRACT-FILE                                          00250000
002600         ASSIGN TO OUT01.                                         00260000
002700                                                                  00270000
002800******************************************************************00280087
002900 DATA DIVISION.                                                   00290087
003000******************************************************************00300087
003100                                                                  00310087
003200******************************************************************00320087
003300 FILE SECTION.                                                    00330087
003400******************************************************************00340087
003500                                                                  00350087
003600 FD  EXTRACT-FILE                                                 00360087
003700     RECORDING MODE IS F                                          00370087
003800     LABEL RECORDS ARE STANDARD                                   00380087
003900     RECORD CONTAINS 170                                          00390087
004000     BLOCK CONTAINS 0 RECORDS                                     00400087
004100     DATA RECORD IS EXTRACT-RECORD.                               00410087
004200 01  EXTRACT-RECORD                      PIC  X(170).             00420087
004300                                                                  00430087
004400******************************************************************00440087
004500 WORKING-STORAGE SECTION.                                         00450087
004600                                                                  00460087
004700 01  ABEND-CODE                          PIC S9(04)  VALUE ZERO   00470087
004800                                                     COMP SYNC.   00480087
004900 01  PC-PROGRAM-CONSTANTS.                                        00490087
005000     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00500087
005100         'PCKUT115'.                                              00510087
005200     05  PC-PGM-DPKUT500                 PIC  X(08)  VALUE        00520087
005300         'DPKUT500'.                                              00530087
005400     05  PC-A                            PIC  X(01)  VALUE 'A'.   00540087
005500     05  PC-19                           PIC  9(02)  VALUE 19.    00550087
005600     05  PC-20                           PIC  9(02)  VALUE 20.    00560087
005700     05  PC-90                           PIC  9(02)  VALUE 90.    00570087
005800     05  PC-DEFAULT-DATE                 PIC  X(26)  VALUE        00580087
005900         '9999-00-00-00.00.00.000000'.                            00590087
006000     05  PC-MONTH-ABBR-TABLE.                                     00600087
006100         10  FILLER                      PIC  X(03)  VALUE 'JAN'. 00610087
006200         10  FILLER                      PIC  X(03)  VALUE 'FEB'. 00620087
006300         10  FILLER                      PIC  X(03)  VALUE 'MAR'. 00630087
006400         10  FILLER                      PIC  X(03)  VALUE 'APR'. 00640087
006500         10  FILLER                      PIC  X(03)  VALUE 'MAY'. 00650087
006600         10  FILLER                      PIC  X(03)  VALUE 'JUN'. 00660087
006700         10  FILLER                      PIC  X(03)  VALUE 'JUL'. 00670087
006800         10  FILLER                      PIC  X(03)  VALUE 'AUG'. 00680087
006900         10  FILLER                      PIC  X(03)  VALUE 'SEP'. 00690087
007000         10  FILLER                      PIC  X(03)  VALUE 'OCT'. 00700087
007100         10  FILLER                      PIC  X(03)  VALUE 'NOV'. 00710087
007200         10  FILLER                      PIC  X(03)  VALUE 'DEC'. 00720087
007300     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    00730087
007400         10  PC-MONTH-ABBR OCCURS 12 TIMES                        00740087
007500                                         PIC  X(03).              00750087
007600                                                                  00760087
007700 01  PV-PROGRAM-VARIABLES.                                        00770000
007800     05  PV-DISP-DEC                     PIC  Z,ZZZ,ZZ9.          00780053
007900     05  PV-ABEND-PARAGRAPH              PIC  X(30)  VALUE SPACE. 00790000
008000     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 00800000
008100     05  PV-DISP-PO                      PIC  Z(09)  VALUE ZEROS. 00810060
008200     05  PV-DISP-RCVR                    PIC  9(04)  VALUE ZEROS. 00820060
008300     05  PV-DISP-OPER                    PIC  Z(04)  VALUE ZEROS. 00830060
008400     05  PV-DISPLAY-ENT-ID               PIC  9(09)  VALUE ZEROS. 00840000
008500     05  PV-SAVE-OPER-UNT-ID             PIC S9(04)  VALUE ZERO   00850048
008600                                                     COMP.        00860048
008700     05  PV-NULL-IND                     PIC S9(04)  VALUE ZERO   00870068
008800                                                     COMP SYNC.   00880068
008900     05  PV-TODAYS-DATE.                                          00890000
009000         10  PV-TODAYS-YY                PIC  9(02)  VALUE ZERO.  00900048
009100         10  PV-TODAYS-MM                PIC  9(02)  VALUE ZERO.  00910048
009200         10  PV-TODAYS-DD                PIC  9(02)  VALUE ZERO.  00920048
009300     05  PV-CURR-COMP-DATE.                                       00930000
009400         10  PV-CURR-COMP-DATE-CC        PIC  9(02)  VALUE ZEROES.00940048
009500         10  PV-CURR-COMP-DATE-YY        PIC  9(02)  VALUE ZEROES.00950048
009600         10  FILLER                      PIC  X(01)  VALUE '-'.   00960048
009700         10  PV-CURR-COMP-DATE-MM        PIC  9(02)  VALUE ZEROES.00970048
009800         10  FILLER                      PIC  X(01)  VALUE '-'.   00980048
009900         10  PV-CURR-COMP-DATE-DD        PIC  9(02)  VALUE ZEROES.00990048
010000     05  PV-TSTR-COMP-DATE               PIC  X(10)  VALUE SPACES.01000048
010100     05  PV-DATE-MMDDYY.                                          01010000
010200         10  PV-MM                       PIC  9(02)  VALUE ZEROES.01020048
010300         10  PV-DD                       PIC  9(02)  VALUE ZEROES.01030048
010400         10  PV-YY                       PIC  9(02)  VALUE ZEROES.01040048
010500         10  FILLER                      PIC  X(04)  VALUE SPACES.01050048
010600     05  PV-COMPARE-DATE                 PIC  9(08)  VALUE ZEROES.01060048
010700     05  PV-DB2-DATE                     PIC  X(10)  VALUE SPACES.01070048
010800     05  PV-OTB.                                                  01080016
010900         10  PV-OTB-MONTH                PIC  X(03)  VALUE SPACES.01090048
011000         10  PV-OTB-YY                   PIC  X(02)  VALUE SPACES.01100048
011100     05  PV-OTB-MON-CH                   PIC  X(02)  VALUE SPACES.01110048
011200     05  PV-OTB-MON-NM  REDEFINES    PV-OTB-MON-CH                01120031
011300                                         PIC  9(02).              01130048
011400                                                                  01140000
011500 01  PA-PROGRAM-COUNTERS.                                         01150083
011600     05  PA-READ-COUNT                   PIC  9(07)  VALUE ZERO.  01160083
011700     05  PA-WRITE-COUNT                  PIC  9(07)  VALUE ZERO.  01170083
011800                                                                  01180083
011900 01  CC-CONTROL-CARD.                                             01190000
012000     05  CC-CONSTANT                     PIC  X(07)  VALUE SPACE. 01200048
012100     05  FILLER                          PIC  X(01)  VALUE SPACE. 01210048
012200     05  CC-TIME-ZONE                    PIC  X(25)  VALUE SPACE. 01220048
012300     05  FILLER                          PIC  X(47)  VALUE SPACE. 01230048
012400                                                                  01240000
012500 01  DK-DB2-KEYS.                                                 01250000
012600     05  DK-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  01260048
012700                                                     COMP.        01270000
012800     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  01280048
012900                                                     COMP.        01290048
013000     05  DK-REC-SEQ-NBR                  PIC S9(09)  VALUE ZEROS  01300000
013100                                                     COMP.        01310000
013200                                                                  01320000
013300 01  PS-PROGRAM-SWITCHES.                                         01330000
013400     05  PS-FIRST-TIME-TWKORIN0-SW       PIC  X(01)  VALUE 'N'.   01340009
013500         88  PS-FIRST-TIME-TWKORIN0                  VALUE 'Y'.   01350009
013600         88  PS-FIRST-TIME-TWKORIN0-NO               VALUE 'N'.   01360009
013700     05  PS-FIRST-TIME-TWKORIN0-NOP-SW   PIC  X(01)  VALUE 'N'.   01370011
013800         88  PS-FIRST-TIME-TWKORIN0-NOP              VALUE 'Y'.   01380011
013900         88  PS-FIRST-TIME-TWKORIN0-NOP-NO           VALUE 'N'.   01390011
014000     05  SW-END-OF-LINE                  PIC  X(01)  VALUE 'N'.   01400000
014100         88  SW-THATS-ALL-FOLKS                      VALUE 'Y'.   01410000
014200         88  SW-THERES-MORE                          VALUE 'N'.   01420000
014300     05  PS-TWKORIN-FOUND-SW             PIC  X(01)  VALUE 'N'.   01430001
014400         88  PS-TWKORIN-FOUND-YES                    VALUE 'Y'.   01440001
014500         88  PS-TWKORIN-FOUND-NO                     VALUE 'N'.   01450001
014600     05  PS-TWKORIN-NO-OPER-FOUND-SW     PIC  X(01)  VALUE 'N'.   01460012
014700         88  PS-TWKORIN-NO-OPER-FOUND-YES            VALUE 'Y'.   01470012
014800         88  PS-TWKORIN-NO-OPER-FOUND-NO             VALUE 'N'.   01480012
014900     05  PS-TWKORIN-CURSOR-SW            PIC  X(01)  VALUE 'N'.   01490001
015000         88  PS-EOF-TWKORIN-CSR                      VALUE 'Y'.   01500000
015100     05  PS-TWKORIN-NO-OPER-CURSOR-SW    PIC  X(01)  VALUE 'N'.   01510001
015200         88  PS-EOF-TWKORIN-NO-OPER-CSR              VALUE 'Y'.   01520001
015300     05  PS-LOCATION-CURSOR-SW           PIC  X(01)  VALUE 'N'.   01530000
015400         88  PS-EOF-LOCATION-CSR                     VALUE 'Y'.   01540000
015500     05  PS-TWKORIN-ZERO-SW              PIC  X(01)  VALUE 'N'.   01550000
015600         88  PS-EOF-TWKORIN-ZERO                     VALUE 'Y'.   01560000
015700     05  PS-TWKORIN-NO-OPER-ZERO-SW      PIC  X(01)  VALUE 'N'.   01570001
015800         88  PS-EOF-TWKORIN-NO-OPER-ZERO             VALUE 'Y'.   01580001
015900     05  PS-AUTO-CONVEY-LVL-SW           PIC  X(03)  VALUE SPACE. 01590048
016000         88  PS-AUTO-CONVEY-EXCPT-CRTNS              VALUE 'EXC'. 01600048
016100         88  PS-AUTO-CONVEY-ALL-CRTNS                VALUE 'ALL'. 01610048
016200                                                                  01620000
016300******************************************************************01630028
016400*  COPY BOOK FOR DB2 FORMATTED MESSAGE AREA                       01640000
016500******************************************************************01650028
016600     COPY DPWS004.                                                01660000
016700                                                                  01670000
016800******************************************************************01680000
016900*    CALENDAR ROUTINE                                             01690000
017000******************************************************************01700000
017100     COPY DPWS500.                                                01710000
017200                                                                  01720000
017300******************************************************************01730037
017400*  COPYBOOK POWS055 (USED FOR OTB)                                01740037
017500******************************************************************01750037
017600     COPY POWS055.                                                01760037
017700                                                                  01770037
017800******************************************************************01780028
017900*  COPY BOOK FOR THE RECEIVER EXTRACT OUTPUT FILE                 01790079
018000******************************************************************01800028
018100     COPY PCRD081.                                                01810034
018200                                                                  01820000
018300******************************************************************01830028
018400*  DCLGEN FOR THE DB2 WORK ORDER INSTRUCTION TABLE                01840028
018500******************************************************************01850028
018600     EXEC SQL                                                     01860028
018700          INCLUDE TWKORIN                                         01870028
018800     END-EXEC.                                                    01880028
018900                                                                  01890028
019000******************************************************************01900028
019100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TDISTHD TABLE      01910075
019200******************************************************************01920028
019300     EXEC SQL                                                     01930000
019400          INCLUDE TDISTHD                                         01940075
019500     END-EXEC.                                                    01950000
019600                                                                  01960000
019700******************************************************************01970075
019800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRECDIS TABLE      01980075
019900******************************************************************01990075
020000     EXEC SQL                                                     02000075
020100          INCLUDE TRECDIS                                         02010075
020200     END-EXEC.                                                    02020075
020300                                                                  02030075
020400******************************************************************02040069
020500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  02050069
020600******************************************************************02060069
020700     EXEC SQL                                                     02070069
020800          INCLUDE TSTATCD                                         02080069
020900     END-EXEC.                                                    02090069
021000                                                                  02100069
021100******************************************************************02110028
021200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     02120000
021300*  HEADER TABLE                                                   02130000
021400******************************************************************02140028
021500     EXEC SQL                                                     02150000
021600          INCLUDE TPURCHS                                         02160000
021700     END-EXEC.                                                    02170000
021800                                                                  02180000
021900******************************************************************02190028
022000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     02200000
022100*  ITEM TABLE                                                     02210000
022200******************************************************************02220028
022300     EXEC SQL                                                     02230000
022400          INCLUDE TPURITM                                         02240000
022500     END-EXEC.                                                    02250000
022600                                                                  02260000
022700******************************************************************02270028
022800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    02280000
022900*  TABLE.                                                         02290000
023000******************************************************************02300028
023100     EXEC SQL                                                     02310000
023200          INCLUDE TENTNME                                         02320000
023300     END-EXEC.                                                    02330000
023400                                                                  02340000
023500******************************************************************02350028
023600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     02360000
023700******************************************************************02370028
023800     EXEC SQL                                                     02380000
023900          INCLUDE TRECEIV                                         02390000
024000     END-EXEC.                                                    02400000
024100                                                                  02410000
024200******************************************************************02420028
024300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT - RECEIVER02430000
024400*  ASSOCIATION TABLE                                              02440000
024500******************************************************************02450028
024600     EXEC SQL                                                     02460000
024700          INCLUDE TSHPTPO                                         02470000
024800     END-EXEC.                                                    02480000
024900                                                                  02490000
025000******************************************************************02500028
025100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          02510000
025200*  LOCATION TABLE - (XLT_LOC)                                     02520028
025300******************************************************************02530028
025400     EXEC SQL                                                     02540000
025500          INCLUDE XLT00010                                        02550000
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800******************************************************************02580028
025900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARM TABLE.        02590000
026000******************************************************************02600028
026100     EXEC SQL                                                     02610000
026200          INCLUDE TKRPRPM                                         02620000
026300     END-EXEC.                                                    02630000
026400                                                                  02640000
026500******************************************************************02650028
026600*  DCLGEN LAYOUT AND COBOL DECLARATION PLANNED SHIPMENT TABLE     02660017
026700******************************************************************02670028
026800     EXEC SQL                                                     02680017
026900          INCLUDE TPLNSHP                                         02690017
027000     END-EXEC.                                                    02700017
027100                                                                  02710017
027200******************************************************************02720031
027300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CARTON DIVERT      02730031
027400*  TRACKING TABLE - (SUT_CART_DIRV_TRKG)                          02740031
027500******************************************************************02750031
027600     EXEC SQL                                                     02760031
027700          INCLUDE SUT00102                                        02770032
027800     END-EXEC.                                                    02780031
027900                                                                  02790031
028000******************************************************************02800028
028100*  COMMUNICATION AREAS FOR DB2                                    02810000
028200******************************************************************02820028
028300     EXEC SQL                                                     02830000
028400         INCLUDE SQLCA                                            02840000
028500     END-EXEC.                                                    02850000
028600                                                                  02860000
028700******************************************************************02870029
028800     EXEC SQL                                                     02880029
028900       DECLARE DRIVER_CSR CURSOR FOR                              02890059
029000         SELECT   DC                                              02900029
029100                , PO                                              02910029
029200                , RCVR                                            02920029
029300          FROM                                                    02930029
029400          (SELECT A.OPER_UNT_ID  AS DC                            02940029
029500                , A.PO_NBR       AS PO                            02950029
029600                , A.RCVR_SEQ_NBR AS RCVR                          02960029
029700             FROM SUT_CART_DIRV_TRKG A                            02970029
029800                , TPURCHS            C                            02980029
029900                , TKRPRPM            D                            02990029
030000                , WST_INTGRTN_TYP   AA                            03000029
030100                , WST_ATTR_DEFN     BB                            03010029
030200                , WST_ATTR_ELEM     CC    -- OPER                 03020029
030300                , WST_ATTR_ELEM     DD    -- DEPT                 03030029
030400                , WST_ATTR_ELEM     EE    -- ENT ID               03040029
030500                , WST_ATTR_ELEM     FF    -- FROM TMST            03050029
030600                , WST_ATTR_ELEM     GG    -- TO TMST              03060029
030700                , WST_ATTR_ELEM     HH    -- Y/N SWITCH           03070029
030800             WHERE A.DIRV_RSN_CDE       = 'RFD'                   03080031
030900               AND A.SHIPT_UNT_ID       > 0                       03090031
031000               AND C.PO_NBR             = A.PO_NBR                03100031
031100               AND C.VER_STATUS_CDE     = 'A'                     03110031
031200               AND A.OPER_UNT_ID        = D.LOC_ID                03120031
031300               AND D.SYS_PRC_FUNC_CDE   = 'STATZN'                03130031
031400               AND D.FUNC_PRC_STAT_CDE  = 'AC'                    03140031
031500               AND D.FUNC_TXT           = :CC-TIME-ZONE           03150031
031600               AND A.CRE_TMST           =                         03160031
031700                   ( SELECT MAX(E.CRE_TMST)                       03170029
031800                       FROM SUT_CART_DIRV_TRKG E                  03180029
031900                      WHERE E.BRCDE_NBR = A.BRCDE_NBR)            03190029
032000               AND DATE(A.CRE_TMST)    >= :PV-DB2-DATE            03200069
032100               AND AA.INTGRTN_TYP_CDE   = 'EASTAG'                03210029
032200               AND AA.INTGRTN_TYP_CDE   = BB.INTGRTN_TYP_CDE      03220029
032300               AND BB.ATTR_DEFN_SEQ_NBR = 1                       03230029
032400               AND BB.INTGRTN_TYP_CDE   = CC.INTGRTN_TYP_CDE      03240029
032500               AND CC.ATTR_DEFN_SEQ_NBR = 1                       03250029
032600               AND CC.ATTR_ELEM_NBR     = A.OPER_UNT_ID           03260029
032700               AND BB.INTGRTN_TYP_CDE   = DD.INTGRTN_TYP_CDE      03270029
032800               AND DD.ATTR_DEFN_SEQ_NBR = 2                       03280029
032900               AND DD.ATTR_ELEM_NBR     = C.DEPT_NBR              03290029
033000               AND BB.INTGRTN_TYP_CDE   = EE.INTGRTN_TYP_CDE      03300029
033100               AND EE.ATTR_DEFN_SEQ_NBR = 3                       03310029
033200               AND EE.ATTR_ELEM_NBR     = C.ENT_ID                03320029
033300               AND BB.INTGRTN_TYP_CDE   = FF.INTGRTN_TYP_CDE      03330029
033400               AND FF.ATTR_DEFN_SEQ_NBR = 4                       03340029
033500               AND BB.INTGRTN_TYP_CDE   = GG.INTGRTN_TYP_CDE      03350029
033600               AND GG.ATTR_DEFN_SEQ_NBR = 5                       03360029
033700               AND BB.INTGRTN_TYP_CDE   = HH.INTGRTN_TYP_CDE      03370029
033800               AND HH.ATTR_DEFN_SEQ_NBR = 6                       03380029
033900               AND CC.ATTR_ELEM_SEQ_NBR = DD.ATTR_ELEM_SEQ_NBR    03390029
034000               AND CC.ATTR_ELEM_SEQ_NBR = EE.ATTR_ELEM_SEQ_NBR    03400029
034100               AND CC.ATTR_ELEM_SEQ_NBR = FF.ATTR_ELEM_SEQ_NBR    03410029
034200               AND CC.ATTR_ELEM_SEQ_NBR = GG.ATTR_ELEM_SEQ_NBR    03420029
034300               AND CC.ATTR_ELEM_SEQ_NBR = HH.ATTR_ELEM_SEQ_NBR    03430029
034400               AND FF.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP      03440029
034500               AND GG.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP      03450029
034600               AND HH.ATTR_ELEM_TXT     =  'Y'                    03460029
034700     UNION                                                        03470029
034800           SELECT                                                 03480029
034900                  A.OPER_UNT_ID AS DC                             03490029
035000                , G.PO_NBR      AS PO                             03500029
035100                , G.REC_SEQ_NBR AS RCVR                           03510029
035200             FROM TSHUNLO   A                                     03520029
035300                , TSHPUNT   B                                     03530029
035400                , TSHUUPC   C                                     03540029
035500                , TPURCHS   E                                     03550029
035600                , TINPKSU   F                                     03560029
035700                , TPKSLIP   G                                     03570029
035800                , TKRPRPM   H                                     03580029
035900                , WST_INTGRTN_TYP   AA                            03590029
036000                , WST_ATTR_DEFN     BB                            03600029
036100                , WST_ATTR_ELEM     CC   -- OPER                  03610029
036200                , WST_ATTR_ELEM     DD   -- DEPT                  03620029
036300                , WST_ATTR_ELEM     EE   -- ENT ID                03630029
036400                , WST_ATTR_ELEM     FF   -- FROM TMST             03640029
036500                , WST_ATTR_ELEM     GG   -- TO TMST               03650029
036600                , WST_ATTR_ELEM     HH   -- Y/N SWITCH            03660029
036700            WHERE A.OPER_UNT_ID       = B.ORGN_OPER_UNT_ID        03670031
036800              AND A.OPER_UNT_ID       = H.LOC_ID                  03680031
036900              AND H.SYS_PRC_FUNC_CDE  = 'STATZN'                  03690029
037000              AND H.FUNC_PRC_STAT_CDE = 'AC'                      03700029
037100              AND H.FUNC_TXT          = :CC-TIME-ZONE             03710031
037200              AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            03720031
037300              AND A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID            03730031
037400              AND C.SHIPT_UNT_ID      = F.SHIPT_UNT_ID            03740031
037500              AND A.TRIP_ID           = 999999999                 03750031
037600              AND A.SCN_LOC_ID        = 'RFDC'                    03760031
037700              AND C.TRN_NBR           = E.PO_NBR                  03770031
037800              AND E.VER_STATUS_CDE    = 'A'                       03780031
037900              AND F.SEQ_NBR           = G.SEQ_NBR                 03790031
038000              AND G.VER_STAT_CDE      = 'A'                       03800031
038100              AND G.PKSL_STAT_CDE     = 'AC'                      03810031
038200              AND G.PO_NBR            = E.PO_NBR                  03820031
038300              AND A.CRE_TMST          =                           03830031
038400                 ( SELECT MAX(E.CRE_TMST)                         03840029
038500                     FROM TSHUNLO E                               03850029
038600                    WHERE E.SHIPT_UNT_ID = A.SHIPT_UNT_ID)        03860029
038700              AND DATE(A.CRE_TMST)    >= :PV-DB2-DATE             03870031
038800              AND AA.INTGRTN_TYP_CDE   = 'EASTAG'                 03880029
038900              AND AA.INTGRTN_TYP_CDE   = BB.INTGRTN_TYP_CDE       03890029
039000              AND BB.ATTR_DEFN_SEQ_NBR = 1                        03900029
039100              AND BB.INTGRTN_TYP_CDE   = CC.INTGRTN_TYP_CDE       03910029
039200              AND CC.ATTR_DEFN_SEQ_NBR = 1                        03920029
039300              AND CC.ATTR_ELEM_NBR     = A.OPER_UNT_ID            03930029
039400              AND BB.INTGRTN_TYP_CDE   = DD.INTGRTN_TYP_CDE       03940029
039500              AND DD.ATTR_DEFN_SEQ_NBR = 2                        03950029
039600              AND DD.ATTR_ELEM_NBR     = E.DEPT_NBR               03960029
039700              AND BB.INTGRTN_TYP_CDE   = EE.INTGRTN_TYP_CDE       03970029
039800              AND EE.ATTR_DEFN_SEQ_NBR = 3                        03980029
039900              AND EE.ATTR_ELEM_NBR     = E.ENT_ID                 03990029
040000              AND BB.INTGRTN_TYP_CDE   = FF.INTGRTN_TYP_CDE       04000029
040100              AND FF.ATTR_DEFN_SEQ_NBR = 4                        04010029
040200              AND BB.INTGRTN_TYP_CDE   = GG.INTGRTN_TYP_CDE       04020029
040300              AND GG.ATTR_DEFN_SEQ_NBR = 5                        04030029
040400              AND BB.INTGRTN_TYP_CDE   = HH.INTGRTN_TYP_CDE       04040029
040500              AND HH.ATTR_DEFN_SEQ_NBR = 6                        04050029
040600              AND CC.ATTR_ELEM_SEQ_NBR = DD.ATTR_ELEM_SEQ_NBR     04060029
040700              AND CC.ATTR_ELEM_SEQ_NBR = EE.ATTR_ELEM_SEQ_NBR     04070029
040800              AND CC.ATTR_ELEM_SEQ_NBR = FF.ATTR_ELEM_SEQ_NBR     04080029
040900              AND CC.ATTR_ELEM_SEQ_NBR = GG.ATTR_ELEM_SEQ_NBR     04090029
041000              AND CC.ATTR_ELEM_SEQ_NBR = HH.ATTR_ELEM_SEQ_NBR     04100029
041100              AND FF.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP       04110029
041200              AND GG.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP       04120029
041300              AND HH.ATTR_ELEM_TXT     =  'Y' ) Z                 04130029
041400            ORDER BY DC                                           04140029
041500                    ,PO                                           04150029
041600                    ,RCVR                                         04160029
041700           WITH UR                                                04170029
041800     END-EXEC.                                                    04180029
041900                                                                  04190029
042000******************************************************************04200000
042100*  TWKORIN CURSOR                                                 04210028
042200******************************************************************04220000
042300     EXEC SQL                                                     04230000
042400          DECLARE TWKORIN_CSR CURSOR FOR                          04240000
042500             SELECT STRT_TMST                                     04250036
042600                   ,STOP_TMST                                     04260036
042700                   ,PRC_FCLTY_AREA_ID                             04270036
042800                   ,SCREEN_SEQ_NBR                                04280036
042900               FROM TWKORIN                                       04290036
043000              WHERE ORD_NBR           = :DK-ORD-NBR               04300041
043100                AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR           04310041
043200                AND ORD_LNE_NBR       = 0                         04320041
043300                AND WORK_ORD_SEQ_NBR  = 1                         04330041
043400                AND FCLTY_ID          = 1                         04340043
043500                AND OPER_UNT_ID       = :SUT00102-OPER-UNT-ID     04350041
043600                AND VER_STATUS_CDE    = :PC-A                     04360041
043700              ORDER BY SCREEN_SEQ_NBR                             04370041
043800           WITH UR                                                04380000
043900     END-EXEC.                                                    04390000
044000                                                                  04400000
044100******************************************************************04410000
044200*  TWKORIN CURSOR - FOR LINE NUMBER = ZERO                        04420028
044300******************************************************************04430000
044400     EXEC SQL                                                     04440000
044500          DECLARE WKORIN0_CSR CURSOR FOR                          04450000
044600             SELECT  STRT_TMST                                    04460036
044700                    ,STOP_TMST                                    04470036
044800                    ,PRC_FCLTY_AREA_ID                            04480036
044900                    ,SCREEN_SEQ_NBR                               04490036
045000               FROM TWKORIN                                       04500036
045100              WHERE ORD_NBR           = :DK-ORD-NBR               04510041
045200                AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR           04520041
045300                AND ORD_LNE_NBR       = 0                         04530041
045400                AND WORK_ORD_SEQ_NBR  = 1                         04540041
045500                AND FCLTY_ID          = 1                         04550043
045600                AND OPER_UNT_ID       = :SUT00102-OPER-UNT-ID     04560041
045700                AND VER_STATUS_CDE    = :PC-A                     04570041
045800              ORDER BY SCREEN_SEQ_NBR                             04580041
045900           WITH UR                                                04590000
046000     END-EXEC.                                                    04600000
046100                                                                  04610000
046200******************************************************************04620001
046300*  TWKORIN CURSOR - NO OPER                                       04630028
046400******************************************************************04640001
046500     EXEC SQL                                                     04650001
046600          DECLARE TWKORIN_NO_OPER_CSR CURSOR FOR                  04660001
046700             SELECT  STRT_TMST                                    04670036
046800                    ,STOP_TMST                                    04680036
046900                    ,PRC_FCLTY_AREA_ID                            04690036
047000                    ,SCREEN_SEQ_NBR                               04700036
047100               FROM TWKORIN                                       04710036
047200              WHERE ORD_NBR           = :DK-ORD-NBR               04720041
047300                AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR           04730041
047400                AND ORD_LNE_NBR       = 0                         04740041
047500                AND WORK_ORD_SEQ_NBR  = 1                         04750041
047600                AND VER_STATUS_CDE    = :PC-A                     04760041
047700              ORDER BY SCREEN_SEQ_NBR                             04770041
047800           WITH UR                                                04780001
047900     END-EXEC.                                                    04790001
048000                                                                  04800001
048100******************************************************************04810001
048200*  TWKORIN CURSOR - FOR LINE NUMBER = ZERO                        04820028
048300******************************************************************04830001
048400     EXEC SQL                                                     04840001
048500          DECLARE WKORIN0_NO_OPER_CSR CURSOR FOR                  04850011
048600             SELECT  STRT_TMST                                    04860036
048700                    ,STOP_TMST                                    04870036
048800                    ,PRC_FCLTY_AREA_ID                            04880036
048900                    ,SCREEN_SEQ_NBR                               04890036
049000               FROM TWKORIN                                       04900036
049100              WHERE ORD_NBR           = :DK-ORD-NBR               04910041
049200                AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR           04920041
049300                AND ORD_LNE_NBR       = 0                         04930041
049400                AND WORK_ORD_SEQ_NBR  = 1                         04940041
049500                AND VER_STATUS_CDE    = :PC-A                     04950041
049600              ORDER BY SCREEN_SEQ_NBR                             04960041
049700           WITH UR                                                04970001
049800     END-EXEC.                                                    04980001
049900                                                                  04990001
050000******************************************************************05000000
050100 PROCEDURE DIVISION.                                              05010000
050200******************************************************************05020000
050300 0000-MAINLINE.                                                   05030000
050400                                                                  05040052
050500     PERFORM 1000-INITIALIZE-ROUTINE.                             05050079
050600                                                                  05060046
050700     PERFORM 2000-PROCESS-CSR                                     05070000
050800        UNTIL SW-THATS-ALL-FOLKS.                                 05080032
050900                                                                  05090000
051000     PERFORM 9000-EOJ-ROUTINE.                                    05100052
051100                                                                  05110000
051200     GOBACK.                                                      05120000
051300                                                                  05130028
051400******************************************************************05140079
051500 1000-INITIALIZE-ROUTINE.                                         05150079
051600                                                                  05160079
051700     DISPLAY ' '.                                                 05170079
051800     DISPLAY ' **************************************'.           05180079
051900     DISPLAY '     '   PC-CURRENT-PROGRAM-NAME.                   05190079
052000     DISPLAY ' **************************************'.           05200079
052100                                                                  05210079
052200     OPEN OUTPUT EXTRACT-FILE.                                    05220079
052300                                                                  05230079
052400     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05240079
052500         DISPLAY ' '.                                             05250079
052600         DISPLAY '** TIMEZONE = ' CC-TIME-ZONE.                   05260079
052700     PERFORM 1100-VALIDATE-CONTROL-CARD.                          05270079
052800                                                                  05280079
052900     ACCEPT PV-TODAYS-DATE FROM DATE.                             05290079
053000     IF PV-TODAYS-YY > PC-90                                      05300079
053100         MOVE PC-19         TO PV-CURR-COMP-DATE-CC               05310079
053200     ELSE                                                         05320079
053300         MOVE PC-20         TO PV-CURR-COMP-DATE-CC.              05330079
053400                                                                  05340079
053500     MOVE PV-TODAYS-MM      TO PV-MM                              05350079
053600                               PV-CURR-COMP-DATE-MM.              05360079
053700     MOVE PV-TODAYS-DD      TO PV-DD                              05370079
053800                               PV-CURR-COMP-DATE-DD.              05380079
053900     MOVE PV-TODAYS-YY      TO PV-YY                              05390079
054000                               PV-CURR-COMP-DATE-YY.              05400079
054100     MOVE PV-CURR-COMP-DATE TO PV-TSTR-COMP-DATE.                 05410079
054200     DISPLAY 'TODAYS DATE:  '  PV-CURR-COMP-DATE.                 05420082
054300                                                                  05430079
054400     PERFORM 1300-SELECT-TKRPRPM.                                 05440079
054500     PERFORM 1200-CALCULATE-DATE.                                 05450079
054600                                                                  05460079
054700     PERFORM 5000-OPEN-DRIVER-CSR.                                05470079
054800                                                                  05480079
054900     PERFORM 5400-FETCH-DRIVER-CSR.                               05490079
055000                                                                  05500079
055100******************************************************************05510000
055200*  VALIDATE THE CONTROL CARD.                                     05520000
055300******************************************************************05530000
055400 1100-VALIDATE-CONTROL-CARD.                                      05540000
055500                                                                  05550028
055600     IF CC-CONSTANT = 'CONTROL'                                   05560029
055700         CONTINUE                                                 05570000
055800     ELSE                                                         05580000
055900         DISPLAY '** ABEND **'                                    05590000
056000         DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME     05600000
056100         DISPLAY '** PARAGRAPH ** = 1100-VALIDATE-CONTROL-CARD'   05610000
056200         DISPLAY '** CONTROL CONSTANT INVALID'                    05620000
056300         DISPLAY '** CONTROL CONSTANT = ' CC-CONSTANT             05630000
056400         DISPLAY '** CHANGE TO CONTROL'                           05640000
056500         MOVE +4003              TO ABEND-CODE                    05650000
056600         CALL 'ILBOABN0' USING ABEND-CODE                         05660000
056700     END-IF.                                                      05670000
056800                                                                  05680000
056900     EVALUATE TRUE                                                05690000
057000         WHEN CC-TIME-ZONE  = 'ETZ'                               05700000
057100         WHEN CC-TIME-ZONE  = 'CTZ'                               05710000
057200         WHEN CC-TIME-ZONE  = 'MTZ'                               05720000
057300         WHEN CC-TIME-ZONE  = 'PTZ'                               05730000
057400         WHEN CC-TIME-ZONE  = 'ALL'                               05740000
057500             CONTINUE                                             05750000
057600                                                                  05760031
057700         WHEN OTHER                                               05770000
057800             DISPLAY '** ABEND **'                                05780000
057900             DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME    05790000
058000             DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'  05800000
058100             DISPLAY '** TIMEZONE NOT VALID '                     05810000
058200             DISPLAY '** TIMEZONE = ' CC-TIME-ZONE                05820000
058300             MOVE +4003          TO ABEND-CODE                    05830000
058400             CALL 'ILBOABN0' USING ABEND-CODE                     05840000
058500     END-EVALUATE.                                                05850000
058600                                                                  05860000
058700******************************************************************05870028
058800 1200-CALCULATE-DATE.                                             05880000
058900                                                                  05890028
059000     SET DPG51-DECREMENT-DATE       TO TRUE.                      05900030
059100     MOVE KRPRPM-FUNC-QTY           TO DPG51-INCR-DECR-DAYS-9.    05910030
059200     MOVE PV-TODAYS-DATE            TO DPG51-SYSTEM-DATE.         05920030
059300                                                                  05930000
059400     MOVE PV-DATE-MMDDYY            TO DPG52-LK-DATE-INPUT.       05940030
059500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      05950000
059600     SET DPG52-LK-DTE-GREG          TO TRUE.                      05960030
059700                                                                  05970000
059800     CALL PC-PGM-DPKUT500 USING DPG51 DPG52                       05980000
059900                                DPG53 DPG54                       05990000
060000                                DPG55 DPG56.                      06000000
060100                                                                  06010077
060200     IF DPG54-NO-ERROR                                            06020000
060300         DISPLAY 'PARM DAYS:    '        KRPRPM-FUNC-QTY          06030082
060400         MOVE DPG55-DB2-ISO-DATE      TO PV-COMPARE-DATE          06040000
060500         MOVE DPG55-DB2-ISO-DATE-FMT  TO PV-DB2-DATE              06050031
060600         DISPLAY 'CALCULATED DATE: '     PV-COMPARE-DATE          06060082
060700     ELSE                                                         06070000
060800         DISPLAY '** ABEND ** IN PCKUT115'                        06080028
060900         DISPLAY 'PV-DATE-MMDDYY = '     PV-DATE-MMDDYY           06090030
061000         DISPLAY 'DATE ERROR : '         DPG54-ERROR-MESSAGE      06100030
061100         MOVE +4003                   TO ABEND-CODE               06110030
061200         CALL 'ILBOABN0' USING ABEND-CODE                         06120000
061300     END-IF.                                                      06130000
061400                                                                  06140000
061500******************************************************************06150028
061600 1300-SELECT-TKRPRPM.                                             06160000
061700                                                                  06170028
061800     MOVE '1300-SELECT-TKRPRPM' TO PV-ABEND-PARAGRAPH.            06180029
061900     MOVE 'SELECT NUMBER OF DAYS FOR EAS'                         06190031
062000                                TO PV-DB2-OPERATION-ATTEMPTED.    06200029
062100                                                                  06210000
062200     INITIALIZE DCLTKRPRPM.                                       06220000
062300                                                                  06230000
062400     EXEC SQL                                                     06240000
062500         SELECT FUNC_QTY                                          06250046
062600           INTO :KRPRPM-FUNC-QTY                                  06260046
062700           FROM TKRPRPM                                           06270046
062800          WHERE LOC_ID           = 90                             06280046
062900            AND INTFC_SYS_CDE    = 'KHL'                          06290046
063000            AND SYS_PRC_FUNC_CDE = 'RCVEAS'                       06300046
063100          WITH UR                                                 06310000
063200     END-EXEC.                                                    06320000
063300                                                                  06330000
063400     EVALUATE TRUE                                                06340000
063500         WHEN SQLCODE = +0                                        06350046
063600             CONTINUE                                             06360046
063700                                                                  06370029
063800         WHEN SQLCODE = +100                                      06380000
063900         WHEN SQLCODE < ZERO                                      06390000
064000         WHEN SQLCODE > ZERO                                      06400000
064100         WHEN SQLWARN0 NOT = SPACE                                06410032
064200             PERFORM 9100-SQL-ABEND                               06420000
064300     END-EVALUATE.                                                06430000
064400                                                                  06440000
064500******************************************************************06450028
064600 2000-PROCESS-CSR.                                                06460000
064700                                                                  06470000
064800     PERFORM 2050-FORMAT-AND-WRITE                                06480037
064900                                                                  06490000
065000     PERFORM 5400-FETCH-DRIVER-CSR.                               06500060
065100                                                                  06510000
065200******************************************************************06520028
065300 2050-FORMAT-AND-WRITE.                                           06530000
065400                                                                  06540037
065500     INITIALIZE PC081-RECEIVER-EXT-RECORD.                        06550034
065600                                                                  06560032
065700     MOVE SUT00102-OPER-UNT-ID       TO PC081-CURRENT-OPER        06570048
065800                                        DK-OPER-UNT-ID.           06580048
065900     MOVE SUT00102-PO-NBR            TO DK-ORD-NBR                06590036
066000                                        PC081-PO-NBR.             06600036
066100     MOVE SUT00102-RCVR-SEQ-NBR      TO DK-REC-SEQ-NBR            06610036
066200                                        PC081-REC-SEQ-NBR.        06620036
066300                                                                  06630032
066400     IF SUT00102-OPER-UNT-ID = PV-SAVE-OPER-UNT-ID                06640048
066500        NEXT SENTENCE                                             06650048
066600     ELSE                                                         06660048
066700        PERFORM 3000-CHECK-AUTO-CONVEY                            06670048
066800        MOVE SUT00102-OPER-UNT-ID    TO PV-SAVE-OPER-UNT-ID       06680048
066900     END-IF.                                                      06690048
067000                                                                  06700079
067100     IF PS-AUTO-CONVEY-EXCPT-CRTNS                                06710048
067200        SET PC081-AUTO-CONVEY-Y      TO TRUE                      06720048
067300     ELSE                                                         06730048
067400        SET PC081-AUTO-CONVEY-N      TO TRUE                      06740048
067500     END-IF.                                                      06750048
067600                                                                  06760048
067700     PERFORM 7010-GET-TPURCHS-INFO.                               06770066
067800     MOVE PURCHS-ENT-ID              TO PC081-ENT-ID.             06780064
067900     MOVE PURCHS-DEPT-NBR            TO PC081-DEPT-NBR.           06790064
068000     MOVE PURCHS-SEASET-SHRT-NM      TO PC081-SEASET-NM.          06800047
068100                                                                  06810047
068200     PERFORM 6000-SELECT-TRECEIV.                                 06820036
068300     MOVE RECEIV-PKGNG-CDE           TO PC081-PKGNG-CDE.          06830050
068400     MOVE RECEIV-STATUS-CDE          TO PC081-STATUS-CDE.         06840036
068500     MOVE RECEIV-EXPTED-CART-CNT     TO PC081-EXPECT-CART-CNT.    06850061
068600     IF RECEIV-PACK-BY-ST-IND = 'Y'                               06860071
068700        MOVE 'A'                     TO PC081-PROCESS-CODE        06870074
068800     ELSE                                                         06880074
068900        PERFORM 6600-SELECT-TDISTHD                               06890075
069000     END-IF.                                                      06900071
069100                                                                  06910067
069200     PERFORM 6500-GET-TRECDIS-INFO.                               06920067
069300     MOVE RECDIS-EXPTED-ITM-QTY      TO PC081-EXPECT-UNIT-CNT.    06930068
069400                                                                  06940000
069500     PERFORM 4000-GET-OTB.                                        06950047
069600                                                                  06960075
069700     PERFORM 4500-GET-PROCESSING-AREA.                            06970047
069800                                                                  06980047
069900     PERFORM 7020-GET-PRIMARY-VNDR-NME.                           06990066
070000                                                                  07000000
070100     PERFORM 2100-WRITE-OUTPUT-FILE.                              07010000
070200                                                                  07020000
070300******************************************************************07030028
070400 2100-WRITE-OUTPUT-FILE.                                          07040000
070500                                                                  07050028
070600     WRITE EXTRACT-RECORD                                         07060028
070700        FROM PC081-RECEIVER-EXT-RECORD.                           07070034
070800                                                                  07080000
070900     ADD +1                        TO PA-WRITE-COUNT.             07090052
071000                                                                  07100052
071100******************************************************************07110048
071200 3000-CHECK-AUTO-CONVEY.                                          07120048
071300                                                                  07130048
071400     MOVE '3000-CHECK-AUTO-CONVEY' TO PV-ABEND-PARAGRAPH.         07140048
071500     MOVE 'GET AUTO CONVEY CODE'   TO PV-DB2-OPERATION-ATTEMPTED. 07150048
071600                                                                  07160059
071700     INITIALIZE DCLTKRPRPM.                                       07170059
071800                                                                  07180048
071900     EXEC SQL                                                     07190049
072000          SELECT FUNC_TXT                                         07200048
072100            INTO :KRPRPM-FUNC-TXT                                 07210048
072200            FROM TKRPRPM                                          07220048
072300           WHERE LOC_ID            = :DK-OPER-UNT-ID              07230048
072400             AND INTFC_SYS_CDE     = 'KHL'                        07240048
072500             AND SYS_PRC_FUNC_CDE  = 'AUTOCY'                     07250048
072600             AND FUNC_PRC_STAT_CDE = 'AC'                         07260048
072700             AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP            07270048
072800             AND FUNC_END_TMST    >= CURRENT TIMESTAMP            07280048
072900            WITH UR                                               07290079
073000     END-EXEC.                                                    07300049
073100                                                                  07310048
073200     EVALUATE TRUE                                                07320076
073300          WHEN SQLCODE = +0                                       07330048
073400              MOVE KRPRPM-FUNC-TXT      TO PS-AUTO-CONVEY-LVL-SW  07340048
073500                                                                  07350048
073600          WHEN OTHER                                              07360048
073700              DISPLAY 'ERROR OPER-ID= '    PC081-CURRENT-OPER     07370048
073800              PERFORM 9100-SQL-ABEND                              07380048
073900     END-EVALUATE.                                                07390076
074000                                                                  07400048
074100******************************************************************07410028
074200 4000-GET-OTB.                                                    07420016
074300                                                                  07430035
074400     PERFORM 4010-GET-OTB-PERIOD.                                 07440024
074500                                                                  07450016
074600     PERFORM POPD055-CALC-WEEKLY-OTB.                             07460016
074700     IF POWS055-NO-ERROR                                          07470024
074800        MOVE POWS055-OTB-MONTH     TO PV-OTB-MON-CH               07480028
074900        MOVE PC-MONTH-ABBR (PV-OTB-MON-NM)                        07490028
075000                                   TO PV-OTB-MONTH                07500028
075100        MOVE POWS055-OTB-YY        TO PV-OTB-YY                   07510028
075200        MOVE PV-OTB                TO PC081-OPEN-TO-BUY-PERIOD    07520034
075300        MOVE POWS055-OTB-FSCL-WEEK-NBR                            07530028
075400                                   TO PC081-OPEN-TO-BUY-WEEK-NBR  07540034
075500     ELSE                                                         07550024
075600        MOVE SPACES                TO PC081-OPEN-TO-BUY-PERIOD    07560034
075700        MOVE ZEROES                TO PC081-OPEN-TO-BUY-WEEK-NBR  07570034
075800     END-IF.                                                      07580024
075900                                                                  07590024
076000******************************************************************07600024
076100 4010-GET-OTB-PERIOD.                                             07610024
076200                                                                  07620024
076300     MOVE '4010-GET-OTB-PERIOD'  TO PV-ABEND-PARAGRAPH.           07630046
076400     MOVE 'RETRIEVE OTB DATA'    TO PV-DB2-OPERATION-ATTEMPTED.   07640046
076500                                                                  07650024
076600     EXEC SQL                                                     07660076
076700          SELECT A.OTB_PER_NBR                                    07670028
076800               , B.DONT_SHIP_BEF_DTE                              07680028
076900            INTO :PURCHS-OTB-PER-NBR                              07690028
077000               , :PLNSHP-DONT-SHIP-BEF-DTE                        07700028
077100            FROM TPURCHS A                                        07710028
077200               , TPLNSHP B                                        07720028
077300           WHERE A.PO_NBR         = :DK-ORD-NBR                   07730028
077400             AND A.VER_STATUS_CDE = 'A'                           07740028
077500             AND B.PO_NBR         = A.PO_NBR                      07750028
077600             AND B.VER_STATUS_CDE = 'A'                           07760028
077700            WITH UR                                               07770079
077800     END-EXEC.                                                    07780076
077900                                                                  07790024
078000     EVALUATE TRUE                                                07800076
078100          WHEN SQLCODE = +0                                       07810028
078200              MOVE PLNSHP-DONT-SHIP-BEF-DTE TO POWS055-INPUT-DATE 07820046
078300                                                                  07830028
078400          WHEN SQLCODE = +100                                     07840028
078500              MOVE SPACES                   TO POWS055-INPUT-DATE 07850046
078600                                                                  07860028
078700          WHEN OTHER                                              07870028
078800              MOVE DK-ORD-NBR               TO PV-DISP-PO         07880046
078900              DISPLAY 'ERROR OPER-ID= '        PC081-CURRENT-OPER 07890079
079000              DISPLAY '       PO-NBR= '        PV-DISP-PO         07900079
079100              PERFORM 9100-SQL-ABEND                              07910046
079200     END-EVALUATE.                                                07920076
079300                                                                  07930016
079400******************************************************************07940028
079500 4500-GET-PROCESSING-AREA.                                        07950000
079600                                                                  07960028
079700     SET PS-TWKORIN-FOUND-NO  TO TRUE.                            07970076
079800                                                                  07980001
079900     PERFORM 4550-OPEN-TWKORIN.                                   07990000
080000     PERFORM 4600-FETCH-TWKORIN-LOOP.                             08000000
080100                                                                  08010000
080200     IF PS-TWKORIN-FOUND-NO                                       08020031
080300         PERFORM 4510-OPEN-TWKORIN-NO-OPER                        08030011
080400         PERFORM 4610-FETCH-TWKORIN-NO-OP-LOOP                    08040012
080500         IF PS-TWKORIN-NO-OPER-FOUND-NO                           08050046
080600            MOVE  SUT00102-OPER-UNT-ID TO PV-DISP-OPER            08060046
080700            MOVE  DK-ORD-NBR           TO PV-DISP-PO              08070046
080800            MOVE  DK-REC-SEQ-NBR       TO PV-DISP-RCVR            08080046
080900            DISPLAY 'NO WORK ORDER INSTRUCTION FOUND - '          08090013
081000                     PV-DISP-PO  '-'                              08100013
081100                     PV-DISP-RCVR '-'                             08110013
081200                     '   OPER-'                                   08120013
081300                     PV-DISP-OPER                                 08130013
081400                     '   *** NO OPER ***'                         08140013
081500     END-IF.                                                      08150002
081600                                                                  08160001
081700******************************************************************08170028
081800 4510-OPEN-TWKORIN-NO-OPER.                                       08180012
081900                                                                  08190028
082000     MOVE '4510-OPEN-TWKORIN-NO-OPER'                             08200011
082100                                 TO PV-ABEND-PARAGRAPH.           08210028
082200     MOVE 'OPEN THE TWKORIN_NO_OPER_CSR'                          08220046
082300                                 TO PV-DB2-OPERATION-ATTEMPTED.   08230028
082400                                                                  08240000
082500     EXEC SQL                                                     08250000
082600         OPEN TWKORIN_NO_OPER_CSR                                 08260011
082700     END-EXEC.                                                    08270000
082800                                                                  08280000
082900     EVALUATE TRUE                                                08290000
083000         WHEN SQLCODE = +0                                        08300046
083100             CONTINUE                                             08310046
083200                                                                  08320046
083300         WHEN SQLWARN0 NOT = SPACE                                08330000
083400         WHEN SQLCODE < ZERO                                      08340000
083500         WHEN SQLCODE > ZERO                                      08350000
083600              MOVE DK-ORD-NBR             TO PV-DISP-PO           08360069
083700              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         08370069
083800              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           08380069
083900              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         08390069
084000              DISPLAY '     OPER-ID= '       PC081-CURRENT-OPER   08400079
084100              PERFORM 9100-SQL-ABEND                              08410073
084200     END-EVALUATE.                                                08420000
084300                                                                  08430080
084400******************************************************************08440028
084500 4515-CLOSE-TWKORIN-NO-OPER.                                      08450011
084600                                                                  08460028
084700     MOVE '4515-CLOSE-TWKORIN-NO-OPER'                            08470011
084800                                  TO PV-ABEND-PARAGRAPH.          08480028
084900     MOVE 'CLOSE THE TWKORIN_NO_OPER_CSR'                         08490046
085000                                  TO PV-DB2-OPERATION-ATTEMPTED.  08500028
085100                                                                  08510011
085200     EXEC SQL                                                     08520011
085300         CLOSE TWKORIN_NO_OPER_CSR                                08530011
085400     END-EXEC.                                                    08540011
085500                                                                  08550011
085600     EVALUATE TRUE                                                08560011
085700         WHEN SQLCODE = +0                                        08570046
085800             CONTINUE                                             08580046
085900                                                                  08590046
086000         WHEN SQLWARN0 NOT = SPACE                                08600011
086100         WHEN SQLCODE < ZERO                                      08610011
086200         WHEN SQLCODE > ZERO                                      08620011
086300             PERFORM 9100-SQL-ABEND                               08630011
086400     END-EVALUATE.                                                08640011
086500                                                                  08650011
086600******************************************************************08660028
086700 4550-OPEN-TWKORIN.                                               08670011
086800                                                                  08680028
086900     MOVE '4550-OPEN-TWKORIN'    TO PV-ABEND-PARAGRAPH.           08690046
087000     MOVE 'OPEN THE TWKORIN_CSR' TO PV-DB2-OPERATION-ATTEMPTED.   08700046
087100                                                                  08710011
087200     EXEC SQL                                                     08720011
087300         OPEN TWKORIN_CSR                                         08730011
087400     END-EXEC.                                                    08740011
087500                                                                  08750011
087600     EVALUATE TRUE                                                08760011
087700         WHEN SQLCODE = +0                                        08770046
087800             CONTINUE                                             08780046
087900                                                                  08790046
088000         WHEN SQLWARN0 NOT = SPACE                                08800011
088100         WHEN SQLCODE < ZERO                                      08810011
088200         WHEN SQLCODE > ZERO                                      08820011
088300              MOVE DK-ORD-NBR             TO PV-DISP-PO           08830069
088400              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         08840069
088500              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           08850069
088600              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         08860069
088700              DISPLAY '     OPER-ID= '       SUT00102-OPER-UNT-ID 08870069
088800              PERFORM 9100-SQL-ABEND                              08880069
088900     END-EVALUATE.                                                08890011
089000                                                                  08900011
089100******************************************************************08910028
089200 4575-CLOSE-TWKORIN.                                              08920000
089300                                                                  08930028
089400     MOVE '4575-CLOSE-TWKORIN'    TO PV-ABEND-PARAGRAPH.          08940046
089500     MOVE 'CLOSE THE TWKORIN_CSR' TO PV-DB2-OPERATION-ATTEMPTED.  08950046
089600                                                                  08960000
089700     EXEC SQL                                                     08970000
089800         CLOSE TWKORIN_CSR                                        08980000
089900     END-EXEC.                                                    08990000
090000                                                                  09000000
090100     EVALUATE TRUE                                                09010000
090200         WHEN SQLCODE = +0                                        09020046
090300             CONTINUE                                             09030046
090400                                                                  09040046
090500         WHEN SQLWARN0 NOT = SPACE                                09050000
090600         WHEN SQLCODE < ZERO                                      09060000
090700         WHEN SQLCODE > ZERO                                      09070000
090800             PERFORM 9100-SQL-ABEND                               09080000
090900     END-EVALUATE.                                                09090000
091000                                                                  09100000
091100******************************************************************09110028
091200 4600-FETCH-TWKORIN-LOOP.                                         09120000
091300                                                                  09130000
091400     SET  PS-TWKORIN-FOUND-NO  TO TRUE.                           09140031
091500     MOVE 'N'                  TO PS-TWKORIN-CURSOR-SW.           09150031
091600     MOVE 'N'                  TO PS-TWKORIN-ZERO-SW.             09160031
091700     PERFORM 4650-FETCH-TWKORIN.                                  09170000
091800     IF PS-EOF-TWKORIN-CSR                                        09180028
091900     OR WKORIN-STRT-TMST > PC-DEFAULT-DATE                        09190028
092000         PERFORM 4575-CLOSE-TWKORIN                               09200000
092100         PERFORM 4800-OPEN-WKORIN0-CURSOR                         09210000
092200         MOVE PC-DEFAULT-DATE        TO WKORIN-STRT-TMST          09220031
092300         SET  PS-FIRST-TIME-TWKORIN0 TO TRUE                      09230028
092400         PERFORM 4850-FETCH-TWKORIN-ZERO                          09240000
092500         IF  PS-FIRST-TIME-TWKORIN0                               09250028
092600         AND PS-EOF-TWKORIN-CSR                                   09260028
092700             PERFORM 4805-CLOSE-WKORIN0                           09270028
092800         ELSE                                                     09280008
092900             IF WKORIN-STRT-TMST > PC-DEFAULT-DATE                09290028
093000                 SET  PS-TWKORIN-FOUND-YES     TO TRUE            09300031
093100                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 09310008
093200                                               PC081-PROCESS-AREA 09320034
093300                 MOVE 'N'                  TO PS-TWKORIN-CURSOR-SW09330031
093400                 PERFORM 4805-CLOSE-WKORIN0                       09340008
093500             ELSE                                                 09350008
093600                 SET  PS-TWKORIN-FOUND-YES     TO TRUE            09360031
093700                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 09370008
093800                                               PC081-PROCESS-AREA 09380034
093900                 PERFORM 4850-FETCH-TWKORIN-ZERO                  09390008
094000                    UNTIL PS-EOF-TWKORIN-CSR                      09400008
094100                 PERFORM 4805-CLOSE-WKORIN0                       09410008
094200             END-IF                                               09420008
094300         END-IF                                                   09430008
094400     ELSE                                                         09440000
094500         SET  PS-TWKORIN-FOUND-YES     TO TRUE                    09450028
094600         MOVE WKORIN-PRC-FCLTY-AREA-ID TO PC081-PROCESS-AREA      09460034
094700         PERFORM 4650-FETCH-TWKORIN                               09470000
094800           UNTIL PS-EOF-TWKORIN-CSR                               09480029
094900         PERFORM 4575-CLOSE-TWKORIN                               09490000
095000     END-IF.                                                      09500000
095100                                                                  09510000
095200******************************************************************09520028
095300 4610-FETCH-TWKORIN-NO-OP-LOOP.                                   09530012
095400                                                                  09540011
095500     SET  PS-TWKORIN-NO-OPER-FOUND-NO  TO TRUE.                   09550031
095600     MOVE 'N'                     TO PS-TWKORIN-NO-OPER-CURSOR-SW.09560031
095700     MOVE 'N'                     TO PS-TWKORIN-NO-OPER-ZERO-SW.  09570031
095800     PERFORM 4660-FETCH-TWKORIN-NO-OPER.                          09580011
095900     IF PS-EOF-TWKORIN-NO-OPER-CSR                                09590028
096000     OR WKORIN-STRT-TMST > PC-DEFAULT-DATE                        09600028
096100         PERFORM 4515-CLOSE-TWKORIN-NO-OPER                       09610011
096200         PERFORM 4810-OPEN-WKORIN0-NO-OPER-CSR                    09620013
096300         MOVE PC-DEFAULT-DATE            TO WKORIN-STRT-TMST      09630031
096400         SET  PS-FIRST-TIME-TWKORIN0-NOP TO TRUE                  09640028
096500         PERFORM 4860-FETCH-TWKORIN-NO-OP-ZERO                    09650012
096600         IF  PS-FIRST-TIME-TWKORIN0-NOP                           09660028
096700         AND PS-EOF-TWKORIN-NO-OPER-CSR                           09670028
096800             PERFORM 4815-CLOSE-WKORIN0-NO-OPER                   09680028
096900         ELSE                                                     09690011
097000             IF WKORIN-STRT-TMST > PC-DEFAULT-DATE                09700028
097100                 SET  PS-TWKORIN-NO-OPER-FOUND-YES TO TRUE        09710029
097200                 MOVE WKORIN-PRC-FCLTY-AREA-ID     TO             09720029
097300                                            PC081-PROCESS-AREA    09730034
097400                 MOVE 'N' TO PS-TWKORIN-NO-OPER-CURSOR-SW         09740011
097500                 PERFORM 4815-CLOSE-WKORIN0-NO-OPER               09750011
097600             ELSE                                                 09760011
097700                 SET  PS-TWKORIN-NO-OPER-FOUND-YES  TO TRUE       09770029
097800                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 09780011
097900                                               PC081-PROCESS-AREA 09790034
098000                 PERFORM 4860-FETCH-TWKORIN-NO-OP-ZERO            09800012
098100                    UNTIL PS-EOF-TWKORIN-NO-OPER-CSR              09810011
098200                 PERFORM 4815-CLOSE-WKORIN0-NO-OPER               09820011
098300             END-IF                                               09830011
098400         END-IF                                                   09840011
098500     ELSE                                                         09850011
098600         SET  PS-TWKORIN-NO-OPER-FOUND-YES  TO TRUE               09860029
098700         MOVE WKORIN-PRC-FCLTY-AREA-ID      TO PC081-PROCESS-AREA 09870034
098800         PERFORM 4660-FETCH-TWKORIN-NO-OPER                       09880011
098900            UNTIL PS-EOF-TWKORIN-NO-OPER-CSR                      09890031
099000         PERFORM 4515-CLOSE-TWKORIN-NO-OPER                       09900011
099100     END-IF.                                                      09910011
099200                                                                  09920011
099300******************************************************************09930028
099400 4650-FETCH-TWKORIN.                                              09940000
099500                                                                  09950028
099600     MOVE '4650-FETCH-TWKORIN'   TO PV-ABEND-PARAGRAPH.           09960029
099700     MOVE 'FETCH THE TWORIN_CSR' TO PV-DB2-OPERATION-ATTEMPTED.   09970029
099800                                                                  09980000
099900     EXEC SQL                                                     09990000
100000          FETCH TWKORIN_CSR                                       10000000
100100             INTO  :WKORIN-STRT-TMST                              10010031
100200                  ,:WKORIN-STOP-TMST                              10020031
100300                  ,:WKORIN-PRC-FCLTY-AREA-ID                      10030031
100400                  ,:WKORIN-SCREEN-SEQ-NBR                         10040036
100500     END-EXEC.                                                    10050000
100600                                                                  10060000
100700     EVALUATE TRUE                                                10070000
100800         WHEN SQLCODE = +0                                        10080000
100900             PERFORM 4675-CHECK-DATES                             10090046
101000                                                                  10100029
101100         WHEN SQLCODE = +100                                      10110000
101200             SET PS-EOF-TWKORIN-CSR TO TRUE                       10120046
101300                                                                  10130029
101400         WHEN SQLWARN0 NOT = SPACE                                10140000
101500         WHEN SQLCODE < ZERO                                      10150000
101600         WHEN SQLCODE > ZERO                                      10160000
101700              MOVE DK-ORD-NBR             TO PV-DISP-PO           10170069
101800              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         10180069
101900              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           10190069
102000              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         10200069
102100              DISPLAY '     OPER-ID= '       SUT00102-OPER-UNT-ID 10210069
102200              PERFORM 9100-SQL-ABEND                              10220069
102300     END-EVALUATE.                                                10230000
102400                                                                  10240000
102500******************************************************************10250028
102600 4660-FETCH-TWKORIN-NO-OPER.                                      10260011
102700                                                                  10270028
102800     MOVE '4660-FETCH-TWKORIN-NO-OPER'                            10280011
102900                                  TO PV-ABEND-PARAGRAPH.          10290029
103000     MOVE 'FETCH THE TWORIN_NO_OPER_CSR'                          10300011
103100                                  TO PV-DB2-OPERATION-ATTEMPTED.  10310029
103200                                                                  10320011
103300     EXEC SQL                                                     10330011
103400          FETCH TWKORIN_NO_OPER_CSR                               10340011
103500             INTO  :WKORIN-STRT-TMST                              10350031
103600                  ,:WKORIN-STOP-TMST                              10360031
103700                  ,:WKORIN-PRC-FCLTY-AREA-ID                      10370031
103800                  ,:WKORIN-SCREEN-SEQ-NBR                         10380036
103900     END-EXEC.                                                    10390011
104000                                                                  10400011
104100     EVALUATE TRUE                                                10410011
104200         WHEN SQLCODE = +0                                        10420011
104300             PERFORM 4675-CHECK-DATES                             10430046
104400                                                                  10440029
104500         WHEN SQLCODE = +100                                      10450011
104600             SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE               10460046
104700                                                                  10470029
104800         WHEN SQLWARN0 NOT = SPACE                                10480011
104900         WHEN SQLCODE < ZERO                                      10490011
105000         WHEN SQLCODE > ZERO                                      10500011
105100              MOVE DK-ORD-NBR             TO PV-DISP-PO           10510069
105200              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         10520069
105300              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           10530069
105400              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         10540069
105500              DISPLAY '     OPER-ID= '       PC081-CURRENT-OPER   10550079
105600              PERFORM 9100-SQL-ABEND                              10560069
105700     END-EVALUATE.                                                10570011
105800                                                                  10580011
105900******************************************************************10590028
106000 4675-CHECK-DATES.                                                10600000
106100                                                                  10610028
106200     IF WKORIN-STRT-TMST < PC-DEFAULT-DATE                        10620031
106300         IF WKORIN-STOP-TMST <  PC-DEFAULT-DATE                   10630031
106400             MOVE WKORIN-PRC-FCLTY-AREA-ID  TO PC081-PROCESS-AREA 10640034
106500         ELSE                                                     10650000
106600             MOVE WKORIN-PRC-FCLTY-AREA-ID  TO PC081-PROCESS-AREA 10660034
106700             SET PS-EOF-TWKORIN-CSR         TO TRUE               10670029
106800             SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE               10680011
106900         END-IF                                                   10690000
107000     ELSE                                                         10700000
107100         SET PS-EOF-TWKORIN-CSR             TO TRUE               10710031
107200         SET PS-EOF-TWKORIN-NO-OPER-CSR     TO TRUE               10720031
107300     END-IF.                                                      10730000
107400                                                                  10740000
107500******************************************************************10750028
107600 4800-OPEN-WKORIN0-CURSOR.                                        10760000
107700                                                                  10770028
107800     MOVE '4800-OPEN-WKORIN0-CURSOR'                              10780000
107900                                  TO PV-ABEND-PARAGRAPH.          10790029
108000     MOVE 'OPEN THE WKORIN0_CSR'  TO PV-DB2-OPERATION-ATTEMPTED.  10800029
108100                                                                  10810000
108200     EXEC SQL                                                     10820000
108300         OPEN WKORIN0_CSR                                         10830000
108400     END-EXEC.                                                    10840000
108500                                                                  10850000
108600     EVALUATE TRUE                                                10860000
108700         WHEN SQLCODE = +0                                        10870046
108800             CONTINUE                                             10880046
108900                                                                  10890046
109000         WHEN SQLWARN0 NOT = SPACE                                10900000
109100         WHEN SQLCODE < ZERO                                      10910000
109200         WHEN SQLCODE > ZERO                                      10920000
109300              MOVE DK-ORD-NBR             TO PV-DISP-PO           10930069
109400              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         10940069
109500              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           10950069
109600              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         10960069
109700              DISPLAY '     OPER-ID= '       SUT00102-OPER-UNT-ID 10970069
109800              PERFORM 9100-SQL-ABEND                              10980069
109900     END-EVALUATE.                                                10990000
110000                                                                  11000011
110100******************************************************************11010046
110200 4805-CLOSE-WKORIN0.                                              11020046
110300                                                                  11030046
110400     MOVE '4805-CLOSE-WKORIN0'    TO PV-ABEND-PARAGRAPH.          11040046
110500     MOVE 'CLOSE THE WKORIN0_CSR' TO PV-DB2-OPERATION-ATTEMPTED.  11050046
110600                                                                  11060046
110700     EXEC SQL                                                     11070046
110800         CLOSE WKORIN0_CSR                                        11080046
110900     END-EXEC.                                                    11090046
111000                                                                  11100046
111100     EVALUATE TRUE                                                11110076
111200          WHEN SQLCODE = +0                                       11120046
111300              CONTINUE                                            11130046
111400                                                                  11140046
111500          WHEN SQLWARN0 NOT = SPACE                               11150046
111600          WHEN SQLCODE < ZERO                                     11160046
111700          WHEN SQLCODE > ZERO                                     11170046
111800              PERFORM 9100-SQL-ABEND                              11180046
111900     END-EVALUATE.                                                11190076
112000                                                                  11200046
112100******************************************************************11210028
112200 4810-OPEN-WKORIN0-NO-OPER-CSR.                                   11220013
112300                                                                  11230028
112400     MOVE '4810-OPEN-WKORIN0-NO-OPER-CSR'                         11240013
112500                                    TO PV-ABEND-PARAGRAPH.        11250029
112600     MOVE 'OPEN THE WKORIN0_NO_OPER_CSR'                          11260011
112700                                    TO PV-DB2-OPERATION-ATTEMPTED.11270029
112800                                                                  11280011
112900     EXEC SQL                                                     11290011
113000         OPEN WKORIN0_NO_OPER_CSR                                 11300011
113100     END-EXEC.                                                    11310011
113200                                                                  11320011
113300     EVALUATE TRUE                                                11330011
113400         WHEN SQLCODE = +0                                        11340046
113500             CONTINUE                                             11350046
113600                                                                  11360046
113700         WHEN SQLWARN0 NOT = SPACE                                11370011
113800         WHEN SQLCODE < ZERO                                      11380011
113900         WHEN SQLCODE > ZERO                                      11390011
114000              MOVE DK-ORD-NBR             TO PV-DISP-PO           11400069
114100              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         11410069
114200              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           11420069
114300              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         11430069
114400              DISPLAY '     OPER-ID= '       PC081-CURRENT-OPER   11440079
114500              PERFORM 9100-SQL-ABEND                              11450069
114600     END-EVALUATE.                                                11460011
114700                                                                  11470000
114800******************************************************************11480028
114900 4815-CLOSE-WKORIN0-NO-OPER.                                      11490011
115000                                                                  11500028
115100     MOVE '4815-CLOSE-WKORIN0-NO-OPER'                            11510011
115200                                    TO PV-ABEND-PARAGRAPH.        11520029
115300     MOVE 'CLOSE THE WKORIN0_CSR_NO_OPER'                         11530011
115400                                    TO PV-DB2-OPERATION-ATTEMPTED.11540029
115500                                                                  11550011
115600     EXEC SQL                                                     11560011
115700         CLOSE WKORIN0_NO_OPER_CSR                                11570011
115800     END-EXEC.                                                    11580011
115900                                                                  11590011
116000     EVALUATE TRUE                                                11600076
116100          WHEN SQLCODE = +0                                       11610046
116200              CONTINUE                                            11620046
116300                                                                  11630046
116400          WHEN SQLWARN0 NOT = SPACE                               11640011
116500          WHEN SQLCODE < ZERO                                     11650011
116600          WHEN SQLCODE > ZERO                                     11660011
116700              PERFORM 9100-SQL-ABEND                              11670046
116800     END-EVALUATE.                                                11680076
116900                                                                  11690011
117000******************************************************************11700028
117100 4850-FETCH-TWKORIN-ZERO.                                         11710000
117200                                                                  11720028
117300     MOVE '4850-FETCH-TWKORIN-ZERO' TO PV-ABEND-PARAGRAPH.        11730029
117400     MOVE 'FETCH THE WKORIN0_CSR'   TO PV-DB2-OPERATION-ATTEMPTED.11740029
117500                                                                  11750000
117600     EXEC SQL                                                     11760000
117700          FETCH WKORIN0_CSR                                       11770000
117800             INTO  :WKORIN-STRT-TMST                              11780031
117900                  ,:WKORIN-STOP-TMST                              11790031
118000                  ,:WKORIN-PRC-FCLTY-AREA-ID                      11800031
118100                  ,:WKORIN-SCREEN-SEQ-NBR                         11810036
118200     END-EXEC.                                                    11820000
118300                                                                  11830000
118400     EVALUATE TRUE                                                11840000
118500         WHEN SQLCODE = +0                                        11850000
118600             SET PS-FIRST-TIME-TWKORIN0-NOP-NO TO TRUE            11860046
118700             PERFORM 4860-CHECK-DATES                             11870046
118800                                                                  11880029
118900         WHEN SQLCODE = +100                                      11890000
119000             SET PS-EOF-TWKORIN-CSR            TO TRUE            11900046
119100                                                                  11910029
119200         WHEN SQLWARN0 NOT = SPACE                                11920000
119300         WHEN SQLCODE < ZERO                                      11930000
119400         WHEN SQLCODE > ZERO                                      11940000
119500              MOVE DK-ORD-NBR             TO PV-DISP-PO           11950069
119600              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         11960069
119700              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           11970069
119800              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         11980069
119900              DISPLAY '     OPER-ID= '       SUT00102-OPER-UNT-ID 11990069
120000              PERFORM 9100-SQL-ABEND                              12000069
120100     END-EVALUATE.                                                12010000
120200                                                                  12020000
120300******************************************************************12030028
120400 4860-FETCH-TWKORIN-NO-OP-ZERO.                                   12040012
120500                                                                  12050028
120600     MOVE '4850-FETCH-TWKORIN-NO-OPER-ZERO'                       12060011
120700                                    TO PV-ABEND-PARAGRAPH.        12070029
120800     MOVE 'FETCH THE WKORIN0_NO_OPER_CSR'                         12080011
120900                                    TO PV-DB2-OPERATION-ATTEMPTED.12090029
121000                                                                  12100011
121100     EXEC SQL                                                     12110011
121200          FETCH WKORIN0_NO_OPER_CSR                               12120011
121300             INTO  :WKORIN-STRT-TMST                              12130036
121400                  ,:WKORIN-STOP-TMST                              12140036
121500                  ,:WKORIN-PRC-FCLTY-AREA-ID                      12150036
121600                  ,:WKORIN-SCREEN-SEQ-NBR                         12160036
121700     END-EXEC.                                                    12170011
121800                                                                  12180011
121900     EVALUATE TRUE                                                12190011
122000         WHEN SQLCODE = +0                                        12200011
122100             SET PS-FIRST-TIME-TWKORIN0-NOP-NO TO TRUE            12210031
122200             PERFORM 4860-CHECK-DATES                             12220031
122300                                                                  12230029
122400         WHEN SQLCODE = +100                                      12240011
122500             SET PS-EOF-TWKORIN-NO-OPER-CSR    TO TRUE            12250031
122600                                                                  12260029
122700         WHEN SQLWARN0 NOT = SPACE                                12270011
122800         WHEN SQLCODE < ZERO                                      12280011
122900         WHEN SQLCODE > ZERO                                      12290011
123000              MOVE DK-ORD-NBR             TO PV-DISP-PO           12300069
123100              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         12310069
123200              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           12320069
123300              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         12330069
123400              DISPLAY '     OPER-ID= '       PC081-CURRENT-OPER   12340079
123500              PERFORM 9100-SQL-ABEND                              12350069
123600     END-EVALUATE.                                                12360011
123700                                                                  12370011
123800******************************************************************12380028
123900 4860-CHECK-DATES.                                                12390000
124000                                                                  12400028
124100     IF WKORIN-STRT-TMST < PC-DEFAULT-DATE                        12410031
124200         IF WKORIN-STOP-TMST < PC-DEFAULT-DATE                    12420031
124300             MOVE WKORIN-PRC-FCLTY-AREA-ID  TO PC081-PROCESS-AREA 12430034
124400         ELSE                                                     12440000
124500             MOVE WKORIN-PRC-FCLTY-AREA-ID  TO PC081-PROCESS-AREA 12450034
124600             SET PS-EOF-TWKORIN-CSR         TO TRUE               12460029
124700             SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE               12470011
124800         END-IF                                                   12480000
124900     ELSE                                                         12490000
125000         MOVE WKORIN-PRC-FCLTY-AREA-ID      TO PC081-PROCESS-AREA 12500036
125100         SET PS-EOF-TWKORIN-CSR TO TRUE                           12510000
125200         SET PS-EOF-TWKORIN-NO-OPER-CSR     TO TRUE               12520036
125300     END-IF.                                                      12530000
125400                                                                  12540000
125500******************************************************************12550028
125600 5000-OPEN-DRIVER-CSR.                                            12560060
125700                                                                  12570028
125800     MOVE '5000-OPEN-DRIVER-CSR'  TO PV-ABEND-PARAGRAPH.          12580060
125900     MOVE 'OPEN THE DRIVER_CSR'   TO PV-DB2-OPERATION-ATTEMPTED.  12590059
126000                                                                  12600000
126100     EXEC SQL                                                     12610000
126200         OPEN DRIVER_CSR                                          12620059
126300     END-EXEC.                                                    12630000
126400                                                                  12640000
126500     EVALUATE TRUE                                                12650000
126600         WHEN SQLCODE = +0                                        12660046
126700             CONTINUE                                             12670046
126800                                                                  12680046
126900         WHEN SQLWARN0 NOT = SPACE                                12690000
127000         WHEN SQLCODE < ZERO                                      12700000
127100         WHEN SQLCODE > ZERO                                      12710000
127200              MOVE DK-ORD-NBR             TO PV-DISP-PO           12720069
127300              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         12730069
127400              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           12740069
127500              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         12750069
127600              DISPLAY '   TIME-ZONE= '       CC-TIME-ZONE         12760069
127700              DISPLAY '    CRE-TMST= '       PV-DB2-DATE          12770069
127800              DISPLAY '     OPER-ID= '       PC081-CURRENT-OPER   12780079
127900              PERFORM 9100-SQL-ABEND                              12790069
128000     END-EVALUATE.                                                12800000
128100                                                                  12810000
128200******************************************************************12820028
128300 5200-CLOSE-DRIVER-CSR.                                           12830060
128400                                                                  12840028
128500     MOVE '5200-CLOSE-DRIVER-CSR'  TO PV-ABEND-PARAGRAPH.         12850060
128600     MOVE 'CLOSE THE DRIVER_CSR'   TO PV-DB2-OPERATION-ATTEMPTED. 12860059
128700                                                                  12870000
128800     EXEC SQL                                                     12880000
128900         CLOSE DRIVER_CSR                                         12890059
129000     END-EXEC.                                                    12900000
129100                                                                  12910000
129200     EVALUATE TRUE                                                12920000
129300         WHEN SQLCODE = +0                                        12930046
129400             CONTINUE                                             12940046
129500                                                                  12950046
129600         WHEN SQLWARN0 NOT = SPACE                                12960000
129700         WHEN SQLCODE < ZERO                                      12970000
129800         WHEN SQLCODE > ZERO                                      12980000
129900             PERFORM 9100-SQL-ABEND                               12990000
130000     END-EVALUATE.                                                13000000
130100                                                                  13010000
130200******************************************************************13020028
130300 5400-FETCH-DRIVER-CSR.                                           13030060
130400                                                                  13040028
130500     MOVE '5400-FETCH-DRIVER-CSR'  TO PV-ABEND-PARAGRAPH.         13050060
130600     MOVE 'FETCH THE DRIVER_CSR'   TO PV-DB2-OPERATION-ATTEMPTED. 13060059
130700                                                                  13070000
130800     INITIALIZE DCLSUT00102.                                      13080059
130900                                                                  13090000
131000     EXEC SQL                                                     13100000
131100         FETCH  DRIVER_CSR                                        13110059
131200          INTO  :SUT00102-OPER-UNT-ID                             13120031
131300               ,:SUT00102-PO-NBR                                  13130031
131400               ,:SUT00102-RCVR-SEQ-NBR                            13140031
131500     END-EXEC.                                                    13150000
131600                                                                  13160000
131700     EVALUATE TRUE                                                13170000
131800         WHEN SQLCODE = +0                                        13180046
131900             ADD 1                   TO PA-READ-COUNT             13190060
132000                                                                  13200046
132100         WHEN SQLCODE = +100                                      13210000
132200             SET SW-THATS-ALL-FOLKS  TO TRUE                      13220046
132300                                                                  13230029
132400         WHEN SQLWARN0 NOT = SPACE                                13240000
132500         WHEN SQLCODE < ZERO                                      13250000
132600         WHEN SQLCODE > ZERO                                      13260000
132700              MOVE DK-ORD-NBR             TO PV-DISP-PO           13270069
132800              MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR         13280069
132900              DISPLAY 'ERROR PO-NBR= '       PV-DISP-PO           13290069
133000              DISPLAY '     SEQ-NBR= '       PV-DISP-RCVR         13300069
133100              DISPLAY '   TIME-ZONE= '       CC-TIME-ZONE         13310069
133200              DISPLAY '    CRE-TMST= '       PV-DB2-DATE          13320069
133300              DISPLAY '     OPER-ID= '       PC081-CURRENT-OPER   13330079
133400              PERFORM 9100-SQL-ABEND                              13340069
133500     END-EVALUATE.                                                13350000
133600                                                                  13360000
133700******************************************************************13370036
133800 6000-SELECT-TRECEIV.                                             13380036
133900                                                                  13390036
134000     MOVE '6000-SELECT-TRECEIV' TO PV-ABEND-PARAGRAPH.            13400036
134100     MOVE 'RETRIEVE FIELDS FROM TRECEIV'                          13410036
134200                                TO PV-DB2-OPERATION-ATTEMPTED.    13420036
134300                                                                  13430036
134400     INITIALIZE DCLTRECEIV.                                       13440036
134500                                                                  13450036
134600     EXEC SQL                                                     13460036
134700         SELECT STATUS_CDE                                        13470036
134800               ,PACK_BY_ST_IND                                    13480036
134900               ,EXPTED_ITM_QTY                                    13490065
135000               ,EXPTED_CART_CNT                                   13500065
135100               ,PKGNG_CDE                                         13510050
135200           INTO :RECEIV-STATUS-CDE                                13520036
135300               ,:RECEIV-PACK-BY-ST-IND                            13530036
135400               ,:RECEIV-EXPTED-ITM-QTY                            13540065
135500               ,:RECEIV-EXPTED-CART-CNT                           13550036
135600               ,:RECEIV-PKGNG-CDE                                 13560050
135700           FROM TRECEIV                                           13570036
135800          WHERE ORD_NBR      = :DK-ORD-NBR                        13580036
135900            AND REC_SEQ_NBR  = :DK-REC-SEQ-NBR                    13590036
136000           WITH UR                                                13600036
136100     END-EXEC.                                                    13610036
136200                                                                  13620036
136300     EVALUATE TRUE                                                13630036
136400         WHEN SQLCODE = +0                                        13640046
136500             CONTINUE                                             13650046
136600                                                                  13660036
136700         WHEN SQLCODE = +100                                      13670036
136800         WHEN SQLCODE < ZERO                                      13680036
136900         WHEN SQLCODE > ZERO                                      13690036
137000         WHEN SQLWARN0 NOT = SPACE                                13700036
137100             MOVE DK-ORD-NBR           TO PV-DISP-PO              13710046
137200             MOVE DK-REC-SEQ-NBR       TO PV-DISP-RCVR            13720046
137300             DISPLAY 'ERROR PO-NBR = '    PV-DISP-PO              13730046
137400             DISPLAY '      SEQ-NBR= '    PV-DISP-RCVR            13740079
137500             DISPLAY '      OPER-ID= '    PC081-CURRENT-OPER      13750079
137600             PERFORM 9100-SQL-ABEND                               13760036
137700     END-EVALUATE.                                                13770036
137800                                                                  13780036
137900******************************************************************13790066
138000 6500-GET-TRECDIS-INFO.                                           13800070
138100                                                                  13810066
138200     MOVE '6500-GET-TRECDIS-INFO'  TO PV-ABEND-PARAGRAPH.         13820067
138300     MOVE 'GET INFO FROM TRECDIS'  TO PV-DB2-OPERATION-ATTEMPTED. 13830067
138400                                                                  13840066
138500     INITIALIZE DCLTRECDIS.                                       13850067
138600                                                                  13860066
138700     EXEC SQL                                                     13870066
138800         SELECT SUM(EXPTED_ITM_QTY)                               13880068
138900           INTO :RECDIS-EXPTED-ITM-QTY                            13890068
139000                :PV-NULL-IND                                      13900068
139100           FROM TRECDIS                                           13910067
139200          WHERE ORD_NBR        = :DK-ORD-NBR                      13920067
139300            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  13930067
139500           WITH UR                                                13950066
139600     END-EXEC.                                                    13960066
139700                                                                  13970066
139800     EVALUATE TRUE                                                13980066
139900         WHEN SQLCODE = +0                                        13990066
140000             IF PV-NULL-IND < +0                                  14000068
140100                MOVE ZEROES             TO RECDIS-EXPTED-ITM-QTY  14010068
140200             END-IF                                               14020068
140300                                                                  14030066
140400         WHEN SQLCODE = +100                                      14040066
140500         WHEN SQLWARN0 NOT = SPACE                                14050066
140600         WHEN SQLCODE < ZERO                                      14060066
140700         WHEN SQLCODE > ZERO                                      14070066
140800             MOVE DK-ORD-NBR            TO PV-DISP-PO             14080066
140900             MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR           14090067
141000             DISPLAY 'ERROR PO-NBR=  '     PV-DISP-PO             14100067
141100             DISPLAY '      SEQ-NBR= '     PV-DISP-RCVR           14110079
141200             DISPLAY '      OPER-ID= '     PC081-CURRENT-OPER     14120079
141300             PERFORM 9100-SQL-ABEND                               14130066
141400     END-EVALUATE.                                                14140066
141500                                                                  14150066
141600******************************************************************14160075
141700*  SELECT THE TDISTHD TABLE.                                      14170075
141800******************************************************************14180075
141900 6600-SELECT-TDISTHD.                                             14190075
142000                                                                  14200075
142100     MOVE '6600-SELECT-TDISTHD'    TO PV-ABEND-PARAGRAPH.         14210075
142200     MOVE 'GET INFO FROM TDISTHD'  TO PV-DB2-OPERATION-ATTEMPTED. 14220075
142300                                                                  14230075
142400     INITIALIZE DCLTDISTHD.                                       14240075
142500                                                                  14250075
142600     EXEC SQL                                                     14260075
142700         SELECT SUM(FCSE_CART_CNT)                                14270075
142800               ,SUM(P2L_CART_CNT)                                 14280075
142900           INTO :DISTHD-FCSE-CART-CNT                             14290075
143000               ,:DISTHD-P2L-CART-CNT                              14300075
143100           FROM TDISTHD                                           14310075
143200          WHERE ORD_NBR      = :DK-ORD-NBR                        14320075
143300            AND RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                    14330075
143400            AND TOT_CART_CNT > 0                                  14340075
143500           WITH UR                                                14350079
143600     END-EXEC.                                                    14360075
143700                                                                  14370075
143800     EVALUATE TRUE                                                14380075
143900         WHEN SQLCODE = ZERO                                      14390075
144000             PERFORM 6610-SELECT-TDISTHD-CONT                     14400075
144100                                                                  14410075
144200         WHEN SQLCODE = +100                                      14420075
144300             MOVE 'N'                   TO PC081-PROCESS-CODE     14430075
144400                                                                  14440075
144500         WHEN SQLWARN0 NOT = SPACE                                14450075
144600         WHEN SQLCODE < ZERO                                      14460075
144700         WHEN SQLCODE > ZERO                                      14470075
144800             MOVE DK-ORD-NBR            TO PV-DISP-PO             14480075
144900             MOVE DK-REC-SEQ-NBR        TO PV-DISP-RCVR           14490075
145000             DISPLAY 'ERROR PO-NBR=  '     PV-DISP-PO             14500075
145100             DISPLAY '      SEQ-NBR= '     PV-DISP-RCVR           14510079
145200             DISPLAY '      OPER-ID= '     PC081-CURRENT-OPER     14520079
145300             PERFORM 9100-SQL-ABEND                               14530075
145400     END-EVALUATE.                                                14540075
145500                                                                  14550075
145600******************************************************************14560075
145700 6610-SELECT-TDISTHD-CONT.                                        14570075
145800                                                                  14580075
145900     EVALUATE TRUE                                                14590075
146000         WHEN DISTHD-FCSE-CART-CNT > 0                            14600075
146100          AND DISTHD-P2L-CART-CNT  > 0                            14610075
146200             MOVE 'D' TO PC081-PROCESS-CODE                       14620075
146300                                                                  14630075
146400         WHEN DISTHD-FCSE-CART-CNT = 0                            14640075
146500          AND DISTHD-P2L-CART-CNT  > 0                            14650075
146600             MOVE 'C' TO PC081-PROCESS-CODE                       14660075
146700                                                                  14670075
146800         WHEN DISTHD-FCSE-CART-CNT > 0                            14680075
146900          AND DISTHD-P2L-CART-CNT  = 0                            14690075
147000             MOVE 'B' TO PC081-PROCESS-CODE                       14700075
147100                                                                  14710075
147200         WHEN DISTHD-FCSE-CART-CNT = 0                            14720075
147300          AND DISTHD-P2L-CART-CNT  = 0                            14730075
147400             MOVE 'N' TO PC081-PROCESS-CODE                       14740075
147500                                                                  14750075
147600         WHEN OTHER                                               14760075
147700             CONTINUE                                             14770075
147800                                                                  14780075
147900     END-EVALUATE.                                                14790075
148000                                                                  14800075
148100******************************************************************14810067
148200 7010-GET-TPURCHS-INFO.                                           14820067
148300                                                                  14830067
148400     MOVE '7010-GET-TPURCHS-INFO'  TO PV-ABEND-PARAGRAPH.         14840067
148500     MOVE 'GET INFO FROM TPURCHS'  TO PV-DB2-OPERATION-ATTEMPTED. 14850067
148600                                                                  14860067
148700     INITIALIZE DCLTPURCHS.                                       14870067
148800                                                                  14880067
148900     EXEC SQL                                                     14890067
149000         SELECT  DEPT_NBR                                         14900067
149100                ,ENT_ID                                           14910067
149200                ,SEASET_SHRT_NM                                   14920067
149300           INTO  :PURCHS-DEPT-NBR                                 14930067
149400                ,:PURCHS-ENT-ID                                   14940067
149500                ,:PURCHS-SEASET-SHRT-NM                           14950067
149600           FROM TPURCHS                                           14960067
149700          WHERE PO_NBR         = :DK-ORD-NBR                      14970067
149800            AND VER_STATUS_CDE = :PC-A                            14980067
149900           WITH UR                                                14990067
150000     END-EXEC.                                                    15000067
150100                                                                  15010067
150200     EVALUATE TRUE                                                15020067
150300         WHEN SQLCODE = +0                                        15030067
150400         WHEN SQLCODE = -811                                      15040067
150500             CONTINUE                                             15050067
150600                                                                  15060067
150700         WHEN SQLCODE = +100                                      15070067
150800         WHEN SQLWARN0 NOT = SPACE                                15080067
150900         WHEN SQLCODE < ZERO                                      15090067
151000         WHEN SQLCODE > ZERO                                      15100067
151100             MOVE DK-ORD-NBR            TO PV-DISP-PO             15110067
151200             DISPLAY 'ERROR PO-NBR= '      PV-DISP-PO             15120067
151300             DISPLAY '     OPER-ID= '      PC081-CURRENT-OPER     15130079
151400             PERFORM 9100-SQL-ABEND                               15140067
151500     END-EVALUATE.                                                15150067
151600                                                                  15160067
151700******************************************************************15170028
151800 7020-GET-PRIMARY-VNDR-NME.                                       15180066
151900                                                                  15190028
152000     MOVE '7020-GET-PRIMARY-VNDR-NME'                             15200066
152100                                    TO PV-ABEND-PARAGRAPH.        15210029
152200     MOVE 'SELECT PRIMARY VNDR NAME'                              15220000
152300                                    TO PV-DB2-OPERATION-ATTEMPTED.15230029
152400                                                                  15240000
152500     INITIALIZE DCLTENTNME.                                       15250000
152600                                                                  15260000
152700     EXEC SQL                                                     15270000
152800         SELECT ENT_NAME_DESC                                     15280031
152900           INTO :ENTNME-ENT-NAME-DESC                             15290031
153000           FROM TENTNME                                           15300031
153100          WHERE ENT_ID    = :PURCHS-ENT-ID                        15310036
153200            AND TYPE_CDE  = '01'                                  15320036
153300           WITH UR                                                15330079
153400     END-EXEC.                                                    15340000
153500                                                                  15350000
153600     EVALUATE TRUE                                                15360000
153700         WHEN SQLCODE = +0                                        15370046
153800             MOVE ENTNME-ENT-NAME-DESC TO PC081-VNDR-NME          15380036
153900                                                                  15390029
154000         WHEN SQLCODE = +100                                      15400000
154100             MOVE SPACES               TO PC081-VNDR-NME          15410036
154200                                                                  15420029
154300         WHEN SQLWARN0 NOT = SPACE                                15430000
154400         WHEN SQLCODE < ZERO                                      15440000
154500         WHEN SQLCODE > ZERO                                      15450000
154600             MOVE PURCHS-ENT-ID        TO PV-DISPLAY-ENT-ID       15460038
154700             DISPLAY 'ERROR ENT-ID= '     PV-DISPLAY-ENT-ID       15470038
154800             DISPLAY '     OPER-ID= '      PC081-CURRENT-OPER     15480079
154900             PERFORM 9100-SQL-ABEND                               15490000
155000     END-EVALUATE.                                                15500000
155100                                                                  15510000
155200******************************************************************15520052
155300* 9000-EOJ-ROUTINE.                                               15530052
155400*       - DISPLAY PROGRAM TOTALS                                  15540052
155500*       - CLOSE THE CURSOR                                        15550052
155600*       - CLOSE THE OUTPUT FILE                                   15560052
155700******************************************************************15570052
155800 9000-EOJ-ROUTINE.                                                15580052
155900                                                                  15590052
156000     DISPLAY ' '.                                                 15600052
156100     DISPLAY '    ** PROGRAM TOTALS **'.                          15610052
156200                                                                  15620052
156300     MOVE PA-READ-COUNT                       TO PV-DISP-DEC.     15630060
156400     DISPLAY ' DRIVER CURSOR RECS READ = '       PV-DISP-DEC.     15640060
156500     MOVE PA-WRITE-COUNT                      TO PV-DISP-DEC.     15650060
156600     DISPLAY ' OUTPUT RECORDS WROTE    = '       PV-DISP-DEC.     15660077
156700     DISPLAY ' '.                                                 15670052
156800                                                                  15680052
156900     PERFORM 5200-CLOSE-DRIVER-CSR.                               15690060
157000                                                                  15700052
157100     CLOSE EXTRACT-FILE.                                          15710052
157200                                                                  15720052
157300******************************************************************15730000
157400*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    15740000
157500*  ERROR OR WARNING CODE OCCURS.                                  15750000
157600******************************************************************15760000
157700 9100-SQL-ABEND.                                                  15770000
157800                                                                  15780028
157900     DISPLAY '9100-SQL-ABEND'.                                    15790000
158000     DISPLAY '** ABEND     **'.                                   15800000
158100     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        15810000
158200     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             15820000
158300     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     15830000
158400                                                                  15840000
158500******************************************************************15850000
158600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    15860000
158700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         15870000
158800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     15880000
158900* FORMAT.                                                         15890000
159000******************************************************************15900000
159100     COPY DPPD004.                                                15910000
159200                                                                  15920000
159300     MOVE +4013                  TO ABEND-CODE.                   15930000
159400     CALL 'ILBOABN0' USING ABEND-CODE.                            15940000
159500                                                                  15950016
159600* PROCEDURE DIVISION CODE FOR CALCULATING THE OTB INFORMATION     15960016
159700     COPY POPD055.                                                15970016
159800                                                                  15980016
