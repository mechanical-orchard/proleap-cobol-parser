       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.             DAKRP104.                                00030035
       DATE-WRITTEN.           07/20/2000.                              00060001
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ***************************************************************** 00090000
      *PURPOSE:                                                         00100018
      *    DEBIT ALLOWANCE TRANSACTION ERROR REPORT SORTED BY BUYOR.    00110018
      ***************************************************************** 00140000
                                                                        00150001
       ENVIRONMENT DIVISION.                                            00170000
       CONFIGURATION SECTION.                                           00190000
       SOURCE-COMPUTER.  IBM-3090.                                      00210018
       OBJECT-COMPUTER.  IBM-3090.                                      00220018
                                                                        00230001
       INPUT-OUTPUT SECTION.                                            00240000
       FILE-CONTROL.                                                    00260000
                                                                        00270000
           SELECT  DEBIT-ALLOWANCE                                      00280000
               ASSIGN TO INP01.                                         00290000
                                                                        00300000
           SELECT  REPORT-FILE                                          00310000
               ASSIGN RPT01.                                            00320000
                                                                        00330000
       DATA DIVISION.                                                   00350000
       FILE SECTION.                                                    00380000
                                                                        00390001
       FD  DEBIT-ALLOWANCE                                              00400000
           LABEL RECORDS ARE STANDARD                                   00410000
           RECORDING MODE IS F                                          00420000
           BLOCK CONTAINS 0 RECORDS.                                    00430000
       01  DEBIT-ALLOW-REC               PIC X(120).                    00440050
                                                                        00450000
       FD  REPORT-FILE                                                  00460000
           RECORDING MODE F                                             00470000
           LABEL RECORDS OMITTED                                        00480000
           BLOCK CONTAINS  0 RECORDS.                                   00490000
       01  REPORT-RECORD.                                               00500000
           05  REPORT-LINE               PIC X(132).                    00510000
                                                                        00530000
      /**************************************************************** 00540002
       WORKING-STORAGE SECTION.                                         00550000
      ***************************************************************** 00551001
                                                                        00560000
       01  ABEND-CODE                PIC S9(04) VALUE ZERO COMP SYNC.   00561001
                                                                        00563000
       01  PA-PROGRAM-ACCUMULATORS.                                     00564000
           05  PA-LINE-COUNT         PIC S9(03)    COMP-3 VALUE 0.      00565000
           05  PA-LINE-NO            PIC S9(03)    COMP-3 VALUE 0.      00566000
           05  PA-PAGE-COUNT         PIC S9(05)    COMP-3 VALUE 0.      00567000
           05  PA-IN-COUNT           PIC S9(09)    COMP-3 VALUE 0.      00568000
           05  PA-TOTAL-READ         PIC S9(09)    COMP-3 VALUE 0.      00569000
           05  PA-TOTAL-WRITTEN      PIC S9(09)    COMP-3 VALUE 0.      00570001
                                                                        00650000
       01  PC-CONSTANTS.                                                00660000
           05  PC-OPERCO-NBR         PIC  X(02) VALUE '03'.             00670000
           05  PC-MDSELV-DPT         PIC  X(03) VALUE 'DPT'.            00680000
           05  PC-DAK002-JOB         PIC  X(06) VALUE 'DAK002'.         00690035
           05  PC-DAKRP104-PGM       PIC  X(08) VALUE 'DAKRP104'.       00700035
           05  PC-NO-INPUT-MSG.                                         00730012
               10  FILLER            PIC X(47)  VALUE SPACES.           00731048
               10  FILLER            PIC X(41)  VALUE                   00732048
               '** NO DA INPUT -- REPORT WILL BE EMPTY **'.             00741048
           05  PC-END-RPT-MSG.                                          00750012
               10  FILLER            PIC X(54)  VALUE SPACES.           00750120
               10  FILLER            PIC X(27)  VALUE                   00751016
               '* * *  END OF REPORT  * * *'.                           00760012
           05  PC-MAX-LINES          PIC S9(03)  VALUE 65.              00770036
           05  PC-MAX-SUBTOTAL-LINES PIC S9(03)  VALUE 54.              00771042
           05  PC-MAX-GRTOTAL-LINES  PIC S9(03)  VALUE 58.              00772041
                                                                        00780000
       01  PS-SWITCHES.                                                 00790000
           05  PS-EOF-EXTRACT-SWITCH PIC X(01) VALUE 'N'.               00800002
               88  PS-EOF-EXTRACT              VALUE 'Y'.               00810002
                                                                        00820000
       01  PV-VARIABLES.                                                00830000
           05  PV-BYR-NBR            PIC X(03)     VALUE SPACES.        00830106
           05  PV-BYR-LAST-NAME      PIC X(18)     VALUE SPACES.        00831006
           05  PV-BYR-FIRST-NAME     PIC X(12)     VALUE SPACES.        00840006
           05  PV-RUN-TIME           PIC X(08)     VALUE SPACES.        00860000
           05  PV-RUN-DATE           PIC X(10)     VALUE SPACES.        00870000
           05  PV-PARAGRAPH          PIC X(30)     VALUE SPACES.        00880000
           05  PV-OPERATION-ATTEMPTED  PIC X(40)   VALUE SPACES.        00890002
           05  PV-ABEND-MESSAGE        PIC X(75)   VALUE SPACES.        00900002
           05  PV-EFF-DTE-TIME       PIC X(26)     VALUE SPACES.        00950105
           05  PV-EFF-DTE-TIME-RED REDEFINES                            00950205
               PV-EFF-DTE-TIME.                                         00950305
               10  PV-EFF-DTE        PIC X(10).                         00950406
               10  PV-EFF-TIME       PIC X(16).                         00950506
                                                                        00990000
       01  H2-HEADING2.                                                 01110000
           05  FILLER                PIC X(47) VALUE SPACES.            01120012
           05  FILLER                PIC X(40) VALUE                    01130000
           '  DEBIT ALLOWANCE TRANSACTION ERRORS '.                     01140001
           05  FILLER                PIC X(23) VALUE SPACES.            01150012
           05  FILLER                PIC X(05) VALUE 'JOB: '.           01160000
           05  H2-JOB-NAME           PIC X(06) VALUE SPACES.            01170000
                                                                        01180000
       01  H3-HEADING3.                                                 01190000
           05  FILLER                PIC X(02) VALUE SPACES.            01200001
           05  FILLER                PIC X(07) VALUE 'BUYER: '.         01210001
           05  H3-BUYER-NAME         PIC X(38) VALUE SPACES.            01220012
           05  FILLER                PIC X(31) VALUE SPACES.            01230012
                                                                        01240000
       01  H4-HEADING4.                                                 01250000
           05  FILLER                PIC X(02) VALUE SPACES.            01340000
           05  FILLER                PIC X(04) VALUE 'DEPT'.            01350001
           05  FILLER                PIC X(05) VALUE SPACES.            01360001
           05  FILLER                PIC X(05) VALUE 'CLASS'.           01370007
           05  FILLER                PIC X(03) VALUE SPACES.            01390007
           05  FILLER                PIC X(14) VALUE 'EFFECTIVE DATE'.  01400001
           05  FILLER                PIC X(05) VALUE SPACES.            01410001
           05  FILLER                PIC X(15) VALUE 'DEBIT ALLOWANCE'. 01420001
           05  FILLER                PIC X(02) VALUE SPACES.            01430007
           05  FILLER                PIC X(13) VALUE 'ERROR MESSAGE'.   01431001
                                                                        01440000
       01  DL1-DETAIL-LINE-1.                                           01450000
           05  FILLER                PIC X(02) VALUE SPACES.            01451002
           05  DL1-DEPT              PIC X(03).                         01452002
           05  FILLER                PIC X(06) VALUE SPACES.            01453002
           05  DL1-CLASS             PIC X(02).                         01454002
           05  FILLER                PIC X(06) VALUE SPACES.            01455002
           05  DL1-EFF-DATE          PIC X(10).                         01456002
           05  FILLER                PIC X(09) VALUE SPACES.            01457002
           05  DL1-DEBIT-ALLOW       PIC X(16).                         01458002
           05  FILLER                PIC X(01) VALUE SPACES.            01459002
           05  DL1-ERR-MESSAGE       PIC X(40).                         01459102
                                                                        01550000
       01  TL1-TOTAL-LINE-1.                                            01560000
           05  FILLER                PIC X(02)     VALUE SPACES.        01570000
           05  TL1-DESC              PIC X(40)     VALUE SPACES.        01580002
           05  FILLER                PIC X(05)     VALUE SPACES.        01590002
           05  TL1-COUNT             PIC Z,ZZZ,ZZZ,ZZZ.                 01600025
                                                                        01640000
       01  ERR-NDX                   PIC S9(05) COMP VALUE ZEROS.       01640102
       01  BYR-NDX                   PIC S9(05) COMP VALUE ZEROS.       01640202
                                                                        01640302
       01  WS-ERR-MESSAGE-TABLE.                                        01641002
           05  WS-BUYER-ELEMENTS      OCCURS 1001 TIMES.                01642102
               10  WS-ERROR-ELEMENTS  OCCURS 50 TIMES.                  01642202
                   15  WS-ERR-BYR     PIC X(03)       VALUE SPACES.     01642302
                   15  WS-ERR-DESCRIP PIC X(40)       VALUE SPACES.     01643002
                   15  WS-ERR-COUNT   PIC S9(13) COMP VALUE ZEROS.      01644002
                                                                        01645002
      ***************************************************************** 01650000
      *  INPUT DEBIT ALLOWANCE RECORD LAYOUT                            01660001
      ***************************************************************** 01670000
           COPY DARD103.                                                01680035
                                                                        01690000
      ***************************************************************** 01691001
      *  KOHL'S STANDARD FIRST HEADING LINE                             01692001
      ***************************************************************** 01693001
           COPY DPWS132O.                                               01694002
                                                                        01695001
      /**************************************************************** 01872102
      *FLOW:    SEQUENTIALLY READ THE DA ARI EXTRACT FILE BREAKING ON   01872218
      *      A BUYOR NUMBER, LAST NAME, OR FIRST NAME CHANGE. CREATE    01872327
      *      SUB TOTALS WHICH SUMMARIZE THE BUYOR'S DA ERRORS BY ERROR  01872418
      *      MESSAGE. THE SUB TOTAL WILL REFLECT A COUNT AS WELL.       01872518
      *      RESET THE REPORT FOR THE NEXT BUYOR.                       01872627
      *         AT END OF FILE, CREATE GRAND TOTALS LINES WHICH SUMM    01872827
      *      THE ERROR MESSAGE FOUND IN THE REPORT. PROVIDE TOTALS FOR  01872918
      *      EACH ERROR AND A GRAND TOTAL SUMMARY PAGE.                 01873027
      *         ERROR COUNTS ARE ACCUMULATED IN A TWO DIMENSIONAL TABLE 01873218
      *      BY BUYOR AND ERROR. THE FINAL ELEMENT, AT THE BUYOR LEVEL, 01873327
      *      CONTAINS THE GRAND TOTALS.                                 01873427
      *                                                                 01873718
      ***************************************************************** 01873801
      ***************************************************************** 01873902
       PROCEDURE DIVISION.                                              01874000
      ***************************************************************** 01874101
       0000-MAIN-DRIVER-SECTION.                                        01875022
                                                                        01876022
           PERFORM 1000-INITIALIZE                                      01877000
              THRU 1000-INITIALIZE-EXIT.                                01877102
                                                                        01878000
           PERFORM 2000-PROCESS-MAIN-LOOP                               01879002
              THRU 2000-PROCESS-MAIN-LOOP-EXIT                          01879102
                UNTIL PS-EOF-EXTRACT.                                   01880002
                                                                        01890000
           PERFORM 9000-EOJ-TASKS                                       01900002
              THRU 9000-EOJ-TASKS-EXIT.                                 01901002
                                                                        01910000
       9999-EXIT-PROGRAM.                                               01911001
           STOP RUN.                                                    01920001
                                                                        01940000
      /**************************************************************** 01941002
      * 1000-INITIALIZATION ROUTINE.                                    01941102
      ***************************************************************** 01942002
       1000-INITIALIZE.                                                 01950000
                                                                        01960000
           OPEN INPUT  DEBIT-ALLOWANCE                                  01970000
           OPEN OUTPUT REPORT-FILE.                                     01980000
                                                                        01990000
           MOVE FUNCTION CURRENT-DATE (3:2)  TO DP132O-RUN-YEAR.        02011131
           MOVE FUNCTION CURRENT-DATE (5:2)  TO DP132O-RUN-MONTH.       02011231
           MOVE FUNCTION CURRENT-DATE (7:2)  TO DP132O-RUN-DAY.         02011331
           MOVE FUNCTION CURRENT-DATE (9:2)  TO DP132O-RUN-HOUR.        02011431
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP132O-RUN-MINUTE.      02012031
           MOVE PC-DAKRP104-PGM    TO DP132O-PROGRAM-NAME.              02070035
           MOVE 1                  TO DP132O-REPORT-NUMBER.             02080004
                                                                        02090000
           PERFORM 4000-WRITE-REPORT-HEADING                            02100002
              THRU 4000-WRITE-REPORT-HEADING-EXIT.                      02101002
                                                                        02102002
           PERFORM 8000-READ-EXTRACT                                    02160302
              THRU 8000-READ-EXTRACT-EXIT.                              02160402
                                                                        02160502
           IF PS-EOF-EXTRACT                                            02160602
               DISPLAY 'NO DA INPUT -- REPORT WILL BE EMPTY'            02160802
           ELSE                                                         02161002
               MOVE DA103-BYR-NBR        TO PV-BYR-NBR                  02161243
               MOVE DA103-BYR-LAST-NAME  TO PV-BYR-LAST-NAME            02161343
               MOVE DA103-BYR-FIRST-NAME TO PV-BYR-FIRST-NAME           02161443
               PERFORM 4200-SUB-HEADINGS                                02161502
                  THRU 4200-SUB-HEADINGS-EXIT                           02161602
           END-IF.                                                      02161702
                                                                        02161802
           INITIALIZE WS-ERR-MESSAGE-TABLE.                             02161907
                                                                        02162007
       1000-INITIALIZE-EXIT.                                            02162102
           EXIT.                                                        02162202
                                                                        02162302
      /**************************************************************** 02163002
      * 2000-MAIN PROCESS LOOP...                                       02164002
      *   LOOP THROUGH THE SORTED DA ARI EXTRACT FILE. BREAK WHEN THE   02164127
      * BUYER NUMBER, LAST NAME, OR FIRST NAME CHANGES. SUB TOTAL FOR   02164212
      * THE BUYER PROVIDING A SUMMARIZED LIST OF WHAT ERRORS THEY HAD.  02164312
      * READ THE NEXT DA ARI EXTRACT FILE RECORD.                       02164412
      ***************************************************************** 02165002
       2000-PROCESS-MAIN-LOOP.                                          02170002
                                                                        02180000
           IF DA103-BYR-NBR NOT EQUAL PV-BYR-NBR              OR        02190035
              DA103-BYR-LAST-NAME NOT EQUAL PV-BYR-LAST-NAME  OR        02191035
              DA103-BYR-FIRST-NAME NOT EQUAL PV-BYR-FIRST-NAME          02192035
               PERFORM 3200-BUYOR-TOTALS                                02192427
                  THRU 3200-BUYOR-TOTALS-EXIT                           02192527
               MOVE DA103-BYR-NBR        TO PV-BYR-NBR                  02192643
               MOVE DA103-BYR-LAST-NAME  TO PV-BYR-LAST-NAME            02192743
               MOVE DA103-BYR-FIRST-NAME TO PV-BYR-FIRST-NAME           02192843
               PERFORM 4200-SUB-HEADINGS                                02230000
                  THRU 4200-SUB-HEADINGS-EXIT                           02230102
           END-IF.                                                      02240000
                                                                        02250000
           MOVE DA103-DEPT-NBR      TO DL1-DEPT.                        02291035
           MOVE DA103-SUB-CL-NBR    TO DL1-CLASS.                       02293035
           MOVE DA103-EFF-DTE       TO DL1-EFF-DATE.                    02295035
           MOVE DA103-DR-ALW-NBR    TO DL1-DEBIT-ALLOW.                 02297035
           MOVE DA103-ERR-MSG-TXT   TO DL1-ERR-MESSAGE.                 02299035
           PERFORM 5000-WRITE-REPORT-LINE                               02380002
              THRU 5000-WRITE-REPORT-LINE-EXIT.                         02380102
                                                                        02381002
           MOVE 1                   TO BYR-NDX.                         02381102
           MOVE 1                   TO ERR-NDX.                         02381202
           PERFORM 3000-ACCUM-ERR-MESSAGES                              02382002
              THRU 3000-ACCUM-ERR-MESSAGES-EXIT                         02383002
                VARYING BYR-NDX FROM 1 BY 1                             02384002
                  UNTIL BYR-NDX IS GREATER THAN 1000.                   02385002
                                                                        02386002
           MOVE 1                   TO ERR-NDX.                         02388021
           PERFORM 3100-ACCUM-GR-TOTAL                                  02389021
              THRU 3100-ACCUM-GR-TOTAL-EXIT                             02389123
                VARYING ERR-NDX FROM 1 BY 1                             02389221
                  UNTIL ERR-NDX IS GREATER THAN 50.                     02389321
                                                                        02389421
           PERFORM 8000-READ-EXTRACT                                    02390006
              THRU 8000-READ-EXTRACT-EXIT.                              02391002
                                                                        02400000
       2000-PROCESS-MAIN-LOOP-EXIT.                                     02410002
           EXIT.                                                        02410102
                                                                        02410202
      /*****************************************************************02410302
      * 3000-ACCUMULATE ERROR MESSAGE TOTALS FOR TOTAL UP....           02410402
      *   A TWO DIMENSIONAL TABLE IS USED, BUYOR AND ERROR, FOR TOTALING02410512
      * UP FOR EACH BUYOR. AT THIS TIKME, ELEMENT 1001 IS USED TO TOTAL 02410612
      * UP FOR "ALL" BUYORS. THE INFORMATION STORED IN THE TABLE IS USED02410712
      * IN THE 5400- AND 5600- ROUTINES.                                02410812
      ******************************************************************02410902
       3000-ACCUM-ERR-MESSAGES.                                         02411002
                                                                        02411102
           IF WS-ERR-BYR (BYR-NDX, ERR-NDX) EQUAL DA103-BYR-NBR         02411235
             IF WS-ERR-DESCRIP (BYR-NDX, ERR-NDX)                       02411302
                             IS EQUAL TO DA103-ERR-MSG-TXT              02411435
               ADD 1         TO WS-ERR-COUNT (BYR-NDX, ERR-NDX)         02411502
               MOVE 9999     TO BYR-NDX                                 02411702
             ELSE                                                       02411802
             IF WS-ERR-DESCRIP (BYR-NDX, ERR-NDX) EQUAL SPACES          02411902
               MOVE DA103-ERR-MSG-TXT                                   02412035
                             TO WS-ERR-DESCRIP (BYR-NDX, ERR-NDX)       02412102
               MOVE 1        TO WS-ERR-COUNT (BYR-NDX, ERR-NDX)         02412302
               MOVE 9999     TO BYR-NDX                                 02412502
             ELSE                                                       02412602
               ADD 1         TO ERR-NDX                                 02412702
               GO TO 3000-ACCUM-ERR-MESSAGES                            02412802
           ELSE                                                         02412902
             MOVE DA103-BYR-NBR TO WS-ERR-BYR (BYR-NDX, ERR-NDX)        02413035
             MOVE DA103-ERR-MSG-TXT TO WS-ERR-DESCRIP (BYR-NDX, ERR-NDX)02413235
             MOVE 1          TO WS-ERR-COUNT (BYR-NDX, ERR-NDX)         02413402
           END-IF.                                                      02414702
                                                                        02414802
           MOVE 1            TO ERR-NDX.                                02414902
                                                                        02415002
       3000-ACCUM-ERR-MESSAGES-EXIT.                                    02415102
           EXIT.                                                        02415202
                                                                        02415302
      /*****************************************************************02415421
      * 3100-ACCUM ERROR MESSAGE GRAND TOTALS FOR THE EOF.              02415521
      ******************************************************************02416021
       3100-ACCUM-GR-TOTAL.                                             02416121
                                                                        02416221
           IF WS-ERR-DESCRIP (1001, ERR-NDX) EQUAL DA103-ERR-MSG-TXT    02416435
               ADD 1         TO WS-ERR-COUNT (1001, ERR-NDX)            02416721
               MOVE 99       TO ERR-NDX                                 02416821
           END-IF.                                                      02416921
                                                                        02417021
           IF WS-ERR-DESCRIP (1001, ERR-NDX) EQUAL SPACES               02417121
               MOVE DA103-ERR-MSG-TXT TO WS-ERR-DESCRIP (1001, ERR-NDX) 02417235
               ADD 1         TO WS-ERR-COUNT (1001, ERR-NDX)            02417521
               MOVE 99       TO ERR-NDX                                 02417621
           END-IF.                                                      02417721
                                                                        02419721
       3100-ACCUM-GR-TOTAL-EXIT.                                        02419821
           EXIT.                                                        02419921
                                                                        02420021
      ******************************************************************02420127
      * 3200-BUYOR SUB TOTAL GENERATION..                               02420227
      ******************************************************************02420327
       3200-BUYOR-TOTALS.                                               02420427
                                                                        02420527
           IF PA-LINE-NO IS GREATER THAN PC-MAX-SUBTOTAL-LINES          02420641
               PERFORM 4000-WRITE-REPORT-HEADING                        02420741
                  THRU 4000-WRITE-REPORT-HEADING-EXIT                   02420841
               PERFORM 4200-SUB-HEADINGS                                02420942
                  THRU 4200-SUB-HEADINGS-EXIT                           02421042
           END-IF.                                                      02421441
                                                                        02421541
           MOVE ZEROS               TO PA-TOTAL-WRITTEN.                02421627
           MOVE 'ERROR SUMMARY:'    TO TL1-DESC.                        02421727
           MOVE ZEROS               TO TL1-COUNT.                       02421827
           WRITE REPORT-RECORD      FROM TL1-TOTAL-LINE-1               02421927
               AFTER ADVANCING 2 LINES.                                 02422027
           ADD 2                    TO PA-LINE-NO.                      02422127
                                                                        02422227
           MOVE 1                   TO BYR-NDX.                         02422327
           MOVE 1                   TO ERR-NDX.                         02422427
           PERFORM 5400-WRITE-BUYOR-TOTALS                              02422527
              THRU 5400-WRITE-BUYOR-TOTALS-EXIT                         02422627
                VARYING BYR-NDX FROM 1 BY 1                             02422727
                  UNTIL BYR-NDX IS GREATER THAN 1000.                   02422827
                                                                        02422927
           MOVE 'BUYOR TOTAL:'      TO TL1-DESC.                        02423027
           MOVE PA-TOTAL-WRITTEN    TO TL1-COUNT.                       02423127
           WRITE REPORT-RECORD      FROM TL1-TOTAL-LINE-1               02423227
               AFTER ADVANCING 3 LINES.                                 02423327
                                                                        02423427
           PERFORM 4000-WRITE-REPORT-HEADING                            02423527
              THRU 4000-WRITE-REPORT-HEADING-EXIT.                      02423627
                                                                        02423727
       3200-BUYOR-TOTALS-EXIT.                                          02423827
           EXIT.                                                        02423927
                                                                        02424027
      ***************************************************************** 02424128
      * 3300-GRAND TOTAL PAGE GENERATION...                             02424228
      ***************************************************************** 02424328
       3300-GRAND-TOTALS.                                               02424427
                                                                        02424527
           IF PA-LINE-NO IS GREATER THAN PC-MAX-SUBTOTAL-LINES          02424641
               PERFORM 4000-WRITE-REPORT-HEADING                        02424741
                  THRU 4000-WRITE-REPORT-HEADING-EXIT                   02424841
           END-IF.                                                      02424941
                                                                        02425041
           MOVE ZEROS             TO PA-TOTAL-WRITTEN.                  02425127
           MOVE 'TOTAL PAGE:'     TO TL1-DESC.                          02425227
           MOVE PA-TOTAL-WRITTEN  TO TL1-COUNT.                         02425327
           WRITE REPORT-RECORD    FROM TL1-TOTAL-LINE-1                 02425427
                   AFTER ADVANCING 2 LINES.                             02425527
           ADD 2                  TO PA-LINE-NO.                        02425641
                                                                        02425727
           PERFORM 5600-WRITE-RPT-TOTALS                                02425827
              THRU 5600-WRITE-RPT-TOTALS-EXIT                           02425927
                VARYING ERR-NDX FROM 1 BY 1                             02426027
                  UNTIL ERR-NDX IS GREATER THAN 50.                     02426127
                                                                        02426227
           MOVE 'GRAND TOTAL:'    TO TL1-DESC.                          02426327
           MOVE PA-TOTAL-WRITTEN  TO TL1-COUNT.                         02426427
           WRITE REPORT-RECORD    FROM TL1-TOTAL-LINE-1                 02426527
               AFTER ADVANCING 3 LINES.                                 02426627
                                                                        02426727
       3300-GRAND-TOTALS-EXIT.                                          02426827
           EXIT.                                                        02426927
                                                                        02427027
      /*****************************************************************02427102
      * 4000-WRITE THE REPORT HEADING LINES.                            02427202
      ******************************************************************02428002
       4000-WRITE-REPORT-HEADING.                                       02430000
                                                                        02470000
           ADD 1                    TO PA-PAGE-COUNT.                   02480038
           MOVE PA-PAGE-COUNT       TO DP132O-PAGE-NUMBER.              02510002
           WRITE REPORT-RECORD  FROM DP132O-STANDRD-HEADER-132-COLS     02530006
                   AFTER ADVANCING PAGE.                                02540000
                                                                        02550000
           MOVE PC-DAK002-JOB       TO H2-JOB-NAME.                     02560035
           WRITE REPORT-RECORD      FROM H2-HEADING2                    02580002
                   AFTER ADVANCING 1 LINE.                              02590000
                                                                        02600000
           MOVE 2                   TO PA-LINE-NO.                      02660002
                                                                        02661002
       4000-WRITE-REPORT-HEADING-EXIT.                                  02661102
           EXIT.                                                        02661202
                                                                        02661302
      ******************************************************************02662002
      * 4200-WRITE THE REPORT SUB HEADING LINES.                        02663002
      ******************************************************************02664002
       4200-SUB-HEADINGS.                                               02670000
                                                                        02680000
           STRING PV-BYR-NBR DELIMITED BY SIZE                          02730043
                  ' - ' DELIMITED BY SIZE                               02740012
                  PV-BYR-LAST-NAME DELIMITED BY ' '                     02750043
                  ', ' DELIMITED BY SIZE                                02760002
                  PV-BYR-FIRST-NAME DELIMITED BY SIZE                   02770043
                               INTO H3-BUYER-NAME.                      02780002
                                                                        02790002
           WRITE REPORT-RECORD FROM H3-HEADING3                         02800002
               AFTER ADVANCING 2 LINES.                                 02810002
                                                                        02820002
           WRITE REPORT-RECORD FROM H4-HEADING4                         02821002
               AFTER ADVANCING 2 LINES.                                 02822002
                                                                        02823002
           ADD 4               TO PA-LINE-NO.                           02850202
                                                                        02850302
       4200-SUB-HEADINGS-EXIT.                                          02850402
           EXIT.                                                        02850502
                                                                        02850602
      /*****************************************************************02851002
      * 5000-WRITE THE REPORT DETAIL LINES.                             02852002
      ******************************************************************02853002
       5000-WRITE-REPORT-LINE.                                          02860000
                                                                        02870000
           IF PA-LINE-NO IS GREATER THAN PC-MAX-LINES                   02880002
               PERFORM 4000-WRITE-REPORT-HEADING                        02890000
                  THRU 4000-WRITE-REPORT-HEADING-EXIT                   02891002
               PERFORM 4200-SUB-HEADINGS                                02900000
                  THRU 4200-SUB-HEADINGS-EXIT                           02901002
           END-IF.                                                      02910000
                                                                        02920000
           WRITE REPORT-RECORD FROM DL1-DETAIL-LINE-1                   02930000
                  AFTER ADVANCING 1 LINES.                              02940000
           ADD 1                    TO PA-LINE-NO.                      02950002
                                                                        02960000
       5000-WRITE-REPORT-LINE-EXIT.                                     02960106
           EXIT.                                                        02960202
                                                                        02960302
      ******************************************************************02961002
      * 5400-WRITE THE REPORT TOTAL LINES.                              02962002
      ******************************************************************02963002
       5400-WRITE-BUYOR-TOTALS.                                         02970002
                                                                        02971002
XXX        IF ERR-NDX IS GREATER THAN 50                                02971145
XXX            GO TO 5400-WRITE-BUYOR-TOTALS-EXIT.                      02971245
XXX                                                                     02971345
           IF PA-LINE-NO IS GREATER THAN PC-MAX-LINES                   02971441
               PERFORM 4000-WRITE-REPORT-HEADING                        02971502
                  THRU 4000-WRITE-REPORT-HEADING-EXIT                   02971602
               PERFORM 4200-SUB-HEADINGS                                02971742
                  THRU 4200-SUB-HEADINGS-EXIT                           02971842
               MOVE 'ERROR SUMMARY:' TO TL1-DESC                        02971938
               MOVE ZEROS            TO TL1-COUNT                       02972038
               WRITE REPORT-RECORD   FROM TL1-TOTAL-LINE-1              02972138
                                     AFTER ADVANCING 2 LINES            02972239
               ADD 2                 TO PA-LINE-NO                      02972338
           END-IF.                                                      02972402
                                                                        02972502
           IF WS-ERR-BYR (BYR-NDX, ERR-NDX) EQUAL PV-BYR-NBR            02972602
             IF WS-ERR-DESCRIP (BYR-NDX, ERR-NDX) GREATER SPACES        02973002
               MOVE WS-ERR-DESCRIP (BYR-NDX, ERR-NDX) TO TL1-DESC       02974002
               MOVE WS-ERR-COUNT (BYR-NDX, ERR-NDX)   TO TL1-COUNT      02976002
               WRITE REPORT-RECORD FROM TL1-TOTAL-LINE-1                03020002
                      AFTER ADVANCING 1 LINE                            03030002
               ADD 1             TO PA-LINE-NO                          03040002
               ADD WS-ERR-COUNT (BYR-NDX, ERR-NDX) TO PA-TOTAL-WRITTEN  03040102
             END-IF                                                     03040210
             ADD 1               TO ERR-NDX                             03040310
             GO TO 5400-WRITE-BUYOR-TOTALS                              03040410
           END-IF.                                                      03040510
                                                                        03050000
       5400-WRITE-BUYOR-TOTALS-EXIT.                                    03120002
           EXIT.                                                        03120102
                                                                        03120202
      ******************************************************************03121002
      * 5600-TOTAL UP....                                               03122002
      ******************************************************************03123002
       5600-WRITE-RPT-TOTALS.                                           03130000
                                                                        03143000
           IF PA-LINE-NO IS GREATER THAN PC-MAX-GRTOTAL-LINES           03143137
               PERFORM 4000-WRITE-REPORT-HEADING                        03143202
                  THRU 4000-WRITE-REPORT-HEADING-EXIT                   03143302
               MOVE ZEROS             TO PA-TOTAL-WRITTEN               03143441
               MOVE 'TOTAL PAGE:'     TO TL1-DESC                       03143541
               MOVE PA-TOTAL-WRITTEN  TO TL1-COUNT                      03143641
               WRITE REPORT-RECORD    FROM TL1-TOTAL-LINE-1             03143741
                                      AFTER ADVANCING 2 LINES           03143841
               ADD 2                  TO PA-LINE-NO                     03143941
           END-IF.                                                      03144002
                                                                        03144102
           IF WS-ERR-DESCRIP (1001, ERR-NDX) GREATER SPACES             03144211
               MOVE WS-ERR-DESCRIP (1001, ERR-NDX) TO TL1-DESC          03144311
               MOVE WS-ERR-COUNT (1001, ERR-NDX)   TO TL1-COUNT         03144411
               WRITE REPORT-RECORD FROM TL1-TOTAL-LINE-1                03144502
                      AFTER ADVANCING 1 LINES                           03145002
               ADD 1                TO PA-LINE-NO                       03145102
               ADD WS-ERR-COUNT (1001, ERR-NDX) TO PA-TOTAL-WRITTEN.    03145211
                                                                        03146000
       5600-WRITE-RPT-TOTALS-EXIT.                                      03147002
           EXIT.                                                        03147102
                                                                        03148002
      /**************************************************************** 03461002
      * 8000-READ THE DA EXTRACT FILE...                                03462002
      ***************************************************************** 03463002
       8000-READ-EXTRACT.                                               03470000
                                                                        03471002
           READ DEBIT-ALLOWANCE INTO DA103-DA-ARI-EXTRACT-RECORD        03480035
               AT END  SET PS-EOF-EXTRACT   TO TRUE.                    03490002
                                                                        03500002
           IF (NOT PS-EOF-EXTRACT)                                      03510047
               ADD 1                TO PA-TOTAL-READ.                   03520046
                                                                        03540000
       8000-READ-EXTRACT-EXIT.                                          03541002
           EXIT.                                                        03542002
                                                                        03543002
      /************************************************************     03550002
      * 9000-EOJ-TASKS.                                                 03560002
      *************************************************************     03610000
       9000-EOJ-TASKS.                                                  03620002
                                                                        03630000
           IF PA-TOTAL-READ IS EQUAL TO ZEROS                           03640002
              WRITE REPORT-RECORD FROM PC-NO-INPUT-MSG                  03650000
                    AFTER ADVANCING 5 LINES                             03660000
           ELSE                                                         03670000
               PERFORM 3200-BUYOR-TOTALS                                03671028
                  THRU 3200-BUYOR-TOTALS-EXIT                           03672028
               PERFORM 3300-GRAND-TOTALS                                03673028
                  THRU 3300-GRAND-TOTALS-EXIT                           03674028
           END-IF.                                                      03700000
                                                                        03710000
           WRITE REPORT-RECORD FROM PC-END-RPT-MSG                      03720000
                AFTER ADVANCING 5 LINES                                 03730000
                                                                        03740000
           CLOSE DEBIT-ALLOWANCE                                        03750000
                 REPORT-FILE.                                           03760000
                                                                        03770000
       9000-EOJ-TASKS-EXIT.                                             03810102
           EXIT.                                                        03810202
