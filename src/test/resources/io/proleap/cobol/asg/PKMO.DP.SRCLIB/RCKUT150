000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.    RCKUT150.                                         00040003
000500 AUTHOR.        BRUCE GRAHAM - KFORCE.                            00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   MARCH, 2010.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000******************************************************************00100000
001100*   BATCH PROGRAM TO CONVERT THE STORE EXTRACT FILE STORE NUMBER  00110000
001200*   (SE-LOC-NBR) AND  NEW STORE NUMBER BASED UPON TABLE ENTRIES   00120000
001210*   (SE-LOC-NBR) TO A NEW STORE NUMBER BASED UPON TABLE ENTRIES   00121000
001220*   IN DB2 TABLE TKRPRPM. THE INPUT FILE MUST BE IN NUMBER ORDER. 00122000
001230*                                                                 00123000
001240*               PROGRAM FLOW:                                     00124000
001250*   1.INITIALIZATION/OPEN.                                        00125000
001260*   2.PERFORM READ OF EXTRACT FILE                                00126000
001270*       FOR EACH RECORD READ                                      00127000
001280*       A.PERFORM TKRPRPM TABLE SELECT (ONCE PER STORE NUMBER /   00128000
001290*         SE-LOC-NBR)                                             00129000
001300*       B.USE RETURNED NUMBER TO UPDATE SE-LOC-NBR WHEN           00130000
001400*         DB2 RETURN CODE IS ZEROS.                               00140000
001500*       C.WRITE OUTPUT RECORD FOR EVERY RECORD READ (CHANGED OR   00150000
001600*         NOT)                                                    00160000
001700*   3.CLOSE.                                                      00170000
001800******************************************************************00180000
001900*  CHANGE LOG                                                     00190000
002000*  DATE       CHANGED BY    DESC                                  00200000
002100*  ---------- ------------- --------------------------------------00210000
002200*  03-18-2010 B. GRAHAM - KFORCE                                  00220000
002300*                         WR 38216 EFC2 CHANGES                   00230000
002400*                         ORIGINAL CODE                           00240000
002500******************************************************************00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700 CONFIGURATION SECTION.                                           00270000
002800                                                                  00280000
002900 SOURCE-COMPUTER.        IBM-3090.                                00290000
003000 OBJECT-COMPUTER.        IBM-3090.                                00300000
003100                                                                  00310000
003200 INPUT-OUTPUT SECTION.                                            00320000
003300 FILE-CONTROL.                                                    00330000
003400                                                                  00340000
003500     SELECT STORE-EXTRACT-IN-FILE                                 00350000
003600         ASSIGN TO INP01.                                         00360000
003700                                                                  00370000
003800     SELECT STORE-EXTRACT-OUT-FILE                                00380000
003900         ASSIGN TO OUT01.                                         00390000
004000                                                                  00400000
004100                                                                  00410000
004200******************************************************************00420000
004300 DATA DIVISION.                                                   00430000
004400 FILE SECTION.                                                    00440000
004500                                                                  00450000
004600 FD  STORE-EXTRACT-IN-FILE                                        00460000
004700     RECORDING MODE IS F                                          00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     BLOCK CONTAINS 0 RECORDS.                                    00490000
005000                                                                  00500000
005100 01  STORE-EXTRACT-IN-REC            PIC  X(300).                 00510000
005200*                                                                 00520000
005300 FD  STORE-EXTRACT-OUT-FILE                                       00530000
005400     RECORDING MODE IS F                                          00540000
005500     LABEL RECORDS ARE STANDARD                                   00550000
005600     BLOCK CONTAINS 0 RECORDS.                                    00560000
005700                                                                  00570000
005800 01  STORE-EXTRACT-OUT-REC           PIC  X(300).                 00580000
005900*                                                                 00590000
006000*                                                                 00600000
006100******************************************************************00610000
006200 WORKING-STORAGE SECTION.                                         00620000
006300******************************************************************00630000
006400 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00640000
006500                                                   COMP SYNC.     00650000
006510                                                                  00651005
006520 01  DK-DB2-KEYS.                                                 00652005
006530     05  DK-PO-NBR                       PIC S9(09) COMP SYNC.    00653005
006531     05  DK-STORE-NBR                    PIC S9(04) COMP SYNC.    00653108
006540     05  DK-RCVR-NBR                     PIC S9(09) COMP SYNC.    00654005
006600                                                                  00660000
006700 01  PA-PROGRAM-ACCUMULATORS.                                     00670000
006800     05  PA-INPUT-REC-CNT            PIC S9(07)    VALUE +0       00680000
006900                                                   COMP-3.        00690000
007000     05  PA-OUTPUT-REC-CNT           PIC S9(07)    VALUE +0       00700000
007100                                                   COMP-3.        00710000
007200                                                                  00720000
007300 01  PC-PROGRAM-CONSTANTS.                                        00730000
007400     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08) VALUE 'RCKUT150'. 00740003
007500                                                                  00750000
007600 01  PS-PROGRAM-SWITCHES.                                         00760000
007700     05  PS-INPUT-AT-END-SW          PIC  X(01)    VALUE 'N'.     00770000
007800         88  PS-INPUT-AT-END-YES                   VALUE 'Y'.     00780000
007900         88  PS-INPUT-AT-END-NO                    VALUE 'N'.     00790000
007910     05  PS-RED-RDC-FOUND-SW         PIC  X(01)    VALUE 'N'.     00791011
007920         88  PS-RED-RDC-FOUND-YES                  VALUE 'Y'.     00792011
007930         88  PS-RED-RDC-FOUND-NO                   VALUE 'N'.     00793011
007940     05  PS-CS-CONVRSON-SW           PIC  X(01)    VALUE 'N'.     00794021
007950         88  PS-CS-CONVRSON-YES                    VALUE 'Y'.     00795021
007960         88  PS-CS-CONVRSON-NO                     VALUE 'N'.     00796021
008000                                                                  00800000
008100 01  PV-PROGRAM-VARIABLES.                                        00810000
008200     05  PV-HOLD-PREV-LOC-NBR        PIC S9(04)    COMP           00820000
008300                                                   VALUE ZERO.    00830000
008310     05  PV-HOLD-PREV-PO-NBR         PIC S9(09)    COMP           00831012
008320                                                   VALUE ZERO.    00832012
008400     05  PV-USE-LOC-NBR              PIC S9(04)    COMP           00840000
008500                                                   VALUE ZERO.    00850000
008600     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00860000
008700     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00870000
008800*                                                                 00880000
008900******************************************************************00890000
009000*  INPUT AND OUTPUT FILE LAYOUT FOR STORE EXTRACT FILES.          00900000
009100******************************************************************00910000
009200     COPY STOREEXT.                                               00920000
009300*                                                                 00930000
009400******************************************************************00940000
009500*  DB2 FORMATTED MESSAGE AREA                                     00950000
009600******************************************************************00960000
009700     COPY DPWS004.                                                00970000
009800*                                                                 00980000
009900******************************************************************00990000
010000*  COMMUNICATIONS AREA FOR DB2                                    01000000
010100******************************************************************01010000
010200     EXEC SQL                                                     01020000
010300          INCLUDE SQLCA                                           01030000
010400     END-EXEC.                                                    01040000
010500*                                                                 01050000
010600*---------------------------------------------------------------* 01060000
010700*    LEGACY PO TABLE                                              01070002
010800*---------------------------------------------------------------* 01080000
010900     EXEC SQL                                                     01090000
011000          INCLUDE TPURCHS                                         01100002
011100     END-EXEC.                                                    01110000
011200                                                                  01120000
011300******************************************************************01130000
011301*---------------------------------------------------------------* 01130111
011302*    SEASONAL SET TABLE                                           01130211
011303*---------------------------------------------------------------* 01130311
011304     EXEC SQL                                                     01130411
011305          INCLUDE TSEASET                                         01130511
011306     END-EXEC.                                                    01130611
011307                                                                  01130711
011308******************************************************************01130811
011310*---------------------------------------------------------------* 01131002
011320*    TKRPRPM TABLE                                                01132002
011330*---------------------------------------------------------------* 01133002
011340     EXEC SQL                                                     01134002
011350          INCLUDE TKRPRPM                                         01135002
011360     END-EXEC.                                                    01136002
011370                                                                  01137002
011371******************************************************************01137113
011372*    WST00008 - WST_INTGRTN_TYP                                   01137213
011373******************************************************************01137313
011374     EXEC SQL                                                     01137413
011375          INCLUDE WST00008                                        01137513
011376     END-EXEC.                                                    01137613
011377                                                                  01137713
011378******************************************************************01137813
011379*    WST00009 - WST_ATTR_DEFN                                     01137913
011380******************************************************************01138013
011381     EXEC SQL                                                     01138113
011382          INCLUDE WST00009                                        01138213
011383     END-EXEC.                                                    01138313
011384                                                                  01138413
011385******************************************************************01138513
011386*    WST00010 - WST_ATTR_ELEM                                     01138613
011387******************************************************************01138713
011388     EXEC SQL                                                     01138813
011389          INCLUDE WST00010                                        01138913
011390     END-EXEC.                                                    01139013
011391                                                                  01139113
011392******************************************************************01139202
011400 PROCEDURE DIVISION.                                              01140000
011500******************************************************************01150000
011600 0000-PROGRAM-MAINLINE.                                           01160000
011700                                                                  01170000
011800     DISPLAY '***** RCKUT150 STARTED *****'.                      01180003
011900                                                                  01190000
012000     PERFORM 1000-OPEN-INIT.                                      01200000
012100                                                                  01210000
012200     PERFORM 2000-PROCESS-INPUT                                   01220000
012300       UNTIL PS-INPUT-AT-END-YES.                                 01230000
012400                                                                  01240000
012500     PERFORM 9000-CLOSE-AND-DISPLAY.                              01250000
012600                                                                  01260000
012700     GOBACK.                                                      01270013
012800                                                                  01280000
012900                                                                  01290000
013000******************************************************************01300000
013100*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    01310000
013200*    -- OPEN INPUT FILE                                           01320000
013300*    -- OPEN OUTPUT FILE                                          01330000
013400******************************************************************01340000
013500 1000-OPEN-INIT.                                                  01350000
013600                                                                  01360000
013700     OPEN INPUT  STORE-EXTRACT-IN-FILE                            01370000
013800          OUTPUT STORE-EXTRACT-OUT-FILE.                          01380000
013900                                                                  01390000
014000                                                                  01400000
014100******************************************************************01410000
014200*  READ AND PROCESS STORE EXTRACT RECORDS AND WRITE AN OUTPUT     01420000
014300*  RECORD. EVEN IF THE RECORD IS NOT CHANGED, IT WILL BE WRITTEN  01430000
014400*  TO THE OUTPUT.                                                 01440000
014500******************************************************************01450000
014600                                                                  01460000
014700 2000-PROCESS-INPUT.                                              01470000
014800                                                                  01480000
014900     PERFORM 8000-READ-INPUT.                                     01490000
015000                                                                  01500000
015100     IF PS-INPUT-AT-END-NO                                        01510000
015200         PERFORM 3000-TRANSLATE-STORE-CHK                         01520000
015400         PERFORM 8500-WRITE-OUTPUT                                01540000
015500     END-IF.                                                      01550000
015600                                                                  01560000
015700                                                                  01570000
015800******************************************************************01580000
015900*  CHECK TO SEE IF CURRENT STORE NUMBER EQUALS PREVIOUS STORE     01590000
016000*  NUMBER. IF IT IS, NO TRANSLATION NEEDS TO BE DONE, USE THE     01600000
016100*  VALUE TRANSLATED PREVIOUSLY.                                   01610000
016200******************************************************************01620000
016300 3000-TRANSLATE-STORE-CHK.                                        01630000
016310                                                                  01631014
016430                                                                  01643015
016500     IF (PV-HOLD-PREV-PO-NBR  =  SE-PO )                          01650016
016501        AND PS-RED-RDC-FOUND-YES                                  01650116
016502        AND (PV-HOLD-PREV-LOC-NBR =  SE-LOC-NBR)                  01650220
016510           MOVE PV-USE-LOC-NBR TO SE-STORE                        01651012
016511                                  SE-LOC-NBR                      01651116
016800     ELSE                                                         01680000
016801         SET PS-CS-CONVRSON-NO TO TRUE                            01680126
016802         SET PS-RED-RDC-FOUND-NO TO TRUE                          01680212
016810         PERFORM 3200-RED-PO-RDC-CHECK                            01681011
016820         IF PS-RED-RDC-FOUND-YES                                  01682011
016830            PERFORM 3400-RETRIEVE-TRANSLATE-STORE                 01683011
016831            MOVE PV-USE-LOC-NBR TO SE-STORE                       01683111
016833                                   SE-LOC-NBR                     01683316
016834            MOVE  0             TO PV-HOLD-PREV-LOC-NBR           01683422
016840         END-IF                                                   01684011
016850         MOVE SE-PO          TO PV-HOLD-PREV-PO-NBR               01685012
017300     END-IF.                                                      01730000
017310     MOVE PS-CS-CONVRSON-SW  TO SE-CS-CONVRSON-IND.               01731021
017400                                                                  01740000
026851****************************************************************  02685100
026852*  ACCESS TKRPRPM TO GET TRANSLATED VALUE.                        02685200
026853*  SE-OPER-UNT-ID IS FROM THE INPUT FILE, THIS IS MATCHED AGAINST 02685300
026854*  THE LOC-ID IN THE TABLE ALONG WITH SPECIFIC CONSTANTS FOR      02685400
026855*  THE FUNC_PRC_STAT_CDE AND THE SYS_PRC_FUNC_CDE COLUMNS.        02685500
026856****************************************************************  02685600
026857                                                                  02685700
026858 3200-RED-PO-RDC-CHECK.                                           02685811
026859                                                                  02685914
026861                                                                  02686114
026862     MOVE SE-PO      TO   DK-PO-NBR                               02686211
026863                                                                  02686300
026864     EXEC SQL                                                     02686411
026865         SELECT G.SEASET_SHRT_NM                                  02686511
026866           INTO :SEASET-SEASET-SHRT-NM                            02686611
026867           FROM  WST_INTGRTN_TYP  A                               02686711
026868                ,WST_ATTR_DEFN    B                               02686811
026869                ,WST_ATTR_ELEM    C                               02686911
026870                ,WST_ATTR_ELEM    D                               02687011
026871                ,WST_ATTR_ELEM    E                               02687111
026872                ,WST_ATTR_ELEM    F                               02687211
026873                ,TSEASET          G                               02687311
026874                ,TPURCHS          H                               02687411
026875            WHERE A.INTGRTN_TYP_CDE   = 'EFCATRDC'                02687511
026876              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         02687611
026877              AND B.ATTR_DEFN_SEQ_NBR = 1                         02687711
026878              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         02687811
026879              AND C.ATTR_DEFN_SEQ_NBR = 1                         02687911
026880              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         02688011
026881              AND D.ATTR_DEFN_SEQ_NBR = 2                         02688111
026882              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         02688211
026883              AND E.ATTR_DEFN_SEQ_NBR = 3                         02688311
026884              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         02688411
026885              AND F.ATTR_DEFN_SEQ_NBR = 4                         02688511
026886              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       02688611
026887              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       02688711
026888              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       02688811
026889              AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE          02688911
026890              AND D.ATTR_ELEM_TXT     = 'ACTIVE'                  02689011
026891              AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP         02689111
026892              AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP         02689211
026893              AND G.SEASET_SHRT_NM    = H.SEASET_SHRT_NM          02689311
026894              AND G.SEASET_YR         = H.SEASET_YR               02689411
026895              AND H.PO_NBR            = :DK-PO-NBR                02689511
026896              AND H.VER_STATUS_CDE    = 'A'                       02689611
026897       END-EXEC.                                                  02689711
026898                                                                  02689800
026899     EVALUATE TRUE                                                02689900
026900         WHEN SQLCODE = ZERO                                      02690000
026901             SET PS-RED-RDC-FOUND-YES TO TRUE                     02690111
026903         WHEN SQLCODE = +100                                      02690300
026904             SET PS-RED-RDC-FOUND-NO  TO TRUE                     02690411
026905         WHEN SQLWARN0 NOT = SPACE                                02690500
026906         WHEN SQLCODE  NOT = ZERO                                 02690600
026907             MOVE '3200-RED-PO-RDC-CHECK'                         02690711
026908                                TO PV-PARAGRAPH-NAME              02690800
026909             MOVE 'SELECT TKRPRPM '                               02690900
026910                                TO PV-DB2-OPERATION-ATTEMPTED     02691000
026911             DISPLAY 'INPUT REC BEING PROCESSED IS '              02691100
026912                                   PA-INPUT-REC-CNT               02691200
026913                                                                  02691300
026914          PERFORM 9100-SQL-ABEND                                  02691400
026915                                                                  02691500
026916     END-EVALUATE.                                                02691600
026917                                                                  02691700
026918                                                                  02691800
026919                                                                  02691900
026920****************************************************************  02692011
026921*  ACCESS TKRPRPM TO GET TRANSLATED VALUE.                        02692111
026922*  SE-LOC-NBR IS FROM THE INPUT FILE, THIS IS MATCHED AGAINST     02692211
026923*  THE LOC-ID IN THE TABLE ALONG WITH SPECIFIC CONSTANTS FOR      02692311
026924*  THE FUNC_PRC_STAT_CDE AND THE SYS_PRC_FUNC_CDE COLUMNS.        02692411
026925****************************************************************  02692511
026926                                                                  02692611
026927 3400-RETRIEVE-TRANSLATE-STORE.                                   02692711
026929     MOVE SE-LOC-NBR TO   DK-STORE-NBR                            02692920
026931     SET PS-CS-CONVRSON-NO TO TRUE                                02693121
026935                                                                  02693511
026936     EXEC SQL                                                     02693611
026937      SELECT FUNC_QTY                                             02693711
026938       INTO :KRPRPM-FUNC-QTY                                      02693811
026939       FROM TKRPRPM A                                             02693911
026940            WHERE A.LOC_ID            = :DK-STORE-NBR             02694011
026941              AND A.FUNC_PRC_STAT_CDE = 'AC'                      02694111
026942              AND A.SYS_PRC_FUNC_CDE  = 'REDPGM'                  02694211
026943              AND A.FUNC_TXT          = :SEASET-SEASET-SHRT-NM    02694311
026944       WITH UR                                                    02694411
026945     END-EXEC.                                                    02694511
026946                                                                  02694611
026947     EVALUATE TRUE                                                02694711
026948         WHEN SQLCODE = ZERO                                      02694811
026949             MOVE KRPRPM-FUNC-QTY   TO PV-USE-LOC-NBR             02694911
026952             SET PS-CS-CONVRSON-YES TO TRUE                       02695221
026954         WHEN SQLCODE = +100                                      02695411
026956             PERFORM 3500-TRNSLTE-STRE-ANY-LOC                    02695623
026958         WHEN SQLWARN0 NOT = SPACE                                02695811
026959         WHEN SQLCODE  NOT = ZERO                                 02695911
026960             MOVE '3400-RETRIEVE-TRANSLATE-STORE'                 02696011
026961                                TO PV-PARAGRAPH-NAME              02696111
026962             MOVE 'SELECT TKRPRPM '                               02696211
026963                                TO PV-DB2-OPERATION-ATTEMPTED     02696311
026964             DISPLAY 'INPUT REC BEING PROCESSED IS '              02696411
026965                                   PA-INPUT-REC-CNT               02696511
026966                                                                  02696611
026967          PERFORM 9100-SQL-ABEND                                  02696711
026968                                                                  02696811
026969     END-EVALUATE.                                                02696911
026970                                                                  02697011
026971****************************************************************  02697124
026972*  ACCESS TKRPRPM TO GET TRANSLATED VALUE.                        02697224
026973*  SECOND CHECK FOR TRANSLATED VALUE REMOVING THE                 02697324
026974*  SEASET-SEASET-SHRT-NM FROM THE SELECT. CONDITION WHERE A       02697424
026975*  RED PO HAS MULTIPLE DC SPLITS                                  02697524
026976****************************************************************  02697624
026978 3500-TRNSLTE-STRE-ANY-LOC.                                       02697824
026979                                                                  02697924
026980     EXEC SQL                                                     02698024
026981      SELECT FUNC_QTY                                             02698124
026982       INTO :KRPRPM-FUNC-QTY                                      02698224
026983       FROM TKRPRPM A                                             02698324
026984            WHERE A.LOC_ID            = :DK-STORE-NBR             02698424
026985              AND A.FUNC_PRC_STAT_CDE = 'AC'                      02698524
026986              AND A.SYS_PRC_FUNC_CDE  = 'REDPGM'                  02698624
026987       WITH UR                                                    02698724
026988     END-EXEC.                                                    02698824
026989                                                                  02698924
026990     EVALUATE TRUE                                                02699024
026991         WHEN SQLCODE = ZERO                                      02699124
026992             MOVE KRPRPM-FUNC-QTY   TO PV-USE-LOC-NBR             02699224
026993             SET PS-CS-CONVRSON-YES TO TRUE                       02699324
026994         WHEN SQLCODE = +100                                      02699424
026995             MOVE SE-LOC-NBR        TO PV-USE-LOC-NBR             02699524
026996         WHEN SQLWARN0 NOT = SPACE                                02699624
026997         WHEN SQLCODE  NOT = ZERO                                 02699724
026998             MOVE '3500-TRNSLTE-STRE-ANY-LOC'                     02699824
026999                                TO PV-PARAGRAPH-NAME              02699924
027000             MOVE 'SELECT TKRPRPM '                               02700024
027001                                TO PV-DB2-OPERATION-ATTEMPTED     02700124
027002             DISPLAY 'INPUT REC BEING PROCESSED IS '              02700224
027003                                   PA-INPUT-REC-CNT               02700324
027004                                                                  02700424
027005          PERFORM 9100-SQL-ABEND                                  02700524
027006                                                                  02700624
027007     END-EVALUATE.                                                02700724
027008                                                                  02700824
027009                                                                  02700924
027010 8000-READ-INPUT.                                                 02701024
027011                                                                  02701124
027012     READ STORE-EXTRACT-IN-FILE INTO STORE-EXTRACT-LINE           02701224
027013         AT END                                                   02701324
027014             SET PS-INPUT-AT-END-YES TO TRUE.                     02701424
027015                                                                  02701524
027016     IF PS-INPUT-AT-END-NO                                        02701624
027017         ADD +1 TO PA-INPUT-REC-CNT                               02701724
027018     END-IF.                                                      02701824
027019                                                                  02701924
027020****************************************************************  02702024
027021*  A RECORD WILL BE WRITTEN TO THE OUTPUT EVEN IF IT HAS          02702124
027022*  NOT CHANGED.                                                   02702224
027023****************************************************************  02702324
027024                                                                  02702424
027025 8500-WRITE-OUTPUT.                                               02702524
027026                                                                  02702624
027027     WRITE STORE-EXTRACT-OUT-REC FROM STORE-EXTRACT-LINE.         02702724
027028                                                                  02702824
027029     ADD +1 TO PA-OUTPUT-REC-CNT.                                 02702924
027030                                                                  02703024
027031                                                                  02703124
027032 9000-CLOSE-AND-DISPLAY.                                          02703224
027033                                                                  02703324
027034     CLOSE STORE-EXTRACT-IN-FILE                                  02703424
027035           STORE-EXTRACT-OUT-FILE.                                02703524
027036                                                                  02703624
027037     DISPLAY 'INPUT RECORD COUNT  ' PA-INPUT-REC-CNT.             02703724
027038     DISPLAY 'OUTPUT RECORD COUNT ' PA-OUTPUT-REC-CNT.            02703824
027039                                                                  02703924
027040     DISPLAY '*****  RCKUT150 ENDED  *****'.                      02704024
027041                                                                  02704124
027042******************************************************************02704224
027043*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    02704324
027044*  ERROR OR WARNING CODE OCCURS.                                  02704424
027045******************************************************************02704524
027046                                                                  02704624
027047 9100-SQL-ABEND.                                                  02704724
027048                                                                  02704824
027049     DISPLAY '9100-SQL-ABEND'.                                    02704924
027050     DISPLAY '** ABEND     **'.                                   02705024
027051     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        02705124
027052     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              02705224
027053     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     02705324
027054     DISPLAY 'INPUT RECORD ID ' STORE-EXTRACT-LINE (1:43).        02705424
027055                                                                  02705524
027056******************************************************************02705624
027057* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    02705724
027058* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02705824
027059* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     02705924
027060* FORMAT.                                                         02706024
027061******************************************************************02706124
027062                                                                  02706224
027063     COPY DPPD004.                                                02706324
027064                                                                  02706424
027065     MOVE +4013                  TO ABEND-CODE.                   02706524
027070     CALL 'ILBOABN0' USING ABEND-CODE.                            02707023
027100                                                                  02710000
