00001 ***************************************************************** 02/01/96
00002  IDENTIFICATION DIVISION.                                         MRKUP075
00003 *****************************************************************    LV002
00004                                                                   MRKUP075
00005  PROGRAM-ID.             MRKUP075.                                MRKUP075
00006  AUTHOR.                 DAVE PHELPS.                             MRKUP075
00007  INSTALLATION.           KOHLS DEPARTMENT STORES.                 MRKUP075
00008  DATE-WRITTEN            01-15-96.                                MRKUP075
00009  DATE-COMPILED.                                                   MRKUP075
00010                                                                   MRKUP075
00011 ***************************************************************** MRKUP075
00012 *     PROFILE SERVICES SALES HISTORY CREATION                   * MRKUP075
00013 *                                                               * MRKUP075
00014 *  THIS PROGRAM WILL UPDATE THE RUN MODE FIELD ON THE CONTROL   * MRKUP075
00015 *  FILE SYSTEM RECORD.                                          * MRKUP075
00016 ***************************************************************** MRKUP075
00017 *  CHANGE MADE:                                                 * MRKUP075
00018 *                                                               * MRKUP075
00019 ***************************************************************** MRKUP075
00020 * CHANGED 06/14/03 BY MARIA KLAMIK                                MRKUP075
00021 *   PM# 557334                                                    MRKUP075
00022 *            ERROR IN USERID TABLE PROCESSING.  TABLE OVERFLOW.   MRKUP075
00023 *            INCREASED SIZE OF TABLE TO 400 USERS FROM 200 USERS. MRKUP075
00026 ***************************************************************** MRKUP075
00020 * CHANGED 06/04/11 BY RYAN STAUFFACHER                            MRKUP075
00021 *   INC000001722048                                               MRKUP075
00022 *            ERROR IN USERID TABLE PROCESSING.  TABLE OVERFLOW.   MRKUP075
00023 *            INCREASED SIZE OF TABLE TO 1000 USERS FROM 400 USERS.MRKUP075
00026 ***************************************************************** MRKUP075
00020 * CHANGED 09/22/17 BY COGNIZANT                                   MRKUP075
00021 *   CHG0178659                                                    MRKUP075
00022 *            ERROR IN USERID TABLE PROCESSING.  TABLE OVERFLOW.   MRKUP075
00023 *            INCREASED SIZE OF TBL TO 5000 USERS FROM 1000 USERS. MRKUP075
00026 ***************************************************************** MRKUP075
00027  ENVIRONMENT DIVISION.                                            MRKUP075
00028 ***************************************************************** MRKUP075
00029                                                                   MRKUP075
00030  CONFIGURATION SECTION.                                           MRKUP075
00031                                                                   MRKUP075
00032  SOURCE-COMPUTER.        IBM-3090.                                MRKUP075
00033  OBJECT-COMPUTER.        IBM-3090.                                MRKUP075
00034                                                                   MRKUP075
00035  INPUT-OUTPUT SECTION.                                            MRKUP075
00036                                                                   MRKUP075
00037  FILE-CONTROL.                                                    MRKUP075
00038 *                                                                 MRKUP075
00039      SELECT PASSWORD-FILE       ASSIGN        TO INP01.           MRKUP075
00040 *                                                                 MRKUP075
00041      SELECT ICCTL-CNTL-FILE-ACC ASSIGN        TO OUT01            MRKUP075
00042                                 ORGANIZATION  IS INDEXED          MRKUP075
00043                                 ACCESS        IS RANDOM           MRKUP075
00044                                 RECORD KEY    IS ICCTL-KEY-ACC    MRKUP075
00045                                 FILE STATUS   IS PV-VSAM-STATUS.  MRKUP075
00046 *                                                                 MRKUP075
00047      SELECT ICCTL-CNTL-FILE-UAR ASSIGN        TO OUT01            MRKUP075
00048                                 ORGANIZATION  IS INDEXED          MRKUP075
00049                                 ACCESS        IS RANDOM           MRKUP075
00050                                 RECORD KEY    IS ICCTL-KEY-UAR    MRKUP075
00051                                 FILE STATUS   IS PV-VSAM-STATUS.  MRKUP075
00052 *                                                                 MRKUP075
00053 ***************************************************************** MRKUP075
00054  DATA DIVISION.                                                   MRKUP075
00055 ***************************************************************** MRKUP075
00056 *                                                                 MRKUP075
00057  FILE SECTION.                                                    MRKUP075
00058                                                                   MRKUP075
00059  FD  PASSWORD-FILE.                                               MRKUP075
00060  01  PASSWORD-RECORD.                                             MRKUP075
00061      05  CONTROL-USERID              PIC  X(08).                  MRKUP075
00062      05  CONTROL-PASSWORD            PIC  X(08).                  MRKUP075
00063      05  FILLER                      PIC  X(64).                  MRKUP075
00064 *                                                                 MRKUP075
00065  FD  ICCTL-CNTL-FILE-UAR.                                         MRKUP075
00066  01  ICCTL-CNTL-REC-UAR.                                          MRKUP075
00067      05  ICCTL-KEY-UAR               PIC X(21).                   MRKUP075
00068      05  FILLER                      PIC X(379).                  MRKUP075
00069 *                                                                 MRKUP075
00070  FD  ICCTL-CNTL-FILE-ACC.                                         MRKUP075
00071  01  ICCTL-CNTL-REC-ACC.                                          MRKUP075
00072      05  ICCTL-KEY-ACC               PIC X(21).                   MRKUP075
00073      05  FILLER                      PIC X(79).                   MRKUP075
00074 *                                                                 MRKUP075
00075  WORKING-STORAGE SECTION.                                         MRKUP075
00076 *                                                                 MRKUP075
00077  01  FILLER.                                                      MRKUP075
00078      05  FILLER                      PIC  X(36)    VALUE          MRKUP075
00079          ' ***** WORKING STORAGE PGM=MRKUP075 '.                  MRKUP075
00080      05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   MRKUP075
00081      05  FILLER                      PIC  X(10)    VALUE          MRKUP075
00082          ' LOCATION='.                                            MRKUP075
00083      05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   MRKUP075
00084      05  FILLER                      PIC  X(06)    VALUE          MRKUP075
00085          ' *****'.                                                MRKUP075
00086  EJECT                                                            MRKUP075
00087  01  PROGRAM-SWITCHES.                                            MRKUP075
00088      05  PS-END-OF-SYSTEM-REC        PIC  X(01)    VALUE 'N'.     MRKUP075
00089          88  END-OF-SYSTEM-REC                     VALUE 'Y'.     MRKUP075
00090      05  PS-END-OF-PASSWORD-REC      PIC  X(01)    VALUE 'N'.     MRKUP075
00091          88  END-OF-PASSWORD-REC                   VALUE 'Y'.     MRKUP075
00092      05  PS-END-PASSWORD-FILE        PIC  X(01)    VALUE 'N'.     MRKUP075
00093          88  END-PASSWORD-FILE                     VALUE 'Y'.     MRKUP075
00094 *                                                                 MRKUP075
00095  01  PC-CONSTANTS.                                                MRKUP075
00096      05  PC-PLUS-1                   PIC S9(04)    VALUE +1       MRKUP075
00097                                                    COMP SYNC.     MRKUP075
00098      05  PC-PLUS-2                   PIC S9(04)    VALUE +2       MRKUP075
00099                                                    COMP SYNC.     MRKUP075
00100      05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     MRKUP075
00101                                                    COMP SYNC.     MRKUP075
00102      05  PC-1                        PIC S9(03)    VALUE +1       MRKUP075
00103                                                    COMP-3.        MRKUP075
00104      05  PC-2                        PIC S9(03)    VALUE +2       MRKUP075
00105                                                    COMP-3.        MRKUP075
00106      05  PC-3                        PIC S9(03)    VALUE +3       MRKUP075
00107                                                    COMP-3.        MRKUP075
00108      05  PC-4                        PIC  X(01)    VALUE '4'.     MRKUP075
00109      05  PC-5                        PIC  X(01)    VALUE '5'.     MRKUP075
00110      05  PC-9                        PIC  X(01)    VALUE '9'.     MRKUP075
00111      05  PC-00                       PIC  X(02)    VALUE '00'.    MRKUP075
00112      05  PC-000                      PIC  X(03)    VALUE '000'.   MRKUP075
00113      05  PC-01                       PIC  X(02)    VALUE '01'.    MRKUP075
00113      05  PC-02                       PIC  X(02)    VALUE '02'.    MRKUP075
00114      05  PC-1A                       PIC  X(02)    VALUE '1A'.    MRKUP075
00115      05  PC-2A                       PIC  X(02)    VALUE '2A'.    MRKUP075
00116      05  PC-3A                       PIC  X(02)    VALUE '3A'.    MRKUP075
00117      05  PC-4A                       PIC  X(02)    VALUE '4A'.    MRKUP075
00118      05  PC-5A                       PIC  X(02)    VALUE '5A'.    MRKUP075
00119      05  PC-6A                       PIC  X(02)    VALUE '6A'.    MRKUP075
00120      05  PC-7A                       PIC  X(02)    VALUE '7A'.    MRKUP075
00120      05  PC-1B                       PIC  X(02)    VALUE '1B'.    MRKUP075
00120      05  PC-1D                       PIC  X(02)    VALUE '1D'.    MRKUP075
00120      05  PC-4B                       PIC  X(02)    VALUE '4B'.    MRKUP075
00121      05  PC-ACC                      PIC  X(03)    VALUE 'ACC'.   MRKUP075
00122      05  PC-UAR                      PIC  X(03)    VALUE 'UAR'.   MRKUP075
00123      05  PC-04                       PIC  X(02)    VALUE '04'.    MRKUP075
00124      05  PC-07                       PIC  9(02)    VALUE   7.     MRKUP075
00125      05  PC-19                       PIC  X(02)    VALUE '19'.    MRKUP075
00126      05  PC-20                       PIC  X(02)    VALUE '20'.    MRKUP075
00127      05  PC-A                        PIC  X(01)    VALUE 'A'.     MRKUP075
00128      05  PC-D                        PIC  X(01)    VALUE 'D'.     MRKUP075
00129      05  PC-M                        PIC  X(01)    VALUE 'M'.     MRKUP075
00130      05  PC-N                        PIC  X(01)    VALUE 'N'.     MRKUP075
00131      05  PC-P                        PIC  X(01)    VALUE 'P'.     MRKUP075
00132      05  PC-U                        PIC  X(01)    VALUE 'U'.     MRKUP075
00133      05  PC-W                        PIC  X(01)    VALUE 'W'.     MRKUP075
00134      05  PC-X                        PIC  X(01)    VALUE 'X'.     MRKUP075
00135      05  PC-Y                        PIC  X(01)    VALUE 'Y'.     MRKUP075
00136      05  PC-F2                       PIC  X(02)    VALUE 'F2'.    MRKUP075
00137      05  PC-PR                       PIC  X(02)    VALUE 'PR'.    MRKUP075
00138      05  PC-TR                       PIC  X(02)    VALUE 'TR'.    MRKUP075
00139      05  PC-RCD-TYPE                 PIC  X(03)    VALUE 'SYS'.   MRKUP075
00140      05  PC-DECR-DAYS                PIC  X(05)    VALUE '00004'. MRKUP075
00141      05  PC-DECR-7-DAYS              PIC  X(05)    VALUE '00007'. MRKUP075
00142      05  PC-DECR-21-DAYS             PIC  X(05)    VALUE '00021'. MRKUP075
00143      05  PC-DASH                     PIC  X(01)    VALUE '-'.     MRKUP075
00144      05  PC-SLASH                    PIC  X(01)    VALUE '/'.     MRKUP075
00145      05  PC-EXPIRE-DATE              PIC  X(08)                   MRKUP075
00146                                      VALUE '99-99-99'.            MRKUP075
00147      05  PC-DB2-DATE                 PIC  X(08)    VALUE SPACES.  MRKUP075
00148      05  PC-SAN                      PIC  X(03)    VALUE 'SAN'.   MRKUP075
00149      05  PC-ANL                      PIC  X(03)    VALUE 'ANL'.   MRKUP075
00150      05  PC-ANM                      PIC  X(03)    VALUE 'ANM'.   MRKUP075
00151      05  PC-MIO                      PIC  X(03)    VALUE 'MIO'.   MRKUP075
00152      05  PC-H5                       PIC  X(02)    VALUE 'H5'.    MRKUP075
00153      05  PC-SYSADMIN                 PIC  X(08)                   MRKUP075
00154                                      VALUE 'SYSADMIN'.            MRKUP075
00155      05  PC-ICC680C                  PIC  X(08)                   MRKUP075
00156                                      VALUE 'ICC680C'.             MRKUP075
00157      05  PC-ICC700C                  PIC  X(08)                   MRKUP075
00158                                      VALUE 'ICC700C'.             MRKUP075
00159  EJECT                                                            MRKUP075
00160 *                                                                 MRKUP075
00161  01  PV-NULL-INDICATORS.                                          MRKUP075
00162      05  PV-DTL-ORD-QTY-UM-CDE-NULL  PIC S9(04)    VALUE +0       MRKUP075
00163                                                    COMP SYNC.     MRKUP075
00164      05  PS-NO-MORE-USERS            PIC  X(01)    VALUE 'N'.     MRKUP075
00165          88  NO-MORE-USERS                         VALUE 'Y'.     MRKUP075
00166 *                                                                 MRKUP075
00167  01  PV-TABLE-AREA.                                               MRKUP075
MK         05  PV-USERID-TABLE            OCCURS 5000 TIMES             MRKUP075
00169                                     INDEXED BY SUB.               MRKUP075
00170          10  PV-USERID               PIC  X(08).                  MRKUP075
00171          10  PV-PASSWORD             PIC  X(08).                  MRKUP075
00172                                                                   MRKUP075
00173 *                                                                 MRKUP075
00174  01  PV-ACCUMULATOR-FIELDS.                                       MRKUP075
00175      05  PV-SYSTEM-INPUT-CNT         PIC S9(03)    VALUE ZERO     MRKUP075
00176                                                    COMP-3.        MRKUP075
00177      05  PV-PARM-INPUT-CNT           PIC S9(03)    VALUE ZERO     MRKUP075
00178                                                    COMP-3.        MRKUP075
00179      05  PV-SYSTEM-OUTPUT-CNT        PIC S9(04)    VALUE ZERO     MRKUP075
00180                                                    COMP-3.        MRKUP075
00181  EJECT                                                            MRKUP075
00182 *                                                                 MRKUP075
00183  01  PV-MISC-FIELDS.                                              MRKUP075
00184      05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     MRKUP075
00185                                                    COMP SYNC.     MRKUP075
00186      05  PV-RBA                      PIC S9(09)    VALUE ZERO     MRKUP075
00187                                                    COMP SYNC.     MRKUP075
00188      05  PV-VSAM-STATUS              PIC  X(02) VALUE SPACE.      MRKUP075
00189          88  PV-VSAM-SUCCESSFUL                 VALUE '00'.       MRKUP075
00190          88  PV-VSAM-DUPLICATE                  VALUE '22'.       MRKUP075
00191          88  PV-VSAM-NOT-FOUND                  VALUE '23'.       MRKUP075
00192      05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  MRKUP075
00193      05  PV-EFF-DATE.                                             MRKUP075
00194          10  PV-EFF-DATE-MO          PIC  9(02)    VALUE ZERO.    MRKUP075
00195          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00196          10  PV-EFF-DATE-DY          PIC  9(02)    VALUE ZERO.    MRKUP075
00197          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00198          10  PV-EFF-DATE-YR          PIC  9(02)    VALUE ZERO.    MRKUP075
00199      05  PV-DB2-DATE                 PIC  X(10)    VALUE ZERO.    MRKUP075
00200      05  PV-CURRENT-DATE.                                         MRKUP075
00201          10  PV-CURRENT-DATE-CC      PIC  9(02)    VALUE ZERO.    MRKUP075
00202          10  PV-CURRENT-DATE-YR      PIC  9(02)    VALUE ZERO.    MRKUP075
00203          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00204          10  PV-CURRENT-DATE-MO      PIC  9(02)    VALUE ZERO.    MRKUP075
00205          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00206          10  PV-CURRENT-DATE-DY      PIC  9(02)    VALUE ZERO.    MRKUP075
00207      05  PV-DATE-RANGE-MAX.                                       MRKUP075
00208          10  PV-LAST-FP-DATE-CC      PIC  9(02)    VALUE ZERO.    MRKUP075
00209          10  PV-LAST-FP-DATE-YR      PIC  9(02)    VALUE ZERO.    MRKUP075
00210          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00211          10  PV-LAST-FP-DATE-MO      PIC  9(02)    VALUE ZERO.    MRKUP075
00212          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00213          10  PV-LAST-FP-DATE-DY      PIC  9(02)    VALUE ZERO.    MRKUP075
00214      05  PV-MMDDYY.                                               MRKUP075
00215          10  PV-MM                   PIC  9(02)    VALUE ZERO.    MRKUP075
00216          10  PV-DD                   PIC  9(02)    VALUE ZERO.    MRKUP075
00217          10  PV-YY                   PIC  9(02)    VALUE ZERO.    MRKUP075
00218      05  PV-YYMMDD                   PIC  9(06)    VALUE ZERO.    MRKUP075
00219      05  PV-TODAYS-TIME.                                          MRKUP075
00220          10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    MRKUP075
00221          10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    MRKUP075
00222          10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    MRKUP075
00223          10  FILLER                  PIC  9(02)    VALUE ZERO.    MRKUP075
00224      05  PV-SUBSCRIPTS.                                           MRKUP075
00225          10  PV-S-CYCLE-SUB          PIC  9(01)    VALUE ZERO.    MRKUP075
00226      05  PV-BPN-WEEK                 PIC  9(02)    VALUE ZERO.    MRKUP075
00227      05  PV-BPN-MONTH                PIC  9(02)    VALUE ZERO.    MRKUP075
00228      05  PV-CURRENT-FIRST-DAY.                                    MRKUP075
00229          10  PV-CURR-FP-DATE-CC      PIC  9(02)    VALUE ZERO.    MRKUP075
00230          10  PV-CURR-FP-DATE-YR      PIC  9(02)    VALUE ZERO.    MRKUP075
00231          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00232          10  PV-CURR-FP-DATE-MO      PIC  9(02)    VALUE ZERO.    MRKUP075
00233          10  FILLER                  PIC  X(01)    VALUE '-'.     MRKUP075
00234          10  PV-CURR-FP-DATE-DY      PIC  9(02)    VALUE ZERO.    MRKUP075
00235      05  PV-CURRENT-PERIOD           PIC  9(02)    VALUE ZERO.    MRKUP075
00236  EJECT                                                            MRKUP075
00237 *                                                                 MRKUP075
00238      COPY DPWS500.                                                MRKUP075
00239  EJECT                                                            MRKUP075
00240 *                                                                 MRKUP075
00241  01  SYSTEM-RECORD-UAR.                                           MRKUP075
00242      COPY ICI020C.                                                MRKUP075
00243 *                                                                 MRKUP075
00244  01  SYSTEM-RECORD-ACC.                                           MRKUP075
00245      COPY ICI026C.                                                MRKUP075
00246 *                                                                 MRKUP075
00247  EJECT                                                            MRKUP075
00248 * DB2 TABLE LAYOUTS                                               MRKUP075
00249      EXEC SQL                                                     MRKUP075
00250          INCLUDE TRSPBAR                                          MRKUP075
00251      END-EXEC.                                                    MRKUP075
00252  EJECT                                                            MRKUP075
00253      EXEC SQL                                                     MRKUP075
00254          INCLUDE TWORKER                                          MRKUP075
00255      END-EXEC.                                                    MRKUP075
00256  EJECT                                                            MRKUP075
00257      EXEC SQL                                                     MRKUP075
00258          INCLUDE TMDSEAR                                          MRKUP075
00259      END-EXEC.                                                    MRKUP075
00260  EJECT                                                            MRKUP075
00261 * DB2 COMMUNICATION AREA                                          MRKUP075
00262                                                                   MRKUP075
00263      EXEC SQL                                                     MRKUP075
00264          INCLUDE SQLCA                                            MRKUP075
00265      END-EXEC.                                                    MRKUP075
00266  EJECT                                                            MRKUP075
00267 * DB2 COMMUNICATION AREA2                                         MRKUP075
00268                                                                   MRKUP075
00269      COPY SQLCA2.                                                 MRKUP075
00270  EJECT                                                            MRKUP075
00271 * DB2 CURSOR AREA                                                 MRKUP075
00272                                                                   MRKUP075
00273      EXEC SQL                                                     MRKUP075
00274        DECLARE MBS_CSR CURSOR FOR                                 MRKUP075
00275          SELECT DISTINCT                                          MRKUP075
00276                 DEPT_NBR,                                         MRKUP075
00277                 UID_NBR,                                          MRKUP075
00278                 RSPLVL_CDE                                        MRKUP075
00279            FROM TMDSEAR A,                                        MRKUP075
00280                 TRSPBAR B,                                        MRKUP075
00281                 TWORKER C                                         MRKUP075
00282           WHERE A.OPERCO_NBR = '03'                               MRKUP075
00283             AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                     MRKUP075
00284             AND B.WORKER_NBR = C.WORKER_NBR                       MRKUP075
00285             AND B.RSPLVL_CDE IN (:PC-SAN,:PC-ANL,:PC-ANM,:PC-MIO) MRKUP075
00286             AND (:PV-DB2-DATE BETWEEN B.WORKER_STRT_DTE           MRKUP075
00287                                  AND  B.WORKER_END_DTE)           MRKUP075
00288             AND (:PV-DB2-DATE BETWEEN A.STRT_DTE                  MRKUP075
00289                                  AND  A.END_DTE)                  MRKUP075
00290           ORDER BY UID_NBR                                        MRKUP075
00291      END-EXEC.                                                    MRKUP075
00292                                                                   MRKUP075
00293  LINKAGE SECTION.                                                 MRKUP075
00294 *                                                                 MRKUP075
00295 ***************************************************************** MRKUP075
00296 *PROCEDURE DIVISION.                                              MRKUP075
00297 ***************************************************************** MRKUP075
00298  PROCEDURE DIVISION.                                              MRKUP075
00299 *                                                                 MRKUP075
00300  A000-MAINLINE-PROCESSING.                                        MRKUP075
00301 *                                                                 MRKUP075
00302      PERFORM A100-INITIALIZATION.                                 MRKUP075
00303 *                                                                 MRKUP075
00304      PERFORM B000-PROCESS-SYSTEM-RECORD UNTIL                     MRKUP075
00305                   NO-MORE-USERS.                                  MRKUP075
00306 *                                                                 MRKUP075
00307      PERFORM Y100-END-ROUTINE.                                    MRKUP075
00308 *                                                                 MRKUP075
00309      GOBACK.                                                      MRKUP075
00310 *                                                                 MRKUP075
00311  EJECT                                                            MRKUP075
00312 ******************************************************************MRKUP075
00313 ** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 MRKUP075
00314 ** CALL CALENDAR ROUTINES TO RETRIEVE VALUES NEEDED IN PROGRAM    MRKUP075
00315 ******************************************************************MRKUP075
00316  A100-INITIALIZATION.                                             MRKUP075
00317 *                                                                 MRKUP075
00318      MOVE 'A100'                   TO PGM-LOCATION.               MRKUP075
00319      MOVE 'A100-INITIALIATION  '   TO PV-ABEND-PARAGRAPH.         MRKUP075
00320 *                                                                 MRKUP075
00321      OPEN  I-O   PASSWORD-FILE                                    MRKUP075
00322                  ICCTL-CNTL-FILE-UAR                              MRKUP075
00323                  ICCTL-CNTL-FILE-ACC.                             MRKUP075
00324 *                                                                 MRKUP075
00325      IF  PV-VSAM-SUCCESSFUL                                       MRKUP075
00326         CONTINUE                                                  MRKUP075
00327      ELSE                                                         MRKUP075
00328         DISPLAY '** ABEND **'                                     MRKUP075
00329         DISPLAY '** PROGRAM    = MRKUP075'                        MRKUP075
00330         DISPLAY '** PARAGRAPH  = R000-READ-SYSTEM-RECORD'         MRKUP075
00331         DISPLAY '** MESSAGE    = '                                MRKUP075
00332                  'BAD VSAM READ, STATUS = ' PV-VSAM-STATUS        MRKUP075
00333         MOVE +4005           TO PV-ABEND-CODE                     MRKUP075
00334         CALL 'ILBOABN0'      USING PV-ABEND-CODE                  MRKUP075
00335      END-IF.                                                      MRKUP075
00336 *                                                                 MRKUP075
00337      INITIALIZE SYSTEM-RECORD-UAR.                                MRKUP075
00338      INITIALIZE SYSTEM-RECORD-ACC.                                MRKUP075
00339 *                                                                 MRKUP075
00340      PERFORM U000-INITIALIZE-USERID-TABLE                         MRKUP075
00341              VARYING SUB                                          MRKUP075
00342              FROM 1 BY 1                                          MRKUP075
00343              UNTIL SUB > 400.                                     MRKUP075
00344                                                                   MRKUP075
00345      SET SUB TO 1.                                                MRKUP075
00346 *                                                                 MRKUP075
00347      PERFORM R100-READ-PASSWORD-RECORD UNTIL                      MRKUP075
00348              END-OF-PASSWORD-REC                                  MRKUP075
00349 *                                                                 MRKUP075
00350      ACCEPT DPG51-SYSTEM-DATE FROM DATE.                          MRKUP075
00351 *                                                                 MRKUP075
00352      MOVE DPG51-SYSTEM-DATE-YR      TO PV-CURRENT-DATE-YR         MRKUP075
00353                                        PV-EFF-DATE-YR.            MRKUP075
00354                                                                   MRKUP075
00355      IF DPG51-SYSTEM-DATE-YR > 95                                 MRKUP075
00356          MOVE 19                    TO PV-CURRENT-DATE-CC         MRKUP075
00357      ELSE                                                         MRKUP075
00358          MOVE 20                    TO PV-CURRENT-DATE-CC         MRKUP075
00359      END-IF                                                       MRKUP075
00360                                                                   MRKUP075
00361      MOVE DPG51-SYSTEM-DATE-MO      TO PV-CURRENT-DATE-MO         MRKUP075
00362                                        PV-EFF-DATE-MO.            MRKUP075
00363                                                                   MRKUP075
00364      MOVE DPG51-SYSTEM-DATE-DY      TO PV-CURRENT-DATE-DY         MRKUP075
00365                                        PV-EFF-DATE-DY.            MRKUP075
00366                                                                   MRKUP075
00367      DISPLAY 'DATE: ' PV-CURRENT-DATE                             MRKUP075
00368                                                                   MRKUP075
00369      MOVE PV-CURRENT-DATE TO PV-DB2-DATE.                         MRKUP075
00370 *                                                                 MRKUP075
00371 ******************************************************************MRKUP075
00372 *   CLOSES FILES AND DISPLAYS MESSAGES.                          *MRKUP075
00373 ******************************************************************MRKUP075
00374  U000-INITIALIZE-USERID-TABLE.                                    MRKUP075
00375 *                                                                 MRKUP075
00376      MOVE 'U000'                   TO PGM-LOCATION.               MRKUP075
00377      MOVE 'U000-INITIALIZE-USERID' TO PV-ABEND-PARAGRAPH.         MRKUP075
00378                                                                   MRKUP075
00379      MOVE LOW-VALUES      TO  PV-USERID(SUB).                     MRKUP075
00380      MOVE ZEROES          TO  PV-PASSWORD(SUB).                   MRKUP075
00381                                                                   MRKUP075
00382  EJECT                                                            MRKUP075
00383 ******************************************************************MRKUP075
00384 *  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *MRKUP075
00385 *  SYSTEM RECORD. THIS PARAGRAPH OPENS A CURSOR OF VALID USERIDS *MRKUP075
00386 *  AND FETCHES THRU EACH VALID USERID AND LOOKS UP A PASSWORD.   *MRKUP075
00387 *  IF A PASSWORD IS NOT FOUND THEN THE USERID IS THE PASSWORD.   *MRKUP075
00388 ******************************************************************MRKUP075
00389  B000-PROCESS-SYSTEM-RECORD.                                      MRKUP075
00390 *                                                                 MRKUP075
00391      PERFORM S600-OPEN-USERID-CURSOR.                             MRKUP075
00392 *                                                                 MRKUP075
00393      PERFORM S700-FETCH-USERID-CSR UNTIL NO-MORE-USERS.           MRKUP075
00394 *                                                                 MRKUP075
00395      PERFORM S800-CLOSE-USERID-CURSOR.                            MRKUP075
00396 *                                                                 MRKUP075
00397  EJECT                                                            MRKUP075
00398 ******************************************************************MRKUP075
00399 * THIS SECTION READS THE PARAMETER RECORD                        *MRKUP075
00400 ******************************************************************MRKUP075
00401  R100-READ-PASSWORD-RECORD.                                       MRKUP075
00402 *                                                                 MRKUP075
00403      MOVE 'R100'                   TO PGM-LOCATION.               MRKUP075
00404      MOVE 'R100-READ-PASSWORD-RECORD' TO PV-ABEND-PARAGRAPH.      MRKUP075
00405 *                                                                 MRKUP075
00406      READ PASSWORD-FILE                                           MRKUP075
00407           AT END                                                  MRKUP075
00408              MOVE PC-Y      TO  PS-END-OF-PASSWORD-REC.           MRKUP075
00409                                                                   MRKUP075
00410      IF END-OF-PASSWORD-REC                                       MRKUP075
00411           MOVE '***' TO PV-USERID (SUB)                           MRKUP075
MK              IF SUB > 5000                                                   
MK                 DISPLAY 'USERID TABLE OVERFLOW ERROR'                        
MK              END-IF                                                          
00412      ELSE                                                         MRKUP075
00413           MOVE CONTROL-USERID    TO  PV-USERID(SUB)               MRKUP075
00414           MOVE CONTROL-PASSWORD  TO  PV-PASSWORD(SUB)             MRKUP075
00415           SET SUB UP BY 1                                         MRKUP075
MK              IF SUB > 5000                                                   
MK                 DISPLAY 'USERID TABLE OVERFLOW ERROR'                        
MK              END-IF                                                          
00416      END-IF .                                                     MRKUP075
00417                                                                   MRKUP075
00418 ******************************************************************MRKUP075
00419 *  THIS PARAGRAPH READS THE REPROFILING RUN PARAMETERS FILE      *MRKUP075
00420 ******************************************************************MRKUP075
00421  R200-READ-PASSWORD-ARRAY.                                        MRKUP075
00422 *                                                                 MRKUP075
00423      MOVE 'R200'                     TO PGM-LOCATION.             MRKUP075
00424      MOVE 'R200-READ-PASSWORD-ARRAY' TO PV-ABEND-PARAGRAPH.       MRKUP075
00425 *                                                                 MRKUP075
00426                                                                   MRKUP075
00427         MOVE WORKER-UID-NBR TO U-ID-USER                          MRKUP075
00428      IF WORKER-UID-NBR = PV-USERID (SUB)                          MRKUP075
00429         MOVE PV-PASSWORD (SUB) TO U-PASSWORD                      MRKUP075
00430         MOVE PC-Y TO PS-END-PASSWORD-FILE                         MRKUP075
00431      ELSE                                                         MRKUP075
00432         MOVE WORKER-UID-NBR    TO U-PASSWORD                      MRKUP075
00433      END-IF.                                                      MRKUP075
00434                                                                   MRKUP075
00435 ******************************************************************MRKUP075
00436 *  THIS PARAGRAPH OPENS THE STORE CURSOR                         *MRKUP075
00437 ******************************************************************MRKUP075
00438  S600-OPEN-USERID-CURSOR.                                         MRKUP075
00439                                                                   MRKUP075
00440      MOVE 'S600'                   TO PGM-LOCATION.               MRKUP075
00441      MOVE 'S600-OPEN-USERID-CSR '  TO PV-ABEND-PARAGRAPH.         MRKUP075
00442                                                                   MRKUP075
00443      EXEC SQL                                                     MRKUP075
00444          OPEN MBS_CSR                                             MRKUP075
00445      END-EXEC.                                                    MRKUP075
00446                                                                   MRKUP075
00447      EVALUATE TRUE                                                MRKUP075
00448        WHEN SQLCODE         = ZERO                                MRKUP075
00449        WHEN SQLCODE         = PC-ROW-NOT-FOUND                    MRKUP075
00450          CONTINUE                                                 MRKUP075
00451        WHEN OTHER                                                 MRKUP075
00452          DISPLAY PV-ABEND-PARAGRAPH                               MRKUP075
00453          PERFORM Z999-SQL-ERROR                                   MRKUP075
00454      END-EVALUATE.                                                MRKUP075
00455                                                                   MRKUP075
00456 ******************************************************************MRKUP075
00457 *   THIS PARAGRAPH FETCHES THE STORE CURSOR                      *MRKUP075
00458 ******************************************************************MRKUP075
00459  S700-FETCH-USERID-CSR.                                           MRKUP075
00460                                                                   MRKUP075
00461      MOVE 'S700'                   TO PGM-LOCATION.               MRKUP075
00462      MOVE 'S700-FETCH-USERID-CSR'  TO PV-ABEND-PARAGRAPH.         MRKUP075
00463                                                                   MRKUP075
00464      EXEC SQL                                                     MRKUP075
00465          FETCH MBS_CSR                                            MRKUP075
00466           INTO :MDSEAR-DEPT-NBR,                                  MRKUP075
00467                :WORKER-UID-NBR,                                   MRKUP075
00468                :RSPBAR-RSPLVL-CDE                                 MRKUP075
00469      END-EXEC.                                                    MRKUP075
00470                                                                   MRKUP075
00471      EVALUATE TRUE                                                MRKUP075
00472        WHEN SQLCODE         = ZERO                                MRKUP075
00473          MOVE WORKER-UID-NBR TO U-USER-ID                         MRKUP075
00474          PERFORM X000-LOOK-UP-PASSWORD                            MRKUP075
00475          PERFORM W000-SET-VALUES-CONTROL-REC                      MRKUP075
00476        WHEN SQLCODE         = PC-ROW-NOT-FOUND                    MRKUP075
00477          MOVE PC-Y TO PS-NO-MORE-USERS                            MRKUP075
00478        WHEN OTHER                                                 MRKUP075
00479          DISPLAY PV-ABEND-PARAGRAPH                               MRKUP075
00480          PERFORM Z999-SQL-ERROR                                   MRKUP075
00481      END-EVALUATE.                                                MRKUP075
00482                                                                   MRKUP075
00483 ******************************************************************MRKUP075
00484 *     THIS PARAGRAPH CLOSES THE STORE CURSOR                     *MRKUP075
00485 ******************************************************************MRKUP075
00486  S800-CLOSE-USERID-CURSOR.                                        MRKUP075
00487                                                                   MRKUP075
00488      MOVE 'S800'                   TO PGM-LOCATION.               MRKUP075
00489      MOVE 'S800-CLOSE-USERID-CSR'  TO PV-ABEND-PARAGRAPH.         MRKUP075
00490                                                                   MRKUP075
00491      EXEC SQL                                                     MRKUP075
00492          CLOSE MBS_CSR                                            MRKUP075
00493      END-EXEC.                                                    MRKUP075
00494                                                                   MRKUP075
00495      EVALUATE TRUE                                                MRKUP075
00496        WHEN SQLCODE         = ZERO                                MRKUP075
00497        WHEN SQLCODE         = PC-ROW-NOT-FOUND                    MRKUP075
00498          CONTINUE                                                 MRKUP075
00499        WHEN OTHER                                                 MRKUP075
00500          DISPLAY PV-ABEND-PARAGRAPH                               MRKUP075
00501          PERFORM Z999-SQL-ERROR                                   MRKUP075
00502      END-EVALUATE.                                                MRKUP075
00503                                                                   MRKUP075
00504 *                                                                 MRKUP075
00505  EJECT                                                            MRKUP075
00506 ******************************************************************MRKUP075
00507 *X000-LOOK-UP-PASSWORD.                                           MRKUP075
00508 ******************************************************************MRKUP075
00509  X000-LOOK-UP-PASSWORD.                                           MRKUP075
00510 *                                                                 MRKUP075
00511      MOVE 'X000'                     TO PGM-LOCATION.             MRKUP075
00512      MOVE 'X000-LOOK-UP-PASSWORD   ' TO PV-ABEND-PARAGRAPH.       MRKUP075
00513 *                                                                 MRKUP075
00514      MOVE SPACES TO PS-END-PASSWORD-FILE                          MRKUP075
00515 *                                                                 MRKUP075
00516      PERFORM R200-READ-PASSWORD-ARRAY                             MRKUP075
00517          WITH TEST AFTER                                          MRKUP075
00518          VARYING SUB FROM 1 BY 1                                  MRKUP075
00519          UNTIL PV-USERID (SUB) = '***' OR                         MRKUP075
00520                END-PASSWORD-FILE.                                 MRKUP075
00521 *                                                                 MRKUP075
00522 ******************************************************************MRKUP075
00523 *     WRITES THE REVISED SYSTEM RECORD.                          *MRKUP075
00524 ******************************************************************MRKUP075
00525  W000-SET-VALUES-CONTROL-REC.                                     MRKUP075
00526 *                                                                 MRKUP075
00527      MOVE 'W000'                  TO PGM-LOCATION.                MRKUP075
00528      MOVE 'W000-SET-VALUES-CONTROL-REC   '                        MRKUP075
00529                                   TO PV-ABEND-PARAGRAPH.          MRKUP075
00530 *                                                                 MRKUP075
00531      MOVE PC-1                    TO U-REL-NO                     MRKUP075
00532      MOVE PC-1                    TO U-VERS-NO                    MRKUP075
00533      MOVE ZERO                    TO U-UPDATE-FLAG                MRKUP075
00534 *                                                                 MRKUP075
00535      MOVE PV-EFF-DATE             TO U-CRT-DATE                   MRKUP075
00536                                      U-EFF-DATE                   MRKUP075
00537                                      C-EFF-DATE                   MRKUP075
00538      MOVE PC-EXPIRE-DATE          TO U-EXP-DATE                   MRKUP075
00539                                      C-EXP-DATE                   MRKUP075
00540      MOVE PV-EFF-DATE             TO U-MOD-DATE                   MRKUP075
00541                                      C-MOD-DATE                   MRKUP075
00542 *                                                                 MRKUP075
00543      IF RSPBAR-RSPLVL-CDE = PC-SAN                                MRKUP075
00544         MOVE PC-Y                 TO U-ORD-ACCESS                 MRKUP075
00545      END-IF                                                       MRKUP075
00546 *                                                                 MRKUP075
00547      IF RSPBAR-RSPLVL-CDE = PC-ANL                                MRKUP075
00548         MOVE PC-U                 TO U-ORD-ACCESS                 MRKUP075
00549      END-IF                                                       MRKUP075
00550 *                                                                 MRKUP075
00551      IF RSPBAR-RSPLVL-CDE = PC-ANM                                MRKUP075
00552         MOVE PC-A                 TO U-ORD-ACCESS                 MRKUP075
00553      END-IF                                                       MRKUP075
00554 *                                                                 MRKUP075
00555      IF RSPBAR-RSPLVL-CDE = PC-MIO                                MRKUP075
00556         MOVE PC-A                 TO U-ORD-ACCESS                 MRKUP075
00557      END-IF                                                       MRKUP075
00558 *                                                                 MRKUP075
00559      MOVE PC-H5                   TO U-JOINT-SEL                  MRKUP075
00560      MOVE PC-ICC680C              TO U-JOINT-DEFAULT              MRKUP075
00561      MOVE PC-01                   TO U-INDEP-SEL                  MRKUP075
00562      MOVE PC-ICC700C              TO U-INDEP-DEFAULT              MRKUP075
00563      MOVE SPACES                  TO U-ORDER-VIEW                 MRKUP075
00564      MOVE SPACES                  TO U-ITEM-VIEW                  MRKUP075
00565 *                                                                 MRKUP075
00566 *    MOVE LOW-VALUES              TO U-TSUP-VIEW                  MRKUP075
00567 *                                    U-A2-DETAIL                  MRKUP075
00568 *                                    U-APPROVE-ON-Q1              MRKUP075
00569 *                                                                 MRKUP075
00570      MOVE PC-N                    TO U-SYS-FUNC (1)               MRKUP075
00571                                      U-SYS-FUNC (2)               MRKUP075
00572                                      U-SYS-FUNC (3)               MRKUP075
00573                                      U-SYS-FUNC (4)               MRKUP075
00574                                      U-SYS-FUNC (5)               MRKUP075
00575                                      U-SYS-FUNC (6)               MRKUP075
00576      MOVE PC-M                    TO U-UAC-FUNC (1)               MRKUP075
00577                                      U-UAC-FUNC (2)               MRKUP075
00578      MOVE PC-N                    TO U-UAC-FUNC (3)               MRKUP075
00579                                      U-UAC-FUNC (4)               MRKUP075
00580                                      U-UAC-FUNC (5)               MRKUP075
00581                                      U-UAC-FUNC (6)               MRKUP075
00582                                      U-UAC-FUNC (7)               MRKUP075
00583                                      U-UAC-FUNC (8)               MRKUP075
00584                                      U-UAC-FUNC (9)               MRKUP075
00585      MOVE PC-N                    TO U-RESET-FUNC (1)             MRKUP075
00586                                      U-RESET-FUNC (2)             MRKUP075
00587                                      U-RESET-FUNC (3)             MRKUP075
00588      MOVE PC-M                    TO U-RESET-FUNC (4)             MRKUP075
00589                                      U-RESET-FUNC (5)             MRKUP075
00590                                      U-RESET-FUNC (6)             MRKUP075
00591                                      U-RESET-FUNC (7)             MRKUP075
00592                                      U-RESET-FUNC (8)             MRKUP075
00593      MOVE PC-M                    TO U-RESET-FUNC (9)             MRKUP075
00594                                      U-RESET-FUNC (10)            MRKUP075
00595                                      U-RESET-FUNC (11)            MRKUP075
00596                                      U-RESET-FUNC (12)            MRKUP075
00597      MOVE PC-N                    TO U-POL-MISC (1)               MRKUP075
00598                                      U-POL-MISC (2)               MRKUP075
00599                                      U-POL-MISC (3)               MRKUP075
00600                                      U-POL-MISC (4)               MRKUP075
00601                                      U-POL-MISC (5)               MRKUP075
00602                                      U-POL-MISC (6)               MRKUP075
00603      MOVE PC-N                    TO U-POL-TRCD (1)               MRKUP075
00604                                      U-POL-TRCD (2)               MRKUP075
00605                                      U-POL-TRCD (3)               MRKUP075
00606                                      U-POL-TRCD (4)               MRKUP075
00607                                      U-POL-TRCD (5)               MRKUP075
00608                                      U-POL-TRCD (6)               MRKUP075
00609                                      U-POL-TRCD (7)               MRKUP075
00610                                      U-POL-TRCD (8)               MRKUP075
00611                                      U-POL-TRCD (9)               MRKUP075
00612                                      U-POL-TRCD (10)              MRKUP075
00613                                      U-POL-TRCD (11)              MRKUP075
00614                                      U-POL-TRCD (12)              MRKUP075
00615                                      U-POL-TRCD (13)              MRKUP075
00616                                      U-POL-TRCD (14)              MRKUP075
00617                                      U-POL-TRCD (15)              MRKUP075
00618                                      U-POL-TRCD (16)              MRKUP075
00619                                      U-POL-TRCD (17)              MRKUP075
00620                                      U-POL-TRCD (18)              MRKUP075
00621                                      U-POL-TRCD (19)              MRKUP075
00622                                      U-POL-TRCD (20)              MRKUP075
00623                                      U-POL-TRCD (21)              MRKUP075
00624      MOVE PC-N                    TO U-POL-GRP (1)                MRKUP075
00625                                      U-POL-GRP (2)                MRKUP075
00626                                      U-POL-GRP (3)                MRKUP075
00627                                      U-POL-GRP (4)                MRKUP075
00628                                      U-POL-GRP (5)                MRKUP075
00629                                      U-POL-GRP (6)                MRKUP075
00630      MOVE PC-M                    TO U-ROQ-DISP (1)               MRKUP075
00631      MOVE PC-N                    TO U-ROQ-DISP (2)               MRKUP075
00632                                      U-ROQ-DISP (3)               MRKUP075
00633                                      U-ROQ-DISP (4)               MRKUP075
00634                                      U-ROQ-DISP (5)               MRKUP075
00635                                      U-ROQ-DISP (6)               MRKUP075
00636      MOVE PC-N                    TO U-ROQ-HDR (1)                MRKUP075
00637                                      U-ROQ-HDR (2)                MRKUP075
00638                                      U-ROQ-HDR (3)                MRKUP075
00639                                      U-ROQ-HDR (4)                MRKUP075
00640                                      U-ROQ-HDR (5)                MRKUP075
00641                                      U-ROQ-HDR (6)                MRKUP075
00642                                      U-ROQ-HDR (7)                MRKUP075
00643                                      U-ROQ-HDR (8)                MRKUP075
00644                                      U-ROQ-HDR (9)                MRKUP075
00645      MOVE PC-M                    TO U-ROQ-ORD (1)                MRKUP075
00646      MOVE PC-N                    TO U-ROQ-ORD (2)                MRKUP075
00647                                      U-ROQ-ORD (3)                MRKUP075
00648                                      U-ROQ-ORD (4)                MRKUP075
00649                                      U-ROQ-ORD (5)                MRKUP075
00650                                      U-ROQ-ORD (6)                MRKUP075
00651                                      U-ROQ-ORD (7)                MRKUP075
00652                                      U-ROQ-ORD (8)                MRKUP075
00653                                      U-ROQ-ORD (9)                MRKUP075
00654      MOVE PC-M                    TO U-ROQ-ANAL (1)               MRKUP075
00655                                      U-ROQ-ANAL (2)               MRKUP075
00656                                      U-ROQ-ANAL (3)               MRKUP075
00657                                      U-ROQ-ANAL (4)               MRKUP075
00658      MOVE PC-N                    TO U-ROQ-ANAL (5)               MRKUP075
00659                                      U-ROQ-ANAL (6)               MRKUP075
00660      MOVE PC-M                    TO U-ROQ-TR                     MRKUP075
00661      MOVE PC-N                    TO U-POL-CORP                   MRKUP075
00662 *                                                                 MRKUP075
00663      MOVE WORKER-UID-NBR          TO U-ID-USER                    MRKUP075
00664                                      C-ID-USER                    MRKUP075
00665 *                                                                 MRKUP075
00666      IF MDSEAR-DEPT-NBR = PC-000                                  MRKUP075
00667           MOVE PC-UAR                  TO U-RCD-TYPE              MRKUP075
00668           MOVE PC-01                   TO U-ID-SYS                MRKUP075
00669           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00670           MOVE PC-1A                   TO U-ID-SYS                MRKUP075
00671           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00672           MOVE PC-2A                   TO U-ID-SYS                MRKUP075
00673           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00674           MOVE PC-3A                   TO U-ID-SYS                MRKUP075
00675           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00676           MOVE PC-4A                   TO U-ID-SYS                MRKUP075
00677           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00678           MOVE PC-5A                   TO U-ID-SYS                MRKUP075
00679           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00680           MOVE PC-6A                   TO U-ID-SYS                MRKUP075
00681           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00682           MOVE PC-7A                   TO U-ID-SYS                MRKUP075
00683           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00682           MOVE PC-1B                   TO U-ID-SYS                MRKUP075
00683           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00682           MOVE PC-4B                   TO U-ID-SYS                MRKUP075
00683           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00682           MOVE PC-02                   TO U-ID-SYS                MRKUP075
00683           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00682           MOVE PC-1D                   TO U-ID-SYS                MRKUP075
00683           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00684      ELSE                                                         MRKUP075
00685        IF RSPBAR-RSPLVL-CDE = PC-ANL                              MRKUP075
00686           MOVE PC-ACC                  TO C-RCD-TYPE              MRKUP075
00687           MOVE MDSEAR-DEPT-NBR         TO C-ID-OWNER              MRKUP075
00688           MOVE PC-SYSADMIN             TO C-USER-ID               MRKUP075
00689                                                                   MRKUP075
00690           MOVE PC-01                   TO C-ID-SYS                MRKUP075
00691           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00692           MOVE PC-1A                   TO C-ID-SYS                MRKUP075
00693           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00694           MOVE PC-2A                   TO C-ID-SYS                MRKUP075
00695           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00696           MOVE PC-3A                   TO C-ID-SYS                MRKUP075
00697           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00698           MOVE PC-4A                   TO C-ID-SYS                MRKUP075
00699           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00700           MOVE PC-5A                   TO C-ID-SYS                MRKUP075
00701           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00702           MOVE PC-6A                   TO C-ID-SYS                MRKUP075
00703           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00704           MOVE PC-7A                   TO C-ID-SYS                MRKUP075
00705           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00700           MOVE PC-1B                   TO C-ID-SYS                MRKUP075
00701           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00702           MOVE PC-4B                   TO C-ID-SYS                MRKUP075
00703           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00704           MOVE PC-02                   TO C-ID-SYS                MRKUP075
00705           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00700           MOVE PC-1D                   TO C-ID-SYS                MRKUP075
00701           PERFORM W101-WRITE-CONTROL-REC                          MRKUP075
00706 *                                                                    CL**2
00707           MOVE PC-UAR                  TO U-RCD-TYPE              MRKUP075
00708           MOVE PC-01                   TO U-ID-SYS                MRKUP075
00709           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00710           MOVE PC-1A                   TO U-ID-SYS                MRKUP075
00711           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00712           MOVE PC-2A                   TO U-ID-SYS                MRKUP075
00713           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00714           MOVE PC-3A                   TO U-ID-SYS                MRKUP075
00715           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00716           MOVE PC-4A                   TO U-ID-SYS                MRKUP075
00717           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00718           MOVE PC-5A                   TO U-ID-SYS                MRKUP075
00719           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00720           MOVE PC-6A                   TO U-ID-SYS                MRKUP075
00721           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00722           MOVE PC-7A                   TO U-ID-SYS                MRKUP075
00723           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00718           MOVE PC-1B                   TO U-ID-SYS                MRKUP075
00719           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00720           MOVE PC-4B                   TO U-ID-SYS                MRKUP075
00721           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00722           MOVE PC-02                   TO U-ID-SYS                MRKUP075
00723           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00718           MOVE PC-1D                   TO U-ID-SYS                MRKUP075
00719           PERFORM W100-WRITE-CONTROL-REC                          MRKUP075
00724        END-IF                                                     MRKUP075
00725      END-IF.                                                      MRKUP075
00726 *                                                                 MRKUP075
00727  EJECT                                                            MRKUP075
00728 ******************************************************************MRKUP075
00729 *W100-WRITE-CONTROL-REC.                                          MRKUP075
00730 ******************************************************************MRKUP075
00731  W100-WRITE-CONTROL-REC.                                          MRKUP075
00732 *                                                                 MRKUP075
00733      MOVE 'W100'                  TO PGM-LOCATION.                MRKUP075
00734      MOVE 'W100-WRITE-CONTROL-REC        '                        MRKUP075
00735                                   TO PV-ABEND-PARAGRAPH.          MRKUP075
00736 *                                                                 MRKUP075
00737      WRITE ICCTL-CNTL-REC-UAR   FROM SYSTEM-RECORD-UAR            MRKUP075
00738 *                                                                 MRKUP075
00739      IF (PV-VSAM-SUCCESSFUL                                       MRKUP075
00740      OR  PV-VSAM-DUPLICATE                                        MRKUP075
00741      OR  PV-VSAM-NOT-FOUND)                                       MRKUP075
00742         CONTINUE                                                  MRKUP075
00743      ELSE                                                         MRKUP075
00744         DISPLAY '** ABEND **'                                     MRKUP075
00745         DISPLAY '** PROGRAM    = MRKUP075'                        MRKUP075
00746         DISPLAY '** PARAGRAPH  = W100-WRITE-CONTROL-REC     '     MRKUP075
00747         DISPLAY '** MESSAGE    = '                                MRKUP075
00748                 'BAD VSAM WRITE,STATUS = ' PV-VSAM-STATUS         MRKUP075
00749         DISPLAY '** KEY        = ' ICCTL-KEY-UAR                  MRKUP075
00750         MOVE +4005              TO PV-ABEND-CODE                  MRKUP075
00751         CALL 'ILBOABN0'         USING PV-ABEND-CODE               MRKUP075
00752      END-IF.                                                      MRKUP075
00753 *                                                                 MRKUP075
00754  EJECT                                                            MRKUP075
00755 ******************************************************************MRKUP075
00756 *W101-WRITE-CONTROL-REC.                                          MRKUP075
00757 ******************************************************************MRKUP075
00758  W101-WRITE-CONTROL-REC.                                          MRKUP075
00759 *                                                                 MRKUP075
00760      MOVE 'W101'                  TO PGM-LOCATION.                MRKUP075
00761      MOVE 'W101-WRITE-CONTROL-REC        '                        MRKUP075
00762                                   TO PV-ABEND-PARAGRAPH.          MRKUP075
00763 *                                                                 MRKUP075
00764      WRITE ICCTL-CNTL-REC-ACC   FROM SYSTEM-RECORD-ACC            MRKUP075
00765 *                                                                 MRKUP075
00766      IF (PV-VSAM-SUCCESSFUL                                       MRKUP075
00767      OR  PV-VSAM-DUPLICATE                                        MRKUP075
00768      OR  PV-VSAM-NOT-FOUND)                                       MRKUP075
00769         CONTINUE                                                  MRKUP075
00770      ELSE                                                         MRKUP075
00771         DISPLAY '** ABEND **'                                     MRKUP075
00772         DISPLAY '** PROGRAM    = MRKUP075'                        MRKUP075
00773         DISPLAY '** PARAGRAPH  = W101-WRITE-CONTROL-REC     '     MRKUP075
00774         DISPLAY '** MESSAGE    = '                                MRKUP075
00775                 'BAD VSAM WRITE,STATUS = ' PV-VSAM-STATUS         MRKUP075
00776         DISPLAY '** KEY        = ' ICCTL-KEY-ACC                  MRKUP075
00777         MOVE +4005              TO PV-ABEND-CODE                  MRKUP075
00778         CALL 'ILBOABN0'         USING PV-ABEND-CODE               MRKUP075
00779      END-IF.                                                      MRKUP075
00780 *                                                                 MRKUP075
00781 ******************************************************************MRKUP075
00782 *   CLOSES FILES AND DISPLAYS MESSAGES.                          *MRKUP075
00783 ******************************************************************MRKUP075
00784  Y100-END-ROUTINE.                                                MRKUP075
00785 *                                                                 MRKUP075
00786      CLOSE  ICCTL-CNTL-FILE-UAR                                   MRKUP075
00787             ICCTL-CNTL-FILE-ACC.                                  MRKUP075
00788 *                                                                 MRKUP075
00789  EJECT                                                            MRKUP075
00790 ******************************************************************MRKUP075
00791 *     SQL WARNING OR ERROR PROCESSING                            *MRKUP075
00792 *                                                                *MRKUP075
00793 ******************************************************************MRKUP075
00794                                                                   MRKUP075
00795  Z999-SQL-ERROR.                                                  MRKUP075
00796                                                                   MRKUP075
00797      MOVE SQLCODE    TO SQLCODE2.                                 MRKUP075
00798      MOVE SQLERRD(3) TO SQLERRD3.                                 MRKUP075
00799      DISPLAY '** ABEND **       ** = SQLERROR'.                   MRKUP075
MK         DISPLAY '** PROGRAM        ** = MRKUP075'.                   MRKUP075
00801      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  MRKUP075
00802      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  MRKUP075
00803      DISPLAY '** SQLERRM        ** = ' SQLERRM.                   MRKUP075
00804      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  MRKUP075
00805                                                                   MRKUP075
00806      MOVE +4013 TO PV-ABEND-CODE.                                 MRKUP075
00807      CALL 'ILBOABN0' USING PV-ABEND-CODE.                         MRKUP075
00808                                                                   MRKUP075
00809 ******************************************************************MRKUP075
