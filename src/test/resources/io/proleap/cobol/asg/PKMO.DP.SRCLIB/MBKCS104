000100*                                                                 00010000
000200*                                                                 00020000
000300*                                                                 00030000
000400 IDENTIFICATION DIVISION.                                         00040000
000500                                                                  00050000
000600 PROGRAM-ID.    MBKCS104.                                         00060000
000700 AUTHOR.        MICHELLE WEBB.                                    00070000
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00080000
000900 DATE-WRITTEN.  09-25-91.                                         00090000
001000 DATE-COMPILED.                                                   00100000
001100                                                                  00110000
001200***************************************************************** 00120000
001300*    GENERIC TEMPLATE PROGRAM                                     00130000
001400*                                                                 00140000
001500*    NOTE THAT PC VALUES CONTAIN MNEMONIC NAMES THAT MAY NEED     00150000
001600*    TO BE CHANGED. TSQ PC WOULD NEED TO BE CHANGED HERE          00160000
001700*                                                                 00170000
001800***************************************************************** 00180000
001900* 10/08/97 - PAUL KEBER/STRATAGEM - WR# 5280                      00190000
002000*   PREVENT THE ENTRY OF UNDERSCORES IN DESCRIPTION ENTRY FIELDS  00200000
002100*   IN ORDER TO PREVENT PROBLEMS LOADING DATA WAREHOUSE DB2PE     00210000
002200*   TABLE INFORMATION.                                            00220000
002300***************************************************************** 00230000
002400***************************************************************** 00240000
002500* 08/17/98 - DAVE METZGER - WR# 5701                              00250000
002600*   INCREASED TEMP STORAGE QUEUE FROM 250 BYTES TO 275 BYTES      00260000
002700*   BECAUSE MBWS104 INCREASED.                                    00270000
002800***************************************************************** 00280000
C14666* 07/10/12 - RAVIKUMAR GUNTHA     - CRQ000000014666               00282000
C14666*   RECOMPILED THE PROGRAM DUE TO A CHANGE IN MBWS104             00283000
C14666***************************************************************** 00284000
262978* CHANGED 10/21/2021    BY JIM HUNTER      WR: CHG0262978         00285008
262978* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00286008
262978* MAKING THE CALL DYNAMIC VS STATIC.                              00287008
262978******************************************************************00288008
002900                                                                  00290000
003000*                                                                 00300000
003100*                                                                 00310000
003200*                                                                 00320000
003300 ENVIRONMENT DIVISION.                                            00330000
003400*                                                                 00340000
003500*                                                                 00350000
003600*                                                                 00360000
003700 DATA DIVISION.                                                   00370000
003800*                                                                 00380000
003900*                                                                 00390000
004000 WORKING-STORAGE SECTION.                                         00400000
004100                                                                  00410000
004200 01  PC-PROGRAM-CONSTANTS.                                        00420000
004300     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00430000
004400     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00440000
004500                                                     COMP SYNC.   00450000
004600     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00460000
004700     'MB104A  '.                                                  00470000
004800     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00480000
004900     'MBKM104 '.                                                  00490000
005000     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00500000
005100     'MBKCS104'.                                                  00510000
005200     05  PC-COMPANY-NUMBER              PIC X(02)    VALUE '03'.  00520000
005300     05  PC-YEAR-DAYS                   PIC 9(04)    VALUE 365.   00530000
005400     05  PC-TSQ-LENGTH                  PIC S9(4)    VALUE +275   00540000
005500                                                     COMP SYNC.   00550000
005600     05  PC-ADD-GMA                     PIC X(08)                 00560000
005700                                        VALUE 'MBAGM01 '.         00570000
005800     05  PC-ADD-DMA                     PIC X(08)                 00580000
005900                                        VALUE 'MBADM01 '.         00590000
006000     05  PC-ADD-DPT                     PIC X(08)                 00600000
006100                                        VALUE 'MBADP01 '.         00610000
006200     05  PC-ADD-MCL                     PIC X(08)                 00620000
006300                                        VALUE 'MBAMC01 '.         00630000
006400     05  PC-ADD-SCL                     PIC X(08)                 00640000
006500                                        VALUE 'MBASC01 '.         00650000
006600     05  PC-INFINITY-DATE               PIC 9(08)                 00660000
006700                                          VALUE 99990909.         00670000
006800     05  PC-MAX-RETRIES                 PIC 9(02)    VALUE 3.     00680000
006900     05  PC-TSYMSG-00005                PIC 9(05)    VALUE 00005. 00690000
007000     05  PC-TSYMSG-00007                PIC 9(05)    VALUE 00007. 00700000
007100     05  PC-TSYMSG-00008                PIC 9(05)    VALUE 00008. 00710000
007200     05  PC-TSYMSG-00009                PIC 9(05)    VALUE 00009. 00720000
007300     05  PC-TSYMSG-00010                PIC 9(05)    VALUE 00010. 00730000
007400     05  PC-TSYMSG-00025                PIC 9(05)    VALUE 00025. 00740000
007500     05  PC-TSYMSG-00030                PIC 9(05)    VALUE 00030. 00750000
007600     05  PC-TSYMSG-00031                PIC 9(05)    VALUE 00031. 00760000
007700     05  PC-TSYMSG-00032                PIC 9(05)    VALUE 00032. 00770000
007800     05  PC-TSYMSG-00034                PIC 9(05)    VALUE 00034. 00780000
007900     05  PC-TSYMSG-00067                PIC 9(05)    VALUE 00067. 00790000
008000     05  PC-TSYMSG-00076                PIC 9(05)    VALUE 00076. 00800000
008100     05  PC-TSYMSG-00077                PIC 9(05)    VALUE 00077. 00810000
008200     05  PC-TSYMSG-00078                PIC 9(05)    VALUE 00078. 00820000
008300     05  PC-TSYMSG-00079                PIC 9(05)    VALUE 00079. 00830000
008400     05  PC-TSYMSG-00138                PIC 9(05)    VALUE 00138. 00840000
008500     05  PC-TSYMSG-00143                PIC 9(05)    VALUE 00143. 00850000
008600     05  PC-TSYMSG-00144                PIC 9(05)    VALUE 00144. 00860000
008700     05  PC-TSYMSG-00145                PIC 9(05)    VALUE 00145. 00870000
008800     05  PC-TSYMSG-00183                PIC 9(05)    VALUE 00183. 00880000
008900     05  PC-TSYMSG-00184                PIC 9(05)    VALUE 00184. 00890000
009000     05  PC-TSYMSG-00185                PIC 9(05)    VALUE 00185. 00900000
009100     05  PC-TSYMSG-01643                PIC 9(05)    VALUE 01643. 00910000
009200     05  PC-TSYMSG-99901                PIC 9(05)    VALUE 99901. 00920000
009300                                                                  00930000
009400 01  PK-PRIMARY-KEYS.                                             00940000
009500     05  PK-OPERCO-NBR                  PIC X(02)    VALUE SPACES.00950000
009600     05  PK-GMA-NBR                     PIC X(02)    VALUE SPACES.00960000
009700     05  PK-DMA-NBR                     PIC X(02)    VALUE SPACES.00970000
009800     05  PK-DEPT-NBR                    PIC X(03)    VALUE SPACES.00980000
009900     05  PK-MAJ-CL-NBR                  PIC X(02)    VALUE SPACES.00990000
010000     05  PK-SUB-CL-NBR                  PIC X(03)    VALUE SPACES.01000000
010100     05  PK-MDSELV-CDE                  PIC X(03)    VALUE SPACES.01010000
010200     05  PK-END-DTE                     PIC X(10)    VALUE SPACES.01020000
010300                                                                  01030000
010400 01  PS-PROGRAM-SWITCHES.                                         01040000
010500     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   01050000
010600         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   01060000
010700         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   01070000
010800         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   01080000
010900         88  PS-SEND-DATA-ONLY                       VALUE '4'.   01090000
011000         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   01100000
011100         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   01110000
011200     05  PS-NEED-ROW-SW                 PIC X(01)    VALUE 'N'.   01120000
011300         88  PS-NEED-ROW                             VALUE 'Y'.   01130000
011400         88  PS-NO-NEED-ROW                          VALUE 'N'.   01140000
011500     05  PS-NEED-DESCRIP-SW             PIC X(01)    VALUE 'N'.   01150000
011600         88  PS-NEED-DESCRIP                         VALUE 'Y'.   01160000
011700         88  PS-NO-NEED-DESCRIP                      VALUE 'N'.   01170000
011800     05  PS-DATA-ERROR-SW               PIC X(01)    VALUE 'N'.   01180000
011900         88  PS-DATA-ERROR                           VALUE 'Y'.   01190000
012000         88  PS-NO-DATA-ERROR                        VALUE 'N'.   01200000
012100     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01210000
012200         88  PS-ERROR                                VALUE 'Y'.   01220000
012300         88  PS-NO-ERROR                             VALUE 'N'.   01230000
012400     05  PS-END-DATE-ERROR-SW           PIC X(01)    VALUE 'N'.   01240000
012500         88  PS-END-DATE-ERROR                       VALUE 'Y'.   01250000
012600         88  PS-NO-END-DATE-ERROR                    VALUE 'N'.   01260000
012700     05  PS-STRT-DATE-ERROR-SW          PIC X(01)    VALUE 'N'.   01270000
012800         88  PS-STRT-DATE-ERROR                      VALUE 'Y'.   01280000
012900         88  PS-NO-STRT-DATE-ERROR                   VALUE 'N'.   01290000
013000     05  PS-INTER-APPL-SW               PIC X(01)    VALUE 'N'.   01300000
013100         88  PS-INTER-APPL-VALID                     VALUE 'Y'.   01310000
013200         88  PS-INTER-APPL-INVALID                   VALUE 'N'.   01320000
013300     05  PS-ROW-FND-SW                  PIC X(01)    VALUE 'N'.   01330000
013400         88  PS-ROW-FOUND                            VALUE 'Y'.   01340000
013500         88  PS-NO-ROW-FOUND                         VALUE 'N'.   01350000
013600     05  PS-GMA-EDIT-SW                 PIC X(01)    VALUE 'N'.   01360000
013700         88  PS-GMA-PASS-EDIT                        VALUE 'Y'.   01370000
013800         88  PS-GMA-NEED-EDIT                        VALUE 'N'.   01380000
013900     05  PS-DMA-EDIT-SW                 PIC X(01)    VALUE 'N'.   01390000
014000         88  PS-DMA-PASS-EDIT                        VALUE 'Y'.   01400000
014100         88  PS-DMA-NEED-EDIT                        VALUE 'N'.   01410000
014200     05  PS-DPT-EDIT-SW                 PIC X(01)    VALUE 'N'.   01420000
014300         88  PS-DPT-PASS-EDIT                        VALUE 'Y'.   01430000
014400         88  PS-DPT-NEED-EDIT                        VALUE 'N'.   01440000
014500     05  PS-MCL-EDIT-SW                 PIC X(01)    VALUE 'N'.   01450000
014600         88  PS-MCL-PASS-EDIT                        VALUE 'Y'.   01460000
014700         88  PS-MCL-NEED-EDIT                        VALUE 'N'.   01470000
014800     05  PS-SCL-EDIT-SW                 PIC X(01)    VALUE 'N'.   01480000
014900         88  PS-SCL-PASS-EDIT                        VALUE 'Y'.   01490000
015000         88  PS-SCL-NEED-EDIT                        VALUE 'N'.   01500000
015100                                                                  01510000
015200 01  PV-PROGRAM-VARIABLES.                                        01520000
015300     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     01530000
015400                                                     COMP SYNC.   01540000
015500     05  PV-MSG-NUMBER-X                PIC X(05)    VALUE SPACES.01550000
015600     05  PV-LEVEL-INDEX                 PIC 9(01)    VALUE 0.     01560000
015700         88  PV-INDEX-CO-LEVEL                       VALUE 0.     01570000
015800         88  PV-INDEX-GMA-LEVEL                      VALUE 1.     01580000
015900         88  PV-INDEX-DMA-LEVEL                      VALUE 2.     01590000
016000         88  PV-INDEX-DPT-LEVEL                      VALUE 3.     01600000
016100         88  PV-INDEX-MCL-LEVEL                      VALUE 4.     01610000
016200         88  PV-INDEX-SCL-LEVEL                      VALUE 5.     01620000
016300     05  PV-LEVEL-DESC                  PIC 9(01)    VALUE 0.     01630000
016400         88  PV-GMA-DESC                             VALUE 1.     01640000
016500         88  PV-DMA-DESC                             VALUE 2.     01650000
016600         88  PV-DPT-DESC                             VALUE 3.     01660000
016700         88  PV-MCL-DESC                             VALUE 4.     01670000
016800         88  PV-SCL-DESC                             VALUE 5.     01680000
016900     05  PV-RETRY-COUNTER               PIC 9(02)    VALUE 0.     01690000
017000     05  PV-LEVEL-INDEX-END             PIC 9(01)    VALUE 0.     01700000
017100     05  PV-MDSEAR-COUNT                PIC S9(03)V  VALUE 0      01710000
017200                                                     COMP-3.      01720000
017300     05  PV-DATE                        PIC 9(08)    VALUE 0.     01730000
017400     05  FILLER REDEFINES PV-DATE.                                01740000
017500         10 PV-CENT                     PIC 9(02).                01750000
017600         10 PV-YEAR                     PIC 9(02).                01760000
017700         10 PV-MONTH                    PIC 9(02).                01770000
017800         10 PV-DAY                      PIC 9(02).                01780000
017900                                                                  01790000
018000     05  PV-DATE2                       PIC 9(08)    VALUE 0.     01800000
018100     05  FILLER REDEFINES PV-DATE2.                               01810000
018200         10 PV-CENT-2                   PIC 9(02).                01820000
018300         10 PV-YEAR-2                   PIC 9(02).                01830000
018400         10 PV-MONTH-2                  PIC 9(02).                01840000
018500         10 PV-DAY-2                    PIC 9(02).                01850000
018600     05  PV-TMP-DATE.                                             01860000
018700         10 PV-TMP-DATE-CC              PIC 9(02).                01870000
018800         10 PV-TMP-DATE-YY              PIC 9(02).                01880000
018900         10 PV-TMP-DATE-MM              PIC 9(02).                01890000
019000         10 PV-TMP-DATE-DD              PIC 9(02).                01900000
019100                                                                  01910000
019200     05  PV-ORIG-FIELDS.                                          01920000
019300         20 PV-ORIG-COMPANY-NO          PIC X(02)    VALUE SPACES.01930000
019400         20 PV-ORIG-GMA-NO              PIC X(02)    VALUE SPACES.01940000
019500         20 PV-ORIG-DMA-NO              PIC X(02)    VALUE SPACES.01950000
019600         20 PV-ORIG-DPT-NO              PIC X(03)    VALUE SPACES.01960000
019700         20 PV-ORIG-MCL-NO              PIC X(02)    VALUE SPACES.01970000
019800         20 PV-ORIG-SCL-NO              PIC X(03)    VALUE SPACES.01980000
019900         20 PV-ORIG-MDSE-LEVEL          PIC X(03)    VALUE SPACES.01990000
020000     05  PV-SAVE-ADD-LEVEL              PIC 9(01)    VALUE ZERO.  02000000
020100     05  PV-SAVE-GMA                    PIC X(02)    VALUE SPACES.02010000
020200     05  PV-SAVE-GMA-DESC               PIC X(25)    VALUE SPACES.02020000
020300     05  PV-SAVE-DMA                    PIC X(02)    VALUE SPACES.02030000
020400     05  PV-SAVE-DMA-DESC               PIC X(25)    VALUE SPACES.02040000
020500     05  PV-SAVE-DPT                    PIC X(03)    VALUE SPACES.02050000
020600     05  PV-SAVE-DPT-DESC               PIC X(25)    VALUE SPACES.02060000
020700     05  PV-SAVE-MCL                    PIC X(02)    VALUE SPACES.02070000
020800     05  PV-SAVE-MCL-DESC               PIC X(25)    VALUE SPACES.02080000
020900     05  PV-SAVE-SCL                    PIC X(03)    VALUE SPACES.02090000
021000     05  PV-SAVE-SCL-DESC               PIC X(25)    VALUE SPACES.02100000
021100     05  PV-WHERE-FROM                  PIC X        VALUE SPACES.02110000
021200                                                                  02120000
021300     05  PV-ITEM-NBR                    PIC S9(04)                02130000
021400                                            COMP SYNC VALUE +1.   02140000
021500     05  PV-UNDERSCORE-COUNT            PIC S9(04)   VALUE +0     02150000
021600                                                     COMP SYNC.   02160000
021700     05  PV-WORK-DATE.                                            02170000
021800         10  PV-WORK-CC                 PIC X(02)    VALUE SPACES.02180000
021900         10  PV-WORK-YY                 PIC X(02)    VALUE SPACES.02190000
022000         10  FILLER                     PIC X        VALUE '-'.   02200000
022100         10  PV-WORK-MM                 PIC X(02)    VALUE SPACES.02210000
022200         10  FILLER                     PIC X        VALUE '-'.   02220000
022300         10  PV-WORK-DD                 PIC X(02)    VALUE SPACES.02230000
022400 EJECT                                                            02240000
022500***************************************************************** 02250000
022600*    MERCHANDISE AREA DB2 TABLE DEFINITION                        02260000
022700***************************************************************** 02270000
022800                                                                  02280000
022900     EXEC SQL                                                     02290000
023000         INCLUDE TMDSEAR                                          02300000
023100     END-EXEC.                                                    02310000
023200******************************************************************02320000
023300* DB2 GMA CURSOR                                                  02330000
023400******************************************************************02340000
023500         EXEC SQL                                                 02350000
023600            DECLARE GMA_CURSOR CURSOR FOR                         02360000
023700            SELECT GMA_NBR,                                       02370000
023800                    DMA_NBR,                                      02380000
023900                    DEPT_NBR,                                     02390000
024000                    MAJ_CL_NBR,                                   02400000
024100                    SUB_CL_NBR,                                   02410000
024200                    MDSEAR_DESC,                                  02420000
024300                    STRT_DTE,                                     02430000
024400                    END_DTE,                                      02440000
024500                    MDSEAR_DKEY,                                  02450000
024600                    BYR_NBR,                                      02460000
024700                    GEN_MDSE_TYP_CDE                              02470000
024800             FROM   TMDSEAR                                       02480000
024900             WHERE ((OPERCO_NBR    = :PK-OPERCO-NBR) AND          02490000
025000                    (GMA_NBR       = :PK-GMA-NBR)    AND          02500000
025100                    (MDSELV_CDE    = :PK-MDSELV-CDE) AND          02510000
025200                    (END_DTE       > :PK-END-DTE))                02520000
025300         END-EXEC.                                                02530000
025400******************************************************************02540000
025500* DB2 DMA CURSOR                                                  02550000
025600******************************************************************02560000
025700         EXEC SQL                                                 02570000
025800             DECLARE DMA_CURSOR CURSOR FOR                        02580000
025900             SELECT GMA_NBR,                                      02590000
026000                    DMA_NBR,                                      02600000
026100                    DEPT_NBR,                                     02610000
026200                    MAJ_CL_NBR,                                   02620000
026300                    SUB_CL_NBR,                                   02630000
026400                    MDSEAR_DESC,                                  02640000
026500                    STRT_DTE,                                     02650000
026600                    END_DTE,                                      02660000
026700                    MDSEAR_DKEY,                                  02670000
026800                    BYR_NBR,                                      02680000
026900                    GEN_MDSE_TYP_CDE                              02690000
027000             FROM   TMDSEAR                                       02700000
027100             WHERE ((OPERCO_NBR    = :PK-OPERCO-NBR) AND          02710000
027200                    (DMA_NBR       = :PK-DMA-NBR)    AND          02720000
027300                    (MDSELV_CDE    = :PK-MDSELV-CDE) AND          02730000
027400                    (END_DTE       > :PK-END-DTE))                02740000
027500         END-EXEC.                                                02750000
027600******************************************************************02760000
027700* DB2 DEPARTMENT CURSOR                                           02770000
027800******************************************************************02780000
027900         EXEC SQL                                                 02790000
028000             DECLARE DEPT_CURSOR CURSOR FOR                       02800000
028100             SELECT GMA_NBR,                                      02810000
028200                    DMA_NBR,                                      02820000
028300                    DEPT_NBR,                                     02830000
028400                    MAJ_CL_NBR,                                   02840000
028500                    SUB_CL_NBR,                                   02850000
028600                    MDSEAR_DESC,                                  02860000
028700                    STRT_DTE,                                     02870000
028800                    END_DTE,                                      02880000
028900                    MDSEAR_DKEY,                                  02890000
029000                    BYR_NBR,                                      02900000
029100                    GEN_MDSE_TYP_CDE                              02910000
029200             FROM   TMDSEAR                                       02920000
029300             WHERE ((OPERCO_NBR    = :PK-OPERCO-NBR) AND          02930000
029400                    (DEPT_NBR      = :PK-DEPT-NBR)    AND         02940000
029500                    (MDSELV_CDE    = :PK-MDSELV-CDE) AND          02950000
029600                    (END_DTE       > :PK-END-DTE))                02960000
029700         END-EXEC.                                                02970000
029800******************************************************************02980000
029900* DB2 CLASS CURSOR                                                02990000
030000******************************************************************03000000
030100         EXEC SQL                                                 03010000
030200             DECLARE CLASS_CURSOR CURSOR FOR                      03020000
030300             SELECT GMA_NBR,                                      03030000
030400                    DMA_NBR,                                      03040000
030500                    DEPT_NBR,                                     03050000
030600                    MAJ_CL_NBR,                                   03060000
030700                    SUB_CL_NBR,                                   03070000
030800                    MDSEAR_DESC,                                  03080000
030900                    STRT_DTE,                                     03090000
031000                    END_DTE,                                      03100000
031100                    MDSEAR_DKEY,                                  03110000
031200                    BYR_NBR,                                      03120000
031300                    GEN_MDSE_TYP_CDE                              03130000
031400             FROM   TMDSEAR                                       03140000
031500             WHERE ((OPERCO_NBR    = :PK-OPERCO-NBR) AND          03150000
031600                    (DEPT_NBR      = :PK-DEPT-NBR)    AND         03160000
031700                    (MAJ_CL_NBR    = :PK-MAJ-CL-NBR)    AND       03170000
031800                    (SUB_CL_NBR    = :PK-SUB-CL-NBR)    AND       03180000
031900                    (MDSELV_CDE    = :PK-MDSELV-CDE) AND          03190000
032000                    (END_DTE       > :PK-END-DTE))                03200000
032100         END-EXEC                                                 03210000
032200***************************************************************** 03220000
032300*    STANDARD COMMAREA.                                           03230000
032400***************************************************************** 03240000
032500                                                                  03250000
032600     COPY DPWS020.                                                03260000
032700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03270000
032800                                                                  03280000
032900***************************************************************** 03290000
033000*    INTER-APPLICATION COMMAREA.                                  03300000
033100***************************************************************** 03310000
033200                                                                  03320000
033300         10  INTER-APPL-COMM-AREA       PIC X(200).               03330000
033400     COPY MBWS005.                                                03340000
033500                                                                  03350000
033600***************************************************************** 03360000
033700*   THIS IS THE APPLICATION SPECIFIC COMMUNICATION AREA FOR      *03370000
033800*   PROGRAM MBKCS104.   2865 BYTES                               *03380000
033900******************************************************************03390000
034000         10  ASC-APPL-SPEC-COMMAREA.                              03400000
034100             15  FILLER                      PIC X(02).           03410000
034200             15  ASC-INTER-APPL-FORMAT-CODE  PIC X(04).           03420000
034300*                                                                 03430000
034400             15  ASC-ADD-MDSE-LEVEL          PIC 9(01).           03440000
034500                 88 ASC-ADD-GMA              VALUE 1.             03450000
034600                 88 ASC-ADD-DMA              VALUE 2.             03460000
034700                 88 ASC-ADD-DPT              VALUE 3.             03470000
034800                 88 ASC-ADD-MCL              VALUE 4.             03480000
034900                 88 ASC-ADD-SCL              VALUE 5.             03490000
035000*                                                                 03500000
035100             15  ASC-DESCRIPTIONS-FILLED-SW  PIC X(01).           03510000
035200                 88 ASC-DESCRIP-FILLED       VALUE 'Y'.           03520000
035300                 88 ASC-DESCRIP-NOT-FILLED   VALUE 'N'.           03530000
035400*                                                                 03540000
035500             15  ASC-KEY-PROTECTED-SW        PIC X(01).           03550000
035600                 88 ASC-KEY-PROTECTED        VALUE 'Y'.           03560000
035700                 88 ASC-KEY-NOT-PROTECTED    VALUE 'N'.           03570000
035800*                                                                 03580000
035900             15  ASC-SCREEN-FIELDS.                               03590000
036000*                                                                 03600000
036100                 20 ASC-SCRN-GMA-NO          PIC X(02).           03610000
036200                 20 FILLER REDEFINES ASC-SCRN-GMA-NO.             03620000
036300                    25 ASC-SCRN-GMA-NO-N     PIC 9(02).           03630000
036400                 20 ASC-GMA-DESC             PIC X(25).           03640000
036500*                                                                 03650000
036600                 20 ASC-SCRN-DMA-NO          PIC X(02).           03660000
036700                 20 FILLER REDEFINES ASC-SCRN-DMA-NO.             03670000
036800                    25 ASC-SCRN-DMA-NO-N     PIC 9(02).           03680000
036900                 20 ASC-DMA-DESC             PIC X(25).           03690000
037000*                                                                 03700000
037100                 20 ASC-SCRN-DPT-NO          PIC X(03).           03710000
037200                 20 FILLER REDEFINES ASC-SCRN-DPT-NO.             03720000
037300                    25 ASC-SCRN-DPT-NO-N     PIC 9(03).           03730000
037400                 20 ASC-DPT-DESC             PIC X(25).           03740000
037500*                                                                 03750000
037600                 20 ASC-SCRN-MCL-NO          PIC X(02).           03760000
037700                 20 FILLER REDEFINES ASC-SCRN-MCL-NO.             03770000
037800                    25 ASC-SCRN-MCL-NO-N     PIC 9(02).           03780000
037900                 20 FILLER REDEFINES ASC-SCRN-MCL-NO.             03790000
038000                    25 ASC-MCL-DIGIT-1       PIC 9.               03800000
038100                    25 ASC-MCL-DIGIT-2       PIC 9.               03810000
038200                 20 ASC-MCL-DESC             PIC X(25).           03820000
038300*                                                                 03830000
038400                 20 ASC-SCRN-SCL-NO          PIC X(03).           03840000
038500                 20 FILLER REDEFINES ASC-SCRN-SCL-NO.             03850000
038600                    25 ASC-SCRN-SCL-NO-N     PIC 9(03).           03860000
038700                 20 FILLER REDEFINES ASC-SCRN-SCL-NO.             03870000
038800                    25 ASC-SCL-DIGIT-1       PIC 9(01).           03880000
038900                    25 ASC-SCL-DIGIT-2       PIC 9(01).           03890000
039000                    25 ASC-SCL-DIGIT-3       PIC 9(01).           03900000
039100                 20 ASC-SCL-DESC             PIC X(25).           03910000
039200*                                                                 03920000
039300                 20 ASC-SCRN-STRT-YYYYMMDD   PIC X(08).           03930000
039400                 20 FILLER REDEFINES ASC-SCRN-STRT-YYYYMMDD.      03940000
039500                    25  ASC-SCRN-STRT-CC-X   PIC X(02).           03950000
039600                    25  ASC-SCRN-STRT-DTE-X PIC X(06).            03960000
039700                    25 FILLER REDEFINES ASC-SCRN-STRT-DTE-X.      03970000
039800                        30  ASC-SCRN-STRT-YY-X PIC X(02).         03980000
039900                        30  ASC-SCRN-STRT-MM-X PIC X(02).         03990000
040000                        30  ASC-SCRN-STRT-DD-X PIC X(02).         04000000
040100                 20 ASC-SCRN-STRT-YYYYMMDD-N REDEFINES            04010000
040200                          ASC-SCRN-STRT-YYYYMMDD.                 04020000
040300                    25  ASC-SCRN-STRT-DTE-CC PIC 9(02).           04030000
040400                    25  ASC-SCRN-STRT-DTE    PIC 9(06).           04040000
040500                    25  FILLER REDEFINES ASC-SCRN-STRT-DTE.       04050000
040600                        30  ASC-SCRN-STRT-YY PIC 9(02).           04060000
040700                        30  ASC-SCRN-STRT-MM PIC 9(02).           04070000
040800                        30  ASC-SCRN-STRT-DD PIC 9(02).           04080000
040900*                                                                 04090000
041000*                                                                 04100000
041100                                                                  04110000
041200                 20 ASC-SCRN-END-YYYYMMDD    PIC X(08).           04120000
041300                 20 FILLER REDEFINES ASC-SCRN-END-YYYYMMDD.       04130000
041400                    25  ASC-SCRN-END-CC-X    PIC X(02).           04140000
041500                    25  ASC-SCRN-END-DTE-X   PIC X(06).           04150000
041600                    25 FILLER REDEFINES ASC-SCRN-END-DTE-X.       04160000
041700                        30  ASC-SCRN-END-YY-X PIC X(02).          04170000
041800                        30  ASC-SCRN-END-MM-X PIC X(02).          04180000
041900                        30  ASC-SCRN-END-DD-X PIC X(02).          04190000
042000                 20 ASC-SCRN-END-YYYYMMDD-N REDEFINES             04200000
042100                          ASC-SCRN-END-YYYYMMDD.                  04210000
042200                    25  ASC-SCRN-END-DTE-CC  PIC 9(02).           04220000
042300                    25  ASC-SCRN-END-DTE     PIC 9(06).           04230000
042400                    25  FILLER REDEFINES ASC-SCRN-END-DTE.        04240000
042500                        30  ASC-SCRN-END-YY  PIC 9(02).           04250000
042600                        30  ASC-SCRN-END-MM  PIC 9(02).           04260000
042700                        30  ASC-SCRN-END-DD  PIC 9(02).           04270000
042800*                                                                 04280000
042900*                                                                 04290000
043000                 20 ASC-SCRN-GEN-MDSETYP     PIC X.               04300000
043100                    88  ASC-MDSE-TYPE-HARDLN VALUE '1'.           04310000
043200                    88  ASC-MDSE-TYPE-SOFTLN VALUE '2'.           04320000
043300                    88  ASC-MDSE-TYPE-MISC   VALUE '0'.           04330000
043400                    88  ASC-VALID-MDSE-TYPE  VALUE '0',           04340000
043500                                                   '1', '2'.      04350000
043600                 20 ASC-SCRN-BYR-NBR         PIC XXX.             04360000
043700                 20 FILLER REDEFINES ASC-SCRN-BYR-NBR.            04370000
043800                    25 ASC-SCRN-BYR-NBR-N    PIC 9(03).           04380000
043900*                                                                 04390000
044000             15  ASC-EDIT-SWITCHES.                               04400000
044100                 20 ASC-EDIT-KEY-DATA-SW     PIC X.               04410000
044200                    88  ASC-KEY-DATA-NEED-EDIT    VALUE 'Y'.      04420000
044300                    88  ASC-KEY-DATA-PASS-EDIT    VALUE 'N'.      04430000
044400                 20 ASC-EDIT-START-DT-SW     PIC X.               04440000
044500                    88  ASC-START-DT-NEED-EDIT    VALUE 'Y'.      04450000
044600                    88  ASC-START-DT-PASS-EDIT    VALUE 'N'.      04460000
044700                 20 ASC-EDIT-END-DT-SW       PIC X.               04470000
044800                    88  ASC-END-DT-NEED-EDIT      VALUE 'Y'.      04480000
044900                    88  ASC-END-DT-PASS-EDIT      VALUE 'N'.      04490000
045000*                                                                 04500000
045100             15  ASC-PARENT-LVL-BYR-NBR      PIC X(03).           04510000
045200             15  ASC-PARENT-LVL-MDSETYP      PIC X.               04520000
045300             15  ASC-LEVEL-STRT-DTE-X        PIC X(8).            04530000
045400             15  ASC-LEVEL-STRT-DTE-N REDEFINES                   04540000
045500                                   ASC-LEVEL-STRT-DTE-X.          04550000
045600                 20  ASC-LEVEL-STRT-DTE      PIC 9(08).           04560000
045700             15 FILLER REDEFINES ASC-LEVEL-STRT-DTE-X.            04570000
045800                 20  ASC-LEVEL-STRT-CC-X     PIC X(02).           04580000
045900                 20  ASC-LEVEL-STRT-YY-X     PIC X(02).           04590000
046000                 20  ASC-LEVEL-STRT-MM-X     PIC X(02).           04600000
046100                 20  ASC-LEVEL-STRT-DD-X     PIC X(02).           04610000
046200*                                                                 04620000
046300             15  ASC-LEVEL-END-DTE-X         PIC X(8).            04630000
046400             15  ASC-LEVEL-END-DTE-N REDEFINES                    04640000
046500                                   ASC-LEVEL-END-DTE-X.           04650000
046600                 20  ASC-LEVEL-END-DTE       PIC 9(08).           04660000
046700             15  FILLER REDEFINES ASC-LEVEL-END-DTE-X.            04670000
046800                 20  ASC-LEVEL-END-CC-X      PIC X(02).           04680000
046900                 20  ASC-LEVEL-END-YY-X      PIC X(02).           04690000
047000                 20  ASC-LEVEL-END-MM-X      PIC X(02).           04700000
047100                 20  ASC-LEVEL-END-DD-X      PIC X(02).           04710000
047200             15  ASC-USERID                  PIC X(08).           04720000
047300             15  ASC-CURRENT-DATE            PIC 9(8).            04730000
047400             15  FILLER REDEFINES ASC-CURRENT-DATE.               04740000
047500                 20  ASC-CURRENT-CC          PIC 9(02).           04750000
047600                 20  ASC-CURRENT-YY          PIC 9(02).           04760000
047700                 20  ASC-CURRENT-MM          PIC 9(02).           04770000
047800                 20  ASC-CURRENT-DD          PIC 9(02).           04780000
047900             15  ASC-TEMP-QUEUE-NAME         PIC X(08).           04790000
048000             15  FILLER REDEFINES ASC-TEMP-QUEUE-NAME.            04800000
048100                 20  ASC-TERM-ID             PIC X(04).           04810000
048200                 20  ASC-TASK-ID             PIC S9(07)           04820000
048300                                             COMP-3.              04830000
048400             15  ASC-PARENT-MDSEAR-DKEY      PIC S9(06)V          04840000
048500                                             COMP-3.              04850000
048600             15  FILLER                      PIC X(2648).         04860000
048700                                                                  04870000
048800***************************************************************** 04880000
048900*    ABEND PROCESSING COPYBOOK.                                   04890000
049000***************************************************************** 04900000
049100                                                                  04910000
049200     COPY DPWS013.                                                04920000
049300                                                                  04930000
049400***************************************************************** 04940000
049500*    ATTRIBUTE SETTINGS COPYBOOK.                                 04950000
049600***************************************************************** 04960000
049700                                                                  04970000
049800     COPY DPWS015.                                                04980000
049900                                                                  04990000
050000***************************************************************** 05000000
050100*    TEMPORARY STORAGE QUEUE LAYOUT                               05010000
050200***************************************************************** 05020000
050300                                                                  05030000
050400     COPY MBWS104.                                                05040000
050500                                                                  05050000
050600***************************************************************** 05060000
050700*    CURRENT DATE AND TIME COPYBOOK.                              05070000
050800***************************************************************** 05080000
050900                                                                  05090000
051000     COPY DPWS017.                                                05100000
051100                                                                  05110000
051200***************************************************************** 05120000
051300*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          05130000
051400***************************************************************** 05140000
051500                                                                  05150000
051600     COPY DPWS009.                                                05160000
051700                                                                  05170000
051800***************************************************************** 05180000
051900*    SYSTEM MESSAGE FIELDS                                        05190000
052000***************************************************************** 05200000
052100                                                                  05210000
052200     COPY DPWS006.                                                05220000
052300                                                                  05230000
052400***************************************************************** 05240000
052500*    FUNCTION KEYS COPYBOOK.                                      05250000
052600***************************************************************** 05260000
052700                                                                  05270000
052800     COPY DPWS016.                                                05280000
052900                                                                  05290000
053000***************************************************************** 05300000
053100*    DPKUT045 COPYBOOK.                                           05310000
053200*                                                                 05320000
053300*    DATA AREA NECESSARY TO INTERACT WITH SUB-ROUTINE DPKUT045    05330000
053400*                                                                 05340000
053500*    DPKUT045 IS A UTILITY ROUTINE THAT CONVERTS THE EIBAID       05350000
053600*    CHARACTER RECEIVED FROM THE TERMINAL INTO A INTEGER VALUE    05360000
053700*    FROM 1 TO 29. THIS INTEGER VALUE IS STORED IN DP020-SRC-AID  05370000
053800*    AND IS USED TO INTERROGATE THE DP020-FUNCTION-KEY-ARRAY      05380000
053900*    TABLE IN THE STANDARD COMMAREA TO DETERMINE WHAT TO DO NEXT. 05390000
054000*    IN ADDITION DPKUT045 WILL PARSE THE SCREEN INPUT COMMAND     05400000
054100*    FIELD AND CONVERT RECOGNIZED SCREEN MANIPULATION COMMANDS    05410000
054200*    INTO THE DP020-SRC-AID EQUIVALENT.                           05420000
054300***************************************************************** 05430000
054400                                                                  05440000
054500     COPY DPWS045.                                                05450000
054600                                                                  05460000
054700***************************************************************** 05470000
054800*    SYSTEM MESSAGES RECORD LAYOUT                                05480000
054900***************************************************************** 05490000
055000                                                                  05500000
055100     COPY DPRD507I.                                               05510000
055200                                                                  05520000
055300***************************************************************** 05530000
055400*    CALENDAR ROUTINE PARAMETER LIST                              05540000
055500***************************************************************** 05550000
055600                                                                  05560000
055700     COPY DPWS500.                                                05570000
055800                                                                  05580000
055900***************************************************************** 05590000
056000*    NUMERIC EDIT ROUTINE COPYBOOK                                05600000
056100***************************************************************** 05610000
056200                                                                  05620000
056300     COPY DPWS010I.                                               05630000
056400                                                                  05640000
056500***************************************************************** 05650000
056600*    STANDARD ATTENTION IDENTIFIER LIST                           05660000
056700***************************************************************** 05670000
056800                                                                  05680000
056900     COPY DFHAID.                                                 05690000
057000                                                                  05700000
057100***************************************************************** 05710000
057200*    MAP LAYOUT                                                   05720000
057300***************************************************************** 05730000
057400                                                                  05740000
057500     COPY MBKM104.                                                05750000
057600                                                                  05760000
057700 01  MD-MAP-DATA-AREA REDEFINES MB104AO.                          05770000
057800***************************************************************** 05780000
057900*    FOR THE UTILITIES THAT RECEIVE AND SEND THE MAP TO THE       05790000
058000*    TERMINAL TO FUNCTION CORRECTLY, CHANGE THE PIC CLAUSE OF     05800000
058100*    THE FOLLOWING FILLER STATEMENT TO BE EQUAL TO THE TOTAL      05810000
058200*    LENGTH OF THE MAP COPYBOOK.                                  05820000
058300***************************************************************** 05830000
058400     05  FILLER                         PIC X(728).               05840000
058500 EJECT                                                            05850000
058600***************************************************************** 05860000
058700*    DB2 COMMUNICATION AREA                                       05870000
058800***************************************************************** 05880000
058900                                                                  05890000
059000     EXEC SQL                                                     05900000
059100         INCLUDE SQLCA                                            05910000
059200     END-EXEC.                                                    05920000
059300                                                                  05930000
059400                                                                  05940000
059500 LINKAGE SECTION.                                                 05950000
059600                                                                  05960000
059700 01  DFHCOMMAREA.                                                 05970000
059800     05  FILLER                       OCCURS 1 TO 4072 TIMES      05980000
059900                                      DEPENDING ON EIBCALEN.      05990000
060000         10  FILLER                   PIC X.                      06000000
060100 EJECT                                                            06010000
060200*                                                                 06020000
060300*                                                                 06030000
060400*                                                                 06040000
060500 PROCEDURE DIVISION.                                              06050000
060600                                                                  06060000
060700                                                                  06070000
060800                                                                  06080000
060900                                                                  06090000
061000 0000-MAIN-MODULE.                                                06100000
061100                                                                  06110000
061200******************************************************************06120000
061300*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           06130000
061400*                                                                 06140000
061500************* DO NOT ALTER THIS PARAGRAPH ************************06150000
061600*                                                                 06160000
061700******************************************************************06170000
061800                                                                  06180000
061900     PERFORM DP015-0000-CHECK-COMMAREA.                           06190000
062000                                                                  06200000
062100******************************************************************06210000
062200*    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS  06220000
062300*    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER     06230000
062400*    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS      06240000
062500*    PROGRAM WILL RETURN TO CICS.                                 06250000
062600******************************************************************06260000
062700     IF DP020-SRC-RETURN-W-TRAN-ID                                06270000
062800         PERFORM A100-CONTROL-PROCESSING                          06280000
062900     END-IF.                                                      06290000
063000                                                                  06300000
063100     PERFORM DP003-0000-RETURN-TO-CICS.                           06310000
063200 EJECT                                                            06320000
063300 A100-CONTROL-PROCESSING.                                         06330000
063400                                                                  06340000
063500******************************************************************06350000
063600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    06360000
063700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    06370000
063800*                                                                 06380000
063900*                                                                 06390000
064000************* DO NOT ALTER THIS PARAGRAPH ************************06400000
064100*                                                                 06410000
064200******************************************************************06420000
064300                                                                  06430000
064400     EVALUATE TRUE                                                06440000
064500                                                                  06450000
064600         WHEN DP020-NEXT-ACT-INITIAL                              06460000
064700             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 06470000
064800                                                                  06480000
064900             PERFORM B100-INITIALIZE-COMMAREA                     06490000
065000             PERFORM B300-BUILD-INITIAL-PANEL                     06500000
065100             PERFORM C300-MOVE-COMMAREA-TO-SCREEN                 06510000
065200             PERFORM C400-DISPLAY-PANEL                           06520000
065300                                                                  06530000
065400         WHEN DP020-NEXT-ACT-READ-MAP                             06540000
065500             PERFORM B400-PROCESS-MAP                             06550000
065600                                                                  06560000
065700         WHEN DP020-NEXT-ACT-RETURN                               06570000
065800             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 06580000
065900                                                                  06590000
066000             IF DP020-MB-RESP-LEVEL-ADD                           06600000
066100                 PERFORM B200-SETUP-RETURN-DATA                   06610000
066200                 PERFORM C500-SET-FIELD-DEFAULTS                  06620000
066300                 PERFORM C100-SET-SCREEN-ATTRIBUTES               06630000
066400                 PERFORM E800-RESET-SCREEN-ATTRB                  06640000
066500             ELSE                                                 06650000
066600                 PERFORM D500-EDIT-DATA-IN-COMMAREA               06660000
066700             END-IF                                               06670000
066800             PERFORM C400-DISPLAY-PANEL                           06680000
066900                                                                  06690000
067000         WHEN DP020-NEXT-ACT-ERROR                                06700000
067100                                                                  06710000
067200******************************************************************06720000
067300*    THE FOLLOWING CODE HAS BEEN INSERTED IN ORDER TO PRESERVE    06730000
067400*    THE ERROR MESSAGE BEING RETURNED FROM THE NAVIGATOR. SINCE   06740000
067500*    THE ERROR BEING RETURNED WILL TYPICALLY BE A SECURITY        06750000
067600*    VIOLATION OR THE UNAVAILABILITY OF THE REQUESTED TRANSACTION 06760000
067700*    THIS CODE ALSO CHECKS TO SEE HOW  THE NAVIGATION REQUEST WAS 06770000
067800*    INVOKED. IF DP020-NAV-MNEMONIC FIELD IN THE STANDARD         06780000
067900*    COMMAREA IS SPACES, THE NAVIGATION REQUEST WAS VIA A FUNCTION06790000
068000*    KEY. IF NOT, IT WAS VIA A COMMAND ENTERED IN THE COMMAND LINE06800000
068100*    COMMAND FIELD AND THIS LOGIC SETS THE ATTRIBUTE FOR THIS FIEL06810000
068200*    TO RED, REVERSE VIDEO.                                       06820000
068300******************************************************************06830000
068400             MOVE DP020-MSG-NUMBER-X  TO PV-MSG-NUMBER-X          06840000
068500                                                                  06850000
068600             IF DP020-NAV-MNEMONIC = SPACES                       06860000
068700                 MOVE SPACES          TO ANAVCMDO                 06870000
068800                 MOVE DP015-GREEN     TO ANAVCMDC                 06880000
068900                 MOVE DP015-UNDERLINE TO ANAVCMDH                 06890000
069000             ELSE                                                 06900000
069100                 MOVE DP015-RED       TO ANAVCMDC                 06910000
069200                 MOVE DP015-REVERSE   TO ANAVCMDH                 06920000
069300             END-IF                                               06930000
069400                                                                  06940000
069500             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        06950000
069600                                                                  06960000
069700             PERFORM D500-EDIT-DATA-IN-COMMAREA                   06970000
069800                                                                  06980000
069900             SET PS-ERROR                TO TRUE                  06990000
070000             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  07000000
070100                                                                  07010000
070200             MOVE PV-MSG-NUMBER-X     TO DP020-MSG-NUMBER-X       07020000
070300******************************************************************07030000
070400*    END OF CODE BLOCK DESIGNED TO SAVE MESSAGE FROM DPKCS008     07040000
070500******************************************************************07050000
070600             MOVE -1         TO ANAVCMDL                          07060000
070700                                                                  07070000
070800             PERFORM C400-DISPLAY-PANEL                           07080000
070900                                                                  07090000
071000         WHEN OTHER                                               07100000
071100             SET DP013-LOGIC-ABEND TO TRUE                        07110000
071200             SET DP013-NO-ROLLBACK TO TRUE                        07120000
071300                                                                  07130000
071400             MOVE 'A100-CONTROL-PROCESSING' TO                    07140000
071500                  DP013-PARAGRAPH                                 07150000
071600             MOVE 'INVALID NEXT ACTION FOR ARCHITECTURE'          07160000
071700                  TO DP013-MESSAGE-TEXT(1)                        07170000
071800                                                                  07180000
071900             PERFORM DP013-0000-PROCESS-ABEND                     07190000
072000                                                                  07200000
072100     END-EVALUATE.                                                07210000
072200 EJECT                                                            07220000
072300                                                                  07230000
072400 B100-INITIALIZE-COMMAREA.                                        07240000
072500******************************************************************07250000
072600*                                                                 07260000
072700*                                                                 07270000
072800*                                                                 07280000
072900******************************************************************07290000
073000                                                                  07300000
073100     INITIALIZE ASC-APPL-SPEC-COMMAREA.                           07310000
073200                                                                  07320000
073300 B200-SETUP-RETURN-DATA.                                          07330000
073400******************************************************************07340000
073500*  WHEN USER RETURNS TO THIS SCREEN, SAVE THE KEY DATA ENTERED,   07350000
073600*  BUT RESET COMMAREA AND ALL SWITCHES.                           07360000
073700*                                                                 07370000
073800******************************************************************07380000
073900     IF MB005-RECORD-UPDATED                                      07390000
074000        MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER                  07400000
074100        SET DP020-MSG-INFORMATIONAL TO TRUE                       07410000
074200        SET MB005-RECORD-NOT-UPDATED TO TRUE                      07420000
074300     END-IF.                                                      07430000
074400                                                                  07440000
074500     MOVE ASC-SCRN-GMA-NO TO PV-SAVE-GMA.                         07450000
074600     MOVE ASC-GMA-DESC    TO PV-SAVE-GMA-DESC.                    07460000
074700     MOVE ASC-SCRN-DMA-NO TO PV-SAVE-DMA.                         07470000
074800     MOVE ASC-DMA-DESC    TO PV-SAVE-DMA-DESC.                    07480000
074900     MOVE ASC-SCRN-DPT-NO TO PV-SAVE-DPT.                         07490000
075000     MOVE ASC-DPT-DESC    TO PV-SAVE-DPT-DESC.                    07500000
075100     MOVE ASC-SCRN-MCL-NO TO PV-SAVE-MCL.                         07510000
075200     MOVE ASC-MCL-DESC    TO PV-SAVE-MCL-DESC.                    07520000
075300     MOVE ASC-SCRN-SCL-NO TO PV-SAVE-SCL.                         07530000
075400     MOVE ASC-SCL-DESC    TO PV-SAVE-SCL-DESC.                    07540000
075500     MOVE ASC-ADD-MDSE-LEVEL TO PV-SAVE-ADD-LEVEL.                07550000
075600     PERFORM B100-INITIALIZE-COMMAREA.                            07560000
075700     MOVE PV-SAVE-ADD-LEVEL TO ASC-ADD-MDSE-LEVEL.                07570000
075800                                                                  07580000
075900     EVALUATE TRUE                                                07590000
076000                                                                  07600000
076100         WHEN ASC-ADD-GMA                                         07610000
076200           INITIALIZE      PV-SAVE-DMA                            07620000
076300                                   PV-SAVE-DPT                    07630000
076400                                   PV-SAVE-MCL                    07640000
076500                                   PV-SAVE-SCL                    07650000
076600                                   PV-SAVE-GMA                    07660000
076700                                   PV-SAVE-GMA-DESC               07670000
076800                                   PV-SAVE-DMA-DESC               07680000
076900                                   PV-SAVE-DPT-DESC               07690000
077000                                   PV-SAVE-MCL-DESC               07700000
077100                                   PV-SAVE-SCL-DESC               07710000
077200                                                                  07720000
077300         WHEN ASC-ADD-DMA                                         07730000
077400           INITIALIZE              PV-SAVE-DMA                    07740000
077500                                   PV-SAVE-DPT                    07750000
077600                                   PV-SAVE-MCL                    07760000
077700                                   PV-SAVE-SCL                    07770000
077800                                   PV-SAVE-DMA-DESC               07780000
077900                                   PV-SAVE-DPT-DESC               07790000
078000                                   PV-SAVE-MCL-DESC               07800000
078100                                   PV-SAVE-SCL-DESC               07810000
078200                                                                  07820000
078300         WHEN ASC-ADD-DPT                                         07830000
078400           INITIALIZE              PV-SAVE-DPT                    07840000
078500                                   PV-SAVE-MCL                    07850000
078600                                   PV-SAVE-SCL                    07860000
078700                                   PV-SAVE-DPT-DESC               07870000
078800                                   PV-SAVE-MCL-DESC               07880000
078900                                   PV-SAVE-SCL-DESC               07890000
079000                                                                  07900000
079100         WHEN ASC-ADD-MCL                                         07910000
079200           INITIALIZE              PV-SAVE-MCL                    07920000
079300                                   PV-SAVE-SCL                    07930000
079400                                   PV-SAVE-MCL-DESC               07940000
079500                                   PV-SAVE-SCL-DESC               07950000
079600                                                                  07960000
079700         WHEN ASC-ADD-SCL                                         07970000
079800           INITIALIZE              PV-SAVE-SCL                    07980000
079900                                   PV-SAVE-SCL-DESC               07990000
080000     END-EVALUATE.                                                08000000
080100                                                                  08010000
080200                                                                  08020000
080300                                                                  08030000
080400     MOVE PV-SAVE-GMA TO ASC-SCRN-GMA-NO.                         08040000
080500     MOVE PV-SAVE-DMA TO ASC-SCRN-DMA-NO.                         08050000
080600     MOVE PV-SAVE-DPT TO ASC-SCRN-DPT-NO.                         08060000
080700     MOVE PV-SAVE-MCL TO ASC-SCRN-MCL-NO.                         08070000
080800     MOVE PV-SAVE-SCL TO ASC-SCRN-SCL-NO.                         08080000
080900     MOVE PV-SAVE-GMA-DESC TO ASC-GMA-DESC.                       08090000
081000     MOVE PV-SAVE-DMA-DESC TO ASC-DMA-DESC.                       08100000
081100     MOVE PV-SAVE-DPT-DESC TO ASC-DPT-DESC.                       08110000
081200     MOVE PV-SAVE-MCL-DESC TO ASC-MCL-DESC.                       08120000
081300     MOVE PV-SAVE-SCL-DESC TO ASC-SCL-DESC.                       08130000
081400                                                                  08140000
081500 B300-BUILD-INITIAL-PANEL.                                        08150000
081600                                                                  08160000
081700******************************************************************08170000
081800*    ROUTINE THAT IS PERFORMED ON FIRST PASS OF THIS PROGRAM.     08180000
081900*                                                                 08190000
082000*                                                                 08200000
082100******************************************************************08210000
082200                                                                  08220000
082300     PERFORM C050-DETERMINE-LEVEL-TO-ADD.                         08230000
082400                                                                  08240000
082500     PERFORM C100-SET-SCREEN-ATTRIBUTES.                          08250000
082600     PERFORM E800-RESET-SCREEN-ATTRB.                             08260000
082700                                                                  08270000
082800     PERFORM C500-SET-FIELD-DEFAULTS.                             08280000
082900                                                                  08290000
083000 EJECT                                                            08300000
083100 B400-PROCESS-MAP.                                                08310000
083200                                                                  08320000
083300******************************************************************08330000
083400*    RECEIVE THE MAP.                                             08340000
083500*    IF A FUNCTION KEY WAS HIT OTHER THAN CLEAR,                  08350000
083600*    MOVE THE SCREEN FIELDS TO THE COMMMAREA.                     08360000
083700*    CONTINUE PROCESSING BASED ON THE FUNCTION KEY THAT WAS HIT.  08370000
083800*                                                                 08380000
083900************* DO NOT ALTER THIS PARAGRAPH ************************08390000
084000*                                                                 08400000
084100*                                                                 08410000
084200******************************************************************08420000
084300                                                                  08430000
084400     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         08440000
084500                                                                  08450000
084600     PERFORM DP007-0000-GET-PANEL.                                08460000
084700                                                                  08470000
084800                                                                  08480000
084900     IF (DP020-SRC-AID NOT = DP016-PF5)   AND                     08490000
085000        (DP020-SRC-AID NOT = DP016-CLEAR)                         08500000
085100         PERFORM E100-MOVE-SCREEN-TO-COMMAREA                     08510000
085200     END-IF.                                                      08520000
085300                                                                  08530000
085400     PERFORM C600-CHECK-LOCAL-FKEYS.                              08540000
085500 EJECT                                                            08550000
085600                                                                  08560000
085700 C050-DETERMINE-LEVEL-TO-ADD.                                     08570000
085800******************************************************************08580000
085900*    SAVE THE INTER-APPLICATION COMMAREA ON THE FIRST CYCLE       08590000
086000*    OF THIS TRANSACTION.                                         08600000
086100*                                                                 08610000
086200*                                                                 08620000
086300******************************************************************08630000
086400     SET PS-INTER-APPL-VALID TO TRUE                              08640000
086500     MOVE LOW-VALUES         TO DP020-INTER-APPL-DATA-AREA        08650000
086600                                ASC-INTER-APPL-FORMAT-CODE.       08660000
086700                                                                  08670000
086800     IF DP020-SRC-MNEMONIC = PC-ADD-GMA                           08680000
086900        SET ASC-ADD-GMA TO TRUE                                   08690000
087000     ELSE                                                         08700000
087100        IF DP020-SRC-MNEMONIC = PC-ADD-DMA                        08710000
087200           SET ASC-ADD-DMA TO TRUE                                08720000
087300        ELSE                                                      08730000
087400           IF DP020-SRC-MNEMONIC = PC-ADD-DPT                     08740000
087500              SET ASC-ADD-DPT TO TRUE                             08750000
087600           ELSE                                                   08760000
087700              IF DP020-SRC-MNEMONIC = PC-ADD-MCL                  08770000
087800                 SET ASC-ADD-MCL TO TRUE                          08780000
087900              ELSE                                                08790000
088000                 SET ASC-ADD-SCL TO TRUE                          08800000
088100              END-IF                                              08810000
088200           END-IF                                                 08820000
088300        END-IF                                                    08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088600                                                                  08860000
088700                                                                  08870000
088800                                                                  08880000
088900 C100-SET-SCREEN-ATTRIBUTES.                                      08890000
089000                                                                  08900000
089100******************************************************************08910000
089200*                                                                 08920000
089300*                                                                 08930000
089400*                                                                 08940000
089500******************************************************************08950000
089600                                                                  08960000
089700***                                                               08970000
089800*  SET DESCRIPTION FOR LEVELS ABOVE LEVEL TO BE ADDED TO          08980000
089900*  BLUE AUTOSKIP                                                  08990000
090000***                                                               09000000
090100                                                                  09010000
090200     COMPUTE PV-LEVEL-INDEX-END = ASC-ADD-MDSE-LEVEL - 1.         09020000
090300     INITIALIZE PV-LEVEL-INDEX.                                   09030000
090400                                                                  09040000
090500     IF PV-LEVEL-INDEX-END > 0                                    09050000
090600         PERFORM D200-SET-LEVEL-TO-BLUE                           09060000
090700            VARYING PV-LEVEL-INDEX FROM 1 BY 1                    09070000
090800            UNTIL (PV-LEVEL-INDEX > PV-LEVEL-INDEX-END)           09080000
090900     END-IF.                                                      09090000
091000***                                                               09100000
091100*  SET NON DESCRIPTION FIELDS TO GREEN UNDERLINE                  09110000
091200***                                                               09120000
091300     COMPUTE PV-LEVEL-INDEX-END = ASC-ADD-MDSE-LEVEL              09130000
091400     INITIALIZE PV-LEVEL-INDEX.                                   09140000
091500                                                                  09150000
091600     PERFORM D100-SET-LEVEL-TO-GREEN                              09160000
091700         VARYING PV-LEVEL-INDEX FROM 1 BY 1                       09170000
091800          UNTIL (PV-LEVEL-INDEX > PV-LEVEL-INDEX-END).            09180000
091900***                                                               09190000
092000*  SET LEVELS BELOW LEVEL TO BE ADDED TO DARK - PROTECTED         09200000
092100***                                                               09210000
092200                                                                  09220000
092300     COMPUTE PV-LEVEL-INDEX = ASC-ADD-MDSE-LEVEL + 1              09230000
092400     IF PV-LEVEL-INDEX < 6                                        09240000
092500         PERFORM D300-SET-LEVEL-TO-DARK                           09250000
092600            VARYING PV-LEVEL-INDEX FROM PV-LEVEL-INDEX BY 1       09260000
092700            UNTIL (PV-LEVEL-INDEX > 5)                            09270000
092800     END-IF.                                                      09280000
092900***                                                               09290000
093000*  DESCRIPTION TO BE ADDED TO GREEN                               09300000
093100***                                                               09310000
093200                                                                  09320000
093300     IF ASC-ADD-GMA                                               09330000
093400          MOVE DP015-GREEN           TO AGMDESCC                  09340000
093500          MOVE DP015-UNDERLINE       TO AGMDESCH                  09350000
093600          MOVE DP015-UNP-ALP-NOR-OFF TO AGMDESCA                  09360000
093700     ELSE                                                         09370000
093800       IF ASC-ADD-DMA                                             09380000
093900          MOVE DP015-GREEN           TO ADMDESCC                  09390000
094000          MOVE DP015-UNDERLINE       TO ADMDESCH                  09400000
094100          MOVE DP015-UNP-ALP-NOR-OFF TO ADMDESCA                  09410000
094200       ELSE                                                       09420000
094300          IF ASC-ADD-DPT                                          09430000
094400              MOVE DP015-GREEN           TO ADPDESCC              09440000
094500              MOVE DP015-UNDERLINE       TO ADPDESCH              09450000
094600              MOVE DP015-UNP-ALP-NOR-OFF TO ADPDESCA              09460000
094700          ELSE                                                    09470000
094800             IF ASC-ADD-MCL                                       09480000
094900                 MOVE DP015-GREEN           TO AMCDESCC           09490000
095000                 MOVE DP015-UNDERLINE       TO AMCDESCH           09500000
095100                 MOVE DP015-UNP-ALP-NOR-OFF TO AMCDESCA           09510000
095200             ELSE                                                 09520000
095300                 MOVE DP015-GREEN           TO ASCDESCC           09530000
095400                 MOVE DP015-UNDERLINE       TO ASCDESCH           09540000
095500                 MOVE DP015-UNP-ALP-NOR-OFF TO ASCDESCA           09550000
095600             END-IF                                               09560000
095700          END-IF                                                  09570000
095800       END-IF                                                     09580000
095900     END-IF.                                                      09590000
096000                                                                  09600000
096100                                                                  09610000
096200 C300-MOVE-COMMAREA-TO-SCREEN.                                    09620000
096300******************************************************************09630000
096400*                                                                 09640000
096500*                                                                 09650000
096600*                                                                 09660000
096700******************************************************************09670000
096800                                                                  09680000
096900                                                                  09690000
097000     MOVE PC-COMPANY-NUMBER  TO AOPERCOO.                         09700000
097100     MOVE ASC-SCRN-GMA-NO    TO AGMAO.                            09710000
097200     MOVE ASC-GMA-DESC       TO AGMDESCO.                         09720000
097300     MOVE ASC-SCRN-DMA-NO    TO ADMAO.                            09730000
097400     MOVE ASC-DMA-DESC       TO ADMDESCO.                         09740000
097500     MOVE ASC-SCRN-DPT-NO    TO ADEPTO.                           09750000
097600     MOVE ASC-DPT-DESC       TO ADPDESCO.                         09760000
097700     MOVE ASC-SCRN-MCL-NO    TO AMCLASSO.                         09770000
097800     MOVE ASC-MCL-DESC       TO AMCDESCO.                         09780000
097900     MOVE ASC-SCRN-SCL-NO    TO ASCLASSO.                         09790000
098000     MOVE ASC-SCL-DESC       TO ASCDESCO.                         09800000
098100     MOVE ASC-SCRN-STRT-MM-X TO ASTRTMMO.                         09810000
098200     MOVE ASC-SCRN-STRT-DD-X TO ASTRTDDO.                         09820000
098300     MOVE ASC-SCRN-STRT-YY-X TO ASTRTYYO.                         09830000
098400     MOVE ASC-SCRN-END-MM-X  TO AENDMMO.                          09840000
098500     MOVE ASC-SCRN-END-DD-X  TO AENDDDO.                          09850000
098600     MOVE ASC-SCRN-END-YY-X  TO AENDYYO.                          09860000
098700     MOVE ASC-SCRN-GEN-MDSETYP TO AGENRLO.                        09870000
098800     MOVE ASC-SCRN-BYR-NBR   TO ABUYERO.                          09880000
098900     IF ASC-ADD-GMA                                               09890000
099000        MOVE 'GMA'                 TO ALEVELO                     09900000
099100     ELSE                                                         09910000
099200       IF ASC-ADD-DMA                                             09920000
099300          MOVE 'DMA'               TO ALEVELO                     09930000
099400       ELSE                                                       09940000
099500          IF ASC-ADD-DPT                                          09950000
099600             MOVE 'DPT'            TO ALEVELO                     09960000
099700          ELSE                                                    09970000
099800             IF ASC-ADD-MCL                                       09980000
099900                MOVE 'MCL'         TO ALEVELO                     09990000
100000             ELSE                                                 10000000
100100                IF ASC-ADD-SCL                                    10010000
100200                   MOVE 'SCL'      TO ALEVELO                     10020000
100300                END-IF                                            10030000
100400             END-IF                                               10040000
100500          END-IF                                                  10050000
100600       END-IF                                                     10060000
100700     END-IF.                                                      10070000
100800                                                                  10080000
100900     MOVE PC-COMPANY-NUMBER        TO AOPERCOO.                   10090000
101000                                                                  10100000
101100 C400-DISPLAY-PANEL.                                              10110000
101200                                                                  10120000
101300******************************************************************10130000
101400*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       10140000
101500*                                                                 10150000
101600******************************************************************10160000
101700                                                                  10170000
101800     IF ASC-SCRN-END-YYYYMMDD = PC-INFINITY-DATE                  10180000
101900        MOVE SPACES TO ASC-SCRN-END-DTE-X                         10190000
102000     END-IF.                                                      10200000
102100                                                                  10210000
102200     IF ASC-KEY-PROTECTED                                         10220000
102300         MOVE ASC-ADD-MDSE-LEVEL TO  PV-LEVEL-INDEX-END           10230000
102400         INITIALIZE PV-LEVEL-INDEX                                10240000
102500                                                                  10250000
102600          PERFORM D200-SET-LEVEL-TO-BLUE                          10260000
102700              VARYING PV-LEVEL-INDEX FROM 1 BY 1                  10270000
102800              UNTIL (PV-LEVEL-INDEX > PV-LEVEL-INDEX-END)         10280000
102900     END-IF.                                                      10290000
103000                                                                  10300000
103100                                                                  10310000
103200     IF PS-NO-ERROR                                               10320000
103300        IF ASC-KEY-PROTECTED                                      10330000
103400           MOVE -1  TO ASTRTMML                                   10340000
103500        ELSE                                                      10350000
103600           MOVE -1  TO AGMAL                                      10360000
103700        END-IF                                                    10370000
103800     END-IF.                                                      10380000
103900                                                                  10390000
104000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       10400000
104100                                                                  10410000
104200     PERFORM DP002-0000-FORMAT-TITLE-LINES.                       10420000
104300                                                                  10430000
104400     PERFORM C300-MOVE-COMMAREA-TO-SCREEN.                        10440000
104500                                                                  10450000
104600     PERFORM DP005-0000-FORMAT-MSG-LINES.                         10460000
104700                                                                  10470000
104800     IF (DP020-SRC-AID = DP016-PA2) OR                            10480000
104900        (PS-SEND-MAP-N-DATA-FRSET)                                10490000
105000         PERFORM DP009-0000-LOAD-FK-LINES                         10500000
105100     END-IF.                                                      10510000
105200                                                                  10520000
105300                                                                  10530000
105400     PERFORM DP008-0000-WRITE-PANEL.                              10540000
105500                                                                  10550000
105600 EJECT                                                            10560000
105700                                                                  10570000
105800 C500-SET-FIELD-DEFAULTS.                                         10580000
105900******************************************************************10590000
106000*                                                                 10600000
106100*                                                                 10610000
106200*                                                                 10620000
106300******************************************************************10630000
106400                                                                  10640000
106500     MOVE SPACES     TO  ASC-SCRN-STRT-MM-X                       10650000
106600                         ASC-SCRN-STRT-DD-X                       10660000
106700                         ASC-SCRN-STRT-YY-X                       10670000
106800                         ASC-SCRN-END-MM-X                        10680000
106900                         ASC-SCRN-END-DD-X                        10690000
107000                         ASC-SCRN-END-YY-X.                       10700000
107100                                                                  10710000
107200                                                                  10720000
107300     EJECT                                                        10730000
107400                                                                  10740000
107500 C600-CHECK-LOCAL-FKEYS.                                          10750000
107600                                                                  10760000
107700******************************************************************10770000
107800*    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT          10780000
107900*    FUNCTION KEY THE USER HAS HIT.                               10790000
108000*                                                                 10800000
108100*    MODIFY THE EVALUATE CLAUSE BELOW BY ADDING A WHEN  CLAUSE    10810000
108200*    FOR EACH AID KEY YOU PLAN ON HANDLING WITHIN THIS PROGRAM.   10820000
108300*    DO NOT MODIFY OR DELETE ANY OF THE EXISTING WHEN  CLAUSES.   10830000
108400*                                                                 10840000
108500******************************************************************10850000
108600                                                                  10860000
108700     EVALUATE TRUE                                                10870000
108800                                                                  10880000
108900         WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID) OR              10890000
109000               DP020-FK-RETURN(DP020-SRC-AID))                    10900000
109100              PERFORM 4300-SETUP-INTER-APPL-COMM                  10910000
109200              PERFORM DP015-1000-START-NAVIGATOR                  10920000
109300                                                                  10930000
109400         WHEN DP020-FK-EDIT-GOTO(DP020-SRC-AID)                   10940000
109500              IF DP020-SRC-AID = DP016-PF17                       10950000
109600                 PERFORM D500-EDIT-DATA-IN-COMMAREA               10960000
109700                 IF PS-NO-ERROR                                   10970000
109800                     PERFORM Z500-BUILD-TEMP-Q                    10980000
109900                     PERFORM 4300-SETUP-INTER-APPL-COMM           10990000
110000                     PERFORM DP015-1000-START-NAVIGATOR           11000000
110100                 ELSE                                             11010000
110200                     PERFORM C300-MOVE-COMMAREA-TO-SCREEN         11020000
110300                     PERFORM C400-DISPLAY-PANEL                   11030000
110400                 END-IF                                           11040000
110500              ELSE                                                11050000
110600                  PERFORM 4300-SETUP-INTER-APPL-COMM              11060000
110700                  PERFORM DP015-1000-START-NAVIGATOR              11070000
110800              END-IF                                              11080000
110900                                                                  11090000
111000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     11100000
111100             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 11110000
111200             PERFORM B100-INITIALIZE-COMMAREA                     11120000
111300             PERFORM B300-BUILD-INITIAL-PANEL                     11130000
111400             INITIALIZE ANAVCMDO ANAVKEYO                         11140000
111500                DP020-NAV-KEY-DATA                                11150000
111600                DP020-NAV-MNEMONIC                                11160000
111700             PERFORM C400-DISPLAY-PANEL                           11170000
111800                                                                  11180000
111900         WHEN DP020-SRC-AID = DP016-ENTER                         11190000
112000                                                                  11200000
112100             IF (DP020-NAV-MNEMONIC = SPACES)     OR              11210000
112200                (DP020-NAV-MNEMONIC = LOW-VALUES)                 11220000
112300                 PERFORM D500-EDIT-DATA-IN-COMMAREA               11230000
112400                 PERFORM C300-MOVE-COMMAREA-TO-SCREEN             11240000
112500                 PERFORM C400-DISPLAY-PANEL                       11250000
112600             ELSE                                                 11260000
112700                 PERFORM 4300-SETUP-INTER-APPL-COMM               11270000
112800                 PERFORM DP015-1000-START-NAVIGATOR               11280000
112900             END-IF                                               11290000
113000                                                                  11300000
113100                                                                  11310000
113200         WHEN DP020-SRC-AID = DP016-PA2                           11320000
113300             SET PS-SEND-DATA-ONLY TO TRUE                        11330000
113400                                                                  11340000
113500             MOVE -1 TO ANAVCMDL                                  11350000
113600                                                                  11360000
113700             PERFORM DP017-0000-GET-CURR-DATE-TIME                11370000
113800             PERFORM DP009-0000-LOAD-FK-LINES                     11380000
113900             PERFORM DP008-0000-WRITE-PANEL                       11390000
114000                                                                  11400000
114100         WHEN DP020-SRC-AID = DP016-CLEAR                         11410000
114200             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 11420000
114300                                                                  11430000
114400             PERFORM D500-EDIT-DATA-IN-COMMAREA                   11440000
114500             PERFORM C400-DISPLAY-PANEL                           11450000
114600                                                                  11460000
114700         WHEN OTHER                                               11470000
114800*            -- INVALID FUNCTION KEY --                           11480000
114900             PERFORM D500-EDIT-DATA-IN-COMMAREA                   11490000
115000             MOVE 45             TO DP020-MSG-NUMBER              11500000
115100             SET DP020-MSG-FATAL TO TRUE                          11510000
115200             PERFORM C400-DISPLAY-PANEL                           11520000
115300                                                                  11530000
115400     END-EVALUATE.                                                11540000
115500 EJECT                                                            11550000
115600                                                                  11560000
115700 D100-SET-LEVEL-TO-GREEN.                                         11570000
115800******************************************************************11580000
115900*                                                                 11590000
116000*                                                                 11600000
116100*                                                                 11610000
116200******************************************************************11620000
116300                                                                  11630000
116400     EVALUATE TRUE                                                11640000
116500          WHEN PV-INDEX-GMA-LEVEL                                 11650000
116600               MOVE DP015-GREEN     TO AGMAC                      11660000
116700               MOVE DP015-UNDERLINE TO AGMAH                      11670000
116800               MOVE DP015-UNP-ALP-NOR-OFF TO AGMAA                11680000
116900          WHEN PV-INDEX-DMA-LEVEL                                 11690000
117000               MOVE DP015-GREEN     TO ADMAC                      11700000
117100               MOVE DP015-UNDERLINE TO ADMAH                      11710000
117200               MOVE DP015-UNP-ALP-NOR-OFF TO ADMAA                11720000
117300          WHEN PV-INDEX-DPT-LEVEL                                 11730000
117400               MOVE DP015-GREEN     TO ADEPTC                     11740000
117500               MOVE DP015-UNDERLINE TO ADEPTH                     11750000
117600               MOVE DP015-UNP-ALP-NOR-OFF TO ADEPTA               11760000
117700          WHEN PV-INDEX-MCL-LEVEL                                 11770000
117800               MOVE DP015-GREEN     TO AMCLASSC                   11780000
117900               MOVE DP015-UNDERLINE TO AMCLASSH                   11790000
118000               MOVE DP015-UNP-ALP-NOR-OFF TO AMCLASSA             11800000
118100          WHEN PV-INDEX-SCL-LEVEL                                 11810000
118200               MOVE DP015-GREEN     TO ASCLASSC                   11820000
118300               MOVE DP015-UNDERLINE TO ASCLASSH                   11830000
118400               MOVE DP015-UNP-ALP-NOR-OFF TO ASCLASSA             11840000
118500     END-EVALUATE.                                                11850000
118600                                                                  11860000
118700                                                                  11870000
118800 D200-SET-LEVEL-TO-BLUE.                                          11880000
118900******************************************************************11890000
119000*                                                                 11900000
119100*                                                                 11910000
119200*                                                                 11920000
119300******************************************************************11930000
119400                                                                  11940000
119500     EVALUATE TRUE                                                11950000
119600          WHEN PV-INDEX-GMA-LEVEL                                 11960000
119700               MOVE DP015-BLUE        TO AGMAC  AGMDESCC          11970000
119800               MOVE DP015-HL-OFF      TO AGMAH  AGMDESCH          11980000
119900               MOVE DP015-ASK-NOR-OFF TO AGMAA  AGMDESCA          11990000
120000          WHEN PV-INDEX-DMA-LEVEL                                 12000000
120100               MOVE DP015-BLUE        TO ADMAC  ADMDESCC          12010000
120200               MOVE DP015-HL-OFF      TO ADMAH  ADMDESCH          12020000
120300               MOVE DP015-ASK-NOR-OFF TO ADMAA  ADMDESCA          12030000
120400          WHEN PV-INDEX-DPT-LEVEL                                 12040000
120500               MOVE DP015-BLUE        TO ADEPTC ADPDESCC          12050000
120600               MOVE DP015-HL-OFF      TO ADEPTH ADPDESCH          12060000
120700               MOVE DP015-ASK-NOR-OFF TO ADEPTA ADPDESCA          12070000
120800          WHEN PV-INDEX-MCL-LEVEL                                 12080000
120900               MOVE DP015-BLUE        TO AMCLASSC AMCDESCC        12090000
121000               MOVE DP015-HL-OFF      TO AMCLASSH AMCDESCH        12100000
121100               MOVE DP015-ASK-NOR-OFF TO AMCLASSA AMCDESCA        12110000
121200          WHEN PV-INDEX-SCL-LEVEL                                 12120000
121300               MOVE DP015-BLUE        TO ASCLASSC ASCDESCC        12130000
121400               MOVE DP015-HL-OFF      TO ASCLASSH ASCDESCH        12140000
121500               MOVE DP015-ASK-NOR-OFF TO ASCLASSA ASCDESCA        12150000
121600     END-EVALUATE.                                                12160000
121700                                                                  12170000
121800 D300-SET-LEVEL-TO-DARK.                                          12180000
121900******************************************************************12190000
122000*                                                                 12200000
122100*                                                                 12210000
122200*                                                                 12220000
122300******************************************************************12230000
122400                                                                  12240000
122500     EVALUATE TRUE                                                12250000
122600          WHEN PV-INDEX-GMA-LEVEL                                 12260000
122700               MOVE DP015-HL-OFF      TO AGMAH  AGMDESCH AGMTITLH 12270000
122800               MOVE DP015-PRO-DRK-OFF TO AGMAA  AGMDESCA AGMTITLA 12280000
122900          WHEN PV-INDEX-DMA-LEVEL                                 12290000
123000               MOVE DP015-HL-OFF      TO ADMAH  ADMDESCH ADMTITLH 12300000
123100               MOVE DP015-PRO-DRK-OFF TO ADMAA  ADMDESCA ADMTITLA 12310000
123200          WHEN PV-INDEX-DPT-LEVEL                                 12320000
123300               MOVE DP015-HL-OFF      TO ADEPTH ADPDESCH ADPTITLH 12330000
123400               MOVE DP015-PRO-DRK-OFF TO ADEPTA ADPDESCA ADPTITLA 12340000
123500          WHEN PV-INDEX-MCL-LEVEL                                 12350000
123600               MOVE DP015-HL-OFF      TO AMCLASSH AMCDESCH        12360000
123700                                         AMCTITLH                 12370000
123800               MOVE DP015-PRO-DRK-OFF TO AMCLASSA AMCDESCA        12380000
123900                                         AMCTITLA                 12390000
124000          WHEN PV-INDEX-SCL-LEVEL                                 12400000
124100               MOVE DP015-HL-OFF      TO ASCLASSH ASCDESCH        12410000
124200                                         ASCTITLH                 12420000
124300               MOVE DP015-PRO-DRK-OFF TO ASCLASSA ASCDESCA        12430000
124400                                         ASCTITLA                 12440000
124500     END-EVALUATE.                                                12450000
124600                                                                  12460000
124700 EJECT                                                            12470000
124800                                                                  12480000
124900                                                                  12490000
125000 D500-EDIT-DATA-IN-COMMAREA.                                      12500000
125100                                                                  12510000
125200******************************************************************12520000
125300*                                                                 12530000
125400*                                                                 12540000
125500*                                                                 12550000
125600*                                                                 12560000
125700*                                                                 12570000
125800******************************************************************12580000
125900     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       12590000
126000     MOVE DP017-EDITED-DATE-YYYYMMDD TO PK-END-DTE.               12600000
126100     MOVE DP017-CURRENT-DATE-YYYYMMDD TO ASC-CURRENT-DATE.        12610000
126200                                                                  12620000
126300     PERFORM C100-SET-SCREEN-ATTRIBUTES.                          12630000
126400                                                                  12640000
126500     PERFORM E800-RESET-SCREEN-ATTRB                              12650000
126600                                                                  12660000
126700     IF (ASC-ADD-DPT) AND                                         12670000
126800        (ASC-SCRN-BYR-NBR) = SPACES                               12680000
126900           SET PS-ERROR         TO TRUE                           12690000
127000           SET DP020-MSG-FATAL  TO TRUE                           12700000
127100           MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER               12710000
127200           MOVE DP015-RED       TO ABUYERC                        12720000
127300           MOVE DP015-REVERSE   TO ABUYERH                        12730000
127400           MOVE -1              TO ABUYERL                        12740000
127500     END-IF.                                                      12750000
127600     IF ASC-ADD-DPT                                               12760000
127700        PERFORM E700-VALIDATE-BUYER-NO                            12770000
127800     END-IF.                                                      12780000
127900                                                                  12790000
128000     IF ASC-SCRN-GEN-MDSETYP = SPACES                             12800000
128100        CONTINUE                                                  12810000
128200     ELSE                                                         12820000
128300         IF NOT ASC-VALID-MDSE-TYPE                               12830000
128400             SET PS-ERROR                                         12840000
128500                 DP020-MSG-FATAL TO TRUE                          12850000
128600             MOVE -1             TO AGENRLL                       12860000
128700             MOVE DP015-RED      TO AGENRLC                       12870000
128800             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             12880000
128900             MOVE DP015-REVERSE  TO AGENRLH                       12890000
129000         END-IF                                                   12900000
129100     END-IF.                                                      12910000
129200                                                                  12920000
129300     IF ASC-END-DT-PASS-EDIT                                      12930000
129400        CONTINUE                                                  12940000
129500     ELSE                                                         12950000
129600        PERFORM E200-EDIT-END-DATE                                12960000
129700     END-IF.                                                      12970000
129800                                                                  12980000
129900     IF ASC-START-DT-PASS-EDIT                                    12990000
130000        CONTINUE                                                  13000000
130100     ELSE                                                         13010000
130200        PERFORM E300-EDIT-START-DATE                              13020000
130300     END-IF.                                                      13030000
130400                                                                  13040000
130500     PERFORM E400-EDIT-DESCRIPTION.                               13050000
130600                                                                  13060000
130700     IF ASC-KEY-DATA-PASS-EDIT                                    13070000
130800         CONTINUE                                                 13080000
130900     ELSE                                                         13090000
131000         PERFORM E050-VALIDATE-MERCH-AREA-DATA                    13100000
131100     END-IF.                                                      13110000
131200*****                                                             13120000
131300* ALWAYS PERFORM E750 TO PROTECT THE MERCH AREA FIELDS            13130000
131400* BEFORE E725, BECAUSE E725 COULD SET THE ERROR FLAG ON           13140000
131500* THUS THE MERCH AREA FIELDS WOULD NOT GET PROTECTED.             13150000
131600*****                                                             13160000
131700     IF (ASC-KEY-DATA-PASS-EDIT AND PS-NO-NEED-DESCRIP) OR        13170000
131800        (ASC-KEY-PROTECTED)                                       13180000
131900        SET ASC-KEY-PROTECTED  TO TRUE                            13190000
132000        PERFORM E725-FILL-IN-PARENT-DEFAULTS                      13200000
132100     END-IF.                                                      13210000
132200                                                                  13220000
132300     IF (ASC-SCRN-STRT-YY NOT NUMERIC) OR                         13230000
132400        (ASC-SCRN-STRT-MM NOT NUMERIC) OR                         13240000
132500        (ASC-SCRN-STRT-DD NOT NUMERIC)                            13250000
132600         SET PS-ERROR                                             13260000
132700             PS-STRT-DATE-ERROR     TO TRUE                       13270000
132800         MOVE DP015-RED             TO ASTRTMMC                   13280000
132900                                       ASTRTDDC                   13290000
133000                                       ASTRTYYC                   13300000
133100         MOVE DP015-REVERSE         TO ASTRTMMH                   13310000
133200                                       ASTRTDDH                   13320000
133300                                       ASTRTYYH                   13330000
133400         MOVE DP015-UNP-ALP-BRT-OFF TO ASTRTMMA                   13340000
133500                                       ASTRTDDA                   13350000
133600                                       ASTRTYYA                   13360000
133700         IF ASC-KEY-PROTECTED                                     13370000
133800           MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER         13380000
133900           SET DP020-MSG-FATAL TO TRUE                            13390000
134000           MOVE -1                    TO ASTRTMML                 13400000
134100         END-IF                                                   13410000
134200     END-IF.                                                      13420000
134300                                                                  13430000
134400     IF PS-NO-ERROR                                               13440000
134500        PERFORM E600-COMPARE-DATE-RANGES                          13450000
134600     END-IF.                                                      13460000
134700                                                                  13470000
134800                                                                  13480000
134900                                                                  13490000
135000                                                                  13500000
135100 E050-VALIDATE-MERCH-AREA-DATA.                                   13510000
135200******************************************************************13520000
135300* VALIDATE ALL DATA RELATING TO THE MERCHANDISE AREA FIELDS:      13530000
135400*                                                                 13540000
135500*   1) USE FLAGS AT ALL LEVELS TO DETERMINE THAT ALL MERCH        13550000
135600*      AREA LEVELS ARE VALID. (CONVERT ALL LEVELS TO NUMERIC)     13560000
135700*                                                                 13570000
135800*   2) IF ALL ARE NUMERIC AND NOT = 0, DETERMINE MAJOR AND SUB    13580000
135900*      CLASS FIELDS TO BE VALID IF THOSE AREAS ARE BEING ENTERED. 13590000
136000*                                                                 13600000
136100*   3) THE FIELD PS-DATA-ERROR INDICATES THAT THERE IS AN         13610000
136200*      ERROR WITH THE MERCHANDISE AREA FIELDS ONLY. PS-ERROR IS   13620000
136300*      USED WHEN THERE IS AN ERROR WITH ANY FIELD, NO MATTER WHAT 13630000
136400*      THE ERROR.                                                 13640000
136500*                                                                 13650000
136600*   4) DETERMINE THAT THE MERCHANDISE AREA TO BE ADDED            13660000
136700*      DOES NOT ALREADY EXIST                                     13670000
136800*                                                                 13680000
136900*   5) DETERMINE THAT THE PARENT MERCHANDISE AREA EXISTS, AND     13690000
137000*      GET PARENT MERCHANDISE AREA DEFAULTS.                      13700000
137100*                                                                 13710000
137200*   6) GET MERCHANDISE AREA DESCRIPTIONS FOR THOSE LEVELS         13720000
137300*      ABOVE THE ONE TO BE ADDED.                                 13730000
137400*                                                                 13740000
137500*   7) FILL IN MERCHANDISE AREA FIELDS THAT ARE BLANK WITH 0'S TO 13750000
137600*      PASS TO THE ADD PROGRAM.(MBKCS106)                         13760000
137700*                                                                 13770000
137800*  PERFORMED BY : D500-EDIT-DATA-IN-COMMAREA                      13780000
137900******************************************************************13790000
138000                                                                  13800000
138100                                                                  13810000
138200     PERFORM E095-FILL-IN-ZEROES.                                 13820000
138300                                                                  13830000
138400     SET PS-GMA-PASS-EDIT                                         13840000
138500         PS-DMA-PASS-EDIT                                         13850000
138600         PS-DPT-PASS-EDIT                                         13860000
138700         PS-MCL-PASS-EDIT                                         13870000
138800         PS-SCL-PASS-EDIT    TO TRUE.                             13880000
138900                                                                  13890000
139000     MOVE ASC-ADD-MDSE-LEVEL TO PV-LEVEL-INDEX-END.               13900000
139100                                                                  13910000
139200     PERFORM E075-VALIDATE-MERCH-AREA                             13920000
139300            VARYING PV-LEVEL-INDEX                                13930000
139400            FROM 1 BY 1                                           13940000
139500            UNTIL PV-LEVEL-INDEX > PV-LEVEL-INDEX-END.            13950000
139600                                                                  13960000
139700     IF ((PS-GMA-PASS-EDIT) AND                                   13970000
139800         (PS-DMA-PASS-EDIT) AND                                   13980000
139900         (PS-DPT-PASS-EDIT) AND                                   13990000
140000         (PS-MCL-PASS-EDIT) AND                                   14000000
140100         (PS-SCL-PASS-EDIT))                                      14010000
140200                                                                  14020000
140300        SET PS-NO-DATA-ERROR TO TRUE                              14030000
140400        PERFORM F800-TEST-MCL-DIGITS                              14040000
140500                                                                  14050000
140600*****                                                             14060000
140700* DETERMINE THAT LEVEL TO BE ADDED DOES NOT ALREADY EXIST         14070000
140800*****                                                             14080000
140900        IF PS-NO-DATA-ERROR                                       14090000
141000                                                                  14100000
141100            MOVE '1900-01-01'       TO PK-END-DTE                 14110000
141200            MOVE ASC-ADD-MDSE-LEVEL TO PV-LEVEL-INDEX             14120000
141300            SET PS-NO-NEED-ROW TO TRUE                            14130000
141400                                                                  14140000
141500            PERFORM E500-EDIT-MDSEAR-ENTRY                        14150000
141600                                                                  14160000
141700*****                                                             14170000
141800* DETERMINE THAT PARENT LEVEL MERCHANDISE AREA DOES EXIST         14180000
141900*****                                                             14190000
142000            IF PS-NO-DATA-ERROR                                   14200000
142100                MOVE DP017-EDITED-DATE-YYYYMMDD TO PK-END-DTE     14210000
142200                PERFORM E150-GET-PARENT-TMDSEAR                   14220000
142300            END-IF                                                14230000
142400        END-IF                                                    14240000
142500     ELSE                                                         14250000
142600        SET PS-ERROR TO TRUE                                      14260000
142700     END-IF.                                                      14270000
142800                                                                  14280000
142900                                                                  14290000
143000     EJECT                                                        14300000
143100                                                                  14310000
143200 E075-VALIDATE-MERCH-AREA.                                        14320000
143300******************************************************************14330000
143400*                                                                 14340000
143500*  PERFORMED BY : E050-VALIDATE-MERCH-AREA-DATA.                  14350000
143600******************************************************************14360000
143700                                                                  14370000
143800                                                                  14380000
143900     EVALUATE TRUE                                                14390000
144000          WHEN PV-INDEX-GMA-LEVEL                                 14400000
144100               SET PS-GMA-NEED-EDIT  TO TRUE                      14410000
144200               PERFORM F250-EDIT-GMA-NUMBER                       14420000
144300          WHEN PV-INDEX-DMA-LEVEL                                 14430000
144400               SET PS-DMA-NEED-EDIT  TO TRUE                      14440000
144500               PERFORM F251-EDIT-DMA-NUMBER                       14450000
144600          WHEN PV-INDEX-DPT-LEVEL                                 14460000
144700               SET PS-DPT-NEED-EDIT  TO TRUE                      14470000
144800               PERFORM F252-EDIT-DPT-NUMBER                       14480000
144900          WHEN PV-INDEX-MCL-LEVEL                                 14490000
145000               SET PS-MCL-NEED-EDIT  TO TRUE                      14500000
145100               PERFORM F253-EDIT-MCL-NUMBER                       14510000
145200          WHEN PV-INDEX-SCL-LEVEL                                 14520000
145300               SET PS-SCL-NEED-EDIT  TO TRUE                      14530000
145400               PERFORM F254-EDIT-SCL-NUMBER                       14540000
145500     END-EVALUATE.                                                14550000
145600                                                                  14560000
145700                                                                  14570000
145800 EJECT                                                            14580000
145900 E095-FILL-IN-ZEROES.                                             14590000
146000******************************************************************14600000
146100*  FILL IN LOWER LEVELS WITH VALUE '0' (IN COMMAREA) TO SEND      14610000
146200*  TO ADD PROGRAM.                                                14620000
146300*                                                                 14630000
146400*  PERFORMED BY : E050-VALIDATE-MERCH-AREA-DATA.                  14640000
146500******************************************************************14650000
146600     IF ASC-ADD-GMA                                               14660000
146700        MOVE '000' TO ASC-SCRN-DMA-NO                             14670000
146800                      ASC-SCRN-DPT-NO                             14680000
146900                      ASC-SCRN-MCL-NO                             14690000
147000                      ASC-SCRN-SCL-NO                             14700000
147100     ELSE                                                         14710000
147200        IF ASC-ADD-DMA                                            14720000
147300            MOVE '000' TO ASC-SCRN-DPT-NO                         14730000
147400                          ASC-SCRN-MCL-NO                         14740000
147500                          ASC-SCRN-SCL-NO                         14750000
147600        ELSE                                                      14760000
147700            IF ASC-ADD-DPT                                        14770000
147800                MOVE '000' TO ASC-SCRN-MCL-NO                     14780000
147900                              ASC-SCRN-SCL-NO                     14790000
148000            ELSE                                                  14800000
148100              IF ASC-ADD-MCL                                      14810000
148200                MOVE '000' TO ASC-SCRN-SCL-NO                     14820000
148300              END-IF                                              14830000
148400            END-IF                                                14840000
148500        END-IF                                                    14850000
148600     END-IF.                                                      14860000
148700                                                                  14870000
148800     EJECT                                                        14880000
148900 E100-MOVE-SCREEN-TO-COMMAREA.                                    14890000
149000                                                                  14900000
149100******************************************************************14910000
149200*                                                                 14920000
149300******************************************************************14930000
149400     IF AGMAL > 0                                                 14940000
149500        MOVE AGMAI   TO ASC-SCRN-GMA-NO                           14950000
149600        SET ASC-KEY-DATA-NEED-EDIT TO TRUE                        14960000
149700     ELSE                                                         14970000
149800        IF AGMAF = DP015-ERASE-EOF                                14980000
149900           MOVE SPACE TO ASC-SCRN-GMA-NO                          14990000
150000           SET ASC-KEY-DATA-NEED-EDIT TO TRUE                     15000000
150100        END-IF                                                    15010000
150200     END-IF.                                                      15020000
150300                                                                  15030000
150400     IF AGMDESCL > 0                                              15040000
150500        MOVE AGMDESCI   TO ASC-GMA-DESC                           15050000
150600     ELSE                                                         15060000
150700        IF AGMDESCF = DP015-ERASE-EOF                             15070000
150800           MOVE SPACE TO ASC-GMA-DESC                             15080000
150900        END-IF                                                    15090000
151000     END-IF.                                                      15100000
151100                                                                  15110000
151200     IF ADMAL > 0                                                 15120000
151300        MOVE ADMAI   TO ASC-SCRN-DMA-NO                           15130000
151400        SET ASC-KEY-DATA-NEED-EDIT TO TRUE                        15140000
151500     ELSE                                                         15150000
151600        IF ADMAF = DP015-ERASE-EOF                                15160000
151700           MOVE SPACE TO ASC-SCRN-DMA-NO                          15170000
151800           SET ASC-KEY-DATA-NEED-EDIT TO TRUE                     15180000
151900        END-IF                                                    15190000
152000     END-IF.                                                      15200000
152100                                                                  15210000
152200     IF ADMDESCL > 0                                              15220000
152300        MOVE ADMDESCI   TO ASC-DMA-DESC                           15230000
152400     ELSE                                                         15240000
152500        IF ADMDESCF = DP015-ERASE-EOF                             15250000
152600           MOVE SPACE TO ASC-DMA-DESC                             15260000
152700        END-IF                                                    15270000
152800     END-IF.                                                      15280000
152900                                                                  15290000
153000     IF ADEPTL > 0                                                15300000
153100        MOVE ADEPTI   TO ASC-SCRN-DPT-NO                          15310000
153200        SET ASC-KEY-DATA-NEED-EDIT TO TRUE                        15320000
153300     ELSE                                                         15330000
153400        IF ADEPTF = DP015-ERASE-EOF                               15340000
153500           MOVE SPACE TO ASC-SCRN-DPT-NO                          15350000
153600           SET ASC-KEY-DATA-NEED-EDIT TO TRUE                     15360000
153700        END-IF                                                    15370000
153800     END-IF.                                                      15380000
153900                                                                  15390000
154000     IF ADPDESCL > 0                                              15400000
154100        MOVE ADPDESCI   TO ASC-DPT-DESC                           15410000
154200     ELSE                                                         15420000
154300        IF ADPDESCF = DP015-ERASE-EOF                             15430000
154400           MOVE SPACE TO ASC-DPT-DESC                             15440000
154500        END-IF                                                    15450000
154600     END-IF.                                                      15460000
154700                                                                  15470000
154800     IF AMCLASSL > 0                                              15480000
154900        MOVE AMCLASSI   TO ASC-SCRN-MCL-NO                        15490000
155000        SET ASC-KEY-DATA-NEED-EDIT TO TRUE                        15500000
155100     ELSE                                                         15510000
155200        IF AMCLASSF = DP015-ERASE-EOF                             15520000
155300           MOVE SPACE TO ASC-SCRN-MCL-NO                          15530000
155400           SET ASC-KEY-DATA-NEED-EDIT TO TRUE                     15540000
155500        END-IF                                                    15550000
155600     END-IF.                                                      15560000
155700                                                                  15570000
155800     IF AMCDESCL > 0                                              15580000
155900        MOVE AMCDESCI   TO ASC-MCL-DESC                           15590000
156000     ELSE                                                         15600000
156100        IF AMCDESCF = DP015-ERASE-EOF                             15610000
156200           MOVE SPACE TO ASC-MCL-DESC                             15620000
156300        END-IF                                                    15630000
156400     END-IF.                                                      15640000
156500                                                                  15650000
156600     IF ASCLASSL > 0                                              15660000
156700        MOVE ASCLASSI   TO ASC-SCRN-SCL-NO                        15670000
156800        SET ASC-KEY-DATA-NEED-EDIT TO TRUE                        15680000
156900     ELSE                                                         15690000
157000        IF ASCLASSF = DP015-ERASE-EOF                             15700000
157100           MOVE SPACE TO ASC-SCRN-SCL-NO                          15710000
157200           SET ASC-KEY-DATA-NEED-EDIT TO TRUE                     15720000
157300        END-IF                                                    15730000
157400     END-IF.                                                      15740000
157500                                                                  15750000
157600     IF ASCDESCL > 0                                              15760000
157700        MOVE ASCDESCI   TO ASC-SCL-DESC                           15770000
157800     ELSE                                                         15780000
157900        IF ASCDESCF = DP015-ERASE-EOF                             15790000
158000           MOVE SPACE TO ASC-SCL-DESC                             15800000
158100        END-IF                                                    15810000
158200     END-IF.                                                      15820000
158300                                                                  15830000
158400     IF ASTRTMML > 0                                              15840000
158500        MOVE ASTRTMMI  TO ASC-SCRN-STRT-MM-X                      15850000
158600        SET ASC-START-DT-NEED-EDIT TO TRUE                        15860000
158700     ELSE                                                         15870000
158800        IF ASTRTMMF = DP015-ERASE-EOF                             15880000
158900           MOVE SPACES TO ASC-SCRN-STRT-MM-X                      15890000
159000           SET ASC-START-DT-NEED-EDIT TO TRUE                     15900000
159100        END-IF                                                    15910000
159200     END-IF.                                                      15920000
159300                                                                  15930000
159400     IF ASTRTDDL > 0                                              15940000
159500        MOVE ASTRTDDI  TO ASC-SCRN-STRT-DD-X                      15950000
159600        SET ASC-START-DT-NEED-EDIT TO TRUE                        15960000
159700     ELSE                                                         15970000
159800        IF ASTRTDDF = DP015-ERASE-EOF                             15980000
159900           MOVE SPACES TO ASC-SCRN-STRT-DD-X                      15990000
160000           SET ASC-START-DT-NEED-EDIT TO TRUE                     16000000
160100        END-IF                                                    16010000
160200     END-IF.                                                      16020000
160300                                                                  16030000
160400     IF ASTRTYYL > 0                                              16040000
160500        MOVE ASTRTYYI  TO ASC-SCRN-STRT-YY-X                      16050000
160600        SET ASC-START-DT-NEED-EDIT TO TRUE                        16060000
160700     ELSE                                                         16070000
160800        IF ASTRTYYF = DP015-ERASE-EOF                             16080000
160900           MOVE SPACES TO ASC-SCRN-STRT-YY-X                      16090000
161000           SET ASC-START-DT-NEED-EDIT TO TRUE                     16100000
161100        END-IF                                                    16110000
161200     END-IF.                                                      16120000
161300                                                                  16130000
161400     IF AENDMML > 0                                               16140000
161500        MOVE AENDMMI  TO ASC-SCRN-END-MM-X                        16150000
161600        SET ASC-END-DT-NEED-EDIT TO TRUE                          16160000
161700     ELSE                                                         16170000
161800        IF AENDMMF = DP015-ERASE-EOF                              16180000
161900           MOVE SPACES TO ASC-SCRN-END-MM-X                       16190000
162000           SET ASC-END-DT-NEED-EDIT TO TRUE                       16200000
162100        END-IF                                                    16210000
162200     END-IF.                                                      16220000
162300                                                                  16230000
162400     IF AENDDDL > 0                                               16240000
162500        MOVE AENDDDI  TO ASC-SCRN-END-DD-X                        16250000
162600        SET ASC-END-DT-NEED-EDIT TO TRUE                          16260000
162700     ELSE                                                         16270000
162800        IF AENDDDF = DP015-ERASE-EOF                              16280000
162900           MOVE SPACES TO ASC-SCRN-END-DD-X                       16290000
163000           SET ASC-END-DT-NEED-EDIT TO TRUE                       16300000
163100        END-IF                                                    16310000
163200     END-IF.                                                      16320000
163300                                                                  16330000
163400     IF AENDYYL > 0                                               16340000
163500        MOVE AENDYYI  TO ASC-SCRN-END-YY-X                        16350000
163600        SET ASC-END-DT-NEED-EDIT TO TRUE                          16360000
163700     ELSE                                                         16370000
163800        IF AENDYYF = DP015-ERASE-EOF                              16380000
163900           MOVE SPACES TO ASC-SCRN-END-YY-X                       16390000
164000           SET ASC-END-DT-NEED-EDIT TO TRUE                       16400000
164100        END-IF                                                    16410000
164200     END-IF.                                                      16420000
164300                                                                  16430000
164400     IF AGENRLL > 0                                               16440000
164500        MOVE AGENRLI TO ASC-SCRN-GEN-MDSETYP                      16450000
164600     ELSE                                                         16460000
164700        IF AGENRLF = DP015-ERASE-EOF                              16470000
164800           MOVE SPACES TO ASC-SCRN-GEN-MDSETYP                    16480000
164900        END-IF                                                    16490000
165000     END-IF.                                                      16500000
165100                                                                  16510000
165200     IF ABUYERL > 0                                               16520000
165300        MOVE ABUYERI TO ASC-SCRN-BYR-NBR                          16530000
165400     ELSE                                                         16540000
165500        IF ABUYERF = DP015-ERASE-EOF                              16550000
165600           MOVE SPACES TO ASC-SCRN-BYR-NBR                        16560000
165700        END-IF                                                    16570000
165800     END-IF.                                                      16580000
165900 EJECT                                                            16590000
166000                                                                  16600000
166100 E150-GET-PARENT-TMDSEAR.                                         16610000
166200******************************************************************16620000
166300*    GET PARENT LEVEL MERCHANDISE AREA INFORMATION AND MOVE IT    16630000
166400*    TO COMMAREA.                                                 16640000
166500*                                                                 16650000
166600******************************************************************16660000
166700     COMPUTE PV-LEVEL-INDEX = ASC-ADD-MDSE-LEVEL - 1              16670000
166800     SET PS-NEED-ROW TO TRUE                                      16680000
166900                                                                  16690000
167000     INITIALIZE ASC-PARENT-MDSEAR-DKEY                            16700000
167100     PERFORM E500-EDIT-MDSEAR-ENTRY                               16710000
167200     IF PS-NO-DATA-ERROR                                          16720000
167300                                                                  16730000
167400        MOVE MDSEAR-DKEY                                          16740000
167500                    TO ASC-PARENT-MDSEAR-DKEY                     16750000
167600        MOVE MDSEAR-END-DTE                                       16760000
167700                    TO PV-WORK-DATE                               16770000
167800        MOVE PV-WORK-CC TO ASC-LEVEL-END-CC-X                     16780000
167900        MOVE PV-WORK-MM TO ASC-LEVEL-END-MM-X                     16790000
168000        MOVE PV-WORK-DD TO ASC-LEVEL-END-DD-X                     16800000
168100        MOVE PV-WORK-YY TO ASC-LEVEL-END-YY-X                     16810000
168200        MOVE MDSEAR-STRT-DTE                                      16820000
168300                    TO PV-WORK-DATE                               16830000
168400        MOVE PV-WORK-CC TO ASC-LEVEL-STRT-CC-X                    16840000
168500        MOVE PV-WORK-MM TO ASC-LEVEL-STRT-MM-X                    16850000
168600        MOVE PV-WORK-DD TO ASC-LEVEL-STRT-DD-X                    16860000
168700        MOVE PV-WORK-YY TO ASC-LEVEL-STRT-YY-X                    16870000
168800        MOVE MDSEAR-BYR-NBR                                       16880000
168900                    TO ASC-PARENT-LVL-BYR-NBR                     16890000
169000        MOVE MDSEAR-GEN-MDSE-TYP-CDE                              16900000
169100                    TO ASC-PARENT-LVL-MDSETYP                     16910000
169200                                                                  16920000
169300        IF PV-LEVEL-INDEX > 0                                     16930000
169400           PERFORM K100-RETRIEVE-DATA-FOR-PANEL                   16940000
169500        END-IF                                                    16950000
169600                                                                  16960000
169700        SET ASC-KEY-DATA-PASS-EDIT TO TRUE                        16970000
169800                                                                  16980000
169900     END-IF.                                                      16990000
170000                                                                  17000000
170100 E200-EDIT-END-DATE.                                              17010000
170200                                                                  17020000
170300******************************************************************17030000
170400*                                                                 17040000
170500*                                                                 17050000
170600*                                                                 17060000
170700*                                                                 17070000
170800*                                                                 17080000
170900******************************************************************17090000
171000                                                                  17100000
171100     MOVE ASC-SCRN-END-MM-X                  TO AENDMMO.          17110000
171200     MOVE ASC-SCRN-END-DD-X                  TO AENDDDO.          17120000
171300     MOVE ASC-SCRN-END-YY-X                  TO AENDYYO.          17130000
171400     IF  ASC-SCRN-END-MM-X = '00'                                 17140000
171500                     OR SPACE                                     17150000
171600         CONTINUE                                                 17160000
171700     ELSE                                                         17170000
171800         MOVE ASC-SCRN-END-MM-X         TO DP010I-UNEDITED-FIELD  17180000
171900         MOVE +2                        TO DP010I-MAXIMUM-DIGITS  17190000
172000         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      17200000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17211008
262978              USING DP010I-NUMERIC-EDIT-AREA                      17212008
172200         IF  DP010I-ERROR-DETECTED                                17220000
172300             SET PS-END-DATE-ERROR TO TRUE                        17230000
172400         ELSE                                                     17240000
172500             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-END-MM        17250000
172600             MOVE ASC-SCRN-END-MM-X     TO AENDMMO                17260000
172700         END-IF                                                   17270000
172800     END-IF.                                                      17280000
172900*                                                                 17290000
173000     IF  ASC-SCRN-END-DD-X = '00'                                 17300000
173100                     OR SPACE                                     17310000
173200         CONTINUE                                                 17320000
173300     ELSE                                                         17330000
173400         MOVE ASC-SCRN-END-DD-X      TO DP010I-UNEDITED-FIELD     17340000
173500         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      17350000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17361008
262978              USING DP010I-NUMERIC-EDIT-AREA                      17362008
173700         IF  DP010I-ERROR-DETECTED                                17370000
173800             SET PS-END-DATE-ERROR TO TRUE                        17380000
173900         ELSE                                                     17390000
174000             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-END-DD        17400000
174100             MOVE ASC-SCRN-END-DD-X     TO AENDDDO                17410000
174200         END-IF                                                   17420000
174300     END-IF.                                                      17430000
174400*                                                                 17440000
174500     IF  ASC-SCRN-END-YY-X = '00'                                 17450000
174600                     OR SPACE                                     17460000
174700         CONTINUE                                                 17470000
174800     ELSE                                                         17480000
174900         MOVE ASC-SCRN-END-YY-X      TO DP010I-UNEDITED-FIELD     17490000
175000         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      17500000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17511008
262978              USING DP010I-NUMERIC-EDIT-AREA                      17512008
175200         IF  DP010I-ERROR-DETECTED                                17520000
175300             SET PS-END-DATE-ERROR TO TRUE                        17530000
175400         ELSE                                                     17540000
175500             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-END-YY        17550000
175600             MOVE ASC-SCRN-END-YY-X          TO AENDYYO           17560000
175700         END-IF                                                   17570000
175800     END-IF.                                                      17580000
175900*                                                                 17590000
176000     IF  PS-END-DATE-ERROR                                        17600000
176100*        --  DATE MUST BE NUMERIC --                              17610000
176200         SET PS-ERROR TO TRUE                                     17620000
176300         MOVE DP015-RED                 TO AENDMMC                17630000
176400                                           AENDDDC                17640000
176500                                           AENDYYC                17650000
176600         MOVE DP015-REVERSE             TO AENDMMH                17660000
176700                                           AENDDDH                17670000
176800                                           AENDYYH                17680000
176900         MOVE DP015-UNP-ALP-BRT-OFF     TO AENDMMA                17690000
177000                                           AENDDDA                17700000
177100                                           AENDYYA                17710000
177200         MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER       17720000
177300         SET DP020-MSG-FATAL TO TRUE                              17730000
177400         MOVE -1                        TO AENDMML                17740000
177500     ELSE                                                         17750000
177600       IF ASC-SCRN-END-DTE = SPACES                               17760000
177700           MOVE ASC-LEVEL-END-DTE-X TO ASC-SCRN-END-YYYYMMDD      17770000
177800       ELSE                                                       17780000
177900         IF  ASC-SCRN-END-DTE > ZERO                              17790000
178000             PERFORM F100-VALIDATE-END-DATE                       17800000
178100         ELSE                                                     17810000
178200             IF  ASC-SCRN-END-DTE = ZERO                          17820000
178300*            -- 'END DATE MUST BE SPECIFIED' --                   17830000
178400                 SET PS-END-DATE-ERROR                            17840000
178500                     PS-ERROR               TO TRUE               17850000
178600                 MOVE DP015-RED             TO AENDMMC            17860000
178700                                               AENDDDC            17870000
178800                                               AENDYYC            17880000
178900                 MOVE DP015-REVERSE         TO AENDMMH            17890000
179000                                               AENDDDH            17900000
179100                                               AENDYYH            17910000
179200                 MOVE DP015-UNP-ALP-BRT-OFF TO AENDMMA            17920000
179300                                               AENDDDA            17930000
179400                                               AENDYYA            17940000
179500                 MOVE PC-TSYMSG-00010       TO DP020-MSG-NUMBER   17950000
179600                 SET DP020-MSG-FATAL TO TRUE                      17960000
179700                 MOVE -1                    TO AENDMML            17970000
179800             ELSE                                                 17980000
179900*            -- 'INVALID END DATE ' --                            17990000
180000                 SET PS-END-DATE-ERROR                            18000000
180100                     PS-ERROR               TO TRUE               18010000
180200                 MOVE DP015-RED             TO AENDMMC            18020000
180300                                               AENDDDC            18030000
180400                                               AENDYYC            18040000
180500                 MOVE DP015-REVERSE         TO AENDMMH            18050000
180600                                               AENDDDH            18060000
180700                                               AENDYYH            18070000
180800                 MOVE DP015-UNP-ALP-BRT-OFF TO AENDMMA            18080000
180900                                               AENDDDA            18090000
181000                                               AENDYYA            18100000
181100                 MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER   18110000
181200                 SET DP020-MSG-FATAL TO TRUE                      18120000
181300                 MOVE -1                    TO AENDMML            18130000
181400             END-IF                                               18140000
181500         END-IF                                                   18150000
181600       END-IF                                                     18160000
181700     END-IF.                                                      18170000
181800     EJECT                                                        18180000
181900                                                                  18190000
182000 E300-EDIT-START-DATE.                                            18200000
182100                                                                  18210000
182200******************************************************************18220000
182300*                                                                 18230000
182400*                                                                 18240000
182500*                                                                 18250000
182600*                                                                 18260000
182700*                                                                 18270000
182800******************************************************************18280000
182900                                                                  18290000
183000     MOVE ASC-SCRN-STRT-MM-X                  TO ASTRTMMO.        18300000
183100     MOVE ASC-SCRN-STRT-DD-X                  TO ASTRTDDO.        18310000
183200     MOVE ASC-SCRN-STRT-YY-X                  TO ASTRTYYO.        18320000
183300     IF  ASC-SCRN-STRT-MM-X = '00'                                18330000
183400                     OR SPACE                                     18340000
183500         CONTINUE                                                 18350000
183600     ELSE                                                         18360000
183700         MOVE ASC-SCRN-STRT-MM-X        TO DP010I-UNEDITED-FIELD  18370000
183800         MOVE +2                        TO DP010I-MAXIMUM-DIGITS  18380000
183900         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      18390000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18401008
262978              USING DP010I-NUMERIC-EDIT-AREA                      18402008
184100         IF  DP010I-ERROR-DETECTED                                18410000
184200             SET PS-STRT-DATE-ERROR TO TRUE                       18420000
184300         ELSE                                                     18430000
184400             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-STRT-MM       18440000
184500             MOVE ASC-SCRN-STRT-MM-X     TO ASTRTMMO              18450000
184600         END-IF                                                   18460000
184700     END-IF.                                                      18470000
184800*                                                                 18480000
184900     IF  ASC-SCRN-STRT-DD-X = '00'                                18490000
185000                     OR SPACE                                     18500000
185100         CONTINUE                                                 18510000
185200     ELSE                                                         18520000
185300         MOVE ASC-SCRN-STRT-DD-X      TO DP010I-UNEDITED-FIELD    18530000
185400         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      18540000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18551008
262978              USING DP010I-NUMERIC-EDIT-AREA                      18552008
185600         IF  DP010I-ERROR-DETECTED                                18560000
185700             SET PS-STRT-DATE-ERROR TO TRUE                       18570000
185800         ELSE                                                     18580000
185900             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-STRT-DD       18590000
186000             MOVE ASC-SCRN-STRT-DD-X     TO ASTRTDDO              18600000
186100         END-IF                                                   18610000
186200     END-IF.                                                      18620000
186300*                                                                 18630000
186400     IF  ASC-SCRN-STRT-YY-X = '00'                                18640000
186500                     OR SPACE                                     18650000
186600         CONTINUE                                                 18660000
186700     ELSE                                                         18670000
186800         MOVE ASC-SCRN-STRT-YY-X      TO DP010I-UNEDITED-FIELD    18680000
186900         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      18690000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18701008
262978              USING DP010I-NUMERIC-EDIT-AREA                      18702008
187100         IF  DP010I-ERROR-DETECTED                                18710000
187200             SET PS-STRT-DATE-ERROR TO TRUE                       18720000
187300         ELSE                                                     18730000
187400             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-STRT-YY       18740000
187500             MOVE ASC-SCRN-STRT-YY-X          TO ASTRTYYO         18750000
187600         END-IF                                                   18760000
187700     END-IF.                                                      18770000
187800*                                                                 18780000
187900                                                                  18790000
188000     IF  PS-STRT-DATE-ERROR                                       18800000
188100*        --  DATE MUST BE NUMERIC --                              18810000
188200         SET PS-ERROR TO TRUE                                     18820000
188300         MOVE DP015-RED                 TO ASTRTMMC               18830000
188400                                           ASTRTDDC               18840000
188500                                           ASTRTYYC               18850000
188600         MOVE DP015-REVERSE             TO ASTRTMMH               18860000
188700                                           ASTRTDDH               18870000
188800                                           ASTRTYYH               18880000
188900         MOVE DP015-UNP-ALP-BRT-OFF     TO ASTRTMMA               18890000
189000                                           ASTRTDDA               18900000
189100                                           ASTRTYYA               18910000
189200         MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER       18920000
189300         SET DP020-MSG-FATAL TO TRUE                              18930000
189400         MOVE -1                        TO ASTRTMML               18940000
189500     ELSE                                                         18950000
189600         IF (ASC-SCRN-STRT-DTE > ZERO) AND                        18960000
189700            (ASC-SCRN-STRT-YY NUMERIC) AND                        18970000
189800            (ASC-SCRN-STRT-MM NUMERIC) AND                        18980000
189900            (ASC-SCRN-STRT-DD NUMERIC)                            18990000
190000             PERFORM F200-VALIDATE-START-DATE                     19000000
190100         ELSE                                                     19010000
190200            IF (ASC-SCRN-STRT-DTE = ZERO) AND                     19020000
190300               (ASC-SCRN-STRT-YY NUMERIC) AND                     19030000
190400               (ASC-SCRN-STRT-MM NUMERIC) AND                     19040000
190500               (ASC-SCRN-STRT-DD NUMERIC)                         19050000
190600**              -- 'DATE CANNOT BE ZERO' --                       19060000
190700                SET PS-ERROR                                      19070000
190800                    PS-STRT-DATE-ERROR     TO TRUE                19080000
190900                MOVE DP015-RED             TO ASTRTMMC            19090000
191000                                              ASTRTDDC            19100000
191100                                              ASTRTYYC            19110000
191200                MOVE DP015-REVERSE         TO ASTRTMMH            19120000
191300                                              ASTRTDDH            19130000
191400                                              ASTRTYYH            19140000
191500                MOVE DP015-UNP-ALP-BRT-OFF TO ASTRTMMA            19150000
191600                                              ASTRTDDA            19160000
191700                                              ASTRTYYA            19170000
191800                MOVE PC-TSYMSG-00010       TO DP020-MSG-NUMBER    19180000
191900                SET DP020-MSG-FATAL TO TRUE                       19190000
192000                MOVE -1                    TO ASTRTMML            19200000
192100*           ELSE                                                  19210000
192200**              -- 'DATE CANNOT BE ZERO' --                       19220000
192300*               SET PS-ERROR                                      19230000
192400*                   PS-STRT-DATE-ERROR     TO TRUE                19240000
192500*               MOVE DP015-RED             TO ASTRTMMC            19250000
192600*                                             ASTRTDDC            19260000
192700*                                             ASTRTYYC            19270000
192800*               MOVE DP015-REVERSE         TO ASTRTMMH            19280000
192900*                                             ASTRTDDH            19290000
193000*                                             ASTRTYYH            19300000
193100*               MOVE DP015-UNP-ALP-BRT-OFF TO ASTRTMMA            19310000
193200*                                             ASTRTDDA            19320000
193300*                                             ASTRTYYA            19330000
193400*               MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER    19340000
193500*               SET DP020-MSG-FATAL TO TRUE                       19350000
193600*               MOVE -1                    TO ASTRTMML            19360000
193700*           END-IF                                                19370000
193800         END-IF                                                   19380000
193900     END-IF.                                                      19390000
194000     EJECT                                                        19400000
194100                                                                  19410000
194200 E400-EDIT-DESCRIPTION.                                           19420000
194300******************************************************************19430000
194400*                                                                 19440000
194500*                                                                 19450000
194600*                                                                 19460000
194700*                                                                 19470000
194800*                                                                 19480000
194900******************************************************************19490000
195000     SET PS-NO-NEED-DESCRIP TO TRUE                               19500000
195100     IF (ASC-ADD-GMA)                                             19510000
195200        IF ASC-GMA-DESC = SPACES                                  19520000
195300                                                                  19530000
195400****         REQUIRED ENTRY                                       19540000
195500                                                                  19550000
195600             SET PS-NEED-DESCRIP                                  19560000
195700                 PS-ERROR TO TRUE                                 19570000
195800             MOVE DP015-RED             TO AGMDESCC               19580000
195900             MOVE DP015-REVERSE         TO AGMDESCH               19590000
196000             MOVE DP015-UNP-ALP-BRT-OFF TO AGMDESCA               19600000
196100             MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER       19610000
196200             SET DP020-MSG-FATAL TO TRUE                          19620000
196300             MOVE -1                    TO AGMDESCL               19630000
196400        ELSE                                                      19640000
196500**         CHECK THE GMA DESCRIPTION FIELD FOR UNDERSCORES        19650000
196600             MOVE ZERO TO PV-UNDERSCORE-COUNT                     19660000
196700             INSPECT ASC-GMA-DESC                                 19670000
196800                 TALLYING PV-UNDERSCORE-COUNT                     19680000
196900                 FOR ALL '_'                                      19690000
197000             IF PV-UNDERSCORE-COUNT > ZERO                        19700000
197100                 SET PS-NEED-DESCRIP                              19710000
197200                     PS-ERROR TO TRUE                             19720000
197300                 MOVE DP015-RED        TO AGMDESCC                19730000
197400                 MOVE DP015-REVERSE    TO AGMDESCH                19740000
197500                 MOVE DP015-UNP-ALP-BRT-OFF TO AGMDESCA           19750000
197600***            ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --    19760000
197700***               PLEASE REMOVE **                                19770000
197800                 MOVE PC-TSYMSG-01643  TO DP020-MSG-NUMBER        19780000
197900                 SET DP020-MSG-FATAL   TO TRUE                    19790000
198000                 MOVE -1               TO AGMDESCL                19800000
198100             END-IF                                               19810000
198200        END-IF                                                    19820000
198300     END-IF.                                                      19830000
198400                                                                  19840000
198500     IF (ASC-ADD-DMA)                                             19850000
198600        IF ASC-DMA-DESC = SPACES                                  19860000
198700                                                                  19870000
198800****         REQUIRED ENTRY                                       19880000
198900                                                                  19890000
199000             SET PS-NEED-DESCRIP                                  19900000
199100                 PS-ERROR TO TRUE                                 19910000
199200             MOVE DP015-RED             TO ADMDESCC               19920000
199300             MOVE DP015-REVERSE         TO ADMDESCH               19930000
199400             MOVE DP015-UNP-ALP-BRT-OFF TO ADMDESCA               19940000
199500             MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER       19950000
199600             SET DP020-MSG-FATAL TO TRUE                          19960000
199700             MOVE -1                    TO ADMDESCL               19970000
199800        ELSE                                                      19980000
199900**         CHECK THE DMA DESCRIPTION FIELD FOR UNDERSCORES        19990000
200000             MOVE ZERO TO PV-UNDERSCORE-COUNT                     20000000
200100             INSPECT ASC-DMA-DESC                                 20010000
200200                 TALLYING PV-UNDERSCORE-COUNT                     20020000
200300                 FOR ALL '_'                                      20030000
200400             IF PV-UNDERSCORE-COUNT > ZERO                        20040000
200500                 SET PS-NEED-DESCRIP                              20050000
200600                     PS-ERROR TO TRUE                             20060000
200700                 MOVE DP015-RED        TO ADMDESCC                20070000
200800                 MOVE DP015-REVERSE    TO ADMDESCH                20080000
200900                 MOVE DP015-UNP-ALP-BRT-OFF TO ADMDESCA           20090000
201000***            ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --    20100000
201100***               PLEASE REMOVE **                                20110000
201200                 MOVE PC-TSYMSG-01643  TO DP020-MSG-NUMBER        20120000
201300                 SET DP020-MSG-FATAL   TO TRUE                    20130000
201400                 MOVE -1               TO ADMDESCL                20140000
201500             END-IF                                               20150000
201600        END-IF                                                    20160000
201700     END-IF.                                                      20170000
201800                                                                  20180000
201900     IF (ASC-ADD-DPT)                                             20190000
202000        IF ASC-DPT-DESC = SPACES                                  20200000
202100                                                                  20210000
202200****         REQUIRED ENTRY                                       20220000
202300                                                                  20230000
202400             SET PS-NEED-DESCRIP                                  20240000
202500                 PS-ERROR TO TRUE                                 20250000
202600             MOVE DP015-RED             TO ADPDESCC               20260000
202700             MOVE DP015-REVERSE         TO ADPDESCH               20270000
202800             MOVE DP015-UNP-ALP-BRT-OFF TO ADPDESCA               20280000
202900             MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER       20290000
203000             SET DP020-MSG-FATAL TO TRUE                          20300000
203100             MOVE -1                    TO ADPDESCL               20310000
203200        ELSE                                                      20320000
203300**         CHECK THE DEPARTMENT DESCRIPTION FIELD FOR UNDERSCORES 20330000
203400             MOVE ZERO TO PV-UNDERSCORE-COUNT                     20340000
203500             INSPECT ASC-DPT-DESC                                 20350000
203600                 TALLYING PV-UNDERSCORE-COUNT                     20360000
203700                 FOR ALL '_'                                      20370000
203800             IF PV-UNDERSCORE-COUNT > ZERO                        20380000
203900                 SET PS-NEED-DESCRIP                              20390000
204000                     PS-ERROR TO TRUE                             20400000
204100                 MOVE DP015-RED        TO ADPDESCC                20410000
204200                 MOVE DP015-REVERSE    TO ADPDESCH                20420000
204300                 MOVE DP015-UNP-ALP-BRT-OFF TO ADPDESCA           20430000
204400***            ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --    20440000
204500***               PLEASE REMOVE **                                20450000
204600                 MOVE PC-TSYMSG-01643  TO DP020-MSG-NUMBER        20460000
204700                 SET DP020-MSG-FATAL   TO TRUE                    20470000
204800                 MOVE -1               TO ADPDESCL                20480000
204900             END-IF                                               20490000
205000        END-IF                                                    20500000
205100     END-IF.                                                      20510000
205200                                                                  20520000
205300     IF (ASC-ADD-MCL)                                             20530000
205400        IF ASC-MCL-DESC = SPACES                                  20540000
205500                                                                  20550000
205600****         REQUIRED ENTRY                                       20560000
205700                                                                  20570000
205800             SET PS-NEED-DESCRIP                                  20580000
205900                 PS-ERROR TO TRUE                                 20590000
206000             MOVE DP015-RED             TO AMCDESCC               20600000
206100             MOVE DP015-REVERSE         TO AMCDESCH               20610000
206200             MOVE DP015-UNP-ALP-BRT-OFF TO AMCDESCA               20620000
206300             MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER       20630000
206400             SET DP020-MSG-FATAL TO TRUE                          20640000
206500             MOVE -1                    TO AMCDESCL               20650000
206600        ELSE                                                      20660000
206700**         CHECK THE MCL DESCRIPTION FIELD FOR UNDERSCORES        20670000
206800             MOVE ZERO TO PV-UNDERSCORE-COUNT                     20680000
206900             INSPECT ASC-MCL-DESC                                 20690000
207000                 TALLYING PV-UNDERSCORE-COUNT                     20700000
207100                 FOR ALL '_'                                      20710000
207200             IF PV-UNDERSCORE-COUNT > ZERO                        20720000
207300                 SET PS-NEED-DESCRIP                              20730000
207400                     PS-ERROR TO TRUE                             20740000
207500                 MOVE DP015-RED        TO AMCDESCC                20750000
207600                 MOVE DP015-REVERSE    TO AMCDESCH                20760000
207700                 MOVE DP015-UNP-ALP-BRT-OFF TO AMCDESCA           20770000
207800***            ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --    20780000
207900***               PLEASE REMOVE **                                20790000
208000                 MOVE PC-TSYMSG-01643  TO DP020-MSG-NUMBER        20800000
208100                 SET DP020-MSG-FATAL   TO TRUE                    20810000
208200                 MOVE -1               TO AMCDESCL                20820000
208300             END-IF                                               20830000
208400        END-IF                                                    20840000
208500     END-IF.                                                      20850000
208600                                                                  20860000
208700     IF (ASC-ADD-SCL)                                             20870000
208800        IF ASC-SCL-DESC = SPACES                                  20880000
208900                                                                  20890000
209000****         REQUIRED ENTRY                                       20900000
209100                                                                  20910000
209200             SET PS-NEED-DESCRIP                                  20920000
209300                 PS-ERROR TO TRUE                                 20930000
209400             MOVE DP015-RED             TO ASCDESCC               20940000
209500             MOVE DP015-REVERSE         TO ASCDESCH               20950000
209600             MOVE DP015-UNP-ALP-BRT-OFF TO ASCDESCA               20960000
209700             MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER       20970000
209800             SET DP020-MSG-FATAL TO TRUE                          20980000
209900             MOVE -1                    TO ASCDESCL               20990000
210000        ELSE                                                      21000000
210100**         CHECK THE SCL DESCRIPTION FIELD FOR UNDERSCORES        21010000
210200             MOVE ZERO TO PV-UNDERSCORE-COUNT                     21020000
210300             INSPECT ASC-SCL-DESC                                 21030000
210400                 TALLYING PV-UNDERSCORE-COUNT                     21040000
210500                 FOR ALL '_'                                      21050000
210600             IF PV-UNDERSCORE-COUNT > ZERO                        21060000
210700                 SET PS-NEED-DESCRIP                              21070000
210800                     PS-ERROR TO TRUE                             21080000
210900                 MOVE DP015-RED        TO ASCDESCC                21090000
211000                 MOVE DP015-REVERSE    TO ASCDESCH                21100000
211100                 MOVE DP015-UNP-ALP-BRT-OFF TO ASCDESCA           21110000
211200***            ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --    21120000
211300***               PLEASE REMOVE **                                21130000
211400                 MOVE PC-TSYMSG-01643  TO DP020-MSG-NUMBER        21140000
211500                 SET DP020-MSG-FATAL   TO TRUE                    21150000
211600                 MOVE -1               TO ASCDESCL                21160000
211700             END-IF                                               21170000
211800        END-IF                                                    21180000
211900     END-IF.                                                      21190000
212000                                                                  21200000
212100 E500-EDIT-MDSEAR-ENTRY.                                          21210000
212200******************************************************************21220000
212300*                                                                 21230000
212400*                                                                 21240000
212500*                                                                 21250000
212600*                                                                 21260000
212700*                                                                 21270000
212800******************************************************************21280000
212900     IF PV-INDEX-CO-LEVEL                                         21290000
213000        PERFORM F309-PROCESS-COMPANY                              21300000
213100     ELSE                                                         21310000
213200        IF PV-INDEX-GMA-LEVEL                                     21320000
213300           PERFORM F310-PROCESS-GMA                               21330000
213400        ELSE                                                      21340000
213500           IF PV-INDEX-DMA-LEVEL                                  21350000
213600              PERFORM F320-PROCESS-DMA                            21360000
213700           ELSE                                                   21370000
213800              IF PV-INDEX-DPT-LEVEL                               21380000
213900                 PERFORM F330-PROCESS-DPT                         21390000
214000              ELSE                                                21400000
214100                 IF PV-INDEX-MCL-LEVEL                            21410000
214200                    PERFORM F340-PROCESS-MCL                      21420000
214300                 ELSE                                             21430000
214400                    PERFORM F350-PROCESS-SCL                      21440000
214500                 END-IF                                           21450000
214600               END-IF                                             21460000
214700            END-IF                                                21470000
214800        END-IF                                                    21480000
214900     END-IF.                                                      21490000
215000                                                                  21500000
215100                                                                  21510000
215200 E600-COMPARE-DATE-RANGES.                                        21520000
215300                                                                  21530000
215400******************************************************************21540000
215500* 1. ADD 365 DAYS TO CURRENT DATE                                 21550000
215600* 2. IF START OR END DATE GREATER THAN CURRENT DATE + 365 DAYS,   21560000
215700*    ERROR                                                        21570000
215800* 3. IF END DATE BEFORE START DATE, ERROR                         21580000
215900* 4. IF END-DATE GREATER THAN PARENT LEVEL END DATE, ERROR        21590000
216000* 5. IF START-DATE < CURRENT DATE, ERROR                          21600000
216100* 6. IF START-DATE < PARENT LEVEL START DATE, ERROR               21610000
216200******************************************************************21620000
216300                                                                  21630000
216310       INITIALIZE DPG51                                           21631000
216320                  DPG52                                           21632000
216330                  DPG53                                           21633000
216340                  DPG54                                           21634000
216350                  DPG55                                           21635000
216360                  DPG56.                                          21636000
216370       SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE                   21637000
216380       SET DPG51-INCREMENT-DATE         TO TRUE                   21638000
216390       MOVE PC-YEAR-DAYS                TO DPG51-INCR-DECR-DAYS-9 21639000
216391       SET DPG52-LK-DTE-ISO             TO TRUE                   21639100
216400       MOVE DP017-CURRENT-DATE-YYYYMMDD TO DPG52-DB2-ISO-DATE-N.  21640000
216800       CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51              21680000
216810                                               DPG52              21681000
216820                                               DPG53              21682000
216830                                               DPG54              21683000
216840                                               DPG55              21684000
216850                                               DPG56.             21685000
216900       IF DPG54-NO-ERROR                                          21690000
217000          MOVE DPG55-DB2-ISO-DATE TO PV-TMP-DATE                  21700000
217400       ELSE                                                       21740000
217500          SET DP013-LOGIC-ABEND TO TRUE                           21750000
217600          SET DP013-ROLLBACK    TO TRUE                           21760000
217700          MOVE 'E600-COMPARE-DATE-RANGES' TO DP013-PARAGRAPH      21770000
217800          MOVE 'INVALID DPKUT105 CALL' TO DP013-MESSAGE-TEXT(1)   21780000
217900          MOVE 'TRIED TO ADD 365 DAYS TO CURRENT DATE ' TO        21790000
218000                                          DP013-MESSAGE-TEXT(2)   21800000
218100          PERFORM DP013-0000-PROCESS-ABEND                        21810000
218200       END-IF.                                                    21820000
218300       IF ASC-SCRN-END-YYYYMMDD-N > ASC-SCRN-STRT-YYYYMMDD-N      21830000
218400          IF ASC-SCRN-END-YYYYMMDD-N > ASC-LEVEL-END-DTE          21840000
218500****            END DATE MUST NOT BE AFTER PARENT END DATE        21850000
218600               SET PS-ERROR TO TRUE                               21860000
218700               MOVE DP015-RED           TO AENDMMC                21870000
218800                                             AENDDDC              21880000
218900                                             AENDYYC              21890000
219000               MOVE DP015-REVERSE       TO AENDMMH                21900000
219100                                             AENDDDH              21910000
219200                                             AENDYYH              21920000
219300               MOVE DP015-UNP-ALP-BRT-OFF TO AENDMMA              21930000
219400                                             AENDDDA              21940000
219500                                             AENDYYA              21950000
219600               MOVE PC-TSYMSG-00145     TO DP020-MSG-NUMBER       21960000
219700               SET DP020-MSG-FATAL TO TRUE                        21970000
219800               MOVE -1                  TO AENDMML                21980000
219900           ELSE                                                   21990000
220000              IF (ASC-SCRN-END-YYYYMMDD-N > PV-TMP-DATE) AND      22000000
220100                 (ASC-SCRN-END-YYYYMMDD-N NOT =                   22010000
220200                           PC-INFINITY-DATE)                      22020000
220300                  SET PS-ERROR TO TRUE                            22030000
220400                  MOVE DP015-RED           TO AENDMMC             22040000
220500                                                AENDDDC           22050000
220600                                                AENDYYC           22060000
220700                  MOVE DP015-REVERSE       TO AENDMMH             22070000
220800                                                AENDDDH           22080000
220900                                                AENDYYH           22090000
221000                  MOVE DP015-UNP-ALP-BRT-OFF TO AENDMMA           22100000
221100                                                AENDDDA           22110000
221200                                                AENDYYA           22120000
221300                  MOVE PC-TSYMSG-00025     TO DP020-MSG-NUMBER    22130000
221400                  SET DP020-MSG-FATAL TO TRUE                     22140000
221500                  MOVE -1                  TO AENDMML             22150000
221600              ELSE                                                22160000
221700                 SET ASC-END-DT-PASS-EDIT TO TRUE                 22170000
221800              END-IF                                              22180000
221900           END-IF                                                 22190000
222000       ELSE                                                       22200000
222100****       END DATE MAY NOT BE PRIOR TO START DATE                22210000
222200           SET PS-ERROR TO TRUE                                   22220000
222300           MOVE DP015-RED           TO AENDMMC                    22230000
222400                                         AENDDDC                  22240000
222500                                         AENDYYC                  22250000
222600           MOVE DP015-REVERSE       TO AENDMMH                    22260000
222700                                         AENDDDH                  22270000
222800                                         AENDYYH                  22280000
222900           MOVE DP015-UNP-ALP-BRT-OFF TO AENDMMA                  22290000
223000                                         AENDDDA                  22300000
223100                                         AENDYYA                  22310000
223200           MOVE PC-TSYMSG-00143     TO DP020-MSG-NUMBER           22320000
223300           SET DP020-MSG-FATAL TO TRUE                            22330000
223400           MOVE -1                  TO AENDMML                    22340000
223500       END-IF.                                                    22350000
223600                                                                  22360000
223700       IF ASC-SCRN-STRT-YYYYMMDD-N > ASC-CURRENT-DATE             22370000
223800          IF ASC-SCRN-STRT-YYYYMMDD-N < ASC-LEVEL-STRT-DTE        22380000
223900                                                                  22390000
224000****        START DATE MUST NOT BE BEFORE PARENT START DATE       22400000
224100                                                                  22410000
224200               SET PS-ERROR TO TRUE                               22420000
224300               MOVE DP015-RED           TO ASTRTMMC               22430000
224400                                             ASTRTDDC             22440000
224500                                             ASTRTYYC             22450000
224600               MOVE DP015-REVERSE       TO ASTRTMMH               22460000
224700                                             ASTRTDDH             22470000
224800                                             ASTRTYYH             22480000
224900               MOVE DP015-UNP-ALP-BRT-OFF TO ASTRTMMA             22490000
225000                                             ASTRTDDA             22500000
225100                                             ASTRTYYA             22510000
225200               MOVE PC-TSYMSG-00144     TO DP020-MSG-NUMBER       22520000
225300               SET DP020-MSG-FATAL TO TRUE                        22530000
225400               MOVE -1                  TO ASTRTMML               22540000
225500          ELSE                                                    22550000
225600            IF (ASC-SCRN-STRT-YYYYMMDD-N > PV-TMP-DATE)           22560000
225700               SET PS-ERROR TO TRUE                               22570000
225800               MOVE DP015-RED           TO ASTRTMMC               22580000
225900                                             ASTRTDDC             22590000
226000                                             ASTRTYYC             22600000
226100               MOVE DP015-REVERSE       TO ASTRTMMH               22610000
226200                                             ASTRTDDH             22620000
226300                                             ASTRTYYH             22630000
226400               MOVE DP015-UNP-ALP-BRT-OFF TO ASTRTMMA             22640000
226500                                             ASTRTDDA             22650000
226600                                             ASTRTYYA             22660000
226700               MOVE PC-TSYMSG-00025     TO DP020-MSG-NUMBER       22670000
226800               SET DP020-MSG-FATAL TO TRUE                        22680000
226900               MOVE -1                  TO ASTRTMML               22690000
227000                                                                  22700000
227100            ELSE                                                  22710000
227200              SET ASC-START-DT-PASS-EDIT TO TRUE                  22720000
227300            END-IF                                                22730000
227400          END-IF                                                  22740000
227500       ELSE                                                       22750000
227600                                                                  22760000
227700****     START DATE MAY NOT BE PRIOR TO CURRENT DATE              22770000
227800                                                                  22780000
227900           SET PS-ERROR TO TRUE                                   22790000
228000           MOVE DP015-RED           TO ASTRTMMC                   22800000
228100                                         ASTRTDDC                 22810000
228200                                         ASTRTYYC                 22820000
228300           MOVE DP015-REVERSE       TO ASTRTMMH                   22830000
228400                                         ASTRTDDH                 22840000
228500                                         ASTRTYYH                 22850000
228600           MOVE DP015-UNP-ALP-BRT-OFF TO ASTRTMMA                 22860000
228700                                         ASTRTDDA                 22870000
228800                                         ASTRTYYA                 22880000
228900           MOVE PC-TSYMSG-00067     TO DP020-MSG-NUMBER           22890000
229000           SET DP020-MSG-FATAL TO TRUE                            22900000
229100           MOVE -1                  TO ASTRTMML                   22910000
229200                                                                  22920000
229300       END-IF.                                                    22930000
229400                                                                  22940000
229500 E700-VALIDATE-BUYER-NO.                                          22950000
229600                                                                  22960000
229700******************************************************************22970000
229800*                                                                 22980000
229900*                                                                 22990000
230000*                                                                 23000000
230100*                                                                 23010000
230200*                                                                 23020000
230300******************************************************************23030000
230400     IF ASC-SCRN-BYR-NBR = SPACES                                 23040000
230500         CONTINUE                                                 23050000
230600     ELSE                                                         23060000
230700         MOVE ASC-SCRN-BYR-NBR   TO DP010I-UNEDITED-FIELD         23070000
230800         MOVE +3                 TO DP010I-MAXIMUM-DIGITS         23080000
230900         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      23090000
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         23101008
262978              USING DP010I-NUMERIC-EDIT-AREA                      23102008
231100         IF  DP010I-ERROR-DETECTED                                23110000
231200             SET PS-ERROR TO TRUE                                 23120000
231300             MOVE DP015-RED             TO ABUYERC                23130000
231400             MOVE DP015-REVERSE         TO ABUYERH                23140000
231500             MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA                23150000
231600             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       23160000
231700             SET DP020-MSG-FATAL TO TRUE                          23170000
231800             MOVE -1                    TO ABUYERL                23180000
231900         ELSE                                                     23190000
232000             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-BYR-NBR-N     23200000
232100             MOVE ASC-SCRN-BYR-NBR      TO ABUYERO                23210000
232200             IF ASC-SCRN-BYR-NBR-N = 0                            23220000
232300                 SET PS-ERROR TO TRUE                             23230000
232400                 MOVE DP015-RED         TO ABUYERC                23240000
232500                 MOVE DP015-REVERSE     TO ABUYERH                23250000
232600                 MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA            23260000
232700                 MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER       23270000
232800                 SET DP020-MSG-FATAL    TO TRUE                   23280000
232900                 MOVE -1                TO ABUYERL                23290000
233000             END-IF                                               23300000
233100         END-IF                                                   23310000
233200     END-IF.                                                      23320000
233300                                                                  23330000
233400                                                                  23340000
233500 E725-FILL-IN-PARENT-DEFAULTS.                                    23350000
233600                                                                  23360000
233700******************************************************************23370000
233800*  FILL IN ALL BLANK FIELDS WITH THE VALUE OF THAT FIELD FROM     23380000
233900*  THE PARENT LEVEL MERCHANDISE AREA.                             23390000
234000*                                                                 23400000
234100*                                                                 23410000
234200*  PERFORMED BY : D500-EDIT-DATA-IN-COMMAREA                      23420000
234300******************************************************************23430000
234400     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       23440000
234500     MOVE DP017-EDITED-DATE-YYYYMMDD TO PK-END-DTE.               23450000
234600     MOVE DP017-CURRENT-DATE-YYYYMMDD TO ASC-CURRENT-DATE.        23460000
234700                                                                  23470000
234800     IF (ASC-ADD-MCL) OR                                          23480000
234900        (ASC-ADD-SCL)                                             23490000
235000        MOVE ASC-PARENT-LVL-BYR-NBR TO ASC-SCRN-BYR-NBR           23500000
235100     END-IF.                                                      23510000
235200                                                                  23520000
235300     IF ASC-SCRN-GEN-MDSETYP = SPACES                             23530000
235400          MOVE ASC-PARENT-LVL-MDSETYP TO ASC-SCRN-GEN-MDSETYP     23540000
235500     END-IF.                                                      23550000
235600                                                                  23560000
235700     IF ASC-SCRN-GEN-MDSETYP = SPACES                             23570000
235800        SET PS-ERROR         TO TRUE                              23580000
235900        SET DP020-MSG-FATAL  TO TRUE                              23590000
236000        MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                  23600000
236100        MOVE DP015-RED       TO AGENRLC                           23610000
236200        MOVE DP015-REVERSE   TO AGENRLH                           23620000
236300        MOVE -1              TO AGENRLL                           23630000
236400     END-IF.                                                      23640000
236500                                                                  23650000
236600     IF ASC-SCRN-END-DTE = SPACES                                 23660000
236700        MOVE ASC-LEVEL-END-DTE TO ASC-SCRN-END-YYYYMMDD-N         23670000
236800     END-IF.                                                      23680000
236900                                                                  23690000
237000     IF ASC-SCRN-STRT-DTE-X    = SPACES                           23700000
237100         IF ASC-LEVEL-STRT-DTE-N <= ASC-CURRENT-DATE              23710000
237110             INITIALIZE DPG51                                     23711000
237120                        DPG52                                     23712000
237130                        DPG53                                     23713000
237140                        DPG54                                     23714000
237150                        DPG55                                     23715000
237160                        DPG56                                     23716000
237170            SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE                23717000
237180            SET DPG51-INCREMENT-DATE TO TRUE                      23718000
237190            MOVE 1 TO DPG51-INCR-DECR-DAYS-9                      23719000
237191            SET DPG52-LK-DTE-ISO TO TRUE                          23719100
237192            MOVE ASC-CURRENT-DATE TO DPG52-DB2-ISO-DATE-N         23719200
237193            CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51         23719300
237194                                                    DPG52         23719400
237195                                                    DPG53         23719500
237196                                                    DPG54         23719600
237197                                                    DPG55         23719700
237198                                                    DPG56         23719800
237199            IF DPG54-NO-ERROR                                     23719900
237800                MOVE DPG55-DB2-ISO-DATE-N                         23780000
238400                                    TO ASC-SCRN-STRT-YYYYMMDD-N   23840000
238500            ELSE                                                  23850000
238600*               --  DATE NOT VALID --                             23860000
238700                SET PS-ERROR                                      23870000
238800                    PS-STRT-DATE-ERROR TO TRUE                    23880000
238900                MOVE DP015-RED                 TO ASTRTMMC        23890000
239000                                                  ASTRTDDC        23900000
239100                                                  ASTRTYYC        23910000
239200                MOVE DP015-REVERSE             TO ASTRTMMH        23920000
239300                                                  ASTRTDDH        23930000
239400                                                  ASTRTYYH        23940000
239500                MOVE DP015-UNP-ALP-BRT-OFF     TO ASTRTMMA        23950000
239600                                                  ASTRTDDA        23960000
239700                                                  ASTRTYYA        23970000
239800                MOVE PC-TSYMSG-00009           TO DP020-MSG-NUMBER23980000
239900                SET DP020-MSG-FATAL TO TRUE                       23990000
240000                MOVE -1                        TO ASTRTMML        24000000
240100            END-IF                                                24010000
240200        ELSE                                                      24020000
240300           MOVE ASC-LEVEL-STRT-DTE-X TO ASC-SCRN-STRT-YYYYMMDD    24030000
240400        END-IF                                                    24040000
240500     END-IF.                                                      24050000
240600                                                                  24060000
240700                                                                  24070000
240800                                                                  24080000
240900                                                                  24090000
241000 E800-RESET-SCREEN-ATTRB.                                         24100000
241100                                                                  24110000
241200******************************************************************24120000
241300*                                                                 24130000
241400*                                                                 24140000
241500*                                                                 24150000
241600*                                                                 24160000
241700*                                                                 24170000
241800******************************************************************24180000
241900     MOVE DP015-GREEN          TO ASTRTMMC                        24190000
242000                                  ASTRTDDC                        24200000
242100                                  ASTRTYYC                        24210000
242200                                  AENDMMC                         24220000
242300                                  AENDDDC                         24230000
242400                                  AENDYYC                         24240000
242500                                  AGENRLC.                        24250000
242600     MOVE DP015-UNDERLINE      TO ASTRTMMH                        24260000
242700                                  ASTRTDDH                        24270000
242800                                  ASTRTYYH                        24280000
242900                                  AENDMMH                         24290000
243000                                  AENDDDH                         24300000
243100                                  AENDYYH                         24310000
243200                                  AGENRLH.                        24320000
243300     MOVE DP015-UNP-ALP-NOR-OFF TO ASTRTMMA                       24330000
243400                                  ASTRTDDA                        24340000
243500                                  ASTRTYYA                        24350000
243600                                  AENDMMA                         24360000
243700                                  AENDDDA                         24370000
243800                                  AENDYYA                         24380000
243900                                  AGENRLA.                        24390000
244000     IF ASC-ADD-DPT                                               24400000
244100         MOVE DP015-GREEN           TO ABUYERC                    24410000
244200         MOVE DP015-WHITE           TO ABYRHDRC                   24420000
244300         MOVE DP015-UNDERLINE       TO ABUYERH                    24430000
244400         MOVE DP015-UNP-ALP-NOR-OFF TO ABUYERA                    24440000
244500         MOVE DP015-PRO-BRT-OFF     TO ABYRHDRA                   24450000
244600     ELSE                                                         24460000
244700         MOVE DP015-HL-OFF      TO ABUYERH                        24470000
244800                                   ABYRHDRH                       24480000
244900         MOVE DP015-PRO-DRK-OFF TO ABUYERA                        24490000
245000                                   ABYRHDRA                       24500000
245100     END-IF.                                                      24510000
245200                                                                  24520000
245300 F100-VALIDATE-END-DATE.                                          24530000
245400                                                                  24540000
245500******************************************************************24550000
245600*                                                                 24560000
245700*                                                                 24570000
245800*                                                                 24580000
245900*                                                                 24590000
246000*                                                                 24600000
246100******************************************************************24610000
246200                                                                  24620000
246210     INITIALIZE DPG51                                             24621000
246220                DPG52                                             24622000
246230                DPG53                                             24623000
246240                DPG54                                             24624000
246250                DPG55                                             24625000
246260                DPG56.                                            24626000
246270     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      24627000
246291     SET DPG52-LK-DTE-GREG TO TRUE.                               24629100
246292     MOVE ASC-SCRN-END-MM TO DPG52-GREG-DATE-MO.                  24629200
246293     MOVE ASC-SCRN-END-DD TO DPG52-GREG-DATE-DY.                  24629300
246294     MOVE ASC-SCRN-END-YY TO DPG52-GREG-DATE-YR.                  24629400
246295     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                24629500
246296                                             DPG52                24629600
246297                                             DPG53                24629700
246298                                             DPG54                24629800
246299                                             DPG55                24629900
246300                                             DPG56.               24630000
246910     IF DPG54-NO-ERROR                                            24691000
247000         MOVE DPG55-DB2-ISO-DATE TO ASC-SCRN-END-YYYYMMDD         24700000
247100     ELSE                                                         24710000
247200*        --  DATE NOT VALID --                                    24720000
247300         SET PS-ERROR                                             24730000
247400             PS-END-DATE-ERROR          TO TRUE                   24740000
247500         MOVE DP015-RED                 TO AENDMMC                24750000
247600                                           AENDDDC                24760000
247700                                           AENDYYC                24770000
247800         MOVE DP015-REVERSE             TO AENDMMH                24780000
247900                                           AENDDDH                24790000
248000                                           AENDYYH                24800000
248100         MOVE DP015-UNP-ALP-BRT-OFF     TO AENDMMA                24810000
248200                                           AENDDDA                24820000
248300                                           AENDYYA                24830000
248400         MOVE PC-TSYMSG-00009           TO DP020-MSG-NUMBER       24840000
248500         SET DP020-MSG-FATAL TO TRUE                              24850000
248600         MOVE -1                        TO AENDMML                24860000
248700     END-IF.                                                      24870000
248800     EJECT                                                        24880000
248900                                                                  24890000
249000 F200-VALIDATE-START-DATE.                                        24900000
249100                                                                  24910000
249200******************************************************************24920000
249300*                                                                 24930000
249400*                                                                 24940000
249500*                                                                 24950000
249600*                                                                 24960000
249700*                                                                 24970000
249800******************************************************************24980000
249900                                                                  24990000
249910     INITIALIZE DPG51                                             24991000
249920                DPG52                                             24992000
249930                DPG53                                             24993000
249940                DPG54                                             24994000
249950                DPG55                                             24995000
249960                DPG56.                                            24996000
249970     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      24997000
249980     SET DPG52-LK-DTE-GREG TO TRUE.                               24998000
249990     MOVE ASC-SCRN-STRT-MM TO DPG52-GREG-DATE-MO.                 24999000
249991     MOVE ASC-SCRN-STRT-DD TO DPG52-GREG-DATE-DY.                 24999100
249992     MOVE ASC-SCRN-STRT-YY TO DPG52-GREG-DATE-YR.                 24999200
249993     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                24999300
249994                                             DPG52                24999400
249995                                             DPG53                24999500
249996                                             DPG54                24999600
249997                                             DPG55                24999700
249998                                             DPG56.               24999800
249999     IF DPG54-NO-ERROR                                            24999900
250000         MOVE DPG55-DB2-ISO-DATE TO ASC-SCRN-STRT-YYYYMMDD        25000000
250800     ELSE                                                         25080000
250900*        --  DATE NOT VALID --                                    25090000
251000         SET PS-ERROR                                             25100000
251100             PS-STRT-DATE-ERROR TO TRUE                           25110000
251200         MOVE DP015-RED                 TO ASTRTMMC               25120000
251300                                           ASTRTDDC               25130000
251400                                           ASTRTYYC               25140000
251500         MOVE DP015-REVERSE             TO ASTRTMMH               25150000
251600                                           ASTRTDDH               25160000
251700                                           ASTRTYYH               25170000
251800         MOVE DP015-UNP-ALP-BRT-OFF     TO ASTRTMMA               25180000
251900                                           ASTRTDDA               25190000
252000                                           ASTRTYYA               25200000
252100         MOVE PC-TSYMSG-00009           TO DP020-MSG-NUMBER       25210000
252200         SET DP020-MSG-FATAL TO TRUE                              25220000
252300         MOVE -1                        TO ASTRTMML               25230000
252400     END-IF.                                                      25240000
252500     EJECT                                                        25250000
252600                                                                  25260000
252700 EJECT                                                            25270000
252800                                                                  25280000
252900 F250-EDIT-GMA-NUMBER.                                            25290000
253000******************************************************************25300000
253100*                                                                 25310000
253200*                                                                 25320000
253300*                                                                 25330000
253400*                                                                 25340000
253500*  PERFORMED BY : E075-VALIDATE-MERCH-AREA                        25350000
253600**************************************************************    25360000
253700     IF ASC-SCRN-GMA-NO = SPACES                                  25370000
253800        CONTINUE                                                  25380000
253900     ELSE                                                         25390000
254000        MOVE ASC-SCRN-GMA-NO TO DP010I-UNEDITED-FIELD             25400000
254100        MOVE +2              TO DP010I-MAXIMUM-DIGITS             25410000
254200        SET DP010I-NEGATIVE-ALLOWED TO TRUE                       25420000
262978        CALL DP010I-NUMERIC-EDIT-ROUTINE                          25431008
262978             USING DP010I-NUMERIC-EDIT-AREA                       25432008
254400        IF  DP010I-ERROR-DETECTED                                 25440000
254500            MOVE DP015-RED                 TO AGMAC               25450000
254600            MOVE DP015-REVERSE             TO AGMAH               25460000
254700            MOVE DP015-UNP-ALP-BRT-OFF     TO AGMAA               25470000
254800            MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER    25480000
254900            SET DP020-MSG-FATAL            TO TRUE                25490000
255000            MOVE -1                        TO AGMAL               25500000
255100         ELSE                                                     25510000
255200            MOVE DP010I-NUMERIC-FIELD      TO ASC-SCRN-GMA-NO-N   25520000
255300            IF ASC-SCRN-GMA-NO = '00'                             25530000
255400                MOVE DP015-RED             TO AGMAC               25540000
255500                MOVE DP015-REVERSE         TO AGMAH               25550000
255600                MOVE DP015-UNP-ALP-BRT-OFF TO AGMAA               25560000
255700                MOVE PC-TSYMSG-00010       TO DP020-MSG-NUMBER    25570000
255800                SET DP020-MSG-FATAL        TO TRUE                25580000
255900                MOVE -1                    TO AGMAL               25590000
256000            ELSE                                                  25600000
256100               SET PS-GMA-PASS-EDIT        TO TRUE                25610000
256200            END-IF                                                25620000
256300         END-IF                                                   25630000
256400     END-IF.                                                      25640000
256500     IF ASC-SCRN-GMA-NO = SPACES                                  25650000
256600         MOVE DP015-RED                    TO AGMAC               25660000
256700         MOVE DP015-REVERSE                TO AGMAH               25670000
256800         MOVE DP015-UNP-ALP-BRT-OFF        TO AGMAA               25680000
256900         MOVE PC-TSYMSG-00007              TO DP020-MSG-NUMBER    25690000
257000         SET DP020-MSG-FATAL               TO TRUE                25700000
257100         MOVE -1                           TO AGMAL               25710000
257200     END-IF.                                                      25720000
257300     EJECT                                                        25730000
257400                                                                  25740000
257500                                                                  25750000
257600 F251-EDIT-DMA-NUMBER.                                            25760000
257700******************************************************************25770000
257800*                                                                 25780000
257900*                                                                 25790000
258000*                                                                 25800000
258100*                                                                 25810000
258200*  PERFORMED BY : E075-VALIDATE-MERCH-AREA                        25820000
258300**************************************************************    25830000
258400     IF ASC-SCRN-DMA-NO = SPACES                                  25840000
258500        CONTINUE                                                  25850000
258600     ELSE                                                         25860000
258700        MOVE ASC-SCRN-DMA-NO TO DP010I-UNEDITED-FIELD             25870000
258800         MOVE +2                 TO DP010I-MAXIMUM-DIGITS         25880000
258900        SET DP010I-NEGATIVE-ALLOWED TO TRUE                       25890000
262978        CALL DP010I-NUMERIC-EDIT-ROUTINE                          25901008
262978             USING DP010I-NUMERIC-EDIT-AREA                       25902008
259100        IF  DP010I-ERROR-DETECTED                                 25910000
259200            MOVE DP015-RED                 TO ADMAC               25920000
259300            MOVE DP015-REVERSE             TO ADMAH               25930000
259400            MOVE DP015-UNP-ALP-BRT-OFF     TO ADMAA               25940000
259500            MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER    25950000
259600            SET DP020-MSG-FATAL            TO TRUE                25960000
259700            MOVE -1                        TO ADMAL               25970000
259800         ELSE                                                     25980000
259900             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-DMA-NO-N      25990000
260000             IF ASC-SCRN-DMA-NO   = '00'                          26000000
260100                 MOVE DP015-RED            TO ADMAC               26010000
260200                 MOVE DP015-REVERSE        TO ADMAH               26020000
260300                 MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA              26030000
260400                 MOVE PC-TSYMSG-00010       TO DP020-MSG-NUMBER   26040000
260500                 SET DP020-MSG-FATAL       TO TRUE                26050000
260600                 MOVE -1                   TO ADMAL               26060000
260700             ELSE                                                 26070000
260800                SET PS-DMA-PASS-EDIT           TO TRUE            26080000
260900             END-IF                                               26090000
261000         END-IF                                                   26100000
261100     END-IF.                                                      26110000
261200                                                                  26120000
261300     IF ASC-SCRN-DMA-NO   = SPACES                                26130000
261400         MOVE DP015-RED                 TO ADMAC                  26140000
261500         MOVE DP015-REVERSE             TO ADMAH                  26150000
261600         MOVE DP015-UNP-ALP-BRT-OFF     TO ADMAA                  26160000
261700         MOVE PC-TSYMSG-00007       TO DP020-MSG-NUMBER           26170000
261800         SET DP020-MSG-FATAL            TO TRUE                   26180000
261900         MOVE -1                        TO ADMAL                  26190000
262000     END-IF.                                                      26200000
262100     EJECT                                                        26210000
262200                                                                  26220000
262300 F252-EDIT-DPT-NUMBER.                                            26230000
262400******************************************************************26240000
262500*                                                                 26250000
262600*                                                                 26260000
262700*                                                                 26270000
262800*                                                                 26280000
262900*  PERFORMED BY : E075-VALIDATE-MERCH-AREA                        26290000
263000**************************************************************    26300000
263100     IF ASC-SCRN-DPT-NO = SPACES                                  26310000
263200        CONTINUE                                                  26320000
263300     ELSE                                                         26330000
263400        MOVE ASC-SCRN-DPT-NO TO DP010I-UNEDITED-FIELD             26340000
263500        MOVE +3                 TO DP010I-MAXIMUM-DIGITS          26350000
263600        SET DP010I-NEGATIVE-ALLOWED TO TRUE                       26360000
262978        CALL DP010I-NUMERIC-EDIT-ROUTINE                          26371008
262978             USING DP010I-NUMERIC-EDIT-AREA                       26372008
263800        IF  DP010I-ERROR-DETECTED                                 26380000
263900            MOVE DP015-RED                 TO ADEPTC              26390000
264000            MOVE DP015-REVERSE             TO ADEPTH              26400000
264100            MOVE DP015-UNP-ALP-BRT-OFF     TO ADEPTA              26410000
264200            MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER    26420000
264300            SET DP020-MSG-FATAL            TO TRUE                26430000
264400            MOVE -1                        TO ADEPTL              26440000
264500         ELSE                                                     26450000
264600             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-DPT-NO-N      26460000
264700             IF ASC-SCRN-DPT-NO   = '000'                         26470000
264800                 MOVE DP015-RED                 TO ADEPTC         26480000
264900                 MOVE DP015-REVERSE             TO ADEPTH         26490000
265000                 MOVE DP015-UNP-ALP-BRT-OFF     TO ADEPTA         26500000
265100                 MOVE PC-TSYMSG-00010        TO DP020-MSG-NUMBER  26510000
265200                 SET DP020-MSG-FATAL TO TRUE                      26520000
265300                 MOVE -1                        TO ADEPTL         26530000
265400             ELSE                                                 26540000
265500                SET PS-DPT-PASS-EDIT           TO TRUE            26550000
265600             END-IF                                               26560000
265700         END-IF                                                   26570000
265800     END-IF.                                                      26580000
265900     IF ASC-SCRN-DPT-NO   = SPACES                                26590000
266000         MOVE DP015-RED                 TO ADEPTC                 26600000
266100         MOVE DP015-REVERSE             TO ADEPTH                 26610000
266200         MOVE DP015-UNP-ALP-BRT-OFF     TO ADEPTA                 26620000
266300         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          26630000
266400         SET DP020-MSG-FATAL TO TRUE                              26640000
266500         MOVE -1                        TO ADEPTL                 26650000
266600     END-IF.                                                      26660000
266700     EJECT                                                        26670000
266800                                                                  26680000
266900                                                                  26690000
267000 F253-EDIT-MCL-NUMBER.                                            26700000
267100******************************************************************26710000
267200*                                                                 26720000
267300*                                                                 26730000
267400*                                                                 26740000
267500*                                                                 26750000
267600*  PERFORMED BY : E075-VALIDATE-MERCH-AREA                        26760000
267700**************************************************************    26770000
267800     IF ASC-SCRN-MCL-NO = SPACES                                  26780000
267900        CONTINUE                                                  26790000
268000     ELSE                                                         26800000
268100        MOVE ASC-SCRN-MCL-NO TO DP010I-UNEDITED-FIELD             26810000
268200        MOVE +2                 TO DP010I-MAXIMUM-DIGITS          26820000
268300        SET DP010I-NEGATIVE-ALLOWED TO TRUE                       26830000
262978        CALL DP010I-NUMERIC-EDIT-ROUTINE                          26841008
262978             USING DP010I-NUMERIC-EDIT-AREA                       26842008
268500        IF  DP010I-ERROR-DETECTED                                 26850000
268600            MOVE DP015-RED                 TO AMCLASSC            26860000
268700            MOVE DP015-REVERSE             TO AMCLASSH            26870000
268800            MOVE DP015-UNP-ALP-BRT-OFF     TO AMCLASSA            26880000
268900            MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER    26890000
269000            SET DP020-MSG-FATAL            TO TRUE                26900000
269100            MOVE -1                        TO AMCLASSL            26910000
269200         ELSE                                                     26920000
269300             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-MCL-NO-N      26930000
269400             IF ASC-SCRN-MCL-NO   = '00'                          26940000
269500                 MOVE DP015-RED                 TO AMCLASSC       26950000
269600                 MOVE DP015-REVERSE             TO AMCLASSH       26960000
269700                 MOVE DP015-UNP-ALP-BRT-OFF     TO AMCLASSA       26970000
269800                 MOVE PC-TSYMSG-00010         TO DP020-MSG-NUMBER 26980000
269900                 SET DP020-MSG-FATAL            TO TRUE           26990000
270000                 MOVE -1                        TO AMCLASSL       27000000
270100             ELSE                                                 27010000
270200                SET PS-MCL-PASS-EDIT           TO TRUE            27020000
270300             END-IF                                               27030000
270400         END-IF                                                   27040000
270500     END-IF.                                                      27050000
270600     IF ASC-SCRN-MCL-NO   = SPACES                                27060000
270700         MOVE DP015-RED                 TO AMCLASSC               27070000
270800         MOVE DP015-REVERSE             TO AMCLASSH               27080000
270900         MOVE DP015-UNP-ALP-BRT-OFF     TO AMCLASSA               27090000
271000         MOVE PC-TSYMSG-00007         TO DP020-MSG-NUMBER         27100000
271100         SET DP020-MSG-FATAL            TO TRUE                   27110000
271200         MOVE -1                        TO AMCLASSL               27120000
271300     END-IF.                                                      27130000
271400     EJECT                                                        27140000
271500                                                                  27150000
271600                                                                  27160000
271700 F254-EDIT-SCL-NUMBER.                                            27170000
271800******************************************************************27180000
271900*                                                                 27190000
272000*                                                                 27200000
272100*                                                                 27210000
272200*                                                                 27220000
272300*  PERFORMED BY : E075-VALIDATE-MERCH-AREA                        27230000
272400**************************************************************    27240000
272500     IF ASC-SCRN-SCL-NO = SPACES                                  27250000
272600        CONTINUE                                                  27260000
272700     ELSE                                                         27270000
272800        MOVE ASC-SCRN-SCL-NO TO DP010I-UNEDITED-FIELD             27280000
272900        MOVE +3                 TO DP010I-MAXIMUM-DIGITS          27290000
273000        SET DP010I-NEGATIVE-ALLOWED TO TRUE                       27300000
262978        CALL DP010I-NUMERIC-EDIT-ROUTINE                          27311008
262978             USING DP010I-NUMERIC-EDIT-AREA                       27312008
273200        IF  DP010I-ERROR-DETECTED                                 27320000
273300            MOVE DP015-RED                 TO ASCLASSC            27330000
273400            MOVE DP015-REVERSE             TO ASCLASSH            27340000
273500            MOVE DP015-UNP-ALP-BRT-OFF     TO ASCLASSA            27350000
273600            MOVE PC-TSYMSG-00008           TO DP020-MSG-NUMBER    27360000
273700            SET DP020-MSG-FATAL            TO TRUE                27370000
273800            MOVE -1                        TO ASCLASSL            27380000
273900         ELSE                                                     27390000
274000             MOVE DP010I-NUMERIC-FIELD  TO ASC-SCRN-SCL-NO-N      27400000
274100             IF ASC-SCRN-SCL-NO   = '00'                          27410000
274200                 MOVE DP015-RED                 TO ASCLASSC       27420000
274300                 MOVE DP015-REVERSE             TO ASCLASSH       27430000
274400                 MOVE DP015-UNP-ALP-BRT-OFF     TO ASCLASSA       27440000
274500                 MOVE PC-TSYMSG-00010        TO DP020-MSG-NUMBER  27450000
274600                 SET DP020-MSG-FATAL            TO TRUE           27460000
274700                 MOVE -1                        TO ASCLASSL       27470000
274800             ELSE                                                 27480000
274900                SET PS-SCL-PASS-EDIT           TO TRUE            27490000
275000             END-IF                                               27500000
275100         END-IF                                                   27510000
275200     END-IF.                                                      27520000
275300     IF ASC-SCRN-SCL-NO   = SPACES                                27530000
275400         MOVE DP015-RED                 TO ASCLASSC               27540000
275500         MOVE DP015-REVERSE             TO ASCLASSH               27550000
275600         MOVE DP015-UNP-ALP-BRT-OFF     TO ASCLASSA               27560000
275700         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          27570000
275800         SET DP020-MSG-FATAL            TO TRUE                   27580000
275900         MOVE -1                        TO ASCLASSL               27590000
276000     END-IF.                                                      27600000
276100     EJECT                                                        27610000
276200                                                                  27620000
276300                                                                  27630000
276400 F800-TEST-MCL-DIGITS.                                            27640000
276500                                                                  27650000
276600******************************************************************27660000
276700*                                                                 27670000
276800*                                                                 27680000
276900******************************************************************27690000
277000     IF ASC-ADD-MCL                                               27700000
277100        IF ASC-MCL-DIGIT-2 NOT = 0                                27710000
277200            MOVE DP015-RED             TO AMCLASSC                27720000
277300            MOVE DP015-REVERSE         TO AMCLASSH                27730000
277400            MOVE DP015-UNP-ALP-BRT-OFF TO AMCLASSA                27740000
277500            MOVE PC-TSYMSG-00183       TO DP020-MSG-NUMBER        27750000
277600            SET DP020-MSG-FATAL                                   27760000
277700                PS-ERROR                                          27770000
277800                PS-DATA-ERROR   TO TRUE                           27780000
277900            MOVE -1                    TO AMCLASSL                27790000
278000        END-IF                                                    27800000
278100     ELSE                                                         27810000
278200       IF ASC-ADD-SCL                                             27820000
278300          IF ASC-SCL-DIGIT-1 NOT = 0                              27830000
278400             MOVE DP015-RED             TO ASCLASSC               27840000
278500             MOVE DP015-REVERSE         TO ASCLASSH               27850000
278600             MOVE DP015-UNP-ALP-BRT-OFF TO ASCLASSA               27860000
278700             MOVE PC-TSYMSG-00184       TO DP020-MSG-NUMBER       27870000
278800             SET DP020-MSG-FATAL                                  27880000
278900                 PS-ERROR                                         27890000
279000                 PS-DATA-ERROR   TO TRUE                          27900000
279100             MOVE -1                    TO ASCLASSL               27910000
279200          ELSE                                                    27920000
279300            IF ASC-SCL-DIGIT-2 NOT = ASC-MCL-DIGIT-1              27930000
279400                MOVE DP015-RED             TO ASCLASSC            27940000
279500                MOVE DP015-REVERSE         TO ASCLASSH            27950000
279600                MOVE DP015-UNP-ALP-BRT-OFF TO ASCLASSA            27960000
279700                MOVE PC-TSYMSG-00185       TO DP020-MSG-NUMBER    27970000
279800                SET DP020-MSG-FATAL                               27980000
279900                    PS-ERROR                                      27990000
280000                    PS-DATA-ERROR   TO TRUE                       28000000
280100                MOVE -1                    TO ASCLASSL            28010000
280200            END-IF                                                28020000
280300          END-IF                                                  28030000
280400       END-IF                                                     28040000
280500     END-IF.                                                      28050000
280600                                                                  28060000
280700     EJECT                                                        28070000
280800                                                                  28080000
280900 F309-PROCESS-COMPANY.                                            28090000
281000******************************************************************28100000
281100*                                                                 28110000
281200*                                                                 28120000
281300* PERFORMED BY: E500-EDIT-MDSEAR-ENTRY                            28130000
281400******************************************************************28140000
281500                                                                  28150000
281600      MOVE PC-COMPANY-NUMBER   TO PK-OPERCO-NBR                   28160000
281700      MOVE '000'               TO PK-GMA-NBR                      28170000
281800                                  PK-DMA-NBR PK-DEPT-NBR          28180000
281900                                  PK-MAJ-CL-NBR                   28190000
282000                                  PK-SUB-CL-NBR                   28200000
282100      MOVE 'CO '               TO PK-MDSELV-CDE                   28210000
282200                                                                  28220000
282300      PERFORM Z108-OPEN-GMA-CURSOR.                               28230000
282400      PERFORM Z110-GET-MERCH-AREA-GMA.                            28240000
282500      PERFORM Z109-CLOSE-GMA-CURSOR.                              28250000
282600                                                                  28260000
282700                                                                  28270000
282800 F310-PROCESS-GMA.                                                28280000
282900******************************************************************28290000
283000*                                                                 28300000
283100*                                                                 28310000
283200* PERFORMED BY: E500-EDIT-MDSEAR-ENTRY                            28320000
283300******************************************************************28330000
283400                                                                  28340000
283500      MOVE PC-COMPANY-NUMBER   TO PK-OPERCO-NBR.                  28350000
283600      MOVE ASC-SCRN-GMA-NO     TO PK-GMA-NBR.                     28360000
283700      MOVE '000'               TO PK-DMA-NBR PK-DEPT-NBR          28370000
283800                                  PK-MAJ-CL-NBR                   28380000
283900                                  PK-SUB-CL-NBR                   28390000
284000      MOVE 'GMA'               TO PK-MDSELV-CDE.                  28400000
284100                                                                  28410000
284200      PERFORM Z108-OPEN-GMA-CURSOR.                               28420000
284300      PERFORM Z110-GET-MERCH-AREA-GMA.                            28430000
284400                                                                  28440000
284500      IF PS-NEED-ROW                                              28450000
284600         IF PS-NO-ROW-FOUND                                       28460000
284700            SET PS-ERROR TO TRUE                                  28470000
284800            SET PS-DATA-ERROR TO TRUE                             28480000
284900            MOVE DP015-RED             TO AGMAC                   28490000
285000            MOVE DP015-REVERSE         TO AGMAH                   28500000
285100            MOVE DP015-UNP-ALP-BRT-OFF TO AGMAA                   28510000
285200            MOVE PC-TSYMSG-00030       TO DP020-MSG-NUMBER        28520000
285300            SET DP020-MSG-FATAL        TO TRUE                    28530000
285400            MOVE -1                    TO AGMAL                   28540000
285500         END-IF                                                   28550000
285600      ELSE                                                        28560000
285700         IF PS-NO-ROW-FOUND                                       28570000
285800              CONTINUE                                            28580000
285900         ELSE                                                     28590000
286000            SET PS-DATA-ERROR TO TRUE                             28600000
286100            SET PS-ERROR TO TRUE                                  28610000
286200            MOVE DP015-RED             TO AGMAC                   28620000
286300            MOVE DP015-REVERSE         TO AGMAH                   28630000
286400            MOVE DP015-UNP-ALP-BRT-OFF TO AGMAA                   28640000
286500            MOVE PC-TSYMSG-00138       TO DP020-MSG-NUMBER        28650000
286600            SET DP020-MSG-FATAL        TO TRUE                    28660000
286700            MOVE -1                    TO AGMAL                   28670000
286800         END-IF                                                   28680000
286900      END-IF.                                                     28690000
287000      PERFORM Z109-CLOSE-GMA-CURSOR.                              28700000
287100                                                                  28710000
287200 F320-PROCESS-DMA.                                                28720000
287300******************************************************************28730000
287400*                                                                 28740000
287500*                                                                 28750000
287600* PERFORMED BY: E500-EDIT-MDSEAR-ENTRY                            28760000
287700******************************************************************28770000
287800                                                                  28780000
287900                                                                  28790000
288000     MOVE PC-COMPANY-NUMBER  TO PK-OPERCO-NBR.                    28800000
288100     MOVE SPACES              TO PK-GMA-NBR.                      28810000
288200     MOVE ASC-SCRN-DMA-NO     TO PK-DMA-NBR.                      28820000
288300     MOVE '000'               TO PK-DEPT-NBR                      28830000
288400                                 PK-MAJ-CL-NBR                    28840000
288500                                 PK-SUB-CL-NBR.                   28850000
288600     MOVE 'DMA'               TO PK-MDSELV-CDE.                   28860000
288700                                                                  28870000
288800      PERFORM Z118-OPEN-DMA-CURSOR.                               28880000
288900      PERFORM Z120-GET-MERCH-AREA-DMA.                            28890000
289000                                                                  28900000
289100                                                                  28910000
289200      IF PS-NEED-ROW                                              28920000
289300         IF PS-NO-ROW-FOUND                                       28930000
289400            SET PS-ERROR TO TRUE                                  28940000
289500            SET PS-DATA-ERROR TO TRUE                             28950000
289600            MOVE DP015-RED             TO ADMAC                   28960000
289700            MOVE DP015-REVERSE         TO ADMAH                   28970000
289800            MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA                   28980000
289900            MOVE PC-TSYMSG-00031       TO DP020-MSG-NUMBER        28990000
290000            SET DP020-MSG-FATAL        TO TRUE                    29000000
290100            MOVE -1                    TO ADMAL                   29010000
290200         ELSE                                                     29020000
290300             IF MDSEAR-GMA-NBR NOT = ASC-SCRN-GMA-NO              29030000
290400                SET PS-ERROR TO TRUE                              29040000
290500                SET PS-DATA-ERROR TO TRUE                         29050000
290600                MOVE DP015-RED             TO ADMAC               29060000
290700                MOVE DP015-REVERSE         TO ADMAH               29070000
290800                MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA               29080000
290900                MOVE PC-TSYMSG-00076       TO DP020-MSG-NUMBER    29090000
291000                SET DP020-MSG-FATAL        TO TRUE                29100000
291100                MOVE -1                    TO ADMAL               29110000
291200             END-IF                                               29120000
291300         END-IF                                                   29130000
291400      ELSE                                                        29140000
291500         IF PS-NO-ROW-FOUND                                       29150000
291600              CONTINUE                                            29160000
291700         ELSE                                                     29170000
291800            SET PS-ERROR TO TRUE                                  29180000
291900            SET PS-DATA-ERROR TO TRUE                             29190000
292000            MOVE DP015-RED             TO ADMAC                   29200000
292100            MOVE DP015-REVERSE         TO ADMAH                   29210000
292200            MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA                   29220000
292300            MOVE PC-TSYMSG-00138       TO DP020-MSG-NUMBER        29230000
292400            SET DP020-MSG-FATAL        TO TRUE                    29240000
292500            MOVE -1                    TO ADMAL                   29250000
292600         END-IF                                                   29260000
292700      END-IF.                                                     29270000
292800                                                                  29280000
292900      PERFORM Z119-CLOSE-DMA-CURSOR.                              29290000
293000                                                                  29300000
293100                                                                  29310000
293200      EJECT                                                       29320000
293300                                                                  29330000
293400                                                                  29340000
293500                                                                  29350000
293600 F330-PROCESS-DPT.                                                29360000
293700******************************************************************29370000
293800*                                                                 29380000
293900*                                                                 29390000
294000* PERFORMED BY: E500-EDIT-MDSEAR-ENTRY                            29400000
294100******************************************************************29410000
294200                                                                  29420000
294300                                                                  29430000
294400      MOVE PC-COMPANY-NUMBER   TO PK-OPERCO-NBR                   29440000
294500      MOVE SPACES              TO PK-GMA-NBR                      29450000
294600                                  PK-DMA-NBR.                     29460000
294700      MOVE ASC-SCRN-DPT-NO     TO PK-DEPT-NBR.                    29470000
294800      MOVE '000'               TO PK-MAJ-CL-NBR                   29480000
294900                                  PK-SUB-CL-NBR.                  29490000
295000      MOVE 'DPT'               TO PK-MDSELV-CDE.                  29500000
295100                                                                  29510000
295200      PERFORM Z128-OPEN-DEPT-CURSOR.                              29520000
295300      PERFORM Z130-GET-MERCH-AREA-DPT.                            29530000
295400                                                                  29540000
295500                                                                  29550000
295600      IF PS-NEED-ROW                                              29560000
295700         IF PS-NO-ROW-FOUND                                       29570000
295800            SET PS-ERROR TO TRUE                                  29580000
295900            SET PS-DATA-ERROR TO TRUE                             29590000
296000            MOVE DP015-RED             TO ADEPTC                  29600000
296100            MOVE DP015-REVERSE         TO ADEPTH                  29610000
296200            MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA                  29620000
296300            MOVE PC-TSYMSG-00032       TO DP020-MSG-NUMBER        29630000
296400            SET DP020-MSG-FATAL        TO TRUE                    29640000
296500            MOVE -1                    TO ADEPTL                  29650000
296600         ELSE                                                     29660000
296700             IF MDSEAR-DMA-NBR NOT = ASC-SCRN-DMA-NO              29670000
296800                SET PS-ERROR TO TRUE                              29680000
296900                SET PS-DATA-ERROR TO TRUE                         29690000
297000                MOVE DP015-RED             TO ADEPTC              29700000
297100                MOVE DP015-REVERSE         TO ADEPTH              29710000
297200                MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA              29720000
297300                MOVE PC-TSYMSG-00077       TO DP020-MSG-NUMBER    29730000
297400                SET DP020-MSG-FATAL        TO TRUE                29740000
297500                MOVE -1                    TO ADEPTL              29750000
297600             ELSE                                                 29760000
297700                 IF MDSEAR-GMA-NBR NOT = ASC-SCRN-GMA-NO          29770000
297800                    SET PS-ERROR TO TRUE                          29780000
297900                    SET PS-DATA-ERROR TO TRUE                     29790000
298000                    MOVE DP015-RED             TO ADMAC           29800000
298100                    MOVE DP015-REVERSE         TO ADMAH           29810000
298200                    MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA           29820000
298300                    MOVE PC-TSYMSG-00076       TO DP020-MSG-NUMBER29830000
298400                    SET DP020-MSG-FATAL        TO TRUE            29840000
298500                    MOVE -1                    TO ADMAL           29850000
298600                 END-IF                                           29860000
298700             END-IF                                               29870000
298800         END-IF                                                   29880000
298900      ELSE                                                        29890000
299000         IF PS-NO-ROW-FOUND                                       29900000
299100              CONTINUE                                            29910000
299200         ELSE                                                     29920000
299300            SET PS-ERROR TO TRUE                                  29930000
299400            SET PS-DATA-ERROR TO TRUE                             29940000
299500            MOVE DP015-RED             TO ADEPTC                  29950000
299600            MOVE DP015-REVERSE         TO ADEPTH                  29960000
299700            MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA                  29970000
299800            MOVE PC-TSYMSG-00138       TO DP020-MSG-NUMBER        29980000
299900            SET DP020-MSG-FATAL        TO TRUE                    29990000
300000            MOVE -1                    TO ADEPTL                  30000000
300100         END-IF                                                   30010000
300200      END-IF.                                                     30020000
300300      PERFORM Z129-CLOSE-DEPT-CURSOR.                             30030000
300400                                                                  30040000
300500 F340-PROCESS-MCL.                                                30050000
300600******************************************************************30060000
300700*                                                                 30070000
300800*                                                                 30080000
300900* PERFORMED BY: E500-EDIT-MDSEAR-ENTRY                            30090000
301000******************************************************************30100000
301100                                                                  30110000
301200                                                                  30120000
301300      MOVE PC-COMPANY-NUMBER TO PK-OPERCO-NBR.                    30130000
301400      MOVE SPACES              TO PK-GMA-NBR                      30140000
301500                                  PK-DMA-NBR.                     30150000
301600      MOVE ASC-SCRN-DPT-NO     TO PK-DEPT-NBR.                    30160000
301700      MOVE ASC-SCRN-MCL-NO     TO PK-MAJ-CL-NBR.                  30170000
301800      MOVE '000'               TO PK-SUB-CL-NBR.                  30180000
301900      MOVE 'MCL'               TO PK-MDSELV-CDE.                  30190000
302000                                                                  30200000
302100      PERFORM Z138-OPEN-CLASS-CURSOR                              30210000
302200      PERFORM Z140-GET-MERCH-AREA-MCL                             30220000
302300                                                                  30230000
302400                                                                  30240000
302500      IF PS-NEED-ROW                                              30250000
302600         IF PS-NO-ROW-FOUND                                       30260000
302700            SET PS-ERROR TO TRUE                                  30270000
302800            SET PS-DATA-ERROR TO TRUE                             30280000
302900            MOVE DP015-RED             TO AMCLASSC                30290000
303000            MOVE DP015-REVERSE         TO AMCLASSH                30300000
303100            MOVE DP015-UNP-ALP-BRT-OFF TO AMCLASSA                30310000
303200            MOVE PC-TSYMSG-00078       TO DP020-MSG-NUMBER        30320000
303300            SET DP020-MSG-FATAL        TO TRUE                    30330000
303400            MOVE -1                    TO AMCLASSL                30340000
303500         ELSE                                                     30350000
303600            IF MDSEAR-DMA-NBR  NOT = ASC-SCRN-DMA-NO              30360000
303700                SET PS-ERROR TO TRUE                              30370000
303800                SET PS-DATA-ERROR TO TRUE                         30380000
303900                MOVE DP015-RED             TO ADEPTC              30390000
304000                MOVE DP015-REVERSE         TO ADEPTH              30400000
304100                MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA              30410000
304200                MOVE PC-TSYMSG-00077       TO DP020-MSG-NUMBER    30420000
304300                SET DP020-MSG-FATAL        TO TRUE                30430000
304400                MOVE -1                    TO ADEPTL              30440000
304500            ELSE                                                  30450000
304600                IF MDSEAR-GMA-NBR  NOT = ASC-SCRN-GMA-NO          30460000
304700                    SET PS-ERROR TO TRUE                          30470000
304800                    SET PS-DATA-ERROR TO TRUE                     30480000
304900                    MOVE DP015-RED             TO ADMAC           30490000
305000                    MOVE DP015-REVERSE         TO ADMAH           30500000
305100                    MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA           30510000
305200                    MOVE PC-TSYMSG-00076       TO DP020-MSG-NUMBER30520000
305300                    SET DP020-MSG-FATAL        TO TRUE            30530000
305400                    MOVE -1                    TO ADMAL           30540000
305500                END-IF                                            30550000
305600            END-IF                                                30560000
305700         END-IF                                                   30570000
305800      ELSE                                                        30580000
305900         IF PS-NO-ROW-FOUND                                       30590000
306000              CONTINUE                                            30600000
306100         ELSE                                                     30610000
306200            SET PS-ERROR TO TRUE                                  30620000
306300            SET PS-DATA-ERROR TO TRUE                             30630000
306400            MOVE DP015-RED             TO AMCLASSC                30640000
306500            MOVE DP015-REVERSE         TO AMCLASSH                30650000
306600            MOVE DP015-UNP-ALP-BRT-OFF TO AMCLASSA                30660000
306700            MOVE PC-TSYMSG-00138       TO DP020-MSG-NUMBER        30670000
306800            SET DP020-MSG-FATAL        TO TRUE                    30680000
306900            MOVE -1                    TO AMCLASSL                30690000
307000         END-IF                                                   30700000
307100      END-IF.                                                     30710000
307200      PERFORM Z139-CLOSE-CLASS-CURSOR.                            30720000
307300                                                                  30730000
307400 F350-PROCESS-SCL.                                                30740000
307500******************************************************************30750000
307600*                                                                 30760000
307700*                                                                 30770000
307800* PERFORMED BY: E500-EDIT-MDSEAR-ENTRY                            30780000
307900******************************************************************30790000
308000                                                                  30800000
308100                                                                  30810000
308200      MOVE PC-COMPANY-NUMBER TO PK-OPERCO-NBR.                    30820000
308300      MOVE SPACES              TO PK-GMA-NBR                      30830000
308400                                  PK-DMA-NBR.                     30840000
308500      MOVE ASC-SCRN-DPT-NO     TO PK-DEPT-NBR.                    30850000
308600      MOVE ASC-SCRN-MCL-NO     TO PK-MAJ-CL-NBR.                  30860000
308700      MOVE ASC-SCRN-SCL-NO     TO PK-SUB-CL-NBR.                  30870000
308800      MOVE 'SCL'               TO PK-MDSELV-CDE.                  30880000
308900                                                                  30890000
309000      PERFORM Z138-OPEN-CLASS-CURSOR.                             30900000
309100      PERFORM Z140-GET-MERCH-AREA-MCL.                            30910000
309200                                                                  30920000
309300                                                                  30930000
309400      IF PS-NEED-ROW                                              30940000
309500         IF PS-NO-ROW-FOUND                                       30950000
309600            SET PS-ERROR TO TRUE                                  30960000
309700            SET PS-DATA-ERROR TO TRUE                             30970000
309800            MOVE DP015-RED             TO ASCLASSC                30980000
309900            MOVE DP015-REVERSE         TO ASCLASSH                30990000
310000            MOVE DP015-UNP-ALP-BRT-OFF TO ASCLASSA                31000000
310100            MOVE PC-TSYMSG-00079       TO DP020-MSG-NUMBER        31010000
310200            SET DP020-MSG-FATAL        TO TRUE                    31020000
310300            MOVE -1                    TO ASCLASSL                31030000
310400         ELSE                                                     31040000
310500            IF MDSEAR-DMA-NBR  NOT = ASC-SCRN-DMA-NO              31050000
310600                SET PS-ERROR TO TRUE                              31060000
310700                SET PS-DATA-ERROR TO TRUE                         31070000
310800                MOVE DP015-RED             TO ADEPTC              31080000
310900                MOVE DP015-REVERSE         TO ADEPTH              31090000
311000                MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA              31100000
311100                MOVE PC-TSYMSG-00077       TO DP020-MSG-NUMBER    31110000
311200                SET DP020-MSG-FATAL        TO TRUE                31120000
311300                MOVE -1                    TO ADEPTL              31130000
311400            ELSE                                                  31140000
311500                IF MDSEAR-GMA-NBR  NOT = ASC-SCRN-GMA-NO          31150000
311600                    SET PS-ERROR TO TRUE                          31160000
311700                    SET PS-DATA-ERROR TO TRUE                     31170000
311800                    MOVE DP015-RED             TO ADMAC           31180000
311900                    MOVE DP015-REVERSE         TO ADMAH           31190000
312000                    MOVE DP015-UNP-ALP-BRT-OFF TO ADMAA           31200000
312100                    MOVE PC-TSYMSG-00076       TO DP020-MSG-NUMBER31210000
312200                    SET DP020-MSG-FATAL        TO TRUE            31220000
312300                    MOVE -1                    TO ADMAL           31230000
312400                END-IF                                            31240000
312500            END-IF                                                31250000
312600         END-IF                                                   31260000
312700      ELSE                                                        31270000
312800         IF PS-NO-ROW-FOUND                                       31280000
312900              CONTINUE                                            31290000
313000         ELSE                                                     31300000
313100            SET PS-ERROR TO TRUE                                  31310000
313200            SET PS-DATA-ERROR TO TRUE                             31320000
313300            MOVE DP015-RED             TO ASCLASSC                31330000
313400            MOVE DP015-REVERSE         TO ASCLASSH                31340000
313500            MOVE DP015-UNP-ALP-BRT-OFF TO ASCLASSA                31350000
313600            MOVE PC-TSYMSG-00138       TO DP020-MSG-NUMBER        31360000
313700            SET DP020-MSG-FATAL        TO TRUE                    31370000
313800            MOVE -1                    TO ASCLASSL                31380000
313900         END-IF                                                   31390000
314000      END-IF.                                                     31400000
314100      PERFORM Z139-CLOSE-CLASS-CURSOR.                            31410000
314200                                                                  31420000
314300                                                                  31430000
314400 K100-RETRIEVE-DATA-FOR-PANEL.                                    31440000
314500                                                                  31450000
314600******************************************************************31460000
314700*                                                                 31470000
314800*                                                                 31480000
314900*                                                                 31490000
315000******************************************************************31500000
315100                                                                  31510000
315200                                                                  31520000
315300     COMPUTE PV-LEVEL-INDEX-END = ASC-ADD-MDSE-LEVEL - 1.         31530000
315400     INITIALIZE PV-LEVEL-INDEX.                                   31540000
315500                                                                  31550000
315600                                                                  31560000
315700     IF PV-LEVEL-INDEX-END > 0                                    31570000
315800         PERFORM K150-GET-LEVEL-DESC                              31580000
315900            VARYING PV-LEVEL-INDEX FROM 1 BY 1                    31590000
316000            UNTIL (PV-LEVEL-INDEX > PV-LEVEL-INDEX-END)           31600000
316100                                                                  31610000
316200         MOVE MDSEAR-END-DTE          TO PV-WORK-DATE             31620000
316300         MOVE PV-WORK-CC              TO ASC-LEVEL-END-CC-X       31630000
316400         MOVE PV-WORK-MM              TO ASC-LEVEL-END-MM-X       31640000
316500         MOVE PV-WORK-DD              TO ASC-LEVEL-END-DD-X       31650000
316600         MOVE PV-WORK-YY              TO ASC-LEVEL-END-YY-X       31660000
316700                                                                  31670000
316800         MOVE MDSEAR-STRT-DTE         TO PV-WORK-DATE             31680000
316900         MOVE PV-WORK-CC              TO ASC-LEVEL-STRT-CC-X      31690000
317000         MOVE PV-WORK-MM              TO ASC-LEVEL-STRT-MM-X      31700000
317100         MOVE PV-WORK-DD              TO ASC-LEVEL-STRT-DD-X      31710000
317200         MOVE PV-WORK-YY              TO ASC-LEVEL-STRT-YY-X      31720000
317300     ELSE                                                         31730000
317400        IF PV-LEVEL-INDEX-END = 0                                 31740000
317500           MOVE ASC-CURRENT-DATE      TO ASC-LEVEL-STRT-DTE       31750000
317600           MOVE PC-INFINITY-DATE      TO ASC-LEVEL-END-DTE        31760000
317700     END-IF.                                                      31770000
317800                                                                  31780000
317900     EJECT                                                        31790000
318000                                                                  31800000
318100 K150-GET-LEVEL-DESC.                                             31810000
318200******************************************************************31820000
318300*                                                                 31830000
318400*                                                                 31840000
318500*   PERFORMED BY :  K100-RETRIEVE DATA FOR PANEL                  31850000
318600******************************************************************31860000
318700                                                                  31870000
318800     EVALUATE TRUE                                                31880000
318900                                                                  31890000
319000          WHEN PV-INDEX-GMA-LEVEL                                 31900000
319100               MOVE PC-COMPANY-NUMBER TO  PK-OPERCO-NBR           31910000
319200               MOVE ASC-SCRN-GMA-NO   TO PK-GMA-NBR               31920000
319300               MOVE '000'             TO PK-DMA-NBR PK-DEPT-NBR   31930000
319400                                         PK-MAJ-CL-NBR            31940000
319500                                         PK-SUB-CL-NBR            31950000
319600               MOVE 'GMA'             TO PK-MDSELV-CDE            31960000
319700               PERFORM Z100-GET-MERCH-AREA-TABLE                  31970000
319800               MOVE MDSEAR-DESC       TO ASC-GMA-DESC             31980000
319900                                                                  31990000
320000          WHEN PV-INDEX-DMA-LEVEL                                 32000000
320100               MOVE PC-COMPANY-NUMBER TO  PK-OPERCO-NBR           32010000
320200               MOVE ASC-SCRN-GMA-NO   TO PK-GMA-NBR               32020000
320300               MOVE ASC-SCRN-DMA-NO   TO PK-DMA-NBR               32030000
320400               MOVE '000'             TO PK-DEPT-NBR              32040000
320500                                         PK-MAJ-CL-NBR            32050000
320600                                         PK-SUB-CL-NBR            32060000
320700               MOVE 'DMA'             TO PK-MDSELV-CDE            32070000
320800               PERFORM Z100-GET-MERCH-AREA-TABLE                  32080000
320900               MOVE MDSEAR-DESC       TO ASC-DMA-DESC             32090000
321000                                                                  32100000
321100          WHEN PV-INDEX-DPT-LEVEL                                 32110000
321200               MOVE PC-COMPANY-NUMBER TO PK-OPERCO-NBR            32120000
321300               MOVE ASC-SCRN-GMA-NO   TO PK-GMA-NBR               32130000
321400               MOVE ASC-SCRN-DMA-NO   TO PK-DMA-NBR               32140000
321500               MOVE ASC-SCRN-DPT-NO   TO PK-DEPT-NBR              32150000
321600               MOVE '000'             TO PK-MAJ-CL-NBR            32160000
321700                                         PK-SUB-CL-NBR            32170000
321800               MOVE 'DPT'             TO PK-MDSELV-CDE            32180000
321900               PERFORM Z100-GET-MERCH-AREA-TABLE                  32190000
322000               MOVE MDSEAR-DESC       TO ASC-DPT-DESC             32200000
322100                                                                  32210000
322200          WHEN PV-INDEX-MCL-LEVEL                                 32220000
322300               MOVE PC-COMPANY-NUMBER TO PK-OPERCO-NBR            32230000
322400               MOVE ASC-SCRN-GMA-NO   TO PK-GMA-NBR               32240000
322500               MOVE ASC-SCRN-DMA-NO   TO PK-DMA-NBR               32250000
322600               MOVE ASC-SCRN-DPT-NO   TO PK-DEPT-NBR              32260000
322700               MOVE ASC-SCRN-MCL-NO   TO PK-MAJ-CL-NBR            32270000
322800               MOVE '000'             TO PK-SUB-CL-NBR            32280000
322900               MOVE 'MCL'             TO PK-MDSELV-CDE            32290000
323000               PERFORM Z100-GET-MERCH-AREA-TABLE                  32300000
323100               MOVE MDSEAR-DESC       TO ASC-MCL-DESC             32310000
323200                                                                  32320000
323300          WHEN PV-INDEX-SCL-LEVEL                                 32330000
323400               MOVE PC-COMPANY-NUMBER TO PK-OPERCO-NBR            32340000
323500               MOVE ASC-SCRN-GMA-NO   TO PK-GMA-NBR               32350000
323600               MOVE ASC-SCRN-DMA-NO   TO PK-DMA-NBR               32360000
323700               MOVE ASC-SCRN-DPT-NO   TO PK-DEPT-NBR              32370000
323800               MOVE ASC-SCRN-MCL-NO   TO PK-MAJ-CL-NBR            32380000
323900               MOVE ASC-SCRN-SCL-NO   TO PK-SUB-CL-NBR            32390000
324000               MOVE 'SCL'             TO PK-MDSELV-CDE            32400000
324100               PERFORM Z100-GET-MERCH-AREA-TABLE                  32410000
324200               MOVE MDSEAR-DESC       TO ASC-SCL-DESC             32420000
324300     END-EVALUATE.                                                32430000
324400                                                                  32440000
324500 EJECT                                                            32450000
324600                                                                  32460000
324700 4300-SETUP-INTER-APPL-COMM.                                      32470000
324800******************************************************************32480000
324900*                                                                 32490000
325000*                                                                 32500000
325100******************************************************************32510000
325200        MOVE PC-COMPANY-NUMBER    TO MB005-CO-NUMBER.             32520000
325300        MOVE ASC-SCRN-GMA-NO      TO MB005-GMA-NUMBER.            32530000
325400        MOVE ASC-SCRN-DMA-NO      TO MB005-DMA-NUMBER.            32540000
325500        MOVE ASC-SCRN-DPT-NO      TO MB005-DEPT-NUMBER.           32550000
325600        MOVE ASC-SCRN-MCL-NO      TO MB005-MCLASS-NUMBER.         32560000
325700        MOVE ASC-SCRN-SCL-NO      TO MB005-SCLASS-NUMBER.         32570000
325800        MOVE ASC-ADD-MDSE-LEVEL   TO MB005-MDSEAR-LEVEL.          32580000
325900        MOVE ASC-TEMP-QUEUE-NAME  TO MB005-LIST-QUEUE-NAME.       32590000
326000        MOVE PC-TSQ-LENGTH        TO MB005-LIST-QUEUE-LENGTH.     32600000
326100        SET DP020-MB-MERCH-AREA-ADD TO TRUE.                      32610000
326200                                                                  32620000
326300 EJECT                                                            32630000
326400                                                                  32640000
326500                                                                  32650000
326600                                                                  32660000
326700******************************************************************32670000
326800*                                                                 32680000
326900*                                                                 32690000
327000******************************************************************32700000
327100                                                                  32710000
327200     SET PS-NO-ERROR TO TRUE.                                     32720000
327300                                                                  32730000
327400 EJECT                                                            32740000
327500                                                                  32750000
327600 Z100-GET-MERCH-AREA-TABLE.                                       32760000
327700                                                                  32770000
327800******************************************************************32780000
327900*                                                                 32790000
328000*                                                                 32800000
328100******************************************************************32810000
328200                                                                  32820000
328300     PERFORM WITH TEST AFTER                                      32830000
328400         VARYING PV-RETRY-COUNTER                                 32840000
328500         FROM 1 BY 1                                              32850000
328600         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              32860000
328700                 OR (SQLCODE = 0)                                 32870000
328800                 OR (SQLCODE = +100))                             32880000
328900                                                                  32890000
329000                                                                  32900000
329100         EXEC SQL                                                 32910000
329200             SELECT GMA_NBR,                                      32920000
329300                    DMA_NBR,                                      32930000
329400                    DEPT_NBR,                                     32940000
329500                    MAJ_CL_NBR,                                   32950000
329600                    SUB_CL_NBR,                                   32960000
329700                    MDSEAR_DESC,                                  32970000
329800                    STRT_DTE,                                     32980000
329900                    END_DTE                                       32990000
330000             INTO :MDSEAR-GMA-NBR,                                33000000
330100                  :MDSEAR-DMA-NBR,                                33010000
330200                  :MDSEAR-DEPT-NBR,                               33020000
330300                  :MDSEAR-MAJ-CL-NBR,                             33030000
330400                  :MDSEAR-SUB-CL-NBR,                             33040000
330500                  :MDSEAR-DESC,                                   33050000
330600                  :MDSEAR-STRT-DTE,                               33060000
330700                  :MDSEAR-END-DTE                                 33070000
330800             FROM   TMDSEAR                                       33080000
330900             WHERE ((OPERCO_NBR    = :PK-OPERCO-NBR) AND          33090000
331000                    (GMA_NBR       = :PK-GMA-NBR)    AND          33100000
331100                    (DMA_NBR       = :PK-DMA-NBR)    AND          33110000
331200                    (DEPT_NBR      = :PK-DEPT-NBR)   AND          33120000
331300                    (MAJ_CL_NBR    = :PK-MAJ-CL-NBR) AND          33130000
331400                    (SUB_CL_NBR    = :PK-SUB-CL-NBR) AND          33140000
331500                    (MDSELV_CDE    = :PK-MDSELV-CDE) AND          33150000
331600                    (END_DTE > DATE (CURRENT TIMESTAMP)))         33160000
331700         END-EXEC                                                 33170000
331800                                                                  33180000
331900         EVALUATE TRUE                                            33190000
332000             WHEN SQLCODE = ZERO                                  33200000
332100                 SET PS-ROW-FOUND TO TRUE                         33210000
332200             WHEN SQLCODE = -904                                  33220000
332300             WHEN SQLCODE = -913                                  33230000
332400                  CONTINUE                                        33240000
332500             WHEN SQLCODE = +100                                  33250000
332600                  SET PS-NO-ROW-FOUND TO TRUE                     33260000
332700             WHEN SQLWARN0 NOT = SPACES                           33270000
332800             WHEN SQLCODE < 0                                     33280000
332900             WHEN SQLCODE > 0                                     33290000
333000                 STRING ' GMA ' PK-GMA-NBR                        33300000
333100                        ' DMA ' PK-DMA-NBR                        33310000
333200                        ' DPT ' PK-DEPT-NBR                       33320000
333300                        ' MCL ' PK-MAJ-CL-NBR                     33330000
333400                        ' SCL ' PK-SUB-CL-NBR                     33340000
333500                        ' LEV=' PK-MDSELV-CDE                     33350000
333600                        ' DTE ' PK-END-DTE                        33360000
333700                        DELIMITED BY SIZE                         33370000
333800                        INTO DP013-MESSAGE-TEXT(1)                33380000
333900                 MOVE SQLCA TO DP013-SQLCA                        33390000
334000                 MOVE 'Z100-GET-MERCH-AREA-TABLE' TO              33400000
334100                     DP013-PARAGRAPH                              33410000
334200                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        33420000
334300                 SET DP013-DB2-ABEND TO TRUE                      33430000
334400                 SET DP013-NO-ROLLBACK TO TRUE                    33440000
334500                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           33450000
334600                 PERFORM DP013-0000-PROCESS-ABEND                 33460000
334700         END-EVALUATE                                             33470000
334800     END-PERFORM.                                                 33480000
334900                                                                  33490000
335000                                                                  33500000
335100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         33510000
335200         MOVE 'Z100-GET-MERCH-AREA-TABLE' TO                      33520000
335300                                     DP013-PARAGRAPH              33530000
335400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 33540000
335500                                     DP013-MESSAGE-TEXT(1)        33550000
335600         STRING ' GMA ' PK-GMA-NBR                                33560000
335700                ' DMA ' PK-DMA-NBR                                33570000
335800                ' DPT ' PK-DEPT-NBR                               33580000
335900                ' MCL ' PK-MAJ-CL-NBR                             33590000
336000                ' SCL ' PK-SUB-CL-NBR                             33600000
336100                ' LEV=' PK-MDSELV-CDE                             33610000
336200                ' DTE ' PK-END-DTE                                33620000
336300                DELIMITED BY SIZE                                 33630000
336400                INTO DP013-MESSAGE-TEXT(2)                        33640000
336500         MOVE SQLCA TO DP013-SQLCA                                33650000
336600         MOVE 'Z100-GET-LEVEL-DESCRIPTION' TO                     33660000
336700             DP013-PARAGRAPH                                      33670000
336800         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                33680000
336900         SET DP013-DB2-ABEND                                      33690000
337000             DP013-NO-ROLLBACK                                    33700000
337100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   33710000
337200         PERFORM DP013-0000-PROCESS-ABEND                         33720000
337300     END-IF.                                                      33730000
337400                                                                  33740000
337500                                                                  33750000
337600 Z108-OPEN-GMA-CURSOR.                                            33760000
337700******************************************************************33770000
337800*                                                                 33780000
337900*                                                                 33790000
338000******************************************************************33800000
338100                                                                  33810000
338200     PERFORM WITH TEST AFTER                                      33820000
338300         VARYING PV-RETRY-COUNTER                                 33830000
338400         FROM 1 BY 1                                              33840000
338500         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              33850000
338600                 OR (SQLCODE = 0)                                 33860000
338700                 OR (SQLCODE = +100))                             33870000
338800                                                                  33880000
338900                                                                  33890000
339000         EXEC SQL                                                 33900000
339100             OPEN GMA_CURSOR                                      33910000
339200         END-EXEC                                                 33920000
339300                                                                  33930000
339400         EVALUATE TRUE                                            33940000
339500             WHEN SQLCODE = ZERO                                  33950000
339600                 SET PS-ROW-FOUND TO TRUE                         33960000
339700             WHEN SQLCODE = -904                                  33970000
339800             WHEN SQLCODE = -913                                  33980000
339900                  CONTINUE                                        33990000
340000             WHEN SQLCODE = +100                                  34000000
340100             WHEN SQLWARN0 NOT = SPACES                           34010000
340200             WHEN SQLCODE < 0                                     34020000
340300             WHEN SQLCODE > 0                                     34030000
340400                 STRING ' GMA ' PK-GMA-NBR                        34040000
340500                        ' DMA ' PK-DMA-NBR                        34050000
340600                        ' DPT ' PK-DEPT-NBR                       34060000
340700                        ' MCL ' PK-MAJ-CL-NBR                     34070000
340800                        ' SCL ' PK-SUB-CL-NBR                     34080000
340900                        ' LEV=' PK-MDSELV-CDE                     34090000
341000                        ' DTE ' PK-END-DTE                        34100000
341100                        DELIMITED BY SIZE                         34110000
341200                        INTO DP013-MESSAGE-TEXT(1)                34120000
341300                 MOVE SQLCA TO DP013-SQLCA                        34130000
341400                 MOVE 'Z108-OPEN-GMA-CURSOR' TO                   34140000
341500                     DP013-PARAGRAPH                              34150000
341600                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        34160000
341700                 SET DP013-DB2-ABEND TO TRUE                      34170000
341800                 SET DP013-NO-ROLLBACK TO TRUE                    34180000
341900                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           34190000
342000                 PERFORM DP013-0000-PROCESS-ABEND                 34200000
342100         END-EVALUATE                                             34210000
342200     END-PERFORM.                                                 34220000
342300                                                                  34230000
342400                                                                  34240000
342500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         34250000
342600         MOVE 'Z108-OPEN-GMA-CURSOR     ' TO                      34260000
342700                                     DP013-PARAGRAPH              34270000
342800         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 34280000
342900                                     DP013-MESSAGE-TEXT(1)        34290000
343000         STRING ' GMA ' PK-GMA-NBR                                34300000
343100                ' LEV=' PK-MDSELV-CDE                             34310000
343200                ' DTE ' PK-END-DTE                                34320000
343300                DELIMITED BY SIZE                                 34330000
343400                INTO DP013-MESSAGE-TEXT(2)                        34340000
343500         MOVE SQLCA TO DP013-SQLCA                                34350000
343600         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                34360000
343700         SET DP013-DB2-ABEND                                      34370000
343800             DP013-NO-ROLLBACK                                    34380000
343900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   34390000
344000         PERFORM DP013-0000-PROCESS-ABEND                         34400000
344100     END-IF.                                                      34410000
344200     EJECT                                                        34420000
344300                                                                  34430000
344400 Z109-CLOSE-GMA-CURSOR.                                           34440000
344500******************************************************************34450000
344600*                                                                 34460000
344700*                                                                 34470000
344800******************************************************************34480000
344900                                                                  34490000
345000     PERFORM WITH TEST AFTER                                      34500000
345100         VARYING PV-RETRY-COUNTER                                 34510000
345200         FROM 1 BY 1                                              34520000
345300         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              34530000
345400                 OR (SQLCODE = 0)                                 34540000
345500                 OR (SQLCODE = +100))                             34550000
345600                                                                  34560000
345700                                                                  34570000
345800         EXEC SQL                                                 34580000
345900             CLOSE GMA_CURSOR                                     34590000
346000         END-EXEC                                                 34600000
346100                                                                  34610000
346200         EVALUATE TRUE                                            34620000
346300             WHEN SQLCODE = ZERO                                  34630000
346400                 SET PS-ROW-FOUND TO TRUE                         34640000
346500             WHEN SQLCODE = -904                                  34650000
346600             WHEN SQLCODE = -913                                  34660000
346700                  CONTINUE                                        34670000
346800             WHEN SQLCODE = +100                                  34680000
346900             WHEN SQLWARN0 NOT = SPACES                           34690000
347000             WHEN SQLCODE < 0                                     34700000
347100             WHEN SQLCODE > 0                                     34710000
347200                 STRING ' GMA ' PK-GMA-NBR                        34720000
347300                        ' DMA ' PK-DMA-NBR                        34730000
347400                        ' DPT ' PK-DEPT-NBR                       34740000
347500                        ' MCL ' PK-MAJ-CL-NBR                     34750000
347600                        ' SCL ' PK-SUB-CL-NBR                     34760000
347700                        ' LEV=' PK-MDSELV-CDE                     34770000
347800                        ' DTE ' PK-END-DTE                        34780000
347900                        DELIMITED BY SIZE                         34790000
348000                        INTO DP013-MESSAGE-TEXT(1)                34800000
348100                 MOVE SQLCA TO DP013-SQLCA                        34810000
348200                 MOVE 'Z109-CLOSE-GMA-CURSOR' TO                  34820000
348300                     DP013-PARAGRAPH                              34830000
348400                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        34840000
348500                 SET DP013-DB2-ABEND TO TRUE                      34850000
348600                 SET DP013-NO-ROLLBACK TO TRUE                    34860000
348700                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           34870000
348800                 PERFORM DP013-0000-PROCESS-ABEND                 34880000
348900         END-EVALUATE                                             34890000
349000     END-PERFORM.                                                 34900000
349100                                                                  34910000
349200                                                                  34920000
349300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         34930000
349400         MOVE 'Z109-CLOSE-GMA-CURSOR     ' TO                     34940000
349500                                     DP013-PARAGRAPH              34950000
349600         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 34960000
349700                                     DP013-MESSAGE-TEXT(1)        34970000
349800         STRING ' GMA ' PK-GMA-NBR                                34980000
349900                ' LEV=' PK-MDSELV-CDE                             34990000
350000                ' DTE ' PK-END-DTE                                35000000
350100                DELIMITED BY SIZE                                 35010000
350200                INTO DP013-MESSAGE-TEXT(2)                        35020000
350300         MOVE SQLCA TO DP013-SQLCA                                35030000
350400         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                35040000
350500         SET DP013-DB2-ABEND                                      35050000
350600             DP013-NO-ROLLBACK                                    35060000
350700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   35070000
350800         PERFORM DP013-0000-PROCESS-ABEND                         35080000
350900     END-IF.                                                      35090000
351000     EJECT                                                        35100000
351100                                                                  35110000
351200 Z110-GET-MERCH-AREA-GMA.                                         35120000
351300                                                                  35130000
351400******************************************************************35140000
351500*                                                                 35150000
351600*                                                                 35160000
351700******************************************************************35170000
351800                                                                  35180000
351900     PERFORM WITH TEST AFTER                                      35190000
352000         VARYING PV-RETRY-COUNTER                                 35200000
352100         FROM 1 BY 1                                              35210000
352200         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              35220000
352300                 OR (SQLCODE = 0)                                 35230000
352400                 OR (SQLCODE = +100))                             35240000
352500                                                                  35250000
352600                                                                  35260000
352700         EXEC SQL                                                 35270000
352800             FETCH GMA_CURSOR                                     35280000
352900             INTO :MDSEAR-GMA-NBR,                                35290000
353000                  :MDSEAR-DMA-NBR,                                35300000
353100                  :MDSEAR-DEPT-NBR,                               35310000
353200                  :MDSEAR-MAJ-CL-NBR,                             35320000
353300                  :MDSEAR-SUB-CL-NBR,                             35330000
353400                  :MDSEAR-DESC,                                   35340000
353500                  :MDSEAR-STRT-DTE,                               35350000
353600                  :MDSEAR-END-DTE,                                35360000
353700                  :MDSEAR-DKEY,                                   35370000
353800                  :MDSEAR-BYR-NBR,                                35380000
353900                  :MDSEAR-GEN-MDSE-TYP-CDE                        35390000
354000         END-EXEC                                                 35400000
354100                                                                  35410000
354200         EVALUATE TRUE                                            35420000
354300             WHEN SQLCODE = ZERO                                  35430000
354400                 SET PS-ROW-FOUND TO TRUE                         35440000
354500             WHEN SQLCODE = -904                                  35450000
354600             WHEN SQLCODE = -913                                  35460000
354700                  CONTINUE                                        35470000
354800             WHEN SQLCODE = +100                                  35480000
354900                  SET PS-NO-ROW-FOUND TO TRUE                     35490000
355000             WHEN SQLWARN0 NOT = SPACES                           35500000
355100             WHEN SQLCODE < 0                                     35510000
355200             WHEN SQLCODE > 0                                     35520000
355300                 STRING ' GMA ' PK-GMA-NBR                        35530000
355400                        ' DMA ' PK-DMA-NBR                        35540000
355500                        ' DPT ' PK-DEPT-NBR                       35550000
355600                        ' MCL ' PK-MAJ-CL-NBR                     35560000
355700                        ' SCL ' PK-SUB-CL-NBR                     35570000
355800                        ' LEV=' PK-MDSELV-CDE                     35580000
355900                        ' DTE ' PK-END-DTE                        35590000
356000                        DELIMITED BY SIZE                         35600000
356100                        INTO DP013-MESSAGE-TEXT(1)                35610000
356200                 MOVE SQLCA TO DP013-SQLCA                        35620000
356300                 MOVE 'Z110-GET-MERCH-AREA-GMA' TO                35630000
356400                     DP013-PARAGRAPH                              35640000
356500                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        35650000
356600                 SET DP013-DB2-ABEND TO TRUE                      35660000
356700                 SET DP013-NO-ROLLBACK TO TRUE                    35670000
356800                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           35680000
356900                 PERFORM DP013-0000-PROCESS-ABEND                 35690000
357000         END-EVALUATE                                             35700000
357100     END-PERFORM.                                                 35710000
357200                                                                  35720000
357300                                                                  35730000
357400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35740000
357500         MOVE 'Z110-GET-MERCH-AREA-GMA  ' TO                      35750000
357600                                     DP013-PARAGRAPH              35760000
357700         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 35770000
357800                                     DP013-MESSAGE-TEXT(1)        35780000
357900         STRING ' GMA ' PK-GMA-NBR                                35790000
358000                ' LEV=' PK-MDSELV-CDE                             35800000
358100                ' DTE ' PK-END-DTE                                35810000
358200                DELIMITED BY SIZE                                 35820000
358300                INTO DP013-MESSAGE-TEXT(2)                        35830000
358400         MOVE SQLCA TO DP013-SQLCA                                35840000
358500         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                35850000
358600         SET DP013-DB2-ABEND                                      35860000
358700             DP013-NO-ROLLBACK                                    35870000
358800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   35880000
358900         PERFORM DP013-0000-PROCESS-ABEND                         35890000
359000     END-IF.                                                      35900000
359100     EJECT                                                        35910000
359200                                                                  35920000
359300 Z118-OPEN-DMA-CURSOR.                                            35930000
359400                                                                  35940000
359500******************************************************************35950000
359600*                                                                 35960000
359700*                                                                 35970000
359800******************************************************************35980000
359900                                                                  35990000
360000     PERFORM WITH TEST AFTER                                      36000000
360100         VARYING PV-RETRY-COUNTER                                 36010000
360200         FROM 1 BY 1                                              36020000
360300         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              36030000
360400                 OR (SQLCODE = 0)                                 36040000
360500                 OR (SQLCODE = +100))                             36050000
360600                                                                  36060000
360700                                                                  36070000
360800         EXEC SQL                                                 36080000
360900             OPEN  DMA_CURSOR                                     36090000
361000         END-EXEC                                                 36100000
361100                                                                  36110000
361200         EVALUATE TRUE                                            36120000
361300             WHEN SQLCODE = ZERO                                  36130000
361400                 SET PS-ROW-FOUND TO TRUE                         36140000
361500             WHEN SQLCODE = -904                                  36150000
361600             WHEN SQLCODE = -913                                  36160000
361700                  CONTINUE                                        36170000
361800             WHEN SQLCODE = +100                                  36180000
361900                  SET PS-NO-ROW-FOUND TO TRUE                     36190000
362000             WHEN SQLWARN0 NOT = SPACES                           36200000
362100             WHEN SQLCODE < 0                                     36210000
362200             WHEN SQLCODE > 0                                     36220000
362300                 STRING ' GMA ' PK-GMA-NBR                        36230000
362400                        ' DMA ' PK-DMA-NBR                        36240000
362500                        ' DPT ' PK-DEPT-NBR                       36250000
362600                        ' MCL ' PK-MAJ-CL-NBR                     36260000
362700                        ' SCL ' PK-SUB-CL-NBR                     36270000
362800                        ' LEV=' PK-MDSELV-CDE                     36280000
362900                        ' DTE ' PK-END-DTE                        36290000
363000                        DELIMITED BY SIZE                         36300000
363100                        INTO DP013-MESSAGE-TEXT(1)                36310000
363200                 MOVE SQLCA TO DP013-SQLCA                        36320000
363300                 MOVE 'Z118-OPEN-DMA-CURSOR' TO                   36330000
363400                     DP013-PARAGRAPH                              36340000
363500                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        36350000
363600                 SET DP013-DB2-ABEND TO TRUE                      36360000
363700                 SET DP013-NO-ROLLBACK TO TRUE                    36370000
363800                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           36380000
363900                 PERFORM DP013-0000-PROCESS-ABEND                 36390000
364000         END-EVALUATE                                             36400000
364100     END-PERFORM.                                                 36410000
364200                                                                  36420000
364300                                                                  36430000
364400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         36440000
364500         MOVE 'Z118-OPEN-DMA-CURSOR' TO DP013-PARAGRAPH           36450000
364600         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 36460000
364700                                     DP013-MESSAGE-TEXT(1)        36470000
364800                 STRING ' GMA ' PK-GMA-NBR                        36480000
364900                        ' DMA ' PK-DMA-NBR                        36490000
365000                        ' DPT ' PK-DEPT-NBR                       36500000
365100                        ' MCL ' PK-MAJ-CL-NBR                     36510000
365200                        ' SCL ' PK-SUB-CL-NBR                     36520000
365300                        ' LEV=' PK-MDSELV-CDE                     36530000
365400                        ' DTE ' PK-END-DTE                        36540000
365500                DELIMITED BY SIZE                                 36550000
365600                INTO DP013-MESSAGE-TEXT(2)                        36560000
365700         MOVE SQLCA TO DP013-SQLCA                                36570000
365800         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                36580000
365900         SET DP013-DB2-ABEND                                      36590000
366000             DP013-NO-ROLLBACK                                    36600000
366100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   36610000
366200         PERFORM DP013-0000-PROCESS-ABEND                         36620000
366300     END-IF.                                                      36630000
366400     EJECT                                                        36640000
366500                                                                  36650000
366600 Z119-CLOSE-DMA-CURSOR.                                           36660000
366700                                                                  36670000
366800******************************************************************36680000
366900*                                                                 36690000
367000*                                                                 36700000
367100******************************************************************36710000
367200                                                                  36720000
367300     PERFORM WITH TEST AFTER                                      36730000
367400         VARYING PV-RETRY-COUNTER                                 36740000
367500         FROM 1 BY 1                                              36750000
367600         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              36760000
367700                 OR (SQLCODE = 0)                                 36770000
367800                 OR (SQLCODE = +100))                             36780000
367900                                                                  36790000
368000                                                                  36800000
368100         EXEC SQL                                                 36810000
368200             CLOSE DMA_CURSOR                                     36820000
368300         END-EXEC                                                 36830000
368400                                                                  36840000
368500         EVALUATE TRUE                                            36850000
368600             WHEN SQLCODE = ZERO                                  36860000
368700                 SET PS-ROW-FOUND TO TRUE                         36870000
368800             WHEN SQLCODE = -904                                  36880000
368900             WHEN SQLCODE = -913                                  36890000
369000                  CONTINUE                                        36900000
369100             WHEN SQLCODE = +100                                  36910000
369200                  SET PS-NO-ROW-FOUND TO TRUE                     36920000
369300             WHEN SQLWARN0 NOT = SPACES                           36930000
369400             WHEN SQLCODE < 0                                     36940000
369500             WHEN SQLCODE > 0                                     36950000
369600                 STRING ' GMA ' PK-GMA-NBR                        36960000
369700                        ' DMA ' PK-DMA-NBR                        36970000
369800                        ' DPT ' PK-DEPT-NBR                       36980000
369900                        ' MCL ' PK-MAJ-CL-NBR                     36990000
370000                        ' SCL ' PK-SUB-CL-NBR                     37000000
370100                        ' LEV=' PK-MDSELV-CDE                     37010000
370200                        ' DTE ' PK-END-DTE                        37020000
370300                        DELIMITED BY SIZE                         37030000
370400                        INTO DP013-MESSAGE-TEXT(1)                37040000
370500                 MOVE SQLCA TO DP013-SQLCA                        37050000
370600                 MOVE 'Z119-CLOSE-DMA-CURSOR' TO                  37060000
370700                     DP013-PARAGRAPH                              37070000
370800                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        37080000
370900                 SET DP013-DB2-ABEND TO TRUE                      37090000
371000                 SET DP013-NO-ROLLBACK TO TRUE                    37100000
371100                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           37110000
371200                 PERFORM DP013-0000-PROCESS-ABEND                 37120000
371300         END-EVALUATE                                             37130000
371400     END-PERFORM.                                                 37140000
371500                                                                  37150000
371600                                                                  37160000
371700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37170000
371800         MOVE 'Z119-CLOSE-DMA-CURSOR' TO DP013-PARAGRAPH          37180000
371900         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 37190000
372000                                     DP013-MESSAGE-TEXT(1)        37200000
372100                 STRING ' GMA ' PK-GMA-NBR                        37210000
372200                        ' DMA ' PK-DMA-NBR                        37220000
372300                        ' DPT ' PK-DEPT-NBR                       37230000
372400                        ' MCL ' PK-MAJ-CL-NBR                     37240000
372500                        ' SCL ' PK-SUB-CL-NBR                     37250000
372600                        ' LEV=' PK-MDSELV-CDE                     37260000
372700                        ' DTE ' PK-END-DTE                        37270000
372800                DELIMITED BY SIZE                                 37280000
372900                INTO DP013-MESSAGE-TEXT(2)                        37290000
373000         MOVE SQLCA TO DP013-SQLCA                                37300000
373100         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                37310000
373200         SET DP013-DB2-ABEND                                      37320000
373300             DP013-NO-ROLLBACK                                    37330000
373400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   37340000
373500         PERFORM DP013-0000-PROCESS-ABEND                         37350000
373600     END-IF.                                                      37360000
373700     EJECT                                                        37370000
373800                                                                  37380000
373900 Z120-GET-MERCH-AREA-DMA.                                         37390000
374000                                                                  37400000
374100******************************************************************37410000
374200*                                                                 37420000
374300*                                                                 37430000
374400******************************************************************37440000
374500                                                                  37450000
374600     PERFORM WITH TEST AFTER                                      37460000
374700         VARYING PV-RETRY-COUNTER                                 37470000
374800         FROM 1 BY 1                                              37480000
374900         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              37490000
375000                 OR (SQLCODE = 0)                                 37500000
375100                 OR (SQLCODE = +100))                             37510000
375200                                                                  37520000
375300                                                                  37530000
375400         EXEC SQL                                                 37540000
375500             FETCH DMA_CURSOR                                     37550000
375600             INTO :MDSEAR-GMA-NBR,                                37560000
375700                  :MDSEAR-DMA-NBR,                                37570000
375800                  :MDSEAR-DEPT-NBR,                               37580000
375900                  :MDSEAR-MAJ-CL-NBR,                             37590000
376000                  :MDSEAR-SUB-CL-NBR,                             37600000
376100                  :MDSEAR-DESC,                                   37610000
376200                  :MDSEAR-STRT-DTE,                               37620000
376300                  :MDSEAR-END-DTE,                                37630000
376400                  :MDSEAR-DKEY,                                   37640000
376500                  :MDSEAR-BYR-NBR,                                37650000
376600                  :MDSEAR-GEN-MDSE-TYP-CDE                        37660000
376700         END-EXEC                                                 37670000
376800                                                                  37680000
376900         EVALUATE TRUE                                            37690000
377000             WHEN SQLCODE = ZERO                                  37700000
377100                 SET PS-ROW-FOUND TO TRUE                         37710000
377200             WHEN SQLCODE = -904                                  37720000
377300             WHEN SQLCODE = -913                                  37730000
377400                  CONTINUE                                        37740000
377500             WHEN SQLCODE = +100                                  37750000
377600                  SET PS-NO-ROW-FOUND TO TRUE                     37760000
377700             WHEN SQLWARN0 NOT = SPACES                           37770000
377800             WHEN SQLCODE < 0                                     37780000
377900             WHEN SQLCODE > 0                                     37790000
378000                 STRING ' GMA ' PK-GMA-NBR                        37800000
378100                        ' DMA ' PK-DMA-NBR                        37810000
378200                        ' DPT ' PK-DEPT-NBR                       37820000
378300                        ' MCL ' PK-MAJ-CL-NBR                     37830000
378400                        ' SCL ' PK-SUB-CL-NBR                     37840000
378500                        ' LEV=' PK-MDSELV-CDE                     37850000
378600                        ' DTE ' PK-END-DTE                        37860000
378700                        DELIMITED BY SIZE                         37870000
378800                        INTO DP013-MESSAGE-TEXT(1)                37880000
378900                 MOVE SQLCA TO DP013-SQLCA                        37890000
379000                 MOVE 'Z120-GET-MERCH-AREA-DMA' TO                37900000
379100                     DP013-PARAGRAPH                              37910000
379200                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        37920000
379300                 SET DP013-DB2-ABEND TO TRUE                      37930000
379400                 SET DP013-NO-ROLLBACK TO TRUE                    37940000
379500                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           37950000
379600                 PERFORM DP013-0000-PROCESS-ABEND                 37960000
379700         END-EVALUATE                                             37970000
379800     END-PERFORM.                                                 37980000
379900                                                                  37990000
380000                                                                  38000000
380100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         38010000
380200         MOVE 'Z120-GET-MERCH-AREA-DMA  ' TO                      38020000
380300                                     DP013-PARAGRAPH              38030000
380400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 38040000
380500                                     DP013-MESSAGE-TEXT(1)        38050000
380600                 STRING ' GMA ' PK-GMA-NBR                        38060000
380700                        ' DMA ' PK-DMA-NBR                        38070000
380800                        ' DPT ' PK-DEPT-NBR                       38080000
380900                        ' MCL ' PK-MAJ-CL-NBR                     38090000
381000                        ' SCL ' PK-SUB-CL-NBR                     38100000
381100                        ' LEV=' PK-MDSELV-CDE                     38110000
381200                        ' DTE ' PK-END-DTE                        38120000
381300                DELIMITED BY SIZE                                 38130000
381400                INTO DP013-MESSAGE-TEXT(2)                        38140000
381500         MOVE SQLCA TO DP013-SQLCA                                38150000
381600         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                38160000
381700         SET DP013-DB2-ABEND                                      38170000
381800             DP013-NO-ROLLBACK                                    38180000
381900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   38190000
382000         PERFORM DP013-0000-PROCESS-ABEND                         38200000
382100     END-IF.                                                      38210000
382200     EJECT                                                        38220000
382300                                                                  38230000
382400 Z128-OPEN-DEPT-CURSOR.                                           38240000
382500                                                                  38250000
382600******************************************************************38260000
382700*                                                                 38270000
382800*                                                                 38280000
382900******************************************************************38290000
383000                                                                  38300000
383100     PERFORM WITH TEST AFTER                                      38310000
383200         VARYING PV-RETRY-COUNTER                                 38320000
383300         FROM 1 BY 1                                              38330000
383400         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              38340000
383500                 OR (SQLCODE = 0)                                 38350000
383600                 OR (SQLCODE = +100))                             38360000
383700                                                                  38370000
383800                                                                  38380000
383900         EXEC SQL                                                 38390000
384000             OPEN  DEPT_CURSOR                                    38400000
384100         END-EXEC                                                 38410000
384200                                                                  38420000
384300         EVALUATE TRUE                                            38430000
384400             WHEN SQLCODE = ZERO                                  38440000
384500                 SET PS-ROW-FOUND TO TRUE                         38450000
384600             WHEN SQLCODE = -904                                  38460000
384700             WHEN SQLCODE = -913                                  38470000
384800                  CONTINUE                                        38480000
384900             WHEN SQLCODE = +100                                  38490000
385000                  SET PS-NO-ROW-FOUND TO TRUE                     38500000
385100             WHEN SQLWARN0 NOT = SPACES                           38510000
385200             WHEN SQLCODE < 0                                     38520000
385300             WHEN SQLCODE > 0                                     38530000
385400                 STRING ' GMA ' PK-GMA-NBR                        38540000
385500                        ' DMA ' PK-DMA-NBR                        38550000
385600                        ' DPT ' PK-DEPT-NBR                       38560000
385700                        ' MCL ' PK-MAJ-CL-NBR                     38570000
385800                        ' SCL ' PK-SUB-CL-NBR                     38580000
385900                        ' LEV=' PK-MDSELV-CDE                     38590000
386000                        ' DTE ' PK-END-DTE                        38600000
386100                        DELIMITED BY SIZE                         38610000
386200                        INTO DP013-MESSAGE-TEXT(1)                38620000
386300                 MOVE SQLCA TO DP013-SQLCA                        38630000
386400                 MOVE 'Z128-OPEN-DEPT-CURSOR' TO                  38640000
386500                     DP013-PARAGRAPH                              38650000
386600                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        38660000
386700                 SET DP013-DB2-ABEND TO TRUE                      38670000
386800                 SET DP013-NO-ROLLBACK TO TRUE                    38680000
386900                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           38690000
387000                 PERFORM DP013-0000-PROCESS-ABEND                 38700000
387100         END-EVALUATE                                             38710000
387200     END-PERFORM.                                                 38720000
387300                                                                  38730000
387400                                                                  38740000
387500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         38750000
387600         MOVE 'Z128-OPEN-DEPT-CURSOR' TO                          38760000
387700                                     DP013-PARAGRAPH              38770000
387800         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 38780000
387900                                     DP013-MESSAGE-TEXT(1)        38790000
388000                 STRING ' GMA ' PK-GMA-NBR                        38800000
388100                        ' DMA ' PK-DMA-NBR                        38810000
388200                        ' DPT ' PK-DEPT-NBR                       38820000
388300                        ' MCL ' PK-MAJ-CL-NBR                     38830000
388400                        ' SCL ' PK-SUB-CL-NBR                     38840000
388500                        ' LEV=' PK-MDSELV-CDE                     38850000
388600                        ' DTE ' PK-END-DTE                        38860000
388700                DELIMITED BY SIZE                                 38870000
388800                INTO DP013-MESSAGE-TEXT(2)                        38880000
388900         MOVE SQLCA TO DP013-SQLCA                                38890000
389000         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                38900000
389100         SET DP013-DB2-ABEND                                      38910000
389200             DP013-NO-ROLLBACK                                    38920000
389300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   38930000
389400         PERFORM DP013-0000-PROCESS-ABEND                         38940000
389500     END-IF.                                                      38950000
389600     EJECT                                                        38960000
389700                                                                  38970000
389800 Z129-CLOSE-DEPT-CURSOR.                                          38980000
389900                                                                  38990000
390000******************************************************************39000000
390100*                                                                 39010000
390200*                                                                 39020000
390300******************************************************************39030000
390400                                                                  39040000
390500     PERFORM WITH TEST AFTER                                      39050000
390600         VARYING PV-RETRY-COUNTER                                 39060000
390700         FROM 1 BY 1                                              39070000
390800         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              39080000
390900                 OR (SQLCODE = 0)                                 39090000
391000                 OR (SQLCODE = +100))                             39100000
391100                                                                  39110000
391200                                                                  39120000
391300         EXEC SQL                                                 39130000
391400             CLOSE DEPT_CURSOR                                    39140000
391500         END-EXEC                                                 39150000
391600                                                                  39160000
391700         EVALUATE TRUE                                            39170000
391800             WHEN SQLCODE = ZERO                                  39180000
391900                 SET PS-ROW-FOUND TO TRUE                         39190000
392000             WHEN SQLCODE = -904                                  39200000
392100             WHEN SQLCODE = -913                                  39210000
392200                  CONTINUE                                        39220000
392300             WHEN SQLCODE = +100                                  39230000
392400                  SET PS-NO-ROW-FOUND TO TRUE                     39240000
392500             WHEN SQLWARN0 NOT = SPACES                           39250000
392600             WHEN SQLCODE < 0                                     39260000
392700             WHEN SQLCODE > 0                                     39270000
392800                 STRING ' GMA ' PK-GMA-NBR                        39280000
392900                        ' DMA ' PK-DMA-NBR                        39290000
393000                        ' DPT ' PK-DEPT-NBR                       39300000
393100                        ' MCL ' PK-MAJ-CL-NBR                     39310000
393200                        ' SCL ' PK-SUB-CL-NBR                     39320000
393300                        ' LEV=' PK-MDSELV-CDE                     39330000
393400                        ' DTE ' PK-END-DTE                        39340000
393500                        DELIMITED BY SIZE                         39350000
393600                        INTO DP013-MESSAGE-TEXT(1)                39360000
393700                 MOVE SQLCA TO DP013-SQLCA                        39370000
393800                 MOVE 'Z129-CLOSE-DEPT-CURSOR' TO                 39380000
393900                     DP013-PARAGRAPH                              39390000
394000                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        39400000
394100                 SET DP013-DB2-ABEND TO TRUE                      39410000
394200                 SET DP013-NO-ROLLBACK TO TRUE                    39420000
394300                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           39430000
394400                 PERFORM DP013-0000-PROCESS-ABEND                 39440000
394500         END-EVALUATE                                             39450000
394600     END-PERFORM.                                                 39460000
394700                                                                  39470000
394800                                                                  39480000
394900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         39490000
395000         MOVE 'Z129-CLOSE-DEPT-CURSOR' TO                         39500000
395100                                     DP013-PARAGRAPH              39510000
395200         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 39520000
395300                                     DP013-MESSAGE-TEXT(1)        39530000
395400                 STRING ' GMA ' PK-GMA-NBR                        39540000
395500                        ' DMA ' PK-DMA-NBR                        39550000
395600                        ' DPT ' PK-DEPT-NBR                       39560000
395700                        ' MCL ' PK-MAJ-CL-NBR                     39570000
395800                        ' SCL ' PK-SUB-CL-NBR                     39580000
395900                        ' LEV=' PK-MDSELV-CDE                     39590000
396000                        ' DTE ' PK-END-DTE                        39600000
396100                DELIMITED BY SIZE                                 39610000
396200                INTO DP013-MESSAGE-TEXT(2)                        39620000
396300         MOVE SQLCA TO DP013-SQLCA                                39630000
396400         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                39640000
396500         SET DP013-DB2-ABEND                                      39650000
396600             DP013-NO-ROLLBACK                                    39660000
396700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   39670000
396800         PERFORM DP013-0000-PROCESS-ABEND                         39680000
396900     END-IF.                                                      39690000
397000                                                                  39700000
397100 Z130-GET-MERCH-AREA-DPT.                                         39710000
397200                                                                  39720000
397300******************************************************************39730000
397400*                                                                 39740000
397500*                                                                 39750000
397600******************************************************************39760000
397700                                                                  39770000
397800     PERFORM WITH TEST AFTER                                      39780000
397900         VARYING PV-RETRY-COUNTER                                 39790000
398000         FROM 1 BY 1                                              39800000
398100         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              39810000
398200                 OR (SQLCODE = 0)                                 39820000
398300                 OR (SQLCODE = +100))                             39830000
398400                                                                  39840000
398500                                                                  39850000
398600         EXEC SQL                                                 39860000
398700             FETCH DEPT_CURSOR                                    39870000
398800             INTO :MDSEAR-GMA-NBR,                                39880000
398900                  :MDSEAR-DMA-NBR,                                39890000
399000                  :MDSEAR-DEPT-NBR,                               39900000
399100                  :MDSEAR-MAJ-CL-NBR,                             39910000
399200                  :MDSEAR-SUB-CL-NBR,                             39920000
399300                  :MDSEAR-DESC,                                   39930000
399400                  :MDSEAR-STRT-DTE,                               39940000
399500                  :MDSEAR-END-DTE,                                39950000
399600                  :MDSEAR-DKEY,                                   39960000
399700                  :MDSEAR-BYR-NBR,                                39970000
399800                  :MDSEAR-GEN-MDSE-TYP-CDE                        39980000
399900         END-EXEC                                                 39990000
400000                                                                  40000000
400100         EVALUATE TRUE                                            40010000
400200             WHEN SQLCODE = ZERO                                  40020000
400300                 SET PS-ROW-FOUND TO TRUE                         40030000
400400             WHEN SQLCODE = -904                                  40040000
400500             WHEN SQLCODE = -913                                  40050000
400600                  CONTINUE                                        40060000
400700             WHEN SQLCODE = +100                                  40070000
400800                  SET PS-NO-ROW-FOUND TO TRUE                     40080000
400900             WHEN SQLWARN0 NOT = SPACES                           40090000
401000             WHEN SQLCODE < 0                                     40100000
401100             WHEN SQLCODE > 0                                     40110000
401200                 STRING ' GMA ' PK-GMA-NBR                        40120000
401300                        ' DMA ' PK-DMA-NBR                        40130000
401400                        ' DPT ' PK-DEPT-NBR                       40140000
401500                        ' MCL ' PK-MAJ-CL-NBR                     40150000
401600                        ' SCL ' PK-SUB-CL-NBR                     40160000
401700                        ' LEV=' PK-MDSELV-CDE                     40170000
401800                        ' DTE ' PK-END-DTE                        40180000
401900                        DELIMITED BY SIZE                         40190000
402000                        INTO DP013-MESSAGE-TEXT(1)                40200000
402100                 MOVE SQLCA TO DP013-SQLCA                        40210000
402200                 MOVE 'Z130-GET-MERCH-AREA-DPT' TO                40220000
402300                     DP013-PARAGRAPH                              40230000
402400                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        40240000
402500                 SET DP013-DB2-ABEND TO TRUE                      40250000
402600                 SET DP013-NO-ROLLBACK TO TRUE                    40260000
402700                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           40270000
402800                 PERFORM DP013-0000-PROCESS-ABEND                 40280000
402900         END-EVALUATE                                             40290000
403000     END-PERFORM.                                                 40300000
403100                                                                  40310000
403200                                                                  40320000
403300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         40330000
403400         MOVE 'Z130-GET-MERCH-AREA-DPT  ' TO                      40340000
403500                                     DP013-PARAGRAPH              40350000
403600         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 40360000
403700                                     DP013-MESSAGE-TEXT(1)        40370000
403800                 STRING ' GMA ' PK-GMA-NBR                        40380000
403900                        ' DMA ' PK-DMA-NBR                        40390000
404000                        ' DPT ' PK-DEPT-NBR                       40400000
404100                        ' MCL ' PK-MAJ-CL-NBR                     40410000
404200                        ' SCL ' PK-SUB-CL-NBR                     40420000
404300                        ' LEV=' PK-MDSELV-CDE                     40430000
404400                        ' DTE ' PK-END-DTE                        40440000
404500                DELIMITED BY SIZE                                 40450000
404600                INTO DP013-MESSAGE-TEXT(2)                        40460000
404700         MOVE SQLCA TO DP013-SQLCA                                40470000
404800         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                40480000
404900         SET DP013-DB2-ABEND                                      40490000
405000             DP013-NO-ROLLBACK                                    40500000
405100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   40510000
405200         PERFORM DP013-0000-PROCESS-ABEND                         40520000
405300     END-IF.                                                      40530000
405400                                                                  40540000
405500                                                                  40550000
405600 Z138-OPEN-CLASS-CURSOR.                                          40560000
405700                                                                  40570000
405800******************************************************************40580000
405900*                                                                 40590000
406000*                                                                 40600000
406100******************************************************************40610000
406200                                                                  40620000
406300     PERFORM WITH TEST AFTER                                      40630000
406400         VARYING PV-RETRY-COUNTER                                 40640000
406500         FROM 1 BY 1                                              40650000
406600         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              40660000
406700                 OR (SQLCODE = 0)                                 40670000
406800                 OR (SQLCODE = +100))                             40680000
406900                                                                  40690000
407000                                                                  40700000
407100         EXEC SQL                                                 40710000
407200             OPEN  CLASS_CURSOR                                   40720000
407300         END-EXEC                                                 40730000
407400                                                                  40740000
407500         EVALUATE TRUE                                            40750000
407600             WHEN SQLCODE = ZERO                                  40760000
407700                 SET PS-ROW-FOUND TO TRUE                         40770000
407800             WHEN SQLCODE = -904                                  40780000
407900             WHEN SQLCODE = -913                                  40790000
408000                  CONTINUE                                        40800000
408100             WHEN SQLCODE = +100                                  40810000
408200                  SET PS-NO-ROW-FOUND TO TRUE                     40820000
408300             WHEN SQLWARN0 NOT = SPACES                           40830000
408400             WHEN SQLCODE < 0                                     40840000
408500             WHEN SQLCODE > 0                                     40850000
408600                 STRING ' GMA ' PK-GMA-NBR                        40860000
408700                        ' DMA ' PK-DMA-NBR                        40870000
408800                        ' DPT ' PK-DEPT-NBR                       40880000
408900                        ' MCL ' PK-MAJ-CL-NBR                     40890000
409000                        ' SCL ' PK-SUB-CL-NBR                     40900000
409100                        ' LEV=' PK-MDSELV-CDE                     40910000
409200                        ' DTE ' PK-END-DTE                        40920000
409300                        DELIMITED BY SIZE                         40930000
409400                        INTO DP013-MESSAGE-TEXT(1)                40940000
409500                 MOVE SQLCA TO DP013-SQLCA                        40950000
409600                 MOVE 'Z138-OPEN-CLASS-CURSOR' TO                 40960000
409700                     DP013-PARAGRAPH                              40970000
409800                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        40980000
409900                 SET DP013-DB2-ABEND TO TRUE                      40990000
410000                 SET DP013-NO-ROLLBACK TO TRUE                    41000000
410100                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           41010000
410200                 PERFORM DP013-0000-PROCESS-ABEND                 41020000
410300         END-EVALUATE                                             41030000
410400     END-PERFORM.                                                 41040000
410500                                                                  41050000
410600                                                                  41060000
410700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41070000
410800         MOVE 'Z138-OPEN-CLASS-CURSOR' TO                         41080000
410900                                     DP013-PARAGRAPH              41090000
411000         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 41100000
411100                                     DP013-MESSAGE-TEXT(1)        41110000
411200                 STRING ' GMA ' PK-GMA-NBR                        41120000
411300                        ' DMA ' PK-DMA-NBR                        41130000
411400                        ' DPT ' PK-DEPT-NBR                       41140000
411500                        ' MCL ' PK-MAJ-CL-NBR                     41150000
411600                        ' SCL ' PK-SUB-CL-NBR                     41160000
411700                        ' LEV=' PK-MDSELV-CDE                     41170000
411800                        ' DTE ' PK-END-DTE                        41180000
411900                DELIMITED BY SIZE                                 41190000
412000                INTO DP013-MESSAGE-TEXT(2)                        41200000
412100         MOVE SQLCA TO DP013-SQLCA                                41210000
412200         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                41220000
412300         SET DP013-DB2-ABEND                                      41230000
412400             DP013-NO-ROLLBACK                                    41240000
412500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   41250000
412600         PERFORM DP013-0000-PROCESS-ABEND                         41260000
412700     END-IF.                                                      41270000
412800     EJECT                                                        41280000
412900                                                                  41290000
413000 Z139-CLOSE-CLASS-CURSOR.                                         41300000
413100                                                                  41310000
413200******************************************************************41320000
413300*                                                                 41330000
413400*                                                                 41340000
413500******************************************************************41350000
413600                                                                  41360000
413700     PERFORM WITH TEST AFTER                                      41370000
413800         VARYING PV-RETRY-COUNTER                                 41380000
413900         FROM 1 BY 1                                              41390000
414000         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              41400000
414100                 OR (SQLCODE = 0)                                 41410000
414200                 OR (SQLCODE = +100))                             41420000
414300                                                                  41430000
414400                                                                  41440000
414500         EXEC SQL                                                 41450000
414600             CLOSE CLASS_CURSOR                                   41460000
414700         END-EXEC                                                 41470000
414800                                                                  41480000
414900         EVALUATE TRUE                                            41490000
415000             WHEN SQLCODE = ZERO                                  41500000
415100                 SET PS-ROW-FOUND TO TRUE                         41510000
415200             WHEN SQLCODE = -904                                  41520000
415300             WHEN SQLCODE = -913                                  41530000
415400                  CONTINUE                                        41540000
415500             WHEN SQLCODE = +100                                  41550000
415600                  SET PS-NO-ROW-FOUND TO TRUE                     41560000
415700             WHEN SQLWARN0 NOT = SPACES                           41570000
415800             WHEN SQLCODE < 0                                     41580000
415900             WHEN SQLCODE > 0                                     41590000
416000                 STRING ' GMA ' PK-GMA-NBR                        41600000
416100                        ' DMA ' PK-DMA-NBR                        41610000
416200                        ' DPT ' PK-DEPT-NBR                       41620000
416300                        ' MCL ' PK-MAJ-CL-NBR                     41630000
416400                        ' SCL ' PK-SUB-CL-NBR                     41640000
416500                        ' LEV=' PK-MDSELV-CDE                     41650000
416600                        ' DTE ' PK-END-DTE                        41660000
416700                        DELIMITED BY SIZE                         41670000
416800                        INTO DP013-MESSAGE-TEXT(1)                41680000
416900                 MOVE SQLCA TO DP013-SQLCA                        41690000
417000                 MOVE 'Z139-CLOSE-CLASS-CURSOR' TO                41700000
417100                     DP013-PARAGRAPH                              41710000
417200                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        41720000
417300                 SET DP013-DB2-ABEND TO TRUE                      41730000
417400                 SET DP013-NO-ROLLBACK TO TRUE                    41740000
417500                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           41750000
417600                 PERFORM DP013-0000-PROCESS-ABEND                 41760000
417700         END-EVALUATE                                             41770000
417800     END-PERFORM.                                                 41780000
417900                                                                  41790000
418000                                                                  41800000
418100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41810000
418200         MOVE 'Z139-CLOSE-CLASS-CURSOR' TO                        41820000
418300                                     DP013-PARAGRAPH              41830000
418400         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 41840000
418500                                     DP013-MESSAGE-TEXT(1)        41850000
418600                 STRING ' GMA ' PK-GMA-NBR                        41860000
418700                        ' DMA ' PK-DMA-NBR                        41870000
418800                        ' DPT ' PK-DEPT-NBR                       41880000
418900                        ' MCL ' PK-MAJ-CL-NBR                     41890000
419000                        ' SCL ' PK-SUB-CL-NBR                     41900000
419100                        ' LEV=' PK-MDSELV-CDE                     41910000
419200                        ' DTE ' PK-END-DTE                        41920000
419300                DELIMITED BY SIZE                                 41930000
419400                INTO DP013-MESSAGE-TEXT(2)                        41940000
419500         MOVE SQLCA TO DP013-SQLCA                                41950000
419600         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                41960000
419700         SET DP013-DB2-ABEND                                      41970000
419800             DP013-NO-ROLLBACK                                    41980000
419900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   41990000
420000         PERFORM DP013-0000-PROCESS-ABEND                         42000000
420100     END-IF.                                                      42010000
420200     EJECT                                                        42020000
420300                                                                  42030000
420400                                                                  42040000
420500 Z140-GET-MERCH-AREA-MCL.                                         42050000
420600                                                                  42060000
420700******************************************************************42070000
420800*                                                                 42080000
420900*                                                                 42090000
421000******************************************************************42100000
421100                                                                  42110000
421200     PERFORM WITH TEST AFTER                                      42120000
421300         VARYING PV-RETRY-COUNTER                                 42130000
421400         FROM 1 BY 1                                              42140000
421500         UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              42150000
421600                 OR (SQLCODE = 0)                                 42160000
421700                 OR (SQLCODE = +100))                             42170000
421800                                                                  42180000
421900                                                                  42190000
422000         EXEC SQL                                                 42200000
422100             FETCH CLASS_CURSOR                                   42210000
422200             INTO :MDSEAR-GMA-NBR,                                42220000
422300                  :MDSEAR-DMA-NBR,                                42230000
422400                  :MDSEAR-DEPT-NBR,                               42240000
422500                  :MDSEAR-MAJ-CL-NBR,                             42250000
422600                  :MDSEAR-SUB-CL-NBR,                             42260000
422700                  :MDSEAR-DESC,                                   42270000
422800                  :MDSEAR-STRT-DTE,                               42280000
422900                  :MDSEAR-END-DTE,                                42290000
423000                  :MDSEAR-DKEY,                                   42300000
423100                  :MDSEAR-BYR-NBR,                                42310000
423200                  :MDSEAR-GEN-MDSE-TYP-CDE                        42320000
423300         END-EXEC                                                 42330000
423400                                                                  42340000
423500         EVALUATE TRUE                                            42350000
423600             WHEN SQLCODE = ZERO                                  42360000
423700                 SET PS-ROW-FOUND TO TRUE                         42370000
423800             WHEN SQLCODE = -904                                  42380000
423900             WHEN SQLCODE = -913                                  42390000
424000                  CONTINUE                                        42400000
424100             WHEN SQLCODE = +100                                  42410000
424200                  SET PS-NO-ROW-FOUND TO TRUE                     42420000
424300             WHEN SQLWARN0 NOT = SPACES                           42430000
424400             WHEN SQLCODE < 0                                     42440000
424500             WHEN SQLCODE > 0                                     42450000
424600                 STRING ' GMA ' PK-GMA-NBR                        42460000
424700                        ' DMA ' PK-DMA-NBR                        42470000
424800                        ' DPT ' PK-DEPT-NBR                       42480000
424900                        ' MCL ' PK-MAJ-CL-NBR                     42490000
425000                        ' SCL ' PK-SUB-CL-NBR                     42500000
425100                        ' LEV=' PK-MDSELV-CDE                     42510000
425200                        ' DTE ' PK-END-DTE                        42520000
425300                        DELIMITED BY SIZE                         42530000
425400                        INTO DP013-MESSAGE-TEXT(1)                42540000
425500                 MOVE SQLCA TO DP013-SQLCA                        42550000
425600                 MOVE 'Z140-GET-MERCH-AREA-MCL' TO                42560000
425700                     DP013-PARAGRAPH                              42570000
425800                 MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        42580000
425900                 SET DP013-DB2-ABEND TO TRUE                      42590000
426000                 SET DP013-NO-ROLLBACK TO TRUE                    42600000
426100                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           42610000
426200                 PERFORM DP013-0000-PROCESS-ABEND                 42620000
426300         END-EVALUATE                                             42630000
426400     END-PERFORM.                                                 42640000
426500                                                                  42650000
426600                                                                  42660000
426700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         42670000
426800         MOVE 'Z140-GET-MERCH-AREA-MCL  ' TO                      42680000
426900                                     DP013-PARAGRAPH              42690000
427000         MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 42700000
427100                                     DP013-MESSAGE-TEXT(1)        42710000
427200                 STRING ' GMA ' PK-GMA-NBR                        42720000
427300                        ' DMA ' PK-DMA-NBR                        42730000
427400                        ' DPT ' PK-DEPT-NBR                       42740000
427500                        ' MCL ' PK-MAJ-CL-NBR                     42750000
427600                        ' SCL ' PK-SUB-CL-NBR                     42760000
427700                        ' LEV=' PK-MDSELV-CDE                     42770000
427800                        ' DTE ' PK-END-DTE                        42780000
427900                DELIMITED BY SIZE                                 42790000
428000                INTO DP013-MESSAGE-TEXT(2)                        42800000
428100         MOVE SQLCA TO DP013-SQLCA                                42810000
428200         MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                42820000
428300         SET DP013-DB2-ABEND                                      42830000
428400             DP013-NO-ROLLBACK                                    42840000
428500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   42850000
428600         PERFORM DP013-0000-PROCESS-ABEND                         42860000
428700     END-IF.                                                      42870000
428800                                                                  42880000
428900                                                                  42890000
429000 Z300-SET-CURSOR-PLACEMENT.                                       42900000
429100******************************************************************42910000
429200*                                                                 42920000
429300******************************************************************42930000
429400     IF ASC-ADD-GMA                                               42940000
429500        MOVE -1 TO AGMAL                                          42950000
429600     ELSE                                                         42960000
429700       IF ASC-ADD-DMA                                             42970000
429800          MOVE -1 TO ADMAL                                        42980000
429900       ELSE                                                       42990000
430000         IF ASC-ADD-DPT                                           43000000
430100            MOVE -1 TO ADEPTL                                     43010000
430200         ELSE                                                     43020000
430300           IF ASC-ADD-MCL                                         43030000
430400              MOVE -1 TO AMCLASSL                                 43040000
430500           ELSE                                                   43050000
430600             IF ASC-ADD-SCL                                       43060000
430700                    MOVE -1 TO ASCLASSL                           43070000
430800             END-IF                                               43080000
430900           END-IF                                                 43090000
431000         END-IF                                                   43100000
431100       END-IF                                                     43110000
431200     END-IF.                                                      43120000
431300                                                                  43130000
431400 Z400-RETURN-TO-PREV-TRAN.                                        43140000
431500******************************************************************43150000
431600*                                                                 43160000
431700******************************************************************43170000
431800     MOVE DP016-PF3 TO DP020-SRC-AID.                             43180000
431900     PERFORM DP015-1000-START-NAVIGATOR.                          43190000
432000                                                                  43200000
432100 Z500-BUILD-TEMP-Q.                                               43210000
432200******************************************************************43220000
432300*                                                                 43230000
432400******************************************************************43240000
432500                                                                  43250000
432600     MOVE EIBTASKN           TO DP020-SRC-TASK-NUMBER             43260000
432700                                ASC-TASK-ID.                      43270000
432800     MOVE EIBTRMID           TO ASC-TERM-ID.                      43280000
432900     MOVE PC-COMPANY-NUMBER  TO MB104-CO-NUMBER.                  43290000
433000     MOVE ASC-SCRN-GMA-NO    TO MB104-GMA-NUMBER.                 43300000
433100     MOVE ASC-GMA-DESC       TO MB104-GMA-DESCRIP.                43310000
433200     MOVE ASC-SCRN-DMA-NO    TO MB104-DMA-NUMBER.                 43320000
433300     MOVE ASC-DMA-DESC       TO MB104-DMA-DESCRIP.                43330000
433400     MOVE ASC-SCRN-DPT-NO    TO MB104-DEPT-NUMBER.                43340000
433500     MOVE ASC-DPT-DESC       TO MB104-DEPT-DESCRIP.               43350000
433600     MOVE ASC-SCRN-MCL-NO    TO MB104-MCLASS-NUMBER.              43360000
433700     MOVE ASC-MCL-DESC       TO MB104-MCLASS-DESCRIP.             43370000
433800     MOVE ASC-SCRN-SCL-NO    TO MB104-SCLASS-NUMBER.              43380000
433900     MOVE ASC-SCL-DESC       TO MB104-SCLASS-DESCRIP.             43390000
434000     MOVE ASC-ADD-MDSE-LEVEL TO MB104-MDSE-LEVEL.                 43400000
434100     MOVE ASC-SCRN-STRT-YYYYMMDD TO MB104-START-DATE.             43410000
434200     IF ASC-SCRN-END-DTE-X = SPACES                               43420000
434300        MOVE PC-INFINITY-DATE TO ASC-SCRN-END-YYYYMMDD            43430000
434400     END-IF.                                                      43440000
434500     MOVE ASC-SCRN-END-YYYYMMDD  TO MB104-END-DATE.               43450000
434600     MOVE ASC-SCRN-GEN-MDSETYP TO MB104-MERCH-TYPE.               43460000
434700     MOVE ASC-SCRN-BYR-NBR   TO MB104-BUYER-NUMBER.               43470000
434800     MOVE ASC-PARENT-MDSEAR-DKEY TO MB104-PARENT-MDSEAR-DKEY.     43480000
434900     MOVE ZERO               TO  MB104-FREIGHT-PERCENT.           43490000
435000     PERFORM Z600-WRITE-TSQ.                                      43500000
435100                                                                  43510000
435200 Z600-WRITE-TSQ.                                                  43520000
435300******************************************************************43530000
435400*                                                                 43540000
435500******************************************************************43550000
435600                                                                  43560000
435700     EXEC CICS                                                    43570000
435800         WRITEQ TS                                                43580000
435900         QUEUE(ASC-TEMP-QUEUE-NAME)                               43590000
436000         FROM(MB104-MDSEAR-ADD-TSQUEUE)                           43600000
436100         LENGTH(PC-TSQ-LENGTH)                                    43610000
436200         ITEM(PV-ITEM-NBR)                                        43620000
436300         RESP(PV-CICS-RESPONSE)                                   43630000
436400     END-EXEC.                                                    43640000
436500     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    43650000
436600        SET DP013-LOGIC-ABEND TO TRUE                             43660000
436700        SET DP013-NO-ROLLBACK TO TRUE                             43670000
436800        MOVE 'Z600-WRITE-TSQ' TO DP013-PARAGRAPH                  43680000
436900        MOVE 'RESPONSE CODE = ' TO DP013-MESSAGE-TEXT(1)          43690000
437000        MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT(2)            43700000
437100        PERFORM DP013-0000-PROCESS-ABEND                          43710000
437200     END-IF.                                                      43720000
437300                                                                  43730000
437400 Z700-NAVIGATE.                                                   43740000
437500******************************************************************43750000
437600*                                                                 43760000
437700******************************************************************43770000
437800******************************************************************43780000
437900*    FILL IN SCREEN HEADER MODULE                                 43790000
438000******************************************************************43800000
438100                                                                  43810000
438200     COPY DPPD002.                                                43820000
438300 EJECT                                                            43830000
438400******************************************************************43840000
438500*    RETURN TO CICS MODULE                                        43850000
438600******************************************************************43860000
438700                                                                  43870000
438800     COPY DPPD003.                                                43880000
438900 EJECT                                                            43890000
439000******************************************************************43900000
439100*    FORMAT MESSAGE LINES MODULE                                  43910000
439200******************************************************************43920000
439300                                                                  43930000
439400     COPY DPPD005.                                                43940000
439500 EJECT                                                            43950000
439600******************************************************************43960000
439700*    GET PANEL MODULE                                             43970000
439800******************************************************************43980000
439900                                                                  43990000
440000     COPY DPPD007.                                                44000000
440100 EJECT                                                            44010000
440200******************************************************************44020000
440300*    WRITE PANEL MODULE                                           44030000
440400******************************************************************44040000
440500                                                                  44050000
440600     COPY DPPD008.                                                44060000
440700 EJECT                                                            44070000
440800******************************************************************44080000
440900*    TOGGLE THE FUNCTION KEY LINE MODULE                          44090000
441000******************************************************************44100000
441100                                                                  44110000
441200     COPY DPPD009.                                                44120000
441300 EJECT                                                            44130000
441400******************************************************************44140000
441500*    ABEND PROCESSOR MODULE                                       44150000
441600******************************************************************44160000
441700                                                                  44170000
441800     COPY DPPD013.                                                44180000
441900 EJECT                                                            44190000
442000******************************************************************44200000
442100*    CHECK COMMUNICATION AREA MODULE                              44210000
442200******************************************************************44220000
442300                                                                  44230000
442400     COPY DPPD015.                                                44240000
442500 EJECT                                                            44250000
442600******************************************************************44260000
442700*    UPDATE TIME AND DATE MODULE                                  44270000
442800******************************************************************44280000
442900                                                                  44290000
443000     COPY DPPD017.                                                44300000
443100 EJECT                                                            44310000
