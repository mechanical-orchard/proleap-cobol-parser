000100***************************************************************** 00010082
000200 IDENTIFICATION DIVISION.                                         00020082
000300***************************************************************** 00030082
000400                                                                  00040082
000500 PROGRAM-ID.             SUKRP008.                                00050082
000600 AUTHOR.                 MARY SARDINA                             00060082
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070082
000800 DATE-WRITTEN            JULY, 1996.                              00080082
000900 DATE-COMPILED.                                                   00090082
001000***************************************************************** 00100082
001100***************************************************************** 00110082
001200*                                                               * 00120082
001300*  THIS PROGRAM WILL PRINT THE DUPLICATE SCAN REPORT            * 00130082
001400*  THIS IS PRODUCED FOLLOWING THE CHECK-IN OF A TRAILER         * 00140082
001500*  WHICH HAS HAD THE CARTONS SCANNED USING THE LRT TERMINAL.    * 00150082
001600***************************************************************** 00160082
001700*  CHANGED 10/24/02 BY ALBERT A VINOD                           * 00170082
001800*   WR# 21361 REMOVED GROUP VARIABLE PV-SKU                     * 00180082
001600***************************************************************** 00181087
001700*  CHANGED 09/30/14 BY CHERI PARMLEY                            * 00182087
001800*   CHG#0094517  EXPAND PO# FROM 7 TO 8 DIGITS                  * 00183088
001900***************************************************************** 00190082
002000*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00200082
002100*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00210082
002200*                                                               * 00220082
002300***************************************************************** 00230082
002400***************************************************************** 00240082
002500 ENVIRONMENT DIVISION.                                            00250082
002600***************************************************************** 00260082
002700                                                                  00270082
002800 CONFIGURATION SECTION.                                           00280082
002900                                                                  00290082
003000 SOURCE-COMPUTER.        IBM-3090.                                00300082
003100 OBJECT-COMPUTER.        IBM-3090.                                00310082
003200                                                                  00320082
003300 INPUT-OUTPUT SECTION.                                            00330082
003400                                                                  00340082
003500 FILE-CONTROL.                                                    00350082
003600*                                                                 00360082
003700     SELECT EXTRACT-FILE                                          00370082
003800         ASSIGN TO INP01.                                         00380082
003900                                                                  00390082
004000     SELECT SU-CARTON-NOT-RCVD-FILE                               00400082
004100         ASSIGN TO RPT01.                                         00410082
004200*                                                                 00420082
004300***************************************************************** 00430082
004400 DATA DIVISION.                                                   00440082
004500***************************************************************** 00450082
004600*                                                                 00460082
004700 FILE SECTION.                                                    00470082
004800*                                                                 00480082
004900 FD  EXTRACT-FILE                                                 00490082
005000     LABEL RECORDS ARE STANDARD                                   00500082
005100     RECORDING MODE IS F                                          00510082
005200     BLOCK CONTAINS 0 RECORDS                                     00520082
005300     RECORD CONTAINS 200 CHARACTERS.                              00530082
005400 01  EXTRACT-RECORD                  PIC X(200).                  00540082
005500                                                                  00550082
005600 FD  SU-CARTON-NOT-RCVD-FILE                                      00560082
005700     RECORDING MODE IS F                                          00570082
005800     BLOCK CONTAINS 0  RECORDS.                                   00580082
005900 01  SU-CARTON-NOT-RCVD-RECORD       PIC  X(132).                 00590082
006000*                                                                 00600082
006100                                                                  00610082
006200 WORKING-STORAGE SECTION.                                         00620082
006300**************************************************************    00630082
006400* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00640082
006500**************************************************************    00650082
006600 01  CC-CONTROL-CARD.                                             00660082
006700     05  CC-PRINTER-ID                PIC  X(08).                 00670082
006800     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00680082
006900     05  CC-TRACK-NBR                 PIC  9(01).                 00690082
007000     05  FILLER                       PIC  X(01).                 00700082
007100     05  CC-CUT-REPORT                PIC  X(01).                 00710082
007200         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00720082
007300     05  CC-REQUESTOR-ID              PIC  X(08).                 00730082
007400     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00740082
007500         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00750082
007600     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00760082
007700         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00770082
007800     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00780082
007900         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00790082
008000     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 00800082
008100         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     00810082
008200     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 00820082
008300         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     00830082
008400     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 00840082
008500         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     00850082
008600     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 00860082
008700         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     00870082
008800*JPL                                                              00880082
008900     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 00890082
009000         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     00900082
009100     05  FILLER                       PIC  X(01).                 00910082
009200     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 00920082
009300         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     00930082
009400         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     00940082
009500*                                                                 00950082
009600 01  PROGRAM-SWITCHES.                                            00960082
009700     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00970082
009800         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00980082
009900     05  PS-END-OF-DUP-CSR-SW        PIC  X(01)    VALUE 'N'.     00990082
010000         88  PS-END-OF-DUP-CSR                     VALUE 'Y'.     01000082
010100         88  PS-START-OF-DUP-CSR                   VALUE 'N'.     01010082
010200     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01020082
010300         88  PS-STATUS-FOUND                       VALUE 'Y'.     01030082
010400         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01040082
010500     05  PS-PO-FOUND-SW              PIC  X(01)    VALUE 'N'.     01050082
010600         88  PS-PO-ROW-FOUND                       VALUE 'Y'.     01060082
010700         88  PS-PO-ROW-NOT-FOUND                   VALUE 'N'.     01070082
010800     05  PS-FIRST-LINE-SW            PIC  X(01)    VALUE 'Y'.     01080082
010900         88  PS-FIRST-LINE                         VALUE 'Y'.     01090082
011000         88  PS-NOT-FIRST-LINE                     VALUE 'N'.     01100082
011100     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01110082
011200         88  PS-ERROR-RECORD                       VALUE 'A'.     01120082
011300         88  PS-DETAIL-RECORD                      VALUE 'B'.     01130082
011400*LMM                                                              01140082
011500 01  DN-DB2-NULL-INDICATORS.                                      01150082
011600     05  DN-VEH-NBR                  PIC S9(04) COMP VALUE +0.    01160082
011700*                                                                 01170082
011800 01  PC-CONSTANTS.                                                01180082
011900     05  PC-1                        PIC S9(03)    VALUE +1       01190082
012000                                                   COMP-3.        01200082
012100     05  PC-2                        PIC S9(03)    VALUE +2       01210082
012200                                                   COMP-3.        01220082
012300     05  PC-3                        PIC S9(03)    VALUE +3       01230082
012400                                                   COMP-3.        01240082
012500     05  PC-7                        PIC S9(01)    VALUE +7.      01250082
012600     05  PC-12                       PIC S9(03)    VALUE +12      01260082
012700                                                   COMP-3.        01270082
012800     05  PC-60                       PIC S9(03)    VALUE +60      01280082
012900                                                   COMP-3.        01290082
013000     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01300082
013100     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01310082
013200     05  PC-00                       PIC  X(02)    VALUE '00'.    01320082
013300     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01330082
013400     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01340082
013500     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01350082
013600     05  PC-A                        PIC  X(01)    VALUE 'A'.     01360082
013700     05  PC-SUKRP008                 PIC  X(08)    VALUE          01370082
013800         'SUKRP008'.                                              01380082
013900     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01390082
014000*                                                                 01400082
014100 01  PV-MISC-FIELDS.                                              01410082
014200     05  PV-LINE-SUB                 PIC S9(03)    VALUE +0       01420082
014300                                                   COMP-3.        01430082
014400     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01440082
014500                                                   COMP-3.        01450082
014600     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01460082
014700                                                   COMP-3.        01470082
014800     05  PV-DB2-COUNT                PIC S9(04)    VALUE ZERO     01480082
014900                                                   COMP SYNC.     01490082
015000     05  PV-STATUS                   PIC  X(02).                  01500082
      *CLP 09/30/14                                                     01501087
015100     05  PV-SAVE-PO-RECEIVER         PIC  X(12).                  01510087
015200     05  PV-SAVE-SHIP-CODE           PIC  X(20).                  01520082
015300     05  SAVE-SHIPT-UNT-ID           PIC S9(18) COMP-3.           01530082
015400     05  PV-TRIP-ID-X                PIC  X(09).                  01540082
015500     05  PV-TRIP-ID REDEFINES PV-TRIP-ID-X                        01550082
015600                                     PIC  9(09).                  01560082
015700     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01570082
015800                                                   COMP SYNC.     01580082
015900     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01590082
016000     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    01600082
016100******************************************************************01610082
016200*  REMOVED GROUP VARIABLE PV-SKU                      WR # 21361 *01620082
016300******************************************************************01630082
017000******************************************************************01640082
017100*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *01650084
017200******************************************************************01660082
017300     05  PV-PO-RECEIVER.                                          01670082
      *CLP 09/30/14                                                     01671087
017400         10  PV-PO                   PIC  ZZZZZZZ9  VALUE ZERO.   01680087
017500         10  FILLER                  PIC  X(01)    VALUE '-'.     01690082
017600         10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    01700082
017700     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  01710082
017800     05  PV-TODAYS-DATE.                                          01720082
017900         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01730082
018000         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01740082
018100         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01750082
018200     05  PV-TODAYS-TIME.                                          01760082
018300         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01770082
018400         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01780082
018500         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01790082
018600         10  FILLER                  PIC  9(02)    VALUE ZERO.    01800082
018700     05  PV-DB2-DATE.                                             01810082
018800         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    01820082
018900         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    01830082
019000         10  FILLER                  PIC  X(01)    VALUE ZERO.    01840082
019100         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    01850082
019200         10  FILLER                  PIC  X(01)    VALUE ZERO.    01860082
019300         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    01870082
019400     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 01880082
019500     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    01890082
019600         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 01900082
019700         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 01910082
019800         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 01920082
019900         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 01930082
020000     05  PV-OUT-SERIAL-SHIP-CODE.                                 01940082
020100         10  FILLER                   PIC  X(05)    VALUE '(00) '.01950082
020200         10  PV-OUT-S-S-C-1           PIC  X(01).                 01960082
020300         10  FILLER                   PIC  X(01) VALUE SPACES.    01970082
020400         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 01980082
020500         10  FILLER                   PIC  X(01) VALUE SPACES.    01990082
020600         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02000082
020700         10  FILLER                   PIC  X(01) VALUE SPACES.    02010082
020800         10  PV-OUT-S-S-C-18          PIC  X(01).                 02020082
020900     05  PV-DB2-TMST.                                             02030082
021000         10 FILLER                    PIC  X(02).                 02040082
021100         10 PV-DB2-TMST-YY            PIC  9(02).                 02050082
021200         10 FILLER                    PIC  X(01).                 02060082
021300         10 PV-DB2-TMST-MM            PIC  9(02).                 02070082
021400         10 FILLER                    PIC  X(01).                 02080082
021500         10 PV-DB2-TMST-DD            PIC  9(02).                 02090082
021600         10 FILLER                    PIC  X(01).                 02100082
021700         10 PV-DB2-TMST-HH            PIC  9(02).                 02110082
021800         10 FILLER                    PIC  X(01).                 02120082
021900         10 PV-DB2-TMST-MN            PIC  9(02).                 02130082
022000         10 FILLER                    PIC  X(01).                 02140082
022100         10 PV-DB2-TMST-SS            PIC  9(02).                 02150082
022200         10 FILLER                    PIC  X(07).                 02160082
022300     05  PV-FORMAT-DATE.                                          02170082
022400         10 PV-FORMAT-DATE-MM         PIC  9(02).                 02180082
022500         10 FILLER                    PIC  X(01) VALUE '/'.       02190082
022600         10 PV-FORMAT-DATE-DD         PIC  9(02).                 02200082
022700         10 FILLER                    PIC  X(01) VALUE '/'.       02210082
022800         10 PV-FORMAT-DATE-YY         PIC  9(02).                 02220082
022900     05  PV-FORMAT-TIME.                                          02230082
023000         10 PV-FORMAT-TIME-HH         PIC  9(02).                 02240082
023100         10 FILLER                    PIC  X(01) VALUE ':'.       02250082
023200         10 PV-FORMAT-TIME-MN         PIC  9(02).                 02260082
023300         10 FILLER                    PIC  X(01) VALUE ':'.       02270082
023400         10 PV-FORMAT-TIME-SS         PIC  9(02).                 02280082
      *CLP 09/30/14                                                     02281087
023500     05  PV-SAVE-PO                   PIC  ZZZZZZZ9  VALUE ZERO.  02290087
023600     05  PV-SAVE-STR                  PIC  ZZZZ    VALUE ZERO.    02300085
023700     05  PV-SAVE-VENDOR-ID            PIC  X(09)   VALUE SPACES.  02310082
023800     05  PV-SAVE-VENDOR-NAME          PIC  X(30)   VALUE SPACES.  02320082
023900     05  PV-SAVE-SERIAL-SHIP-CODE     PIC  X(26)   VALUE SPACES.  02330082
024000*                                                                 02340082
024100     COPY DPWS024.                                                02350085
024200*                                                                 02360082
024300     COPY SURD001.                                                02370085
024400*                                                                 02380082
024500******************************************************************02390082
024600*  COPY BOOK OF PRINTER COMMANDS FOR PRINTEK PRINTER.S            02400082
024700******************************************************************02410082
024800     COPY DSWS004.                                                02420085
024900 EJECT                                                            02430082
025000*                                                                 02440082
025100******************************************************************02450082
025200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02460082
025300******************************************************************02470082
025400     COPY DPWS132O.                                               02480085
025500*                                                                 02490082
025600*                                                                 02500082
025700 01  HEADING-LINES.                                               02510082
025800     05  HEADING-LINE-0.                                          02520082
025900         10  FILLER                  PIC  X(50)    VALUE SPACES.  02530082
026000         10  FILLER                  PIC  X(32)    VALUE          02540082
026100             'CHECK-IN COMPLETION - EXCEPTIONS'.                  02550082
026200         10  FILLER                  PIC  X(50)    VALUE SPACES.  02560082
026300*                                                                 02570082
026400     05  HEADING-LINE-1.                                          02580082
026500         10  FILLER                  PIC  X(05)    VALUE SPACES.  02590082
026600         10  FILLER                  PIC  X(40)    VALUE          02600082
026700             '****************************************'.          02610082
026800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02620082
026900         10  FILLER                  PIC  X(40)    VALUE          02630082
027000             'CARTONS SCANNED AND NO INFORMATION FOUND'.          02640082
027100         10  FILLER                  PIC  X(46)    VALUE SPACES.  02650082
027200*                                                                 02660082
027300     05  HEADING-LINE-1A.                                         02670082
027400         10  FILLER                  PIC  X(05)    VALUE SPACES.  02680082
027500         10  FILLER                  PIC  X(03)    VALUE '*  '.   02690082
027600         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  02700082
027700         10  FILLER                  PIC  X(01)    VALUE '*'.     02710082
027800         10  FILLER                  PIC  X(87)    VALUE SPACES.  02720082
027900*                                                                 02730082
028000     05  HEADING-LINE-1B.                                         02740082
028100         10  FILLER                  PIC  X(05)    VALUE SPACES.  02750082
028200         10  FILLER                  PIC  X(40)    VALUE          02760082
028300             '****************************************'.          02770082
028400         10  FILLER                  PIC  X(87)    VALUE SPACES.  02780082
028500*                                                                 02790082
028600     05  HEADING-LINE-2.                                          02800082
028700         10  FILLER                  PIC  X(02)    VALUE SPACE.   02810082
028800         10  FILLER                  PIC  X(09)    VALUE          02820082
028900             'CARRIER: '.                                         02830082
029000         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  02840082
029100         10  FILLER                  PIC  X(03)    VALUE SPACE.   02850082
029200         10  FILLER                  PIC  X(09)    VALUE          02860082
029300             'TRAILER: '.                                         02870082
029400         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  02880082
029500         10  FILLER                  PIC  X(04)    VALUE SPACE.   02890082
029600         10  FILLER                  PIC  X(09)    VALUE          02900082
029700             'TRIP ID: '.                                         02910082
029800         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  02920082
029900         10  FILLER                  PIC  X(16)    VALUE SPACE.   02930082
030000         10  FILLER                  PIC  X(16)    VALUE          02940082
030100             'TRAILER STATUS: '.                                  02950082
030200         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  02960082
030300         10  FILLER                  PIC  X(38)    VALUE SPACES.  02970082
030400*                                                                 02980082
030500     05  HEADING-LINE-3.                                          02990082
030600         10  FILLER                  PIC  X(02)    VALUE SPACES.  03000082
030700         10  FILLER                  PIC  X(16)    VALUE          03010082
030800             'ARRIVAL DATE:   '.                                  03020082
030900         10  HL3-ARRIVAL-DATE.                                    03030082
031000             15  HL3-ARRIVAL-DATE-MM                              03040082
031100                                     PIC  X(02)    VALUE SPACES.  03050082
031200             15  FILLER              PIC  X(01)    VALUE '/'.     03060082
031300             15  HL3-ARRIVAL-DATE-DD                              03070082
031400                                     PIC  X(02)    VALUE SPACES.  03080082
031500             15  FILLER              PIC  X(01)    VALUE '/'.     03090082
031600             15  HL3-ARRIVAL-DATE-CC                              03100082
031700                                     PIC  X(02)    VALUE SPACES.  03110082
031800             15  HL3-ARRIVAL-DATE-YY                              03120082
031900                                     PIC  X(02)    VALUE SPACES.  03130082
032000         10  FILLER                  PIC  X(13)    VALUE SPACES.  03140082
032100         10  FILLER                  PIC  X(23)    VALUE          03150082
032200             'BEGIN UNLOADING DATE:  '.                           03160082
032300         10  HL3-BEG-UNLOAD-DATE.                                 03170082
032400             15  HL3-BEG-UNLOAD-DATE-MM                           03180082
032500                                     PIC  X(02)    VALUE SPACES.  03190082
032600             15  FILLER              PIC  X(01)    VALUE '/'.     03200082
032700             15  HL3-BEG-UNLOAD-DATE-DD                           03210082
032800                                     PIC  X(02)    VALUE SPACES.  03220082
032900             15  FILLER              PIC  X(01)    VALUE '/'.     03230082
033000             15  HL3-BEG-UNLOAD-DATE-CC                           03240082
033100                                     PIC  X(02)    VALUE SPACES.  03250082
033200             15  HL3-BEG-UNLOAD-DATE-YY                           03260082
033300                                     PIC  X(02)    VALUE SPACES.  03270082
033400         10  FILLER                  PIC  X(03)    VALUE SPACES.  03280082
033500         10  FILLER                  PIC  X(15)    VALUE          03290082
033600             'UNLOADED DATE: '.                                   03300082
033700         10  HL3-UNLOADED-DATE.                                   03310082
033800             15  HL3-UNLOADED-DATE-MM                             03320082
033900                                     PIC  X(02)    VALUE SPACES.  03330082
034000             15  FILLER              PIC  X(01)    VALUE '/'.     03340082
034100             15  HL3-UNLOADED-DATE-DD                             03350082
034200                                     PIC  X(02)    VALUE SPACES.  03360082
034300             15  FILLER              PIC  X(01)    VALUE '/'.     03370082
034400             15  HL3-UNLOADED-DATE-CC                             03380082
034500                                     PIC  X(02)    VALUE SPACES.  03390082
034600             15  HL3-UNLOADED-DATE-YY                             03400082
034700                                     PIC  X(02)    VALUE SPACES.  03410082
034800         10  FILLER                  PIC  X(31)    VALUE SPACES.  03420082
034900*                                                                 03430082
035000*    05  HEADING-LINE-4.                                          03440082
035100*        10  FILLER                  PIC  X(71)    VALUE SPACES.  03450082
035200*        10  FILLER                  PIC  X(13)    VALUE          03460082
035300*            '------------ '.                                     03470082
035400*        10  FILLER                  PIC  X(26)    VALUE          03480082
035500*            'SCAN CHECK-IN INFORMATION '.                        03490082
035600*        10  FILLER                  PIC  X(12)    VALUE          03500082
035700*            '------------'.                                      03510082
035800*                                                                 03520082
035900     05  HEADING-LINE-5.                                          03530082
036000         10  FILLER                  PIC  X(12)    VALUE SPACES.  03540082
036100         10  FILLER                  PIC  X(03)    VALUE          03550082
036200             'STR'.                                               03560082
036300         10  FILLER                  PIC  X(117)   VALUE SPACES.  03570082
036400*                                                                 03580082
036500     05  HEADING-LINE-6.                                          03590082
036600         10  FILLER                  PIC  X(02)    VALUE SPACES.  03600082
036700         10  FILLER                  PIC  X(02)    VALUE          03610082
036800             'PO'.                                                03620082
036900         10  FILLER                  PIC  X(08)    VALUE SPACES.  03630082
037000         10  FILLER                  PIC  X(03)    VALUE          03640082
037100             'NBR'.                                               03650082
037200         10  FILLER                  PIC  X(03)    VALUE SPACES.  03660082
037300         10  FILLER                  PIC  X(16)    VALUE          03670082
037400             'SERIAL SHIP CODE'.                                  03680082
037500         10  FILLER                  PIC  X(13)    VALUE SPACES.  03690082
037600         10  FILLER                  PIC  X(09)    VALUE          03700082
037700             'VENDOR ID'.                                         03710082
037800         10  FILLER                  PIC  X(03)    VALUE SPACES.  03720082
037900         10  FILLER                  PIC  X(11)    VALUE          03730082
038000             'VENDOR NAME'.                                       03740082
038100         10  FILLER                  PIC  X(65)    VALUE SPACES.  03750082
038200*                                                                 03760082
038300*                                                                 03770082
038400 01  MISCELLANEOUS-LINES.                                         03780082
038500     05  END-OF-REPORT-LINE.                                      03790082
038600         10  FILLER                  PIC  X(44)    VALUE SPACES.  03800082
038700         10  FILLER                  PIC  X(45)    VALUE          03810082
038800             '*******   E N D   O F   R E P O R T   *******'.     03820082
038900         10  FILLER                  PIC  X(43)    VALUE SPACES.  03830082
039000*                                                                 03840082
039100 01  DETAIL-LINES.                                                03850082
039200     05  DETAIL-LINE1.                                            03860082
039300         10  FILLER                  PIC  X(01)    VALUE SPACES.  03870082
039400         10  DL1-PO                  PIC  X(08)    VALUE SPACES.  03880082
039500         10  FILLER                  PIC  X(03)    VALUE SPACES.  03890082
039600         10  DL1-STORE               PIC  ZZZZ     VALUE ZERO.    03900085
039700         10  FILLER                  PIC  X(02)    VALUE SPACES.  03910085
039800         10  DL1-SERIAL-SHIP-CODE    PIC  X(26)    VALUE SPACES.  03920082
039900         10  FILLER                  PIC  X(03)    VALUE SPACES.  03930082
040000         10  DL1-VENDOR-ID           PIC  X(09)    VALUE SPACES.  03940082
040100         10  FILLER                  PIC  X(03)    VALUE SPACES.  03950082
040200         10  DL1-VENDOR-NAME         PIC  X(30)    VALUE SPACES.  03960082
040300         10  FILLER                  PIC  X(46)    VALUE SPACES.  03970082
040400                                                                  03980082
040500 01  EL1-ERROR-LINE-1F.                                           03990082
040600     05  FILLER                      PIC  X(02)     VALUE SPACES. 04000082
040700     05  FILLER                      PIC  X(48)     VALUE         04010082
040800         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04020082
040900     05  FILLER                      PIC  X(49)     VALUE         04030082
041000         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     04040082
041100     05  FILLER                      PIC  X(33)     VALUE         04050082
041200         ' COMPLETED.                      '.                     04060082
041300                                                                  04070082
041400 01  EL1-ERROR-LINE-1P.                                           04080082
041500     05  FILLER                      PIC  X(02)     VALUE SPACES. 04090082
041600     05  FILLER                      PIC  X(48)     VALUE         04100082
041700         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04110082
041800     05  FILLER                      PIC  X(49)     VALUE         04120082
041900         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     04130082
042000     05  FILLER                      PIC  X(33)     VALUE         04140082
042100         'COMPLETED.                       '.                     04150082
042200                                                                  04160082
042300 01  EL2-ERROR-LINE-2F.                                           04170082
042400     05  FILLER                      PIC  X(02)     VALUE SPACES. 04180082
042500     05  FILLER                      PIC  X(36)     VALUE         04190082
042600         'NONE OF YOUR REPORTS WERE CREATED.  '.                  04200082
042700     05  FILLER                      PIC  X(36)     VALUE         04210082
042800         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  04220082
042900     05  FILLER                      PIC  X(58)     VALUE SPACES. 04230082
043000                                                                  04240082
043100 01  EL2-ERROR-LINE-2P.                                           04250082
043200     05  FILLER                      PIC  X(02)     VALUE SPACES. 04260082
043300     05  FILLER                      PIC  X(49)     VALUE         04270082
043400         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     04280082
043500     05  FILLER                      PIC  X(41)     VALUE         04290082
043600         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             04300082
043700     05  FILLER                      PIC  X(40)     VALUE         04310082
043800         'DETERMINE IF THEY NEED TO BE CREATED).  '.              04320082
043900                                                                  04330082
044000 01  EL3-ERROR-LINE-3.                                            04340082
044100     05  FILLER                      PIC  X(02)     VALUE SPACES. 04350082
044200     05  FILLER                      PIC  X(50)     VALUE         04360082
044300         'YOUR REQUEST WAS AS FOLLOWS:                      '.    04370082
044400     05  FILLER                      PIC  X(81)     VALUE SPACES. 04380082
044500                                                                  04390082
044600 01  EL4-ERROR-LINE-4.                                            04400082
044700     05  FILLER                      PIC  X(07)     VALUE SPACES. 04410082
044800     05  FILLER                      PIC  X(12)     VALUE         04420082
044900         'REQUESTOR:  '.                                          04430082
045000     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 04440082
045100     05  FILLER                      PIC  X(10)     VALUE SPACES. 04450082
045200     05  FILLER                      PIC  X(22)     VALUE         04460082
045300         'PRINTER DESTINATION:  '.                                04470082
045400     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 04480082
045500     05  FILLER                      PIC  X(65)     VALUE SPACES. 04490082
045600                                                                  04500082
045700 01  EL5-ERROR-LINE-5.                                            04510082
045800     05  FILLER                      PIC  X(07)     VALUE SPACES. 04520082
045900     05  FILLER                      PIC  X(20)     VALUE         04530082
046000         'REQUESTED REPORTS:  '.                                  04540082
046100*JPL                                                              04550082
046200     05  FILLER                      PIC  X(105)    VALUE SPACES. 04560082
046300*JPL 05  FILLER                      PIC  X(08)     VALUE         04570082
046400*JPL     'STATS   '.                                              04580082
046500*JPL 05  FILLER                      PIC  X(18)     VALUE         04590082
046600*JPL     'PO/STR WRKSHEET   '.                                    04600082
046700*JPL 05  FILLER                      PIC  X(17)     VALUE         04610082
046800*JPL     'CRTNS NOT RCVD   '.                                     04620082
046900*JPL 05  FILLER                      PIC  X(14)     VALUE         04630082
047000*JPL     'FREE ASTRAY   '.                                        04640082
047100*JPL 05  FILLER                      PIC  X(12)     VALUE         04650082
047200*JPL     'MISDIRECT   '.                                          04660082
047300*JPL 05  FILLER                      PIC  X(17)     VALUE         04670082
047400*JPL     'DUPLICATE SCAN   '.                                     04680082
047500*JPL 05  FILLER                      PIC  X(14)     VALUE         04690082
047600*JPL     'SCAN NOT FOUND'.                                        04700082
047700*JPL 05  FILLER                      PIC  X(05)     VALUE SPACES. 04710082
047800                                                                  04720082
047900 01  EL5-ERROR-LINE-5B.                                           04730082
048000     05  FILLER                      PIC  X(07)     VALUE SPACES. 04740082
048100     05  FILLER                      PIC  X(04)     VALUE SPACES. 04750082
048200     05  FILLER                      PIC  X(08)     VALUE         04760082
048300         'STATS   '.                                              04770082
048400     05  FILLER                      PIC  X(18)     VALUE         04780082
048500         'PO/STR UNT ADJ    '.                                    04790082
048600     05  FILLER                      PIC  X(17)     VALUE         04800082
048700         'CRTNS NOT RCVD   '.                                     04810082
048800     05  FILLER                      PIC  X(14)     VALUE         04820082
048900         'FREE ASTRAY   '.                                        04830082
049000     05  FILLER                      PIC  X(12)     VALUE         04840082
049100         'MISDIRECT   '.                                          04850082
049200     05  FILLER                      PIC  X(17)     VALUE         04860082
049300         'DUPLICATE SCAN   '.                                     04870082
049400     05  FILLER                      PIC  X(18)     VALUE         04880082
049500         'SCAN NOT FOUND    '.                                    04890082
049600     05  FILLER                      PIC  X(17)     VALUE         04900082
049700         'UNUSED LABELS    '.                                     04910082
049800*JPL                                                              04920082
049900*01  EL6-ERROR-LINE-6.                                            04930082
050000*    05  FILLER                      PIC  X(29)     VALUE SPACES. 04940082
050100*    05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 04950082
050200*    05  FILLER                      PIC  X(12)     VALUE SPACES. 04960082
050300*    05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 04970082
050400*    05  FILLER                      PIC  X(16)     VALUE SPACES. 04980082
050500*    05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 04990082
050600*    05  FILLER                      PIC  X(15)     VALUE SPACES. 05000082
050700*    05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05010082
050800*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05020082
050900*    05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05030082
051000*    05  FILLER                      PIC  X(13)     VALUE SPACES. 05040082
051100*    05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05050082
051200*    05  FILLER                      PIC  X(16)     VALUE SPACES. 05060082
051300*    05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05070082
051400*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05080082
051500                                                                  05090082
051600 01  EL6-ERROR-LINE-6B.                                           05100082
051700     05  FILLER                      PIC  X(13)     VALUE SPACES. 05110082
051800     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05120082
051900     05  FILLER                      PIC  X(12)     VALUE SPACES. 05130082
052000     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 05140082
052100     05  FILLER                      PIC  X(16)     VALUE SPACES. 05150082
052200     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 05160082
052300     05  FILLER                      PIC  X(15)     VALUE SPACES. 05170082
052400     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 05180082
052500     05  FILLER                      PIC  X(12)     VALUE SPACES. 05190082
052600     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 05200082
052700     05  FILLER                      PIC  X(13)     VALUE SPACES. 05210082
052800     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 05220082
052900     05  FILLER                      PIC  X(16)     VALUE SPACES. 05230082
053000     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 05240082
053100     05  FILLER                      PIC  X(17)     VALUE SPACES. 05250082
053200*JPL                                                              05260082
053300     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 05270082
053400     05  FILLER                      PIC  X(10)     VALUE SPACES. 05280082
053500                                                                  05290082
053600*                                                                 05300082
053700*  COPY BOOK FOR SHIPMENT UNIT TABLE                              05310082
053800*                                                                 05320082
053900     EXEC SQL                                                     05330082
054000          INCLUDE TSHPUNT                                         05340082
054100     END-EXEC.                                                    05350082
054200*                                                                 05360082
054300*  COPY BOOK FOR SHIPMENT UNIT LOCATION TABLE                     05370082
054400*                                                                 05380082
054500     EXEC SQL                                                     05390082
054600          INCLUDE TSHUNLO                                         05400082
054700     END-EXEC.                                                    05410082
054800*                                                                 05420082
054900*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    05430082
055000*                                                                 05440082
055100     EXEC SQL                                                     05450082
055200          INCLUDE TSHUUPC                                         05460082
055300     END-EXEC.                                                    05470082
055400*                                                                 05480082
055500*  COPY BOOK FOR PURCHASE ORDER HEADER TABLE                      05490082
055600*                                                                 05500082
055700     EXEC SQL                                                     05510082
055800          INCLUDE TPURCHS                                         05520082
055900     END-EXEC.                                                    05530082
056000*                                                                 05540082
056100*  COPY BOOK FOR THE EXTERNAL ENTERPRISE TABLE                    05550082
056200*                                                                 05560082
056300     EXEC SQL                                                     05570082
056400          INCLUDE TEXTENT                                         05580082
056500     END-EXEC.                                                    05590082
056600*                                                                 05600082
056700*  COPY BOOK FOR THE EXTERNAL ENTERPRISE NAME TABLE               05610082
056800*                                                                 05620082
056900     EXEC SQL                                                     05630082
057000          INCLUDE TENTNME                                         05640082
057100     END-EXEC.                                                    05650082
057200*                                                                 05660082
057300*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           05670082
057400*                                                                 05680082
057500     EXEC SQL                                                     05690082
057600          INCLUDE TVHTRIP                                         05700082
057700     END-EXEC.                                                    05710082
057800*                                                                 05720082
057900*  COPY BOOK FOR THE TRIP STATUS TABLE                            05730082
058000*                                                                 05740082
058100     EXEC SQL                                                     05750082
058200          INCLUDE TTRIPST                                         05760082
058300     END-EXEC.                                                    05770082
058400*                                                                 05780082
058500*  COPY BOOK FOR THE TRIP STATUS TYPE TABLE                       05790082
058600*                                                                 05800082
058700     EXEC SQL                                                     05810082
058800          INCLUDE TTRSTYP                                         05820082
058900     END-EXEC.                                                    05830082
059000 EJECT                                                            05840082
059100*  DB2 COMMUNICATION AREA                                         05850082
059200*                                                                 05860082
059300     EXEC SQL                                                     05870082
059400         INCLUDE SQLCA                                            05880082
059500     END-EXEC.                                                    05890082
059600 EJECT                                                            05900082
059700*  DB2 COMMUNICATION AREA2                                        05910082
059800*                                                                 05920082
059900     COPY SQLCA2.                                                 05930085
060000 EJECT                                                            05940082
060100                                                                  05950082
060200*                                                                 05960082
060300 PROCEDURE DIVISION.                                              05970082
060400*                                                                 05980082
060500 0000-MAINLINE-PROCESSING.                                        05990082
060600******************************************************************06000082
060700* THIS PARAGRAPH DRIVES THE PROGRAM.                              06010082
060800* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM      06020082
060900* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                   \\\06030082
061000******************************************************************06040082
061100     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           06050082
061200     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   06060082
061300                                                                  06070082
061400     IF CC-PRINT-SUKRP008                                         06080082
061500         PERFORM 0100-INITIALIZATION                              06090082
061600         IF SU001-DETAIL-RECORD                                   06100082
061700             PERFORM 1000-PROCESS-EXTRACT-FILE                    06110082
061800             IF PS-ERROR-RECORD                                   06120082
061900                 PERFORM 7000-WRITE-ERROR-REPORT                  06130082
062000             END-IF                                               06140082
062100         ELSE                                                     06150082
062200             IF CC-PRINT-SUKRP002                                 06160082
062300             OR CC-PRINT-SUKRP003                                 06170082
062400             OR CC-PRINT-SUKRP004                                 06180082
062500             OR CC-PRINT-SUKRP005                                 06190082
062600             OR CC-PRINT-SUKRP006                                 06200082
062700             OR CC-PRINT-SUKRP007                                 06210082
062800                 CONTINUE                                         06220082
062900             ELSE                                                 06230082
063000                 PERFORM 7000-WRITE-ERROR-REPORT                  06240082
063100             END-IF                                               06250082
063200         END-IF                                                   06260082
063300         CLOSE EXTRACT-FILE                                       06270082
063400               SU-CARTON-NOT-RCVD-FILE                            06280082
063500     END-IF.                                                      06290082
063600                                                                  06300082
063700     GOBACK.                                                      06310082
063800*                                                                 06320082
063900 0100-INITIALIZATION.                                             06330082
064000******************************************************************06340082
064100**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               06350082
064200******************************************************************06360082
064300     ACCEPT PV-TODAYS-DATE                                        06370082
064400       FROM DATE.                                                 06380082
064500                                                                  06390082
064600     ACCEPT PV-TODAYS-TIME                                        06400082
064700       FROM TIME.                                                 06410082
064800                                                                  06420082
064900     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         06430082
065000     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             06440082
065100     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               06450082
065200     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              06460082
065300                                                                  06470082
065400     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              06480082
065500     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            06490082
065600     MOVE PC-SUKRP008            TO DP132O-PROGRAM-NAME.          06500082
065700                                                                  06510082
065800******************************************************************06520082
065900**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  06530082
066000******************************************************************06540082
066100     IF CC-PRINT-ENTIRE-TRIP                                      06550082
066200        STRING 'ENTIRE TRIP-REQUESTED BY '                        06560082
066300               CC-REQUESTOR-ID  DELIMITED BY SIZE                 06570082
066400               INTO HL1A-CC-IND-DESC                              06580082
066500     ELSE                                                         06590082
066600        STRING 'SELECTED PO''S REQUESTED BY '                     06600082
066700               CC-REQUESTOR-ID  DELIMITED BY SIZE                 06610082
066800               INTO HL1A-CC-IND-DESC.                             06620082
066900                                                                  06630082
067000     OPEN INPUT  EXTRACT-FILE                                     06640082
067100          OUTPUT SU-CARTON-NOT-RCVD-FILE.                         06650082
067200                                                                  06660082
067300     PERFORM 2200-READ-EXTRACT.                                   06670082
067400                                                                  06680082
067500     MOVE SU001-MANIFEST-NBR     TO PV-TRIP-ID                    06690082
067600                                    VHTRIP-TRIP-ID.               06700082
067700                                                                  06710082
067800     SET PS-DETAIL-RECORD        TO TRUE.                         06720082
067900                                                                  06730082
068000     PERFORM 1100-SELECT-TRAILER.                                 06740082
068100                                                                  06750082
068200*LMM                                                              06760082
068300     IF DN-VEH-NBR = -1                                           06770082
068400        MOVE SPACES                 TO HL2-TRAILER                06780082
068500     ELSE                                                         06790082
068600        MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC                   06800082
068700        MOVE PV-TRIP-ID             TO HL2-TRIP-ID                06810082
068800        MOVE VHTRIP-VEH-NBR         TO HL2-TRAILER                06820082
068900        MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT           06830082
069000     END-IF.                                                      06840082
069100*                                                                 06850082
069200 1000-PROCESS-EXTRACT-FILE.                                       06860082
069300******************************************************************06870082
069400**  PERFORM THE PROCESSING FOR THE PROGRAM.                       06880082
069500******************************************************************06890082
069600     IF PS-DETAIL-RECORD                                          06900082
069700         MOVE PC-AR TO PV-STATUS                                  06910082
069800         SET PS-STATUS-NOT-FOUND TO TRUE                          06920082
069900         PERFORM 1200-SELECT-STATUS                               06930082
070000     END-IF.                                                      06940082
070100                                                                  06950082
070200     IF PS-DETAIL-RECORD                                          06960082
070300         IF PS-STATUS-FOUND                                       06970082
070400             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              06980082
070500             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           06990082
070600             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           07000082
070700             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           07010082
070800             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           07020082
070900         ELSE                                                     07030082
071000             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           07040082
071100             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           07050082
071200             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           07060082
071300             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           07070082
071400         END-IF                                                   07080082
071500         MOVE PC-UG    TO PV-STATUS                               07090082
071600         SET PS-STATUS-NOT-FOUND TO TRUE                          07100082
071700         PERFORM 1200-SELECT-STATUS                               07110082
071800     END-IF.                                                      07120082
071900                                                                  07130082
072000     IF PS-DETAIL-RECORD                                          07140082
072100         IF PS-STATUS-FOUND                                       07150082
072200             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              07160082
072300             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        07170082
072400             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        07180082
072500             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        07190082
072600             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        07200082
072700         ELSE                                                     07210082
072800             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        07220082
072900             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        07230082
073000             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        07240082
073100             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        07250082
073200         END-IF                                                   07260082
073300         MOVE PC-UN    TO PV-STATUS                               07270082
073400         SET PS-STATUS-NOT-FOUND TO TRUE                          07280082
073500         PERFORM 1200-SELECT-STATUS                               07290082
073600     END-IF.                                                      07300082
073700                                                                  07310082
073800     IF PS-DETAIL-RECORD                                          07320082
073900         IF PS-STATUS-FOUND                                       07330082
074000             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              07340082
074100             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          07350082
074200             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          07360082
074300             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          07370082
074400             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          07380082
074500         ELSE                                                     07390082
074600             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          07400082
074700             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          07410082
074800             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          07420082
074900             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          07430082
075000         END-IF                                                   07440082
075100         PERFORM 8000-WRITE-REPORT-HEADERS                        07450082
075200         INITIALIZE SAVE-SHIPT-UNT-ID                             07460082
075300         PERFORM 2200-READ-EXTRACT                                07470082
075400         PERFORM 2000-PROCESS-SU                                  07480082
075500           UNTIL PS-END-OF-EXTRACT                                07490082
075600              OR PS-ERROR-RECORD                                  07500082
075700     END-IF.                                                      07510082
075800                                                                  07520082
075900     IF PS-DETAIL-RECORD                                          07530082
076000         WRITE SU-CARTON-NOT-RCVD-RECORD                          07540082
076100           FROM END-OF-REPORT-LINE                                07550082
076200             AFTER ADVANCING 2 LINES                              07560082
076300                                                                  07570082
076400*    IF THIS IS A PRINTEK PRINTER, SEND A CUT COMMAND             07580082
076500         IF CC-PRTR-CNTL-IND = 'P'                                07590082
076600             WRITE SU-CARTON-NOT-RCVD-RECORD                      07600082
076700                FROM DS004-PLC-CUT-FORM                           07610082
076800                  AFTER ADVANCING 1 LINE                          07620082
076900         END-IF                                                   07630082
077000     END-IF.                                                      07640082
077100*                                                                 07650082
077200 1100-SELECT-TRAILER.                                             07660082
077300     MOVE '1100-SELECT-TRAILER '                                  07670082
077400                                 TO PV-ABEND-PARAGRAPH.           07680082
077500     EXEC SQL                                                     07690082
077600       SELECT A.OWNER_SCAC_ID                                     07700082
077700             ,A.VEH_NBR                                           07710082
077800             ,A.MANIFEST_NBR                                      07720082
077900             ,B.TRIP_STATUS_CDE                                   07730082
078000       INTO  :VHTRIP-OWNER-SCAC-ID                                07740082
078100            ,:VHTRIP-VEH-NBR    :DN-VEH-NBR                       07750082
078200            ,:VHTRIP-MANIFEST-NBR                                 07760082
078300            ,:TRIPST-TRIP-STATUS-CDE                              07770082
078400       FROM   TVHTRIP A                                           07780082
078500             ,TTRIPST B                                           07790082
078600             ,TTRSTYP C                                           07800082
078700       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                07810082
078800         AND  B.TRIP_STATUS_CDE ^= 'DE'                           07820082
078900         AND  C.PRTY_CDE =                                        07830082
079000              (SELECT MAX(E.PRTY_CDE)                             07840082
079100                 FROM TTRIPST D                                   07850082
079200                     ,TTRSTYP E                                   07860082
079300                WHERE D.TRIP_ID         = A.TRIP_ID               07870082
079400                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      07880082
079500         AND  A.TRIP_ID         = B.TRIP_ID                       07890082
079600         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               07900082
079700     END-EXEC.                                                    07910082
079800                                                                  07920082
079900     EVALUATE TRUE                                                07930082
080000       WHEN SQLCODE = ZEROS                                       07940082
080100         CONTINUE                                                 07950082
080200       WHEN SQLCODE = +100                                        07960082
080300         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      07970082
080400                        VHTRIP-VEH-NBR                            07980082
080500                        TRIPST-TRIP-STATUS-CDE                    07990082
080600       WHEN SQLCODE = -904                                        08000082
080700       WHEN SQLCODE = -911                                        08010082
080800       WHEN SQLCODE = -913                                        08020082
080900         SET PS-ERROR-RECORD TO TRUE                              08030082
081000         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      08040082
081100                        VHTRIP-VEH-NBR                            08050082
081200                        TRIPST-TRIP-STATUS-CDE                    08060082
081300       WHEN OTHER                                                 08070082
081400         DISPLAY PV-ABEND-PARAGRAPH                               08080082
081500         PERFORM Z999-SQL-ERROR                                   08090082
081600     END-EVALUATE.                                                08100082
081700                                                                  08110082
081800 1200-SELECT-STATUS.                                              08120082
081900     MOVE '1200-SELECT-STATUS  '                                  08130082
082000                                 TO PV-ABEND-PARAGRAPH.           08140082
082100     EXEC SQL                                                     08150082
082200       SELECT STATUS_DTE                                          08160082
082300       INTO  :TRIPST-STATUS-DTE                                   08170082
082400       FROM   TTRIPST                                             08180082
082500       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                08190082
082600         AND  TRIP_STATUS_CDE    = :PV-STATUS                     08200082
082700     END-EXEC.                                                    08210082
082800                                                                  08220082
082900     EVALUATE TRUE                                                08230082
083000       WHEN SQLCODE = ZEROS                                       08240082
083100         SET PS-STATUS-FOUND TO TRUE                              08250082
083200       WHEN SQLCODE = +100                                        08260082
083300         SET PS-STATUS-NOT-FOUND TO TRUE                          08270082
083400       WHEN SQLCODE = -904                                        08280082
083500       WHEN SQLCODE = -911                                        08290082
083600       WHEN SQLCODE = -913                                        08300082
083700         SET PS-ERROR-RECORD TO TRUE                              08310082
083800       WHEN OTHER                                                 08320082
083900         DISPLAY PV-ABEND-PARAGRAPH                               08330082
084000         PERFORM Z999-SQL-ERROR                                   08340082
084100     END-EVALUATE.                                                08350082
084200*                                                                 08360082
084300 2000-PROCESS-SU.                                                 08370082
084400******************************************************************08380082
084500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *08390082
084600*  CARTONS NOT RECEIVED REPORT.                                  *08400082
084700******************************************************************08410082
084800     IF SAVE-SHIPT-UNT-ID = SU001-SHIPT-UNT-ID                    08420082
084900         CONTINUE                                                 08430082
085000     ELSE                                                         08440082
085100         PERFORM 2300-PROCESS-CURSOR                              08450082
085200         IF PS-DETAIL-RECORD                                      08460082
085300             MOVE SU001-SHIPT-UNT-ID TO SAVE-SHIPT-UNT-ID         08470082
085400         END-IF                                                   08480082
085500     END-IF.                                                      08490082
085600                                                                  08500082
085700     PERFORM 2200-READ-EXTRACT.                                   08510082
085800 2200-READ-EXTRACT.                                               08520082
085900     MOVE '2200-READ-EXTRACT   '                                  08530082
086000                                 TO PV-ABEND-PARAGRAPH.           08540082
086100     READ EXTRACT-FILE INTO SU001-EXTRACT-RECORD                  08550082
086200        AT END                                                    08560082
086300           SET PS-END-OF-EXTRACT TO TRUE.                         08570082
086400                                                                  08580082
086500                                                                  08590082
086600 2300-PROCESS-CURSOR.                                             08600082
086700     EXEC SQL                                                     08610082
086800          SELECT DEST_OPER_UNT_ID                                 08620082
086900            INTO :SHPUNT-DEST-OPER-UNT-ID                         08630082
087000          FROM   TSHPUNT                                          08640082
087100          WHERE  SHIPT_UNT_ID = :SU001-SHIPT-UNT-ID               08650082
087200     END-EXEC.                                                    08660082
087300                                                                  08670082
087400     EVALUATE TRUE                                                08680082
087500       WHEN SQLCODE = ZEROS                                       08690082
087600         CONTINUE                                                 08700082
087700       WHEN SQLCODE = +100                                        08710082
087800         MOVE ZEROES TO SHPUNT-DEST-OPER-UNT-ID                   08720082
087900       WHEN SQLCODE = -904                                        08730082
088000       WHEN SQLCODE = -911                                        08740082
088100       WHEN SQLCODE = -913                                        08750082
088200         SET PS-ERROR-RECORD TO TRUE                              08760082
088300       WHEN OTHER                                                 08770082
088400         MOVE '2300-PROCESS-CURSOR '                              08780082
088500                                 TO PV-ABEND-PARAGRAPH            08790082
088600         DISPLAY PV-ABEND-PARAGRAPH                               08800082
088700         PERFORM Z999-SQL-ERROR                                   08810082
088800     END-EVALUATE.                                                08820082
088900                                                                  08830082
089000     IF PS-DETAIL-RECORD                                          08840082
089100         MOVE SHPUNT-DEST-OPER-UNT-ID  TO DL1-STORE               08850082
089200         MOVE SU001-PO-NUMBER          TO PV-PO                   08860082
089300         MOVE SU001-SHIPT-UNT-ID       TO PV-SERIAL-SHIP-CODE     08870082
089400         MOVE PV-SERIAL-SHIP-CODE-1    TO PV-OUT-S-S-C-1          08880082
089500         MOVE PV-SERIAL-SHIP-CODE-2-8  TO PV-OUT-S-S-C-2-8        08890082
089600         MOVE PV-SERIAL-SHIP-CODE-9-17 TO PV-OUT-S-S-C-9-17       08900082
089700         MOVE PV-SERIAL-SHIP-CODE-18   TO PV-OUT-S-S-C-18         08910082
089800         MOVE PV-OUT-SERIAL-SHIP-CODE  TO DL1-SERIAL-SHIP-CODE    08920082
089900         SET PS-PO-ROW-FOUND TO TRUE                              08930082
090000         PERFORM 3400-SELECT-PO-NUMBER                            08940082
090100     END-IF.                                                      08950082
090200                                                                  08960082
090300     IF PS-DETAIL-RECORD                                          08970082
090400         IF PS-PO-ROW-FOUND                                       08980082
090500             PERFORM 3500-SELECT-VDR-INFO                         08990082
090600         END-IF                                                   09000082
090700     END-IF.                                                      09010082
090800                                                                  09020082
090900     IF PS-DETAIL-RECORD                                          09030082
091000         IF PS-FIRST-LINE                                         09040082
091100             SET PS-NOT-FIRST-LINE TO TRUE                        09050082
091200             MOVE PC-2 TO PV-LINE-SUB                             09060082
091300             MOVE PV-PO                    TO DL1-PO              09070082
091400                                              PV-SAVE-PO          09080082
091500             MOVE SHPUNT-DEST-OPER-UNT-ID  TO PV-SAVE-STR         09090082
091600             MOVE EXTENT-DUN-NBR           TO DL1-VENDOR-ID       09100082
091700                                              PV-SAVE-VENDOR-ID   09110082
091800             MOVE ENTNME-ENT-NAME-DESC     TO DL1-VENDOR-NAME     09120082
091900                                              PV-SAVE-VENDOR-NAME 09130082
092000         ELSE                                                     09140082
092100             IF PV-PO = PV-SAVE-PO                                09150082
092200                 MOVE PC-1 TO PV-LINE-SUB                         09160082
092300                 IF DL1-STORE = PV-SAVE-STR                       09170082
092400                     MOVE SPACES           TO DL1-PO              09180082
092500                     MOVE ZEROES           TO DL1-STORE           09190082
092600                     MOVE SPACES           TO DL1-VENDOR-ID       09200082
092700                     MOVE SPACES           TO DL1-VENDOR-NAME     09210082
092800                 ELSE                                             09220082
092900                     MOVE PC-2 TO PV-LINE-SUB                     09230082
093000                     MOVE DL1-STORE        TO PV-SAVE-STR         09240082
093100                     MOVE SPACES           TO DL1-PO              09250082
093200                     MOVE SPACES           TO DL1-VENDOR-ID       09260082
093300                     MOVE SPACES           TO DL1-VENDOR-NAME     09270082
093400                 END-IF                                           09280082
093500             ELSE                                                 09290082
093600                 MOVE PC-2 TO PV-LINE-SUB                         09300082
093700                 MOVE PV-PO                TO DL1-PO              09310082
093800                                              PV-SAVE-PO          09320082
093900                 MOVE DL1-STORE            TO PV-SAVE-STR         09330082
094000                 MOVE EXTENT-DUN-NBR       TO DL1-VENDOR-ID       09340082
094100                                              PV-SAVE-VENDOR-ID   09350082
094200                 MOVE ENTNME-ENT-NAME-DESC TO DL1-VENDOR-NAME     09360082
094300                                              PV-SAVE-VENDOR-NAME 09370082
094400             END-IF                                               09380082
094500         END-IF                                                   09390082
      *CLP 09/30/14                                                     09391087
094600         IF DL1-PO = '99999999'                                   09400087
094700             MOVE 'CO MSDRTS' TO DL1-PO                           09410082
094800         END-IF                                                   09420082
094900                                                                  09430082
095000         IF PV-LINE-CNT > PC-60                                   09440082
095100              PERFORM 8000-WRITE-REPORT-HEADERS                   09450082
095200         END-IF                                                   09460082
095300         IF PV-SAVE-SERIAL-SHIP-CODE   =   DL1-SERIAL-SHIP-CODE   09470082
095400             CONTINUE                                             09480082
095500         ELSE                                                     09490082
095600             PERFORM 8400-WRITE-DETAIL-LINES                      09500082
095700             MOVE DL1-SERIAL-SHIP-CODE                            09510082
095800                                      TO PV-SAVE-SERIAL-SHIP-CODE 09520082
095900         END-IF                                                   09530082
096000     END-IF.                                                      09540082
096100                                                                  09550082
096200 3400-SELECT-PO-NUMBER.                                           09560082
096300     MOVE '3400-SELECT-PO-NUMBER'                                 09570082
096400                                 TO PV-ABEND-PARAGRAPH.           09580082
096500                                                                  09590082
096600     EXEC SQL                                                     09600082
096700         SELECT PO_NBR                                            09610082
096800               ,ENT_ID                                            09620082
096900           INTO :PURCHS-PO-NBR                                    09630082
097000               ,:PURCHS-ENT-ID                                    09640082
097100           FROM TPURCHS                                           09650082
097200          WHERE PO_NBR     = :SU001-PO-NUMBER                     09660082
097300            AND VER_STATUS_CDE = :PC-A                            09670082
097400     END-EXEC.                                                    09680082
097500     EVALUATE TRUE                                                09690082
097600       WHEN SQLCODE = ZEROS                                       09700082
097700           CONTINUE                                               09710082
097800       WHEN SQLCODE = +100                                        09720082
097900           SET PS-PO-ROW-NOT-FOUND TO TRUE                        09730082
098000           MOVE SPACES TO                                         09740082
098100                 EXTENT-DUN-NBR                                   09750082
098200                 ENTNME-ENT-NAME-DESC                             09760082
098300       WHEN SQLCODE = -904                                        09770082
098400       WHEN SQLCODE = -911                                        09780082
098500       WHEN SQLCODE = -913                                        09790082
098600         SET PS-ERROR-RECORD TO TRUE                              09800082
098700       WHEN OTHER                                                 09810082
098800           DISPLAY PV-ABEND-PARAGRAPH                             09820082
098900           PERFORM Z999-SQL-ERROR                                 09830082
099000     END-EVALUATE.                                                09840082
099100                                                                  09850082
099200                                                                  09860082
099300 3500-SELECT-VDR-INFO.                                            09870082
099400     MOVE '3500-SELECT-VDR-INFO'                                  09880082
099500                                 TO PV-ABEND-PARAGRAPH.           09890082
099600                                                                  09900082
099700     EXEC SQL                                                     09910082
099800         SELECT A.DUN_NBR                                         09920082
099900               ,B.ENT_NAME_DESC                                   09930082
100000           INTO :EXTENT-DUN-NBR                                   09940082
100100               ,:ENTNME-ENT-NAME-DESC                             09950082
100200           FROM TEXTENT A                                         09960082
100300               ,TENTNME B                                         09970082
100400          WHERE A.ENT_ID   = :PURCHS-ENT-ID                       09980082
100500            AND A.ENT_ID   = B.ENT_ID                             09990082
100600            AND B.TYPE_CDE = '01'                                 10000082
P40473          WITH UR                                                 10001086
100700     END-EXEC.                                                    10010082
100800     EVALUATE TRUE                                                10020082
100900       WHEN SQLCODE = ZEROS                                       10030082
101000           CONTINUE                                               10040082
101100       WHEN SQLCODE = +100                                        10050082
101200           CONTINUE                                               10060082
101300       WHEN SQLCODE = -904                                        10070082
101400       WHEN SQLCODE = -911                                        10080082
101500       WHEN SQLCODE = -913                                        10090082
101600         SET PS-ERROR-RECORD TO TRUE                              10100082
101700       WHEN OTHER                                                 10110082
101800           DISPLAY PV-ABEND-PARAGRAPH                             10120082
101900           PERFORM Z999-SQL-ERROR                                 10130082
102000     END-EVALUATE.                                                10140082
102100                                                                  10150082
102200*                                                                 10160082
102300 7000-WRITE-ERROR-REPORT.                                         10170082
102400******************************************************************10180082
102500*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *10190082
102600******************************************************************10200082
102700     PERFORM 8200-WRITE-TOP-LINE.                                 10210082
102800*                                                                 10220082
102900     WRITE SU-CARTON-NOT-RCVD-RECORD                              10230082
103000       FROM HEADING-LINE-0                                        10240082
103100         AFTER ADVANCING 1 LINE.                                  10250082
103200*                                                                 10260082
103300     WRITE SU-CARTON-NOT-RCVD-RECORD                              10270082
103400       FROM HEADING-LINE-1                                        10280082
103500         AFTER ADVANCING 1 LINE.                                  10290082
103600*                                                                 10300082
103700     WRITE SU-CARTON-NOT-RCVD-RECORD                              10310082
103800       FROM HEADING-LINE-1A                                       10320082
103900         AFTER ADVANCING 1 LINE.                                  10330082
104000*                                                                 10340082
104100     WRITE SU-CARTON-NOT-RCVD-RECORD                              10350082
104200       FROM HEADING-LINE-1B                                       10360082
104300         AFTER ADVANCING 1 LINE.                                  10370082
104400*                                                                 10380082
104500     WRITE SU-CARTON-NOT-RCVD-RECORD                              10390082
104600       FROM HEADING-LINE-2                                        10400082
104700         AFTER ADVANCING 4 LINES.                                 10410082
104800*                                                                 10420082
104900     IF SU001-DETAIL-RECORD                                       10430082
105000         WRITE SU-CARTON-NOT-RCVD-RECORD                          10440082
105100           FROM EL1-ERROR-LINE-1P                                 10450082
105200             AFTER ADVANCING 3 LINES                              10460082
105300                                                                  10470082
105400         WRITE SU-CARTON-NOT-RCVD-RECORD                          10480082
105500           FROM EL2-ERROR-LINE-2P                                 10490082
105600             AFTER ADVANCING 2 LINES                              10500082
105700     ELSE                                                         10510082
105800         WRITE SU-CARTON-NOT-RCVD-RECORD                          10520082
105900           FROM EL1-ERROR-LINE-1F                                 10530082
106000             AFTER ADVANCING 3 LINES                              10540082
106100                                                                  10550082
106200         WRITE SU-CARTON-NOT-RCVD-RECORD                          10560082
106300           FROM EL2-ERROR-LINE-2F                                 10570082
106400             AFTER ADVANCING 2 LINES                              10580082
106500     END-IF.                                                      10590082
106600*                                                                 10600082
106700     WRITE SU-CARTON-NOT-RCVD-RECORD                              10610082
106800       FROM EL3-ERROR-LINE-3                                      10620082
106900         AFTER ADVANCING 2 LINES.                                 10630082
107000*                                                                 10640082
107100     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     10650082
107200     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      10660082
107300     WRITE SU-CARTON-NOT-RCVD-RECORD                              10670082
107400       FROM EL4-ERROR-LINE-4                                      10680082
107500         AFTER ADVANCING 3 LINES.                                 10690082
107600*                                                                 10700082
107700     WRITE SU-CARTON-NOT-RCVD-RECORD                              10710082
107800       FROM EL5-ERROR-LINE-5                                      10720082
107900         AFTER ADVANCING 2 LINE.                                  10730082
108000*JPL                                                              10740082
108100     WRITE SU-CARTON-NOT-RCVD-RECORD                              10750082
108200       FROM EL5-ERROR-LINE-5B                                     10760082
108300         AFTER ADVANCING 2 LINE.                                  10770082
108400*                                                                 10780082
108500     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              10790082
108600     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              10800082
108700     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              10810082
108800     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              10820082
108900     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              10830082
109000     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              10840082
109100     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              10850082
109200*JPL                                                              10860082
109300     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              10870082
109400                                                                  10880082
109500*JPL WRITE SU-CARTON-NOT-RCVD-RECORD                              10890082
109600*JPL   FROM EL6-ERROR-LINE-6                                      10900082
109700*JPL     AFTER ADVANCING 1 LINE.                                  10910082
109800*JPL                                                              10920082
109900     WRITE SU-CARTON-NOT-RCVD-RECORD                              10930082
110000       FROM EL6-ERROR-LINE-6B                                     10940082
110100         AFTER ADVANCING 1 LINE.                                  10950082
110200*                                                                 10960082
110300     WRITE SU-CARTON-NOT-RCVD-RECORD                              10970082
110400       FROM END-OF-REPORT-LINE                                    10980082
110500         AFTER ADVANCING 6 LINES.                                 10990082
110600*                                                                 11000082
110700*                                                                 11010082
110800 8000-WRITE-REPORT-HEADERS.                                       11020082
110900******************************************************************11030082
111000*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *11040082
111100*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *11050082
111200******************************************************************11060082
111300     PERFORM 8200-WRITE-TOP-LINE.                                 11070082
111400*                                                                 11080082
111500     WRITE SU-CARTON-NOT-RCVD-RECORD                              11090082
111600       FROM HEADING-LINE-0                                        11100082
111700         AFTER ADVANCING 1 LINE.                                  11110082
111800*                                                                 11120082
111900     WRITE SU-CARTON-NOT-RCVD-RECORD                              11130082
112000       FROM HEADING-LINE-1                                        11140082
112100         AFTER ADVANCING 1 LINE.                                  11150082
112200*                                                                 11160082
112300     WRITE SU-CARTON-NOT-RCVD-RECORD                              11170082
112400       FROM HEADING-LINE-1A                                       11180082
112500         AFTER ADVANCING 1 LINE.                                  11190082
112600*                                                                 11200082
112700     WRITE SU-CARTON-NOT-RCVD-RECORD                              11210082
112800       FROM HEADING-LINE-1B                                       11220082
112900         AFTER ADVANCING 1 LINE.                                  11230082
113000*                                                                 11240082
113100     WRITE SU-CARTON-NOT-RCVD-RECORD                              11250082
113200       FROM HEADING-LINE-2                                        11260082
113300         AFTER ADVANCING 1 LINES.                                 11270082
113400*                                                                 11280082
113500     WRITE SU-CARTON-NOT-RCVD-RECORD                              11290082
113600       FROM HEADING-LINE-3                                        11300082
113700         AFTER ADVANCING 2 LINES.                                 11310082
113800*                                                                 11320082
113900*    WRITE SU-CARTON-NOT-RCVD-RECORD                              11330082
114000*      FROM HEADING-LINE-4                                        11340082
114100*        AFTER ADVANCING 2 LINES.                                 11350082
114200*                                                                 11360082
114300     WRITE SU-CARTON-NOT-RCVD-RECORD                              11370082
114400       FROM HEADING-LINE-5                                        11380082
114500         AFTER ADVANCING 2 LINE.                                  11390082
114600                                                                  11400082
114700     WRITE SU-CARTON-NOT-RCVD-RECORD                              11410082
114800       FROM HEADING-LINE-6                                        11420082
114900         AFTER ADVANCING 1 LINE.                                  11430082
115000*                                                                 11440082
115100     MOVE PC-12                   TO PV-LINE-CNT.                 11450082
115200     SET PS-FIRST-LINE            TO TRUE.                        11460082
115300*                                                                 11470082
115400*                                                                 11480082
115500 8200-WRITE-TOP-LINE.                                             11490082
115600******************************************************************11500082
115700*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *11510082
115800*     NEEDED FOR AN ASN NUMBER.                                  *11520082
115900******************************************************************11530082
116000     ADD 1                        TO PV-PAGE-CNT.                 11540082
116100*                                                                 11550082
116200     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          11560082
116300*                                                                 11570082
116400     WRITE SU-CARTON-NOT-RCVD-RECORD                              11580082
116500       FROM DP132O-STANDRD-HEADER-132-COLS                        11590082
116600         AFTER ADVANCING PAGE.                                    11600082
116700*                                                                 11610082
116800*                                                                 11620082
116900 8400-WRITE-DETAIL-LINES.                                         11630082
117000******************************************************************11640082
117100*     WRITES THE DETAIL LINE INFORMATION.                        *11650082
117200******************************************************************11660082
117300     WRITE SU-CARTON-NOT-RCVD-RECORD                              11670082
117400       FROM DETAIL-LINE1                                          11680082
117500         AFTER ADVANCING PV-LINE-SUB LINES.                       11690082
117600*                                                                 11700082
117700     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              11710082
117800*                                                                 11720082
117900*                                                                 11730082
118000******************************************************************11740082
118100*     SQL WARNING OR ERROR PROCESSING                            *11750082
118200*                                                                *11760082
118300******************************************************************11770082
118400                                                                  11780082
118500*                                                                 11790082
118600 Z999-SQL-ERROR.                                                  11800082
118700*---------------                                                  11810082
118800                                                                  11820082
118900     MOVE SQLCODE    TO SQLCODE2.                                 11830082
119000     MOVE SQLERRD(3) TO SQLERRD3.                                 11840082
119100     DISPLAY '** ABEND **       ** = SQLERROR'.                   11850082
119200     DISPLAY '** PROGRAM        ** = SUKRP008'.                   11860082
119300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11870082
119400     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11880082
119500     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   11890082
119600     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  11900082
119700     EXEC SQL                                                     11910082
119800         COMMIT                                                   11920082
119900     END-EXEC.                                                    11930082
120000     MOVE +4013 TO PV-ABEND-CODE.                                 11940082
120100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11950082
