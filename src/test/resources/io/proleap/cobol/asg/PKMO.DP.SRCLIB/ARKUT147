000100***************************************************************** 00010035
000200 IDENTIFICATION DIVISION.                                         00020035
000300***************************************************************** 00030035
000400                                                                  00040035
000500 PROGRAM-ID.             ARKUT147.                                00050068
000600 AUTHOR.                 COGNIZANT.                               00060035
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070035
000800 DATE-WRITTEN            JULY  2019.                              00080062
000900 DATE-COMPILED.                                                   00090035
001000                                                                  00100035
001100***************************************************************** 00110035
001200*  PURPOSE:                                                       00120035
001300*  THIS PROGRAM WILL TOKENIZE THE BELOW FIELDS IN THE INPUT FILE  00130062
001400*  1) AR147-CC1729RD-ACCT-ID                                      00140068
001500*  PROTEGRITY MODULE WILL BE INVOKED TO TOKENIZE THE FIELDS       00150062
001600*                                                                 00160035
001700*  INPUT:  CD1729 RAWDATA FILE                                    00170068
001800*  OUTPUT: CD1729 RAWDATA FILE WITH TOKENIZED ACCOUNT ID          00180068
001900*                                                                 00190035
002000***************************************************************** 00200035
002100*----------------------------------------------------------------*00210035
002200*                                                                *00220035
002300* DATE:        07/24/2019                                        *00230062
002400* WR/IR#:      CHG0230275                                        *00240077
002500* PROGRAMMER:  COGNIZANT                                         *00250035
002600* DESCRIPTION: INITIAL VERSION CREATED FOR FD FILE TRANSFER      *00260065
002700*              PROJECT                                           *00270035
002800*                                                                *00280035
002900*----------------------------------------------------------------*00290035
003000***************************************************************** 00300035
003100 ENVIRONMENT DIVISION.                                            00310035
003200***************************************************************** 00320035
003300                                                                  00330035
003400 CONFIGURATION SECTION.                                           00340035
003500                                                                  00350035
003600 SOURCE-COMPUTER.        IBM-3090.                                00360035
003700                                                                  00370035
003800 OBJECT-COMPUTER.        IBM-3090.                                00380035
003900                                                                  00390035
004000 INPUT-OUTPUT SECTION.                                            00400035
004100                                                                  00410035
004200 FILE-CONTROL.                                                    00420035
004300                                                                  00430035
004400     SELECT AR147-INPUT-FILE                                      00440068
004500         ASSIGN TO INP01.                                         00450035
004600                                                                  00460035
004700     SELECT AR147-TOKEN-FILE                                      00470068
004800         ASSIGN TO OUT01.                                         00480035
004900                                                                  00490035
005000******************************************************************00500035
005100 DATA DIVISION.                                                   00510035
005200******************************************************************00520035
005300                                                                  00530035
005400 FILE SECTION.                                                    00540035
005500                                                                  00550035
005600 FD  AR147-INPUT-FILE                                             00560068
005700     RECORDING MODE IS V                                          00570071
005800     BLOCK CONTAINS 0 RECORDS                                     00580035
005900     LABEL RECORDS ARE STANDARD                                   00590035
006000     RECORD IS VARYING FROM 1 TO 84.                              00600073
006100                                                                  00610035
006200 01  AR147-INPUT-RECORD          PIC X(84).                       00620071
006300                                                                  00630035
006400 FD  AR147-TOKEN-FILE                                             00640068
006500     RECORDING MODE IS V                                          00650071
006600     BLOCK CONTAINS 0 RECORDS                                     00660035
006700     LABEL RECORDS ARE STANDARD                                   00670035
006800     RECORD IS VARYING FROM 1 TO 84.                              00680073
006900                                                                  00690035
007000 01  AR147-TOKEN-RECORD          PIC X(84).                       00700071
007100                                                                  00710035
007200******************************************************************00720035
007300 WORKING-STORAGE SECTION.                                         00730035
007400******************************************************************00740035
007500 01  FILLER                            PIC X(50)  VALUE           00750035
007600     ' *** WORKING STORAGE STARTS HERE FOR ARKUT147 *** '.        00760068
007700                                                                  00770035
007800 01  ABEND-CODE                        PIC S9(04) VALUE +0.       00780057
007900                                                                  00790057
008000 01  PS-PROGRAM-SWITCHES.                                         00800035
008100     05  PS-END-OF-AR147-SW            PIC X(01)  VALUE 'N'.      00810068
008200         88  PS-NOT-END-OF-AR147                  VALUE 'N'.      00820068
008300         88  PS-END-OF-AR147                      VALUE 'Y'.      00830068
008400                                                                  00840035
008500 01  PC-CONSTANTS.                                                00850035
008600     05  PC-PROGRAM-NAME               PIC  X(08) VALUE           00860035
008700                                                 'ARKUT147'.      00870068
008800 01  PV-PROGRAM-VARIABLES.                                        00880035
008900     05  PV-AR147-READ-COUNT           PIC  9(07) VALUE ZEROES.   00890068
009000     05  PV-AR147-WRITE-COUNT          PIC  9(07) VALUE ZEROES.   00900068
009100     05  PV-INPUT-LENGTH               PIC  9(09).                00910056
009200                                                                  00920035
009300********                                                          00930059
009400******************************************************************00940062
009500* RECORD LAYOUT FOR SETTLEMENT ADJUSTMENT FILE- INPUT AND OUTPUT *00950062
009600******************************************************************00960062
009700     COPY ARRD147.                                                00970068
009800********                                                          00980059
009900******************************************************************00990035
010000* LAYOUT THAT DEFINES THE PARAMETERS NEEDED TO INVOKE PROTEGRITY *01000035
010100* MODULE                                                         *01010035
010200******************************************************************01020035
010300     COPY PTYCCSIP.                                               01030035
010400                                                                  01040035
010500******************************************************************01050035
010600* LAYOUT THAT DEFINES THE WORKING VARIABLES TO INVOKE PROTEGRITY *01060035
010700* MODULE                                                         *01070035
010800******************************************************************01080035
010900     COPY DPWS031.                                                01090052
011000                                                                  01100035
011100******************************************************************01110035
011200                                                                  01120035
011300 PROCEDURE DIVISION.                                              01130035
011400                                                                  01140035
011500 0000-MAINLINE-PARA.                                              01150035
011600                                                                  01160035
011700     PERFORM 1000-INITIALIZE.                                     01170035
011800                                                                  01180035
011900     PERFORM 2000-PROCESS-RECORDS                                 01190035
012000           UNTIL PS-END-OF-AR147.                                 01200068
012100                                                                  01210035
012200     PERFORM 9000-EOJ-ROUTINE.                                    01220035
012300                                                                  01230035
012400     STOP RUN.                                                    01240035
012500                                                                  01250035
012600******************************************************************01260035
012700* 1000-INITIALIZE                                                 01270035
012800*     INITIALIZE THE VARIABLES, OPEN THE INPUT AND OUTPUT FILES   01280035
012900*     AND READ THE INPUT FILE                                     01290035
013000******************************************************************01300035
013100 1000-INITIALIZE.                                                 01310035
013200                                                                  01320035
013300     DISPLAY 'PROGRAM - ' PC-PROGRAM-NAME.                        01330035
013400     INITIALIZE PV-PROGRAM-VARIABLES.                             01340035
013500     MOVE PC-PROGRAM-NAME               TO DP031-PROGRAM-NAME.    01350055
013600                                                                  01360035
013700     OPEN INPUT  AR147-INPUT-FILE                                 01370068
013800          OUTPUT AR147-TOKEN-FILE.                                01380068
013900                                                                  01390035
014000     PERFORM 2100-READ-AR147.                                     01400068
014100                                                                  01410035
014200******************************************************************01420035
014300* 2000-PROCESS-RECORDS                                            01430035
014400*   1. TOKENIZE THE FIELDS IN THE INPUT FILE                      01440062
014500*   2. WRITE THE RECORDS TO OUTPUT AND READ THE NEXT RECORD TO    01450035
014600*      PROCESS                                                    01460035
014700******************************************************************01470035
014800 2000-PROCESS-RECORDS.                                            01480035
014900                                                                  01490035
015000     IF AR147-RECORDS(1:1) NOT = 'H' AND                          01500076
015001        AR147-RECORDS(1:1) NOT = 'T' AND                          01510076
015010        AR147-CC1729RD-ACCT-ID > SPACES                           01520075
015100        MOVE ZEROES TO PV-INPUT-LENGTH                            01530074
015200        INSPECT FUNCTION REVERSE (AR147-CC1729RD-ACCT-ID)         01540074
015300            TALLYING PV-INPUT-LENGTH FOR LEADING SPACES           01550074
015400        COMPUTE PV-INPUT-LENGTH =                                 01560074
015500            LENGTH OF AR147-CC1729RD-ACCT-ID - PV-INPUT-LENGTH    01570074
015600        PERFORM 2200-TOKENIZE-CHD-ACC-ID                          01580074
015700     END-IF.                                                      01590074
015800     PERFORM 3000-WRITE-AR147.                                    01600068
015900     PERFORM 2100-READ-AR147.                                     01610068
016000                                                                  01620035
016100******************************************************************01630035
016200* 2100-READ-AR147                                                 01640068
016300*      READ THE RECORDS IN SETTLEMENT ADJUSTMENT FILE             01650035
016400******************************************************************01660035
016500 2100-READ-AR147.                                                 01670068
016600                                                                  01680035
016700     READ AR147-INPUT-FILE INTO AR147-RECORDS                     01690068
016800        AT END                                                    01700035
016900           SET PS-END-OF-AR147 TO TRUE                            01710068
017000        NOT AT END                                                01720035
017100           ADD 1               TO PV-AR147-READ-COUNT             01730068
017200     END-READ.                                                    01740035
017300                                                                  01750035
017400******************************************************************01760035
017500* 2200-TOKENIZE-CHD-ACC-NBR                                       01770067
017600******************************************************************01780035
017700 2200-TOKENIZE-CHD-ACC-ID.                                        01790068
017800                                                                  01800035
017900     INITIALIZE CSI-PARAMETERS                                    01810044
018000                DP031-PROTEG-PGM-PARAMETERS.                      01820051
018100                                                                  01830044
018200     SET CSI-ENCRYPT-FUNCTION         TO TRUE.                    01840044
018300     SET DP031-ACCTNBR                TO TRUE.                    01850061
018400     MOVE 'AC-ACCT'                   TO DP031-FIELD.             01860059
018500     MOVE AR147-CC1729RD-ACCT-ID      TO DP031-CLEAR-TEXT.        01870068
018600     MOVE PV-INPUT-LENGTH             TO DP031-INPUT-LEN.         01880051
018700     PERFORM DP031-0000-PROTG-TOKEN-DETOKEN.                      01890052
018800                                                                  01900044
018900     IF CSI-RETURN-CODE NOT = ZERO                                01910044
019000        DISPLAY 'ABEND IN RECORD NUMBER - ' PV-AR147-READ-COUNT   01920068
019100        DISPLAY 'INPUT-LENGTH - ' PV-INPUT-LENGTH                 01930058
019200        PERFORM DP031-9999-ABEND                                  01940052
019300     END-IF.                                                      01950044
019400     INITIALIZE AR147-CC1729RD-ACCT-ID.                           01960068
019500     MOVE DP031-CIPHER-TEXT        TO AR147-CC1729RD-ACCT-ID.     01970068
019600                                                                  01980035
019700******************************************************************01990063
019800* 3000-WRITE-AR147                                                02000068
019900*      WRITE THE RECORDS TO OUTPUT                                02010035
020000******************************************************************02020035
020100 3000-WRITE-AR147.                                                02030068
020200                                                                  02040035
020300     WRITE AR147-TOKEN-RECORD FROM AR147-RECORDS.                 02050068
020400     ADD 1                   TO PV-AR147-WRITE-COUNT.             02060068
020500                                                                  02070035
020600******************************************************************02080035
020700* 9000-EOJ-ROUTINE                                                02090035
020800*      CLOSE THE INPUT AND OUTPUT FILES, DISPLAY THE MESSAGES     02100035
020900*      AND TERMINATE THE PROCESS.                                 02110035
021000******************************************************************02120035
021100 9000-EOJ-ROUTINE.                                                02130035
021200                                                                  02140035
021300     CLOSE AR147-INPUT-FILE                                       02150068
021400           AR147-TOKEN-FILE.                                      02160068
021500                                                                  02170035
021600     IF PV-AR147-READ-COUNT = 0                                   02180068
021700        DISPLAY 'INPUT SETTLEMENT ADJUSTMENT FILE IS EMPTY'       02190035
021800     END-IF.                                                      02200035
021900     DISPLAY 'SAF RECORDS READ   : ' PV-AR147-READ-COUNT.         02210068
022000     DISPLAY 'SAF RECORDS WRITTEN: ' PV-AR147-WRITE-COUNT.        02220068
022100                                                                  02230035
022200******************************************************************02240035
022300*      COPY MEMBER DPPD031 CONTAINS STATEMENTS NEEDED TO INVOKE   02250052
022400*      PROTEGRITY MODULE FOR TOKENIZATION                         02260035
022500******************************************************************02270035
022600      COPY DPPD031.                                               02280052
022700                                                                  02290035
022800******************************************************************02300035
