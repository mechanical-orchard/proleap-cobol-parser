       IDENTIFICATION DIVISION.                                         INKCS056
00004  PROGRAM-ID.    INKCS056.                                         INKCS056
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          INKCS056
00007  DATE-WRITTEN.  04-26-2002.                                       INKCS056
00008  DATE-COMPILED.                                                   INKCS056
00009                                                                   INKCS056
00010 ******************************************************************INKCS056
00011 *    I056 - PHYSICAL INVENTORY ADJUSTMENT DETAIL INQUIRY.         INKCS056
00056 *                                                                 INKCS056
00013 *    THIS PROGRAM IS INVOKED FROM INKCS055.  IT DISPLAYS          INKCS056
00014 *    SUMMARY INVENTORY AND DETAIL ADJUSTMENT ROWS THAT EXIST      INKCS056
00015 *    FOR THE SELECTED STORE/AREA/SKU.                             INKCS056
      *                                                                         
      *CHANGE HISTORY:                                                          
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                             
      * -------  ----------  ----------------------------------------           
W23511* W23511   04-25-2002  PHYS INV TOP EXCEPTION RPT ENHANCEMENT             
W23511*                      (CREATION) -ROD JANSSEN                            
W21732* W21732   11-27-2002  DISPLAY NON-INTELLIGENT SKU INSTEAD OF             
W21732*                      DEPT, CLASS AND SEQ NBR.                           
W21732*                      CHANGED BY : IGSI                                  
      ***************************************************************** INKCS055
C21732*    CHANGE BY S JACKSON  3/17/03                                *        
C21732*    USE UPC CHCK - NEW SKU COMPLIANT UPC LOOKUP MODULE                   
C21732*----------------------------------------------------------------*        
W25428*  12/05/03 - S. JACKSON -   WR#25428                           *         
W25428*    ALLOW FOR UPC TO BE INCORPORATED INTO ADJUSTMENT PROCESS.  *         
W25428*    ADD ASC-DMS FIELD TO ASC-ITEM-ARRAY TO CONTAIN SKU ATTR.   *         
W25428*    CHANGE CURSOR PROCESSING TO SUM SIMILAR RECORD COUNTS THAT *         
W25428*    CONTAIN THE SAME KEY FIELDS (SKU/RETAIL) REGARDLES OF UPC. *         
W25428*---------------------------------------------------------------* INKCS011
      * 26600    04-20-2004  STORE NUMBER EXPANSION FOR INV. LEDGER   *         
      *                      TEMPORARILY ADD LOC-NBR TO INSERT STMT   *         
      *                      -V. LEE YANG                             *         
W26682*---------------------------------------------------------------* INKCS011
      * 26682    04-26-2004  UPC ENHANCEMENT ISSUE WITH INQUIRY WHERE *         
      *                      MULTIPLE UPCS EXIST (811) PARA- 4100-    *         
      *                      ALSO COMMENT OUT ANY LOGIC RELATED TO              
      *                      INSERT/UPDATE OF TABLES OR FILES.                  
      *                      -S. JACKSON                              *         
W26600*---------------------------------------------------------------* INKCS011
      * 26600    07-20-2004  STORE NUMBER EXPANSION - REMOVE OBSOLETE *         
      *                      STORE_NBR FIELD REFERENCES               *         
      *                      -SCOTT JACKSON                           *         
      * 28545    08-10-2006  DEPARTMENT INVENTORY PROJECT             *         
      *                      REMOVE OBSOLETE REFERENCE TO TINVPAR     *         
      *                      -B. GRAHAM - STRATAGEM                   *         
      * 33304    05-01-2008  HOLDING INVENTORY LEDGER OPEN ACROSS               
      *                      PERIODS INVENTORY SHORTAGE REPORTING               
      *                      -JILL LIN                                          
      ***************************************************************** INKCS055
263126* CHANGED 10/26/2021    BY JIM HUNTER      WR: CHG0263126                 
263126* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263126* MAKING THE CALL DYNAMIC VS STATIC.                                      
00010 ***************************************************************** INKCS055
1122RM* CHANGED 11/03/2022    BY BOB MCASEY      WR: CHG0277188                 
1122RM* ADDED THE DPKCS930 COPYBOOK. CHANGED THE PARAMETERS FOR CALLING         
1122RM* THE CICS ARCHITECTURE API.                                              
      *----------------------------------------------------------------*        
00020** CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369                 
00020**    CHANGE THE CALL OF UPC CHECK DIGIT ROUTINE TO DYNAMIC                
00020**----------------------------------------------------------------*        
00021                                                                   INKCS056
00023  ENVIRONMENT DIVISION.                                            INKCS056
00025  DATA DIVISION.                                                   INKCS056
00026                                                                   INKCS056
00010 /*****************************************************************INKCS056
00028  WORKING-STORAGE SECTION.                                         INKCS056
00010 ******************************************************************INKCS056
00029  01  PC-PROGRAM-CONSTANTS.                                        INKCS056
00030      05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'INKCS056'.  INKCS056
00031      05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'IN056A  '.  INKCS056
00032      05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'INKM056 '.  INKCS056
00033      05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           INKCS056
00034                                               COMP.               INKCS056
00035      05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           INKCS056
00036                                               COMP.               INKCS056
00037      05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           INKCS056
00038                                               COMP.               INKCS056
00039      05  PC-INTER-APPL-CODES.                                     INKCS056
00040          10  PC-INTER-APPL-CRIT-SPEC                              INKCS056
00041                                   PIC  X(01)  VALUE '1'.          INKCS056
00042          10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '0'.          INKCS056
00043      05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       INKCS056
00044      05  PC-30                    PIC  9(03)  VALUE 30 COMP-3.    INKCS056
00045      05  PC-9000                  PIC  9(05)  VALUE 9000.         INKCS056
00046      05  PC-9999                  PIC  9(05)  VALUE 9999.         INKCS056
00047      05  PC-98                    PIC  9(02)  VALUE 98.           INKCS056
00048      05  PC-15                    PIC  9(02)  VALUE 15.           INKCS056
00049      05  PC-11                    PIC  9(02)  VALUE 11.           INKCS056
00050      05  PC-9                     PIC  9(01)  VALUE 9.            INKCS056
00051      05  PC-7                     PIC  9(01)  VALUE 7.            INKCS056
W21732     05  PC-8                     PIC  9(01)  VALUE 8.            INKCS056
00053      05  PC-2                     PIC  9(01)  VALUE 2.            INKCS056
00054      05  PC-CO                    PIC  X(02)  VALUE 'CO'.         INKCS056
00055      05  PC-CORRECTION            PIC  X(10)  VALUE 'CORRECTION'. INKCS056
00056      05  PC-N                     PIC  X(01)  VALUE 'N'.          INKCS056
00057      05  PC-Y                     PIC  X(01)  VALUE 'Y'.          INKCS056
00058      05  PC-SCL                   PIC  X(03)  VALUE 'SCL'.        INKCS056
00059      05  PC-MAX-PRICE             PIC S9(05)V99 VALUE +99999.99   INKCS056
00060                                               COMP-3.             INKCS056
00061      05  PC-MAX-EXTENDED-PRICE    PIC S9(09)V99                   INKCS056
00062                                               VALUE +999999999.99 INKCS056
00063                                               COMP-3.             INKCS056
00064      05  PC-MIN-EXTENDED-PRICE    PIC S9(09)V99                   INKCS056
00065                                               VALUE -999999999.99 INKCS056
00066                                               COMP-3.             INKCS056
00067      05  PC-MAX-QUANTITY          PIC S9(07)    VALUE +99999      INKCS056
00068                                               COMP-3.             INKCS056
00069      05  PC-MIN-QUANTITY          PIC S9(07)    VALUE -99999      INKCS056
00070                                               COMP-3.             INKCS056
00071      05  PC-20-CENTS              PIC S9(01)V99 VALUE .20         INKCS056
00072                                               COMP-3.             INKCS056
00073      05  PC-PRIME1                PIC S9(05)  COMP-3              INKCS056
00074                                               VALUE +38543.       INKCS056
00075      05  PC-NINES-DATE            PIC X(10)   VALUE '9999-09-09'. INKCS056
00075      05  PC-PRIME2                PIC S9(05)  COMP-3              INKCS056
00076                                               VALUE +58889.       INKCS056
00077      05  PC-ONE-BILLION           PIC S9(11)  COMP-3              INKCS056
00078                                               VALUE +1000000000.  INKCS056
00079                                                                   INKCS056
00080      05  PC-TSYMSG-NUMBERS.                                       INKCS056
00081          10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       INKCS056
00082          10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       INKCS056
00083          10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       INKCS056
00084          10  PC-TSYMSG-00010      PIC  9(05)  VALUE  00010.       INKCS056
00085          10  PC-TSYMSG-00046      PIC  9(05)  VALUE  00046.       INKCS056
00086          10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       INKCS056
00087          10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       INKCS056
00088          10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       INKCS056
00089          10  PC-TSYMSG-00073      PIC  9(05)  VALUE  00073.       INKCS056
00090          10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       INKCS056
00091          10  PC-TSYMSG-00100      PIC  9(05)  VALUE  00100.       INKCS056
00092          10  PC-TSYMSG-00117      PIC  9(05)  VALUE  00117.       INKCS056
00093          10  PC-TSYMSG-00124      PIC  9(05)  VALUE  00124.       INKCS056
00094          10  PC-TSYMSG-00125      PIC  9(05)  VALUE  00125.       INKCS056
00095          10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       INKCS056
00096          10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       INKCS056
00097          10  PC-TSYMSG-00316      PIC  9(05)  VALUE  00316.       INKCS056
00098          10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       INKCS056
00099          10  PC-TSYMSG-00410      PIC  9(05)  VALUE  00410.       INKCS056
00100          10  PC-TSYMSG-00453      PIC  9(05)  VALUE  00453.       INKCS056
00101          10  PC-TSYMSG-00474      PIC  9(05)  VALUE  00474.       INKCS056
00102          10  PC-TSYMSG-00547      PIC  9(05)  VALUE  00547.       INKCS056
00103          10  PC-TSYMSG-00548      PIC  9(05)  VALUE  00548.       INKCS056
00104          10  PC-TSYMSG-00551      PIC  9(05)  VALUE  00551.       INKCS056
00105          10  PC-TSYMSG-00686      PIC  9(05)  VALUE  00686.       INKCS056
00106          10  PC-TSYMSG-00687      PIC  9(05)  VALUE  00687.       INKCS056
00107          10  PC-TSYMSG-00688      PIC  9(05)  VALUE  00688.       INKCS056
00108          10  PC-TSYMSG-00698      PIC  9(05)  VALUE  00698.       INKCS056
00108          10  PC-TSYMSG-02150      PIC  9(05)  VALUE  02150.       INKCS056
00109          10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       INKCS056
00110 *                                                                 INKCS056
00111  01  PS-PROGRAM-SWITCHES.                                         INKCS056
00112      05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         INKCS056
00113          88  PS-ERROR                         VALUE  'Y'.         INKCS056
00114          88  PS-WARNING                       VALUE  'W'.         INKCS056
00115          88  PS-NO-ERROR                      VALUE  'N'.         INKCS056
00116      05  PS-QTY-ENTERED-SW        PIC  X(01)  VALUE  'N'.         INKCS056
00117          88  PS-QTY-ENTERED                   VALUE  'Y'.         INKCS056
00118      05  PS-PRICE-ENTERED-SW      PIC  X(01)  VALUE  'N'.         INKCS056
00119          88  PS-PRICE-ENTERED                 VALUE  'Y'.         INKCS056
00560      05  PS-REASON-ENTERED-SW     PIC  X(01)  VALUE  'N'.         INKCS056
00561          88  PS-REASON-ENTERED                VALUE  'Y'.         INKCS056
00562      05  PS-GOOD-SKU-SW           PIC X(01)   VALUE  'N'.         INKCS056
00563          88  PS-GOOD-SKU                      VALUE  'Y'.         INKCS056
00564          88  PS-BAD-SKU                       VALUE  'N'.         INKCS056
00565      05  PS-INSERT-SW             PIC X(01)   VALUE  'N'.         INKCS056
00566          88  PS-INSERT-DONE                   VALUE  'Y'.         INKCS056
00567          88  PS-INSERT-NOT-DONE               VALUE  'N'.         INKCS056
00568      05  PS-ROW-EXISTS-SW         PIC X(01)   VALUE  'N'.         INKCS056
00569          88  PS-ROW-FOUND                     VALUE  'Y'.         INKCS056
00130          88  PS-ROW-NOT-FOUND                 VALUE  'N'.         INKCS056
00131      05  PS-QTY-PRICE-ERROR-SW    PIC X(01)   VALUE  'N'.         INKCS056
00132          88  PS-QTY-PRICE-ERROR               VALUE  'Y'.         INKCS056
00133      05  PS-SKU-ENTERED-SW        PIC  X(01).                     INKCS056
00134          88  PS-SKU-ENTERED                   VALUE 'Y'.          INKCS056
00135          88  PS-SKU-NOT-ENTERED               VALUE 'N'.          INKCS056
00136 *                                                                 INKCS056
00137  01  PV-PROGRAM-VARIABLES.                                        INKCS056
00138      05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            INKCS056
00139                                               COMP SYNC.          INKCS056
00140      05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            INKCS056
00141                                               COMP SYNC.          INKCS056
00142      05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            INKCS056
00143                                               COMP SYNC.          INKCS056
00144      05  PV-RBA                   PIC S9(09)  COMP VALUE ZERO.    INKCS056
00145      05  PV-DISPLAY-RESP          PIC  9(08)  VALUE ZERO.         INKCS056
00146      05  PV-WORK-PR-AMT-X.                                        INKCS056
00147          10  PV-WORK-PR-AMT       PIC S9(05)V99.                  INKCS056
00148      05  PV-TOT-EXT-PRICE         PIC S9(15)V99 COMP-3.           INKCS056
00149      05  PV-ADJ-EXT1              PIC S9(15)V99 COMP-3.           INKCS056
00150      05  PV-ADJ-EXT2              PIC S9(15)V99 COMP-3.           INKCS056
00151                                                                   INKCS056
W26600     05  PV-STORE-NBR-X           PIC X(04)     VALUE ZEROES.     INKCS056
W26600     05  PV-STORE-NBR-9 REDEFINES PV-STORE-NBR-X                          
W26600                                  PIC 9(04).                              
W26600     05  PV-STORE-NUMBER          PIC S9(04)    VALUE +0.         INKCS056
00152      05  PV-RENUMBERED-SKU.                                       INKCS056
W21732         10  PV-RSKU-NBR          PIC X(08).                      INKCS056
00158      05  PV-WORK-UPC-X2.                                          INKCS056
00159          10  FILLER               PIC X(4)    VALUE '0400'.       INKCS056
W21732         10  PV-UPC-SKU2          PIC X(8).                       INKCS056
00163          10  PV-UPC-CHK-DIG2      PIC 9       VALUE ZERO.         INKCS056
00164      05  PV-WORK-UPC2  REDEFINES  PV-WORK-UPC-X2                  INKCS056
00165                                   PIC 9(13).                      INKCS056
00166                                                                   INKCS056
00167      05  PV-WORK-SKU.                                             INKCS056
W21732         10  PV-WORK-SKU-NBR      PIC X(8).                       INKCS056
00173      05  PV-MAJ-CL-NBR.                                           INKCS056
00174          10  PV-MAJ-CL-NBR1       PIC X.                          INKCS056
00175          10  PV-MAJ-CL-NBR2       PIC X.                          INKCS056
00176      05  PV-SUB-CL-NBR.                                           INKCS056
00177          10  PV-SUB-CL-NBR1       PIC X      VALUE '0'.           INKCS056
00178          10  PV-SUB-CL-NBR2-3     PIC X(02).                      INKCS056
W21732     05  PV-EIGHT                 PIC 9(08).                      INKCS056
W21732     05  FILLER  REDEFINES  PV-EIGHT.                             INKCS056
W21732         10  PV-EIGHT-X           PIC X(08).                      INKCS056
00184                                                                   INKCS056
00185      05  PV-WORK-TMST.                                            INKCS056
00186          10  PV-WT-CC             PIC X(02).                      INKCS056
00187          10  PV-WT-YY             PIC X(02).                      INKCS056
00188          10  FILLER               PIC X(01).                      INKCS056
00189          10  PV-WT-MM             PIC X(02).                      INKCS056
00190          10  FILLER               PIC X(01).                      INKCS056
00191          10  PV-WT-DD             PIC X(02).                      INKCS056
00192          10  FILLER               PIC X(16).                      INKCS056
00193      05  PV-DISPLAY-DATE.                                         INKCS056
00194          10  PV-DD-MM             PIC XX.                         INKCS056
00195          10  FILLER               PIC X(01)   VALUE '/'.          INKCS056
00196          10  PV-DD-DD             PIC XX.                         INKCS056
00197          10  FILLER               PIC X(01)   VALUE '/'.          INKCS056
00198          10  PV-DD-YY             PIC XX.                         INKCS056
00199                                                                   INKCS056
00200      05  PV-RANDOM-NUMBER                PIC S9(11)   COMP-3      INKCS056
00201                                                       VALUE +0.   INKCS056
00202      05  PV-SEED                         PIC S9(11)   COMP-3      INKCS056
00203                                                       VALUE +0.   INKCS056
00204      05  PV-WORK-FIELD                   PIC S9(17)   COMP-3      INKCS056
00205                                                       VALUE +0.   INKCS056
00206      05  PV-WORK-FIELD2                  PIC S9(17)   COMP-3      INKCS056
00207                                                       VALUE +0.   INKCS056
00208      05  PV-TODAYS-TIME                  PIC 9(08)    VALUE ZERO. INKCS056
00209      05  FILLER  REDEFINES  PV-TODAYS-TIME.                       INKCS056
00210          10  PV-HH                       PIC 9(02).               INKCS056
00211          10  PV-MIN                      PIC 9(02).               INKCS056
00212          10  PV-SEC                      PIC 9(02).               INKCS056
00213          10  PV-HUND-SEC                 PIC 9(02).               INKCS056
00214      05  PV-INITIAL-SEED                 PIC 9(08)    VALUE ZERO. INKCS056
00215      05  FILLER REDEFINES PV-INITIAL-SEED.                        INKCS056
00216          10  PV-SEED-BYTE-1-2            PIC 9(02).               INKCS056
00217          10  PV-SEED-BYTE-3-4            PIC 9(02).               INKCS056
00218          10  PV-SEED-BYTE-5-6            PIC 9(02).               INKCS056
00219          10  PV-SEED-BYTE-7-8            PIC 9(02).               INKCS056
                                                                        INKCS056
00225      COPY INWS012.                                                INKCS056
                                                                        INKCS056
00232      COPY INKM056.                                                INKCS056
00233                                                                   INKCS056
00234  01  MR-OCCURS-LAYOUT                   REDEFINES  IN056AO.       INKCS056
W21732*    05  FILLER                         PIC X(131).               INKCS056
W25428*    05  FILLER                         PIC X(133).                       
W26600*    05  FILLER                         PIC X(138).                       
W26600     05  FILLER                         PIC X(142).                       
00236      05  MR-SCROLL-AREA                 OCCURS 6 TIMES.           INKCS056
00237          10  MR-USERIDL                 PIC S9(04) COMP.          INKCS056
00238          10  MR-USERIDA                 PIC  X(01).               INKCS056
00239          10  MR-USERIDC                 PIC  X(01).               INKCS056
00240          10  MR-USERIDH                 PIC  X(01).               INKCS056
00241          10  MR-USERIDO                 PIC  X(08).               INKCS056
00242                                                                   INKCS056
00243          10  MR-ADJ-DATEL               PIC S9(04) COMP.          INKCS056
00244          10  MR-ADJ-DATEA               PIC  X(01).               INKCS056
00245          10  MR-ADJ-DATEC               PIC  X(01).               INKCS056
00246          10  MR-ADJ-DATEH               PIC  X(01).               INKCS056
00247          10  MR-ADJ-DATEO               PIC  X(08).               INKCS056
00248                                                                   INKCS056
00249          10  MR-ADJ-QTYL                PIC S9(04) COMP.          INKCS056
00250          10  MR-ADJ-QTYA                PIC  X(01).               INKCS056
00251          10  MR-ADJ-QTYC                PIC  X(01).               INKCS056
00252          10  MR-ADJ-QTYH                PIC  X(01).               INKCS056
00253          10  MR-ADJ-QTYX.                                         INKCS056
00254              15  MR-ADJ-QTYO            PIC  -(06)9.              INKCS056
00255                                                                   INKCS056
00256          10  MR-ADJ-PRICEL              PIC S9(04) COMP.          INKCS056
00257          10  MR-ADJ-PRICEA              PIC  X(01).               INKCS056
00258          10  MR-ADJ-PRICEC              PIC  X(01).               INKCS056
00259          10  MR-ADJ-PRICEH              PIC  X(01).               INKCS056
00260          10  MR-ADJ-PRICEX.                                       INKCS056
00261              15  MR-ADJ-PRICEO          PIC  -(05).99.            INKCS056
00262                                                                   INKCS056
00263          10  MR-EXT-PRICEL              PIC S9(04) COMP.          INKCS056
00264          10  MR-EXT-PRICEA              PIC  X(01).               INKCS056
00265          10  MR-EXT-PRICEC              PIC  X(01).               INKCS056
00266          10  MR-EXT-PRICEH              PIC  X(01).               INKCS056
00267          10  MR-EXT-PRICEX.                                       INKCS056
00268              15  MR-EXT-PRICEO          PIC  -(10).99.            INKCS056
00269                                                                   INKCS056
00270          10  MR-ADJ-REASONL             PIC S9(04) COMP.          INKCS056
00271          10  MR-ADJ-REASONA             PIC  X(01).               INKCS056
00272          10  MR-ADJ-REASONC             PIC  X(01).               INKCS056
00273          10  MR-ADJ-REASONH             PIC  X(01).               INKCS056
00274          10  MR-ADJ-REASONO             PIC  X(20).               INKCS056
00275                                                                   INKCS056
00281      COPY DPWS015.                                                INKCS056
00282                                                                   INKCS056
00287      COPY DPWS016.                                                INKCS056
00288                                                                   INKCS056
00293      COPY INWS015.                                                INKCS056
                                                                        INKCS056
00299      COPY DPWS010I.                                               INKCS056
                                                                        INKCS056
00305      COPY DPWS040I.                                               INKCS056
                                                                        INKCS056
00311      COPY DPWS030.                                                INKCS056
1122RM     COPY DPWS930.                                                INKCS056
                                                                        INKCS056
00317      COPY DPWS020.                                                INKCS056
00318      05  INKCS056-APPL REDEFINES DP020-VARIABLE-COMMAREA.         INKCS056
00324          10  INTER-APPL-COMM-AREA PIC X(200).                     INKCS056
                                                                                
00325      COPY INWS001.                                                INKCS056
00329          10  ASC-SPECIFIC-COMMAREA.                               INKCS056
00330              15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            INKCS056
00331 *            15  ASC-STORE-NBR             PIC  X(03).            INKCS056
W26600             15  ASC-STORE-NBR             PIC  9(04).            INKCS056
W26600             15  ASC-STORE-NBR-X   REDEFINES                      INKCS056
W26600                 ASC-STORE-NBR             PIC  X(04).            INKCS056
00332              15  ASC-AREA-NBR              PIC S9(08)    COMP.    INKCS056
00333              15  ASC-ADJ-TYPE-CDE          PIC  X(02).            INKCS056
00334                  88  ASC-ADJ-TYPE-SI                  VALUE 'SI'. INKCS056
00335                  88  ASC-ADJ-TYPE-AD                  VALUE 'AD'. INKCS056
00336              15  ASC-ADJ-TYPE-CDE2         PIC  X(02).            INKCS056
00337                  88  ASC-ADJ-TYPE-MM                  VALUE 'MM'. INKCS056
00338                  88  ASC-ADJ-TYPE-AD2                 VALUE 'AD'. INKCS056
00336              15  ASC-ADJ-TYPE-CDE3         PIC  X(02).            INKCS056
00337                  88  ASC-ADJ-TYPE-SA                  VALUE 'SA'. INKCS056
00338                  88  ASC-ADJ-TYPE-AD3                 VALUE 'AD'. INKCS056
00339              15  ASC-ADD-NUM               PIC S9(04)    COMP.    INKCS056
00340                                                                   INKCS056
00341              15  ASC-KEY-DATA.                                    INKCS056
W25428                 20  ASC-SKU               PIC  X(08).                    
W25428                 20  ASC-SKU-NUM REDEFINES                                
W26600                     ASC-SKU               PIC  9(08).                    
W25428                 20  ASC-UPC               PIC  X(15).                    
W25428                 20  ASC-UPC-NUM REDEFINES                                
W25428                     ASC-UPC               PIC  Z(15).                    
W25428                 20  ASC-QTY               PIC S9(06)    COMP-3.          
W21732*                20  ASC-SKU-NBR           PIC  X(08).            INKCS056
00346 *                20  ASC-QTY               PIC S9(07)    COMP-3.  INKCS056
00347                  20  ASC-PRICE             PIC S9(05)V99 COMP-3.  INKCS056
00348                  20  ASC-TABLE-FROM        PIC  X(01).            INKCS056
00349                      88  ASC-FROM-TSUMINV              VALUE 'S'. INKCS056
00350                      88  ASC-FROM-TADJADD              VALUE 'A'. INKCS056
W25428                     88  ASC-FROM-TADJDTL              VALUE 'D'.         
00351              15  ASC-DKEY-NBR              PIC S9(08)    COMP.    INKCS056
00352                                                                   INKCS056
00353              15  ASC-USE-SELECTION-SW      PIC  X(01).            INKCS056
00354                  88  ASC-USE-SELECTION-QUEUE           VALUE 'S'. INKCS056
00355                  88  ASC-NO-SELECTION-QUEUE            VALUE 'N'. INKCS056
00356              15  ASC-READ-TABLES-SW        PIC  X(01).            INKCS056
00357                  88  ASC-MUST-READ-TABLES              VALUE 'Y'. INKCS056
00358                  88  ASC-DONT-READ-TABLES              VALUE 'N'. INKCS056
00359              15  ASC-DATA-EXISTS-SW        PIC  X(01).            INKCS056
00360                  88  ASC-ADD-NEW                       VALUE 'N'. INKCS056
00361                  88  ASC-ADD-EXIST                     VALUE 'E'. INKCS056
00362              15  ASC-ALLOW-ADJUSTMENTS-SW  PIC  X(01).            INKCS056
00363                  88  ASC-ADJUSTMENTS-ALLOWED           VALUE 'Y'. INKCS056
00364                  88  ASC-NO-ADJUSTMENTS-ALLOWED        VALUE 'N'. INKCS056
00365                                                                   INKCS056
00366              15  ASC-SEL-QUEUE-NAME        PIC  X(08).            INKCS056
00367              15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    INKCS056
00368              15  ASC-NUMBER-OF-SELECTED-ITEMS                     INKCS056
00369                                            PIC S9(09)  COMP-3.    INKCS056
00370              15  ASC-SEL-SUB               PIC S9(04)  COMP.      INKCS056
00371              15  ASC-SEL-ITEM              PIC S9(04)  COMP.      INKCS056
00372                                                                   INKCS056
00373          12  ASC-INIT-ALL-ASC.                                    INKCS056
00374              15  ASC-INIT-AREA.                                   INKCS056
00375                17  ASC-MAP-TABLE OCCURS 6 TIMES.                  INKCS056
00376                  20  ASC-MAP-USERID        PIC  X(08).            INKCS056
00377                  20  ASC-MAP-ADJ-DATE      PIC  X(08).            INKCS056
00378                  20  ASC-MAP-ADJ-QTY       PIC S9(07)    COMP-3.  INKCS056
00379                  20  ASC-MAP-ADJ-PRICE     PIC S9(05)V99 COMP-3.  INKCS056
00380                  20  ASC-MAP-ADJ-EXT-PRICE PIC S9(11)V99 COMP-3.  INKCS056
00381                  20  ASC-MAP-REASON        PIC  X(20).            INKCS056
00382                17  ASC-MAP-SUB             PIC S9(04)    COMP.    INKCS056
00383                                                                   INKCS056
00384                17  ASC-ORIG-QTY            PIC S9(07)    COMP-3.  INKCS056
00385                17  ASC-ORIG-PRICE          PIC S9(05)V99 COMP-3.  INKCS056
00386                17  ASC-ORIG-EXT-PRICE      PIC S9(09)V99 COMP-3.  INKCS056
00387                17  ASC-ORIG-REASON         PIC  X(20).            INKCS056
00388                17  ASC-STATUS-CODE         PIC S9(03)    COMP-3.  INKCS056
00389                    88  ASC-CLEARANCE                   VALUE 30.  INKCS056
00390                                                                   INKCS056
00391                17  ASC-NEW-QTY-X.                                 INKCS056
00392                  20  ASC-NEW-QTY           PIC S9(07).            INKCS056
00393                17  ASC-NEW-PRICE-X.                               INKCS056
00394                  20  ASC-NEW-PRICE         PIC S9(06)V99.         INKCS056
00395                17  ASC-NEW-EXT-PRICE       PIC S9(11)V99 COMP-3.  INKCS056
00396                17  ASC-NEW-REASON          PIC  X(20).            INKCS056
00397                                                                   INKCS056
00398                17  ASC-ADJ-QTY             PIC S9(07)    COMP-3.  INKCS056
00399                17  ASC-ADJ-PRICE           PIC S9(05)V99 COMP-3.  INKCS056
00400                17  ASC-ACT-ADJ-QTY         PIC S9(07)    COMP-3.  INKCS056
00401                17  ASC-ACT-ADJ-PRICE       PIC S9(07)V99 COMP-3.  INKCS056
00402                17  ASC-TOT-QTY             PIC S9(7)     COMP-3.  INKCS056
00403                17  ASC-TOT-PRICE           PIC S9(5)V99  COMP-3.  INKCS056
00404                17  ASC-TOT-EXT-PRICE       PIC S9(11)V99  COMP-3. INKCS056
00405                17  ASC-PRICE-ERROR-SW      PIC  X(1).             INKCS056
00406                    88  ASC-PRICE-ERROR                  VALUE 'E'.INKCS056
00407                    88  ASC-NO-PRICE-ERROR               VALUE 'N'.INKCS056
00408                17  ASC-QTY-ERROR-SW        PIC  X(1).             INKCS056
00409                    88  ASC-QTY-ERROR                    VALUE 'E'.INKCS056
00410                    88  ASC-NO-QTY-ERROR                 VALUE 'N'.INKCS056
00411              15  ASC-INIT-AREA-END         PIC  X(1).             INKCS056
00412            12    ASC-INIT-ALL-ASC-END.                            INKCS056
00413                                                                   INKCS056
00414              15  ASC-HOLD-INTER-APPL       PIC  X(200).           INKCS056
00420                                                                   INKCS056
00421      COPY DPWS013.                                                INKCS056
00422                                                                   INKCS056
W21732*****************************************************************         
W21732*    COPYBOOK FOR NI-SKU WORK FIELDS.                             INKCS056
W21732*****************************************************************         
W21732     COPY ISWS006.                                                INKCS056
W21732                                                                  INKCS056
00429                                                                   INKCS056
      *****************************************************************         
00424 *    DB2 AREA FOR TSUMINV (PI SUMMARY INVENTORY)                  INKCS056
      *****************************************************************         
00425                                                                   INKCS056
00426      EXEC SQL                                                     INKCS056
W26600          INCLUDE TSUMINV                                         INKCS056
00428      END-EXEC.                                                    INKCS056
00429                                                                   INKCS056
      *****************************************************************         
00430 *    DB2 AREA FOR TADJADD (PI ADJUSTMENT ADD)                     INKCS056
      *****************************************************************         
00431                                                                   INKCS056
00432      EXEC SQL                                                     INKCS056
W26600          INCLUDE TADJADD                                         INKCS056
00434      END-EXEC.                                                    INKCS056
00435                                                                   INKCS056
      *****************************************************************         
00436 *    DB2 AREA FOR TADJADD (PI ADJUSTMENT DETAIL)                  INKCS056
      *****************************************************************         
00437                                                                   INKCS056
00438      EXEC SQL                                                     INKCS056
W26600          INCLUDE TADJDTL                                         INKCS056
00440      END-EXEC.                                                    INKCS056
00441                                                                   INKCS056
W21732*****************************************************************         
W21732*    DB2 AREA FOR TSKXREF (SKU)                                   INKCS056
W21732*****************************************************************         
W21732                                                                  INKCS056
W21732     EXEC SQL                                                     INKCS056
W21732          INCLUDE TSKXREF                                         INKCS056
W21732     END-EXEC.                                                    INKCS056
W21732                                                                  INKCS056
      *****************************************************************         
00448 *    DB2 AREA FOR TUPCSKU (UPC/SKU XREF)                          INKCS056
      *****************************************************************         
00449                                                                   INKCS056
00450      EXEC SQL                                                     INKCS056
00451           INCLUDE TUPCSKU                                         INKCS056
00452      END-EXEC.                                                    INKCS056
00453                                                                   INKCS056
      *****************************************************************         
00454 *    DB2 AREA FOR TMDSEAR (MERCHANDISE AREA)                      INKCS056
      *****************************************************************         
00455                                                                   INKCS056
00456      EXEC SQL                                                     INKCS056
00457           INCLUDE TMDSEAR                                         INKCS056
00458      END-EXEC.                                                    INKCS056
00459                                                                   INKCS056
      *****************************************************************         
00460 *    DB2 AREA FOR COMMUNICATIONS                                  INKCS056
      *****************************************************************         
00461                                                                   INKCS056
00462      EXEC SQL                                                     INKCS056
00463           INCLUDE SQLCA                                           INKCS056
00464      END-EXEC.                                                    INKCS056
00465                                                                   INKCS056
      *****************************************************************         
00466 *    ADJUSTMENT DETAIL CURSOR                                     INKCS056
      *****************************************************************         
00467                                                                   INKCS056
00468      EXEC SQL DECLARE ADJ-CSR CURSOR FOR                          INKCS056
00469           SELECT                                                  INKCS056
00470                    ADJ_UNIT_PR_AMT                                INKCS056
00471                ,   ADJ_QTY                                        INKCS056
00472                ,   ADJ_EXTD_AMT                                   INKCS056
00473                ,   ADJ_RSN_TXT                                    INKCS056
00474                ,   CRE_TMST                                       INKCS056
00475                ,   CRE_ID_NBR                                     INKCS056
00476           FROM                                                    INKCS056
00477                  TADJDTL                                          INKCS056
00478           WHERE                                                   INKCS056
W26600                 LOC_NBR            =  :ADJDTL-LOC-NBR            INKCS056
00480             AND  AREA_NBR           =  :ASC-AREA-NBR              INKCS056
W26600            AND  SKU_NBR            =  :ADJDTL-SKU-NBR            INKCS056
W26600*           AND  UPC_NBR            =  :ADJDTL-UPC-NBR            INKCS056
W26600*           AND  DKEY_NBR           =  :ASC-DKEY-NBR              INKCS056
W26600            AND (ADJ_TYPE_CDE       =  :ASC-ADJ-TYPE-CDE          INKCS056
W26600             OR  ADJ_TYPE_CDE       =  :ASC-ADJ-TYPE-CDE2                 
W26600             OR  ADJ_TYPE_CDE       =  :ASC-ADJ-TYPE-CDE3)                
00484           ORDER BY                                                INKCS056
00485                  CRE_TMST                                         INKCS056
00486      END-EXEC.                                                    INKCS056
00487                                                                   INKCS056
      /****************************************************************         
00489  LINKAGE SECTION.                                                 INKCS056
      *****************************************************************         
00491  01  DFHCOMMAREA.                                                 INKCS056
00492      05  FILLER                         OCCURS  1 TO 4072 TIMES   INKCS056
00493                                         DEPENDING ON EIBCALEN.    INKCS056
00494          10  FILLER                     PIC X.                    INKCS056
00495                                                                   INKCS056
00496                                                                   INKCS056
00497  PROCEDURE DIVISION.                                              INKCS056
00498 **-------------------------------------------------------------** INKCS056
00499 ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** INKCS056
00500 ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** INKCS056
00501 ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** INKCS056
00502 **                                                             ** INKCS056
00503 ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** INKCS056
00504 ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** INKCS056
00505 **-------------------------------------------------------------** INKCS056
00506                                                                   INKCS056
00507  0000-MAIN-MODULE.                                                INKCS056
00508                                                                   INKCS056
00509      INITIALIZE DP030-CICS-API-FIELDS.                            INKCS056
00510      MOVE +1                       TO DP030-NUMBER-OF-MAPS.       INKCS056
00511      MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          INKCS056
00512      MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         INKCS056
00513                                                                   INKCS056
00514      SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       INKCS056
00515      MOVE LENGTH OF IN056AI        TO DP030-MAP-LENGTH (1).       INKCS056
00516      MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     INKCS056
00517      PERFORM 0001-CALL-CICS-ARCH-API.                             INKCS056
00518                                                                   INKCS056
00519      PERFORM 1000-CONTROL-PROCESSING                              INKCS056
00520                                                                   INKCS056
00521      MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     INKCS056
00522      PERFORM 0001-CALL-CICS-ARCH-API.                             INKCS056
00523                                                                   INKCS056
00524  0001-CALL-CICS-ARCH-API.                                         INKCS056
00525                                                                   INKCS056
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               INKCS056
1122RM     CALL DP930-CICS-ARCH-API                                             
1122RM                     USING DFHEIBLK                                       
00527                            DFHCOMMAREA                            INKCS056
00528                            DP030-CICS-API-FIELDS                  INKCS056
00529                            DP020-STANDARD-COMMAREA                INKCS056
00530                            IN056AI.                               INKCS056
00531                                                                   INKCS056
00532      IF  DP030-RC-CALL-SUCCESSFUL                                 INKCS056
00533          CONTINUE                                                 INKCS056
00534      ELSE                                                         INKCS056
00535          SET DP013-NO-ROLLBACK                                    INKCS056
00536              DP013-XCTL-DISPLAY-RESTART                           INKCS056
00537              DP013-CICS-ABEND      TO TRUE                        INKCS056
00538          MOVE 'BEFORE 0000-MAIN-MODULE'                           INKCS056
00539                                    TO DP013-PARAGRAPH             INKCS056
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEXINKCS056
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      INKCS056
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
00542          MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      INKCS056
00543          PERFORM DP013-0000-PROCESS-ABEND                         INKCS056
00544      END-IF.                                                      INKCS056
00545 /                                                                 INKCS056
00546 *----------------------------------------------------------------*INKCS056
00547 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *INKCS056
00548 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *INKCS056
00549 *----------------------------------------------------------------*INKCS056
00550                                                                   INKCS056
00551  1000-CONTROL-PROCESSING.                                         INKCS056
00552                                                                   INKCS056
                                                                                
00553      EVALUATE TRUE                                                INKCS056
00554          WHEN DP020-NEXT-ACT-INITIAL                              INKCS056
00555               PERFORM 1100-FIND-OBJECT-KEYS                       INKCS056
00556               IF  PS-ERROR                                        INKCS056
00557                   CONTINUE                                        INKCS056
00558               ELSE                                                INKCS056
00559                   MOVE INTER-APPL-COMM-AREA                       INKCS056
00560                                    TO  ASC-HOLD-INTER-APPL        INKCS056
00561                   IF  ASC-USE-SELECTION-QUEUE                     INKCS056
00562                       SET ASC-DONT-READ-TABLES                    INKCS056
00563                                    TO  TRUE                       INKCS056
00564                       PERFORM 4000-BUILD-INITIAL-PANEL            INKCS056
00565                       IF  SQLCODE = +100                          INKCS056
00566                           MOVE PC-TSYMSG-00148                    INKCS056
00567                                    TO  DP020-MSG-NUMBER           INKCS056
00568                           SET DP020-MSG-INFORMATIONAL             INKCS056
00569                               DP020-NEXT-ACT-APPL-ERROR           INKCS056
00570                                    TO  TRUE                       INKCS056
00571                       END-IF                                      INKCS056
00572                   ELSE                                            INKCS056
W21732                      MOVE -1      TO ANSKUL                      INKCS056
00574                       SET ASC-MUST-READ-TABLES                    INKCS056
00575                           DP030-SET-CURSOR-APPL-1                 INKCS056
00576                                    TO  TRUE                       INKCS056
00577                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        INKCS056
00578                   END-IF                                          INKCS056
00579                                                                   INKCS056
00580                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS056
00581               END-IF                                              INKCS056
00582                                                                   INKCS056
00583          WHEN DP020-NEXT-ACT-READ-MAP                             INKCS056
00584               PERFORM 2000-PROCESS-PANEL                          INKCS056
00585                                                                   INKCS056
00586          WHEN DP020-NEXT-ACT-RETURN                               INKCS056
00587               MOVE ASC-HOLD-INTER-APPL                            INKCS056
00588                                    TO  INTER-APPL-COMM-AREA       INKCS056
00589               PERFORM 3000-EDIT-DATA-IN-COMMAREA                  INKCS056
00590               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS056
00591                                                                   INKCS056
00592          WHEN OTHER                                               INKCS056
00593               SET DP013-LOGIC-ABEND TO TRUE                       INKCS056
00594               SET DP013-NO-ROLLBACK TO TRUE                       INKCS056
00595               MOVE '1000-CONTROL-PROCESSING'                      INKCS056
00596                                    TO  DP013-PARAGRAPH            INKCS056
00597               MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  INKCS056
00598                                    TO  DP013-MESSAGE-TEXT(1)      INKCS056
00599               MOVE DP020-NEXT-APPL-ACTIVITY                       INKCS056
00600                                    TO  DP013-MESSAGE-TEXT(2)      INKCS056
00601               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
00602      END-EVALUATE.                                                INKCS056
00603                                                                   INKCS056
00604 *----------------------------------------------------------------*INKCS056
00605 *  DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE    *INKCS056
00606 *  INTER-APPLICATION FORMAT CODE.                                *INKCS056
00607 *----------------------------------------------------------------*INKCS056
00608                                                                   INKCS056
00609  1100-FIND-OBJECT-KEYS.                                           INKCS056
00610                                                                   INKCS056
00611      INITIALIZE ASC-SPECIFIC-COMMAREA.                            INKCS056
00612      MOVE DP020-INT-APPL-FORMAT-IND                               INKCS056
00613                                    TO  ASC-INT-APPL-FORMAT-IND.   INKCS056
00614                                                                   INKCS056
00615      EVALUATE DP020-INT-APPL-FORMAT-IND                           INKCS056
00616          WHEN PC-INTER-APPL-CRIT-SPEC                             INKCS056
00617               IF (IN001-STORE-NBR NUMERIC                         INKCS056
00618               AND IN001-AREA-NBR NUMERIC)                         INKCS056
00619                   MOVE IN001-STORE-NBR                            INKCS056
00620                                    TO  ASC-STORE-NBR              INKCS056
W26600                  MOVE ASC-STORE-NBR TO                           INKCS056
W26600                                       PV-STORE-NUMBER            INKCS056
00621                   MOVE IN001-AREA-NBR                             INKCS056
00622                                    TO  ASC-AREA-NBR               INKCS056
00623                   SET ASC-NO-SELECTION-QUEUE                      INKCS056
00624                       ASC-ADD-NEW                                 INKCS056
00625                                    TO  TRUE                       INKCS056
00626               ELSE                                                INKCS056
00627                   MOVE PC-TSYMSG-00148                            INKCS056
00628                                    TO  DP020-MSG-NUMBER           INKCS056
00629                   SET DP020-MSG-FATAL                             INKCS056
00630                       DP020-NEXT-ACT-APPL-ERROR                   INKCS056
00631                                    TO  TRUE                       INKCS056
00632               END-IF                                              INKCS056
00633                                                                   INKCS056
00634          WHEN PC-INTER-APPL-LIST                                  INKCS056
00635               SET ASC-USE-SELECTION-QUEUE                         INKCS056
00636                   ASC-ADD-EXIST    TO  TRUE                       INKCS056
00637               MOVE IN001-NUMBER-OF-SELECTED-ITEMS                 INKCS056
00638                                    TO ASC-NUMBER-OF-SELECTED-ITEMSINKCS056
00639               MOVE IN001-NUMBER-OF-TS-ITEMS                       INKCS056
00640                                    TO  ASC-NUMBER-OF-TS-ITEMS     INKCS056
00641               MOVE IN001-SEL-QUEUE-NAME                           INKCS056
00642                                    TO  ASC-SEL-QUEUE-NAME         INKCS056
00643               PERFORM 1120-PREPARE-LIST-ENTRY                     INKCS056
00644                                                                   INKCS056
00645          WHEN OTHER                                               INKCS056
00646               MOVE PC-TSYMSG-00148 TO  DP020-MSG-NUMBER           INKCS056
00647               SET DP020-MSG-FATAL                                 INKCS056
00648                   DP020-NEXT-ACT-APPL-ERROR                       INKCS056
00649                                    TO TRUE                        INKCS056
00650      END-EVALUATE.                                                INKCS056
00651                                                                   INKCS056
00652                                                                   INKCS056
00653 *----------------------------------------------------------------*INKCS056
00654 * ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *INKCS056
00655 * STORAGE QUEUE PASSED FROM THE LIST.                            *INKCS056
00656 *----------------------------------------------------------------*INKCS056
00657                                                                   INKCS056
00658  1120-PREPARE-LIST-ENTRY.                                         INKCS056
00659                                                                   INKCS056
00660      MOVE IN012-MAX-ITEMS          TO ASC-SEL-SUB.                INKCS056
00661      MOVE ZERO                     TO ASC-SEL-ITEM.               INKCS056
00662      PERFORM 2110-GET-NEXT-LINE.                                  INKCS056
00663                                                                   INKCS056
00664 *----------------------------------------------------------------*INKCS056
00665 * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *INKCS056
00666 * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *INKCS056
00667 * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *INKCS056
00668 * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *INKCS056
00669 * FUNCTION KEYS CAN GET THIS FAR.                                *INKCS056
00670 *----------------------------------------------------------------*INKCS056
00671                                                                   INKCS056
00672  2000-PROCESS-PANEL.                                              INKCS056
00673                                                                   INKCS056
00674      IF  IN001-STORE-NBR NOT NUMERIC                              INKCS056
00675          MOVE ASC-HOLD-INTER-APPL TO INTER-APPL-COMM-AREA         INKCS056
00676      END-IF.                                                      INKCS056
00677                                                                   INKCS056
00678      EVALUATE TRUE                                                INKCS056
00679                                                                   INKCS056
00680          WHEN DP020-SRC-AID = DP016-CLEAR                         INKCS056
00681               IF  ASC-MUST-READ-TABLES                            INKCS056
W21732                  MOVE -1          TO  ANSKUL                     INKCS056
00683                   SET DP030-SET-CURSOR-APPL-1                     INKCS056
00684                                    TO  TRUE                       INKCS056
00685               ELSE                                                INKCS056
00686                   PERFORM 3000-EDIT-DATA-IN-COMMAREA              INKCS056
00687               END-IF                                              INKCS056
00688               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS056
00689                                                                   INKCS056
00690          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     INKCS056
00691               SET DP030-DONT-ERASE                                INKCS056
00692                   DP030-SEND-DATAONLY (PC-APPL-MAP)               INKCS056
00693                                    TO TRUE                        INKCS056
00694               MOVE ZERO            TO  ASC-NEW-QTY                INKCS056
00695                                        ASC-NEW-PRICE              INKCS056
00696                                        ADADJQTO                   INKCS056
00697                                        ADADJPRO                   INKCS056
00698                                        ADEXTPRO                   INKCS056
00699               MOVE SPACE           TO  ANREASNO                   INKCS056
00700                                        ASC-NEW-REASON             INKCS056
00701               IF  ASC-ADD-NEW                                     INKCS056
W21732                  MOVE -1          TO  ANSKUL                     INKCS056
00703                   SET DP030-SET-CURSOR-APPL-1                     INKCS056
00704                                    TO  TRUE                       INKCS056
W21732                  MOVE SPACE       TO  ANSKUO                     INKCS056
W25428                                       ASC-SKU                            
W25428                  MOVE SPACES      TO  ANUPCO                             
W25428                                       ASC-UPC                            
W21732*                                      ASC-SKU-NBR                INKCS056
00711                   INITIALIZE ASC-INIT-ALL-ASC                     INKCS056
00712                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            INKCS056
00713                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS056
00714               ELSE                                                INKCS056
00715                   PERFORM 4000-BUILD-INITIAL-PANEL                INKCS056
00716                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS056
00717               END-IF                                              INKCS056
00718                                                                   INKCS056
00719          WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             INKCS056
00720               IF  ASC-USE-SELECTION-QUEUE                         INKCS056
00721                   PERFORM 2110-GET-NEXT-LINE                      INKCS056
00722                   PERFORM 4000-BUILD-INITIAL-PANEL                INKCS056
00723                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS056
00724               ELSE                                                INKCS056
00725 *                 --- BOTTOM OF LIST ---                          INKCS056
00726                   MOVE PC-TSYMSG-00070                            INKCS056
00727                                    TO DP020-MSG-NUMBER            INKCS056
00728                   SET DP020-MSG-INFORMATIONAL                     INKCS056
00729                                    TO TRUE                        INKCS056
00730               END-IF                                              INKCS056
00731                                                                   INKCS056
00732          WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             INKCS056
00733               IF  ASC-USE-SELECTION-QUEUE                         INKCS056
00734                   PERFORM 2120-GET-PREV-LINE                      INKCS056
00735                   PERFORM 4000-BUILD-INITIAL-PANEL                INKCS056
00736                   PERFORM 3200-RESET-ATTRIBUTES                   INKCS056
00737               ELSE                                                INKCS056
00738 *                 --- TOP OF LIST ---                             INKCS056
00739                   MOVE PC-TSYMSG-00069                            INKCS056
00740                                    TO DP020-MSG-NUMBER            INKCS056
00741                   SET DP020-MSG-INFORMATIONAL                     INKCS056
00742                                    TO TRUE                        INKCS056
00743               END-IF                                              INKCS056
00744                                                                   INKCS056
00745          WHEN OTHER                                               INKCS056
00746               PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                INKCS056
00747               PERFORM 3000-EDIT-DATA-IN-COMMAREA                  INKCS056
00748               IF  PS-NO-ERROR                                     INKCS056
00749                   SET DP030-CONTINUE-GO                           INKCS056
00750                                    TO TRUE                        INKCS056
00751                   PERFORM 2100-CHECK-FUNCTION-KEY                 INKCS056
00752               ELSE                                                INKCS056
00753                   SET DP030-OVERRIDE-GO                           INKCS056
00754                                    TO TRUE                        INKCS056
00755                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            INKCS056
00756               END-IF                                              INKCS056
00757      END-EVALUATE.                                                INKCS056
00758                                                                   INKCS056
00759 *----------------------------------------------------------------*INKCS056
00760 * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *INKCS056
00761 * FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *INKCS056
00762 * FROM THE CICS ARCHITECTURE API.                                *INKCS056
00763 *----------------------------------------------------------------*INKCS056
00764                                                                   INKCS056
00765  2100-CHECK-FUNCTION-KEY.                                         INKCS056
00766                                                                   INKCS056
00767      EVALUATE TRUE                                                INKCS056
00768          WHEN DP020-SRC-AID = DP016-ENTER                         INKCS056
00769               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                INKCS056
00770                                                                   INKCS056
00798          WHEN OTHER                                               INKCS056
00799               SET DP013-NO-ROLLBACK                               INKCS056
00800                   DP013-XCTL-DISPLAY-RESTART                      INKCS056
00801                   DP013-CICS-ABEND  TO TRUE                       INKCS056
00802               MOVE '2100-CHECK-FUNCTION-KEY'                      INKCS056
00803                                    TO DP013-PARAGRAPH             INKCS056
00804               MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     INKCS056
00805                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
00806               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
00807      END-EVALUATE.                                                INKCS056
00808                                                                   INKCS056
00809 *----------------------------------------------------------------*INKCS056
00810 *    RETRIEVE THE NEXT KEY FOR PROCESSING.                       *INKCS056
00811 *----------------------------------------------------------------*INKCS056
00812                                                                   INKCS056
00813  2110-GET-NEXT-LINE.                                              INKCS056
00814                                                                   INKCS056
00815      ADD +1                        TO  ASC-SEL-SUB.               INKCS056
00816      IF  ASC-SEL-SUB > IN012-MAX-ITEMS                            INKCS056
00817          ADD +1                    TO  ASC-SEL-ITEM               INKCS056
00818          MOVE +1                   TO  ASC-SEL-SUB                INKCS056
00819      END-IF.                                                      INKCS056
00820                                                                   INKCS056
00821      IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                INKCS056
00822          PERFORM 9100-READ-SEL-QUEUE                              INKCS056
00823          IF  IN012-ITEM (ASC-SEL-SUB) > ZERO                      INKCS056
00824              INITIALIZE ASC-INIT-ALL-ASC                          INKCS056
00825              MOVE IN012-KEY-DATA (ASC-SEL-SUB)                    INKCS056
00826                                    TO  ASC-KEY-DATA               INKCS056
00827              SET IN012-INQ (ASC-SEL-SUB)                          INKCS056
00828                                    TO  TRUE                       INKCS056
00829              PERFORM 9200-REWRITE-SEL-QUEUE                       INKCS056
00830          ELSE                                                     INKCS056
00831              SUBTRACT +1 FROM ASC-SEL-SUB                         INKCS056
00832 *            --- BOTTOM OF LIST ---                               INKCS056
00833              MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER           INKCS056
00834              SET DP020-MSG-INFORMATIONAL                          INKCS056
00835                                    TO  TRUE                       INKCS056
00836          END-IF                                                   INKCS056
00837      ELSE                                                         INKCS056
00838          SUBTRACT +1 FROM ASC-SEL-ITEM                            INKCS056
00839          MOVE IN012-MAX-ITEMS      TO  ASC-SEL-SUB                INKCS056
00840          MOVE PC-TSYMSG-00070      TO  DP020-MSG-NUMBER           INKCS056
00841          SET DP020-MSG-INFORMATIONAL                              INKCS056
00842                                    TO  TRUE                       INKCS056
00843      END-IF.                                                      INKCS056
00844                                                                   INKCS056
00845 *----------------------------------------------------------------*INKCS056
00846 *  GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED         *INKCS056
00847 *  OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.           *INKCS056
00848 *----------------------------------------------------------------*INKCS056
00849                                                                   INKCS056
00850  2120-GET-PREV-LINE.                                              INKCS056
00851                                                                   INKCS056
00852      SUBTRACT +1 FROM ASC-SEL-SUB.                                INKCS056
00853      IF  ASC-SEL-SUB < +1                                         INKCS056
00854          SUBTRACT +1 FROM ASC-SEL-ITEM                            INKCS056
00855          MOVE IN012-MAX-ITEMS      TO ASC-SEL-SUB                 INKCS056
00856      END-IF.                                                      INKCS056
00857                                                                   INKCS056
00858      IF  ASC-SEL-ITEM > ZERO                                      INKCS056
00859          INITIALIZE ASC-INIT-ALL-ASC                              INKCS056
00860          PERFORM 9100-READ-SEL-QUEUE                              INKCS056
00861          MOVE IN012-KEY-DATA (ASC-SEL-SUB)                        INKCS056
00862                                    TO ASC-KEY-DATA                INKCS056
00863      ELSE                                                         INKCS056
00864          MOVE +1                   TO ASC-SEL-ITEM                INKCS056
00865                                       ASC-SEL-SUB                 INKCS056
00866 *        --- TOP OF LIST ---                                      INKCS056
00867          MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            INKCS056
00868          SET DP020-MSG-INFORMATIONAL                              INKCS056
00869                                    TO TRUE                        INKCS056
00870      END-IF.                                                      INKCS056
00871 /                                                                 INKCS056
00872 *----------------------------------------------------------------*INKCS056
00873 * MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *INKCS056
00874 * IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *INKCS056
00875 * THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *INKCS056
00876 *----------------------------------------------------------------*INKCS056
00877                                                                   INKCS056
00878  2200-MOVE-SCREEN-TO-COMMAREA.                                    INKCS056
00879                                                                   INKCS056
W21732     IF  ANSKUL  > ZERO                                           INKCS056
W21732*        MOVE ANSKUI               TO  ASC-SKU-NBR                INKCS056
W25428         MOVE ANSKUI               TO  ASC-SKU                    INKCS056
W21732*        IF  ASC-SKU-NBR EQUAL SPACES                             INKCS056
W25428         IF  ASC-SKU     EQUAL SPACES                             INKCS056
00883              SET PS-SKU-NOT-ENTERED                               INKCS056
00884                                    TO  TRUE                       INKCS056
W21732*            MOVE SPACE            TO  ASC-SKU-NBR                INKCS056
W25428             MOVE SPACE            TO  ASC-SKU                    INKCS056
00888          ELSE                                                     INKCS056
00889              SET PS-SKU-ENTERED    TO  TRUE                       INKCS056
00890          END-IF                                                   INKCS056
00891      ELSE                                                         INKCS056
W21732         IF  ANSKUF  = DP015-ERASE-EOF                            INKCS056
00893              SET PS-SKU-ENTERED                                   INKCS056
00894                                    TO  TRUE                       INKCS056
W21732*            MOVE SPACE            TO  ASC-SKU-NBR                INKCS056
W25428             MOVE SPACE            TO  ASC-SKU                    INKCS056
00898          END-IF                                                   INKCS056
00899      END-IF.                                                      INKCS056
W25428                                                                          
W25428*    IF  ANUPCL > 0                                                       
W25428*        SET PS-UPC-ENTERED        TO  TRUE                               
W25428*        MOVE ANUPCI               TO  ASC-UPC                            
W25428*        MOVE ASC-UPC              TO  PV-UPC                             
W25428*    ELSE                                                                 
W25428*        IF  ANUPCF = DP015-ERASE-EOF                                     
SCOTT8**********   SET PS-UPC-ENTERED    TO  TRUE                               
W25428*            SET PS-UPC-NOT-ENTERED    TO  TRUE                           
W25428*            MOVE SPACE            TO  ASC-UPC                            
W25428*        END-IF                                                           
W25428*    END-IF.                                                              
W25428*                                                                         
00900                                                                   INKCS056
00921      IF  PS-SKU-ENTERED                                           INKCS056
00922          MOVE ZERO                 TO  ADADJQTO                   INKCS056
00923                                        ADADJPRO                   INKCS056
00924                                        ADEXTPRO                   INKCS056
00925      END-IF.                                                      INKCS056
00926                                                                   INKCS056
00927      IF  ANADJQTL > ZERO                                          INKCS056
00928          SET PS-QTY-ENTERED        TO  TRUE                       INKCS056
00929          MOVE ANADJQTI             TO  ASC-NEW-QTY-X              INKCS056
00930          IF  ASC-NEW-QTY-X EQUAL SPACES                           INKCS056
00931              MOVE ZERO             TO  ASC-NEW-QTY-X              INKCS056
00932          END-IF                                                   INKCS056
00933      ELSE                                                         INKCS056
00934          IF  ANADJQTF = DP015-ERASE-EOF                           INKCS056
00935              MOVE ZERO             TO  ASC-NEW-QTY-X              INKCS056
00936          END-IF                                                   INKCS056
00937      END-IF.                                                      INKCS056
00938                                                                   INKCS056
00939      IF  ANADJPRL > ZERO                                          INKCS056
00940          MOVE ANADJPRI             TO  ASC-NEW-PRICE-X            INKCS056
00941          IF  ASC-NEW-PRICE-X NOT EQUAL SPACES                     INKCS056
00942              SET PS-PRICE-ENTERED  TO  TRUE                       INKCS056
00943          ELSE                                                     INKCS056
00944              MOVE ZERO             TO  ASC-NEW-PRICE              INKCS056
00945              SET ASC-NO-PRICE-ERROR TO TRUE                       INKCS056
00946          END-IF                                                   INKCS056
00947      ELSE                                                         INKCS056
00948          IF  ANADJPRF = DP015-ERASE-EOF                           INKCS056
00949              MOVE ZERO             TO  ASC-NEW-PRICE-X            INKCS056
00950              SET ASC-NO-PRICE-ERROR TO TRUE                       INKCS056
00951          END-IF                                                   INKCS056
00952      END-IF.                                                      INKCS056
00953                                                                   INKCS056
00954      IF  ANREASNL > ZERO                                          INKCS056
00955          SET PS-REASON-ENTERED     TO  TRUE                       INKCS056
00956          MOVE ANREASNI             TO  ASC-NEW-REASON             INKCS056
00957      ELSE                                                         INKCS056
00958          IF  ANREASNF = DP015-ERASE-EOF                           INKCS056
00959              MOVE SPACE            TO  ASC-NEW-REASON             INKCS056
00960          END-IF                                                   INKCS056
00961      END-IF.                                                      INKCS056
00962 /                                                                 INKCS056
00963 *----------------------------------------------------------------*INKCS056
00964 * PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *INKCS056
00965 * IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *INKCS056
00966 * APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *INKCS056
00967 *----------------------------------------------------------------*INKCS056
00968                                                                   INKCS056
00969  3000-EDIT-DATA-IN-COMMAREA.                                      INKCS056
00970                                                                   INKCS056
00971      PERFORM 3200-RESET-ATTRIBUTES.                               INKCS056
00972                                                                   INKCS056
00973      IF (PS-PRICE-ENTERED                                         INKCS056
00974      OR  ASC-PRICE-ERROR)                                         INKCS056
00975          PERFORM 3001-VALIDATE-PRICE                              INKCS056
00976      END-IF.                                                      INKCS056
00977                                                                   INKCS056
00978      IF (PS-QTY-ENTERED                                           INKCS056
00979      OR  ASC-QTY-ERROR)                                           INKCS056
00980          PERFORM 3002-VALIDATE-QTY                                INKCS056
00981      END-IF.                                                      INKCS056
00982      IF  NOT ASC-QTY-ERROR                                        INKCS056
00983          IF (ASC-NEW-QTY GREATER PC-MAX-QUANTITY                  INKCS056
00984          OR  ASC-NEW-QTY LESS    PC-MIN-QUANTITY)                 INKCS056
00985              SET PS-ERROR                                         INKCS056
00986                  DP020-MSG-FATAL   TO  TRUE                       INKCS056
00987              MOVE PC-TSYMSG-00687  TO  DP020-MSG-NUMBER           INKCS056
00988              MOVE DP015-UNP-ALP-BRT-OFF                           INKCS056
00989                                    TO  ANADJQTA                   INKCS056
00990              MOVE DP015-RED        TO  ANADJQTC                   INKCS056
00991              MOVE DP015-REVERSE    TO  ANADJQTH                   INKCS056
00992              MOVE -1               TO  ANADJQTL                   INKCS056
00993          END-IF                                                   INKCS056
00994      END-IF.                                                      INKCS056
00995                                                                   INKCS056
00996      IF  PS-NO-ERROR                                              INKCS056
00997          IF  ASC-ADD-EXIST                                        INKCS056
00998              PERFORM 3003-CALC-ACTUAL                             INKCS056
00999              PERFORM 3004-CHECK-EXTENDED-MAX                      INKCS056
01000          ELSE                                                     INKCS056
01001              COMPUTE PV-TOT-EXT-PRICE                             INKCS056
01002                                     =  ASC-NEW-PRICE              INKCS056
01003                                     *  ASC-NEW-QTY                INKCS056
01004          END-IF                                                   INKCS056
01005                                                                   INKCS056
01006          IF  ASC-ADD-NEW                                          INKCS056
01007              MOVE ASC-NEW-PRICE      TO  ASC-PRICE                INKCS056
01008              IF (ASC-PRICE EQUAL ZERO                             INKCS056
01009              OR  ASC-NEW-QTY EQUAL ZERO)                          INKCS056
01010                  PERFORM 3045-SET-QTY-PRICE-ERROR                 INKCS056
01011              ELSE                                                 INKCS056
01056                  PERFORM 3004-CHECK-EXTENDED-MAX                  INKCS056
01013              END-IF                                               INKCS056
01014                                                                   INKCS056
01015              PERFORM 3010-VALIDATE-SKU                            INKCS056
01016              IF  PS-GOOD-SKU                                      INKCS056
01017                  PERFORM 3015-PROCESS-SKU                         INKCS056
01018                                                                   INKCS056
01019                  IF  SQLCODE EQUAL +100                           INKCS056
01020                      PERFORM 3040-SET-SKU-ERROR                   INKCS056
01021                  ELSE                                             INKCS056
01022                      IF  NOT PS-QTY-PRICE-ERROR                   INKCS056
01023                          PERFORM 3020-CONTINUE-SKU-CHECK          INKCS056
01024                      END-IF                                       INKCS056
01025                  END-IF                                           INKCS056
01026              ELSE                                                 INKCS056
01027                  PERFORM 3040-SET-SKU-ERROR                       INKCS056
01028              END-IF                                               INKCS056
01029                                                                   INKCS056
01030          END-IF                                                   INKCS056
01031      END-IF.                                                      INKCS056
01032                                                                   INKCS056
01033      IF (ASC-ADJUSTMENTS-ALLOWED                                  INKCS056
01034      OR  ASC-ADD-NEW)                                             INKCS056
01035      AND ASC-NEW-REASON NOT GREATER THAN SPACES                   INKCS056
01036          MOVE DP015-RED            TO  ANREASNC                   INKCS056
01037          MOVE DP015-REVERSE        TO  ANREASNH                   INKCS056
01038          IF  PS-NO-ERROR                                          INKCS056
01039              MOVE -1               TO  ANREASNL                   INKCS056
01040              MOVE PC-TSYMSG-00007  TO  DP020-MSG-NUMBER           INKCS056
01041              SET PS-ERROR                                         INKCS056
01042                  DP020-MSG-FATAL   TO  TRUE                       INKCS056
01043          END-IF                                                   INKCS056
01044      END-IF.                                                      INKCS056
01045                                                                   INKCS056
01046      IF  PS-NO-ERROR                                              INKCS056
01047          MOVE -1                   TO  ANADJQTL                   INKCS056
01048      END-IF.                                                      INKCS056
01049      SET DP030-SET-CURSOR-APPL-1   TO  TRUE.                      INKCS056
01050 /                                                                 INKCS056
01051 *----------------------------------------------------------------*INKCS056
01052 *    ENSURE THE PRICE IS VALID.                                  *INKCS056
01053 *----------------------------------------------------------------*INKCS056
01054                                                                   INKCS056
01055  3001-VALIDATE-PRICE.                                             INKCS056
01056                                                                   INKCS056
01057      SET  ASC-NO-PRICE-ERROR       TO  TRUE.                      INKCS056
01058      MOVE ASC-NEW-PRICE-X          TO  DP010I-UNEDITED-FIELD.     INKCS056
01059      MOVE PC-9                     TO  DP010I-MAXIMUM-DIGITS.     INKCS056
01060      MOVE PC-2                     TO  DP010I-MAXIMUM-DECIMALS.   INKCS056
01061      SET DP010I-NEGATIVE-NOT-ALLOWED                              INKCS056
01062                                    TO  TRUE.                      INKCS056
263126     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263126          USING DP010I-NUMERIC-EDIT-AREA.                                 
01064                                                                   INKCS056
01065      IF  DP010I-ERROR-DETECTED                                    INKCS056
01066          SET PS-ERROR                                             INKCS056
01067              ASC-PRICE-ERROR                                      INKCS056
01068              DP020-MSG-FATAL       TO  TRUE                       INKCS056
01069          MOVE PC-TSYMSG-00008      TO  DP020-MSG-NUMBER           INKCS056
01070          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS056
01071                                    TO  ANADJPRA                   INKCS056
01072          MOVE DP015-RED            TO  ANADJPRC                   INKCS056
01073          MOVE DP015-REVERSE        TO  ANADJPRH                   INKCS056
01074          MOVE -1                   TO  ANADJPRL                   INKCS056
01075      ELSE                                                         INKCS056
01076                                                                   INKCS056
01077          IF  DP010I-NUMERIC-FIELD LESS THAN PC-20-CENTS           INKCS056
01078              SET PS-ERROR                                         INKCS056
01079                  ASC-PRICE-ERROR                                  INKCS056
01080                  DP020-MSG-FATAL   TO  TRUE                       INKCS056
01081              MOVE PC-TSYMSG-00688  TO  DP020-MSG-NUMBER           INKCS056
01082              MOVE DP015-UNP-ALP-BRT-OFF                           INKCS056
01083                                    TO  ANADJPRA                   INKCS056
01084              MOVE DP015-RED        TO  ANADJPRC                   INKCS056
01085              MOVE DP015-REVERSE    TO  ANADJPRH                   INKCS056
01086              MOVE -1               TO  ANADJPRL                   INKCS056
01087          ELSE                                                     INKCS056
01088              IF  DP010I-NUMERIC-FIELD > PC-MAX-PRICE              INKCS056
01089                  SET PS-ERROR                                     INKCS056
01090                      ASC-PRICE-ERROR                              INKCS056
01091                      DP020-MSG-FATAL TO TRUE                      INKCS056
01092                  MOVE PC-TSYMSG-00686                             INKCS056
01093                                    TO  DP020-MSG-NUMBER           INKCS056
01094                  MOVE DP015-UNP-ALP-BRT-OFF                       INKCS056
01095                                    TO  ANADJPRA                   INKCS056
01096                  MOVE DP015-RED    TO  ANADJPRC                   INKCS056
01097                  MOVE DP015-REVERSE TO ANADJPRH                   INKCS056
01098                  MOVE -1           TO  ANADJPRL                   INKCS056
01099              ELSE                                                 INKCS056
01100                  MOVE DP010I-NUMERIC-FIELD                        INKCS056
01101                                    TO  ASC-NEW-PRICE              INKCS056
01102              END-IF                                               INKCS056
01103          END-IF                                                   INKCS056
01104                                                                   INKCS056
01105      END-IF.                                                      INKCS056
01106 /                                                                 INKCS056
01107 *----------------------------------------------------------------*INKCS056
01108 *    NOW, ENSURE THE QUANTITY IS NUMERIC.                        *INKCS056
01109 *----------------------------------------------------------------*INKCS056
01110                                                                   INKCS056
01111  3002-VALIDATE-QTY.                                               INKCS056
01112                                                                   INKCS056
01113      SET  ASC-NO-QTY-ERROR         TO  TRUE.                      INKCS056
01114      MOVE ASC-NEW-QTY-X            TO  DP010I-UNEDITED-FIELD.     INKCS056
01115      MOVE PC-7                     TO  DP010I-MAXIMUM-DIGITS.     INKCS056
01116      MOVE ZERO                     TO  DP010I-MAXIMUM-DECIMALS.   INKCS056
01117      SET DP010I-NEGATIVE-ALLOWED   TO  TRUE.                      INKCS056
263126     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263126          USING DP010I-NUMERIC-EDIT-AREA.                                 
01119                                                                   INKCS056
01120      IF  DP010I-ERROR-DETECTED                                    INKCS056
01121          SET PS-ERROR                                             INKCS056
01122              ASC-QTY-ERROR                                        INKCS056
01123              DP020-MSG-FATAL       TO  TRUE                       INKCS056
01124          MOVE PC-TSYMSG-00008      TO  DP020-MSG-NUMBER           INKCS056
01125          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS056
01126                                    TO  ANADJQTA                   INKCS056
01127          MOVE DP015-RED            TO  ANADJQTC                   INKCS056
01128          MOVE DP015-REVERSE        TO  ANADJQTH                   INKCS056
01129          MOVE -1                   TO  ANADJQTL                   INKCS056
01130      ELSE                                                         INKCS056
01131          MOVE DP010I-NUMERIC-FIELD                                INKCS056
01132                                    TO  ASC-NEW-QTY                INKCS056
01133      END-IF.                                                      INKCS056
01134 /                                                                 INKCS056
01135 *----------------------------------------------------------------*INKCS056
01136 *    COMPUTE THE ACTUAL ADJUSTMENT FIELDS.                       *INKCS056
01137 *----------------------------------------------------------------*INKCS056
01138                                                                   INKCS056
01139  3003-CALC-ACTUAL.                                                INKCS056
01140                                                                   INKCS056
01141      IF  ASC-NEW-PRICE EQUAL ZERO                                 INKCS056
01142          MOVE ZERO                 TO  ASC-ACT-ADJ-PRICE          INKCS056
01143                                        PV-ADJ-EXT1                INKCS056
01144      ELSE                                                         INKCS056
01145          COMPUTE ASC-ACT-ADJ-PRICE  =  ASC-NEW-PRICE              INKCS056
01146                                     -  ASC-TOT-PRICE              INKCS056
01147          COMPUTE PV-ADJ-EXT1        =  ASC-ACT-ADJ-PRICE          INKCS056
01148                                     *  ASC-TOT-QTY                INKCS056
01149      END-IF.                                                      INKCS056
01150                                                                   INKCS056
01151      IF  ASC-NEW-QTY EQUAL ZERO                                   INKCS056
01152          MOVE ZERO                 TO  ASC-ACT-ADJ-QTY            INKCS056
01153                                        PV-ADJ-EXT2                INKCS056
01154      ELSE                                                         INKCS056
01155          COMPUTE ASC-ACT-ADJ-QTY    =  ASC-NEW-QTY                INKCS056
01156                                     -  ASC-TOT-QTY                INKCS056
01157          IF  PV-ADJ-EXT1 EQUAL ZERO                               INKCS056
01158              COMPUTE PV-ADJ-EXT2    =  ASC-ACT-ADJ-QTY            INKCS056
01159                                     *  ASC-TOT-PRICE              INKCS056
01160          ELSE                                                     INKCS056
01161              COMPUTE PV-ADJ-EXT2    =  ASC-ACT-ADJ-QTY            INKCS056
01162                                     *  ASC-NEW-PRICE              INKCS056
01163          END-IF                                                   INKCS056
01164      END-IF.                                                      INKCS056
01165                                                                   INKCS056
01166      MOVE ASC-ACT-ADJ-QTY          TO  ADADJQTO.                  INKCS056
01167      MOVE ASC-ACT-ADJ-PRICE        TO  ADADJPRO.                  INKCS056
01168      COMPUTE PV-TOT-EXT-PRICE       =  PV-ADJ-EXT1                INKCS056
01169                                     +  PV-ADJ-EXT2.               INKCS056
01170 /                                                                 INKCS056
01171 *----------------------------------------------------------------*INKCS056
01172 *    SEE IF WE EXCEEDED THE MAXIMUM ADJUSTMENT ALLOWED.          *INKCS056
01173 *----------------------------------------------------------------*INKCS056
01174                                                                   INKCS056
01175  3004-CHECK-EXTENDED-MAX.                                         INKCS056
01176                                                                   INKCS056
01177      IF  ASC-NO-ADJUSTMENTS-ALLOWED                               INKCS056
01178          CONTINUE                                                 INKCS056
01179      ELSE                                                         INKCS056
01180          IF (PV-TOT-EXT-PRICE GREATER PC-MAX-EXTENDED-PRICE       INKCS056
01181          OR  PV-TOT-EXT-PRICE LESS    PC-MIN-EXTENDED-PRICE)      INKCS056
01182              MOVE PC-TSYMSG-00686  TO  DP020-MSG-NUMBER           INKCS056
01183              SET DP020-MSG-FATAL   TO  TRUE                       INKCS056
01184              SET PS-ERROR          TO  TRUE                       INKCS056
01185              IF (PS-QTY-ENTERED                                   INKCS056
01186              OR  ASC-NEW-QTY GREATER THAN ZERO)                   INKCS056
01187                  MOVE DP015-UNP-ALP-BRT-OFF                       INKCS056
01188                                    TO  ANADJQTA                   INKCS056
01189                  MOVE DP015-RED    TO  ANADJQTC                   INKCS056
01190                  MOVE DP015-REVERSE TO ANADJQTH                   INKCS056
01191                  MOVE -1           TO  ANADJQTL                   INKCS056
01192              ELSE                                                 INKCS056
01193                  MOVE DP015-UNP-ALP-BRT-OFF                       INKCS056
01194                                    TO  ANADJPRA                   INKCS056
01195                  MOVE DP015-RED    TO  ANADJPRC                   INKCS056
01196                  MOVE DP015-REVERSE TO ANADJPRH                   INKCS056
01197                  MOVE -1           TO  ANADJPRL                   INKCS056
01198              END-IF                                               INKCS056
01199          ELSE                                                     INKCS056
05600              IF  PV-TOT-EXT-PRICE EQUAL ZERO                      INKCS056
05601                  MOVE PC-TSYMSG-00010                             INKCS056
05602                                    TO  DP020-MSG-NUMBER           INKCS056
05603                  SET DP020-MSG-FATAL                              INKCS056
05604                      PS-ERROR      TO  TRUE                       INKCS056
05605                  IF (PS-QTY-ENTERED                               INKCS056
05606                  OR  ASC-NEW-QTY GREATER THAN ZERO)               INKCS056
05607                      MOVE DP015-UNP-ALP-BRT-OFF                   INKCS056
05608                                    TO  ANADJQTA                   INKCS056
05609                      MOVE DP015-RED TO ANADJQTC                   INKCS056
05610                      MOVE DP015-REVERSE TO ANADJQTH               INKCS056
05611                      MOVE -1       TO  ANADJQTL                   INKCS056
05612                  ELSE                                             INKCS056
05613                      MOVE DP015-UNP-ALP-BRT-OFF                   INKCS056
05614                                    TO  ANADJPRA                   INKCS056
05615                      MOVE DP015-RED TO ANADJPRC                   INKCS056
05616                      MOVE DP015-REVERSE TO ANADJPRH               INKCS056
05617                      MOVE -1       TO  ANADJPRL                   INKCS056
05618                  END-IF                                           INKCS056
05619              END-IF                                               INKCS056
05620          END-IF                                                   INKCS056
05621      END-IF.                                                      INKCS056
05622      MOVE PV-TOT-EXT-PRICE         TO  ADEXTPRO.                  INKCS056
05623 /                                                                 INKCS056
05624 *----------------------------------------------------------------*INKCS056
05625 *    FIRST, SEE IF THE OPERATOR ENTERED A VALID SKU.             *INKCS056
05626 *    IF VALID, CHECK FOR STATUS 98.                              *INKCS056
05627 *    IF A ROW DOES NOT EXIST ON EITHER TSUMINV OR TADJADD,       *INKCS056
05628 *    CHECK IF A ROW EXISTS FOR THE RENUMBERED SKU.               *INKCS056
05629 *    IF NOT, USE THE RENUMBERED SKU FOR PROCESSING.              *INKCS056
05630 *----------------------------------------------------------------*INKCS056
05631                                                                   INKCS056
05632  3010-VALIDATE-SKU.                                               INKCS056
05633                                                                   INKCS056
05634      SET PS-GOOD-SKU               TO  TRUE.                      INKCS056
05635                                                                   INKCS056
W21732*    MOVE ASC-SKU-NBR              TO  DP010I-UNEDITED-FIELD.     INKCS056
W25428     MOVE ASC-SKU                  TO  DP010I-UNEDITED-FIELD.     INKCS056
W21732     MOVE PC-8                     TO  DP010I-MAXIMUM-DIGITS.     INKCS056
05666      MOVE ZERO                     TO  DP010I-MAXIMUM-DECIMALS.   INKCS056
05667      SET DP010I-NEGATIVE-NOT-ALLOWED                              INKCS056
05668                                    TO  TRUE.                      INKCS056
263126     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263126          USING DP010I-NUMERIC-EDIT-AREA.                                 
05670                                                                   INKCS056
05671      IF  DP010I-ERROR-DETECTED                                    INKCS056
05672          PERFORM 3040-SET-SKU-ERROR                               INKCS056
05673      ELSE                                                         INKCS056
W21732         MOVE DP010I-NUMERIC-FIELD TO  PV-EIGHT                   INKCS056
W21732*        MOVE PV-EIGHT-X           TO  ASC-SKU-NBR                INKCS056
W25428         MOVE PV-EIGHT-X           TO  ASC-SKU                    INKCS056
05676      END-IF.                                                      INKCS056
05677                                                                   INKCS056
05678 *----------------------------------------------------------------*INKCS056
05679 *    NOW CHECK IF THE SKU EXISTS.                                *INKCS056
05680 *----------------------------------------------------------------*INKCS056
05681                                                                   INKCS056
05682  3015-PROCESS-SKU.                                                INKCS056
05683                                                                   INKCS056
W21732*    IF  ASC-SKU-NBR (6:3) = '000' OR '999'                       INKCS056
W25428     IF  ASC-SKU     (6:3) = '000' OR '999'                       INKCS056
W21732         MOVE ZERO                 TO  SKXREF-SKU-STAT-CDE        INKCS056
05686          PERFORM 3050-READ-TMDSEAR                                INKCS056
05687      ELSE                                                         INKCS056
W21732         PERFORM 3030-READ-TSKXREF                                INKCS056
05689      END-IF.                                                      INKCS056
W21732     MOVE SKXREF-SKU-STAT-CDE      TO  ASC-STATUS-CODE.           INKCS056
05691                                                                   INKCS056
05692 *----------------------------------------------------------------*INKCS056
05693 *    SEE IF THE SKU IS RENUMBERED.                               *INKCS056
05694 *----------------------------------------------------------------*INKCS056
05695                                                                   INKCS056
05696  3020-CONTINUE-SKU-CHECK.                                         INKCS056
05697                                                                   INKCS056
W21732     IF  SKXREF-SKU-STAT-CDE EQUAL PC-98                          INKCS056
05699          PERFORM 3031-READ-RENUMBERED-SKU                         INKCS056
01300                                                                   INKCS056
01301          IF  SQLCODE EQUAL ZERO                                   INKCS056
01302              SET DP020-MSG-INFORMATIONAL                          INKCS056
01303                                    TO  TRUE                       INKCS056
01304              MOVE PC-TSYMSG-00453                                 INKCS056
01305                                    TO  DP020-MSG-NUMBER           INKCS056
W21732             MOVE SKXREF-SKU       TO  NI-SKU-9                   INKCS056
W21732             MOVE NI-SKU           TO  PV-RSKU-NBR                INKCS056
W21732*                                      ASC-SKU-NBR                INKCS056
W25428                                       ASC-SKU                    INKCS056
01314              MOVE PV-RENUMBERED-SKU TO DP020-MSG-TEXT             INKCS056
01315          ELSE                                                     INKCS056
01316              PERFORM 3040-SET-SKU-ERROR                           INKCS056
01317              MOVE PC-TSYMSG-00125  TO  DP020-MSG-NUMBER           INKCS056
01318          END-IF                                                   INKCS056
01319      END-IF.                                                      INKCS056
01320                                                                   INKCS056
01321      IF  PS-ERROR                                                 INKCS056
01322          CONTINUE                                                 INKCS056
01323      ELSE                                                         INKCS056
01324          PERFORM 3025-FROM-WHERE                                  INKCS056
01325      END-IF.                                                      INKCS056
01326                                                                   INKCS056
01327 *----------------------------------------------------------------*INKCS056
01328 *    SEE IF A ROW EXISTS ON EITHER TSUMINV OR TADJADD.           *INKCS056
01329 *----------------------------------------------------------------*INKCS056
01330                                                                   INKCS056
01331  3025-FROM-WHERE.                                                 INKCS056
01332                                                                   INKCS056
01333 *    MOVE ASC-NEW-PRICE            TO  ASC-PRICE.                 INKCS056
01334 *    MOVE ZERO                     TO  ASC-NEW-PRICE.             INKCS056
01335      PERFORM 4100-GET-FROM-TSUMINV.                               INKCS056
01336                                                                   INKCS056
01337      IF  SQLCODE EQUAL +100                                       INKCS056
01338          PERFORM 4200-GET-FROM-TADJADD                            INKCS056
01339          IF  SQLCODE EQUAL ZERO                                   INKCS056
01340              SET PS-ERROR                                         INKCS056
01341                  PS-ROW-FOUND      TO  TRUE                       INKCS056
01342          END-IF                                                   INKCS056
01343      ELSE                                                         INKCS056
01344          SET PS-ERROR                                             INKCS056
01345              PS-ROW-FOUND          TO  TRUE                       INKCS056
01346      END-IF.                                                      INKCS056
01347                                                                   INKCS056
01348      IF  PS-ROW-FOUND                                             INKCS056
01349          PERFORM 3040-SET-SKU-ERROR                               INKCS056
01350          MOVE PC-TSYMSG-00117      TO  DP020-MSG-NUMBER           INKCS056
01351      END-IF.                                                      INKCS056
01352                                                                   INKCS056
01353 /                                                                 INKCS056
01354 *----------------------------------------------------------------*INKCS056
W21732*    READ THE SKU TABLE BY 8 DIGIT SKU.                          *INKCS056
01356 *----------------------------------------------------------------*INKCS056
01357                                                                   INKCS056
W21732 3030-READ-TSKXREF.                                               INKCS056
01359                                                                   INKCS056
W21732*        MOVE ASC-SKU-NBR           TO  NI-SKU.                   INKCS056
W25428         MOVE ASC-SKU               TO  NI-SKU.                   INKCS056
W21732         MOVE NI-SKU-9              TO  SKXREF-SKU.               INKCS056
01359                                                                   INKCS056
01360          EXEC SQL                                                 INKCS056
01361               SELECT                                              INKCS056
W21732                     SKU_STAT_CDE                                 INKCS056
W21732                   , ITM_NBR                                      INKCS056
01364               INTO                                                INKCS056
W21732                    :SKXREF-SKU-STAT-CDE                          INKCS056
W21732                   ,:SKXREF-ITM-NBR                               INKCS056
01367               FROM                                                INKCS056
W21732                     TSKXREF                                      INKCS056
01369               WHERE                                               INKCS056
W21732                     SKU               =  :SKXREF-SKU             INKCS056
01375          END-EXEC.                                                INKCS056
01376                                                                   INKCS056
01377          EVALUATE TRUE                                            INKCS056
01378              WHEN SQLCODE = ZERO                                  INKCS056
01379                   CONTINUE                                        INKCS056
01380              WHEN SQLCODE = +100                                  INKCS056
W21732                  MOVE ZERO TO SKXREF-SKU-STAT-CDE                INKCS056
01382              WHEN SQLCODE = -904                                  INKCS056
01383              WHEN SQLCODE = -913                                  INKCS056
01384                   PERFORM 9900-SOFT-ABORT                         INKCS056
01385              WHEN SQLWARN0 NOT = SPACES                           INKCS056
01386              WHEN SQLCODE NOT EQUAL ZERO                          INKCS056
W21732                 MOVE '3030-READ-TSKXREF'                         INKCS056
01388                                    TO DP013-PARAGRAPH             INKCS056
01389                  MOVE 'SELECT SKU'                                INKCS056
01390                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01391                  MOVE SQLCA        TO DP013-SQLCA                 INKCS056
W21732                 MOVE 'TSKXREF'    TO DP013-DB2-TABLE-NAME (1)    INKCS056
01393                  SET DP013-DB2-ABEND                              INKCS056
01394                      DP013-XCTL-DISPLAY-RESTART                   INKCS056
01395                                    TO TRUE                        INKCS056
01396                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS056
01397          END-EVALUATE.                                            INKCS056
01398 /                                                                 INKCS056
01399 *----------------------------------------------------------------*INKCS056
01400 *    FORMAT THE KOHLS UPC NUMBER, GET THE ITEM NUMBER, GET THE   *INKCS056
01401 *    RENUMBERED SKU.                                             *INKCS056
01402 *----------------------------------------------------------------*INKCS056
01403                                                                   INKCS056
01404  3031-READ-RENUMBERED-SKU.                                        INKCS056
01405                                                                   INKCS056
W21732*    MOVE ASC-SKU-NBR              TO  PV-UPC-SKU2.               INKCS056
W25428     MOVE ASC-SKU                  TO  PV-UPC-SKU2.               INKCS056
01409      MOVE PV-WORK-UPC2             TO  DP040I-UPC-CODE.           INKCS056
01410                                                                   INKCS056
01411      SET DP040I-COMP-CHECK-DIGIT-OPTION                           INKCS056
01412                                    TO  TRUE.                      INKCS056
01413      CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          INKCS056
01413                             USING  DP040I-UPC-CHECK-DIGIT-PARMS.  INKCS056
01414                                                                   INKCS056
01415      MOVE DP040I-COMPUTED-UPC-CHK-DIGIT                           INKCS056
01416                                    TO  PV-UPC-CHK-DIG2.           INKCS056
01417      MOVE PV-WORK-UPC2             TO  TUPCSKU-UPC-NBR.           INKCS056
01418                                                                   INKCS056
01419      PERFORM 3032-GET-RENUMBERED-ITEM.                            INKCS056
01420      IF  SQLCODE EQUAL ZERO                                       INKCS056
01421          PERFORM 3033-GET-RENUMBERED-SKU                          INKCS056
01422      END-IF.                                                      INKCS056
01423                                                                   INKCS056
01424 *----------------------------------------------------------------*INKCS056
01425 *    GET THE ITEM NUMBER FOR THE RENUMBERED SKU                  *INKCS056
01426 *----------------------------------------------------------------*INKCS056
01427                                                                   INKCS056
01428  3032-GET-RENUMBERED-ITEM.                                        INKCS056
01429                                                                   INKCS056
01430          EXEC SQL                                                 INKCS056
01431               SELECT                                              INKCS056
01432                      ITEM_NBR                                     INKCS056
01433               INTO                                                INKCS056
01434                     :TUPCSKU-ITEM-NBR                             INKCS056
01435               FROM                                                INKCS056
01436                      TUPCSKU                                      INKCS056
01437               WHERE                                               INKCS056
01438                      UPC_NBR      =  :TUPCSKU-UPC-NBR             INKCS056
01439          END-EXEC.                                                INKCS056
01440                                                                   INKCS056
01441          EVALUATE TRUE                                            INKCS056
01442              WHEN SQLCODE = ZERO                                  INKCS056
01443                   CONTINUE                                        INKCS056
01444              WHEN SQLCODE = +100                                  INKCS056
01445                   MOVE ZERO        TO TUPCSKU-ITEM-NBR            INKCS056
01446              WHEN SQLCODE = -904                                  INKCS056
01447              WHEN SQLCODE = -913                                  INKCS056
01448                   PERFORM 9900-SOFT-ABORT                         INKCS056
01449              WHEN SQLWARN0 NOT = SPACES                           INKCS056
01450              WHEN SQLCODE NOT EQUAL ZERO                          INKCS056
01451                  MOVE '3032-GET-TUPCSKU'                          INKCS056
01452                                    TO DP013-PARAGRAPH             INKCS056
01453                  MOVE 'SELECT UPC/SKU XREF'                       INKCS056
01454                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01455                  MOVE SQLCA        TO DP013-SQLCA                 INKCS056
01456                  MOVE 'TUPCSKU'    TO DP013-DB2-TABLE-NAME (1)    INKCS056
01457                  SET DP013-DB2-ABEND                              INKCS056
01458                      DP013-XCTL-DISPLAY-RESTART                   INKCS056
01459                                    TO TRUE                        INKCS056
01460                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS056
01461          END-EVALUATE.                                            INKCS056
01462                                                                   INKCS056
01463 *----------------------------------------------------------------*INKCS056
01464 *    GET THE RENUMBERED SKU.                                     *INKCS056
01465 *----------------------------------------------------------------*INKCS056
01466                                                                   INKCS056
01467  3033-GET-RENUMBERED-SKU.                                         INKCS056
01468                                                                   INKCS056
W21732         MOVE TUPCSKU-ITEM-NBR       TO SKXREF-ITM-NBR.           INKCS056
01468                                                                   INKCS056
01469          EXEC SQL                                                 INKCS056
01470               SELECT                                              INKCS056
W21732                     SKU                                          INKCS056
01474               INTO                                                INKCS056
W21732                    :SKXREF-SKU                                   INKCS056
01478               FROM                                                INKCS056
W21732                     TSKXREF                                      INKCS056
01480               WHERE                                               INKCS056
W21732                     ITM_NBR           =  :SKXREF-ITM-NBR         INKCS056
01482          END-EXEC.                                                INKCS056
01483                                                                   INKCS056
01484          EVALUATE TRUE                                            INKCS056
01485              WHEN SQLCODE = ZERO                                  INKCS056
01486              WHEN SQLCODE = +100                                  INKCS056
01487                  CONTINUE                                         INKCS056
01488              WHEN SQLCODE = -904                                  INKCS056
01489              WHEN SQLCODE = -913                                  INKCS056
01490                   PERFORM 9900-SOFT-ABORT                         INKCS056
01491              WHEN SQLWARN0 NOT = SPACES                           INKCS056
01492              WHEN SQLCODE NOT EQUAL ZERO                          INKCS056
01493                  MOVE '3033-GET-RENUMBERED-SKU'                   INKCS056
01494                                    TO DP013-PARAGRAPH             INKCS056
01495                  MOVE 'SELECT SKU'                                INKCS056
01496                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01497                  MOVE SQLCA        TO DP013-SQLCA                 INKCS056
W21732                 MOVE 'TSKXREF'    TO DP013-DB2-TABLE-NAME (1)    INKCS056
01499                  SET DP013-DB2-ABEND                              INKCS056
01500                      DP013-XCTL-DISPLAY-RESTART                   INKCS056
01501                                    TO TRUE                        INKCS056
01502                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS056
01503          END-EVALUATE.                                            INKCS056
01504                                                                   INKCS056
01505 /                                                                 INKCS056
01506 *----------------------------------------------------------------*INKCS056
01507 *    COMMON ROUTINE TO SET SKU ERROR FLAGS.                      *INKCS056
01508 *----------------------------------------------------------------*INKCS056
01509 /                                                                 INKCS056
01510  3040-SET-SKU-ERROR.                                              INKCS056
01511                                                                   INKCS056
01512      SET PS-ERROR                                                 INKCS056
01513          PS-BAD-SKU                                               INKCS056
01514          DP020-MSG-FATAL           TO  TRUE.                      INKCS056
01515      MOVE PC-TSYMSG-00073          TO  DP020-MSG-NUMBER.          INKCS056
W21732     MOVE DP015-UNP-ALP-BRT-OFF    TO  ANSKUA.                    INKCS056
W21732     MOVE DP015-RED                TO  ANSKUC.                    INKCS056
W21732     MOVE DP015-REVERSE            TO  ANSKUH.                    INKCS056
W21732     MOVE -1                       TO  ANSKUL.                    INKCS056
01526                                                                   INKCS056
01527 *----------------------------------------------------------------*INKCS056
01528 *    SET THE FIELDS IN ERROR.                                    *INKCS056
01529 *----------------------------------------------------------------*INKCS056
01530                                                                   INKCS056
01531  3045-SET-QTY-PRICE-ERROR.                                        INKCS056
01532                                                                   INKCS056
01533      IF  PV-RSKU-NBR GREATER THAN SPACES                          INKCS056
01534          CONTINUE                                                 INKCS056
01535      ELSE                                                         INKCS056
01536          MOVE PC-TSYMSG-00007      TO  DP020-MSG-NUMBER           INKCS056
01537      END-IF.                                                      INKCS056
01538                                                                   INKCS056
01539      SET PS-ERROR                                                 INKCS056
01540          PS-QTY-PRICE-ERROR                                       INKCS056
01541          DP020-MSG-FATAL           TO  TRUE.                      INKCS056
01542                                                                   INKCS056
01543      IF  ASC-NEW-PRICE EQUAL ZERO                                 INKCS056
01544          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS056
01545                                    TO  ANADJPRA                   INKCS056
01546          MOVE DP015-RED            TO  ANADJPRC                   INKCS056
01547          MOVE DP015-REVERSE        TO  ANADJPRH                   INKCS056
01548          MOVE -1                   TO  ANADJPRL                   INKCS056
01549      END-IF.                                                      INKCS056
01550                                                                   INKCS056
01551      IF  ASC-NEW-QTY EQUAL ZERO                                   INKCS056
01552          MOVE DP015-UNP-ALP-BRT-OFF                               INKCS056
01553                                    TO  ANADJQTA                   INKCS056
01554          MOVE DP015-RED            TO  ANADJQTC                   INKCS056
01555          MOVE DP015-REVERSE        TO  ANADJQTH                   INKCS056
01556          MOVE -1                   TO  ANADJQTL                   INKCS056
01557      END-IF.                                                      INKCS056
01558 /                                                                 INKCS056
01559 *----------------------------------------------------------------*INKCS056
01560 *    READ THE MERCHANDISE AREA TABLE.                            *INKCS056
01561 *----------------------------------------------------------------*INKCS056
01562                                                                   INKCS056
01563  3050-READ-TMDSEAR.                                               INKCS056
01564                                                                   INKCS056
W21732*    MOVE ASC-SKU-NBR (1:3)           TO  MDSEAR-DEPT-NBR.        INKCS056
W25428     MOVE ASC-SKU(1:3)                TO  MDSEAR-DEPT-NBR.        INKCS056
W21732*    MOVE ASC-SKU-NBR (4:2)           TO  PV-MAJ-CL-NBR           INKCS056
W25428     MOVE ASC-SKU(4:2)                TO  PV-MAJ-CL-NBR           INKCS056
01566                                           PV-SUB-CL-NBR2-3.       INKCS056
01567      MOVE ZERO                        TO  PV-MAJ-CL-NBR2.         INKCS056
01568      MOVE PV-SUB-CL-NBR               TO  MDSEAR-SUB-CL-NBR.      INKCS056
01569      MOVE PV-MAJ-CL-NBR               TO  MDSEAR-MAJ-CL-NBR.      INKCS056
01571                                                                   INKCS056
W21732     MOVE PC-SCL                      TO MDSEAR-MDSELV-CDE.       INKCS056
01571                                                                   INKCS056
01572          EXEC SQL                                                 INKCS056
01573               SELECT                                              INKCS056
01574                      MDSEAR_DKEY                                  INKCS056
01575               INTO                                                INKCS056
01576                     :MDSEAR-DKEY                                  INKCS056
01577               FROM                                                INKCS056
01578                      TMDSEAR                                      INKCS056
01579               WHERE                                               INKCS056
01580                      DEPT_NBR          =  :MDSEAR-DEPT-NBR        INKCS056
01581                AND                                                INKCS056
01582                      MAJ_CL_NBR        =  :MDSEAR-MAJ-CL-NBR      INKCS056
01583                AND                                                INKCS056
01584                      SUB_CL_NBR        =  :MDSEAR-SUB-CL-NBR      INKCS056
01585                AND                                                INKCS056
W21732                     MDSELV_CDE        =  :MDSEAR-MDSELV-CDE      INKCS056
01587                AND   :IN001-DB2-ACTL-INV-DTE                      INKCS056
01588                      BETWEEN STRT_DTE AND END_DTE                 INKCS056
01589          END-EXEC.                                                INKCS056
01590                                                                   INKCS056
01591          EVALUATE TRUE                                            INKCS056
01592              WHEN SQLCODE = ZERO                                  INKCS056
01593                   CONTINUE                                        INKCS056
01594              WHEN SQLCODE = +100                                  INKCS056
01595                   MOVE ZERO         TO  MDSEAR-DKEY               INKCS056
01596              WHEN SQLCODE = -904                                  INKCS056
01597              WHEN SQLCODE = -913                                  INKCS056
01598                   PERFORM 9900-SOFT-ABORT                         INKCS056
01599              WHEN SQLWARN0 NOT = SPACES                           INKCS056
01600              WHEN SQLCODE NOT EQUAL ZERO                          INKCS056
01601                  MOVE '3050-READ-TMDSEAR'                         INKCS056
01602                                    TO DP013-PARAGRAPH             INKCS056
01603                  MOVE 'SELECT TMDSEAR'                            INKCS056
01604                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01605                  MOVE SQLCA        TO DP013-SQLCA                 INKCS056
W21732                 MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    INKCS056
01607                  SET DP013-DB2-ABEND                              INKCS056
01608                      DP013-XCTL-DISPLAY-RESTART                   INKCS056
01609                                    TO TRUE                        INKCS056
01610                  PERFORM DP013-0000-PROCESS-ABEND                 INKCS056
01611          END-EVALUATE.                                            INKCS056
                                                                                
W25428*----------------------------------------------------------------*        
W25428*    COMMON ROUTINE TO SET SKU ERROR FLAGS.                      *        
W25428*----------------------------------------------------------------*        
W25428/                                                                         
W25428 3090-SET-UPC-ERROR.                                                      
W25428                                                                          
W25428     SET PS-ERROR                                                         
W25428*        PS-BAD-UPC                                                       
W25428         DP020-MSG-FATAL           TO  TRUE.                              
W25428     MOVE PC-TSYMSG-00100          TO  DP020-MSG-NUMBER.                  
W25428     MOVE DP015-UNP-ALP-BRT-OFF    TO  ANUPCA.                            
W25428     MOVE DP015-RED                TO  ANUPCC.                            
W25428     MOVE DP015-REVERSE            TO  ANUPCH.                            
W21732     MOVE -1                       TO  ANUPCL.                            
W25428/                                                                         
01613 *----------------------------------------------------------------*INKCS056
01614 *    RESET THE DATA ENTERABLE FIELDS ATTRIBUTE, HIGHLIGHT, AND   *INKCS056
01615 *    COLOR BYTES.                                                *INKCS056
01616 *----------------------------------------------------------------*INKCS056
01617                                                                   INKCS056
01618  3200-RESET-ATTRIBUTES.                                           INKCS056
01619                                                                   INKCS056
01620      IF  ASC-NO-ADJUSTMENTS-ALLOWED                               INKCS056
01621          MOVE DP015-ASK-DRK-OFF    TO  ANADJQTA                   INKCS056
01622                                        ANADJPRA                   INKCS056
01623                                        ANREASNA                   INKCS056
01624          MOVE DP015-BLUE           TO  ANADJQTC                   INKCS056
01625                                        ANADJPRC                   INKCS056
01626                                        ANREASNC                   INKCS056
01627          MOVE DP015-HL-OFF         TO  ANADJQTH                   INKCS056
01628                                        ANADJPRH                   INKCS056
01629                                        ANREASNH                   INKCS056
01630      ELSE                                                         INKCS056
01631          MOVE DP015-UNP-ALP-BRT-OFF TO ANADJQTA                   INKCS056
01632                                        ANADJPRA                   INKCS056
01633                                        ANREASNA                   INKCS056
01634          MOVE DP015-GREEN          TO  ANADJQTC                   INKCS056
01635                                        ANADJPRC                   INKCS056
01636                                        ANREASNC                   INKCS056
01637          MOVE DP015-UNDERLINE      TO  ANADJQTH                   INKCS056
01638                                        ANADJPRH                   INKCS056
01639                                        ANREASNH                   INKCS056
01640      END-IF.                                                      INKCS056
01641                                                                   INKCS056
01642      IF  ASC-ADD-NEW                                              INKCS056
W21732         MOVE DP015-UNP-ALP-NOR-OFF TO ANSKUA                     INKCS056
W25428                                       ANUPCA                             
W21732         MOVE DP015-GREEN           TO ANSKUC                             
W25428                                       ANUPCC                             
W21732         MOVE DP015-UNDERLINE       TO ANSKUH                             
W25428                                       ANUPCH                             
01653      ELSE                                                         INKCS056
W21732         MOVE DP015-ASK-DRK-OFF     TO ANSKUA                     INKCS056
W25428                                       ANUPCA                             
W21732         MOVE DP015-BLUE            TO ANSKUC                     INKCS056
W25428                                       ANUPCC                             
W21732         MOVE DP015-HL-OFF          TO ANSKUH                     INKCS056
W25428                                       ANUPCH                             
01664      END-IF.                                                      INKCS056
01665                                                                   INKCS056
01666 /                                                                 INKCS056
01667 *----------------------------------------------------------------*INKCS056
01668 *    THIS IS BUILT ONLY IF A SELECTION QUEUE WAS PASSED.         *INKCS056
01669 *----------------------------------------------------------------*INKCS056
01670                                                                   INKCS056
01671  4000-BUILD-INITIAL-PANEL.                                        INKCS056
01672                                                                   INKCS056
01673      SET DP030-SET-CURSOR-APPL-1                                  INKCS056
01674          ASC-NO-ADJUSTMENTS-ALLOWED   TO  TRUE.                   INKCS056
01675      MOVE IN001-STORE-NBR          TO  ASC-STORE-NBR.             INKCS056
W26600     MOVE ASC-STORE-NBR            TO  PV-STORE-NUMBER.           INKCS056
01676      MOVE IN001-AREA-NBR           TO  ASC-AREA-NBR.              INKCS056
01677      MOVE ZERO                     TO  ASC-MAP-SUB.               INKCS056
01678                                                                   INKCS056
01679      IF  ASC-FROM-TSUMINV                                         INKCS056
01680          PERFORM 4100-GET-FROM-TSUMINV                            INKCS056
01681          SET ASC-ADJ-TYPE-SI       TO  TRUE                       INKCS056
01682          SET ASC-ADJ-TYPE-MM       TO  TRUE                       INKCS056
01682          SET ASC-ADJ-TYPE-SA       TO  TRUE                       INKCS056
01683      ELSE                                                         INKCS056
01684          PERFORM 4200-GET-FROM-TADJADD                            INKCS056
01685          SET ASC-ADJ-TYPE-AD       TO  TRUE                       INKCS056
01686          SET ASC-ADJ-TYPE-AD2      TO  TRUE                       INKCS056
01686          SET ASC-ADJ-TYPE-AD3      TO  TRUE                       INKCS056
01687      END-IF.                                                      INKCS056
W26600     MOVE PV-STORE-NUMBER TO ADJDTL-LOC-NBR.                      INKCS056
01688      PERFORM 4300-GET-TADJDTL.                                    INKCS056
01689                                                                   INKCS056
01690      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        INKCS056
01691 /                                                                 INKCS056
01692 *----------------------------------------------------------------*INKCS056
01693 *    RETRIEVE THE ROWS FROM THE SUMMARY INVENTORY TABLE.         *INKCS056
01694 *----------------------------------------------------------------*INKCS056
01695                                                                   INKCS056
01696  4100-GET-FROM-TSUMINV.                                           INKCS056
01697                                                                   INKCS056
W21732*    MOVE ASC-STORE-NBR       TO SUMINV-STORE-NBR.                INKCS056
W26600     MOVE PV-STORE-NUMBER     TO SUMINV-LOC-NBR.                  INKCS056
W21732     MOVE ASC-AREA-NBR        TO SUMINV-AREA-NBR.                 INKCS056
W21732*    MOVE ASC-SKU-NBR         TO NI-SKU.                          INKCS056
W25428     MOVE ASC-SKU             TO NI-SKU.                          INKCS056
W21732     MOVE NI-SKU-9            TO SUMINV-SKU-NBR.                  INKCS056
W21732     MOVE ASC-PRICE           TO SUMINV-INV-UNIT-PR-AMT.          INKCS056
01697                                                                   INKCS056
01698      EXEC SQL                                                     INKCS056
01699 *         SELECT                                                  INKCS056
01700 *****             INV_UNIT_PR_AMT                                 INKCS056
W26682*                 SUM(INV_UNIT_PR_AMT)                            INKCS056
01701 *              ,  INV_QTY                                         INKCS056
01702 *              ,  EXTD_AMT                                        INKCS056
01703 *              ,  DKEY_NBR                                        INKCS056
01704 *         INTO                                                    INKCS056
01705 *                :SUMINV-INV-UNIT-PR-AMT                          INKCS056
01706 *              , :SUMINV-INV-QTY                                  INKCS056
01707 *              , :SUMINV-EXTD-AMT                                 INKCS056
01708 *              , :SUMINV-DKEY-NBR                                 INKCS056
01709 *         FROM                                                    INKCS056
01710 *                 TSUMINV                                         INKCS056
01711 *         WHERE                                                   INKCS056
W21732*                 STORE_NBR          =  :SUMINV-STORE-NBR         INKCS056
W21732*           AND   AREA_NBR           =  :SUMINV-AREA-NBR          INKCS056
W21732*           AND   SKU_NBR            =  :SUMINV-SKU-NBR           INKCS056
W21732*           AND   INV_UNIT_PR_AMT    =  :SUMINV-INV-UNIT-PR-AMT   INKCS056
W26682          SELECT                                                          
  |                     INV_UNIT_PR_AMT                                         
  |                  ,  SUM(INV_QTY)                                            
  |                  ,  SUM(EXTD_AMT)                                           
  |             INTO                                                            
  |                    :SUMINV-INV-UNIT-PR-AMT                                  
  |                  , :SUMINV-INV-QTY                                          
  |                  , :SUMINV-EXTD-AMT                                         
  |             FROM                                                            
  |                     TSUMINV                                                 
  |             WHERE                                                           
W26600*                 STORE_NBR          =  :SUMINV-STORE-NBR                 
W26600                  LOC_NBR            =  :SUMINV-LOC-NBR                   
  |               AND   AREA_NBR           =  :SUMINV-AREA-NBR                  
  |               AND   SKU_NBR            =  :SUMINV-SKU-NBR                   
  |               AND   INV_UNIT_PR_AMT    =  :SUMINV-INV-UNIT-PR-AMT           
W26682*         GROUP BY STORE_NBR, AREA_NBR, SKU_NBR, INV_UNIT_PR_AMT          
W26601          GROUP BY LOC_NBR, AREA_NBR, SKU_NBR, INV_UNIT_PR_AMT            
01718      END-EXEC.                                                    INKCS056
01719                                                                   INKCS056
01720      EVALUATE TRUE                                                INKCS056
01721          WHEN SQLCODE = ZERO                                      INKCS056
W26600              MOVE SUMINV-SKU-NBR         TO ADJDTL-SKU-NBR       INKCS056
W26600              MOVE SUMINV-INV-UNIT-PR-AMT TO                      INKCS056
W26600                                            ADJDTL-ADJ-UNIT-PR-AMTINKCS056
01722          WHEN SQLCODE = +100                                      INKCS056
01723               CONTINUE                                            INKCS056
01724          WHEN SQLCODE = -904                                      INKCS056
01725          WHEN SQLCODE = -913                                      INKCS056
01726               PERFORM 9900-SOFT-ABORT                             INKCS056
01727          WHEN SQLWARN0 NOT = SPACES                               INKCS056
01728          WHEN SQLCODE NOT EQUAL ZERO                              INKCS056
01729               MOVE '4100-GET-FROM-TSUMINV'                        INKCS056
01730                                    TO DP013-PARAGRAPH             INKCS056
01731               MOVE 'SELECT TSUMINV'                               INKCS056
01732                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01733               MOVE SQLCA           TO DP013-SQLCA                 INKCS056
01734               MOVE 'TSUMINV'       TO DP013-DB2-TABLE-NAME (1)    INKCS056
01735               SET DP013-DB2-ABEND                                 INKCS056
01736                   DP013-XCTL-DISPLAY-RESTART                      INKCS056
01737                                    TO TRUE                        INKCS056
01738               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
01739      END-EVALUATE.                                                INKCS056
01740                                                                   INKCS056
01741      IF  SQLCODE EQUAL ZERO                                       INKCS056
01742          MOVE SUMINV-INV-UNIT-PR-AMT TO  ASC-ORIG-PRICE           INKCS056
01743                                          ASC-TOT-PRICE            INKCS056
01744          MOVE SUMINV-INV-QTY         TO  ASC-ORIG-QTY             INKCS056
01745                                          ASC-TOT-QTY              INKCS056
01746          MOVE SUMINV-EXTD-AMT        TO  ASC-ORIG-EXT-PRICE       INKCS056
01747                                          ASC-TOT-EXT-PRICE        INKCS056
01748          MOVE SUMINV-DKEY-NBR        TO  ASC-DKEY-NBR             INKCS056
01749      END-IF.                                                      INKCS056
01750 /                                                                 INKCS056
01751 *----------------------------------------------------------------*INKCS056
01752 *    RETRIEVE THE ROWS FROM THE ADJUSTMENT ADD TABLE.            *INKCS056
01753 *----------------------------------------------------------------*INKCS056
01754                                                                   INKCS056
01755  4200-GET-FROM-TADJADD.                                           INKCS056
01756                                                                   INKCS056
W21732*    MOVE ASC-STORE-NBR              TO ADJADD-STORE-NBR.         INKCS056
W21732     MOVE PV-STORE-NUMBER            TO ADJADD-LOC-NBR.           INKCS056
W21732     MOVE ASC-AREA-NBR               TO ADJADD-AREA-NBR.          INKCS056
W21732*    MOVE ASC-SKU-NBR                TO NI-SKU.                   INKCS056
W25428     MOVE ASC-SKU                    TO NI-SKU.                   INKCS056
W21732     MOVE NI-SKU-9                   TO ADJADD-SKU-NBR.           INKCS056
W21732     MOVE ASC-PRICE                  TO ADJADD-ADJ-UNIT-PR-AMT.   INKCS056
01756                                                                   INKCS056
S26600     EXEC SQL                                                     INKCS056
S26600          SELECT                                                  INKCS056
S26600                  ADJ_UNIT_PR_AMT                                 INKCS056
S26600               ,  ADJ_QTY                                         INKCS056
S26600               ,  ADJ_EXTD_AMT                                    INKCS056
S26600               ,  DKEY_NBR                                        INKCS056
S26600               ,  ADJ_RSN_TXT                                     INKCS056
S26600          INTO                                                    INKCS056
S26600                 :ADJADD-ADJ-UNIT-PR-AMT                          INKCS056
S26600               , :ADJADD-ADJ-QTY                                  INKCS056
S26600               , :ADJADD-ADJ-EXTD-AMT                             INKCS056
S26600               , :ADJADD-DKEY-NBR                                 INKCS056
S26600               , :ADJADD-ADJ-RSN-TXT                              INKCS056
S26600          FROM                                                    INKCS056
S26600                  TADJADD                                         INKCS056
S26600          WHERE                                                   INKCS056
S26600*                 STORE_NBR          =  :ADJADD-STORE-NBR         INKCS056
S26600                  LOC_NBR            =  :ADJADD-LOC-NBR           INKCS056
S26600            AND   AREA_NBR           =  :ADJADD-AREA-NBR          INKCS056
S26600            AND   SKU_NBR            =  :ADJADD-SKU-NBR           INKCS056
S26600            AND   ADJ_UNIT_PR_AMT    =  :ADJADD-ADJ-UNIT-PR-AMT   INKCS056
S26600     END-EXEC.                                                    INKCS056
01780                                                                   INKCS056
X26600*    EXEC SQL                                                     INKCS056
X26600*         SELECT  ADJ_UNIT_PR_AMT                                 INKCS056
X26600*              ,  SUM(ADJ_QTY)                                    INKCS056
X26600*              ,  SUM(ADJ_EXTD_AMT)                               INKCS056
X26600**              ,  DKEY_NBR                                       INKCS056
X26600**              ,  ADJ_RSN_TXT                                    INKCS056
X26600*         INTO   :ADJADD-ADJ-UNIT-PR-AMT                          INKCS056
X26600*              , :ADJADD-ADJ-QTY                                  INKCS056
X26600*              , :ADJADD-ADJ-EXTD-AMT                             INKCS056
X26600**              , :ADJADD-DKEY-NBR                                INKCS056
X26600**              , :ADJADD-ADJ-RSN-TXT                             INKCS056
X26600*         FROM    TADJADD                                         INKCS056
X26600*         WHERE   LOC_NBR            =  :ADJADD-LOC-NBR           INKCS056
X26600*           AND   AREA_NBR           =  :ADJADD-AREA-NBR          INKCS056
X26600*           AND   SKU_NBR            =  :ADJADD-SKU-NBR           INKCS056
X26600*           AND   ADJ_UNIT_PR_AMT    =  :ADJADD-ADJ-UNIT-PR-AMT   INKCS056
X26600*         GROUP BY LOC_NBR, AREA_NBR, SKU_NBR, ADJ_UNIT_PR_AMT    INKCS056
X26600**                ,DKEY_NBR, ADJ_RSN_TXT                          INKCS056
W26600*    END-EXEC.                                                    INKCS056
01780                                                                   INKCS056
01781      EVALUATE TRUE                                                INKCS056
01782          WHEN SQLCODE = ZERO                                      INKCS056
W26600              MOVE ADJADD-SKU-NBR         TO ADJDTL-SKU-NBR       INKCS056
W26600              MOVE ADJADD-ADJ-UNIT-PR-AMT TO                      INKCS056
W26600                                            ADJDTL-ADJ-UNIT-PR-AMTINKCS056
01783          WHEN SQLCODE = +100                                      INKCS056
01784               CONTINUE                                            INKCS056
01785          WHEN SQLCODE = -904                                      INKCS056
01786          WHEN SQLCODE = -913                                      INKCS056
01787               PERFORM 9900-SOFT-ABORT                             INKCS056
01788          WHEN SQLWARN0 NOT = SPACES                               INKCS056
01789          WHEN SQLCODE NOT EQUAL ZERO                              INKCS056
01790               MOVE '4200-GET-FROM-TADJADD'                        INKCS056
01791                                    TO DP013-PARAGRAPH             INKCS056
01792               MOVE 'SELECT TADJADD'                               INKCS056
01793                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01794               MOVE SQLCA           TO DP013-SQLCA                 INKCS056
01795               MOVE 'TADJADD'       TO DP013-DB2-TABLE-NAME (1)    INKCS056
01796               SET DP013-DB2-ABEND                                 INKCS056
01797                   DP013-XCTL-DISPLAY-RESTART                      INKCS056
01798                                    TO TRUE                        INKCS056
01799               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
01800      END-EVALUATE.                                                INKCS056
01801                                                                   INKCS056
01802      IF  SQLCODE EQUAL ZERO                                       INKCS056
01803          MOVE ADJADD-ADJ-UNIT-PR-AMT TO  ASC-ORIG-PRICE           INKCS056
01804                                          ASC-TOT-PRICE            INKCS056
01805          MOVE ADJADD-ADJ-QTY         TO  ASC-ORIG-QTY             INKCS056
01806                                          ASC-TOT-QTY              INKCS056
01807          MOVE ADJADD-ADJ-EXTD-AMT    TO  ASC-ORIG-EXT-PRICE       INKCS056
01808                                          ASC-TOT-EXT-PRICE        INKCS056
S26600         MOVE ADJADD-DKEY-NBR        TO  ASC-DKEY-NBR             INKCS056
S26600         MOVE ADJADD-ADJ-RSN-TXT     TO  ASC-ORIG-REASON          INKCS056
01811      END-IF.                                                      INKCS056
01812 /                                                                 INKCS056
01813 *----------------------------------------------------------------*INKCS056
01814 *    RETRIEVE THE ADJUSTMENT DETAIL ROWS.                        *INKCS056
01815 *----------------------------------------------------------------*INKCS056
01816                                                                   INKCS056
01817  4300-GET-TADJDTL.                                                INKCS056
01818                                                                   INKCS056
01819      PERFORM 4310-OPEN-ADJ-CSR.                                   INKCS056
01820      IF  SQLCODE EQUAL ZERO                                       INKCS056
01821          PERFORM 4320-RETRIEVE-ADJ-ROWS                           INKCS056
01822                  UNTIL SQLCODE NOT EQUAL ZERO                     INKCS056
01823          IF  SQLCODE EQUAL ZERO OR +100                           INKCS056
01824              PERFORM 4340-CLOSE-ADJ-CSR                           INKCS056
01825          END-IF                                                   INKCS056
01826      END-IF.                                                      INKCS056
01827                                                                   INKCS056
01828 *----------------------------------------------------------------*INKCS056
01829 *    OPEN THE ADJDTL CURSOR.                                     *INKCS056
01830 *----------------------------------------------------------------*INKCS056
01831                                                                   INKCS056
01832  4310-OPEN-ADJ-CSR.                                               INKCS056
01833                                                                   INKCS056
01834      EXEC SQL                                                     INKCS056
01835           OPEN ADJ-CSR                                            INKCS056
01836      END-EXEC.                                                    INKCS056
01837                                                                   INKCS056
01838      EVALUATE TRUE                                                INKCS056
01839          WHEN SQLCODE = ZERO                                      INKCS056
01840          WHEN SQLCODE = +100                                      INKCS056
01841               CONTINUE                                            INKCS056
01842          WHEN SQLCODE = -904                                      INKCS056
01843          WHEN SQLCODE = -913                                      INKCS056
01844               PERFORM 9900-SOFT-ABORT                             INKCS056
01845          WHEN SQLWARN0 NOT = SPACES                               INKCS056
01846          WHEN SQLCODE NOT EQUAL ZERO                              INKCS056
01847               MOVE '4310-OPEN-ADJ-CSR'                            INKCS056
01848                                    TO DP013-PARAGRAPH             INKCS056
01849               MOVE 'OPEN ADJDTL CURSOR'                           INKCS056
01850                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01851               MOVE SQLCA           TO DP013-SQLCA                 INKCS056
01852               MOVE 'TADJDTL'       TO DP013-DB2-TABLE-NAME (1)    INKCS056
01853               SET DP013-DB2-ABEND                                 INKCS056
01854                   DP013-XCTL-DISPLAY-RESTART                      INKCS056
01855                                    TO TRUE                        INKCS056
01856               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
01857      END-EVALUATE.                                                INKCS056
01858                                                                   INKCS056
01859 *----------------------------------------------------------------*INKCS056
01860 *    NOW, FETCH THE ROWS AND LOAD THE ASC.                       *INKCS056
01861 *----------------------------------------------------------------*INKCS056
01862                                                                   INKCS056
01863  4320-RETRIEVE-ADJ-ROWS.                                          INKCS056
01864                                                                   INKCS056
01865      PERFORM 4330-FETCH-ADJ-CSR.                                  INKCS056
01866      IF  SQLCODE EQUAL ZERO                                       INKCS056
01867          PERFORM 4350-LOAD-ASC                                    INKCS056
01868      END-IF.                                                      INKCS056
01869                                                                   INKCS056
01870 *----------------------------------------------------------------*INKCS056
01871 *    FETCH A ROW FROM THE ADJDTL CURSOR.                         *INKCS056
01872 *----------------------------------------------------------------*INKCS056
01873                                                                   INKCS056
01874  4330-FETCH-ADJ-CSR.                                              INKCS056
01875                                                                   INKCS056
01876      EXEC SQL                                                     INKCS056
01877           FETCH                                                   INKCS056
01878                   ADJ-CSR                                         INKCS056
01879           INTO                                                    INKCS056
01880                  :ADJDTL-ADJ-UNIT-PR-AMT                          INKCS056
01881                , :ADJDTL-ADJ-QTY                                  INKCS056
01882                , :ADJDTL-ADJ-EXTD-AMT                             INKCS056
01883                , :ADJDTL-ADJ-RSN-TXT                              INKCS056
01884                , :ADJDTL-CRE-TMST                                 INKCS056
01885                , :ADJDTL-CRE-ID-NBR                               INKCS056
01886      END-EXEC.                                                    INKCS056
01887                                                                   INKCS056
01888      EVALUATE TRUE                                                INKCS056
01889          WHEN SQLCODE = ZERO                                      INKCS056
01890          WHEN SQLCODE = +100                                      INKCS056
01891               CONTINUE                                            INKCS056
01892          WHEN SQLCODE = -904                                      INKCS056
01893          WHEN SQLCODE = -913                                      INKCS056
01894               PERFORM 9900-SOFT-ABORT                             INKCS056
01895          WHEN SQLWARN0 NOT = SPACES                               INKCS056
01896          WHEN SQLCODE NOT EQUAL ZERO                              INKCS056
01897               MOVE '4330-FETCH-ADJ-CSR'                           INKCS056
01898                                    TO DP013-PARAGRAPH             INKCS056
01899               MOVE 'FETCH ADJADD CURSOR'                          INKCS056
01900                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01901               MOVE SQLCA           TO DP013-SQLCA                 INKCS056
01902               MOVE 'TADJADD'       TO DP013-DB2-TABLE-NAME (1)    INKCS056
01903               SET DP013-DB2-ABEND                                 INKCS056
01904                   DP013-XCTL-DISPLAY-RESTART                      INKCS056
01905                                    TO TRUE                        INKCS056
01906               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
01907      END-EVALUATE.                                                INKCS056
01908                                                                   INKCS056
01909 *----------------------------------------------------------------*INKCS056
01910 *    CLOSE THE ADJADD CURSOR.                                    *INKCS056
01911 *----------------------------------------------------------------*INKCS056
01912                                                                   INKCS056
01913  4340-CLOSE-ADJ-CSR.                                              INKCS056
01914                                                                   INKCS056
01915      EXEC SQL                                                     INKCS056
01916           CLOSE ADJ-CSR                                           INKCS056
01917      END-EXEC.                                                    INKCS056
01918                                                                   INKCS056
01919      EVALUATE TRUE                                                INKCS056
01920          WHEN SQLCODE = ZERO                                      INKCS056
01921               CONTINUE                                            INKCS056
01922          WHEN SQLCODE = -904                                      INKCS056
01923          WHEN SQLCODE = -913                                      INKCS056
01924               PERFORM 9900-SOFT-ABORT                             INKCS056
01925          WHEN SQLWARN0 NOT = SPACES                               INKCS056
01926          WHEN SQLCODE NOT EQUAL ZERO                              INKCS056
01927               MOVE '4340-CLOSE-ADJ-CSR'                           INKCS056
01928                                    TO DP013-PARAGRAPH             INKCS056
01929               MOVE 'CLOSE ADJADD CURSOR'                          INKCS056
01930                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
01931               MOVE SQLCA           TO DP013-SQLCA                 INKCS056
01932               MOVE 'TADJADD'       TO DP013-DB2-TABLE-NAME (1)    INKCS056
01933               SET DP013-DB2-ABEND                                 INKCS056
01934                   DP013-XCTL-DISPLAY-RESTART                      INKCS056
01935                                    TO TRUE                        INKCS056
01936               PERFORM DP013-0000-PROCESS-ABEND                    INKCS056
01937      END-EVALUATE.                                                INKCS056
01938                                                                   INKCS056
01939 /                                                                 INKCS056
01940 *----------------------------------------------------------------*INKCS056
01941 *    MOVE THE DATA FROM THE HOST VARIALBES TO THE ASC.           *INKCS056
01942 *----------------------------------------------------------------*INKCS056
01943                                                                   INKCS056
01944  4350-LOAD-ASC.                                                   INKCS056
01945                                                                   INKCS056
01946      ADD 1                       TO  ASC-MAP-SUB.                 INKCS056
01947      IF  ASC-MAP-SUB GREATER THAN 5                               INKCS056
01948          MOVE PC-TSYMSG-00698    TO  DP020-MSG-NUMBER             INKCS056
01949          SET ASC-NO-ADJUSTMENTS-ALLOWED                           INKCS056
01950              DP030-SET-CURSOR-TRAILER                             INKCS056
01951              DP020-MSG-FATAL                                      INKCS056
01952              PS-ERROR            TO  TRUE                         INKCS056
01953          MOVE 6                  TO  ASC-MAP-SUB                  INKCS056
01954      END-IF.                                                      INKCS056
01955                                                                   INKCS056
01956      MOVE ADJDTL-CRE-TMST       TO  PV-WORK-TMST.                 INKCS056
01957      MOVE PV-WT-YY              TO  PV-DD-YY.                     INKCS056
01958      MOVE PV-WT-MM              TO  PV-DD-MM.                     INKCS056
01959      MOVE PV-WT-DD              TO  PV-DD-DD.                     INKCS056
01960      MOVE PV-DISPLAY-DATE       TO  ASC-MAP-ADJ-DATE (ASC-MAP-SUB)INKCS056
01961                                                                   INKCS056
01962      MOVE ADJDTL-ADJ-UNIT-PR-AMT                                  INKCS056
01963                                 TO  ASC-MAP-ADJ-PRICE(ASC-MAP-SUB)INKCS056
01964      MOVE ADJDTL-ADJ-QTY        TO  ASC-MAP-ADJ-QTY  (ASC-MAP-SUB)INKCS056
01965      MOVE ADJDTL-CRE-ID-NBR     TO  ASC-MAP-USERID   (ASC-MAP-SUB)INKCS056
01966      MOVE ADJDTL-ADJ-EXTD-AMT                                     INKCS056
01967                                 TO  ASC-MAP-ADJ-EXT-PRICE         INKCS056
01968                                                      (ASC-MAP-SUB)INKCS056
01969      MOVE ADJDTL-ADJ-RSN-TXT    TO  ASC-MAP-REASON   (ASC-MAP-SUB)INKCS056
01970                                                                   INKCS056
01971      ADD ADJDTL-ADJ-QTY         TO  ASC-TOT-QTY.                  INKCS056
01972      ADD ADJDTL-ADJ-UNIT-PR-AMT                                   INKCS056
01973                                 TO  ASC-TOT-PRICE.                INKCS056
01974      ADD ADJDTL-ADJ-EXTD-AMT    TO  ASC-TOT-EXT-PRICE.            INKCS056
01975 /                                                                 INKCS056
01976 *----------------------------------------------------------------*INKCS056
01977 *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *INKCS056
01978 *----------------------------------------------------------------*INKCS056
01979                                                                   INKCS056
01980  4400-MOVE-COMMAREA-TO-SCREEN.                                    INKCS056
01981                                                                   INKCS056
01982      MOVE IN001-STORE-NBR          TO  ASTRNBRO.                  INKCS056
01982      MOVE IN001-STORE-NAME         TO  ASTRNAMO.                  INKCS056
01983      MOVE ASC-AREA-NBR             TO  AAREAO.                    INKCS056
W26600     MOVE ASC-NEW-REASON           TO  ANREASNO.                  INKCS056
W26600*    EVALUATE TRUE                                                INKCS056
W26600*        WHEN ASC-FROM-TSUMINV                                    INKCS056
W26600*             MOVE SPACES          TO  ASC-ORIG-REASON            INKCS056
W26600*        WHEN ASC-FROM-TADJADD                                    INKCS056
W26600*             MOVE 'ADJ ADD'       TO  ASC-ORIG-REASON            INKCS056
W26600*        WHEN ASC-FROM-TADJDTL                                    INKCS056
W26600*             MOVE 'ADJUST '       TO  ASC-ORIG-REASON            INKCS056
W26600*    END-EVALUATE.                                                INKCS056
01985                                                                   INKCS056
01986      IF  ASC-NEW-PRICE NUMERIC                                    INKCS056
01987          MOVE ASC-NEW-PRICE        TO  ANADJPRO                   INKCS056
01988      ELSE                                                         INKCS056
01989          MOVE ASC-NEW-PRICE-X      TO  ANADJPRO                   INKCS056
01990      END-IF.                                                      INKCS056
01991      IF  ASC-NEW-QTY NUMERIC                                      INKCS056
01992          MOVE ASC-NEW-QTY          TO  ANADJQTO                   INKCS056
01993      ELSE                                                         INKCS056
01994          MOVE ASC-NEW-QTY-X        TO  ANADJQTO                   INKCS056
01995      END-IF.                                                      INKCS056
01996                                                                   INKCS056
01997      IF  ASC-ADD-NEW                                              INKCS056
W21732*        MOVE ASC-SKU-NBR          TO  ANSKUO                     INKCS056
W25428         MOVE ASC-SKU              TO  ANSKUO                     INKCS056
W21732         IF  ANSKUC  NOT EQUAL DP015-RED                          INKCS056
W21732             MOVE DP015-GREEN      TO  ANSKUC                     INKCS056
W21732             MOVE DP015-UNDERLINE  TO  ANSKUH                     INKCS056
W21732             MOVE DP015-UNP-ALP-NOR-OFF                           INKCS056
W21732                                   TO  ANSKUA                     INKCS056
02056              IF  PS-NO-ERROR                                      INKCS056
02013                  MOVE -1           TO  ANADJQTL                   INKCS056
02014              END-IF                                               INKCS056
02015          END-IF                                                   INKCS056
02016      ELSE                                                         INKCS056
02017          PERFORM 4410-MOVE-REST                                   INKCS056
02018      END-IF.                                                      INKCS056
02019                                                                   INKCS056
02020 *----------------------------------------------------------------*INKCS056
02021 *    THERE IS DATA TO BE MOVED, SO MOVE IT.                      *INKCS056
02022 *----------------------------------------------------------------*INKCS056
02023                                                                   INKCS056
02024  4410-MOVE-REST.                                                  INKCS056
02025                                                                   INKCS056
W21732*    MOVE ASC-SKU-NBR              TO  ASKUO.                     INKCS056
W25428     MOVE ASC-SKU                  TO  ASKUO.                     INKCS056
02029                                                                   INKCS056
02030      MOVE ASC-ORIG-QTY             TO  AQTYO.                     INKCS056
02031      MOVE ASC-ORIG-PRICE           TO  APRICEO.                   INKCS056
02032      MOVE ASC-ORIG-EXT-PRICE       TO  AEXTPRIO.                  INKCS056
02033      MOVE ASC-ORIG-REASON          TO  AREASONO.                  INKCS056
02034                                                                   INKCS056
02035      MOVE ASC-TOT-QTY              TO  ATOTQTYO.                  INKCS056
02036      MOVE ASC-TOT-PRICE            TO  ATOTPRIO.                  INKCS056
02037      MOVE ASC-TOT-EXT-PRICE        TO  ATOTEXTO.                  INKCS056
02038                                                                   INKCS056
02039      IF  PS-NO-ERROR                                              INKCS056
02040          IF  ASC-ADJUSTMENTS-ALLOWED                              INKCS056
02041              MOVE -1               TO  ANADJQTL                   INKCS056
02042          ELSE                                                     INKCS056
02043              SET DP030-SET-CURSOR-TRAILER                         INKCS056
02044                                    TO  TRUE                       INKCS056
02045          END-IF                                                   INKCS056
02046      END-IF.                                                      INKCS056
02047                                                                   INKCS056
02048      PERFORM VARYING ASC-MAP-SUB                                  INKCS056
02049          FROM 1 BY 1                                              INKCS056
02050          UNTIL ASC-MAP-SUB GREATER THAN 6                         INKCS056
02051                                                                   INKCS056
02052          IF  ASC-MAP-USERID(ASC-MAP-SUB) > SPACES                 INKCS056
02053              MOVE ASC-MAP-USERID       (ASC-MAP-SUB)              INKCS056
02054                                    TO  MR-USERIDO  (ASC-MAP-SUB)  INKCS056
02055              MOVE ASC-MAP-ADJ-DATE     (ASC-MAP-SUB)              INKCS056
02056                                    TO  MR-ADJ-DATEO (ASC-MAP-SUB) INKCS056
02057              MOVE ASC-MAP-ADJ-QTY      (ASC-MAP-SUB)              INKCS056
02058                                    TO  MR-ADJ-QTYO  (ASC-MAP-SUB) INKCS056
02059              MOVE ASC-MAP-ADJ-PRICE    (ASC-MAP-SUB)              INKCS056
02060                                    TO  MR-ADJ-PRICEO(ASC-MAP-SUB) INKCS056
02061              MOVE ASC-MAP-ADJ-EXT-PRICE(ASC-MAP-SUB)              INKCS056
02062                                    TO  MR-EXT-PRICEO(ASC-MAP-SUB) INKCS056
02063              MOVE ASC-MAP-REASON       (ASC-MAP-SUB)              INKCS056
02064                                    TO MR-ADJ-REASONO(ASC-MAP-SUB) INKCS056
02065          ELSE                                                     INKCS056
02066              MOVE SPACES           TO  MR-USERIDO  (ASC-MAP-SUB)  INKCS056
02067                                        MR-ADJ-DATEO (ASC-MAP-SUB) INKCS056
02068                                        MR-ADJ-QTYX  (ASC-MAP-SUB) INKCS056
02069                                        MR-ADJ-PRICEX(ASC-MAP-SUB) INKCS056
02070                                        MR-EXT-PRICEX(ASC-MAP-SUB) INKCS056
02071                                       MR-ADJ-REASONO(ASC-MAP-SUB) INKCS056
02072          END-IF                                                   INKCS056
02073      END-PERFORM.                                                 INKCS056
02074 /                                                                 INKCS056
02075 *----------------------------------------------------------------*INKCS056
02076 *    ENSURE DATA WAS ENTERED BEFORE UPDATING.                    *INKCS056
02077 *----------------------------------------------------------------*INKCS056
02078                                                                   INKCS056
W26682*5000-BEGIN-UPDATE-PROCESS.                                       INKCS056
02080 *                                                                 INKCS056
02081 *    IF  ASC-ADD-NEW                                              INKCS056
02082 *        PERFORM 5001-CONTINUE-UPDATE                             INKCS056
02083 *    ELSE                                                         INKCS056
02084 *        IF  ASC-NEW-PRICE GREATER THAN ZERO                      INKCS056
02085 *        OR  ASC-NEW-QTY   NOT EQUAL ZERO                         INKCS056
02086 *            PERFORM 5001-CONTINUE-UPDATE                         INKCS056
02087 *        ELSE                                                     INKCS056
02088 *            SET PS-ERROR            TO  TRUE                     INKCS056
02089 *            SET DP020-MSG-FATAL     TO  TRUE                     INKCS056
02090 *            IF  ASC-NO-ADJUSTMENTS-ALLOWED                       INKCS056
02091 *                SET DP030-SET-CURSOR-TRAILER                     INKCS056
02092 *                                    TO  TRUE                     INKCS056
02093 *                MOVE PC-TSYMSG-00698                             INKCS056
02094 *                                TO  DP020-MSG-NUMBER             INKCS056
02095 *            ELSE                                                 INKCS056
02096 *                MOVE -1             TO  ANADJQTL                 INKCS056
02097 *                MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER         INKCS056
02098 *            END-IF                                               INKCS056
02099 *        END-IF                                                   INKCS056
02100 *    END-IF.                                                      INKCS056
02101 *                                                                 INKCS056
02102 *                                                                 INKCS056
02103 *----------------------------------------------------------------*INKCS056
02104 *    DETERMINE WHETHER THIS IS THE FIRST ADJUSTMENT FOR THIS     *INKCS056
02105 *    SKU.  IF SO, ADD TO ADJADD, ELSE, ADD TO ADJDTL.            *INKCS056
02106 *----------------------------------------------------------------*INKCS056
02107 *                                                                 INKCS056
W26682*5001-CONTINUE-UPDATE.                                            INKCS056
02109 *                                                                 INKCS056
02110 *    IF  ASC-ADD-NEW                                              INKCS056
02111 *        PERFORM 5100-PREPARE-TADJADD-ROW                         INKCS056
02112 *        PERFORM 5110-INSERT-TADJADD-ROW                          INKCS056
02113 *    ELSE                                                         INKCS056
02114 *        PERFORM 5200-PREPARE-TADJDTL-ROW                         INKCS056
02115 *        PERFORM 5210-INSERT-TADJDTL-ROW                          INKCS056
02116 *    END-IF.                                                      INKCS056
02117 *                                                                 INKCS056
W21732*    IF (ASC-SKU-NBR (6:3) = '000' OR '999'                       INKCS056
W25428*    IF (ASC-SKU (6:3) = '000' OR '999'                           INKCS056
02119 *    OR  ASC-CLEARANCE                                            INKCS056
02120 *    OR  IN015-ADJUSTMENT-QTY EQUAL ZERO)                         INKCS056
02121 *        CONTINUE                                                 INKCS056
02122 *    ELSE                                                         INKCS056
02123 *        PERFORM 5300-WRITE-VSAM-ADJUST-REC                       INKCS056
02124 *    END-IF                                                       INKCS056
02125 *                                                                 INKCS056
02126 *    IF  ASC-USE-SELECTION-QUEUE                                  INKCS056
02127 *        PERFORM 9000-UPDATE-SELECTION-QUEUE                      INKCS056
02128 *    END-IF.                                                      INKCS056
02129 *                                                                 INKCS056
02130 *    MOVE ZERO                     TO  ADADJQTO                   INKCS056
02131 *                                      ADADJPRO                   INKCS056
02132 *                                      ADEXTPRO.                  INKCS056
02133 *                                                                 INKCS056
02134 *----------------------------------------------------------------*INKCS056
02135 *    FIRST, GENERATE THE DATALESS KEY.  NEXT, PREPARE THE        *INKCS056
02136 *    REST OF THE HOST VARIABLES FOR TADJADD.                     *INKCS056
02137 *----------------------------------------------------------------*INKCS056
02138 *                                                                 INKCS056
W26682*5100-PREPARE-TADJADD-ROW.                                        INKCS056
02140 *                                                                 INKCS056
02141 *    ADD PC-11                     TO  ASC-ADD-NUM.               INKCS056
02142 *    COMPUTE PV-TODAYS-TIME        =  (DP020-SRC-TASK-NUMBER      INKCS056
02143 *                                  +   ASC-ADD-NUM)               INKCS056
02144 *                                  *   PC-11.                     INKCS056
02145 *    MOVE PV-HUND-SEC              TO  PV-SEED-BYTE-1-2.          INKCS056
02146 *    MOVE PV-SEC                   TO  PV-SEED-BYTE-3-4.          INKCS056
02147 *    MOVE PV-MIN                   TO  PV-SEED-BYTE-5-6.          INKCS056
02148 *    MOVE PV-HH                    TO  PV-SEED-BYTE-7-8.          INKCS056
02149 *    MOVE PV-INITIAL-SEED          TO  PV-SEED.                   INKCS056
02150 *                                                                 INKCS056
02151 *    COMPUTE PV-WORK-FIELD    =                                   INKCS056
02152 *           ((PV-SEED + PC-PRIME1) * PC-PRIME2).                  INKCS056
02153 *                                                                 INKCS056
02154 *    DIVIDE PV-WORK-FIELD BY  PC-ONE-BILLION                      INKCS056
02155 *           GIVING PV-WORK-FIELD2                                 INKCS056
02156 *           REMAINDER PV-RANDOM-NUMBER.                           INKCS056
02157 *                                                                 INKCS056
02158 *    MOVE PV-RANDOM-NUMBER         TO  ASC-DKEY-NBR               INKCS056
02159 *                                      ADJADD-DKEY-NBR.           INKCS056
02160 *                                                                 INKCS056
W26600*    MOVE ASC-STORE-NBR            TO  ADJADD-STORE-NBR           INKCS056
W26600*                                      PV-STORE-NBR-X.                    
W26600*    MOVE PV-STORE-NBR-9           TO  ADJADD-LOC-NBR.                    
      *                                                                         
02162 *    MOVE ASC-AREA-NBR             TO  ADJADD-AREA-NBR.           INKCS056
W21732*    MOVE ASC-SKU-NBR              TO  NI-SKU.                    INKCS056
W25428*    MOVE ASC-SKU                  TO  NI-SKU.                    INKCS056
W21732*    MOVE NI-SKU-9                 TO  ADJADD-SKU-NBR.            INKCS056
02167 *    MOVE SPACE                    TO  ADJADD-MISSED-MD-IND.      INKCS056
02168 *    MOVE DP020-USERID             TO  ADJADD-CHG-ID-NBR.         INKCS056
02169 *                                                                 INKCS056
02170 *    MOVE ASC-NEW-REASON           TO  ADJADD-ADJ-RSN-TXT.        INKCS056
02171 *    MOVE ASC-NEW-PRICE            TO  ADJADD-ADJ-UNIT-PR-AMT.    INKCS056
02172 *    MOVE ASC-NEW-QTY              TO  ADJADD-ADJ-QTY             INKCS056
02173 *                                      IN015-ADJUSTMENT-QTY.      INKCS056
02174 *                                                                 INKCS056
02175 *    EVALUATE TRUE                                                INKCS056
02176 *      WHEN ASC-NEW-PRICE EQUAL ZERO                              INKCS056
02177 *         COMPUTE ADJADD-ADJ-EXTD-AMT = ADJADD-ADJ-QTY            INKCS056
02178 *                                     * ASC-TOT-PRICE             INKCS056
02179 *      WHEN ASC-NEW-QTY EQUAL ZERO                                INKCS056
02180 *         COMPUTE ADJADD-ADJ-EXTD-AMT = ASC-TOT-QTY               INKCS056
02181 *                                     * ADJADD-ADJ-UNIT-PR-AMT    INKCS056
02182 *      WHEN OTHER                                                 INKCS056
02183 *         COMPUTE ADJADD-ADJ-EXTD-AMT = ADJADD-ADJ-QTY            INKCS056
02184 *                                     * ADJADD-ADJ-UNIT-PR-AMT    INKCS056
02185 *    END-EVALUATE.                                                INKCS056
02186 *                                                                 INKCS056
02187 *----------------------------------------------------------------*INKCS056
02188 *     INSERT THE TADJADD TABLE.                                  *INKCS056
02189 *----------------------------------------------------------------*INKCS056
02190 *                                                                 INKCS056
W26682*5110-INSERT-TADJADD-ROW.                                         INKCS056
02192 *                                                                 INKCS056
02193 *    SET PS-INSERT-NOT-DONE        TO TRUE.                       INKCS056
02194 *    PERFORM UNTIL PS-INSERT-DONE                                 INKCS056
02195 *        EXEC SQL                                                 INKCS056
02196 *             INSERT                                              INKCS056
02197 *             INTO  TADJADD                                       INKCS056
02198 *                  (STORE_NBR                                     INKCS056
W26600*                 , LOC_NBR                                       INKCS056
02199 *                 , AREA_NBR                                      INKCS056
W21732*                 , SKU_NBR                                       INKCS056
02203 *                 , ADJ_UNIT_PR_AMT                               INKCS056
02204 *                 , ADJ_QTY                                       INKCS056
02205 *                 , MISSED_MD_IND                                 INKCS056
02206 *                 , DKEY_NBR                                      INKCS056
02207 *                 , CHG_TMST                                      INKCS056
02208 *                 , CHG_ID_NBR                                    INKCS056
02209 *                 , ADJ_RSN_TXT                                   INKCS056
02210 *                 , ADJ_EXTD_AMT)                                 INKCS056
02211 *            VALUES                                               INKCS056
02212 *                  (:ADJADD-STORE-NBR                             INKCS056
W26600*                 , :ADJADD-LOC-NBR                               INKCS056
02213 *                 , :ADJADD-AREA-NBR                              INKCS056
W21732*                 , :ADJADD-SKU-NBR                               INKCS056
02217 *                 , :ADJADD-ADJ-UNIT-PR-AMT                       INKCS056
02218 *                 , :ADJADD-ADJ-QTY                               INKCS056
02219 *                 , :ADJADD-MISSED-MD-IND                         INKCS056
02220 *                 , :ADJADD-DKEY-NBR                              INKCS056
02221 *                 ,  CURRENT TIMESTAMP                            INKCS056
02222 *                 , :ADJADD-CHG-ID-NBR                            INKCS056
02223 *                 , :ADJADD-ADJ-RSN-TXT                           INKCS056
02224 *                 , :ADJADD-ADJ-EXTD-AMT)                         INKCS056
02225 *        END-EXEC                                                 INKCS056
02226 *                                                                 INKCS056
02227 *        EVALUATE TRUE                                            INKCS056
02228 *            WHEN SQLCODE = ZERO                                  INKCS056
02229 *                 SET PS-INSERT-DONE TO TRUE                      INKCS056
02230 *            WHEN SQLCODE = -803                                  INKCS056
02231 *                 COMPUTE PV-RANDOM-NUMBER =                      INKCS056
02232 *                         PV-RANDOM-NUMBER *                      INKCS056
02233 *                        (PC-11 * ASC-ADD-NUM)                    INKCS056
02234 *                 ADD PC-11        TO  ASC-ADD-NUM                INKCS056
02235 *                 MOVE PV-RANDOM-NUMBER                           INKCS056
02236 *                                  TO  ASC-DKEY-NBR               INKCS056
02237 *                                      ADJADD-DKEY-NBR            INKCS056
02238 *            WHEN SQLCODE = -904                                  INKCS056
02239 *            WHEN SQLCODE = -913                                  INKCS056
02240 *                 PERFORM 9900-SOFT-ABORT                         INKCS056
02241 *                 SET PS-INSERT-DONE TO TRUE                      INKCS056
02242 *            WHEN SQLWARN0 NOT = SPACES                           INKCS056
02243 *            WHEN SQLCODE < ZERO                                  INKCS056
02244 *            WHEN SQLCODE > ZERO                                  INKCS056
02245 *                MOVE '5110-INSERT-TADJADD-ROW'                   INKCS056
02246 *                                  TO DP013-PARAGRAPH             INKCS056
02247 *                MOVE 'INSERT A ROW ON THE TADJADD TABLE'         INKCS056
02248 *                                  TO DP013-MESSAGE-TEXT(1)       INKCS056
02249 *                MOVE SQLCA        TO DP013-SQLCA                 INKCS056
02250 *                MOVE 'TADJADD'    TO DP013-DB2-TABLE-NAME (1)    INKCS056
02251 *                SET DP013-DB2-ABEND                              INKCS056
02252 *                    DP013-XCTL-DISPLAY-RESTART TO TRUE           INKCS056
02253 *                PERFORM DP013-0000-PROCESS-ABEND                 INKCS056
02254 *        END-EVALUATE                                             INKCS056
02255 *    END-PERFORM.                                                 INKCS056
02256 *                                                                 INKCS056
02257 *----------------------------------------------------------------*INKCS056
02258 *    PREPARE THE ADJUSTMENT DETAIL HOST VARIABLES.               *INKCS056
02259 *----------------------------------------------------------------*INKCS056
02260 *                                                                 INKCS056
W26682*5200-PREPARE-TADJDTL-ROW.                                        INKCS056
02262 *                                                                 INKCS056
02263 *    IF  ASC-NEW-PRICE EQUAL ZERO                                 INKCS056
02264 *        MOVE ZERO                 TO  ASC-ACT-ADJ-PRICE          INKCS056
02265 *                                      PV-ADJ-EXT1                INKCS056
02266 *    ELSE                                                         INKCS056
02267 *        COMPUTE ASC-ACT-ADJ-PRICE  =  ASC-NEW-PRICE              INKCS056
02268 *                                   -  ASC-TOT-PRICE              INKCS056
02269 *        COMPUTE PV-ADJ-EXT1        =  ASC-ACT-ADJ-PRICE          INKCS056
02270 *                                   *  ASC-TOT-QTY                INKCS056
02271 *    END-IF.                                                      INKCS056
02272 *                                                                 INKCS056
02273 *    IF  ASC-NEW-QTY EQUAL ZERO                                   INKCS056
02274 *        MOVE ZERO                 TO  ASC-ACT-ADJ-QTY            INKCS056
02275 *                                      PV-ADJ-EXT2                INKCS056
02276 *    ELSE                                                         INKCS056
02277 *        COMPUTE ASC-ACT-ADJ-QTY    =  ASC-NEW-QTY                INKCS056
02278 *                                   -  ASC-TOT-QTY                INKCS056
02279 *        IF  PV-ADJ-EXT1 EQUAL ZERO                               INKCS056
02280 *            COMPUTE PV-ADJ-EXT2    =  ASC-ACT-ADJ-QTY            INKCS056
02281 *                                   *  ASC-TOT-PRICE              INKCS056
02282 *        ELSE                                                     INKCS056
02283 *            COMPUTE PV-ADJ-EXT2    =  ASC-ACT-ADJ-QTY            INKCS056
02284 *                                   *  ASC-NEW-PRICE              INKCS056
02285 *        END-IF                                                   INKCS056
02286 *    END-IF.                                                      INKCS056
02287 *                                                                 INKCS056
02288 *    COMPUTE ADJDTL-ADJ-EXTD-AMT    =  PV-ADJ-EXT1                INKCS056
02289 *                                   +  PV-ADJ-EXT2.               INKCS056
02290 *                                                                 INKCS056
W26600*    MOVE ASC-STORE-NBR            TO  ADJDTL-STORE-NBR           INKCS056
W26600*                                      PV-STORE-NBR-X.                    
W26600*    MOVE PV-STORE-NBR-9           TO  ADJDTL-LOC-NBR.                    
      *                                                                         
02292 *    MOVE ASC-AREA-NBR             TO  ADJDTL-AREA-NBR.           INKCS056
02293 *    MOVE ASC-ADJ-TYPE-CDE         TO  ADJDTL-ADJ-TYPE-CDE.       INKCS056
02294 *    MOVE ASC-NEW-REASON           TO  ADJDTL-ADJ-RSN-TXT.        INKCS056
02295 *                                                                 INKCS056
W21732*    MOVE ASC-SKU-NBR              TO  NI-SKU.                    INKCS056
W25428*    MOVE ASC-SKU                  TO  NI-SKU.                    INKCS056
W21732*    MOVE NI-SKU-9                 TO  ADJDTL-SKU-NBR.            INKCS056
02299 *    MOVE ASC-ACT-ADJ-PRICE        TO  ADJDTL-ADJ-UNIT-PR-AMT.    INKCS056
02300 *    MOVE ASC-ACT-ADJ-QTY          TO  ADJDTL-ADJ-QTY             INKCS056
02301 *                                      IN015-ADJUSTMENT-QTY.      INKCS056
02302 *                                                                 INKCS056
02303 *    MOVE ASC-DKEY-NBR             TO  ADJDTL-DKEY-NBR.           INKCS056
02304 *    MOVE DP020-USERID             TO  ADJDTL-CRE-ID-NBR.         INKCS056
02305 *                                                                 INKCS056
02306 *----------------------------------------------------------------*INKCS056
02307 *    INSERT THE ADJUSTMENT DETAIL ROW.                           *INKCS056
02308 *----------------------------------------------------------------*INKCS056
02309 *                                                                 INKCS056
02310 *5210-INSERT-TADJDTL-ROW.                                         INKCS056
02311 *                                                                 INKCS056
02312 *        EXEC SQL                                                 INKCS056
02313 *             INSERT                                              INKCS056
02314 *             INTO  TADJDTL                                       INKCS056
02315 *                  (STORE_NBR                                     INKCS056
W26600*                 , LOC_NBR                                       INKCS056
02316 *                 , AREA_NBR                                      INKCS056
W21732*                 , SKU_NBR                                       INKCS056
02320 *                 , CRE_TMST                                      INKCS056
02321 *                 , ADJ_RSN_TXT                                   INKCS056
02322 *                 , ADJ_TYPE_CDE                                  INKCS056
02323 *                 , ADJ_UNIT_PR_AMT                               INKCS056
02324 *                 , ADJ_QTY                                       INKCS056
02325 *                 , ADJ_EXTD_AMT                                  INKCS056
02326 *                 , DKEY_NBR                                      INKCS056
02327 *                 , CRE_ID_NBR)                                   INKCS056
02328 *            VALUES                                               INKCS056
02329 *                  (:ADJDTL-STORE-NBR                             INKCS056
W26600*                 , :ADJDTL-LOC-NBR                               INKCS056
02330 *                 , :ADJDTL-AREA-NBR                              INKCS056
W21732*                 , :ADJDTL-SKU-NBR                               INKCS056
02334 *                 ,  CURRENT TIMESTAMP                            INKCS056
02335 *                 , :ADJDTL-ADJ-RSN-TXT                           INKCS056
02336 *                 , :ADJDTL-ADJ-TYPE-CDE                          INKCS056
02337 *                 , :ADJDTL-ADJ-UNIT-PR-AMT                       INKCS056
02338 *                 , :ADJDTL-ADJ-QTY                               INKCS056
02339 *                 , :ADJDTL-ADJ-EXTD-AMT                          INKCS056
02340 *                 , :ADJDTL-DKEY-NBR                              INKCS056
02341 *                 , :ADJDTL-CRE-ID-NBR)                           INKCS056
02342 *        END-EXEC.                                                INKCS056
02343 *                                                                 INKCS056
02344 *        EVALUATE TRUE                                            INKCS056
02345 *            WHEN SQLCODE = ZERO                                  INKCS056
02346 *                 EXEC SQL                                        INKCS056
02347 *                      COMMIT                                     INKCS056
02348 *                 END-EXEC                                        INKCS056
02349 *            WHEN SQLCODE = -904                                  INKCS056
02350 *            WHEN SQLCODE = -913                                  INKCS056
02351 *                 PERFORM 9900-SOFT-ABORT                         INKCS056
02352 *            WHEN SQLWARN0 NOT = SPACES                           INKCS056
02353 *            WHEN SQLCODE < ZERO                                  INKCS056
02354 *            WHEN SQLCODE > ZERO                                  INKCS056
02355 *                MOVE '5210-INSERT-TADJDTL-ROW'                   INKCS056
02356 *                                  TO DP013-PARAGRAPH             INKCS056
02357 *                MOVE 'INSERT A ROW ON THE TADJDTL TABLE'         INKCS056
02358 *                                  TO DP013-MESSAGE-TEXT(1)       INKCS056
02359 *                MOVE SQLCA        TO DP013-SQLCA                 INKCS056
02360 *                MOVE 'TADJDTL'    TO DP013-DB2-TABLE-NAME (1)    INKCS056
02361 *                SET DP013-DB2-ABEND                              INKCS056
02362 *                    DP013-XCTL-DISPLAY-RESTART TO TRUE           INKCS056
02363 *                PERFORM DP013-0000-PROCESS-ABEND                 INKCS056
02364 *        END-EVALUATE.                                            INKCS056
02365 *                                                                 INKCS056
02366 *----------------------------------------------------------------*INKCS056
02367 *    GET STORE UNIT BOOK DATE.                                   *INKCS056
02368 *----------------------------------------------------------------*INKCS056
02369 *                                                                 INKCS056
02366 *----------------------------------------------------------------*INKCS056
02367 *    WRITE THE ADJUSTMENT VSAM RECORD.                           *INKCS056
02368 *----------------------------------------------------------------*INKCS056
02369 *                                                                 INKCS056
W26682*5300-WRITE-VSAM-ADJUST-REC.                                      INKCS056
02371 *                                                                 INKCS056
02372 *    MOVE IN001-STORE-NBR          TO  IN015-STORE-NBR.           INKCS056
W21732*    MOVE ASC-SKU-NBR              TO  IN015-SKU-NBR.             INKCS056
W25428*    MOVE ASC-SKU                  TO  IN015-SKU-NBR.             INKCS056
02376 *    IF  IN015-ADJUSTMENT-QTY POSITIVE                            INKCS056
02377 *        SET IN015-POSITIVE-ADJUSTMENT                            INKCS056
02378 *                                  TO  TRUE                       INKCS056
02379 *    ELSE                                                         INKCS056
02380 *        SET IN015-NEGATIVE-ADJUSTMENT                            INKCS056
02381 *                                  TO  TRUE                       INKCS056
02382 *    END-IF.                                                      INKCS056
02383 *                                                                 INKCS056
JS0599*    IF INVPAR-ACTL-UNIT-BK-DTE = PC-NINES-DATE                           
JS0599*        MOVE 'N' TO IN015-UNIT-BOOK-IND                                  
JS0599*    ELSE                                                                 
JS0599*        MOVE 'Y' TO IN015-UNIT-BOOK-IND                                  
JS0599*    END-IF.                                                      INKCS056
      *                                                                         
02384 *    EXEC CICS WRITE                                              INKCS056
02385 *         FROM  (IN015-ADJUSTMENT-RECORD)                         INKCS056
02386 *         RIDFLD(PV-RBA)                                          INKCS056
02387 *         RBA                                                     INKCS056
02388 *         FILE  ('INADJUST')                                      INKCS056
02389 *         RESP  (PV-CICS-RESPONSE)                                INKCS056
02390 *    END-EXEC.                                                    INKCS056
02391 *                                                                 INKCS056
02392 *    IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               INKCS056
02393 *        SET DP013-LOGIC-ABEND                                    INKCS056
02394 *            DP013-NO-ROLLBACK     TO TRUE                        INKCS056
02395 *        MOVE '5300-WRITE-VSAM-ADJUST-REC'                        INKCS056
02396 *                                  TO DP013-PARAGRAPH             INKCS056
02397 *        MOVE 'INVALID RESPONSE FROM WRITE COMMAND:'              INKCS056
02398 *                                  TO DP013-MESSAGE-TEXT (1)      INKCS056
02399 *        MOVE PV-CICS-RESPONSE     TO PV-DISPLAY-RESP             INKCS056
02400 *        MOVE PV-DISPLAY-RESP      TO DP013-MESSAGE-TEXT (2)      INKCS056
02401 *        PERFORM DP013-0000-PROCESS-ABEND                         INKCS056
02402 *    END-IF.                                                      INKCS056
02403 *                                                                 INKCS056
02404 *----------------------------------------------------------------*INKCS056
02405 * RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *INKCS056
02406 * OBJECT WAS UPDATED.                                            *INKCS056
02407 *----------------------------------------------------------------*INKCS056
02408 *                                                                 INKCS056
W26682*9000-UPDATE-SELECTION-QUEUE.                                     INKCS056
02410 *                                                                 INKCS056
02411 *    PERFORM 9100-READ-SEL-QUEUE.                                 INKCS056
02412 *    SET IN012-UPD (ASC-SEL-SUB) TO TRUE.                         INKCS056
02413 *    PERFORM 9200-REWRITE-SEL-QUEUE.                              INKCS056
02414 *                                                                 INKCS056
02415 *----------------------------------------------------------------*INKCS056
02416 * READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *INKCS056
02417 *----------------------------------------------------------------*INKCS056
02418 *                                                                 INKCS056
02419  9100-READ-SEL-QUEUE.                                             INKCS056
02420                                                                   INKCS056
02421      EXEC CICS                                                    INKCS056
02422          READQ TS                                                 INKCS056
02423              QUEUE (ASC-SEL-QUEUE-NAME)                           INKCS056
02424              INTO  (IN012-SELECTED-SKUS)                          INKCS056
02425              ITEM  (ASC-SEL-ITEM)                                 INKCS056
02426              RESP  (PV-CICS-RESPONSE)                             INKCS056
02427      END-EXEC.                                                    INKCS056
02428                                                                   INKCS056
02429      IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   INKCS056
02430          CONTINUE                                                 INKCS056
02431      ELSE                                                         INKCS056
02432          SET DP013-LOGIC-ABEND                                    INKCS056
02433              DP013-NO-ROLLBACK     TO TRUE                        INKCS056
02434          MOVE '9100-READ-SEL-QUEUE'                               INKCS056
02435                                    TO DP013-PARAGRAPH             INKCS056
02436          MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   INKCS056
02437                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
02438          PERFORM DP013-0000-PROCESS-ABEND                         INKCS056
02439      END-IF.                                                      INKCS056
02440                                                                   INKCS056
02441 *----------------------------------------------------------------*INKCS056
02442 * UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *INKCS056
02443 *----------------------------------------------------------------*INKCS056
02444                                                                   INKCS056
02445  9200-REWRITE-SEL-QUEUE.                                          INKCS056
02446                                                                   INKCS056
02447      EXEC CICS                                                    INKCS056
02448           WRITEQ TS                                               INKCS056
02449               QUEUE  (ASC-SEL-QUEUE-NAME)                         INKCS056
02450               FROM   (IN012-SELECTED-SKUS)                        INKCS056
02451               ITEM   (ASC-SEL-ITEM)                               INKCS056
02452               RESP   (PV-CICS-RESPONSE)                           INKCS056
02453               REWRITE                                             INKCS056
02454      END-EXEC.                                                    INKCS056
02455                                                                   INKCS056
02456      IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               INKCS056
02457          SET DP013-CICS-ABEND                                     INKCS056
02458              DP013-NO-ROLLBACK     TO TRUE                        INKCS056
02459          MOVE '9200-REWRITE-SEL-QUEUE'                            INKCS056
02460                                    TO DP013-PARAGRAPH             INKCS056
02461          MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   INKCS056
02462                                    TO DP013-MESSAGE-TEXT (1)      INKCS056
02463          PERFORM DP013-0000-PROCESS-ABEND                         INKCS056
02464      END-IF.                                                      INKCS056
02465 /                                                                 INKCS056
02466 *----------------------------------------------------------------*INKCS056
02467 *    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *INKCS056
02468 *    AND THE ERROR SWITCHES.                                     *INKCS056
02469 *----------------------------------------------------------------*INKCS056
02470                                                                   INKCS056
02471  9900-SOFT-ABORT.                                                 INKCS056
02472                                                                   INKCS056
02473      SET PS-ERROR                TO  TRUE.                        INKCS056
02474      SET DP020-MSG-FATAL         TO  TRUE.                        INKCS056
02475      MOVE PC-TSYMSG-00551        TO  DP020-MSG-NUMBER.            INKCS056
02476 /                                                                 INKCS056
02477 *----------------------------------------------------------------*INKCS056
02478 *    ABEND PROCESSOR MODULE                                      *INKCS056
02479 *----------------------------------------------------------------*INKCS056
02480                                                                   INKCS056
02481      COPY DPPD013.                                                INKCS056
