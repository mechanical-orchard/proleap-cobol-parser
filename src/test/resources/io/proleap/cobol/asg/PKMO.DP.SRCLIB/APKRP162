000200 IDENTIFICATION DIVISION.                                         00020064
000400 PROGRAM-ID.     APKRP162.                                        00040064
000500 AUTHOR.         CHRIS KUNSTMANN IBS.                             00050064
000600 DATE-WRITTEN.   03/01/1999.                                      00060064
000700 DATE-COMPILED.                                                   00070064
000800*----------------------------------------------------------------*00080073
000900*    COBOL II                                                    *00090073
001000*                                                                *00100073
001100*        DAILY PRELIMINARY IMPORT EXPENSE INVOICE LIST           *00110073
001200*                                                                *00120073
001300* THE PURPOSE OF THIS PROGRAM IS TO CREATE A REPORT CONTAINING   *00130073
001400* A PRELIMINARY LIST OF THE IMPORT EXPENSE INVOICES THAT WERE    *00140073
001500* ENTERED EACH DAY.                                              *00150073
001600*                                                                *00160073
001700*----------------------------------------------------------------*00170073
001800*                                                                *00180073
001900* INPUT:                                                         *00190073
002000*  1. ACCOUNTS PAYABLE TRANSACTIONS FILE    (APRD040)            *00200073
002100*                                                                *00210073
002200* OUTPUT:                                                        *00220073
002300*  1. PRELIMINARY IMPORT EXPENSE INVOICE ENTRY REPORT            *00230073
002400*                                                                *00240073
002500*----------------------------------------------------------------*00250073
002600*   CHANGES:                                                     *00260073
002700*  10/08/99   ROBIN BERNOSKI             WR/PITS # 5998          *00270073
002800*             INCREASED THE SIZE OF THE TOTAL FIELDS IN ORDER    *00280073
002900*             TO ACCOUNT FOR AMOUNTS IN THE HUNDREDS OF          *00290073
003000*             MILLIONS.                                          *00300073
003100*                                                                *00310073
003200*  11/10/2000  JILL JUEL                WR/IR #: 20224           *00320073
003300*              ADDED LOGIC TO PROCESS THE NEW MOS-DISC AND       *00330073
003400*              ADV-DISC FIELDS. THE NEW FIELDS ARE HANDLED       *00340073
003500*              THE SAME WAY THE NEW STORE DISCOUNT IS HANDLED.   *00350073
003600*                                                                *00360073
003700*  12/15/2000  JILL JUEL                WR/IR #: 20704           *00370073
003800*              INCREASED THE SIZE OF THE GROSS COST AND NET      *00380073
003900*              NET IN THE DETAIL LINES. IN ORDER TO INCREASE     *00390073
004000*              THE GROSS COST THE VENDOR NAME WAS DECREASED.     *00400073
004100*                                                                *00410073
004200*  07/20/2001  ALEXIS KEIKER            WR/IR #: WR22467         *00420073
004300*              INCREASED THE AP-TRANS INPUT FILE'S LRECL FROM    *00430073
004400*              400 TO 500.  THIS CHANGE WAS MADE BECAUSE         *00440073
004500*              COPYBOOK APRD040 HAS INCREASED TO 500.            *00450073
004600*                                                                *00460073
004700*  09/26/2006  KRYSTEN LEARY            WR/IR #: WR31177         *00470073
004800*              RECOMPILE FROM PRODUCTION TO PICK UP THE NEW      *00480073
004900*              FIELD AP040-SEPARATE-CHCK IN THE APRD040          *00490073
005000*              COPYBOOK.                                         *00500073
005100*                                                                *00510073
005200*  03/22/2007  KRYSTEN LEARY            WR/IR #: WR32060         *00520073
005300*              RECOMPILE FROM PRODUCTION TO PICK UP THE NEW      *00530073
005400*              FIELDS AP040-WTHD-SETID, AP040-WTHD-SW, AND       *00540073
005500*              AP040-WTHD-CD IN THE APRD040 COPYBOOK.            *00550073
005600*                                                                *00560073
005610*  03/26/2019                                                    *00561073
005620*  CHANGE MADE:                                                  *00562073
005621*  AS PART OF PREPARTION FOR CONVERSION FROM PEOPLESOFT TO       *00562173
005622*  ORACLE, NEW DISCOUNT FIELDS COOP,ALW AND MSC HAVE BEEN ADDED  *00562273
005623*  TO APRD040 COPYBOOK. ADDED THE 3 NEW DISCOUNTS AMOUNT         *00562373
005624*  FIELDS AP040-COOP-DISC-AMT, AP040-ALW-DISC-AMT                *00562473
005625*  AND AP040-MSC-DISC-AMT TO THE COMPUTE PV-DISC-AMT STATEMENT   *00562573
005626*  MADE BY: SURIYA                  WR/IR #: CHG0220043          *00562673
005627*                                                                *00562773
005628*  DATE  06/20/2023                                              *00562873
005629*      CHANGE MADE:                                              *00562973
005630*      ADDED THE PAYMENT DUE DATE COLUMN TO THE REPORT TO SHOW   *00563073
005631*      THE DUE DATE BEING CALCULATED FOR INFOR-NEXUS INVOICES.   *00563173
005632*      MADE BY: NANCY EILBES            WR/IR #: CHG0289780      *00563273
005633*----------------------------------------------------------------*00563373
005634                                                                  00563473
005635 ENVIRONMENT DIVISION.                                            00563573
005636 CONFIGURATION SECTION.                                           00563673
005640 SOURCE-COMPUTER.    IBM-3090.                                    00564065
005650 OBJECT-COMPUTER.    IBM-3090.                                    00565065
005660                                                                  00566065
005670 INPUT-OUTPUT SECTION.                                            00567065
005680 FILE-CONTROL.                                                    00568065
005690                                                                  00569065
005700     SELECT AP-TRANS-FILE        ASSIGN TO UT-S-INP01.            00570065
005800     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00580065
005900                                                                  00590065
006000                                                                  00600065
006100 DATA DIVISION.                                                   00610065
006200 FILE SECTION.                                                    00620065
006300                                                                  00630065
006400 FD  AP-TRANS-FILE                                                00640065
006500     RECORDING MODE IS F                                          00650065
006600     LABEL RECORDS ARE STANDARD                                   00660065
006700     BLOCK CONTAINS 0 RECORDS                                     00670065
006800     DATA RECORD IS AP-TRANS-REC.                                 00680065
006900 01  AP-TRANS-REC                PIC  X(500).                     00690065
007000                                                                  00700065
007100 FD  REPORT-FILE                                                  00710065
007200     RECORDING MODE IS F                                          00720065
007300     LABEL RECORDS ARE STANDARD                                   00730065
007400     BLOCK CONTAINS 0 RECORDS                                     00740065
007500     DATA RECORD IS REPORT-REC.                                   00750065
007600 01  REPORT-REC                  PIC  X(132).                     00760065
007700                                                                  00770065
007800                                                                  00780065
007900 WORKING-STORAGE SECTION.                                         00790065
008000 01  PROGRAM-CONSTANTS.                                           00800065
008100     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP162'. 00810065
008200     05  PC-LINES-MAX            PIC S999       VALUE +60.        00820065
008300                                                                  00830065
008400 01  PROGRAM-SWITCHES.                                            00840065
008500     05  PS-TRANS-EOF-SW         PIC  X         VALUE 'N'.        00850065
008600         88  PS-TRANS-NOT-EOF                   VALUE 'N'.        00860065
008700         88  PS-TRANS-EOF                       VALUE 'Y'.        00870065
008800                                                                  00880065
008900 01  PV-REPORT-CONTROLS.                                          00890065
009000     05  PV-LINES-PER-PAGE       PIC S999       VALUE +999.       00900065
009100     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     00910065
009200                                                                  00920065
009300 01  PV-PROCESS-COUNTERS.                                         00930065
009400     05  PV-TRANS-READ           PIC  9(08)     VALUE ZEROES.     00940065
009500                                                                  00950065
009600 01  PROGRAM-VARIABLES.                                           00960065
009700     05  PV-CURRENT-DATE.                                         00970065
009800         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      00980065
009900         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      00990065
010000         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      01000065
010100     05  PV-CURRENT-TIME.                                         01010065
010200         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     01020065
010300         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     01030065
010400         10  FILLER              PIC  9(02)     VALUE ZEROES.     01040065
010500                                                                  01050065
010600     05  PV-ENTR-ID              PIC  X(08)     VALUE SPACES.     01060065
010700     05  PV-ORGN-AP-TRN-CDE.                                      01070065
010800         10  PV-ORGN-CDE         PIC  X(01)     VALUE SPACES.     01080065
010900         10  PV-AP-TRN-CDE       PIC  X(02)     VALUE SPACES.     01090065
011000                                                                  01100065
011100     05  PV-DISC-AMT             PIC S9(9)V99   VALUE ZEROES.     01110065
011200     05  PV-TKID-GROSS-AMT       PIC S9(9)V99   VALUE ZEROES.     01120065
011300     05  PV-TKID-DISC-AMT        PIC S9(9)V99   VALUE ZEROES.     01130065
011400     05  PV-TKID-NET-AMT         PIC S9(9)V99   VALUE ZEROES.     01140065
011500     05  PV-ORGN-GROSS-AMT       PIC S9(9)V99   VALUE ZEROES.     01150065
011600     05  PV-ORGN-DISC-AMT        PIC S9(9)V99   VALUE ZEROES.     01160065
011700     05  PV-ORGN-NET-AMT         PIC S9(9)V99   VALUE ZEROES.     01170065
011800     05  PV-GRND-GROSS-AMT       PIC S9(9)V99   VALUE ZEROES.     01180065
011900     05  PV-GRND-DISC-AMT        PIC S9(9)V99   VALUE ZEROES.     01190065
012000     05  PV-GRND-NET-AMT         PIC S9(9)V99   VALUE ZEROES.     01200065
012100                                                                  01210065
012200     05  PV-ALPHA9               PIC  X(09)     VALUE SPACES.     01220065
012300     05  PV-ALPHA9-N             REDEFINES      PV-ALPHA9         01230065
012400                                 PIC  9(09).                      01240065
012500     05  PV-DB2-DATE.                                             01250065
012600         10  PV-DB2-YEAR.                                         01260065
012700             15  PV-DB2-CC       PIC  X(02)     VALUE SPACES.     01270065
012800             15  PV-DB2-YY       PIC  X(02)     VALUE SPACES.     01280065
012900         10  PV-DB2-DASH         PIC  X(01)     VALUE SPACES.     01290065
013000         10  PV-DB2-MM           PIC  X(02)     VALUE SPACES.     01300065
013100         10  PV-DB2-DASH         PIC  X(01)     VALUE SPACES.     01310065
013200         10  PV-DB2-DD           PIC  X(02)     VALUE SPACES.     01320065
013300     05  PV-DIS-DATE.                                             01330065
013400         10  PV-DIS-MM           PIC  X(02)     VALUE SPACES.     01340065
013500         10  PV-DIS-S1           PIC  X(01)     VALUE SPACES.     01350065
013600         10  PV-DIS-DD           PIC  X(02)     VALUE SPACES.     01360065
013700         10  PV-DIS-S2           PIC  X(01)     VALUE SPACES.     01370065
013800         10  PV-DIS-YEAR.                                         01380065
013900             15  PV-DIS-CC       PIC  X(02)     VALUE SPACES.     01390065
014000             15  PV-DIS-YY       PIC  X(02)     VALUE SPACES.     01400065
014100                                                                  01410065
014200*----------------------------------------------------------------*01420065
014300*  INPUT RECORD LAYOUT                                            01430065
014400*----------------------------------------------------------------*01440065
014500     COPY APRD040.                                                01450065
014600                                                                  01460065
014700*----------------------------------------------------------------*01470065
014800*  STANDARD HEADER LAYOUT                                         01480065
014900*----------------------------------------------------------------*01490065
015000     COPY DPWS132O.                                               01500065
015100                                                                  01510065
015200*----------------------------------------------------------------*01520065
015300*  REPORT LAYOUT                                                  01530065
015400*----------------------------------------------------------------*01540065
015500                                                                  01550065
015600 01  HL-HEADER2.                                                  01560065
015700     05  FILLER                  PIC  X(58)     VALUE SPACES.     01570065
015800     05  HL2-TITLE               PIC  X(16)     VALUE             01580065
015900         'ACCOUNTS PAYABLE'.                                      01590065
016000     05  FILLER                  PIC  X(58)     VALUE SPACES.     01600065
016100                                                                  01610065
016200 01  HL-HEADER3.                                                  01620065
016300     05  FILLER                  PIC  X(42)     VALUE SPACES.     01630065
016400     05  HL3-TITLE               PIC  X(48)     VALUE             01640065
016500         'PRELIMINARY IMPORT EXPENSE INVOICE ENTRY LISTING'.      01650065
016600     05  FILLER                  PIC  X(42)     VALUE SPACES.     01660065
016700                                                                  01670065
016800 01  HL-HEADER4.                                                  01680065
016900     05  FILLER                  PIC  X(59)     VALUE SPACES.     01690065
017000     05  FILLER                  PIC  X(05)     VALUE 'FOR: '.    01700065
017100     05  HL4-ENTR-MM             PIC  X(02)     VALUE SPACES.     01710065
017200     05  HL4-ENTR-S1             PIC  X(01)     VALUE SPACES.     01720065
017300     05  HL4-ENTR-DD             PIC  X(02)     VALUE SPACES.     01730065
017400     05  HL4-ENTR-S2             PIC  X(01)     VALUE SPACES.     01740065
017500     05  HL4-ENTR-YY             PIC  X(02)     VALUE SPACES.     01750065
017600     05  FILLER                  PIC  X(60)     VALUE SPACES.     01760065
017700                                                                  01770065
017800 01  HL-HEADER5.                                                  01780065
017900     05  FILLER                  PIC  X(14)     VALUE             01790065
018000         '  ENTERED BY: '.                                        01800065
018100     05  HL5-ENTR-ID             PIC  X(08)     VALUE SPACES.     01810065
018200     05  FILLER                  PIC  X(10)     VALUE             01820065
018300         '  ORIGIN: '.                                            01830065
018400     05  HL5-ORGN-AP-TRN-CDE     PIC  X(03)     VALUE SPACES.     01840065
018500     05  FILLER                  PIC  X(97)     VALUE SPACES.     01850065
018600                                                                  01860065
018700 01  HL-HEADER6.                                                  01870065
018800     05  FILLER                  PIC  X(04)     VALUE SPACES.     01880065
018900     05  FILLER                  PIC  X(02)     VALUE 'PO'.       01890065
019000     05  FILLER                  PIC  X(06)     VALUE SPACES.     01900067
019100     05  FILLER                  PIC  X(08)     VALUE 'DOCUMENT'. 01910065
019200     05  FILLER                  PIC  X(08)     VALUE SPACES.     01920068
019300     05  FILLER                  PIC  X(05)     VALUE 'ENTRY'.    01930065
019400     05  FILLER                  PIC  X(06)     VALUE SPACES.     01940065
019500     05  FILLER                  PIC  X(06)     VALUE 'VENDOR'.   01950065
019600     05  FILLER                  PIC  X(10)     VALUE SPACES.     01960065
019700     05  FILLER                  PIC  X(06)     VALUE 'VENDOR'.   01970065
019800*    05  FILLER                  PIC  X(17)     VALUE SPACES.     01980065
019900     05  FILLER                  PIC  X(15)     VALUE SPACES.     01990068
020000     05  FILLER                  PIC  X(05)     VALUE 'DEPT/'.    02000065
020100     05  FILLER                  PIC  X(04)     VALUE SPACES.     02010070
020110     05  FILLER                  PIC  X(05)     VALUE ' DUE '.    02011065
020120     05  FILLER                  PIC  X(10)     VALUE SPACES.     02012070
020200     05  FILLER                  PIC  X(05)     VALUE 'GROSS'.    02020065
020300     05  FILLER                  PIC  X(23)     VALUE SPACES.     02030070
020400     05  FILLER                  PIC  X(03)     VALUE 'NET'.      02040065
020500     05  FILLER                  PIC  X(04)     VALUE SPACES.     02050065
020600                                                                  02060065
020700 01  HL-HEADER7.                                                  02070065
020800     05  FILLER                  PIC  X(02)     VALUE SPACES.     02080065
020900     05  FILLER                  PIC  X(06)     VALUE 'NUMBER'.   02090065
021000     05  FILLER                  PIC  X(05)     VALUE SPACES.     02100068
021100     05  FILLER                  PIC  X(06)     VALUE 'NUMBER'.   02110065
021200     05  FILLER                  PIC  X(09)     VALUE SPACES.     02120071
021300     05  FILLER                  PIC  X(04)     VALUE 'DATE'.     02130065
021400     05  FILLER                  PIC  X(07)     VALUE SPACES.     02140069
021500     05  FILLER                  PIC  X(06)     VALUE 'NUMBER'.   02150065
021600     05  FILLER                  PIC  X(10)     VALUE SPACES.     02160071
021700     05  FILLER                  PIC  X(04)     VALUE 'NAME'.     02170065
021800     05  FILLER                  PIC  X(16)     VALUE SPACES.     02180071
021900     05  FILLER                  PIC  X(07)     VALUE 'EXPENSE'.  02190065
022000     05  FILLER                  PIC  X(03)     VALUE SPACES.     02200071
022010     05  FILLER                  PIC  X(05)     VALUE ' DATE'.    02201065
022020     05  FILLER                  PIC  X(10)     VALUE SPACES.     02202070
022100     05  FILLER                  PIC  X(04)     VALUE 'COST'.     02210065
022200     05  FILLER                  PIC  X(08)     VALUE SPACES.     02220070
022300     05  FILLER                  PIC  X(08)     VALUE 'DISCOUNT'. 02230065
022400     05  FILLER                  PIC  X(07)     VALUE SPACES.     02240071
022500     05  FILLER                  PIC  X(04)     VALUE 'COST'.     02250065
022600     05  FILLER                  PIC  X(03)     VALUE SPACES.     02260065
022700                                                                  02270065
022800 01  DL-DETAIL.                                                   02280065
023000     05  DL-PO-NBR               PIC  ZZZZZZZZ9 VALUE ZEROES.     02300065
023100     05  FILLER                  PIC  X(01)     VALUE SPACES.     02310065
023200     05  DL-DOC-NBR              PIC  X(16)     VALUE SPACES.     02320065
023300     05  FILLER                  PIC  X(01)     VALUE SPACES.     02330065
023400     05  DL-ENTR-DTE             PIC  X(10)     VALUE SPACES.     02340065
023500     05  FILLER                  PIC  X(01)     VALUE SPACES.     02350065
023600     05  DL-VENDOR-NBR           PIC  X(09)     VALUE SPACES.     02360065
023700     05  FILLER                  PIC  X(01)     VALUE SPACES.     02370065
023800     05  DL-VENDOR-NAME          PIC  X(27)     VALUE SPACES.     02380065
023900     05  FILLER                  PIC  X(01)     VALUE SPACES.     02390065
024000     05  DL-ACCOUNT              PIC  X(06)     VALUE SPACES.     02400065
024100     05  FILLER                  PIC  X(01)     VALUE SPACES.     02410065
024110     05  DL-DUE-DATE             PIC  X(10)     VALUE SPACES.     02411065
024120     05  FILLER                  PIC  X(01)     VALUE SPACES.     02412065
024200     05  DL-GROSS-COST           PIC  --,---,--9.99 VALUE ZEROES. 02420065
024300     05  FILLER                  PIC  X(01)     VALUE SPACES.     02430065
024400     05  DL-DISCOUNT             PIC  ---,--9.99 VALUE ZEROES.    02440065
024500     05  FILLER                  PIC  X(01)     VALUE SPACES.     02450065
024600     05  DL-NET-COST             PIC  --,---,--9.99 VALUE ZEROES. 02460065
024700     05  FILLER                  PIC  X(01)     VALUE SPACES.     02470065
024800                                                                  02480065
024900 01  TL-TOTAL1.                                                   02490065
025000     05  FILLER                  PIC  X(49)     VALUE SPACES.     02500065
025100     05  FILLER                  PIC  X(30)     VALUE             02510065
025200         'TRANSACTION TOTALS FOR ORIGIN '.                        02520065
025300     05  TL1-ORGN-AP-TRN-CDE     PIC  X(03)     VALUE SPACES.     02530065
025400     05  FILLER                  PIC  X(11)     VALUE SPACES.     02540071
025500     05  TL1-GROSS-COST          PIC ---,---,--9.99 VALUE ZEROES. 02550065
025600     05  FILLER                  PIC  X(01)     VALUE SPACES.     02560065
025700     05  TL1-DISCOUNT            PIC ---,--9.99 VALUE ZEROES.     02570065
025800*    05  FILLER                  PIC  X(01)     VALUE SPACES.     02580072
025900     05  TL1-NET-COST            PIC ---,---,--9.99 VALUE ZEROES. 02590065
026000                                                                  02600065
026100 01  TL-TOTAL2.                                                   02610065
026200     05  FILLER                  PIC  X(49)     VALUE SPACES.     02620065
026300     05  FILLER                  PIC  X(29)     VALUE             02630065
026400         'TRANSACTION TOTALS FOR TK ID '.                         02640065
026500     05  TL2-ENTR-ID             PIC  X(08)     VALUE SPACES.     02650065
026600     05  FILLER                  PIC  X(07)     VALUE SPACES.     02660071
026700     05  TL2-GROSS-COST          PIC ---,---,--9.99 VALUE ZEROES. 02670065
026800     05  FILLER                  PIC  X(01)     VALUE SPACES.     02680065
026900     05  TL2-DISCOUNT            PIC ---,--9.99 VALUE ZEROES.     02690065
027000*    05  FILLER                  PIC  X(01)     VALUE SPACES.     02700072
027100     05  TL2-NET-COST            PIC ---,---,--9.99 VALUE ZEROES. 02710065
027200                                                                  02720065
027300 01  TL-TOTAL3.                                                   02730065
027400     05  FILLER                  PIC  X(45)     VALUE SPACES.     02740071
027500     05  FILLER                  PIC  X(40)     VALUE             02750065
027600         'GRAND TOTALS FOR ALL ORIGINS AND TK IDS '.              02760065
027610     05  FILLER                  PIC  X(08)     VALUE SPACES.     02761072
027700     05  TL3-GROSS-COST          PIC ---,---,--9.99 VALUE ZEROES. 02770065
027800     05  FILLER                  PIC  X(01)     VALUE SPACES.     02780065
027900     05  TL3-DISCOUNT            PIC ---,--9.99 VALUE ZEROES.     02790065
028000*    05  FILLER                  PIC  X(01)     VALUE SPACES.     02800072
028100     05  TL3-NET-COST            PIC ---,---,--9.99 VALUE ZEROES. 02810065
028200                                                                  02820065
028300 01  END-OF-REPORT.                                               02830065
028400     05  FILLER                  PIC  X(47)     VALUE SPACES.     02840065
028500     05  FILLER                  PIC  X(37)     VALUE             02850065
028600         '**********  END OF REPORT  **********'.                 02860065
028700     05  FILLER                  PIC  X(48)     VALUE SPACES.     02870065
028800                                                                  02880065
028900                                                                  02890065
029000 01  FILLER                      PIC  X(25)     VALUE             02900065
029100     '** END OF APKRP162 W/S **'.                                 02910065
029200                                                                  02920065
029300 PROCEDURE DIVISION.                                              02930065
029400 A100-MAIN.                                                       02940065
029500                                                                  02950065
029600     PERFORM B100-INITIALIZE.                                     02960065
029700                                                                  02970065
029800     PERFORM B200-PROCESS-TRANS-FILE                              02980065
029900         UNTIL PS-TRANS-EOF.                                      02990065
030000                                                                  03000065
030100     PERFORM B300-END-OF-PROGRAM.                                 03010065
030200                                                                  03020065
030300     GOBACK.                                                      03030065
030400                                                                  03040065
030500                                                                  03050065
030600 B100-INITIALIZE.                                                 03060065
030700*----------------------------------------------------------------*03070065
030800*    INITIALIZATION PROCESSING                                   *03080065
030900*    - OPEN FILES.                                               *03090065
031000*    - FORMAT PAGE HEADINGS.                                     *03100065
031100*    - READ INPUT FILE.                                          *03110065
031200*----------------------------------------------------------------*03120065
031300                                                                  03130065
031400     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * * * * *'03140065
031500     DISPLAY '** BEGIN APKRP162 PROCESSING **'.                   03150065
031600                                                                  03160065
031700     OPEN INPUT  AP-TRANS-FILE                                    03170065
031800          OUTPUT REPORT-FILE.                                     03180065
031900                                                                  03190065
032000     ACCEPT PV-CURRENT-DATE FROM DATE.                            03200065
032100     MOVE PV-CURRENT-MONTH       TO DP132O-RUN-MONTH              03210065
032200                                    HL4-ENTR-MM.                  03220065
032300     MOVE PV-CURRENT-DAY         TO DP132O-RUN-DAY                03230065
032400                                    HL4-ENTR-DD.                  03240065
032500     MOVE PV-CURRENT-YEAR        TO DP132O-RUN-YEAR               03250065
032600                                    HL4-ENTR-YY.                  03260065
032700     MOVE '/'                    TO HL4-ENTR-S1                   03270065
032800                                    HL4-ENTR-S2.                  03280065
032900                                                                  03290065
033000     ACCEPT PV-CURRENT-TIME FROM TIME.                            03300065
033100     MOVE PV-CURRENT-HOUR        TO DP132O-RUN-HOUR.              03310065
033200     MOVE PV-CURRENT-MINUTE      TO DP132O-RUN-MINUTE.            03320065
033300     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          03330065
033400     MOVE 1                      TO DP132O-REPORT-NUMBER.         03340065
033500                                                                  03350065
033600     PERFORM R100-READ-INPUT.                                     03360065
033700     IF PS-TRANS-EOF                                              03370065
033800         PERFORM W100-WRITE-HEADINGS                              03380065
033900         DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'    03390065
034000         MOVE ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'       03400065
034100                                 TO REPORT-REC                    03410065
034200         WRITE REPORT-REC AFTER 2                                 03420065
034300     END-IF.                                                      03430065
034400                                                                  03440065
034500     MOVE AP040-ENTR-ID          TO PV-ENTR-ID.                   03450065
034600     MOVE AP040-ORGN-CDE         TO PV-ORGN-CDE.                  03460065
034700     MOVE AP040-AP-TRN-CDE       TO PV-AP-TRN-CDE.                03470065
034800                                                                  03480065
034900*  FORMAT HEADINGS FOR NEW ORGN-AP-TRN-CDE / ENTR-ID              03490065
035000     MOVE AP040-ENTR-ID          TO HL5-ENTR-ID.                  03500065
035100     MOVE PV-ORGN-AP-TRN-CDE     TO HL5-ORGN-AP-TRN-CDE.          03510065
035200                                                                  03520065
035300                                                                  03530065
035400 B200-PROCESS-TRANS-FILE.                                         03540065
035500*----------------------------------------------------------------*03550065
035600*    PROCESS TRANSACTION FILE                                    *03560065
035700*                                                                *03570065
035800*    - IF NEW ENTRY ID, ORIGIN CODE, OR AP TRAN CODE, FORMAT AND *03580065
035900*       PRINT TOTALS.                                            *03590065
036000*    - FORMAT AND PRINT THE DETAIL MESSAGE.                      *03600065
036100*    - READ THE INPUT FILE.                                      *03610065
036200*----------------------------------------------------------------*03620065
036300                                                                  03630065
036400*    - IF NEW ENTRY ID, ORGN CDE, OR AP TRN CDE                   03640065
036500     IF AP040-ENTR-ID NOT = PV-ENTR-ID                            03650065
036600       OR AP040-ORGN-CDE NOT = PV-ORGN-CDE                        03660065
036700       OR AP040-AP-TRN-CDE NOT = PV-AP-TRN-CDE                    03670065
036800                                                                  03680065
036900         PERFORM F200-FORMAT-ORIGIN                               03690065
037000     END-IF.                                                      03700065
037100                                                                  03710065
037200*    - IF NEW ENTRY ID                                            03720065
037300     IF AP040-ENTR-ID NOT = PV-ENTR-ID                            03730065
037400                                                                  03740065
037500         PERFORM F300-FORMAT-ENTR-ID                              03750065
037600     END-IF.                                                      03760065
037700                                                                  03770065
037800*  PROCESS CURRENT RECORD AND ACCUMULATE FOR TK ID BREAK          03780065
037900     COMPUTE PV-DISC-AMT = ( AP040-TERM-DISC-AMT +                03790065
038000             AP040-NW-STR-DISC-AMT + AP040-TRD-DISC-AMT +         03800065
038100             AP040-MOS-DISC-AMT + AP040-ADV-DISC-AMT +            03810065
038200             AP040-COOP-DISC-AMT + AP040-ALW-DISC-AMT +           03820065
038300             AP040-MSC-DISC-AMT ).                                03830065
038400                                                                  03840065
038500     PERFORM F100-FORMAT-DETAIL.                                  03850065
038600                                                                  03860065
038700     ADD AP040-GRO-COST-AMT      TO PV-ORGN-GROSS-AMT.            03870065
038800     ADD AP040-NET-COST-AMT      TO PV-ORGN-NET-AMT.              03880065
038900     ADD PV-DISC-AMT             TO PV-ORGN-DISC-AMT.             03890065
039000                                                                  03900065
039100*    - READ THE NEXT INPUT RECORD.                                03910065
039200     PERFORM R100-READ-INPUT.                                     03920065
039300                                                                  03930065
039400                                                                  03940065
039500 B300-END-OF-PROGRAM.                                             03950065
039600*----------------------------------------------------------------*03960065
039700*  END OF PROGRAM                                                *03970065
039800*----------------------------------------------------------------*03980065
039900                                                                  03990065
040000     IF PV-TRANS-READ > ZEROES                                    04000065
040100*  PRINT TOTALS FOR LAST ORGN-AP-TRN-CDE / ENTR-ID                04010065
040200         PERFORM F200-FORMAT-ORIGIN                               04020065
040300         PERFORM F300-FORMAT-ENTR-ID                              04030065
040400*  PRINT GRAND TOTALS                                             04040065
040500         PERFORM F400-FORMAT-GRAND-TOTALS                         04050065
040600     END-IF.                                                      04060065
040700                                                                  04070065
040800     WRITE REPORT-REC FROM END-OF-REPORT                          04080065
040900       AFTER ADVANCING +2 LINES.                                  04090065
041000                                                                  04100065
041100     DISPLAY '** END OF APKRP162 PROCESSING **'.                  04110065
041200     DISPLAY '** TRANSACTIONS READ      = ' PV-TRANS-READ.        04120065
041300     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * * * * *'04130065
041400                                                                  04140065
041500     CLOSE AP-TRANS-FILE                                          04150065
041600           REPORT-FILE.                                           04160065
041700                                                                  04170065
041800                                                                  04180065
041900 F100-FORMAT-DETAIL.                                              04190065
042000*----------------------------------------------------------------*04200065
042100*    FORMAT DETAIL DATA TO THE REPORT HEADINGS, DETAIL LINES.    *04210065
042200*                                                                *04220065
042300*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *04230065
042400*----------------------------------------------------------------*04240065
042500                                                                  04250065
042600     IF PV-LINES-PER-PAGE > PC-LINES-MAX                          04260065
042700         PERFORM W100-WRITE-HEADINGS                              04270065
042800     END-IF.                                                      04280065
042900                                                                  04290065
043000     MOVE AP040-PO-NBR           TO PV-ALPHA9.                    04300065
043100     MOVE PV-ALPHA9-N            TO DL-PO-NBR.                    04310065
043200     MOVE AP040-DOC-NBR          TO DL-DOC-NBR.                   04320065
043300                                                                  04330065
043400     MOVE AP040-ENTR-DTE         TO PV-DB2-DATE.                  04340065
043500     MOVE PV-DB2-YEAR            TO PV-DIS-YEAR.                  04350065
043600     MOVE PV-DB2-MM              TO PV-DIS-MM.                    04360065
043700     MOVE PV-DB2-DD              TO PV-DIS-DD.                    04370065
043800     MOVE '/'                    TO PV-DIS-S1                     04380065
043900                                    PV-DIS-S2.                    04390065
044000     MOVE PV-DIS-DATE            TO DL-ENTR-DTE.                  04400065
044100                                                                  04410065
044110     MOVE AP040-PYMT-DUE-DTE     TO DL-DUE-DATE.                  04411066
044120                                                                  04412066
044200     MOVE AP040-VND-NBR          TO DL-VENDOR-NBR.                04420065
044300     MOVE AP040-ENT-NME-DESC     TO DL-VENDOR-NAME.               04430065
044400     MOVE AP040-GL-ACCT-NBR      TO DL-ACCOUNT.                   04440065
044500     MOVE AP040-GRO-COST-AMT     TO DL-GROSS-COST.                04450065
044600     MOVE PV-DISC-AMT            TO DL-DISCOUNT.                  04460065
044700     MOVE AP040-NET-COST-AMT     TO DL-NET-COST.                  04470065
044800                                                                  04480065
044900     PERFORM W200-WRITE-DETAIL.                                   04490065
045000                                                                  04500065
045100                                                                  04510065
045200 F200-FORMAT-ORIGIN.                                              04520065
045300*----------------------------------------------------------------*04530065
045400*  PRINT TOTALS FOR LAST ORIGIN, FORMAT HEADING                   04540065
045500*----------------------------------------------------------------*04550065
045600                                                                  04560065
045700     MOVE PV-ORGN-AP-TRN-CDE     TO TL1-ORGN-AP-TRN-CDE.          04570065
045800     MOVE PV-ORGN-GROSS-AMT      TO TL1-GROSS-COST.               04580065
045900     MOVE PV-ORGN-DISC-AMT       TO TL1-DISCOUNT.                 04590065
046000     MOVE PV-ORGN-NET-AMT        TO TL1-NET-COST.                 04600065
046100                                                                  04610065
046200     ADD PV-ORGN-GROSS-AMT       TO PV-TKID-GROSS-AMT.            04620065
046300     ADD PV-ORGN-DISC-AMT        TO PV-TKID-DISC-AMT.             04630065
046400     ADD PV-ORGN-NET-AMT         TO PV-TKID-NET-AMT.              04640065
046500                                                                  04650065
046600     WRITE REPORT-REC FROM TL-TOTAL1                              04660065
046700       AFTER ADVANCING +2 LINES.                                  04670065
046800                                                                  04680065
046900     ADD +2                      TO PV-LINES-PER-PAGE.            04690065
047000                                                                  04700065
047100     INITIALIZE PV-ORGN-GROSS-AMT                                 04710065
047200                PV-ORGN-DISC-AMT                                  04720065
047300                PV-ORGN-NET-AMT.                                  04730065
047400                                                                  04740065
047500     MOVE AP040-ORGN-CDE         TO PV-ORGN-CDE.                  04750065
047600     MOVE AP040-AP-TRN-CDE       TO PV-AP-TRN-CDE.                04760065
047700     MOVE PV-ORGN-AP-TRN-CDE     TO HL5-ORGN-AP-TRN-CDE.          04770065
047800                                                                  04780065
047900*  THIS CAUSES THE ORIGIN/ENTRY ID HEADING TO PRINT IF MORE DATA  04790065
048000*   IS AVAILABLE AND THERES ROOM TO PRINT ANOTHER DETAIL LINE.    04800065
048100     IF AP040-ENTR-ID = PV-ENTR-ID                                04810065
048200       AND PS-TRANS-NOT-EOF                                       04820065
048300       AND PV-LINES-PER-PAGE < PC-LINES-MAX                       04830065
048400                                                                  04840065
048500         WRITE REPORT-REC FROM HL-HEADER5                         04850065
048600           AFTER ADVANCING +2 LINES                               04860065
048700         MOVE SPACES             TO REPORT-REC                    04870065
048800         WRITE REPORT-REC                                         04880065
048900           AFTER ADVANCING +1 LINES                               04890065
049000         ADD +3                  TO PV-LINES-PER-PAGE             04900065
049100     END-IF.                                                      04910065
049200                                                                  04920065
049300                                                                  04930065
049400 F300-FORMAT-ENTR-ID.                                             04940065
049500*----------------------------------------------------------------*04950065
049600*  PRINT TOTALS FOR LAST ENTR-ID, FORMAT HEADING                  04960065
049700*----------------------------------------------------------------*04970065
049800                                                                  04980065
049900     IF PV-LINES-PER-PAGE > ( PC-LINES-MAX + 3 )                  04990065
050000         PERFORM W100-WRITE-HEADINGS                              05000065
050100     END-IF.                                                      05010065
050200                                                                  05020065
050300     MOVE PV-ENTR-ID             TO TL2-ENTR-ID.                  05030065
050400     MOVE PV-TKID-GROSS-AMT      TO TL2-GROSS-COST.               05040065
050500     MOVE PV-TKID-DISC-AMT       TO TL2-DISCOUNT.                 05050065
050600     MOVE PV-TKID-NET-AMT        TO TL2-NET-COST.                 05060065
050700                                                                  05070065
050800     WRITE REPORT-REC FROM TL-TOTAL2                              05080065
050900       AFTER ADVANCING +3 LINES.                                  05090065
051000                                                                  05100065
051100*  FORMAT HEADINGS FOR NEW ORGN-AP-TRN-CDE / ENTR-ID              05110065
051200     MOVE AP040-ENTR-ID          TO HL5-ENTR-ID                   05120065
051300                                    PV-ENTR-ID.                   05130065
051400                                                                  05140065
051500     ADD PV-TKID-GROSS-AMT       TO PV-GRND-GROSS-AMT.            05150065
051600     ADD PV-TKID-DISC-AMT        TO PV-GRND-DISC-AMT.             05160065
051700     ADD PV-TKID-NET-AMT         TO PV-GRND-NET-AMT.              05170065
051800     INITIALIZE PV-TKID-GROSS-AMT                                 05180065
051900                PV-TKID-DISC-AMT                                  05190065
052000                PV-TKID-NET-AMT.                                  05200065
052100                                                                  05210065
052200*  THIS CAUSES THE HEADINGS TO GET PRINTED WITH THE NEXT DETAIL   05220065
052300     MOVE +999                   TO PV-LINES-PER-PAGE.            05230065
052400                                                                  05240065
052500                                                                  05250065
052600 F400-FORMAT-GRAND-TOTALS.                                        05260065
052700*----------------------------------------------------------------*05270065
052800*  PRINT GRAND TOTALS FOR REPORT                                  05280065
052900*----------------------------------------------------------------*05290065
053000                                                                  05300065
053100     IF PV-LINES-PER-PAGE > PC-LINES-MAX                          05310065
053200         PERFORM W100-WRITE-HEADINGS                              05320065
053300     END-IF.                                                      05330065
053400                                                                  05340065
053500     MOVE PV-GRND-GROSS-AMT      TO TL3-GROSS-COST.               05350065
053600     MOVE PV-GRND-DISC-AMT       TO TL3-DISCOUNT.                 05360065
053700     MOVE PV-GRND-NET-AMT        TO TL3-NET-COST.                 05370065
053800                                                                  05380065
053900     WRITE REPORT-REC FROM TL-TOTAL3                              05390065
054000       AFTER ADVANCING +3 LINES.                                  05400065
054100                                                                  05410065
054200                                                                  05420065
054300 R100-READ-INPUT.                                                 05430065
054400*----------------------------------------------------------------*05440065
054500*  READ IMPORT FILE.                                             *05450065
054600*----------------------------------------------------------------*05460065
054700                                                                  05470065
054800     READ AP-TRANS-FILE INTO AP040-TRANSACTION-FILE               05480065
054900       AT END                                                     05490065
055000           SET PS-TRANS-EOF      TO TRUE                          05500065
055100       NOT AT END                                                 05510065
055200           ADD 1                 TO PV-TRANS-READ                 05520065
055300     END-READ.                                                    05530065
055400                                                                  05540065
055500                                                                  05550065
055600 W100-WRITE-HEADINGS.                                             05560065
055700*----------------------------------------------------------------*05570065
055800*  WRITE PAGE HEADING LINES.                                     *05580065
055900*----------------------------------------------------------------*05590065
056000                                                                  05600065
056100     ADD +1                      TO PV-PAGE-COUNT.                05610065
056200     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER            05620065
056300                                                                  05630065
056400* HEADING LINE 1 (STANDARD)                                       05640065
056500     WRITE REPORT-REC FROM DP132O-STANDRD-HEADER-132-COLS         05650065
056600       AFTER ADVANCING PAGE.                                      05660065
056700     WRITE REPORT-REC FROM HL-HEADER2                             05670065
056800       AFTER ADVANCING +1 LINES.                                  05680065
056900     WRITE REPORT-REC FROM HL-HEADER3                             05690065
057000       AFTER ADVANCING +1 LINES.                                  05700065
057100     WRITE REPORT-REC FROM HL-HEADER4                             05710065
057200       AFTER ADVANCING +1 LINES.                                  05720065
057300                                                                  05730065
057400* THIS HEADING LINE DOESN'T APPLY FOR THE GRAND TOTAL PAGE        05740065
057500     IF PS-TRANS-EOF                                              05750065
057600         MOVE SPACES             TO REPORT-REC                    05760065
057700         WRITE REPORT-REC                                         05770065
057800           AFTER ADVANCING +1 LINES                               05780065
057900     ELSE                                                         05790065
058000         WRITE REPORT-REC FROM HL-HEADER5                         05800065
058100           AFTER ADVANCING +1 LINES                               05810065
058200     END-IF.                                                      05820065
058300                                                                  05830065
058400     WRITE REPORT-REC FROM HL-HEADER6                             05840065
058500       AFTER ADVANCING +2 LINES.                                  05850065
058600     WRITE REPORT-REC FROM HL-HEADER7                             05860065
058700       AFTER ADVANCING +1 LINES.                                  05870065
058800                                                                  05880065
058900     MOVE SPACES                 TO REPORT-REC.                   05890065
059000     WRITE REPORT-REC                                             05900065
059100       AFTER ADVANCING +1 LINES.                                  05910065
059200     MOVE +9                     TO PV-LINES-PER-PAGE.            05920065
059300                                                                  05930065
059400                                                                  05940065
059500 W200-WRITE-DETAIL.                                               05950065
059600*----------------------------------------------------------------*05960065
059700*  PRINTS PO DETAIL LINES.                                       *05970065
059800*----------------------------------------------------------------*05980065
059900                                                                  05990065
060000     WRITE REPORT-REC FROM DL-DETAIL                              06000065
060100       AFTER ADVANCING +1 LINES.                                  06010065
060200                                                                  06020065
060300     ADD +1                      TO PV-LINES-PER-PAGE.            06030065
060400     INITIALIZE DL-DETAIL.                                        06040065
060500                                                                  06050065
060600                                                                  06060065
