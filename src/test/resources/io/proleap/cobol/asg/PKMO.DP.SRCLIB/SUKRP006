000100***************************************************************** 00010026
000200 IDENTIFICATION DIVISION.                                         00020026
000300***************************************************************** 00030026
000400                                                                  00040026
000500 PROGRAM-ID.             SUKRP006.                                00050026
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060026
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070026
000800 DATE-WRITTEN            JUNE, 1996.                              00080026
000900 DATE-COMPILED.                                                   00090026
001000***************************************************************** 00100026
001100***************************************************************** 00110026
001200*                                                               * 00120026
001300*  THIS PROGRAM WILL PRINT THE DUPLICATE SCAN REPORT            * 00130026
001400*  THIS IS PRODUCED FOLLOWING THE CHECK-IN OF A TRAILER         * 00140026
001500*  WHICH HAS HAD THE CARTONS SCANNED USING THE LRT TERMINAL.    * 00150026
001600***************************************************************** 00160026
001700*  CHANGED 08/07/2000 BY LARRY SCHLEICHER                       * 00170026
001800*   WR# 20694 USE THE DEST-OPER-UNT-ID FIELD FROM THE TSULBXF   * 00180026
001900*             TABLE TO FILL IN THE 'STR NBR' FIELD ON THE REPORT* 00190026
001600***************************************************************** 00191033
001700*  CHANGED 09/30/2014 BY CHERI PARMLEY                          * 00192033
001800*   CHG# 0094571  EXPAND PO# FROM 7 TO 8 DIGITS                 * 00193035
002000***************************************************************** 00200026
002100*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00210026
002200*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00220026
002300*                                                               * 00230026
002400***************************************************************** 00240026
002500***************************************************************** 00250026
002600 ENVIRONMENT DIVISION.                                            00260026
002700***************************************************************** 00270026
002800                                                                  00280026
002900 CONFIGURATION SECTION.                                           00290026
003000                                                                  00300026
003100 SOURCE-COMPUTER.        IBM-3090.                                00310026
003200 OBJECT-COMPUTER.        IBM-3090.                                00320026
003300                                                                  00330026
003400 INPUT-OUTPUT SECTION.                                            00340026
003500                                                                  00350026
003600 FILE-CONTROL.                                                    00360026
003700*                                                                 00370026
003800     SELECT EXTRACT-FILE                                          00380026
003900         ASSIGN TO INP01.                                         00390026
004000                                                                  00400026
004100     SELECT SU-CARTON-NOT-RCVD-FILE                               00410026
004200         ASSIGN TO RPT01.                                         00420026
004300*                                                                 00430026
004400***************************************************************** 00440026
004500 DATA DIVISION.                                                   00450026
004600***************************************************************** 00460026
004700*                                                                 00470026
004800 FILE SECTION.                                                    00480026
004900*                                                                 00490026
005000 FD  EXTRACT-FILE                                                 00500026
005100     LABEL RECORDS ARE STANDARD                                   00510026
005200     RECORDING MODE IS F                                          00520026
005300     BLOCK CONTAINS 0 RECORDS                                     00530026
005400     RECORD CONTAINS 200 CHARACTERS.                              00540026
005500 01  EXTRACT-RECORD                  PIC X(200).                  00550026
005600                                                                  00560026
005700 FD  SU-CARTON-NOT-RCVD-FILE                                      00570026
005800     RECORDING MODE IS F                                          00580026
005900     BLOCK CONTAINS 0  RECORDS.                                   00590026
006000 01  SU-CARTON-NOT-RCVD-RECORD       PIC  X(132).                 00600026
006100*                                                                 00610026
006200                                                                  00620026
006300 WORKING-STORAGE SECTION.                                         00630026
006400**************************************************************    00640026
006500* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00650026
006600**************************************************************    00660026
006700 01  CC-CONTROL-CARD.                                             00670026
006800     05  CC-PRINTER-ID                PIC  X(08).                 00680026
006900     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00690026
007000     05  CC-TRACK-NBR                 PIC  9(01).                 00700026
007100     05  FILLER                       PIC  X(01).                 00710026
007200     05  CC-CUT-REPORT                PIC  X(01).                 00720026
007300         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00730026
007400     05  CC-REQUESTOR-ID              PIC  X(08).                 00740026
007500     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00750026
007600         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00760026
007700     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00770026
007800         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00780026
007900     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00790026
008000         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00800026
008100     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 00810026
008200         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     00820026
008300     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 00830026
008400         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     00840026
008500     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 00850026
008600         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     00860026
008700     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 00870026
008800         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     00880026
008900*JPL                                                              00890026
009000     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 00900026
009100         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     00910026
009200     05  FILLER                       PIC  X(01).                 00920026
009300     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 00930026
009400         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     00940026
009500         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     00950026
009600*                                                                 00960026
009700 01  PROGRAM-SWITCHES.                                            00970026
009800     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00980026
009900         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00990026
010000     05  PS-END-OF-DUP-CSR-SW        PIC  X(01)    VALUE 'N'.     01000026
010100         88  PS-END-OF-DUP-CSR                     VALUE 'Y'.     01010026
010200         88  PS-START-OF-DUP-CSR                   VALUE 'N'.     01020026
010300     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01030026
010400         88  PS-STATUS-FOUND                       VALUE 'Y'.     01040026
010500         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01050026
010600     05  PS-FIRST-LINE-SW            PIC  X(01)    VALUE 'Y'.     01060026
010700         88  PS-FIRST-LINE                         VALUE 'Y'.     01070026
010800         88  PS-NOT-FIRST-LINE                     VALUE 'N'.     01080026
010900     05  PS-FINISHED-FIRST-LINE-SW   PIC  X(01)    VALUE 'N'.     01090026
011000         88  PS-FINISHED-FIRST-LINE                VALUE 'Y'.     01100026
011100         88  PS-PRINTING-FIRST-LINE                VALUE 'N'.     01110026
011200     05  PS-NEW-HEADING-SW           PIC  X(01)    VALUE 'N'.     01120026
011300         88  PS-NEW-HEADING                        VALUE 'Y'.     01130026
011400         88  PS-NO-HEADING                         VALUE 'N'.     01140026
011500     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01150026
011600         88  PS-ERROR-RECORD                       VALUE 'A'.     01160026
011700         88  PS-DETAIL-RECORD                      VALUE 'B'.     01170026
011800*LMM                                                              01180026
011900 01  DN-DB2-NULL-INDICATORS.                                      01190026
012000     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01200026
012100*                                                                 01210026
012200 01  PC-CONSTANTS.                                                01220026
012300     05  PC-1                        PIC S9(03)    VALUE +1       01230026
012400                                                   COMP-3.        01240026
012500     05  PC-2                        PIC S9(03)    VALUE +2       01250026
012600                                                   COMP-3.        01260026
012700     05  PC-3                        PIC S9(03)    VALUE +3       01270026
012800                                                   COMP-3.        01280026
012900     05  PC-7                        PIC S9(01)    VALUE +7.      01290026
013000     05  PC-12                       PIC S9(03)    VALUE +12      01300026
013100                                                   COMP-3.        01310026
013200     05  PC-60                       PIC S9(03)    VALUE +60      01320026
013300                                                   COMP-3.        01330026
013400     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01340026
013500     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01350026
013600     05  PC-00                       PIC  X(02)    VALUE '00'.    01360026
013700     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01370026
013800     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01380026
013900     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01390026
014000     05  PC-MLT                      PIC  X(04)    VALUE 'MLT '.  01400032
014100     05  PC-A                        PIC  X(01)    VALUE 'A'.     01410026
014200     05  PC-SUKRP006                 PIC  X(08)    VALUE          01420026
014300         'SUKRP006'.                                              01430026
014400     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01440026
014500     05  PC-NO-SKU                   PIC  X(11)    VALUE          01450026
014600         '  NO SKU'.                                              01460026
014700*                                                                 01470026
014800 01  PV-MISC-FIELDS.                                              01480026
014900     05  PV-IN-SUB                   PIC S9(04)    VALUE +0       01490026
015000                                                   COMP.          01500026
015100     05  PV-OUT-SUB                  PIC S9(04)    VALUE +0       01510026
015200                                                   COMP.          01520026
015300     05  PV-LINE-SUB                 PIC S9(03)    VALUE +0       01530026
015400                                                   COMP-3.        01540026
015500     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01550026
015600                                                   COMP-3.        01560026
015700     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01570026
015800                                                   COMP-3.        01580026
015900     05  PV-DB2-COUNT                PIC S9(04)    VALUE ZERO     01590026
016000                                                   COMP SYNC.     01600026
016100     05  PV-RECORD-COUNT             PIC  9(04)    VALUE ZERO.    01610026
016200     05  PV-LINE-TOTAL               PIC S9(04)    VALUE ZERO     01620026
016300                                                   COMP SYNC.     01630026
016400     05  PV-EXPTED-QTY               PIC S9(04)    VALUE ZERO     01640026
016500                                                   COMP SYNC.     01650026
016600     05  PV-TRIP-ID                  PIC S9(09)    VALUE ZERO     01660026
016700                                                   COMP SYNC.     01670026
016800     05  PV-SAVE-STR-NBR             PIC S9(04)    VALUE ZERO     01680026
016900                                                   COMP SYNC.     01690026
017000     05  PV-SAVE-UPC-NBR             PIC S9(15)    VALUE ZERO     01700026
017100                                                   COMP-3.        01710026
017200     05  PV-STR-NBR                  PIC S9(04)    VALUE ZERO     01720026
017300                                                   COMP SYNC.     01730026
017400     05  PV-SAVE-LNE-NBR             PIC S9(09)    VALUE 99999999901740026
017500                                                   COMP SYNC.     01750026
017600******************************************************************01760026
017700*  INCREASED THE SIZE OF PV-SAVE-SKU TO 15.            WR# 21361 *01770026
017800******************************************************************01780026
018000     05  PV-SAVE-SKU                 PIC  X(15).                  01790026
018100     05  PV-STATUS                   PIC  X(02).                  01800026
      *CLP 09/30/14                                                     01801033
018200     05  PV-SAVE-PO-RECEIVER         PIC  X(12).                  01810033
018300     05  PV-SAVE-SHIP-CODE           PIC  X(20).                  01820026
018400     05  SAVE-SHIPT-UNT-ID           PIC S9(18) COMP-3.           01830026
018500     05  PV-MANIFEST-X               PIC  X(09).                  01840026
018600     05  PV-MANIFEST REDEFINES PV-MANIFEST-X                      01850026
018700                                     PIC  9(09).                  01860026
018800     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01870026
018900                                                   COMP SYNC.     01880026
019000     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01890026
019100     05  PV-ABEND-TRIP-ID            PIC  9(12)    VALUE ZERO.    01900026
019200     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    01910026
019300******************************************************************01920026
019400*  REMOVED VARIABLE PV-SKU-SEQ AND ADDED NEW           WR# 21361 *01930026
019500*  VARIABLE PV-SKU-NBR 9(8). CHANGED THE VALUES OF FILLERS TO    *01940027
019600*  SPACES.*                                                       01950027
019700******************************************************************01960026
019800     05  PV-SKU.                                                  01970026
019900         10  PV-SKU-DEPT             PIC  X(03)    VALUE SPACES.  01980026
020000         10  FILLER                  PIC  X(01)    VALUE SPACES.  01990026
020100         10  PV-SKU-CLASS            PIC  X(02)    VALUE SPACES.  02000026
020200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02010026
020400         10  PV-SKU-NBR              PIC  9(08)    VALUE ZEROS.   02020026
020500******************************************************************02030026
020600*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *02040029
020700******************************************************************02050026
020800     05  PV-PO-RECEIVER.                                          02060026
      *CLP 09/30/14                                                     02061034
020900         10  PV-PO                   PIC  ZZZZZZZ9 VALUE ZERO.    02070034
021000         10  FILLER                  PIC  X(01)    VALUE '-'.     02080026
021100         10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    02090026
021200     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  02100026
021300     05  PV-TODAYS-DATE.                                          02110026
021400         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    02120026
021500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    02130026
021600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    02140026
021700     05  PV-TODAYS-TIME.                                          02150026
021800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    02160026
021900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02170026
022000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02180026
022100         10  FILLER                  PIC  9(02)    VALUE ZERO.    02190026
022200     05  PV-DB2-DATE.                                             02200026
022300         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    02210026
022400         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02220026
022500         10  FILLER                  PIC  X(01)    VALUE ZERO.    02230026
022600         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02240026
022700         10  FILLER                  PIC  X(01)    VALUE ZERO.    02250026
022800         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02260026
022900     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 02270026
023000     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02280026
023100         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02290026
023200         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02300026
023300         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02310026
023400         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02320026
023500     05  PV-OUT-SERIAL-SHIP-CODE.                                 02330026
023600         10  FILLER                   PIC  X(05)    VALUE '(00) '.02340026
023700         10  PV-OUT-S-S-C-1           PIC  X(01).                 02350026
023800         10  FILLER                   PIC  X(01) VALUE SPACES.    02360026
023900         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02370026
024000         10  FILLER                   PIC  X(01) VALUE SPACES.    02380026
024100         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02390026
024200         10  FILLER                   PIC  X(01) VALUE SPACES.    02400026
024300         10  PV-OUT-S-S-C-18          PIC  X(01).                 02410026
024400     05  PV-DB2-TMST.                                             02420026
024500         10 FILLER                    PIC  X(02).                 02430026
024600         10 PV-DB2-TMST-YY            PIC  9(02).                 02440026
024700         10 FILLER                    PIC  X(01).                 02450026
024800         10 PV-DB2-TMST-MM            PIC  9(02).                 02460026
024900         10 FILLER                    PIC  X(01).                 02470026
025000         10 PV-DB2-TMST-DD            PIC  9(02).                 02480026
025100         10 FILLER                    PIC  X(01).                 02490026
025200         10 PV-DB2-TMST-HH            PIC  9(02).                 02500026
025300         10 FILLER                    PIC  X(01).                 02510026
025400         10 PV-DB2-TMST-MN            PIC  9(02).                 02520026
025500         10 FILLER                    PIC  X(01).                 02530026
025600         10 PV-DB2-TMST-SS            PIC  9(02).                 02540026
025700         10 FILLER                    PIC  X(07).                 02550026
025800     05  PV-FORMAT-DATE.                                          02560026
025900         10 PV-FORMAT-DATE-MM         PIC  9(02).                 02570026
026000         10 FILLER                    PIC  X(01) VALUE '/'.       02580026
026100         10 PV-FORMAT-DATE-DD         PIC  9(02).                 02590026
026200         10 FILLER                    PIC  X(01) VALUE '/'.       02600026
026300         10 PV-FORMAT-DATE-YY         PIC  9(02).                 02610026
026400     05  PV-FORMAT-TIME.                                          02620026
026500         10 PV-FORMAT-TIME-HH         PIC  9(02).                 02630026
026600         10 FILLER                    PIC  X(01) VALUE ':'.       02640026
026700         10 PV-FORMAT-TIME-MN         PIC  9(02).                 02650026
026800         10 FILLER                    PIC  X(01) VALUE ':'.       02660026
026900         10 PV-FORMAT-TIME-SS         PIC  9(02).                 02670026
027000 01  PV-SAVE-TABLE.                                               02680026
027100     05  PV-SAVE-TABLE-ITEMS OCCURS 20 TIMES INDEXED BY SUB.      02690026
027200         10 PV-SAVE-TRIP-ID           PIC  9(09)  COMP.           02700026
027300         10 PV-SAVE-OPER-UNIT         PIC  9(04)  COMP.           02710026
027400         10 PV-SAVE-CRE-TMST          PIC  X(26).                 02720026
027500         10 PV-SAVE-SCAN-USER-ID      PIC  X(08).                 02730026
027600*                                                                 02740026
027700     COPY DPWS024.                                                02750032
027800*                                                                 02760026
027900     COPY SURD001.                                                02770032
028000 EJECT                                                            02780026
028100*                                                                 02790026
028200******************************************************************02800026
028300*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02810026
028400******************************************************************02820026
028500     COPY DPWS132O.                                               02830032
028600*                                                                 02840026
028700*                                                                 02850026
028800 01  HEADING-LINES.                                               02860026
028900     05  HEADING-LINE-0.                                          02870026
029000         10  FILLER                  PIC  X(50)    VALUE SPACES.  02880026
029100         10  FILLER                  PIC  X(32)    VALUE          02890026
029200             'CHECK-IN COMPLETION - EXCEPTIONS'.                  02900026
029300         10  FILLER                  PIC  X(50)    VALUE SPACES.  02910026
029400*                                                                 02920026
029500     05  HEADING-LINE-1.                                          02930026
029600         10  FILLER                  PIC  X(05)    VALUE SPACES.  02940026
029700         10  FILLER                  PIC  X(40)    VALUE          02950026
029800             '****************************************'.          02960026
029900         10  FILLER                  PIC  X(13)    VALUE SPACES.  02970026
030000         10  FILLER                  PIC  X(15)    VALUE          02980026
030100             'DUPLICATE SCANS' .                                  02990026
030200         10  FILLER                  PIC  X(59)    VALUE SPACES.  03000026
030300*                                                                 03010026
030400     05  HEADING-LINE-1A.                                         03020026
030500         10  FILLER                  PIC  X(05)    VALUE SPACES.  03030026
030600         10  FILLER                  PIC  X(03)    VALUE '*  '.   03040026
030700         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  03050026
030800         10  FILLER                  PIC  X(01)    VALUE '*'.     03060026
030900         10  FILLER                  PIC  X(87)    VALUE SPACES.  03070026
031000*                                                                 03080026
031100     05  HEADING-LINE-1B.                                         03090026
031200         10  FILLER                  PIC  X(05)    VALUE SPACES.  03100026
031300         10  FILLER                  PIC  X(40)    VALUE          03110026
031400             '****************************************'.          03120026
031500         10  FILLER                  PIC  X(87)    VALUE SPACES.  03130026
031600*                                                                 03140026
031700     05  HEADING-LINE-2.                                          03150026
031800         10  FILLER                  PIC  X(03)    VALUE SPACE.   03160026
031900         10  FILLER                  PIC  X(09)    VALUE          03170026
032000             'CARRIER: '.                                         03180026
032100         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  03190026
032200         10  FILLER                  PIC  X(03)    VALUE SPACE.   03200026
032300         10  FILLER                  PIC  X(09)    VALUE          03210026
032400             'TRAILER: '.                                         03220026
032500         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  03230026
032600         10  FILLER                  PIC  X(04)    VALUE SPACE.   03240026
032700         10  FILLER                  PIC  X(09)    VALUE          03250026
032800             'TRIP ID: '.                                         03260026
032900         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  03270026
033000         10  FILLER                  PIC  X(14)    VALUE SPACE.   03280026
033100         10  FILLER                  PIC  X(16)    VALUE          03290026
033200             'TRAILER STATUS: '.                                  03300026
033300         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  03310026
033400         10  FILLER                  PIC  X(38)    VALUE SPACES.  03320026
033500*                                                                 03330026
033600     05  HEADING-LINE-3.                                          03340026
033700         10  FILLER                  PIC  X(03)    VALUE SPACES.  03350026
033800         10  FILLER                  PIC  X(16)    VALUE          03360026
033900             'ARRIVAL DATE:   '.                                  03370026
034000         10  HL3-ARRIVAL-DATE.                                    03380026
034100             15  HL3-ARRIVAL-DATE-MM                              03390026
034200                                     PIC  X(02)    VALUE SPACES.  03400026
034300             15  FILLER              PIC  X(01)    VALUE '/'.     03410026
034400             15  HL3-ARRIVAL-DATE-DD                              03420026
034500                                     PIC  X(02)    VALUE SPACES.  03430026
034600             15  FILLER              PIC  X(01)    VALUE '/'.     03440026
034700             15  HL3-ARRIVAL-DATE-CC                              03450026
034800                                     PIC  X(02)    VALUE SPACES.  03460026
034900             15  HL3-ARRIVAL-DATE-YY                              03470026
035000                                     PIC  X(02)    VALUE SPACES.  03480026
035100         10  FILLER                  PIC  X(11)    VALUE SPACES.  03490026
035200         10  FILLER                  PIC  X(23)    VALUE          03500026
035300             'BEGIN UNLOADING DATE:  '.                           03510026
035400         10  HL3-BEG-UNLOAD-DATE.                                 03520026
035500             15  HL3-BEG-UNLOAD-DATE-MM                           03530026
035600                                     PIC  X(02)    VALUE SPACES.  03540026
035700             15  FILLER              PIC  X(01)    VALUE '/'.     03550026
035800             15  HL3-BEG-UNLOAD-DATE-DD                           03560026
035900                                     PIC  X(02)    VALUE SPACES.  03570026
036000             15  FILLER              PIC  X(01)    VALUE '/'.     03580026
036100             15  HL3-BEG-UNLOAD-DATE-CC                           03590026
036200                                     PIC  X(02)    VALUE SPACES.  03600026
036300             15  HL3-BEG-UNLOAD-DATE-YY                           03610026
036400                                     PIC  X(02)    VALUE SPACES.  03620026
036500         10  FILLER                  PIC  X(03)    VALUE SPACES.  03630026
036600         10  FILLER                  PIC  X(15)    VALUE          03640026
036700             'UNLOADED DATE: '.                                   03650026
036800         10  HL3-UNLOADED-DATE.                                   03660026
036900             15  HL3-UNLOADED-DATE-MM                             03670026
037000                                     PIC  X(02)    VALUE SPACES.  03680026
037100             15  FILLER              PIC  X(01)    VALUE '/'.     03690026
037200             15  HL3-UNLOADED-DATE-DD                             03700026
037300                                     PIC  X(02)    VALUE SPACES.  03710026
037400             15  FILLER              PIC  X(01)    VALUE '/'.     03720026
037500             15  HL3-UNLOADED-DATE-CC                             03730026
037600                                     PIC  X(02)    VALUE SPACES.  03740026
037700             15  HL3-UNLOADED-DATE-YY                             03750026
037800                                     PIC  X(02)    VALUE SPACES.  03760026
037900         10  FILLER                  PIC  X(31)    VALUE SPACES.  03770026
038000*                                                                 03780026
038100     05  HEADING-LINE-4.                                          03790026
038200         10  FILLER                  PIC  X(80)    VALUE SPACES.  03800026
038300         10  FILLER                  PIC  X(13)    VALUE          03810026
038400             '------------ '.                                     03820026
038500         10  FILLER                  PIC  X(26)    VALUE          03830026
038600             'SCAN CHECK-IN INFORMATION '.                        03840026
038700         10  FILLER                  PIC  X(12)    VALUE          03850026
038800             '------------'.                                      03860026
038900*                                                                 03870026
039000******************************************************************03880026
039100*   ADJUSTED FILLERS FOR REPORT HEADING.               WR# 21361 *03890026
039200******************************************************************03900026
039300     05  HEADING-LINE-5.                                          03910026
039400         10  FILLER                  PIC  X(40)    VALUE SPACES.  03920026
039500         10  FILLER                  PIC  X(03)    VALUE          03930026
039600             'STR'.                                               03940026
039700         10  FILLER                  PIC  X(02)    VALUE SPACES.  03950026
039800         10  FILLER                  PIC  X(04)    VALUE          03960026
039900             'LINE'.                                              03970026
040100         10  FILLER                  PIC  X(18)    VALUE SPACES.  03980026
040200         10  FILLER                  PIC  X(05)    VALUE          03990026
040300             'EXPTD'.                                             04000026
040500         10  FILLER                  PIC  X(03)    VALUE SPACES.  04010026
040600         10  FILLER                  PIC  X(04)    VALUE          04020026
040700             'LINE'.                                              04030026
040900         10  FILLER                  PIC  X(18)    VALUE SPACES.  04040026
041000         10  FILLER                  PIC  X(04)    VALUE          04050026
041100             'OPER'.                                              04060026
041200         10  FILLER                  PIC  X(04)    VALUE SPACES.  04070026
041300         10  FILLER                  PIC  X(04)    VALUE          04080026
041400             'SCAN'.                                              04090026
041500         10  FILLER                  PIC  X(06)    VALUE SPACES.  04100026
041600         10  FILLER                  PIC  X(04)    VALUE          04110026
041700             'SCAN'.                                              04120026
041800         10  FILLER                  PIC  X(06)    VALUE SPACES.  04130026
041900         10  FILLER                  PIC  X(04)    VALUE          04140026
042000             'SCAN'.                                              04150026
042100         10  FILLER                  PIC  X(02)    VALUE SPACES.  04160026
042200*                                                                 04170026
042300******************************************************************04180026
042400*   REPLACED FILLER VALUE 'SKU NUMBER' WITH FILLER     WR# 21361 *04190026
042500*   VALUE 'DPT CL SKU' AND ADJUSTED FILLERS.                     *04200026
042600******************************************************************04210026
042700     05  HEADING-LINE-6.                                          04220026
042800         10  FILLER                  PIC  X(05)    VALUE SPACES.  04230026
042900         10  FILLER                  PIC  X(16)    VALUE          04240026
043000             'SERIAL SHIP CODE'.                                  04250026
043100         10  FILLER                  PIC  X(06)    VALUE SPACES.  04260026
043200         10  FILLER                  PIC  X(11)    VALUE          04270026
043300             'PO/RECEIVER'.                                       04280026
043400         10  FILLER                  PIC  X(02)    VALUE SPACES.  04290026
043500         10  FILLER                  PIC  X(03)    VALUE          04300026
043600             'NBR'.                                               04310026
043700         10  FILLER                  PIC  X(03)    VALUE SPACES.  04320026
043800         10  FILLER                  PIC  X(03)    VALUE          04330026
043900             'NBR'.                                               04340026
044000         10  FILLER                  PIC  X(02)    VALUE SPACES.  04350026
044300         10  FILLER                  PIC  X(14)    VALUE          04360026
044400             'DPT CL SKU    '.                                    04370026
044500         10  FILLER                  PIC  X(03)    VALUE SPACES.  04380026
044600         10  FILLER                  PIC  X(03)    VALUE          04390026
044700             'QTY'.                                               04400026
044900         10  FILLER                  PIC  X(02)    VALUE SPACES.  04410026
045000         10  FILLER                  PIC  X(07)    VALUE          04420026
045100             'TOT QTY'.                                           04430026
045300         10  FILLER                  PIC  X(02)    VALUE SPACES.  04440026
045400         10  FILLER                  PIC  X(04)    VALUE          04450026
045500             'SCAC'.                                              04460026
045700         10  FILLER                  PIC  X(01)    VALUE SPACES.  04470026
045800         10  FILLER                  PIC  X(07)    VALUE          04480026
045900             'TRAILER'.                                           04490026
046100         10  FILLER                  PIC  X(03)    VALUE SPACES.  04500026
046200         10  FILLER                  PIC  X(04)    VALUE          04510026
046300             'UNIT'.                                              04520026
046400         10  FILLER                  PIC  X(04)    VALUE SPACES.  04530026
046500         10  FILLER                  PIC  X(04)    VALUE          04540026
046600             'DATE'.                                              04550026
046700         10  FILLER                  PIC  X(06)    VALUE SPACES.  04560026
046800         10  FILLER                  PIC  X(04)    VALUE          04570026
046900             'TIME'.                                              04580026
047000         10  FILLER                  PIC  X(05)    VALUE SPACES.  04590026
047100         10  FILLER                  PIC  X(07)    VALUE          04600026
047200             'USER ID'.                                           04610026
047300******************************************************************04620026
047400*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *04630029
047500******************************************************************04640026
047600*                                                                 04650026
047700*                                                                 04660026
047800 01  MISCELLANEOUS-LINES.                                         04670026
047900     05  END-OF-REPORT-LINE.                                      04680026
048000         10  FILLER                  PIC  X(44)    VALUE SPACES.  04690026
048100         10  FILLER                  PIC  X(45)    VALUE          04700026
048200             '*******   E N D   O F   R E P O R T   *******'.     04710026
048300         10  FILLER                  PIC  X(43)    VALUE SPACES.  04720026
048400*                                                                 04730026
048500******************************************************************04740026
048600*  INCREASED THE SIZE OF DL1-SKU TO 15 AND ADJUSTED    WR# 21361 *04750026
048700*  FILLERS.                                                      *04760026
048800******************************************************************04770026
048900 01  DETAIL-LINES.                                                04780026
049000     05  DETAIL-LINE1.                                            04790026
049100         10  DL1-SERIAL-SHIP-CODE    PIC  X(26)    VALUE SPACES.  04800026
049200         10  FILLER                  PIC  X(01)    VALUE SPACES.  04810026
      *CLP 09/30/14                                                     04811033
049300         10  DL1-PO-RECEIVER         PIC  X(12)    VALUE SPACES.  04820033
049400         10  FILLER                  PIC  X(01)    VALUE SPACES.  04830033
049500         10  DL1-STORE               PIC  ZZZZ     VALUE ZERO.    04840032
049600         10  DL1-STORE-X REDEFINES DL1-STORE                      04850026
049700                                     PIC   X(04).                 04860032
049800         10  FILLER                  PIC  X(01)    VALUE SPACES.  04870032
049900         10  DL1-LINE-NBR            PIC   ZZZ9    VALUE ZERO.    04880026
050000         10  DL1-LINE-NBR-X  REDEFINES DL1-LINE-NBR               04890026
050100                                     PIC  X(04).                  04900026
050200         10  FILLER                  PIC  X(02)    VALUE SPACES.  04910026
050400         10  DL1-SKU                 PIC  X(15)    VALUE SPACES.  04920026
050600         10  FILLER                  PIC  X(01)    VALUE SPACES.  04930026
050700         10  DL1-EXPTED-QTY          PIC  ZZZZ9    VALUE ZERO.    04940026
050800         10  DL1-EXPTED-QTY-X  REDEFINES DL1-EXPTED-QTY           04950026
050900                                     PIC  X(05).                  04960026
051100         10  FILLER                  PIC  X(02)    VALUE SPACES.  04970026
051200         10  DL1-LINE-TOTAL          PIC  ZZZZ9    VALUE ZERO.    04980026
051300         10  DL1-LINE-TOTAL-X REDEFINES DL1-LINE-TOTAL            04990026
051400                                     PIC  X(05).                  05000026
051600         10  FILLER                  PIC  X(03)    VALUE SPACES.  05010026
051700         10  DL1-SCAC                PIC  X(04)    VALUE SPACES.  05020026
051900         10  FILLER                  PIC  X(01)    VALUE SPACES.  05030026
052000         10  DL1-TRAILER             PIC  X(10)    VALUE SPACES.  05040026
052200         10  FILLER                  PIC  X(01)    VALUE SPACES.  05050026
052300         10  DL1-OPER-UNIT           PIC  ZZZ9     VALUE ZERO.    05060026
052400         10  DL1-OPER-UNIT-X REDEFINES DL1-OPER-UNIT              05070026
052500                                     PIC  X(04).                  05080026
052600         10  FILLER                  PIC  X(02)    VALUE SPACES.  05090026
052700         10  DL1-SCAN-DATE           PIC  X(08)    VALUE SPACES.  05100026
052800         10  FILLER                  PIC  X(02)    VALUE SPACES.  05110026
052900         10  DL1-SCAN-TIME           PIC  X(08)    VALUE SPACES.  05120026
053000         10  FILLER                  PIC  X(02)    VALUE SPACES.  05130026
053100         10  DL1-SCAN-USER-ID        PIC  X(08)    VALUE SPACES.  05140026
053200******************************************************************05150026
053300*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *05160029
053400******************************************************************05170026
053500                                                                  05180026
053600 01  EL1-ERROR-LINE-1F.                                           05190026
053700     05  FILLER                      PIC  X(02)     VALUE SPACES. 05200026
053800     05  FILLER                      PIC  X(48)     VALUE         05210026
053900         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05220026
054000     05  FILLER                      PIC  X(49)     VALUE         05230026
054100         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     05240026
054200     05  FILLER                      PIC  X(33)     VALUE         05250026
054300         ' COMPLETED.                      '.                     05260026
054400                                                                  05270026
054500 01  EL1-ERROR-LINE-1P.                                           05280026
054600     05  FILLER                      PIC  X(02)     VALUE SPACES. 05290026
054700     05  FILLER                      PIC  X(48)     VALUE         05300026
054800         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05310026
054900     05  FILLER                      PIC  X(49)     VALUE         05320026
055000         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     05330026
055100     05  FILLER                      PIC  X(33)     VALUE         05340026
055200         'COMPLETED.                       '.                     05350026
055300                                                                  05360026
055400 01  EL2-ERROR-LINE-2F.                                           05370026
055500     05  FILLER                      PIC  X(02)     VALUE SPACES. 05380026
055600     05  FILLER                      PIC  X(36)     VALUE         05390026
055700         'NONE OF YOUR REPORTS WERE CREATED.  '.                  05400026
055800     05  FILLER                      PIC  X(36)     VALUE         05410026
055900         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  05420026
056000     05  FILLER                      PIC  X(58)     VALUE SPACES. 05430026
056100                                                                  05440026
056200 01  EL2-ERROR-LINE-2P.                                           05450026
056300     05  FILLER                      PIC  X(02)     VALUE SPACES. 05460026
056400     05  FILLER                      PIC  X(49)     VALUE         05470026
056500         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     05480026
056600     05  FILLER                      PIC  X(41)     VALUE         05490026
056700         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             05500026
056800     05  FILLER                      PIC  X(40)     VALUE         05510026
056900         'DETERMINE IF THEY NEED TO BE CREATED).  '.              05520026
057000                                                                  05530026
057100 01  EL3-ERROR-LINE-3.                                            05540026
057200     05  FILLER                      PIC  X(02)     VALUE SPACES. 05550026
057300     05  FILLER                      PIC  X(50)     VALUE         05560026
057400         'YOUR REQUEST WAS AS FOLLOWS:                      '.    05570026
057500     05  FILLER                      PIC  X(81)     VALUE SPACES. 05580026
057600                                                                  05590026
057700 01  EL4-ERROR-LINE-4.                                            05600026
057800     05  FILLER                      PIC  X(07)     VALUE SPACES. 05610026
057900     05  FILLER                      PIC  X(12)     VALUE         05620026
058000         'REQUESTOR:  '.                                          05630026
058100     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 05640026
058200     05  FILLER                      PIC  X(10)     VALUE SPACES. 05650026
058300     05  FILLER                      PIC  X(22)     VALUE         05660026
058400         'PRINTER DESTINATION:  '.                                05670026
058500     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05680026
058600     05  FILLER                      PIC  X(65)     VALUE SPACES. 05690026
058700                                                                  05700026
058800 01  EL5-ERROR-LINE-5.                                            05710026
058900     05  FILLER                      PIC  X(07)     VALUE SPACES. 05720026
059000     05  FILLER                      PIC  X(20)     VALUE         05730026
059100         'REQUESTED REPORTS:  '.                                  05740026
059200*JPL                                                              05750026
059300     05  FILLER                      PIC  X(105)    VALUE SPACES. 05760026
059400*JPL 05  FILLER                      PIC  X(08)     VALUE         05770026
059500*JPL     'STATS   '.                                              05780026
059600*JPL 05  FILLER                      PIC  X(18)     VALUE         05790026
059700*JPL     'PO/STR WRKSHEET   '.                                    05800026
059800*JPL 05  FILLER                      PIC  X(17)     VALUE         05810026
059900*JPL     'CRTNS NOT RCVD   '.                                     05820026
060000*JPL 05  FILLER                      PIC  X(14)     VALUE         05830026
060100*JPL     'FREE ASTRAY   '.                                        05840026
060200*JPL 05  FILLER                      PIC  X(12)     VALUE         05850026
060300*JPL     'MISDIRECT   '.                                          05860026
060400*JPL 05  FILLER                      PIC  X(17)     VALUE         05870026
060500*JPL     'DUPLICATE SCAN   '.                                     05880026
060600*JPL 05  FILLER                      PIC  X(14)     VALUE         05890026
060700*JPL     'SCAN NOT FOUND'.                                        05900026
060800*JPL 05  FILLER                      PIC  X(05)     VALUE SPACES. 05910026
060900                                                                  05920026
061000 01  EL5-ERROR-LINE-5B.                                           05930026
061100     05  FILLER                      PIC  X(07)     VALUE SPACES. 05940026
061200     05  FILLER                      PIC  X(04)     VALUE SPACES. 05950026
061300     05  FILLER                      PIC  X(08)     VALUE         05960026
061400         'STATS   '.                                              05970026
061500     05  FILLER                      PIC  X(18)     VALUE         05980026
061600         'PO/STR UNT ADJ    '.                                    05990026
061700     05  FILLER                      PIC  X(17)     VALUE         06000026
061800         'CRTNS NOT RCVD   '.                                     06010026
061900     05  FILLER                      PIC  X(14)     VALUE         06020026
062000         'FREE ASTRAY   '.                                        06030026
062100     05  FILLER                      PIC  X(12)     VALUE         06040026
062200         'MISDIRECT   '.                                          06050026
062300     05  FILLER                      PIC  X(17)     VALUE         06060026
062400         'DUPLICATE SCAN   '.                                     06070026
062500     05  FILLER                      PIC  X(18)     VALUE         06080026
062600         'SCAN NOT FOUND    '.                                    06090026
062700     05  FILLER                      PIC  X(17)     VALUE         06100026
062800         'UNUSED LABELS    '.                                     06110026
062900*JPL                                                              06120026
063000*01  EL6-ERROR-LINE-6.                                            06130026
063100*    05  FILLER                      PIC  X(29)     VALUE SPACES. 06140026
063200*    05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 06150026
063300*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06160026
063400*    05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 06170026
063500*    05  FILLER                      PIC  X(16)     VALUE SPACES. 06180026
063600*    05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 06190026
063700*    05  FILLER                      PIC  X(15)     VALUE SPACES. 06200026
063800*    05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 06210026
063900*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06220026
064000*    05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 06230026
064100*    05  FILLER                      PIC  X(13)     VALUE SPACES. 06240026
064200*    05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 06250026
064300*    05  FILLER                      PIC  X(16)     VALUE SPACES. 06260026
064400*    05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 06270026
064500*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06280026
064600                                                                  06290026
064700 01  EL6-ERROR-LINE-6B.                                           06300026
064800     05  FILLER                      PIC  X(13)     VALUE SPACES. 06310026
064900     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 06320026
065000     05  FILLER                      PIC  X(12)     VALUE SPACES. 06330026
065100     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 06340026
065200     05  FILLER                      PIC  X(16)     VALUE SPACES. 06350026
065300     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 06360026
065400     05  FILLER                      PIC  X(15)     VALUE SPACES. 06370026
065500     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 06380026
065600     05  FILLER                      PIC  X(12)     VALUE SPACES. 06390026
065700     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 06400026
065800     05  FILLER                      PIC  X(13)     VALUE SPACES. 06410026
065900     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 06420026
066000     05  FILLER                      PIC  X(16)     VALUE SPACES. 06430026
066100     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 06440026
066200     05  FILLER                      PIC  X(17)     VALUE SPACES. 06450026
066300*JPL                                                              06460026
066400     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 06470026
066500     05  FILLER                      PIC  X(10)     VALUE SPACES. 06480026
066600                                                                  06490026
066700******************************************************************06500026
066800*  ADDED COPYBOOK FOR XLKUT001                         WR# 21361 *06510026
066900******************************************************************06520026
067000     COPY XLWS001.                                                06530026
067100                                                                  06540026
067200******************************************************************06550026
067300*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06560029
067400******************************************************************06570026
067500*                                                                 06580026
067600*  COPY BOOK FOR SHIPMENT TABLE                                   06590026
067700*                                                                 06600026
067800     EXEC SQL                                                     06610026
067900          INCLUDE TSHIPMT                                         06620026
068000     END-EXEC.                                                    06630026
068100******************************************************************06640026
068200*  REMOVED REFERENCES OF DB2 TABLE TSHPTPO.            WR# 21361 *06650026
068300******************************************************************06660026
069000******************************************************************06670026
069100*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06680029
069200******************************************************************06690026
069300*                                                                 06700026
069400*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    06710026
069500*                                                                 06720026
069600     EXEC SQL                                                     06730026
069700          INCLUDE TSHUUPC                                         06740026
069800     END-EXEC.                                                    06750026
069900*                                                                 06760026
070000*  COPY BOOK FOR PACKSLIP TABLE                                   06770026
070100*                                                                 06780026
070200     EXEC SQL                                                     06790026
070300          INCLUDE TPKSLIP                                         06800026
070400     END-EXEC.                                                    06810026
070500*                                                                 06820026
070600*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T06830026
070700*                                                                 06840026
070800     EXEC SQL                                                     06850026
070900          INCLUDE TINPKSU                                         06860026
071000     END-EXEC.                                                    06870026
071100*                                                                 06880026
071200*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           06890026
071300*                                                                 06900026
071400     EXEC SQL                                                     06910026
071500          INCLUDE TSHUNLO                                         06920026
071600     END-EXEC.                                                    06930026
071700******************************************************************06940026
071800*  REMOVED REFERENCES OF DB2 TABLE TSK                 WR# 21361 *06950026
071900******************************************************************06960026
071910******************************************************************06970028
071920*  REMOVED REFERENCES OF DB2 TABLE TSK                 WR# 21361 *06980028
071930******************************************************************06990028
073500******************************************************************07000026
073600*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *07010029
073700******************************************************************07020026
073800*                                                                 07030026
073900*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           07040026
074000*                                                                 07050026
074100     EXEC SQL                                                     07060026
074200          INCLUDE TVHTRIP                                         07070026
074300     END-EXEC.                                                    07080026
074400*                                                                 07090026
074500*  COPY BOOK FOR TRIP STATUS TABLE                                07100026
074600*                                                                 07110026
074700     EXEC SQL                                                     07120026
074800          INCLUDE TTRIPST                                         07130026
074900     END-EXEC.                                                    07140026
075000*                                                                 07150026
075100*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           07160026
075200*                                                                 07170026
075300     EXEC SQL                                                     07180026
075400          INCLUDE TTRSTYP                                         07190026
075500     END-EXEC.                                                    07200026
075600*                                                                 07210026
075700*  COPY BOOK FOR SHIPMENT UNIT BARCODE NUMBER                    T07220026
075800*                                                                 07230026
075900     EXEC SQL                                                     07240026
076000          INCLUDE TSULBXF                                         07250026
076100     END-EXEC.                                                    07260026
076200                                                                  07270026
076300 EJECT                                                            07280026
076400*  DB2 COMMUNICATION AREA                                         07290026
076500*                                                                 07300026
076600     EXEC SQL                                                     07310026
076700         INCLUDE SQLCA                                            07320026
076800     END-EXEC.                                                    07330026
076900 EJECT                                                            07340026
077000*  DB2 COMMUNICATION AREA2                                        07350026
077100*                                                                 07360026
077200     COPY SQLCA2.                                                 07370032
077300 EJECT                                                            07380026
077400                                                                  07390026
077500                                                                  07400026
077600     EXEC SQL                                                     07410026
077700          DECLARE DUPLICATE-SCAN-CSR CURSOR FOR                   07420026
077800         SELECT A.OPER_UNT_ID                                     07430026
077900              , A.CRE_USR_ID                                      07440026
078000              , A.CRE_TMST                                        07450026
078100              , A.SHIPT_UNT_ID                                    07460026
078200              , A.TRIP_ID                                         07470026
078300              , C.PO_NBR                                          07480026
078400              , C.REC_SEQ_NBR                                     07490026
078500              , C.STR_DEST_NBR                                    07500026
078600              , C.OPER_UNT_ID                                     07510026
078700              , B.SHIPT_UNT_ID                                    07520026
078800              , D.UPC_NBR                                         07530026
078900              , D.SHPD_QTY                                        07540026
079000              , D.TRN_LNE_NBR                                     07550026
079100          FROM  TSHUNLO A                                         07560026
079200              , TINPKSU B                                         07570026
079300              , TPKSLIP C                                         07580026
079400              , TSHUUPC D                                         07590026
079500          WHERE A.SHIPT_UNT_ID      = :SU001-SHIPT-UNT-ID         07600026
079600            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              07610026
079700            AND B.PO_NBR            = C.PO_NBR                    07620026
079800            AND B.SEQ_NBR           = C.SEQ_NBR                   07630026
079900            AND C.VER_STAT_CDE      = :PC-A                       07640026
080000            AND B.SHIPT_UNT_ID      = D.SHIPT_UNT_ID              07650026
080100            AND A.SCN_LOC_ID        = 'RECV'                      07660026
080200            AND A.ACTV_CDE          = 'A'                         07670026
080300          ORDER BY D.TRN_LNE_NBR, D.UPC_NBR                       07680026
080400     END-EXEC.                                                    07690026
080500*                                                                 07700026
080600 PROCEDURE DIVISION.                                              07710026
080700*                                                                 07720026
080800 0000-MAINLINE-PROCESSING.                                        07730026
080900***************************************************************** 07740026
081000* THIS PARAGRAPH DRIVES THE PROGRAM.                           *  07750026
081100* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM    * 07760026
081200* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                    * 07770026
081300***************************************************************** 07780026
081400     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           07790026
081500     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   07800026
081600                                                                  07810026
081700     IF CC-PRINT-SUKRP006                                         07820026
081800         PERFORM 0100-INITIALIZATION                              07830026
081900         IF SU001-DETAIL-RECORD                                   07840026
082000             PERFORM 1000-PROCESS-EXTRACT-FILE                    07850026
082100             IF PS-ERROR-RECORD                                   07860026
082200                 PERFORM 7000-WRITE-ERROR-REPORT                  07870026
082300             END-IF                                               07880026
082400         ELSE                                                     07890026
082500             IF CC-PRINT-SUKRP002                                 07900026
082600             OR CC-PRINT-SUKRP003                                 07910026
082700             OR CC-PRINT-SUKRP004                                 07920026
082800             OR CC-PRINT-SUKRP005                                 07930026
082900                 CONTINUE                                         07940026
083000             ELSE                                                 07950026
083100                 PERFORM 7000-WRITE-ERROR-REPORT                  07960026
083200             END-IF                                               07970026
083300         END-IF                                                   07980026
083400         CLOSE EXTRACT-FILE                                       07990026
083500               SU-CARTON-NOT-RCVD-FILE                            08000026
083600     END-IF.                                                      08010026
083700                                                                  08020026
083800     GOBACK.                                                      08030026
083900*                                                                 08040026
084000*                                                                 08050026
084100 0100-INITIALIZATION.                                             08060026
084200******************************************************************08070026
084300**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               08080026
084400******************************************************************08090026
084500     ACCEPT PV-TODAYS-DATE                                        08100026
084600       FROM DATE.                                                 08110026
084700                                                                  08120026
084800     ACCEPT PV-TODAYS-TIME                                        08130026
084900       FROM TIME.                                                 08140026
085000                                                                  08150026
085100     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         08160026
085200     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             08170026
085300     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               08180026
085400     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              08190026
085500                                                                  08200026
085600     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              08210026
085700     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            08220026
085800     MOVE PC-SUKRP006            TO DP132O-PROGRAM-NAME.          08230026
085900                                                                  08240026
086000******************************************************************08250026
086100**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  08260026
086200******************************************************************08270026
086300     IF CC-PRINT-ENTIRE-TRIP                                      08280026
086400        STRING 'ENTIRE TRIP-REQUESTED BY '                        08290026
086500               CC-REQUESTOR-ID  DELIMITED BY SIZE                 08300026
086600               INTO HL1A-CC-IND-DESC                              08310026
086700     ELSE                                                         08320026
086800        STRING 'SELECTED PO''S REQUESTED BY '                     08330026
086900               CC-REQUESTOR-ID  DELIMITED BY SIZE                 08340026
087000               INTO HL1A-CC-IND-DESC.                             08350026
087100                                                                  08360026
087200     OPEN INPUT  EXTRACT-FILE                                     08370026
087300          OUTPUT SU-CARTON-NOT-RCVD-FILE.                         08380026
087400                                                                  08390026
087500     PERFORM 2200-READ-EXTRACT.                                   08400026
087600                                                                  08410026
087700     MOVE SU001-MANIFEST-NBR     TO PV-MANIFEST                   08420026
087800                                    VHTRIP-TRIP-ID.               08430026
087900                                                                  08440026
088000     SET PS-DETAIL-RECORD        TO TRUE.                         08450026
088100                                                                  08460026
088200     PERFORM 1100-SELECT-TRAILER.                                 08470026
088300*LMM                                                              08480026
088400     IF DN-VEH-NBR = -1                                           08490026
088500        MOVE SPACES                 TO HL2-TRAILER                08500026
088600     ELSE                                                         08510026
088700        MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC                   08520026
088800        MOVE PV-MANIFEST            TO HL2-TRIP-ID                08530026
088900        MOVE VHTRIP-VEH-NBR         TO HL2-TRAILER                08540026
089000        MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT           08550026
089100     END-IF.                                                      08560026
089200*                                                                 08570026
089300 1000-PROCESS-EXTRACT-FILE.                                       08580026
089400******************************************************************08590026
089500**  PERFORM THE PROCESSING FOR THE PROGRAM.                       08600026
089600******************************************************************08610026
089700     IF PS-DETAIL-RECORD                                          08620026
089800         MOVE PC-AR    TO PV-STATUS                               08630026
089900         SET PS-STATUS-NOT-FOUND TO TRUE                          08640026
090000         PERFORM 1200-SELECT-STATUS                               08650026
090100     END-IF.                                                      08660026
090200                                                                  08670026
090300     IF PS-DETAIL-RECORD                                          08680026
090400         IF PS-STATUS-FOUND                                       08690026
090500             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08700026
090600             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           08710026
090700             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           08720026
090800             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           08730026
090900             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           08740026
091000         ELSE                                                     08750026
091100             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           08760026
091200             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           08770026
091300             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           08780026
091400             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           08790026
091500         END-IF                                                   08800026
091600         MOVE PC-UG    TO PV-STATUS                               08810026
091700         SET PS-STATUS-NOT-FOUND TO TRUE                          08820026
091800         PERFORM 1200-SELECT-STATUS                               08830026
091900     END-IF.                                                      08840026
092000                                                                  08850026
092100     IF PS-DETAIL-RECORD                                          08860026
092200         IF PS-STATUS-FOUND                                       08870026
092300             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08880026
092400             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        08890026
092500             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        08900026
092600             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        08910026
092700             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        08920026
092800         ELSE                                                     08930026
092900             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        08940026
093000             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        08950026
093100             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        08960026
093200             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        08970026
093300         END-IF                                                   08980026
093400         MOVE PC-UN    TO PV-STATUS                               08990026
093500         SET PS-STATUS-NOT-FOUND TO TRUE                          09000026
093600         PERFORM 1200-SELECT-STATUS                               09010026
093700     END-IF.                                                      09020026
093800                                                                  09030026
093900     IF PS-DETAIL-RECORD                                          09040026
094000         IF PS-STATUS-FOUND                                       09050026
094100             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              09060026
094200             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          09070026
094300             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          09080026
094400             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          09090026
094500             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          09100026
094600         ELSE                                                     09110026
094700             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          09120026
094800             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          09130026
094900             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          09140026
095000             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          09150026
095100         END-IF                                                   09160026
095200         PERFORM 8000-WRITE-REPORT-HEADERS                        09170026
095300         INITIALIZE SAVE-SHIPT-UNT-ID                             09180026
095400         PERFORM 2200-READ-EXTRACT                                09190026
095500         PERFORM 2000-PROCESS-SU                                  09200026
095600     END-IF.                                                      09210026
095700                                                                  09220026
095800     IF PS-DETAIL-RECORD                                          09230026
095900         WRITE SU-CARTON-NOT-RCVD-RECORD                          09240026
096000           FROM END-OF-REPORT-LINE                                09250026
096100             AFTER ADVANCING 2 LINES                              09260026
096200     END-IF.                                                      09270026
096300*                                                                 09280026
096400 1100-SELECT-TRAILER.                                             09290026
096500     MOVE '1100-SELECT-TRAILER '                                  09300026
096600                                 TO PV-ABEND-PARAGRAPH.           09310026
096700     EXEC SQL                                                     09320026
096800       SELECT A.OWNER_SCAC_ID                                     09330026
096900             ,A.VEH_NBR                                           09340026
097000             ,B.TRIP_STATUS_CDE                                   09350026
097100       INTO  :VHTRIP-OWNER-SCAC-ID                                09360026
097200*LMM                                                              09370026
097300            ,:VHTRIP-VEH-NBR    :DN-VEH-NBR                       09380026
097400            ,:TRIPST-TRIP-STATUS-CDE                              09390026
097500       FROM   TVHTRIP A                                           09400026
097600             ,TTRIPST B                                           09410026
097700             ,TTRSTYP C                                           09420026
097800       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                09430026
097900         AND  B.TRIP_STATUS_CDE ^= 'DE'                           09440026
098000         AND  C.PRTY_CDE =                                        09450026
098100              (SELECT MAX(E.PRTY_CDE)                             09460026
098200                 FROM TTRIPST D                                   09470026
098300                     ,TTRSTYP E                                   09480026
098400                WHERE D.TRIP_ID         = A.TRIP_ID               09490026
098500                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      09500026
098600         AND  A.TRIP_ID         = B.TRIP_ID                       09510026
098700         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               09520026
098800     END-EXEC.                                                    09530026
098900                                                                  09540026
099000     EVALUATE TRUE                                                09550026
099100       WHEN SQLCODE = ZEROS                                       09560026
099200         CONTINUE                                                 09570026
099300       WHEN SQLCODE = +100                                        09580026
099400         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      09590026
099500                        VHTRIP-VEH-NBR                            09600026
099600                        TRIPST-TRIP-STATUS-CDE                    09610026
099700       WHEN SQLCODE = -904                                        09620026
099800       WHEN SQLCODE = -911                                        09630026
099900       WHEN SQLCODE = -913                                        09640026
100000         SET PS-ERROR-RECORD TO TRUE                              09650026
100100         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      09660026
100200                        VHTRIP-VEH-NBR                            09670026
100300                        TRIPST-TRIP-STATUS-CDE                    09680026
100400       WHEN OTHER                                                 09690026
100500         DISPLAY PV-ABEND-PARAGRAPH                               09700026
100600         PERFORM Z999-SQL-ERROR                                   09710026
100700     END-EVALUATE.                                                09720026
100800                                                                  09730026
100900 1200-SELECT-STATUS.                                              09740026
101000     MOVE '1200-SELECT-STATUS  '                                  09750026
101100                                 TO PV-ABEND-PARAGRAPH.           09760026
101200     EXEC SQL                                                     09770026
101300       SELECT STATUS_DTE                                          09780026
101400       INTO  :TRIPST-STATUS-DTE                                   09790026
101500       FROM   TTRIPST                                             09800026
101600       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                09810026
101700         AND  TRIP_STATUS_CDE    = :PV-STATUS                     09820026
101800     END-EXEC.                                                    09830026
101900                                                                  09840026
102000     EVALUATE TRUE                                                09850026
102100       WHEN SQLCODE = ZEROS                                       09860026
102200         SET PS-STATUS-FOUND TO TRUE                              09870026
102300       WHEN SQLCODE = +100                                        09880026
102400         SET PS-STATUS-NOT-FOUND TO TRUE                          09890026
102500       WHEN SQLCODE = -904                                        09900026
102600       WHEN SQLCODE = -911                                        09910026
102700       WHEN SQLCODE = -913                                        09920026
102800         SET PS-ERROR-RECORD TO TRUE                              09930026
102900       WHEN OTHER                                                 09940026
103000         DISPLAY PV-ABEND-PARAGRAPH                               09950026
103100         PERFORM Z999-SQL-ERROR                                   09960026
103200     END-EVALUATE.                                                09970026
103300                                                                  09980026
103400*                                                                 09990026
103500 2000-PROCESS-SU.                                                 10000026
103600******************************************************************10010026
103700*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *10020026
103800*  CARTONS NOT RECEIVED REPORT.                                  *10030026
103900******************************************************************10040026
104000     MOVE PV-MANIFEST  TO SHUNLO-TRIP-ID.                         10050026
104100     PERFORM 2300-PROCESS-CURSOR                                  10060026
104200         UNTIL PS-END-OF-EXTRACT                                  10070026
104300            OR PS-ERROR-RECORD.                                   10080026
104400                                                                  10090026
104500 2200-READ-EXTRACT.                                               10100026
104600     MOVE '2200-READ-EXTRACT   '                                  10110026
104700                                 TO PV-ABEND-PARAGRAPH.           10120026
104800     READ EXTRACT-FILE INTO SU001-EXTRACT-RECORD                  10130026
104900        AT END                                                    10140026
105000           SET PS-END-OF-EXTRACT TO TRUE.                         10150026
105100                                                                  10160026
105200     ADD  1  TO  PV-RECORD-COUNT.                                 10170026
105300                                                                  10180026
105400 2300-PROCESS-CURSOR.                                             10190026
105500                                                                  10200026
105600     IF SAVE-SHIPT-UNT-ID = SU001-SHIPT-UNT-ID                    10210026
105700         CONTINUE                                                 10220026
105800     ELSE                                                         10230026
105900         PERFORM 2500-COUNT-SHUNLO-RECS                           10240026
106000         IF PS-DETAIL-RECORD                                      10250026
106100             IF PV-DB2-COUNT > PC-1                               10260026
106200                 PERFORM 3000-PROCESS-DUPS                        10270026
106300             END-IF                                               10280026
106400             MOVE SU001-SHIPT-UNT-ID TO SAVE-SHIPT-UNT-ID         10290026
106500         END-IF                                                   10300026
106600     END-IF.                                                      10310026
106700                                                                  10320026
106800     IF PS-DETAIL-RECORD                                          10330026
106900         PERFORM 2200-READ-EXTRACT                                10340026
107000     END-IF.                                                      10350026
107100                                                                  10360026
107200 2500-COUNT-SHUNLO-RECS.                                          10370026
107300     MOVE '2500-COUNT-SHUNLO-RECS'                                10380026
107400                                 TO PV-ABEND-PARAGRAPH.           10390026
107500     MOVE ZERO TO PV-DB2-COUNT.                                   10400026
107600                                                                  10410026
107700     EXEC SQL                                                     10420026
107800         SELECT COUNT(*)                                          10430026
107900           INTO :PV-DB2-COUNT                                     10440026
108000           FROM TSHUNLO                                           10450026
108100          WHERE SHIPT_UNT_ID =:SU001-SHIPT-UNT-ID                 10460026
108200            AND SCN_LOC_ID   = 'RECV'                             10470026
108300            AND ACTV_CDE     = 'A'                                10480026
108400            AND TRIP_ID      > 0                                  10490026
108500     END-EXEC.                                                    10500026
108600     EVALUATE TRUE                                                10510026
108700       WHEN SQLCODE = ZEROS                                       10520026
108800           CONTINUE                                               10530026
108900       WHEN SQLCODE = -904                                        10540026
109000       WHEN SQLCODE = -911                                        10550026
109100       WHEN SQLCODE = -913                                        10560026
109200         SET PS-ERROR-RECORD TO TRUE                              10570026
109300       WHEN OTHER                                                 10580026
109400           DISPLAY PV-ABEND-PARAGRAPH                             10590026
109500           PERFORM Z999-SQL-ERROR                                 10600026
109600     END-EVALUATE.                                                10610026
109700*                                                                 10620026
109800 3000-PROCESS-DUPS.                                               10630026
109900     SET PS-START-OF-DUP-CSR TO TRUE.                             10640026
110000     INITIALIZE PV-SAVE-TABLE.                                    10650026
110100     MOVE +1 TO PV-IN-SUB.                                        10660026
110200     MOVE +1 TO PV-OUT-SUB.                                       10670026
110300     MOVE 0 TO PV-SAVE-UPC-NBR.                                   10680026
110400     PERFORM 3100-OPEN-CURSOR.                                    10690026
110500                                                                  10700026
110600     IF PS-DETAIL-RECORD                                          10710026
110700         PERFORM 3200-FETCH-CURSOR                                10720026
110800     END-IF.                                                      10730026
110900                                                                  10740026
111000     IF PS-DETAIL-RECORD                                          10750026
111100         SET PS-FIRST-LINE                                        10760026
111200             PS-PRINTING-FIRST-LINE TO TRUE                       10770026
111300         PERFORM 3300-PROCESS-CURSOR                              10780026
111400             UNTIL PS-END-OF-DUP-CSR                              10790026
111500                OR PS-ERROR-RECORD                                10800026
111600     END-IF.                                                      10810026
111700                                                                  10820026
111800     IF PS-DETAIL-RECORD                                          10830026
111900         PERFORM 3400-CLOSE-CURSOR                                10840026
112000     END-IF.                                                      10850026
112100                                                                  10860026
112200 3100-OPEN-CURSOR.                                                10870026
112300     MOVE '3100-OPEN-CURSOR   '                                   10880026
112400                                 TO PV-ABEND-PARAGRAPH.           10890026
112500     EXEC SQL                                                     10900026
112600         OPEN DUPLICATE-SCAN-CSR                                  10910026
112700     END-EXEC.                                                    10920026
112800     EVALUATE TRUE                                                10930026
112900       WHEN SQLCODE = ZEROS                                       10940026
113000         CONTINUE                                                 10950026
113100       WHEN SQLCODE = -904                                        10960026
113200       WHEN SQLCODE = -911                                        10970026
113300       WHEN SQLCODE = -913                                        10980026
113400         SET PS-ERROR-RECORD TO TRUE                              10990026
113500       WHEN OTHER                                                 11000026
113600         DISPLAY PV-ABEND-PARAGRAPH                               11010026
113700         PERFORM Z999-SQL-ERROR                                   11020026
113800     END-EVALUATE.                                                11030026
113900                                                                  11040026
114000 3200-FETCH-CURSOR.                                               11050026
114100     MOVE '3200-FETCH-CURSOR   '                                  11060026
114200                                 TO PV-ABEND-PARAGRAPH.           11070026
114300     EXEC SQL                                                     11080026
114400          FETCH DUPLICATE-SCAN-CSR                                11090026
114500          INTO  :SHUNLO-OPER-UNT-ID                               11100026
114600              , :SHUNLO-CRE-USR-ID                                11110026
114700              , :SHUNLO-CRE-TMST                                  11120026
114800              , :SHUNLO-SHIPT-UNT-ID                              11130026
114900              , :PV-TRIP-ID                                       11140026
115000              , :PKSLIP-PO-NBR                                    11150026
115100              , :PKSLIP-REC-SEQ-NBR                               11160026
115200              , :PKSLIP-STR-DEST-NBR                              11170026
115300              , :PKSLIP-OPER-UNT-ID                               11180026
115400              , :INPKSU-SHIPT-UNT-ID                              11190026
115500              , :SHUUPC-UPC-NBR                                   11200026
115600              , :SHUUPC-SHPD-QTY                                  11210026
115700              , :SHUUPC-TRN-LNE-NBR                               11220026
115800     END-EXEC.                                                    11230026
115900                                                                  11240026
116000     EVALUATE TRUE                                                11250026
116100       WHEN SQLCODE = ZEROS                                       11260026
116200         CONTINUE                                                 11270026
116300       WHEN SQLCODE = +100                                        11280026
116400           SET PS-END-OF-DUP-CSR TO TRUE                          11290026
116500       WHEN SQLCODE = -904                                        11300026
116600       WHEN SQLCODE = -911                                        11310026
116700       WHEN SQLCODE = -913                                        11320026
116800         SET PS-ERROR-RECORD TO TRUE                              11330026
116900       WHEN OTHER                                                 11340026
117000         DISPLAY PV-ABEND-PARAGRAPH                               11350026
117100         PERFORM Z999-SQL-ERROR                                   11360026
117200     END-EVALUATE.                                                11370026
117300                                                                  11380026
117400                                                                  11390026
117500 3300-PROCESS-CURSOR.                                             11400026
117600     IF PS-FIRST-LINE                                             11410026
117700         SET PS-NOT-FIRST-LINE TO TRUE                            11420026
117800         MOVE PC-2 TO PV-LINE-SUB                                 11430026
117900         MOVE INPKSU-SHIPT-UNT-ID      TO PV-SERIAL-SHIP-CODE     11440026
118000         MOVE PV-SERIAL-SHIP-CODE-1    TO PV-OUT-S-S-C-1          11450026
118100         MOVE PV-SERIAL-SHIP-CODE-2-8  TO PV-OUT-S-S-C-2-8        11460026
118200         MOVE PV-SERIAL-SHIP-CODE-9-17 TO PV-OUT-S-S-C-9-17       11470026
118300         MOVE PV-SERIAL-SHIP-CODE-18   TO PV-OUT-S-S-C-18         11480026
118400         MOVE PV-OUT-SERIAL-SHIP-CODE  TO DL1-SERIAL-SHIP-CODE    11490026
118500         MOVE PKSLIP-PO-NBR            TO PV-PO                   11500026
118600         MOVE PKSLIP-REC-SEQ-NBR       TO PV-RECEIVER             11510026
118700         MOVE PV-PO-RECEIVER           TO DL1-PO-RECEIVER         11520026
118800         MOVE PV-TRIP-ID         TO PV-SAVE-TRIP-ID (PV-IN-SUB)   11530026
118900         MOVE SHUNLO-OPER-UNT-ID TO PV-SAVE-OPER-UNIT (PV-IN-SUB) 11540026
119000         MOVE SHUNLO-CRE-TMST    TO PV-SAVE-CRE-TMST (PV-IN-SUB)  11550026
119100         MOVE SHUNLO-CRE-USR-ID                                   11560026
119200                             TO PV-SAVE-SCAN-USER-ID (PV-IN-SUB)  11570026
119300         ADD +1 TO PV-IN-SUB                                      11580026
119400     ELSE                                                         11590026
119500         MOVE PC-1 TO PV-LINE-SUB                                 11600026
119600         MOVE SPACES                   TO DL1-SERIAL-SHIP-CODE    11610026
119700                                          DL1-PO-RECEIVER         11620026
119800     END-IF.                                                      11630026
119900     IF PS-PRINTING-FIRST-LINE AND                                11640026
120000        PV-SAVE-UPC-NBR > 0                                       11650026
120100         SET PS-FINISHED-FIRST-LINE TO TRUE                       11660026
120200     END-IF.                                                      11670026
120300     MOVE SPACES                  TO DL1-STORE-X.                 11680026
120400     PERFORM 3700-SELECT-DEST.                                    11690026
120500     IF SQLCODE = +100                                            11700026
120600         IF PKSLIP-STR-DEST-NBR > ZERO                            11710026
120700             MOVE PKSLIP-STR-DEST-NBR    TO DL1-STORE             11720026
120800                                            PV-STR-NBR            11730026
120900         ELSE                                                     11740026
121000             MOVE PKSLIP-OPER-UNT-ID     TO DL1-STORE             11750026
121100                                            PV-STR-NBR            11760026
121200         END-IF                                                   11770026
121300     ELSE                                                         11780026
121400         IF SQLCODE = -811                                        11790026
121500             MOVE PC-MLT                 TO DL1-STORE-X           11800026
121600                                            PV-STR-NBR            11810026
121700         ELSE                                                     11820026
121800             MOVE SULBXF-DEST-OPER-UNT-ID                         11830026
121900                                         TO DL1-STORE             11840026
122000                                            PV-STR-NBR            11850026
122100         END-IF                                                   11860026
122200     END-IF.                                                      11870026
122300                                                                  11880026
122400******************************************************************11890026
122500*  REMOVED REFERENCES TUPCSKU-UPC-NBR                  WR# 21361 *11900026
122600******************************************************************11910026
122800     MOVE SHUUPC-UPC-NBR           TO PV-SAVE-UPC-NBR.            11920026
122900     MOVE SHUUPC-SHPD-QTY          TO PV-EXPTED-QTY.              11930026
123000******************************************************************11940026
123100*  CALL TO 3600-SELECT-SKU IS REPLACED WITH CALL TO    WR# 21361 *11950026
123200*  3600-CALL-XLKUT-DOMAIN-PGM.                                   *11960026
123300******************************************************************11970026
123500     PERFORM 3600-CALL-XLKUT-DOMAIN-PGM.                          11980026
123600******************************************************************11990026
123700*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *12000029
123800******************************************************************12010026
123900                                                                  12020026
124000     IF PS-DETAIL-RECORD                                          12030026
124100         MOVE DL1-SKU              TO PV-SAVE-SKU                 12040026
124200         IF PV-STR-NBR = PV-SAVE-STR-NBR                          12050026
124300             MOVE SPACES TO DL1-STORE-X                           12060026
124400             IF PV-SAVE-LNE-NBR =                                 12070026
124500                     SHUUPC-TRN-LNE-NBR                           12080026
124600                 ADD SHUUPC-SHPD-QTY     TO PV-LINE-TOTAL         12090026
124700                 MOVE SPACES             TO DL1-LINE-NBR-X        12100026
124800             ELSE                                                 12110026
124900                 MOVE SHUUPC-SHPD-QTY    TO PV-LINE-TOTAL         12120026
125000                 MOVE SHUUPC-TRN-LNE-NBR TO DL1-LINE-NBR          12130026
125100                                            PV-SAVE-LNE-NBR       12140026
125200             END-IF                                               12150026
125300         ELSE                                                     12160026
125400             MOVE PV-STR-NBR         TO PV-SAVE-STR-NBR           12170026
125500             MOVE SHUUPC-SHPD-QTY    TO PV-LINE-TOTAL             12180026
125600             MOVE SHUUPC-TRN-LNE-NBR TO DL1-LINE-NBR              12190026
125700                                        PV-SAVE-LNE-NBR           12200026
125800         END-IF                                                   12210026
125900     END-IF.                                                      12220026
126000                                                                  12230026
126100     IF PS-DETAIL-RECORD                                          12240026
126200         IF PV-SAVE-TRIP-ID (PV-OUT-SUB) > 0                      12250026
126300         OR PS-PRINTING-FIRST-LINE                                12260026
126400             MOVE PV-SAVE-TRIP-ID (PV-OUT-SUB)                    12270026
126500                                TO VHTRIP-TRIP-ID                 12280026
126600             MOVE PV-SAVE-OPER-UNIT (PV-OUT-SUB)                  12290026
126700                                TO DL1-OPER-UNIT                  12300026
126800             MOVE PV-SAVE-CRE-TMST (PV-OUT-SUB)                   12310026
126900                                TO PV-DB2-TMST                    12320026
127000             MOVE PV-SAVE-SCAN-USER-ID (PV-OUT-SUB)               12330026
127100                                TO DL1-SCAN-USER-ID               12340026
127200             ADD +1 TO PV-OUT-SUB                                 12350026
127300             PERFORM 3500-SELECT-VEHICLE                          12360026
127400*LMM                                                              12370026
127500             IF PS-DETAIL-RECORD                                  12380026
127600                 IF DN-VEH-NBR = -1                               12390026
127700                    MOVE SPACES               TO DL1-TRAILER      12400026
127800                 ELSE                                             12410026
127900                    MOVE VHTRIP-OWNER-SCAC-ID TO DL1-SCAC         12420026
128000                    MOVE VHTRIP-VEH-NBR       TO DL1-TRAILER      12430026
128100                    MOVE PV-DB2-TMST-MM       TO PV-FORMAT-DATE-MM12440026
128200                    MOVE PV-DB2-TMST-DD       TO PV-FORMAT-DATE-DD12450026
128300                    MOVE PV-DB2-TMST-YY       TO PV-FORMAT-DATE-YY12460026
128400                    MOVE PV-FORMAT-DATE       TO DL1-SCAN-DATE    12470026
128500                    MOVE PV-DB2-TMST-HH       TO PV-FORMAT-TIME-HH12480026
128600                    MOVE PV-DB2-TMST-MN       TO PV-FORMAT-TIME-MN12490026
128700                    MOVE PV-DB2-TMST-SS       TO PV-FORMAT-TIME-SS12500026
128800                    MOVE PV-FORMAT-TIME       TO DL1-SCAN-TIME    12510026
128900                 END-IF                                           12520026
129000             END-IF                                               12530026
129100         ELSE                                                     12540026
129200             MOVE SPACES           TO DL1-SCAC                    12550026
129300                                      DL1-TRAILER                 12560026
129400                                      DL1-OPER-UNIT-X             12570026
129500                                      DL1-SCAN-DATE               12580026
129600                                      DL1-SCAN-TIME               12590026
129700                                      DL1-SCAN-USER-ID            12600026
129800         END-IF                                                   12610026
129900     END-IF.                                                      12620026
130000                                                                  12630026
130100     IF PS-DETAIL-RECORD                                          12640026
130200         IF  PV-LINE-CNT > PC-60                                  12650026
130300              PERFORM 8000-WRITE-REPORT-HEADERS                   12660026
130400         END-IF                                                   12670026
130500         PERFORM 3350-FETCH-SAME-LINE                             12680026
130600            UNTIL PV-SAVE-LNE-NBR NOT = SHUUPC-TRN-LNE-NBR        12690026
130700               OR DL1-SKU NOT = PV-SAVE-SKU                       12700026
130800*              OR PV-SAVE-UPC-NBR NOT = SHUUPC-UPC-NBR            12710026
130900               OR PS-END-OF-DUP-CSR                               12720026
131000               OR PS-ERROR-RECORD                                 12730026
131100     END-IF.                                                      12740026
131200                                                                  12750026
131300     IF PS-DETAIL-RECORD                                          12760026
131400         IF PV-SAVE-LNE-NBR NOT = SHUUPC-TRN-LNE-NBR              12770026
131500         OR PS-END-OF-DUP-CSR                                     12780026
131600             MOVE PV-LINE-TOTAL TO DL1-LINE-TOTAL                 12790026
131700         ELSE                                                     12800026
131800             MOVE SPACES        TO DL1-LINE-TOTAL-X               12810026
131900             MOVE PV-SAVE-SKU   TO DL1-SKU                        12820026
132000         END-IF                                                   12830026
132100         MOVE PV-EXPTED-QTY     TO DL1-EXPTED-QTY                 12840026
132200         PERFORM 8400-WRITE-DETAIL-LINES                          12850026
132300         IF PS-END-OF-DUP-CSR                                     12860026
132400             DISPLAY 'END OF DUPLICATE CSR'                       12870026
132500             IF PV-SAVE-TRIP-ID (PV-OUT-SUB) > 0                  12880026
132600                 MOVE PC-1 TO PV-LINE-SUB                         12890026
132700                 MOVE SPACES TO DL1-SERIAL-SHIP-CODE              12900026
132800                                DL1-PO-RECEIVER                   12910026
132900                                DL1-STORE-X                       12920026
133000                                DL1-LINE-NBR-X                    12930026
133100                                DL1-SKU                           12940026
133200                                DL1-EXPTED-QTY-X                  12950026
133300                                DL1-LINE-TOTAL-X                  12960026
133400                 PERFORM                                          12970026
133500                    UNTIL PV-SAVE-TRIP-ID (PV-OUT-SUB) = 0        12980026
133600                       OR PS-ERROR-RECORD                         12990026
133700                     MOVE PV-SAVE-TRIP-ID (PV-OUT-SUB)            13000026
133800                                           TO VHTRIP-TRIP-ID      13010026
133900                     PERFORM 3500-SELECT-VEHICLE                  13020026
134000*LMM                                                              13030026
134100                     IF PS-DETAIL-RECORD                          13040026
134200                        IF DN-VEH-NBR = -1                        13050026
134300                           MOVE SPACES       TO DL1-TRAILER       13060026
134400                        ELSE                                      13070026
134500                           MOVE VHTRIP-OWNER-SCAC-ID              13080026
134600                                       TO DL1-SCAC                13090026
134700                           MOVE VHTRIP-VEH-NBR                    13100026
134800                                       TO DL1-TRAILER             13110026
134900                           MOVE PV-SAVE-OPER-UNIT (PV-OUT-SUB)    13120026
135000                                       TO DL1-OPER-UNIT           13130026
135100                           MOVE PV-SAVE-CRE-TMST (PV-OUT-SUB)     13140026
135200                                       TO PV-DB2-TMST             13150026
135300                           MOVE PV-DB2-TMST-MM                    13160026
135400                                       TO PV-FORMAT-DATE-MM       13170026
135500                           MOVE PV-DB2-TMST-DD                    13180026
135600                                       TO PV-FORMAT-DATE-DD       13190026
135700                           MOVE PV-DB2-TMST-YY                    13200026
135800                                       TO PV-FORMAT-DATE-YY       13210026
135900                           MOVE PV-FORMAT-DATE                    13220026
136000                                       TO DL1-SCAN-DATE           13230026
136100                           MOVE PV-DB2-TMST-HH                    13240026
136200                                       TO PV-FORMAT-TIME-HH       13250026
136300                           MOVE PV-DB2-TMST-MN                    13260026
136400                                       TO PV-FORMAT-TIME-MN       13270026
136500                           MOVE PV-DB2-TMST-SS                    13280026
136600                                       TO PV-FORMAT-TIME-SS       13290026
136700                           MOVE PV-FORMAT-TIME                    13300026
136800                                       TO DL1-SCAN-TIME           13310026
136900                           MOVE PV-SAVE-SCAN-USER-ID (PV-OUT-SUB) 13320026
137000                                       TO DL1-SCAN-USER-ID        13330026
137100                        END-IF                                    13340026
137200                           IF PV-LINE-CNT > PC-60                 13350026
137300                               PERFORM 8000-WRITE-REPORT-HEADERS  13360026
137400                           END-IF                                 13370026
137500                           PERFORM 8400-WRITE-DETAIL-LINES        13380026
137600                           ADD +1 TO PV-OUT-SUB                   13390026
137700                     END-IF                                       13400026
137800                 END-PERFORM                                      13410026
137900             END-IF                                               13420026
138000         END-IF                                                   13430026
138100     END-IF.                                                      13440026
138200                                                                  13450026
138300 3350-FETCH-SAME-LINE.                                            13460026
138400     PERFORM 3200-FETCH-CURSOR.                                   13470026
138500                                                                  13480026
138600     IF PS-DETAIL-RECORD                                          13490026
138700         IF NOT PS-END-OF-DUP-CSR                                 13500026
138800             IF  PS-PRINTING-FIRST-LINE                           13510026
138900             AND PV-SAVE-LNE-NBR = SHUUPC-TRN-LNE-NBR             13520026
139000             AND PV-SAVE-UPC-NBR = SHUUPC-UPC-NBR                 13530026
139100                 MOVE PV-TRIP-ID  TO PV-SAVE-TRIP-ID (PV-IN-SUB)  13540026
139200                 MOVE SHUNLO-OPER-UNT-ID                          13550026
139300                              TO PV-SAVE-OPER-UNIT (PV-IN-SUB)    13560026
139400                 MOVE SHUNLO-CRE-TMST                             13570026
139500                              TO PV-SAVE-CRE-TMST (PV-IN-SUB)     13580026
139600                 MOVE SHUNLO-CRE-USR-ID                           13590026
139700                              TO PV-SAVE-SCAN-USER-ID (PV-IN-SUB) 13600026
139800                 ADD +1 TO PV-IN-SUB                              13610026
139900             ELSE                                                 13620026
140000                 SET PS-FINISHED-FIRST-LINE TO TRUE               13630026
140100             END-IF                                               13640026
140200         END-IF                                                   13650026
140300     END-IF.                                                      13660026
140400                                                                  13670026
140500     IF PS-DETAIL-RECORD                                          13680026
140600         IF NOT PS-END-OF-DUP-CSR                                 13690026
140700             IF PV-SAVE-LNE-NBR = SHUUPC-TRN-LNE-NBR              13700026
140800                 IF PV-SAVE-UPC-NBR = SHUUPC-UPC-NBR              13710026
140900                     CONTINUE                                     13720026
141000                 ELSE                                             13730026
141100******************************************************************13740026
141200*  REMOVED REFERENCES TUPCSKU-UPC-NBR                  WR# 21361 *13750026
141300******************************************************************13760026
141500                     MOVE SHUUPC-UPC-NBR TO PV-SAVE-UPC-NBR       13770026
141600******************************************************************13780026
141700*  CALL TO 3600-SELECT-SKU IS REPLACED WITH CALL TO    WR# 21361 *13790026
141800*  3600-CALL-XLKUT-DOMAIN-PGM.                                   *13800026
141900******************************************************************13810026
142100                     PERFORM 3600-CALL-XLKUT-DOMAIN-PGM           13820026
142200******************************************************************13830026
142300*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *13840029
142400******************************************************************13850026
142500                     IF PS-DETAIL-RECORD                          13860026
142600                         IF DL1-SKU = PV-SAVE-SKU                 13870026
142700                             ADD SHUUPC-SHPD-QTY TO PV-EXPTED-QTY 13880026
142800                                                    PV-LINE-TOTAL 13890026
142900                         END-IF                                   13900026
143000                     END-IF                                       13910026
143100                 END-IF                                           13920026
143200             END-IF                                               13930026
143300         END-IF                                                   13940026
143400     END-IF.                                                      13950026
143500                                                                  13960026
143600 3400-CLOSE-CURSOR.                                               13970026
143700     MOVE '3400-CLOSE-CURSOR   '                                  13980026
143800                                 TO PV-ABEND-PARAGRAPH.           13990026
143900     EXEC SQL                                                     14000026
144000         CLOSE DUPLICATE-SCAN-CSR                                 14010026
144100     END-EXEC.                                                    14020026
144200     EVALUATE TRUE                                                14030026
144300       WHEN SQLCODE = ZEROS                                       14040026
144400         CONTINUE                                                 14050026
144500       WHEN SQLCODE = -904                                        14060026
144600       WHEN SQLCODE = -911                                        14070026
144700       WHEN SQLCODE = -913                                        14080026
144800         SET PS-ERROR-RECORD TO TRUE                              14090026
144900       WHEN OTHER                                                 14100026
145000         DISPLAY PV-ABEND-PARAGRAPH                               14110026
145100         PERFORM Z999-SQL-ERROR                                   14120026
145200     END-EVALUATE.                                                14130026
145300                                                                  14140026
145400 3500-SELECT-VEHICLE.                                             14150026
145500     MOVE '3500-SELECT-VEHICLE'                                   14160026
145600                                 TO PV-ABEND-PARAGRAPH.           14170026
145700                                                                  14180026
145800     EXEC SQL                                                     14190026
145900         SELECT OWNER_SCAC_ID                                     14200026
146000               ,VEH_NBR                                           14210026
146100           INTO :VHTRIP-OWNER-SCAC-ID                             14220026
146200*LMM                                                              14230026
146300               ,:VHTRIP-VEH-NBR    :DN-VEH-NBR                    14240026
146400           FROM TVHTRIP                                           14250026
146500          WHERE TRIP_ID   = :VHTRIP-TRIP-ID                       14260026
146600     END-EXEC.                                                    14270026
146700     EVALUATE TRUE                                                14280026
146800       WHEN SQLCODE = ZEROS                                       14290026
146900           CONTINUE                                               14300026
147000       WHEN SQLCODE = -904                                        14310026
147100       WHEN SQLCODE = -911                                        14320026
147200       WHEN SQLCODE = -913                                        14330026
147300         SET PS-ERROR-RECORD TO TRUE                              14340026
147400       WHEN OTHER                                                 14350026
147500           MOVE VHTRIP-TRIP-ID TO PV-ABEND-TRIP-ID                14360026
147600           DISPLAY 'ABEND TRIP ID IS:  ' PV-ABEND-TRIP-ID         14370026
147700           DISPLAY PV-ABEND-PARAGRAPH                             14380026
147800           PERFORM Z999-SQL-ERROR                                 14390026
147900     END-EVALUATE.                                                14400026
148000                                                                  14410026
148100                                                                  14420026
148200******************************************************************14430026
148300*  REMOVED PARAGRAPH 3000-SELECT-SKU                   WR# 21361 *14440026
148400******************************************************************14450026
151700******************************************************************14460026
151800*  ADDED NEW PARAGRAPH 3000-CALL-XLKUT-DOMAIN-PGM      WR# 21361 *14470026
151900******************************************************************14480026
152000 3600-CALL-XLKUT-DOMAIN-PGM.                                      14490026
152100     MOVE '3600-CALL-SLKUT-DOMAIN-PGM'                            14500026
152200                                 TO PV-ABEND-PARAGRAPH.           14510026
152300                                                                  14520026
152400     INITIALIZE XL001-ITEM-COMMAREA.                              14530026
152500                                                                  14540026
152600     MOVE SHUUPC-UPC-NBR       TO XL001-KEY-UPC-NBR.              14550026
152700                                                                  14560026
152800     SET XL001-BY-UPC-NBR      TO TRUE                            14570026
152900                                                                  14580026
153000     SET XL001-SELECT-UPC                                         14590026
153100         XL001-SELECT-SKU                                         14600026
153200         XL001-SELECT-VND-STYL TO TRUE.                           14610026
153300                                                                  14620026
153400     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                14630026
153500                                                                  14640026
153800     EVALUATE TRUE                                                14650026
153900       WHEN XL001-UPC-SQLCODE = ZEROS                             14660031
154000         PERFORM 3610-INTERROGATE-SKU-SQLCODE                     14670026
154100       WHEN XL001-UPC-SQLCODE = +100                              14680031
154200         MOVE PC-NO-SKU            TO DL1-SKU                     14690026
154300       WHEN XL001-UPC-SQLCODE = -904                              14700031
154400       WHEN XL001-UPC-SQLCODE = -911                              14710031
154500       WHEN XL001-UPC-SQLCODE = -913                              14720031
154600         SET PS-ERROR-RECORD TO TRUE                              14730026
154700       WHEN OTHER                                                 14740026
154800         DISPLAY PV-ABEND-PARAGRAPH                               14750026
154900         PERFORM Z999-SQL-ERROR                                   14760026
155000     END-EVALUATE.                                                14770026
155100                                                                  14780026
155200 3610-INTERROGATE-SKU-SQLCODE.                                    14790026
155300     MOVE '3610-INTERROGATE-SKU-SQLCODE'                          14800026
155400                                 TO PV-ABEND-PARAGRAPH.           14810026
155500                                                                  14820026
155800     EVALUATE TRUE                                                14830026
155900       WHEN XL001-SKU-SQLCODE = ZEROS                             14840031
158200         MOVE XL001-SKU-NBR        TO PV-SKU-NBR                  14850030
156000         PERFORM 3620-INTERROGATE-VND-SQLCODE                     14860026
158300         MOVE PV-SKU           TO DL1-SKU                         14870030
156100       WHEN XL001-SKU-SQLCODE = +100                              14880031
156200         MOVE PC-NO-SKU            TO DL1-SKU                     14890026
156300       WHEN XL001-SKU-SQLCODE = -904                              14900031
156400       WHEN XL001-SKU-SQLCODE = -911                              14910031
156500       WHEN XL001-SKU-SQLCODE = -913                              14920031
156600         SET PS-ERROR-RECORD TO TRUE                              14930026
156700       WHEN OTHER                                                 14940026
156800         DISPLAY PV-ABEND-PARAGRAPH                               14950026
156900         PERFORM Z999-SQL-ERROR                                   14960026
157000     END-EVALUATE.                                                14970026
157100                                                                  14980026
157200 3620-INTERROGATE-VND-SQLCODE.                                    14990026
157300     MOVE '3620-INTERROGATE-VND-SQLCODE'                          15000026
157400                                 TO PV-ABEND-PARAGRAPH.           15010026
157500                                                                  15020026
157800     EVALUATE TRUE                                                15030026
157900       WHEN XL001-VND-STYL-SQLCODE = ZEROS                        15040031
158000         MOVE XL001-DEPT-NBR-3CH   TO PV-SKU-DEPT                 15050026
158100         MOVE XL001-SUB-CL-NBR-2CH TO PV-SKU-CLASS                15060026
158400       WHEN XL001-VND-STYL-SQLCODE = +100                         15070031
158500         MOVE '000'                TO PV-SKU-DEPT                 15080030
158500         MOVE '00'                 TO PV-SKU-CLASS                15090030
158600       WHEN XL001-VND-STYL-SQLCODE = -904                         15100031
158700       WHEN XL001-VND-STYL-SQLCODE = -911                         15110031
158800       WHEN XL001-VND-STYL-SQLCODE = -913                         15120031
158900         SET PS-ERROR-RECORD TO TRUE                              15130026
159000       WHEN OTHER                                                 15140026
159100         DISPLAY PV-ABEND-PARAGRAPH                               15150026
159200         PERFORM Z999-SQL-ERROR                                   15160026
159300     END-EVALUATE.                                                15170026
159400                                                                  15180026
159500******************************************************************15190026
159600*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *15200029
159700******************************************************************15210026
159800 3700-SELECT-DEST.                                                15220026
159900     MOVE '3700-SELECT-DEST    '                                  15230026
160000                                 TO PV-ABEND-PARAGRAPH.           15240026
160100     EXEC SQL                                                     15250026
160200       SELECT DISTINCT                                            15260026
160300              DEST_OPER_UNT_ID                                    15270026
160400       INTO  :SULBXF-DEST-OPER-UNT-ID                             15280026
160500       FROM   TSULBXF                                             15290026
160600       WHERE  SHIPT_UNT_ID       = :INPKSU-SHIPT-UNT-ID           15300026
160700         AND  STAT_CDE           = :PC-A                          15310026
160800     END-EXEC.                                                    15320026
160900                                                                  15330026
161000     EVALUATE TRUE                                                15340026
161100       WHEN SQLCODE = ZEROS                                       15350026
161200       WHEN SQLCODE = +100                                        15360026
161300       WHEN SQLCODE = -811                                        15370026
161400         CONTINUE                                                 15380026
161500       WHEN SQLCODE = -904                                        15390026
161600       WHEN SQLCODE = -911                                        15400026
161700       WHEN SQLCODE = -913                                        15410026
161800         SET PS-ERROR-RECORD TO TRUE                              15420026
161900       WHEN OTHER                                                 15430026
162000         DISPLAY PV-ABEND-PARAGRAPH                               15440026
162100         PERFORM Z999-SQL-ERROR                                   15450026
162200     END-EVALUATE.                                                15460026
162300                                                                  15470026
162400*                                                                 15480026
162500 7000-WRITE-ERROR-REPORT.                                         15490026
162600******************************************************************15500026
162700*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *15510026
162800******************************************************************15520026
162900     PERFORM 8200-WRITE-TOP-LINE.                                 15530026
163000*                                                                 15540026
163100     WRITE SU-CARTON-NOT-RCVD-RECORD                              15550026
163200       FROM HEADING-LINE-0                                        15560026
163300         AFTER ADVANCING 1 LINE.                                  15570026
163400*                                                                 15580026
163500     WRITE SU-CARTON-NOT-RCVD-RECORD                              15590026
163600       FROM HEADING-LINE-1                                        15600026
163700         AFTER ADVANCING 1 LINE.                                  15610026
163800*                                                                 15620026
163900     WRITE SU-CARTON-NOT-RCVD-RECORD                              15630026
164000       FROM HEADING-LINE-1A                                       15640026
164100         AFTER ADVANCING 1 LINE.                                  15650026
164200*                                                                 15660026
164300     WRITE SU-CARTON-NOT-RCVD-RECORD                              15670026
164400       FROM HEADING-LINE-1B                                       15680026
164500         AFTER ADVANCING 1 LINE.                                  15690026
164600*                                                                 15700026
164700     WRITE SU-CARTON-NOT-RCVD-RECORD                              15710026
164800       FROM HEADING-LINE-2                                        15720026
164900         AFTER ADVANCING 4 LINES.                                 15730026
165000*                                                                 15740026
165100     IF SU001-DETAIL-RECORD                                       15750026
165200         WRITE SU-CARTON-NOT-RCVD-RECORD                          15760026
165300           FROM EL1-ERROR-LINE-1P                                 15770026
165400             AFTER ADVANCING 3 LINES                              15780026
165500                                                                  15790026
165600         WRITE SU-CARTON-NOT-RCVD-RECORD                          15800026
165700           FROM EL2-ERROR-LINE-2P                                 15810026
165800             AFTER ADVANCING 2 LINES                              15820026
165900     ELSE                                                         15830026
166000         WRITE SU-CARTON-NOT-RCVD-RECORD                          15840026
166100           FROM EL1-ERROR-LINE-1F                                 15850026
166200             AFTER ADVANCING 3 LINES                              15860026
166300                                                                  15870026
166400         WRITE SU-CARTON-NOT-RCVD-RECORD                          15880026
166500           FROM EL2-ERROR-LINE-2F                                 15890026
166600             AFTER ADVANCING 2 LINES                              15900026
166700     END-IF.                                                      15910026
166800*                                                                 15920026
166900     WRITE SU-CARTON-NOT-RCVD-RECORD                              15930026
167000       FROM EL3-ERROR-LINE-3                                      15940026
167100         AFTER ADVANCING 2 LINES.                                 15950026
167200*                                                                 15960026
167300     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     15970026
167400     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      15980026
167500     WRITE SU-CARTON-NOT-RCVD-RECORD                              15990026
167600       FROM EL4-ERROR-LINE-4                                      16000026
167700         AFTER ADVANCING 3 LINES.                                 16010026
167800*                                                                 16020026
167900     WRITE SU-CARTON-NOT-RCVD-RECORD                              16030026
168000       FROM EL5-ERROR-LINE-5                                      16040026
168100         AFTER ADVANCING 2 LINE.                                  16050026
168200*JPL                                                              16060026
168300     WRITE SU-CARTON-NOT-RCVD-RECORD                              16070026
168400       FROM EL5-ERROR-LINE-5B                                     16080026
168500         AFTER ADVANCING 2 LINE.                                  16090026
168600*                                                                 16100026
168700     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              16110026
168800     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              16120026
168900     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              16130026
169000     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              16140026
169100     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              16150026
169200     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              16160026
169300     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              16170026
169400*JPL                                                              16180026
169500     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              16190026
169600                                                                  16200026
169700*JPL WRITE SU-CARTON-NOT-RCVD-RECORD                              16210026
169800*JPL   FROM EL6-ERROR-LINE-6                                      16220026
169900*JPL     AFTER ADVANCING 1 LINE.                                  16230026
170000*JPL                                                              16240026
170100     WRITE SU-CARTON-NOT-RCVD-RECORD                              16250026
170200       FROM EL6-ERROR-LINE-6B                                     16260026
170300         AFTER ADVANCING 1 LINE.                                  16270026
170400*                                                                 16280026
170500     WRITE SU-CARTON-NOT-RCVD-RECORD                              16290026
170600       FROM END-OF-REPORT-LINE                                    16300026
170700         AFTER ADVANCING 6 LINES.                                 16310026
170800*                                                                 16320026
170900*                                                                 16330026
171000 8000-WRITE-REPORT-HEADERS.                                       16340026
171100******************************************************************16350026
171200*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *16360026
171300*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *16370026
171400******************************************************************16380026
171500     SET PS-NEW-HEADING TO TRUE.                                  16390026
171600     PERFORM 8200-WRITE-TOP-LINE.                                 16400026
171700*                                                                 16410026
171800     WRITE SU-CARTON-NOT-RCVD-RECORD                              16420026
171900       FROM HEADING-LINE-0                                        16430026
172000         AFTER ADVANCING 1 LINE.                                  16440026
172100*                                                                 16450026
172200     WRITE SU-CARTON-NOT-RCVD-RECORD                              16460026
172300       FROM HEADING-LINE-1                                        16470026
172400         AFTER ADVANCING 1 LINE.                                  16480026
172500*                                                                 16490026
172600     WRITE SU-CARTON-NOT-RCVD-RECORD                              16500026
172700       FROM HEADING-LINE-1A                                       16510026
172800         AFTER ADVANCING 1 LINE.                                  16520026
172900*                                                                 16530026
173000     WRITE SU-CARTON-NOT-RCVD-RECORD                              16540026
173100       FROM HEADING-LINE-1B                                       16550026
173200         AFTER ADVANCING 1 LINE.                                  16560026
173300*                                                                 16570026
173400     WRITE SU-CARTON-NOT-RCVD-RECORD                              16580026
173500       FROM HEADING-LINE-2                                        16590026
173600         AFTER ADVANCING 3 LINES.                                 16600026
173700*                                                                 16610026
173800     WRITE SU-CARTON-NOT-RCVD-RECORD                              16620026
173900       FROM HEADING-LINE-3                                        16630026
174000         AFTER ADVANCING 2 LINES.                                 16640026
174100*                                                                 16650026
174200     WRITE SU-CARTON-NOT-RCVD-RECORD                              16660026
174300       FROM HEADING-LINE-4                                        16670026
174400         AFTER ADVANCING 2 LINES.                                 16680026
174500*                                                                 16690026
174600     WRITE SU-CARTON-NOT-RCVD-RECORD                              16700026
174700       FROM HEADING-LINE-5                                        16710026
174800         AFTER ADVANCING 1 LINE.                                  16720026
174900                                                                  16730026
175000     WRITE SU-CARTON-NOT-RCVD-RECORD                              16740026
175100       FROM HEADING-LINE-6                                        16750026
175200         AFTER ADVANCING 1 LINE.                                  16760026
175300*                                                                 16770026
175400     MOVE PC-12                   TO PV-LINE-CNT.                 16780026
175500*                                                                 16790026
175600*                                                                 16800026
175700 8200-WRITE-TOP-LINE.                                             16810026
175800******************************************************************16820026
175900*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *16830026
176000*     NEEDED FOR AN ASN NUMBER.                                  *16840026
176100******************************************************************16850026
176200     ADD 1                        TO PV-PAGE-CNT.                 16860026
176300*                                                                 16870026
176400     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          16880026
176500*                                                                 16890026
176600     WRITE SU-CARTON-NOT-RCVD-RECORD                              16900026
176700       FROM DP132O-STANDRD-HEADER-132-COLS                        16910026
176800         AFTER ADVANCING PAGE.                                    16920026
176900*                                                                 16930026
177000*                                                                 16940026
177100 8400-WRITE-DETAIL-LINES.                                         16950026
177200******************************************************************16960026
177300*     WRITES THE DETAIL LINE INFORMATION.                        *16970026
177400******************************************************************16980026
177500     IF PS-NEW-HEADING                                            16990026
177600         MOVE PV-OUT-SERIAL-SHIP-CODE  TO DL1-SERIAL-SHIP-CODE    17000026
177700         MOVE PV-PO-RECEIVER           TO DL1-PO-RECEIVER         17010026
177800         SET PS-NO-HEADING    TO TRUE                             17020026
177900     END-IF.                                                      17030026
178000                                                                  17040026
178100     WRITE SU-CARTON-NOT-RCVD-RECORD                              17050026
178200       FROM DETAIL-LINE1                                          17060026
178300         AFTER ADVANCING PV-LINE-SUB LINES.                       17070026
178400*                                                                 17080026
178500     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              17090026
178600*                                                                 17100026
178700*                                                                 17110026
178800******************************************************************17120026
178900*     SQL WARNING OR ERROR PROCESSING                            *17130026
179000*                                                                *17140026
179100******************************************************************17150026
179200                                                                  17160026
179300*                                                                 17170026
179400 Z999-SQL-ERROR.                                                  17180026
179500*---------------                                                  17190026
179600                                                                  17200026
179700     MOVE SQLCODE    TO SQLCODE2.                                 17210026
179800     MOVE SQLERRD(3) TO SQLERRD3.                                 17220026
179900     DISPLAY '** ABEND **       ** = SQLERROR'.                   17230026
180000     DISPLAY '** PROGRAM        ** = SUKRP006'.                   17240026
180100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  17250026
180200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  17260026
180300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   17270026
180400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  17280026
180500     EXEC SQL                                                     17290026
180600         COMMIT                                                   17300026
180700     END-EXEC.                                                    17310026
180800     MOVE +4013 TO PV-ABEND-CODE.                                 17320026
180900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         17330026
