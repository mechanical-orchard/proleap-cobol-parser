000100 IDENTIFICATION DIVISION.                                         00010034
000200 PROGRAM-ID.     APKUT216.                                        00020034
000300 AUTHOR.         NANCY EILBES.                                    00030034
000400 DATE-WRITTEN.   03/28/2019.                                      00040034
000500 DATE-COMPILED.                                                   00050034
000600*************************************************************     00060034
000700*    COBOL 2                                                *     00070034
000800*  READ IN AP TRANSACTION FILE AND INITIALIZE THE COOP, ALW *     00080034
000900*  AND MSC DISCOUNT PERCENT AND AMOUNT FIELDS.              *     00090034
001100*                                                           *     00110034
001200* INPUT:                                                    *     00120034
001300*  1. AP TRANSACTIONS, COPYBOOK APRD040                     *     00130034
001400*                                                           *     00140034
001500* OUTPUT:                                                   *     00150034
001600*  1. AP TRANSACTIONS, COPYBOOK APRD040                     *     00160034
001700*                                                           *     00170034
001800*-----------------------------------------------------------*     00180035
001810* CHANGES:                                                  *     00181035
001811*  DATE  03/28/2019                                         *     00181135
001812*      CHANGE MADE: ERP PROJECT.  INITIAL VERSION.          *     00181235
001813*      MADE BY: NANCY EILBES            WR/IR #: CHG        *     00181335
001814*                                                           *     00181435
001820*************************************************************     00182035
001900   EJECT                                                          00190034
002000 ENVIRONMENT DIVISION.                                            00200034
002100 CONFIGURATION SECTION.                                           00210034
002200 SOURCE-COMPUTER.    IBM-3090.                                    00220034
002300 OBJECT-COMPUTER.    IBM-3090.                                    00230034
002400                                                                  00240034
002500 INPUT-OUTPUT SECTION.                                            00250034
002600 FILE-CONTROL.                                                    00260034
002700     SELECT AP-TRANS-INPUT-FILE    ASSIGN TO INP01.               00270034
002800     SELECT AP-TRANS-OUTPUT-FILE   ASSIGN TO OUT01.               00280034
002900 EJECT                                                            00290034
003000 DATA DIVISION.                                                   00300034
003100 FILE SECTION.                                                    00310034
003200                                                                  00320034
003300 FD  AP-TRANS-INPUT-FILE                                          00330034
003400     RECORDING MODE IS F                                          00340034
003500     LABEL RECORDS ARE STANDARD                                   00350034
003600     BLOCK CONTAINS 0 RECORDS                                     00360034
003700     RECORD CONTAINS 500 CHARACTERS                               00370034
003800     DATA RECORD IS AP-TRANS-INPUT-RECORD.                        00380034
003900 01  AP-TRANS-INPUT-RECORD.                                       00390034
004000     05 FILLER                        PIC  X(500).                00400034
004100                                                                  00410034
004200 FD  AP-TRANS-OUTPUT-FILE                                         00420034
004300     RECORDING MODE IS F                                          00430034
004400     LABEL RECORDS ARE STANDARD                                   00440034
004500     BLOCK CONTAINS 0 RECORDS                                     00450034
004600     RECORD CONTAINS 500 CHARACTERS                               00460034
004700     DATA RECORD IS AP-TRANS-OUTPUT-RECORD.                       00470034
004800 01  AP-TRANS-OUTPUT-RECORD.                                      00480034
004900     05 FILLER                        PIC  X(500).                00490034
005000                                                                  00500034
005100                                                                  00510034
005200 EJECT                                                            00520034
005300 WORKING-STORAGE SECTION.                                         00530034
005400                                                                  00540034
006400                                                                  00640034
006500 01  PV-PROGRAM-VARIABLES.                                        00650034
006600     05  FILLER                  PIC  X(30)  VALUE                00660034
006700         '** BEGINING OF APKUT216 W/S **'.                        00670034
006800     05  PV-PROGRAM-NAME         PIC  X(08)  VALUE 'APKUT216'.    00680034
006900     05  PV-READ-COUNT           PIC  9(07)  VALUE ZEROS.         00690034
007500     05  PV-WRITTEN-COUNT        PIC  9(07)  VALUE ZEROS.         00750034
007600     05  PV-TOTAL-NET-COST       PIC S9(16)V99 VALUE ZEROS        00760034
007700                                             COMP-3.              00770034
007800     05  PV-BEG-NET-COST         PIC S9(16)V99 VALUE ZEROS        00780034
007900                                             COMP-3.              00790034
008000     05  PV-END-NET-COST         PIC S9(16)V99 VALUE ZEROS        00800034
008100                                             COMP-3.              00810034
008200     05  DL-BEG-NET-COST         PIC ------------.99 VALUE ZEROS. 00820034
008300     05  DL-END-NET-COST         PIC ------------.99 VALUE ZEROS. 00830034
008800                                                                  00880034
009900 01  PS-PROGRAM-SWITCHES.                                         00990034
010000     05  PS-END-OF-TRANS-SW          PIC X(01) VALUE 'N'.         01000034
010100         88  END-OF-TRANS                      VALUE 'Y'.         01010034
010200         88  MORE-TRANS                        VALUE 'N'.         01020034
010600                                                                  01060034
010700 EJECT                                                            01070034
010800*----------------------------------------------------------------*01080034
010900*  AP TRANSACTIONS FILE LAYOUT  (INPUT AND OUTPUT)               *01090034
011000*----------------------------------------------------------------*01100034
011100     COPY APRD040.                                                01110034
011200                                                                  01120034
011300 EJECT                                                            01130034
011400                                                                  01140034
011500 01  FILLER                      PIC  X(25)  VALUE                01150034
011600     '** END OF APKUT216 W/S **'.                                 01160034
011700 EJECT                                                            01170034
011800 PROCEDURE DIVISION.                                              01180034
011900 A100-MAIN.                                                       01190034
012000                                                                  01200034
012100     PERFORM B100-INITIALIZE.                                     01210034
012200                                                                  01220034
012300     PERFORM B200-PROCESS-INPUT-TRANS                             01230034
012400         UNTIL END-OF-TRANS.                                      01240034
012500                                                                  01250034
012600     PERFORM B300-END-PROGRAM.                                    01260034
012700                                                                  01270034
012800     GOBACK.                                                      01280034
012900 EJECT                                                            01290034
013000*----------------------------------------------------------------*01300034
013100*    INITIALIZATION PROCESSING                                   *01310034
013200*----------------------------------------------------------------*01320034
013300 B100-INITIALIZE.                                                 01330034
013400                                                                  01340034
013500     DISPLAY '**------  APKUT216  (PROCESSING MSGS)  ------**'.   01350034
013600                                                                  01360034
013700     OPEN INPUT  AP-TRANS-INPUT-FILE                              01370034
013800          OUTPUT AP-TRANS-OUTPUT-FILE.                            01380034
013900                                                                  01390034
014000     INITIALIZE AP040-TRANSACTION-FILE.                           01400034
014100                                                                  01410034
014200     PERFORM R100-READ-INPUT-TRANS.                               01420034
014300                                                                  01430034
014400     IF END-OF-TRANS                                              01440034
014500         DISPLAY 'AP INPUT TRANSACTION FILE IS EMPTY'             01450034
014600     END-IF.                                                      01460034
014700                                                                  01470034
014800                                                                  01480034
014900 EJECT                                                            01490034
015000*----------------------------------------------------------------*01500034
015100*    PROCESSES THE INPUT FILE AND DETERMINES WHETHER THERE ARE   *01510034
015200*    DISCOUNT COMMENTS IN THE REASON TEXT FIELD.  WHEN DISCOUNTS *01520034
015300*    ARE FOUND, THEY ARE MOVED TO THE APPROPRIATE DISCOUNT FIELD *01530034
015400*    AND SUBTRACTED FROM THE TERMS DISCOUNT.                     *01540034
015500*----------------------------------------------------------------*01550034
015600 B200-PROCESS-INPUT-TRANS.                                        01560034
015700                                                                  01570034
015800     INITIALIZE AP040-COOP-DISC-PCT                               01580034
016000                AP040-ALW-DISC-PCT                                01600034
016100                AP040-MSC-DISC-PCT                                01610034
016200                AP040-COOP-DISC-AMT                               01620034
016300                AP040-ALW-DISC-AMT                                01630034
016400                AP040-MSC-DISC-AMT.                               01640034
016600                                                                  01660034
026800     PERFORM W100-WRITE-TRANS-OUTPUT-REC.                         02680034
026900                                                                  02690034
027000     PERFORM R100-READ-INPUT-TRANS.                               02700034
027100                                                                  02710034
027200 EJECT                                                            02720034
027300*----------------------------------------------------------------*02730034
027400*    ENDING PROCESSING: WRITES OUT LAST INVOICE, DISPLAYS COUNT, *02740034
027500*    AND CLOSES FILES.                                           *02750034
027600*----------------------------------------------------------------*02760034
027700 B300-END-PROGRAM.                                                02770034
027800                                                                  02780034
027900     CLOSE AP-TRANS-INPUT-FILE                                    02790034
028000           AP-TRANS-OUTPUT-FILE.                                  02800034
028100                                                                  02810034
028200     MOVE PV-BEG-NET-COST TO DL-BEG-NET-COST.                     02820034
028300     MOVE PV-END-NET-COST TO DL-END-NET-COST.                     02830034
028400                                                                  02840034
028500     DISPLAY '**************************************************' 02850034
028600     DISPLAY 'PROGRAM NAME                = ' PV-PROGRAM-NAME.    02860034
028700     DISPLAY 'TRANS RECORDS READ          = ' PV-READ-COUNT.      02870034
028800     DISPLAY 'TOTAL INPUT NET COST        = ' DL-BEG-NET-COST.    02880034
028900     DISPLAY 'TOTAL OUTPUT NET COST       = ' DL-END-NET-COST.    02890034
029200     DISPLAY 'EXTRACT RECORDS WRITTEN     = ' PV-WRITTEN-COUNT.   02920034
029300     DISPLAY '**************************************************'.02930034
029400                                                                  02940034
029700 EJECT                                                            02970034
029800*----------------------------------------------------------------*02980034
029900*  READS A RECORD FROM THE AP TRANSACTION FILE                   *02990034
030000*----------------------------------------------------------------*03000034
030100 R100-READ-INPUT-TRANS.                                           03010034
030200                                                                  03020034
030300     READ AP-TRANS-INPUT-FILE INTO AP040-TRANSACTION-FILE         03030034
030400         AT END SET END-OF-TRANS TO TRUE.                         03040034
030500                                                                  03050034
030600     IF MORE-TRANS                                                03060034
030700         ADD AP040-NET-COST-AMT TO PV-BEG-NET-COST                03070034
030800         ADD +1 TO PV-READ-COUNT                                  03080034
030900     END-IF.                                                      03090034
031000                                                                  03100034
031100 EJECT                                                            03110034
031200*---------------------------------------------------------------- 03120034
031300*    WRITES OUT THE AP-TRANS-OUTPUT-RECORD.                       03130034
031400*---------------------------------------------------------------- 03140034
031500 W100-WRITE-TRANS-OUTPUT-REC.                                     03150034
031600                                                                  03160034
031700     ADD AP040-NET-COST-AMT TO PV-END-NET-COST.                   03170034
031800     ADD 1 TO PV-WRITTEN-COUNT.                                   03180034
031900                                                                  03190034
032000     WRITE AP-TRANS-OUTPUT-RECORD FROM AP040-TRANSACTION-FILE.    03200034
032100                                                                  03210034
032200 EJECT                                                            03220034
