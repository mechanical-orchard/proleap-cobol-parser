000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500******************************************************************00050007
000600******************************************************************00060007
000700***  NEED TO COMPLETE:                                         ***00070007
000800***    ==> BOL AND PRO ON REF SEGMENTS                         ***00080007
000900******************************************************************00090007
001000******************************************************************00100007
001100                                                                  00110007
001200 PROGRAM-ID.    SNKUT911.                                         00120000
001300 AUTHOR.        RON KRIER                                         00130000
001400 INSTALLATION.  KOHLS.                                            00140000
001500 DATE-WRITTEN   FEBRUARY, 2014.                                   00150000
001600 DATE-COMPILED.                                                   00160000
001700                                                                  00170000
001800******************************************************************00180000
001900*  THIS PROGRAM IS USED TO HELP BUILD TEST ASN DATA FROM THE      00190000
002000*  PO'S BEING REQUESTED ON THE INPUT FILE.                        00200000
002100*  THE INPUT INTO THIS PROGRAM WILL BE FROM A FILE OUT OF         00210001
002200*  SNKUT910.  THE FILE WILL GIVE US THE DC, TRAILER AND PO        00220001
002300*  INFORMATION THAT CAN BE USED TO GENERATE THE ASN DATA TO A     00230001
002400*  FILE THAT COULD BE USED TO DROP INTO THE ASN REPOSITORY        00240001
002500*  TABLES.                                                        00250001
002600*                                                                 00260013
002700*  THIS PROGRAM WILL ONLY GENERATE THE SHIPMENT LEVEL ASN DATA    00270013
002800*  BASED ON THE INPUT FILE.  THE SAME INPUT FILE WILL BE FED      00280013
002900*  INTO SNKUT912 TO CREATE THE ORDER LEVEL DATA FOR THE ASN'S.    00290013
003000*                                                                 00300013
003100*  THE OUTPUT FILES FROM THIS PROGRAM AND SNKUT912 WILL THEN      00310013
003200*  BE SORTED TOGETHER AND PULLED INTO ANOTHER PROGRAM TO LOAD     00320013
003300*  UP THE REPOSITORY TABLES.                                      00330013
003400*                                                                 00340013
003500*  THIS PROGRAM WILL GENERATE THE FOLLOWING ASN SEGMENTS RELATED  00350013
003600*  TO SHIPMENT INFO:                                              00360013
003700*   'ID ', 'HL ',  'TD5', 'TD3', 'REF', 'DTM' AND 'N1 '           00370013
003800*                                                                 00380013
003900******************************************************************00390000
004000******************************************************************00400000
004100 ENVIRONMENT DIVISION.                                            00410000
004200******************************************************************00420000
004300                                                                  00430000
004400 CONFIGURATION SECTION.                                           00440000
004500                                                                  00450000
004600 SOURCE-COMPUTER.        IBM-3090.                                00460000
004700 OBJECT-COMPUTER.        IBM-3090.                                00470000
004800                                                                  00480000
004900 INPUT-OUTPUT SECTION.                                            00490000
005000                                                                  00500000
005100 FILE-CONTROL.                                                    00510000
005200                                                                  00520000
005300                                                                  00530000
005400     SELECT INPUT-FILE                                            00540000
005500         ASSIGN TO INP01.                                         00550000
005600                                                                  00560000
005700     SELECT OUTPUT-FILE                                           00570000
005800         ASSIGN TO OUT01.                                         00580000
005900******************************************************************00590000
006000 DATA DIVISION.                                                   00600000
006100******************************************************************00610000
006200                                                                  00620000
006300 FILE SECTION.                                                    00630000
006400                                                                  00640000
006500 FD  INPUT-FILE                                                   00650000
006600     RECORDING MODE IS F                                          00660000
006700     LABEL RECORDS ARE STANDARD                                   00670000
006800     BLOCK CONTAINS 0 RECORDS.                                    00680000
006900                                                                  00690000
007000 01  INPUT-RECORD                     PIC   X(80).                00700000
007100                                                                  00710000
007200 FD  OUTPUT-FILE                                                  00720000
007300     RECORDING MODE IS F                                          00730000
007400     LABEL RECORDS ARE STANDARD                                   00740000
007500     RECORD CONTAINS 400                                          00750007
007600     BLOCK CONTAINS 0 RECORDS                                     00760000
007700     DATA RECORD IS OUTPUT-RECORD.                                00770000
007800                                                                  00780000
007900 01  OUTPUT-RECORD                    PIC   X(400).               00790007
008000*                                                                 00800000
008100******************************************************************00810000
008200 WORKING-STORAGE SECTION.                                         00820000
008300******************************************************************00830000
008400*                                                                 00840000
008500 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00850000
008600                                                   COMP SYNC.     00860000
008700                                                                  00870000
008800 01  PS-PROGRAM-SWITCHES.                                         00880000
008900     05  PS-EOF-INPUT-SW             PIC  X(01)    VALUE 'N'.     00890000
009000         88  PS-EOF-INPUT                          VALUE 'Y'.     00900000
009100         88  PS-MORE-INPUT                         VALUE 'N'.     00910000
009200     05  PS-PRINT-INFO-SW            PIC  X(01)    VALUE 'N'.     00920000
009300         88  PS-PRINT-INFO                         VALUE 'Y'.     00930000
009400         88  PS-NOT-PRINT-INFO                     VALUE 'N'.     00940000
009500     05  PS-INBOUND-LINE-SW          PIC  X(01)    VALUE 'N'.     00950000
009600         88  PS-INBOUND-LINE-FOUND                 VALUE 'Y'.     00960000
009700         88  PS-INBOUND-LINE-NOT-FOUND             VALUE 'N'.     00970000
009800     05  PS-EOF-CURSOR-SW            PIC  X(01)    VALUE 'N'.     00980006
009900         88  PS-EOF-CURSOR                         VALUE 'Y'.     00990006
010000         88  PS-NOT-EOF-CURSOR                     VALUE 'N'.     01000006
010100                                                                  01010000
010200 01  PC-PROGRAM-CONSTANTS.                                        01020000
010300     05  PC-RANDOM-PGM               PIC  X(08)    VALUE          01030003
010400         'DPKUT902'.                                              01040003
010500     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01050000
010600                                                   COMP SYNC.     01060000
010700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01070000
010800         'SNKUT911'.                                              01080000
010900     05  PC-CURRENT-OPERATING-COMPANY                             01090000
011000                                     PIC  X(02)    VALUE '03'.    01100000
011100     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01110000
011200                                                   COMP SYNC.     01120000
011300     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  01130000
011400                                                                  01140000
011500 01  PV-PROGRAM-VARIABLES.                                        01150000
011600     05  PV-PREV-DC-NBR              PIC  9(04)    VALUE ZERO.    01160001
011700     05  PV-PREV-TRAILER-NBR         PIC  9(08)    VALUE ZERO.    01170001
011800     05  PV-PREV-STRUCTURE-CDE       PIC  X(04)    VALUE SPACES.  01180020
011900     05  PV-PREV-ENT-ID              PIC  9(09)    VALUE ZERO.    01190020
012000     05  PV-PREV-BOL-DC-NBR          PIC  9(04)    VALUE ZERO.    01200024
012100     05  PV-PREV-BOL-TRAILER-NBR     PIC  9(08)    VALUE ZERO.    01210024
012110     05  PV-PREV-PRO-DC-NBR          PIC  9(04)    VALUE ZERO.    01211024
012120     05  PV-PREV-PRO-TRAILER-NBR     PIC  9(08)    VALUE ZERO.    01212024
012200     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    01220000
012300     05  PV-NUM-FIELD                PIC  9(06)    VALUE ZERO.    01230000
012400     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  01240000
012500     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01250000
012600     05  PV-ABEND-MESSAGE            PIC  X(30)    VALUE SPACE.   01260003
012700     05  PV-CARTON-SHIP-QTY          PIC S9(09)    VALUE ZERO     01270006
012800                                                   COMP SYNC.     01280006
012900     05  PV-CARTON-QTY               PIC S9(09)    VALUE ZERO     01290007
013000                                                   COMP SYNC.     01300007
013100     05  PV-INPUT-COUNTER            PIC S9(09)    VALUE ZERO     01310000
013200                                                   COMP SYNC.     01320000
013300     05  PV-INPUT-DISPLAY-COUNTER    PIC S9(09)    VALUE ZERO     01330000
013400                                                   COMP SYNC.     01340000
013500     05  PV-OUTPUT-COUNTER           PIC S9(09)    VALUE ZERO     01350000
013600                                                   COMP SYNC.     01360000
013700     05  PV-MULT-PKITEM-COUNTER      PIC S9(09)    VALUE ZERO     01370000
013800                                                   COMP SYNC.     01380000
013900     05  PV-NO-PKITEM-COUNTER        PIC S9(09)    VALUE ZERO     01390000
014000                                                   COMP SYNC.     01400000
014100     05  PV-YES-PKITEM-COUNTER       PIC S9(09)    VALUE ZERO     01410000
014200                                                   COMP SYNC.     01420000
014300     05  PV-NO-MATCH-INBOUND-COUNTER PIC S9(09)    VALUE ZERO     01430000
014400                                                   COMP SYNC.     01440000
014500     05  PV-MATCH-INBOUND-COUNTER    PIC S9(09)    VALUE ZERO     01450000
014600                                                   COMP SYNC.     01460000
014700     05  PV-YES-INBOUND-COUNTER      PIC S9(09)    VALUE ZERO     01470000
014800                                                   COMP SYNC.     01480000
014900     05  PV-NO-INBOUND-COUNTER       PIC S9(09)    VALUE ZERO     01490000
015000                                                   COMP SYNC.     01500000
015100     05  PV-MULT-INBOUND-COUNTER     PIC S9(09)    VALUE ZERO     01510000
015200                                                   COMP SYNC.     01520000
015300     05  PV-MATCH-COUNTER            PIC S9(09)    VALUE ZERO     01530000
015400                                                   COMP SYNC.     01540000
015500     05  PV-MISMATCH-COUNTER         PIC S9(09)    VALUE ZERO     01550000
015600                                                   COMP SYNC.     01560000
015700     05  PV-MULT-DATA-COUNTER        PIC S9(09)    VALUE ZERO     01570000
015800                                                   COMP SYNC.     01580000
015900     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             01590000
016000                                                                  01600000
016100     05  PV-TEMP-FIELD               PIC S9(09)    VALUE ZERO     01610000
016200                                                   COMP SYNC.     01620000
016300     05  PV-IO-TOT-PKSLP-ITM-QTY     PIC S9(09)    VALUE ZERO     01630000
016400                                                   COMP SYNC.     01640000
016500     05  PV-IO-TOT-NBR-OF-CRTNS      PIC S9(09)    VALUE ZERO     01650000
016600                                                   COMP SYNC.     01660000
016700     05  PV-IO-TOT-CRSDCK-CRTN-QTY   PIC S9(09)    VALUE ZERO     01670000
016800                                                   COMP SYNC.     01680000
016900     05  PV-IO-TOT-P2L-CRTN-QTY      PIC S9(09)    VALUE ZERO     01690000
017000                                                   COMP SYNC.     01700000
017100     05  PV-IO-TOT-HRTW-CRTN-QTY     PIC S9(09)    VALUE ZERO     01710000
017200                                                   COMP SYNC.     01720000
017300     05  PV-IO-TOT-JWLRY-CRTN-QTY    PIC S9(09)    VALUE ZERO     01730000
017400                                                   COMP SYNC.     01740000
017500     05  PV-IO-TOT-CRSDCK-UNIT-QTY   PIC S9(09)    VALUE ZERO     01750000
017600                                                   COMP SYNC.     01760000
017700     05  PV-IO-TOT-P2L-UNIT-QTY      PIC S9(09)    VALUE ZERO     01770000
017800                                                   COMP SYNC.     01780000
017900     05  PV-IO-TOT-HRTW-UNIT-QTY     PIC S9(09)    VALUE ZERO     01790000
018000                                                   COMP SYNC.     01800000
018100     05  PV-IO-TOT-JWLRY-UNIT-QTY    PIC S9(09)    VALUE ZERO     01810000
018200                                                   COMP SYNC.     01820000
018300                                                                  01830000
018400     05  PV-IN-TOT-PKSLP-ITM-QTY     PIC S9(09)    VALUE ZERO     01840000
018500                                                   COMP SYNC.     01850000
018600     05  PV-IN-TOT-NBR-OF-CRTNS      PIC S9(09)    VALUE ZERO     01860000
018700                                                   COMP SYNC.     01870000
018800     05  PV-IN-TOT-CRSDCK-CRTN-QTY   PIC S9(09)    VALUE ZERO     01880000
018900                                                   COMP SYNC.     01890000
019000     05  PV-IN-TOT-P2L-CRTN-QTY      PIC S9(09)    VALUE ZERO     01900000
019100                                                   COMP SYNC.     01910000
019200     05  PV-IN-TOT-HRTW-CRTN-QTY     PIC S9(09)    VALUE ZERO     01920000
019300                                                   COMP SYNC.     01930000
019400     05  PV-IN-TOT-JWLRY-CRTN-QTY    PIC S9(09)    VALUE ZERO     01940000
019500                                                   COMP SYNC.     01950000
019600     05  PV-IN-TOT-CRSDCK-UNIT-QTY   PIC S9(09)    VALUE ZERO     01960000
019700                                                   COMP SYNC.     01970000
019800     05  PV-IN-TOT-P2L-UNIT-QTY      PIC S9(09)    VALUE ZERO     01980000
019900                                                   COMP SYNC.     01990000
020000     05  PV-IN-TOT-HRTW-UNIT-QTY     PIC S9(09)    VALUE ZERO     02000000
020100                                                   COMP SYNC.     02010000
020200     05  PV-IN-TOT-JWLRY-UNIT-QTY    PIC S9(09)    VALUE ZERO     02020000
020300                                                   COMP SYNC.     02030000
020400     05  PV-SHPD-QTY                 PIC  9(07)    VALUE ZEROS.   02040000
020500                                                                  02050000
020600     05  PV-PKSL-ITM-QTY             PIC  9(07)    VALUE ZEROS.   02060000
020700                                                                  02070000
020800     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     02080000
020900                                                   COMP-3.        02090000
021000     05  PV-ALLPLN-CURR-SPLIT-QTY    PIC S9(09)    VALUE ZERO     02100006
021100                                                   COMP SYNC.     02110006
021200     05  PV-TOTAL-CARTON-QTY         PIC S9(09)    VALUE ZERO     02120006
021300                                                   COMP SYNC.     02130006
021400     05  PV-TOTAL-CARTON-SHIP-QTY    PIC S9(09)    VALUE ZERO     02140007
021500                                                   COMP SYNC.     02150007
021600     05  PV-TOTAL-CARTON-SHIP-LBS    PIC S9(09)    VALUE ZERO     02160007
021700                                                   COMP SYNC.     02170007
021800     05  PV-PERCENT-OF-PO-UNITS      PIC S9(01)V99 VALUE ZERO     02180006
021900                                                   COMP-3.        02190006
022000                                                                  02200006
022100     05  PV-RANDOM-NBR                PIC 9(09)     VALUE ZERO.   02210009
022200     05  PV-DISPLAY-OPER              PIC 9(04)     VALUE ZERO.   02220000
022300     05  PV-DISPLAY-PO                PIC 9(09)     VALUE ZERO.   02230000
022400     05  PV-DISPLAY-ENT-ID            PIC 9(09)     VALUE ZERO.   02240004
022500     05  PV-DISPLAY-SEQ-NBR           PIC 9(09)     VALUE ZERO.   02250000
022600     05  PV-DISPLAY-ITEM-NBR          PIC 9(18)     VALUE ZERO.   02260000
022700     05  PV-DISPLAY-SKU-NBR           PIC 9(08)     VALUE ZERO.   02270000
022800     05  PV-DISPLAY-ERROR-NBR         PIC 9(02)     VALUE ZERO.   02280000
022900     05  PV-DISPLAY-LOC-NBR           PIC 9(04)     VALUE ZERO.   02290000
023000     05  PV-DISPLAY-OPER-UNT          PIC 9(04)     VALUE ZERO.   02300000
023100     05  PV-DISPLAY-FIELD             PIC ZZZZZZZZ9 VALUE ZERO.   02310000
023200     05  PV-DISPLAY-FIELD-2           PIC ZZZZZZZZ9 VALUE ZERO.   02320000
023300     05  PV-DISPLAY-FIELD-3           PIC ZZZZZZZZ9 VALUE ZERO.   02330000
023310                                                                  02331024
023320     05  PV-NANO-SECOND.                                          02332024
023330         10  PV-NANO-SECOND-1-2       PIC  X(02).                 02333024
023340         10  PV-NANO-SECOND-3-4       PIC  X(02).                 02334024
023350         10  PV-NANO-SECOND-5-6       PIC  X(02).                 02335024
023400                                                                  02340002
023500     05  PV-BOL.                                                  02350015
023600         10  FILLER                   PIC  X(02)   VALUE 'BL'.    02360024
023700         10  PV-BOL-YY                PIC  X(02).                 02370015
023800         10  PV-BOL-MM                PIC  X(02).                 02380015
023900         10  PV-BOL-DD                PIC  X(02).                 02390015
024000         10  PV-BOL-HH                PIC  X(02).                 02400015
024100         10  PV-BOL-MIN               PIC  X(02).                 02410015
024200         10  PV-BOL-SS                PIC  X(02).                 02420015
024300         10  PV-BOL-NN                PIC  X(02).                 02430024
024400         10  FILLER                   PIC  X(14)   VALUE SPACES.  02440015
024500                                                                  02450015
024600     05  PV-PRO.                                                  02460015
024700         10  FILLER                   PIC  X(02)   VALUE 'PR'.    02470024
024800         10  PV-PRO-YY                PIC  X(02).                 02480015
024900         10  PV-PRO-MM                PIC  X(02).                 02490015
025000         10  PV-PRO-DD                PIC  X(02).                 02500015
025100         10  PV-PRO-HH                PIC  X(02).                 02510015
025200         10  PV-PRO-MIN               PIC  X(02).                 02520015
025300         10  PV-PRO-SS                PIC  X(02).                 02530015
025400         10  PV-PRO-NN                PIC  X(02).                 02540024
025500         10  FILLER                   PIC  X(14)   VALUE SPACES.  02550015
025600                                                                  02560015
025700     05  PV-SHIPMENT-ID.                                          02570015
025800         10  PV-SCAC                  PIC  X(04).                 02580002
025900         10  PV-DC-NBR                PIC  9(04).                 02590002
026000         10  PV-NSEC                  PIC  X(06).                 02600002
026100         10  PV-SEC                   PIC  X(02).                 02610002
026200         10  PV-MIN                   PIC  X(02).                 02620002
026300         10  PV-HRS                   PIC  X(02).                 02630002
026400         10  PV-DD                    PIC  X(02).                 02640002
026500     05  PV-SHIP-TO-DC.                                           02650007
026600         10  PV-SHIP-TO-DC-NBR        PIC  9(04).                 02660007
026700         10  PV-SHIP-TO-DC-FILLER     PIC  X(13).                 02670007
026800                                                                  02680002
026900     05  PV-CURRENT-TIMESTAMP         PIC  X(26).                 02690002
027000     05  PV-CURR-TMST.                                            02700002
027100         10  PV-CURR-TMST-CC          PIC  X(02).                 02710002
027200         10  PV-CURR-TMST-YY          PIC  X(02).                 02720002
027300         10  FILLER                   PIC  X(01).                 02730002
027400         10  PV-CURR-TMST-MM          PIC  X(02).                 02740002
027500         10  FILLER                   PIC  X(01).                 02750002
027600         10  PV-CURR-TMST-DD          PIC  X(02).                 02760002
027700         10  FILLER                   PIC  X(01).                 02770002
027800         10  PV-CURR-TMST-HRS         PIC  X(02).                 02780002
027900         10  FILLER                   PIC  X(01).                 02790002
028000         10  PV-CURR-TMST-MIN         PIC  X(02).                 02800002
028100         10  FILLER                   PIC  X(01).                 02810002
028200         10  PV-CURR-TMST-SEC         PIC  X(02).                 02820002
028300         10  FILLER                   PIC  X(01).                 02830002
028400         10  PV-CURR-TMST-NSEC        PIC  X(06).                 02840002
028500                                                                  02850002
028600     05  PV-ASN-CRE-DATE.                                         02860002
028700         10  PV-ASN-CRE-DATE-YY       PIC  X(02).                 02870002
028800         10  PV-ASN-CRE-DATE-MM       PIC  X(02).                 02880002
028900         10  PV-ASN-CRE-DATE-DD       PIC  X(02).                 02890002
029000                                                                  02900002
029100     05  PV-ASN-CRE-TIME.                                         02910002
029200         10  PV-ASN-CRE-TIME-HH       PIC  X(02).                 02920002
029300         10  PV-ASN-CRE-TIME-MM       PIC  X(02).                 02930002
029400                                                                  02940002
029500 01  PV-ABEND-FIELDS.                                             02950000
029600     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         02960000
029700                                                 COMP SYNC.       02970000
029800     05  PV-SQLCODE                   PIC  Z(08)9-.               02980000
029900     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02990000
030000     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    03000000
030100     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    03010000
030200     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    03020000
030300     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    03030000
030400     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    03040000
030500     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    03050000
030600     05  PV-DB2-TABLE-NAME-1          PIC  X(15) VALUE SPACE.     03060000
030700     05  PV-DB2-TABLE-NAME-2          PIC  X(15) VALUE SPACE.     03070000
030800     05  PV-DB2-TABLE-NAME-3          PIC  X(15) VALUE SPACE.     03080000
030900     05  PV-DB2-TABLE-NAME-4          PIC  X(15) VALUE SPACE.     03090000
031000                                                                  03100000
031100                                                                  03110000
031200 01  PV-INPUT.                                                    03120000
031300     05  FILLER                       PIC  X(01) VALUE SPACES.    03130001
031400     05  PVI-DC-NBR                   PIC  9(04) VALUE ZEROS.     03140001
031500     05  FILLER                       PIC  X(01) VALUE SPACES.    03150001
031600     05  PVI-TRAILER-NBR              PIC  9(08) VALUE ZEROS.     03160001
031700     05  FILLER                       PIC  X(01) VALUE SPACES.    03170001
031800     05  PVI-PO-NBR                   PIC  9(08) VALUE ZEROS.     03180001
031900     05  FILLER                       PIC  X(01) VALUE SPACES.    03190001
032000     05  PVI-PERCENT-OF-PO-UNITS      PIC  9(03) VALUE ZEROS.     03200001
032100         88  PVI-ALL-PO-UNITS                    VALUE 100.       03210001
032200     05  FILLER                       PIC  X(01) VALUE SPACE.     03220001
032300     05  PVI-PREPACK-ASN-BUILD-CDE    PIC  X(01) VALUE ZEROS.     03230001
032400         88 PVI-BUILD-PACK-AND-COMP              VALUE 'A'.       03240001
032500         88 PVI-BUILD-PACK-ONLY                  VALUE 'B'.       03250001
032600         88 PVI-BUILD-COMP-ONLY                  VALUE 'C'.       03260001
032700     05  FILLER                       PIC  X(01) VALUE SPACE.     03270020
032800     05  PVI-ID-SEGMENT-STRUC-CDE     PIC  X(04) VALUE ZEROS.     03280020
032900         88 PVI-ID-SEG-STRUC-PICK-PACK           VALUE '0001'.    03290020
033000         88 PVI-ID-SEG-STRUC-STANDARD            VALUE '0002'.    03300020
033100     05  FILLER                       PIC  X(01) VALUE SPACE.     03310020
033200     05  PVI-ENT-ID                   PIC  9(09) VALUE ZEROS.     03320020
033210     05  FILLER                       PIC  X(01) VALUE SPACE.     03321025
033220     05  PVI-BUILD-AS-PBS-ASN-CDE     PIC  X(01) VALUE ZEROS.     03322025
033230         88 PVI-BUILD-AS-PBS-ASN                 VALUE 'Y'.       03323025
033240     05  FILLER                       PIC  X(01) VALUE SPACE.     03324027
033250     05  PVI-PACK-RAT-LNE1-DF-NBR     PIC  9(03) VALUE ZEROS.     03325027
033260     05  FILLER                       PIC  X(01) VALUE SPACE.     03326027
033270     05  PVI-PACK-RAT-LNE1-DF-CDE     PIC  X(01) VALUE SPACE.     03327027
033280         88 PVI-PACK-RAT-LNE1-DF-PLUS            VALUE 'P'.       03328027
033290         88 PVI-PACK-RAT-LNE1-DF-NEG             VALUE 'N'.       03329027
033300     05  FILLER                       PIC  X(01) VALUE SPACE.     03330027
033310     05  PVI-PACK-RAT-LNE1-DF-QTY     PIC  9(03) VALUE ZEROS.     03331027
033320     05  FILLER                       PIC  X(01) VALUE SPACE.     03332027
033330     05  PVI-PACK-RAT-LNE2-DF-NBR     PIC  9(03) VALUE ZEROS.     03333027
033340     05  FILLER                       PIC  X(01) VALUE SPACE.     03334027
033350     05  PVI-PACK-RAT-LNE2-DF-CDE     PIC  X(01) VALUE SPACE.     03335027
033360         88 PVI-PACK-RAT-LNE2-DF-PLUS            VALUE 'P'.       03336027
033370         88 PVI-PACK-RAT-LNE2-DF-NEG             VALUE 'N'.       03337027
033380     05  FILLER                       PIC  X(01) VALUE SPACE.     03338027
033390     05  PVI-PACK-RAT-LNE2-DF-QTY     PIC  9(03) VALUE ZEROS.     03339027
033391     05  FILLER                       PIC  X(01) VALUE SPACE.     03339127
033392     05  PVI-PACK-COMP-BYPASS-LNE-NBR PIC  9(03) VALUE ZEROS.     03339227
033393     05  FILLER                       PIC  X(01) VALUE SPACE.     03339327
033394     05  PVI-PACK-COMP-RPLACE-LNE-NBR PIC  9(03) VALUE ZEROS.     03339427
033395     05  FILLER                       PIC  X(06) VALUE SPACE.     03339527
033400                                                                  03340001
033500 01  PV-OUTPUT.                                                   03350007
033600     05  FILLER                       PIC  X(01) VALUE SPACES.    03360007
033700     05  PVO-DC-NBR                   PIC  9(04) VALUE ZEROS.     03370007
033800     05  FILLER                       PIC  X(01) VALUE SPACES.    03380007
033900     05  PVO-TRAILER-NBR              PIC  9(08) VALUE ZEROS.     03390007
034000     05  FILLER                       PIC  X(01) VALUE SPACES.    03400007
034100     05  PVO-ENT-ID                   PIC  9(09) VALUE ZEROS.     03410020
034200     05  FILLER                       PIC  X(01) VALUE SPACES.    03420020
034300     05  PVO-STRUCTURE-CDE            PIC  X(04) VALUE ZEROS.     03430020
034400     05  FILLER                       PIC  X(01) VALUE SPACES.    03440020
034500     05  PVO-SEQ-NBR                  PIC  9(08) VALUE ZEROS.     03450007
034600     05  FILLER                       PIC  X(01) VALUE SPACES.    03460007
034700     05  PVO-ASN-DATA-RECORD          PIC  X(350).                03470007
034800     05  FILLER                       PIC  X(11) VALUE SPACE.     03480020
034900                                                                  03490000
035000                                                                  03500000
035100 01  SD-SYSTEM-DATE.                                              03510000
035200     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  03520000
035300     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  03530000
035400     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  03540000
035500                                                                  03550000
035600 01  DK-DB-KEYS.                                                  03560000
035700     05 DK-PO-NBR                     PIC S9(09) COMP.            03570000
035800     05 DK-PO-LINE-NBR                PIC S9(09) COMP.            03580000
035900     05 DK-ASN-NBR                    PIC  X(30).                 03590000
036000     05 DK-SKU-NBR                    PIC S9(08)V COMP-3.         03600000
036100     05 DK-OPER-UNIT                  PIC S9(04) COMP.            03610000
036200     05 DK-DC-NBR                     PIC S9(04) COMP.            03620008
036300     05 DK-STORE-NBR                  PIC S9(04) COMP.            03630000
036400     05 DK-SEQ-NBR                    PIC S9(04) COMP.            03640000
036500     05 DK-ENT-ID                     PIC S9(09) COMP.            03650004
036600                                                                  03660000
036700*----------------------------------------------------------------*03670002
036800*  RANDOM NUMBER AREA                                             03680002
036900*----------------------------------------------------------------*03690002
037000     COPY DPWS902.                                                03700002
037100                                                                  03710002
037200******************************************************************03720000
037300*  DB2 FORMATTED MESSAGE AREA                                     03730000
037400******************************************************************03740000
037500     COPY DPWS004.                                                03750000
037600                                                                  03760002
037700******************************************************************03770002
037800*  ASN OUTPUT LAYOUT                                              03780002
037900******************************************************************03790002
038000     COPY SNRD005.                                                03800002
038100*                                                                 03810000
038200******************************************************************03820000
038300*  COMMUNICATIONS AREA FOR DB2                                    03830000
038400******************************************************************03840000
038500     EXEC SQL                                                     03850000
038600          INCLUDE SQLCA                                           03860000
038700     END-EXEC.                                                    03870000
038800*                                                                 03880000
038900******************************************************************03890000
039000*   TCOCNTL TABLE                                                 03900002
039100******************************************************************03910000
039200     EXEC SQL                                                     03920000
039300          INCLUDE TCOCNTL                                         03930002
039400     END-EXEC.                                                    03940000
039500*                                                                 03950002
039600******************************************************************03960002
039700*   TPURCHS TABLE                                                 03970002
039800******************************************************************03980002
039900     EXEC SQL                                                     03990002
040000          INCLUDE TPURCHS                                         04000002
040100     END-EXEC.                                                    04010002
040200*                                                                 04020000
040300******************************************************************04030000
040400*   TPURITM TABLE                                                 04040002
040500******************************************************************04050000
040600     EXEC SQL                                                     04060000
040700          INCLUDE TPURITM                                         04070002
040800     END-EXEC.                                                    04080000
040900                                                                  04090000
041000*                                                                 04100006
041100******************************************************************04110006
041200*   TALLPLN TABLE                                                 04120006
041300******************************************************************04130006
041400     EXEC SQL                                                     04140006
041500          INCLUDE TALLPLN                                         04150006
041600     END-EXEC.                                                    04160006
041700                                                                  04170006
041800*                                                                 04180002
041900******************************************************************04190002
042000*   TEXTENT TABLE                                                 04200002
042100******************************************************************04210002
042200     EXEC SQL                                                     04220002
042300          INCLUDE TEXTENT                                         04230002
042400     END-EXEC.                                                    04240002
042500                                                                  04250002
042600*                                                                 04260008
042700******************************************************************04270008
042800*   TTRDPRT TABLE (TRADING PARTNER TABLE)                         04280008
042900******************************************************************04290008
043000     EXEC SQL                                                     04300008
043100          INCLUDE TTRDPRT                                         04310008
043200     END-EXEC.                                                    04320008
043300                                                                  04330008
044200     EXEC SQL                                                     04420006
044300          DECLARE BULK-CASE-CRTN-CURSOR CURSOR FOR                04430006
044400           SELECT A.PO_NBR , C.PO_LNE_NBR                         04440006
044500                , C.INNR_PK_QTY , C.OUTR_PK_QTY , B.CURR_SPLIT_QTY04450006
044600             FROM TPURCHS A                                       04460006
044700                , TALLPLN B                                       04470006
044800                , TPURITM C                                       04480006
044900           WHERE  A.PO_NBR         = :DK-PO-NBR                   04490006
045000             AND  A.VER_STATUS_CDE = 'A'                          04500006
045100             AND  B.PO_NBR         = A.PO_NBR                     04510006
045200             AND  B.DEST_NBR       = :DK-DC-NBR                   04520006
045300             AND  B.CURR_SPLIT_QTY > 0                            04530019
045400             AND  C.PO_NBR         = A.PO_NBR                     04540006
045500             AND  C.PO_LNE_NBR     = B.PO_LNE_NBR                 04550006
045600         ORDER BY A.PO_NBR , C.PO_LNE_NBR                         04560010
045700     END-EXEC.                                                    04570006
045800                                                                  04580006
045900******************************************************************04590000
046000 PROCEDURE DIVISION.                                              04600000
046100******************************************************************04610000
046200                                                                  04620000
046300 0000-PROGRAM-MAINLINE.                                           04630000
046400******************************************************************04640000
046500* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     04650000
046600*      PROGRAM.                                                   04660000
046700******************************************************************04670000
046800                                                                  04680000
046900     PERFORM 1000-INITIALIZE.                                     04690000
047000                                                                  04700000
047100     IF PS-MORE-INPUT                                             04710000
047200         PERFORM 2000-PROCESS-INPUT                               04720000
047300            UNTIL PS-EOF-INPUT                                    04730000
047400     END-IF.                                                      04740000
047500                                                                  04750012
047600     PERFORM 9000-EOJ-ROUTINE.                                    04760000
047700                                                                  04770000
047800     STOP RUN.                                                    04780000
047900                                                                  04790000
048000 1000-INITIALIZE.                                                 04800000
048100******************************************************************04810000
048200*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    04820000
048300******************************************************************04830000
048400                                                                  04840000
048500     OPEN INPUT INPUT-FILE.                                       04850000
048600     OPEN OUTPUT OUTPUT-FILE.                                     04860000
048700     PERFORM 8000-READ-INPUT.                                     04870000
048800                                                                  04880000
048900 2000-PROCESS-INPUT.                                              04890000
049000******************************************************************04900000
049100*  PROCESS THE FILE AND COMPARE THE FIELDS                        04910000
049200******************************************************************04920000
049300                                                                  04930000
049400     IF  PVI-DC-NBR               =  PV-PREV-DC-NBR               04940020
049500     AND PVI-TRAILER-NBR          =  PV-PREV-TRAILER-NBR          04950020
049600     AND PVI-ID-SEGMENT-STRUC-CDE =  PV-PREV-STRUCTURE-CDE        04960020
049700     AND PVI-ENT-ID               =  PV-PREV-ENT-ID               04970020
049800         NEXT SENTENCE                                            04980014
049900     ELSE                                                         04990001
050000         PERFORM 2400-PROCESS-ASN-INFO                            05000001
050100         MOVE PVI-DC-NBR               TO PV-PREV-DC-NBR          05010020
050200         MOVE PVI-TRAILER-NBR          TO PV-PREV-TRAILER-NBR     05020020
050300         MOVE PVI-ID-SEGMENT-STRUC-CDE TO PV-PREV-STRUCTURE-CDE   05030020
050400         MOVE PVI-ENT-ID               TO PV-PREV-ENT-ID          05040020
050500     END-IF.                                                      05050001
050600                                                                  05060000
050700     PERFORM 8000-READ-INPUT.                                     05070000
050800                                                                  05080000
050900 2400-PROCESS-ASN-INFO.                                           05090001
051000                                                                  05100007
051100     MOVE PVI-DC-NBR           TO PVO-DC-NBR.                     05110007
051200     MOVE PVI-TRAILER-NBR      TO PVO-TRAILER-NBR.                05120007
051300     MOVE PVI-ENT-ID               TO PVO-ENT-ID.                 05130022
051400     MOVE PVI-ID-SEGMENT-STRUC-CDE TO PVO-STRUCTURE-CDE.          05140022
051500     PERFORM 6000-GET-TIMESTAMP.                                  05150002
051600     MOVE PV-CURRENT-TIMESTAMP TO PV-CURR-TMST.                   05160023
051700     DISPLAY 'CURRENT TIMESTAMP: ' PV-CURRENT-TIMESTAMP.          05170023
051800     PERFORM 6200-GET-VENDOR-INFO.                                05180002
051900                                                                  05190002
052000* CREATE 'ID ' SEGMENT                                            05200007
052100     MOVE SPACES              TO SN005-HEADER-LEVEL-RECORD.       05210009
052200     MOVE 'ID '               TO SN005-HEADER-LEVEL-ID.           05220002
052300     MOVE EXTENT-DUN-NBR      TO SN005-VEND-DUNNS-NBR.            05230002
052400     MOVE SPACES              TO SN005-VEND-ID-FILLER.            05240002
052500     MOVE '00'                TO SN005-BSN01-TRANS-CDE.           05250002
052600     IF PVI-DC-NBR = 810                                          05260002
052700        MOVE 'SCNN'           TO PV-SCAC                          05270002
052800     ELSE                                                         05280002
052900     IF PVI-DC-NBR = 830                                          05290002
053000        MOVE 'ANSH'           TO PV-SCAC                          05300002
053100     ELSE                                                         05310002
053200     IF PVI-DC-NBR = 840                                          05320002
053300        MOVE 'HJBT'           TO PV-SCAC                          05330002
053400     ELSE                                                         05340002
053500     IF PVI-DC-NBR = 855                                          05350002
053600        MOVE 'SWFT'           TO PV-SCAC                          05360002
053700     ELSE                                                         05370002
053800     IF PVI-DC-NBR = 860                                          05380002
053900        MOVE 'HUBG'           TO PV-SCAC                          05390002
054000     ELSE                                                         05400002
054100     IF PVI-DC-NBR = 865                                          05410002
054200        MOVE 'CRPS'           TO PV-SCAC                          05420002
054300     ELSE                                                         05430002
054400     IF PVI-DC-NBR = 875                                          05440002
054500        MOVE 'DART'           TO PV-SCAC                          05450002
054600     ELSE                                                         05460002
054700     IF PVI-DC-NBR = 885                                          05470002
054800        MOVE 'HJBI'           TO PV-SCAC                          05480002
054900     ELSE                                                         05490002
055000     IF PVI-DC-NBR = 890                                          05500002
055100        MOVE 'ABFS'           TO PV-SCAC                          05510002
055200     ELSE                                                         05520002
055300     IF PVI-DC-NBR = 806                                          05530002
055400        MOVE 'UPSN'           TO PV-SCAC                          05540002
055500     ELSE                                                         05550002
055600     IF PVI-DC-NBR = 816                                          05560002
055700        MOVE 'GBEA'           TO PV-SCAC                          05570002
055800     ELSE                                                         05580002
055900     IF PVI-DC-NBR = 826                                          05590002
056000        MOVE 'SCDS'           TO PV-SCAC                          05600002
056100     ELSE                                                         05610002
056200     IF PVI-DC-NBR = 870                                          05620002
056300        MOVE 'GBXI'           TO PV-SCAC                          05630002
056400     ELSE                                                         05640002
056500        MOVE 'POHP'           TO PV-SCAC.                         05650002
056600     MOVE PVI-DC-NBR          TO PV-DC-NBR.                       05660002
056700*    MOVE PV-CURRENT-TIMESTAMP TO PV-CURR-TMST.                   05670023
056800     MOVE PV-CURR-TMST-NSEC   TO PV-NSEC.                         05680002
056900     MOVE PV-CURR-TMST-SEC    TO PV-SEC.                          05690002
057000     MOVE PV-CURR-TMST-MIN    TO PV-MIN.                          05700002
057100     MOVE PV-CURR-TMST-HRS    TO PV-HRS.                          05710002
057200     MOVE PV-CURR-TMST-DD     TO PV-DD.                           05720002
057300     MOVE PV-SHIPMENT-ID      TO SN005-BSN02-SHIPT-ID.            05730002
057400     MOVE PV-CURR-TMST-YY     TO PV-ASN-CRE-DATE-YY.              05740002
057500     MOVE PV-CURR-TMST-MM     TO PV-ASN-CRE-DATE-MM.              05750002
057600     MOVE PV-CURR-TMST-DD     TO PV-ASN-CRE-DATE-DD.              05760002
057700     MOVE PV-CURR-TMST-HRS    TO PV-ASN-CRE-TIME-HH.              05770002
057800     MOVE PV-CURR-TMST-MIN    TO PV-ASN-CRE-TIME-MM.              05780002
057900     MOVE PV-ASN-CRE-DATE     TO SN005-BSN03-SHIPT-DTE.           05790002
058000     MOVE PV-ASN-CRE-TIME     TO SN005-BSN04-SHIPT-TIME.          05800002
058100     MOVE SPACES              TO SN005-RECYCLE-DATE.              05810002
058200* THE FOLLOWING CAN BE 0001 OR 0002 BUT THIS DRIVES HOW SOME      05820002
058300* OF THE DETAIL DATA IS FORMATTED PO/CARTON/ITEM WITHIN THE       05830002
058400* ASN                                                             05840002
058500     MOVE PVI-ID-SEGMENT-STRUC-CDE TO SN005-STRUC-CDE.            05850021
058600     PERFORM 6400-GENER-RANDOM-NBR.                               05860003
058700     MOVE PV-RANDOM-NBR       TO SN005-ISA-CNTL-NBR.              05870003
058800     PERFORM 6400-GENER-RANDOM-NBR.                               05880003
058900     MOVE PV-RANDOM-NBR       TO SN005-GS-CNTL-NBR.               05890003
059000     PERFORM 6400-GENER-RANDOM-NBR.                               05900003
059100     MOVE PV-RANDOM-NBR       TO SN005-ST-CNTL-NBR.               05910003
059200     MOVE PV-CURRENT-TIMESTAMP TO SN005-ISA-TMST.                 05920002
059300     PERFORM 6400-GENER-RANDOM-NBR.                               05930004
059400     MOVE PV-RANDOM-NBR       TO SN005-SESSION-NBR.               05940004
059500     MOVE EXTENT-ENT-ID       TO DK-ENT-ID.                       05950004
059600     PERFORM 6600-GET-IMPORT-IND.                                 05960004
059700     MOVE TRDPRT-VEND-INCHG-ID-DESC TO SN005-ISA-ID-QUAL.         05970004
059800     MOVE TRDPRT-VEND-INCHG-ID      TO SN005-ISA-ID.              05980004
059900     MOVE SN005-HEADER-LEVEL-RECORD TO PVO-ASN-DATA-RECORD.       05990007
060000     MOVE 1                   TO PVO-SEQ-NBR.                     06000007
060100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            06010004
060200                                                                  06020004
060300* CREATE 'HL ' SHIPMENT SEGMENT                                   06030007
060400     MOVE 'HL '               TO SN005-HL-ID.                     06040004
060500     MOVE SPACES              TO SN005-HL01-ID-NBR.               06050004
060600     MOVE SPACES              TO SN005-HL02-PARENT-ID.            06060004
060700     MOVE 'S '                TO SN005-HL03-LVL-CDE.              06070004
060800     MOVE SPACES              TO SN005-HL04-CHILD-CDE.            06080004
060900     MOVE SPACES              TO SN005-HL-FILLER.                 06090004
061000     MOVE SN005-HL-SEGMENT    TO PVO-ASN-DATA-RECORD.             06100007
061100     MOVE 2                   TO PVO-SEQ-NBR.                     06110007
061200     PERFORM 8400-WRITE-OUTPUT-RECORD.                            06120004
061300                                                                  06130007
061400* CREATE 'TD5' SEGMENT                                            06140007
061500     MOVE 'TD5'               TO SN005-TD5-ID.                    06150007
061600     MOVE SN005-TD5-SEGMENT   TO PVO-ASN-DATA-RECORD.             06160007
061700     MOVE 'O '                TO SN005-TD501-RTE-SEQ-CDE.         06170007
061800     MOVE '2 '                TO SN005-TD502-CARR-ID-QUAL-CDE.    06180007
061900     IF PVI-DC-NBR = 810                                          06190007
062000        MOVE 'SCNN'           TO SN005-TD503-CARR-ID-CDE          06200007
062100     ELSE                                                         06210007
062200     IF PVI-DC-NBR = 830                                          06220007
062300        MOVE 'ANSH'           TO SN005-TD503-CARR-ID-CDE          06230007
062400     ELSE                                                         06240007
062500     IF PVI-DC-NBR = 840                                          06250007
062600        MOVE 'HJBT'           TO SN005-TD503-CARR-ID-CDE          06260007
062700     ELSE                                                         06270007
062800     IF PVI-DC-NBR = 855                                          06280007
062900        MOVE 'SWFT'           TO SN005-TD503-CARR-ID-CDE          06290007
063000     ELSE                                                         06300007
063100     IF PVI-DC-NBR = 860                                          06310007
063200        MOVE 'HUBG'           TO SN005-TD503-CARR-ID-CDE          06320007
063300     ELSE                                                         06330007
063400     IF PVI-DC-NBR = 865                                          06340007
063500        MOVE 'CRPS'           TO SN005-TD503-CARR-ID-CDE          06350007
063600     ELSE                                                         06360007
063700     IF PVI-DC-NBR = 875                                          06370007
063800        MOVE 'DART'           TO SN005-TD503-CARR-ID-CDE          06380007
063900     ELSE                                                         06390007
064000     IF PVI-DC-NBR = 885                                          06400007
064100        MOVE 'HJBI'           TO SN005-TD503-CARR-ID-CDE          06410007
064200     ELSE                                                         06420007
064300     IF PVI-DC-NBR = 890                                          06430007
064400        MOVE 'ABFS'           TO SN005-TD503-CARR-ID-CDE          06440007
064500     ELSE                                                         06450007
064600     IF PVI-DC-NBR = 806                                          06460007
064700        MOVE 'UPSN'           TO SN005-TD503-CARR-ID-CDE          06470007
064800     ELSE                                                         06480007
064900     IF PVI-DC-NBR = 816                                          06490007
065000        MOVE 'GBEA'           TO SN005-TD503-CARR-ID-CDE          06500007
065100     ELSE                                                         06510007
065200     IF PVI-DC-NBR = 826                                          06520007
065300        MOVE 'SCDS'           TO SN005-TD503-CARR-ID-CDE          06530007
065400     ELSE                                                         06540007
065500     IF PVI-DC-NBR = 870                                          06550007
065600        MOVE 'GBXI'           TO SN005-TD503-CARR-ID-CDE          06560007
065700     ELSE                                                         06570007
065800        MOVE 'POHP'           TO SN005-TD503-CARR-ID-CDE.         06580007
065900     MOVE 'M '                TO SN005-TD504-TRANS-MTHD-CDE.      06590007
066000     MOVE SPACES              TO SN005-TD505-CARR-NME.            06600007
066100     MOVE SPACES              TO SN005-TD506-STATUS-CDE.          06610007
066200     MOVE SPACES              TO SN005-TD507-LOC-QUAL.            06620007
066300     MOVE SPACES              TO SN005-TD508-LOC-ID.              06630007
066400     MOVE SPACES              TO SN005-TD510-TRNS-TME-QUAL-CDE.   06640007
066500     MOVE ZEROS               TO SN005-TD511-TRNST-TIME.          06650007
066600     MOVE SPACES              TO SN005-TD5-FILLER.                06660007
066700     MOVE SN005-TD5-SEGMENT   TO PVO-ASN-DATA-RECORD.             06670011
066800     MOVE 4                   TO PVO-SEQ-NBR.                     06680007
066900     PERFORM 8400-WRITE-OUTPUT-RECORD.                            06690007
067000                                                                  06700007
067100* CREATE 'TD3' SEGMENT                                            06710007
067200     MOVE 'TD3'               TO SN005-TD3-ID.                    06720007
067300     MOVE 'CN'                TO SN005-TD301-EQUIP-CDE.           06730007
067400     MOVE 'MRKU'              TO SN005-TD302-EQUIP-INIT-CDE.      06740007
067500     MOVE '1234567890'        TO SN005-TD303-EQUIP-NBR.           06750007
067600     MOVE SPACES              TO SN005-TD3-FILLER.                06760007
067700     MOVE SN005-TD3-SEGMENT   TO PVO-ASN-DATA-RECORD.             06770007
067800     MOVE 5                   TO PVO-SEQ-NBR.                     06780007
067900     PERFORM 8400-WRITE-OUTPUT-RECORD.                            06790007
068000                                                                  06800004
068100* CREATE 'REF' SEGMENT - BOL DATA                                 06810007
068200     MOVE 'REF'               TO SN005-REF-ID.                    06820007
068300     MOVE 'BM'                TO SN005-REF01-NBR-QUAL-CDE.        06830007
068400                                                                  06840024
068500     IF  PVI-DC-NBR         = PV-PREV-BOL-DC-NBR                  06850024
068600     AND PVI-TRAILER-NBR    = PV-PREV-BOL-TRAILER-NBR             06860024
068700         NEXT SENTENCE                                            06870024
068800     ELSE                                                         06880024
068810         PERFORM 3200-FORMAT-BOL                                  06881024
068811         MOVE PVI-DC-NBR      TO PV-PREV-BOL-DC-NBR               06881124
068812         MOVE PVI-TRAILER-NBR TO PV-PREV-BOL-TRAILER-NBR          06881224
068820     END-IF.                                                      06882024
068900                                                                  06890024
069700     MOVE PV-BOL              TO SN005-REF02-NBR.                 06970016
069800     MOVE SPACES              TO SN005-REF-FILLER.                06980007
069900     MOVE SN005-TD3-SEGMENT   TO PVO-ASN-DATA-RECORD.             06990007
070000     MOVE 6                   TO PVO-SEQ-NBR.                     07000007
070100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07010007
070200                                                                  07020007
070300* CREATE 'REF' SEGMENT - CAN NUMBER                               07030015
070400     MOVE 'REF'               TO SN005-REF-ID.                    07040015
070500     MOVE '06'                TO SN005-REF01-NBR-QUAL-CDE.        07050015
070600     PERFORM 6400-GENER-RANDOM-NBR.                               07060015
070700     MOVE PV-RANDOM-NBR       TO SN005-REF02-NBR.                 07070015
070800     MOVE SPACES              TO SN005-REF-FILLER.                07080015
070900     MOVE SN005-TD3-SEGMENT   TO PVO-ASN-DATA-RECORD.             07090015
071000     MOVE 7                   TO PVO-SEQ-NBR.                     07100017
071100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07110015
071200                                                                  07120015
071300* CREATE 'REF' SEGMENT - PRO DATA                                 07130007
071400     MOVE 'REF'               TO SN005-REF-ID.                    07140007
071500     MOVE 'CN'                TO SN005-REF01-NBR-QUAL-CDE.        07150007
071510                                                                  07151024
071520     IF  PVI-DC-NBR         = PV-PREV-PRO-DC-NBR                  07152024
071530     AND PVI-TRAILER-NBR    = PV-PREV-PRO-TRAILER-NBR             07153024
071540         NEXT SENTENCE                                            07154024
071550     ELSE                                                         07155024
071560         PERFORM 3600-FORMAT-PRO                                  07156024
071570         MOVE PVI-DC-NBR      TO PV-PREV-PRO-DC-NBR               07157024
071580         MOVE PVI-TRAILER-NBR TO PV-PREV-PRO-TRAILER-NBR          07158024
071590     END-IF.                                                      07159024
071591                                                                  07159124
072300     MOVE PV-PRO              TO SN005-REF02-NBR.                 07230016
072400     MOVE SPACES              TO SN005-REF-FILLER.                07240007
072500     MOVE SN005-TD3-SEGMENT   TO PVO-ASN-DATA-RECORD.             07250007
072600     MOVE 8                   TO PVO-SEQ-NBR.                     07260017
072700     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07270007
072800                                                                  07280007
072900* CREATE 'DTM' SEGMENT                                            07290007
073000     MOVE 'DTM'               TO SN005-DTM-ID.                    07300007
073100     MOVE '011'               TO SN005-DTM01-DTE-QUAL-CDE.        07310018
073200     MOVE PV-ASN-CRE-DATE     TO SN005-DTM02-DTE.                 07320007
073300     MOVE PV-ASN-CRE-TIME     TO SN005-DTM03-SHIP-TIME.           07330007
073400     MOVE SPACES              TO SN005-DTM-FILLER.                07340007
073500     MOVE SN005-DTM-SEGMENT   TO PVO-ASN-DATA-RECORD.             07350007
073600     MOVE 9                   TO PVO-SEQ-NBR.                     07360017
073700     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07370007
073800                                                                  07380007
073900* CREATE 'N1 ' SEGMENT                                            07390007
074000     MOVE 'N1 '               TO SN005-N1-ID.                     07400007
074100     MOVE 'ST'                TO SN005-N101-ID-CDE.               07410007
074200     MOVE 'KOHLS'             TO SN005-N102-CUST-NME.             07420007
074300     MOVE '92'                TO SN005-N103-NME-ID-QUAL-CDE.      07430007
074400     MOVE PVI-DC-NBR          TO PV-SHIP-TO-DC-NBR.               07440007
074500     MOVE SPACES              TO PV-SHIP-TO-DC-FILLER.            07450007
074600     MOVE PV-SHIP-TO-DC       TO SN005-N104-NME-ID-CDE.           07460007
074700     MOVE SPACES              TO SN005-N1-FILLER.                 07470007
074800     MOVE SN005-N1-SEGMENT    TO PVO-ASN-DATA-RECORD.             07480007
074900     MOVE 10                  TO PVO-SEQ-NBR.                     07490017
075000     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07500007
075001                                                                  07500124
075010 3200-FORMAT-BOL.                                                 07501024
075100                                                                  07510013
075110     MOVE PV-CURR-TMST-YY     TO PV-BOL-YY.                       07511024
075120     MOVE PV-CURR-TMST-MM     TO PV-BOL-MM.                       07512024
075130     MOVE PV-CURR-TMST-DD     TO PV-BOL-DD.                       07513024
075140     MOVE PV-CURR-TMST-HRS    TO PV-BOL-HH.                       07514024
075150     MOVE PV-CURR-TMST-MIN    TO PV-BOL-MIN.                      07515024
075160     MOVE PV-CURR-TMST-SEC    TO PV-BOL-SS.                       07516024
075170     MOVE PV-CURR-TMST-NSEC   TO PV-NANO-SECOND.                  07517024
075171     MOVE PV-NANO-SECOND-5-6  TO PV-BOL-NN.                       07517124
075180                                                                  07518024
075190 3600-FORMAT-PRO.                                                 07519024
075191                                                                  07519124
075192     MOVE PV-CURR-TMST-YY     TO PV-PRO-YY.                       07519224
075193     MOVE PV-CURR-TMST-MM     TO PV-PRO-MM.                       07519324
075194     MOVE PV-CURR-TMST-DD     TO PV-PRO-DD.                       07519424
075195     MOVE PV-CURR-TMST-HRS    TO PV-PRO-HH.                       07519524
075196     MOVE PV-CURR-TMST-MIN    TO PV-PRO-MIN.                      07519624
075197     MOVE PV-CURR-TMST-SEC    TO PV-PRO-SS.                       07519724
075198     MOVE PV-CURR-TMST-NSEC   TO PV-NANO-SECOND.                  07519824
075199     MOVE PV-NANO-SECOND-5-6  TO PV-PRO-NN.                       07519924
075200                                                                  07520024
075210 6000-GET-TIMESTAMP.                                              07521024
075300                                                                  07530002
075400     EXEC SQL                                                     07540002
075500          SELECT CURRENT TIMESTAMP                                07550002
075600          INTO  :PV-CURRENT-TIMESTAMP                             07560002
075700          FROM   TCOCNTL                                          07570002
075800          WHERE OPER_UNT_ID = 90                                  07580002
075900          WITH UR                                                 07590002
076000     END-EXEC.                                                    07600002
076100                                                                  07610002
076200     EVALUATE TRUE                                                07620002
076300         WHEN SQLCODE = ZERO                                      07630002
076400         WHEN SQLCODE = -811                                      07640002
076500              CONTINUE                                            07650002
076600         WHEN SQLWARN0 NOT = SPACE                                07660002
076700         WHEN SQLCODE NOT = ZERO                                  07670002
076800              MOVE '6000-GET-TIMESTAMP'                           07680002
076900                                  TO PV-PARAGRAPH-NAME            07690002
077000              MOVE 'SELECT TIMESTAMP FROM TCOCNTL          '      07700002
077100                                  TO PV-DB2-OPERATION-MESSAGE-1   07710002
077200              MOVE 'TCOCNTL'      TO PV-DB2-TABLE-NAME-1          07720002
077300              PERFORM 9999-SQL-ABEND                              07730002
077400     END-EVALUATE.                                                07740002
077500                                                                  07750002
077600 6200-GET-VENDOR-INFO.                                            07760002
077700                                                                  07770002
077800      MOVE '6200-GET-VENDOR-INFO   '      TO PV-ABEND-PARAGRAPH.  07780002
077900      MOVE PVI-PO-NBR                     TO DK-PO-NBR.           07790002
078000                                                                  07800002
078100      EXEC SQL                                                    07810002
078200                SELECT B.ENT_ID , B.DUN_NBR , A.PKGNG_CDE         07820006
078300                INTO  :EXTENT-ENT-ID                              07830002
078400                   ,  :EXTENT-DUN-NBR                             07840002
078500                   ,  :PURCHS-PKGNG-CDE                           07850006
078600                  FROM TPURCHS A                                  07860002
078700                     , TEXTENT B                                  07870002
078800                WHERE A.PO_NBR       = :DK-PO-NBR                 07880002
078900                  AND A.VER_STATUS_CDE = 'A'                      07890008
079000                  AND B.ENT_ID         = A.ENT_ID                 07900002
079100                WITH UR                                           07910002
079200      END-EXEC.                                                   07920002
079300                                                                  07930002
079400       EVALUATE TRUE                                              07940002
079500            WHEN SQLCODE = ZERO                                   07950002
079600            WHEN SQLCODE = -811                                   07960002
079700                CONTINUE                                          07970002
079800            WHEN SQLCODE = +100                                   07980002
079900                ADD +1 TO PV-NO-INBOUND-COUNTER                   07990002
080000                DISPLAY 'PO OR VEDOR DOES NOT EXIST'              08000002
080100                DISPLAY 'PO NBR:  ' PVI-PO-NBR                    08010002
080200            WHEN OTHER                                            08020002
080300                MOVE  SQLCODE          TO  PV-SQLCODE             08030002
080400                MOVE 'SELECT TPURCHS AND TEXTENT '                08040002
080500                                     TO PV-DB2-OPERATION-MESSAGE-108050002
080600                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  08060002
080700                       PVI-PO-NBR              DELIMITED BY SIZE  08070002
080800                                   INTO PV-DB2-OPERATION-MESSAGE-208080002
080900                MOVE 'TPURCHS'           TO PV-DB2-TABLE-NAME-1   08090002
081000                MOVE 'TEXTENT'           TO PV-DB2-TABLE-NAME-2   08100002
081100                PERFORM 9999-SQL-ABEND                            08110002
081200        END-EVALUATE.                                             08120002
081300                                                                  08130002
081400******************************************************************08140003
081500* GENERATE A RANDOM NUMBER BASED ON THE CURRENT DATE AND TIME    *08150003
081600* VIA KOHL'S RANDOM NUMBER ROUTINE.                              *08160003
081700******************************************************************08170003
081800 6400-GENER-RANDOM-NBR.                                           08180003
081900                                                                  08190003
082000     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     08200003
082100     CALL PC-RANDOM-PGM USING                                     08210009
082200                            DP902-RANDNBR-ROUTINE-FIELDS.         08220003
082300                                                                  08230003
082400                                                                  08240003
082500     IF DP902-SUCCESSFUL                                          08250003
082600         MOVE DP902-RANDOM-NUMBER   TO PV-RANDOM-NBR              08260003
082700     ELSE                                                         08270003
082800         MOVE '6400-GENER-RANDOM-NBR' TO PV-PARAGRAPH-NAME        08280003
082900         MOVE 'RANDOM NBR SUBROUINE FAILURE'                      08290003
083000                                      TO PV-ABEND-MESSAGE         08300003
083100         PERFORM 9200-NON-SQL-ABEND                               08310003
083200     END-IF.                                                      08320003
083300                                                                  08330002
083400                                                                  08340002
083500 6600-GET-IMPORT-IND.                                             08350004
083600                                                                  08360004
083700     MOVE '6600-GET-IMPORT-IND    '      TO PV-ABEND-PARAGRAPH.   08370004
083800                                                                  08380004
083900     EXEC SQL                                                     08390004
084000           SELECT B.VEND_INCHG_ID_DESC                            08400004
084100                , B.VEND_INCHG_ID                                 08410004
084200           INTO :TRDPRT-VEND-INCHG-ID-DESC                        08420004
084300               ,:TRDPRT-VEND-INCHG-ID                             08430004
084400           FROM TEXTENT A,                                        08440004
084500                TTRDPRT B                                         08450004
084600           WHERE A.ENT_ID            = :DK-ENT-ID                 08460004
084700             AND B.INACTV_DTE        = '9999-09-09'               08470004
084800             AND A.ENT_ID            =  B.ENT_ID                  08480004
084900           WITH UR                                                08490004
085000     END-EXEC.                                                    08500004
085100                                                                  08510004
085200     EVALUATE TRUE                                                08520004
085300          WHEN SQLCODE = ZERO                                     08530004
085400          WHEN SQLCODE = -811                                     08540004
085500             CONTINUE                                             08550004
085600          WHEN SQLCODE = +100                                     08560004
085700             MOVE 'ZZ'      TO TRDPRT-VEND-INCHG-ID-DESC          08570004
085800             MOVE 'UNKNOWN' TO TRDPRT-VEND-INCHG-ID               08580004
085900          WHEN OTHER                                              08590004
086000             MOVE  SQLCODE          TO  PV-SQLCODE                08600004
086100             MOVE 'SELECT TEXTENT AND TTRDPRT '                   08610004
086200                                  TO PV-DB2-OPERATION-MESSAGE-1   08620004
086300             MOVE DK-ENT-ID TO PV-DISPLAY-ENT-ID                  08630004
086400             STRING ' PO NUMBER -  '        DELIMITED BY SIZE     08640004
086500                    PVI-PO-NBR              DELIMITED BY SIZE     08650004
086600                    ' ENT ID    -  '        DELIMITED BY SIZE     08660004
086700                    PV-DISPLAY-ENT-ID       DELIMITED BY SIZE     08670004
086800                                INTO PV-DB2-OPERATION-MESSAGE-2   08680004
086900             MOVE 'TEXTENT'           TO PV-DB2-TABLE-NAME-1      08690004
087000             MOVE 'TTRDPRT'           TO PV-DB2-TABLE-NAME-2      08700004
087100             PERFORM 9999-SQL-ABEND                               08710004
087200     END-EVALUATE.                                                08720004
087300                                                                  08730004
087400                                                                  08740002
087500 8000-READ-INPUT.                                                 08750000
087600******************************************************************08760000
087700*  READ THE INPUT FILE                                            08770000
087800******************************************************************08780000
087900     READ INPUT-FILE                                              08790000
088000          INTO PV-INPUT                                           08800004
088100          AT END                                                  08810000
088200             SET PS-EOF-INPUT TO TRUE.                            08820000
088300                                                                  08830000
088400     IF PS-EOF-INPUT                                              08840000
088500        CONTINUE                                                  08850000
088600     ELSE                                                         08860000
088700        ADD +1 TO PV-INPUT-COUNTER                                08870000
088800        ADD +1 TO PV-INPUT-DISPLAY-COUNTER                        08880000
088900     END-IF.                                                      08890000
089000                                                                  08900000
089100     IF  PV-INPUT-DISPLAY-COUNTER = 2000                          08910000
089200         MOVE PV-INPUT-COUNTER       TO PV-DISPLAY-FIELD          08920000
089300         DISPLAY 'READ INPUT RECORD: '                            08930000
089400                 PV-DISPLAY-FIELD                                 08940000
089500         MOVE ZEROS TO PV-INPUT-DISPLAY-COUNTER                   08950000
089600     END-IF.                                                      08960000
089700                                                                  08970000
089800******************************************************************08980000
089900* WRITES TO THE OUTPUT FILE                                       08990000
090000******************************************************************09000000
090100 8400-WRITE-OUTPUT-RECORD.                                        09010000
090200                                                                  09020000
090300     WRITE OUTPUT-RECORD                                          09030000
090400        FROM PV-OUTPUT.                                           09040000
090500        ADD  1  TO  PV-OUTPUT-COUNTER.                            09050000
090600                                                                  09060000
090700 9000-EOJ-ROUTINE.                                                09070000
090800******************************************************************09080000
090900*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                          09090000
091000******************************************************************09100000
091100     CLOSE INPUT-FILE.                                            09110000
091200     CLOSE OUTPUT-FILE.                                           09120000
091300                                                                  09130000
091400     MOVE PV-INPUT-COUNTER TO PV-DISPLAY-COUNT.                   09140000
091500     DISPLAY 'INPUT RECORDS READ:        ' PV-DISPLAY-COUNT.      09150000
091600     MOVE PV-OUTPUT-COUNTER TO PV-DISPLAY-COUNT.                  09160000
091700     DISPLAY 'OUTPUT RECORDS WRITTEN:    ' PV-DISPLAY-COUNT.      09170000
091800                                                                  09180000
091900                                                                  09190003
092000****************************************************************  09200003
092100** PERFORM NON SQL ABEND PROCESSING                               09210003
092200****************************************************************  09220003
092300 9200-NON-SQL-ABEND.                                              09230003
092400                                                                  09240003
092500     DISPLAY '************************************************'.  09250003
092600     DISPLAY '********** NON SQL PROGRAM ABEND ***************'.  09260003
092700     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          09270003
092800     DISPLAY '** ABEND CODE: ', PV-ABEND-CODE.                    09280003
092900     DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH-NAME.                09290003
093000     DISPLAY '** MESSAGE:    ', PV-ABEND-MESSAGE.                 09300003
093100     DISPLAY '************************************************'.  09310003
093200     MOVE +4013 TO ABEND-CODE.                                    09320003
093300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09330003
093400                                                                  09340003
093500******************************************************************09350000
093600* ABEND PROCEDURE                                                *09360000
093700******************************************************************09370000
093800 9999-SQL-ABEND.                                                  09380000
093900     DISPLAY '** ABEND           ** = SQLABEND'.                  09390000
094000     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  09400000
094100     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       09410000
094200     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-1.      09420000
094300     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-2.      09430000
094400     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-3.      09440000
094500     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-4.      09450000
094600     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-109460000
094700     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-209470000
094800     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               09480000
094900     COPY DPPD004.                                                09490000
095000     MOVE +4013                  TO PV-ABEND-CODE.                09500000
095100     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       09510000
