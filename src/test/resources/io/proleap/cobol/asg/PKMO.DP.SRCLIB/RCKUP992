000100******************************************************************00010000
000200*  THIS IS A PROGRAM THAT CAN BE USED TO TAKE IN A FILE IN THE    00020003
000300*  RCRD097 FORMAT AND GENERATE RECEIVERS FOR THE PO'S IN THE      00030003
000400*  FILE.                                                          00040003
000410*  THIS PROGRAM WAS COPIED FROM RCKUP991 WHICH WAS COPIED FROM    00041003
000420*  RCKUP009.                                                      00042003
000430*  CURRENT VERSION OF THIS PROGRAM WOULD CREATE A NEW RECEIVER    00043003
000440*  WHERE THERE IS A CHANGE IN THE PO NUMBER ON THE FILE.  BECAUSE 00044003
000450*  OF THAT, THE PROGRAM AT THIS TIME WOULD TAKE IN A FILE FOR     00045003
000460*  ONLY DATA FOR A DC SO THAT THE PROGRAM WOULD LAND UP CREATING  00046003
000470*  ONLY ONE RECEIVER BY DC (IF MULTIPLE DC'S ON THE FILE, THEN    00047003
000480*  ALL DATA WOULD BE COMBINED TO ONE RECEIVER BASED ON THE WAY    00048003
000490*  THIS PROGRAM IS CURRENTLY WRITTEN.                             00049003
000491*  PROGRAM RCKUT992 SHOULD RUN PRIOR TO THIS PROGRAM - IT WILL    00049103
000492*  FORMAT THE RCRD097 INPUT FILE BUT WILL ALSO CREATE A           00049203
000493*  SEPARATE FILE FOR EACH DC.  THE FILE INTO THE RCKUT992 PROGRAM 00049303
000494*  COMES FROM A SPREADSHEET THAT WAS SUPPLIED BY INVENTORY CONTROL00049403
000495*  AND SAVED TO A .TXT FILE AND UPLOADED TO THE MAINFRAME.        00049503
000496*                                                                 00049603
000497*  FILE COMING INTO THIS PROGRAM SHOULD BE IN PO/LINE SEQUENCE.   00049703
000500*                                                                 00050003
000510******************************************************************00051003
000600 IDENTIFICATION DIVISION.                                         00060000
000700 PROGRAM-ID.             RCKUP992.                                00070000
000800 AUTHOR.                 RON KRIER.                               00080005
000900 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00090000
001000 DATE-WRITTEN.           FEBRUARY 2017.                           00100005
001100 DATE-COMPILED.                                                   00110000
001200                                                                  00120000
001300******************************************************************00130000
001400*                                                                 00140000
001500                                                                  00150000
001600* GENERAL PROCESSING:                                             00160000
001700* -------------------                                             00170000
001800* 1) INITIALIZE VARIABLES, SET SWITCHES, OPEN INPUT & OUTPUT      00180000
001900*                                                                 00190000
002000* 2) WHEN A ORDER/STORE HAS BEEN PROCESSED, THE DATA WILL BE      00200000
002100*    LOADED TO THE RECEIVER AN PACKSLIP TABLES.                   00210000
002200*                                                                 00220000
002300* 3) EVERYTHING WILL GET INITIALIZED AND RESET - READY FOR THE    00230000
002400*    NEXT RECORD                                                  00240000
002500*                                                                 00250000
002600* ERROR PROCESSING:                                               00260000
002700* -----------------                                               00270000
002800* THIS PRGM IS CODED TO TRAP 23 TYPES OF ERRORS WHICH INCLUDE:    00280000
002900*                                                                 00290000
003000* 1) VALUE 1 - ROW NOT FOUND                                      00300000
003100* 2) VALUE 2 - STYLE ID NOT FOUND                                 00310000
003200* 3) VALUE 3 - DUP INSERT ON STYLE                                00320000
003300* 4) VALUE 4 - DUP INSERT ON SKU                                  00330000
003400* 5) VALUE 5 - SIZE DESC CODE MISMATCH                            00340000
003500* 6) VALUE 6 - DUP UPDATE STYLE                                   00350000
003600* 7) VALUE 7 - DUP INSERT ON UPC                                  00360000
003700* 8) VALUE 8 - UPC ROW NOT FOUND                                  00370000
003800* 9) VALUE 9 - DUP UPDATE UPC                                     00380000
003900* 10)VALUE 10- SKU ROW PROBLEM                                    00390000
004000* 11)VALUE 11- SKU INTR UPC ID NOT FOUND                          00400000
004100* 12)VALUE 12- PK INSERT NOT SUCCESS                              00410000
004200* 13)VALUE 13- PK DELETE NOT SUCCESS                              00420000
004300* 14)VALUE 14- PK UPDATE NOT SUCCESS                              00430000
004400* 15)VALUE 15- PK CPT INSERT NOT SUCCESS                          00440000
004500* 16)VALUE 16- PK CPT DELETE NOT SUCCESS                          00450000
004600* 17)VALUE 17- PK CPT UPDATE NOT SUCCESS                          00460000
004700* 18)VALUE 18- PK UPC INSERT NOT SUCCESS                          00470000
004800* 19)VALUE 19- PK UPC DELETE NOT SUCCESS                          00480000
004900* 20)VALUE 20- PK UPC UPDATE NOT SUCCESS                          00490000
005000* 21)VALUE 21- POPRPK INSERT NOT SUCCESS                          00500000
005100* 22)VALUE 22- POPRPK DELETE NOT SUCCESS                          00510000
005200* 23)VALUE 23- POPRPK UPDATE NOT SUCCESS                          00520000
005300*                                                                 00530000
005400* UNITS OF WORK AND COMMITS:                                      00540000
005500* --------------------------                                      00550000
005600* A UNIT OF WORK FOR A DB2 COMMIT WILL BE COMPLETE WHEN A         00560000
005700* RECORD HAS BEEN READ FROM THE INPUT FILE, AND ALL TABLE         00570000
005800* INSERTS AND UPDATES HAVE BEEN DONE WITH NO ERRORS.              00580000
005900* THE DB2 COMMIT IS PERFORMED.                                    00590000
005900*                                                                 00590106
001400* CHANGE LOG:                                                  *  00591006
001500*                                                              *  00592006
001600* DATE  02/24/2017                                             *  00593006
001700*    CHANGE MADE: INITIAL IMPLEMENTATION.                      *  00594006
001800*    MADE BY: RON KRIER               WR/IR #: CHG0163084      *  00595006
006000*                                                                 00600000
006100******************************************************************00610000
006200 ENVIRONMENT DIVISION.                                            00620000
006300******************************************************************00630000
006400 CONFIGURATION SECTION.                                           00640000
006500 SOURCE-COMPUTER.        IBM-3090.                                00650000
006600 OBJECT-COMPUTER.        IBM-3090.                                00660000
006700                                                                  00670000
006800 INPUT-OUTPUT SECTION.                                            00680000
006900 FILE-CONTROL.                                                    00690000
007000                                                                  00700000
007100* ------------------------------------------------------------- * 00710000
007200     SELECT INPUT-FILE                                            00720000
007300            ASSIGN TO INP01.                                      00730000
007400     SELECT ERROR-FILE                                            00740000
007500            ASSIGN TO OUT01.                                      00750000
007600     SELECT BKUP-FILE                                             00760000
007700            ASSIGN TO OUT02.                                      00770000
007800                                                                  00780000
007900******************************************************************00790000
008000 DATA DIVISION.                                                   00800000
008100******************************************************************00810000
008200 FILE SECTION.                                                    00820000
008300                                                                  00830000
008400 FD  INPUT-FILE                                                   00840000
008500     RECORDING MODE F                                             00850000
008600     BLOCK CONTAINS 0 RECORDS                                     00860000
008700     LABEL RECORDS ARE OMITTED.                                   00870000
008800 01  INPUT-RECORD                     PIC  X(150).                00880001
008900                                                                  00890000
009000 FD  ERROR-FILE                                                   00900000
009100     RECORDING MODE F                                             00910000
009200     BLOCK CONTAINS 0 RECORDS                                     00920000
009300     LABEL RECORDS ARE OMITTED.                                   00930000
009400 01  ERROR-RECORD                     PIC  X(150).                00940001
009500                                                                  00950000
009600 FD  BKUP-FILE                                                    00960000
009700     RECORDING MODE F                                             00970000
009800     BLOCK CONTAINS 0 RECORDS                                     00980000
009900     LABEL RECORDS ARE OMITTED.                                   00990000
010000 01  BKUP-RECORD                      PIC  X(080).                01000000
010100******************************************************************01010000
010200 WORKING-STORAGE SECTION.                                         01020000
010300******************************************************************01030000
010400*  COMMUNICATIONS AREA FOR DB2                                    01040000
010500******************************************************************01050000
010600     EXEC SQL                                                     01060000
010700          INCLUDE SQLCA                                           01070000
010800     END-EXEC.                                                    01080000
010900                                                                  01090000
011000                                                                  01100000
011100*----------------------------------------------------------------*01110000
011200*    DB2 DCLGEN FOR THE PURCHASE ITEM TABLE                       01120000
011300*----------------------------------------------------------------*01130000
011400     EXEC SQL                                                     01140000
011500          INCLUDE TPURITM                                         01150000
011600     END-EXEC.                                                    01160000
011700                                                                  01170000
011800*----------------------------------------------------------------*01180000
011900*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     01190000
012000*----------------------------------------------------------------*01200000
012100     EXEC SQL                                                     01210000
012200          INCLUDE TRECVER                                         01220000
012300     END-EXEC.                                                    01230000
012400                                                                  01240000
012500******************************************************************01250000
012600*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          01260000
012700******************************************************************01270000
012800     EXEC SQL                                                     01280000
012900          INCLUDE TPURCHS                                         01290000
013000     END-EXEC.                                                    01300000
013100                                                                  01310000
013200*----------------------------------------------------------------*01320000
013300*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            01330000
013400*----------------------------------------------------------------*01340000
013500     EXEC SQL                                                     01350000
013600          INCLUDE TPOAGMT                                         01360000
013700     END-EXEC.                                                    01370000
013800                                                                  01380000
013900*----------------------------------------------------------------*01390000
014000*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        01400000
014100*----------------------------------------------------------------*01410000
014200     EXEC SQL                                                     01420000
014300          INCLUDE TPKSLIP                                         01430000
014400     END-EXEC.                                                    01440000
014500                                                                  01450000
014600*----------------------------------------------------------------*01460000
014700*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          01470000
014800*----------------------------------------------------------------*01480000
014900     EXEC SQL                                                     01490000
015000          INCLUDE TPKITEM                                         01500000
015100     END-EXEC.                                                    01510000
015200                                                                  01520000
015300*---------------------------------------------------------------* 01530000
015400*    DB2 AREA FOR RECEIVER TABLE                                * 01540000
015500*---------------------------------------------------------------* 01550000
015600     EXEC SQL                                                     01560000
015700          INCLUDE TRECEIV                                         01570000
015800     END-EXEC.                                                    01580000
015900                                                                  01590000
016000******************************************************************01600000
016100*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       01610000
016200******************************************************************01620000
016300     EXEC SQL                                                     01630000
016400          INCLUDE TRECITM                                         01640000
016500     END-EXEC.                                                    01650000
016600                                                                  01660000
016700******************************************************************01670000
016800*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION TABLE                01680000
016900******************************************************************01690000
017000     EXEC SQL                                                     01700000
017100          INCLUDE TRECDIS                                         01710000
017200     END-EXEC.                                                    01720000
017300                                                                  01730000
017400******************************************************************01740000
017500*    DB2 DCLGEN FOR THE PARAMETER TABLE                           01750000
017600******************************************************************01760000
017700     EXEC SQL                                                     01770000
017800          INCLUDE TKRPRPM                                         01780000
017900     END-EXEC.                                                    01790000
018000                                                                  01800000
018100*---------------------------------------------------------------* 01810000
018200*    DB2 AREA FOR XLT_MDSE_INV_PARM-INVENTORY PARAMENTERS TABLE * 01820000
018300*---------------------------------------------------------------* 01830000
018400     EXEC SQL                                                     01840000
018500          INCLUDE XLT00025                                        01850000
018600     END-EXEC.                                                    01860000
018610******************************************************************01861001
018620*    DB2 DCLGEN WFT_LOD_CNTL                                      01862001
018630******************************************************************01863001
018640     EXEC SQL                                                     01864001
018650          INCLUDE WFT00001                                        01865001
018660     END-EXEC.                                                    01866001
018670                                                                  01867001
018680******************************************************************01868001
018690*    DB2 DCLGEN WFT_LOD_XFER                                      01869001
018691******************************************************************01869101
018692     EXEC SQL                                                     01869201
018693          INCLUDE WFT00002                                        01869301
018694     END-EXEC.                                                    01869401
018700******************************************************************01870000
018800* INPUT LAYOUT                                                    01880000
018900******************************************************************01890000
019000     COPY RCRD097.                                                01900001
019100                                                                  01910000
019200******************************************************************01920000
019300*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     01930000
019400******************************************************************01940000
019500     COPY DPWS004.                                                01950000
019600                                                                  01960000
019700 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01970000
019800                                                   COMP SYNC.     01980000
019900 01  PA-PROGRAM-ACCUMULATORS.                                     01990000
020000     05  PA-TO-VERIFY-QTY             PIC S9(09) VALUE +0 COMP-3. 02000000
020100     05  PA-TOTALS.                                               02010000
020200         10 PA-TOTAL-RECORDS-READ     PIC S9(09) VALUE +0 COMP-3. 02020000
020300         10 PA-TOTAL-UNITS-PROCESSED  PIC S9(09) VALUE +0 COMP-3. 02030000
020400         10 PA-TOTAL-ERROR-RECS       PIC S9(09) VALUE +0 COMP-3. 02040000
020500         10 PA-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02050000
020600         10 PA-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02060000
020700         10 PA-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02070000
020800         10 PA-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02080000
020900         10 PA-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02090000
021000         10 PA-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02100000
021100         10 PA-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02110000
021200         10 PA-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 02120000
021300         10 PA-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 02130000
021400         10 PT-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02140000
021500         10 PT-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02150000
021600         10 PT-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02160000
021700         10 PT-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02170000
021800         10 PT-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02180000
021900         10 PT-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02190000
022000         10 PT-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02200000
022100         10 PT-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 02210000
022200         10 PT-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 02220000
022300         10 PA-TOTAL-DB2-COMMITS      PIC S9(09) VALUE +0 COMP-3. 02230000
022400                                                                  02240000
022500 01  PS-PROGRAM-SWITCHES.                                         02250000
022600     05  PS-SAME-PO-SW               PIC X(01) VALUE 'N'.         02260000
022700         88  PS-SAME-PO-YES                    VALUE 'Y'.         02270000
022800         88  PS-SAME-PO-NO                     VALUE 'N'.         02280000
022900     05  PS-SAME-PO-LNE-SW           PIC X(01) VALUE 'N'.         02290000
023000         88  PS-SAME-PO-LNE-YES                VALUE 'Y'.         02300000
023100         88  PS-SAME-PO-LNE-NO                 VALUE 'N'.         02310000
023200     05  PS-DC-FLUSH-SW              PIC X(01) VALUE 'N'.         02320000
023300         88  PS-DC-FLUSH-YES                   VALUE 'Y'.         02330000
023400         88  PS-DC-FLUSH-NO                    VALUE 'N'.         02340000
023500     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         02350000
023600         88  PS-END-OF-INPUT                   VALUE 'Y'.         02360000
023700         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         02370000
023800     05  PS-TRECVER-CURSOR-SW          PIC  X(01)  VALUE 'N'.     02380000
023900         88  PS-EOF-TRECVER-CSR               VALUE 'Y'.          02390000
024000     05  PS-PKSLIP-INSERTED-SW         PIC  X(01)  VALUE 'N'.     02400000
024100         88  PS-PKSLIP-NOT-INSERTED           VALUE 'N'.          02410000
024200         88  PS-PKSLIP-INSERTED               VALUE 'Y'.          02420000
024300     05  PS-ERROR-SW                   PIC  X(01)    VALUE 'N'.   02430000
024400         88  PS-ERROR-YES                            VALUE 'Y'.   02440000
024500         88  PS-ERROR-NO                             VALUE 'N'.   02450000
024600 01  PC-PROGRAM-CONSTANTS.                                        02460000
024700     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'RCKUP992'.  02470000
024800     05  PC-ITEM                    PIC X(04)  VALUE 'ITEM'.      02480000
024900     05  PC-HDR                     PIC X(03)  VALUE 'HDR'.       02490000
025000     05  PC-DTL                     PIC X(03)  VALUE 'DTL'.       02500000
025100     05  PC-GFT                     PIC X(03)  VALUE 'GFT'.       02510000
025200     05  PC-END                     PIC X(03)  VALUE 'END'.       02520000
025300     05  PC-N                       PIC X(01)  VALUE 'N'.         02530000
025400     05  PC-READY                   PIC X(06)  VALUE 'READY '.    02540000
025500     05  PC-CMPLTD                  PIC X(06)  VALUE 'CMPLTD'.    02550000
025600     05  PC-DEFAULT-TMST            PIC X(26)  VALUE              02560000
025700                                    '0001-01-01-00.00.00.000000'. 02570000
025800     05  PC-END-RUN-MSG             PIC X(18)  VALUE              02580000
025900                                            'END RUN OF PROGRAM'. 02590000
026000                                                                  02600000
026100 01  DK-DB2-KEYS.                                                 02610000
026200     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   02620000
026300     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    02630000
026400     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   02640000
026500     05  DK-LNE-NBR                   PIC S9(09) COMP VALUE +0.   02650000
026600     05  DK-HOLD-PO-NBR               PIC S9(09) COMP VALUE +0.   02660000
026700     05  DK-HOLD-LNE-NBR              PIC S9(09) COMP VALUE +0.   02670000
026800                                                                  02680000
026900 01  PV-BKUP-RECORDS.                                             02690000
027000     05  PV-BKUP-RECORD-1.                                        02700000
027100         10  FILLER                 PIC X(07)  VALUE 'PO NBR '.   02710000
027200         10  PV-BKUP-PO-NBR-1       PIC 9(09).                    02720000
027300         10  FILLER                 PIC X(10)  VALUE              02730000
027400                                                  '  LNE NBR '.   02740000
027500         10  PV-BKUP-PO-LNE-1       PIC 9(04).                    02750000
027600         10  FILLER                 PIC X(10)  VALUE              02760000
027700                                                  '  STR NBR '.   02770000
027800         10  PV-BKUP-STR-NBR-1      PIC 9(05).                    02780000
027900         10  FILLER                 PIC X(09)  VALUE              02790000
028000                                                   '  VE QTY '.   02800000
028100         10  PV-BKUP-TO-VERIFY-QTY-1 PIC 9(09).                   02810000
028200         10  FILLER                 PIC X(07)  VALUE SPACES.      02820000
028300     05  PV-BKUP-RECORD-2.                                        02830000
028400         10  FILLER                 PIC X(14)  VALUE              02840000
028500                                              'PO / RECEIVER '.   02850000
028600         10  PV-BKUP-PO-NBR-2       PIC 9(09).                    02860000
028700         10  FILLER                 PIC X(01)  VALUE SPACE.       02870000
028800         10  PV-BKUP-REC-SEQ-2      PIC 9(09).                    02880000
028900         10  FILLER                 PIC X(47)  VALUE SPACE.       02890000
029000                                                                  02900000
029100 01  PV-PROGRAM-VARIABLES.                                        02910000
029200     05  PV-SEQ-NBR-IND             PIC S9(04) VALUE +0           02920000
029300                                                  COMP.           02930000
029400     05  PV-NEXT-SEQ-NBR            PIC S9(04) VALUE +0           02940000
029500                                                 COMP.            02950000
029600     05  PV-SAVE-PKSLIP-SEQ-NBR     PIC S9(04) VALUE +0           02960000
029700                                                 COMP.            02970000
029800     05  PV-MAX-SEQ-NBR             PIC S9(04) VALUE +0           02980000
029900                                                 COMP.            02990000
030000     05  PV-COUNT                   PIC S9(04) VALUE +0           03000000
030100                                                 COMP.            03010000
030200     05  PV-DB2-COUNT               PIC S9(09)  VALUE +0          03020000
030300                                                 COMP-3.          03030000
030400     05  PV-WORK-DATE-PLUS-7        PIC  X(10)  VALUE ZEROS.      03040000
030500     05  PV-DISP-PO                 PIC 9(09).                    03050000
030600     05  PV-DISP-REC-SEQ            PIC 9(09).                    03060000
030700     05  PV-DISP-LINE-NBR           PIC 9(09).                    03070000
030800     05  PV-DISP-TYP-CDE            PIC 9(04).                    03080000
030900     05  PV-DISP-STR-NBR            PIC 9(09).                    03090000
031000     05  PV-DISP-SQLCODE            PIC -9(09).                   03100000
031100     05  PV-DISP-SEQ                PIC 9(09).                    03110000
031200     05  PW-CONTROL-REC.                                          03120000
031300         10  PW-CONTROL-KEYREC.                                   03130000
031400             20  PW-CONTROL-PANL-NBR.                             03140000
031500                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   03150000
031600                 30  PW-CONTROL-KEYREC-NBR                        03160000
031700                                         PIC 9(02)  VALUE ZERO.   03170000
031800             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  03180000
031900                                       PW-CONTROL-PANL-NBR        03190000
032000                                         PIC 9(7).                03200000
032100             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   03210000
032200         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      03220000
032300                                         PIC 9(08).               03230000
032400         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  03240000
032500                                                                  03250000
032600     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   03260000
032700     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   03270000
032800     05  PV-PARAGRAPH               PIC X(48)  VALUE SPACES.      03280000
032900     05  PV-REC-SEQ-NBR             PIC S9(09) VALUE +0 COMP.     03290000
033000     05  PV-MSG-LENGTH              PIC S9(9)  BINARY.            03300000
033100                                                                  03310000
033200     05  PV-RECEIPT-ADJUSTMENT-REC.                               03320000
033300         10  PV-HEADER-DATA.                                      03330000
033400             15  PV-ORDER-NUMBER               PIC 9(09).         03340000
033500             15  PV-RCVR-ID                    PIC 9(09).         03350000
033600             15  PV-DC                         PIC 9(04).         03360000
033700             15  PV-SKU                        PIC 9(08).         03370000
033800             15  PV-VRFY-DATE                  PIC X(14).         03380000
033900             15  PV-STORE-COUNT                PIC 9(04).         03390000
034000             15  FILLER                        PIC X(52).         03400000
034100         10  PV-STORE-DATA OCCURS 1 TO 100 TIMES                  03410000
034200                              DEPENDING ON PV-STORE-COUNT         03420000
034300                              INDEXED BY PV-IDX.                  03430000
034400             15  PV-STORE                      PIC 9(04).         03440000
034500             15  PV-STORE-QTY                  PIC 9(09).         03450000
034600             15  PV-STORE-QTY-SIGN             PIC X(01).         03460000
034700                                                                  03470000
034800 01  PV-DB2-TMST                      PIC X(26).                  03480000
034900 01  FILLER  REDEFINES  PV-DB2-TMST.                              03490000
035000         10  PV-DB2-TMST-CCYY         PIC X(04).                  03500000
035100         10  FILLER                   PIC X(01).                  03510000
035200         10  PV-DB2-TMST-MO           PIC X(02).                  03520000
035300         10  FILLER                   PIC X(01).                  03530000
035400         10  PV-DB2-TMST-DA           PIC X(02).                  03540000
035500         10  FILLER                   PIC X(01).                  03550000
035600         10  PV-DB2-TMST-HH           PIC X(02).                  03560000
035700         10  FILLER                   PIC X(01).                  03570000
035800         10  PV-DB2-TMST-MM           PIC X(02).                  03580000
035900         10  FILLER                   PIC X(01).                  03590000
036000         10  PV-DB2-TMST-SS           PIC X(02).                  03600000
036100             88  PV-DB2-TMST-SS-01               VALUE '01'.      03610000
036200         10  FILLER                   PIC X(01).                  03620000
036300         10  PV-DB2-TMST-MS           PIC X(06).                  03630000
036400             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  03640000
036500*PV-MSG IS WHAT GETS BROKEN DOWN INTO DTLS/GFTS/END               03650000
036600 01  PV-MSG.                                                      03660000
036700     05  PV-MSG-END                 PIC X(18).                    03670000
036800         88 PV-END-RUN-MSG          VALUE 'END RUN OF PROGRAM'.   03680000
036900     05  FILLER                     PIC X(432).                   03690000
037000                                                                  03700000
037100 01  PV-DTL.                                                      03710000
037200     05  PV-DTL-EVENT               PIC 9(03)   VALUE ZERO.       03720000
037300     05  FILLER                     PIC X(447)  VALUE SPACE.      03730000
037400                                                                  03740000
037500 01  PV-HOLD-FIELDS.                                              03750000
037600     05  PV-HOLD-PO-NBR             PIC  9(09).                   03760000
037700     05  PV-HOLD-CRE-UID            PIC  X(08).                   03770000
037800     05  PV-HOLD-PO-LNE-NBR         PIC  9(04).                   03780000
037900     05  PV-HOLD-REC-SEQ-NBR        PIC S9(09) VALUE +0.          03790000
038000     05  PV-HOLD-SEQ-NBR            PIC S9(04) VALUE +0           03800000
038100                                                 COMP.            03810000
038200                                                                  03820000
038300 01  PV-ABEND-VARIABLES.                                          03830000
038400     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.03840000
038500     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 03850000
038600     88  ABEND-4002-READ-ERROR                       VALUE +4002. 03860000
038700     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 03870000
038800     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 03880000
038900     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 03890000
039000     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 03900000
039100     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 03910000
039200     88  ABEND-4008-DATA-ERROR                       VALUE +4008. 03920000
039300     88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 03930000
039400     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 03940000
039500     88  ABEND-4019-CAL-SUB-ERROR                    VALUE +4019. 03950000
039600     88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 03960000
039700                                                                  03970000
039800*                                                                 03980000
039900*                                                                 03990000
040000****************************************************************  04000000
040100 PROCEDURE DIVISION.                                              04010000
040200******************************************************************04020000
040300 0000-PROGRAM-MAINLINE.                                           04030000
040400     DISPLAY '************ START OF RCKUP992 ***************'     04040000
040500                                                                  04050000
040600*INIT VARIBLES, SET SWITHCES.                                     04060000
040700     PERFORM 1000-INITIALIZE.                                     04070000
040800                                                                  04080000
040900                                                                  04090000
041000     SET PS-NOT-END-OF-INPUT TO TRUE.                             04100000
041100                                                                  04110000
041200     OPEN INPUT  INPUT-FILE                                       04120000
041300     OPEN OUTPUT ERROR-FILE                                       04130000
041400                 BKUP-FILE                                        04140000
041500     PERFORM 4000-READ-RECORD                                     04150000
041600     IF NOT PS-END-OF-INPUT                                       04160000
041700         SET PS-SAME-PO-NO                                        04170000
041800             PS-SAME-PO-LNE-YES TO TRUE                           04180000
041900         MOVE RC097-PO-NBR      TO PV-HOLD-PO-NBR                 04190001
042000         MOVE RC097-CRE-UID     TO PV-HOLD-CRE-UID                04200001
042100         MOVE RC097-PO-LNE-NBR  TO PV-HOLD-PO-LNE-NBR             04210001
042200         PERFORM 2000-PROCESS-INPUT                               04220000
042300             UNTIL PS-END-OF-INPUT                                04230000
042400         IF PS-ERROR-NO                                           04240000
042500             PERFORM 2200-ADD-TPKITEM                             04250000
042600         END-IF                                                   04260000
042700         IF PS-ERROR-NO                                           04270000
042800             PERFORM 2400-ADD-RECITM                              04280000
042900         END-IF                                                   04290000
043000     END-IF.                                                      04300000
043100                                                                  04310000
043200     PERFORM 5000-END-RUN-ROUTINE.                                04320000
043300                                                                  04330000
043400******************************************************************04340000
043500* INITIALIZE VARIABLES.                                           04350000
043600* SET SWITCHES.                                                   04360000
043700******************************************************************04370000
043800 1000-INITIALIZE.                                                 04380000
043900                                                                  04390000
044000     INITIALIZE   PA-TOTAL-TRECEIV-INSERTS                        04400000
044100                  PA-TOTAL-TRECEIV-UPDATES                        04410000
044200                  PA-TOTAL-TPKITEM-INSERTS                        04420000
044300                  PA-TOTAL-TRECITM-INSERTS                        04430000
044400                  PA-TOTAL-TRECDIS-INSERTS                        04440000
044500                  PA-TOTAL-WFT-CNTL-INSERTS                       04450000
044600                  PA-TOTAL-WFT-XFER-INSERTS                       04460000
044700                  PA-TOTAL-TPKSLIP-INSERTS                        04470000
044800                  PA-TOTAL-TPKSLIP-UPDATES                        04480000
044900                  PA-TOTAL-DB2-COMMITS                            04490000
045000                  PV-HOLD-FIELDS                                  04500000
045100                  PV-MSG-LENGTH.                                  04510000
045200                                                                  04520000
045300*INIT SWITCHES USED FOR EDITING EACH MSG, AND CONTINUING RUN OF   04530000
045400*PROGRAM.                                                         04540000
045500                                                                  04550000
045600****************************************************************  04560000
045700* INIT SOME FIELDS BEFORE THE NEXT ITEM IS PROCESSED.             04570000
045800* RESET SOME SWITCHES.                                            04580000
045900****************************************************************  04590000
046000 1300-REINITIALIZE.                                               04600000
046100                                                                  04610000
046200     SET PS-ERROR-NO  TO TRUE.                                    04620000
046300                                                                  04630000
046400******************************************************************04640000
046500* BREAKDOWN AND EDIT INPUT.                                       04650000
046600* EDIT DB2 TABLES                                                 04660000
046700* GET THE NEXT RECORD                                             04670000
046800******************************************************************04680000
046900 2000-PROCESS-INPUT.                                              04690000
047000                                                                  04700000
047100     MOVE 0    TO PT-TOTAL-TPKSLIP-INSERTS                        04710000
047200                  PT-TOTAL-TPKSLIP-UPDATES                        04720000
047300*                 PT-TOTAL-TPKITEM-INSERTS                        04730000
047400                  PT-TOTAL-TRECEIV-INSERTS                        04740000
047500                  PT-TOTAL-TRECEIV-UPDATES                        04750000
047600*                 PT-TOTAL-TRECITM-INSERTS                        04760000
047700                  PT-TOTAL-TRECDIS-INSERTS.                       04770000
047800                                                                  04780000
047900     MOVE RC097-PO-NBR      TO DK-PO-NBR.                         04790001
048000     MOVE RC097-PO-LNE-NBR  TO DK-LNE-NBR                         04800001
048100                                                                  04810000
048200     MOVE RC097-STR-NBR      TO RECDIS-STR-NBR.                   04820001
048300     IF PS-SAME-PO-NO                                             04830000
048400         SET PS-DC-FLUSH-NO      TO TRUE                          04840000
048500         PERFORM 2250-CHECK-DC-FLUSH-PARM                         04850000
048600     END-IF.                                                      04860000
048700     IF PS-DC-FLUSH-YES                                           04870000
048800         PERFORM 2275-CHECK-INV-IN-PROCESS                        04880000
048900     END-IF.                                                      04890000
049000                                                                  04900000
049100     IF PS-ERROR-NO                                               04910000
049200         IF PS-SAME-PO-NO                                         04920000
049300             PERFORM 2100-ADD-PACK-SLIP-HEADER                    04930000
049400         ELSE                                                     04940000
049500             PERFORM 2160-UPDATE-PACK-SLIP-HEADER                 04950000
049600         END-IF                                                   04960000
049700     END-IF.                                                      04970000
049800                                                                  04980000
049900     IF PS-ERROR-NO                                               04990000
050000         IF PS-SAME-PO-NO                                         05000000
050100             IF PV-HOLD-REC-SEQ-NBR = ZERO                        05010000
050200                 MOVE PV-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR       05020000
050300             END-IF                                               05030000
050400             IF PV-HOLD-SEQ-NBR = ZERO                            05040000
050500                 MOVE PV-NEXT-SEQ-NBR TO PV-HOLD-SEQ-NBR          05050000
050600             END-IF                                               05060000
050700         END-IF                                                   05070000
050800     END-IF.                                                      05080000
050900                                                                  05090000
051000     IF PS-ERROR-NO                                               05100000
051100         IF PS-SAME-PO-NO                                         05110000
051200             PERFORM 2300-BUILD-RECEIVER-INFO                     05120000
051300         ELSE                                                     05130000
051400             PERFORM 2350-UPDATE-RECEIVER-INFO                    05140000
051500     END-IF.                                                      05150000
051600                                                                  05160000
051700     IF PS-SAME-PO-LNE-NO                                         05170000
051800         IF PS-ERROR-NO                                           05180000
051900             PERFORM 2200-ADD-TPKITEM                             05190000
052000         END-IF                                                   05200000
052100         IF PS-ERROR-NO                                           05210000
052200             PERFORM 2400-ADD-RECITM                              05220000
052300         END-IF                                                   05230000
052400         MOVE RC097-PO-NBR        TO PV-HOLD-PO-NBR               05240001
052500         MOVE RC097-CRE-UID       TO PV-HOLD-CRE-UID              05250001
052600         MOVE RC097-PO-LNE-NBR    TO PV-HOLD-PO-LNE-NBR           05260001
052700         MOVE RC097-TO-VERIFY-QTY TO PA-TO-VERIFY-QTY             05270001
052800         IF PV-REC-SEQ-NBR NOT = PV-HOLD-REC-SEQ-NBR              05280000
052900             MOVE PV-REC-SEQ-NBR  TO PV-HOLD-REC-SEQ-NBR          05290000
053000         END-IF                                                   05300000
053100         IF PV-NEXT-SEQ-NBR NOT = PV-HOLD-SEQ-NBR                 05310000
053200             MOVE PV-NEXT-SEQ-NBR TO PV-HOLD-SEQ-NBR              05320000
053300         END-IF                                                   05330000
053400     ELSE                                                         05340000
053500         ADD RC097-TO-VERIFY-QTY  TO PA-TO-VERIFY-QTY             05350001
053600     END-IF.                                                      05360000
053700                                                                  05370000
053800     IF PS-ERROR-NO                                               05380000
053900         PERFORM 2500-PREPARE-TRECDIS                             05390000
054000     END-IF.                                                      05400000
054100                                                                  05410000
054110     IF PS-ERROR-NO                                               05411001
054120         PERFORM 2600-INSERT-WFT-LOD-CNTL                         05412001
054130     END-IF.                                                      05413001
054140                                                                  05414001
054150     IF PS-ERROR-NO                                               05415001
054160         PERFORM 2700-INSERT-WFT-LOD-XFER                         05416001
054170     END-IF.                                                      05417001
054200                                                                  05420000
054300*IF NO ERRORS, JUST CONTINUE,                                     05430000
054400*ELSE REINIT AND RESET SWITCHES AND GO AFTER THE NEXT MSG         05440000
054500*(NEW ITEM) ON THE QUEUE.                                         05450000
054600     IF PS-ERROR-YES                                              05460000
054700         WRITE ERROR-RECORD FROM RC097-ITEM-REC                   05470001
054800         ADD +1 TO PA-TOTAL-ERROR-RECS                            05480000
054900*       PERFORM 7100-ERROR-ROUTINE                                05490000
055000     END-IF.                                                      05500000
055100                                                                  05510000
055200     IF PS-ERROR-NO                                               05520000
055300         PERFORM 6000-DB2-COMMIT                                  05530000
055400         CONTINUE                                                 05540000
055500     ELSE                                                         05550000
055600         PERFORM 6100-DB2-ROLLBACK                                05560000
055700     END-IF.                                                      05570000
055800                                                                  05580000
055900     PERFORM 1300-REINITIALIZE.                                   05590000
056000                                                                  05600000
056100     PERFORM 4000-READ-RECORD                                     05610000
056200     IF NOT PS-END-OF-INPUT                                       05620000
056300         IF RC097-PO-NBR = DK-PO-NBR                              05630001
056400             SET PS-SAME-PO-YES TO TRUE                           05640000
056500             IF RC097-PO-LNE-NBR = DK-LNE-NBR                     05650001
056600                 SET PS-SAME-PO-LNE-YES TO TRUE                   05660000
056700             ELSE                                                 05670000
056800                 SET PS-SAME-PO-LNE-NO  TO TRUE                   05680000
056900             END-IF                                               05690000
057000         ELSE                                                     05700000
057100             SET PS-SAME-PO-NO                                    05710000
057200                 PS-SAME-PO-LNE-NO      TO TRUE                   05720000
057300         END-IF                                                   05730000
057400     END-IF.                                                      05740000
057500                                                                  05750000
057600******************************************************************05760000
057700* INSERT, UPDATE OR DELETE TABLES.                                05770000
057800* DB2 COMMIT.                                                     05780000
057900******************************************************************05790000
058000 2100-ADD-PACK-SLIP-HEADER.                                       05800000
058100                                                                  05810000
058200     INITIALIZE DCLTPKSLIP.                                       05820000
058300     MOVE RC097-PO-NBR             TO PKSLIP-PO-NBR.              05830001
058400     MOVE RC097-OPER-UNIT          TO PKSLIP-OPER-UNT-ID.         05840001
058500     MOVE 1                        TO PKSLIP-FCLTY-ID.            05850000
058600     MOVE RC097-PO-NBR (3:7)       TO PKSLIP-PKSL-NBR.            05860001
058700     MOVE ZERO                     TO PKSLIP-STR-DEST-NBR.        05870000
058800     MOVE ZERO                     TO PKSLIP-PKSL-PG-CNT.         05880000
058900                                                                  05890000
059000     MOVE 1                        TO PKSLIP-EXPTED-PKG-QTY.      05900000
059100                                                                  05910000
059200     MOVE SPACES                   TO PKSLIP-OWNER-SCAC-ID.       05920000
059300     MOVE SPACES                   TO PKSLIP-ASN-NBR.             05930000
059400     MOVE SPACES                   TO PKSLIP-CONTNR-ID.           05940000
059500     MOVE ZERO                     TO PKSLIP-SHIPT-ID.            05950000
059600     MOVE SPACES                   TO PKSLIP-BOL-NBR.             05960000
059700     MOVE SPACES                   TO PKSLIP-PRO-NBR.             05970000
059800     MOVE SPACES                   TO PKSLIP-CRE-SRC-CDE.         05980000
059900     MOVE 'AC'                     TO PKSLIP-PKSL-STAT-CDE.       05990000
060000     MOVE RC097-CRE-UID            TO PKSLIP-CRE-UID.             06000001
060100                                                                  06010000
060200     PERFORM 2110-GET-PO-VER-NBR.                                 06020000
060300     IF PS-ERROR-NO                                               06030000
060400         MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR       06040000
060500                                                                  06050000
060600         PERFORM 2120-GET-NEXT-SEQ-NBR                            06060000
060700     END-IF.                                                      06070000
060800                                                                  06080000
060900     IF PS-ERROR-NO                                               06090000
061000         MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR          06100000
061100                                                                  06110000
061200         SET PS-PKSLIP-NOT-INSERTED    TO TRUE                    06120000
061300                                                                  06130000
061400         PERFORM 2130-GET-MAX-SEQ-NBR                             06140000
061500     END-IF.                                                      06150000
061600                                                                  06160000
061700     IF PS-ERROR-NO                                               06170000
061800         MOVE PV-REC-SEQ-NBR           TO PKSLIP-REC-SEQ-NBR      06180000
061900                                                                  06190000
062000         EXEC SQL                                                 06200000
062100              SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP       06210000
062200         END-EXEC                                                 06220000
062300                                                                  06230000
062400         SET PV-DB2-TMST-SS-01                                    06240000
062500             PV-DB2-TMST-MS-ZERO   TO  TRUE                       06250000
062600         PERFORM 2140-INSERT-LOOP                                 06260000
062700             UNTIL PS-PKSLIP-INSERTED                             06270000
062800                OR PS-ERROR-YES                                   06280000
062900     END-IF.                                                      06290000
063000                                                                  06300000
063100 2110-GET-PO-VER-NBR.                                             06310000
063200                                                                  06320000
063300     EXEC SQL                                                     06330000
063400          SELECT VER_NBR                                          06340000
063500            INTO :PURCHS-VER-NBR                                  06350000
063600            FROM TPURCHS                                          06360000
063700           WHERE PO_NBR         = :DK-PO-NBR                      06370000
063800             AND VER_STATUS_CDE = 'A'                             06380000
063900     END-EXEC.                                                    06390000
064000                                                                  06400000
064100     EVALUATE TRUE                                                06410000
064200         WHEN SQLCODE = +0                                        06420000
064300              CONTINUE                                            06430000
064400         WHEN SQLCODE = +100                                      06440000
064500             MOVE DK-PO-NBR   TO PV-DISP-PO                       06450000
064600             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06460000
064700             MOVE '2110-GET-PO-VER-NBR'                           06470000
064800                              TO RC097-ERROR-PARA-NAME            06480001
064900             SET RC097-PO-NOF                                     06490001
065000                 PS-ERROR-YES    TO TRUE                          06500000
065100             DISPLAY '******************************************' 06510000
065200             DISPLAY '*ABEND                                   *' 06520000
065300             DISPLAY '*PROGRAM   = RCKUP992                    *' 06530000
065400             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 06540000
065500             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 06550000
065600             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06560000
065700             DISPLAY '*PO = ' PV-DISP-PO                          06570000
065800             DISPLAY '******************************************' 06580000
065900                                                                  06590000
066000         WHEN SQLWARN0 NOT = SPACES                               06600000
066100         WHEN SQLCODE < +0                                        06610000
066200         WHEN SQLCODE > +0                                        06620000
066300             MOVE DK-PO-NBR   TO PV-DISP-PO                       06630000
066400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06640000
066500             MOVE '2110-GET-PO-VER-NBR'                           06650000
066600                              TO RC097-ERROR-PARA-NAME            06660001
066700             SET RC097-DB-ERROR                                   06670001
066800                 PS-ERROR-YES    TO TRUE                          06680000
066900             DISPLAY '******************************************' 06690000
067000             DISPLAY '*ABEND                                   *' 06700000
067100             DISPLAY '*PROGRAM   = RCKUP992                    *' 06710000
067200             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 06720000
067300             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 06730000
067400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06740000
067500             DISPLAY '*PO = ' PV-DISP-PO                          06750000
067600             DISPLAY '******************************************' 06760000
067700     END-EVALUATE.                                                06770000
067800                                                                  06780000
067900 2120-GET-NEXT-SEQ-NBR.                                           06790000
068000                                                                  06800000
068100     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             06810000
068200                                                                  06820000
068300     EXEC SQL                                                     06830000
068400          SELECT MAX(SEQ_NBR)                                     06840000
068500            INTO :PV-MAX-SEQ-NBR :PV-SEQ-NBR-IND                  06850000
068600            FROM TPKSLIP                                          06860000
068700           WHERE PO_NBR = :DK-PO-NBR                              06870000
068800     END-EXEC.                                                    06880000
068900                                                                  06890000
069000     EVALUATE TRUE                                                06900000
069100         WHEN SQLCODE = +0                                        06910000
069200              COMPUTE PV-NEXT-SEQ-NBR =                           06920000
069300                      PV-MAX-SEQ-NBR + 1                          06930000
069400                                                                  06940000
069500         WHEN SQLCODE = +100                                      06950000
069600              MOVE +1          TO PV-NEXT-SEQ-NBR                 06960000
069700                                                                  06970000
069800         WHEN SQLWARN0 NOT = SPACES                               06980000
069900         WHEN SQLCODE < +0                                        06990000
070000         WHEN SQLCODE > +0                                        07000000
070100             MOVE DK-PO-NBR   TO PV-DISP-PO                       07010000
070200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  07020000
070300             MOVE '2120-GET-NEXT-SEQ-NBR'                         07030000
070400                              TO RC097-ERROR-PARA-NAME            07040001
070500             SET RC097-DB-ERROR                                   07050001
070600                 PS-ERROR-YES    TO TRUE                          07060000
070700             DISPLAY '******************************************' 07070000
070800             DISPLAY '*ABEND                                   *' 07080000
070900             DISPLAY '*PROGRAM   = RCKUP992                    *' 07090000
071000             DISPLAY '*DB2 OPER  = SELECT ON TPKSLIP           *' 07100000
071100             DISPLAY '*PARAGRAPH = 2120-GET-NEXT-SEQ-NBR       *' 07110000
071200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                07120000
071300             DISPLAY '*PO = ' PV-DISP-PO                          07130000
071400             DISPLAY '******************************************' 07140000
071500     END-EVALUATE.                                                07150000
071600                                                                  07160000
071700*----------------------------------------------------------------*07170000
071800* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *07180000
071900*----------------------------------------------------------------*07190000
072000 2130-GET-MAX-SEQ-NBR.                                            07200000
072100                                                                  07210000
072200     EXEC SQL                                                     07220000
072300         SELECT MAX(REC_SEQ_NBR)                                  07230000
072400         INTO  :RECEIV-REC-SEQ-NBR                                07240000
072500         FROM   TRECEIV                                           07250000
072600         WHERE  ORD_NBR = :DK-PO-NBR                              07260000
072700     END-EXEC.                                                    07270000
072800                                                                  07280000
072900     EVALUATE TRUE                                                07290000
073000         WHEN SQLCODE = +0                                        07300000
073100             MOVE RECEIV-REC-SEQ-NBR                              07310000
073200                             TO PV-REC-SEQ-NBR                    07320000
073300             ADD +1          TO PV-REC-SEQ-NBR                    07330000
073400         WHEN SQLCODE = +100                                      07340000
073500         WHEN SQLCODE = -305                                      07350000
073600             MOVE +1         TO PV-REC-SEQ-NBR                    07360000
073700                                                                  07370000
073800         WHEN SQLWARN0 NOT = SPACE                                07380000
073900         WHEN SQLCODE < +0                                        07390000
074000         WHEN SQLCODE > +0                                        07400000
074100             MOVE SQLCODE TO PV-DISP-SQLCODE                      07410000
074200             MOVE DK-PO-NBR   TO PV-DISP-PO                       07420000
074300             MOVE '2130-GET-MAX-SEQ-NBR'                          07430000
074400                              TO RC097-ERROR-PARA-NAME            07440001
074500             SET RC097-DB-ERROR                                   07450001
074600                 PS-ERROR-YES    TO TRUE                          07460000
074700             DISPLAY '******************************************' 07470000
074800             DISPLAY '*ABEND                                   *' 07480000
074900             DISPLAY '*PROGRAM   = RCKUP992                    *' 07490000
075000             DISPLAY '*DB2 OPER  = SELECT ON TRECEIV           *' 07500000
075100             DISPLAY '*PARAGRAPH = 2130-GET-MAX-SEQ-NBR        *' 07510000
075200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                07520000
075300             DISPLAY '*PO = ' PV-DISP-PO                          07530000
075400             DISPLAY '******************************************' 07540000
075500     END-EVALUATE.                                                07550000
075600                                                                  07560000
075700*----------------------------------------------------------------*07570000
075800*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *07580000
075900*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *07590000
076000*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *07600000
076100*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMSTAMP IS PART   *07610000
076200*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *07620000
076300*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *07630000
076400*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *07640000
076500*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *07650000
076600*----------------------------------------------------------------*07660000
076700                                                                  07670000
076800 2140-INSERT-LOOP.                                                07680000
076900                                                                  07690000
077000     MOVE PKSLIP-SEQ-NBR  TO PV-SAVE-PKSLIP-SEQ-NBR.              07700000
077100                                                                  07710000
077200     PERFORM 2150-INSERT-TPKSLIP.                                 07720000
077300                                                                  07730000
077400     EVALUATE TRUE                                                07740000
077500         WHEN SQLCODE EQUAL ZERO                                  07750000
077600              SET PS-PKSLIP-INSERTED                              07760000
077700                                   TO TRUE                        07770000
077800                                                                  07780000
077900         WHEN SQLCODE EQUAL -803                                  07790000
078000              ADD 1                TO PKSLIP-SEQ-NBR              07800000
078100                                                                  07810000
078200     END-EVALUATE.                                                07820000
078300                                                                  07830000
078400                                                                  07840000
078500 2150-INSERT-TPKSLIP.                                             07850000
078600                                                                  07860000
078700     EXEC SQL                                                     07870000
078800          INSERT INTO TPKSLIP                                     07880000
078900                 (PO_NBR                                          07890000
079000               ,  SEQ_NBR                                         07900000
079100               ,  CRE_TMST                                        07910000
079200               ,  VER_STAT_CDE                                    07920000
079300               ,  OPER_UNT_ID                                     07930000
079400               ,  FCLTY_ID                                        07940000
079500               ,  PKSL_NBR                                        07950000
079600               ,  STR_DEST_NBR                                    07960000
079700               ,  REC_SEQ_NBR                                     07970000
079800               ,  SHIPT_ID                                        07980000
079900               ,  BOL_NBR                                         07990000
080000               ,  PRO_NBR                                         08000000
080100               ,  PKSL_STAT_CDE                                   08010000
080200               ,  CRE_UID                                         08020000
080300               ,  PO_VER_NBR                                      08030000
080400               ,  CRE_SRC_CDE                                     08040000
080500               ,  EXPTED_PKG_QTY                                  08050000
080600               ,  OWNER_SCAC_ID                                   08060000
080700               ,  ASN_NBR                                         08070000
080800               ,  VEND_SHIP_DTE                                   08080000
080900               ,  PKSL_PG_CNT                                     08090000
081000               ,  CONTNR_ID                                       08100000
081100               ,  ORIG_PKSL_SEQ_NBR)                              08110000
081200          VALUES (:PKSLIP-PO-NBR                                  08120000
081300               ,  :PKSLIP-SEQ-NBR                                 08130000
081400               ,  :PV-DB2-TMST                                    08140000
081500               ,  'A'                                             08150000
081600               ,  :PKSLIP-OPER-UNT-ID                             08160000
081700               ,  :PKSLIP-FCLTY-ID                                08170000
081800               ,  :PKSLIP-PKSL-NBR                                08180000
081900               ,  :PKSLIP-STR-DEST-NBR                            08190000
082000               ,  :PKSLIP-REC-SEQ-NBR                             08200000
082100               ,  :PKSLIP-SHIPT-ID                                08210000
082200               ,  :PKSLIP-BOL-NBR                                 08220000
082300               ,  :PKSLIP-PRO-NBR                                 08230000
082400               ,  :PKSLIP-PKSL-STAT-CDE                           08240000
082500               ,  :PKSLIP-CRE-UID                                 08250000
082600               ,  :PKSLIP-PO-VER-NBR                              08260000
082700               ,  :PKSLIP-CRE-SRC-CDE                             08270000
082800               ,  :PKSLIP-EXPTED-PKG-QTY                          08280000
082900               ,  :PKSLIP-OWNER-SCAC-ID                           08290000
083000               ,  :PKSLIP-ASN-NBR                                 08300000
083100               ,  CURRENT_DATE                                    08310000
083200               ,  :PKSLIP-PKSL-PG-CNT                             08320000
083300               ,  :PKSLIP-CONTNR-ID                               08330000
083400               ,  :PKSLIP-ORIG-PKSL-SEQ-NBR)                      08340000
083500     END-EXEC.                                                    08350000
083600                                                                  08360000
083700     EVALUATE TRUE                                                08370000
083800         WHEN SQLCODE = +0                                        08380000
083900              MOVE +1       TO PT-TOTAL-TPKSLIP-INSERTS           08390000
084000         WHEN SQLWARN0 NOT = SPACES                               08400000
084100         WHEN SQLCODE < +0                                        08410000
084200         WHEN SQLCODE > +0                                        08420000
084300             MOVE PKSLIP-PO-NBR   TO PV-DISP-PO                   08430000
084400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  08440000
084500             MOVE '2150-INSERT-TPKSLIP'                           08450000
084600                              TO RC097-ERROR-PARA-NAME            08460001
084700             SET RC097-DB-ERROR                                   08470001
084800                 PS-ERROR-YES    TO TRUE                          08480000
084900             DISPLAY '******************************************' 08490000
085000             DISPLAY '*ABEND                                   *' 08500000
085100             DISPLAY '*PROGRAM   = RCKUP992                    *' 08510000
085200             DISPLAY '*DB2 OPER  = INSERT ON TPKSLIP           *' 08520000
085300             DISPLAY '*PARAGRAPH = 2150-INSERT-TPKSLIP         *' 08530000
085400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                08540000
085500             DISPLAY '*PO = ' PV-DISP-PO                          08550000
085600             DISPLAY '******************************************' 08560000
085700     END-EVALUATE.                                                08570000
085800                                                                  08580000
085900 2160-UPDATE-PACK-SLIP-HEADER.                                    08590000
086000     PERFORM 2170-SELECT-TPKSLIP.                                 08600000
086100     COMPUTE PKSLIP-EXPTED-PKG-QTY = PKSLIP-EXPTED-PKG-QTY +      08610000
086200                RC097-TO-VERIFY-QTY.                              08620001
086300     PERFORM 2180-UPDATE-TPKSLIP.                                 08630000
086400                                                                  08640000
086500 2170-SELECT-TPKSLIP.                                             08650000
086600                                                                  08660000
086700     EXEC SQL                                                     08670000
086800          SELECT EXPTED_PKG_QTY                                   08680000
086900            INTO :PKSLIP-EXPTED-PKG-QTY                           08690000
087000            FROM TPKSLIP                                          08700000
087100           WHERE PO_NBR       = :DK-PO-NBR                        08710000
087200             AND SEQ_NBR      = :PV-SAVE-PKSLIP-SEQ-NBR           08720000
087300             AND VER_STAT_CDE = 'A'                               08730000
087400     END-EXEC.                                                    08740000
087500                                                                  08750000
087600     EVALUATE TRUE                                                08760000
087700         WHEN SQLCODE = +0                                        08770000
087800              CONTINUE                                            08780000
087900         WHEN SQLWARN0 NOT = SPACES                               08790000
088000         WHEN SQLCODE < +0                                        08800000
088100         WHEN SQLCODE > +0                                        08810000
088200             MOVE DK-PO-NBR       TO PV-DISP-PO                   08820000
088300             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          08830000
088400                                  TO PV-DISP-SEQ                  08840000
088500             MOVE SQLCODE     TO PV-DISP-SQLCODE                  08850000
088600             MOVE '2170-SELECT-TPKSLIP'                           08860000
088700                              TO RC097-ERROR-PARA-NAME            08870001
088800             SET RC097-DB-ERROR                                   08880001
088900                 PS-ERROR-YES    TO TRUE                          08890000
089000             DISPLAY '******************************************' 08900000
089100             DISPLAY '*ABEND                                   *' 08910000
089200             DISPLAY '*PROGRAM   = RCKUP992                    *' 08920000
089300             DISPLAY '*DB2 OPER  = SELECT TPKSLIP              *' 08930000
089400             DISPLAY '*PARAGRAPH = 2170-SELECT-TPKSLIP         *' 08940000
089500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                08950000
089600             DISPLAY '*PO = ' PV-DISP-PO                          08960000
089700             DISPLAY '*SEQ = ' PV-DISP-SEQ                        08970000
089800             DISPLAY '******************************************' 08980000
089900     END-EVALUATE.                                                08990000
090000                                                                  09000000
090100 2180-UPDATE-TPKSLIP.                                             09010000
090200     EXEC SQL                                                     09020000
090300          UPDATE TPKSLIP                                          09030000
090400             SET EXPTED_PKG_QTY = :PKSLIP-EXPTED-PKG-QTY          09040000
090500           WHERE PO_NBR         = :DK-PO-NBR                      09050000
090600             AND SEQ_NBR        = :PV-SAVE-PKSLIP-SEQ-NBR         09060000
090700             AND VER_STAT_CDE   = 'A'                             09070000
090800     END-EXEC                                                     09080000
090900                                                                  09090000
091000     EVALUATE TRUE                                                09100000
091100         WHEN SQLCODE = +0                                        09110000
091200             MOVE +1       TO PT-TOTAL-TPKSLIP-UPDATES            09120000
091300         WHEN SQLWARN0 NOT = SPACES                               09130000
091400         WHEN SQLCODE < +0                                        09140000
091500         WHEN SQLCODE > +0                                        09150000
091600             MOVE DK-PO-NBR       TO PV-DISP-PO                   09160000
091700             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          09170000
091800                                  TO PV-DISP-SEQ                  09180000
091900             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09190000
092000             MOVE '2180-UPDATE-TPKSLIP'                           09200000
092100                              TO RC097-ERROR-PARA-NAME            09210001
092200             SET RC097-PO-NOF                                     09220001
092300                 PS-ERROR-YES    TO TRUE                          09230000
092400             DISPLAY '******************************************' 09240000
092500             DISPLAY '*ABEND                                   *' 09250000
092600             DISPLAY '*PROGRAM   = RCKUP992                    *' 09260000
092700             DISPLAY '*DB2 OPER  = UPDATE TPKSLIP              *' 09270000
092800             DISPLAY '*PARAGRAPH = 2180-UPDATE-TPKSLIP         *' 09280000
092900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                09290000
093000             DISPLAY '*PO = ' PV-DISP-PO                          09300000
093100             DISPLAY '*SEQ = ' PV-DISP-SEQ                        09310000
093200             DISPLAY '******************************************' 09320000
093300     END-EVALUATE.                                                09330000
093400*----------------------------------------------------------------*09340000
093500*    INSERT A PACK SLIP ITEM ROW                                 *09350000
093600*----------------------------------------------------------------*09360000
093700                                                                  09370000
093800                                                                  09380000
093900 2200-ADD-TPKITEM.                                                09390000
094000                                                                  09400000
094100     PERFORM 2210-SETUP-TPKITEM-FIELDS.                           09410000
094200     PERFORM 2230-INSERT-TPKITEM.                                 09420000
094300                                                                  09430000
094400 2210-SETUP-TPKITEM-FIELDS.                                       09440000
094500                                                                  09450000
094600     MOVE PV-HOLD-PO-NBR         TO PKITEM-PO-NBR.                09460000
094700     MOVE PV-HOLD-SEQ-NBR        TO PKITEM-SEQ-NBR.               09470000
094800     MOVE PA-TO-VERIFY-QTY       TO PKITEM-PKSL-ITM-QTY.          09480000
094900     MOVE PV-HOLD-CRE-UID        TO PKITEM-CRE-UID.               09490000
095000     MOVE PA-TO-VERIFY-QTY       TO PKITEM-ORIG-PKSL-ITM-QTY.     09500000
095100     MOVE PV-HOLD-PO-NBR         TO DK-HOLD-PO-NBR.               09510000
095200     MOVE PV-HOLD-PO-LNE-NBR     TO DK-HOLD-LNE-NBR.              09520000
095300     PERFORM 2220-SELECT-LINE.                                    09530000
095400     MOVE PURITM-VER-NBR         TO PKITEM-PURITM-VER-NBR.        09540000
095500     MOVE PURITM-APP-PO-LNE-NBR  TO PKITEM-PKSL-LNE-NBR.          09550000
095600                                                                  09560000
095700                                                                  09570000
095800 2220-SELECT-LINE.                                                09580000
095900     EXEC SQL                                                     09590000
096000        SELECT  A.APP_PO_LNE_NBR                                  09600000
096100           ,    A.VER_NBR                                         09610000
096200           ,    A.ITM_NBR                                         09620000
096300           ,    A.PIC_ITM_IND                                     09630000
096400           ,    A.PO_LNE_NBR                                      09640000
096500           ,    A.VEND_STYL_NAME                                  09650000
096600           ,    A.SKU_SEQ_NBR                                     09660000
096700           ,    A.UNT_RTL_PR_AMT                                  09670000
096800           ,    A.UNT_COST_AMT                                    09680000
096900           ,    A.GP_RTL_AMT                                      09690000
097000           ,    A.GP_QTY                                          09700000
097100          INTO :PURITM-APP-PO-LNE-NBR                             09710000
097200           ,    :PURITM-VER-NBR                                   09720000
097300           ,    :PURITM-ITM-NBR                                   09730000
097400           ,    :PURITM-PIC-ITM-IND                               09740000
097500           ,    :PURITM-PO-LNE-NBR                                09750000
097600           ,    :PURITM-VEND-STYL-NAME                            09760000
097700           ,    :PURITM-SKU-SEQ-NBR                               09770000
097800           ,    :PURITM-UNT-RTL-PR-AMT                            09780000
097900           ,    :PURITM-UNT-COST-AMT                              09790000
098000           ,    :PURITM-GP-RTL-AMT                                09800000
098100           ,    :PURITM-GP-QTY                                    09810000
098200          FROM TPURITM A                                          09820000
098300          WHERE A.PO_NBR          = :DK-HOLD-PO-NBR               09830000
098400            AND A.VER_STATUS_CDE  = 'A'                           09840000
098500            AND A.PO_LNE_NBR      = :DK-HOLD-LNE-NBR              09850000
098600     END-EXEC.                                                    09860000
098700                                                                  09870000
098800     EVALUATE TRUE                                                09880000
098900         WHEN SQLCODE = +0                                        09890000
099000         WHEN SQLCODE = -811                                      09900000
099100              CONTINUE                                            09910000
099200         WHEN SQLCODE = +100                                      09920000
099300             MOVE DK-PO-NBR   TO PV-DISP-PO                       09930000
099400             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 09940000
099500             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09950000
099600             MOVE '2220-SELECT-LINE'                              09960000
099700                              TO RC097-ERROR-PARA-NAME            09970001
099800             SET RC097-ITEM-NOT-ON-PO                             09980001
099900                 PS-ERROR-YES    TO TRUE                          09990000
100000             DISPLAY '******************************************' 10000000
100100             DISPLAY '*ABEND                                   *' 10010000
100200             DISPLAY '*PROGRAM   = RCKUP992                    *' 10020000
100300             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 10030000
100400             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 10040000
100500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10050000
100600             DISPLAY '*PO = ' PV-DISP-PO                          10060000
100700             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  10070000
100800             DISPLAY '******************************************' 10080000
100900         WHEN SQLWARN0 NOT = SPACES                               10090000
101000         WHEN SQLCODE < +0                                        10100000
101100         WHEN SQLCODE > +0                                        10110000
101200             MOVE DK-PO-NBR   TO PV-DISP-PO                       10120000
101300             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 10130000
101400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10140000
101500             MOVE '2220-SELECT-LINE'                              10150000
101600                              TO RC097-ERROR-PARA-NAME            10160001
101700             SET RC097-DB-ERROR                                   10170001
101800                 PS-ERROR-YES    TO TRUE                          10180000
101900             DISPLAY '******************************************' 10190000
102000             DISPLAY '*ABEND                                   *' 10200000
102100             DISPLAY '*PROGRAM   = RCKUP992                    *' 10210000
102200             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 10220000
102300             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 10230000
102400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10240000
102500             DISPLAY '*PO = ' PV-DISP-PO                          10250000
102600             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  10260000
102700             DISPLAY '******************************************' 10270000
102800     END-EVALUATE.                                                10280000
102900                                                                  10290000
103000 2230-INSERT-TPKITEM.                                             10300000
103100     EXEC SQL                                                     10310000
103200          INSERT INTO TPKITEM                                     10320000
103300                 (PO_NBR                                          10330000
103400              ,   SEQ_NBR                                         10340000
103500              ,   PKSL_LNE_NBR                                    10350000
103600              ,   CRE_TMST                                        10360000
103700              ,   VER_STAT_CDE                                    10370000
103800              ,   PKSL_ITM_QTY                                    10380000
103900              ,   CRE_UID                                         10390000
104000              ,   PURITM_VER_NBR                                  10400000
104100              ,   ORIG_PKSL_ITM_QTY)                              10410000
104200          VALUES (:PKITEM-PO-NBR                                  10420000
104300              ,   :PKITEM-SEQ-NBR                                 10430000
104400              ,   :PKITEM-PKSL-LNE-NBR                            10440000
104500              ,    CURRENT_TIMESTAMP                              10450000
104600              ,    'A'                                            10460000
104700              ,   :PKITEM-PKSL-ITM-QTY                            10470000
104800              ,   :PKITEM-CRE-UID                                 10480000
104900              ,   :PKITEM-PURITM-VER-NBR                          10490000
105000              ,   0)                                              10500000
105100     END-EXEC.                                                    10510000
105200                                                                  10520000
105300     EVALUATE TRUE                                                10530000
105400         WHEN SQLCODE = +0                                        10540000
105500*             MOVE +1       TO PT-TOTAL-TPKITEM-INSERTS           10550000
105600              ADD  +1       TO PA-TOTAL-TPKITEM-INSERTS           10560000
105700         WHEN SQLWARN0 NOT = SPACES                               10570000
105800         WHEN SQLCODE < +0                                        10580000
105900         WHEN SQLCODE > +0                                        10590000
106000             MOVE PKITEM-PO-NBR  TO PV-DISP-PO                    10600000
106100             MOVE PKITEM-SEQ-NBR TO PV-DISP-SEQ                   10610000
106200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10620000
106300             MOVE '2230-INSERT-TPKITEM'                           10630000
106400                              TO RC097-ERROR-PARA-NAME            10640001
106500             SET RC097-DB-ERROR                                   10650001
106600                 PS-ERROR-YES    TO TRUE                          10660000
106700             DISPLAY '******************************************' 10670000
106800             DISPLAY '*ABEND                                   *' 10680000
106900             DISPLAY '*PROGRAM   = RCKUP992                    *' 10690000
107000             DISPLAY '*DB2 OPER  = INSERT ON TPKITEM           *' 10700000
107100             DISPLAY '*PARAGRAPH = 2230-INSERT-TPKITEM         *' 10710000
107200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10720000
107300             DISPLAY '*PO = ' PV-DISP-PO                          10730000
107400             DISPLAY '*SEQ = ' PV-DISP-SEQ                        10740000
107500             DISPLAY '******************************************' 10750000
107600     END-EVALUATE.                                                10760000
107700                                                                  10770000
107800/                                                                 10780000
107900*---------------------------------------------------------------* 10790000
108000* CHECK TO SEE IF THE DC SHOULD FLUSH THEIR BUILDING.             10800000
108100*---------------------------------------------------------------* 10810000
108200 2250-CHECK-DC-FLUSH-PARM.                                        10820000
108300                                                                  10830000
108400     EXEC SQL                                                     10840000
108500          SELECT  FUNC_TXT                                        10850000
108600          INTO   :KRPRPM-FUNC-TXT                                 10860000
108700          FROM  TKRPRPM                                           10870000
108800          WHERE LOC_ID            =  90                           10880000
108900            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      10890000
109000            AND FUNC_PRC_STAT_CDE =  'AC'                         10900000
109100     END-EXEC.                                                    10910000
109200                                                                  10920000
109300     EVALUATE TRUE                                                10930000
109400         WHEN SQLCODE = +0                                        10940000
109500            IF KRPRPM-FUNC-TXT = 'N'                              10950000
109600                SET PS-DC-FLUSH-NO  TO TRUE                       10960000
109700            ELSE                                                  10970000
109800                SET PS-DC-FLUSH-YES TO TRUE                       10980000
109900            END-IF                                                10990000
110000         WHEN OTHER                                               11000000
110100                SET PS-DC-FLUSH-NO  TO TRUE                       11010000
110200     END-EVALUATE.                                                11020000
110300                                                                  11030000
110400*---------------------------------------------------------------* 11040000
110500* CHECK TO SEE IF STORE IS IN INVENTORY CYCLE                     11050000
110600*---------------------------------------------------------------* 11060000
110700 2275-CHECK-INV-IN-PROCESS.                                       11070000
110800                                                                  11080000
110900     EXEC SQL                                                     11090000
111000          SELECT                                                  11100000
111100                 A.DC_CTOFF_DTE                                   11110000
111200             ,   (A.DC_CTOFF_DTE + 7 DAYS)                        11120000
111300          INTO                                                    11130000
111400                 :XLT00025-DC-CTOFF-DTE                           11140000
111500             ,   :PV-WORK-DATE-PLUS-7                             11150000
111600          FROM                                                    11160000
111700                XLT_MDSE_INV_PARM A                               11170000
111800          WHERE A.LOC_NBR           =  :RECDIS-STR-NBR            11180000
111900           AND  A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)         11190000
112000           AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)         11200000
112010           AND  A.ACTV_IND         = 'Y'                          11201003
112020           AND  A.LOC_INV_STAT_CDE = 'IN'                         11202003
112100     END-EXEC.                                                    11210000
112200                                                                  11220000
112300     EVALUATE TRUE                                                11230000
112400         WHEN SQLCODE = +0                                        11240000
112500            SET RC097-STORE-INV-CYCLE                             11250001
112600                PS-ERROR-YES    TO TRUE                           11260000
112700         WHEN SQLCODE = +100                                      11270000
112800             CONTINUE                                             11280000
112900         WHEN SQLWARN0 NOT = SPACES                               11290000
113000         WHEN SQLCODE < +0                                        11300000
113100         WHEN SQLCODE > +0                                        11310000
113200             MOVE RECDIS-STR-NBR  TO PV-DISP-STR-NBR              11320000
113300             MOVE SQLCODE     TO PV-DISP-SQLCODE                  11330000
113400             MOVE '2275-CHECK-INV-IN-PROCESS'                     11340000
113500                              TO RC097-ERROR-PARA-NAME            11350001
113600             SET RC097-DB-ERROR                                   11360001
113700                 PS-ERROR-YES    TO TRUE                          11370000
113800             DISPLAY '******************************************' 11380000
113900             DISPLAY '*ABEND                                   *' 11390000
114000             DISPLAY '*PROGRAM   = RCKUP992                    *' 11400000
114100             DISPLAY '*DB2 OPER  = SELECT ON XLT_MDSE_INV_PARM *' 11410000
114200             DISPLAY '*PARAGRAPH = 2275-CHECK-INV-IN-PROCESS   *' 11420000
114300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                11430000
114400             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  11440000
114500             DISPLAY '******************************************' 11450000
114600     END-EVALUATE.                                                11460000
114700                                                                  11470000
114800                                                                  11480000
114900*---------------------------------------------------------------* 11490000
115000 2300-BUILD-RECEIVER-INFO.                                        11500000
115100                                                                  11510000
115200     INITIALIZE DCLTRECEIV.                                       11520000
115300                                                                  11530000
115400     PERFORM 2310-DETERMINE-INDICATORS.                           11540000
115500                                                                  11550000
115600     MOVE RC097-PO-NBR           TO RECEIV-ORD-NBR.               11560001
115700     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            11570000
115800                                    RECEIV-REFER-BACK-SEQ-NBR.    11580000
115900*    MOVE PURITM-VER-NBR         TO RECEIV-PO-VER-NBR.            11590000
116000     MOVE PURCHS-VER-NBR         TO RECEIV-PO-VER-NBR.            11600000
116100                                                                  11610000
116200     MOVE RC097-OPER-UNIT        TO RECEIV-OPER-UNT-ID.           11620001
116300     MOVE 1                      TO RECEIV-FCLTY-ID.              11630000
116400     MOVE 'VE'                   TO RECEIV-STATUS-CDE.            11640000
116500     MOVE 'P'                    TO RECEIV-SYST-CRE-CDE.          11650000
116600     MOVE RC097-REC-TYP-CDE      TO RECEIV-REC-TYP-CDE.           11660001
116700     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        11670000
116800     MOVE 1                      TO RECEIV-EXPTED-CART-CNT.       11680000
116900     MOVE 1                      TO RECEIV-ACTL-CART-CNT.         11690000
117000     MOVE RC097-TO-VERIFY-QTY    TO RECEIV-EXPTED-ITM-QTY         11700001
117100                                    RECEIV-ACTL-ITM-QTY.          11710000
117200     MOVE '9999-09-09-09.09.09.999999'                            11720000
117300                                 TO RECEIV-ML-POST-TMST           11730000
117400                                    RECEIV-FS-POST-TMST           11740000
117500                                    RECEIV-IN-TRBL-TMST           11750000
117600                                    RECEIV-MKNG-APRN-PRT-TMST.    11760000
117700*    PERFORM 3000-SEL-ARRVD-TRIP-TMST.                            11770000
117800*    MOVE PV-ARRVD-TIMESTAMP      TO RECEIV-REC-TMST.             11780000
117900     MOVE RC097-OPER-UNIT         TO RECEIV-CURR-OPER-UNT-ID.     11790001
118000                                                                  11800000
118100     MOVE RC097-OPER-UNIT         TO RECEIV-CRE-OPER-UNT-ID.      11810001
118200     MOVE RC097-CRE-UID           TO RECEIV-CRE-UID.              11820001
118300                                                                  11830000
118400     MOVE 1                       TO RECEIV-CURR-FCLTY-ID.        11840000
118500     MOVE 1                       TO RECEIV-CRE-FCLTY-ID.         11850000
118600     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID            11860000
118700                                     RECEIV-UPD-UID               11870000
118800                                     RECEIV-VRFD-USR-ID.          11880000
118900                                                                  11890000
119000     MOVE RC097-RCVG-CLERK-INIT-ID                                11900001
119100                                 TO RECEIV-RCVG-CLERK-INIT-ID.    11910000
119200     MOVE 'N'                    TO RECEIV-FRE-ASTRA-IND.         11920000
119300                                                                  11930000
119400     PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   11940000
119500          PV-COUNT > 10                                           11950000
119600         PERFORM 3000-OPEN-TRECVER-CSR                            11960000
119700         PERFORM 3020-FETCH-TRECVER-CSR                           11970000
119800                                                                  11980000
119900         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       11990000
120000         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     12000000
120100                                       REMAINDER  PW-REMAINDER    12010000
120200         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      12020000
120300         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        12030000
120400         ADD +1                    TO RECVER-MAX-RCVR-NBR         12040000
120500         PERFORM 3040-DELETE-TRECVER-CSR                          12050000
120600         PERFORM 3060-INSERT-TRECVER                              12060000
120700         PERFORM 3080-CLOSE-TRECVER-CSR                           12070000
120800     END-PERFORM.                                                 12080000
120900                                                                  12090000
121000     PERFORM 2340-INSERT-TRECEIV.                                 12100000
121100***  IF SQLCODE = ZERO                                            12110000
121200***      PERFORM 4900-INSERT-TPOSYNC                              12120000
121300***  END-IF                                                       12130000
121400***  PERFORM 5100-CHECK-FOR-TROUBLE                               12140000
121500                                                                  12150000
121600 2310-DETERMINE-INDICATORS.                                       12160000
121700                                                                  12170000
121800* SET PRE TICKET INDICATOR                                        12180000
121900     MOVE 4                      TO DK-AGRMT-TYP-ID.              12190000
122000     MOVE 1                      TO DK-TYP-CDE.                   12200000
122100                                                                  12210000
122200     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12220000
122300                                                                  12230000
122400     IF  PV-DB2-COUNT > +0                                        12240000
122500         MOVE 'Y'                TO RECEIV-PRE-TKT-IND            12250000
122600     ELSE                                                         12260000
122700         MOVE 'N'                TO RECEIV-PRE-TKT-IND            12270000
122800     END-IF.                                                      12280000
122900                                                                  12290000
123000                                                                  12300000
123100* SET GARMENT ON HANGER (GOH) INDICATOR                           12310000
123200     MOVE 4                      TO DK-AGRMT-TYP-ID.              12320000
123300     MOVE 2                      TO DK-TYP-CDE.                   12330000
123400                                                                  12340000
123500     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12350000
123600                                                                  12360000
123700     IF  PV-DB2-COUNT > +0                                        12370000
123800         MOVE 'Y'                TO RECEIV-GOH-IND                12380000
123900     ELSE                                                         12390000
124000         MOVE 'N'                TO RECEIV-GOH-IND                12400000
124100     END-IF.                                                      12410000
124200                                                                  12420000
124300* SET PACK BY STORE INDICATOR AND PACKAGING CODE                  12430000
124400     MOVE RC097-PKGNG-CDE        TO RECEIV-PKGNG-CDE              12440001
124500     IF RC097-PKGNG-CDE = SPACE                                   12450001
124600         MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         12460000
124700     ELSE                                                         12470000
124800         MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         12480000
124900     END-IF.                                                      12490000
125000                                                                  12500000
125100*    MOVE 4                      TO DK-AGRMT-TYP-ID.              12510000
125200*    MOVE 4                      TO DK-TYP-CDE.                   12520000
125300                                                                  12530000
125400*    PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12540000
125500                                                                  12550000
125600*    IF  PV-DB2-COUNT > +0                                        12560000
125700*        MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         12570000
125800*    ELSE                                                         12580000
125900*        MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         12590000
126000*    END-IF.                                                      12600000
126100                                                                  12610000
126200*    IF RECEIV-PACK-BY-ST-IND NOT = 'Y'                           12620000
126300*        PERFORM 2330-PKGNG-CDE-FROM-PO                           12630000
126400*    ELSE                                                         12640000
126500*        MOVE SPACES                   TO RECEIV-PKGNG-CDE        12650000
126600*    END-IF.                                                      12660000
126700                                                                  12670000
126800 2320-CHECK-PO-SERVICE-INFO.                                      12680000
126900                                                                  12690000
127000     MOVE 0        TO PV-DB2-COUNT.                               12700000
127100                                                                  12710000
127200     EXEC SQL                                                     12720000
127300          SELECT COUNT(*)                                         12730000
127400            INTO :PV-DB2-COUNT                                    12740000
127500            FROM TPOAGMT                                          12750000
127600           WHERE PO_NBR         = :DK-PO-NBR                      12760000
127700             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                12770000
127800             AND VER_STATUS_CDE = 'A'                             12780000
127900             AND TYP_CDE        = :DK-TYP-CDE                     12790000
128000     END-EXEC.                                                    12800000
128100                                                                  12810000
128200     EVALUATE TRUE                                                12820000
128300         WHEN SQLCODE = +0                                        12830000
128400         WHEN SQLCODE = +100                                      12840000
128500              CONTINUE                                            12850000
128600                                                                  12860000
128700         WHEN SQLWARN0 NOT = SPACES                               12870000
128800         WHEN SQLCODE < +0                                        12880000
128900         WHEN SQLCODE > +0                                        12890000
129000             MOVE DK-PO-NBR   TO PV-DISP-PO                       12900000
129100             MOVE DK-TYP-CDE  TO PV-DISP-TYP-CDE                  12910000
129200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  12920000
129300             MOVE '2320-CHECK-PO-SERVICE-INFO'                    12930000
129400                              TO RC097-ERROR-PARA-NAME            12940001
129500             SET RC097-DB-ERROR                                   12950001
129600                 PS-ERROR-YES    TO TRUE                          12960000
129700             DISPLAY '******************************************' 12970000
129800             DISPLAY '*ABEND                                   *' 12980000
129900             DISPLAY '*PROGRAM   = RCKUP992                    *' 12990000
130000             DISPLAY '*DB2 OPER  = SELECT ON TPOAGMT           *' 13000000
130100             DISPLAY '*PARAGRAPH = 2320-CHECK-PO-SERVICE-INFO  *' 13010000
130200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                13020000
130300             DISPLAY '*PO = ' PV-DISP-PO                          13030000
130400             DISPLAY '*TYPE = ' PV-DISP-TYP-CDE                   13040000
130500             DISPLAY '*AGRMT TYP ID = ' DK-AGRMT-TYP-ID           13050000
130600             DISPLAY '******************************************' 13060000
130700     END-EVALUATE.                                                13070000
130800                                                                  13080000
130900*2330-PKGNG-CDE-FROM-PO.                                          13090000
131000                                                                  13100000
131100*    EXEC SQL                                                     13110000
131200*        SELECT PKGNG_CDE                                         13120000
131300*          INTO :PURCHS-PKGNG-CDE                                 13130000
131400*          FROM TPURCHS                                           13140000
131500*         WHERE PO_NBR = :DK-PO-NBR                               13150000
131600*           AND VER_STATUS_CDE = 'A'                              13160000
131700*    END-EXEC.                                                    13170000
131800                                                                  13180000
131900*    EVALUATE TRUE                                                13190000
132000*        WHEN SQLCODE = +0                                        13200000
132100*            MOVE PURCHS-PKGNG-CDE                                13210000
132200*                        TO RECEIV-PKGNG-CDE                      13220000
132300*        WHEN SQLCODE = +100                                      13230000
132400*            MOVE SPACES TO RECEIV-PKGNG-CDE                      13240000
132500*        WHEN SQLWARN0 NOT = SPACES                               13250000
132600*        WHEN SQLCODE < +0                                        13260000
132700*        WHEN SQLCODE > +0                                        13270000
132800*            MOVE DK-PO-NBR   TO PV-DISP-PO                       13280000
132900*            MOVE SQLCODE     TO PV-DISP-SQLCODE                  13290000
133000*            MOVE '2330-PKGNG-CDE-FROM-PO'                        13300000
133100*                             TO RC097-ERROR-PARA-NAME            13310001
133200*            SET RC097-DB-ERROR                                   13320001
133300*                PS-ERROR-YES    TO TRUE                          13330000
133400*            DISPLAY '******************************************' 13340000
133500*            DISPLAY '*ABEND                                   *' 13350000
133600*            DISPLAY '*PROGRAM   = RCKUP992                    *' 13360000
133700*            DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 13370000
133800*            DISPLAY '*PARAGRAPH = 2330-PKGNG-CDE-FROM-PO      *' 13380000
133900*            DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                13390000
134000*            DISPLAY '*PO = ' PV-DISP-PO                          13400000
134100*            DISPLAY '******************************************' 13410000
134200*    END-EVALUATE.                                                13420000
134300                                                                  13430000
134400 2340-INSERT-TRECEIV.                                             13440000
134500                                                                  13450000
134600     EXEC SQL                                                     13460000
134700          INSERT INTO TRECEIV                                     13470000
134800                 ( ORD_NBR                                        13480000
134900                ,  REC_SEQ_NBR                                    13490000
135000                ,  CRE_TMST                                       13500000
135100                ,  CRE_UID                                        13510000
135200                ,  PO_VER_NBR                                     13520000
135300                ,  OPER_UNT_ID                                    13530000
135400                ,  FCLTY_ID                                       13540000
135500                ,  STATUS_CDE                                     13550000
135600                ,  SYST_CRE_CDE                                   13560000
135700                ,  REC_TYP_CDE                                    13570000
135800                ,  VER_STATUS_CDE                                 13580000
135900                ,  PACK_BY_ST_IND                                 13590000
136000                ,  REC_TMST                                       13600000
136100                ,  EXPTED_CART_CNT                                13610000
136200                ,  ACTL_CART_CNT                                  13620000
136300                ,  EXPTED_ITM_QTY                                 13630000
136400                ,  ACTL_ITM_QTY                                   13640000
136500                ,  RCVR_NBR                                       13650000
136600                ,  ML_POST_TMST                                   13660000
136700                ,  FS_POST_TMST                                   13670000
136800                ,  PRE_TKT_IND                                    13680000
136900                ,  AD_INFO_DESC                                   13690000
137000                ,  IN_TRBL_TMST                                   13700000
137100                ,  IN_TRBL_MIN_CNT                                13710000
137200                ,  IN_TRBL_HOUR_CNT                               13720000
137300                ,  VERFYD_TMST                                    13730000
137400                ,  RCVG_CLERK_INIT_ID                             13740000
137500                ,  REFER_BACK_SEQ_NBR                             13750000
137600                ,  AP_PRC_CDE                                     13760000
137700                ,  AP_PRC_DTE                                     13770000
137800                ,  MIS_DIRECT_IND                                 13780000
137900                ,  IMPRT_IND                                      13790000
138000                ,  CRE_OPER_UNT_ID                                13800000
138100                ,  CRE_FCLTY_ID                                   13810000
138200                ,  CURR_OPER_UNT_ID                               13820000
138300                ,  CURR_FCLTY_ID                                  13830000
138400                ,  UPD_TMST                                       13840000
138500                ,  UPD_UID                                        13850000
138600                ,  UPD_PGM_ID                                     13860000
138700                ,  MKNG_APRN_PRT_TMST                             13870000
138800                ,  GOH_IND                                        13880000
138900                ,  VRFD_USR_ID                                    13890000
139000                ,  AP_RVRSL_DTE                                   13900000
139100                ,  PKGNG_CDE                                      13910000
139200                ,  FRE_ASTRA_IND                                  13920000
139300                  )                                               13930000
139400         VALUES ( :RECEIV-ORD-NBR                                 13940000
139500                , :RECEIV-REC-SEQ-NBR                             13950000
139600                , CURRENT_TIMESTAMP                               13960000
139700                , :RECEIV-CRE-UID                                 13970000
139800                , :RECEIV-PO-VER-NBR                              13980000
139900                , :RECEIV-OPER-UNT-ID                             13990000
140000                , :RECEIV-FCLTY-ID                                14000000
140100                , :RECEIV-STATUS-CDE                              14010000
140200                , :RECEIV-SYST-CRE-CDE                            14020000
140300                , :RECEIV-REC-TYP-CDE                             14030000
140400                , :RECEIV-VER-STATUS-CDE                          14040000
140500                , :RECEIV-PACK-BY-ST-IND                          14050000
140600*               , :RECEIV-REC-TMST                                14060000
140700                , CURRENT_TIMESTAMP                               14070000
140800                , :RECEIV-EXPTED-CART-CNT                         14080000
140900                , :RECEIV-ACTL-CART-CNT                           14090000
141000                , :RECEIV-EXPTED-ITM-QTY                          14100000
141100                , :RECEIV-ACTL-ITM-QTY                            14110000
141200                , :RECEIV-RCVR-NBR                                14120000
141300                , :RECEIV-ML-POST-TMST                            14130000
141400                , :RECEIV-FS-POST-TMST                            14140000
141500                , :RECEIV-PRE-TKT-IND                             14150000
141600                , :RECEIV-AD-INFO-DESC                            14160000
141700                , :RECEIV-IN-TRBL-TMST                            14170000
141800                , :RECEIV-IN-TRBL-MIN-CNT                         14180000
141900                , :RECEIV-IN-TRBL-HOUR-CNT                        14190000
142000                , CURRENT_TIMESTAMP                               14200000
142100                , :RECEIV-RCVG-CLERK-INIT-ID                      14210000
142200                , :RECEIV-REFER-BACK-SEQ-NBR                      14220000
142300                , :RECEIV-AP-PRC-CDE                              14230000
142400                , '9999-09-09'                                    14240000
142500                , :RECEIV-MIS-DIRECT-IND                          14250000
142600                , :RECEIV-IMPRT-IND                               14260000
142700                , :RECEIV-CRE-OPER-UNT-ID                         14270000
142800                , :RECEIV-CRE-FCLTY-ID                            14280000
142900                , :RECEIV-CURR-OPER-UNT-ID                        14290000
143000                , :RECEIV-CURR-FCLTY-ID                           14300000
143100                , CURRENT_TIMESTAMP                               14310000
143200                , :RECEIV-UPD-UID                                 14320000
143300                , :RECEIV-UPD-PGM-ID                              14330000
143400                , :RECEIV-MKNG-APRN-PRT-TMST                      14340000
143500                , :RECEIV-GOH-IND                                 14350000
143600                , :RECEIV-VRFD-USR-ID                             14360000
143700                , '9999-09-09'                                    14370000
143800                , :RECEIV-PKGNG-CDE                               14380000
143900                , :RECEIV-FRE-ASTRA-IND                           14390000
144000                 )                                                14400000
144100     END-EXEC.                                                    14410000
144200                                                                  14420000
144300     EVALUATE TRUE                                                14430000
144400         WHEN SQLCODE = +0                                        14440000
144500              MOVE +1       TO PT-TOTAL-TRECEIV-INSERTS           14450000
144600              MOVE RECEIV-ORD-NBR     TO PV-DISP-PO               14460000
144700              MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ          14470000
144800              DISPLAY ' PO / RECEIVER '                           14480000
144900                      PV-DISP-PO ' ' PV-DISP-REC-SEQ              14490000
145000              MOVE PV-DISP-PO         TO PV-BKUP-PO-NBR-2         14500000
145100              MOVE PV-DISP-REC-SEQ    TO PV-BKUP-REC-SEQ-2        14510000
145200              WRITE BKUP-RECORD FROM PV-BKUP-RECORD-2             14520000
145300         WHEN SQLWARN0 NOT = SPACE                                14530000
145400         WHEN SQLCODE < +0                                        14540000
145500         WHEN SQLCODE > +0                                        14550000
145600             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO                   14560000
145700             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ           14570000
145800             MOVE SQLCODE TO PV-DISP-SQLCODE                      14580000
145900             MOVE '2340-INSERT-TRECEIV'                           14590000
146000                              TO RC097-ERROR-PARA-NAME            14600001
146100             SET RC097-DB-ERROR                                   14610001
146200                 PS-ERROR-YES    TO TRUE                          14620000
146300             DISPLAY '******************************************' 14630000
146400             DISPLAY '*ABEND                                   *' 14640000
146500             DISPLAY '*PROGRAM   = RCKUP992                    *' 14650000
146600             DISPLAY '*DB2 OPER  = INSERT ON TRECEIV           *' 14660000
146700             DISPLAY '*PARAGRAPH = 2340-INSERT-TRECEIV         *' 14670000
146800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                14680000
146900             DISPLAY '*PO = ' PV-DISP-PO                          14690000
147000             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               14700000
147100             DISPLAY '******************************************' 14710000
147200                                                                  14720000
147300     END-EVALUATE.                                                14730000
147400                                                                  14740000
147500 2350-UPDATE-RECEIVER-INFO.                                       14750000
147600     PERFORM 2360-SELECT-TRECEIV.                                 14760000
147700     COMPUTE RECEIV-EXPTED-ITM-QTY = RECEIV-EXPTED-ITM-QTY +      14770000
147800                RC097-TO-VERIFY-QTY.                              14780001
147900     COMPUTE RECEIV-ACTL-ITM-QTY = RECEIV-ACTL-ITM-QTY +          14790000
148000                RC097-TO-VERIFY-QTY.                              14800001
148100     PERFORM 2370-UPDATE-TRECEIV.                                 14810000
148200                                                                  14820000
148300 2360-SELECT-TRECEIV.                                             14830000
148400     EXEC SQL                                                     14840000
148500          SELECT EXPTED_ITM_QTY                                   14850000
148600                ,ACTL_ITM_QTY                                     14860000
148700            INTO :RECEIV-EXPTED-ITM-QTY                           14870000
148800                ,:RECEIV-ACTL-ITM-QTY                             14880000
148900            FROM TRECEIV                                          14890000
149000           WHERE ORD_NBR     = :DK-PO-NBR                         14900000
149100             AND REC_SEQ_NBR = :PV-REC-SEQ-NBR                    14910000
149200             AND VER_STATUS_CDE = 'A'                             14920000
149300     END-EXEC.                                                    14930000
149400                                                                  14940000
149500     EVALUATE TRUE                                                14950000
149600         WHEN SQLCODE = ZERO                                      14960000
149700              CONTINUE                                            14970000
149800                                                                  14980000
149900         WHEN SQLWARN0 NOT = SPACES                               14990000
150000         WHEN SQLCODE  NOT = ZERO                                 15000000
150100             MOVE DK-PO-NBR         TO PV-DISP-PO                 15010000
150200             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           15020000
150300             MOVE SQLCODE TO PV-DISP-SQLCODE                      15030000
150400             MOVE '2360-SELECT-TRECEIV'                           15040000
150500                              TO RC097-ERROR-PARA-NAME            15050001
150600             SET RC097-DB-ERROR                                   15060001
150700                 PS-ERROR-YES    TO TRUE                          15070000
150800             DISPLAY '******************************************' 15080000
150900             DISPLAY '*ABEND                                   *' 15090000
151000             DISPLAY '*PROGRAM   = RCKUP992                    *' 15100000
151100             DISPLAY '*DB2 OPER  = SELECT TRECEIV              *' 15110000
151200             DISPLAY '*PARAGRAPH = 2360-SELECT-TRECEIV         *' 15120000
151300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15130000
151400             DISPLAY '*PO = ' PV-DISP-PO                          15140000
151500             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               15150000
151600             DISPLAY '******************************************' 15160000
151700     END-EVALUATE.                                                15170000
151800                                                                  15180000
151900 2370-UPDATE-TRECEIV.                                             15190000
152000     EXEC SQL                                                     15200000
152100       UPDATE TRECEIV                                             15210000
152200          SET   EXPTED_ITM_QTY     = :RECEIV-EXPTED-ITM-QTY       15220000
152300              , ACTL_ITM_QTY       = :RECEIV-ACTL-ITM-QTY         15230000
152400           WHERE ORD_NBR        = :DK-PO-NBR                      15240000
152500             AND REC_SEQ_NBR    = :PV-REC-SEQ-NBR                 15250000
152600             AND VER_STATUS_CDE = 'A'                             15260000
152700     END-EXEC.                                                    15270000
152800                                                                  15280000
152900     EVALUATE TRUE                                                15290000
153000         WHEN SQLCODE = ZERO                                      15300000
153100              MOVE +1       TO PT-TOTAL-TRECEIV-UPDATES           15310000
153200                                                                  15320000
153300         WHEN SQLWARN0 NOT = SPACES                               15330000
153400         WHEN SQLCODE  NOT = ZERO                                 15340000
153500             MOVE DK-PO-NBR         TO PV-DISP-PO                 15350000
153600             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           15360000
153700             MOVE SQLCODE TO PV-DISP-SQLCODE                      15370000
153800             MOVE '2370-UPDATE-TRECEIV'                           15380000
153900                              TO RC097-ERROR-PARA-NAME            15390001
154000             SET RC097-DB-ERROR                                   15400001
154100                 PS-ERROR-YES    TO TRUE                          15410000
154200             DISPLAY '******************************************' 15420000
154300             DISPLAY '*ABEND                                   *' 15430000
154400             DISPLAY '*PROGRAM   = RCKUP992                    *' 15440000
154500             DISPLAY '*DB2 OPER  = UPDATE TRECEIV              *' 15450000
154600             DISPLAY '*PARAGRAPH = 2370-UPDATE-TRECEIV         *' 15460000
154700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15470000
154800             DISPLAY '*PO = ' PV-DISP-PO                          15480000
154900             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               15490000
155000             DISPLAY '******************************************' 15500000
155100     END-EVALUATE.                                                15510000
155200                                                                  15520000
155300 2400-ADD-RECITM.                                                 15530000
155400     PERFORM 2410-SETUP-RECITM-FIELDS.                            15540000
155500     PERFORM 2420-INSERT-RECITM.                                  15550000
155600                                                                  15560000
155700 2410-SETUP-RECITM-FIELDS.                                        15570000
155800                                                                  15580000
155900     INITIALIZE DCLTRECITM.                                       15590000
156000                                                                  15600000
156100     MOVE PV-HOLD-PO-NBR         TO RECITM-ORD-NBR.               15610000
156200     MOVE PURITM-APP-PO-LNE-NBR  TO RECITM-ORD-LNE-NBR.           15620000
156300                                                                  15630000
156400     MOVE PV-HOLD-REC-SEQ-NBR    TO RECITM-REC-SEQ-NBR.           15640000
156500     MOVE RC097-OPER-UNIT        TO RECITM-OPER-UNT-ID.           15650001
156600     MOVE 1                      TO RECITM-FCLTY-ID.              15660000
156700                                                                  15670000
156800     MOVE PURITM-VER-NBR         TO RECITM-PO-VER-NBR.            15680000
156900     MOVE PURITM-ITM-NBR         TO RECITM-ITM-NBR.               15690000
157000     MOVE PURITM-UNT-RTL-PR-AMT  TO RECITM-UNT-RTL-AMT            15700000
157100     MOVE PURITM-UNT-COST-AMT    TO RECITM-UNT-COST-AMT           15710000
157200     MOVE PURITM-GP-RTL-AMT      TO RECITM-GP-RTL-AMT             15720000
157300     MOVE PURITM-GP-QTY          TO RECITM-GP-QTY                 15730000
157400     MOVE RECEIV-PRE-TKT-IND     TO RECITM-PRE-TKT-IND.           15740000
157500     MOVE SPACES                 TO RECITM-TKT-FMT-ID.            15750000
157600     MOVE 'VE'                   TO RECITM-STATUS-CDE.            15760000
157700     MOVE 1                      TO RECITM-EXPTED-CART-CNT.       15770000
157800     MOVE PA-TO-VERIFY-QTY       TO RECITM-PKSL-ITM-QTY           15780000
157900                                    RECITM-DTL-CK-ITM-QTY.        15790000
158000     MOVE ZERO                   TO RECITM-ACTL-CART-CNT.         15800000
158100     MOVE '9999-09-09-09.09.09.999999'                            15810000
158200                                 TO RECITM-MKING-APRON-TMST       15820000
158300                                    RECITM-UPD-TMST.              15830000
158400     MOVE PC-CURRENT-PROGRAM-NAME TO RECITM-VRFD-USR-ID.          15840004
158500     MOVE RC097-CRE-UID           TO RECITM-CRE-UID.              15850001
158600                                                                  15860000
158700     INITIALIZE                     RECITM-PREPK-ID               15870000
158800                                    RECITM-PREPK-DRV-LNE-CDE      15880000
158900                                    RECITM-PREPK-RATO-QTY         15890000
159000                                    RECITM-PREPK-ODD-UNT-QTY.     15900000
159100                                                                  15910000
159200 2420-INSERT-RECITM.                                              15920000
159300                                                                  15930000
159400     EXEC SQL                                                     15940000
159500         INSERT INTO TRECITM                                      15950000
159600               (ORD_NBR                                           15960000
159700             ,  ORD_LNE_NBR                                       15970000
159800             ,  REC_SEQ_NBR                                       15980000
159900             ,  OPER_UNT_ID                                       15990000
160000             ,  FCLTY_ID                                          16000000
160100             ,  CRE_TMST                                          16010000
160200             ,  CRE_UID                                           16020000
160300             ,  PO_VER_NBR                                        16030000
160400             ,  ITM_NBR                                           16040000
160500             ,  PRE_TKT_IND                                       16050000
160600             ,  TKT_FMT_ID                                        16060000
160700             ,  RTV_IND                                           16070000
160800             ,  STATUS_CDE                                        16080000
160900             ,  VER_STATUS_CDE                                    16090000
161000             ,  PKSL_ITM_QTY                                      16100000
161100             ,  DTL_CK_ITM_QTY                                    16110000
161200             ,  INNR_PACK_QTY                                     16120000
161300             ,  CASE_PACK_QTY                                     16130000
161400             ,  RTV_QTY                                           16140000
161500             ,  EXPTED_CART_CNT                                   16150000
161600             ,  ACTL_CART_CNT                                     16160000
161700             ,  MKING_APRON_TMST                                  16170000
161800             ,  UNT_COST_AMT                                      16180000
161900             ,  COLOR_DESC                                        16190000
162000             ,  SIZE_DESC                                         16200000
162100             ,  VEND_STYL_NAME                                    16210000
162200             ,  VEND_DESC                                         16220000
162300             ,  VERFYD_TMST                                       16230000
162400             ,  PKSL_NBR                                          16240000
162500             ,  REC_INV_LNE_NBR                                   16250000
162600             ,  DMG_ITM_QTY                                       16260000
162700             ,  UPD_TMST                                          16270000
162800             ,  UPD_UID                                           16280000
162900             ,  UPD_PGM_ID                                        16290000
163000             ,  RCPT_DISTR_UPD_CDE                                16300000
163010             ,  VRFD_USR_ID                                       16301004
163100             ,  LAST_TRSCP_TMST                                   16310000
163200             ,  LAST_TRSCP_USR_ID                                 16320000
163300             ,  PREPK_ID                                          16330000
163400             ,  PREPK_RATO_QTY                                    16340000
163500             ,  PREPK_ODD_UNT_QTY                                 16350000
163600             ,  PREPK_DRV_LNE_CDE                                 16360000
163700             ,  UNT_RTL_AMT                                       16370000
163800             ,  GP_RTL_AMT                                        16380000
163900             ,  GP_QTY                                            16390000
164000             ,  ORIG_PKSL_ITM_QTY)                                16400000
164100        VALUES (:RECITM-ORD-NBR                                   16410000
164200             ,  :RECITM-ORD-LNE-NBR                               16420000
164300             ,  :RECITM-REC-SEQ-NBR                               16430000
164400             ,  :RECITM-OPER-UNT-ID                               16440000
164500             ,  :RECITM-FCLTY-ID                                  16450000
164600             ,   CURRENT_TIMESTAMP                                16460000
164700             ,  :RECITM-CRE-UID                                   16470000
164800             ,  :RECITM-PO-VER-NBR                                16480000
164900             ,  :RECITM-ITM-NBR                                   16490000
165000             ,  :RECITM-PRE-TKT-IND                               16500000
165100             ,  :RECITM-TKT-FMT-ID                                16510000
165200             ,  :RECITM-RTV-IND                                   16520000
165300             ,  :RECITM-STATUS-CDE                                16530000
165400             ,  'A'                                               16540000
165500             ,  :RECITM-PKSL-ITM-QTY                              16550000
165600             ,  :RECITM-DTL-CK-ITM-QTY                            16560000
165700             ,  :RECITM-INNR-PACK-QTY                             16570000
165800             ,  :RECITM-CASE-PACK-QTY                             16580000
165900             ,  :RECITM-RTV-QTY                                   16590000
166000             ,  :RECITM-EXPTED-CART-CNT                           16600000
166100             ,  :RECITM-ACTL-CART-CNT                             16610000
166200             ,  :RECITM-MKING-APRON-TMST                          16620000
166300             ,  :RECITM-UNT-COST-AMT                              16630000
166400             ,  :RECITM-COLOR-DESC                                16640000
166500             ,  :RECITM-SIZE-DESC                                 16650000
166600             ,  :RECITM-VEND-STYL-NAME                            16660000
166700             ,  :RECITM-VEND-DESC                                 16670000
166800             ,  CURRENT_TIMESTAMP                                 16680000
166900             ,  :RECITM-PKSL-NBR                                  16690000
167000             ,  :RECITM-REC-INV-LNE-NBR                           16700000
167100             ,  :RECITM-DMG-ITM-QTY                               16710000
167200             ,  :RECITM-UPD-TMST                                  16720000
167300             ,  :RECITM-UPD-UID                                   16730000
167400             ,  :RECITM-UPD-PGM-ID                                16740000
167500             ,  :RECITM-RCPT-DISTR-UPD-CDE                        16750000
167510             ,  :RECITM-VRFD-USR-ID                               16751004
167600             ,   CURRENT_TIMESTAMP                                16760000
167700             ,  :PC-CURRENT-PROGRAM-NAME                          16770000
167800             ,  :RECITM-PREPK-ID                                  16780000
167900             ,  :RECITM-PREPK-RATO-QTY                            16790000
168000             ,  :RECITM-PREPK-ODD-UNT-QTY                         16800000
168100             ,  :RECITM-PREPK-DRV-LNE-CDE                         16810000
168200             ,  :RECITM-UNT-RTL-AMT                               16820000
168300             ,  :RECITM-GP-RTL-AMT                                16830000
168400             ,  :RECITM-GP-QTY                                    16840000
168500             ,  0)                                                16850000
168600     END-EXEC.                                                    16860000
168700                                                                  16870000
168800     EVALUATE TRUE                                                16880000
168900         WHEN SQLCODE = ZERO                                      16890000
169000*             MOVE +1       TO PT-TOTAL-TRECITM-INSERTS           16900000
169100              ADD  +1       TO PA-TOTAL-TRECITM-INSERTS           16910000
169200                                                                  16920000
169300         WHEN SQLWARN0 NOT = SPACES                               16930000
169400         WHEN SQLCODE  NOT = ZERO                                 16940000
169500             MOVE DK-PO-NBR         TO PV-DISP-PO                 16950000
169600             MOVE RECITM-REC-SEQ-NBR TO PV-DISP-REC-SEQ           16960000
169700             MOVE RECITM-ORD-LNE-NBR TO PV-DISP-LINE-NBR          16970000
169800             MOVE SQLCODE TO PV-DISP-SQLCODE                      16980000
169900             MOVE '2420-INSERT-RECITM'                            16990000
170000                              TO RC097-ERROR-PARA-NAME            17000001
170100             SET RC097-DB-ERROR                                   17010001
170200                 PS-ERROR-YES    TO TRUE                          17020000
170300             DISPLAY '******************************************' 17030000
170400             DISPLAY '*ABEND                                   *' 17040000
170500             DISPLAY '*PROGRAM   = RCKUP992                    *' 17050000
170600             DISPLAY '*DB2 OPER  = INSERT ON TRECITM           *' 17060000
170700             DISPLAY '*PARAGRAPH = 2420-INSERT-RECITM          *' 17070000
170800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                17080000
170900             DISPLAY '*PO = ' PV-DISP-PO                          17090000
171000             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               17100000
171100             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  17110000
171200             DISPLAY '******************************************' 17120000
171300     END-EVALUATE.                                                17130000
171400                                                                  17140000
171500 2500-PREPARE-TRECDIS.                                            17150000
171600     PERFORM 2530-SELECT-APP-PO-LINE.                             17160000
171700     IF PS-ERROR-NO                                               17170000
171800         PERFORM 2510-SETUP-TRECDIS-FIELDS                        17180000
171900         PERFORM 2520-INSERT-TRECDIS                              17190000
172000     END-IF.                                                      17200000
172100                                                                  17210000
172200 2510-SETUP-TRECDIS-FIELDS.                                       17220000
172300                                                                  17230000
172400     INITIALIZE DCLTRECDIS.                                       17240000
172500                                                                  17250000
172600     MOVE RC097-PO-NBR       TO RECDIS-ORD-NBR.                   17260001
172700     MOVE PURITM-APP-PO-LNE-NBR                                   17270000
172800                             TO RECDIS-ORD-LNE-NBR.               17280000
172900     MOVE PV-REC-SEQ-NBR     TO RECDIS-REC-SEQ-NBR.               17290000
173000     MOVE RC097-OPER-UNIT    TO RECDIS-OPER-UNT-ID.               17300001
173100     MOVE RC097-CRE-UID      TO RECDIS-CRE-UID.                   17310001
173200     MOVE 'A'                TO RECDIS-VER-STATUS-CDE.            17320000
173300     MOVE RC097-TO-VERIFY-QTY TO RECDIS-EXPTED-ITM-QTY            17330001
173400                                RECDIS-VERIFY-ITM-QTY             17340000
173500                                RECDIS-AP-VERIFY-ITM-QTY.         17350000
173600     MOVE RC097-STR-NBR      TO RECDIS-STR-NBR.                   17360001
173700     MOVE 1                  TO RECDIS-FCLTY-ID.                  17370000
173800     MOVE 1                  TO RECDIS-STR-FCLTY-ID.              17380000
173900                                                                  17390000
174000     MOVE '9999-09-09'       TO RECDIS-AP-PRC-DTE.                17400000
174100                                                                  17410000
174200                                                                  17420000
174300 2520-INSERT-TRECDIS.                                             17430000
174400                                                                  17440000
174500     EXEC SQL                                                     17450000
174600          INSERT INTO TRECDIS                                     17460000
174700                 (ORD_NBR                                         17470000
174800               ,  ORD_LNE_NBR                                     17480000
174900               ,  REC_SEQ_NBR                                     17490000
175000               ,  OPER_UNT_ID                                     17500000
175100               ,  FCLTY_ID                                        17510000
175200               ,  CRE_TMST                                        17520000
175300               ,  CRE_UID                                         17530000
175400               ,  VER_STATUS_CDE                                  17540000
175500               ,  EXPTED_ITM_QTY                                  17550000
175600               ,  VERIFY_ITM_QTY                                  17560000
175700               ,  AP_VERIFY_ITM_QTY                               17570000
175800               ,  STR_NBR                                         17580000
175900               ,  STR_FCLTY_ID                                    17590000
176000               ,  PLAN_ITM_QTY                                    17600000
176100               ,  AP_PRC_CDE                                      17610000
176200               ,  AP_PRC_DTE)                                     17620000
176300          VALUES (:RECDIS-ORD-NBR                                 17630000
176400               ,  :RECDIS-ORD-LNE-NBR                             17640000
176500               ,  :RECDIS-REC-SEQ-NBR                             17650000
176600               ,  :RECDIS-OPER-UNT-ID                             17660000
176700               ,  :RECDIS-FCLTY-ID                                17670000
176800               ,  CURRENT_TIMESTAMP                               17680000
176900               ,  :RECDIS-CRE-UID                                 17690000
177000               ,  :RECDIS-VER-STATUS-CDE                          17700000
177100               ,  :RECDIS-EXPTED-ITM-QTY                          17710000
177200               ,  :RECDIS-VERIFY-ITM-QTY                          17720000
177300               ,  :RECDIS-AP-VERIFY-ITM-QTY                       17730000
177400               ,  :RECDIS-STR-NBR                                 17740000
177500               ,  :RECDIS-STR-FCLTY-ID                            17750000
177600               ,  :RECDIS-PLAN-ITM-QTY                            17760000
177700               ,  :RECDIS-AP-PRC-CDE                              17770000
177800               ,  :RECDIS-AP-PRC-DTE)                             17780000
177900     END-EXEC.                                                    17790000
178000                                                                  17800000
178100     EVALUATE TRUE                                                17810000
178200         WHEN SQLCODE = +0                                        17820000
178300              MOVE +1       TO PT-TOTAL-TRECDIS-INSERTS           17830000
178400                                                                  17840000
178500         WHEN OTHER                                               17850000
178600             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 17860000
178700             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           17870000
178800             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          17880000
178900             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           17890000
179000             MOVE SQLCODE TO PV-DISP-SQLCODE                      17900000
179100             MOVE '2510-INSERT-TRECDIS'                           17910000
179200                              TO RC097-ERROR-PARA-NAME            17920001
179300             SET RC097-DB-ERROR                                   17930001
179400                 PS-ERROR-YES    TO TRUE                          17940000
179500             DISPLAY '******************************************' 17950000
179600             DISPLAY '*ABEND                                   *' 17960000
179700             DISPLAY '*PROGRAM   = RCKUP992                    *' 17970000
179800             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 17980000
179900             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 17990000
180000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18000000
180100             DISPLAY '*PO = ' PV-DISP-PO                          18010000
180200             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18020000
180300             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18030000
180400             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  18040000
180500             DISPLAY '******************************************' 18050000
180600     END-EVALUATE.                                                18060000
180700                                                                  18070000
180800 2530-SELECT-APP-PO-LINE.                                         18080000
180900     EXEC SQL                                                     18090000
181000        SELECT  A.APP_PO_LNE_NBR                                  18100000
181100          INTO :PURITM-APP-PO-LNE-NBR                             18110000
181200          FROM TPURITM A                                          18120000
181300          WHERE A.PO_NBR          = :DK-PO-NBR                    18130000
181400            AND A.VER_STATUS_CDE  = 'A'                           18140000
181500            AND A.PO_LNE_NBR      = :DK-LNE-NBR                   18150000
181600     END-EXEC.                                                    18160000
181700                                                                  18170000
181800     EVALUATE TRUE                                                18180000
181900         WHEN SQLCODE = +0                                        18190000
182000         WHEN SQLCODE = -811                                      18200000
182100              CONTINUE                                            18210000
182200         WHEN SQLCODE = +100                                      18220000
182300             MOVE DK-PO-NBR   TO PV-DISP-PO                       18230000
182400             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 18240000
182500             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18250000
182600             MOVE '2530-SELECT-APP-PO-LINE'                       18260000
182700                              TO RC097-ERROR-PARA-NAME            18270001
182800             SET RC097-ITEM-NOT-ON-PO                             18280001
182900                 PS-ERROR-YES    TO TRUE                          18290000
183000             DISPLAY '******************************************' 18300000
183100             DISPLAY '*ABEND                                   *' 18310000
183200             DISPLAY '*PROGRAM   = RCKUP992                    *' 18320000
183300             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 18330000
183400             DISPLAY '*PARAGRAPH = 2530-SELECT-APP-PO-LINE     *' 18340000
183500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18350000
183600             DISPLAY '*PO = ' PV-DISP-PO                          18360000
183700             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18370000
183800             DISPLAY '******************************************' 18380000
183900         WHEN SQLWARN0 NOT = SPACES                               18390000
184000         WHEN SQLCODE < +0                                        18400000
184100         WHEN SQLCODE > +0                                        18410000
184200             MOVE DK-PO-NBR   TO PV-DISP-PO                       18420000
184300             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 18430000
184400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18440000
184500             MOVE '2530-SELECT-APP-PO-LINE'                       18450000
184600                              TO RC097-ERROR-PARA-NAME            18460001
184700             SET RC097-DB-ERROR                                   18470001
184800                 PS-ERROR-YES    TO TRUE                          18480000
184900             DISPLAY '******************************************' 18490000
185000             DISPLAY '*ABEND                                   *' 18500000
185100             DISPLAY '*PROGRAM   = RCKUP992                    *' 18510000
185200             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 18520000
185300             DISPLAY '*PARAGRAPH = 2530-SELECT-APP-PO-LINE     *' 18530000
185400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18540000
185500             DISPLAY '*PO = ' PV-DISP-PO                          18550000
185600             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18560000
185700             DISPLAY '******************************************' 18570000
185800     END-EVALUATE.                                                18580000
185801                                                                  18580101
185810 2600-INSERT-WFT-LOD-CNTL.                                        18581001
185820                                                                  18582001
185830     INITIALIZE DCLWFT00001.                                      18583001
185840     INITIALIZE DCLWFT00002.                                      18584001
185850                                                                  18585001
185860     EXEC SQL                                                     18586001
185870         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          18587001
185880     END-EXEC.                                                    18588001
185890                                                                  18589001
185891                                                                  18589101
185892     EXEC SQL                                                     18589201
185893         INSERT INTO WFT_LOD_CNTL                                 18589301
185894             ( PRC_CNTL_TMST                                      18589401
185895             , TRN_TYP_CDE                                        18589501
185896             , STAT_CDE                                           18589601
185897             , INIT_PRCG_BEG_TMST                                 18589701
185898             , END_TMST                                           18589801
185899             , ARCH_DAT_IND                                       18589901
185900             , DAT_LOD_VER_NBR                                    18590001
185901             , STR_NBR)                                           18590101
185902         VALUES                                                   18590201
185903             ( :WFT00002-PRC-CNTL-TMST                            18590301
185904             , 'SKUVER'                                           18590401
185905             , 'READY'                                            18590501
185906             , '0001-01-01-00.00.00.000000'                       18590601
185907             , '0001-01-01-00.00.00.000000'                       18590701
185908             , ' '                                                18590801
185909             , 0                                                  18590901
185910             , 0999                                               18591001
185911             )                                                    18591101
185912     END-EXEC.                                                    18591201
185913                                                                  18591301
185914     EVALUATE TRUE                                                18591401
185915        WHEN SQLCODE = +0                                         18591501
185916              MOVE +1       TO PT-TOTAL-WFT-CNTL-INSERTS          18591601
185917        WHEN SQLWARN0 NOT = SPACES                                18591701
185918        WHEN SQLCODE < +0                                         18591801
185919        WHEN SQLCODE > +0                                         18591901
185920             MOVE SQLCODE TO PV-DISP-SQLCODE                      18592001
185921             MOVE '2600-INSERT-WFT-LOD-CNTL'                      18592101
185922                              TO RC097-ERROR-PARA-NAME            18592201
185923             SET RC097-DB-ERROR                                   18592301
185924                 PS-ERROR-YES    TO TRUE                          18592401
185925             DISPLAY '******************************************' 18592501
185926             DISPLAY '*ABEND                                   *' 18592601
185927             DISPLAY '*PROGRAM   = RCKUP009                    *' 18592701
185928             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_CNTL      *' 18592801
185929             DISPLAY '*PARAGRAPH = 2600-INSERT-WFT-LOD-CNTL    *' 18592901
185930             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18593001
185931             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       18593101
185932             DISPLAY '******************************************' 18593201
185933     END-EVALUATE.                                                18593301
185934                                                                  18593401
185935 2700-INSERT-WFT-LOD-XFER.                                        18593501
185936                                                                  18593601
185937     INITIALIZE WFT00002-LOD-DAT-TXT.                             18593701
185938                                                                  18593801
185939     MOVE RC097-PO-NBR      TO PV-ORDER-NUMBER.                   18593901
185940     MOVE RC097-SKU-NBR     TO PV-SKU.                            18594002
185941     MOVE PV-REC-SEQ-NBR    TO PV-RCVR-ID.                        18594101
185942     MOVE RC097-OPER-UNIT   TO PV-DC.                             18594201
185943                                                                  18594301
185944     EXEC SQL                                                     18594401
185945          SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP           18594501
185946     END-EXEC.                                                    18594601
185947                                                                  18594701
185948     MOVE PV-DB2-TMST-CCYY  TO PV-VRFY-DATE (1:4).                18594801
185949     MOVE PV-DB2-TMST-MO    TO PV-VRFY-DATE (5:2).                18594901
185950     MOVE PV-DB2-TMST-DA    TO PV-VRFY-DATE (7:2).                18595001
185951     MOVE PV-DB2-TMST-HH    TO PV-VRFY-DATE (9:2).                18595101
185952     MOVE PV-DB2-TMST-MM    TO PV-VRFY-DATE (11:2).               18595201
185953     MOVE PV-DB2-TMST-SS    TO PV-VRFY-DATE (13:2).               18595301
185954     MOVE 1                 TO PV-STORE-COUNT.                    18595401
185955     MOVE RC097-STR-NBR     TO PV-STORE (1).                      18595501
185956     MOVE RC097-TO-VERIFY-QTY TO PV-STORE-QTY (1).                18595602
185957     MOVE 'P'               TO PV-STORE-QTY-SIGN (1).             18595701
185958     MOVE LENGTH OF PV-RECEIPT-ADJUSTMENT-REC TO                  18595801
185959        WFT00002-LOD-DAT-TXT-LEN.                                 18595901
185960                                                                  18596001
185961     MOVE PV-RECEIPT-ADJUSTMENT-REC TO                            18596101
185962        WFT00002-LOD-DAT-TXT-TEXT.                                18596201
185963                                                                  18596301
185964                                                                  18596401
185965     EXEC SQL                                                     18596501
185966         INSERT INTO WFT_LOD_XFER                                 18596601
185967             ( PRC_CNTL_TMST                                      18596701
185968             , TRN_TYP_CDE                                        18596801
185969             , BTCH_LOD_SEQ_ID                                    18596901
185970             , LOD_DAT_TXT                                        18597001
185971             )                                                    18597101
185972         VALUES                                                   18597201
185973             (:WFT00002-PRC-CNTL-TMST                             18597301
185974             , 'SKUVER'                                           18597401
185975             , 1                                                  18597501
185976             , :WFT00002-LOD-DAT-TXT                              18597601
185977             )                                                    18597701
185978     END-EXEC.                                                    18597801
185979                                                                  18597901
185980     EVALUATE TRUE                                                18598001
185981        WHEN SQLCODE = +0                                         18598101
185982              MOVE +1       TO PT-TOTAL-WFT-XFER-INSERTS          18598201
185983        WHEN SQLWARN0 NOT = SPACES                                18598301
185984        WHEN SQLCODE < +0                                         18598401
185985        WHEN SQLCODE > +0                                         18598501
185986             MOVE SQLCODE TO PV-DISP-SQLCODE                      18598601
185987             MOVE '2700-INSERT-WFT-LOD-XFER'                      18598701
185988                              TO RC097-ERROR-PARA-NAME            18598801
185989             SET RC097-DB-ERROR                                   18598901
185990                 PS-ERROR-YES    TO TRUE                          18599001
185991             DISPLAY '******************************************' 18599101
185992             DISPLAY '*ABEND                                   *' 18599201
185993             DISPLAY '*PROGRAM   = RCKUP009                    *' 18599301
185994             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_XFER      *' 18599401
185995             DISPLAY '*PARAGRAPH = 2700-INSERT-WFT-LOD-XFER    *' 18599501
185996             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18599601
185997             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       18599701
185998             DISPLAY '******************************************' 18599801
185999     END-EVALUATE.                                                18599901
186000*----------------------------------------------------------------*18600000
186010* OPEN THE TRECVER CURSOR                                        *18601000
186100*----------------------------------------------------------------*18610000
186200                                                                  18620000
186300 3000-OPEN-TRECVER-CSR.                                           18630000
186400                                                                  18640000
186500     EXEC SQL                                                     18650000
186600          DECLARE TRECVER-CSR CURSOR FOR                          18660000
186700           SELECT MAX_RCVR_NBR                                    18670000
186800           FROM   TRECVER                                         18680000
186900           WHERE  OPERCO_NBR = '03'                               18690000
187000           FOR UPDATE OF MAX_RCVR_NBR                             18700000
187100     END-EXEC.                                                    18710000
187200                                                                  18720000
187300     EXEC SQL                                                     18730000
187400          OPEN TRECVER-CSR                                        18740000
187500     END-EXEC.                                                    18750000
187600                                                                  18760000
187700     EVALUATE TRUE                                                18770000
187800         WHEN SQLCODE = +0                                        18780000
187900              CONTINUE                                            18790000
188000         WHEN SQLWARN0 NOT = SPACE                                18800000
188100         WHEN SQLCODE  NOT = +0                                   18810000
188200             MOVE SQLCODE TO PV-DISP-SQLCODE                      18820000
188300             MOVE '3000-OPEN-TRECVER-CSR'                         18830000
188400                              TO RC097-ERROR-PARA-NAME            18840001
188500             SET RC097-DB-ERROR                                   18850001
188600                 PS-ERROR-YES    TO TRUE                          18860000
188700             DISPLAY '******************************************' 18870000
188800             DISPLAY '*ABEND                                   *' 18880000
188900             DISPLAY '*PROGRAM   = RCKUP992                    *' 18890000
189000             DISPLAY '*DB2 OPER  = OPEN TRECVER CURSOR         *' 18900000
189100             DISPLAY '*PARAGRAPH = 3000-OPEN-TRECVER-CSR       *' 18910000
189200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18920000
189300             DISPLAY '******************************************' 18930000
189400     END-EVALUATE.                                                18940000
189500                                                                  18950000
189600/                                                                 18960000
189700*----------------------------------------------------------------*18970000
189800*    FETCH A TRECVER ROW                                         *18980000
189900*----------------------------------------------------------------*18990000
190000                                                                  19000000
190100 3020-FETCH-TRECVER-CSR.                                          19010000
190200                                                                  19020000
190300     EXEC SQL                                                     19030000
190400          FETCH TRECVER-CSR                                       19040000
190500          INTO :RECVER-MAX-RCVR-NBR                               19050000
190600     END-EXEC.                                                    19060000
190700                                                                  19070000
190800     EVALUATE TRUE                                                19080000
190900         WHEN SQLCODE = +0                                        19090000
191000              CONTINUE                                            19100000
191100                                                                  19110000
191200         WHEN SQLCODE = +100                                      19120000
191300              SET PS-EOF-TRECVER-CSR TO TRUE                      19130000
191400                                                                  19140000
191500         WHEN SQLWARN0 NOT = SPACE                                19150000
191600         WHEN SQLCODE < +0                                        19160000
191700         WHEN SQLCODE > +0                                        19170000
191800             MOVE SQLCODE TO PV-DISP-SQLCODE                      19180000
191900             MOVE '3020-FETCH-TRECVER-CSR'                        19190000
192000                              TO RC097-ERROR-PARA-NAME            19200001
192100             SET RC097-DB-ERROR                                   19210001
192200                 PS-ERROR-YES    TO TRUE                          19220000
192300             DISPLAY '******************************************' 19230000
192400             DISPLAY '*ABEND                                   *' 19240000
192500             DISPLAY '*PROGRAM   = RCKUP992                    *' 19250000
192600             DISPLAY '*DB2 OPER  = FETCH TRECVER CURSOR        *' 19260000
192700             DISPLAY '*PARAGRAPH = 3020-FETCH-TRECVER-CSR      *' 19270000
192800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19280000
192900             DISPLAY '******************************************' 19290000
193000     END-EVALUATE.                                                19300000
193100                                                                  19310000
193200/                                                                 19320000
193300*----------------------------------------------------------------*19330000
193400*    UDPATE CURRENT CURSOR                                       *19340000
193500*----------------------------------------------------------------*19350000
193600                                                                  19360000
193700 3040-DELETE-TRECVER-CSR.                                         19370000
193800                                                                  19380000
193900     EXEC SQL                                                     19390000
194000          DELETE FROM TRECVER                                     19400000
194100            WHERE CURRENT OF TRECVER-CSR                          19410000
194200     END-EXEC                                                     19420000
194300                                                                  19430000
194400     EVALUATE TRUE                                                19440000
194500         WHEN SQLCODE = +0                                        19450000
194600              CONTINUE                                            19460000
194700                                                                  19470000
194800         WHEN SQLWARN0 NOT = SPACE                                19480000
194900         WHEN SQLCODE < +0                                        19490000
195000         WHEN SQLCODE > +0                                        19500000
195100             MOVE SQLCODE TO PV-DISP-SQLCODE                      19510000
195200             MOVE '3040-DELETE-TRECVER-CSR'                       19520000
195300                              TO RC097-ERROR-PARA-NAME            19530001
195400             SET RC097-DB-ERROR                                   19540001
195500                 PS-ERROR-YES    TO TRUE                          19550000
195600             DISPLAY '******************************************' 19560000
195700             DISPLAY '*ABEND                                   *' 19570000
195800             DISPLAY '*PROGRAM   = RCKUP992                    *' 19580000
195900             DISPLAY '*DB2 OPER  = DELETE TRECVER CURSOR       *' 19590000
196000             DISPLAY '*PARAGRAPH = 3040-DELETE-TRECVER-CSR     *' 19600000
196100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19610000
196200             DISPLAY '******************************************' 19620000
196300     END-EVALUATE.                                                19630000
196400                                                                  19640000
196500/                                                                 19650000
196600*----------------------------------------------------------------*19660000
196700* INSERT THE TRECVER ROW                                         *19670000
196800*----------------------------------------------------------------*19680000
196900                                                                  19690000
197000 3060-INSERT-TRECVER.                                             19700000
197100                                                                  19710000
197200     EXEC SQL                                                     19720000
197300          INSERT INTO TRECVER                                     19730000
197400                 ( OPERCO_NBR                                     19740000
197500                ,  MAX_RCVR_NBR )                                 19750000
197600          VALUES ( '03'                                           19760000
197700                ,  :RECVER-MAX-RCVR-NBR )                         19770000
197800     END-EXEC.                                                    19780000
197900                                                                  19790000
198000     EVALUATE TRUE                                                19800000
198100         WHEN SQLCODE = +0                                        19810000
198200         WHEN SQLCODE = -904                                      19820000
198300         WHEN SQLCODE = -913                                      19830000
198400             CONTINUE                                             19840000
198500                                                                  19850000
198600         WHEN SQLWARN0 NOT = SPACE                                19860000
198700         WHEN SQLCODE < +0                                        19870000
198800         WHEN SQLCODE > +0                                        19880000
198900             MOVE SQLCODE TO PV-DISP-SQLCODE                      19890000
199000             MOVE '3060-INSERT-TRECVER'                           19900000
199100                              TO RC097-ERROR-PARA-NAME            19910001
199200             SET RC097-DB-ERROR                                   19920001
199300                 PS-ERROR-YES    TO TRUE                          19930000
199400             DISPLAY '******************************************' 19940000
199500             DISPLAY '*ABEND                                   *' 19950000
199600             DISPLAY '*PROGRAM   = RCKUP992                    *' 19960000
199700             DISPLAY '*DB2 OPER  = INSERT TRECVER              *' 19970000
199800             DISPLAY '*PARAGRAPH = 3060-INSERT-TRECVER         *' 19980000
199900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19990000
200000             DISPLAY '******************************************' 20000000
200100     END-EVALUATE.                                                20010000
200200                                                                  20020000
200300/                                                                 20030000
200400*----------------------------------------------------------------*20040000
200500* CLOSE THE TRECVER CURSOR                                       *20050000
200600*----------------------------------------------------------------*20060000
200700                                                                  20070000
200800 3080-CLOSE-TRECVER-CSR.                                          20080000
200900                                                                  20090000
201000     EXEC SQL                                                     20100000
201100          CLOSE TRECVER-CSR                                       20110000
201200     END-EXEC                                                     20120000
201300                                                                  20130000
201400     EVALUATE TRUE                                                20140000
201500         WHEN SQLCODE = +0                                        20150000
201600              CONTINUE                                            20160000
201700         WHEN SQLWARN0 NOT = SPACE                                20170000
201800         WHEN SQLCODE  NOT = +0                                   20180000
201900             MOVE SQLCODE TO PV-DISP-SQLCODE                      20190000
202000             MOVE '3080-CLOSE-TRECVER-CSR'                        20200000
202100                              TO RC097-ERROR-PARA-NAME            20210001
202200             SET RC097-DB-ERROR                                   20220001
202300                 PS-ERROR-YES    TO TRUE                          20230000
202400             DISPLAY '******************************************' 20240000
202500             DISPLAY '*ABEND                                   *' 20250000
202600             DISPLAY '*PROGRAM   = RCKUP992                    *' 20260000
202700             DISPLAY '*DB2 OPER  = CLOSE TRECVER CURSOR        *' 20270000
202800             DISPLAY '*PARAGRAPH = 3080-CLOSE-TRECVER-CSR      *' 20280000
202900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20290000
203000             DISPLAY '******************************************' 20300000
203100     END-EVALUATE.                                                20310000
203200                                                                  20320000
203300/                                                                 20330000
203400                                                                  20340000
203500 4000-READ-RECORD.                                                20350000
203600     SET PS-NOT-END-OF-INPUT TO TRUE.                             20360000
203700     READ INPUT-FILE  INTO RC097-ITEM-REC                         20370001
203800         AT END                                                   20380000
203900           SET PS-END-OF-INPUT TO TRUE                            20390000
204000         NOT AT END                                               20400000
204100           ADD +1               TO PA-TOTAL-RECORDS-READ          20410000
204200           ADD RC097-TO-VERIFY-QTY                                20420001
204300                                TO PA-TOTAL-UNITS-PROCESSED       20430000
204400*          DISPLAY ' PO NBR '   RC097-PO-NBR                      20440001
204500*                  '  LNE NBR ' RC097-PO-LNE-NBR                  20450001
204600*                  '  STR NBR ' RC097-STR-NBR                     20460001
204700*                  '  VE QTY '  RC097-TO-VERIFY-QTY.              20470001
204800           MOVE RC097-PO-NBR        TO PV-BKUP-PO-NBR-1           20480001
204900           MOVE RC097-PO-LNE-NBR    TO PV-BKUP-PO-LNE-1           20490001
205000           MOVE RC097-STR-NBR       TO PV-BKUP-STR-NBR-1          20500001
205100           MOVE RC097-TO-VERIFY-QTY TO PV-BKUP-TO-VERIFY-QTY-1    20510001
205200           WRITE BKUP-RECORD FROM PV-BKUP-RECORD-1.               20520000
205300                                                                  20530000
205400****************************************************************  20540000
205500* END RUN OF PROGRAM ROUTINE:                                     20550000
205600* DISPLAY SUMMARY STATISTICS                                      20560000
205700****************************************************************  20570000
205800 5000-END-RUN-ROUTINE.                                            20580000
205900                                                                  20590000
206000     CLOSE INPUT-FILE                                             20600000
206100           ERROR-FILE                                             20610000
206200           BKUP-FILE.                                             20620000
206300                                                                  20630000
206400*END OF JOB ROUTINE.                                              20640000
206500     PERFORM 8000-EOJ-ROUTINE.                                    20650000
206600                                                                  20660000
206700*END PROGRAM.                                                     20670000
206800     DISPLAY '************  END OF RCKUP992  ***************'     20680000
206900     STOP RUN.                                                    20690000
207000                                                                  20700000
207100******************************************************************20710000
207200* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     20720000
207300******************************************************************20730000
207400 6000-DB2-COMMIT.                                                 20740000
207500                                                                  20750000
207600     EXEC SQL                                                     20760000
207700         COMMIT                                                   20770000
207800     END-EXEC.                                                    20780000
207900                                                                  20790000
208000     EVALUATE TRUE                                                20800000
208100         WHEN SQLCODE = +0                                        20810000
208200              ADD +1  TO PA-TOTAL-DB2-COMMITS                     20820000
208300              ADD PT-TOTAL-TPKSLIP-INSERTS                        20830000
208400                                     TO PA-TOTAL-TPKSLIP-INSERTS  20840000
208500              ADD PT-TOTAL-TPKSLIP-UPDATES                        20850000
208600                                     TO PA-TOTAL-TPKSLIP-UPDATES  20860000
208700*             ADD PT-TOTAL-TPKITEM-INSERTS                        20870000
208800*                                    TO PA-TOTAL-TPKITEM-INSERTS  20880000
208900              ADD PT-TOTAL-TRECEIV-INSERTS                        20890000
209000                                     TO PA-TOTAL-TRECEIV-INSERTS  20900000
209100              ADD PT-TOTAL-TRECEIV-UPDATES                        20910000
209200                                     TO PA-TOTAL-TRECEIV-UPDATES  20920000
209300*             ADD PT-TOTAL-TRECITM-INSERTS                        20930000
209400*                                    TO PA-TOTAL-TRECITM-INSERTS  20940000
209500              ADD PT-TOTAL-TRECDIS-INSERTS                        20950000
209600                                     TO PA-TOTAL-TRECDIS-INSERTS  20960000
209700              ADD PT-TOTAL-WFT-CNTL-INSERTS                       20970001
209800                                     TO PA-TOTAL-WFT-CNTL-INSERTS 20980001
209900              ADD PT-TOTAL-WFT-XFER-INSERTS                       20990001
210000                                     TO PA-TOTAL-WFT-XFER-INSERTS 21000001
210100         WHEN SQLWARN0 NOT = SPACES                               21010000
210200         WHEN SQLCODE  NOT = ZERO                                 21020000
210300         MOVE '6000-DB2-COMMIT'                                   21030000
210400                          TO RC097-ERROR-PARA-NAME                21040001
210500         SET RC097-DB-ERROR                                       21050001
210600             PS-ERROR-YES    TO TRUE                              21060000
210700         DISPLAY '****************************'                   21070000
210800         DISPLAY '** ABEND                  **'                   21080000
210900         DISPLAY '** PROGRAM = RCKUP992     **'                   21090000
211000         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   21100000
211100         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   21110000
211200         DISPLAY '****************************'                   21120000
211300     END-EVALUATE.                                                21130000
211400                                                                  21140000
211500 6100-DB2-ROLLBACK.                                               21150000
211600                                                                  21160000
211700     EXEC SQL                                                     21170000
211800         ROLLBACK                                                 21180000
211900     END-EXEC.                                                    21190000
212000                                                                  21200000
212100     EVALUATE TRUE                                                21210000
212200         WHEN SQLCODE = +0                                        21220000
212300              CONTINUE                                            21230000
212400         WHEN SQLWARN0 NOT = SPACES                               21240000
212500         WHEN SQLCODE  NOT = ZERO                                 21250000
212600         MOVE '6100-DB2-ROLLBACK'                                 21260000
212700                          TO RC097-ERROR-PARA-NAME                21270001
212800         SET RC097-DB-ERROR                                       21280001
212900             PS-ERROR-YES    TO TRUE                              21290000
213000         DISPLAY '****************************'                   21300000
213100         DISPLAY '** ABEND                  **'                   21310000
213200         DISPLAY '** PROGRAM = RCKUP992     **'                   21320000
213300         DISPLAY '** PARAGRAPH = 6100-ROLLBACK'                   21330000
213400         DISPLAY '** UNSUCCESSFUL ROLLBACK  **'                   21340000
213500         DISPLAY '****************************'                   21350000
213600     END-EVALUATE.                                                21360000
213700                                                                  21370000
213800******************************************************************21380000
213900* UPDATE CHECKPOINT STATUS CODE WITH 0 FOR COMPLETION.            21390000
214000* DISPLAY STATISTICS FOR THE PROGRAM                              21400000
214100******************************************************************21410000
214200 8000-EOJ-ROUTINE.                                                21420000
214300                                                                  21430000
214400                                                                  21440000
214500         DISPLAY ' ********************************************'  21450000
214600         DISPLAY '     * RCKUP992 SUMMARY STATISTICS *         '  21460000
214700         DISPLAY ' '                                              21470000
214800         DISPLAY '       ---------------------------           '  21480000
214900         DISPLAY '          RECEIVER CREATE UPDATES            '  21490000
215000         DISPLAY '       ---------------------------           '  21500000
215100         DISPLAY ' '                                              21510000
215200         DISPLAY ' TOTAL RECORDS READ                :'           21520000
215300                                        PA-TOTAL-RECORDS-READ     21530000
215400         DISPLAY ' TOTAL UNITS PROCESSED             :'           21540000
215500                                        PA-TOTAL-UNITS-PROCESSED  21550000
215600         DISPLAY ' TOTAL MESSAGES IN ERROR           :'           21560000
215700                                        PA-TOTAL-ERROR-RECS       21570000
215800         DISPLAY ' TOTAL PKSLIP INSERTS              :'           21580000
215900                                        PA-TOTAL-TPKSLIP-INSERTS  21590000
216000         DISPLAY ' TOTAL PKSLIP UPDATES              :'           21600000
216100                                        PA-TOTAL-TPKSLIP-UPDATES  21610000
216200         DISPLAY ' TOTAL PKITEM INSERTS              :'           21620000
216300                                        PA-TOTAL-TPKITEM-INSERTS  21630000
216400         DISPLAY ' TOTAL RECEIVER INSERTS            :'           21640000
216500                                        PA-TOTAL-TRECEIV-INSERTS  21650000
216600         DISPLAY ' TOTAL RECEIVER UPDATES            :'           21660000
216700                                        PA-TOTAL-TRECEIV-UPDATES  21670000
216800         DISPLAY ' TOTAL RECITM INSERTS              :'           21680000
216900                                        PA-TOTAL-TRECITM-INSERTS  21690000
217000         DISPLAY ' TOTAL RECDIS INSERTS              :'           21700000
217100                                        PA-TOTAL-TRECDIS-INSERTS  21710000
217200         DISPLAY ' TOTAL DB2 COMMITS                 :'           21720000
217300                                        PA-TOTAL-DB2-COMMITS      21730000
217310         DISPLAY ' TOTAL WFT_CNTL INSERTS:  '                     21731001
217320                                        PA-TOTAL-WFT-CNTL-INSERTS 21732001
217330         DISPLAY ' TOTAL WFT_XFER INSERTS:  '                     21733001
217340                                        PA-TOTAL-WFT-XFER-INSERTS 21734001
217400         DISPLAY '********************************************'.  21740000
217500                                                                  21750000
217600                                                                  21760000
217700******************************************************************21770000
217800**                      END OF PROGRAM                            21780000
217900*                                                                 21790000
218000******************************************************************21800000
