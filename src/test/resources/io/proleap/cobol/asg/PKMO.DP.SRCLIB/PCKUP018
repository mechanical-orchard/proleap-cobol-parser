000100 IDENTIFICATION DIVISION.                                         00030001
000700 PROGRAM-ID.             PCKUP018.                                00090001
000800 AUTHOR.                 DEANNA BRANTNER.                         00100001
000900 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00110001
001000 DATE-WRITTEN            APRIL 2006.                              00120001
001100 DATE-COMPILED.                                                   00130001
001200******************************************************************00140001
000300* UTILITY PROGRAM TO BE USED TO INSERT A ROW INTO SUT_OTBND_LOC   00141001
000400* WHEN E-COMM INTRANSIT HAS BEEN PROCESSED FOR A PARTICULAR       00142001
000400* CARTON.                                                         00142101
000500* WILL BE PART OF PCK044 JOB                                      00143001
000500*                                                                 00143112
000500* CHANGES:                                                        00143212
000500* 05/15/2020  JEAN KURK  REPLACE WMRD015 WITH CERD015             00143312
000500*                                                                 00143413
000500* 06/29/2023  JEAN KURK  ADD CHECKPOINT RESTART FOR COMMIT        00143532
000500*                        FREQUENCY.         CHG0270281            00143631
001200******************************************************************00143713
001300 ENVIRONMENT DIVISION.                                            00150001
001400 CONFIGURATION SECTION.                                           00160001
001500 SOURCE-COMPUTER.        IBM-3090.                                00170001
001600 OBJECT-COMPUTER.        IBM-3090.                                00180001
001700 INPUT-OUTPUT SECTION.                                            00190001
001800 FILE-CONTROL.                                                    00200001
001900                                                                  00210001
002000     SELECT UPDATE-EXTRACT-FILE                                   00220001
002100         ASSIGN TO INP01.                                         00230001
002200                                                                  00240001
002300 DATA DIVISION.                                                   00250001
002400 FILE SECTION.                                                    00260001
002500                                                                  00270001
002600 FD  UPDATE-EXTRACT-FILE                                          00280001
002700     RECORDING MODE IS F                                          00290001
002800     LABEL RECORDS ARE STANDARD                                   00300001
002900     RECORD CONTAINS 158 CHARACTERS                               00310001
003000     BLOCK CONTAINS 0  RECORDS.                                   00320001
003100 01  UPDATE-EXTRACT-REC               PIC X(158).                 00330001
003200                                                                  00340001
003300 WORKING-STORAGE SECTION.                                         00350001
003400 01  PS-SWITCHES.                                                 00360001
003500     05  PS-EOF-EXTRACT-SW            PIC X(01) VALUE 'N'.        00370001
003600         88  PS-EOF-EXTRACT-YES                 VALUE 'Y'.        00380001
013000     05  PS-TYPE-OF-RUN-SW             PIC X(01)  VALUE 'N'.      00381015
013100         88  PS-NORMAL-RUN                        VALUE 'N'.      00382015
013200         88  PS-RESTART-RUN                       VALUE 'Y'.      00383015
003700                                                                  00383415
036700 01  CR-CHECKPOINT-RESTART-AREA.                                  00383515
036800     05  CR-CKPT-STAT-CODE        PIC  X(01)   VALUE SPACE.       00383615
036900         88  NORMAL-RUN                        VALUE '0'.         00383715
037000         88  RESTART-RUN                       VALUE '9'.         00383815
036800     05  CR-CKPT-FRQNCY           PIC  S9(5)V COMP-3  VALUE 0.    00383916
037100     05  CR-CKPT-RESTART-INFO.                                    00384015
037200         10  CR-LOCATION          PIC 9(4)     VALUE ZERO.        00386021
037200         10  CR-CONTAINER-ID      PIC X(20)    VALUE SPACES.      00387021
003700                                                                  00390001
003800 01  PROGRAM-VARIABLES.                                           00400002
003900     05  PV-DISP-NBR                  PIC Z,ZZZ,ZZ9.              00410001
004000     05  PV-ABEND-CODE                PIC S9(04) VALUE ZERO       00420001
004100                                                 COMP SYNC.       00430001
004200         88  ABEND-4013-DB2-ERROR                VALUE +4013.     00440001
004300     05  PV-EXTRACT-COUNT             PIC S9(05) COMP-3           00450001
004400                                          VALUE ZERO.             00460001
004500     05  PV-INSERT-COUNT              PIC S9(05) COMP-3           00470001
004600                                          VALUE ZERO.             00480001
004900     05  PV-RETRY-COUNTER             PIC S9(03) COMP-3           00510001
005000                                        VALUE 3.                  00520001
005100     05  PC-MAX-RETRIES               PIC S9(03) COMP-3           00530001
005200                                        VALUE 3.                  00540001
005300     05  PV-ABEND-PARAGRAPH           PIC X(35) VALUE SPACES.     00550001
010300     05  PV-HOLD-TMST                 PIC X(26)  VALUE SPACES.    00552119
010400     05  PV-TMST                      PIC X(26)  VALUE SPACES.    00554019
010400     05  PV-COMMIT-CNT                PIC 9(09)  VALUE ZERO.      00555023
005400                                                                  00560001
013900 01  PC-CONSTANTS.                                                00561015
014200     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00562015
014300                                                   'PCKUP018'.    00563015
028500     05  PC-IN-PROCESS-CODE          PIC  X(01)    VALUE '9'.     00564015
028600     05  PC-RUN-COMPLETE-CODE        PIC  X(01)    VALUE '0'.     00565015
005400                                                                  00566015
005500 01  PV-DISP-KEY-MSG.                                             00570001
005600     05  FILLER                      PIC X(07) VALUE              00580001
005700         ' CTN= '.                                                00590001
005800     05  PV-KEY-SHIPT-UNT-ID         PIC 9(18) VALUE ZEROES.      00600001
005900     05  FILLER                      PIC X(12) VALUE              00610001
006000         '; LOC NBR= '.                                           00620001
006700     05  PV-KEY-LOC                  PIC 9(04) VALUE ZEROES.      00690001
007500                                                                  00770001
007600** INPUT FILE LAYOUT                                              00780001
007600     COPY CERD015.                                                00781012
007700                                                                  00790001
007800     EXEC SQL                                                     00800001
007900         INCLUDE SUT00027                                         00810001
008000     END-EXEC.                                                    00820001
008100                                                                  00830001
008200     EXEC SQL                                                     00840001
008300         INCLUDE SQLCA                                            00850001
008400     END-EXEC.                                                    00860001
047700*---------------------------------------------------------------  00861015
047800*  CHECKPOINT/RESTART CONTROL TABLE                               00862015
047900*---------------------------------------------------------------  00863015
048000     EXEC SQL                                                     00864015
048100         INCLUDE TCKRSTCN                                         00865015
048200     END-EXEC.                                                    00866015
048400*---------------------------------------------------------------  00867015
048500*  CHECKPOINT/RESTART DATA TABLE                                  00868015
048600*---------------------------------------------------------------  00869015
048700     EXEC SQL                                                     00869115
048800         INCLUDE TCKRSTIN                                         00869215
048900     END-EXEC.                                                    00869315
008500                                                                  00870001
008600     COPY SQLCA2.                                                 00880001
008700     COPY DPWS004.                                                00890001
008800                                                                  00900001
008900******************************************************************00910001
009000 PROCEDURE DIVISION.                                              00920001
009100     PERFORM 1000-INITIALIZE.                                     00930001
009200     PERFORM 2000-PROCESS                                         00940001
009300             UNTIL PS-EOF-EXTRACT-YES.                            00950028
009400     PERFORM 9000-EOJ.                                            00960001
009500                                                                  00970001
009600     GOBACK.                                                      00980001
009700                                                                  00990001
009800 1000-INITIALIZE.                                                 01000001
009900                                                                  01010001
010000     OPEN INPUT UPDATE-EXTRACT-FILE.                              01020028
010100                                                                  01030001
060800     PERFORM R800-SELECT-CHECKPOINT-CNTL.                         01031015
065400                                                                  01032015
065400     IF RESTART-RUN                                               01033015
065400         SET PS-RESTART-RUN        TO TRUE                        01034015
060800         PERFORM R900-SELECT-CHECKPOINT-INFO                      01034115
061100         MOVE TCKRSTINF-WORK-STRG-DESC-TEXT                       01034215
061200                                    TO CR-CKPT-RESTART-INFO       01034315
061300                                                                  01034415
061700         DISPLAY '***********************************************'01034715
061400         DISPLAY '** PCKUP018 CHECKPOINT RESTART **'              01034815
061400         DISPLAY '**          FOR SUT_OTBND_LOC    '              01034915
061500         DISPLAY '** RESTART CONTAINER = ' CR-CONTAINER-ID        01035024
061500         DISPLAY '**         LOCATION  = ' CR-LOCATION            01035124
061700         DISPLAY '***********************************************'01035215
065400     ELSE                                                         01035519
073400         MOVE PC-IN-PROCESS-CODE   TO CR-CKPT-STAT-CODE           01036015
073600         PERFORM U300-UPDATE-CHECKPOINT-CNTL                      01037015
073700         PERFORM C100-COMMIT                                      01038018
065400     END-IF.                                                      01039015
032300     PERFORM C200-SET-CHECKPOINT-TIME.                            01039119
032300                                                                  01039219
010200     PERFORM 8000-READ-EXTRACT-FILE.                              01040019
010300     IF PS-EOF-EXTRACT-YES                                        01050001
010400         DISPLAY ' PCKUP018 - INPUT FILE IS EMPTY '               01060001
065400     ELSE                                                         01071019
065400         IF RESTART-RUN                                           01071119
010200             PERFORM 8000-READ-EXTRACT-FILE                       01071219
010200                 UNTIL PS-EOF-EXTRACT-YES                         01071319
010200                    OR CE015-LOCATION > CR-LOCATION               01071419
010200                    OR (CE015-LOCATION = CR-LOCATION              01071519
010200                        AND CE015-CONTAINER-ID > CR-CONTAINER-ID) 01071622
065400         END-IF                                                   01071721
010500     END-IF.                                                      01072019
010600                                                                  01080001
010600                                                                  01081028
010700 2000-PROCESS.                                                    01090001
010800                                                                  01100001
010900     MOVE CE015-CONTAINER-ID  TO SUT00027-SHIPT-UNT-ID            01110012
                                       PV-KEY-SHIPT-UNT-ID.             01110107
010900     MOVE CE015-LOCATION      TO SUT00027-LOC-NBR                 01111012
                                       PV-KEY-LOC.                      01112007
010900     PERFORM 3000-INSERT-ERDM-ROW.                                01120019
011300                                                                  01150001
023000     PERFORM C300-CHECKPOINT-CHECK.                               01151019
023100                                                                  01152019
011400     PERFORM 8000-READ-EXTRACT-FILE.                              01160001
011500                                                                  01170001
015100                                                                  01530001
010900 3000-INSERT-ERDM-ROW.                                            01541001
015300                                                                  01550001
015400     MOVE '3000-INSERT-ERDM-ROW'      TO PV-ABEND-PARAGRAPH.      01560026
015300                                                                  01570001
021500     PERFORM                                                      02180001
021600         WITH TEST AFTER                                          02190001
021700         VARYING PV-RETRY-COUNTER                                 02200001
021800         FROM 1 BY 1                                              02210001
021900               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)         02220001
022000                  OR  (SQLCODE = -803)                            02230001
022100                  OR  (SQLCODE = +0))                             02240001
022296                                                                  02260001
022300     EXEC SQL                                                     02270001
022400         INSERT INTO SUT_OTBND_LOC                                02280001
022500         (                                                        02290001
022600             SHIPT_UNT_ID                                         02300001
022700            ,CRE_TMST                                             02310001
022800            ,OTBND_TRIP_ID                                        02320001
022900            ,LOC_NBR                                              02330001
023000            ,SCN_CDE                                              02340001
023100            ,CRE_USR_ID                                           02350001
023200            ,ACTV_CDE                                             02360001
023300            ,INBD_TRIP_ID                                         02370001
023400         )                                                        02380001
023500             VALUES                                               02390001
023600         (                                                        02400001
023700             :SUT00027-SHIPT-UNT-ID                               02410001
023800         ,   CURRENT TIMESTAMP                                    02420001
023900         ,   NULL                                                 02430003
024000         ,   :SUT00027-LOC-NBR                                    02440001
024100         ,   'ERDM'                                               02450001
024200         ,   'PCKUT063'                                           02460001
024300         ,   'A'                                                  02470001
024400         ,   0                                                    02480001
024500         )                                                        02490001
024600     END-EXEC                                                     02500001
024700                                                                  02510001
024800     EVALUATE TRUE                                                02520001
024900         WHEN SQLCODE = ZERO                                      02530001
025000             ADD 1                    TO PV-INSERT-COUNT          02540001
025100         WHEN SQLCODE = -803                                      02550001
025200             CONTINUE                                             02550105
025300         WHEN SQLCODE = -904                                      02570001
025400         WHEN SQLCODE = -911                                      02580001
025500         WHEN SQLCODE = -913                                      02590001
025600             CONTINUE                                             02600001
025700                                                                  02610001
025800         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  02620001
025900             DISPLAY '**************************************'     02630001
026000             DISPLAY 'WARNING ISSUED '                            02640001
026100             DISPLAY 'INSERT CARTON LOC                     '     02650001
026200             DISPLAY  PV-DISP-KEY-MSG                             02660001
026300             DISPLAY '**************************************'     02670001
026400             PERFORM 9800-SQL-WARNING                             02680001
026500                                                                  02690001
026600         WHEN SQLCODE < ZERO                                      02700001
026700             DISPLAY '**************************************'     02710001
026800             DISPLAY 'ERROR ISSUED ON                       '     02720001
026900             DISPLAY 'INSERT CARTON LOC'                          02730001
027000             DISPLAY PV-DISP-KEY-MSG                              02740001
027100             DISPLAY '**************************************'     02750001
027200             PERFORM 9900-SQL-ERROR                               02760001
027300         END-EVALUATE                                             02770001
027400     END-PERFORM.                                                 02780001
027500                                                                  02790001
027600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    02800001
027700         SQLCODE NOT = ZERO                                       02810001
027800         DISPLAY '**************************************'         02820001
027900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         02830001
028000         DISPLAY 'INSERT CARTON LOC'                              02840001
028100         DISPLAY PV-DISP-KEY-MSG                                  02850001
028200         DISPLAY '**************************************'         02860001
028300         PERFORM 9900-SQL-ERROR                                   02870001
028400     END-IF.                                                      02880001
028500                                                                  02890001
028600 8000-READ-EXTRACT-FILE.                                          02900001
028700                                                                  02910001
028800     READ UPDATE-EXTRACT-FILE                                     02920001
028900         INTO CE015-RECEIPT-UPLOAD-RECORD                         02930012
029000     AT END                                                       02940001
029100         SET PS-EOF-EXTRACT-YES       TO TRUE                     02950001
029200     NOT AT END                                                   02960001
029300         ADD 1                        TO PV-EXTRACT-COUNT         02970001
029400     END-READ.                                                    02980001
029500                                                                  02990001
153600******************************************************************02990116
153700* COMMIT UNIT OF WORK                                             02990216
153800******************************************************************02990316
153801 C100-COMMIT.                                                     02990426
154000                                                                  02990516
015400     MOVE 'C100-COMMIT'               TO PV-ABEND-PARAGRAPH.      02990726
015300                                                                  02990826
109640     EXEC SQL                                                     02990916
109650        COMMIT                                                    02991016
109660     END-EXEC.                                                    02991116
109670                                                                  02991216
109680     EVALUATE TRUE                                                02991316
109690        WHEN SQLCODE = 0                                          02991416
109690           ADD 1 TO PV-COMMIT-CNT                                 02991523
109692        WHEN OTHER                                                02991623
027800             DISPLAY '**************************************'     02991723
027900             DISPLAY 'COMMIT ERROR                          '     02991823
028200             DISPLAY '**************************************'     02991918
028300             PERFORM 9900-SQL-ERROR                               02992018
109701     END-EVALUATE.                                                02992316
109702                                                                  02992416
109702                                                                  02992519
050100*----------------------------------------------------------------*02992619
050200*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *02992719
050300*----------------------------------------------------------------*02992819
050400 C200-SET-CHECKPOINT-TIME.                                        02992919
154000                                                                  02993026
015400     MOVE 'C200-SET-CHECKPOINT-TIME'  TO PV-ABEND-PARAGRAPH.      02993126
050500                                                                  02993219
051300     EXEC SQL                                                     02993819
051400         SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)     02993919
051500           INTO :PV-HOLD-TMST                                     02994019
051600           FROM TCKRSTCNTL                                        02994119
051700          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              02994220
051800     END-EXEC.                                                    02994319
051900                                                                  02994419
052000     EVALUATE TRUE                                                02994519
052100         WHEN SQLCODE = ZERO                                      02994619
052200         WHEN SQLCODE = -904                                      02994719
052300         WHEN SQLCODE = -913                                      02994819
052400             CONTINUE                                             02995019
052500                                                                  02995119
052600         WHEN SQLWARN0 NOT = SPACES                               02995219
052700         WHEN SQLCODE  NOT = ZERO                                 02995319
027800             DISPLAY '**************************************'     02995419
027900             DISPLAY 'ERROR GETTING CHKPT TIME              '     02995519
028200             DISPLAY '**************************************'     02995619
028300             PERFORM 9900-SQL-ERROR                               02995719
053800     END-EVALUATE.                                                02996719
054000                                                                  02996919
054000                                                                  02997019
033800*----------------------------------------------------------------*02997119
033900*    CHECK TO SEE IF A CHECKPOINT SHOULD BE TAKEN.               *02997219
034000*----------------------------------------------------------------*02997319
034100 C300-CHECKPOINT-CHECK.                                           02997419
154000                                                                  02997526
015400     MOVE 'C300-CHECKPOINT-CHECK'     TO PV-ABEND-PARAGRAPH.      02997626
034200                                                                  02997719
034500     EXEC SQL                                                     02997819
034600       SET :PV-TMST = CURRENT TIMESTAMP                           02997919
034700     END-EXEC.                                                    02998019
034800                                                                  02998119
034900     IF SQLCODE = +0                                              02998219
035000         CONTINUE                                                 02998419
035100     ELSE                                                         02998519
027800         DISPLAY '**************************************'         02999319
027900         DISPLAY 'ERROR SETTING TIME                    '         02999419
028200         DISPLAY '**************************************'         02999519
028300         PERFORM 9900-SQL-ERROR                                   02999619
036000     END-IF.                                                      02999719
036100                                                                  02999819
036200     IF PV-TMST > PV-HOLD-TMST                                    02999919
036800         PERFORM U400-UPDATE-CHECKPOINT-INFO                      03000521
036900         PERFORM C100-COMMIT                                      03000619
037000         PERFORM C200-SET-CHECKPOINT-TIME                         03000719
037100     END-IF.                                                      03000819
037200                                                                  03000919
190300*---------------------------------------------------------------  03001019
190400*    GETS THE RESTART STATUS CODE FROM THE CHECKPOINT/RESTART     03001119
190500*    CONTROL TABLE.                                               03001219
190600*---------------------------------------------------------------  03001319
190700 R800-SELECT-CHECKPOINT-CNTL.                                     03001419
154000                                                                  03001526
015400     MOVE 'R800-SELECT-CHECKPOINT-CNTL' TO PV-ABEND-PARAGRAPH.    03001626
190800                                                                  03001719
190900     EXEC SQL                                                     03001819
191000      SELECT CKPT_STAT_CODE                                       03001919
191000           , CKPT_FRQNCY_QTY                                      03002019
191100       INTO :CR-CKPT-STAT-CODE                                    03002119
191100          , :CR-CKPT-FRQNCY                                       03002219
191200       FROM TCKRSTCNTL                                            03002319
191300       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 03002419
191400     END-EXEC.                                                    03002519
191500                                                                  03002619
191600     EVALUATE TRUE                                                03002719
191700         WHEN SQLCODE = ZERO                                      03002819
191800              CONTINUE                                            03002919
191900                                                                  03003019
192000         WHEN SQLWARN0 NOT = SPACES                               03003119
192100         WHEN SQLCODE  NOT = ZERO                                 03003219
027800             DISPLAY '**************************************'     03003319
027900             DISPLAY 'ERROR IN RETRIEVING CKPT CONTROL'           03003419
028200             DISPLAY '**************************************'     03003519
038700             PERFORM 9900-SQL-ERROR                               03003619
193000     END-EVALUATE.                                                03003719
193100 EJECT                                                            03003819
193200*---------------------------------------------------------------  03003919
193300*    GETS THE WS DESCRIPTION INFO FROM THE CHECKPOINT/RESTART     03004019
193400*    INFORMATION TABLE.                                           03004119
193500*---------------------------------------------------------------  03004219
193600 R900-SELECT-CHECKPOINT-INFO.                                     03004319
154000                                                                  03004426
015400     MOVE 'R900-SELECT-CHECKPOINT-INFO' TO PV-ABEND-PARAGRAPH.    03004526
193700                                                                  03004619
193800     EXEC SQL                                                     03004719
193900      SELECT WORK_STRG_DESC                                       03004819
194000       INTO :TCKRSTINF-WORK-STRG-DESC                             03004919
194100       FROM TCKRSTINF                                             03005019
194200       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 03005119
194300     END-EXEC.                                                    03005219
194400                                                                  03005319
194500     EVALUATE TRUE                                                03005419
194600         WHEN SQLCODE = ZERO                                      03005519
194700              CONTINUE                                            03005619
194800                                                                  03005719
194900         WHEN SQLWARN0 NOT = SPACES                               03005819
195000         WHEN SQLCODE  NOT = ZERO                                 03005919
027800             DISPLAY '**************************************'     03006019
027900             DISPLAY 'ERROR IN RETRIEVING CKPT DATA '             03006119
028200             DISPLAY '**************************************'     03006219
038700             PERFORM 9900-SQL-ERROR                               03006319
195900     END-EVALUATE.                                                03006419
196000                                                                  03006519
205700*---------------------------------------------------------------  03006619
205800*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS    03006719
205900*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE).  03006819
206000*---------------------------------------------------------------  03006919
206100 U300-UPDATE-CHECKPOINT-CNTL.                                     03007019
154000                                                                  03007126
015400     MOVE 'U300-UPDATE-CHECKPOINT-CNTL' TO PV-ABEND-PARAGRAPH.    03007226
206200                                                                  03007319
206300     EXEC SQL                                                     03007419
206400         UPDATE TCKRSTCNTL                                        03007519
206500         SET CKPT_STAT_CODE = :CR-CKPT-STAT-CODE                  03007619
206600         WHERE PLAN_NAME    = :PC-CURRENT-PROGRAM-NAME            03007719
206700     END-EXEC.                                                    03007819
206800                                                                  03007919
206900     EVALUATE TRUE                                                03008019
207000         WHEN SQLCODE = ZEROS                                     03008119
207100              CONTINUE                                            03008219
207200                                                                  03008319
207300         WHEN OTHER                                               03008419
027800             DISPLAY '**************************************'     03008519
027900             DISPLAY 'ERROR IN UPDATING CKPT CONTROL'             03008619
028200             DISPLAY '**************************************'     03008719
038700             PERFORM 9900-SQL-ERROR                               03008819
208200     END-EVALUATE.                                                03008919
207200                                                                  03009019
208400*---------------------------------------------------------------  03009119
208500*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING      03009219
208600*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE LAST COMMITED  03009319
208700*    PO STORE NUMBER COMBINATION.                                 03009419
208800*---------------------------------------------------------------  03009519
208900 U400-UPDATE-CHECKPOINT-INFO.                                     03009619
154000                                                                  03009726
015400     MOVE 'U400-UPDATE-CHECKPOINT-INFO' TO PV-ABEND-PARAGRAPH.    03009826
209000                                                                  03009919
037200     MOVE CE015-CONTAINER-ID     TO CR-CONTAINER-ID.              03010026
037200     MOVE CE015-LOCATION         TO CR-LOCATION.                  03010126
037200     MOVE CR-CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.03010227
109900     MOVE 24                     TO TCKRSTINF-WORK-STRG-DESC-LEN. 03010426
037200                                                                  03010519
209100     EXEC SQL                                                     03010619
209200         UPDATE TCKRSTINF                                         03010719
209300         SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC         03010819
209400         WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME          03010919
209500     END-EXEC.                                                    03011019
209600                                                                  03011119
209700     EVALUATE TRUE                                                03011219
209800         WHEN SQLCODE = ZEROS                                     03011319
209900              CONTINUE                                            03011419
210000                                                                  03011519
210100         WHEN OTHER                                               03011619
027800             DISPLAY '**************************************'     03011719
027900             DISPLAY 'ERROR IN UPDATING CKPT INFO'                03011819
028200             DISPLAY '**************************************'     03011919
038700             PERFORM 9900-SQL-ERROR                               03012019
211000     END-EVALUATE.                                                03012119
210000                                                                  03012219
210000                                                                  03012325
029600 9000-EOJ.                                                        03012425
029700     CLOSE      UPDATE-EXTRACT-FILE                               03013001
029800                                                                  03020001
073400     MOVE PC-RUN-COMPLETE-CODE TO CR-CKPT-STAT-CODE.              03021019
037200     MOVE '0000'                     TO CE015-CONTAINER-ID.       03021129
037200     MOVE '000000000000000'          TO CE015-LOCATION.           03021229
036800     PERFORM U400-UPDATE-CHECKPOINT-INFO.                         03021325
073600     PERFORM U300-UPDATE-CHECKPOINT-CNTL.                         03022019
073700     PERFORM C100-COMMIT.                                         03023019
029800                                                                  03024019
029900     DISPLAY SPACES.                                              03030001
030000     DISPLAY ' PCKUP018'                                          03040001
030100     DISPLAY SPACES.                                              03050001
030200     MOVE PV-EXTRACT-COUNT            TO PV-DISP-NBR              03060001
030700     DISPLAY 'RECORDS READ.......   = ' PV-DISP-NBR.              03070001
030600     MOVE PV-INSERT-COUNT             TO PV-DISP-NBR              03100001
030700     DISPLAY 'ROWS INSERTED......   = ' PV-DISP-NBR.              03110001
030600     MOVE PV-COMMIT-CNT               TO PV-DISP-NBR              03110123
030700     DISPLAY 'COMMITS TAKEN......   = ' PV-DISP-NBR.              03111023
030800                                                                  03120001
030900 9800-SQL-WARNING.                                                03130001
031000                                                                  03140001
031100     MOVE SQLCODE               TO SQLCODE2.                      03150001
031200     MOVE SQLERRD(3)            TO SQLERRD3.                      03160001
031300     DISPLAY '** ABEND **       ** = SQLWARNING'.                 03170001
031400     DISPLAY '** PROGRAM        ** = PCKUP018'.                   03180001
031500     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        03190001
031600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  03200001
031700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  03210001
031800                                                                  03220001
031900     COPY DPPD004.                                                03230001
032000     SET ABEND-4013-DB2-ERROR   TO TRUE                           03240001
032100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03250001
032200                                                                  03260001
032300 9900-SQL-ERROR.                                                  03270001
032400                                                                  03280001
032500     MOVE SQLCODE               TO SQLCODE2.                      03290001
032600     MOVE SQLERRD(3)            TO SQLERRD3.                      03300001
032700     DISPLAY '** ABEND **       ** = SQLERROR'.                   03310001
032800     DISPLAY '** PROGRAM        ** = PCKUP018'.                   03320001
032900     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        03330001
033000                                                                  03340001
033100     COPY DPPD004.                                                03350001
033200     SET ABEND-4013-DB2-ERROR   TO TRUE                           03360001
033300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03370001
