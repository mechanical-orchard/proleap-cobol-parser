000100 IDENTIFICATION DIVISION.                                         00010022
000200 PROGRAM-ID.     APKUT059.                                        00020036
000300 AUTHOR.         COGNIZANT.                                       00030046
000400*DATE-WRITTEN.   MARCH 2019.                                      00040047
000500*DATE-COMPILED.                                                   00050050
000510*---------------------------------------------------------------* 00051051
000520*    COBOL 2                                                    * 00052051
000530*                                                               * 00053051
000540*    THE PURPOSE OF THIS PROGRAM IS TO CREATE THE INVOICES      * 00054051
000550*    FOR PAYMENT HOLD FILE TO SEND TO ORACLE.                   * 00055051
000551*---------------------------------------------------------------* 00055151
001060*                                                               * 00106051
001070* INPUT:                                                        * 00107051
001080* 1.  AP-INVOICE-FILE                    (APRD040)              * 00108051
001090*                                                               * 00109051
001100* OUTPUT                                                        * 00110051
001200* 1.  AP-INVOICE-HLD-FILE                (APRD007)              * 00120051
001300* 2.  #RECS IN AP-REFMT-TRANS FILE                              * 00130051
001310*---------------------------------------------------------------* 00131051
001410* CHANGE LOG:                                                   * 00141051
001420*   DATE  03/13/2019                                            * 00142051
001430*       CHANGE MADE: ERP PROJECT - INITIAL IMPLEMENTATION.      * 00143051
001440*       MADE BY: COGNIZANT           WR/IR #: CHG0220043        * 00144051
001450*                                                               * 00145051
001451*   DATE  08/07/2019                                            * 00145153
001452*       CHANGE MADE: RECOMPILE TO USE MODIFIED APRD007 COPYBOOK * 00145253
001453*       MADE BY: NANCY EILBES        WR/IR #: CHG0228945        * 00145353
001454*                                                               * 00145453
001455*---------------------------------------------------------------* 00145553
001500                                                                  00150023
001600 ENVIRONMENT DIVISION.                                            00160023
001700                                                                  00170023
001800 INPUT-OUTPUT SECTION.                                            00180023
001900                                                                  00190023
002000 FILE-CONTROL.                                                    00200023
002100                                                                  00210023
002200     SELECT AP-INVOICE-FILE           ASSIGN TO INP01.            00220033
002300                                                                  00230023
002400     SELECT AP-INVOICE-HLD-FILE       ASSIGN TO OUT01.            00240033
002700                                                                  00270023
002800 DATA DIVISION.                                                   00280023
002900                                                                  00290023
003000 FILE SECTION.                                                    00300023
003100                                                                  00310023
003200 FD  AP-INVOICE-FILE                                              00320033
003300     LABEL RECORDS  ARE STANDARD                                  00330023
003400     RECORDING MODE IS  F                                         00340023
003410     BLOCK CONTAINS 0 RECORDS                                     00341051
003500     DATA RECORD    IS  AP-INVOICE-RECORD.                        00350035
003600                                                                  00360023
003700 01  AP-INVOICE-RECORD             PIC X(500).                    00370035
003800                                                                  00380023
003900 FD  AP-INVOICE-HLD-FILE                                          00390033
004000     RECORDING MODE IS F                                          00400023
004100     LABEL RECORDS ARE STANDARD                                   00410023
004200     BLOCK CONTAINS 0 RECORDS                                     00420023
004300     DATA RECORD IS AP-INVOICE-HLD-RECORD.                        00430035
004400                                                                  00440023
004500 01  AP-INVOICE-HLD-RECORD         PIC X(26).                     00450045
004600                                                                  00460023
005300 WORKING-STORAGE SECTION.                                         00530023
005400                                                                  00540023
005500 01  FILLER                        PIC X(25) VALUE                00550023
005600                             'WS FOR APKUT059 BEGINS==>'.         00560036
005700                                                                  00570023
005800 01  PV-PROGRAM-VARIABLES.                                        00580023
005900     05  PV-DISC-PCT                  PIC S9V9(4) VALUE ZEROES.   00590023
006000     05  PV-TEMP-AMT                  PIC S9(9)V99                00600023
006100                                                  VALUE ZEROES.   00610023
006900*                                                                 00690023
007000 01  PV-PROGRAM-COUNTERS.                                         00700023
007100     05  PV-INPUT-COUNT               PIC 9(9)  VALUE ZEROS.      00710023
007200     05  PV-WRITTEN-OUT-REC-CNT       PIC 9(9) VALUE ZEROS.       00720023
007300                                                                  00730023
007400 01  PS-SWITCHES.                                                 00740023
007500     05  PS-END-OF-FILE-SW             PIC X(01) VALUE 'N'.       00750023
007600         88  END-OF-FILE                        VALUE 'Y'.        00760023
007700         88  NOT-END-OF-FILE                    VALUE 'N'.        00770023
008100                                                                  00810023
008200*----------------------------------------------------------------*00820023
008300*  ACCOUNTS PAYABLE TRANSACTION COPYBOOK                         *00830023
008400*----------------------------------------------------------------*00840023
008500     COPY APRD040.                                                00850023
008600                                                                  00860023
008700*----------------------------------------------------------------*00870023
008800*  ACCOUNTS ACCOUNTS PAYABLE PAYMENT HOLD COPYBOOK               *00880037
008900*----------------------------------------------------------------*00890023
009000     COPY APRD007.                                                00900037
009100                                                                  00910023
009200 PROCEDURE DIVISION.                                              00920023
009300                                                                  00930023
009400 A100-MAINLINE.                                                   00940023
009500                                                                  00950023
009600     PERFORM B100-INITIALIZATION.                                 00960023
009700                                                                  00970023
009800     PERFORM B200-PROCESSING                                      00980023
009900        UNTIL END-OF-FILE.                                        00990023
010000                                                                  01000023
010100     PERFORM B300-END-OF-JOB.                                     01010023
010200                                                                  01020023
010300     GOBACK.                                                      01030023
010400*---------------------------------------------------------------* 01040023
010500*    OPEN FILES AND PERFORM INITIAL READ                          01050023
010700*---------------------------------------------------------------* 01070023
010800 B100-INITIALIZATION.                                             01080023
010900                                                                  01090023
011000     DISPLAY '**********************************'                 01100023
011100     DISPLAY '*   STARTING PROGRAM APKUT059    *'                 01110036
011200     DISPLAY '**********************************'                 01120023
011300                                                                  01130023
011400     OPEN  INPUT AP-INVOICE-FILE                                  01140033
011500          OUTPUT AP-INVOICE-HLD-FILE.                             01150043
011700                                                                  01170023
011800     PERFORM R100-READ-AP-INVOICE-FILE.                           01180033
011900                                                                  01190023
012000     IF END-OF-FILE                                               01200023
012100        DISPLAY '**********************************'              01210023
012200        DISPLAY '* AP INVOICE FILE                *'              01220044
012300        DISPLAY '* INPUT FILE IS EMPTY.           *'              01230023
012400        DISPLAY '**********************************'              01240023
012500     END-IF.                                                      01250023
012600                                                                  01260023
012700*---------------------------------------------------------------* 01270023
012800*  PROCESS AP TRANS RECORDS AND CALCULATE DUE DATE AND          * 01280023
012900*  OTP DATES BASED ON THE RECEIVING DATE.                       * 01290023
013000*---------------------------------------------------------------* 01300023
013100 B200-PROCESSING.                                                 01310023
013200                                                                  01320023
013300                                                                  01330051
013400     INITIALIZE AP007-TEXT-FILE                                   01340051
013500                PV-PROGRAM-VARIABLES.                             01350051
013600                                                                  01360051
013750     MOVE AP040-VND-NBR             TO AP007-VND-NBR.             01375042
013760                                                                  01376042
013770     MOVE AP040-DOC-NBR             TO AP007-INVC-NBR.            01377042
013780                                                                  01378042
013790     MOVE 'Y'                       TO AP007-PAYMENT-HOLD.        01379042
013791                                                                  01379142
013800     PERFORM W100-WRITE-OUTPUT-REC.                               01380042
014200                                                                  01420023
014300     PERFORM R100-READ-AP-INVOICE-FILE.                           01430042
014400                                                                  01440023
014500 B300-END-OF-JOB.                                                 01450023
014600                                                                  01460023
014900     DISPLAY '*----------------------------------------------*'.  01490023
015000     DISPLAY 'PROGRAM APKUT059 RECORD COUNTS '                    01500036
015100     DISPLAY 'TOTAL AP TRANS RECORDS READ    = '                  01510023
015200              PV-INPUT-COUNT                                      01520023
015300     DISPLAY 'TOTAL AP REFORMATTED TRANS RECORDS WRITTEN   = '    01530023
015400              PV-WRITTEN-OUT-REC-CNT                              01540023
015500     DISPLAY '*----------------------------------------------*'.  01550023
015700                                                                  01570023
015800     CLOSE AP-INVOICE-FILE                                        01580033
015900           AP-INVOICE-HLD-FILE.                                   01590041
016100                                                                  01610023
024824*---------------------------------------------------------------* 02482423
024825*     READ THE AP INVOICE FILE                                  * 02482539
024826*---------------------------------------------------------------* 02482623
024827 R100-READ-AP-INVOICE-FILE.                                       02482733
024828                                                                  02482823
024829     READ AP-INVOICE-FILE INTO AP040-TRANSACTION-FILE             02482933
024830         AT END  SET END-OF-FILE TO TRUE.                         02483023
024840                                                                  02484023
024850     IF NOT-END-OF-FILE                                           02485023
024860        ADD 1 TO PV-INPUT-COUNT                                   02486023
024870     END-IF.                                                      02487023
024880                                                                  02488023
024890*---------------------------------------------------------------* 02489023
024900*  WRITE THE UNJOUNRALIZED AGED RECORD TO THE OUTPUT FILE.      * 02490023
025000*---------------------------------------------------------------* 02500023
025100 W100-WRITE-OUTPUT-REC.                                           02510023
025200                                                                  02520023
025300     WRITE AP-INVOICE-HLD-RECORD                                  02530035
025400         FROM AP007-TEXT-FILE.                                    02540042
025500                                                                  02550023
025600     ADD 1 TO PV-WRITTEN-OUT-REC-CNT.                             02560023
025700                                                                  02570023
