      ******************************************************************00010064
       IDENTIFICATION DIVISION.                                         00020064
      ******************************************************************00030064
      *                                                                 00040064
       PROGRAM-ID.    IMKUT220.                                         00050064
       AUTHOR.        BOB MCASEY.                                       00060064
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070064
       DATE-WRITTEN.  AUGUST, 2004.                                     00080064
       DATE-COMPILED.                                                   00090064
      *                                                                 00100064
      ******************************************************************00110064
      *   THIS PROGRAM CREATES AN EXTRACT OF SKUS AND DESCRIPTIONS     *00120064
      ******************************************************************00130064
      *  CHANGED:                                                      *00140064
      *                                                                *00150064
      *    WR/PITS#     DATE        DESCRIPTION                        *00160064
      *    --------   ----------   ---------------------------------   *00170064
      *                                                                *00180064
      *    WR27367    08-25-2004    INITIAL DEVELOPMENT.               *00190064
      *                                                                 00200064
      *    WR29810    01-19-2006    PRVT LBL IND TO LBL TYP CDE.       *00201065
      ******************************************************************00210064
       ENVIRONMENT DIVISION.                                            00220064
      ******************************************************************00230064
      *                                                                 00240064
       CONFIGURATION SECTION.                                           00250064
       SOURCE-COMPUTER.    IBM-3090.                                    00260064
       OBJECT-COMPUTER.    IBM-3090.                                    00270064
      *                                                                 00280064
       INPUT-OUTPUT SECTION.                                            00290064
       FILE-CONTROL.                                                    00300064
      *                                                                 00310064
           SELECT PROD-CHAR-OUT-FILE                                    00320064
               ASSIGN TO OUT01.                                         00330064
      *                                                                 00340064
      ******************************************************************00350064
       DATA DIVISION.                                                   00360064
      ******************************************************************00370064
      *                                                                 00380064
       FILE SECTION.                                                    00390064
      *                                                                 00400064
       FD  PROD-CHAR-OUT-FILE                                           00410064
           RECORDING MODE IS F                                          00420064
           BLOCK CONTAINS 0 RECORDS.                                    00430064
       01  PROD-CHAR-OUT-REC       PIC X(329).                          00440064
      *                                                                 00450064
      *                                                                 00460064
       WORKING-STORAGE SECTION.                                         00470064
      ******************************************************************00480064
      *  INPUT/OUTPUT FILE RECORD LAYOUT                                00490064
      ******************************************************************00500064
      *                                                                 00510064
       01  ABEND-CODE                      PIC S9(04)    VALUE ZERO     00520064
                                                         COMP SYNC.     00530064
      *                                                                 00540064
       01  PA-PROGRAM-ACCUMULATORS.                                     00550064
           05  PA-WRITE-COUNT              PIC 9(09)    VALUE ZERO.     00560064
           05  PA-WRITE-2-COUNT            PIC 9(09)    VALUE ZERO.     00570064
           05  PA-DEF-MAINT-COUNT          PIC 9(09)    VALUE ZERO.     00580064
      *                                                                 00590064
       01  PC-PROGRAM-CONSTANTS.                                        00600064
           05  PC-PROGRAM-NAME             PIC X(08)     VALUE          00610064
               'IMKUT220'.                                              00620064
           05  PC-COMP-ZERO                PIC S9(04) COMP  VALUE +0.   00630064
      *                                                                 00640064
       01  PS-PROGRAM-SWITCHES.                                         00650064
           05  PS-END-OF-PROD-CHAR-CSR-SW  PIC X(01)  VALUE 'N'.        00660064
               88  PS-END-OF-PROD-CHAR-CSR            VALUE 'Y'.        00670064
      *                                                                 00680064
       01  PV-PROGRAM-VARIABLES.                                        00690064
           05  PV-PARA-NAME                PIC X(35).                   00700064
**TEMP     05  PV-MDARVS-DEPT-NBR          PIC 9(04) COMP-3 VALUE 0.    00710064
**TEMP     05  PV-MDARVS-SUB-CL-NBR        PIC 9(04) COMP-3 VALUE 0.    00720064
           05  PV-DEPT-NBR                 PIC 9(03).                   00730064
           05  PV-MDSEAR-DEPT-NBR REDEFINES PV-DEPT-NBR                 00740064
                                           PIC X(03).                   00750064
           05  PV-SUB-CL-MDSEAR-ID         PIC S9(6)V COMP-3 VALUE +0.  00760064
           05  PV-MDARVS-MAJ-CL-NBR        PIC 9(04)  VALUE 0.          00770064
           05  PV-MAJ-CL-NBR REDEFINES PV-MDARVS-MAJ-CL-NBR.            00780064
               10  FILLER                  PIC X(02).                   00790064
               10  PV-MAJ-CL               PIC X(02).                   00800064
           05  PV-END-DTE-NV               PIC S9(04) COMP  VALUE +0.   00810064
           05  PV-UPC-UPC-ID               PIC  9(15).                  00820064
           05  PV-UPC-VS-ID                PIC  9(15).                  00830064
           05  PV-UPC-INTR-UPC-ID          PIC  9(15).                  00840064
           05  PV-UPC-KOHLS-SIZE-CDE       PIC  9(15).                  00850064
           05  PV-UPC-INNR-PK-QTY          PIC  9(04) COMP.             00860064
           05  PV-UPC-OUTR-PK-QTY          PIC  9(04) COMP.             00870064
           05  PV-COMP-DOUBLE              PIC S9(10) VALUE ZERO        00880064
                                                      COMP SYNC.        00890064
           05  PV-MDARVS-DEPT              PIC 9(04) VALUE 0.           00900064
           05  PV-MDARVS-SUB-CL            PIC 9(04) VALUE 0.           00910064
           05  PV-UPC-UNT-COST-1ST-AMT     PIC  9(7)V9(3) VALUE 0.      00920064
           05  PV-UPC-UPC-NBR              PIC  9(15) VALUE 0.          00930064
           05  PV-PREV-LBL-SEQ-NBR         PIC  S9(4) COMP VALUE +0.    00940064
                                                                        00950064
      *                                                                 00960064
       01  IM220-PROD-CHAR-EXTR.                                        00970064
           05  IM220-MDARVS-DEPT-NBR       PIC  9(04).                  00980064
           05  IM220-MDARVS-SUB-CL-NBR     PIC  9(04).                  00990064
           05  IM220-UPC-GP-CDE            PIC  X(03).                  01000064
           05  IM220-VNDSTL-VS-NBR         PIC  X(20).                  01010064
           05  IM220-TUPCSKU-UPC-NBR       PIC  X(08).                  01020064
           05  IM220-TUPC-INTR-UPC-DESC    PIC  X(30).                  01030064
           05  IM220-MDSEAR-DEPT-DESC      PIC  X(25).                  01040064
           05  IM220-MDSEAR-SUBCL-DESC     PIC  X(25).                  01050064
           05  IM220-MDSEAR-MAJ-CL-DESC    PIC  X(25).                  01060064
           05  IM220-UPC-UPC-ID            PIC  9(10).                  01070064
           05  IM220-UPC-UPC-NBR           PIC  9(15).                  01080064
           05  IM220-UPC-VS-ID             PIC  9(10).                  01090064
           05  IM220-UPC-INTR-UPC-ID       PIC  9(10).                  01100064
           05  IM220-UPC-EFF-BEG-DTE       PIC  X(10).                  01110064
           05  IM220-UPC-EFF-END-DTE       PIC  X(10).                  01120064
           05  IM220-UPC-KOHLS-SIZE-CDE    PIC  9(09).                  01130064
           05  IM220-UPC-NRF-SIZE-IND      PIC  X(01).                  01140064
           05  IM220-UPC-NRF-CLOR-CDE      PIC  X(03).                  01150064
           05  IM220-UPC-NRF-CLOR-IND      PIC  X(01).                  01160064
           05  IM220-UPC-CSTM-CLOR-DESC    PIC  X(10).                  01170064
           05  IM220-UPC-EDI-ORD-IND       PIC  X(01).                  01180064
           05  IM220-UPC-PREPK-IND         PIC  X(01).                  01190064
           05  IM220-UPC-CERTD-IND         PIC  X(01).                  01200064
           05  IM220-UPC-CERTD-DTE         PIC  X(10).                  01210064
           05  IM220-UPC-RPLNMT-IND        PIC  X(01).                  01220064
           05  IM220-UPC-KY-ITM-IND        PIC  X(01).                  01230064
           05  IM220-UPC-UNT-COST-1ST-AMT  PIC  9(07).9(3).             01240064
           05  IM220-UPC-UPC-SRC-CDE       PIC  X(01).                  01250064
           05  IM220-UPC-INNR-PK-QTY       PIC  9(04).                  01260064
           05  IM220-UPC-OUTR-PK-QTY       PIC  9(04).                  01270064
           05  IM220-UPC-REGN-PRIC-IND     PIC  X(01).                  01280064
           05  IM220-ENTNME-ENT-ID         PIC  9(09).                  01290064
           05  IM220-ENT-NAME-DESC         PIC  X(30).                  01300064
           05  IM220-LBL-TYP-CDE           PIC  X(01).                  01310065
           05  IM220-CHARTC-DESC           PIC  X(20).                  01320064
                                                                        01330064
           COPY SQLCA2.                                                 01340064
      *                                                                 01350064
      ******************************************************************01360064
      *  TUPC    -                                                      01370064
      ******************************************************************01380064
      *                                                                 01390064
           EXEC SQL                                                     01400064
                INCLUDE TUPC                                            01410064
           END-EXEC.                                                    01420064
      *                                                                 01430064
      ******************************************************************01440064
      *  TSKXREF -                                                      01450064
      ******************************************************************01460064
      *                                                                 01470064
           EXEC SQL                                                     01480064
                INCLUDE TSKXREF                                         01490064
           END-EXEC.                                                    01500064
      *                                                                 01510064
      ******************************************************************01520064
      *  TUPCSKU -                                                      01530064
      ******************************************************************01540064
      *                                                                 01550064
           EXEC SQL                                                     01560064
                INCLUDE TUPCSKU                                         01570064
           END-EXEC.                                                    01580064
      *                                                                 01590064
      ******************************************************************01600064
      *  TMDARVS -                                                      01610064
      ******************************************************************01620064
      *                                                                 01630064
           EXEC SQL                                                     01640064
                INCLUDE TMDARVS                                         01650064
           END-EXEC.                                                    01660064
      *                                                                 01670064
      ******************************************************************01680064
      *  TVNDSTL -                                                      01690064
      ******************************************************************01700064
      *                                                                 01710064
           EXEC SQL                                                     01720064
                INCLUDE TVNDSTL                                         01730064
           END-EXEC.                                                    01740064
      *                                                                 01750064
      *                                                                 01760064
      ******************************************************************01770064
      *  TMDSEAR -                                                      01780064
      ******************************************************************01790064
      *                                                                 01800064
           EXEC SQL                                                     01810064
                INCLUDE TMDSEAR                                         01820064
           END-EXEC.                                                    01830064
      *                                                                 01840064
      *                                                                 01850064
      *                                                                 01860064
      ******************************************************************01870064
      *  TENTNME -                                                      01880064
      ******************************************************************01890064
      *                                                                 01900064
           EXEC SQL                                                     01910064
                INCLUDE TENTNME                                         01920064
           END-EXEC.                                                    01930064
      *                                                                 01940064
      *                                                                 01950064
      *                                                                 01960064
      ******************************************************************01970064
      *  TVSCHVL -                                                      01980064
      ******************************************************************01990064
      *                                                                 02000064
           EXEC SQL                                                     02010064
                INCLUDE TVSCHVL                                         02020064
           END-EXEC.                                                    02030064
      *                                                                 02040064
      *                                                                 02050064
      *                                                                 02060064
      ******************************************************************02070064
      *  IMT_LBL -                                                      02080064
      ******************************************************************02090064
      *                                                                 02100064
           EXEC SQL                                                     02110064
                INCLUDE IMT00000                                        02120064
           END-EXEC.                                                    02130064
      *                                                                 02140064
           EXEC SQL                                                     02150064
                INCLUDE SQLCA                                           02160064
           END-EXEC.                                                    02170064
                                                                        02180064
      ******************************************************************02190064
      * PRODUCT CHARACTERISTICS CURSOR                                  02200064
      ******************************************************************02210064
           EXEC SQL                                                     02220064
                DECLARE PROD_CHAR_CSR CURSOR FOR                        02230064
                 SELECT D.DEPT_NBR                                      02240064
                        ,D.SUB_CL_NBR                                   02250064
                        ,U.GP_CDE                                       02260064
                        ,V.VS_NBR                                       02270064
                        ,SUBSTR(DIGITS(U.UPC_NBR),7,8)                  02280064
                        ,U.INTR_UPC_DESC                                02290064
                        ,D.SUB_CL_MDSEAR_ID                             02300064
                        ,D.MAJ_CL_NBR                                   02310064
                        ,U.UPC_ID                                       02320064
                        ,U.UPC_NBR                                      02330064
                        ,U.VS_ID                                        02340064
                        ,U.INTR_UPC_ID                                  02350064
                        ,U.EFF_BEG_DTE                                  02360064
                        ,U.EFF_END_DTE                                  02370064
                        ,U.KOHLS_SIZE_CDE                               02380064
                        ,U.NRF_SIZE_IND                                 02390064
                        ,U.NRF_CLOR_CDE                                 02400064
                        ,U.NRF_CLOR_IND                                 02410064
                        ,U.CSTM_CLOR_DESC                               02420064
                        ,U.EDI_ORD_IND                                  02430064
                        ,U.PREPK_IND                                    02440064
                        ,U.CERTD_IND                                    02450064
                        ,U.CERTD_DTE                                    02460064
                        ,U.RPLNMT_IND                                   02470064
                        ,U.KY_ITM_IND                                   02480064
                        ,U.UNT_COST_1ST_AMT                             02490064
                        ,U.UPC_SRC_CDE                                  02500064
                        ,U.INNR_PK_QTY                                  02510064
                        ,U.OUTR_PK_QTY                                  02520064
                        ,U.REGN_PRIC_IND                                02530064
                        ,N.ENT_ID                                       02540064
                        ,N.ENT_NAME_DESC                                02550064
                        ,D.LBL_SEQ_NBR                                  02560064
                        ,G.CHARTC_VAL_DESC                              02570064
                    FROM TUPC     U                                     02580064
                        ,TMDARVS  D                                     02590064
                        ,TVNDSTL  V                                     02600064
                        ,TENTNME  N                                     02610064
                        ,TVSCHVL  G                                     02620064
                    WHERE U.UPC_TYP_CDE      = 'I'                      02630064
                      AND U.EFF_BEG_DTE <= CURRENT DATE                 02640064
                      AND (U.EFF_END_DTE >= CURRENT DATE                02650064
                       OR U.EFF_END_DTE IS NULL)                        02660064
                      AND U.VS_ID            = D.VS_ID                  02670064
                      AND U.SUB_CL_MDSEAR_ID = D.SUB_CL_MDSEAR_ID       02680064
                      AND D.VS_ID            = V.VS_ID                  02690064
                      AND V.ENT_ID           = N.ENT_ID                 02700064
                      AND N.TYPE_CDE         = '01'                     02710064
                      AND D.GNDR_SEQ_NBR     = G.CHARTC_SEQ_NBR         02720064
                      AND G.CHARTC_CDE       = 26                       02730064
      *          OPTIMIZE FOR 1 ROW                                     02740064
               FOR FETCH ONLY                                           02750064
               WITH UR                                                  02760064
           END-EXEC.                                                    02770064
                                                                        02780064
      ******************************************************************02790064
      *  DB2 ERROR MESSAGES FORMAT AREA.                                02800064
      ******************************************************************02810064
           COPY DPWS004.                                                02820064
                                                                        02830064
      *                                                                 02840064
      ******************************************************************02850064
       PROCEDURE DIVISION.                                              02860064
      ******************************************************************02870064
      *                                                                 02880064
       0000-IMKUT220.                                                   02890064
      ******************************************************************02900064
      * MAIN PROCESSING ROUTINE                                        *02910064
      ******************************************************************02920064
                                                                        02930064
           PERFORM 1000-HOUSEKEEPING.                                   02940064
      *                                                                 02950064
           PERFORM 2000-CREATE-PROD-CHAR-EXTR                           02960064
             UNTIL PS-END-OF-PROD-CHAR-CSR.                             02970064
      *                                                                 02980064
           PERFORM 1500-END-OF-JOB.                                     02990064
           GOBACK.                                                      03000064
      *                                                                 03010064
                                                                        03020064
       1000-HOUSEKEEPING.                                               03030064
                                                                        03040064
           MOVE '*1000-HOUSEKEEPING.              *' TO PV-PARA-NAME.   03050064
                                                                        03060064
           OPEN OUTPUT PROD-CHAR-OUT-FILE.                              03070064
                                                                        03080064
                                                                        03090064
       1500-END-OF-JOB.                                                 03100064
                                                                        03110064
      ******************************************************************03120064
      *  CLOSE FILES AND DISPLAY COUNTS                                *03130064
      ******************************************************************03140064
                                                                        03150064
           CLOSE PROD-CHAR-OUT-FILE.                                    03160064
                                                                        03170064
           DISPLAY '***************************'                        03180064
           DISPLAY 'END OF JOB STATS'                                   03190064
           DISPLAY '# OF RECS WRITTEN        : = ' PA-WRITE-COUNT.      03200064
           DISPLAY '***************************'.                       03210064
                                                                        03220064
      ******************************************************************03230064
      * MAIN PROCESS OF MDSEAR EXTRACT                                 *03240064
      ******************************************************************03250064
       2000-CREATE-PROD-CHAR-EXTR.                                      03260064
           MOVE '*2000-CREATE-PROD-CHAR-EXTR        *' TO PV-PARA-NAME. 03270064
                                                                        03280064
           PERFORM 7000-OPEN-PROD-CHAR-CSR.                             03290064
                                                                        03300064
           MOVE 'N' TO PS-END-OF-PROD-CHAR-CSR-SW.                      03310064
                                                                        03320064
           PERFORM 3000-PROCESS-CURSOR                                  03330064
             UNTIL PS-END-OF-PROD-CHAR-CSR.                             03340064
                                                                        03350064
      ******************************************************************03360064
      * PROCESS DEFAULT MAINTENANCE CURSOR                             *03370064
      ******************************************************************03380064
       3000-PROCESS-CURSOR.                                             03390064
           PERFORM 7200-FETCH-PROD-CHAR-CSR.                            03400064
                                                                        03410064
           MOVE UPC-UPC-ID          TO PV-COMP-DOUBLE.                  03420064
           MOVE PV-COMP-DOUBLE      TO IM220-UPC-UPC-ID.                03430064
           MOVE UPC-INTR-UPC-ID     TO PV-COMP-DOUBLE.                  03440064
           MOVE PV-COMP-DOUBLE      TO IM220-UPC-INTR-UPC-ID.           03450064
           MOVE UPC-VS-ID           TO PV-COMP-DOUBLE.                  03460064
           MOVE PV-COMP-DOUBLE      TO IM220-UPC-VS-ID.                 03470064
           MOVE UPC-KOHLS-SIZE-CDE  TO PV-COMP-DOUBLE.                  03480064
           MOVE PV-COMP-DOUBLE      TO IM220-UPC-KOHLS-SIZE-CDE.        03490064
           MOVE UPC-INNR-PK-QTY     TO PV-COMP-DOUBLE.                  03500064
           MOVE PV-COMP-DOUBLE      TO IM220-UPC-INNR-PK-QTY.           03510064
           MOVE UPC-OUTR-PK-QTY     TO PV-COMP-DOUBLE.                  03520064
           MOVE PV-COMP-DOUBLE      TO IM220-UPC-OUTR-PK-QTY.           03530064
           MOVE ENTNME-ENT-ID       TO PV-COMP-DOUBLE.                  03540064
           MOVE PV-COMP-DOUBLE      TO IM220-ENTNME-ENT-ID.             03550064
                                                                        03560064
           MOVE MDARVS-DEPT-NBR          TO PV-MDARVS-DEPT-NBR.         03570064
           MOVE PV-MDARVS-DEPT-NBR       TO PV-MDARVS-DEPT.             03580064
           MOVE PV-MDARVS-DEPT           TO IM220-MDARVS-DEPT-NBR.      03590064
           MOVE MDARVS-SUB-CL-NBR        TO PV-MDARVS-SUB-CL-NBR.       03600064
           MOVE PV-MDARVS-SUB-CL-NBR     TO PV-MDARVS-SUB-CL.           03610064
           MOVE PV-MDARVS-SUB-CL         TO IM220-MDARVS-SUB-CL-NBR.    03620064
           MOVE UPC-UNT-COST-1ST-AMT     TO PV-UPC-UNT-COST-1ST-AMT.    03630064
           MOVE PV-UPC-UNT-COST-1ST-AMT  TO IM220-UPC-UNT-COST-1ST-AMT. 03640064
           MOVE UPC-UPC-NBR              TO PV-UPC-UPC-NBR.             03650064
           MOVE PV-UPC-UPC-NBR           TO IM220-UPC-UPC-NBR.          03660064
                                                                        03670064
           IF PV-END-DTE-NV < 0                                         03680064
               MOVE '0000-00-00'         TO IM220-UPC-EFF-END-DTE       03690064
           END-IF.                                                      03700064
           IF MDARVS-LBL-SEQ-NBR = PC-COMP-ZERO                         03710064
               MOVE ' '                  TO IM220-LBL-TYP-CDE           03720066
           ELSE                                                         03730064
               IF MDARVS-LBL-SEQ-NBR = PV-PREV-LBL-SEQ-NBR              03740064
                   MOVE IMT00000-LBL-TYP-CDE TO IM220-LBL-TYP-CDE       03750065
               ELSE                                                     03760064
                   PERFORM 3400-SELECT-LBL-CDE                          03770066
                   MOVE IMT00000-LBL-TYP-CDE  TO IM220-LBL-TYP-CDE      03780065
                   MOVE MDARVS-LBL-SEQ-NBR    TO PV-PREV-LBL-SEQ-NBR    03790064
               END-IF                                                   03800064
           END-IF.                                                      03810064
                                                                        03820064
                                                                        03830064
           IF PS-END-OF-PROD-CHAR-CSR                                   03840064
               PERFORM 7400-CLOSE-PROD-CHAR-CSR                         03850064
           ELSE                                                         03860064
               IF MDARVS-SUB-CL-MDSEAR-ID NOT = PV-SUB-CL-MDSEAR-ID     03870064
                   PERFORM 3100-SELECT-SUBCL-INFO                       03880064
                   MOVE MDARVS-DEPT-NBR TO PV-DEPT-NBR                  03890064
                   PERFORM 3200-SELECT-DEPT-INFO                        03900064
                   MOVE MDARVS-SUB-CL-MDSEAR-ID TO                      03910064
                        PV-SUB-CL-MDSEAR-ID                             03920064
                   MOVE MDARVS-MAJ-CL-NBR TO                            03930064
                        PV-MDARVS-MAJ-CL-NBR                            03940064
                   PERFORM 3300-SELECT-CLASS-INFO                       03950064
               END-IF                                                   03960064
               PERFORM 8000-WRITE-PROD-CHAR-REC                         03970064
           END-IF.                                                      03980064
      *                                                                 03990064
       3100-SELECT-SUBCL-INFO.                                          04000064
           MOVE '*3100-SELECT-SUBCL-INFO.'  TO PV-PARA-NAME.            04010064
                                                                        04020064
           EXEC SQL                                                     04030064
                 SELECT MDSEAR_DESC                                     04040064
                   INTO :IM220-MDSEAR-SUBCL-DESC                        04050064
                   FROM TMDSEAR                                         04060064
                  WHERE MDSEAR_DKEY = :MDARVS-SUB-CL-MDSEAR-ID          04070064
                    AND MDSELV_CDE = 'SCL'                              04080064
                    AND OPERCO_NBR  = '03'                              04090064
                    AND STRT_DTE <= CURRENT DATE                        04100064
                    AND (END_DTE >= CURRENT DATE                        04110064
                     OR END_DTE IS NULL)                                04120064
                 WITH UR                                                04130064
           END-EXEC.                                                    04140064
           EVALUATE TRUE                                                04150064
               WHEN SQLCODE = 0                                         04160064
                 CONTINUE                                               04170064
               WHEN SQLCODE > 0                                         04180064
               WHEN SQLCODE < 0                                         04190064
                 PERFORM 9900-EVALUATE-SQLCODE                          04200064
           END-EVALUATE.                                                04210064
                                                                        04220064
       3200-SELECT-DEPT-INFO.                                           04230064
           MOVE '*3200-SELECT-DEPT-INFO. '  TO PV-PARA-NAME.            04240064
                                                                        04250064
           EXEC SQL                                                     04260064
                 SELECT MDSEAR_DESC                                     04270064
                   INTO :IM220-MDSEAR-DEPT-DESC                         04280064
                   FROM TMDSEAR                                         04290064
                  WHERE DEPT_NBR   = :PV-MDSEAR-DEPT-NBR                04300064
                    AND MDSELV_CDE = 'DPT'                              04310064
                    AND OPERCO_NBR  = '03'                              04320064
                    AND STRT_DTE <= CURRENT DATE                        04330064
                    AND (END_DTE >= CURRENT DATE                        04340064
                     OR END_DTE IS NULL)                                04350064
                 WITH UR                                                04360064
           END-EXEC.                                                    04370064
           EVALUATE TRUE                                                04380064
               WHEN SQLCODE = 0                                         04390064
                 CONTINUE                                               04400064
               WHEN SQLCODE > 0                                         04410064
               WHEN SQLCODE < 0                                         04420064
                 PERFORM 9900-EVALUATE-SQLCODE                          04430064
           END-EVALUATE.                                                04440064
                                                                        04450064
       3300-SELECT-CLASS-INFO.                                          04460064
           MOVE '*3300-SELECT-CLASS-INFO.'  TO PV-PARA-NAME.            04470064
                                                                        04480064
           EXEC SQL                                                     04490064
                 SELECT MDSEAR_DESC                                     04500064
                   INTO :IM220-MDSEAR-MAJ-CL-DESC                       04510064
                   FROM TMDSEAR                                         04520064
                  WHERE DEPT_NBR    = :PV-MDSEAR-DEPT-NBR               04530064
                    AND MAJ_CL_NBR  = :PV-MAJ-CL                        04540064
                    AND MDSELV_CDE  = 'MCL'                             04550064
                    AND OPERCO_NBR  = '03'                              04560064
                    AND STRT_DTE <= CURRENT DATE                        04570064
                    AND (END_DTE >= CURRENT DATE                        04580064
                     OR END_DTE IS NULL)                                04590064
                 WITH UR                                                04600064
           END-EXEC.                                                    04610064
           EVALUATE TRUE                                                04620064
               WHEN SQLCODE = 0                                         04630064
                 CONTINUE                                               04640064
               WHEN SQLCODE > 0                                         04650064
               WHEN SQLCODE < 0                                         04660064
                 PERFORM 9900-EVALUATE-SQLCODE                          04670064
           END-EVALUATE.                                                04680064
                                                                        04690064
       3400-SELECT-LBL-CDE.                                             04700066
           MOVE '*3400-SELECT-LBL-CDE. *' TO PV-PARA-NAME.              04710066
                                                                        04720064
           EXEC SQL                                                     04730064
                 SELECT LBL_TYP_CDE                                     04740065
                   INTO :IMT00000-LBL-TYP-CDE                           04750065
                   FROM IMT_LBL                                         04760064
                  WHERE LBL_SEQ_NBR = :MDARVS-LBL-SEQ-NBR               04770064
                 WITH UR                                                04780064
           END-EXEC.                                                    04790064
           EVALUATE TRUE                                                04800064
               WHEN SQLCODE = 0                                         04810064
                   CONTINUE                                             04810168
               WHEN SQLCODE = +100                                      04810269
                   MOVE ' ' TO IMT00000-LBL-TYP-CDE                     04811067
               WHEN SQLCODE > 0                                         04830064
               WHEN SQLCODE < 0                                         04840064
                 PERFORM 9900-EVALUATE-SQLCODE                          04850064
           END-EVALUATE.                                                04860064
                                                                        04870064
      ******************************************************************04880064
      * 7000 OPEN PROD_CHAR_CSR CURSOR                                 *04890064
      ******************************************************************04900064
       7000-OPEN-PROD-CHAR-CSR.                                         04910064
                                                                        04920064
           EXEC SQL                                                     04930064
               OPEN PROD_CHAR_CSR                                       04940064
           END-EXEC.                                                    04950064
                                                                        04960064
           EVALUATE TRUE                                                04970064
               WHEN SQLCODE = 0                                         04980064
                 CONTINUE                                               04990064
               WHEN SQLCODE > 0                                         05000064
               WHEN SQLCODE < 0                                         05010064
                 PERFORM 9900-EVALUATE-SQLCODE                          05020064
           END-EVALUATE.                                                05030064
                                                                        05040064
      ******************************************************************05050064
      * 7200 FETCH PRODUCT CHARACTERISTIC CURSOR                        05060064
      ******************************************************************05070064
       7200-FETCH-PROD-CHAR-CSR.                                        05080064
                                                                        05090064
           MOVE '*7200-FETCH-PROD-CHAR-CSR. *' TO PV-PARA-NAME.         05100064
           INITIALIZE PV-END-DTE-NV.                                    05110064
           EXEC SQL                                                     05120064
               FETCH PROD_CHAR_CSR                                      05130064
                INTO :MDARVS-DEPT-NBR                                   05140064
                   , :MDARVS-SUB-CL-NBR                                 05150064
                   , :IM220-UPC-GP-CDE                                  05160064
                   , :IM220-VNDSTL-VS-NBR                               05170064
                   , :IM220-TUPCSKU-UPC-NBR                             05180064
                   , :IM220-TUPC-INTR-UPC-DESC                          05190064
                   , :MDARVS-SUB-CL-MDSEAR-ID                           05200064
                   , :MDARVS-MAJ-CL-NBR                                 05210064
                   , :UPC-UPC-ID                                        05220064
                   , :UPC-UPC-NBR                                       05230064
                   , :UPC-VS-ID                                         05240064
                   , :UPC-INTR-UPC-ID                                   05250064
                   , :IM220-UPC-EFF-BEG-DTE                             05260064
                   , :IM220-UPC-EFF-END-DTE :PV-END-DTE-NV              05270064
                   , :UPC-KOHLS-SIZE-CDE                                05280064
                   , :IM220-UPC-NRF-SIZE-IND                            05290064
                   , :IM220-UPC-NRF-CLOR-CDE                            05300064
                   , :IM220-UPC-NRF-CLOR-IND                            05310064
                   , :IM220-UPC-CSTM-CLOR-DESC                          05320064
                   , :IM220-UPC-EDI-ORD-IND                             05330064
                   , :IM220-UPC-PREPK-IND                               05340064
                   , :IM220-UPC-CERTD-IND                               05350064
                   , :IM220-UPC-CERTD-DTE                               05360064
                   , :IM220-UPC-RPLNMT-IND                              05370064
                   , :IM220-UPC-KY-ITM-IND                              05380064
                   , :UPC-UNT-COST-1ST-AMT                              05390064
                   , :IM220-UPC-UPC-SRC-CDE                             05400064
                   , :UPC-INNR-PK-QTY                                   05410064
                   , :UPC-OUTR-PK-QTY                                   05420064
                   , :IM220-UPC-REGN-PRIC-IND                           05430064
                   , :ENTNME-ENT-ID                                     05440064
                   , :IM220-ENT-NAME-DESC                               05450064
                   , :MDARVS-LBL-SEQ-NBR                                05460064
                   , :IM220-CHARTC-DESC                                 05470064
           END-EXEC.                                                    05480064
                                                                        05490064
           EVALUATE TRUE                                                05500064
               WHEN SQLCODE = 0                                         05510064
                 CONTINUE                                               05520064
               WHEN SQLCODE = +100                                      05530064
                 SET PS-END-OF-PROD-CHAR-CSR TO TRUE                    05540064
                 DISPLAY ' END OF PRODUCT CHAR CURSOR'                  05550064
               WHEN OTHER                                               05560064
                 PERFORM 9900-EVALUATE-SQLCODE                          05570064
           END-EVALUATE.                                                05580064
                                                                        05590064
      ******************************************************************05600064
      * 7400 CLOSE DEFAULT MAINTENANCE CURSOR                          *05610064
      ******************************************************************05620064
       7400-CLOSE-PROD-CHAR-CSR.                                        05630064
                                                                        05640064
           EXEC SQL                                                     05650064
               CLOSE PROD_CHAR_CSR                                      05660064
           END-EXEC.                                                    05670064
                                                                        05680064
           EVALUATE TRUE                                                05690064
               WHEN SQLCODE = 0                                         05700064
                 CONTINUE                                               05710064
               WHEN SQLCODE > 0                                         05720064
               WHEN SQLCODE < 0                                         05730064
                 PERFORM 9900-EVALUATE-SQLCODE                          05740064
           END-EVALUATE.                                                05750064
                                                                        05760064
      *                                                                 05770064
      ******************************************************************05780064
      * WRITE DEFAULT MAINTENANCE RECORDS                              *05790064
      ******************************************************************05800064
       8000-WRITE-PROD-CHAR-REC.                                        05810064
           MOVE '*8000-PROD-CHAR-REC.       *' TO PV-PARA-NAME.         05820064
                                                                        05830064
           WRITE PROD-CHAR-OUT-REC FROM IM220-PROD-CHAR-EXTR.           05840064
           ADD +1 TO PA-WRITE-COUNT.                                    05850064
                                                                        05860064
                                                                        05870064
      ******************************************************************05880064
      * 9900 EVALUATE SQL CODE.                                        *05890064
      ******************************************************************05900064
       9900-EVALUATE-SQLCODE.                                           05910064
                                                                        05920064
           EVALUATE TRUE                                                05930064
              WHEN SQLCODE = +0                                         05940064
              WHEN SQLCODE = +100                                       05950064
                 CONTINUE                                               05960064
              WHEN OTHER                                                05970064
                 PERFORM 9980-SQL-ERROR                                 05980064
           END-EVALUATE.                                                05990064
                                                                        06000064
       9980-SQL-ERROR.                                                  06010064
      ******************************************************************06020064
      * ABEND ROUTINE FOR BAD SQL CALLS                                *06030064
      ******************************************************************06040064
           DISPLAY '** ABEND **          = SQL ERROR'.                  06050064
           DISPLAY '** PROGRAM **        = ' PC-PROGRAM-NAME.           06060064
           DISPLAY '** PARAGRAPH **      = ' PV-PARA-NAME.              06070064
      *                                                                 06080064
      ******************************************************************06090064
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    06100064
      * MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         06110064
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     06120064
      * FORMAT.                                                         06130064
      ******************************************************************06140064
           COPY DPPD004.                                                06150064
                                                                        06160064
             EXEC SQL                                                   06170064
                COMMIT                                                  06180064
             END-EXEC.                                                  06190064
      *                                                                 06200064
           MOVE +4013                      TO ABEND-CODE.               06210064
           CALL 'ILBOABN0' USING ABEND-CODE.                            06220064
                                                                        06230064
