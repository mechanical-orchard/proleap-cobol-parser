000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             IMKUT029.                                00050000
000600 AUTHOR.                 D. THEEL                                 00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            9/16/2002.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*                                                                 00110000
001200*-----------------------------------------------------------------00120000
001300*    CREATE ITEM DOMAIN SKU EXTRACT RECORDS                       00130000
001400*-----------------------------------------------------------------00140000
001500*  THE PURPOSE OF THIS PROGRAM IS TO READ IN THE BMC UNLOAD ITEM  00150000
001600*  SKU EXTRACT FILE, GET DEFAULT CHARACTERISTIC DESCS, SKU STATUS 00160000
      *  DESCRIPTION, COLOR AND SIZE DESCRIPTIONS, AND POPULATE TWEBITM 00160100
001600*  OUTPUT FIELDS.  IF THE INTR UPC ID IS ACTIVE ON TWEBITM,       00160200
001600*  SET E BUS ITM IND = Y, ELSE SET TO N AND SET ALL WEBITM        00160300
001900*  OUTPUT FIELDS TO LOW VALUES (DECIMAL FIELDS TO ZERO).          00160400
001400*-----------------------------------------------------------------00160500
      *    WR/PITS#     DATE        DESCRIPTION                         00160600
      *    --------   --------     ---------------------------------    00160700
      *    P000573025 09/11/03     CHANGED INTR UPC ID DISPLAY TO       00160800
      *                            NUMERIC                              00160900
      *    WR29737    12/16/05     P. KEBER - PROCESS THE NEW TUPC      00161000
      *                            TRANSITION INDICATOR COLUMN.         00161100
      *    WR32249    09/13/07     D. THEEL - ADDED LOGIC FOR NEW       00161200
      *                            EXTENDED SIZE CODE AND WEB EXCLUSIVE 00161300
      *                            INDICATOR.                           00161400
      *    WR33240    10/23/07     D. THEEL - ADDED LOGIC FOR NEW       00161500
      *                            FAST TRACK INDICATOR - PO-SHRT-CYC-  00161600
      *                            IND.                                 00161700
      *    WR32284    07/14/2008   D. THEEL - INCREASED INPUT LRECL AND 00161800
      *                            ADDED LOGIC TO WRITE NEW EFF BEG DTE 00161900
      *                            FROM INPUT FILE TO OUTPUT FILE.      00162000
W36546*                                                                 00162100
W36546*    WR36546    08/19/2010   COGNIZANT - PROCESS THE NEW TUPC     00162200
W36546*                            TEST PRODUCT TYPE SEQUENCE NUMBER    00162300
W36546*                                                                 00162400
W38861*    WR38861    08/19/2010   COGNIZANT - PROCESS THE NEW TUPC     00162500
W38861*                            WARE HOUSE REPLENISHMENT INDICATOR   00162600
W38861*                                                                 00162700
002000*-----------------------------------------------------------------00162800
002100                                                                  00162900
002200******************************************************************00163000
002300 ENVIRONMENT DIVISION.                                            00163100
002400******************************************************************00163200
002500                                                                  00163300
002600 CONFIGURATION SECTION.                                           00163400
002700                                                                  00163500
002800 SOURCE-COMPUTER.        IBM-3090.                                00164000
002900 OBJECT-COMPUTER.        IBM-3090.                                00165000
003000                                                                  00166000
003100 INPUT-OUTPUT SECTION.                                            00167000
003200                                                                  00168000
003300 FILE-CONTROL.                                                    00169000
003400                                                                  00170000
003500     SELECT SKU-UNLOAD-IN                                         00180000
003600         ASSIGN TO INP01.                                         00190000
003700                                                                  00200000
003800     SELECT SKU-EXTRACT-OUT                                       00210000
003900         ASSIGN TO OUT01.                                         00220000
004000                                                                  00230000
004300                                                                  00240000
004400******************************************************************00250000
004500 DATA DIVISION.                                                   00260000
004600******************************************************************00270000
004700                                                                  00280000
004800 FILE SECTION.                                                    00290000
004900                                                                  00300000
005000 FD  SKU-UNLOAD-IN                                                00310000
005100     RECORDING MODE IS F                                          00320000
005200     BLOCK CONTAINS 0 RECORDS                                     00330000
005300     LABEL RECORDS ARE STANDARD.                                  00340000
W38861*01  SKU-UNLOAD-IN-REC                  PIC X(147).               00350000
W38861 01  SKU-UNLOAD-IN-REC                  PIC X(150).               00351000
005500                                                                  00360000
005600 FD  SKU-EXTRACT-OUT                                              00370000
005700     RECORDING MODE IS F                                          00380000
005800     BLOCK CONTAINS 0 RECORDS                                     00390000
005900     LABEL RECORDS ARE STANDARD.                                  00400000
006000 01  SKU-EXTRACT-OUT-REC                PIC X(500).               00410000
006100                                                                  00420000
006800******************************************************************00430000
006900 WORKING-STORAGE SECTION.                                         00440000
007000******************************************************************00450000
007100 01  ABEND-CODE                         PIC S9(04)  VALUE +0      00460000
007200                                                    COMP SYNC.    00470000
007300 01  PC-PROGRAM-CONSTANTS.                                        00480000
007400     05  PC-PGM-NAME             PIC  X(08)     VALUE 'IMKUT029'. 00490000
007600     05  PC-MAX-RETRIES          PIC S9(04)     VALUE +2.         00500000
008000     05  PC-NEW                  PIC X(10) VALUE                  00501000
007700                                      'NEW       '.               00510000
008000     05  PC-ACTIVE               PIC X(10) VALUE                  00511000
007700                                      'ACTIVE    '.               00512000
008000     05  PC-MIXED                PIC X(10) VALUE                  00513000
007700                                      'MIXED     '.               00514000
008000     05  PC-CLEARANCE            PIC X(10) VALUE                  00515000
007700                                      'CLEARANCE '.               00516000
008000     05  PC-PROMTIONAL           PIC X(10) VALUE                  00517000
007700                                      'PROMTIONAL'.               00518000
008000     05  PC-DISCNTNUED           PIC X(10) VALUE                  00519000
007700                                      'DISCNTNUED'.               00519100
008000     05  PC-RENUMBERED           PIC X(10) VALUE                  00519200
007700                                      'RENUMBERED'.               00519300
007800                                                                  00520000
007900 01  PS-PROGRAM-SWITCHES.                                         00530000
008000     05  PS-INPUT-IND                   PIC X(01)    VALUE 'N'.   00540000
008100         88  END-OF-INPUT                            VALUE 'Y'.   00550000
008200     05  PS-SQL-ERROR-SW                PIC X(01)    VALUE 'N'.   00560000
008300         88  PS-SQL-ERROR                            VALUE 'Y'.   00570000
008400         88  PS-NO-SQL-ERROR                         VALUE 'N'.   00580000
009100                                                                  00620000
009200 01  PV-PROGRAM-VARIABLES.                                        00630000
009300     05  PV-SKU-RECS-WRITTEN            PIC S9(09) VALUE +0  COMP.00640000
009400     05  PV-SKU-RECS-READ               PIC S9(09) VALUE +0  COMP.00650000
009700     05  PV-PARAGRAPH-NAME              PIC  X(30)  VALUE SPACE.  00660000
009800     05  PV-DB2-OPERATION               PIC  X(30)  VALUE SPACE.  00670000
009900     05  PV-RETRY-COUNT                 PIC S9(04)  VALUE ZERO    00680000
010000                                                    COMP SYNC.    00690000
           05  PV-INTR-UPC-ID-TEN             PIC S9(10) VALUE +0 COMP. 00691000
           05  PV-DISPLAY-INTERNAL            PIC  9(10) VALUE ZERO.    00691100
           05  PV-EXTD-SZ-NULL-IND           PIC S9(4)    VALUE +0 COMP.00691200
                                                                        00692000
012700*--------------------------------------------------               00700000
012800*  COPYBOOK FOR BMC SKU UNLOAD INPUT FILE.                        00710000
012900*--------------------------------------------------               00720000
013000     COPY IMRD052.                                                00730000
013100                                                                  00740000
012700*--------------------------------------------------               00750000
012800*  COPYBOOK FOR ITEM DOMAIN SKU EXTRACT OUTPUT FILE.              00760000
012900*--------------------------------------------------               00770000
013000     COPY IMRD053.                                                00780000
013100                                                                  00790000
013800                                                                  00800000
015210*--------------------------------------------------               00810000
015220*  VENDOR STYLE CHARACTERISTIC VALUE TABLE                        00820000
015230*--------------------------------------------------               00830000
015240     EXEC SQL                                                     00840000
015250         INCLUDE TVSCHVL                                          00850000
015260     END-EXEC.                                                    00860000
015270                                                                  00870000
015210*--------------------------------------------------               00880000
015220*  COLOR TABLE                                                    00890000
015230*--------------------------------------------------               00900000
015240     EXEC SQL                                                     00910000
015250         INCLUDE TCOLOR                                           00920000
015260     END-EXEC.                                                    00930000
015270                                                                  00940000
015210*--------------------------------------------------               00941000
015220*  SIZE TABLE                                                     00942000
015230*--------------------------------------------------               00943000
015240     EXEC SQL                                                     00944000
015250         INCLUDE TSIZE                                            00945000
015260     END-EXEC.                                                    00946000
015270                                                                  00947000
015210*--------------------------------------------------               00948000
015220*  WEB ITEM ATTRIBUTES TABLE                                      00949000
015230*--------------------------------------------------               00949100
015240     EXEC SQL                                                     00949200
015250         INCLUDE TWEBITM                                          00949300
015260     END-EXEC.                                                    00949400
015270                                                                  00949500
015230*--------------------------------------------------               00958000
015400*  COMMUNICATION AREA FOR DB2                                     00960000
015500*--------------------------------------------------               00970000
015600     EXEC SQL                                                     00980000
015700         INCLUDE SQLCA                                            00990000
015800     END-EXEC.                                                    01000000
015900                                                                  01010000
016000*--------------------------------------------------               01020000
016100*  DB2 SQL ERROR ROUTINE                                          01030000
016200*--------------------------------------------------               01040000
016300     COPY DPWS004.                                                01050000
016400                                                                  01060000
016500 PROCEDURE DIVISION.                                              01070000
016600*-----------------------------------------------------------------01080000
016700*  MAIN LINE OF THE PROGRAM PERFORMS THE                          01090000
016800*  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM. 01100000
016900*-----------------------------------------------------------------01110000
017000 0000-MAINLINE.                                                   01120000
017100                                                                  01130000
017200     PERFORM 0100-HOUSEKEEPING.                                   01140000
017300                                                                  01150000
017400     PERFORM 1000-PROCESS-INPUT-FILE                              01160000
017500         UNTIL END-OF-INPUT.                                      01170000
017600                                                                  01180000
017700     PERFORM 9000-EOJ.                                            01190000
017800     GOBACK.                                                      01200000
017900                                                                  01210000
018000*-----------------------------------------------------------------01220000
018100*  OPEN FILES AND PERFORM FIRST READ FROM INPUT FILE              01230000
018200*-----------------------------------------------------------------01240000
018300 0100-HOUSEKEEPING.                                               01250000
018400                                                                  01260000
018500     OPEN INPUT SKU-UNLOAD-IN                                     01270000
018600          OUTPUT SKU-EXTRACT-OUT.                                 01280000
018800                                                                  01290000
020800     PERFORM 6000-READ-SKU-UNLOAD-FILE.                           01300000
020900                                                                  01310000
021000     IF END-OF-INPUT                                              01320000
021100        DISPLAY '*** '                                            01330000
021200        DISPLAY '*** IMKUT029 - NO INPUT SKU RECS FOUND'          01340000
021300        DISPLAY '*** '                                            01350000
021400        MOVE +4003 TO ABEND-CODE                                  01360000
021500        PERFORM 9999-ABEND                                        01370000
021600     END-IF.                                                      01380000
021700                                                                  01390000
021800*-----------------------------------------------------------------01400000
021900*  PROCESS ALL INPUT RECORDS AND FORMAT ITEM SKU DOMAIN EXTRACT   01410000
022000*  RECORDS UNTIL END OF INPUT FILE.                               01420000
022100*-----------------------------------------------------------------01430000
022200 1000-PROCESS-INPUT-FILE.                                         01440000
022300     MOVE IM052-INTR-UPC-ID       TO PV-INTR-UPC-ID-TEN.          01450000
022300     MOVE PV-INTR-UPC-ID-TEN      TO PV-DISPLAY-INTERNAL.         01451000
028310     PERFORM 1300-GET-SIZE-DESC.                                  01460000
028320     MOVE SIZE-KOHLS-DESC         TO IM053-KOHLS-SIZE-DESC.       01470000
           IF PV-EXTD-SZ-NULL-IND = -1                                  01470100
               MOVE SPACES TO IM053-EXTD-SZ-CDE                         01470400
           ELSE                                                         01470500
               MOVE SIZE-EXTD-SZ-CDE    TO IM053-EXTD-SZ-CDE            01470800
           END-IF.                                                      01480000
           PERFORM 1400-GET-COLOR-DESCS.                                01490000
           MOVE COLOR-NRF-CLOR-DESC     TO IM053-NRF-CLOR-DESC.         01491000
           MOVE COLOR-SHRT-CLOR-DESC    TO IM053-SHRT-CLOR-DESC.        01493000
                                                                        01520000
028340     PERFORM 1500-GET-SEA-DESC.                                   01520100
028350     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-SEA-DESC.              01520200
                                                                        01520300
028340     PERFORM 1600-GET-TX-PRD-CDE-DESC.                            01520400
028350     MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-TX-PRD-CDE-DESC.       01520500
                                                                        01520600
           IF IM052-SKU-STAT-CDE = '98'                                 01522000
               MOVE 'N' TO IM053-E-BUS-ITM-IND                          01523000
               MOVE LOW-VALUES TO IM053-ASRT-BEG-DTE                    01523200
               MOVE LOW-VALUES TO IM053-ASRT-END-DTE                    01523300
               MOVE LOW-VALUES TO IM053-STRG-AREA-DESC                  01523400
               MOVE ZERO       TO IM053-SHIP-WD-QTY                     01523500
               MOVE ZERO       TO IM053-SHIP-DPTH-QTY                   01523600
               MOVE ZERO       TO IM053-SHIP-HT-QTY                     01523700
               MOVE ZERO       TO IM053-SHIP-WT-QTY                     01523800
               MOVE LOW-VALUES TO IM053-SHIP-DIM-SRC-CDE                01523900
               MOVE LOW-VALUES TO IM053-PKG-DESC                        01524000
               MOVE LOW-VALUES TO IM053-SHIP-RSTRC-DESC                 01524100
               MOVE LOW-VALUES TO IM053-GFT-WRAP-AVL-IND                01524200
               MOVE ZERO       TO IM053-PRD-GP-NBR                      01524300
               MOVE LOW-VALUES TO IM053-PRD-GP-IND                      01524400
               MOVE ZERO       TO IM053-SHIP-SRCHG-FEE-AMT              01524500
               MOVE LOW-VALUES TO IM053-SHIP-SRVC-DESC                  01524600
               MOVE LOW-VALUES TO IM053-SHIP-GP-DESC                    01524700
           ELSE                                                         01525000
               PERFORM 1700-GET-WEBITM                                  01700000
               IF SQLCODE = 0                                           01701000
                 MOVE 'Y' TO IM053-E-BUS-ITM-IND                        01701100
                 MOVE WEBITM-ASRT-BEG-DTE   TO IM053-ASRT-BEG-DTE       01701200
                 MOVE WEBITM-ASRT-END-DTE   TO IM053-ASRT-END-DTE       01701300
                 MOVE WEBITM-SHIP-WD-QTY    TO IM053-SHIP-WD-QTY        01701500
                 MOVE WEBITM-SHIP-DPTH-QTY  TO IM053-SHIP-DPTH-QTY      01701600
                 MOVE WEBITM-SHIP-HT-QTY    TO IM053-SHIP-HT-QTY        01701700
                 MOVE WEBITM-SHIP-WT-QTY    TO IM053-SHIP-WT-QTY        01701800
                 MOVE WEBITM-SHIP-DIM-SRC-CDE                           01701900
                                     TO IM053-SHIP-DIM-SRC-CDE          01702000
                 MOVE WEBITM-GFT-WRAP-AVL-IND                           01702300
                                     TO IM053-GFT-WRAP-AVL-IND          01702400
                 MOVE WEBITM-PRD-GP-NBR     TO IM053-PRD-GP-NBR         01702500
                 MOVE WEBITM-PRD-GP-IND     TO IM053-PRD-GP-IND         01702600
                 MOVE WEBITM-SHIP-SRCHG-FEE-AMT                         01702700
                                     TO IM053-SHIP-SRCHG-FEE-AMT        01702800
                 PERFORM 1800-GET-STRG-AREA-DESC                        01703100
028350           MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-STRG-AREA-DESC   01703200
                 PERFORM 1900-GET-PKG-DESC                              01703300
028350           MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-PKG-DESC         01703400
                 PERFORM 2100-GET-SHIP-RSTRC-DESC                       01703500
028350           MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-SHIP-RSTRC-DESC  01703600
                 PERFORM 2200-GET-SHIP-SRVC-DESC                        01703700
028350           MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-SHIP-SRVC-DESC   01703800
                 PERFORM 2300-GET-SHIP-GP-DESC                          01703900
028350           MOVE VSCHVL-CHARTC-VAL-DESC  TO IM053-SHIP-GP-DESC     01704000
                 MOVE WEBITM-WEB-EXCLV-IND    TO IM053-WEB-EXCLV-IND    01704100
               END-IF                                                   01704200
           END-IF.                                                      01705000
W36546                                                                  01705100
W36546     PERFORM 2400-GET-TST-PRD-TYP-DESC.                           01706000
W36546     MOVE VSCHVL-CHARTC-VAL-DESC TO IM053-TST-PRD-TYP-DESC.       01707000
W36546                                                                  01708000
022900     PERFORM 1200-MOVE-DATA-TO-OUTPUT-REC.                        01710000
028360                                                                  01720000
028600***  WRITE SKU OUTPUT RECORD                                      01730000
028700     PERFORM 7000-WRITE-SKU-OUTPUT-REC.                           01740000
029200     PERFORM 6000-READ-SKU-UNLOAD-FILE.                           01760000
024300                                                                  01770000
024400*-----------------------------------------------------------------01780000
024500* MOVE VALUES TO OUTPUT RECORD                                    01790000
024600*-----------------------------------------------------------------01800000
024700 1200-MOVE-DATA-TO-OUTPUT-REC.                                    01810000
024800                                                                  01820000
           MOVE IM052-INTR-UPC-ID       TO IM053-INTR-UPC-ID.           01821000
026000     MOVE IM052-RMS-STYL-ID       TO IM053-RMS-STYL-ID.           01830000
026100     MOVE IM052-ITM-NBR           TO IM053-ITM-NBR.               01840000
026000     MOVE IM052-SKU               TO IM053-SKU.                   01850000
026000     MOVE IM052-INTR-UPC-DESC     TO IM053-INTR-UPC-DESC.         01860000
026100     MOVE IM052-SKU-STAT-CDE      TO IM053-SKU-STAT-CDE.          01870000
           EVALUATE IM052-SKU-STAT-CDE                                  01871000
               WHEN '10'                                                01872000
                   MOVE PC-NEW TO IM053-SKU-STAT-DESC                   01873000
               WHEN '20'                                                01874000
                   MOVE PC-ACTIVE TO IM053-SKU-STAT-DESC                01875000
               WHEN '25'                                                01876000
                   MOVE PC-MIXED TO IM053-SKU-STAT-DESC                 01877000
               WHEN '30'                                                01878000
                   MOVE PC-CLEARANCE TO IM053-SKU-STAT-DESC             01879000
               WHEN '40'                                                01879100
                   MOVE PC-PROMTIONAL TO IM053-SKU-STAT-DESC            01879200
               WHEN '90'                                                01879300
                   MOVE PC-DISCNTNUED TO IM053-SKU-STAT-DESC            01879400
               WHEN '98'                                                01879500
                   MOVE PC-RENUMBERED TO IM053-SKU-STAT-DESC            01879600
               WHEN  OTHER                                              01879700
                   MOVE SPACES TO IM053-SKU-STAT-DESC                   01879800
           END-EVALUATE.                                                01879900
026100     MOVE IM052-INNR-PK-QTY       TO IM053-INNR-PK-QTY.           01880000
026100     MOVE IM052-OUTR-PK-QTY       TO IM053-OUTR-PK-QTY.           01881000
026100     MOVE IM052-KOHLS-SIZE-CDE    TO IM053-KOHLS-SIZE-CDE.        01890000
026100     MOVE IM052-NRF-CLOR-CDE      TO IM053-NRF-CLOR-CDE.          01900000
026100     MOVE IM052-CSTM-CLOR-DESC    TO IM053-CSTM-CLOR-DESC.        01910000
026100     MOVE IM052-CUSTFACG-CLOR-DESC                                01911000
028300                                  TO IM053-CUSTFACG-CLOR-DESC.    01920000
026100     MOVE IM052-REGN-PRIC-IND     TO IM053-REGN-PRIC-IND.         01920100
026100     MOVE IM052-RPLNMT-IND        TO IM053-RPLNMT-IND.            01920200
026100     MOVE IM052-KY-ITM-IND        TO IM053-KY-ITM-IND.            01920300
026100     MOVE IM052-POG-IND           TO IM053-POG-IND.               01920400
026100     MOVE IM052-GP-CDE            TO IM053-GP-CDE.                01920500
           MOVE IM052-UNT-COST-1ST-AMT  TO IM053-UNT-COST-1ST-AMT.      01921000
           MOVE IM052-WT-UM-CDE         TO IM053-WT-UM-CDE.             01922000
           MOVE IM052-WT-UM-QTY         TO IM053-WT-UM-QTY.             01923000
           MOVE IM052-SIZE-UM-CDE       TO IM053-SIZE-UM-CDE.           01924000
           MOVE IM052-WD-UM-QTY         TO IM053-WD-UM-QTY.             01925000
           MOVE IM052-HT-UM-QTY         TO IM053-HT-UM-QTY.             01926000
           MOVE IM052-DPTH-UM-QTY       TO IM053-DPTH-UM-QTY.           01927000
026100     MOVE IM052-TRNSTN-IND        TO IM053-TRNSTN-IND.            01928000
           MOVE IM052-PO-SHRT-CYC-IND   TO IM053-PO-SHRT-CYC-IND.       01929000
           MOVE IM052-EFF-BEG-DTE       TO IM053-EFF-BEG-DTE.           01929100
W38861     MOVE IM052-WHSE-RPLNT-IND    TO IM053-WHSE-RPLNT-IND.        01929200
028400     MOVE SPACES                  TO IM053-ITEM-SKU-FILLER.       01930000
028500                                                                  01940000
028800                                                                  01950000
028810*-----------------------------------------------------------------01960000
028820* GET THE SIZE DESCRIPTION FROM TSIZE BASED ON THE KOHLS SIZE CDE 01970000
028830* FROM THE INPUT FILE.                                            01980000
028840*-----------------------------------------------------------------01990000
028850 1300-GET-SIZE-DESC.                                              02000000
028860                                                                  02010000
028861     INITIALIZE DCLTSIZE.                                         02020000
028862                                                                  02030000
028870     PERFORM WITH TEST AFTER                                      02040000
028880         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02050000
028890           UNTIL SQLCODE = +0                                     02060000
028891              OR SQLCODE = +100                                   02070000
028893              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02080000
028894         EXEC SQL                                                 02090000
028895             SELECT KOHLS_DESC                                    02100000
                         ,EXTD_SZ_CDE                                   02100100
028898               INTO :SIZE-KOHLS-DESC                              02110000
                         ,:SIZE-EXTD-SZ-CDE :PV-EXTD-SZ-NULL-IND        02111000
028901               FROM TSIZE                                         02120000
028902              WHERE KOHLS_SIZE_CDE = :IM052-KOHLS-SIZE-CDE        02130000
                    WITH UR                                             02150000
028904         END-EXEC                                                 02160000
028905                                                                  02170000
028906         EVALUATE TRUE                                            02180000
028907             WHEN SQLCODE = -904                                  02190000
028908             WHEN SQLCODE = -913                                  02200000
028909                 CONTINUE                                         02210000
028910             WHEN SQLCODE = ZERO                                  02220000
028911                 CONTINUE                                         02230000
028912             WHEN SQLCODE = +100                                  02240000
028913                 MOVE SPACES TO SIZE-KOHLS-DESC                   02250000
                       MOVE SPACES TO SIZE-EXTD-SZ-CDE                  02251000
028914             WHEN OTHER                                           02260000
028915                 DISPLAY '** '                                    02270000
028916                         PC-PGM-NAME                              02280000
028917                         ' - INTR UPC ID: '                       02290000
028918                         PV-DISPLAY-INTERNAL                      02300000
028924                 MOVE '1300-GET-SIZE-DESC' TO PV-PARAGRAPH-NAME   02310000
028925                 MOVE 'SELECT FROM TSIZE'  TO PV-DB2-OPERATION    02320000
028926                 PERFORM 9998-SQL-ERROR                           02330000
028927         END-EVALUATE                                             02340000
028928     END-PERFORM.                                                 02350000
028929                                                                  02360000
028930     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02370000
028931         DISPLAY '** '                                            02380000
028932                 PC-PGM-NAME                                      02390000
028917                 ' - INTR UPC ID: '                               02391000
028918                 PV-DISPLAY-INTERNAL                              02391100
028924         MOVE '1300-GET-SIZE-DESC' TO PV-PARAGRAPH-NAME           02393000
028925         MOVE 'SELECT FROM TSIZE'  TO PV-DB2-OPERATION            02394000
028926         PERFORM 9998-SQL-ERROR                                   02395000
028940     END-IF.                                                      02450000
028941                                                                  02460000
028810*-----------------------------------------------------------------02466200
028820* GET THE COLOR DESCS FROM TCOLOR BASED ON THE NRF COLOR CODE     02466300
028830* FROM THE INPUT FILE.                                            02466400
028840*-----------------------------------------------------------------02466500
028850 1400-GET-COLOR-DESCS.                                            02466600
028860                                                                  02466700
028861     INITIALIZE DCLTCOLOR.                                        02467000
028862                                                                  02468000
028870     PERFORM WITH TEST AFTER                                      02469000
028880         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02469100
028890           UNTIL SQLCODE = +0                                     02469200
028891              OR SQLCODE = +100                                   02469300
028893              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02469400
028894         EXEC SQL                                                 02469500
028895             SELECT NRF_CLOR_DESC                                 02469600
                         ,SHRT_CLOR_DESC                                02469700
028898               INTO :COLOR-NRF-CLOR-DESC                          02470000
                         ,:COLOR-SHRT-CLOR-DESC                         02470100
028901               FROM TCOLOR                                        02470200
028902              WHERE NRF_CLOR_CDE = :IM052-NRF-CLOR-CDE            02470300
                    WITH UR                                             02470400
028904         END-EXEC                                                 02470500
028905                                                                  02470600
028906         EVALUATE TRUE                                            02470700
028907             WHEN SQLCODE = -904                                  02470800
028908             WHEN SQLCODE = -913                                  02470900
028909                 CONTINUE                                         02471000
028910             WHEN SQLCODE = ZERO                                  02471100
028911                 CONTINUE                                         02471200
028912             WHEN SQLCODE = +100                                  02471300
028898                 MOVE SPACES TO COLOR-NRF-CLOR-DESC               02471400
                       MOVE SPACES TO COLOR-SHRT-CLOR-DESC              02471500
028914             WHEN OTHER                                           02471700
028915                 DISPLAY '** '                                    02471800
028916                         PC-PGM-NAME                              02471900
028917                         ' - INTR UPC ID: '                       02472000
028918                         PV-DISPLAY-INTERNAL                      02472100
028924                 MOVE '1400-GET-COLOR-DESCS' TO PV-PARAGRAPH-NAME 02472300
028925                 MOVE 'SELECT FROM TCOLOR'   TO PV-DB2-OPERATION  02472400
028926                 PERFORM 9998-SQL-ERROR                           02472500
028927         END-EVALUATE                                             02472600
028928     END-PERFORM.                                                 02472700
028929                                                                  02472800
028930     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02472900
028915         DISPLAY '** '                                            02473000
028916                 PC-PGM-NAME                                      02473100
028917                 ' - INTR UPC ID: '                               02473200
028918                 PV-DISPLAY-INTERNAL                              02473300
028924         MOVE '1400-GET-COLOR-DESCS' TO PV-PARAGRAPH-NAME         02473500
028925         MOVE 'SELECT FROM TCOLOR'   TO PV-DB2-OPERATION          02473600
028926         PERFORM 9998-SQL-ERROR                                   02473700
028940     END-IF.                                                      02474300
028941                                                                  02474400
028942*-----------------------------------------------------------------02899400
028943* GET THE SEASON  DESCRIPTION BASED ON THE SEA-SEQ-NBR            02899500
028944* FROM THE INPUT FILE.                                            02899600
028945*-----------------------------------------------------------------02899700
028946 1500-GET-SEA-DESC.                                               02899800
028947                                                                  02899900
028948     INITIALIZE DCLTVSCHVL.                                       02900000
028949                                                                  02900100
028950     PERFORM WITH TEST AFTER                                      02900200
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02900300
028952           UNTIL SQLCODE = +0                                     02900400
028953              OR SQLCODE = +100                                   02900500
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02900600
028955         EXEC SQL                                                 02900700
028956             SELECT CHARTC_VAL_DESC                               02900800
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02900900
028958               FROM TVSCHVL                                       02901000
028959              WHERE CHARTC_CDE     = 4                            02901100
028960                AND CHARTC_SEQ_NBR = :IM052-SEA-SEQ-NBR           02901200
                    WITH UR                                             02901300
028961         END-EXEC                                                 02901400
028962                                                                  02901500
028963         EVALUATE TRUE                                            02901600
028964             WHEN SQLCODE = -904                                  02901700
028965             WHEN SQLCODE = -913                                  02901800
028966                 CONTINUE                                         02901900
028967             WHEN SQLCODE = ZERO                                  02902000
028968                 CONTINUE                                         02902100
028969             WHEN SQLCODE = +100                                  02902200
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02902300
028971             WHEN OTHER                                           02902400
028915                 DISPLAY '** '                                    02902500
028916                         PC-PGM-NAME                              02902600
028917                         ' - INTR UPC ID: '                       02902700
028918                         PV-DISPLAY-INTERNAL                      02902800
028924                 MOVE '1500-GET-SEA-DESC'    TO PV-PARAGRAPH-NAME 02903000
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02903100
028926                 PERFORM 9998-SQL-ERROR                           02903200
028982         END-EVALUATE                                             02904000
028983     END-PERFORM.                                                 02904100
028984                                                                  02904200
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02904300
028915         DISPLAY '** '                                            02904400
028916                 PC-PGM-NAME                                      02904500
028917                 ' - INTR UPC ID: '                               02904600
028918                 PV-DISPLAY-INTERNAL                              02904700
028924         MOVE '1500-GET-SEA-DESC'    TO PV-PARAGRAPH-NAME         02904900
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02905000
028926         PERFORM 9998-SQL-ERROR                                   02905100
028995     END-IF.                                                      02905800
                                                                        02905900
028942*-----------------------------------------------------------------02906000
028943* GET THE TAX PROD CODE DESCRIPTION USING THE TX-PRD-CDE-SEQ-NBR  02906100
028944* FROM THE INPUT FILE.                                            02906200
028945*-----------------------------------------------------------------02906300
028340 1600-GET-TX-PRD-CDE-DESC.                                        02906400
028947                                                                  02906600
028948     INITIALIZE DCLTVSCHVL.                                       02906700
028949                                                                  02906800
028950     PERFORM WITH TEST AFTER                                      02906900
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02907000
028952           UNTIL SQLCODE = +0                                     02907100
028953              OR SQLCODE = +100                                   02907200
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02907300
028955         EXEC SQL                                                 02907400
028956             SELECT CHARTC_VAL_DESC                               02907500
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02907600
028958               FROM TVSCHVL                                       02907700
028959              WHERE CHARTC_CDE     = 14                           02907800
028960                AND CHARTC_SEQ_NBR = :IM052-TX-PRD-CDE-SEQ-NBR    02907900
                    WITH UR                                             02908000
028961         END-EXEC                                                 02908100
028962                                                                  02908200
028963         EVALUATE TRUE                                            02908300
028964             WHEN SQLCODE = -904                                  02908400
028965             WHEN SQLCODE = -913                                  02908500
028966                 CONTINUE                                         02908600
028967             WHEN SQLCODE = ZERO                                  02908700
028968                 CONTINUE                                         02908800
028969             WHEN SQLCODE = +100                                  02908900
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02909000
028971             WHEN OTHER                                           02909100
028915                 DISPLAY '** '                                    02909200
028916                         PC-PGM-NAME                              02909300
028917                         ' - INTR UPC ID: '                       02909400
028918                         PV-DISPLAY-INTERNAL                      02909600
028924                 MOVE '1600-GET-TAX-DESC'    TO PV-PARAGRAPH-NAME 02909700
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02909800
028926                 PERFORM 9998-SQL-ERROR                           02909900
028982         END-EVALUATE                                             02910000
028983     END-PERFORM.                                                 02910100
028984                                                                  02910200
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02910300
028915         DISPLAY '** '                                            02910400
028916                 PC-PGM-NAME                                      02910500
028917                 ' - INTR UPC ID: '                               02910600
028918                 PV-DISPLAY-INTERNAL                              02910800
028924         MOVE '1600-GET-TAX-DESC'    TO PV-PARAGRAPH-NAME         02910900
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02911000
028926         PERFORM 9998-SQL-ERROR                                   02911100
028995     END-IF.                                                      02911200
028996                                                                  02911300
029051                                                                  02932000
028810*-----------------------------------------------------------------02932100
028820* GET THE WEBITM INFORMATION FROM TWEBITM BASED ON THE INTR UPC   02932200
028830* ID FROM THE INPUT FILE.                                         02932300
028840*-----------------------------------------------------------------02932400
028850 1700-GET-WEBITM.                                                 02932500
028860                                                                  02932600
028861     INITIALIZE DCLTWEBITM.                                       02932700
028862                                                                  02932800
028870     PERFORM WITH TEST AFTER                                      02932900
028880         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02933000
028890           UNTIL SQLCODE = +0                                     02933100
028891              OR SQLCODE = +100                                   02933200
028893              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02933300
028894         EXEC SQL                                                 02933400
                   SELECT ASRT_BEG_DTE                                  02933500
                         ,ASRT_END_DTE                                  02933600
                         ,STRG_AREA_SEQ_NBR                             02933700
                         ,SHIP_WD_QTY                                   02933800
                         ,SHIP_DPTH_QTY                                 02933900
                         ,SHIP_HT_QTY                                   02934000
                         ,SHIP_WT_QTY                                   02934100
                         ,SHIP_DIM_SRC_CDE                              02934200
                         ,PKG_SEQ_NBR                                   02934300
                         ,SHIP_RSTRC_SEQ_NBR                            02934400
                         ,GFT_WRAP_AVL_IND                              02934500
                         ,PRD_GP_NBR                                    02934600
                         ,PRD_GP_IND                                    02934700
                         ,SHIP_SRCHG_FEE_AMT                            02934800
                         ,SHIP_SRVC_SEQ_NBR                             02934900
                         ,SHIP_GP_SEQ_NBR                               02935000
                         ,WEB_EXCLV_IND                                 02935100
                     INTO :WEBITM-ASRT-BEG-DTE                          02935200
                         ,:WEBITM-ASRT-END-DTE                          02935400
                         ,:WEBITM-STRG-AREA-SEQ-NBR                     02935500
                         ,:WEBITM-SHIP-WD-QTY                           02935600
                         ,:WEBITM-SHIP-DPTH-QTY                         02935700
                         ,:WEBITM-SHIP-HT-QTY                           02935800
                         ,:WEBITM-SHIP-WT-QTY                           02935900
                         ,:WEBITM-SHIP-DIM-SRC-CDE                      02936000
                         ,:WEBITM-PKG-SEQ-NBR                           02936100
                         ,:WEBITM-SHIP-RSTRC-SEQ-NBR                    02936200
                         ,:WEBITM-GFT-WRAP-AVL-IND                      02936300
                         ,:WEBITM-PRD-GP-NBR                            02936400
                         ,:WEBITM-PRD-GP-IND                            02936500
                         ,:WEBITM-SHIP-SRCHG-FEE-AMT                    02936600
                         ,:WEBITM-SHIP-SRVC-SEQ-NBR                     02936700
                         ,:WEBITM-SHIP-GP-SEQ-NBR                       02936800
                         ,:WEBITM-WEB-EXCLV-IND                         02936900
028901             FROM TWEBITM                                         02937000
028902             WHERE INTR_UPC_ID = :IM052-INTR-UPC-ID               02937100
                     AND EFF_BEG_TMST <= CURRENT TIMESTAMP              02937200
                     AND EFF_END_TMST IS NULL                           02937300
                   WITH UR                                              02937400
028904         END-EXEC                                                 02937500
028905                                                                  02937600
028906         EVALUATE TRUE                                            02937700
028907             WHEN SQLCODE = -904                                  02937800
028908             WHEN SQLCODE = -913                                  02937900
028909                 CONTINUE                                         02938000
028910             WHEN SQLCODE = ZERO                                  02938100
028911                 CONTINUE                                         02938200
028912             WHEN SQLCODE = +100                                  02938300
                       MOVE 'N' TO IM053-E-BUS-ITM-IND                  02938400
                       MOVE LOW-VALUES TO IM053-ASRT-BEG-DTE            02938500
                       MOVE LOW-VALUES TO IM053-ASRT-END-DTE            02938600
                       MOVE LOW-VALUES TO IM053-STRG-AREA-DESC          02938700
                       MOVE ZERO       TO IM053-SHIP-WD-QTY             02938800
                       MOVE ZERO       TO IM053-SHIP-DPTH-QTY           02938900
                       MOVE ZERO       TO IM053-SHIP-HT-QTY             02939000
                       MOVE ZERO       TO IM053-SHIP-WT-QTY             02939100
                       MOVE LOW-VALUES TO IM053-SHIP-DIM-SRC-CDE        02939200
                       MOVE LOW-VALUES TO IM053-PKG-DESC                02939300
                       MOVE LOW-VALUES TO IM053-SHIP-RSTRC-DESC         02939400
                       MOVE LOW-VALUES TO IM053-GFT-WRAP-AVL-IND        02939500
                       MOVE ZERO       TO IM053-PRD-GP-NBR              02939600
                       MOVE LOW-VALUES TO IM053-PRD-GP-IND              02939700
                       MOVE ZERO       TO IM053-SHIP-SRCHG-FEE-AMT      02939800
                       MOVE LOW-VALUES TO IM053-SHIP-SRVC-DESC          02939900
                       MOVE LOW-VALUES TO IM053-SHIP-GP-DESC            02940000
                       MOVE 'N' TO IM053-WEB-EXCLV-IND                  02940100
028914             WHEN OTHER                                           02940200
028915                 DISPLAY '** '                                    02940300
028916                         PC-PGM-NAME                              02940400
028917                         ' - INTR UPC ID: '                       02940500
028918                         PV-DISPLAY-INTERNAL                      02940600
028924                 MOVE '1700-GET-WEBITM'      TO PV-PARAGRAPH-NAME 02940700
028925                 MOVE 'SELECT FROM TWEBITM'  TO PV-DB2-OPERATION  02940800
028926                 PERFORM 9998-SQL-ERROR                           02940900
028927         END-EVALUATE                                             02941000
028928     END-PERFORM.                                                 02941100
028929                                                                  02941200
028930     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02941300
028931         DISPLAY '** '                                            02941400
028932                 PC-PGM-NAME                                      02941500
028917                 ' - INTR UPC ID: '                               02941600
028918                 PV-DISPLAY-INTERNAL                              02941700
028924         MOVE '1700-GET-WEBITM'      TO PV-PARAGRAPH-NAME         02941800
028925         MOVE 'SELECT FROM TWEBITM'  TO PV-DB2-OPERATION          02941900
028926         PERFORM 9998-SQL-ERROR                                   02942000
028940     END-IF.                                                      02942100
028941                                                                  02942200
                                                                        02942300
028942*-----------------------------------------------------------------02942400
028943* GET THE ECOMM STORAGE AREA DESC USING THE TWEBITM STRG-AREA-SEQ-02942500
028943* NBR.                                                            02942600
028945*-----------------------------------------------------------------02942700
028340 1800-GET-STRG-AREA-DESC.                                         02942800
028947                                                                  02942900
028948     INITIALIZE DCLTVSCHVL.                                       02943000
028949                                                                  02943100
028950     PERFORM WITH TEST AFTER                                      02943200
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02943300
028952           UNTIL SQLCODE = +0                                     02943400
028953              OR SQLCODE = +100                                   02943500
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02943600
028955         EXEC SQL                                                 02943700
028956             SELECT CHARTC_VAL_DESC                               02943800
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02943900
028958               FROM TVSCHVL                                       02944000
028959              WHERE CHARTC_CDE     = 15                           02944100
028960                AND CHARTC_SEQ_NBR = :WEBITM-STRG-AREA-SEQ-NBR    02944200
                    WITH UR                                             02944300
028961         END-EXEC                                                 02944400
028962                                                                  02944500
028963         EVALUATE TRUE                                            02944600
028964             WHEN SQLCODE = -904                                  02944700
028965             WHEN SQLCODE = -913                                  02944800
028966                 CONTINUE                                         02944900
028967             WHEN SQLCODE = ZERO                                  02945000
028968                 CONTINUE                                         02945100
028969             WHEN SQLCODE = +100                                  02945200
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02945300
028971             WHEN OTHER                                           02945400
028915                 DISPLAY '** '                                    02945500
028916                         PC-PGM-NAME                              02945600
028917                         ' - INTR UPC ID: '                       02945700
028918                         PV-DISPLAY-INTERNAL                      02945900
028924                 MOVE '1800-GET-STRG-AREA-DESC'                   02946000
028924                                             TO PV-PARAGRAPH-NAME 02946100
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02946200
028926                 PERFORM 9998-SQL-ERROR                           02946300
028982         END-EVALUATE                                             02946400
028983     END-PERFORM.                                                 02946500
028984                                                                  02946600
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02946700
028915         DISPLAY '** '                                            02946800
028916                 PC-PGM-NAME                                      02946900
028917                 ' - INTR UPC ID: '                               02947000
028918                 PV-DISPLAY-INTERNAL                              02947100
028924         MOVE '1600-GET-TAX-DESC'    TO PV-PARAGRAPH-NAME         02947300
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02947400
028926         PERFORM 9998-SQL-ERROR                                   02947500
028995     END-IF.                                                      02947600
028996                                                                  02947700
028942*-----------------------------------------------------------------02947800
028943* GET THE ECOMM PACKAGE DESC USING THE TWEBITM PKG-SEQ-NBR.       02947900
028945*-----------------------------------------------------------------02948000
028340 1900-GET-PKG-DESC.                                               02948100
028947                                                                  02948200
028948     INITIALIZE DCLTVSCHVL.                                       02948300
028949                                                                  02948400
028950     PERFORM WITH TEST AFTER                                      02948500
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02948600
028952           UNTIL SQLCODE = +0                                     02948700
028953              OR SQLCODE = +100                                   02948800
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02948900
028955         EXEC SQL                                                 02949000
028956             SELECT CHARTC_VAL_DESC                               02949100
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02949200
028958               FROM TVSCHVL                                       02949300
028959              WHERE CHARTC_CDE     = 16                           02949400
028960                AND CHARTC_SEQ_NBR = :WEBITM-PKG-SEQ-NBR          02949500
                    WITH UR                                             02949600
028961         END-EXEC                                                 02949700
028962                                                                  02949800
028963         EVALUATE TRUE                                            02949900
028964             WHEN SQLCODE = -904                                  02950000
028965             WHEN SQLCODE = -913                                  02950100
028966                 CONTINUE                                         02950200
028967             WHEN SQLCODE = ZERO                                  02950300
028968                 CONTINUE                                         02950400
028969             WHEN SQLCODE = +100                                  02950500
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02950600
028971             WHEN OTHER                                           02950700
028915                 DISPLAY '** '                                    02950800
028916                         PC-PGM-NAME                              02950900
028917                         ' - INTR UPC ID: '                       02951000
028918                         PV-DISPLAY-INTERNAL                      02951200
028924                 MOVE '1900-GET-PKG-DESC'                         02951300
028924                                             TO PV-PARAGRAPH-NAME 02951400
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02951500
028926                 PERFORM 9998-SQL-ERROR                           02951600
028982         END-EVALUATE                                             02951700
028983     END-PERFORM.                                                 02951800
028984                                                                  02951900
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02952000
028915         DISPLAY '** '                                            02952100
028916                 PC-PGM-NAME                                      02952200
028917                 ' - INTR UPC ID: '                               02952300
028918                 PV-DISPLAY-INTERNAL                              02952500
028924         MOVE '1900-GET-PKG-DESC'    TO PV-PARAGRAPH-NAME         02952600
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02952700
028926         PERFORM 9998-SQL-ERROR                                   02952800
028995     END-IF.                                                      02952900
                                                                        02953000
028942*-----------------------------------------------------------------02953100
028943* GET THE ECOMM SHIPPING RESTRICTION DESC USING THE TWEBITM       02953200
028943* SHIP-RESTR-SEQ-NBR.                                             02953300
028945*-----------------------------------------------------------------02953400
       2100-GET-SHIP-RSTRC-DESC.                                        02953500
028947                                                                  02953600
028948     INITIALIZE DCLTVSCHVL.                                       02953700
028949                                                                  02953800
028950     PERFORM WITH TEST AFTER                                      02953900
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02954000
028952           UNTIL SQLCODE = +0                                     02954100
028953              OR SQLCODE = +100                                   02954200
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02954300
028955         EXEC SQL                                                 02954400
028956             SELECT CHARTC_VAL_DESC                               02954500
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02954600
028958               FROM TVSCHVL                                       02954700
028959              WHERE CHARTC_CDE     = 17                           02954800
028960                AND CHARTC_SEQ_NBR = :WEBITM-SHIP-RSTRC-SEQ-NBR   02954900
                    WITH UR                                             02955000
028961         END-EXEC                                                 02955100
028962                                                                  02955200
028963         EVALUATE TRUE                                            02955300
028964             WHEN SQLCODE = -904                                  02955400
028965             WHEN SQLCODE = -913                                  02955500
028966                 CONTINUE                                         02955600
028967             WHEN SQLCODE = ZERO                                  02955700
028968                 CONTINUE                                         02955800
028969             WHEN SQLCODE = +100                                  02955900
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02956000
028971             WHEN OTHER                                           02956100
028915                 DISPLAY '** '                                    02956200
028916                         PC-PGM-NAME                              02956300
028917                         ' - INTR UPC ID: '                       02956400
028918                         PV-DISPLAY-INTERNAL                      02956500
028924                 MOVE '2100-GET-SHIP-RSTRC-DESC'                  02956700
028924                                             TO PV-PARAGRAPH-NAME 02956800
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02956900
028926                 PERFORM 9998-SQL-ERROR                           02957000
028982         END-EVALUATE                                             02957100
028983     END-PERFORM.                                                 02957200
028984                                                                  02957300
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02957400
028915         DISPLAY '** '                                            02957500
028916                 PC-PGM-NAME                                      02957600
028917                 ' - INTR UPC ID: '                               02957700
028918                 PV-DISPLAY-INTERNAL                              02957800
028924         MOVE '2100-GET-SHIP-RSTRC-DESC'                          02958000
028924                                     TO PV-PARAGRAPH-NAME         02958100
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02958200
028926         PERFORM 9998-SQL-ERROR                                   02958300
028995     END-IF.                                                      02958400
028996                                                                  02958500
028942*-----------------------------------------------------------------02958600
028943* GET THE ECOMM SHIPPING SERVICE LEVEL DESC USING THE TWEBITM     02958700
028943* SHIP-SRVC-SEQ-NBR.                                              02958800
028945*-----------------------------------------------------------------02958900
       2200-GET-SHIP-SRVC-DESC.                                         02959000
028947                                                                  02959100
028948     INITIALIZE DCLTVSCHVL.                                       02959200
028949                                                                  02959300
028950     PERFORM WITH TEST AFTER                                      02959400
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02959500
028952           UNTIL SQLCODE = +0                                     02959600
028953              OR SQLCODE = +100                                   02959700
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02959800
028955         EXEC SQL                                                 02959900
028956             SELECT CHARTC_VAL_DESC                               02960000
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02960100
028958               FROM TVSCHVL                                       02960200
028959              WHERE CHARTC_CDE     = 13                           02960300
028960                AND CHARTC_SEQ_NBR = :WEBITM-SHIP-SRVC-SEQ-NBR    02960400
                    WITH UR                                             02960500
028961         END-EXEC                                                 02960600
028962                                                                  02960700
028963         EVALUATE TRUE                                            02960800
028964             WHEN SQLCODE = -904                                  02960900
028965             WHEN SQLCODE = -913                                  02961000
028966                 CONTINUE                                         02961100
028967             WHEN SQLCODE = ZERO                                  02961200
028968                 CONTINUE                                         02961300
028969             WHEN SQLCODE = +100                                  02961400
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02961500
028971             WHEN OTHER                                           02961600
028915                 DISPLAY '** '                                    02961700
028916                         PC-PGM-NAME                              02961800
028917                         ' - INTR UPC ID: '                       02961900
028918                         PV-DISPLAY-INTERNAL                      02962000
028924                 MOVE '2200-GET-SHIP-SRVC-DESC'                   02962200
028924                                             TO PV-PARAGRAPH-NAME 02962300
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02962400
028926                 PERFORM 9998-SQL-ERROR                           02962500
028982         END-EVALUATE                                             02962600
028983     END-PERFORM.                                                 02962700
028984                                                                  02962800
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02962900
028915         DISPLAY '** '                                            02963000
028916                 PC-PGM-NAME                                      02963100
028917                 ' - INTR UPC ID: '                               02963200
028918                 PV-DISPLAY-INTERNAL                              02963300
028924         MOVE '2200-GET-SHIP-SRVC-DESC'                           02963500
028924                                     TO PV-PARAGRAPH-NAME         02963600
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02963700
028926         PERFORM 9998-SQL-ERROR                                   02963800
028995     END-IF.                                                      02963900
028996                                                                  02964000
028942*-----------------------------------------------------------------02964100
028943* GET THE ECOMM SHIPPING PACKAGE GROUP DESC USING THE TWEBITM     02964200
028943* SHIP-GP-SEQ-NBR.                                                02964300
028945*-----------------------------------------------------------------02964400
       2300-GET-SHIP-GP-DESC.                                           02964500
028947                                                                  02964600
028948     INITIALIZE DCLTVSCHVL.                                       02964700
028949                                                                  02964800
028950     PERFORM WITH TEST AFTER                                      02964900
028951         VARYING PV-RETRY-COUNT FROM 1 BY 1                       02965000
028952           UNTIL SQLCODE = +0                                     02965100
028953              OR SQLCODE = +100                                   02965200
028954              OR PV-RETRY-COUNT > PC-MAX-RETRIES                  02965300
028955         EXEC SQL                                                 02965400
028956             SELECT CHARTC_VAL_DESC                               02965500
028957               INTO :VSCHVL-CHARTC-VAL-DESC                       02965600
028958               FROM TVSCHVL                                       02965700
028959              WHERE CHARTC_CDE     = 18                           02965800
028960                AND CHARTC_SEQ_NBR = :WEBITM-SHIP-GP-SEQ-NBR      02965900
                    WITH UR                                             02966000
028961         END-EXEC                                                 02966100
028962                                                                  02966200
028963         EVALUATE TRUE                                            02966300
028964             WHEN SQLCODE = -904                                  02966400
028965             WHEN SQLCODE = -913                                  02966500
028966                 CONTINUE                                         02966600
028967             WHEN SQLCODE = ZERO                                  02966700
028968                 CONTINUE                                         02966800
028969             WHEN SQLCODE = +100                                  02966900
028970                 MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC            02967000
028971             WHEN OTHER                                           02967100
028915                 DISPLAY '** '                                    02967200
028916                         PC-PGM-NAME                              02967300
028917                         ' - INTR UPC ID: '                       02967400
028918                         PV-DISPLAY-INTERNAL                      02967500
028924                 MOVE '2300-GET-SHIP-GP-DESC'                     02967700
028924                                             TO PV-PARAGRAPH-NAME 02967800
028925                 MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION  02967900
028926                 PERFORM 9998-SQL-ERROR                           02968000
028982         END-EVALUATE                                             02968100
028983     END-PERFORM.                                                 02968200
028984                                                                  02968300
028985     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02968400
028915         DISPLAY '** '                                            02968500
028916                 PC-PGM-NAME                                      02968600
028917                 ' - INTR UPC ID: '                               02968700
028918                 PV-DISPLAY-INTERNAL                              02968800
028924         MOVE '2300-GET-SHIP-GP-DESC'                             02969000
028924                                     TO PV-PARAGRAPH-NAME         02969100
028925         MOVE 'SELECT FROM TVSCHVL'  TO PV-DB2-OPERATION          02969200
028926         PERFORM 9998-SQL-ERROR                                   02969300
028995     END-IF.                                                      02969400
028996                                                                  02969500
W36546*-----------------------------------------------------------------02969600
W36546* TO GET THE DESCRIPTION FOR TEST PRODUCT TYPE SEQUENCE NUMBER    02969700
W36546*-----------------------------------------------------------------02969800
W36546 2400-GET-TST-PRD-TYP-DESC.                                       02969900
W36546                                                                  02970000
W36546     INITIALIZE DCLTVSCHVL.                                       02970100
W36546                                                                  02970200
W36546     PERFORM WITH TEST AFTER                                      02970300
W36546             VARYING PV-RETRY-COUNT FROM 1 BY 1                   02970400
W36546               UNTIL SQLCODE = +0                                 02970500
W36546                  OR SQLCODE = +100                               02970600
W36546                  OR PV-RETRY-COUNT > PC-MAX-RETRIES              02970700
W36546          EXEC SQL                                                02970800
W36546               SELECT CHARTC_VAL_DESC                             02970900
W36546               INTO :VSCHVL-CHARTC-VAL-DESC                       02971000
W36546               FROM TVSCHVL                                       02971100
W36546               WHERE CHARTC_CDE     = 34                          02971200
W36546               AND CHARTC_SEQ_NBR = :IM052-TST-PRD-TYP-SEQ-NBR    02971300
W36546                  WITH UR                                         02971400
W36546             END-EXEC                                             02971500
W36546     EVALUATE TRUE                                                02971700
W36546          WHEN SQLCODE = -904                                     02971800
W36546          WHEN SQLCODE = -913                                     02971900
W36546               CONTINUE                                           02972000
W36546          WHEN SQLCODE = ZERO                                     02972100
W36546               CONTINUE                                           02972200
W36546          WHEN SQLCODE = +100                                     02972300
W36546               MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC              02972400
W36546          WHEN OTHER                                              02972500
W36546               DISPLAY '** '                                      02972600
W36546                       PC-PGM-NAME                                02972700
W36546                       ' - INTR UPC ID: '                         02972800
W36546                       PV-DISPLAY-INTERNAL                        02972900
W36546               MOVE '2400-GET-TST-PRD-TYP-DESC'                   02973000
W36546                           TO PV-PARAGRAPH-NAME                   02973100
W36546               MOVE 'SELECT FROM TVSCHVL'                         02973200
W36546                           TO PV-DB2-OPERATION                    02973300
W36546               PERFORM 9998-SQL-ERROR                             02973400
W36546      END-EVALUATE                                                02973500
W36546     END-PERFORM.                                                 02973600
W36546                                                                  02973700
W36546     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          02973800
W36546          DISPLAY '** '                                           02973900
W36546                  PC-PGM-NAME                                     02974000
W36546                  ' - INTR UPC ID: '                              02974100
W36546                  PV-DISPLAY-INTERNAL                             02974200
W36546          MOVE '2400-GET-TST-PRD-TYP-DESC' TO PV-PARAGRAPH-NAME   02974300
W36546          MOVE 'SELECT FROM TVSCHVL'       TO PV-DB2-OPERATION    02974400
W36546          PERFORM 9998-SQL-ERROR                                  02974500
W36546      END-IF.                                                     02974600
W36546                                                                  02974700
029052*-----------------------------------------------------------------02974800
029060* READ THE TSKXREF/TMDARVS/TUPC UNLOAD INPUT FILE.                02974900
029100*-----------------------------------------------------------------02975000
029200 6000-READ-SKU-UNLOAD-FILE.                                       02975100
029300                                                                  02975200
029310     INITIALIZE IM052-ITEM-SKU-UNLD-REC.                          02975300
029320                                                                  02975400
029400     READ SKU-UNLOAD-IN INTO IM052-ITEM-SKU-UNLD-REC              02975500
029500        AT END                                                    02975600
029600           SET END-OF-INPUT TO TRUE                               02975700
029700        NOT AT END                                                02975800
029800           ADD +1   TO PV-SKU-RECS-READ.                          02975900
029300                                                                  02976000
029052*-----------------------------------------------------------------02976100
029060* READ THE SKU ITEM DOMAIN OUTPUT FILE.                           02976200
030000*-----------------------------------------------------------------02976300
028700 7000-WRITE-SKU-OUTPUT-REC.                                       02976400
030500                                                                  02976500
030600     WRITE SKU-EXTRACT-OUT-REC FROM   IM053-ITEM-SKU-DOMAIN-REC.  02976600
030700                                                                  02976700
030800     ADD +1 TO PV-SKU-RECS-WRITTEN.                               02976800
030900                                                                  02976900
042500                                                                  02977000
042600*-----------------------------------------------------------------02977100
042700* 9000-EOJ-ROUTINE - CLOSES THE FILES ASSOCIATED WITH THE JOB.    02977200
042800*-----------------------------------------------------------------02977300
042900 9000-EOJ.                                                        02977400
043000                                                                  02978000
043100     DISPLAY ' '.                                                 02980000
043200     DISPLAY '============================================='.     02990000
043300     DISPLAY ' '.                                                 03000000
043400     DISPLAY ' ******  IMKUT029 PROCESSING SUMMARY  ******  '.    03010000
043500     PERFORM 9100-DISPLAY-PROCESSING-INFO.                        03020000
043600     DISPLAY '============================================='.     03030000
043700                                                                  03040000
043800                                                                  03050000
043900     CLOSE SKU-UNLOAD-IN                                          03060000
044000           SKU-EXTRACT-OUT.                                       03070000
044200                                                                  03080000
044300*-----------------------------------------------------------------03090000
044400* DISPLAY PROCESSED RECORDS COUNTS                                03100000
044500*-----------------------------------------------------------------03110000
044600 9100-DISPLAY-PROCESSING-INFO.                                    03120000
044700                                                                  03130000
044800     DISPLAY ' '.                                                 03140000
044900     DISPLAY '    SKU RECORDS READ     = '                        03150000
045000           PV-SKU-RECS-READ.                                      03160000
045100     DISPLAY '    SKU RECORDS WRITTEN  = '                        03170000
045200           PV-SKU-RECS-WRITTEN.                                   03180000
045500     DISPLAY ' '.                                                 03190000
045600*-----------------------------------------------------------------03200000
045700* 9800-SQL-ABEND - DISPLAY DB2 ABEND INFO                         03210000
045800*-----------------------------------------------------------------03220000
045900 9998-SQL-ERROR.                                                  03230000
046000                                                                  03240000
046100     SET PS-SQL-ERROR TO TRUE.                                    03250000
046200                                                                  03260000
046300     DISPLAY '** '                                                03270000
046400             PC-PGM-NAME                                          03280000
046500             ' ABEND IN PARAGRAPH '                               03290000
046600             PV-PARAGRAPH-NAME.                                   03300000
046700     DISPLAY '** '                                                03310000
046800             PC-PGM-NAME                                          03320000
046900             ' OPERATION = ' PV-DB2-OPERATION.                    03330000
047000                                                                  03340000
047100*    THE FOLLOWING COPYBOOK UTILIZES MODULE DSNTIAR TO FORMAT     03350000
047200*    THE INFO IN SQLCA INTO UNDERSTANDABLE VERBAGE.               03360000
047300     COPY DPPD004.                                                03370000
047400                                                                  03380000
047500     EXEC SQL                                                     03390000
047600         ROLLBACK                                                 03400000
047700     END-EXEC.                                                    03410000
047800                                                                  03420000
047900     MOVE +4013 TO ABEND-CODE                                     03430000
048000     PERFORM 9999-ABEND.                                          03440000
048100                                                                  03450000
048200*-----------------------------------------------------------------03460000
048300* 9999-ABEND - FORCES PROGRAM ABEND WITH RETURN CODE              03470000
048400*-----------------------------------------------------------------03480000
048500 9999-ABEND.                                                      03490000
048600                                                                  03500000
048700     CALL 'ILBOABN0' USING ABEND-CODE.                            03510000
048800                                                                  03520000
