000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400 PROGRAM-ID.   RCKUT077.                                          00040099
000500 AUTHOR.       JOE LAROSA.                                        00050099
000600 INSTALLATION. KOHLS DEPARTMENT STORES.                           00060099
000700 DATE-WRITTEN. NOV 2003.                                          00070099
000800 DATE-COMPILED.                                                   00080099
000900******************************************************************00090099
001000* THIS BATCH PROGRAM LOADS INPUT FILE1 INTO WS ASSIGNING A RANK   00100099
001100* TO EACH RECORD.  THEN READS INPUT FILE2, ATTEMPTING TO MATCH    00110099
001200* AGAINST FILE1.  IF MATCH YES, RANK USED & OUTPUT WRITTEN.       00120099
001300* IF MATCH NO, 999 USED & OUTPUT WRITTEN.                         00130099
001400******************************************************************00140099
001500 ENVIRONMENT DIVISION.                                            00150099
001600 CONFIGURATION SECTION.                                           00160099
001700 SOURCE-COMPUTER.        IBM-3090.                                00170099
001800 OBJECT-COMPUTER.        IBM-3090.                                00180099
001900 INPUT-OUTPUT SECTION.                                            00190099
002000                                                                  00200099
002100 FILE-CONTROL.                                                    00210099
002200     SELECT INPUT1-FILE ASSIGN TO INP01.                          00220099
002300     SELECT INPUT2-FILE ASSIGN TO INP02.                          00230099
002400     SELECT OUTPUT-FILE ASSIGN TO OUT01.                          00240099
002500******************************************************************00250099
002600 DATA DIVISION.                                                   00260099
002700******************************************************************00270099
002800 FILE SECTION.                                                    00280099
002900                                                                  00290099
003000 FD  INPUT1-FILE                                                  00300099
003100     RECORDING MODE IS F                                          00310099
003200     LABEL RECORDS ARE STANDARD                                   00320099
003300     BLOCK CONTAINS 0 RECORDS.                                    00330099
003400 01  INPUT1-REC                        PIC X(400).                00340099
003500                                                                  00350099
003600 FD  INPUT2-FILE                                                  00360099
003700     RECORDING MODE IS F                                          00370099
003800     LABEL RECORDS ARE STANDARD                                   00380099
003900     BLOCK CONTAINS 0 RECORDS.                                    00390099
004000 01  INPUT2-REC                        PIC X(400).                00400099
004100                                                                  00410099
004200 FD  OUTPUT-FILE                                                  00420099
004300     RECORDING MODE IS F                                          00430099
004400     LABEL RECORDS ARE STANDARD                                   00440099
004500     BLOCK CONTAINS 0 RECORDS.                                    00450099
004600 01  OUTPUT-REC                        PIC X(400).                00460099
004700                                                                  00470099
004800******************************************************************00480099
004900 WORKING-STORAGE SECTION.                                         00490099
005000******************************************************************00500099
005100 01  PS-PROGRAM-SWITCHES.                                         00510099
005200     05  PS-END-OF-INPUT1-SW           PIC X(01) VALUE 'N'.       00520099
005300         88  PS-END-OF-INPUT1-YES                VALUE 'Y'.       00530099
005400         88  PS-END-OF-INPUT1-NO                 VALUE 'N'.       00540099
005500     05  PS-END-OF-INPUT2-SW           PIC X(01) VALUE 'N'.       00550099
005600         88  PS-END-OF-INPUT2-YES                VALUE 'Y'.       00560099
005700         88  PS-END-OF-INPUT2-NO                 VALUE 'N'.       00570099
005800                                                                  00580099
005900 01  PV-PROGRAM-VARIABLES.                                        00590099
006000     05  PV-COUNTER                    PIC S9(5).                 00600099
006100                                                                  00610099
006200 01  PV-HOLD-TABLE.                                               00620099
006300     05  PV-HOLD-ENTRY OCCURS 900 INDEXED BY IDX.                 00630099
006400         10  PV-HOLD-IMPRT-FCTRY-NAME  PIC X(35).                 00640099
006500         10  PV-HOLD-RANK              PIC 999.                   00650099
006600                                                                  00660099
006700 01  PV-RCVR-EXTRACT-RECORD            PIC X(400).                00670099
006800 01  FILLER REDEFINES PV-RCVR-EXTRACT-RECORD.                     00680099
006900     05  PV-RC065-DATA                 PIC X(365).                00690099
007000     05  PV-RC065-RANK                 PIC 999.                   00700099
007100     05  PV-RC065-FILLER               PIC X(32).                 00710099
007200                                                                  00720099
007300******************************************************************00730099
007400* INPUT LAYOUT                                                    00740099
007500******************************************************************00750099
007600     COPY RCRD065.                                                00760099
007700                                                                  00770099
007800/*****************************************************************00780099
007900 PROCEDURE DIVISION.                                              00790099
008000******************************************************************00800099
008100 0000-PROGRAM-MAINLINE.                                           00810099
008200     DISPLAY '**** START OF RCKUT077 ****'.                       00820099
008300     DISPLAY ' '.                                                 00830099
008400                                                                  00840099
008500*OPEN FILES.                                                      00850099
008600     OPEN INPUT  INPUT1-FILE                                      00860099
008700                 INPUT2-FILE.                                     00870099
008800     OPEN OUTPUT OUTPUT-FILE.                                     00880099
008900                                                                  00890099
009000*LOAD INPUT1 RECORDS.                                             00900099
009100     SET IDX TO 1.                                                00910099
009200     MOVE +1 TO PV-COUNTER.                                       00920099
009300     INITIALIZE PV-HOLD-TABLE.                                    00930099
009400                                                                  00940099
009500     SET PS-END-OF-INPUT1-NO TO TRUE.                             00950099
009600     PERFORM 1000-PROCESS-INPUT1                                  00960099
009700       UNTIL PS-END-OF-INPUT1-YES.                                00970099
009800                                                                  00980099
009900*PROCESS INPUT2 RECORDS.                                          00990099
010000     SET PS-END-OF-INPUT2-NO TO TRUE.                             01000099
010100     PERFORM 2000-PROCESS-INPUT2                                  01010099
010200       UNTIL PS-END-OF-INPUT2-YES.                                01020099
010300                                                                  01030099
010400*CLOSE FILES.                                                     01040099
010500     CLOSE INPUT1-FILE                                            01050099
010600           INPUT2-FILE                                            01060099
010700           OUTPUT-FILE.                                           01070099
010800                                                                  01080099
010900     DISPLAY '****  END OF RCKUT077  ****'.                       01090099
011000                                                                  01100099
011100     GOBACK.                                                      01110099
011200                                                                  01120099
011300******************************************************************01130099
011400**  PROCESS INPUT1 FILE                                           01140099
011500******************************************************************01150099
011600 1000-PROCESS-INPUT1.                                             01160099
011700                                                                  01170099
011800     READ INPUT1-FILE INTO RC065-RCVR-EXTRACT-RECORD              01180099
011900       AT END                                                     01190099
012000         SET PS-END-OF-INPUT1-YES TO TRUE                         01200099
012100       NOT AT END                                                 01210099
012200         MOVE RC065-IMPRT-FCTRY-NAME                              01220099
012300           TO PV-HOLD-IMPRT-FCTRY-NAME (IDX)                      01230099
012400         MOVE PV-COUNTER TO PV-HOLD-RANK (IDX)                    01240099
012500         DISPLAY ' FILE1  = ' RC065-IMPRT-FCTRY-NAME ' '          01250099
012600                              PV-HOLD-RANK (IDX)                  01260099
012700         SET IDX UP BY 1                                          01270099
012800                                                                  01280099
012900         ADD +1 TO PV-COUNTER                                     01290099
013000         IF PV-COUNTER > 900                                      01300099
013100             SET PS-END-OF-INPUT1-YES TO TRUE                     01310099
013200         END-IF.                                                  01320099
013300                                                                  01330099
013400******************************************************************01340099
013500**  PROCESS INPUT2 FILE                                           01350099
013600******************************************************************01360099
013700 2000-PROCESS-INPUT2.                                             01370099
013800                                                                  01380099
013900     PERFORM 2100-READ-INPUT2.                                    01390099
014000                                                                  01400099
014100     IF NOT PS-END-OF-INPUT2-YES                                  01410099
014200         MOVE RC065-RCVR-EXTRACT-RECORD                           01420099
014300           TO PV-RCVR-EXTRACT-RECORD                              01430099
014400         PERFORM 2200-SEARCH-MATCH                                01440099
014500         WRITE OUTPUT-REC FROM PV-RCVR-EXTRACT-RECORD             01450099
014600     END-IF.                                                      01460099
014700                                                                  01470099
014800******************************************************************01480099
014900**  READ INPUT2 FILE                                              01490099
015000******************************************************************01500099
015100 2100-READ-INPUT2.                                                01510099
015200                                                                  01520099
015300     READ INPUT2-FILE INTO RC065-RCVR-EXTRACT-RECORD              01530099
015400       AT END                                                     01540099
015500         SET PS-END-OF-INPUT2-YES TO TRUE.                        01550099
015600                                                                  01560099
015700******************************************************************01570099
015800 2200-SEARCH-MATCH.                                               01580099
015900                                                                  01590099
016000     SET IDX TO 1.                                                01600099
016100     SEARCH PV-HOLD-ENTRY                                         01610099
016200       AT END                                                     01620099
016300         MOVE 999              TO PV-RC065-RANK                   01630099
016400       WHEN PV-HOLD-IMPRT-FCTRY-NAME (IDX)                        01640099
016500            = RC065-IMPRT-FCTRY-NAME                              01650099
016600         MOVE PV-HOLD-RANK (IDX) TO PV-RC065-RANK                 01660099
016700     END-SEARCH.                                                  01670099
016800                                                                  01680099
