00001 *                                                                 08/22/94
00002 *                                                                 MBKCS110
00003 *                                                                    LV003
00004  IDENTIFICATION DIVISION.                                         MBKCS110
00005                                                                   MBKCS110
00006  PROGRAM-ID.    MBKCS110.                                         MBKCS110
00007  AUTHOR.        MICHELLE WEBB.                                    MBKCS110
00008  INSTALLATION.  KOHLS DEPARTMENT STORES.                          MBKCS110
00009  DATE-WRITTEN.  10-14-91.                                         MBKCS110
00010  DATE-COMPILED.                                                   MBKCS110
00011                                                                   MBKCS110
00012 ***************************************************************** MBKCS110
C14666*----------------------------------------------------------------*        
C14666*    07/10/12   CRQ000000014666         RAVIKUMAR GUNTHA         *        
C14666*    - RECOMPILED THE PROGRAM DUE TO A CHANGE IN MBWS104         *        
C14666*----------------------------------------------------------------*        
00013 *                                                                 MBKCS110
00014 *                                                                 MBKCS110
00015 ***************************************************************** MBKCS110
00016                                                                   MBKCS110
00017 *                                                                 MBKCS110
00018 *                                                                 MBKCS110
00019 *                                                                 MBKCS110
00020  ENVIRONMENT DIVISION.                                            MBKCS110
00021 *                                                                 MBKCS110
00022 *                                                                 MBKCS110
00023 *                                                                 MBKCS110
00024  DATA DIVISION.                                                   MBKCS110
00025 *                                                                 MBKCS110
00026 *                                                                 MBKCS110
00027  WORKING-STORAGE SECTION.                                         MBKCS110
00028                                                                   MBKCS110
00029  01  PC-PROGRAM-CONSTANTS.                                        MBKCS110
00030      05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.MBKCS110
00031      05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  MBKCS110
00032                                                      COMP SYNC.   MBKCS110
00033      05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        MBKCS110
00034      'MB110A  '.                                                  MBKCS110
00035      05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        MBKCS110
00036      'MBKM110 '.                                                  MBKCS110
00037      05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        MBKCS110
00038      'MBKCS110'.                                                  MBKCS110
00039      05  PC-TSQ-ADD-LENGTH              PIC S9(04)   VALUE 0      MBKCS110
00040                                                      COMP SYNC.   MBKCS110
00041      05  PC-TSQ-MAINT-LENGTH            PIC S9(04)   VALUE 0      MBKCS110
00042                                                      COMP SYNC.   MBKCS110
00043      05  PC-CENTURY-CUTOFF              PIC 9(02)    VALUE 80.    MBKCS110
00044      05  PC-GMA-LEVEL-CD                PIC X(03)    VALUE 'GMA'. MBKCS110
00045      05  PC-DMA-LEVEL-CD                PIC X(03)    VALUE 'DMA'. MBKCS110
00046      05  PC-DEPT-LEVEL-CD               PIC X(03)    VALUE 'DPT'. MBKCS110
00047      05  PC-MCL-LEVEL-CD                PIC X(03)    VALUE 'MCL'. MBKCS110
00048      05  PC-SCL-LEVEL-CD                PIC X(03)    VALUE 'SCL'. MBKCS110
00049      05  PC-MAX-RETRIES                 PIC S9(3)    VALUE +3.    MBKCS110
00050      05  PC-TSYMSG-00000                PIC 9(05)    VALUE 00000. MBKCS110
00051      05  PC-TSYMSG-00005                PIC 9(05)    VALUE 00005. MBKCS110
00052      05  PC-TSYMSG-00007                PIC 9(05)    VALUE 00007. MBKCS110
00053      05  PC-TSYMSG-00008                PIC 9(05)    VALUE 00008. MBKCS110
00054      05  PC-TSYMSG-00045                PIC 9(05)    VALUE 00045. MBKCS110
00055      05  PC-TSYMSG-00046                PIC 9(05)    VALUE 00046. MBKCS110
00056      05  PC-TSYMSG-00059                PIC 9(05)    VALUE 00059. MBKCS110
00057      05  PC-TSYMSG-00070                PIC 9(05)    VALUE 00070. MBKCS110
00058      05  PC-TSYMSG-00122                PIC 9(05)    VALUE 00122. MBKCS110
00059      05  PC-TSYMSG-00150                PIC 9(05)    VALUE 00150. MBKCS110
00060      05  PC-TSYMSG-00151                PIC 9(05)    VALUE 00151. MBKCS110
00061      05  PC-TSYMSG-00152                PIC 9(05)    VALUE 00152. MBKCS110
00062      05  PC-TSYMSG-00153                PIC 9(05)    VALUE 00153. MBKCS110
00063      05  PC-TSYMSG-99901                PIC 9(05)    VALUE 99901. MBKCS110
00064                                                                   MBKCS110
00065  01  PS-PROGRAM-SWITCHES.                                         MBKCS110
00066      05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   MBKCS110
00067          88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   MBKCS110
00068          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   MBKCS110
00069          88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   MBKCS110
00070          88  PS-SEND-DATA-ONLY                       VALUE '4'.   MBKCS110
00071          88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   MBKCS110
00072          88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   MBKCS110
00073      05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   MBKCS110
00074          88  PS-ERROR                                VALUE 'Y'.   MBKCS110
00075          88  PS-NO-ERROR                             VALUE 'N'.   MBKCS110
00076      05  PS-INTER-APPL-SW               PIC X(01)    VALUE 'N'.   MBKCS110
00077          88  PS-INTER-APPL-VALID                     VALUE 'Y'.   MBKCS110
00078          88  PS-INTER-APPL-INVALID                   VALUE 'N'.   MBKCS110
00079      05  PS-QUEUE-STATUS                PIC X(01)    VALUE 'Y'.   MBKCS110
00080          88  PS-FULL-QUEUE                           VALUE 'Y'.   MBKCS110
00081          88  PS-EMPTY-QUEUE                          VALUE 'N'.   MBKCS110
00082      05  PS-ROW-FOUND-SW                PIC X(01)    VALUE 'Y'.   MBKCS110
00083          88  PS-ROW-FOUND                            VALUE 'Y'.   MBKCS110
00084          88  PS-ROW-NOT-FOUND                        VALUE 'N'.   MBKCS110
00085                                                                   MBKCS110
00086  01  PV-PROGRAM-VARIABLES.                                        MBKCS110
00087      05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     MBKCS110
00088                                                      COMP SYNC.   MBKCS110
00089      05  PV-MSG-NUMBER-X                PIC X(05)    VALUE SPACES.MBKCS110
00090                                                                   MBKCS110
00091                                                                   MBKCS110
00092      05  PV-TSQ-TEMP-LAYOUT             PIC X(2007).              MBKCS110
00093      05  FILLER REDEFINES PV-TSQ-TEMP-LAYOUT.                     MBKCS110
00094          10  PV-SCL-ADD-QUEUE           PIC X(229).               MBKCS110
00095          10  FILLER                     PIC X(1778).              MBKCS110
00096                                                                   MBKCS110
00097                                                                   MBKCS110
00098      05  PV-RETRY-COUNTER               PIC S9(3)    VALUE 0.     MBKCS110
00099      05  PV-CHANGE-DATE.                                          MBKCS110
00100          10  PV-CHANGE-CENT             PIC 9(02)    VALUE 0.     MBKCS110
00101          10  PV-CHANGE-YY               PIC 9(02)    VALUE 0.     MBKCS110
00102          10  PV-DASH1                   PIC X        VALUE '-'.   MBKCS110
00103          10  PV-CHANGE-MM               PIC 9(02)    VALUE 0.     MBKCS110
00104          10  PV-DASH2                   PIC X        VALUE '-'.   MBKCS110
00105          10  PV-CHANGE-DD               PIC 9(02)    VALUE 0.     MBKCS110
00106  EJECT                                                            MBKCS110
00107                                                                   MBKCS110
00108  01  DK-DATA-KEYS.                                                MBKCS110
00109      05  DK-OPERCO-NBR                  PIC X(02)    VALUE SPACES.MBKCS110
00110      05  DK-GMA-NBR                     PIC X(02)    VALUE SPACES.MBKCS110
00111      05  DK-DMA-NBR                     PIC X(02)    VALUE SPACES.MBKCS110
00112      05  DK-DEPT-NBR                    PIC X(03)    VALUE SPACES.MBKCS110
00113      05  DK-MAJ-CL-NBR                  PIC X(02)    VALUE SPACES.MBKCS110
00114      05  DK-SUB-CL-NBR                  PIC X(03)    VALUE SPACES.MBKCS110
00115      05  DK-END-DATE                    PIC X(10)    VALUE SPACES.MBKCS110
00116      05  DK-MDSELV-CDE                  PIC X(03)    VALUE SPACES.MBKCS110
00117      05  DK-MDSEBG-NBR                  PIC X(03)    VALUE SPACES.MBKCS110
00118      05  DK-DPTDIS-CDE                  PIC X(03)    VALUE SPACES.MBKCS110
00119      05  DK-MDSEAR-DKEY                 PIC S9(06)V   COMP-3      MBKCS110
00120                                                      VALUE 0.     MBKCS110
00121                                                                   MBKCS110
00122 ***************************************************************** MBKCS110
00123 *    STANDARD COMMAREA.                                           MBKCS110
00124 ***************************************************************** MBKCS110
00125                                                                   MBKCS110
00126      COPY DPWS020.                                                MBKCS110
00127      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                MBKCS110
00128                                                                   MBKCS110
00129 ***************************************************************** MBKCS110
00130 *    INTER-APPLICATION COMMAREA.                                  MBKCS110
00131 ***************************************************************** MBKCS110
00132                                                                   MBKCS110
00133          10  INTER-APPL-COMM-AREA       PIC X(200).               MBKCS110
00134      COPY MBWS005.                                                MBKCS110
00135                                                                   MBKCS110
00136 ***************************************************************** MBKCS110
00137 *    APPLICATION SPECIFIC COMMAREA FOR MBKCS110 - 2865 BYTES      MBKCS110
00138 ***************************************************************** MBKCS110
00139          10  ASC-APPL-SPEC-COMMAREA.                              MBKCS110
00140              15 ASC-WHERE-FROM                  PIC X.            MBKCS110
00141                 88  ASC-SCL-MAINT                     VALUE 'M'.  MBKCS110
00142                 88  ASC-SCL-ADD                       VALUE 'A'.  MBKCS110
00143              15 ASC-TSQ-ITEM-NBR                PIC S9(04)        MBKCS110
00144                                                     COMP SYNC.    MBKCS110
00145              15 ASC-COMPANY-NO                  PIC X(2).         MBKCS110
00146              15 ASC-GMA-NO                      PIC X(2).         MBKCS110
00147              15 ASC-GMA-DESC                    PIC X(25).        MBKCS110
00148              15 ASC-DMA-NO                      PIC X(2).         MBKCS110
00149              15 ASC-DMA-DESC                    PIC X(25).        MBKCS110
00150              15 ASC-DPT-NO                      PIC X(3).         MBKCS110
00151              15 ASC-DPT-DESC                    PIC X(25).        MBKCS110
00152              15 ASC-MCL-NO                      PIC X(2).         MBKCS110
00153              15 ASC-MCL-DESC                    PIC X(25).        MBKCS110
00154              15 ASC-SCL-NO                      PIC X(3).         MBKCS110
00155              15 ASC-SCL-DESC                    PIC X(25).        MBKCS110
00156              15 ASC-MDSEAR-LEVEL                PIC 9(01).        MBKCS110
00157 *                                                                 MBKCS110
00158              15 ASC-ORIGINAL-FIELDS.                              MBKCS110
00159                  20 ASC-ORIG-POS-DESC           PIC X(17).        MBKCS110
00160                  20 ASC-ORIG-TAX-DFLT-IND       PIC X(01).        MBKCS110
00161 *                                                                 MBKCS110
00162              15 ASC-MODIFIABLE-FIELDS.                            MBKCS110
00163                  20 ASC-SCRN-POS-DESC           PIC X(17).        MBKCS110
00164                  20 ASC-SCRN-TAX-DFLT-IND       PIC X(01).        MBKCS110
00165                     88 ASC-SCRN-TAX-DFLT-VALID  VALUE '1',        MBKCS110
00166                                                       '0'.        MBKCS110
00167 *                                                                 MBKCS110
00168              15 ASC-POS-DESC-EDIT-FLAG          PIC X(01).        MBKCS110
00169                 88  ASC-POS-DESC-NEED-EDIT      VALUE 'Y'.        MBKCS110
00170                 88  ASC-POS-DESC-PASS-EDIT      VALUE 'N'.        MBKCS110
00171              15 ASC-TAX-DFLT-EDIT-FLAG          PIC X(01).        MBKCS110
00172                  88 ASC-TAX-DFLT-NEED-EDIT      VALUE 'Y'.        MBKCS110
00173                  88 ASC-TAX-DFLT-PASS-EDIT      VALUE 'N'.        MBKCS110
00174 *                                                                 MBKCS110
00175              15 ASC-TEMP-QUEUE-NAME             PIC X(08).        MBKCS110
00176              15 FILLER REDEFINES ASC-TEMP-QUEUE-NAME.             MBKCS110
00177                  20  ASC-TERM-ID                PIC X(04).        MBKCS110
00178                  20  ASC-TASK-ID                PIC S9(07)        MBKCS110
00179                                                         COMP-3.   MBKCS110
00180              15 ASC-TEMP-QUEUE-LENGTH           PIC S9(4) COMP.   MBKCS110
00181              15 ASC-SEL-IDX                     PIC S9(4) COMP.   MBKCS110
00182              15 ASC-MDSEAR-DKEY                 PIC S9(06)V       MBKCS110
00183                                                 COMP-3.           MBKCS110
00184              15 ASC-FREIGHT-PERCENT             PIC SV999         MBKCS110
00185                                                 COMP-3.           MBKCS110
00186              15 ASC-SAVE-SELECTION-TABLE        PIC X(2007).      MBKCS110
00187              15 FILLER REDEFINES ASC-SAVE-SELECTION-TABLE.        MBKCS110
00188                  20 FILLER                      PIC X(03).        MBKCS110
00189                  20 ASC-MAX-ITEMS               PIC 9(03).        MBKCS110
00190                  20 FILLER                      PIC X(01).        MBKCS110
00191                  20 ASC-ITEM-ARRAY OCCURS 100 TIMES.              MBKCS110
00192                      25  ASC-ITEM               PIC S9(09)        MBKCS110
00193                                                 COMP-3.           MBKCS110
00194                      25  ASC-KEY-DATA.                            MBKCS110
00195                          30  ASC-GMA-NBR        PIC X(02).        MBKCS110
00196                          30  ASC-DMA-NBR        PIC X(02).        MBKCS110
00197                          30  ASC-DPT-NBR        PIC X(03).        MBKCS110
00198                          30  ASC-MCL-NBR        PIC X(02).        MBKCS110
00199                          30  ASC-SCL-NBR        PIC X(03).        MBKCS110
00200                          30  ASC-MDSELV-CDE     PIC X(03).        MBKCS110
00201              15  FILLER                         PIC X(600).       MBKCS110
00202                                                                   MBKCS110
00203                                                                   MBKCS110
00204 ***************************************************************** MBKCS110
00205 *    WORK AREA FOR UPDATES.                                       MBKCS110
00206 ***************************************************************** MBKCS110
00207  01  MB003-RECORD-AREA.                                           MBKCS110
00208      COPY MBWS003.                                                MBKCS110
00209                                                                   MBKCS110
00210 ***************************************************************** MBKCS110
00211 *    ABEND PROCESSING COPYBOOK.                                   MBKCS110
00212 ***************************************************************** MBKCS110
00213                                                                   MBKCS110
00214      COPY DPWS013.                                                MBKCS110
00215                                                                   MBKCS110
00216 ***************************************************************** MBKCS110
00217 *    ATTRIBUTE SETTINGS COPYBOOK.                                 MBKCS110
00218 ***************************************************************** MBKCS110
00219                                                                   MBKCS110
00220      COPY DPWS015.                                                MBKCS110
00221                                                                   MBKCS110
00222 *****************************************************************    CL**2
00223 *    MESSAGE FORMAT COPYBOOK.                                        CL**2
00224 *****************************************************************    CL**2
00225                                                                      CL**2
00226      COPY DPWS006.                                                   CL**2
00227                                                                      CL**2
00228 ***************************************************************** MBKCS110
00229 *    CURRENT DATE AND TIME COPYBOOK.                              MBKCS110
00230 ***************************************************************** MBKCS110
00231                                                                   MBKCS110
00232      COPY DPWS017.                                                MBKCS110
00233                                                                   MBKCS110
00234 ***************************************************************** MBKCS110
00235 *    TOGGLE FUNCTION KEY LINES COPYBOOK.                          MBKCS110
00236 ***************************************************************** MBKCS110
00237                                                                   MBKCS110
00238      COPY DPWS009.                                                MBKCS110
00239                                                                   MBKCS110
00240 ***************************************************************** MBKCS110
00241 *    FUNCTION KEYS COPYBOOK.                                      MBKCS110
00242 ***************************************************************** MBKCS110
00243                                                                   MBKCS110
00244      COPY DPWS016.                                                MBKCS110
00245                                                                   MBKCS110
00246 ***************************************************************** MBKCS110
00247 *    NUMERIC EDIT ROUTINE                                         MBKCS110
00248 ***************************************************************** MBKCS110
00249                                                                   MBKCS110
00250      COPY DPWS010I.                                               MBKCS110
00251                                                                   MBKCS110
00252 ***************************************************************** MBKCS110
00253 *    MERCHANDISE AREA ADD TEMPORARY STORAGE QUEUE                 MBKCS110
00254 ***************************************************************** MBKCS110
00255                                                                   MBKCS110
00256      COPY MBWS104.                                                   CL**3
00257                                                                   MBKCS110
00258 ***************************************************************** MBKCS110
00259 *    DPKUT045 COPYBOOK.                                           MBKCS110
00260 *                                                                 MBKCS110
00261 *    DATA AREA NECESSARY TO INTERACT WITH SUB-ROUTINE DPKUT045    MBKCS110
00262 *                                                                 MBKCS110
00263 *    DPKUT045 IS A UTILITY ROUTINE THAT CONVERTS THE EIBAID       MBKCS110
00264 *    CHARACTER RECEIVED FROM THE TERMINAL INTO A INTEGER VALUE    MBKCS110
00265 *    FROM 1 TO 29. THIS INTEGER VALUE IS STORED IN DP020-SRC-AID  MBKCS110
00266 *    AND IS USED TO INTERROGATE THE DP020-FUNCTION-KEY-ARRAY      MBKCS110
00267 *    TABLE IN THE STANDARD COMMAREA TO DETERMINE WHAT TO DO NEXT. MBKCS110
00268 *    IN ADDITION DPKUT045 WILL PARSE THE SCREEN INPUT COMMAND     MBKCS110
00269 *    FIELD AND CONVERT RECOGNIZED SCREEN MANIPULATION COMMANDS    MBKCS110
00270 *    INTO THE DP020-SRC-AID EQUIVALENT.                           MBKCS110
00271 ***************************************************************** MBKCS110
00272                                                                   MBKCS110
00273      COPY DPWS045.                                                MBKCS110
00274                                                                   MBKCS110
00275 ***************************************************************** MBKCS110
00276 *    SYSTEM MESSAGES RECORD LAYOUT                                MBKCS110
00277 ***************************************************************** MBKCS110
00278                                                                   MBKCS110
00279      COPY DPRD507I.                                               MBKCS110
00280                                                                   MBKCS110
00281 ***************************************************************** MBKCS110
00282 *    STANDARD ATTENTION IDENTIFIER LIST                           MBKCS110
00283 ***************************************************************** MBKCS110
00284                                                                   MBKCS110
00285      COPY DFHAID.                                                 MBKCS110
00286                                                                   MBKCS110
00287 ***************************************************************** MBKCS110
00288 *    MAP LAYOUT                                                   MBKCS110
00289 ***************************************************************** MBKCS110
00290                                                                   MBKCS110
00291      COPY MBKM110.                                                MBKCS110
00292                                                                   MBKCS110
00293  01  MD-MAP-DATA-AREA REDEFINES MB110AO.                          MBKCS110
00294 ***************************************************************** MBKCS110
00295 *    FOR THE UTILITIES THAT RECEIVE AND SEND THE MAP TO THE       MBKCS110
00296 *    TERMINAL TO FUNCTION CORRECTLY, CHANGE THE PIC CLAUSE OF     MBKCS110
00297 *    THE FOLLOWING FILLER STATEMENT TO BE EQUAL TO THE TOTAL      MBKCS110
00298 *    LENGTH OF THE MAP COPYBOOK.                                  MBKCS110
00299 ***************************************************************** MBKCS110
00300      05  FILLER                         PIC X(611).               MBKCS110
00301  EJECT                                                            MBKCS110
00302 ***************************************************************** MBKCS110
00303 *    MERCHANDISE AREA DB2 TABLE DEFINITION                        MBKCS110
00304 ***************************************************************** MBKCS110
00305                                                                   MBKCS110
00306      EXEC SQL                                                     MBKCS110
00307          INCLUDE TMDSEAR                                          MBKCS110
00308      END-EXEC.                                                    MBKCS110
00309 ***************************************************************** MBKCS110
00310 *    MERCHANDISE CLASS      DB2 TABLE DEFINITION                  MBKCS110
00311 ***************************************************************** MBKCS110
00312                                                                   MBKCS110
00313      EXEC SQL                                                     MBKCS110
00314          INCLUDE TMDSECL                                          MBKCS110
00315      END-EXEC.                                                    MBKCS110
00316 ***************************************************************** MBKCS110
00317 *    DB2 COMMUNICATION AREA                                       MBKCS110
00318 ***************************************************************** MBKCS110
00319                                                                   MBKCS110
00320      EXEC SQL                                                     MBKCS110
00321          INCLUDE SQLCA                                            MBKCS110
00322      END-EXEC.                                                    MBKCS110
00323                                                                   MBKCS110
00324                                                                   MBKCS110
00325  LINKAGE SECTION.                                                 MBKCS110
00326                                                                   MBKCS110
00327  01  DFHCOMMAREA.                                                 MBKCS110
00328      05  FILLER                       OCCURS 1 TO 4072 TIMES      MBKCS110
00329                                       DEPENDING ON EIBCALEN.      MBKCS110
00330          10  FILLER                   PIC X.                      MBKCS110
00331  EJECT                                                            MBKCS110
00332 *                                                                 MBKCS110
00333 *                                                                 MBKCS110
00334 *                                                                 MBKCS110
00335  PROCEDURE DIVISION.                                              MBKCS110
00336                                                                   MBKCS110
00337                                                                   MBKCS110
00338                                                                   MBKCS110
00339                                                                   MBKCS110
00340  0000-MAIN-MODULE.                                                MBKCS110
00341                                                                   MBKCS110
00342 ******************************************************************MBKCS110
00343 *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           MBKCS110
00344 *                                                                 MBKCS110
00345 ************* DO NOT ALTER THIS PARAGRAPH ************************MBKCS110
00346 *                                                                 MBKCS110
00347 ******************************************************************MBKCS110
00348                                                                   MBKCS110
00349      PERFORM DP015-0000-CHECK-COMMAREA.                           MBKCS110
00350                                                                   MBKCS110
00351 ******************************************************************MBKCS110
00352 *    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS  MBKCS110
00353 *    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER     MBKCS110
00354 *    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS      MBKCS110
00355 *    PROGRAM WILL RETURN TO CICS.                                 MBKCS110
00356 ******************************************************************MBKCS110
00357      IF DP020-SRC-RETURN-W-TRAN-ID                                MBKCS110
00358          PERFORM 1000-CONTROL-PROCESSING                          MBKCS110
00359      END-IF.                                                      MBKCS110
00360                                                                   MBKCS110
00361      PERFORM DP003-0000-RETURN-TO-CICS.                           MBKCS110
00362  EJECT                                                            MBKCS110
00363  1000-CONTROL-PROCESSING.                                         MBKCS110
00364                                                                   MBKCS110
00365 ******************************************************************MBKCS110
00366 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    MBKCS110
00367 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                    MBKCS110
00368 *                                                                 MBKCS110
00369 *                                                                 MBKCS110
00370 ************* DO NOT ALTER THIS PARAGRAPH ************************MBKCS110
00371 *                                                                 MBKCS110
00372 ******************************************************************MBKCS110
00373                                                                   MBKCS110
00374      EVALUATE TRUE                                                MBKCS110
00375                                                                   MBKCS110
00376          WHEN DP020-NEXT-ACT-INITIAL                              MBKCS110
00377              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 MBKCS110
00378                                                                   MBKCS110
00379              PERFORM 1100-INITIALIZE-COMMAREA                     MBKCS110
00380              MOVE LENGTH OF MB104-MDSEAR-ADD-TSQUEUE              MBKCS110
00381                                TO  ASC-TEMP-QUEUE-LENGTH          MBKCS110
00382                                    MB005-LIST-QUEUE-LENGTH        MBKCS110
00383              PERFORM 4100-SAVE-INITIAL-INTERAPPL                  MBKCS110
00384              IF PS-INTER-APPL-VALID                               MBKCS110
00385                 PERFORM 1500-DETERMINE-AND-READ-TSQ               MBKCS110
00386                 PERFORM 2000-BUILD-INITIAL-PANEL                  MBKCS110
00387                 PERFORM 2200-DISPLAY-PANEL                        MBKCS110
00388              ELSE                                                 MBKCS110
00389                 PERFORM 9100-RETURN-TO-PREV-TRAN                  MBKCS110
00390              END-IF                                               MBKCS110
00391                                                                   MBKCS110
00392          WHEN DP020-NEXT-ACT-READ-MAP                             MBKCS110
00393              PERFORM 3000-PROCESS-MAP                             MBKCS110
00394                                                                   MBKCS110
00395          WHEN DP020-NEXT-ACT-RETURN                               MBKCS110
00396              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 MBKCS110
00397                                                                   MBKCS110
00398              PERFORM 4200-UPDATE-INITIAL-INTERAPPL                MBKCS110
00399              PERFORM 3300-EDIT-DATA-IN-COMMAREA                   MBKCS110
00400              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00401                                                                   MBKCS110
00402          WHEN DP020-NEXT-ACT-ERROR                                MBKCS110
00403                                                                   MBKCS110
00404              MOVE DP020-MSG-NUMBER-X  TO PV-MSG-NUMBER-X          MBKCS110
00405                                                                   MBKCS110
00406              IF DP020-NAV-MNEMONIC = SPACES                       MBKCS110
00407                  MOVE SPACES          TO ANAVCMDO                 MBKCS110
00408                  MOVE DP015-GREEN     TO ANAVCMDC                 MBKCS110
00409                  MOVE DP015-UNDERLINE TO ANAVCMDH                 MBKCS110
00410              ELSE                                                 MBKCS110
00411                  MOVE DP015-RED       TO ANAVCMDC                 MBKCS110
00412                  MOVE DP015-REVERSE   TO ANAVCMDH                 MBKCS110
00413              END-IF                                               MBKCS110
00414                                                                   MBKCS110
00415              MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        MBKCS110
00416                                                                   MBKCS110
00417              PERFORM 3300-EDIT-DATA-IN-COMMAREA                   MBKCS110
00418                                                                   MBKCS110
00419              SET PS-ERROR                TO TRUE                  MBKCS110
00420              SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  MBKCS110
00421                                                                   MBKCS110
00422              MOVE PV-MSG-NUMBER-X     TO DP020-MSG-NUMBER-X       MBKCS110
00423 ******************************************************************MBKCS110
00424 *    END OF CODE BLOCK DESIGNED TO SAVE MESSAGE FROM DPKCS008     MBKCS110
00425 ******************************************************************MBKCS110
00426              MOVE -1         TO ANAVCMDL                          MBKCS110
00427                                                                   MBKCS110
00428              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00429                                                                   MBKCS110
00430          WHEN OTHER                                               MBKCS110
00431              SET DP013-LOGIC-ABEND TO TRUE                        MBKCS110
00432              SET DP013-NO-ROLLBACK TO TRUE                        MBKCS110
00433                                                                   MBKCS110
00434              MOVE 'B100-CONTROL-PROCESSING' TO                    MBKCS110
00435                   DP013-PARAGRAPH                                 MBKCS110
00436              MOVE 'INVALID NEXT ACTION FOR ARCHITECTURE' TO       MBKCS110
00437                      DP013-MESSAGE-TEXT(1)                        MBKCS110
00438                                                                   MBKCS110
00439              PERFORM DP013-0000-PROCESS-ABEND                     MBKCS110
00440                                                                   MBKCS110
00441      END-EVALUATE.                                                MBKCS110
00442  EJECT                                                            MBKCS110
00443  1100-INITIALIZE-COMMAREA.                                        MBKCS110
00444                                                                   MBKCS110
00445 ******************************************************************MBKCS110
00446 *                                                                 MBKCS110
00447 ******************************************************************MBKCS110
00448       INITIALIZE ASC-APPL-SPEC-COMMAREA.                          MBKCS110
00449                                                                   MBKCS110
00450  EJECT                                                            MBKCS110
00451                                                                   MBKCS110
00452  1500-DETERMINE-AND-READ-TSQ.                                     MBKCS110
00453 ******************************************************************MBKCS110
00454 *                                                                 MBKCS110
00455 ******************************************************************MBKCS110
00456                                                                   MBKCS110
00457      MOVE +1 TO ASC-TSQ-ITEM-NBR.                                 MBKCS110
00458      MOVE 1 TO ASC-SEL-IDX.                                       MBKCS110
00459                                                                   MBKCS110
00460      PERFORM 9050-READ-TSQ.                                       MBKCS110
00461                                                                   MBKCS110
00462      IF ASC-SCL-MAINT                                             MBKCS110
00463                                                                   MBKCS110
00464         MOVE PV-TSQ-TEMP-LAYOUT      TO ASC-SAVE-SELECTION-TABLE  MBKCS110
00465         MOVE ASC-GMA-NBR(ASC-SEL-IDX)  TO ASC-GMA-NO              MBKCS110
00466         MOVE ASC-DMA-NBR(ASC-SEL-IDX)  TO ASC-DMA-NO              MBKCS110
00467         MOVE ASC-DPT-NBR(ASC-SEL-IDX)  TO ASC-DPT-NO              MBKCS110
00468         MOVE ASC-MCL-NBR(ASC-SEL-IDX)  TO ASC-MCL-NO              MBKCS110
00469         MOVE ASC-SCL-NBR(ASC-SEL-IDX)  TO ASC-SCL-NO              MBKCS110
00470                                                                   MBKCS110
00471      ELSE                                                         MBKCS110
00472                                                                   MBKCS110
00473         MOVE PV-SCL-ADD-QUEUE      TO MB104-MDSEAR-ADD-TSQUEUE    MBKCS110
00474         MOVE MB104-CO-NUMBER       TO ASC-COMPANY-NO              MBKCS110
00475         MOVE MB104-GMA-NUMBER      TO ASC-GMA-NO                  MBKCS110
00476         MOVE MB104-GMA-DESCRIP     TO ASC-GMA-DESC                MBKCS110
00477         MOVE MB104-DMA-NUMBER      TO ASC-DMA-NO                  MBKCS110
00478         MOVE MB104-DMA-DESCRIP     TO ASC-DMA-DESC                MBKCS110
00479         MOVE MB104-DEPT-NUMBER     TO ASC-DPT-NO                  MBKCS110
00480         MOVE MB104-DEPT-DESCRIP    TO ASC-DPT-DESC                MBKCS110
00481         MOVE MB104-MCLASS-NUMBER   TO ASC-MCL-NO                  MBKCS110
00482         MOVE MB104-MCLASS-DESCRIP  TO ASC-MCL-DESC                MBKCS110
00483         MOVE MB104-SCLASS-NUMBER   TO ASC-SCL-NO                  MBKCS110
00484         MOVE MB104-SCLASS-DESCRIP  TO ASC-SCL-DESC                MBKCS110
00485         MOVE MB104-MDSE-LEVEL      TO ASC-MDSEAR-LEVEL            MBKCS110
00486         MOVE MB104-FREIGHT-PERCENT TO ASC-FREIGHT-PERCENT         MBKCS110
00487                                                                   MBKCS110
00488      END-IF.                                                      MBKCS110
00489  EJECT                                                            MBKCS110
00490                                                                   MBKCS110
00491                                                                   MBKCS110
00492  1700-RESET-ATTRIBUTES.                                           MBKCS110
00493 ******************************************************************MBKCS110
00494 *                                                                 MBKCS110
00495 ******************************************************************MBKCS110
00496      MOVE DP015-GREEN     TO APDESCC                              MBKCS110
00497                              ATAXDFTC.                            MBKCS110
00498      MOVE DP015-UNDERLINE TO APDESCH                              MBKCS110
00499                              ATAXDFTH.                            MBKCS110
00500                                                                   MBKCS110
00501  2000-BUILD-INITIAL-PANEL.                                        MBKCS110
00502                                                                   MBKCS110
00503 ******************************************************************MBKCS110
00504 *                                                                 MBKCS110
00505 ******************************************************************MBKCS110
00506                                                                   MBKCS110
00507      PERFORM DP017-0000-GET-CURR-DATE-TIME                        MBKCS110
00508      SET DP017-EDITED-YMD-DATE-DASH-1                             MBKCS110
00509          DP017-EDITED-YMD-DATE-DASH-2 TO TRUE                     MBKCS110
00510      MOVE DP017-EDITED-DATE-YYYYMMDD TO  DK-END-DATE              MBKCS110
00511                                                                   MBKCS110
00512      IF ASC-SCL-MAINT                                             MBKCS110
00513                                                                   MBKCS110
00514          MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR                  MBKCS110
00515          MOVE ASC-GMA-NO        TO DK-GMA-NBR                     MBKCS110
00516          MOVE ASC-DMA-NO        TO DK-DMA-NBR                     MBKCS110
00517          MOVE ASC-DPT-NO        TO DK-DEPT-NBR                    MBKCS110
00518          MOVE ASC-MCL-NO        TO DK-MAJ-CL-NBR                  MBKCS110
00519          MOVE ASC-SCL-NO        TO DK-SUB-CL-NBR                  MBKCS110
00520          MOVE PC-SCL-LEVEL-CD   TO DK-MDSELV-CDE                  MBKCS110
00521                                                                   MBKCS110
00522          PERFORM 2100-RETRIEVE-DATA-FOR-PANEL                     MBKCS110
00523          IF PS-ROW-NOT-FOUND                                      MBKCS110
00524              STRING ' GMA ' DK-GMA-NBR                            MBKCS110
00525                     ' DMA ' DK-DMA-NBR                            MBKCS110
00526                     ' DPT ' DK-DEPT-NBR                           MBKCS110
00527                     ' MCL ' DK-MAJ-CL-NBR                         MBKCS110
00528                     ' SCL ' DK-SUB-CL-NBR                         MBKCS110
00529                     ' LEV=' DK-MDSELV-CDE                         MBKCS110
00530                     ' DTE ' DK-END-DATE                           MBKCS110
00531                     DELIMITED BY SIZE                             MBKCS110
00532                     INTO DP013-MESSAGE-TEXT(1)                    MBKCS110
00533              MOVE SQLCA TO DP013-SQLCA                            MBKCS110
00534              MOVE '2000-BUILD-INITIAL-PANEL' TO DP013-PARAGRAPH   MBKCS110
00535              MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)            MBKCS110
00536              MOVE 'TMDSEDP' TO DP013-DB2-TABLE-NAME(2)            MBKCS110
00537              SET DP013-DB2-ABEND TO TRUE                          MBKCS110
00538              SET DP013-NO-ROLLBACK TO TRUE                        MBKCS110
00539              SET DP013-XCTL-DISPLAY-RESTART TO TRUE               MBKCS110
00540              PERFORM DP013-0000-PROCESS-ABEND                     MBKCS110
00541          END-IF                                                   MBKCS110
00542                                                                   MBKCS110
00543                                                                   MBKCS110
00544          MOVE MDSECL-MDSEAR-DKEY    TO ASC-MDSEAR-DKEY            MBKCS110
00545          MOVE MDSECL-POS-DESC       TO ASC-SCRN-POS-DESC          MBKCS110
00546                                        ASC-ORIG-POS-DESC          MBKCS110
00547          MOVE MDSECL-TAX-DFLT-IND   TO ASC-SCRN-TAX-DFLT-IND      MBKCS110
00548                                        ASC-ORIG-TAX-DFLT-IND      MBKCS110
00549                                                                   MBKCS110
00550          PERFORM 2400-GET-MDSEAR-DESCRIPS                         MBKCS110
00551      ELSE                                                         MBKCS110
00552          INITIALIZE ASC-ORIG-POS-DESC                             MBKCS110
00553                     ASC-SCRN-POS-DESC                             MBKCS110
00554                     ASC-ORIG-TAX-DFLT-IND                         MBKCS110
00555                     ASC-SCRN-TAX-DFLT-IND                         MBKCS110
00556      END-IF.                                                      MBKCS110
00557                                                                   MBKCS110
00558  EJECT                                                            MBKCS110
00559                                                                   MBKCS110
00560                                                                   MBKCS110
00561  2100-RETRIEVE-DATA-FOR-PANEL.                                    MBKCS110
00562                                                                   MBKCS110
00563 ******************************************************************MBKCS110
00564 *                                                                 MBKCS110
00565 ******************************************************************MBKCS110
00566                                                                   MBKCS110
00567      PERFORM WITH TEST AFTER                                      MBKCS110
00568          VARYING PV-RETRY-COUNTER                                 MBKCS110
00569          FROM 1 BY 1                                              MBKCS110
00570          UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              MBKCS110
00571                  OR (SQLCODE = 0)                                 MBKCS110
00572                  OR (SQLCODE = +100))                             MBKCS110
00573                                                                   MBKCS110
00574                                                                   MBKCS110
00575          EXEC SQL                                                 MBKCS110
00576              SELECT D.POS_DESC,                                   MBKCS110
00577                     D.TAX_DFLT_IND,                               MBKCS110
00578                     D.MDSEAR_DKEY                                 MBKCS110
00579              INTO :MDSECL-POS-DESC,                               MBKCS110
00580                   :MDSECL-TAX-DFLT-IND,                           MBKCS110
00581                   :MDSECL-MDSEAR-DKEY                             MBKCS110
00582              FROM   TMDSEAR A,                                    MBKCS110
00583                     TMDSECL D                                     MBKCS110
00584              WHERE ((A.OPERCO_NBR    = :DK-OPERCO-NBR) AND        MBKCS110
00585                     (A.GMA_NBR       = :DK-GMA-NBR)    AND        MBKCS110
00586                     (A.DMA_NBR       = :DK-DMA-NBR)    AND        MBKCS110
00587                     (A.DEPT_NBR      = :DK-DEPT-NBR)   AND        MBKCS110
00588                     (A.MAJ_CL_NBR    = :DK-MAJ-CL-NBR) AND        MBKCS110
00589                     (A.SUB_CL_NBR    = :DK-SUB-CL-NBR) AND        MBKCS110
00590                     (A.MDSELV_CDE    = :DK-MDSELV-CDE) AND        MBKCS110
00591                     (A.END_DTE > DATE (CURRENT TIMESTAMP))AND     MBKCS110
00592                     (A.MDSEAR_DKEY = D.MDSEAR_DKEY))              MBKCS110
00593          END-EXEC                                                 MBKCS110
00594                                                                   MBKCS110
00595          EVALUATE TRUE                                            MBKCS110
00596              WHEN SQLCODE = ZERO                                  MBKCS110
00597                  SET PS-ROW-FOUND TO TRUE                         MBKCS110
00598              WHEN SQLCODE = -904                                  MBKCS110
00599              WHEN SQLCODE = -913                                  MBKCS110
00600                   CONTINUE                                        MBKCS110
00601              WHEN SQLCODE = +100                                  MBKCS110
00602                  SET PS-ROW-NOT-FOUND TO TRUE                     MBKCS110
00603              WHEN SQLWARN0 NOT = SPACES                           MBKCS110
00604              WHEN SQLCODE < 0                                     MBKCS110
00605              WHEN SQLCODE > 0                                     MBKCS110
00606                  STRING ' GMA ' DK-GMA-NBR                        MBKCS110
00607                         ' DMA ' DK-DMA-NBR                        MBKCS110
00608                         ' DPT ' DK-DEPT-NBR                       MBKCS110
00609                         ' MCL ' DK-MAJ-CL-NBR                     MBKCS110
00610                         ' SCL ' DK-SUB-CL-NBR                     MBKCS110
00611                         ' LEV=' DK-MDSELV-CDE                     MBKCS110
00612                         ' DTE ' DK-END-DATE                       MBKCS110
00613                         DELIMITED BY SIZE                         MBKCS110
00614                         INTO DP013-MESSAGE-TEXT(1)                MBKCS110
00615                  MOVE SQLCA TO DP013-SQLCA                        MBKCS110
00616                  MOVE '2100-RETREIVE-DATA-FOR-PANEL' TO           MBKCS110
00617                      DP013-PARAGRAPH                              MBKCS110
00618                  MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        MBKCS110
00619                  MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(2)        MBKCS110
00620                  SET DP013-DB2-ABEND TO TRUE                      MBKCS110
00621                  SET DP013-NO-ROLLBACK TO TRUE                    MBKCS110
00622                  SET DP013-XCTL-DISPLAY-RESTART TO TRUE           MBKCS110
00623                  PERFORM DP013-0000-PROCESS-ABEND                 MBKCS110
00624          END-EVALUATE                                             MBKCS110
00625      END-PERFORM.                                                 MBKCS110
00626                                                                   MBKCS110
00627                                                                   MBKCS110
00628      IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         MBKCS110
00629          MOVE '2100-RETRIEVE-DATA-FOR-PANEL' TO                   MBKCS110
00630                                      DP013-PARAGRAPH              MBKCS110
00631          MOVE SQLCA TO DP013-SQLCA                                MBKCS110
00632          STRING ' GMA ' DK-GMA-NBR                                MBKCS110
00633                 ' DMA ' DK-DMA-NBR                                MBKCS110
00634                 ' DPT ' DK-DEPT-NBR                               MBKCS110
00635                 ' MCL ' DK-MAJ-CL-NBR                             MBKCS110
00636                 ' SCL ' DK-SUB-CL-NBR                             MBKCS110
00637                 ' LEV=' DK-MDSELV-CDE                             MBKCS110
00638                 ' DTE ' DK-END-DATE                               MBKCS110
00639                 DELIMITED BY SIZE                                 MBKCS110
00640                 INTO DP013-MESSAGE-TEXT(1)                        MBKCS110
00641          MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 MBKCS110
00642                                      DP013-MESSAGE-TEXT(2)        MBKCS110
00643          MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                MBKCS110
00644          MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(2)                MBKCS110
00645          SET DP013-DB2-ABEND                                      MBKCS110
00646              DP013-NO-ROLLBACK                                    MBKCS110
00647              DP013-XCTL-DISPLAY-RESTART TO TRUE                   MBKCS110
00648          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS110
00649      END-IF.                                                      MBKCS110
00650                                                                   MBKCS110
00651                                                                   MBKCS110
00652  EJECT                                                            MBKCS110
00653                                                                   MBKCS110
00654                                                                   MBKCS110
00655  2200-DISPLAY-PANEL.                                              MBKCS110
00656                                                                   MBKCS110
00657 ******************************************************************MBKCS110
00658 *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       MBKCS110
00659 *                                                                 MBKCS110
00660 ******************************************************************MBKCS110
00661                                                                   MBKCS110
00662      PERFORM DP017-0000-GET-CURR-DATE-TIME.                       MBKCS110
00663                                                                   MBKCS110
00664      PERFORM DP002-0000-FORMAT-TITLE-LINES.                       MBKCS110
00665      PERFORM 3300-MOVE-COMMAREA-TO-SCREEN.                        MBKCS110
00666                                                                   MBKCS110
00667                                                                   MBKCS110
00668      PERFORM DP005-0000-FORMAT-MSG-LINES.                         MBKCS110
00669                                                                   MBKCS110
00670      IF (DP020-SRC-AID = DP016-PA2) OR                            MBKCS110
00671         (PS-SEND-MAP-N-DATA-FRSET)                                MBKCS110
00672          PERFORM DP009-0000-LOAD-FK-LINES                         MBKCS110
00673      END-IF.                                                      MBKCS110
00674                                                                   MBKCS110
00675      IF PS-NO-ERROR                                               MBKCS110
00676         MOVE -1 TO APDESCL                                        MBKCS110
00677      END-IF.                                                      MBKCS110
00678                                                                   MBKCS110
00679      PERFORM DP008-0000-WRITE-PANEL.                              MBKCS110
00680                                                                   MBKCS110
00681  EJECT                                                            MBKCS110
00682                                                                   MBKCS110
00683  2300-RETRIEVE-FOR-UPDATE.                                        MBKCS110
00684                                                                   MBKCS110
00685 ******************************************************************MBKCS110
00686 *                                                                 MBKCS110
00687 ******************************************************************MBKCS110
00688                                                                   MBKCS110
00689      PERFORM WITH TEST AFTER                                      MBKCS110
00690          VARYING PV-RETRY-COUNTER                                 MBKCS110
00691          FROM 1 BY 1                                              MBKCS110
00692          UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              MBKCS110
00693                  OR (SQLCODE = 0)                                 MBKCS110
00694                  OR (SQLCODE = +100))                             MBKCS110
00695                                                                   MBKCS110
00696                                                                   MBKCS110
00697          EXEC SQL                                                 MBKCS110
00698              SELECT POS_DESC,                                     MBKCS110
00699                     TAX_DFLT_IND                                  MBKCS110
00700              INTO :MDSECL-POS-DESC,                               MBKCS110
00701                   :MDSECL-TAX-DFLT-IND                            MBKCS110
00702              FROM   TMDSECL                                       MBKCS110
00703              WHERE (MDSEAR_DKEY     = :DK-MDSEAR-DKEY)            MBKCS110
00704          END-EXEC                                                 MBKCS110
00705                                                                   MBKCS110
00706          EVALUATE TRUE                                            MBKCS110
00707              WHEN SQLCODE = ZERO                                  MBKCS110
00708                  SET PS-ROW-FOUND TO TRUE                         MBKCS110
00709              WHEN SQLCODE = -904                                  MBKCS110
00710              WHEN SQLCODE = -913                                  MBKCS110
00711                   CONTINUE                                        MBKCS110
00712              WHEN SQLCODE = +100                                  MBKCS110
00713              WHEN SQLWARN0 NOT = SPACES                           MBKCS110
00714              WHEN SQLCODE < 0                                     MBKCS110
00715              WHEN SQLCODE > 0                                     MBKCS110
00716                  STRING ' GMA ' DK-GMA-NBR                        MBKCS110
00717                         ' DMA ' DK-DMA-NBR                        MBKCS110
00718                         ' DPT ' DK-DEPT-NBR                       MBKCS110
00719                         ' MCL ' DK-MAJ-CL-NBR                     MBKCS110
00720                         ' SCL ' DK-SUB-CL-NBR                     MBKCS110
00721                         ' LEV=' DK-MDSELV-CDE                     MBKCS110
00722                         ' DTE ' DK-END-DATE                       MBKCS110
00723                         DELIMITED BY SIZE                         MBKCS110
00724                         INTO DP013-MESSAGE-TEXT(1)                MBKCS110
00725                  MOVE SQLCA TO DP013-SQLCA                        MBKCS110
00726                  MOVE '2300-RETREIVE-FOR-UPDATE' TO               MBKCS110
00727                      DP013-PARAGRAPH                              MBKCS110
00728                  MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        MBKCS110
00729                  MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(2)        MBKCS110
00730                  SET DP013-DB2-ABEND TO TRUE                      MBKCS110
00731                  SET DP013-NO-ROLLBACK TO TRUE                    MBKCS110
00732                  SET DP013-XCTL-DISPLAY-RESTART TO TRUE           MBKCS110
00733                  PERFORM DP013-0000-PROCESS-ABEND                 MBKCS110
00734          END-EVALUATE                                             MBKCS110
00735      END-PERFORM.                                                 MBKCS110
00736                                                                   MBKCS110
00737                                                                   MBKCS110
00738      IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         MBKCS110
00739          MOVE '2300-RETRIEVE-FOR-UPDATE' TO                       MBKCS110
00740                                      DP013-PARAGRAPH              MBKCS110
00741          MOVE SQLCA TO DP013-SQLCA                                MBKCS110
00742          STRING ' GMA ' DK-GMA-NBR                                MBKCS110
00743                 ' DMA ' DK-DMA-NBR                                MBKCS110
00744                 ' DPT ' DK-DEPT-NBR                               MBKCS110
00745                 ' MCL ' DK-MAJ-CL-NBR                             MBKCS110
00746                 ' SCL ' DK-SUB-CL-NBR                             MBKCS110
00747                 ' LEV=' DK-MDSELV-CDE                             MBKCS110
00748                 ' DTE ' DK-END-DATE                               MBKCS110
00749                 DELIMITED BY SIZE                                 MBKCS110
00750                 INTO DP013-MESSAGE-TEXT(1)                        MBKCS110
00751          MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 MBKCS110
00752                                      DP013-MESSAGE-TEXT(2)        MBKCS110
00753          MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                MBKCS110
00754          MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(2)                MBKCS110
00755          SET DP013-DB2-ABEND                                      MBKCS110
00756              DP013-NO-ROLLBACK                                    MBKCS110
00757              DP013-XCTL-DISPLAY-RESTART TO TRUE                   MBKCS110
00758          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS110
00759      END-IF.                                                      MBKCS110
00760                                                                   MBKCS110
00761                                                                   MBKCS110
00762  EJECT                                                            MBKCS110
00763                                                                   MBKCS110
00764  2400-GET-MDSEAR-DESCRIPS.                                        MBKCS110
00765                                                                   MBKCS110
00766       MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR                     MBKCS110
00767       MOVE ASC-GMA-NO        TO DK-GMA-NBR                        MBKCS110
00768       MOVE '000'             TO DK-DMA-NBR                        MBKCS110
00769                                 DK-DEPT-NBR                       MBKCS110
00770                                 DK-MAJ-CL-NBR                     MBKCS110
00771                                 DK-SUB-CL-NBR                     MBKCS110
00772       MOVE PC-GMA-LEVEL-CD   TO DK-MDSELV-CDE                     MBKCS110
00773       PERFORM 9400-GET-MDSEAR                                     MBKCS110
00774       MOVE MDSEAR-DESC       TO ASC-GMA-DESC                      MBKCS110
00775                                                                   MBKCS110
00776                                                                   MBKCS110
00777       MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR                     MBKCS110
00778       MOVE ASC-GMA-NO        TO DK-GMA-NBR                        MBKCS110
00779       MOVE ASC-DMA-NO        TO DK-DMA-NBR                        MBKCS110
00780       MOVE '000'             TO DK-DEPT-NBR                       MBKCS110
00781                                 DK-MAJ-CL-NBR                     MBKCS110
00782                                 DK-SUB-CL-NBR                     MBKCS110
00783       MOVE PC-DMA-LEVEL-CD   TO DK-MDSELV-CDE                     MBKCS110
00784       PERFORM 9400-GET-MDSEAR                                     MBKCS110
00785       MOVE MDSEAR-DESC       TO ASC-DMA-DESC                      MBKCS110
00786                                                                   MBKCS110
00787                                                                   MBKCS110
00788       MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR                     MBKCS110
00789       MOVE ASC-GMA-NO        TO DK-GMA-NBR                        MBKCS110
00790       MOVE ASC-DMA-NO        TO DK-DMA-NBR                        MBKCS110
00791       MOVE ASC-DPT-NO        TO DK-DEPT-NBR                       MBKCS110
00792       MOVE '000'             TO DK-MAJ-CL-NBR                     MBKCS110
00793                                 DK-SUB-CL-NBR                     MBKCS110
00794       MOVE PC-DEPT-LEVEL-CD  TO DK-MDSELV-CDE                     MBKCS110
00795       PERFORM 9400-GET-MDSEAR                                     MBKCS110
00796       MOVE MDSEAR-DESC       TO ASC-DPT-DESC.                     MBKCS110
00797                                                                   MBKCS110
00798       MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR                     MBKCS110
00799       MOVE ASC-GMA-NO        TO DK-GMA-NBR                        MBKCS110
00800       MOVE ASC-DMA-NO        TO DK-DMA-NBR                        MBKCS110
00801       MOVE ASC-DPT-NO        TO DK-DEPT-NBR                       MBKCS110
00802       MOVE ASC-MCL-NO        TO DK-MAJ-CL-NBR                     MBKCS110
00803       MOVE '000'             TO DK-SUB-CL-NBR                     MBKCS110
00804       MOVE PC-MCL-LEVEL-CD   TO DK-MDSELV-CDE                     MBKCS110
00805       PERFORM 9400-GET-MDSEAR                                     MBKCS110
00806       MOVE MDSEAR-DESC       TO ASC-MCL-DESC.                     MBKCS110
00807                                                                   MBKCS110
00808       MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR                     MBKCS110
00809       MOVE ASC-GMA-NO        TO DK-GMA-NBR                        MBKCS110
00810       MOVE ASC-DMA-NO        TO DK-DMA-NBR                        MBKCS110
00811       MOVE ASC-DPT-NO        TO DK-DEPT-NBR                       MBKCS110
00812       MOVE ASC-MCL-NO        TO DK-MAJ-CL-NBR                     MBKCS110
00813       MOVE ASC-SCL-NO        TO DK-SUB-CL-NBR                     MBKCS110
00814       MOVE PC-SCL-LEVEL-CD   TO DK-MDSELV-CDE                     MBKCS110
00815       PERFORM 9400-GET-MDSEAR                                     MBKCS110
00816       MOVE MDSEAR-DESC       TO ASC-SCL-DESC.                     MBKCS110
00817                                                                   MBKCS110
00818  3000-PROCESS-MAP.                                                MBKCS110
00819                                                                   MBKCS110
00820 ******************************************************************MBKCS110
00821 *                                                                 MBKCS110
00822 ******************************************************************MBKCS110
00823                                                                   MBKCS110
00824      SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         MBKCS110
00825                                                                   MBKCS110
00826      PERFORM DP007-0000-GET-PANEL.                                MBKCS110
00827                                                                   MBKCS110
00828                                                                   MBKCS110
00829      IF (DP020-SRC-AID NOT = DP016-PF5)   AND                     MBKCS110
00830         (DP020-SRC-AID NOT = DP016-CLEAR)                         MBKCS110
00831          PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                     MBKCS110
00832      END-IF.                                                      MBKCS110
00833                                                                   MBKCS110
00834      PERFORM 3100-CHECK-LOCAL-FKEYS.                              MBKCS110
00835  EJECT                                                            MBKCS110
00836                                                                   MBKCS110
00837  3100-CHECK-LOCAL-FKEYS.                                          MBKCS110
00838                                                                   MBKCS110
00839 ******************************************************************MBKCS110
00840 *    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT          MBKCS110
00841 *    FUNCTION KEY THE USER HAS HIT.                               MBKCS110
00842 *                                                                 MBKCS110
00843 *    MODIFY THE EVALUATE CLAUSE BELOW BY ADDING A WHEN  CLAUSE    MBKCS110
00844 *    FOR EACH AID KEY YOU PLAN ON HANDLING WITHIN THIS PROGRAM.   MBKCS110
00845 *    DO NOT MODIFY OR DELETE ANY OF THE EXISTING WHEN  CLAUSES.   MBKCS110
00846 *                                                                 MBKCS110
00847 ******************************************************************MBKCS110
00848                                                                   MBKCS110
00849      EVALUATE TRUE                                                MBKCS110
00850                                                                   MBKCS110
00851          WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)  OR             MBKCS110
00852                DP020-FK-RETURN(DP020-SRC-AID))                    MBKCS110
00853              PERFORM 4300-SETUP-INTER-APPL-COMM                   MBKCS110
00854              PERFORM DP015-1000-START-NAVIGATOR                   MBKCS110
00855                                                                   MBKCS110
00856          WHEN (DP020-FK-EDIT-GOTO(DP020-SRC-AID))                 MBKCS110
00857                                                                   MBKCS110
00858              IF (DP020-SRC-AID = DP016-PF13)                      MBKCS110
00859                                                                   MBKCS110
00860                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS110
00861                                                                   MBKCS110
00862                  IF PS-NO-ERROR                                   MBKCS110
00863                     PERFORM 4000-PREPARE-TSQ                      MBKCS110
00864                     PERFORM 4300-SETUP-INTER-APPL-COMM            MBKCS110
00865                     PERFORM DP015-1000-START-NAVIGATOR            MBKCS110
00866                  ELSE                                             MBKCS110
00867                     PERFORM 2200-DISPLAY-PANEL                    MBKCS110
00868                  END-IF                                           MBKCS110
00869              END-IF                                               MBKCS110
00870                                                                   MBKCS110
00871          WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              MBKCS110
00872              PERFORM 3250-GET-NEXT-SELECTION                      MBKCS110
00873              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00874                                                                   MBKCS110
00875          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     MBKCS110
00876              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 MBKCS110
00877              INITIALIZE ANAVCMDO ANAVKEYO                         MBKCS110
00878                         DP020-NAV-KEY-DATA                        MBKCS110
00879                         DP020-NAV-MNEMONIC                        MBKCS110
00880              PERFORM 2000-BUILD-INITIAL-PANEL                     MBKCS110
00881              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00882                                                                   MBKCS110
00883                                                                   MBKCS110
00884          WHEN DP020-SRC-AID = DP016-ENTER                         MBKCS110
00885                                                                   MBKCS110
00886              IF (DP020-NAV-MNEMONIC = SPACES)     OR              MBKCS110
00887                 (DP020-NAV-MNEMONIC = LOW-VALUES)                 MBKCS110
00888                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS110
00889                  PERFORM 2200-DISPLAY-PANEL                       MBKCS110
00890              ELSE                                                 MBKCS110
00891                  PERFORM 4300-SETUP-INTER-APPL-COMM               MBKCS110
00892                  PERFORM DP015-1000-START-NAVIGATOR               MBKCS110
00893              END-IF                                               MBKCS110
00894                                                                   MBKCS110
00895                                                                   MBKCS110
00896          WHEN DP020-SRC-AID = DP016-PF15                          MBKCS110
00897              IF ASC-SCL-MAINT                                     MBKCS110
00898                  PERFORM 3300-EDIT-DATA-IN-COMMAREA               MBKCS110
00899                  IF PS-NO-ERROR                                   MBKCS110
00900                      PERFORM 4500-DETERMINE-UPDATE                MBKCS110
00901                  END-IF                                           MBKCS110
00902              ELSE                                                 MBKCS110
00903                 MOVE PC-TSYMSG-00151 TO DP020-MSG-NUMBER          MBKCS110
00904                 SET PS-ERROR                                      MBKCS110
00905                     DP020-MSG-FATAL TO TRUE                       MBKCS110
00906                 MOVE -1 TO ANAVCMDL                               MBKCS110
00907              END-IF                                               MBKCS110
00908              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00909                                                                   MBKCS110
00910          WHEN DP020-SRC-AID = DP016-PA2                           MBKCS110
00911              SET PS-SEND-DATA-ONLY TO TRUE                        MBKCS110
00912                                                                   MBKCS110
00913              MOVE -1 TO ANAVCMDL                                  MBKCS110
00914                                                                   MBKCS110
00915              PERFORM DP017-0000-GET-CURR-DATE-TIME                MBKCS110
00916              PERFORM DP009-0000-LOAD-FK-LINES                     MBKCS110
00917              PERFORM DP008-0000-WRITE-PANEL                       MBKCS110
00918                                                                   MBKCS110
00919          WHEN DP020-SRC-AID = DP016-CLEAR                         MBKCS110
00920              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 MBKCS110
00921                                                                   MBKCS110
00922              PERFORM 3300-EDIT-DATA-IN-COMMAREA                   MBKCS110
00923              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00924                                                                   MBKCS110
00925          WHEN OTHER                                               MBKCS110
00926 *            -- INVALID FUNCTION KEY --                           MBKCS110
00927              PERFORM 3300-EDIT-DATA-IN-COMMAREA                   MBKCS110
00928              MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER            MBKCS110
00929              SET DP020-MSG-FATAL TO TRUE                          MBKCS110
00930              PERFORM 2200-DISPLAY-PANEL                           MBKCS110
00931                                                                   MBKCS110
00932      END-EVALUATE.                                                MBKCS110
00933  EJECT                                                            MBKCS110
00934                                                                   MBKCS110
00935  3200-MOVE-SCREEN-TO-COMMAREA.                                    MBKCS110
00936                                                                   MBKCS110
00937 ******************************************************************MBKCS110
00938 *                                                                 MBKCS110
00939 ******************************************************************MBKCS110
00940                                                                   MBKCS110
00941      IF APDESCL > 0                                               MBKCS110
00942         MOVE APDESCI   TO ASC-SCRN-POS-DESC                       MBKCS110
00943         SET ASC-POS-DESC-NEED-EDIT TO TRUE                        MBKCS110
00944      ELSE                                                         MBKCS110
00945         IF APDESCF = DP015-ERASE-EOF                              MBKCS110
00946            MOVE SPACE TO ASC-SCRN-POS-DESC                        MBKCS110
00947            SET ASC-POS-DESC-NEED-EDIT TO TRUE                     MBKCS110
00948         END-IF                                                    MBKCS110
00949      END-IF.                                                      MBKCS110
00950                                                                   MBKCS110
00951      IF ATAXDFTL > 0                                              MBKCS110
00952         MOVE ATAXDFTI   TO ASC-SCRN-TAX-DFLT-IND                  MBKCS110
00953         SET ASC-TAX-DFLT-NEED-EDIT TO TRUE                        MBKCS110
00954      ELSE                                                         MBKCS110
00955         IF ATAXDFTF = DP015-ERASE-EOF                             MBKCS110
00956            MOVE SPACE TO ASC-SCRN-TAX-DFLT-IND                    MBKCS110
00957            SET ASC-TAX-DFLT-NEED-EDIT TO TRUE                     MBKCS110
00958         END-IF                                                    MBKCS110
00959      END-IF.                                                      MBKCS110
00960                                                                   MBKCS110
00961                                                                   MBKCS110
00962  EJECT                                                            MBKCS110
00963                                                                   MBKCS110
00964  3250-GET-NEXT-SELECTION.                                         MBKCS110
00965 ******************************************************************MBKCS110
00966 *                                                                 MBKCS110
00967 ******************************************************************MBKCS110
00968      SET PS-SEND-MAP-N-DATA-FRSET TO TRUE.                        MBKCS110
00969      ADD 1 TO ASC-SEL-IDX.                                        MBKCS110
00970                                                                   MBKCS110
00971      IF ASC-SEL-IDX > ASC-MAX-ITEMS                               MBKCS110
00972         ADD +1 TO ASC-TSQ-ITEM-NBR                                MBKCS110
00973         PERFORM 9050-READ-TSQ                                     MBKCS110
00974         MOVE PV-TSQ-TEMP-LAYOUT    TO ASC-SAVE-SELECTION-TABLE    MBKCS110
00975         MOVE 1 TO ASC-SEL-IDX                                     MBKCS110
00976      END-IF.                                                      MBKCS110
00977      IF ASC-KEY-DATA (ASC-SEL-IDX) > SPACES                       MBKCS110
00978          MOVE ASC-GMA-NBR(ASC-SEL-IDX)  TO ASC-GMA-NO             MBKCS110
00979          MOVE ASC-DMA-NBR(ASC-SEL-IDX)  TO ASC-DMA-NO             MBKCS110
00980          MOVE ASC-DPT-NBR(ASC-SEL-IDX)  TO ASC-DPT-NO             MBKCS110
00981          MOVE ASC-MCL-NBR(ASC-SEL-IDX)  TO ASC-MCL-NO             MBKCS110
00982          MOVE ASC-SCL-NBR(ASC-SEL-IDX)  TO ASC-SCL-NO             MBKCS110
00983          PERFORM 2000-BUILD-INITIAL-PANEL                         MBKCS110
00984      ELSE                                                         MBKCS110
00985          SUBTRACT 1 FROM ASC-SEL-IDX                              MBKCS110
00986          MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER                MBKCS110
00987          SET DP020-MSG-INFORMATIONAL TO TRUE                      MBKCS110
00988          SET PS-ERROR TO TRUE                                     MBKCS110
00989          MOVE -1  TO APDESCL                                      MBKCS110
00990      END-IF.                                                      MBKCS110
00991                                                                   MBKCS110
00992  3300-EDIT-DATA-IN-COMMAREA.                                      MBKCS110
00993                                                                   MBKCS110
00994 ******************************************************************MBKCS110
00995 *                                                                 MBKCS110
00996 ******************************************************************MBKCS110
00997                                                                   MBKCS110
00998      PERFORM 1700-RESET-ATTRIBUTES.                               MBKCS110
00999                                                                   MBKCS110
01000      SET PS-NO-ERROR TO TRUE.                                     MBKCS110
01001                                                                   MBKCS110
01002      IF ASC-TAX-DFLT-PASS-EDIT                                    MBKCS110
01003         CONTINUE                                                  MBKCS110
01004      ELSE                                                         MBKCS110
01005         PERFORM 3400-VALIDATE-TAX-DFLT                            MBKCS110
01006      END-IF.                                                      MBKCS110
01007                                                                   MBKCS110
01008      IF ASC-POS-DESC-PASS-EDIT                                    MBKCS110
01009         CONTINUE                                                  MBKCS110
01010      ELSE                                                         MBKCS110
01011         PERFORM 3410-VALIDATE-POS-DESC                            MBKCS110
01012      END-IF.                                                      MBKCS110
01013                                                                   MBKCS110
01014      PERFORM 3300-MOVE-COMMAREA-TO-SCREEN.                        MBKCS110
01015                                                                   MBKCS110
01016  EJECT                                                            MBKCS110
01017                                                                   MBKCS110
01018  3300-MOVE-COMMAREA-TO-SCREEN.                                    MBKCS110
01019                                                                   MBKCS110
01020 ******************************************************************MBKCS110
01021 *                                                                 MBKCS110
01022 ******************************************************************MBKCS110
01023                                                                   MBKCS110
01024      MOVE ASC-COMPANY-NO          TO AOPERCOO.                    MBKCS110
01025      MOVE ASC-GMA-NO              TO AGMAO.                       MBKCS110
01026      MOVE ASC-GMA-DESC            TO AGMADESO.                    MBKCS110
01027      MOVE ASC-DMA-NO              TO ADMAO.                       MBKCS110
01028      MOVE ASC-DMA-DESC            TO ADMADESO.                    MBKCS110
01029      MOVE ASC-DPT-NO              TO ADEPTO.                      MBKCS110
01030      MOVE ASC-DPT-DESC            TO ADPTDESO.                    MBKCS110
01031      MOVE ASC-MCL-NO              TO AMCLASSO.                    MBKCS110
01032      MOVE ASC-MCL-DESC            TO AMCLDESO.                    MBKCS110
01033      MOVE ASC-SCL-NO              TO ASCLASSO.                    MBKCS110
01034      MOVE ASC-SCL-DESC            TO ASCLDESO.                    MBKCS110
01035      MOVE ASC-SCRN-POS-DESC       TO APDESCO.                     MBKCS110
01036      MOVE ASC-SCRN-TAX-DFLT-IND   TO ATAXDFTO.                    MBKCS110
01037                                                                   MBKCS110
01038  EJECT                                                            MBKCS110
01039                                                                   MBKCS110
01040  3400-VALIDATE-TAX-DFLT.                                          MBKCS110
01041 ******************************************************************MBKCS110
01042 *                                                                 MBKCS110
01043 ******************************************************************MBKCS110
01044                                                                   MBKCS110
01045                                                                   MBKCS110
01046      IF ASC-SCRN-TAX-DFLT-VALID                                   MBKCS110
01047         SET ASC-TAX-DFLT-PASS-EDIT TO TRUE                        MBKCS110
01048      ELSE                                                         MBKCS110
01049         SET PS-ERROR         TO TRUE                              MBKCS110
01050         SET DP020-MSG-FATAL  TO TRUE                              MBKCS110
01051         MOVE DP015-RED       TO ATAXDFTC                          MBKCS110
01052         MOVE DP015-REVERSE   TO ATAXDFTH                          MBKCS110
01053         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                  MBKCS110
01054         MOVE -1              TO ATAXDFTL                          MBKCS110
01055      END-IF.                                                      MBKCS110
01056                                                                   MBKCS110
01057  3410-VALIDATE-POS-DESC.                                          MBKCS110
01058 ******************************************************************MBKCS110
01059 *                                                                 MBKCS110
01060 ******************************************************************MBKCS110
01061      IF ASC-SCRN-POS-DESC NOT = SPACES                            MBKCS110
01062         SET ASC-POS-DESC-PASS-EDIT TO TRUE                        MBKCS110
01063      ELSE                                                         MBKCS110
01064          SET PS-ERROR         TO TRUE                             MBKCS110
01065          SET DP020-MSG-FATAL  TO TRUE                             MBKCS110
01066          MOVE DP015-RED       TO APDESCC                          MBKCS110
01067          MOVE DP015-REVERSE   TO APDESCH                          MBKCS110
01068          MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 MBKCS110
01069          MOVE -1              TO APDESCL                          MBKCS110
01070      END-IF.                                                      MBKCS110
01071                                                                   MBKCS110
01072                                                                   MBKCS110
01073  4000-PREPARE-TSQ.                                                MBKCS110
01074 ******************************************************************MBKCS110
01075 *                                                                 MBKCS110
01076 ******************************************************************MBKCS110
01077      MOVE 1 TO ASC-TSQ-ITEM-NBR.                                  MBKCS110
01078      PERFORM 9050-READ-TSQ.                                       MBKCS110
01079      MOVE PV-SCL-ADD-QUEUE     TO MB104-MDSEAR-ADD-TSQUEUE.       MBKCS110
01080      MOVE ASC-SCRN-POS-DESC    TO MB104-POS-DESCRIP               MBKCS110
01081      MOVE ASC-SCRN-TAX-DFLT-IND TO  MB104-TAX-DEFLT-IND.          MBKCS110
01082      INITIALIZE PV-TSQ-TEMP-LAYOUT.                               MBKCS110
01083      MOVE MB104-MDSEAR-ADD-TSQUEUE TO PV-SCL-ADD-QUEUE.           MBKCS110
01084      PERFORM 9075-REWRITE-TSQ.                                    MBKCS110
01085                                                                   MBKCS110
01086  4100-SAVE-INITIAL-INTERAPPL.                                     MBKCS110
01087                                                                   MBKCS110
01088 ******************************************************************MBKCS110
01089 *    SAVE THE INTER-APPLICATION COMMAREA ON THE FIRST CYCLE       MBKCS110
01090 *    OF THIS TRANSACTION.                                         MBKCS110
01091 ******************************************************************MBKCS110
01092      IF (DP020-MB-SUB-CLASS-SELECT) OR                            MBKCS110
01093         (DP020-MB-SUB-CLASS-LIST)                                 MBKCS110
01094         SET ASC-SCL-MAINT TO TRUE                                 MBKCS110
01095         SET PS-INTER-APPL-VALID        TO TRUE                    MBKCS110
01096         MOVE MB005-LIST-QUEUE-NAME     TO ASC-TEMP-QUEUE-NAME     MBKCS110
01097         MOVE MB005-CO-NUMBER           TO ASC-COMPANY-NO          MBKCS110
01098      ELSE                                                         MBKCS110
01099        IF (DP020-MB-MERCH-AREA-ADD)                               MBKCS110
01100           SET ASC-SCL-ADD TO TRUE                                 MBKCS110
01101           SET PS-INTER-APPL-VALID      TO TRUE                    MBKCS110
01102           MOVE MB005-LIST-QUEUE-NAME   TO ASC-TEMP-QUEUE-NAME     MBKCS110
01103           MOVE MB005-CO-NUMBER           TO ASC-COMPANY-NO        MBKCS110
01104        ELSE                                                       MBKCS110
01105           MOVE PC-TSYMSG-99901 TO DP020-MSG-NUMBER                MBKCS110
01106           SET DP020-MSG-FATAL  TO TRUE                            MBKCS110
01107           SET PS-INTER-APPL-INVALID TO TRUE                       MBKCS110
01108           MOVE -1 TO ANAVCMDL                                     MBKCS110
01109        END-IF                                                     MBKCS110
01110      END-IF.                                                      MBKCS110
01111                                                                   MBKCS110
01112  EJECT                                                            MBKCS110
01113                                                                   MBKCS110
01114  4200-UPDATE-INITIAL-INTERAPPL.                                   MBKCS110
01115                                                                   MBKCS110
01116 ******************************************************************MBKCS110
01117 ******************************************************************MBKCS110
01118  EJECT                                                            MBKCS110
01119                                                                   MBKCS110
01120  4300-SETUP-INTER-APPL-COMM.                                      MBKCS110
01121                                                                   MBKCS110
01122 ******************************************************************MBKCS110
01123 *                                                                 MBKCS110
01124 ******************************************************************MBKCS110
01125                                                                   MBKCS110
01126      SET DP020-MB-MERCH-DEPT-MAINT TO TRUE                        MBKCS110
01127      COMPUTE MB005-NUMBER-PROCESSED-ITEMS =                       MBKCS110
01128         ((ASC-TSQ-ITEM-NBR - 1) * ASC-MAX-ITEMS) +                MBKCS110
01129           ASC-SEL-IDX.                                            MBKCS110
01130      MOVE ASC-TEMP-QUEUE-NAME   TO MB005-LIST-QUEUE-NAME.         MBKCS110
01131      MOVE ASC-COMPANY-NO        TO MB005-CO-NUMBER.               MBKCS110
01132      MOVE 'DPT'                 TO MB005-MDSEAR-LEVEL.            MBKCS110
01133                                                                   MBKCS110
01134  EJECT                                                            MBKCS110
01135                                                                   MBKCS110
01136  4500-DETERMINE-UPDATE.                                           MBKCS110
01137                                                                   MBKCS110
01138 ******************************************************************MBKCS110
01139 *                                                                 MBKCS110
01140 ******************************************************************MBKCS110
01141                                                                   MBKCS110
01142      MOVE ASC-COMPANY-NO    TO DK-OPERCO-NBR.                     MBKCS110
01143      MOVE ASC-GMA-NO        TO DK-GMA-NBR.                        MBKCS110
01144      MOVE ASC-DMA-NO        TO DK-DMA-NBR.                        MBKCS110
01145      MOVE ASC-DPT-NO        TO DK-DEPT-NBR.                       MBKCS110
01146      MOVE ASC-MCL-NO        TO DK-MAJ-CL-NBR                      MBKCS110
01147      MOVE ASC-SCL-NO        TO DK-SUB-CL-NBR.                     MBKCS110
01148      MOVE PC-DEPT-LEVEL-CD  TO DK-MDSELV-CDE.                     MBKCS110
01149                                                                   MBKCS110
01150      MOVE ASC-MDSEAR-DKEY TO DK-MDSEAR-DKEY.                      MBKCS110
01151      PERFORM 2300-RETRIEVE-FOR-UPDATE.                            MBKCS110
01152                                                                   MBKCS110
01153      IF (ASC-ORIG-POS-DESC NOT = MDSECL-POS-DESC) OR              MBKCS110
01154         (ASC-ORIG-TAX-DFLT-IND NOT = MDSECL-TAX-DFLT-IND)         MBKCS110
01155         SET PS-ERROR     TO TRUE                                  MBKCS110
01156         SET DP020-MSG-FATAL TO TRUE                               MBKCS110
01157         MOVE PC-TSYMSG-00122 TO DP020-MSG-NUMBER                  MBKCS110
01158         MOVE -1 TO ANAVCMDL                                       MBKCS110
01159      ELSE                                                         MBKCS110
01160         IF (ASC-ORIG-POS-DESC = ASC-SCRN-POS-DESC) AND            MBKCS110
01161            (ASC-ORIG-TAX-DFLT-IND = ASC-SCRN-TAX-DFLT-IND)        MBKCS110
01162            SET PS-ERROR     TO TRUE                               MBKCS110
01163            SET DP020-MSG-FATAL TO TRUE                            MBKCS110
01164            MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER               MBKCS110
01165            MOVE -1 TO ANAVCMDL                                    MBKCS110
01166         ELSE                                                      MBKCS110
01167                                                                   MBKCS110
01168            MOVE ASC-SCRN-POS-DESC TO MDSECL-POS-DESC              MBKCS110
01169                                       ASC-ORIG-POS-DESC           MBKCS110
01170            MOVE ASC-SCRN-TAX-DFLT-IND TO MDSECL-TAX-DFLT-IND      MBKCS110
01171                                       ASC-ORIG-TAX-DFLT-IND       MBKCS110
01172                                                                   MBKCS110
01173                                                                   MBKCS110
01174            PERFORM 9300-UPDATE-SUB-CLASS                          MBKCS110
01175            PERFORM 9900-COMMIT                                    MBKCS110
01176            PERFORM 3300-MOVE-COMMAREA-TO-SCREEN                   MBKCS110
01177            IF SQLCODE = +000                                      MBKCS110
01178                MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER          MBKCS110
01179                SET DP020-MSG-INFORMATIONAL TO TRUE                MBKCS110
01180            END-IF                                                 MBKCS110
01181         END-IF                                                    MBKCS110
01182      END-IF.                                                      MBKCS110
01183                                                                   MBKCS110
01184  9050-READ-TSQ.                                                   MBKCS110
01185 ******************************************************************MBKCS110
01186 *    READ TEMPORARY STORAGE QUEUE                                 MBKCS110
01187 ******************************************************************MBKCS110
01188                                                                   MBKCS110
01189      IF  ASC-SCL-MAINT                                            MBKCS110
01190          MOVE LENGTH OF MB003-RECORD-AREA                         MBKCS110
01191                                TO  ASC-TEMP-QUEUE-LENGTH          MBKCS110
01192                                    MB005-LIST-QUEUE-LENGTH        MBKCS110
01193      ELSE                                                         MBKCS110
01194          MOVE LENGTH OF MB104-MDSEAR-ADD-TSQUEUE                  MBKCS110
01195                                TO  ASC-TEMP-QUEUE-LENGTH          MBKCS110
01196                                    MB005-LIST-QUEUE-LENGTH        MBKCS110
01197      END-IF.                                                      MBKCS110
01198                                                                   MBKCS110
01199      EXEC CICS                                                    MBKCS110
01200          READQ TS                                                 MBKCS110
01201          QUEUE(ASC-TEMP-QUEUE-NAME)                               MBKCS110
01202          INTO (PV-TSQ-TEMP-LAYOUT)                                MBKCS110
01203          LENGTH(ASC-TEMP-QUEUE-LENGTH)                            MBKCS110
01204          ITEM(ASC-TSQ-ITEM-NBR)                                   MBKCS110
01205          RESP(PV-CICS-RESPONSE)                                   MBKCS110
01206      END-EXEC.                                                    MBKCS110
01207                                                                   MBKCS110
01208      IF PV-CICS-RESPONSE =  DFHRESP(QZERO)                        MBKCS110
01209         IF ASC-SCL-ADD                                            MBKCS110
01210             SET DP013-LOGIC-ABEND  TO TRUE                        MBKCS110
01211             SET DP013-NO-ROLLBACK  TO TRUE                        MBKCS110
01212             MOVE '9050-READ-TSQ'   TO DP013-PARAGRAPH             MBKCS110
01213             MOVE 'RECEIVED ERROR MESSAGE WHILE READING TSQ' TO    MBKCS110
01214                                       DP013-MESSAGE-TEXT(1)       MBKCS110
01215             PERFORM DP013-0000-PROCESS-ABEND                      MBKCS110
01216         ELSE                                                      MBKCS110
01217             SET PS-EMPTY-QUEUE TO TRUE                            MBKCS110
01218         END-IF                                                    MBKCS110
01219      ELSE                                                         MBKCS110
01220          IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                MBKCS110
01221             SET DP013-LOGIC-ABEND  TO TRUE                        MBKCS110
01222             SET DP013-NO-ROLLBACK  TO TRUE                        MBKCS110
01223             MOVE '9050-READ-TSQ'   TO DP013-PARAGRAPH             MBKCS110
01224             MOVE 'RECEIVED ERROR MESSAGE WHILE READING TSQ' TO    MBKCS110
01225                                       DP013-MESSAGE-TEXT(1)       MBKCS110
01226             PERFORM DP013-0000-PROCESS-ABEND                      MBKCS110
01227          END-IF                                                   MBKCS110
01228      END-IF.                                                      MBKCS110
01229  EJECT                                                            MBKCS110
01230                                                                   MBKCS110
01231  9075-REWRITE-TSQ.                                                MBKCS110
01232 ******************************************************************MBKCS110
01233 *    REWRITE TSQ                                                  MBKCS110
01234 ******************************************************************MBKCS110
01235      EXEC CICS                                                    MBKCS110
01236          WRITEQ TS                                                MBKCS110
01237          QUEUE(ASC-TEMP-QUEUE-NAME)                               MBKCS110
01238          FROM (PV-SCL-ADD-QUEUE)                                  MBKCS110
01239          LENGTH(ASC-TEMP-QUEUE-LENGTH)                            MBKCS110
01240          ITEM(ASC-TSQ-ITEM-NBR) REWRITE                           MBKCS110
01241          RESP(PV-CICS-RESPONSE)                                   MBKCS110
01242      END-EXEC.                                                    MBKCS110
01243      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    MBKCS110
01244         SET DP013-LOGIC-ABEND  TO TRUE                            MBKCS110
01245         SET DP013-NO-ROLLBACK  TO TRUE                            MBKCS110
01246         MOVE '9075-REWRITE-TSQ'   TO DP013-PARAGRAPH              MBKCS110
01247         MOVE 'RECEIVED ERROR MESSAGE WHILE REWRITING TSQ' TO      MBKCS110
01248                                   DP013-MESSAGE-TEXT(1)           MBKCS110
01249         PERFORM DP013-0000-PROCESS-ABEND                          MBKCS110
01250      END-IF.                                                      MBKCS110
01251  EJECT                                                            MBKCS110
01252  9100-RETURN-TO-PREV-TRAN.                                        MBKCS110
01253 ******************************************************************MBKCS110
01254 *                                                                 MBKCS110
01255 ******************************************************************MBKCS110
01256      MOVE DP016-PF3  TO DP020-SRC-AID.                            MBKCS110
01257      PERFORM DP015-1000-START-NAVIGATOR.                          MBKCS110
01258  9300-UPDATE-SUB-CLASS.                                           MBKCS110
01259                                                                   MBKCS110
01260 ******************************************************************MBKCS110
01261 *                                                                 MBKCS110
01262 ******************************************************************MBKCS110
01263                                                                   MBKCS110
01264      PERFORM WITH TEST AFTER                                      MBKCS110
01265          VARYING PV-RETRY-COUNTER                                 MBKCS110
01266          FROM 1 BY 1                                              MBKCS110
01267          UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              MBKCS110
01268                  OR (SQLCODE = 0)                                 MBKCS110
01269                  OR (SQLCODE = +100))                             MBKCS110
01270                                                                   MBKCS110
01271          EXEC SQL                                                 MBKCS110
01272              UPDATE TMDSECL                                       MBKCS110
01273                 SET POS_DESC       = :MDSECL-POS-DESC,            MBKCS110
01274                     TAX_DFLT_IND   = :MDSECL-TAX-DFLT-IND         MBKCS110
01275                 WHERE (MDSEAR_DKEY = :DK-MDSEAR-DKEY)             MBKCS110
01276          END-EXEC                                                 MBKCS110
01277                                                                   MBKCS110
01278          EVALUATE TRUE                                            MBKCS110
01279              WHEN SQLCODE = ZERO                                  MBKCS110
01280                  SET PS-ROW-FOUND TO TRUE                         MBKCS110
01281              WHEN SQLCODE = -904                                  MBKCS110
01282              WHEN SQLCODE = -913                                  MBKCS110
01283                  CONTINUE                                         MBKCS110
01284              WHEN SQLWARN0 NOT = SPACES                           MBKCS110
01285              WHEN SQLCODE < 0                                     MBKCS110
01286              WHEN SQLCODE > 0                                     MBKCS110
01287                  MOVE 'UPDATE TO DEPARTMENT DATABASE FAILED'      MBKCS110
01288                           TO DP013-MESSAGE-TEXT(1)                MBKCS110
01289                  MOVE SQLCA TO DP013-SQLCA                        MBKCS110
01290                  MOVE '9300-UPDATE-SUB-CLASS' TO                  MBKCS110
01291                      DP013-PARAGRAPH                              MBKCS110
01292                  MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(1)        MBKCS110
01293                  SET DP013-DB2-ABEND TO TRUE                      MBKCS110
01294                  SET DP013-NO-ROLLBACK TO TRUE                    MBKCS110
01295                  SET DP013-XCTL-DISPLAY-RESTART TO TRUE           MBKCS110
01296                  PERFORM DP013-0000-PROCESS-ABEND                 MBKCS110
01297          END-EVALUATE                                             MBKCS110
01298      END-PERFORM.                                                 MBKCS110
01299                                                                   MBKCS110
01300      IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         MBKCS110
01301          MOVE '9300-UPDATE-SUB-CLASS' TO                          MBKCS110
01302                                      DP013-PARAGRAPH              MBKCS110
01303          STRING 'UPDATE EXCEEDED MAX RETRIES'                     MBKCS110
01304                 DELIMITED BY SIZE                                 MBKCS110
01305                                 INTO DP013-MESSAGE-TEXT(1)        MBKCS110
01306          MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 MBKCS110
01307                                      DP013-MESSAGE-TEXT(2)        MBKCS110
01308          MOVE SQLCA TO DP013-SQLCA                                MBKCS110
01309          MOVE 'TMDSECL' TO DP013-DB2-TABLE-NAME(1)                MBKCS110
01310          SET DP013-DB2-ABEND                                      MBKCS110
01311              DP013-ROLLBACK                                       MBKCS110
01312              DP013-XCTL-DISPLAY-RESTART TO TRUE                   MBKCS110
01313          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS110
01314      END-IF.                                                      MBKCS110
01315                                                                   MBKCS110
01316  9400-GET-MDSEAR.                                                 MBKCS110
01317                                                                   MBKCS110
01318 ******************************************************************MBKCS110
01319 *                                                                 MBKCS110
01320 ******************************************************************MBKCS110
01321                                                                   MBKCS110
01322      PERFORM WITH TEST AFTER                                      MBKCS110
01323          VARYING PV-RETRY-COUNTER                                 MBKCS110
01324          FROM 1 BY 1                                              MBKCS110
01325          UNTIL (( PV-RETRY-COUNTER > PC-MAX-RETRIES)              MBKCS110
01326                  OR (SQLCODE = 0)                                 MBKCS110
01327                  OR (SQLCODE = +100))                             MBKCS110
01328                                                                   MBKCS110
01329                                                                   MBKCS110
01330          EXEC SQL                                                 MBKCS110
01331              SELECT GMA_NBR,                                      MBKCS110
01332                     DMA_NBR,                                      MBKCS110
01333                     DEPT_NBR,                                     MBKCS110
01334                     MDSEAR_DESC                                   MBKCS110
01335              INTO :MDSEAR-GMA-NBR,                                MBKCS110
01336                   :MDSEAR-DMA-NBR,                                MBKCS110
01337                   :MDSEAR-DEPT-NBR,                               MBKCS110
01338                   :MDSEAR-DESC                                    MBKCS110
01339              FROM   TMDSEAR                                       MBKCS110
01340              WHERE ((OPERCO_NBR    = :DK-OPERCO-NBR) AND          MBKCS110
01341                     (GMA_NBR       = :DK-GMA-NBR)    AND          MBKCS110
01342                     (DMA_NBR       = :DK-DMA-NBR)    AND          MBKCS110
01343                     (DEPT_NBR      = :DK-DEPT-NBR)   AND          MBKCS110
01344                     (MAJ_CL_NBR    = :DK-MAJ-CL-NBR) AND          MBKCS110
01345                     (SUB_CL_NBR    = :DK-SUB-CL-NBR) AND          MBKCS110
01346                     (MDSELV_CDE    = :DK-MDSELV-CDE) AND          MBKCS110
01347                     (END_DTE > DATE (CURRENT TIMESTAMP)))         MBKCS110
01348          END-EXEC                                                 MBKCS110
01349                                                                   MBKCS110
01350          EVALUATE TRUE                                            MBKCS110
01351              WHEN SQLCODE = ZERO                                  MBKCS110
01352                  SET PS-ROW-FOUND TO TRUE                         MBKCS110
01353              WHEN SQLCODE = -904                                  MBKCS110
01354              WHEN SQLCODE = -913                                  MBKCS110
01355                   CONTINUE                                        MBKCS110
01356              WHEN SQLCODE = +100                                  MBKCS110
01357              WHEN SQLWARN0 NOT = SPACES                           MBKCS110
01358              WHEN SQLCODE < 0                                     MBKCS110
01359              WHEN SQLCODE > 0                                     MBKCS110
01360                  STRING ' GMA ' DK-GMA-NBR                        MBKCS110
01361                         ' DMA ' DK-DMA-NBR                        MBKCS110
01362                         ' DPT ' DK-DEPT-NBR                       MBKCS110
01363                         ' MCL ' DK-MAJ-CL-NBR                     MBKCS110
01364                         ' SCL ' DK-SUB-CL-NBR                     MBKCS110
01365                         ' LEV=' DK-MDSELV-CDE                     MBKCS110
01366                         ' DTE ' DK-END-DATE                       MBKCS110
01367                         DELIMITED BY SIZE                         MBKCS110
01368                         INTO DP013-MESSAGE-TEXT(1)                MBKCS110
01369                  MOVE SQLCA TO DP013-SQLCA                        MBKCS110
01370                  MOVE '9400-GET-MDSEAR' TO                        MBKCS110
01371                      DP013-PARAGRAPH                              MBKCS110
01372                  MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)        MBKCS110
01373                  SET DP013-DB2-ABEND TO TRUE                      MBKCS110
01374                  SET DP013-NO-ROLLBACK TO TRUE                    MBKCS110
01375                  SET DP013-XCTL-DISPLAY-RESTART TO TRUE           MBKCS110
01376                  PERFORM DP013-0000-PROCESS-ABEND                 MBKCS110
01377          END-EVALUATE                                             MBKCS110
01378      END-PERFORM.                                                 MBKCS110
01379                                                                   MBKCS110
01380                                                                   MBKCS110
01381      IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         MBKCS110
01382          MOVE '9400-GET-MDSEAR' TO DP013-PARAGRAPH                MBKCS110
01383          MOVE SQLCA TO DP013-SQLCA                                MBKCS110
01384          STRING ' GMA ' DK-GMA-NBR                                MBKCS110
01385                 ' DMA ' DK-DMA-NBR                                MBKCS110
01386                 ' DPT ' DK-DEPT-NBR                               MBKCS110
01387                 ' MCL ' DK-MAJ-CL-NBR                             MBKCS110
01388                 ' SCL ' DK-SUB-CL-NBR                             MBKCS110
01389                 ' LEV=' DK-MDSELV-CDE                             MBKCS110
01390                 ' DTE ' DK-END-DATE                               MBKCS110
01391                 DELIMITED BY SIZE                                 MBKCS110
01392                 INTO DP013-MESSAGE-TEXT(1)                        MBKCS110
01393          MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 MBKCS110
01394                                      DP013-MESSAGE-TEXT(2)        MBKCS110
01395          MOVE 'TMDSEAR' TO DP013-DB2-TABLE-NAME(1)                MBKCS110
01396          SET DP013-DB2-ABEND                                      MBKCS110
01397              DP013-NO-ROLLBACK                                    MBKCS110
01398              DP013-XCTL-DISPLAY-RESTART TO TRUE                   MBKCS110
01399          PERFORM DP013-0000-PROCESS-ABEND                         MBKCS110
01400      END-IF.                                                      MBKCS110
01401                                                                   MBKCS110
01402                                                                   MBKCS110
01403  EJECT                                                            MBKCS110
01404                                                                   MBKCS110
01405  9900-COMMIT.                                                     MBKCS110
01406      EXEC CICS                                                    MBKCS110
01407          SYNCPOINT                                                MBKCS110
01408      END-EXEC.                                                    MBKCS110
01409                                                                   MBKCS110
01410                                                                   MBKCS110
01411  EJECT                                                            MBKCS110
01412                                                                   MBKCS110
01413 ******************************************************************MBKCS110
01414 *    FILL IN SCREEN HEADER MODULE                                 MBKCS110
01415 ******************************************************************MBKCS110
01416                                                                   MBKCS110
01417      COPY DPPD002.                                                MBKCS110
01418  EJECT                                                            MBKCS110
01419 ******************************************************************MBKCS110
01420 *    RETURN TO CICS MODULE                                        MBKCS110
01421 ******************************************************************MBKCS110
01422                                                                   MBKCS110
01423      COPY DPPD003.                                                MBKCS110
01424  EJECT                                                            MBKCS110
01425 ******************************************************************MBKCS110
01426 *    FORMAT MESSAGE LINES MODULE                                  MBKCS110
01427 ******************************************************************MBKCS110
01428                                                                   MBKCS110
01429      COPY DPPD005.                                                MBKCS110
01430  EJECT                                                            MBKCS110
01431 ******************************************************************MBKCS110
01432 *    GET PANEL MODULE                                             MBKCS110
01433 ******************************************************************MBKCS110
01434                                                                   MBKCS110
01435      COPY DPPD007.                                                MBKCS110
01436  EJECT                                                            MBKCS110
01437 ******************************************************************MBKCS110
01438 *    WRITE PANEL MODULE                                           MBKCS110
01439 ******************************************************************MBKCS110
01440                                                                   MBKCS110
01441      COPY DPPD008.                                                MBKCS110
01442  EJECT                                                            MBKCS110
01443 ******************************************************************MBKCS110
01444 *    TOGGLE THE FUNCTION KEY LINE MODULE                          MBKCS110
01445 ******************************************************************MBKCS110
01446                                                                   MBKCS110
01447      COPY DPPD009.                                                MBKCS110
01448  EJECT                                                            MBKCS110
01449 ******************************************************************MBKCS110
01450 *    ABEND PROCESSOR MODULE                                       MBKCS110
01451 ******************************************************************MBKCS110
01452                                                                   MBKCS110
01453      COPY DPPD013.                                                MBKCS110
01454  EJECT                                                            MBKCS110
01455 ******************************************************************MBKCS110
01456 *    CHECK COMMUNICATION AREA MODULE                              MBKCS110
01457 ******************************************************************MBKCS110
01458                                                                   MBKCS110
01459      COPY DPPD015.                                                MBKCS110
01460  EJECT                                                            MBKCS110
01461 ******************************************************************MBKCS110
01462 *    UPDATE TIME AND DATE MODULE                                  MBKCS110
01463 ******************************************************************MBKCS110
01464                                                                   MBKCS110
01465      COPY DPPD017.                                                MBKCS110
01466  EJECT                                                            MBKCS110
