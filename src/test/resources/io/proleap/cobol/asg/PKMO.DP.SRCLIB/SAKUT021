000130*----------------------------------------------------------       00013000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.    SAKUT021.                                         00040099
000500 AUTHOR.        SCOTT BARTELT                                     00050000
000600 DATE-WRITTEN.  DECEMBER, 2001.                                   00060099
000700                                                                  00070000
000800*----------------------------------------------------------       00080000
000900* THIS CREATES THE MISSED MARKUP AND MARKDOWN ACTIVITY            00090099
001000* SKU DETAIL REPORT FOR EVEN EXCHANGES.                           00100099
001300*----------------------------------------------------------       00130000
001400*----------------------------------------------------------       00140000
001410* HISTORY LOG:                                                    00141000
001420*                                                                 00142000
001500* DATE: MM/DD/YY                                                  00150000
001600* WR/IR#:                                                         00160000
001700* PROGRAMMER:                                                     00170000
001800* DESCRIPTION:                                                    00180000
003194*----------------------------------------------------------       00319400
003195 ENVIRONMENT DIVISION.                                            00319500
003196*----------------------------------------------------------       00319600
003197 CONFIGURATION SECTION.                                           00319700
003198 SOURCE-COMPUTER. IBM-3090.                                       00319800
003199 OBJECT-COMPUTER. IBM-3090.                                       00319900
003200                                                                  00320000
003300 INPUT-OUTPUT SECTION.                                            00330000
003400                                                                  00340000
003500 FILE-CONTROL.                                                    00350000
003600                                                                  00360000
003700     SELECT MKUP-MKDN-FILE                                        00370099
003800       FILE STATUS IS SC-MKUP-MKDN-FILE-STATUS                    00380099
003900       ASSIGN TO INP01.                                           00390011
004000                                                                  00400011
004100     SELECT POS-DATE-FILE                                         00410099
004200       FILE STATUS IS SC-POS-DATE-FILE-STATUS                     00420099
004300       ASSIGN TO INP02.                                           00430099
004400                                                                  00440099
004860     SELECT RPT-MISSED-MKUP-MKDWN-ACT                             00486031
004870       ASSIGN TO RPT01.                                           00487099
004900                                                                  00490000
005000*----------------------------------------------------------       00500000
005100 DATA DIVISION.                                                   00510000
005200*----------------------------------------------------------       00520000
005300 FILE SECTION.                                                    00530000
005400                                                                  00540000
006801 FD  MKUP-MKDN-FILE                                               00680199
006802     RECORDING MODE IS F                                          00680236
006803     BLOCK CONTAINS 0 RECORDS                                     00680333
006804     LABEL RECORDS ARE STANDARD.                                  00680433
006805 01  MKUP-MKDN-REC                          PIC  X(080).          00680599
006894                                                                  00689431
006895 FD  POS-DATE-FILE                                                00689599
006896     RECORDING MODE IS F                                          00689699
006897     LABEL RECORDS ARE STANDARD                                   00689799
006898     RECORD CONTAINS 80 CHARACTERS                                00689899
006899     DATA RECORD IS POS-DATE-RECORD.                              00689999
006900 01  POS-DATE-RECORD                        PIC  X(080).          00690099
006910                                                                  00691099
007000 FD  RPT-MISSED-MKUP-MKDWN-ACT                                    00700031
008302     RECORDING MODE IS F                                          00830236
008303     BLOCK CONTAINS 0 RECORDS                                     00830311
008304     LABEL RECORDS ARE STANDARD.                                  00830411
008305 01  RPT-MISSED-MKUP-MKDWN-ACT-REC          PIC  X(132).          00830536
008306                                                                  00830611
008307*----------------------------------------------------------       00830700
008400 WORKING-STORAGE SECTION.                                         00840000
008401*----------------------------------------------------------       00840111
008403 01  ABEND-CODE                             PIC S9(004)           00840331
008404                                             VALUE +0             00840431
008405                                             COMP.                00840531
008407                                                                  00840711
008408*---------------------------------------------                    00840899
008409* RECORD LAYOUT FOR INPUT DATE CARD                               00840999
008410* (POS DATE)                                                      00841099
008420*---------------------------------------------                    00842099
008430 01  CC-POS-DATE-CARD.                                            00843099
008440   05  CC-POS-DATE-CARD-DISPLAY.                                  00844099
008450     10  CC-CONTROL-NAME                    PIC  X(014)           00845099
008460                                             VALUE SPACES.        00846099
008470       88  CC-VALID-CONTROL-NAME                                  00847099
008480             VALUE 'P.O.S. DATE = '.                              00848099
008490     10  CC-POS-DATE-MMDDYY                 PIC  9(006)           00849099
008500                                             VALUE ZEROES.        00850099
008501     10  FILLER                                                   00850199
008502        REDEFINES CC-POS-DATE-MMDDYY.                             00850299
008503       15  CC-POS-DATE-MM                   PIC  9(002).          00850399
008504       15  CC-POS-DATE-DD                   PIC  9(002).          00850499
008505       15  CC-POS-DATE-YY                   PIC  9(002).          00850599
008506   05  FILLER                               PIC  X(060)           00850699
008507                                             VALUE SPACES.        00850799
008508                                                                  00850899
008510*---------------------------------------------                    00851017
008520* PC- PROGRAM CONSTANTS                                           00852017
008530*---------------------------------------------                    00853017
008531 01  PC-PROGRAM-CONSTANTS.                                        00853135
008532   05  PC-PROGRAM-NAME                      PIC  X(008)           00853235
008533        VALUE 'SAKUT021'.                                         00853399
008534   05  PC-DECIMAL-SHIFT-RIGHT               PIC S9(002)           00853499
008535                                             VALUE +10.           00853599
008536   05  PC-MAX-PAGE-SIZE                     PIC S9(003)           00853699
008537                                             VALUE +56            00853799
008538                                             COMP-3.              00853899
008539   05  PC-DATE-SLASH                        PIC  X(001)           00853999
008540                                             VALUE '/'.           00854099
008550   05  PC-ALL                               PIC  X(003)           00855099
008560                                             VALUE 'ALL'.         00856099
008561   05  PC-NO-DATA-IN-INPUT-FILE             PIC  X(034)           00856199
008562         VALUE 'NO DATA IN INPUT FILE TO REPORT ON'.              00856299
008563                                                                  00856331
008564*---------------------------------------------                    00856499
008565* PS- PROGRAM SWITCHES                                            00856599
008566*---------------------------------------------                    00856699
008568 01  PS-PROGRAM-SWITCHES.                                         00856899
008569   05  PS-CONTINUE-PROCESSING-SW            PIC  X(001).          00856999
008570     88  PS-CONTINUE-PROCESSING              VALUE 'Y'.           00857099
008571     88  PS-END-PROCESSING                   VALUE 'N'.           00857199
008572   05  PS-FIRST-READ-SW                     PIC  X(001).          00857299
008573     88  PS-FIRST-READ                       VALUE 'Y'.           00857399
008574     88  PS-NOT-FIRST-READ                   VALUE 'N'.           00857499
008575   05  PS-ADVANCE-PAGE-SW                   PIC  X(001).          00857599
008576     88  PS-ADVANCE-PAGE                     VALUE 'Y'.           00857699
008577     88  PS-DONT-ADVANCE-PAGE                VALUE 'N'.           00857799
008578   05  PS-WRITE-PREV-MONTH-NAME-SW          PIC  X(001).          00857899
008579     88  PS-WRITE-PREV-MONTH-NAME            VALUE 'Y'.           00857999
008580     88  PS-DONT-WRITE-PREV-MONTH-NAME       VALUE 'N'.           00858099
008581                                                                  00858199
008582*---------------------------------------------                    00858299
008583* PV- PROGRAM WORKING VARIABLES                                   00858399
008584*---------------------------------------------                    00858499
008585 01  PV-PROGRAM-VARIABLES.                                        00858599
008586   05  PV-LINES-TO-ADVANCE                  PIC  9(001)           00858699
008587                                             VALUE ZEROS.         00858799
008592   05  PV-LINE-COUNT                        PIC S9(003)           00859299
008593                                             VALUE +99            00859399
008594                                             COMP-3.              00859499
008597   05  PV-CC-GREG-CC-FMT-DATE               PIC  X(010).          00859799
008598   05  PV-CC-FISCAL-ACCT-MONTH              PIC  X(002).          00859899
008599   05  PV-CC-FISCAL-FP-ISO-FMT              PIC  X(010).          00859999
008601   05  PV-CC-PREV-FISCAL-MONTH-NAME         PIC  X(009).          00860199
008602   05  PV-CPU-DATE.                                               00860299
008603     10  PV-CPU-DATE-YY                     PIC  9(002)           00860399
008604                                             VALUE ZEROES.        00860499
008605     10  PV-CPU-DATE-MM                     PIC  9(002)           00860599
008606                                             VALUE ZEROES.        00860699
008607     10  PV-CPU-DATE-DD                     PIC  9(002)           00860799
008608                                             VALUE ZEROES.        00860899
008609   05  PV-TRANSACTION-DATE-YMD              PIC S9(007)           00860999
008610                                             VALUE ZEROES.        00861099
008611   05  FILLER                                                     00861199
008612      REDEFINES PV-TRANSACTION-DATE-YMD.                          00861299
008613                                                                  00861399
008614     10  PV-TRANSACTION-DATE-YEAR           PIC  9(002).          00861499
008615     10  PV-TRANSACTION-DATE-MONTH          PIC  9(002).          00861599
008616     10  PV-TRANSACTION-DATE-DAY            PIC  9(002).          00861699
008617     10  FILLER                             PIC  9(001).          00861799
008618   05  PV-HOLDING-FIELDS.                                         00861899
008619     10  PV-ACCT-MONTH-HOLD                 PIC  X(002).          00861999
008620     10  PV-STORE-NUMBER-HOLD               PIC  X(004).          00862099
008621     10  PV-DEPT-CLS-COMB-HOLD.                                   00862199
008622       15  PV-DEPARTMENT-HOLD               PIC  X(003).          00862299
008623       15  PV-CLASS-HOLD                    PIC  X(002).          00862399
008624   05  PV-PAGE-COUNT                        PIC S9(004)           00862499
008625                                             VALUE +0             00862599
008630                                             COMP.                00863099
008663   05  PV-STR-TOTAL-FIELDS.                                       00866399
008664     10  PV-STR-EXT-MISD-RI-MD-AMT          PIC S9(007)V99        00866499
008665                                             VALUE ZEROES         00866599
008666                                             COMP-3.              00866699
008667     10  PV-STR-EXT-MISD-RI-MDC-AMT         PIC S9(007)V99        00866799
008668                                             VALUE ZEROES         00866899
008669                                             COMP-3.              00866999
008670     10  PV-STR-EXT-MISD-SI-MU-AMT          PIC S9(007)V99        00867099
008671                                             VALUE ZEROES         00867199
008672                                             COMP-3.              00867299
008673     10  PV-STR-EXT-MISD-SI-MD-AMT          PIC S9(007)V99        00867399
008674                                             VALUE ZEROES         00867499
008675                                             COMP-3.              00867599
008688   05  PV-DEPT-CLS-TOTAL-FIELDS.                                  00868899
008689     10  PV-DC-EXT-MISD-RI-MD-AMT           PIC S9(007)V99        00868999
008690                                             VALUE ZEROES         00869099
008691                                             COMP-3.              00869199
008692     10  PV-DC-EXT-MISD-RI-MDC-AMT          PIC S9(007)V99        00869299
008693                                             VALUE ZEROES         00869399
008694                                             COMP-3.              00869499
008695     10  PV-DC-EXT-MISD-SI-MU-AMT           PIC S9(007)V99        00869599
008696                                             VALUE ZEROES         00869699
008697                                             COMP-3.              00869799
008698     10  PV-DC-EXT-MISD-SI-MD-AMT           PIC S9(007)V99        00869899
008699                                             VALUE ZEROES         00869999
008700                                             COMP-3.              00870099
008724   05  PV-CORP-TOTAL-FIELDS.                                      00872499
008725     10  PV-CORP-EXT-MISD-RI-MD-AMT         PIC S9(007)V99        00872599
008726                                             VALUE ZEROES         00872699
008727                                             COMP-3.              00872799
008728     10  PV-CORP-EXT-MISD-RI-MDC-AMT        PIC S9(007)V99        00872899
008729                                             VALUE ZEROES         00872999
008730                                             COMP-3.              00873099
008731     10  PV-CORP-EXT-MISD-SI-MU-AMT         PIC S9(007)V99        00873199
008732                                             VALUE ZEROES         00873299
008733                                             COMP-3.              00873399
008734     10  PV-CORP-EXT-MISD-SI-MD-AMT         PIC S9(007)V99        00873499
008735                                             VALUE ZEROES         00873599
008736                                             COMP-3.              00873699
008738   05  PV-SALES-OR-RETURNS-LAYOUT.                                00873899
008739     10  PV-POS-DATE-YMD                    PIC S9(007)           00873999
008740                                             COMP-3.              00874099
008741     10  PV-ACCT-MONTH                      PIC  9(002).          00874199
008742     10  PV-STORE-NUMBER                    PIC  X(004).          00874299
008743     10  PV-TERMINAL-NUMBER                 PIC  9(004).          00874399
008744     10  PV-TRANSACTION-NUMBER              PIC  9(004).          00874499
008745     10  PV-ITEM-SEQUENCE                   PIC S9(005)           00874599
008746                                             COMP-3.              00874699
008747     10  PV-SKU                             PIC  X(008).          00874799
008753     10  PV-STATUS-CODE                     PIC S9(003)           00875399
008754                                             COMP-3.              00875499
008755     10  PV-UNIT-QTY                        PIC S9(005)           00875599
008756                                             COMP-3.              00875699
008757     10  PV-UNIT-CUST-CHARGED-AMT           PIC S9(005)V99        00875799
008758                                             COMP-3.              00875899
008759     10  PV-UNIT-NET-AMT-CHARGED            PIC S9(005)V99        00875999
008760                                             COMP-3.              00876099
008761     10  PV-UNIT-RETAIL-AMT                 PIC S9(005)V99        00876199
008762                                              COMP-3.             00876299
008763     10  PV-UNIT-OWNED-RETAIL-AMT           PIC S9(005)V99        00876399
008764                                             COMP-3.              00876499
008765     10  PV-UNIT-EXT-MISD-RI-MD-AMT         PIC S9(007)V99        00876599
008766                                             VALUE ZEROES         00876699
008767                                             COMP-3.              00876799
008768     10  PV-UNIT-EXT-MISD-RI-MDC-AMT        PIC S9(007)V99        00876899
008769                                             VALUE ZEROES         00876999
008770                                             COMP-3.              00877099
008771     10  PV-UNIT-EXT-MISD-SI-MU-AMT         PIC S9(007)V99        00877199
008772                                             VALUE ZEROES         00877299
008773                                             COMP-3.              00877399
008774     10  PV-UNIT-EXT-MISD-SI-MD-AMT         PIC S9(007)V99        00877499
008775                                             VALUE ZEROES         00877599
008776                                             COMP-3.              00877699
008779     10  PV-SKU-DTA-ATTRIB.                                       00877999
008780         15  PV-DEPT-CLASS             PIC  X(05).                00878099
008781         15  PV-DEPT-CLASS-NUM        REDEFINES                   00878199
008782             PV-DEPT-CLASS.                                       00878299
008783             20  PV-DEPARTMENT         PIC  9(03).                00878399
008784             20  PV-CLASS              PIC  9(02).                00878499
008785         15  PV-MAJ-CLASS              PIC  X(04).                00878599
008786     10  FILLER                        PIC  X(01) VALUE SPACES.   00878699
008787                                                                  00878799
008788*---------------------------------------------                    00878899
008789* PV-RPT- VARIABLES                                               00878999
008790*---------------------------------------------                    00879099
008791 01  PV-RPT-VARIABLES.                                            00879199
008792   05  PV-RPT-PROCESS-DATE.                                       00879299
008793     10  PV-RPT-PROCESS-MONTH               PIC  9(002)           00879399
008794                                             VALUE ZEROES.        00879499
008795     10  FILLER                             PIC  X(001)           00879599
008796                                             VALUE '/'.           00879699
008797     10  PV-RPT-PROCESS-DAY                 PIC  9(002)           00879799
008798                                             VALUE ZEROES.        00879899
008799     10  FILLER                             PIC  X(001)           00879999
008800                                             VALUE '/'.           00880099
008801     10  PV-RPT-PROCESS-YEAR                PIC  9(002)           00880199
008802                                             VALUE ZEROES.        00880299
008803   05  PV-RPT-CURRENT-TIME.                                       00880399
008804     10  PV-RPT-CURRENT-HOUR                PIC  9(002)           00880499
008805                                             VALUE ZEROES.        00880599
008806     10  PV-RPT-CURRENT-MINUTE              PIC  9(002)           00880699
008807                                             VALUE ZEROES.        00880799
008808     10  FILLER                             PIC  9(004)           00880899
008809                                             VALUE ZEROES.        00880999
008810   05  PV-RPT-HEADING-LINE-1.                                     00881099
008811     10  FILLER                             PIC  X(032)           00881199
008812                                             VALUE SPACES.        00881299
008813     10  FILLER                             PIC  X(039)           00881399
008814           VALUE 'SKU DETAIL OF MISSED MARKDOWN ACTIVITY '.       00881499
008815     10  FILLER                             PIC  X(022)           00881599
008816           VALUE 'ON EVEN EXCHANGES FOR '.                        00881699
008817     10  PV-RPT-HEAD-DATE                   PIC  X(010).          00881799
008818     10  FILLER                             PIC  X(029)           00881899
008819                                             VALUE SPACES.        00881999
008820   05  PV-RPT-COL-HEADING-LINE-1.                                 00882099
008821     10  FILLER                             PIC  X(087)           00882199
008822                                             VALUE SPACES.        00882299
008823     10  FILLER                             PIC  X(008)           00882399
008824           VALUE 'EXTENDED'.                                      00882499
008825     10  FILLER                             PIC  X(003)           00882599
008826                                             VALUE SPACES.        00882699
008827     10  FILLER                             PIC  X(008)           00882799
008828           VALUE 'EXTENDED'.                                      00882899
008829     10  FILLER                             PIC  X(003)           00882999
008830                                             VALUE SPACES.        00883099
008831     10  FILLER                             PIC  X(008)           00883199
008832           VALUE 'EXTENDED'.                                      00883299
008833     10  FILLER                             PIC  X(003)           00883399
008834                                             VALUE SPACES.        00883499
008835     10  FILLER                             PIC  X(008)           00883599
008836           VALUE 'EXTENDED'.                                      00883699
008837     10  FILLER                             PIC  X(004)           00883799
008838                                             VALUE SPACES.        00883899
008839   05  PV-RPT-COL-HEADING-LINE-2.                                 00883999
008840     10  FILLER                             PIC  X(056)           00884099
008841                                             VALUE SPACES.        00884199
008842     10  FILLER                             PIC  X(003)           00884299
008843           VALUE 'NET'.                                           00884399
008844     10  FILLER                             PIC  X(007)           00884499
008845                                             VALUE SPACES.        00884599
008846     10  FILLER                             PIC  X(007)           00884699
008847           VALUE 'CURRENT'.                                       00884799
008848     10  FILLER                             PIC  X(004)           00884899
008849                                             VALUE SPACES.        00884999
008850     10  FILLER                             PIC  X(005)           00885099
008851           VALUE 'OWNED'.                                         00885199
008852     10  FILLER                             PIC  X(006)           00885299
008853                                             VALUE SPACES.        00885399
008854     10  FILLER                             PIC  X(006)           00885499
008855           VALUE 'MISSED'.                                        00885599
008856     10  FILLER                             PIC  X(005)           00885699
008857                                             VALUE SPACES.        00885799
008858     10  FILLER                             PIC  X(006)           00885899
008859           VALUE 'MISSED'.                                        00885999
008860     10  FILLER                             PIC  X(005)           00886099
008861                                             VALUE SPACES.        00886199
008862     10  FILLER                             PIC  X(006)           00886299
008863           VALUE 'MISSED'.                                        00886399
008864     10  FILLER                             PIC  X(005)           00886499
008865                                             VALUE SPACES.        00886599
008866     10  FILLER                             PIC  X(006)           00886699
008867           VALUE 'MISSED'.                                        00886799
008868     10  FILLER                             PIC  X(005)           00886899
008869                                             VALUE SPACES.        00886999
008870   05  PV-RPT-COL-HEADING-LINE-3.                                 00887099
008871     10  FILLER                             PIC  X(013)           00887199
008872                                             VALUE SPACES.        00887299
008873     10  FILLER                             PIC  X(003)           00887399
008874           VALUE 'POS'.                                           00887499
008875     10  FILLER                             PIC  X(027)           00887599
008876                                             VALUE SPACES.        00887699
008877     10  FILLER                             PIC  X(008)           00887799
008878           VALUE 'CUSTOMER'.                                      00887899
008879     10  FILLER                             PIC  X(005)           00887999
008880                                             VALUE SPACES.        00888099
008881     10  FILLER                             PIC  X(003)           00888199
008882           VALUE 'AMT'.                                           00888299
008883     10  FILLER                             PIC  X(008)           00888399
008884                                             VALUE SPACES.        00888499
008885     10  FILLER                             PIC  X(004)           00888599
008886           VALUE 'UNIT'.                                          00888699
008887     10  FILLER                             PIC  X(007)           00888799
008888                                             VALUE SPACES.        00888899
008889     10  FILLER                             PIC  X(004)           00888999
008890           VALUE 'UNIT'.                                          00889099
008891     10  FILLER                             PIC  X(007)           00889199
008892                                             VALUE SPACES.        00889299
008893     10  FILLER                             PIC  X(004)           00889399
008894           VALUE 'SALE'.                                          00889499
008895     10  FILLER                             PIC  X(007)           00889599
008896                                             VALUE SPACES.        00889699
008897     10  FILLER                             PIC  X(004)           00889799
008898           VALUE 'SALE'.                                          00889899
008899     10  FILLER                             PIC  X(006)           00889999
008900                                             VALUE SPACES.        00890099
008901     10  FILLER                             PIC  X(006)           00890199
008902           VALUE 'RETURN'.                                        00890299
008903     10  FILLER                             PIC  X(005)           00890399
008904                                             VALUE SPACES.        00890499
008905     10  FILLER                             PIC  X(006)           00890599
008906           VALUE 'RETURN'.                                        00890699
008907     10  FILLER                             PIC  X(005)           00890799
008908                                             VALUE SPACES.        00890899
008909   05  PV-RPT-COL-HEADING-LINE-4.                                 00890999
008910     10  FILLER                             PIC  X(004)           00891099
008911                                             VALUE SPACES.        00891199
008912     10  FILLER                             PIC  X(003)           00891299
008913           VALUE 'SKU'.                                           00891399
008914     10  FILLER                             PIC  X(006)           00891499
008915                                             VALUE SPACES.        00891599
008916     10  FILLER                             PIC  X(004)           00891699
008917           VALUE 'DATE'.                                          00891799
008918     10  FILLER                             PIC  X(003)           00891899
008919                                             VALUE SPACES.        00891999
008920     10  FILLER                             PIC  X(003)           00892099
008921           VALUE 'STR'.                                           00892199
008922     10  FILLER                             PIC  X(002)           00892299
008923                                             VALUE SPACES.        00892399
008924     10  FILLER                             PIC  X(004)           00892499
008925           VALUE 'TERM'.                                          00892599
008926     10  FILLER                             PIC  X(001)           00892699
008927                                             VALUE SPACES.        00892799
008928     10  FILLER                             PIC  X(004)           00892899
008929           VALUE 'TRAN'.                                          00892999
008930     10  FILLER                             PIC  X(002)           00893099
008931                                             VALUE SPACES.        00893199
008932     10  FILLER                             PIC  X(003)           00893299
008933           VALUE 'QTY'.                                           00893399
008934     10  FILLER                             PIC  X(004)           00893499
008935                                             VALUE SPACES.        00893599
008936     10  FILLER                             PIC  X(007)           00893699
008937           VALUE 'CHARGED'.                                       00893799
008938     10  FILLER                             PIC  X(004)           00893899
008939                                             VALUE SPACES.        00893999
008940     10  FILLER                             PIC  X(007)           00894099
008941           VALUE 'CHARGED'.                                       00894199
008942     10  FILLER                             PIC  X(005)           00894299
008943                                             VALUE SPACES.        00894399
008944     10  FILLER                             PIC  X(006)           00894499
008945           VALUE 'RETAIL'.                                        00894599
008946     10  FILLER                             PIC  X(005)           00894699
008947                                             VALUE SPACES.        00894799
008948     10  FILLER                             PIC  X(006)           00894899
008949           VALUE 'RETAIL'.                                        00894999
008950     10  FILLER                             PIC  X(007)           00895099
008951                                             VALUE SPACES.        00895199
008952     10  FILLER                             PIC  X(002)           00895299
008953           VALUE 'MD'.                                            00895399
008954     10  FILLER                             PIC  X(009)           00895499
008955                                             VALUE SPACES.        00895599
008956     10  FILLER                             PIC  X(002)           00895699
008957           VALUE 'MU'.                                            00895799
008958     10  FILLER                             PIC  X(008)           00895899
008959                                             VALUE SPACES.        00895999
008960     10  FILLER                             PIC  X(003)           00896099
008961           VALUE 'MDC'.                                           00896199
008962     10  FILLER                             PIC  X(009)           00896299
008963                                             VALUE SPACES.        00896399
008964     10  FILLER                             PIC  X(002)           00896499
008965           VALUE 'MD'.                                            00896599
008966     10  FILLER                             PIC  X(007)           00896699
008967                                             VALUE SPACES.        00896799
008968   05  PV-RPT-SKU-DETAIL-LINE.                                    00896899
008969     10  FILLER                             PIC  X(002)           00896999
008970                                             VALUE SPACES.        00897099
008971     10  PV-RPT-SKU-NBR                     PIC  X(008).          00897199
008972     10  FILLER                             PIC  X(001)           00897299
008973                                             VALUE SPACES.        00897399
008974     10  PV-RPT-POS-DATE.                                         00897499
008975       15  PV-RPT-POS-DATE-MM               PIC  X(002)           00897599
008976                                             VALUE SPACES.        00897699
008977       15  PV-RPT-POS-DATE-S1               PIC  X(001)           00897799
008978                                             VALUE SPACES.        00897899
008979       15  PV-RPT-POS-DATE-DD               PIC  X(002)           00897999
008980                                             VALUE SPACES.        00898099
008981       15  PV-RPT-POS-DATE-S2               PIC  X(001)           00898199
008982                                             VALUE SPACES.        00898299
008983       15  PV-RPT-POS-DATE-YY               PIC  X(002)           00898399
008984                                             VALUE SPACES.        00898499
008985     10  FILLER                             PIC  X(001)           00898599
008986                                             VALUE SPACES.        00898699
008987     10  PV-RPT-STR-NBR                     PIC  X(004)           00898799
008988                                             VALUE SPACES.        00898899
008989     10  FILLER                             PIC  X(001)           00898999
008990                                             VALUE SPACES.        00899099
008991     10  PV-RPT-TERM-NBR                    PIC  X(004)           00899199
008992                                             VALUE SPACES.        00899299
008993     10  FILLER                             PIC  X(001)           00899399
008994                                             VALUE SPACES.        00899499
008995     10  PV-RPT-TRAN-NBR                    PIC  X(004)           00899599
008996                                             VALUE SPACES.        00899699
008997     10  FILLER                             PIC  X(001)           00899799
008998                                             VALUE SPACES.        00899899
008999     10  PV-RPT-QTY-NBR                     PIC ZZZZZ9.           00899999
009000     10  FILLER                             PIC  X(001)           00900099
009001                                             VALUE SPACES.        00900199
009002     10  PV-RPT-CUST-CHRGD-AMT                                    00900299
009003           PIC ZZ,ZZ9.99-.                                        00900399
009004     10  FILLER                             PIC  X(001)           00900499
009005                                             VALUE SPACES.        00900599
009006     10  PV-RPT-NET-CHRGD-AMT                                     00900699
009007           PIC ZZ,ZZ9.99-.                                        00900799
009008     10  FILLER                             PIC  X(001)           00900899
009009                                             VALUE SPACES.        00900999
009010     10  PV-RPT-CURR-UNIT-RTL-AMT                                 00901099
009011           PIC ZZ,ZZ9.99-.                                        00901199
009012     10  FILLER                             PIC  X(001)           00901299
009013                                             VALUE SPACES.        00901399
009014     10  PV-RPT-OWN-UNIT-RTL-AMT                                  00901499
009015           PIC ZZ,ZZ9.99-.                                        00901599
009016     10  FILLER                             PIC  X(001)           00901699
009017                                             VALUE SPACES.        00901799
009018     10  PV-RPT-EXT-MISD-SLE-MD                                   00901899
009019           PIC ZZ,ZZ9.99-.                                        00901999
009020     10  FILLER                             PIC  X(001)           00902099
009021                                             VALUE SPACES.        00902199
009022     10  PV-RPT-EXT-MISD-SLE-MU                                   00902299
009023           PIC ZZ,ZZ9.99-.                                        00902399
009024     10  FILLER                             PIC  X(001)           00902499
009025                                             VALUE SPACES.        00902599
009026     10  PV-RPT-EXT-MISD-RTRN-MDC                                 00902699
009027           PIC ZZ,ZZ9.99-.                                        00902799
009028     10  FILLER                             PIC  X(001)           00902899
009029                                             VALUE SPACES.        00902999
009030     10  PV-RPT-EXT-MISD-RTRN-MD                                  00903099
009031           PIC ZZ,ZZ9.99-.                                        00903199
009032     10  FILLER                             PIC  X(003)           00903299
009033                                             VALUE SPACES.        00903399
009034                                                                  00903499
009035   05  PV-RPT-SKU-CORP-TOTAL-LINE.                                00903599
009036     10  FILLER                             PIC  X(002)           00903699
009037                                             VALUE SPACES.        00903799
009038     10  PV-RPT-CORP-SKU-NBR                PIC  X(008).          00903899
009039     10  FILLER                             PIC  X(071)           00903999
009040                                             VALUE SPACES.        00904099
009075     10  PV-RPT-CORP-EXT-MISD-SLE-MD                              00907599
009076           PIC Z,ZZZ,ZZ9.99-.                                     00907699
009079     10  PV-RPT-CORP-EXT-MISD-SLE-MU                              00907999
009080           PIC Z,ZZZ,ZZ9.99-.                                     00908099
009083     10  PV-RPT-CORP-EXT-MISD-RTRN-MDC                            00908399
009084           PIC Z,ZZZ,ZZ9.99-.                                     00908499
009087     10  PV-RPT-CORP-EXT-MISD-RTRN-MD                             00908799
009088           PIC Z,ZZZ,ZZ9.99-.                                     00908899
009091                                                                  00909199
009092*---------------------------------------------                    00909299
009093* SC- FILE STATUSES                                               00909399
009094*---------------------------------------------                    00909499
009095 01  SC-FILE-STATUS-CODES.                                        00909599
009096   05  SC-MKUP-MKDN-FILE-STATUS             PIC  X(002)           00909699
009097                                             VALUE SPACES.        00909799
009098     88  SC-MKUP-MKDN-FILE-OK                VALUE '00'.          00909899
009099     88  SC-MKUP-MKDN-FILE-EOF               VALUE '10'.          00909999
009100   05  SC-POS-DATE-FILE-STATUS              PIC  X(002)           00910099
009101                                             VALUE SPACES.        00910199
009102     88  SC-POS-DATE-STATUS-OK               VALUE '00'.          00910299
009103                                                                  00910399
009104*---------------------------------------------                    00910499
009105* KOHLS STANDARD 132 BYTE REPORT LAYOUT.                          00910599
009106*---------------------------------------------                    00910699
009107     COPY DPWS132O.                                               00910799
009108                                                                  00910899
009109*---------------------------------------------                    00910999
009110* KOHLS DATE ROUTINE COPY MEMBERS.                                00911099
009111*---------------------------------------------                    00911199
009120     COPY DPWS500.                                                00912099
009200                                                                  00920031
042900*----------------------------------------------------------       04290000
043000 PROCEDURE DIVISION.                                              04300099
043100*----------------------------------------------------------       04310000
043200 0000-MAINLINE.                                                   04320000
043300                                                                  04330000
043301     PERFORM 1000-INITIALIZE.                                     04330111
043302                                                                  04330200
043305     PERFORM 2000-CREATE-MKUP-MKDWN-REPORT                        04330599
043306       UNTIL PS-END-PROCESSING.                                   04330699
043307                                                                  04330731
043308     PERFORM 9999-CLEAN-UP.                                       04330899
043309                                                                  04330999
044100     GOBACK.                                                      04410000
044200                                                                  04420000
044300*0000-EXIT.                                                       04430000
044400 EJECT                                                            04440000
044401                                                                  04440111
044402*----------------------------------------------------------       04440200
044403* 1000-INITIALIZE.                                                04440300
044406*----------------------------------------------------------       04440600
044407 1000-INITIALIZE.                                                 04440700
044408                                                                  04440800
044430     OPEN INPUT  MKUP-MKDN-FILE                                   04443099
044440                 POS-DATE-FILE                                    04444099
044462          OUTPUT RPT-MISSED-MKUP-MKDWN-ACT.                       04446299
044479                                                                  04447931
044484     IF NOT SC-MKUP-MKDN-FILE-OK                                  04448499
044485       DISPLAY ' '                                                04448531
044486       DISPLAY '** ABEND     **'                                  04448631
044487       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              04448731
044488       DISPLAY '** PARAGRAPH **'                                  04448831
044489        '= 1000-INITIALIZE'                                       04448931
044490       DISPLAY '** POS MARKUP/MARKDOWN FILE OPEN ERROR'           04449099
044491       DISPLAY '** FILE STATUS IS = '                             04449131
044492        SC-MKUP-MKDN-FILE-STATUS                                  04449299
044493       MOVE +4005 TO ABEND-CODE                                   04449331
044494       CALL 'ILBOABN0' USING ABEND-CODE                           04449431
044495     END-IF.                                                      04449531
044544                                                                  04454431
044552     SET PS-CONTINUE-PROCESSING                                   04455299
044553         PS-FIRST-READ                                            04455399
044554         PS-DONT-ADVANCE-PAGE                                     04455499
044555         PS-DONT-WRITE-PREV-MONTH-NAME TO TRUE.                   04455599
044558                                                                  04455899
044566*** RETRIEVE DATA FOR CONTROL CARD DATE                           04456699
044567     PERFORM 1100-RET-CONTROL-CARD-DATA.                          04456799
044568                                                                  04456899
044592     ACCEPT PV-CPU-DATE FROM DATE.                                04459299
044593     ACCEPT PV-RPT-CURRENT-TIME FROM TIME.                        04459399
044594                                                                  04459499
044620*1000-EXIT.                                                       04462031
044621 EJECT                                                            04462131
044622                                                                  04462231
044623*----------------------------------------------------------       04462399
044624* 1100-RET-CONTROL-CARD-DATA.                                     04462499
044625*----------------------------------------------------------       04462599
044626 1100-RET-CONTROL-CARD-DATA.                                      04462699
044628                                                                  04462899
044631     READ POS-DATE-FILE                                           04463199
044632       INTO CC-POS-DATE-CARD                                      04463299
044633         AT END                                                   04463399
044634           DISPLAY ' '                                            04463499
044635           DISPLAY '** ABEND     **'                              04463599
044636           DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME          04463699
044637           DISPLAY '** PARAGRAPH **'                              04463799
044638            '= 1100-RET-CONTROL-CARD-DATA'                        04463899
044639           DISPLAY '** CONTROL CARD DATE RECORD IS MISSING'       04463999
044640           MOVE +4003 TO ABEND-CODE                               04464099
044641           CALL 'ILBOABN0' USING ABEND-CODE                       04464199
044642     END-READ.                                                    04464299
044643                                                                  04464399
044644*** CAPTURE DATA ON THE FISCAL MONTH OF THE CONTROL CARD          04464499
044645*** DATE                                                          04464599
044646     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04464699
044647                                                                  04464799
044648     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       04464899
044649     SET DPG52-LK-DTE-GREG         TO TRUE.                       04464999
044650                                                                  04465099
044651     MOVE CC-POS-DATE-MMDDYY TO DPG52-LK-DATE-INPUT.              04465199
044652                                                                  04465299
044653     CALL DP500-KOHLS-CALENDAR-ROUTINE                            04465399
044654       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 04465499
044655                                                                  04465599
044656     EVALUATE TRUE                                                04465699
044657       WHEN DPG54-NO-ERROR                                        04465799
044658         CONTINUE                                                 04465899
044659       WHEN OTHER                                                 04465999
044660         DISPLAY ' '                                              04466099
044661         DISPLAY '** ABEND     **'                                04466199
044662         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04466299
044663         DISPLAY '** PARAGRAPH **'                                04466399
044664          '= 1100-RET-CONTROL-CARD-DATA'                          04466499
044665         DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE        04466599
044666         MOVE +4019 TO ABEND-CODE                                 04466699
044667         CALL 'ILBOABN0' USING ABEND-CODE                         04466799
044668     END-EVALUATE.                                                04466899
044669                                                                  04466999
044670     MOVE DPG55-GREG-CC-DATE-FMT  TO PV-CC-GREG-CC-FMT-DATE.      04467099
044671     MOVE DPG56-FISCAL-PERIOD-NBR TO PV-CC-FISCAL-ACCT-MONTH.     04467199
044672     MOVE DPG56-FIRST-FP-DB2-ISO-FMT                              04467299
044673      TO PV-CC-FISCAL-FP-ISO-FMT.                                 04467399
044674                                                                  04467499
044675*** CAPTURE DATA ON THE PREVIOUS FISCAL MONTH IN RESPECT          04467599
044676*** TO THE CONTROL CARD DATE                                      04467699
044677     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04467799
044678                                                                  04467899
044679     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       04467999
044680     SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       04468099
044681                                                                  04468199
044682     SET DPG51-DECREMENT-DATE TO TRUE.                            04468299
044683     MOVE 1 TO DPG51-INCR-DECR-DAYS-9.                            04468399
044684                                                                  04468499
044686     MOVE PV-CC-FISCAL-FP-ISO-FMT TO DPG52-LK-DATE-INPUT.         04468699
044687                                                                  04468799
044688     CALL DP500-KOHLS-CALENDAR-ROUTINE                            04468899
044689       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 04468999
044690                                                                  04469099
044691     EVALUATE TRUE                                                04469199
044692       WHEN DPG54-NO-ERROR                                        04469299
044693         CONTINUE                                                 04469399
044694       WHEN OTHER                                                 04469499
044695         DISPLAY ' '                                              04469599
044696         DISPLAY '** ABEND     **'                                04469699
044697         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04469799
044698         DISPLAY '** PARAGRAPH **'                                04469899
044699          '= 1100-RET-CONTROL-CARD-DATA'                          04469999
044700         DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE        04470099
044701         MOVE +4019 TO ABEND-CODE                                 04470199
044702         CALL 'ILBOABN0' USING ABEND-CODE                         04470299
044703     END-EVALUATE.                                                04470399
044704                                                                  04470499
044705     MOVE DPG56-FISCAL-PERIOD-NAME                                04470599
044706      TO PV-CC-PREV-FISCAL-MONTH-NAME.                            04470699
044708                                                                  04470899
044709*1100-EXIT.                                                       04470999
044710 EJECT                                                            04471099
044711                                                                  04471199
044712*----------------------------------------------------------       04471299
044713* 2000-CREATE-MKUP-MKDWN-REPORT.                                  04471399
044714*----------------------------------------------------------       04471499
044715 2000-CREATE-MKUP-MKDWN-REPORT.                                   04471599
044716                                                                  04471699
044717     PERFORM 8010-READ-MKUP-MKDN-FILE.                            04471799
044718                                                                  04471899
044719     IF PV-ACCT-MONTH    NOT = PV-ACCT-MONTH-HOLD                 04471999
044720      OR PV-STORE-NUMBER NOT = PV-STORE-NUMBER-HOLD               04472099
044721      OR PV-DEPARTMENT   NOT = PV-DEPARTMENT-HOLD                 04472199
044722      OR PV-CLASS        NOT = PV-CLASS-HOLD                      04472299
044723      OR SC-MKUP-MKDN-FILE-EOF                                    04472399
044724        PERFORM 2020-REPORT-BREAKS                                04472499
044725     END-IF.                                                      04472599
044726                                                                  04472699
044727     IF SC-MKUP-MKDN-FILE-OK                                      04472799
044728       IF PV-LINE-COUNT > PC-MAX-PAGE-SIZE                        04472899
044729         PERFORM 7010-NEW-PAGE                                    04472999
044730       END-IF                                                     04473099
044731       PERFORM 2010-PROCESS-IND-RECORD-FIELDS                     04473199
044732     ELSE                                                         04473299
044733       DISPLAY 'END OF FILE'                                      04473399
044734       SET PS-END-PROCESSING TO TRUE                              04473499
044735     END-IF.                                                      04473599
044736                                                                  04473699
044737*2000-EXIT.                                                       04473799
044738 EJECT                                                            04473899
044739                                                                  04473999
044740*----------------------------------------------------------       04474099
044741* 2010-PROCESS-IND-RECORD-FIELDS.                                 04474199
044742*----------------------------------------------------------       04474299
044743 2010-PROCESS-IND-RECORD-FIELDS.                                  04474399
044744                                                                  04474499
044745*** MOVE FIELDS FROM THE RECORD TO THE REPORT VARIABLES           04474599
044746     COMPUTE PV-TRANSACTION-DATE-YMD =                            04474699
044747       PV-POS-DATE-YMD * PC-DECIMAL-SHIFT-RIGHT.                  04474799
044748     MOVE PV-TRANSACTION-DATE-MONTH TO PV-RPT-POS-DATE-MM.        04474899
044749     MOVE PC-DATE-SLASH             TO PV-RPT-POS-DATE-S1.        04474999
044750     MOVE PV-TRANSACTION-DATE-DAY   TO PV-RPT-POS-DATE-DD.        04475099
044751     MOVE PC-DATE-SLASH             TO PV-RPT-POS-DATE-S2.        04475199
044752     MOVE PV-TRANSACTION-DATE-YEAR  TO PV-RPT-POS-DATE-YY.        04475299
044753                                                                  04475399
044754     MOVE PV-SKU                   TO PV-RPT-SKU-NBR.             04475499
044755     MOVE PV-STORE-NUMBER          TO PV-RPT-STR-NBR.             04475599
044756     MOVE PV-TERMINAL-NUMBER       TO PV-RPT-TERM-NBR.            04475699
044757     MOVE PV-TRANSACTION-NUMBER    TO PV-RPT-TRAN-NBR.            04475799
044758     MOVE PV-UNIT-QTY              TO PV-RPT-QTY-NBR.             04475899
044759                                                                  04475999
044760     MOVE PV-UNIT-CUST-CHARGED-AMT TO PV-RPT-CUST-CHRGD-AMT.      04476099
044761     MOVE PV-UNIT-NET-AMT-CHARGED  TO PV-RPT-NET-CHRGD-AMT.       04476199
044762     MOVE PV-UNIT-RETAIL-AMT                                      04476299
044763      TO PV-RPT-CURR-UNIT-RTL-AMT.                                04476399
044764     MOVE PV-UNIT-OWNED-RETAIL-AMT                                04476499
044765      TO PV-RPT-OWN-UNIT-RTL-AMT.                                 04476599
044766                                                                  04476699
044767     MOVE PV-UNIT-EXT-MISD-SI-MD-AMT                              04476799
044768      TO PV-RPT-EXT-MISD-SLE-MD.                                  04476899
044769     MOVE PV-UNIT-EXT-MISD-SI-MU-AMT                              04476999
044770      TO PV-RPT-EXT-MISD-SLE-MU.                                  04477099
044771     MOVE PV-UNIT-EXT-MISD-RI-MDC-AMT                             04477199
044772      TO PV-RPT-EXT-MISD-RTRN-MDC.                                04477299
044773     MOVE PV-UNIT-EXT-MISD-RI-MD-AMT                              04477399
044774      TO PV-RPT-EXT-MISD-RTRN-MD.                                 04477499
044775                                                                  04477599
044776     MOVE PV-RPT-SKU-DETAIL-LINE                                  04477699
044777      TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                           04477799
044778                                                                  04477899
044779*** WRITE THE INDIVIDUAL REPORT DETAIL LINE                       04477999
044780     MOVE 1 TO PV-LINES-TO-ADVANCE.                               04478099
044781     PERFORM 9010-WRITE-REPORT-LINE                               04478199
044782                                                                  04478299
044783*** ADD THE EXTENDED FIELD VALUES TO THE STORE TOTAL FIELDS       04478399
044784     ADD PV-UNIT-EXT-MISD-SI-MD-AMT                               04478499
044785      TO PV-STR-EXT-MISD-SI-MD-AMT.                               04478599
044786     ADD PV-UNIT-EXT-MISD-SI-MU-AMT                               04478699
044787      TO PV-STR-EXT-MISD-SI-MU-AMT.                               04478799
044788     ADD PV-UNIT-EXT-MISD-RI-MDC-AMT                              04478899
044789      TO PV-STR-EXT-MISD-RI-MDC-AMT.                              04478999
044790     ADD PV-UNIT-EXT-MISD-RI-MD-AMT                               04479099
044791      TO PV-STR-EXT-MISD-RI-MD-AMT.                               04479199
044792                                                                  04479299
044793*** ADD THE EXTENDED FIELD VALUES TO THE D/C TOTAL FIELDS         04479399
044794     ADD PV-UNIT-EXT-MISD-SI-MD-AMT                               04479499
044795      TO PV-DC-EXT-MISD-SI-MD-AMT.                                04479599
044796     ADD PV-UNIT-EXT-MISD-SI-MU-AMT                               04479699
044797      TO PV-DC-EXT-MISD-SI-MU-AMT.                                04479799
044798     ADD PV-UNIT-EXT-MISD-RI-MDC-AMT                              04479899
044799      TO PV-DC-EXT-MISD-RI-MDC-AMT.                               04479999
044800     ADD PV-UNIT-EXT-MISD-RI-MD-AMT                               04480099
044801      TO PV-DC-EXT-MISD-RI-MD-AMT.                                04480199
044802                                                                  04480299
044803*** ADD THE EXTENDED FIELD VALUES TO THE CORPORATE TOTAL          04480399
044804*** FIELDS                                                        04480499
044805     ADD PV-UNIT-EXT-MISD-SI-MD-AMT                               04480599
044806      TO PV-CORP-EXT-MISD-SI-MD-AMT.                              04480699
044807     ADD PV-UNIT-EXT-MISD-SI-MU-AMT                               04480799
044808      TO PV-CORP-EXT-MISD-SI-MU-AMT.                              04480899
044809     ADD PV-UNIT-EXT-MISD-RI-MDC-AMT                              04480999
044810      TO PV-CORP-EXT-MISD-RI-MDC-AMT.                             04481099
044811     ADD PV-UNIT-EXT-MISD-RI-MD-AMT                               04481199
044812      TO PV-CORP-EXT-MISD-RI-MD-AMT.                              04481299
044813                                                                  04481399
044814*2010-EXIT.                                                       04481499
044815 EJECT                                                            04481599
044816                                                                  04481699
044820*----------------------------------------------------------       04482099
044821* 2020-REPORT-BREAKS.                                             04482199
044830*----------------------------------------------------------       04483099
044831 2020-REPORT-BREAKS.                                              04483199
044832                                                                  04483299
044840     IF PV-ACCT-MONTH NOT = PV-ACCT-MONTH-HOLD                    04484099
044850       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04485099
044860                      PV-RPT-SKU-DETAIL-LINE                      04486099
044870                                                                  04487099
044880       MOVE PV-DEPT-CLS-COMB-HOLD TO PV-RPT-SKU-NBR               04488099
044890                                                                  04489099
044891       MOVE PV-DC-EXT-MISD-RI-MD-AMT                              04489199
044892        TO PV-RPT-EXT-MISD-RTRN-MD                                04489299
044893       MOVE PV-DC-EXT-MISD-RI-MDC-AMT                             04489399
044894        TO PV-RPT-EXT-MISD-RTRN-MDC                               04489499
044895       MOVE PV-DC-EXT-MISD-SI-MU-AMT                              04489599
044896        TO PV-RPT-EXT-MISD-SLE-MU                                 04489699
044897       MOVE PV-DC-EXT-MISD-SI-MD-AMT                              04489799
044898        TO PV-RPT-EXT-MISD-SLE-MD                                 04489899
044899                                                                  04489999
044900       MOVE PV-RPT-SKU-DETAIL-LINE                                04490099
044901        TO RPT-MISSED-MKUP-MKDWN-ACT-REC                          04490199
044902       MOVE 2 TO PV-LINES-TO-ADVANCE                              04490299
044903       PERFORM 9010-WRITE-REPORT-LINE                             04490399
044904                                                                  04490499
044905       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04490599
044906       MOVE 1 TO PV-LINES-TO-ADVANCE                              04490699
044907       PERFORM 9010-WRITE-REPORT-LINE                             04490799
044908                                                                  04490899
044918       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04491899
044920                      PV-RPT-SKU-CORP-TOTAL-LINE                  04492099
044923       SET PS-WRITE-PREV-MONTH-NAME TO TRUE                       04492399
044924       PERFORM 7010-NEW-PAGE                                      04492499
044925       SET PS-DONT-WRITE-PREV-MONTH-NAME TO TRUE                  04492599
044926                                                                  04492699
044927       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04492799
044928                      PV-RPT-SKU-CORP-TOTAL-LINE                  04492899
044929                                                                  04492999
044930       MOVE PC-ALL TO PV-RPT-CORP-SKU-NBR                         04493099
044931                                                                  04493199
044932       MOVE PV-CORP-EXT-MISD-RI-MD-AMT                            04493299
044933        TO PV-RPT-CORP-EXT-MISD-RTRN-MD                           04493399
044934       MOVE PV-CORP-EXT-MISD-RI-MDC-AMT                           04493499
044935        TO PV-RPT-CORP-EXT-MISD-RTRN-MDC                          04493599
044936       MOVE PV-CORP-EXT-MISD-SI-MU-AMT                            04493699
044937        TO PV-RPT-CORP-EXT-MISD-SLE-MU                            04493799
044938       MOVE PV-CORP-EXT-MISD-SI-MD-AMT                            04493899
044939        TO PV-RPT-CORP-EXT-MISD-SLE-MD                            04493999
044940                                                                  04494099
044941       MOVE PV-RPT-SKU-CORP-TOTAL-LINE                            04494199
044942        TO RPT-MISSED-MKUP-MKDWN-ACT-REC                          04494299
044943       MOVE 4 TO PV-LINES-TO-ADVANCE                              04494399
044944       PERFORM 9010-WRITE-REPORT-LINE                             04494499
044945                                                                  04494599
044946       PERFORM 7010-NEW-PAGE                                      04494699
044947                                                                  04494799
044948       INITIALIZE PV-CORP-TOTAL-FIELDS                            04494899
044949                  PV-DEPT-CLS-TOTAL-FIELDS                        04494999
044950                  PV-STR-TOTAL-FIELDS                             04495099
044951                                                                  04495199
044952       MOVE PV-ACCT-MONTH   TO PV-ACCT-MONTH-HOLD                 04495299
044953       MOVE PV-STORE-NUMBER TO PV-STORE-NUMBER-HOLD               04495399
044954       MOVE PV-DEPARTMENT   TO PV-DEPARTMENT-HOLD                 04495499
044955       MOVE PV-CLASS        TO PV-CLASS-HOLD                      04495599
044956     END-IF.                                                      04495699
044957                                                                  04495799
044958     IF PV-STORE-NUMBER NOT = PV-STORE-NUMBER-HOLD                04495899
044959       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04495999
044960                      PV-RPT-SKU-DETAIL-LINE                      04496099
044961                                                                  04496199
044962       MOVE PV-DEPT-CLS-COMB-HOLD TO PV-RPT-SKU-NBR               04496299
044963       MOVE PV-STORE-NUMBER-HOLD  TO PV-RPT-STR-NBR               04496399
044964                                                                  04496499
044965       MOVE PV-STR-EXT-MISD-RI-MD-AMT                             04496599
044966        TO PV-RPT-EXT-MISD-RTRN-MD                                04496699
044967       MOVE PV-STR-EXT-MISD-RI-MDC-AMT                            04496799
044968        TO PV-RPT-EXT-MISD-RTRN-MDC                               04496899
044969       MOVE PV-STR-EXT-MISD-SI-MU-AMT                             04496999
044970        TO PV-RPT-EXT-MISD-SLE-MU                                 04497099
044971       MOVE PV-STR-EXT-MISD-SI-MD-AMT                             04497199
044972        TO PV-RPT-EXT-MISD-SLE-MD                                 04497299
044973                                                                  04497399
044974       MOVE PV-RPT-SKU-DETAIL-LINE                                04497499
044975        TO RPT-MISSED-MKUP-MKDWN-ACT-REC                          04497599
044976       MOVE 1 TO PV-LINES-TO-ADVANCE                              04497699
044977       PERFORM 9010-WRITE-REPORT-LINE                             04497799
044978                                                                  04497899
044979       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04497999
044980       MOVE 1 TO PV-LINES-TO-ADVANCE                              04498099
044981       PERFORM 9010-WRITE-REPORT-LINE                             04498199
044982                                                                  04498299
044983       INITIALIZE PV-STR-TOTAL-FIELDS                             04498399
044984       MOVE PV-STORE-NUMBER TO PV-STORE-NUMBER-HOLD               04498499
044985     END-IF.                                                      04498599
044990                                                                  04499099
045000     IF PV-DEPARTMENT  NOT = PV-DEPARTMENT-HOLD                   04500099
045100      OR PV-CLASS      NOT = PV-CLASS-HOLD                        04510099
045101        MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC              04510199
045102                       PV-RPT-SKU-DETAIL-LINE                     04510299
045103                                                                  04510399
045104        MOVE PV-DEPT-CLS-COMB-HOLD TO PV-RPT-SKU-NBR              04510499
045105                                                                  04510599
045106        MOVE PV-DC-EXT-MISD-RI-MD-AMT                             04510699
045107         TO PV-RPT-EXT-MISD-RTRN-MD                               04510799
045108        MOVE PV-DC-EXT-MISD-RI-MDC-AMT                            04510899
045109         TO PV-RPT-EXT-MISD-RTRN-MDC                              04510999
045110        MOVE PV-DC-EXT-MISD-SI-MU-AMT                             04511099
045111         TO PV-RPT-EXT-MISD-SLE-MU                                04511199
045112        MOVE PV-DC-EXT-MISD-SI-MD-AMT                             04511299
045113         TO PV-RPT-EXT-MISD-SLE-MD                                04511399
045114                                                                  04511499
045115        MOVE PV-RPT-SKU-DETAIL-LINE                               04511599
045116         TO RPT-MISSED-MKUP-MKDWN-ACT-REC                         04511699
045117        MOVE 2 TO PV-LINES-TO-ADVANCE                             04511799
045118        PERFORM 9010-WRITE-REPORT-LINE                            04511899
045122                                                                  04512299
045123        MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC              04512399
045124        MOVE 1 TO PV-LINES-TO-ADVANCE                             04512499
045125        PERFORM 9010-WRITE-REPORT-LINE                            04512599
045129                                                                  04512999
045130        INITIALIZE PV-DEPT-CLS-TOTAL-FIELDS                       04513099
045131        MOVE PV-STORE-NUMBER TO PV-STORE-NUMBER-HOLD              04513199
045132        MOVE PV-DEPARTMENT   TO PV-DEPARTMENT-HOLD                04513299
045133        MOVE PV-CLASS        TO PV-CLASS-HOLD                     04513399
045134     END-IF.                                                      04513499
045135                                                                  04513599
045136     IF SC-MKUP-MKDN-FILE-EOF                                     04513699
045137       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04513799
045138                      PV-RPT-SKU-CORP-TOTAL-LINE                  04513899
045139       PERFORM 7010-NEW-PAGE                                      04513999
045140                                                                  04514099
045141       MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC               04514199
045142                      PV-RPT-SKU-CORP-TOTAL-LINE                  04514299
045143                                                                  04514399
045144       MOVE PC-ALL TO PV-RPT-CORP-SKU-NBR                         04514499
045145                                                                  04514599
045146       MOVE PV-CORP-EXT-MISD-RI-MD-AMT                            04514699
045147        TO PV-RPT-CORP-EXT-MISD-RTRN-MD                           04514799
045148       MOVE PV-CORP-EXT-MISD-RI-MDC-AMT                           04514899
045149        TO PV-RPT-CORP-EXT-MISD-RTRN-MDC                          04514999
045150       MOVE PV-CORP-EXT-MISD-SI-MU-AMT                            04515099
045151        TO PV-RPT-CORP-EXT-MISD-SLE-MU                            04515199
045152       MOVE PV-CORP-EXT-MISD-SI-MD-AMT                            04515299
045153        TO PV-RPT-CORP-EXT-MISD-SLE-MD                            04515399
045154                                                                  04515499
045155       MOVE PV-RPT-SKU-CORP-TOTAL-LINE                            04515599
045156        TO RPT-MISSED-MKUP-MKDWN-ACT-REC                          04515699
045157       MOVE 4 TO PV-LINES-TO-ADVANCE                              04515799
045158       PERFORM 9010-WRITE-REPORT-LINE                             04515899
045159     END-IF.                                                      04515999
045160                                                                  04516099
045161*2020-EXIT.                                                       04516199
045162 EJECT                                                            04516299
045170                                                                  04517099
045294*----------------------------------------------------------       04529499
045295* 7010-NEW-PAGE.                                                  04529599
045296*----------------------------------------------------------       04529699
045297 7010-NEW-PAGE.                                                   04529799
045298                                                                  04529899
045299     MOVE PV-CPU-DATE-YY TO DP132O-RUN-YEAR.                      04529999
045300     MOVE PV-CPU-DATE-MM TO DP132O-RUN-MONTH.                     04530099
045301     MOVE PV-CPU-DATE-DD TO DP132O-RUN-DAY.                       04530199
045302                                                                  04530299
045303     MOVE PV-RPT-CURRENT-HOUR   TO DP132O-RUN-HOUR.               04530399
045304     MOVE PV-RPT-CURRENT-MINUTE TO DP132O-RUN-MINUTE.             04530499
045305                                                                  04530599
045306     MOVE PC-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.               04530699
045307     MOVE '1'               TO DP132O-REPORT-NUMBER.              04530799
045308     ADD +1                 TO PV-PAGE-COUNT.                     04530899
045309     MOVE PV-PAGE-COUNT     TO DP132O-PAGE-NUMBER.                04530999
045310                                                                  04531099
045311     MOVE DP132O-STANDRD-HEADER-132-COLS                          04531199
045312       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04531299
045313     IF PV-PAGE-COUNT > 1                                         04531399
045314       SET PS-ADVANCE-PAGE TO TRUE                                04531499
045319       PERFORM 9010-WRITE-REPORT-LINE                             04531999
045321       MOVE +1 TO PV-LINE-COUNT                                   04532199
045322       SET PS-DONT-ADVANCE-PAGE TO TRUE                           04532299
045323     ELSE                                                         04532399
045324       MOVE 0 TO PV-LINES-TO-ADVANCE                              04532499
045325       MOVE +1 TO PV-LINE-COUNT                                   04532599
045326       PERFORM 9010-WRITE-REPORT-LINE                             04532699
045328     END-IF.                                                      04532899
045329                                                                  04532999
045331     IF PV-ACCT-MONTH = PV-CC-FISCAL-ACCT-MONTH                   04533199
045332      AND PS-DONT-WRITE-PREV-MONTH-NAME                           04533299
045334        MOVE PV-CC-GREG-CC-FMT-DATE       TO PV-RPT-HEAD-DATE     04533499
045335     ELSE                                                         04533599
045336        MOVE PV-CC-PREV-FISCAL-MONTH-NAME TO PV-RPT-HEAD-DATE     04533699
045340     END-IF.                                                      04534099
045346     MOVE PV-RPT-HEADING-LINE-1                                   04534699
045347       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04534799
045349     MOVE 2 TO PV-LINES-TO-ADVANCE.                               04534999
045350     PERFORM 9010-WRITE-REPORT-LINE.                              04535099
045351                                                                  04535199
045352     MOVE PV-RPT-COL-HEADING-LINE-1                               04535299
045353       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04535399
045354     MOVE 2 TO PV-LINES-TO-ADVANCE.                               04535499
045355     PERFORM 9010-WRITE-REPORT-LINE.                              04535599
045356                                                                  04535699
045357     MOVE PV-RPT-COL-HEADING-LINE-2                               04535799
045358       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04535899
045359     MOVE 1 TO PV-LINES-TO-ADVANCE.                               04535999
045360     PERFORM 9010-WRITE-REPORT-LINE.                              04536099
045361                                                                  04536199
045362     MOVE PV-RPT-COL-HEADING-LINE-3                               04536299
045363       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04536399
045364     MOVE 1 TO PV-LINES-TO-ADVANCE.                               04536499
045365     PERFORM 9010-WRITE-REPORT-LINE.                              04536599
045366                                                                  04536699
045367     MOVE PV-RPT-COL-HEADING-LINE-4                               04536799
045368       TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                          04536899
045369     MOVE 1 TO PV-LINES-TO-ADVANCE.                               04536999
045370     PERFORM 9010-WRITE-REPORT-LINE.                              04537099
045371                                                                  04537199
045372     MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC.                04537299
045373     MOVE 1 TO PV-LINES-TO-ADVANCE.                               04537399
045374     PERFORM 9010-WRITE-REPORT-LINE.                              04537499
045377                                                                  04537799
045378*7010-EXIT.                                                       04537899
045379 EJECT                                                            04537999
045380                                                                  04538099
045381*----------------------------------------------------------       04538199
045382* 8010-READ-MKUP-MKDN-FILE.                                       04538299
045383*----------------------------------------------------------       04538399
045384 8010-READ-MKUP-MKDN-FILE.                                        04538499
045385                                                                  04538599
045386     READ MKUP-MKDN-FILE                                          04538699
045387       INTO PV-SALES-OR-RETURNS-LAYOUT.                           04538799
045388                                                                  04538899
045389     IF NOT SC-MKUP-MKDN-FILE-OK                                  04538999
045390      AND NOT SC-MKUP-MKDN-FILE-EOF                               04539099
045391       DISPLAY ' '                                                04539199
045392       DISPLAY '** ABEND     **'                                  04539299
045393       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              04539399
045394       DISPLAY '** PARAGRAPH **'                                  04539499
045395        '= 8010-READ-MKUP-MKDN-FILE'                              04539599
045396       DISPLAY '** MKUP-MKDN-FILE READ ERROR'                     04539699
045397       DISPLAY '** FILE STATUS IS = '                             04539799
045398        SC-MKUP-MKDN-FILE-STATUS                                  04539899
045399       MOVE +4002 TO ABEND-CODE                                   04539999
045400       CALL 'ILBOABN0' USING ABEND-CODE                           04540099
045401     END-IF.                                                      04540199
045402                                                                  04540299
045405     IF PS-FIRST-READ                                             04540599
045406       IF SC-MKUP-MKDN-FILE-OK                                    04540699
045408         MOVE PV-ACCT-MONTH    TO PV-ACCT-MONTH-HOLD              04540899
045409         MOVE PV-STORE-NUMBER  TO PV-STORE-NUMBER-HOLD            04540999
045410         MOVE PV-DEPARTMENT    TO PV-DEPARTMENT-HOLD              04541099
045411         MOVE PV-CLASS         TO PV-CLASS-HOLD                   04541199
045412         SET PS-NOT-FIRST-READ TO TRUE                            04541299
045413       ELSE                                                       04541399
045414         MOVE SPACES TO RPT-MISSED-MKUP-MKDWN-ACT-REC             04541499
045415         MOVE PC-NO-DATA-IN-INPUT-FILE                            04541599
045416          TO RPT-MISSED-MKUP-MKDWN-ACT-REC                        04541699
045417         MOVE 1 TO PV-LINES-TO-ADVANCE                            04541799
045418         PERFORM 9010-WRITE-REPORT-LINE                           04541899
045419       END-IF                                                     04541999
045420     END-IF.                                                      04542099
045421                                                                  04542199
045422     IF SC-MKUP-MKDN-FILE-EOF                                     04542299
045423       MOVE HIGH-VALUES TO PV-STORE-NUMBER                        04542399
045424                           PV-DEPT-CLASS                          04542499
045425*                          PV-DEPARTMENT                          04542599
045426*                          PV-CLASS                               04542699
045427     END-IF.                                                      04542799
045428                                                                  04542899
045429*8010-EXIT.                                                       04542999
045430 EJECT                                                            04543099
045431                                                                  04543199
045432*----------------------------------------------------------       04543299
045433* 9010-WRITE-REPORT-LINE.                                         04543399
045434*----------------------------------------------------------       04543499
045435 9010-WRITE-REPORT-LINE.                                          04543599
045436                                                                  04543699
045437     IF PS-DONT-ADVANCE-PAGE                                      04543799
045438       WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                        04543899
045439         AFTER ADVANCING PV-LINES-TO-ADVANCE                      04543999
045440       ADD PV-LINES-TO-ADVANCE TO PV-LINE-COUNT                   04544099
045441     ELSE                                                         04544199
045442       WRITE RPT-MISSED-MKUP-MKDWN-ACT-REC                        04544299
045443         AFTER ADVANCING PAGE                                     04544399
045444     END-IF.                                                      04544499
045445                                                                  04544599
045446*9010-EXIT.                                                       04544699
045447 EJECT                                                            04544799
045448                                                                  04544899
045449*----------------------------------------------------------       04544999
045450* 9999-CLEAN-UP.                                                  04545099
045451*----------------------------------------------------------       04545199
045452 9999-CLEAN-UP.                                                   04545299
045453                                                                  04545399
045454     CLOSE MKUP-MKDN-FILE                                         04545499
045455           POS-DATE-FILE                                          04545599
045456           RPT-MISSED-MKUP-MKDWN-ACT.                             04545699
045457                                                                  04545799
045460*9999-EXIT.                                                       04546099
045500 EJECT                                                            04550099
