       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    MLKRP203.                                         00020000
       AUTHOR.        BARBARA HULL.                                     00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  06-15-98.                                         00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      *                                                                *00080000
      * MLKRP203 - THIS PROGRAM PRODUCES THE SALES AND INVENTORY       *00090000
      * RANKING REPORT.                                                *00100000
      *                                                                *00110000
      * THE INPUT TO THIS PROGRAM IS CREATED IN PROGRAMS MLKUT407 AND  *00120000
      * MLKUT408.                                                      *00130000
      *                                                                *00140000
      * FOR NORMAL MONTH END, THE INPUT FILE WILL CONTAIN ONLY         *00150000
      * DEPARTMENT AND STORE TOTAL RECORDS.  FOR THE QUARTERLY REPORT  *00160000
      * MAJOR CLASS AND STORE DETAIL RECORDS WILL ALSO BE INCLUDED.    *00170000
      * FOR THE WEEKLY REPORT, THE INPUT WILL BE SIMILAR TO THE        *00180000
      * QUARTERLY REPORT EXCEPT THAT IT WILL BE SORTED IN BUYER NUMBER *00190000
      * ORDER AS THE MAJOR SORT FIELD AND BREAK ON CHANGES OF BUYER.   *00200000
      *                                                                *00210000
      * THE FILE WILL ALWAYS BE ORDERED BY DEPT AND MAJOR CLASS        *00220000
      * (ASCENDING), SALES TOTAL (DESCENDING), AND STORE NUMBER        *00230000
      * (ASCENDING) ORDER.                                             *00240000
      *                                                                *00250000
      * THE REPORT WILL BREAK TO A NEW PAGE ON CHANGES IN DEPARTMENT.  *00260000
      *                                                                *00270000
      * PERCENTAGES ARE CALCULATED TO SHOW THE RATIO BETWEEN SALES AND *00280000
      * TOTAL DEPARTMENT/MAJOR CLASS SALES AND INVENTORY AND TOTAL     *00290000
      * DEPARTMENT/MAJOR CLASS INVENTORY FOR EACH STORE TOTAL AND      *00300000
      * STORE DETAIL RECORD.                                           *00310000
      *                                                                *00320000
      ******************************************************************00330000
      *   12/28/99   WR#57001  JIM SHIFF                                00340000
      *              REMOVE REFERENCE TO LASER PRINTING FUNCTION        00350000
W26603******************************************************************00360000
W26603* CHG ID   DATE        DESCRIPTION                               *00370000
W26603* ------   ----------  ----------------------------------------- *00380000
W26603* W26603   03-23-2004  STORE EXPANSION.  EXPANDED LRECL OF       *00390000
W26603*                      INP02, AND RPT01.                         *00400000
W26603*                      REPLACED COPYBOOK DPWS132O WITH DPWS150O. *00410000
W26603*                      (RPT01 IS NOW 150 BYTES WIDE)             *00420000
W26603*                      EXPANDED WORKING STORAGE VARIABLES.       *00430000
W26603*                      ADDED 'WITH UR' TO DB2 SELECTS.           *00440000
W26603*                      REPLACED TSTR000 WITH XMT_LOC TABLE.      *00450000
W26603*                      - RONNA MCDONALD                          *00460000
      ******************************************************************00470000
W26006*   02/24/05   WR#26006  ERIN SEARL                              *00471004
W26006*              REMOVE REFERENCES TO OBSOLETE STORE TABLE.        *00472004
W26006******************************************************************00473004
RONNA1*   03/11/07   PC-TABLE-MAX -- INCREASED TO MATCH THE SIZE OF TBL*00475005
RONNA1*                              PITS P000993447                   *00475106
      ******************************************************************00476005
      *                                                                 00480000
      *                                                                 00490000
       ENVIRONMENT DIVISION.                                            00500000
       CONFIGURATION SECTION.                                           00510000
       SOURCE-COMPUTER.        IBM-3090.                                00520000
       OBJECT-COMPUTER.        IBM-3090.                                00530000
       INPUT-OUTPUT SECTION.                                            00540000
       FILE-CONTROL.                                                    00550000
      *                                                                 00560000
           SELECT CONTROL-FILE                                          00570000
               ASSIGN TO INP01.                                         00580000
      *                                                                 00590000
           SELECT RANK-EXTRACT-FILE                                     00600000
               ASSIGN TO INP02.                                         00610000
      *                                                                 00620000
           SELECT STORE-RANKING-REPORT                                  00630000
               ASSIGN TO RPT01.                                         00640000
      *                                                                 00650000
      ******************************************************************00660000
       DATA DIVISION.                                                   00670000
      ******************************************************************00680000
       FILE SECTION.                                                    00690000
      *                                                                 00700000
       FD  CONTROL-FILE                                                 00710000
           RECORDING MODE IS F                                          00720000
           LABEL RECORDS ARE STANDARD                                   00730000
           BLOCK CONTAINS 0 CHARACTERS.                                 00740000
                                                                        00750000
       01  CONTROL-RECORD              PIC X(80).                       00760000
                                                                        00770000
       FD  RANK-EXTRACT-FILE                                            00780000
           RECORDING MODE IS F                                          00790000
           LABEL RECORDS ARE STANDARD                                   00800000
           BLOCK CONTAINS 0 CHARACTERS.                                 00810000
                                                                        00820000
W26603*01  RANK-EXTRACT-RECORD         PIC X(70).                       00830000
W26603 01  RANK-EXTRACT-RECORD         PIC X(90).                       00840000
                                                                        00850000
       FD  STORE-RANKING-REPORT                                         00860000
           RECORDING MODE IS F                                          00870000
           LABEL RECORDS ARE OMITTED                                    00880000
           BLOCK CONTAINS 0 CHARACTERS.                                 00890000
                                                                        00900000
W26603*01  STORE-RANKING-LINE          PIC X(132).                      00910000
W26603 01  STORE-RANKING-LINE          PIC X(150).                      00920000
                                                                        00930000
       EJECT                                                            00940000
                                                                        00950000
      ******************************************************************00960000
       WORKING-STORAGE SECTION.                                         00970000
      ******************************************************************00980000
                                                                        00990000
      *** INPUT CONTROL RECORD                                          01000000
       01  CC-CONTROL-CARD.                                             01010000
           05  CC-BREAK-VALUE          PIC X(01)   VALUE SPACE.         01020000
           05  FILLER                  PIC X(79)   VALUE SPACE.         01030000
      *                                                                 01040000
      *** INPUT STORE RANKING RECORD                                    01050000
           COPY MLRD108.                                                01060000
                                                                        01070000
       EJECT                                                            01080000
                                                                        01090000
      *                                                                 01100000
       01 ABEND-AREAS.                                                  01110000
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           01120000
                                                   COMP SYNC.           01130000
               88  AC-BAD-DATA                     VALUE +4003.         01140000
               88  AC-DB2-ERROR                    VALUE +4013.         01150000
           05  AA-ABEND-LIT            PIC X(40)   VALUE                01160000
                 '*****       ABEND'.                                   01170000
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                01180000
                   '*****   PROGRAM: MLKRP203'.                         01190000
           05  AA-PARAGRAPH-LIT.                                        01200000
               10  FILLER              PIC X(17)   VALUE                01210000
                   '***** PARAGRAPH: '.                                 01220000
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        01230000
           05  AA-MESSAGE-LINE.                                         01240000
               10  FILLER              PIC X(06)   VALUE '*****'.       01250000
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        01260000
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                01270000
                   '*****    DB2 ERROR'.                                01280000
           05  AA-DB2-OPERATION-LIT.                                    01290000
               10  FILLER              PIC X(17)   VALUE                01300000
                   '***** OPERATION: '.                                 01310000
               10  AA-DB2-OPERATION.                                    01320000
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        01330000
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        01340000
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        01350000
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        01360000
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        01370000
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        01380000
      *                                                                 01390000
       01  PV-PROGRAM-VARIABLES.                                        01400000
           05  PV-OPN-FSCL-MN-DTE      PIC X(10).                       01410000
           05  PV-OPN-FSCL-WK-DTE      PIC X(10).                       01420000
                                                                        01430000
           05  PV-BUYER-NUM-3          PIC X(3)    VALUE SPACES.        01440000
           05  PV-BUYER-NUM.                                            01450000
               10  PV-BUYER-NUM-1-X    PIC X(1)    VALUE '0'.           01460000
               10  PV-BUYER-NUM-2      PIC X(2)    VALUE SPACES.        01470000
           05  PV-DEPT-NUM             PIC X(3)    VALUE SPACES.        01480000
           05  PV-DIVISION-NUM         PIC X(2)    VALUE SPACES.        01490000
           05  PV-MANAGER-NUM          PIC X(2)    VALUE SPACES.        01500000
           05  PV-FIRST-NAME.                                           01510000
               10  PV-FIRST-INIT       PIC X(1)    VALUE SPACE.         01520000
               10  PV-FIRST-REST       PIC X(11)   VALUE SPACES.        01530000
           05  PV-DATE-REFORMATTER.                                     01540000
               10  PV-DATE-REFOR-CC    PIC XX.                          01550000
               10  PV-DATE-REFOR-YY    PIC XX.                          01560000
               10  FILLER              PIC X.                           01570000
               10  PV-DATE-REFOR-MM    PIC XX.                          01580000
               10  FILLER              PIC X.                           01590000
               10  PV-DATE-REFOR-DD    PIC XX.                          01600000
      *                                                                 01610000
       01  PC-PROGRAM-COUNTERS                         COMP-3.          01620000
           05  PC-TOTAL-RECS-READ      PIC S9(09)      VALUE ZEROS.     01630000
                                                                        01640000
           05  PC-ACCUM-INVEN-PERCENT  PIC S9(03)V99   VALUE ZEROS.     01650000
           05  PC-ACCUM-MONTH-PERCENT  PIC S9(03)V99   VALUE ZEROS.     01660000
           05  PC-ACCUM-SALES-PERCENT  PIC S9(03)V99   VALUE ZEROS.     01670000
           05  PC-EOM-INVENTORY-DOLLARS                                 01680000
W26603*                                PIC S9(09)V99   VALUE ZEROS.     01690000
W26603                                 PIC S9(11)V99   VALUE ZEROS.     01700000
           05  PC-INVENTORY-PERCENT    PIC S9(03)V99   VALUE ZEROS.     01710000
           05  PC-MONTH-PERCENT        PIC S9(03)V99   VALUE ZEROS.     01720000
W26603*    05  PC-MONTH-SALES          PIC S9(09)V99   VALUE ZEROS.     01730000
W26603     05  PC-MONTH-SALES          PIC S9(11)V99   VALUE ZEROS.     01740000
           05  PC-PAGE-NUMBER          PIC S9(05)      VALUE ZEROS.     01750000
           05  PC-PERCENTAGE           PIC S9(03)V9999 VALUE ZEROS.     01760000
           05  PC-PERCENT-ADJUST       PIC S9(03)V99   VALUE ZEROS.     01770000
           05  PC-REPORT-RECS-WRITTEN  PIC S9(09)      VALUE ZEROS.     01780000
           05  PC-SALES-PERCENT        PIC S9(03)V99   VALUE ZEROS.     01790000
W26603*    05  PC-SALES-RANK           PIC S9(03)      VALUE ZEROS.     01800000
W26603     05  PC-SALES-RANK           PIC S9(05)      VALUE ZEROS.     01810000
W26603*    05  PC-YTD-SALES-DOLLARS    PIC S9(09)V99   VALUE ZEROS.     01820000
W26603     05  PC-YTD-SALES-DOLLARS    PIC S9(11)V99   VALUE ZEROS.     01830000
      *                                                                 01840000
       01  CD-COUNTER-DISPLAY.                                          01850000
           05  CD-COUNT-HOLD1          PIC ZZZ,ZZZ,ZZ9.                 01860000
      *                                                                 01870000
       01  PC-PROGRAM-CONSTANTS                        COMP-3.          01880000
           05  PC-HUNDRED              PIC S9(03)V99   VALUE            01890000
               +100.00.                                                 01900000
RONNA1     05  PC-TABLE-MAX            PIC S9(05)      VALUE +99999.    01910005
      *                                                                 01920000
       01  CP-CONTROL-PRINT.                                            01930000
           05  CP-SPACE-CONTROL        PIC S9(01)      VALUE ZEROS.     01940000
           05  CP-LINE-MAX             PIC S9(03)      VALUE +055       01950000
                                                       COMP-3.          01960000
           05  CP-LINE-COUNT           PIC S9(03)      VALUE +099       01970000
                                                       COMP-3.          01980000
      *                                                                 01990000
       01  IW-INTERMEDIATE-WORKAREAS.                                   02000000
           05  IW-DATE.                                                 02010000
               10  IW-YEAR             PIC X(02)       VALUE SPACE.     02020000
               10  IW-MONTH            PIC X(02)       VALUE SPACE.     02030000
               10  IW-DAY              PIC X(02)       VALUE SPACE.     02040000
           05  IW-TIME.                                                 02050000
               10  IW-HOUR             PIC X(02)       VALUE SPACE.     02060000
               10  IW-MINUTE           PIC X(02)       VALUE SPACE.     02070000
               10  FILLER              PIC X(02)       VALUE SPACE.     02080000
      *                                                                 02090000
       01  SA-SAVE-AREAS.                                               02100000
           05  SA-MAJ-CLASS-VALUE      PIC X(02)       VALUE SPACE.     02110000
                                                                        02120000
           05  SA-OLD-BUYER            PIC X(02)       VALUE SPACE.     02130000
           05  SA-OLD-DEPT             PIC X(03)       VALUE ZEROS.     02140000
           05  SA-OLD-MAJ-CLASS        PIC X(02)       VALUE ZEROS.     02150000
                                                                        02160000
           05  SA-MAJ-CLASS-TITLE      PIC X(12)       VALUE            02170000
               'MAJOR CLASS '.                                          02180000
                                                                        02190000
           05  SA-DEPT-DESC            PIC X(20)       VALUE SPACE.     02200000
           05  SA-DEPT-BUYER           PIC X(02)       VALUE SPACE.     02210000
           05  SA-DEPT-DIVISION        PIC X(02)       VALUE SPACE.     02220000
      *                                                                 02230000
       01  PS-PROGRAM-SWITCHES.                                         02240000
W26603     05  PS-XMT-LOC-DONE         PIC X           VALUE 'N'.       02270000
W26603         88  PS-XMT-LOC-IS-DONE                  VALUE 'Y'.       02280000
           05  PS-BUYER-BREAK          PIC X           VALUE 'N'.       02290000
               88  PS-CREATE-BUYER-BREAK               VALUE 'Y'.       02300000
           05  PS-NEED-MAJ-CLASS-PRINT PIC X           VALUE 'N'.       02310000
               88  PS-NEED-MAJ-CLASS-TOTAL             VALUE 'Y'.       02320000
           05  PS-NEED-DEPT-PRINT      PIC X           VALUE 'N'.       02330000
               88  PS-NEED-DEPT-TOTAL                  VALUE 'Y'.       02340000
           05  PS-FIND-STORE           PIC X           VALUE 'N'.       02350000
               88  PS-STORE-FOUND                      VALUE 'Y'.       02360000
           05  PS-RANK-EXTRACT-EOF-SWITCH                               02370000
                                       PIC X           VALUE 'N'.       02380000
               88  PS-END-OF-RANK-EXTRACT-FILE         VALUE 'Y'.       02390000
      *                                                                 02400000
       01  ST-STORE-TOTAL-TABLE.                                        02410000
           05  ST-STORE-TOTAL-TABLE-SIZE                                02420000
W26603*                                PIC S9(04)      COMP.            02430000
                                       PIC S9(06)      COMP.            02440000
W26603*    05  ST-ENTRY OCCURS 1 TO 999 TIMES                           02450000
           05  ST-ENTRY OCCURS 1 TO 99999 TIMES                         02460000
                          DEPENDING ON                                  02470000
                            ST-STORE-TOTAL-TABLE-SIZE.                  02480000
W26603*        10  ST-STORE-NUMBER     PIC X(03).                       02490000
W26603         10  ST-STORE-NUMBER     PIC 9(05).                       02500000
               10  ST-STORE-NAME       PIC X(10).                       02510000
                                                                        02520000
       01  PS-PROGRAM-SUBSCRIPTS.                                       02530000
W26603*    05  PS-STORE-SUB            PIC S9(04)      VALUE +0         02540000
           05  PS-STORE-SUB            PIC S9(06)      VALUE +0         02550000
                                                       COMP SYNC.       02560000
                                                                        02570000
       EJECT                                                            02580000
                                                                        02590000
      *                                                                 02600000
      *                                                                 02610000
      *01  LC-LASER-CONTROL-SWITCHES.                                   02620000
      * CONTROL-FF IS FOR PAGE BREAK  CONTROL-FD IS FOR NEW PAGE        02630000
      *    05  LC-LASER-CONTROL-FF.                                     02640000
      *        10  FILLER              PIC S9(04)      VALUE -1         02650000
      *                                                COMP.            02660000
      *    05  LC-LASER-CONTROL-FD.                                     02670000
      *        10  FILLER              PIC S9(04)      VALUE -513       02680000
      *                                                COMP.            02690000
      *        10  FILLER              PIC  X(79)      VALUE SPACE.     02700000
      *    05  LC-LASER-BREAK-SW       PIC  X(01)      VALUE 'N'.       02710000
      *        88  LC-LASER-BREAK                      VALUE 'Y'.       02720000
      *                                                                 02730000
      *  STANDARD KOHL'S HEADING LINE FOR A 132 COLUMN REPORT           02740000
      *                                                                 02750000
W26603*    COPY DPWS132O.                                               02760000
W26603     COPY DPWS150O.                                               02770000
                                                                        02780000
       01  H2-HEADING2.                                                 02790000
           05  FILLER                  PIC X(42)       VALUE SPACE.     02800000
           05  FILLER                  PIC X(40)       VALUE            02810000
               'STORE RANKING REPORT FOR WEEK BEGINNING '.              02820000
           05  H2-DATE.                                                 02830000
               10  H2-MONTH            PIC 9(02)       VALUE ZEROS.     02840000
               10  FILLER              PIC X(01)       VALUE '/'.       02850000
               10  H2-DAY              PIC 9(02)       VALUE ZEROS.     02860000
               10  FILLER              PIC X(01)       VALUE '/'.       02870000
               10  H2-YEAR             PIC 9(02)       VALUE ZEROS.     02880000
           05  FILLER                  PIC X(42)       VALUE SPACE.     02890000
      *                                                                 02900000
       01  H3-HEADING3.                                                 02910000
           05  FILLER                  PIC X(114)      VALUE SPACE.     02920000
W26603     05  FILLER                  PIC X(15)      VALUE SPACE.      02930000
           05  FILLER                  PIC X(04)       VALUE 'DMM '.    02940000
           05  H3-DMM-NUMBER           PIC X(02)       VALUE SPACE.     02950000
           05  FILLER                  PIC X(12)       VALUE SPACE.     02960000
      *                                                                 02970000
       01  H4-HEADING4.                                                 02980000
           05  FILLER                  PIC X(01)       VALUE SPACE.     02990000
           05  FILLER                  PIC X(11)       VALUE            03000000
               'DEPARTMENT '.                                           03010000
           05  H4-DEPT-NUMBER          PIC 999         VALUE ZEROS.     03020000
           05  FILLER                  PIC X(02)       VALUE SPACE.     03030000
           05  FILLER                  PIC X(20)       VALUE SPACE.     03040000
           05  FILLER                  PIC X(05)       VALUE SPACE.     03050000
           05  H4-MAJ-CLASS-HOLD       PIC X(12)       VALUE SPACE.     03060000
           05  H4-MAJ-CLASS-NUMBER     PIC X(02)       VALUE SPACE.     03070000
           05  FILLER                  PIC X(02)       VALUE SPACE.     03080000
           05  H4-MAJ-CLASS-DESC       PIC X(20)       VALUE SPACE.     03090000
           05  FILLER                  PIC X(03)       VALUE SPACE.     03100000
W26603     05  FILLER                  PIC X(15)       VALUE SPACE.     03110000
           05  FILLER                  PIC X(06)       VALUE            03120000
               'BUYER '.                                                03130000
           05  H4-BUYER                PIC X(02)       VALUE SPACE.     03140000
           05  FILLER                  PIC X(03)       VALUE SPACE.     03150000
           05  H4-BUYER-NAME           PIC X(20)       VALUE SPACE.     03160000
           05  FILLER                  PIC X(02)       VALUE SPACE.     03170000
           05  H4-DMM-NAME             PIC X(18)       VALUE SPACE.     03180000
      *                                                                 03190000
       01  H5-HEADING5.                                                 03200000
W26603*    05  FILLER                  PIC X(10)       VALUE            03210000
W26603*        'SALES RANK'.                                            03220000
W26603     05  FILLER                  PIC X(14)       VALUE            03230000
W26603         '  SALES   RANK'.                                        03240000
           05  FILLER                  PIC X(09)       VALUE            03250000
               ' NO SALES'.                                             03260000
W26603*    05  FILLER                  PIC X(08)       VALUE            03270000
W26603*        '   STORE'.                                              03280000
W26603     05  FILLER                  PIC X(10)       VALUE            03290000
W26603         '     STORE'.                                            03300000
           05  FILLER                  PIC X(28)       VALUE SPACE.     03310000
W26603     05  FILLER                  PIC X(04)       VALUE SPACE.     03320000
           05  FILLER                  PIC X(06)       VALUE            03330000
               'PCT OF'.                                                03340000
W26603*    05  FILLER                  PIC X(13)       VALUE SPACE.     03350000
W26603     05  FILLER                  PIC X(16)       VALUE SPACE.     03360000
           05  FILLER                  PIC X(05)       VALUE            03370000
               'MONTH'.                                                 03380000
W26603*    05  FILLER                  PIC X(07)       VALUE SPACE.     03390000
W26603     05  FILLER                  PIC X(08)       VALUE SPACE.     03400000
           05  FILLER                  PIC X(06)       VALUE            03410000
               'PCT OF'.                                                03420000
W26603*    05  FILLER                  PIC X(18)       VALUE SPACE.     03430000
W26603     05  FILLER                  PIC X(22)       VALUE SPACE.     03440000
           05  FILLER                  PIC X(03)       VALUE            03450000
               'EOM'.                                                   03460000
W26603*    05  FILLER                  PIC X(08)       VALUE SPACE.     03470000
W26603     05  FILLER                  PIC X(09)       VALUE SPACE.     03480000
           05  FILLER                  PIC X(06)       VALUE            03490000
               'PCT OF'.                                                03500000
W26603*    05  FILLER                  PIC X(03)       VALUE SPACE.     03510000
W26603     05  FILLER                  PIC X(04)       VALUE SPACE.     03520000
      *                                                                 03530000
       01  H6-HEADING6.                                                 03540000
W26603*    05  FILLER                  PIC X(01)       VALUE SPACE.     03550000
W26603     05  FILLER                  PIC X(03)       VALUE SPACE.     03560000
W26603*    05  FILLER                  PIC X(14)       VALUE            03570000
W26603*        '  TY   LY   LY'.                                        03580000
W26603     05  FILLER                  PIC X(16)       VALUE            03590000
W26603         '  TY     LY   LY'.                                      03600000
W26603*    05  FILLER                  PIC X(13)       VALUE            03610000
W22603*        '     NBR NAME'.                                         03620000
W26603     05  FILLER                  PIC X(15)       VALUE            03630000
W26603         '       NBR NAME'.                                       03640000
           05  FILLER                  PIC X(14)       VALUE SPACE.     03650000
W26603     05  FILLER                  PIC X(03)       VALUE SPACE.     03660001
           05  FILLER                  PIC X(09)       VALUE            03670000
               'YTD SALES'.                                             03680000
W26603     05  FILLER                  PIC X(02)       VALUE SPACE.     03700001
           05  FILLER                  PIC X(10)       VALUE            03710000
               'CLASS/DEPT'.                                            03720000
W26603*    05  FILLER                  PIC X(08)       VALUE SPACE.     03730000
W26603     05  FILLER                  PIC X(11)       VALUE SPACE.     03740000
           05  FILLER                  PIC X(05)       VALUE            03750000
               'SALES'.                                                 03760000
W26603*    05  FILLER                  PIC X(06)       VALUE            03770000
W26603*        '  RANK'.                                                03780000
W26603     05  FILLER                  PIC X(08)       VALUE            03790000
W26603         '    RANK'.                                              03800000
           05  FILLER                  PIC X(03)       VALUE SPACE.     03810000
           05  FILLER                  PIC X(10)       VALUE            03820000
               'CLASS/DEPT'.                                            03830000
W26603*    05  FILLER                  PIC X(07)       VALUE SPACE.     03840000
W26603     05  FILLER                  PIC X(10)       VALUE SPACE.     03850000
           05  FILLER                  PIC X(09)       VALUE            03860000
               'INVENTORY'.                                             03870000
W26603*    05  FILLER                  PIC X(02)       VALUE SPACE.     03880000
W26603     05  FILLER                  PIC X(04)       VALUE SPACE.     03890000
           05  FILLER                  PIC X(04)       VALUE            03900000
               'RANK'.                                                  03910000
           05  FILLER                  PIC X(03)       VALUE SPACE.     03920000
           05  FILLER                  PIC X(10)       VALUE            03930000
               'CLASS/DEPT'.                                            03940000
      *                                                                 03950000
       01  DL-DETAIL-LINE.                                              03960000
           05  FILLER                  PIC X(02)       VALUE SPACE.     03970000
W26603*    05  DL-SALES-RANK-HOLD      PIC ZZ9         VALUE ZEROS.     03980000
W26603     05  DL-SALES-RANK-HOLD      PIC ZZZZ9       VALUE ZEROS.     03990000
           05  FILLER                  PIC X(02)       VALUE SPACE.     04000000
W26603*    05  DL-SALES-RANK-LY-HOLD   PIC ZZ9         VALUE ZEROS.     04010000
W26603     05  DL-SALES-RANK-LY-HOLD   PIC ZZZZ9       VALUE ZEROS.     04020000
           05  FILLER                  PIC X(03)       VALUE SPACE.     04030000
           05  DL-NO-SALES-LY-IND      PIC X           VALUE SPACE.     04040000
           05  FILLER                  PIC X(06)       VALUE SPACE.     04050000
W26603*    05  DL-STORE-NUMBER         PIC ZZ9         VALUE ZEROS.     04060000
W26603     05  DL-STORE-NUMBER         PIC ZZZZ9       VALUE ZEROS.     04070000
           05  FILLER                  PIC X(01)       VALUE SPACE.     04080000
           05  DL-STORE-NAME           PIC X(10)       VALUE SPACE.     04090000
           05  FILLER                  PIC X(03)       VALUE SPACE.     04100000
W26603*    05  DL-YTD-SALES            PIC ---,---,--9.99               04110000
W26603     05  DL-YTD-SALES            PIC --,---,---,--9.99            04120000
                                                       VALUE ZEROS.     04130000
           05  FILLER                  PIC X(03)       VALUE SPACE.     04140000
           05  DL-SALES-PERCENT        PIC ---.99      VALUE ZEROS.     04150000
           05  FILLER                  PIC X(02)       VALUE '% '.      04160000
W26603*    05  DL-MONTH-SALES          PIC ---,---,--9.99               04170000
W26603     05  DL-MONTH-SALES          PIC --,---,---,--9.99            04180000
                                                       VALUE ZEROS.     04190000
           05  FILLER                  PIC X(03)       VALUE SPACE.     04200000
W26603*    05  DL-MONTH-RANK           PIC ZZ9         VALUE ZEROS.     04210000
W26603     05  DL-MONTH-RANK           PIC ZZZZ9       VALUE ZEROS.     04220000
           05  FILLER                  PIC X(04)       VALUE SPACE.     04230000
           05  DL-MONTH-PERCENT        PIC ---.99      VALUE ZEROS.     04240000
           05  FILLER                  PIC X(05)       VALUE '%    '.   04250000
W26603*    05  DL-EOM-INVENTORY        PIC ---,---,--9.99               04260000
W26603     05  DL-EOM-INVENTORY        PIC --,---,---,--9.99            04270000
                                                       VALUE ZEROS.     04280000
           05  FILLER                  PIC X(03)       VALUE SPACE.     04290000
W26603*    05  DL-INVENTORY-RANK-HOLD  PIC ZZ9         VALUE ZEROS.     04300000
W26603     05  DL-INVENTORY-RANK-HOLD  PIC ZZZZ9       VALUE ZEROS.     04310000
           05  FILLER                  PIC X(04)       VALUE SPACE.     04320000
           05  DL-INVENTORY-PERCENT    PIC ---.99      VALUE ZEROS.     04330000
           05  FILLER                  PIC X(05)       VALUE '% '.      04340000
      *                                                                 04350000
       01  CTL-MAJ-CLASS-TOTAL-LINE.                                    04360000
           05  FILLER                  PIC X(02)       VALUE SPACE.     04370000
           05  FILLER                  PIC X(22)       VALUE            04380000
           'TOTALS FOR CLASS      '.                                    04390000
W26603     05  FILLER                  PIC X(19)       VALUE SPACE.     04400002
W26603*    05  CTL-YTD-SALES           PIC ---,---,--9.99               04410000
W26603     05  CTL-YTD-SALES           PIC --,---,---,--9.99            04420000
                                                       VALUE ZEROS.     04430000
           05  FILLER                  PIC X(02)       VALUE SPACE.     04440000
           05  CTL-SALES-PERCENT       PIC ----.99     VALUE ZEROS.     04450000
           05  FILLER                  PIC X(02)       VALUE '% '.      04460000
W26603*    05  CTL-MONTH-SALES         PIC ---,---,--9.99               04470000
W26603     05  CTL-MONTH-SALES         PIC --,---,---,--9.99            04480000
                                                       VALUE ZEROS.     04490000
           05  FILLER                  PIC X(09)       VALUE SPACE.     04500000
           05  CTL-MONTH-PERCENT       PIC ----.99     VALUE ZEROS.     04510000
           05  FILLER                  PIC X(05)       VALUE '% '.      04520000
W26603*    05  CTL-EOM-INVENTORY       PIC ---,---,--9.99               04530000
W26603     05  CTL-EOM-INVENTORY       PIC --,---,---,--9.99            04540000
                                                       VALUE ZEROS.     04550000
           05  FILLER                  PIC X(09)       VALUE SPACE.     04560000
           05  CTL-INVENTORY-PERCENT   PIC ----.99                      04570000
                                                       VALUE ZEROS.     04580000
           05  FILLER                  PIC X(07)       VALUE '% '.      04590000
      *                                                                 04600000
       01  DTL-DEPT-TOTAL-LINE.                                         04610000
           05  FILLER                  PIC X(02)       VALUE SPACE.     04620000
           05  FILLER                  PIC X(22)       VALUE            04630000
           'TOTALS FOR DEPARTMENT '.                                    04640000
W26603     05  FILLER                  PIC X(19)       VALUE SPACE.     04650002
W26603*    05  DTL-YTD-SALES           PIC ---,---,--9.99               04660000
W26603     05  DTL-YTD-SALES           PIC --,---,---,--9.99            04670000
                                                       VALUE ZEROS.     04680000
           05  FILLER                  PIC X(02)       VALUE SPACE.     04690000
           05  DTL-SALES-PERCENT       PIC ----.99     VALUE ZEROS.     04700000
           05  FILLER                  PIC X(02)       VALUE '% '.      04710000
W26603*    05  DTL-MONTH-SALES         PIC ---,---,--9.99               04720000
W26603     05  DTL-MONTH-SALES         PIC --,---,---,--9.99            04730000
                                                       VALUE ZEROS.     04740000
           05  FILLER                  PIC X(09)       VALUE SPACE.     04750000
           05  DTL-MONTH-PERCENT       PIC ----.99.                     04760000
           05  FILLER                  PIC X(05)       VALUE '% '.      04770000
W26603*    05  DTL-EOM-INVENTORY       PIC ---,---,--9.99               04780000
W26603     05  DTL-EOM-INVENTORY       PIC --,---,---,--9.99            04790000
                                                       VALUE ZEROS.     04800000
           05  FILLER                  PIC X(09)       VALUE SPACE.     04810000
           05  DTL-INVENTORY-PERCENT   PIC ----.99     VALUE ZEROS.     04820000
           05  FILLER                  PIC X(07)       VALUE '% '.      04830000
                                                                        04840000
       01  ER-END-OF-REPORT-LINE.                                       04850000
           05  FILLER                  PIC X(21)   VALUE                04860000
                                          '*** END OF REPORT ***'.      04870000
                                                                        04880000
       EJECT                                                            04890000
                                                                        04900000
      ******************************************************************04910000
      *  DB2 CONTROL TABLE LAYOUT                                       04920000
      ******************************************************************04930000
           EXEC SQL                                                     04940000
               INCLUDE TMLCNTL                                          04950000
           END-EXEC.                                                    04960000
                                                                        04970000
      ******************************************************************04980000
      *  DB2 MERCHANDISE AREA TABLE LAYOUT                              04990000
      ******************************************************************05000000
           EXEC SQL                                                     05010000
               INCLUDE TMDSEAR                                          05020000
           END-EXEC.                                                    05030000
                                                                        05040000
      ******************************************************************05050000
      *  DB2 RESPONSIBILITY AREA TABLE LAYOUT                           05060000
      ******************************************************************05070000
           EXEC SQL                                                     05080000
               INCLUDE TRSPBAR                                          05090000
           END-EXEC.                                                    05100000
                                                                        05110000
      ******************************************************************05120000
      *  DB2 STORE TABLE LAYOUT                                         05130000
      ******************************************************************05140000
           EXEC SQL                                                     05150000
W26603        INCLUDE XMT00001                                          05170000
           END-EXEC.                                                    05180000
                                                                        05190000
      ******************************************************************05200000
      *  DB2 M/L DATE TABLE LAYOUT                                      05210000
      ******************************************************************05220000
           EXEC SQL                                                     05230000
               INCLUDE TDTATTR                                          05240000
           END-EXEC.                                                    05250000
                                                                        05260000
      ******************************************************************05270000
      *  DB2 ERROR MESSAGES FORMAT AREA.                                05280000
      ******************************************************************05290000
           COPY DPWS004.                                                05300000
                                                                        05310000
      ******************************************************************05320000
      *  DB2 COMMUNICATION AREA                                         05330000
      ******************************************************************05340000
           EXEC SQL                                                     05350000
              INCLUDE SQLCA                                             05360000
           END-EXEC.                                                    05370000
                                                                        05380000
      ******************************************************************05390000
      *  DB2 COMMUNICATION AREA 2                                       05400000
      ******************************************************************05410000
           COPY SQLCA2.                                                 05420000
                                                                        05430000
      ******************************************************************05440000
      *  DB2 STORE CURSOR                                               05450000
      ******************************************************************05460000
           EXEC SQL                                                     05470000
              DECLARE STORE_CURSOR CURSOR FOR                           05480000
W26603          SELECT LOC_NBR,                                         05570000
W26603                 LOC_TYP_CDE,                                     05580000
W26603                 LOC_10_ABBR_NM                                   05590000
W26603            FROM XMT_LOC                                          05600000
W26603            WHERE LOC_TYP_CDE = 'DS'                              05610000
W26603            ORDER BY LOC_NBR                                      05620000
           END-EXEC.                                                    05630000
                                                                        05640000
       EJECT                                                            05650000
                                                                        05660000
      ******************************************************************05670000
       PROCEDURE DIVISION.                                              05680000
      ******************************************************************05690000
                                                                        05700000
      ******************************************************************05710000
       0000-MAINLINE-MLKRP203.                                          05720000
      ******************************************************************05730000
      *                                                                 05740000
           PERFORM 1000-INITIALIZATION.                                 05750000
                                                                        05760000
           PERFORM 2000-CREATE-RANKING-REPORT                           05770000
               UNTIL PS-END-OF-RANK-EXTRACT-FILE.                       05780000
                                                                        05790000
           PERFORM 8000-EOJ.                                            05800000
                                                                        05810000
           STOP RUN.                                                    05820000
                                                                        05830000
       EJECT                                                            05840000
                                                                        05850000
      ******************************************************************05860000
       1000-INITIALIZATION.                                             05870000
      ******************************************************************05880000
      *                                                                 05890000
           ACCEPT IW-DATE FROM DATE.                                    05900000
           ACCEPT IW-TIME FROM TIME.                                    05910000
                                                                        05920000
           OPEN INPUT  CONTROL-FILE                                     05930000
                       RANK-EXTRACT-FILE                                05940000
                OUTPUT STORE-RANKING-REPORT.                            05950000
                                                                        05960000
           PERFORM 7000-SELECT-TMLCNTL.                                 05970000
                                                                        05980000
           DISPLAY ' '.                                                 05990000
           DISPLAY '*** OPEN FISCAL DATES USED ARE:  '                  06000000
           DISPLAY '      MLCNTL-OPN-FSCL-MN-DTE = '                    06010000
             PV-OPN-FSCL-MN-DTE.                                        06020000
           DISPLAY '      MLCNTL-OPN-FSCL-WK-DTE = '                    06030000
             PV-OPN-FSCL-WK-DTE.                                        06040000
                                                                        06050000
           PERFORM 7500-SELECT-TDTATTR.                                 06060000
                                                                        06070000
           PERFORM 4000-READ-CONTROL-FILE.                              06080000
                                                                        06090000
           DISPLAY ' '.                                                 06100000
           DISPLAY '*** PROCESS OPTION CARD FOR MLKRP203 FOLLOWS ***'   06110000
           DISPLAY CC-CONTROL-CARD.                                     06120000
                                                                        06130000
W26603     MOVE IW-MONTH               TO DP150O-RUN-MONTH.             06140000
W26603     MOVE IW-DAY                 TO DP150O-RUN-DAY.               06150000
W26603     MOVE IW-YEAR                TO DP150O-RUN-YEAR.              06160000
W26603     MOVE IW-HOUR                TO DP150O-RUN-HOUR.              06170000
W26603     MOVE IW-MINUTE              TO DP150O-RUN-MINUTE.            06180000
W26603     MOVE 'MLKRP203'             TO DP150O-PROGRAM-NAME.          06190000
           IF CC-BREAK-VALUE = 'Y'                                      06200000
W26603         MOVE 1                  TO DP150O-REPORT-NUMBER          06210000
           ELSE                                                         06220000
W26603         MOVE 2                  TO DP150O-REPORT-NUMBER          06230000
           END-IF.                                                      06240000
                                                                        06250000
           MOVE DTATTR-FSCL-WK-BEG-DTE TO PV-DATE-REFORMATTER.          06260000
           MOVE PV-DATE-REFOR-MM       TO H2-MONTH.                     06270000
           MOVE PV-DATE-REFOR-DD       TO H2-DAY.                       06280000
           MOVE PV-DATE-REFOR-YY       TO H2-YEAR.                      06290000
                                                                        06300000
           MOVE CC-BREAK-VALUE         TO PS-BUYER-BREAK.               06310000
                                                                        06320000
           MOVE ZERO                   TO ST-STORE-TOTAL-TABLE-SIZE.    06330000
                                                                        06340000
           PERFORM 1100-PREPARE-STORE-TABLE.                            06350000
                                                                        06360000
           PERFORM 4100-READ-RANK-EXTRACT-FILE.                         06370000
                                                                        06380000
           IF PS-END-OF-RANK-EXTRACT-FILE                               06390000
               MOVE '1000-INITIALIZATION' TO AA-PARAGRAPH-NAME          06400000
               MOVE 'EXTRACT FILE IS EMPTY'                             06410000
                                       TO AA-MESSAGE                    06420000
               MOVE +4003              TO ABEND-CODE                    06430000
               PERFORM 9900-COMMON-ABEND-ROUTINE                        06440000
           END-IF.                                                      06450000
                                                                        06460000
           MOVE ML108-BUYER-NUMBER     TO SA-OLD-BUYER.                 06470000
           MOVE ML108-DEPT-NUMBER      TO SA-OLD-DEPT.                  06480000
           MOVE ML108-YTD-SALES-DOLLARS                                 06490000
                                       TO PC-YTD-SALES-DOLLARS          06500000
                                          DTL-YTD-SALES.                06510000
                                                                        06520000
           MOVE ML108-MTH-SALES-DOLLARS                                 06530000
                                       TO PC-MONTH-SALES                06540000
                                          DTL-MONTH-SALES.              06550000
                                                                        06560000
           MOVE ML108-EOM-INVENTORY-DOLLARS                             06570000
                                       TO PC-EOM-INVENTORY-DOLLARS      06580000
                                          DTL-EOM-INVENTORY.            06590000
                                                                        06600000
       EJECT                                                            06610000
                                                                        06620000
      ******************************************************************06630000
       1100-PREPARE-STORE-TABLE.                                        06640000
      ******************************************************************06650000
      *                                                                 06660000
W26603     PERFORM 7100-OPEN-CURSOR-XMT-LOC.                            06680000
                                                                        06690000
W26603     PERFORM 7110-FETCH-XMT-LOC.                                  06710000
                                                                        06720000
           PERFORM                                                      06730000
W26603         UNTIL PS-XMT-LOC-IS-DONE                                 06750000
                   ADD 1               TO PS-STORE-SUB                  06760000
                   IF PS-STORE-SUB < PC-TABLE-MAX                       06770000
W26603                 MOVE XMT00001-LOC-NBR                            06790000
                                       TO ST-STORE-NUMBER(PS-STORE-SUB) 06800000
W26603                 MOVE XMT00001-LOC-10-ABBR-NM                     06820000
                                       TO ST-STORE-NAME (PS-STORE-SUB)  06830000
W26603                 PERFORM 7110-FETCH-XMT-LOC                       06850000
                       ADD 1           TO ST-STORE-TOTAL-TABLE-SIZE     06860000
                   ELSE                                                 06870000
                       MOVE '1100-PREPARE-STORE-TABLE'                  06880000
                                       TO AA-PARAGRAPH-NAME             06890000
                       MOVE 'WS STORE TABLE IS TOO SMALL, INCREASE SIZE'06900000
                                       TO AA-MESSAGE                    06910000
                       MOVE +4004      TO ABEND-CODE                    06920000
                       PERFORM 9900-COMMON-ABEND-ROUTINE                06930000
                   END-IF                                               06940000
           END-PERFORM.                                                 06950000
                                                                        06960000
W26603     PERFORM 7120-CLOSE-CURSOR-XMT-LOC.                           06980000
                                                                        06990000
       EJECT                                                            07000000
                                                                        07010000
      ******************************************************************07020000
       2000-CREATE-RANKING-REPORT.                                      07030000
      ******************************************************************07040000
      *                                                                 07050000
           PERFORM 2100-PROCESS-DEPT-RECORD                             07060000
             UNTIL                                                      07070000
               ML108-DEPT-NUMBER > SA-OLD-DEPT                          07080000
               OR (ML108-DEPT-NUMBER < SA-OLD-DEPT                      07090000
               AND ML108-BUYER-NUMBER IS NOT EQUAL TO SA-OLD-BUYER)     07100000
               OR PS-END-OF-RANK-EXTRACT-FILE.                          07110000
                                                                        07120000
           IF PS-NEED-DEPT-TOTAL                                        07130000
                PERFORM 2120-PRODUCE-DEPT-TOTAL                         07140000
           ELSE                                                         07150000
               IF PS-NEED-MAJ-CLASS-TOTAL                               07160000
                    PERFORM 2220-PRODUCE-MAJ-CLASS-TOTAL                07170000
               END-IF                                                   07180000
           END-IF.                                                      07190000
                                                                        07200000
           MOVE ML108-DEPT-NUMBER      TO SA-OLD-DEPT.                  07210000
                                                                        07220000
      *    IF (ML108-BUYER-NUMBER IS NOT EQUAL TO SA-OLD-BUYER          07230000
      *      AND PS-CREATE-BUYER-BREAK)                                 07240000
      *        MOVE 'Y'                TO LC-LASER-BREAK-SW             07250000
      *        MOVE LC-LASER-CONTROL-FF                                 07260000
      *                                TO DP150O-LASER-NEW-PAGE-INDICATR07270000
      *    END-IF.                                                      07280000
                                                                        07290000
           MOVE ML108-BUYER-NUMBER     TO SA-OLD-BUYER.                 07300000
                                                                        07310000
       EJECT                                                            07320000
                                                                        07330000
      ******************************************************************07340000
       2100-PROCESS-DEPT-RECORD.                                        07350000
      ******************************************************************07360000
      *                                                                 07370000
           ADD +1                      TO PC-TOTAL-RECS-READ.           07380000
                                                                        07390000
           IF ML108-CLASS-NUMBER > ZERO                                 07400000
               IF PS-NEED-DEPT-TOTAL                                    07410000
                   PERFORM 2120-PRODUCE-DEPT-TOTAL                      07420000
                   PERFORM 2210-FORMAT-MAJ-CLASS-TOTAL                  07430000
               ELSE                                                     07440000
                   PERFORM 2200-PROCESS-MAJ-CLASS                       07450000
               END-IF                                                   07460000
           ELSE                                                         07470000
               IF ML108-STORE-NUMBER = ZERO                             07480000
                   PERFORM 2110-FORMAT-DEPT-TOTAL                       07490000
               ELSE                                                     07500000
                   PERFORM 3000-CALCULATE-PERCENTAGES                   07510000
                   PERFORM 3100-FORMAT-DETAIL-LINE                      07520000
               END-IF                                                   07530000
           END-IF.                                                      07540000
                                                                        07550000
           PERFORM 4100-READ-RANK-EXTRACT-FILE.                         07560000
                                                                        07570000
       EJECT                                                            07580000
                                                                        07590000
      ******************************************************************07600000
       2110-FORMAT-DEPT-TOTAL.                                          07610000
      ******************************************************************07620000
      *                                                                 07630000
           MOVE ZERO                   TO PC-SALES-RANK.                07640000
           MOVE ML108-YTD-SALES-DOLLARS                                 07650000
                                       TO  PC-YTD-SALES-DOLLARS         07660000
                                           DTL-YTD-SALES.               07670000
           MOVE ML108-EOM-INVENTORY-DOLLARS                             07680000
                                       TO PC-EOM-INVENTORY-DOLLARS      07690000
                                          DTL-EOM-INVENTORY.            07700000
           MOVE ML108-MTH-SALES-DOLLARS                                 07710000
                                       TO PC-MONTH-SALES                07720000
                                          DTL-MONTH-SALES.              07730000
           MOVE ML108-DEPT-NUMBER      TO SA-OLD-DEPT.                  07740000
           MOVE ML108-CLASS-NUMBER     TO SA-OLD-MAJ-CLASS              07750000
           MOVE SPACES                 TO SA-MAJ-CLASS-VALUE.           07760000
           MOVE ML108-DEPT-NUMBER      TO H4-DEPT-NUMBER.               07770000
           MOVE ML108-BUYER-NUMBER     TO SA-DEPT-BUYER.                07780000
           MOVE ML108-MANAGER-NUMBER   TO H3-DMM-NUMBER.                07790000
                                                                        07800000
           PERFORM 7300-READ-BUYER-DB.                                  07810000
           PERFORM 7400-READ-BUYER-DMM.                                 07820000
                                                                        07830000
           MOVE ML108-DESCRIPTION      TO SA-DEPT-DESC.                 07840000
                                                                        07850000
           PERFORM 6000-PRODUCES-HEADINGS.                              07860000
                                                                        07870000
           MOVE 'Y'                    TO PS-NEED-DEPT-PRINT.           07880000
                                                                        07890000
       EJECT                                                            07900000
                                                                        07910000
      ******************************************************************07920000
       2120-PRODUCE-DEPT-TOTAL.                                         07930000
      ******************************************************************07940000
      *                                                                 07950000
           MOVE PC-ACCUM-MONTH-PERCENT TO DTL-MONTH-PERCENT.            07960000
           MOVE PC-ACCUM-INVEN-PERCENT TO DTL-INVENTORY-PERCENT.        07970000
           MOVE PC-ACCUM-SALES-PERCENT TO DTL-SALES-PERCENT.            07980000
                                                                        07990000
           MOVE DTL-DEPT-TOTAL-LINE    TO STORE-RANKING-LINE.           08000000
                                                                        08010000
           PERFORM 6999-WRITE-PRINT-LINE.                               08020000
                                                                        08030000
           MOVE ZEROES                 TO PC-ACCUM-MONTH-PERCENT        08040000
                                          PC-ACCUM-INVEN-PERCENT        08050000
                                          PC-ACCUM-SALES-PERCENT.       08060000
                                                                        08070000
           MOVE 'N'                    TO PS-NEED-DEPT-PRINT.           08080000
                                                                        08090000
       EJECT                                                            08100000
                                                                        08110000
      ******************************************************************08120000
       2200-PROCESS-MAJ-CLASS.                                          08130000
      ******************************************************************08140000
      *                                                                 08150000
           IF ML108-CLASS-NUMBER > SA-OLD-MAJ-CLASS                     08160000
               PERFORM 2220-PRODUCE-MAJ-CLASS-TOTAL                     08170000
               PERFORM 2210-FORMAT-MAJ-CLASS-TOTAL                      08180000
           ELSE                                                         08190000
               PERFORM 3000-CALCULATE-PERCENTAGES                       08200000
               PERFORM 3100-FORMAT-DETAIL-LINE                          08210000
           END-IF.                                                      08220000
                                                                        08230000
           MOVE ML108-CLASS-NUMBER     TO SA-OLD-MAJ-CLASS.             08240000
                                                                        08250000
       EJECT                                                            08260000
                                                                        08270000
      ******************************************************************08280000
       2210-FORMAT-MAJ-CLASS-TOTAL.                                     08290000
      ******************************************************************08300000
      *                                                                 08310000
           MOVE ML108-CLASS-NUMBER     TO SA-MAJ-CLASS-VALUE.           08320000
           MOVE ZERO                   TO PC-SALES-RANK.                08330000
           MOVE ML108-YTD-SALES-DOLLARS                                 08340000
                                       TO PC-YTD-SALES-DOLLARS          08350000
                                          CTL-YTD-SALES                 08360000
           MOVE ML108-EOM-INVENTORY-DOLLARS                             08370000
                                       TO PC-EOM-INVENTORY-DOLLARS      08380000
                                          CTL-EOM-INVENTORY.            08390000
           MOVE ML108-MTH-SALES-DOLLARS                                 08400000
                                       TO PC-MONTH-SALES                08410000
                                          CTL-MONTH-SALES.              08420000
           MOVE ML108-CLASS-NUMBER     TO SA-OLD-MAJ-CLASS.             08430000
           MOVE ML108-DEPT-NUMBER      TO H4-DEPT-NUMBER.               08440000
           MOVE ML108-MANAGER-NUMBER   TO H3-DMM-NUMBER.                08450000
                                                                        08460000
           PERFORM 7300-READ-BUYER-DB.                                  08470000
           PERFORM 7400-READ-BUYER-DMM.                                 08480000
                                                                        08490000
           PERFORM 6000-PRODUCES-HEADINGS.                              08500000
                                                                        08510000
           MOVE 'Y'                    TO PS-NEED-MAJ-CLASS-PRINT.      08520000
                                                                        08530000
       EJECT                                                            08540000
                                                                        08550000
      ******************************************************************08560000
       2220-PRODUCE-MAJ-CLASS-TOTAL.                                    08570000
      ******************************************************************08580000
      *                                                                 08590000
           MOVE PC-ACCUM-MONTH-PERCENT TO CTL-MONTH-PERCENT.            08600000
           MOVE PC-ACCUM-INVEN-PERCENT TO CTL-INVENTORY-PERCENT.        08610000
           MOVE PC-ACCUM-SALES-PERCENT TO CTL-SALES-PERCENT.            08620000
           MOVE CTL-MAJ-CLASS-TOTAL-LINE                                08630000
                                       TO STORE-RANKING-LINE.           08640000
                                                                        08650000
           PERFORM 6999-WRITE-PRINT-LINE.                               08660000
                                                                        08670000
           MOVE ZEROES                 TO PC-ACCUM-MONTH-PERCENT        08680000
                                          PC-ACCUM-INVEN-PERCENT        08690000
                                          PC-ACCUM-SALES-PERCENT.       08700000
                                                                        08710000
           MOVE 'N'                    TO PS-NEED-MAJ-CLASS-PRINT.      08720000
                                                                        08730000
       EJECT                                                            08740000
                                                                        08750000
      ***************************************************************** 08760000
       3000-CALCULATE-PERCENTAGES.                                      08770000
      ***************************************************************** 08780000
      *                                                                 08790000
            DIVIDE ML108-MTH-SALES-DOLLARS BY                           08800000
                PC-MONTH-SALES                                          08810000
                GIVING PC-PERCENTAGE ROUNDED                            08820000
                ON SIZE ERROR                                           08830000
                    MOVE ZERO          TO PC-PERCENTAGE.                08840000
                                                                        08850000
           MULTIPLY PC-PERCENTAGE BY PC-HUNDRED                         08860000
               GIVING PC-PERCENT-ADJUST.                                08870000
                                                                        08880000
           MOVE PC-PERCENT-ADJUST      TO PC-MONTH-PERCENT.             08890000
                                                                        08900000
           ADD PC-MONTH-PERCENT        TO PC-ACCUM-MONTH-PERCENT.       08910000
      *                                                                 08920000
           DIVIDE ML108-EOM-INVENTORY-DOLLARS BY                        08930000
               PC-EOM-INVENTORY-DOLLARS                                 08940000
               GIVING PC-PERCENTAGE ROUNDED                             08950000
               ON SIZE ERROR                                            08960000
                   MOVE ZERO           TO PC-PERCENTAGE.                08970000
                                                                        08980000
           MULTIPLY PC-PERCENTAGE BY PC-HUNDRED                         08990000
               GIVING PC-PERCENT-ADJUST.                                09000000
                                                                        09010000
           MOVE PC-PERCENT-ADJUST      TO PC-INVENTORY-PERCENT.         09020000
                                                                        09030000
           ADD PC-INVENTORY-PERCENT    TO PC-ACCUM-INVEN-PERCENT.       09040000
      *                                                                 09050000
           DIVIDE ML108-YTD-SALES-DOLLARS BY                            09060000
               PC-YTD-SALES-DOLLARS                                     09070000
               GIVING PC-PERCENTAGE ROUNDED                             09080000
               ON SIZE ERROR                                            09090000
                   MOVE ZERO           TO PC-PERCENTAGE.                09100000
                                                                        09110000
           MULTIPLY PC-PERCENTAGE BY PC-HUNDRED                         09120000
               GIVING PC-PERCENT-ADJUST.                                09130000
                                                                        09140000
           MOVE PC-PERCENT-ADJUST      TO PC-SALES-PERCENT.             09150000
                                                                        09160000
           ADD PC-SALES-PERCENT        TO PC-ACCUM-SALES-PERCENT.       09170000
                                                                        09180000
       EJECT                                                            09190000
                                                                        09200000
      ******************************************************************09210000
       3100-FORMAT-DETAIL-LINE.                                         09220000
      ******************************************************************09230000
      *                                                                 09240000
           ADD 1                       TO PC-SALES-RANK.                09250000
                                                                        09260000
           MOVE PC-SALES-RANK          TO DL-SALES-RANK-HOLD.           09270000
           MOVE ML108-LY-SALES-RANKING                                  09280000
                                       TO DL-SALES-RANK-LY-HOLD.        09290000
           IF ML108-YTD-SALES-DOLLARS-LY = ZERO                         09300000
               MOVE '*'                TO DL-NO-SALES-LY-IND            09310000
           ELSE                                                         09320000
               MOVE SPACE              TO DL-NO-SALES-LY-IND            09330000
           END-IF.                                                      09340000
           MOVE ML108-STORE-NUMBER     TO DL-STORE-NUMBER.              09350000
           MOVE ML108-YTD-SALES-DOLLARS                                 09360000
                                       TO DL-YTD-SALES.                 09370000
           MOVE PC-SALES-PERCENT       TO DL-SALES-PERCENT.             09380000
           MOVE ML108-MTH-SALES-DOLLARS                                 09390000
                                       TO DL-MONTH-SALES.               09400000
           MOVE ML108-MONTH-SALES-RANKING                               09410000
                                       TO DL-MONTH-RANK.                09420000
           MOVE PC-MONTH-PERCENT       TO DL-MONTH-PERCENT.             09430000
           MOVE ML108-EOM-INVENTORY-DOLLARS                             09440000
                                       TO DL-EOM-INVENTORY.             09450000
           MOVE PC-INVENTORY-PERCENT   TO DL-INVENTORY-PERCENT.         09460000
           MOVE ML108-INVENTORY-RANKING                                 09470000
                                       TO DL-INVENTORY-RANK-HOLD.       09480000
                                                                        09490000
           MOVE 'N'                    TO PS-FIND-STORE.                09500000
                                                                        09510000
           PERFORM                                                      09520000
               VARYING PS-STORE-SUB                                     09530000
               FROM 1 BY 1                                              09540000
               UNTIL (PS-STORE-SUB > ST-STORE-TOTAL-TABLE-SIZE          09550000
                   OR PS-STORE-FOUND)                                   09560000
                   EVALUATE TRUE                                        09570000
                       WHEN ML108-STORE-NUMBER =                        09580000
                           ST-STORE-NUMBER (PS-STORE-SUB)               09590000
                       MOVE ST-STORE-NAME (PS-STORE-SUB)                09600000
                                       TO DL-STORE-NAME                 09610000
                       SET PS-STORE-FOUND                               09620000
                                       TO TRUE                          09630000
                   END-EVALUATE                                         09640000
           END-PERFORM.                                                 09650000
                                                                        09660000
           PERFORM 6900-CHECK-LINE-COUNT.                               09670000
                                                                        09680000
           MOVE DL-DETAIL-LINE         TO STORE-RANKING-LINE.           09690000
                                                                        09700000
           PERFORM 6999-WRITE-PRINT-LINE.                               09710000
                                                                        09720000
           ADD 1                       TO PC-REPORT-RECS-WRITTEN.       09730000
                                                                        09740000
           MOVE 1                      TO CP-SPACE-CONTROL.             09750000
                                                                        09760000
       EJECT                                                            09770000
                                                                        09780000
      ******************************************************************09790000
       4000-READ-CONTROL-FILE.                                          09800000
      ******************************************************************09810000
      *                                                                 09820000
           READ CONTROL-FILE                                            09830000
             INTO CC-CONTROL-CARD                                       09840000
               AT END                                                   09850000
                   MOVE '4000-READ-CONTROL-FILE'                        09860000
                                       TO AA-PARAGRAPH-NAME             09870000
                   MOVE 'CONTROL CARD IS MISSING'                       09880000
                                       TO AA-MESSAGE                    09890000
                   MOVE +4002          TO ABEND-CODE                    09900000
                   PERFORM 9900-COMMON-ABEND-ROUTINE.                   09910000
                                                                        09920000
       EJECT                                                            09930000
                                                                        09940000
      ******************************************************************09950000
       4100-READ-RANK-EXTRACT-FILE.                                     09960000
      ******************************************************************09970000
      *                                                                 09980000
           READ RANK-EXTRACT-FILE                                       09990000
               INTO ML108-STORE-RANKING-RECORD                          10000000
                   AT END                                               10010000
                       SET PS-END-OF-RANK-EXTRACT-FILE                  10020000
                                       TO TRUE.                         10030000
                                                                        10040000
       EJECT                                                            10050000
                                                                        10060000
      ******************************************************************10070000
       6000-PRODUCES-HEADINGS.                                          10080000
      ******************************************************************10090000
      *                                                                 10100000
      *    IF LC-LASER-BREAK                                            10110000
      *        WRITE STORE-RANKING-LINE FROM                            10120000
      *            LC-LASER-CONTROL-FD                                  10130000
      *                AFTER ADVANCING PAGE                             10140000
      *    ELSE                                                         10150000
W26603         MOVE SPACES        TO DP150O-LASER-NEW-PAGE-INDICATR.    10160000
      *    END-IF.                                                      10170000
                                                                        10180000
           ADD 1                       TO PC-PAGE-NUMBER.               10190000
                                                                        10200000
W26603     MOVE PC-PAGE-NUMBER         TO DP150O-PAGE-NUMBER.           10210000
                                                                        10220000
      *    MOVE 'N'                    TO LC-LASER-BREAK-SW.            10230000
                                                                        10240000
JS         WRITE STORE-RANKING-LINE                                     10250000
W26603         FROM DP150O-STANDRD-HEADER-150-COLS                      10260000
                   AFTER ADVANCING PAGE.                                10270000
                                                                        10280000
W26603*    MOVE SPACES                TO DP150O-LASER-NEW-PAGE-INDICATR.10290000
           WRITE STORE-RANKING-LINE                                     10300000
               FROM H2-HEADING2                                         10310000
                   AFTER ADVANCING 2.                                   10320000
                                                                        10330000
           WRITE STORE-RANKING-LINE                                     10340000
               FROM H3-HEADING3                                         10350000
                   AFTER ADVANCING 1.                                   10360000
                                                                        10370000
           MOVE SA-DEPT-BUYER          TO H4-BUYER.                     10380000
           IF ML108-CLASS-NUMBER > ZERO                                 10390000
               MOVE ML108-CLASS-NUMBER TO H4-MAJ-CLASS-NUMBER           10400000
               MOVE SA-MAJ-CLASS-TITLE TO H4-MAJ-CLASS-HOLD             10410000
               MOVE ML108-DESCRIPTION  TO H4-MAJ-CLASS-DESC             10420000
           ELSE                                                         10430000
               IF SA-MAJ-CLASS-VALUE > SPACES                           10440000
                   MOVE SA-MAJ-CLASS-VALUE                              10450000
                                       TO H4-MAJ-CLASS-NUMBER           10460000
                   MOVE SA-MAJ-CLASS-TITLE                              10470000
                                       TO H4-MAJ-CLASS-HOLD             10480000
                   MOVE ML108-DESCRIPTION                               10490000
                                       TO H4-MAJ-CLASS-DESC             10500000
               ELSE                                                     10510000
                   MOVE SPACES         TO H4-MAJ-CLASS-NUMBER           10520000
                                          H4-MAJ-CLASS-DESC             10530000
                                          H4-MAJ-CLASS-HOLD             10540000
               END-IF                                                   10550000
           END-IF.                                                      10560000
           WRITE STORE-RANKING-LINE                                     10570000
               FROM H4-HEADING4                                         10580000
                   AFTER ADVANCING 1.                                   10590000
                                                                        10600000
           WRITE STORE-RANKING-LINE                                     10610000
               FROM H5-HEADING5                                         10620000
                   AFTER ADVANCING 1.                                   10630000
                                                                        10640000
           WRITE STORE-RANKING-LINE                                     10650000
               FROM H6-HEADING6                                         10660000
                   AFTER ADVANCING 1.                                   10670000
                                                                        10680000
           MOVE 2                      TO CP-SPACE-CONTROL.             10690000
                                                                        10700000
           MOVE ZERO                   TO CP-LINE-COUNT.                10710000
                                                                        10720000
       EJECT                                                            10730000
                                                                        10740000
      ******************************************************************10750000
       6900-CHECK-LINE-COUNT.                                           10760000
      ******************************************************************10770000
      *                                                                 10780000
           IF CP-LINE-COUNT < CP-LINE-MAX                               10790000
               CONTINUE                                                 10800000
           ELSE                                                         10810000
               PERFORM 6000-PRODUCES-HEADINGS                           10820000
           END-IF.                                                      10830000
                                                                        10840000
       EJECT                                                            10850000
                                                                        10860000
      ******************************************************************10870000
       6999-WRITE-PRINT-LINE.                                           10880000
      ******************************************************************10890000
      *                                                                 10900000
           WRITE STORE-RANKING-LINE                                     10910000
               AFTER ADVANCING CP-SPACE-CONTROL.                        10920000
                                                                        10930000
           ADD CP-SPACE-CONTROL        TO CP-LINE-COUNT.                10940000
                                                                        10950000
       EJECT                                                            10960000
                                                                        10970000
      ******************************************************************10980000
       7000-SELECT-TMLCNTL.                                             10990000
      ******************************************************************11000000
      *                                                                 11010000
           EXEC SQL                                                     11020000
               SELECT OPN_FSCL_MN_DTE,                                  11030000
                      OPN_FSCL_WK_DTE                                   11040000
               INTO  :PV-OPN-FSCL-MN-DTE,                               11050000
                     :PV-OPN-FSCL-WK-DTE                                11060000
               FROM TMLCNTL                                             11070000
W26603         WITH UR                                                  11080000
           END-EXEC.                                                    11090000
                                                                        11100000
           EVALUATE TRUE                                                11110000
               WHEN SQLCODE = ZERO                                      11120000
                   CONTINUE                                             11130000
               WHEN OTHER                                               11140000
                   MOVE '7000-SELECT-TMLCNTL'                           11150000
                                       TO AA-PARAGRAPH-NAME             11160000
                   MOVE 'TMLCNTL ROW NOT FOUND'                         11170000
                                       TO AA-MESSAGE                    11180000
                   MOVE 'SELECT'       TO AA-DB2-OPERATION              11190000
                   PERFORM 9901-SQL-ERROR                               11200000
           END-EVALUATE.                                                11210000
                                                                        11220000
       EJECT                                                            11230000
                                                                        11240000
      ******************************************************************11250000
W26603 7100-OPEN-CURSOR-XMT-LOC.                                        11270000
      ******************************************************************11280000
      *                                                                 11290000
           EXEC SQL                                                     11300000
               OPEN STORE_CURSOR                                        11310000
           END-EXEC.                                                    11320000
                                                                        11330000
           EVALUATE TRUE                                                11340000
               WHEN SQLCODE = ZERO                                      11350000
                   CONTINUE                                             11360000
               WHEN OTHER                                               11370000
W26603             MOVE '7100-OPEN-CURSOR-XMT-LOC'                      11390000
                                       TO AA-PARAGRAPH-NAME             11400000
W26603             MOVE 'XMT_LOC TABLE ERROR'                           11420000
                                       TO AA-MESSAGE                    11430000
                   MOVE 'OPEN CURSOR'  TO AA-DB2-OPERATION              11440000
                   PERFORM 9901-SQL-ERROR                               11450000
           END-EVALUATE.                                                11460000
                                                                        11470000
       EJECT                                                            11480000
                                                                        11490000
      ******************************************************************11500000
W26603 7110-FETCH-XMT-LOC.                                              11520000
      ******************************************************************11530000
      *                                                                 11540000
           EXEC SQL                                                     11550000
               FETCH STORE_CURSOR                                       11560000
W26603         INTO                                                     11610000
W26603               :XMT00001-LOC-NBR,                                 11620000
W26603               :XMT00001-LOC-TYP-CDE,                             11630000
W26603               :XMT00001-LOC-10-ABBR-NM                           11640000
           END-EXEC.                                                    11650000
                                                                        11660000
           EVALUATE TRUE                                                11670000
               WHEN SQLCODE = ZERO                                      11680000
                   CONTINUE                                             11690000
               WHEN SQLCODE = +100                                      11700000
W26603             MOVE 'Y'            TO PS-XMT-LOC-DONE               11720000
               WHEN OTHER                                               11730000
W26603             MOVE '7110-FETCH-XMT-LOC'                            11750000
                                       TO AA-PARAGRAPH-NAME             11760000
W26603             MOVE 'XMT_LOC TABLE ERROR'                           11780000
                                       TO AA-MESSAGE                    11790000
                   MOVE 'FETCH'        TO AA-DB2-OPERATION              11800000
                   PERFORM 9901-SQL-ERROR                               11810000
           END-EVALUATE.                                                11820000
                                                                        11830000
       EJECT                                                            11840000
                                                                        11850000
      ******************************************************************11860000
W26603 7120-CLOSE-CURSOR-XMT-LOC.                                       11880000
      ******************************************************************11890000
      *                                                                 11900000
           EXEC SQL                                                     11910000
               CLOSE STORE_CURSOR                                       11920000
           END-EXEC.                                                    11930000
                                                                        11940000
           EVALUATE TRUE                                                11950000
               WHEN SQLCODE = ZERO                                      11960000
                   CONTINUE                                             11970000
               WHEN OTHER                                               11980000
W26603             MOVE '7120-CLOSE-CURSOR-XMT-LOC'                     12000000
                                       TO AA-PARAGRAPH-NAME             12010000
W26603             MOVE 'XMT_LOC TABLE ERROR'                           12030000
                                       TO AA-MESSAGE                    12040000
                   MOVE 'CLOSE CURSOR' TO AA-DB2-OPERATION              12050000
                   PERFORM 9901-SQL-ERROR                               12060000
           END-EVALUATE.                                                12070000
                                                                        12080000
       EJECT                                                            12090000
                                                                        12100000
      ******************************************************************12110000
       7300-READ-BUYER-DB.                                              12120000
      ******************************************************************12130000
      *                                                                 12140000
           MOVE SA-OLD-BUYER           TO PV-BUYER-NUM-2.               12150000
           MOVE PV-BUYER-NUM           TO PV-BUYER-NUM-3.               12160000
           MOVE SA-OLD-DEPT            TO PV-DEPT-NUM.                  12170000
           MOVE SPACES                 TO H4-BUYER-NAME.                12180000
                                                                        12190000
           EXEC SQL                                                     12200000
               SELECT WORKER_FIR_NAME                                   12210000
                    , WORKER_LAST_NAME                                  12220000
               INTO :RSPBAR-WORKER-FIR-NAME                             12230000
                  , :RSPBAR-WORKER-LAST-NAME                            12240000
               FROM TMDSEAR, TRSPBAR                                    12250000
               WHERE (TMDSEAR.OPERCO_NBR = '03'                         12260000
                 AND  BYR_NBR            = :PV-BUYER-NUM-3              12270000
                 AND DEPT_NBR            = :PV-DEPT-NUM                 12280000
                 AND MDSELV_CDE          = 'DPT'                        12290000
                 AND (:PV-OPN-FSCL-MN-DTE                               12300000
                   BETWEEN STRT_DTE AND END_DTE)                        12310000
                 AND RSPLVL_CDE          = 'BYR'                        12320000
                 AND (:PV-OPN-FSCL-MN-DTE                               12330000
                   BETWEEN WORKER_STRT_DTE AND WORKER_END_DTE)          12340000
                 AND TMDSEAR.OPERCO_NBR  = TRSPBAR.OPERCO_NBR           12350000
                 AND TMDSEAR.MDSEAR_DKEY = TRSPBAR.MDSEAR_DKEY)         12360000
W26603         WITH UR                                                  12370000
           END-EXEC.                                                    12380000
                                                                        12390000
           EVALUATE TRUE                                                12400000
               WHEN SQLCODE = 0                                         12410000
                   MOVE RSPBAR-WORKER-FIR-NAME                          12420000
                                       TO PV-FIRST-NAME                 12430000
                   STRING  PV-FIRST-INIT DELIMITED BY SIZE              12440000
                           '. ' DELIMITED BY SIZE,                      12450000
                           RSPBAR-WORKER-LAST-NAME DELIMITED BY '  '    12460000
                     INTO H4-BUYER-NAME                                 12470000
               WHEN SQLCODE = +100                                      12480000
                   MOVE 'THE UNKNOWN BUYER'                             12490000
                                       TO H4-BUYER-NAME                 12500000
                   DISPLAY 'NO NAME FOR BUYER ' PV-BUYER-NUM-3          12510000
                     ' AND DEPT ' PV-DEPT-NUM                           12520000
               WHEN OTHER                                               12530000
                   DISPLAY '7300-READ-BUYER-DB'                         12540000
                   DISPLAY 'BUYER NUMBER:' PV-BUYER-NUM-2               12550000
                   DISPLAY 'DEPT NUMBER:' PV-DEPT-NUM                   12560000
                   MOVE '7300-READ-BUYER-DB'                            12570000
                                       TO AA-PARAGRAPH-NAME             12580000
                   MOVE 'BAD SELECT ON TMDSEAR/TRSPBAR TABLES'          12590000
                                       TO AA-MESSAGE                    12600000
                   PERFORM 9901-SQL-ERROR                               12610000
           END-EVALUATE.                                                12620000
                                                                        12630000
       EJECT                                                            12640000
                                                                        12650000
      ******************************************************************12660000
       7400-READ-BUYER-DMM.                                             12670000
      ******************************************************************12680000
      *                                                                 12690000
           MOVE ML108-DIVISION-NUMBER  TO PV-DIVISION-NUM.              12700000
           MOVE ML108-MANAGER-NUMBER   TO PV-MANAGER-NUM.               12710000
                                                                        12720000
           EXEC SQL                                                     12730000
               SELECT WORKER_LAST_NAME                                  12740000
               INTO :RSPBAR-WORKER-LAST-NAME                            12750000
               FROM TMDSEAR, TRSPBAR                                    12760000
               WHERE (TMDSEAR.OPERCO_NBR = '03'                         12770000
                 AND GMA_NBR             = :PV-DIVISION-NUM             12780000
                 AND DMA_NBR             = :PV-MANAGER-NUM              12790000
                 AND MDSELV_CDE          = 'DMA'                        12800000
                 AND (:PV-OPN-FSCL-MN-DTE                               12810000
                   BETWEEN STRT_DTE AND END_DTE)                        12820000
                 AND RSPLVL_CDE          = 'DMM'                        12830000
                 AND (:PV-OPN-FSCL-MN-DTE                               12840000
                   BETWEEN WORKER_STRT_DTE AND WORKER_END_DTE)          12850000
                 AND TMDSEAR.OPERCO_NBR  = TRSPBAR.OPERCO_NBR           12860000
                 AND TMDSEAR.MDSEAR_DKEY = TRSPBAR.MDSEAR_DKEY)         12870000
W26603         WITH UR                                                  12880000
           END-EXEC.                                                    12890000
                                                                        12900000
           EVALUATE TRUE                                                12910000
               WHEN SQLCODE = 0                                         12920000
                   MOVE RSPBAR-WORKER-LAST-NAME                         12930000
                                       TO H4-DMM-NAME                   12940000
               WHEN SQLCODE = +100                                      12950000
                   MOVE 'UNKNOWN DMM'  TO H4-DMM-NAME                   12960000
                   DISPLAY 'NO NAME FOR DIVISION ' PV-DIVISION-NUM      12970000
               WHEN OTHER                                               12980000
                   DISPLAY '7400-READ-BUYER-DMM'                        12990000
                   DISPLAY 'DIVISION NUMBER:' PV-DIVISION-NUM           13000000
                   MOVE '7400-READ-BUYER-DMM'                           13010000
                                       TO AA-PARAGRAPH-NAME             13020000
                   MOVE 'BAD SELECT ON TMDSEAR/TRSPBAR TABLES'          13030000
                                       TO AA-MESSAGE                    13040000
                   PERFORM 9901-SQL-ERROR                               13050000
           END-EVALUATE.                                                13060000
                                                                        13070000
       EJECT                                                            13080000
                                                                        13090000
      ******************************************************************13100000
       7500-SELECT-TDTATTR.                                             13110000
      ******************************************************************13120000
      *                                                                 13130000
           EXEC SQL                                                     13140000
               SELECT FSCL_WK_BEG_DTE                                   13150000
               INTO  :DTATTR-FSCL-WK-BEG-DTE                            13160000
               FROM TDTATTR                                             13170000
               WHERE KY_DTE  = :PV-OPN-FSCL-WK-DTE                      13180000
W26603         WITH UR                                                  13190000
           END-EXEC.                                                    13200000
                                                                        13210000
           EVALUATE TRUE                                                13220000
               WHEN SQLCODE = ZERO                                      13230000
                   CONTINUE                                             13240000
               WHEN OTHER                                               13250000
                   MOVE '7500-SELECT-TDTATTR'                           13260000
                                       TO AA-PARAGRAPH-NAME             13270000
                   MOVE 'TDTATTR ROW NOT FOUND'                         13280000
                                       TO AA-MESSAGE                    13290000
                   MOVE 'SELECT'       TO AA-DB2-OPERATION              13300000
                   PERFORM 9901-SQL-ERROR                               13310000
           END-EVALUATE.                                                13320000
                                                                        13330000
       EJECT                                                            13340000
                                                                        13350000
      ******************************************************************13360000
       8000-EOJ.                                                        13370000
      ******************************************************************13380000
      *                                                                 13390000
           DISPLAY ' '.                                                 13400000
           DISPLAY '*** RECORD COUNT SUMMARY'.                          13410000
           MOVE PC-TOTAL-RECS-READ     TO CD-COUNT-HOLD1.               13420000
           DISPLAY 'TOTAL RECORDS READ = ' CD-COUNT-HOLD1.              13430000
                                                                        13440000
           MOVE ER-END-OF-REPORT-LINE  TO STORE-RANKING-LINE.           13450000
           MOVE 3                      TO CP-SPACE-CONTROL.             13460000
                                                                        13470000
           PERFORM 6999-WRITE-PRINT-LINE.                               13480000
                                                                        13490000
           CLOSE CONTROL-FILE                                           13500000
                 RANK-EXTRACT-FILE                                      13510000
                 STORE-RANKING-REPORT.                                  13520000
                                                                        13530000
       EJECT                                                            13540000
                                                                        13550000
      ******************************************************************13560000
       9900-COMMON-ABEND-ROUTINE.                                       13570000
      ******************************************************************13580000
      *                                                                 13590000
           DISPLAY AA-ABEND-LIT.                                        13600000
           DISPLAY AA-PROGRAM-LIT.                                      13610000
           DISPLAY AA-PARAGRAPH-LIT.                                    13620000
           DISPLAY AA-MESSAGE-LINE.                                     13630000
           DISPLAY ABEND-CODE.                                          13640000
                                                                        13650000
           CALL 'ILBOABN0' USING ABEND-CODE.                            13660000
                                                                        13670000
       EJECT                                                            13680000
                                                                        13690000
      ******************************************************************13700000
       9901-SQL-ERROR.                                                  13710000
      ******************************************************************13720000
      *                                                                 13730000
           MOVE SQLCODE                TO SQLCODE2.                     13740000
           MOVE SQLERRD(3)             TO SQLERRD3.                     13750000
           DISPLAY '** ABEND **       ** = SQLERROR'.                   13760000
           DISPLAY '** PROGRAM        ** = MLKRP203'.                   13770000
           DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  13780000
           DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  13790000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   13800000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  13810000
                                                                        13820000
           MOVE +4013                  TO ABEND-CODE.                   13830000
           COPY DPPD004.                                                13840000
           CALL 'ILBOABN0' USING ABEND-CODE.                            13850000
                                                                        13860000
