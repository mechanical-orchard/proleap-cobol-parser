000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SEKRP012.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           03-15-19.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL CREATE THE RACF RESOURCE AUDIT         *00120005
001201*  CERTIFICATION FILE FOR USERS WITH SPECIAL OR GROUP SPECIAL    *00120105
001202*  ATTRIBUTES, AND CREATE THE HEADER RECORD FOR THE OVERALL      *00120205
001203*  CERTIFICATION FILE.  THE CERTIFICATION FILE IS SENT TO        *00120305
001204*  SAILPOINT FOR AUDIT REVIEW CAMPAIGN PROCESSING COVERING THE   *00120405
001205*  RACF RESOURCES UNDER ROUTINE REVIEW AS ENTITLEMENTS.          *00120505
001210******************************************************************00121000
001220                                                                  00122000
001230******************************************************************00123000
001240 ENVIRONMENT DIVISION.                                            00124000
001250******************************************************************00125000
001260                                                                  00126000
001270 CONFIGURATION SECTION.                                           00127000
001280                                                                  00128000
001290 SOURCE-COMPUTER.        IBM-3090.                                00129000
001300 OBJECT-COMPUTER.        IBM-3090.                                00130000
001400                                                                  00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT RACF-SPECIAL-FILE                                     00190000
002000         ASSIGN TO INP01.                                         00200000
002100                                                                  00210000
002200     SELECT RACF-GROUP-SPECIAL-FILE                               00220000
002300         ASSIGN TO INP02.                                         00230000
002400                                                                  00240000
002410     SELECT CERTIFICATION-HEADER-FILE                             00241000
002420         ASSIGN TO OUT01.                                         00242000
002430                                                                  00243000
002440     SELECT CERTIFICATION-FILE                                    00244000
002450         ASSIGN TO OUT02.                                         00245000
002490                                                                  00249000
002500******************************************************************00250000
002600 DATA DIVISION.                                                   00260000
002700******************************************************************00270000
002800                                                                  00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  RACF-SPECIAL-FILE                                            00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     RECORD CONTAINS 72 CHARACTERS                                00350000
003600     DATA RECORD IS RS-RACF-SPECIAL-RECORD.                       00360000
003700                                                                  00370000
003800 01  RS-RACF-SPECIAL-RECORD      PIC X(72).                       00380000
004000                                                                  00400000
004100 FD  RACF-GROUP-SPECIAL-FILE                                      00410000
004200     RECORDING MODE IS F                                          00420000
004300     LABEL RECORDS ARE STANDARD                                   00430000
004310     BLOCK CONTAINS 0 RECORDS                                     00431000
004320     RECORD CONTAINS 65 CHARACTERS                                00432000
004330     DATA RECORD IS RG-RACF-GROUP-SPECIAL-RECORD.                 00433000
004340                                                                  00434000
004350 01  RG-RACF-GROUP-SPECIAL-RECORD                                 00435000
004351                                 PIC X(65).                       00435100
004360                                                                  00436000
004820 FD  CERTIFICATION-HEADER-FILE                                    00482000
004830     RECORDING MODE IS F                                          00483000
004840     LABEL RECORDS ARE STANDARD                                   00484000
004850     BLOCK CONTAINS 0 RECORDS                                     00485000
004860     RECORD CONTAINS 91 CHARACTERS                                00486000
004870     DATA RECORD IS CH-CERTIFICATION-HEADER-RECORD.               00487000
004880                                                                  00488000
004890 01  CH-CERTIFICATION-HEADER-RECORD                               00489000
004891                                 PIC X(91).                       00489100
004900                                                                  00490000
005000 FD  CERTIFICATION-FILE                                           00500000
005100     RECORDING MODE IS F                                          00510000
005110     LABEL RECORDS ARE STANDARD                                   00511000
005120     BLOCK CONTAINS 0 RECORDS                                     00512000
005130     RECORD CONTAINS 91 CHARACTERS                                00513000
005140     DATA RECORD IS CF-CERTIFICATION-RECORD.                      00514000
005150                                                                  00515000
005160 01  CF-CERTIFICATION-RECORD     PIC X(91).                       00516000
005170                                                                  00517000
005180 WORKING-STORAGE SECTION.                                         00518000
005700                                                                  00570000
005800 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          00580000
005900                                              COMP SYNC.          00590000
006000     88  AC-CONTROL-CARD-ERROR                VALUE +4003.        00600000
006100     88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        00610000
006200     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        00620000
006210     88  AC-INVLD-DATA-ON-DATASET-ERROR       VALUE +4008.        00621000
006220                                                                  00622000
006230 01  PS-PROGRAM-SWITCHES.                                         00623000
006240     05  PS-END-OF-SPECIAL-FILE-SW                                00624001
006250                                 PIC X(1)     VALUE 'N'.          00625000
006260         88  PS-END-OF-SPECIAL-FILE           VALUE 'Y'.          00626001
006270     05  PS-END-OF-GROUP-SPCL-FILE-SW                             00627002
006280                                 PIC X(1)     VALUE 'N'.          00628000
006290         88  PS-END-OF-GROUP-SPECIAL-FILE     VALUE 'Y'.          00629000
006700                                                                  00670000
006710 01  PC-PROGRAM-CONSTANTS.                                        00671000
006720     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'SEKRP012'.   00672000
007034     05  PC-COMMA                PIC X(1)     VALUE ','.          00703400
007035     05  PC-DOUBLE-QUOTE         PIC X(1)     VALUE '"'.          00703500
007036     05  PC-SPECIAL              PIC X(7)     VALUE 'Special'.    00703601
007037     05  PC-GROUP-SPECIAL        PIC X(12)    VALUE               00703701
007038         'GroupSpecial'.                                          00703801
007039     05  PC-SPECIAL-CLASS        PIC X(15)    VALUE               00703901
007040         'NoResourceGroup'.                                       00704001
007041     05  PC-NO-USER-GROUP        PIC X(11)    VALUE 'NoUserGroup'.00704101
007042     05  PC-ACCESS-LEVEL-N-A     PIC X(3)     VALUE 'N/A'.        00704201
007043     05  PC-CATEGORY-UNKNOWN     PIC X(7)     VALUE 'UNKNOWN'.    00704301
007044                                                                  00704401
007045 01  PV-PROGRAM-VARIABLES.                                        00704501
007295     05  PV-CERTIFICATION-RECORD PIC X(91)    VALUE SPACES.       00729500
007750                                                                  00775000
007751 01  RS-RACF-SPECIAL-RCD.                                         00775101
007752     05  RS-USER-ID              PIC X(8)     VALUE SPACES.       00775201
007753     05  RS-USER-NAME            PIC X(40)    VALUE SPACES.       00775301
007754     05  RS-ACCOUNT-CATEGORY     PIC X(8)     VALUE SPACES.       00775401
007755         88  RS-AC-CATEGORY-NOT-DEFINED       VALUE SPACES.       00775501
007756         88  RS-AC-CATEGORY-UNKNOWN           VALUE 'UNKNOWN'.    00775601
007757     05  RS-EMPLOYEE-ID          PIC X(7)     VALUE SPACES.       00775701
007758     05  RS-ACCOUNT-SPECIAL-IND  PIC X(3)     VALUE SPACES.       00775801
007759         88  RS-ACCOUNT-SPECIAL               VALUE 'YES'.        00775902
007760     05  RS-ACCOUNT-OPERATIONS-IND                                00776001
007761                                 PIC X(3)     VALUE SPACES.       00776101
007762         88  RS-ACCOUNT-OPERATIONS            VALUE 'YES'.        00776202
007763     05  RS-ACCOUNT-AUDITOR-IND  PIC X(3)     VALUE SPACES.       00776301
007764         88  RS-ACCOUNT-AUDITOR               VALUE 'YES'.        00776402
007765                                                                  00776501
007766 01  RG-RACF-GROUP-SPECIAL-RCD.                                   00776601
007767     05  RG-USER-ID              PIC X(8)     VALUE SPACES.       00776701
007768     05  RG-USER-GROUP           PIC X(8)     VALUE SPACES.       00776801
007769     05  RG-GROUP-SPECIAL-IND    PIC X(3)     VALUE SPACES.       00776901
007770         88  RG-GROUP-SPECIAL                 VALUE 'YES'.        00777002
007771     05  RG-GROUP-OPERATIONS-IND PIC X(3)     VALUE SPACES.       00777101
007773         88  RG-GROUP-OPERATIONS              VALUE 'YES'.        00777302
007774     05  RG-GROUP-AUDITOR-IND    PIC X(3)     VALUE SPACES.       00777401
007776         88  RG-GROUP-AUDITOR                 VALUE 'YES'.        00777602
007777     05  RG-USER-NAME            PIC X(40)    VALUE SPACES.       00777701
008700                                                                  00870000
008800 01  CH-CERTIFICATION-HEADER-RCD.                                 00880002
008900     05  FILLER                  PIC X(1)     VALUE '"'.          00890000
009000     05  FILLER                  PIC X(6)     VALUE 'USR_ID'.     00900000
009100     05  FILLER                  PIC X(3)     VALUE '","'.        00910000
009200     05  FILLER                  PIC X(11)    VALUE 'ENTITLEMENT'.00920000
009300     05  FILLER                  PIC X(3)     VALUE '","'.        00930000
009400     05  FILLER                  PIC X(7)     VALUE 'USR_GRP'.    00940000
009500     05  FILLER                  PIC X(3)     VALUE '","'.        00950000
009600     05  FILLER                  PIC X(14)    VALUE               00960000
009700                                                 'RESOURCE_CLASS'.00970000
009800     05  FILLER                  PIC X(3)     VALUE '","'.        00980000
009900     05  FILLER                  PIC X(11)    VALUE 'ACCESS_TYPE'.00990000
010000     05  FILLER                  PIC X(3)     VALUE '","'.        01000000
010010     05  FILLER                  PIC X(8)     VALUE 'USR_TYPE'.   01001000
010020     05  FILLER                  PIC X(1)     VALUE '"'.          01002000
013711                                                                  01371100
013712******************************************************************01371200
013713 PROCEDURE DIVISION.                                              01371300
013714******************************************************************01371400
013715                                                                  01371500
013716 0000-MAINLINE.                                                   01371600
013717                                                                  01371700
013718     PERFORM 1000-INITIALIZE.                                     01371800
013719                                                                  01371900
013720     PERFORM 2000-PROCESS-ACCOUNT                                 01372001
013730         UNTIL PS-END-OF-SPECIAL-FILE.                            01373001
013731                                                                  01373101
013732     PERFORM 3000-PROCESS-USER-GROUP                              01373201
013733         UNTIL PS-END-OF-GROUP-SPECIAL-FILE.                      01373302
013740                                                                  01374000
013750     PERFORM 9000-EOJ-ROUTINE.                                    01375000
013800                                                                  01380000
013900     GOBACK.                                                      01390000
014000                                                                  01400000
014100******************************************************************01410000
014200*                                                                *01420000
014300******************************************************************01430000
014400                                                                  01440000
014500 1000-INITIALIZE.                                                 01450000
015200     OPEN INPUT  RACF-SPECIAL-FILE                                01520000
015300                 RACF-GROUP-SPECIAL-FILE                          01530000
015400          OUTPUT CERTIFICATION-HEADER-FILE                        01540000
015500                 CERTIFICATION-FILE.                              01550000
015600                                                                  01560000
016710     PERFORM 7000-READ-SPECIAL-FILE.                              01671000
016711                                                                  01671100
016712     PERFORM 7100-READ-GROUP-SPECIAL-FILE.                        01671200
016720                                                                  01672000
016730     MOVE CH-CERTIFICATION-HEADER-RCD TO                          01673002
016740               PV-CERTIFICATION-RECORD.                           01674000
016750     PERFORM 8000-WRITE-CERTIFICATION-HDR.                        01675000
016760*1000-EXIT.                                                       01676000
017930                                                                  01793000
017940******************************************************************01794000
017950*                                                                *01795000
017960******************************************************************01796000
017961                                                                  01796100
017962 2000-PROCESS-ACCOUNT.                                            01796201
017963     IF (RS-ACCOUNT-SPECIAL)                                      01796303
019150         INITIALIZE PV-CERTIFICATION-RECORD                       01915003
019151                                                                  01915101
019153         IF (RS-AC-CATEGORY-NOT-DEFINED)                          01915303
019154             SET RS-AC-CATEGORY-UNKNOWN TO TRUE                   01915403
019157         END-IF                                                   01915703
019158                                                                  01915801
019160         STRING PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01916003
019161                RS-USER-ID                  DELIMITED BY SPACE    01916103
019162                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01916203
019163                PC-COMMA                    DELIMITED BY SIZE     01916303
019164                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01916403
019165                PC-SPECIAL                  DELIMITED BY SIZE     01916503
019166                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01916603
019167                PC-COMMA                    DELIMITED BY SIZE     01916703
019168                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01916803
019169                PC-NO-USER-GROUP            DELIMITED BY SIZE     01916903
019170                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01917003
019171                PC-COMMA                    DELIMITED BY SIZE     01917103
019172                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01917203
019173                PC-SPECIAL-CLASS            DELIMITED BY SIZE     01917303
019174                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01917403
019175                PC-COMMA                    DELIMITED BY SIZE     01917503
019176                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01917603
019177                PC-ACCESS-LEVEL-N-A         DELIMITED BY SIZE     01917703
019178                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01917803
019179                PC-COMMA                    DELIMITED BY SIZE     01917903
019180                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01918003
019181                RS-ACCOUNT-CATEGORY         DELIMITED BY SPACE    01918103
019182                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     01918203
019183             INTO PV-CERTIFICATION-RECORD                         01918303
019185         PERFORM 8100-WRITE-CERTIFICATION-RCD                     01918503
019186     END-IF.                                                      01918603
019187                                                                  01918701
019751     PERFORM 7000-READ-SPECIAL-FILE.                              01975101
019760*2000-EXIT.                                                       01976000
019770                                                                  01977001
019780******************************************************************01978001
019790*                                                                *01979001
019800******************************************************************01980001
019900                                                                  01990001
020000 3000-PROCESS-USER-GROUP.                                         02000001
020010     IF (RG-GROUP-SPECIAL)                                        02001003
020100         INITIALIZE PV-CERTIFICATION-RECORD                       02010003
020700         STRING PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02070003
020800                RG-USER-ID                  DELIMITED BY SPACE    02080003
020900                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02090003
021000                PC-COMMA                    DELIMITED BY SIZE     02100003
021100                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02110003
021200                PC-GROUP-SPECIAL            DELIMITED BY SIZE     02120003
021300                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02130003
021400                PC-COMMA                    DELIMITED BY SIZE     02140003
021500                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02150003
021600                RG-USER-GROUP               DELIMITED BY SPACE    02160003
021700                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02170003
021800                PC-COMMA                    DELIMITED BY SIZE     02180003
021900                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02190003
022000                PC-SPECIAL-CLASS            DELIMITED BY SIZE     02200003
022100                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02210003
022200                PC-COMMA                    DELIMITED BY SIZE     02220003
022300                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02230003
022400                PC-ACCESS-LEVEL-N-A         DELIMITED BY SIZE     02240003
022500                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02250003
022600                PC-COMMA                    DELIMITED BY SIZE     02260003
022700                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02270003
022800                PC-CATEGORY-UNKNOWN         DELIMITED BY SIZE     02280003
022810                PC-DOUBLE-QUOTE             DELIMITED BY SIZE     02281003
022820             INTO PV-CERTIFICATION-RECORD                         02282003
022840         PERFORM 8100-WRITE-CERTIFICATION-RCD                     02284003
022841     END-IF.                                                      02284103
022850                                                                  02285001
022851     PERFORM 7100-READ-GROUP-SPECIAL-FILE.                        02285104
022852*3000-EXIT.                                                       02285203
022860                                                                  02286000
022870******************************************************************02287000
022880*                                                                *02288000
022890******************************************************************02289000
022900                                                                  02290000
023000 7000-READ-SPECIAL-FILE.                                          02300000
023100     READ RACF-SPECIAL-FILE                                       02310000
023200         INTO RS-RACF-SPECIAL-RCD                                 02320000
023300         AT END                                                   02330000
023400             SET PS-END-OF-SPECIAL-FILE TO TRUE                   02340000
023500     END-READ.                                                    02350000
023600*7000-EXIT.                                                       02360000
023700                                                                  02370000
023800******************************************************************02380000
023900*                                                                *02390000
024000******************************************************************02400000
024100                                                                  02410000
024200 7100-READ-GROUP-SPECIAL-FILE.                                    02420000
024300     READ RACF-GROUP-SPECIAL-FILE                                 02430000
024400         INTO RG-RACF-GROUP-SPECIAL-RCD                           02440000
024500         AT END                                                   02450000
024600             SET PS-END-OF-GROUP-SPECIAL-FILE TO TRUE             02460000
024700     END-READ.                                                    02470000
024800*7100-EXIT.                                                       02480000
027080                                                                  02708000
027090******************************************************************02709000
027091*                                                                *02709100
027092******************************************************************02709200
027093                                                                  02709300
027094 8000-WRITE-CERTIFICATION-HDR.                                    02709400
027095     WRITE CH-CERTIFICATION-HEADER-RECORD                         02709500
027096         FROM PV-CERTIFICATION-RECORD.                            02709600
027097*8000-EXIT.                                                       02709700
027098                                                                  02709800
027099******************************************************************02709900
027100*                                                                *02710000
027101******************************************************************02710100
027102                                                                  02710200
027103 8100-WRITE-CERTIFICATION-RCD.                                    02710300
027104     WRITE CF-CERTIFICATION-RECORD                                02710400
027105         FROM PV-CERTIFICATION-RECORD.                            02710500
027106*8100-EXIT.                                                       02710600
027107                                                                  02710700
027108******************************************************************02710800
027110*  CLOSE ALL FILES.                                              *02711000
027200******************************************************************02720000
027300                                                                  02730000
027400 9000-EOJ-ROUTINE.                                                02740000
027500     CLOSE RACF-SPECIAL-FILE                                      02750000
027600           RACF-GROUP-SPECIAL-FILE                                02760000
027700           CERTIFICATION-HEADER-FILE                              02770000
027800           CERTIFICATION-FILE.                                    02780000
028000*9000-EXIT.                                                       02800000
