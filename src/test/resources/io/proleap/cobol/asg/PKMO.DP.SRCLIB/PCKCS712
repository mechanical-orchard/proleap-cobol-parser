000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS712.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JUNE , 2001.                                      00070000
000800 DATE-COMPILED.                                                   00080000
001000*---------------------------------------------------------------* 00100000
001100*    E712 - PO/RECEIVER CARTON LIST PROGRAM.                    * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM CREATES A SCREEN THAT WILL LIST ALL CARTONS   * 00130000
001400*    (SERIAL SHIP CODES) FOR A PO/RECEIVER.  THE SCREEN CAN     * 00140000
001500*    EITHER BE ACCESSED FROM THE CRIT SPEC SCREEN (F24) OR FROM * 00150000
001600*    THE PO/RECEIVER CHECK-IN STATUS SCREEN (F23).              * 00160000
001700*---------------------------------------------------------------* 00170000
001800*  CHANGED 10/13/2014    BY COGNIZANT       WR: CHG0094517        00180099
001810*                                                                 00181099
001820* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00182099
001830*-----------------------------------------------------------------00183099
001840* DATE  11/04/2021                                                00184099
001850*            - CHANGE CALL OF 'DPKUT100' TO                     * 00185099
001860*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00186099
001870*              MAKING THE CALL DYNAMIC VS STATIC                * 00187099
001880*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00188099
001890*-----------------------------------------------------------------00189099
1122RM* DATE  11/07/2022                                              * 00189199
1122RM*            - ADD COPYBOOK DPWS930                             * 00189299
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00189399
1122RM*              DYNAMIC.                                         * 00189499
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00189599
1122RM*-----------------------------------------------------------------00189699
001900 ENVIRONMENT DIVISION.                                            00190000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  DK-DB2-KEYS.                                                 00250000
002600     05  DK-OPER-UNT-ID                 PIC S9(04) COMP VALUE +0. 00260000
002700     05  DK-FCLTY-ID                    PIC S9(04) COMP VALUE +0. 00270000
002800     05  DK-SCAC-ID                     PIC  X(04).               00280000
002900     05  DK-VEH-NBR                     PIC  X(10).               00290000
003000     05  DK-TRIP-ID                     PIC S9(09) COMP VALUE +0. 00300000
003100     05  DK-PO-NBR                      PIC S9(09) COMP VALUE +0. 00310000
003200     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP VALUE +0. 00320000
003210     05  DK-STR-NBR                     PIC S9(4)   COMP.         00321099
003220     05  DK-STORE-NMBR.                                           00322099
003230         10  FILLER                     PIC X(01)   VALUE SPACES. 00323099
003240         10  DK-THREE-DIG-STORE-NMBR    PIC X(03)   VALUE SPACES. 00324099
003250     05  DK-STORE-X                     PIC X(03)   VALUE SPACES. 00325099
003251     05  DK-RANDOM-NBR                  PIC S9(09)  COMP.         00325199
003252*                                                                 00325299
003253     05  DK-CARTON-ID             PIC S9(18)V COMP-3.             00325399
003254     05  DK-CARTON-ID2            PIC  9(18).                     00325499
003255     05  DK-CARTON-ID3.                                           00325599
003256         10  DK-FIRST-CARTON      PIC 9(2).                       00325699
003257         10  DK-CARTON-ID4        PIC 9(18).                      00325799
003258         10  DK-LAST-CARTON       PIC 9(2).                       00325899
003259     05  DK-CARTON-ID-DB2.                                        00325999
003260         10  DK-FIRST-PART        PIC 9(7).                       00326099
003270         10  DK-REST-OF           PIC 9(11).                      00327099
003280     05  DK-START.                                                00328099
003290         10  DK-FIRST-START       PIC 9(7).                       00329099
003291         10  DK-REST-OF-START     PIC 9(11) VALUE ZEROES.         00329199
003292     05  DK-END.                                                  00329299
003293         10  DK-FIRST-END         PIC 9(7).                       00329399
003294         10  DK-REST-OF-END       PIC 9(11) VALUE 99999999999.    00329499
003295     05  DK-START2                PIC  9(18)V.                    00329599
003296     05  DK-END2                  PIC  9(18)V.                    00329699
003297     05  DK-START-DB2             PIC S9(18)V COMP-3.             00329799
003298     05  DK-END-DB2               PIC S9(18)V COMP-3.             00329899
003299                                                                  00329999
003300 01  PC-PROGRAM-CONSTANTS.                                        00330099
003400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00340099
003500                                                    'PCK712  '.   00350099
003600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00360099
003700                                                    'PCKM712 '.   00370099
003800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380099
003900                                                    'PCKCS712'.   00390099
004000     05  PC-PRTR-VALIDATION-PGM         PIC  X(08)  VALUE         00400099
004010                                                    'DPKCS060'.   00401099
004020     05  PC-RANDOM-PGM                  PIC  X(08)  VALUE         00402099
004021                                                    'DPKUT902'.   00402199
004022     05  PC-REPORT-PGM-1                PIC  X(08)  VALUE         00402299
004023                                                    'PCKCS126'.   00402399
004024     05  PC-PRINT-PROGRAM               PIC  X(08)  VALUE         00402499
004025                                                    'PCKCS728'.   00402599
004028     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00402899
004029     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00402999
004030     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00403099
004040     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00404099
004050     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     00405099
004060                                                    COMP SYNC.    00406099
004070     05  PC-MAX-ITEMS                   PIC S9(09) VALUE +1000000 00407099
004080                                                    COMP-3.       00408099
004090     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00409099
004100                                                    COMP SYNC.    00410099
004200     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00420099
004300                                                    COMP SYNC.    00430099
004400     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00440099
004500                                                    COMP-3.       00450099
004600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00460099
004700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00470099
004800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00480099
004900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00490099
005000     05  PC-01                          PIC  X(02)  VALUE '01'.   00500099
005100     05  PC-A                           PIC  X(01)  VALUE 'A'.    00510099
005200     05  PC-E                           PIC  X(01)  VALUE 'E'.    00520099
005300     05  PC-I                           PIC  X(01)  VALUE 'I'.    00530099
005400     05  PC-S                           PIC  X(01)  VALUE 'S'.    00540099
005500     05  PC-SHOF                        PIC  X(04)  VALUE 'SHOF'. 00550099
005600     05  PC-SHON                        PIC  X(04)  VALUE 'SHON'. 00560099
005700     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00570099
005800*                                                                 00580099
005900*----------------------------------------------------------------*00590099
006000*  SYSTEM MESSAGES                                               *00600099
006100*----------------------------------------------------------------*00610099
006200*   00005 = INVALID VALUE                                        *00620099
006300*   00007 = REQUIRED ENTRY                                       *00630099
006400*   00008 = MUST BE NUMERIC                                      *00640099
006500*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00650099
006600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00660099
006700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00670099
006800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00680099
006900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00690099
007000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00700099
007100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00710099
007200*   00069 - TOP OF LIST                                          *00720099
007300*   00070 - BOTTOM OF LIST                                       *00730099
007400*   00279 - MORE ITEMS TO DISPLAY                                *00740099
007500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00750099
007600*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*00760099
007700*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*00770099
007800*   02688 = UNABLE TO PERFORM FUNCTION, CARTON INACTIVE          *00780099
007900*   02692 = INVALID STATUS FOR FUNCTION REQUESTED                *00790099
008000*   02694 = COMMUNICATION ERROR WHEN CREATING LABELS - CONTACT SU*00800099
008100*   02750 = INVALID FUNCTION FOR CARTON SOURCE                   *00810099
008200*   99901 = INVALID COMMAND WAS ENTERED                          *00820099
008300*----------------------------------------------------------------*00830099
008400     05  PC-TSYMSG-NUMBERS.                                       00840099
008500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00850099
008600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00860099
008700         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00870099
008800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00880099
008900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00890099
009000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00900099
009100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00910099
009200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00920099
009300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00930099
009400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00940099
009500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00950099
009600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00960099
009700         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00970099
009800         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  00980099
009900         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  00990099
010000         10  PC-TSYMSG-01756            PIC  9(05)  VALUE 01756.  01000099
010100         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01010099
010200         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01020099
010300         10  PC-TSYMSG-02688            PIC  9(05)  VALUE 02688.  01030099
010400         10  PC-TSYMSG-02692            PIC  9(05)  VALUE 02692.  01040099
010500         10  PC-TSYMSG-02693            PIC  9(05)  VALUE 02693.  01050099
010600         10  PC-TSYMSG-02694            PIC  9(05)  VALUE 02694.  01060099
010700         10  PC-TSYMSG-02750            PIC  9(05)  VALUE 02750.  01070099
010800                                                                  01080099
010900 01  PS-PROGRAM-SWITCHES.                                         01090099
011000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01100099
011100         88  PS-NO-ERROR                            VALUE 'Y'.    01110099
011200         88  PS-ERROR                               VALUE 'N'.    01120099
011300*                                                                 01130099
011400     05  PS-PRINTER-ERROR-SW            PIC  X(01)  VALUE  'N'.   01140099
011500         88  PS-PRINTER-ERROR                       VALUE  'Y'.   01150099
011600*                                                                 01160099
011700     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01170099
011800         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01180099
011900         88  PS-BLOCK-ERROR                         VALUE 'N'.    01190099
012000*                                                                 01200099
012100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01210099
012200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01220099
012300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01230099
012400*                                                                 01240099
012500     05  PS-EO-CARTON-CSR-SW            PIC  X(01)  VALUE  'N'.   01250099
012600         88  PS-EO-CARTON-CSR                       VALUE  'Y'.   01260099
012700         88  PS-NOT-EO-CARTON-CSR                   VALUE  'N'.   01270099
012800*                                                                 01280099
012900     05  PS-TRANS-ID-DUP-SW             PIC X(01)   VALUE 'Y'.    01290099
013000         88  PS-TRANS-ID-NOT-DUP                    VALUE 'N'.    01300099
013100         88  PS-TRANS-ID-DUP                        VALUE 'Y'.    01310099
013200     05  PS-VALID-TRANS-ID-SW           PIC X(01)   VALUE 'Y'.    01320099
013300         88  PS-VALID-TRANS-ID                      VALUE 'Y'.    01330099
013400         88  PS-INVALID-TRANS-ID                    VALUE 'N'.    01340099
013500*                                                                 01350099
013600     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01360099
013700         88  PS-LIST-END                            VALUE 'Y'.    01370099
013800         88  PS-NO-LIST-END                         VALUE 'N'.    01380099
013900*                                                                 01390099
014000     05  PS-INACTV-CRTN-SW              PIC  X(01)  VALUE 'N'.    01400099
014100         88  PS-INACTV-CRTN-YES                     VALUE 'Y'.    01410099
014200         88  PS-INACTV-CRTN-NO                      VALUE 'N'.    01420099
014300                                                                  01430099
014400     05  PS-ACTV-CRTN-SW             PIC X(02)  VALUE SPACE.      01440099
014500         88  PS-INACTIVATED                     VALUE '01'.       01450099
014600         88  PS-SCANNED-ONTO-TRLR               VALUE '04'.       01460099
014700         88  PS-DIVERTED-TO-TRLR                VALUE '05'.       01470099
014800         88  PS-LOADED-ONTO-TRLR                VALUE '06'.       01480099
014900                                                                  01490099
015000 01  PV-PROGRAM-VARIABLES.                                        01500099
015100     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROS   01510099
015200                                        COMP SYNC.                01520099
015300     05  PV-SUB                         PIC S9(04)  VALUE +0      01530099
015400                                                    COMP SYNC.    01540099
015500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01550099
015600                                                    COMP SYNC.    01560099
015700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01570099
015800                                                    COMP-3.       01580099
015900     05  PV-READ-COUNT-2                PIC S9(09)  VALUE +0      01590099
016000                                                    COMP-3.       01600099
016100     05  PV-STAT-COUNT                  PIC S9(09)  VALUE +0      01610099
016200                                                    COMP-3.       01620099
016300     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      01630099
016400                                                    COMP SYNC.    01640099
016500     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       01650099
016600     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       01660099
016700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01670099
016800                                                    COMP-3.       01680099
016900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01690099
017000                                                    COMP-3.       01700099
017100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01710099
017200                                                    COMP-3.       01720099
017300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01730099
017400                                                    COMP-3.       01740099
017500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01750099
017600                                                    COMP-3.       01760099
017700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01770099
017800                                                    COMP-3.       01780099
017900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01790099
018000                                                    COMP SYNC.    01800099
018100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01810099
018200                                                    COMP SYNC.    01820099
018300     05  PV-ITEM                        PIC S9(04)  VALUE +0      01830099
018400                                                    COMP SYNC.    01840099
018500     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01850099
018600                                                    COMP SYNC.    01860099
018700     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01870099
018800                                                    COMP SYNC.    01880099
018900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01890099
019000                                                    COMP SYNC.    01900099
019100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01910099
019200                                                    COMP SYNC.    01920099
019300     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01930099
019400                                                    COMP SYNC.    01940099
019500     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01950099
019600                                                    COMP SYNC.    01960099
019700     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01970099
019800                                                    COMP SYNC.    01980099
019900     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01990099
020000                                                    COMP SYNC.    02000099
020100     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02010099
020200                                                    COMP SYNC.    02020099
020300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02030099
020400                                                    COMP SYNC.    02040099
020500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02050099
020600                                                    COMP SYNC.    02060099
020700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02070099
020800                                                    COMP SYNC.    02080099
020900*                                                                 02090099
021000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02100099
021100                                                     COMP SYNC.   02110099
021200     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.02120099
021300     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.02130099
021400     05  PV-CICS-MSG-HOLD.                                        02140099
021500         10  FILLER                      PIC  X(01)  VALUE SPACES.02150099
021600         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACES.02160099
021700     05  PV-CICS-MSG-HOLD2.                                       02170099
021800         10  FILLER                      PIC  X(01)  VALUE SPACES.02180099
021900         10  PV-CICS-MSG-DATA2          PIC  X(99)  VALUE SPACES. 02190099
022000*                                                                 02200099
022100     05  PV-DTE-TME.                                              02210099
022200         10  PV-DTE                     PIC  X(10)  VALUE SPACES. 02220099
022300         10  FILLER                     PIC  X(01)  VALUE SPACES. 02230099
022400         10  PV-TME                     PIC  X(07)  VALUE SPACES. 02240099
022500*                                                                 02250099
022600     05  PV-DB2-TIMESTAMP                PIC  X(26).              02260099
022700     05  PV-DB2-TIMESTAMP-R REDEFINES PV-DB2-TIMESTAMP.           02270099
022800         10  PV-DB2-TMST-DATE            PIC  X(10).              02280099
022900         10  FILLER                      PIC X(16).               02290099
023000     05  PV-START-TIMESTAMP              PIC  X(26).              02300099
023100     05  PV-END-TIMESTAMP                PIC  X(26).              02310099
023200*                                                                 02320099
023300*                                                                 02330099
023400*                                                                 02340099
023500     05  PV-PO-RECEIVER.                                          02350099
023600         10  PV-PO-NBR      PIC 9(08).                            02360099
023700         10  FILLER         PIC X(01)  VALUE '-'.                 02370099
023800         10  PV-RECEIVER    PIC 9(03).                            02380099
023900*                                                                 02390099
024000     05  PV-OPER-UNT-FCLTY.                                       02400099
024100         10  PV-OPER-UNT    PIC 9(04).                            02410099
024200         10  FILLER         PIC X(01)  VALUE '-'.                 02420099
024300         10  PV-FCLTY       PIC 9(03).                            02430099
024400*                                                                 02440099
024500     05  PV-DB2-COUNT-CRTNS             PIC S9(04)  VALUE +0      02450099
024600                                                    COMP SYNC.    02460099
024700     05  PV-NBR-CRTNS-INACTIVATED       PIC S9(04)  VALUE +0      02470099
024800                                                    COMP SYNC.    02480099
024900     05  PV-ADJUST-LABEL-COUNT          PIC  9(05) VALUE ZEROES.  02490099
025000     05  PV-TOTAL-CART-PO-ADJ           PIC S9(09) COMP.          02500099
025100     05  PV-TOTAL-CART-PO-PREV          PIC S9(09) COMP.          02510099
025200     05  PV-TROUBLE-COUNT               PIC S9(09)  COMP.         02520099
025300                                                                  02530099
025400                                                                  02540099
025500*                                                                 02550099
025600     05  PV-SEL-TERM-ID                  PIC  X(04).              02560099
025700     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02570099
025800     05  PV-SEL-SEQ                      PIC  9(01).              02580099
025900*                                                                 02590099
026000     05  PV-SHP-PRTR-CLUSTER-NBR         PIC S9(04)  VALUE ZERO.  02600099
026100     05  PV-SHP-PRTR-ID-ADDR             PIC  X(15)  VALUE SPACES.02610099
026200     05  PV-SHP-PRTR-OS-RLSE-CDE         PIC  X(15)  VALUE SPACES.02620099
026300     05  PV-SHP-DATA-XFER-MODE-ID        PIC  X(02)  VALUE SPACES.02630099
026400     05  PV-SHP-XMIT-INTFC-CDE           PIC  X(01)  VALUE SPACE. 02640099
026500     05  PV-SHP-PRTR-TYP-CDE             PIC  X(08)  VALUE SPACE. 02650099
026600*                                                                 02660099
026700     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.02670099
026800     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          02680099
026900         10  PV-RANDOM-1-8               PIC  9(08).              02690099
027000         10  FILLER                      PIC  9(01).              02700099
027100     05  PV-RANDOM-NBR-R                 PIC  9(08)  VALUE ZEROES.02710099
027200     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.02720099
027300*---------------------------------------------------------------* 02730099
027400*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 02740099
027500*   THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          * 02750099
027600*   APPLICATION-SPECIFIC COMMAREA.                              * 02760099
027700*   ALL LQW LEVEL 10'S MUST MATCH ASC LEVEL 30'S.               * 02770099
027800*---------------------------------------------------------------* 02780099
027900 01  LQW-LIST-QUEUE-WORK-AREA.                                    02790099
028000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACES. 02800099
028100     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           02810099
028200                                        INDEXED BY LQW-IDX.       02820099
028300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02830099
028400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02840099
028500         10  LQW-SELECTED-SW            PIC  X(01).               02850099
028600             88  LQW-SELECT                         VALUE 'S'.    02860099
028700             88  LQW-DESELECT                       VALUE ' '.    02870099
028800*                                                                 02880099
028900         10  LQW-ACTION                 PIC  X(03).               02890099
029000         10  LQW-SERIAL-SHIP-CDE        PIC  S9(18).              02900099
029100         10  LQW-ACTV-CDE               PIC  X(01).               02910099
029200         10  LQW-CRE-SRC                PIC  X(03).               02920099
029300         10  LQW-CART-STATUS            PIC  X(19).               02930099
029400         10  LQW-TOT-UNTS-CRTN          PIC  S9(09)               02940099
029500                                               COMP.              02950099
029600         10  LQW-CARTON-STATUS-SW       PIC X(1).                 02960099
029700             88  LQW-INACTVE-CRT-FND      VALUE 'I'.              02970099
029800             88  LQW-ACTVE-CRT-FND        VALUE 'A'.              02980099
029900         10  LQW-VERIFIED-LINE-SW       PIC X(1).                 02990099
030000             88  LQW-VERIFD-LNE-YES       VALUE 'Y'.              03000099
030100             88  LQW-VERIFD-LNE-NO        VALUE 'N'.              03010099
030200         10  LQW-CRTN-STAT-DTL-SW       PIC X(2).                 03020099
030300             88  LQW-INACTIVATED          VALUE '01'.             03030099
030400             88  LQW-SCANNED-ONTO-TRLR    VALUE '04'.             03040099
030500             88  LQW-DIVERTED-TO-TRLR     VALUE '05'.             03050099
030600             88  LQW-LOADED-ONTO-TRLR     VALUE '06'.             03060099
035200*                                                                 03520000
035300*                                                                 03530000
035400*---------------------------------------------------------------* 03540000
035500*  SELECTION QUEUE LAYOUT                                       * 03550000
035600*---------------------------------------------------------------* 03560000
035700     COPY PCWS203.                                                03570013
035701     COPY SUWS010.                                                03570199
035702     COPY PCWS206.                                                03570299
035703                                                                  03570399
035704                                                                  03570499
035705*---------------------------------------------------------------* 03570599
035706*    MAP LAYOUT                                                 * 03570699
035707*---------------------------------------------------------------* 03570799
035708*                                                                 03570899
035709     COPY PCKM712.                                                03570999
035710*                                                                 03571099
035720*DEFINITIONS MATCH PCKM712 MAPSET                                 03572099
035730 01  MR-OCCURS-LAYOUT                   REDEFINES  PCK712O.       03573099
035740     05  FILLER                         PIC X(177).               03574099
035750     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          03575099
035760         10  MR-SELECTL                 PIC S9(04) COMP.          03576099
035770         10  MR-SELECTA                 PIC  X(01).               03577099
035780         10  MR-SELECTC                 PIC  X(01).               03578099
035790         10  MR-SELECTH                 PIC  X(01).               03579099
035800         10  MR-SELECTI                 PIC  X(01).               03580099
035900                                                                  03590099
036000         10  MR-ACTIONL                 PIC S9(04) COMP.          03600099
036100         10  MR-ACTIONA                 PIC  X(01).               03610099
036200         10  MR-ACTIONC                 PIC  X(01).               03620099
036300         10  MR-ACTIONH                 PIC  X(01).               03630099
036400         10  MR-ACTION                  PIC  X(03).               03640099
036500                                                                  03650099
036600         10  MR-SHIPL                   PIC S9(04) COMP.          03660099
036700         10  MR-SHIPA                   PIC  X(01).               03670099
036800         10  MR-SHIPC                   PIC  X(01).               03680099
036900         10  MR-SHIPH                   PIC  X(01).               03690099
037000         10  MR-SHIP                    PIC  X(18).               03700099
037100                                                                  03710099
037200         10  MR-ACTVL                   PIC S9(04) COMP.          03720099
037300         10  MR-ACTVA                   PIC  X(01).               03730099
037400         10  MR-ACTVC                   PIC  X(01).               03740099
037500         10  MR-ACTVH                   PIC  X(01).               03750099
037600         10  MR-ACTV                    PIC  X(01).               03760099
037700                                                                  03770099
037800         10  MR-SRCL                    PIC S9(04) COMP.          03780099
037900         10  MR-SRCA                    PIC  X(01).               03790099
038000         10  MR-SRCC                    PIC  X(01).               03800099
038100         10  MR-SRCH                    PIC  X(01).               03810099
038200         10  MR-SRC                     PIC  X(03).               03820099
038300                                                                  03830099
038400         10  MR-STATL                   PIC S9(04) COMP.          03840099
038500         10  MR-STATA                   PIC  X(01).               03850099
038600         10  MR-STATC                   PIC  X(01).               03860099
038700         10  MR-STATH                   PIC  X(01).               03870099
038800         10  MR-STAT                    PIC  X(19).               03880099
038900                                                                  03890099
039000         10  MR-UNTS-CRTNL              PIC S9(04) COMP.          03900099
039100         10  MR-UNTS-CRTNA              PIC  X(01).               03910099
039200         10  MR-UNTS-CRTNC              PIC  X(01).               03920099
039300         10  MR-UNTS-CRTNH              PIC  X(01).               03930099
039400         10  MR-UNTS-CRTN-X.                                      03940099
039500             15 MR-UNTS-CRTN            PIC ZZZZ9.                03950099
039600                                                                  03960099
039700     05  FILLER                         PIC  X(12).               03970099
039800*                                                                 03980099
039900*---------------------------------------------------------------* 03990099
040000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04000099
040100*---------------------------------------------------------------* 04010099
040200                                                                  04020099
040300     COPY DPWS015.                                                04030099
040400                                                                  04040099
040500*---------------------------------------------------------------* 04050099
040600*    FUNCTION KEYS COPYBOOK.                                    * 04060099
040700*---------------------------------------------------------------* 04070099
040800                                                                  04080099
040900     COPY DPWS016.                                                04090099
041000                                                                  04100099
041100*----------------------------------------------------------------*04110099
041200**  SECURITY SUBROUTINE PARAMETERS                                04120099
041300*----------------------------------------------------------------*04130099
041400                                                                  04140099
041500     COPY DPWS008.                                                04150099
041600                                                                  04160099
041700*---------------------------------------------------------------* 04170099
041800*    NUMERIC EDIT LAYOUT.                                       * 04180099
041900*---------------------------------------------------------------* 04190099
042000                                                                  04200099
042100     COPY DPWS010I.                                               04210099
042200 EJECT                                                            04220099
042300*---------------------------------------------------------------* 04230099
042400*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 04240099
042500*---------------------------------------------------------------* 04250099
042600                                                                  04260099
042700     COPY DPWS030.                                                04270099
1122RM     COPY DPWS930.                                                04271099
042800 EJECT                                                            04280099
042900*---------------------------------------------------------------* 04290099
043000*    STANDARD COMMAREA.                                         * 04300099
043100*---------------------------------------------------------------* 04310099
043200                                                                  04320099
043300     COPY DPWS020.                                                04330099
043400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04340099
043500                                                                  04350099
043600*---------------------------------------------------------------* 04360099
043700* INTER-APPLICATION COMMAREA.                                   * 04370099
043800*   PCWS201 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04380099
043900*             SPEC SCREEN.                                      * 04390099
044000*   PCWS202 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04400099
044100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04410099
044200*---------------------------------------------------------------* 04420099
044300*                                                                 04430099
044400         10  INTER-APPL-COMM-AREA       PIC X(200).               04440099
044500     COPY PCWS201.                                                04450099
044600     COPY PCWS202.                                                04460099
044700     COPY PCWS204.                                                04470099
044800     COPY SUWS009.                                                04480099
044900*---------------------------------------------------------------* 04490099
045000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04500099
045100*  ASC LEVEL 30'S MUST MATCH LQW LEVEL 10'S.                    * 04510099
045200*---------------------------------------------------------------* 04520099
045300         10  ASC-SPECIFIC-COMMAREA.                               04530099
045400             15  ASC-OPER-UNT-ID          PIC S9(04) COMP.        04540099
045500             15  ASC-FCLTY-ID             PIC S9(04) COMP.        04550099
045600             15  ASC-FCLTY-NME            PIC X(25).              04560099
045700             15  ASC-PO-RECEIVER.                                 04570099
045800                 20  ASC-PO-NBR           PIC 9(08).              04580099
045900                 20  ASC-DASH             PIC X(01).              04590099
046000                 20  ASC-RECEIVER         PIC 9(03).              04600099
046100             15  ASC-VENDOR-NAME          PIC X(23).              04610099
046200             15  ASC-SHIPT-UNT-ID         PIC S9(18)V COMP-3.     04620099
046300             15  ASC-SHIPT-UNT-SRC-ID     PIC X(03).              04630099
046400             15  ASC-DATE                 PIC X(10).              04640099
046500             15  ASC-SML-PRINTER          PIC  X(08).             04650099
046600             15  ASC-STR-NUMBER           PIC S9(09).             04660099
046700             15  ASC-DEPT                 PIC S9(04) COMP.        04670099
046800             15  ASC-TOTAL-CART           PIC S9(09)              04680099
046900                                                     COMP.        04690099
047000             15  ASC-TOTAL-CART-PO        PIC S9(09)              04700099
047100                                                     COMP.        04710099
047200             15  ASC-TOTAL-UNITS          PIC S9(09)              04720099
047300                                                     COMP.        04730099
047400             15  ASC-TIME                 PIC X(05).              04740099
047500             15  ASC-STATUS-MESSAGE       PIC X(25).              04750099
049400*                                                                 04940000
049500             15  ASC-BLK-SUB                  PIC S9(04) COMP     04950000
049600                                                         SYNC.    04960000
049700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04970000
049800                                                         SYNC.    04980000
049900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04990000
050000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05000000
050100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05010000
050200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05020000
050300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05030000
050400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05040000
050500                                                         SYNC.    05050000
050600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05060000
050700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05070000
050800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05080000
050900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05090000
051000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05100000
051100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05110000
051200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05120000
051300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05130000
051400             15  ASC-LIST-QUEUE-NAME.                             05140000
051500                 20  ASC-LIST-TERM-ID         PIC  X(04).         05150000
051600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05160000
051700                 20  ASC-LIST-SEQ             PIC  9(01).         05170000
051800             15  ASC-SEL-QUEUE-NAME.                              05180000
051900                 20  ASC-SEL-TERM-ID          PIC  X(04).         05190000
052000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05200000
052100                 20  ASC-SEL-SEQ              PIC  9(01).         05210000
052200             15  ASC-SEL-QUEUE-NAME-ORIG.                         05220000
052300                 20  ASC-SEL-TERM-ID-ORIG     PIC  X(04).         05230000
052400                 20  ASC-SEL-TASK-NUMBER-ORIG PIC S9(05) COMP-3.  05240000
052500                 20  ASC-SEL-SEQ-ORIG         PIC  9(01).         05250000
052600             15  ASC-START-ITEM-REQUEST.                          05260000
052700                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05270000
052800             15  ASC-CSR-SW                   PIC  X(02).         05280000
052900                 88  ASC-NO-CSR                      VALUE 'Z '.  05290000
053000                 88  ASC-CARTON-CSR                  VALUE 'A '.  05300000
053100             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05310000
053200             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05320000
053300             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05330000
053400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05340000
053500             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05350000
053501*                                                                 05350199
053502             15  ASC-RCVR-TRBLE-EXISTS-SW     PIC X(1).           05350299
053503                 88  ASC-RCVR-TRBLE-EXISTS-YES   VALUE 'Y'.       05350399
053504                 88  ASC-RCVR-TRBLE-EXISTS-NO    VALUE 'N'.       05350499
053505                                                                  05350599
053506             15  ASC-FUNC01-RETURN-FLAG       PIC  X(1).          05350699
053507                 88  ASC-FUNC01-RETURN-NO   VALUE 'N'.            05350799
053508                 88  ASC-FUNC01-RETURN-YES  VALUE 'Y'.            05350899
053509                                                                  05350999
053510             15  ASC-FUNC03-RETURN-FLAG       PIC  X(1).          05351099
053520                 88  ASC-FUNC03-RETURN-NO   VALUE 'N'.            05352099
053530                 88  ASC-FUNC03-RETURN-YES  VALUE 'Y'.            05353099
053531                                                                  05353199
053532             15  ASC-FUNC04-RETURN-FLAG       PIC  X(1).          05353299
053533                 88  ASC-FUNC04-RETURN-NO   VALUE 'N'.            05353399
053534                 88  ASC-FUNC04-RETURN-YES  VALUE 'Y'.            05353499
053535                                                                  05353599
053536             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05353699
053537                 20  ASC-BLOCK-MODIFIED-SW          PIC X(01).    05353799
053538                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    05353899
053539                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    05353999
053540                                                                  05354099
053550                 20  ASC-ITEM-ARRAY.                              05355099
053560                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05356099
053570                         30  ASC-LIST-ITEM-NUMBER                 05357099
053580                                        PIC S9(09)  COMP-3.       05358099
053590                         30  ASC-TEMP-SELECTED-SW PIC X(01).      05359099
053600                             88  ASC-VALID-SELECT   VALUE ' '     05360099
053700                                                          'S'     05370099
053800                                                          'B'     05380099
053900                                                          'E'.    05390099
054000                             88  ASC-TEMP-NO-SELECT VALUE ' '.    05400099
054100                             88  ASC-TEMP-SELECT    VALUE 'S'.    05410099
054200                             88  ASC-TEMP-BEGIN     VALUE 'B'.    05420099
054300                             88  ASC-TEMP-END       VALUE 'E'.    05430099
054400                         30  ASC-SELECTED-SW        PIC X(01).    05440099
054500                             88  ASC-NO-SELECT      VALUE ' '.    05450099
054600                             88  ASC-SELECT         VALUE 'S'.    05460099
054700                             88  ASC-BEGIN          VALUE 'B'.    05470099
054800                             88  ASC-END            VALUE 'E'.    05480099
054900                         30  ASC-ACTION             PIC X(03).    05490099
055000                         30  ASC-SERIAL-SHIP-CDE    PIC S9(18).   05500099
055100                         30  ASC-ACTV-CDE           PIC X(01).    05510099
055200                         30  ASC-CRE-SRC            PIC X(03).    05520099
055300                         30  ASC-CART-STATUS        PIC X(19).    05530099
055400                         30  ASC-TOT-UNTS-CRTN      PIC S9(09)    05540099
055500                                                          COMP.   05550099
055600                         30  ASC-CARTON-STATUS-SW   PIC X(1).     05560099
055700                             88  ASC-INACTVE-CRT-FND   VALUE 'I'. 05570099
055800                             88  ASC-ACTVE-CRT-FND     VALUE 'A'. 05580099
055900                         30  ASC-VERIFIED-LINE-SW   PIC X(1).     05590099
056000                             88  ASC-VERIFD-LNE-YES    VALUE 'Y'. 05600099
056100                             88  ASC-VERIFD-LNE-NO     VALUE 'N'. 05610099
056200                         30  ASC-CRTN-STAT-DTL-SW       PIC X(2). 05620099
056300                             88  ASC-INACTIVATED      VALUE '01'. 05630099
056400                             88  ASC-SCANNED-ONTO-TRLR VALUE '04'.05640099
056500                             88  ASC-DIVERTED-TO-TRLR VALUE '05'. 05650099
056600                             88  ASC-LOADED-ONTO-TRLR VALUE '06'. 05660099
056700                                                                  05670099
056800******************************************************************05680099
056900                                                                  05690099
057000 EJECT                                                            05700099
057100*----------------------------------------------------------------*05710099
057200*  SENDING/RECEIVING AREA FOR THE                                 05720099
057300*  PRINTER VALIDATION ROUTING (DPKCS060)                          05730099
057400*----------------------------------------------------------------*05740099
057500                                                                  05750099
057600     COPY DPWS072.                                                05760099
057700*----------------------------------------------------------------*05770099
057800*  SENDING/RECEIVING AREA FOR PCKUT713                            05780099
057810*  CARTON STATUS ROUTINE (PCWS046)                                05781099
057820*----------------------------------------------------------------*05782099
057830                                                                  05783099
057840     COPY PCWS046.                                                05784099
057850*                                                                 05785099
057860*----------------------------------------------------------------*05786099
057870*  RANDOM NUMBER AREA                                             05787099
057880*----------------------------------------------------------------*05788099
057890     COPY DPWS902.                                                05789099
057900                                                                  05790099
058000*---------------------------------------------------------------* 05800099
058010*    ABEND PROCESSING COPYBOOK.                                 * 05801099
058020*---------------------------------------------------------------* 05802099
058030                                                                  05803099
058040     COPY DPWS013.                                                05804099
058050*                                                                 05805099
058060*---------------------------------------------------------------* 05806099
058070*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 05807099
058080*---------------------------------------------------------------* 05808099
058090     EXEC SQL                                                     05809099
058100          INCLUDE TPURCHS                                         05810099
058200     END-EXEC.                                                    05820099
058300*                                                                 05830099
058400*---------------------------------------------------------------* 05840099
058500*    DB2 AREA FOR THE VENDOR TABLE                              * 05850099
058600*---------------------------------------------------------------* 05860099
058700     EXEC SQL                                                     05870099
058800          INCLUDE TENTNME                                         05880099
058900     END-EXEC.                                                    05890099
059000                                                                  05900099
059100*                                                                 05910099
059200*                                                                 05920099
059300*---------------------------------------------------------------* 05930099
059400*    DB2 AREA FOR THE SHIPMENT UNIT LOCATION TABLE              * 05940099
059500*---------------------------------------------------------------* 05950099
059600     EXEC SQL                                                     05960099
059700          INCLUDE TSHUNLO                                         05970099
059800     END-EXEC.                                                    05980099
059900                                                                  05990099
060000*                                                                 06000099
060100*---------------------------------------------------------------* 06010099
060200*    DB2 AREA FOR THE SHIPPING UNIT TABLE                       * 06020099
060300*---------------------------------------------------------------* 06030099
060400     EXEC SQL                                                     06040099
060500          INCLUDE SUT00024                                        06050099
060600     END-EXEC.                                                    06060099
060700                                                                  06070099
061500*                                                                 06150099
061600*---------------------------------------------------------------* 06160099
061700*    DB2 AREA FOR THE SHIPPING UNIT UPC ASSOCIATION TABLE       * 06170099
061800*---------------------------------------------------------------* 06180099
061900     EXEC SQL                                                     06190099
062000          INCLUDE SUT00028                                        06200099
062100     END-EXEC.                                                    06210099
062200                                                                  06220099
062300*---------------------------------------------------------------* 06230099
062400*    DB2 AREA FOR THE DIVERT TABLE                              * 06240099
062500*---------------------------------------------------------------* 06250099
062600     EXEC SQL                                                     06260099
062700          INCLUDE TSUCRDV                                         06270099
062800     END-EXEC.                                                    06280099
062900                                                                  06290099
063000*                                                                 06300099
063100*---------------------------------------------------------------* 06310099
063200*    DB2 AREA FOR THE HISTORY TABLE                             * 06320099
063300*---------------------------------------------------------------* 06330099
063400     EXEC SQL                                                     06340099
063500          INCLUDE TLBTKHS                                         06350099
063600     END-EXEC.                                                    06360099
063700                                                                  06370099
063800*                                                                 06380099
063900*---------------------------------------------------------------* 06390099
064000*    DB2 AREA                                                   * 06400099
064100*---------------------------------------------------------------* 06410099
064200     EXEC SQL                                                     06420099
064300          INCLUDE TRECITM                                         06430099
064400     END-EXEC.                                                    06440099
064500                                                                  06450099
064600*                                                                 06460099
064700*---------------------------------------------------------------* 06470099
064800*---------------------------------------------------------------* 06480099
064900*    DB2 AREA                                                   * 06490099
065000*---------------------------------------------------------------* 06500099
065100     EXEC SQL                                                     06510099
065200          INCLUDE TPKSLIP                                         06520099
065300     END-EXEC.                                                    06530099
065400                                                                  06540099
065500*                                                                 06550099
066400*---------------------------------------------------------------* 06640099
066500*      -TROUBLE NOTIFICATION TABLE                              * 06650099
066600*---------------------------------------------------------------* 06660099
066700     EXEC SQL                                                     06670099
066800          INCLUDE TTRBNTF                                         06680099
066801     END-EXEC.                                                    06680199
066802                                                                  06680299
066803                                                                  06680399
066804*---------------------------------------------------------------* 06680499
066805*      -TROUBLE REASON CODES TABLE                              * 06680599
066806*---------------------------------------------------------------* 06680699
066807     EXEC SQL                                                     06680799
066808          INCLUDE TTRBRSN                                         06680899
066809     END-EXEC.                                                    06680999
066810                                                                  06681099
066811                                                                  06681199
066812*-----------------------------------------------------------------06681299
066813*---------------------------------------------------------------* 06681399
066814*      -                                                          06681499
066815*---------------------------------------------------------------* 06681599
066816     EXEC SQL                                                     06681699
066817          INCLUDE TINPKSU                                         06681799
066818     END-EXEC.                                                    06681899
066819                                                                  06681999
066820                                                                  06682099
066821*-----------------------------------------------------------------06682199
066822*---------------------------------------------------------------* 06682299
066823     EXEC SQL                                                     06682399
066824          INCLUDE TSHPUNT                                         06682499
066825     END-EXEC.                                                    06682599
066826                                                                  06682699
066827                                                                  06682799
066828*---------------------------------------------------------------* 06682899
066829     EXEC SQL                                                     06682999
066830          INCLUDE TSHUUPC                                         06683099
066831     END-EXEC.                                                    06683199
066832                                                                  06683299
066833                                                                  06683399
066834*-----------------------------------------------------------------06683499
066835*---------------------------------------------------------------* 06683599
066836*    DB2 AREA FOR COMMUNICATIONS                                * 06683699
066837*---------------------------------------------------------------* 06683799
066838     EXEC SQL                                                     06683899
066839          INCLUDE SQLCA                                           06683999
066840     END-EXEC.                                                    06684099
066841                                                                  06684199
066842*---------------------------------------------------------------* 06684299
066843* CARTON -CURSOR FOR SELECTING FROM SUT_OTBND_CART AND         *  06684399
066844* SUT_OTBND_UPC *                                                 06684499
066845*---------------------------------------------------------------* 06684599
066850     EXEC SQL                                                     06685099
066860       DECLARE CARTON_CSR CURSOR FOR                              06686099
066870          SELECT DISTINCT                                         06687099
066880                 B.SHIPT_UNT_ID                                   06688099
066890               , B.ACTV_IND                                       06689099
066900               , B.CART_SRC_CDE                                   06690099
067000               , SUM(A.SHPD_UNT_QTY)                              06700099
067100          FROM  SUT_OTBND_UPC A,                                  06710099
067200                SUT_OTBND_CART B                                  06720099
067300          WHERE  A.TRN_NBR          =  :DK-PO-NBR                 06730099
067400           AND   A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR            06740099
067500           AND   A.SHIPT_UNT_ID     =   B.SHIPT_UNT_ID            06750099
067600           AND   B.DEST_LOC_NBR     =  :DK-STR-NBR                06760099
067700          GROUP BY B.SHIPT_UNT_ID, B.ACTV_IND, B.CART_SRC_CDE     06770099
067710       UNION                                                      06771099
067720          SELECT DISTINCT                                         06772099
067730                 C.SHIPT_UNT_ID                                   06773099
067740               , C.ACTV_IND                                       06774099
067750               , C.SHIPT_UNT_SRC_ID                               06775099
067760               , SUM(D.SHPD_QTY)                                  06776099
067770          FROM  TPKSLIP A,                                        06777099
067780                TINPKSU B,                                        06778099
067790                TSHPUNT C,                                        06779099
067800                TSHUUPC D                                         06780099
067801         WHERE A.PO_NBR           = :DK-PO-NBR                    06780199
067802           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               06780299
067803           AND A.VER_STAT_CDE     = 'A'                           06780399
067804           AND A.PO_NBR           =  B.PO_NBR                     06780499
067805           AND A.SEQ_NBR          =  B.SEQ_NBR                    06780599
067806           AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID               06780699
067807           AND C.DEST_OPER_UNT_ID = :DK-STR-NBR                   06780799
067808           AND C.SHIPT_UNT_ID     = D.SHIPT_UNT_ID                06780899
067809          GROUP BY C.SHIPT_UNT_ID, C.ACTV_IND, C.SHIPT_UNT_SRC_ID 06780999
067810       ORDER  BY 2,1                                              06781099
067820     END-EXEC.                                                    06782099
067830                                                                  06783099
067840*                                                                 06784099
067850***************************************************************   06785099
067860*                                                                 06786099
067870 LINKAGE SECTION.                                                 06787099
067880                                                                  06788099
067890 01  DFHCOMMAREA.                                                 06789099
067900     05  FILLER                         OCCURS  1 TO 4072 TIMES   06790099
068000                                        DEPENDING ON EIBCALEN.    06800099
068100         10  FILLER                     PIC X.                    06810099
068200                                                                  06820099
068300 EJECT                                                            06830099
068400*                                                                 06840099
068500*                                                                 06850099
068600 PROCEDURE DIVISION.                                              06860099
068700*---------------------------------------------------------------* 06870099
068800*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 06880099
068900*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 06890099
069000*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 06900099
069100*---------------------------------------------------------------* 06910099
069200 0000-MAIN-MODULE.                                                06920099
069300     INITIALIZE DP030-CICS-API-FIELDS.                            06930099
069400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06940099
069500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06950099
069600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06960099
069700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06970099
069800     MOVE LENGTH OF PCK712I        TO DP030-MAP-LENGTH (1).       06980099
069900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06990099
070000     PERFORM 0001-CALL-CICS-ARCH-API.                             07000099
070100*                                                                 07010099
070200     PERFORM 1000-CONTROL-PROCESSING                              07020099
070300                                                                  07030099
070400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07040099
070500     PERFORM 0001-CALL-CICS-ARCH-API.                             07050099
070600*                                                                 07060099
070700*                                                                 07070099
070800*---------------------------------------------------------------* 07080099
070900*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 07090099
071000*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 07100099
071100*---------------------------------------------------------------* 07110099
071200 0001-CALL-CICS-ARCH-API.                                         07120099
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               07130099
1122RM     CALL DP930-CICS-ARCH-API                                     07131099
1122RM                     USING DFHEIBLK                               07132099
071400                           DFHCOMMAREA                            07140099
071500                           DP030-CICS-API-FIELDS                  07150099
071600                           DP020-STANDARD-COMMAREA                07160099
071700                           PCK712I.                               07170099
071800*                                                                 07180099
071900     IF DP030-RC-CALL-SUCCESSFUL                                  07190099
072000         CONTINUE                                                 07200099
072100     ELSE                                                         07210099
072200         SET DP013-NO-ROLLBACK                                    07220099
072300             DP013-XCTL-DISPLAY-RESTART                           07230099
072400             DP013-CICS-ABEND      TO TRUE                        07240099
072500         MOVE '0001-CALL-CICS-ARCH-API'                           07250099
072600                                   TO DP013-PARAGRAPH             07260099
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07270099
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07280099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07281099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07282099
072900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07290099
073000         PERFORM DP013-0000-PROCESS-ABEND                         07300099
073100     END-IF.                                                      07310099
073200*                                                                 07320099
073300*                                                                 07330099
073400*----------------------------------------------------------------*07340099
073500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07350099
073600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07360099
073700*                                                                *07370099
073800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07380099
073900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07390099
074000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07400099
074100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07410099
074200*----------------------------------------------------------------*07420099
074300 1000-CONTROL-PROCESSING.                                         07430099
074400     EVALUATE TRUE                                                07440099
074500         WHEN DP020-NEXT-ACT-INITIAL                              07450099
074600             INITIALIZE ASC-SPECIFIC-COMMAREA                     07460099
074700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07470099
074800                                      ASC-SEL-TERM-ID             07480099
074900                                      ASC-SEL-TERM-ID-ORIG        07490099
075000             MOVE DP020-SRC-TASK-NUMBER                           07500099
075100                                   TO ASC-LIST-TASK-NUMBER        07510099
075200                                      ASC-SEL-TASK-NUMBER         07520099
075300                                      ASC-SEL-TASK-NUMBER-ORIG    07530099
075400             MOVE PC-LIST-QUEUE-SEQ                               07540099
075500                                   TO ASC-LIST-SEQ                07550099
075600             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07560099
075700                                      ASC-SEL-SEQ-ORIG            07570099
075800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07580099
075900                                                                  07590099
076000             PERFORM 4000-BUILD-INITIAL-PANEL                     07600099
076100                                                                  07610099
076200         WHEN DP020-NEXT-ACT-READ-MAP                             07620099
076300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07630099
076400                                   TO PV-TOP-ITEM                 07640099
076500             PERFORM 2000-PROCESS-PANEL                           07650099
076600                                                                  07660099
076700         WHEN DP020-NEXT-ACT-RETURN                               07670099
076800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07680099
076900                                   TO PV-TOP-ITEM                 07690099
077000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    07700099
077100             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07710099
077200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07720099
077300                                                                  07730099
077400         WHEN OTHER                                               07740099
077500             SET DP013-LOGIC-ABEND TO TRUE                        07750099
077600             SET DP013-NO-ROLLBACK TO TRUE                        07760099
077700             MOVE '1000-CONTROL-PROCESSING'                       07770099
077800                                   TO DP013-PARAGRAPH             07780099
077900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07790099
078000                                   TO DP013-MESSAGE-TEXT(1)       07800099
078100             PERFORM DP013-0000-PROCESS-ABEND                     07810099
078200     END-EVALUATE.                                                07820099
078300                                                                  07830099
078400 EJECT                                                            07840099
078500*                                                                 07850099
078600*                                                                 07860099
078700*----------------------------------------------------------------*07870099
078800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07880099
078900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07890099
079000*----------------------------------------------------------------*07900099
079100 1100-PROCESS-INTER-APPL-COMM.                                    07910099
079200     SET PS-COMMAREA-VALID         TO TRUE.                       07920099
079300     MOVE SPACES                   TO ASC-START-ITEM-REQUEST.     07930099
079400                                                                  07940099
079500     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07950099
079600         MOVE PC201-PO-NBR           TO ASC-PO-NBR                07960099
079700         MOVE PC201-REC-SEQ-NBR      TO ASC-RECEIVER              07970099
079800         MOVE PC201-OPER-UNT-ID      TO ASC-OPER-UNT-ID           07980099
079900         MOVE PC201-FCLTY-ID         TO ASC-FCLTY-ID              07990099
080000         MOVE PC201-SML-PRTR-ID      TO ASC-SML-PRINTER           08000099
080100         MOVE PC201-STR-NUMBER       TO ASC-STR-NUMBER            08010099
080200     END-IF.                                                      08020099
080300                                                                  08030099
080400     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              08040099
080500       IF PC202-NUMBER-OF-SELECTED-ITEMS > 0                      08050099
080600         MOVE PC202-OPER-UNT-ID      TO ASC-OPER-UNT-ID           08060099
080700         MOVE PC202-FCLTY-ID         TO ASC-FCLTY-ID              08070099
080800         MOVE PC202-PO-NBR           TO ASC-PO-NBR                08080099
080900         MOVE PC202-REC-SEQ-NBR      TO ASC-RECEIVER              08090099
081000         MOVE PC202-SML-PRINTER      TO ASC-SML-PRINTER           08100099
081100         MOVE PC202-VENDOR-NAME      TO ASC-VENDOR-NAME           08110099
081200                                                                  08120099
081300         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    08130099
081400         MOVE PC202-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08140099
081500         MOVE PC202-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-ORIG 08150099
081600         PERFORM 1120-PREPARE-LIST-ENTRY                          08160099
081700       ELSE                                                       08170099
081800         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           08180099
081900         SET  PS-COMMAREA-NOT-VALID TO TRUE                       08190099
082000       END-IF                                                     08200099
082100     END-IF.                                                      08210099
082200*                                                                 08220099
082300*                                                                 08230099
082400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08240099
082500 1120-PREPARE-LIST-ENTRY.                                         08250099
082600                                                                  08260099
082700     MOVE PC203-MAX-ITEMS          TO ASC-SEL-SUB.                08270099
082800     MOVE ZERO                     TO ASC-SEL-ITEM.               08280099
082900     PERFORM 1130-GET-NEXT-RECORD.                                08290099
083000*                                                                 08300099
083100*                                                                 08310099
083200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08320099
083300* GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED   *08330099
083400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08340099
083500 1130-GET-NEXT-RECORD.                                            08350099
083600                                                                  08360099
083700     ADD +1                       TO ASC-SEL-SUB.                 08370099
083800                                                                  08380099
083900     IF  ASC-SEL-SUB > PC203-MAX-ITEMS                            08390099
084000         ADD +1                   TO ASC-SEL-ITEM                 08400099
084100         MOVE +1                  TO ASC-SEL-SUB                  08410099
084200     END-IF.                                                      08420099
084300                                                                  08430099
084400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08440099
084500         PERFORM 9100-READ-SEL-QUEUE                              08450099
084600         IF  PC203-ITEM (ASC-SEL-SUB) > ZERO                      08460099
084700             MOVE PC203-DEST-OPER-UNT-ID (ASC-SEL-SUB)            08470099
084800                                  TO ASC-STR-NUMBER               08480099
084900             MOVE PC203-STORE-UNITS (ASC-SEL-SUB)                 08490099
085000                                  TO ASC-TOTAL-UNITS              08500099
085100             MOVE PC203-PREV-CTN-COUNT (ASC-SEL-SUB)              08510099
085200                                  TO ASC-TOTAL-CART               08520099
085300             MOVE PC203-TOT-CRTNS-PO (ASC-SEL-SUB)                08530099
085400                                  TO ASC-TOTAL-CART-PO            08540099
085500                                                                  08550099
085600             SET PC203-INQ (ASC-SEL-SUB)                          08560099
085700                                  TO TRUE                         08570099
085800             SET PC202-UPDATE-TSQ TO TRUE                         08580099
085900             PERFORM 9200-REWRITE-SEL-QUEUE                       08590099
086000         ELSE                                                     08600099
086100             SUBTRACT +1 FROM ASC-SEL-SUB                         08610099
086200             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08620099
086300             SET DP020-MSG-INFORMATIONAL                          08630099
086400                 PS-LIST-END             TO TRUE                  08640099
086500         END-IF                                                   08650099
086600     ELSE                                                         08660099
086700         SUBTRACT +1 FROM ASC-SEL-ITEM                            08670099
086800         MOVE PC203-MAX-ITEMS     TO ASC-SEL-SUB                  08680099
086900         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             08690099
087000         SET DP020-MSG-INFORMATIONAL                              08700099
087100             PS-LIST-END             TO TRUE                      08710099
087200     END-IF.                                                      08720099
087300*                                                                 08730099
087400*                                                                 08740099
087500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08750099
087600*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *08760099
087700*    PROCESSED.                                                  *08770099
087800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08780099
087900 1140-GET-PREV-RECORD.                                            08790099
088000                                                                  08800099
088100     SUBTRACT +1 FROM ASC-SEL-SUB.                                08810099
088200                                                                  08820099
088300     IF  ASC-SEL-SUB < +1                                         08830099
088400         SUBTRACT +1 FROM ASC-SEL-ITEM                            08840099
088500         MOVE PC203-MAX-ITEMS     TO ASC-SEL-SUB                  08850099
088600     END-IF.                                                      08860099
088700                                                                  08870099
088800     IF  ASC-SEL-ITEM > ZERO                                      08880099
088900         PERFORM 9100-READ-SEL-QUEUE                              08890099
089000             MOVE PC203-DEST-OPER-UNT-ID (ASC-SEL-SUB)            08900099
089100                                  TO ASC-STR-NUMBER               08910099
089200             MOVE PC203-STORE-UNITS (ASC-SEL-SUB)                 08920099
089300                                  TO ASC-TOTAL-UNITS              08930099
089400             MOVE PC203-PREV-CTN-COUNT (ASC-SEL-SUB)              08940099
089500                                  TO ASC-TOTAL-CART               08950099
089600             MOVE PC203-TOT-CRTNS-PO (ASC-SEL-SUB)                08960099
089700                                  TO ASC-TOTAL-CART-PO            08970099
089800         SET PC203-INQ (ASC-SEL-SUB)                              08980099
089900                                  TO TRUE                         08990099
090000         SET PC202-UPDATE-TSQ TO TRUE                             09000099
090100         PERFORM 9200-REWRITE-SEL-QUEUE                           09010099
090200     ELSE                                                         09020099
090300         MOVE +1                  TO ASC-SEL-ITEM                 09030099
090400                                     ASC-SEL-SUB                  09040099
090500         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09050099
090600         SET DP020-MSG-INFORMATIONAL                              09060099
090700             PS-LIST-END             TO TRUE                      09070099
090800     END-IF.                                                      09080099
090900*                                                                 09090099
091000*                                                                 09100099
091100*----------------------------------------------------------------*09110099
091200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITING OF THE DATA    *09120099
091300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09130099
091400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09140099
091500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09150099
091600* FUNCTION KEYS CAN GET THIS FAR.                                *09160099
091700*----------------------------------------------------------------*09170099
091800 2000-PROCESS-PANEL.                                              09180099
091900     EVALUATE TRUE                                                09190099
092000         WHEN DP020-SRC-AID = DP016-CLEAR                         09200099
092100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09210099
092200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09220099
092300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09230099
092400                                                                  09240099
092500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09250099
092600             PERFORM 2050-DELETE-LIST-QUEUE                       09260099
092700             MOVE ZEROES  TO ASC-TOTAL-UNITS                      09270099
092800             PERFORM 4000-BUILD-INITIAL-PANEL                     09280099
092900                                                                  09290099
093000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09300099
093100             PERFORM 2140-DESELECT-ALL-ITEMS                      09310099
093200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09320099
093300                                                                  09330099
093400         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 09340099
093500              PERFORM 2150-SELECT-ALL-ITEMS                       09350099
093600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09360099
093700                                                                  09370099
093800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09380099
093900             IF  ASC-USE-SELECTION-QUEUE                          09390099
094000                 PERFORM 1130-GET-NEXT-RECORD                     09400099
094100                 IF PS-LIST-END                                   09410099
094200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09420099
094300                     SET PS-NO-LIST-END TO TRUE                   09430099
094400                 ELSE                                             09440099
094500                     PERFORM 2050-DELETE-LIST-QUEUE               09450099
094600                     PERFORM 3200-RESET-ATTRIBUTES                09460099
094700                     PERFORM 4000-BUILD-INITIAL-PANEL             09470099
094800                 END-IF                                           09480099
094900              ELSE                                                09490099
095000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09500099
095100*                --- BOTTOM OF LIST ---                           09510099
095200                 MOVE PC-TSYMSG-00070                             09520099
095300                                   TO DP020-MSG-NUMBER            09530099
095400                 SET DP020-MSG-INFORMATIONAL                      09540099
095500                                   TO TRUE                        09550099
095600             END-IF                                               09560099
095700                                                                  09570099
095800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09580099
095900             IF  ASC-USE-SELECTION-QUEUE                          09590099
096000                 PERFORM 1140-GET-PREV-RECORD                     09600099
096100                 IF PS-LIST-END                                   09610099
096200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09620099
096300                     SET PS-NO-LIST-END                           09630099
096400                                   TO TRUE                        09640099
096500                 ELSE                                             09650099
096600                     PERFORM 2050-DELETE-LIST-QUEUE               09660099
096700                     PERFORM 3200-RESET-ATTRIBUTES                09670099
096800                     PERFORM 4000-BUILD-INITIAL-PANEL             09680099
096900                 END-IF                                           09690099
097000             ELSE                                                 09700099
097100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09710099
097200                 MOVE PC-TSYMSG-00069                             09720099
097300                                   TO DP020-MSG-NUMBER            09730099
097400                 SET DP020-MSG-INFORMATIONAL                      09740099
097500                                   TO TRUE                        09750099
097600             END-IF                                               09760099
097700                                                                  09770099
097800                                                                  09780099
097900         WHEN OTHER                                               09790099
098000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09800099
098100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09810099
098200                                                                  09820099
098300             IF  PS-NO-ERROR                                      09830099
098400                 SET DP030-CONTINUE-GO                            09840099
098500                                 TO TRUE                          09850099
098600                 PERFORM 2100-CHECK-FUNCTION-KEY                  09860099
098700             ELSE                                                 09870099
098800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09880099
098900                 SET DP030-OVERRIDE-GO                            09890099
099000                                 TO TRUE                          09900099
099100             END-IF                                               09910099
099200     END-EVALUATE.                                                09920099
099300 EJECT                                                            09930099
099400*                                                                 09940099
099500*                                                                 09950099
099600*----------------------------------------------------------------*09960099
099700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09970099
099800*----------------------------------------------------------------*09980099
099900 2050-DELETE-LIST-QUEUE.                                          09990099
100000     EXEC CICS                                                    10000099
100100         DELETEQ TS                                               10010099
100200           QUEUE (ASC-LIST-QUEUE-NAME)                            10020099
100300            RESP (PV-CICS-RESP)                                   10030099
100400     END-EXEC.                                                    10040099
100500                                                                  10050099
100600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10060099
100700        (PV-CICS-RESP = DFHRESP(QIDERR))                          10070099
100800         CONTINUE                                                 10080099
100900     ELSE                                                         10090099
101000         SET DP013-CICS-ABEND      TO TRUE                        10100099
101100         SET DP013-NO-ROLLBACK     TO TRUE                        10110099
101200                                                                  10120099
101300         MOVE '2050-DELETE-LIST-QUEUE'                            10130099
101400                                   TO DP013-PARAGRAPH             10140099
101500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10150099
101600                                   TO DP013-MESSAGE-TEXT (1)      10160099
101700         PERFORM DP013-0000-PROCESS-ABEND                         10170099
101800     END-IF.                                                      10180099
101900                                                                  10190099
102000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10200099
102100 EJECT                                                            10210099
102200*                                                                 10220099
102300*                                                                 10230099
102400*----------------------------------------------------------------*10240099
102500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10250099
102600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10260099
102700* CICS ARCHITECTURE API.                                         *10270099
102800*----------------------------------------------------------------*10280099
102900 2100-CHECK-FUNCTION-KEY.                                         10290099
103000*******************************************                       10300099
103100* F13 - ADD CARTONS                                               10310099
103200*******************************************                       10320099
103300*                                                                 10330099
103400     EVALUATE TRUE                                                10340099
103500*                                                                 10350099
103600* F13 - SMOOTHING CARTON UPDATE (LOCAL-FUNC-01)                   10360099
103700*                                                                 10370099
103800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10380099
103900             IF  ASC-TOTAL-CART > ZERO                            10390099
104000                 INITIALIZE PC202-INTER-APPL-COMMAREA             10400099
104100                 MOVE +1        TO PC202-NUMBER-OF-SELECTED-ITEMS 10410099
104200                 SET PC202-UPDATE-TSQ TO TRUE                     10420099
104300                 MOVE ASC-OPER-UNT-ID                             10430099
104400                                TO PC202-OPER-UNT-ID              10440099
104500                 MOVE ASC-FCLTY-ID                                10450099
104600                                TO PC202-FCLTY-ID                 10460099
104700                 MOVE ASC-PO-NBR                                  10470099
104800                                TO PC202-PO-NBR                   10480099
104900                 MOVE ASC-RECEIVER                                10490099
105000                                TO PC202-REC-SEQ-NBR              10500099
105100                 MOVE ASC-STR-NUMBER                              10510099
105200                                TO PC202-DEST-OPER-UNT-ID         10520099
105300                 MOVE ASC-TOTAL-UNITS                             10530099
105400                                TO PC202-DEST-STORE-UNITS         10540099
105500                 MOVE ASC-TOTAL-CART                              10550099
105600                                TO PC202-PREV-CTN-COUNT           10560099
105700                 MOVE ASC-SML-PRINTER                             10570099
105800                                TO PC202-SML-PRINTER              10580099
105900                 MOVE PV-SHP-PRTR-ID-ADDR                         10590099
106000                                TO PC202-SHP-PRTR-IP-ADDR         10600099
106100                 PERFORM 5000-PREPARE-SEL-QUEUE                   10610099
106200                 SET ASC-FUNC01-RETURN-YES TO TRUE                10620099
106300             ELSE                                                 10630099
106400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10640099
106500                 SET DP030-OVERRIDE-GO                            10650099
106600                                   TO TRUE                        10660099
106700                 MOVE PC-TSYMSG-02688                             10670099
106800                                   TO DP020-MSG-NUMBER            10680099
106900                 SET DP020-MSG-WARNING                            10690099
107000                                   TO TRUE                        10700099
107100             END-IF                                               10710099
107200*                                                                 10720099
107300*                                                                 10730099
107400* F16 - INACTIVATE CARTONS -(LOCAL-FUNC-02)                       10740099
107500*                                                                 10750099
107600         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10760099
107700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10770099
107800                 SET PS-NO-ERROR  TO TRUE                         10780099
107900                 PERFORM 7000-CREATE-RANDOM-NBR                   10790099
108000                 PERFORM 4600-PROCESS-PRINT-FUNCTION              10800099
108100                     VARYING PV-ITEM  FROM 1 BY 1                 10810099
108200                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    10820099
108300                     OR PS-ERROR                                  10830099
108400                 IF PS-INACTV-CRTN-YES                            10840099
108500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10850099
108600                     SET DP030-OVERRIDE-GO                        10860099
108700                                       TO TRUE                    10870099
108800                     MOVE PC-TSYMSG-02688                         10880099
108900                                       TO DP020-MSG-NUMBER        10890099
109000                     SET DP020-MSG-WARNING                        10900099
109100                                       TO TRUE                    10910099
109200                 ELSE                                             10920099
109300                     COMPUTE PV-ADJUST-LABEL-COUNT =              10930099
109400                        (ASC-TOTAL-CART -                         10940099
109500                          PV-NBR-CRTNS-INACTIVATED)               10950099
109600                      PERFORM 4650-ISSUE-RESMOOTH-REQ             10960099
109700*                                                                 10970099
109800                      COMPUTE ASC-TOTAL-CART-PO =                 10980099
109900                          (ASC-TOTAL-CART-PO -                    10990099
110000                           PV-NBR-CRTNS-INACTIVATED)              11000099
110100                      MOVE PV-ADJUST-LABEL-COUNT                  11010099
110200                            TO ASC-TOTAL-CART                     11020099
110300*                                                                 11030099
110400                      PERFORM 2050-DELETE-LIST-QUEUE              11040099
110500                      MOVE ZEROES  TO ASC-TOTAL-UNITS             11050099
110600                      PERFORM 4000-BUILD-INITIAL-PANEL            11060099
110700*                                                                 11070099
110800                      PERFORM 9100-READ-SEL-QUEUE                 11080099
110900                      MOVE ASC-TOTAL-CART-PO TO                   11090099
111000                               PC203-TOT-CRTNS-PO(ASC-SEL-SUB)    11100099
111100                      MOVE ASC-TOTAL-CART                         11110099
111200                            TO PC203-PREV-CTN-COUNT (ASC-SEL-SUB) 11120099
111300                      PERFORM 9200-REWRITE-SEL-QUEUE              11130099
111400*                                                                 11140099
111500                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        11150099
111600                 END-IF                                           11160099
111700             ELSE                                                 11170099
111800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11180099
111900                 SET DP030-OVERRIDE-GO                            11190099
112000                                   TO TRUE                        11200099
112100                 MOVE PC-TSYMSG-00057                             11210099
112200                                   TO DP020-MSG-NUMBER            11220099
112300                 SET DP020-MSG-WARNING                            11230099
112400                                   TO TRUE                        11240099
112500             END-IF                                               11250099
112600*                                                                 11260099
112700* F23 - CARTON DETAIL LIST (LOCAL-FUNC-03)                        11270099
112800*                                                                 11280099
112900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11290099
113000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11300099
113100                 INITIALIZE SU009-INTER-APPL-COMMAREA             11310099
113200                 SET SU009-UPDATE-TSQ TO TRUE                     11320099
113300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11330099
113400                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11340099
113500                 MOVE ASC-OPER-UNT-ID                             11350099
113600                                TO SU009-OPER-UNT-ID              11360099
114300                 PERFORM 5000-PREPARE-SEL-QUEUE                   11430099
114400                 IF PS-INACTV-CRTN-YES                            11440099
114500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11450099
114600                     SET DP030-OVERRIDE-GO                        11460099
114700                                       TO TRUE                    11470099
114800                     MOVE PC-TSYMSG-00057                         11480099
114900                                       TO DP020-MSG-NUMBER        11490099
115000                     SET DP020-MSG-WARNING                        11500099
115100                                       TO TRUE                    11510099
115200                 END-IF                                           11520099
115300             ELSE                                                 11530099
115400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11540099
115500                 SET DP030-OVERRIDE-GO                            11550099
115600                                   TO TRUE                        11560099
115700                 MOVE PC-TSYMSG-00057                             11570099
115800                                   TO DP020-MSG-NUMBER            11580099
115900                 SET DP020-MSG-WARNING                            11590099
116000                                   TO TRUE                        11600099
116100             END-IF                                               11610099
116200             SET ASC-FUNC03-RETURN-YES TO TRUE                    11620099
116300*                                                                 11630099
116400* F24 - LABEL REPRINT  (LOCAL-FUNC-04)                            11640099
116500*                                                                 11650099
116600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              11660099
116700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11670099
116800                 INITIALIZE PC204-INTER-APPL-COMMAREA             11680099
116900                 MOVE ASC-SML-PRINTER                             11690099
117000                                TO PC204-SML-PRINTER              11700099
117100                 MOVE PV-SHP-PRTR-ID-ADDR                         11710099
117200                                TO PC204-SHP-PRTR-IP-ADDR         11720099
117300                 PERFORM 7000-CREATE-RANDOM-NBR                   11730099
117400                 MOVE  ASC-NUMBER-OF-SELECTED-ITEMS               11740099
117500                                TO PC204-TOT-LABELS-CNT           11750099
117600                 MOVE ZEROES TO PC204-TOT-LABELS-CNT              11760099
117700                 PERFORM 5000-PREPARE-SEL-QUEUE                   11770099
117800                 IF PS-INACTV-CRTN-YES                            11780099
117900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11790099
118000                     SET DP030-OVERRIDE-GO                        11800099
118100                                       TO TRUE                    11810099
118200                     MOVE PC-TSYMSG-02692                         11820099
118300                                       TO DP020-MSG-NUMBER        11830099
118400                     SET DP020-MSG-WARNING                        11840099
118500                                       TO TRUE                    11850099
118600                 ELSE                                             11860099
118700                     SET ASC-FUNC04-RETURN-YES TO TRUE            11870099
118800                     PERFORM 4650-ISSUE-RESMOOTH-REQ              11880099
118900                     IF PS-NO-ERROR                               11890099
119000                        PERFORM 6000-REFRESH-PANEL-FROM-TEMP      11900099
119010                        SET DP020-MSG-INFORMATIONAL  TO  TRUE     11901099
119020                        MOVE PC-TSYMSG-02234  TO DP020-MSG-NUMBER 11902099
119030                     END-IF                                       11903099
119031                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11903199
119032                 END-IF                                           11903299
119033             ELSE                                                 11903399
119034                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11903499
119035                 SET DP030-OVERRIDE-GO                            11903599
119036                                   TO TRUE                        11903699
119037                 MOVE PC-TSYMSG-00057                             11903799
119038                                   TO DP020-MSG-NUMBER            11903899
119039                 SET DP020-MSG-WARNING                            11903999
119040                                   TO TRUE                        11904099
119041             END-IF                                               11904199
119042*                                                                 11904299
119043* F6 - FIRST PAGE (AUTOMATICALLY GOES BACK TO PAGE 1)             11904399
119044*                                                                 11904499
119045         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11904599
119046             MOVE +1               TO PV-TOP-ITEM                 11904699
119047             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11904799
119048*                                                                 11904899
119049* F7 - PREVIOUS PAGE                                              11904999
119050*                                                                 11905099
119060         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11906099
119070             PERFORM 2110-BROWSE-BACKWARD                         11907099
119080             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11908099
119090*                                                                 11909099
119100* F8 - NEXT PAGE                                                  11910099
119200*                                                                 11920099
119300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11930099
119400             PERFORM 2120-BROWSE-FORWARD                          11940099
119500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11950099
119600*                                                                 11960099
119700* ENTER KEY                                                       11970099
119800*                                                                 11980099
119900         WHEN DP020-SRC-AID = DP016-ENTER                         11990099
120000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12000099
120100             IF  PS-ERROR                                         12010099
120200                 CONTINUE                                         12020099
120300             ELSE                                                 12030099
120400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12040099
120500             END-IF                                               12050099
120600                                                                  12060099
120700         WHEN OTHER                                               12070099
120800             SET DP013-NO-ROLLBACK                                12080099
120900                 DP013-XCTL-DISPLAY-RESTART                       12090099
121000                 DP013-CICS-ABEND  TO TRUE                        12100099
121100             MOVE '2100-CHECK-FUNCTION-KEY'                       12110099
121200                                   TO DP013-PARAGRAPH             12120099
121300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12130099
121400                                   TO DP013-MESSAGE-TEXT (1)      12140099
121500             PERFORM DP013-0000-PROCESS-ABEND                     12150099
121600     END-EVALUATE.                                                12160099
121700*                                                                 12170099
121800*                                                                 12180099
121900*----------------------------------------------------------------*12190099
122000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12200099
122100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12210099
122200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12220099
122300*    MESSAGE.                                                    *12230099
122400*----------------------------------------------------------------*12240099
122500 2110-BROWSE-BACKWARD.                                            12250099
122600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12260099
122700         GIVING PV-TOP-ITEM.                                      12270099
122800                                                                  12280099
122900     IF  ((PV-TOP-ITEM < +1)                                      12290099
123000       OR (PV-TOP-ITEM = +1))                                     12300099
123100         MOVE +1                   TO PV-TOP-ITEM                 12310099
123200*        -- TOP OF LIST --                                        12320099
123300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12330099
123400         SET DP020-MSG-INFORMATIONAL                              12340099
123500                                   TO TRUE                        12350099
123600     END-IF.                                                      12360099
123700 EJECT                                                            12370099
123800*                                                                 12380099
123900*                                                                 12390099
124000*----------------------------------------------------------------*12400099
124100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12410099
124200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12420099
124300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12430099
124400*----------------------------------------------------------------*12440099
124500 2120-BROWSE-FORWARD.                                             12450099
124600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12460099
124700         GIVING PV-TOP-ITEM.                                      12470099
124800                                                                  12480099
124900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12490099
125000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12500099
125100                                   TO PV-TOP-ITEM                 12510099
125200*        -- BOTTOM OF LIST --                                     12520099
125300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12530099
125400         SET DP020-MSG-INFORMATIONAL                              12540099
125500                                   TO TRUE                        12550099
125600     ELSE                                                         12560099
125700         COMPUTE PV-BOTTOM-ITEM =                                 12570099
125800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12580099
125900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12590099
126000*            -- BOTTOM OF LIST --                                 12600099
126100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12610099
126200             SET DP020-MSG-INFORMATIONAL                          12620099
126300                                   TO TRUE                        12630099
126400         END-IF                                                   12640099
126500     END-IF.                                                      12650099
126600 EJECT                                                            12660099
126700*                                                                 12670099
126800*                                                                 12680099
126900*----------------------------------------------------------------*12690099
127000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12700099
127100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12710099
127200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12720099
127300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12730099
127400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12740099
127500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12750099
127600*----------------------------------------------------------------*12760099
127700 2130-CHECK-FOR-JUMP-BROWSE.                                      12770099
127800     SET PS-NO-ERROR               TO TRUE.                       12780099
127900     IF (ASC-START-ITEM-REQUEST = SPACES)                         12790099
128000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12800099
128100                                   TO PV-TOP-ITEM                 12810099
128200     ELSE                                                         12820099
128300         MOVE ASC-START-ITEM-REQUEST                              12830099
128400                                   TO DP010I-UNEDITED-FIELD       12840099
128500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12850099
128600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12860099
128700         SET DP010I-NEGATIVE-NOT-ALLOWED                          12870099
128800                                   TO TRUE                        12880099
128910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12891099
128920                         USING DP010I-NUMERIC-EDIT-AREA           12892099
129000                                                                  12900099
129100         IF  NOT DP010I-ERROR-DETECTED                            12910099
129200             MOVE DP010I-NUMERIC-FIELD                            12920099
129300                                   TO ASC-START-ITEM-REQUEST-N    12930099
129400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12940099
129500                 IF  ASC-START-ITEM-REQUEST-N >                   12950099
129600                                          ASC-NUMBER-OF-ITEMS-READ12960099
129700                     MOVE SPACES TO ASC-START-ITEM-REQUEST        12970099
129800                     COMPUTE PV-TOP-ITEM =                        12980099
129900                             ASC-NUMBER-OF-ITEMS-READ             12990099
130000                             - PC-ITEMS-PER-PANEL + 1             13000099
130100                     IF  PV-TOP-ITEM < +1                         13010099
130200                         MOVE +1   TO PV-TOP-ITEM                 13020099
130300                         MOVE PC-TSYMSG-00070                     13030099
130400                                   TO DP020-MSG-NUMBER            13040099
130500                         SET DP020-MSG-INFORMATIONAL              13050099
130600                                   TO TRUE                        13060099
130700                     END-IF                                       13070099
130800                 ELSE                                             13080099
130900                     MOVE ASC-START-ITEM-REQUEST-N                13090099
131000                                   TO PV-TOP-ITEM                 13100099
131100                     MOVE SPACES   TO ASC-START-ITEM-REQUEST      13110099
131200                     COMPUTE PV-BOTTOM-ITEM =                     13120099
131300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13130099
131400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13140099
131500*                        -- BOTTOM OF LIST --                     13150099
131600                         MOVE PC-TSYMSG-00070                     13160099
131700                                   TO DP020-MSG-NUMBER            13170099
131800                         SET DP020-MSG-INFORMATIONAL              13180099
131900                                   TO TRUE                        13190099
132000                     END-IF                                       13200099
132100                 END-IF                                           13210099
132200             ELSE                                                 13220099
132300*                --- VALUE OUT OF RANGE ----                      13230099
132400                 MOVE PC-TSYMSG-00101                             13240099
132500                                   TO DP020-MSG-NUMBER            13250099
132600                 MOVE -1           TO ASTRTITL                    13260099
132700                 SET DP030-SET-CURSOR-APPL-1                      13270099
132800                                   TO TRUE                        13280099
132900                 MOVE DP015-REVERSE                               13290099
133000                                   TO ASTRTITH                    13300099
133100                 MOVE DP015-RED    TO ASTRTITC                    13310099
133200                 MOVE DP015-UNP-NUM-BRT-MDT                       13320099
133300                                   TO ASTRTITA                    13330099
133400                 SET DP020-MSG-FATAL                              13340099
133500                                   TO TRUE                        13350099
133600                 SET PS-ERROR      TO TRUE                        13360099
133700             END-IF                                               13370099
133800                                                                  13380099
133900         ELSE                                                     13390099
134000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13400099
134100             MOVE -1               TO ASTRTITL                    13410099
134200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13420099
134300             MOVE DP015-REVERSE    TO ASTRTITH                    13430099
134400             MOVE DP015-RED        TO ASTRTITC                    13440099
134500             MOVE DP015-UNP-NUM-BRT-MDT                           13450099
134600                                   TO ASTRTITA                    13460099
134700             SET DP020-MSG-FATAL   TO TRUE                        13470099
134800             SET PS-ERROR          TO TRUE                        13480099
134900         END-IF                                                   13490099
135000     END-IF.                                                      13500099
135100 EJECT                                                            13510099
135200*                                                                 13520099
135300*                                                                 13530099
135400*----------------------------------------------------------------*13540099
135500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13550099
135600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13560099
135700*    (F9)                                                        *13570099
135800*----------------------------------------------------------------*13580099
135900 2140-DESELECT-ALL-ITEMS.                                         13590099
136000     MOVE +1                       TO ASC-BLK-SUB.                13600099
136100                                                                  13610099
136200     PERFORM 2141-CLEAR-SELECTED-INDS                             13620099
136300         VARYING ASC-ITEM-SUB                                     13630099
136400         FROM 1 BY 1                                              13640099
136500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13650099
136600                                                                  13660099
136700     ADD +1                        TO ASC-BLK-SUB.                13670099
136800                                                                  13680099
136900     PERFORM 2141-CLEAR-SELECTED-INDS                             13690099
137000         VARYING ASC-ITEM-SUB                                     13700099
137100         FROM 1 BY 1                                              13710099
137200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13720099
137300                                                                  13730099
137400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13740099
137500                                   TO PV-LIST-ITEM-NUMBER.        13750099
137600                                                                  13760099
137700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13770099
137800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13780099
137900                                                                  13790099
138000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13800099
138100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13810099
138200         MOVE +1                   TO ASC-BLK-SUB                 13820099
138300                                                                  13830099
138400         PERFORM 5100-WRITE-TEMP-STORAGE                          13840099
138500                                                                  13850099
138600         MOVE +1                   TO PV-BLOCK-NUMBER             13860099
138700                                                                  13870099
138800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13880099
138900             PV-FIRST-BLOCK-IN-ARRAY - 1                          13890099
139000                                                                  13900099
139100         PERFORM                                                  13910099
139200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13920099
139300                                                                  13930099
139400             PERFORM 4410-READ-TEMP-STORAGE                       13940099
139500                                                                  13950099
139600             PERFORM 2141-CLEAR-SELECTED-INDS                     13960099
139700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13970099
139800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13980099
139900                                                                  13990099
140000             PERFORM 5100-WRITE-TEMP-STORAGE                      14000099
140100                                                                  14010099
140200             ADD +1                TO PV-BLOCK-NUMBER             14020099
140300                                                                  14030099
140400         END-PERFORM                                              14040099
140500                                                                  14050099
140600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14060099
140700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14070099
140800                                                                  14080099
140900         PERFORM                                                  14090099
141000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14100099
141100                   ASC-HIGHEST-BLOCK-WRITTEN                      14110099
141200                                                                  14120099
141300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14130099
141400                                   TO PV-BLOCK-NUMBER             14140099
141500                                                                  14150099
141600             PERFORM 4410-READ-TEMP-STORAGE                       14160099
141700                                                                  14170099
141800             PERFORM 2141-CLEAR-SELECTED-INDS                     14180099
141900                 VARYING ASC-ITEM-SUB                             14190099
142000                 FROM 1 BY 1                                      14200099
142100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14210099
142200                                                                  14220099
142300             PERFORM 5100-WRITE-TEMP-STORAGE                      14230099
142400                                                                  14240099
142500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14250099
142600                                                                  14260099
142700         END-PERFORM                                              14270099
142800                                                                  14280099
142900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14290099
143000                                   TO PV-BLOCK-NUMBER             14300099
143100                                                                  14310099
143200         PERFORM 4410-READ-TEMP-STORAGE                           14320099
143300     END-IF.                                                      14330099
143400                                                                  14340099
143500                                                                  14350099
143600     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.14360099
143700     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 14370099
143800     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   14380099
143900                                                                  14390099
144000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14400099
144100                                                                  14410099
144200 EJECT                                                            14420099
144300*                                                                 14430099
144400*                                                                 14440099
144500*----------------------------------------------------------------*14450099
144600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *14460099
144700*----------------------------------------------------------------*14470099
144800 2141-CLEAR-SELECTED-INDS.                                        14480099
144900     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          14490099
145000             NOT EQUAL ZERO                                       14500099
145100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14510099
145200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14520099
145300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    14530099
145400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14540099
145500                                   TO TRUE                        14550099
145600         END-IF                                                   14560099
145700     END-IF.                                                      14570099
145800                                                                  14580099
145900 EJECT                                                            14590099
146000*                                                                 14600099
146100*                                                                 14610099
146200*----------------------------------------------------------------*14620099
146300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14630099
146400*  FOR ALL ITEMS (F21).                                          *14640099
146500*----------------------------------------------------------------*14650099
146600 2150-SELECT-ALL-ITEMS.                                           14660099
146700     MOVE +1                       TO ASC-BLK-SUB.                14670099
146800                                                                  14680099
146900     PERFORM 2151-SET-SELECTED-INDS                               14690099
147000         VARYING ASC-ITEM-SUB                                     14700099
147100         FROM 1 BY 1                                              14710099
147200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14720099
147300                                                                  14730099
147400     ADD +1                        TO ASC-BLK-SUB.                14740099
147500                                                                  14750099
147600     PERFORM 2151-SET-SELECTED-INDS                               14760099
147700         VARYING ASC-ITEM-SUB                                     14770099
147800         FROM 1 BY 1                                              14780099
147900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14790099
148000                                                                  14800099
148100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14810099
148200                                   TO PV-LIST-ITEM-NUMBER.        14820099
148300                                                                  14830099
148400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14840099
148500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14850099
148600     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            14860099
148700         MOVE +1                   TO ASC-BLK-SUB                 14870099
148800                                                                  14880099
148900         PERFORM 5100-WRITE-TEMP-STORAGE                          14890099
149000         MOVE +2                   TO ASC-BLK-SUB                 14900099
149100         PERFORM 5100-WRITE-TEMP-STORAGE                          14910099
149200         MOVE +1                   TO ASC-BLK-SUB                 14920099
149300         MOVE +1                   TO PV-BLOCK-NUMBER             14930099
149400     END-IF.                                                      14940099
149500                                                                  14950099
149600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14960099
149700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14970099
149800         MOVE +1                   TO ASC-BLK-SUB                 14980099
149900                                                                  14990099
150000         PERFORM 5100-WRITE-TEMP-STORAGE                          15000099
150100                                                                  15010099
150200         MOVE +1                   TO PV-BLOCK-NUMBER             15020099
150300                                                                  15030099
150400                                                                  15040099
150500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15050099
150600        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15060099
150700         MOVE +1                   TO ASC-BLK-SUB                 15070099
150800                                                                  15080099
150900         PERFORM 5100-WRITE-TEMP-STORAGE                          15090099
151000                                                                  15100099
151100         MOVE +1                   TO PV-BLOCK-NUMBER             15110099
151200                                                                  15120099
151300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15130099
151400             PV-FIRST-BLOCK-IN-ARRAY - 1                          15140099
151500                                                                  15150099
151600         PERFORM                                                  15160099
151700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15170099
151800                                                                  15180099
151900             PERFORM 4410-READ-TEMP-STORAGE                       15190099
152000                                                                  15200099
152100             PERFORM 2151-SET-SELECTED-INDS                       15210099
152200                 VARYING ASC-ITEM-SUB                             15220099
152300                 FROM 1 BY 1                                      15230099
152400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15240099
152500                                                                  15250099
152600             PERFORM 5100-WRITE-TEMP-STORAGE                      15260099
152700                                                                  15270099
152800             ADD +1                TO PV-BLOCK-NUMBER             15280099
152900                                                                  15290099
153000         END-PERFORM                                              15300099
153100                                                                  15310099
153200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15320099
153300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15330099
153400                                                                  15340099
153500         PERFORM                                                  15350099
153600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15360099
153700                   ASC-HIGHEST-BLOCK-WRITTEN                      15370099
153800                                                                  15380099
153900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15390099
154000                                   TO PV-BLOCK-NUMBER             15400099
154100                                                                  15410099
154200             PERFORM 4410-READ-TEMP-STORAGE                       15420099
154300                                                                  15430099
154400             PERFORM 2151-SET-SELECTED-INDS                       15440099
154500                 VARYING ASC-ITEM-SUB                             15450099
154600                 FROM 1 BY 1                                      15460099
154700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15470099
154800                                                                  15480099
154900             PERFORM 5100-WRITE-TEMP-STORAGE                      15490099
155000                                                                  15500099
155100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15510099
155200                                                                  15520099
155300         END-PERFORM                                              15530099
155400                                                                  15540099
155500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15550099
155600                                   TO PV-BLOCK-NUMBER             15560099
155700                                                                  15570099
155800         PERFORM 4410-READ-TEMP-STORAGE                           15580099
155900     END-IF.                                                      15590099
156000                                                                  15600099
156100                                                                  15610099
156200     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             15620099
156300                       ASC-NUMBER-OF-SELECTED-ITEMS.              15630099
156400                                                                  15640099
156500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15650099
156600                                                                  15660099
156700 EJECT                                                            15670099
156800*                                                                 15680099
156900*                                                                 15690099
157000*----------------------------------------------------------------*15700099
157100*    MARK EACH ITEM AS BEING SELECTED.                           *15710099
157200*----------------------------------------------------------------*15720099
157300 2151-SET-SELECTED-INDS.                                          15730099
157400                                                                  15740099
157500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15750099
157600             NOT EQUAL ZERO                                       15760099
157700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15770099
157800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15780099
157900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        15790099
158000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15800099
158100                                   TO TRUE                        15810099
158200         END-IF                                                   15820099
158300     END-IF.                                                      15830099
158400                                                                  15840099
158500 EJECT                                                            15850099
158600*                                                                 15860099
158700*                                                                 15870099
158800*----------------------------------------------------------------*15880099
158900*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *15890099
159000*  SCREEN INTO THE COMMAREA.  ALL EDITING IS DONE IN THE COMM.   *15900099
159100*----------------------------------------------------------------*15910099
159200 2200-MOVE-SCREEN-TO-COMMAREA.                                    15920099
159300     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15930099
159400     MOVE +1                       TO PV-SUB.                     15940099
159500                                                                  15950099
159600     PERFORM 3100-SET-SUBSCRIPTS.                                 15960099
159700                                                                  15970099
159800     IF  ASTRTITL > ZERO                                          15980099
159900         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      15990099
160000     ELSE                                                         16000099
160100         IF  ASTRTITF = DP015-ERASE-EOF                           16010099
160200             INITIALIZE ASC-START-ITEM-REQUEST                    16020099
160300         END-IF                                                   16030099
160400     END-IF.                                                      16040099
160500                                                                  16050099
160510     IF  APRTRL > ZERO                                            16051099
160520         MOVE APRTRI           TO ASC-SML-PRINTER                 16052099
160530     ELSE                                                         16053099
160540         IF  APRTRF   = DP015-ERASE-EOF                           16054099
160550             MOVE ZERO         TO ASC-SML-PRINTER                 16055099
160560         END-IF                                                   16056099
160570     END-IF.                                                      16057099
160580                                                                  16058099
160590     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16059099
160600         VARYING PV-SUB                                           16060099
160700         FROM 1 BY 1                                              16070099
160800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16080099
160900*                                                                 16090099
161000*                                                                 16100099
161100*----------------------------------------------------------------*16110099
161200*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *16120099
161300*----------------------------------------------------------------*16130099
161400 2210-MOVE-LINES-TO-COMMAREA.                                     16140099
161500     IF  MR-SELECTL (PV-SUB) > ZERO                               16150099
161600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16160099
161700         MOVE MR-SELECTI (PV-SUB)                                 16170099
161800                                   TO ASC-TEMP-SELECTED-SW        16180099
161900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16190099
162000     ELSE                                                         16200099
162100         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                16210099
162200                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16220099
162300                 MOVE SPACES       TO ASC-TEMP-SELECTED-SW        16230099
162400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16240099
162500         END-IF                                                   16250099
162600     END-IF.                                                      16260099
162700                                                                  16270099
162800     PERFORM 2215-MOVE-FIELDS-TO-COMMAREA.                        16280099
162900                                                                  16290099
163000     ADD +1                        TO ASC-ITEM-SUB.               16300099
163100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16310099
163200         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16320099
163300             COMPUTE PV-BLOCK-NUMBER  =                           16330099
163400                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         16340099
163500                    PC-ITEMS-PER-PANEL                            16350099
163600             PERFORM 5105-REWRITE-ASC-LISTQ                       16360099
163601         END-IF                                                   16360199
163602         ADD +1                    TO ASC-BLK-SUB                 16360299
163603         MOVE +1                   TO ASC-ITEM-SUB                16360399
163604     ELSE                                                         16360499
163605     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             16360599
163606         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16360699
163607             COMPUTE PV-BLOCK-NUMBER  =                           16360799
163608                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         16360899
163609                    PC-ITEMS-PER-PANEL                            16360999
163610             PERFORM 5105-REWRITE-ASC-LISTQ                       16361099
163611         END-IF                                                   16361199
163612     END-IF.                                                      16361299
163613*                                                                 16361399
163614 2215-MOVE-FIELDS-TO-COMMAREA.                                    16361499
163615*                                                                 16361599
163616     IF  ASC-SML-PRINTER > SPACES                                 16361699
163617             INITIALIZE  PV-SHP-PRTR-CLUSTER-NBR                  16361799
163618                         PV-SHP-PRTR-ID-ADDR                      16361899
163619                         PV-SHP-PRTR-OS-RLSE-CDE                  16361999
163620                         PV-SHP-DATA-XFER-MODE-ID                 16362099
163630             MOVE ASC-SML-PRINTER   TO                            16363099
163640                                      APRTRO                      16364099
163650                                      DP072-PRINTER-ID            16365099
163660             MOVE PC-REPORT-PGM-1     TO DP072-RPT-PGM-NME        16366099
163661             PERFORM 3010-VALIDATE-PRINTER                        16366199
163662             IF  PS-NO-ERROR                                      16366299
163663               PERFORM 3020-VALIDATE-PRINTER-ID-SML               16366399
163664               MOVE  DP072-PRTR-CLUSTER-NBR                       16366499
163665                                TO PV-SHP-PRTR-CLUSTER-NBR        16366599
163666               MOVE  DP072-PRTR-IP-ADDRESS                        16366699
163667                                TO PV-SHP-PRTR-ID-ADDR            16366799
163668               MOVE  DP072-PRTR-CLUSTER-OS-RLSE-CDE               16366899
163669                                TO PV-SHP-PRTR-OS-RLSE-CDE        16366999
163670               MOVE  DP072-PRTR-DATA-XFER-MODE-ID                 16367099
163671                                TO PV-SHP-DATA-XFER-MODE-ID       16367199
163672               MOVE  DP072-XMIT-INTFC-CDE                         16367299
163673                                TO PV-SHP-XMIT-INTFC-CDE          16367399
163674               MOVE  DP072-PRTR-TYP-CDE                           16367499
163675                                TO PV-SHP-PRTR-TYP-CDE            16367599
163676             END-IF                                               16367699
163677     END-IF.                                                      16367799
163678*                                                                 16367899
163679*----------------------------------------------------------------*16367999
163680*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *16368099
163690*  COMMAREA (EDITING IS NOT DONE AGAINST THE SCREEN DIRECTLY).   *16369099
163700*----------------------------------------------------------------*16370099
163800 3000-EDIT-DATA-IN-COMMAREA.                                      16380099
163900     SET PS-NO-ERROR               TO TRUE.                       16390099
164000     PERFORM 3200-RESET-ATTRIBUTES.                               16400099
164100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16410099
164200                                                                  16420099
164300**                                                                16430099
164400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16440099
164500* EDITING IS DONE FROM THE BOTTOM UP.                             16450099
164600**                                                                16460099
164700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16470099
164800         ASC-ITEMS-DISPLAYED - 1.                                 16480099
164900     PERFORM 3100-SET-SUBSCRIPTS.                                 16490099
165000                                                                  16500099
165100     IF  PS-NO-ERROR                                              16510099
165200         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        16520099
165300     END-IF.                                                      16530099
165400                                                                  16540099
165500     IF  PS-NO-ERROR                                              16550099
165600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16560099
165700     END-IF.                                                      16570099
165800*                                                                 16580099
165900     IF  ((PS-NO-ERROR)                                           16590099
166000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16600099
166100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16610099
166200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  16620099
166300     END-IF.                                                      16630099
166400*                                                                 16640099
166500*                                                                 16650099
166600*----------------------------------------------------------------*16660099
166700*   3005-EDIT-COMMAREA-BLOCKS                                    *16670099
166800*----------------------------------------------------------------*16680099
166900 3005-EDIT-COMMAREA-BLOCKS.                                       16690099
167000     MOVE +1                       TO PV-BLOCK-NUMBER.            16700099
167100     MOVE +1                       TO ASC-BLK-SUB.                16710099
167200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               16720099
167300                                                                  16730099
167400     COMPUTE PV-BLOCK-NUMBER  =                                   16740099
167500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 16750099
167600            PC-ITEMS-PER-PANEL.                                   16760099
167700                                                                  16770099
167800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          16780099
167900                                                                  16790099
168000     PERFORM                                                      16800099
168100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          16810099
168200          OR PS-ERROR                                             16820099
168300          OR PS-BLOCK-ERROR                                       16830099
168400                                                                  16840099
168500             COMPUTE PV-ITEMS-HOLD  =                             16850099
168600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        16860099
168700                     PC-ITEMS-PER-PANEL - 1                       16870099
168800                                                                  16880099
168900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       16890099
169000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               16900099
169100                     FROM  PV-ITEMS-HOLD                          16910099
169200                   GIVING  PV-ITEMS-DIFF                          16920099
169300                 SUBTRACT  PV-ITEMS-DIFF                          16930099
169400                     FROM  PC-ITEMS-PER-PANEL                     16940099
169500                   GIVING  PV-ITEMS-HOLD                          16950099
169600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              16960099
169700                                              ASC-ITEM-SUB        16970099
169800                                              ASC-ITEMS-DISPLAYED 16980099
169900             ELSE                                                 16990099
170000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              17000099
170100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        17010099
170200             END-IF                                               17020099
170300                                                                  17030099
170400             PERFORM 3300-EDIT-SELECTIONS                         17040099
170500                     VARYING PV-SUB                               17050099
170600                        FROM PV-SUB BY -1                         17060099
170700                       UNTIL PV-SUB < +1                          17070099
170800                                                                  17080099
170900             MOVE +1               TO ASC-BLK-SUB                 17090099
171000                                                                  17100099
171100             PERFORM 5105-REWRITE-ASC-LISTQ                       17110099
171200                                                                  17120099
171300             MOVE +1                TO ASC-BLK-SUB                17130099
171400                                                                  17140099
171500             IF  PS-BLOCK-ERROR                                   17150099
171600                 SET  PS-ERROR     TO TRUE                        17160099
171700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        17170099
171800                                   TO PV-TOP-ITEM                 17180099
171900             ELSE                                                 17190099
172000                 ADD  +1           TO PV-BLOCK-NUMBER             17200099
172100                 IF  PV-BLOCK-NUMBER >                            17210099
172200                     ASC-HIGHEST-BLOCK-WRITTEN                    17220099
172300                     MOVE +2       TO ASC-BLK-SUB                 17230099
172400                     PERFORM 4410-READ-TEMP-STORAGE               17240099
172500                     MOVE +1       TO ASC-BLK-SUB                 17250099
172600                 ELSE                                             17260099
172700                     PERFORM 4410-READ-TEMP-STORAGE               17270099
172800                     ADD  +1        TO PV-BLOCK-NUMBER            17280099
172900                     MOVE +2        TO ASC-BLK-SUB                17290099
173000                     PERFORM 4410-READ-TEMP-STORAGE               17300099
173100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            17310099
173200                     MOVE +1        TO ASC-BLK-SUB                17320099
173300                 END-IF                                           17330099
173400             END-IF                                               17340099
173500     END-PERFORM.                                                 17350099
173600                                                                  17360099
173700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            17370099
173800         PS-ERROR                   OR                            17380099
173900         PS-BLOCK-ERROR                                           17390099
174000         CONTINUE                                                 17400099
174100     ELSE                                                         17410099
174200         MOVE +1                 TO PV-BLOCK-NUMBER               17420099
174300         MOVE +1                 TO ASC-BLK-SUB                   17430099
174400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  17440099
174500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           17450099
174600         PERFORM 4410-READ-TEMP-STORAGE                           17460099
174700                                                                  17470099
174800         PERFORM                                                  17480099
174900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              17490099
175000              OR PS-ERROR                                         17500099
175100              OR PS-BLOCK-ERROR                                   17510099
175200                                                                  17520099
175300                 COMPUTE PV-ITEMS-HOLD  =                         17530099
175400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    17540099
175500                         PC-ITEMS-PER-PANEL - 1                   17550099
175600                                                                  17560099
175700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     17570099
175800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           17580099
175900                         FROM  PV-ITEMS-HOLD                      17590099
176000                       GIVING  PV-ITEMS-DIFF                      17600099
176100                     SUBTRACT  PV-ITEMS-DIFF                      17610099
176200                         FROM  PC-ITEMS-PER-PANEL                 17620099
176300                       GIVING  PV-ITEMS-HOLD                      17630099
176400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            17640099
176500                                                ASC-ITEM-SUB      17650099
176600                                               ASC-ITEMS-DISPLAYED17660099
176700                 ELSE                                             17670099
176800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          17680099
176900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    17690099
177000                 END-IF                                           17700099
177100                                                                  17710099
177200                 PERFORM 3300-EDIT-SELECTIONS                     17720099
177300                         VARYING PV-SUB                           17730099
177400                            FROM PV-SUB BY -1                     17740099
177500                           UNTIL PV-SUB < +1                      17750099
177600                                                                  17760099
177700                 MOVE +1               TO ASC-BLK-SUB             17770099
177800                                                                  17780099
177900                 PERFORM 5105-REWRITE-ASC-LISTQ                   17790099
178000                                                                  17800099
178100                 MOVE +1                TO ASC-BLK-SUB            17810099
178200                                                                  17820099
178300                 IF  PS-BLOCK-ERROR                               17830099
178400                     SET  PS-ERROR     TO TRUE                    17840099
178500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    17850099
178600                                       TO PV-TOP-ITEM             17860099
178700                 ELSE                                             17870099
178800                     ADD  +1            TO PV-BLOCK-NUMBER        17880099
178900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      17890099
179000                         MOVE +2        TO ASC-BLK-SUB            17900099
179100                         PERFORM 4410-READ-TEMP-STORAGE           17910099
179200                         MOVE +1        TO ASC-BLK-SUB            17920099
179300                     ELSE                                         17930099
179400                         PERFORM 4410-READ-TEMP-STORAGE           17940099
179500                         ADD  +1        TO PV-BLOCK-NUMBER        17950099
179600                         MOVE +2        TO ASC-BLK-SUB            17960099
179700                         PERFORM 4410-READ-TEMP-STORAGE           17970099
179800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        17980099
179900                         MOVE +1        TO ASC-BLK-SUB            17990099
180000                     END-IF                                       18000099
180100                 END-IF                                           18010099
180200     END-PERFORM.                                                 18020099
180300*                                                                 18030099
180400*----------------------------------------------------------------*18040099
180500*   3010-VALIDATE-PRINTER                                         18050099
180600* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                       18060099
180610*----------------------------------------------------------------*18061099
180620 3010-VALIDATE-PRINTER.                                           18062099
180630                                                                  18063099
180640     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     18064099
180650     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 18065099
180660     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        18066099
180670     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     18067099
180680                                        DP072-FCLTY-ID.           18068099
180690     SET DP072-VALIDATE              TO TRUE.                     18069099
180691                                                                  18069199
180692     EXEC CICS                                                    18069299
180693          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  18069399
180694               COMMAREA (DP072-COMM-AREA)                         18069499
180695               RESP     (PV-CICS-RESP)                            18069599
180696     END-EXEC                                                     18069699
180697                                                                  18069799
180698     EVALUATE TRUE                                                18069899
180699         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     18069999
180700              CONTINUE                                            18070099
180701         WHEN OTHER                                               18070199
180702             SET PS-ERROR                                         18070299
180703                 DP020-MSG-FATAL       TO TRUE                    18070399
180704             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        18070499
180705             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              18070599
180706                 MOVE DP015-UNP-ALP-BRT-OFF                       18070699
180707                                       TO APRTRA                  18070799
180708                 MOVE DP015-RED        TO APRTRC                  18070899
180709                 MOVE DP015-REVERSE    TO APRTRH                  18070999
180710                 MOVE -1               TO APRTRL                  18071099
180711             ELSE                                                 18071199
180712                 MOVE DP015-UNP-ALP-BRT-OFF                       18071299
180713                                       TO APRTRA                  18071399
180714                 MOVE DP015-RED        TO APRTRC                  18071499
180715                 MOVE DP015-REVERSE    TO APRTRH                  18071599
180716                 MOVE -1               TO APRTRL                  18071699
180717             END-IF                                               18071799
180718             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18071899
180719     END-EVALUATE.                                                18071999
180720                                                                  18072099
180721                                                                  18072199
180722*----------------------------------------------------------------*18072299
180723*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *18072399
180724*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *18072499
180725*  CAN BE PRINTED ON THIS PRINTER.                                18072599
180726*----------------------------------------------------------------*18072699
180727 3020-VALIDATE-PRINTER-ID-SML.                                    18072799
180728                                                                  18072899
180729     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  = PC-MGMX                18072999
180730         SET  PS-PRINTER-ERROR                                    18073099
180731              PS-ERROR                                            18073199
180732              DP020-MSG-FATAL         TO TRUE                     18073299
180733         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         18073399
180734         MOVE DP015-UNP-ALP-BRT-MDT   TO APRTRA                   18073499
180735         MOVE DP015-RED               TO APRTRC                   18073599
180736         MOVE DP015-REVERSE           TO APRTRH                   18073699
180737         MOVE -1                      TO APRTRL                   18073799
180738         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     18073899
180739     ELSE                                                         18073999
180740         MOVE DP015-UNP-ALP-NOR-OFF    TO APRTRA                  18074099
180741         MOVE DP015-GREEN              TO APRTRC                  18074199
180742         MOVE DP015-UNDERLINE          TO APRTRH                  18074299
180743     END-IF.                                                      18074399
180744                                                                  18074499
180745     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   18074599
180746         MOVE DP015-UNP-ALP-NOR-OFF    TO APRTRA                  18074699
180747         MOVE DP015-GREEN              TO APRTRC                  18074799
180748         MOVE DP015-UNDERLINE          TO APRTRH                  18074899
180749     ELSE                                                         18074999
180750         SET  PS-PRINTER-ERROR                                    18075099
180751              PS-ERROR                                            18075199
180752              DP020-MSG-FATAL         TO TRUE                     18075299
180753         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         18075399
180754         MOVE DP015-UNP-ALP-BRT-MDT   TO APRTRA                   18075499
180755         MOVE DP015-RED               TO APRTRC                   18075599
180756         MOVE DP015-REVERSE           TO APRTRH                   18075699
180757         MOVE -1                      TO APRTRL                   18075799
180758         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     18075899
180759     END-IF.                                                      18075999
180760                                                                  18076099
180770*                                                                 18077099
180780*----------------------------------------------------------------*18078099
180790*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18079099
180800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18080099
180900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18090099
181000*                                                                *18100099
181100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18110099
181200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18120099
181300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18130099
181400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18140099
181500*----------------------------------------------------------------*18150099
181600 3100-SET-SUBSCRIPTS.                                             18160099
181700     COMPUTE ASC-ITEM-SUB =                                       18170099
181800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18180099
181900                                                                  18190099
182000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18200099
182100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18210099
182200                                                                  18220099
182300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18230099
182400     ELSE                                                         18240099
182500         MOVE +1                     TO ASC-BLK-SUB               18250099
182600     END-IF.                                                      18260099
182700*                                                                 18270099
182800*                                                                 18280099
182900*----------------------------------------------------------------*18290099
183000*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *18300099
183100*----------------------------------------------------------------*18310099
183200 3200-RESET-ATTRIBUTES.                                           18320099
183300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18330099
183400     MOVE DP015-GREEN              TO ASTRTITC.                   18340099
183500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18350099
183600                                                                  18360099
183700     PERFORM                                                      18370099
183800         VARYING PV-SUB                                           18380099
183900         FROM 1 BY 1                                              18390099
184000         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18400099
184100         MOVE DP015-UNP-ALP-NOR-OFF                               18410099
184200                                   TO MR-SELECTA (PV-SUB)         18420099
184300         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         18430099
184400         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         18440099
184500     END-PERFORM.                                                 18450099
184600*                                                                 18460099
184700*                                                                 18470099
184800*----------------------------------------------------------------*18480099
184900*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *18490099
185000*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *18500099
185100*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *18510099
185200*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *18520099
185300*----------------------------------------------------------------*18530099
185400 3300-EDIT-SELECTIONS.                                            18540099
185500     EVALUATE TRUE                                                18550099
185600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18560099
185700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18570099
185800                 CONTINUE                                         18580099
185900                                                                  18590099
186000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18600099
186100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18610099
186200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS18620099
186300                 MOVE ASC-TEMP-SELECTED-SW                        18630099
186400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18640099
186500                                   TO ASC-SELECTED-SW             18650099
186600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18660099
186700             END-IF                                               18670099
186800                                                                  18680099
186900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18690099
187000                 = SPACES                                         18700099
187100                                                                  18710099
187200             EVALUATE TRUE                                        18720099
187300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18730099
187400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18740099
187500                     MOVE SPACES   TO ASC-SELECTED-SW             18750099
187600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18760099
187700                                                                  18770099
187800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18780099
187900                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 18790099
188000                     MOVE SPACES   TO ASC-SELECTED-SW             18800099
188100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18810099
188200                                                                  18820099
188300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18830099
188400                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   18840099
188500                     MOVE SPACES   TO ASC-SELECTED-SW             18850099
188600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18860099
188700             END-EVALUATE                                         18870099
188800                                                                  18880099
188900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18890099
189000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18900099
189100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18910099
189200             END-IF                                               18920099
189300             PERFORM 3310-EDIT-RANGE                              18930099
189400                                                                  18940099
189500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18950099
189600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18960099
189700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18970099
189800             END-IF                                               18980099
189900             PERFORM 3310-EDIT-RANGE                              18990099
190000                                                                  19000099
190100         WHEN OTHER                                               19010099
190200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            19020099
190300             SET DP020-MSG-FATAL   TO TRUE                        19030099
190400             MOVE -1               TO MR-SELECTL (PV-SUB)         19040099
190500             SET DP030-SET-CURSOR-APPL-1                          19050099
190600                                   TO TRUE                        19060099
190700             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         19070099
190800             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         19080099
190900             SET PS-ERROR          TO TRUE                        19090099
191000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19100099
191100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19110099
191200                 MOVE SPACES       TO ASC-SELECTED-SW             19120099
191300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19130099
191400             END-IF                                               19140099
191500     END-EVALUATE.                                                19150099
191600                                                                  19160099
191700     EVALUATE TRUE                                                19170099
191800        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               19180099
191900        WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)               19190099
192000            IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             19200099
192010               IF ASC-INACTVE-CRT-FND (ASC-BLK-SUB ASC-ITEM-SUB)  19201099
192020                     OR                                           19202099
192030                  ASC-VERIFD-LNE-YES  (ASC-BLK-SUB ASC-ITEM-SUB)  19203099
192040                    SET  PS-ERROR                                 19204099
192050                         DP020-MSG-FATAL TO TRUE                  19205099
192060                    MOVE PC-TSYMSG-02692 TO DP020-MSG-NUMBER      19206099
192070                    MOVE -1              TO MR-SELECTL (PV-SUB)   19207099
192080                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           19208099
192090                    SET PS-BLOCK-ERROR   TO TRUE                  19209099
192091               END-IF                                             19209199
192092            END-IF                                                19209299
192093     END-EVALUATE.                                                19209399
192094                                                                  19209499
192095     EVALUATE TRUE                                                19209599
192096        WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)               19209699
192097            IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             19209799
192098               IF ASC-INACTIVATED      (ASC-BLK-SUB ASC-ITEM-SUB) 19209899
192099                     OR                                           19209999
192100                  ASC-SCANNED-ONTO-TRLR(ASC-BLK-SUB ASC-ITEM-SUB) 19210099
192110                     OR                                           19211099
192120                  ASC-DIVERTED-TO-TRLR (ASC-BLK-SUB ASC-ITEM-SUB) 19212099
192121                     OR                                           19212199
192122                  ASC-LOADED-ONTO-TRLR (ASC-BLK-SUB ASC-ITEM-SUB) 19212299
192123                    SET  PS-ERROR                                 19212399
192124                         DP020-MSG-FATAL TO TRUE                  19212499
192125                    MOVE PC-TSYMSG-02692 TO DP020-MSG-NUMBER      19212599
192126                    MOVE -1              TO MR-SELECTL (PV-SUB)   19212699
192127                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           19212799
192128                    SET PS-BLOCK-ERROR   TO TRUE                  19212899
192129               END-IF                                             19212999
192130            END-IF                                                19213099
192131     END-EVALUATE.                                                19213199
192132                                                                  19213299
192133     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND                 19213399
192134          ASC-RCVR-TRBLE-EXISTS-YES                               19213499
192135        EVALUATE TRUE                                             19213599
192136           WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)            19213699
192137                 SET  PS-ERROR                                    19213799
192138                      DP020-MSG-FATAL TO TRUE                     19213899
192139                 MOVE PC-TSYMSG-01756 TO DP020-MSG-NUMBER         19213999
192140                 MOVE -1              TO MR-SELECTL (PV-SUB)      19214099
192141                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             19214199
192142                 SET PS-BLOCK-ERROR   TO TRUE                     19214299
192143           WHEN OTHER                                             19214399
192144                 CONTINUE                                         19214499
192145        END-EVALUATE                                              19214599
192146     END-IF.                                                      19214699
192147                                                                  19214799
192148     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     19214899
192149         IF ASC-CRE-SRC (ASC-BLK-SUB ASC-ITEM-SUB) = 'SMO'        19214999
192150            CONTINUE                                              19215099
192151         ELSE                                                     19215199
192152             IF (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR        19215299
192153                 DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR        19215399
192154                 DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID))          19215499
192155                 SET  PS-ERROR                                    19215599
192156                      DP020-MSG-FATAL TO TRUE                     19215699
192157                 MOVE PC-TSYMSG-02750 TO DP020-MSG-NUMBER         19215799
192158                 MOVE -1              TO MR-SELECTL (PV-SUB)      19215899
192159                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19215999
192160                 SET PS-BLOCK-ERROR   TO TRUE                     19216099
192170             END-IF                                               19217099
192180         END-IF                                                   19218099
192190     END-IF.                                                      19219099
192191                                                                  19219199
192192                                                                  19219299
192193     SUBTRACT +1                   FROM PV-ITEM-IN-USE.           19219399
192194     SUBTRACT +1                   FROM ASC-ITEM-SUB.             19219499
192195                                                                  19219599
192196     IF  ASC-ITEM-SUB < 1                                         19219699
192197         SUBTRACT +1 FROM ASC-BLK-SUB                             19219799
192198         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19219899
192199     END-IF.                                                      19219999
192200*                                                                 19220099
192300*                                                                 19230099
192400*----------------------------------------------------------------*19240099
192500*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *19250099
192600*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *19260099
192700*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *19270099
192800*  THE ENDING.                                                   *19280099
192900*----------------------------------------------------------------*19290099
193000 3310-EDIT-RANGE.                                                 19300099
193100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                19310099
193200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   19320099
193300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)19330099
193400                                   TO ASC-SELECTED-SW             19340099
193500                                        (ASC-BLK-SUB ASC-ITEM-SUB)19350099
193600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 19360099
193700         ELSE                                                     19370099
193800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     19380099
193900                 CONTINUE                                         19390099
194000             ELSE                                                 19400099
194100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        19410099
194200                 MOVE PC-TSYMSG-00054                             19420099
194300                                       TO DP020-MSG-NUMBER        19430099
194400                 MOVE -1               TO ASTRTITL                19440099
194500                 SET DP020-MSG-FATAL                              19450099
194600                     DP030-SET-CURSOR-APPL-1                      19460099
194700                     PS-ERROR          TO TRUE                    19470099
194800             END-IF                                               19480099
194900         END-IF                                                   19490099
195000     ELSE                                                         19500099
195100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     19510099
195200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19520099
195300                                   TO ASC-SELECTED-SW             19530099
195400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19540099
195500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   19550099
195600         ELSE                                                     19560099
195700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       19570099
195800                 CONTINUE                                         19580099
195900             ELSE                                                 19590099
196000*                -- ONLY ONE END-OF-RANGE ALLOWED --              19600099
196100                 MOVE PC-TSYMSG-00055                             19610099
196200                                        TO DP020-MSG-NUMBER       19620099
196300                 MOVE -1                TO ASTRTITL               19630099
196400                 SET DP020-MSG-FATAL                              19640099
196500                     DP030-SET-CURSOR-APPL-1                      19650099
196600                     PS-ERROR           TO TRUE                   19660099
196700             END-IF                                               19670099
196800         END-IF                                                   19680099
196900     END-IF.                                                      19690099
197000*                                                                 19700099
197100*                                                                 19710099
197200*----------------------------------------------------------------*19720099
197300*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *19730099
197400*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *19740099
197500*----------------------------------------------------------------*19750099
197600 3400-CHECK-RANGE-SEQUENCE.                                       19760099
197700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       19770099
197800       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      19780099
197900       AND  ASC-START-OF-SELECTED-RANGE >                         19790099
198000                                         ASC-END-OF-SELECTED-RANGE19800099
198100*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                19810099
198200         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            19820099
198300         SET DP020-MSG-FATAL       TO TRUE                        19830099
198400         SET PS-ERROR              TO TRUE                        19840099
198500         PERFORM 3410-POSITION-AT-ERROR                           19850099
198600     END-IF.                                                      19860099
198700*                                                                 19870099
198800*                                                                 19880099
198900*----------------------------------------------------------------*19890099
199000*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *19900099
199100*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CSR     *19910099
199200*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *19920099
199300*----------------------------------------------------------------*19930099
199400 3410-POSITION-AT-ERROR.                                          19940099
199500     SET DP030-SET-CURSOR-APPL-1                                  19950099
199600                                   TO TRUE.                       19960099
199700     MOVE -1                       TO ASTRTITL                    19970099
199800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 19980099
199900                    - PV-TOP-ITEM + 1.                            19990099
200000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20000099
200100         CONTINUE                                                 20010099
200200     END-IF.                                                      20020099
200300*                                                                 20030099
200400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20040099
200500                    - PV-TOP-ITEM + 1.                            20050099
200600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20060099
200700         CONTINUE                                                 20070099
200800     END-IF.                                                      20080099
200900 EJECT                                                            20090099
201000*                                                                 20100099
201100*                                                                 20110099
201200*----------------------------------------------------------------*20120099
201300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20130099
201400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *20140099
201500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *20150099
201600*----------------------------------------------------------------*20160099
201700 3500-MARK-RANGE-AS-SELECTED.                                     20170099
201800     MOVE +1                       TO ASC-BLK-SUB.                20180099
201900                                                                  20190099
202000     PERFORM 3510-MARK-SELECTED-INDS                              20200099
202100         VARYING ASC-ITEM-SUB                                     20210099
202200         FROM 1 BY 1                                              20220099
202300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20230099
202400                                                                  20240099
202500     ADD +1                        TO ASC-BLK-SUB.                20250099
202600                                                                  20260099
202700     PERFORM 3510-MARK-SELECTED-INDS                              20270099
202800         VARYING ASC-ITEM-SUB                                     20280099
202900         FROM 1 BY 1                                              20290099
203000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20300099
203100                                                                  20310099
203200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20320099
203300                                   TO PV-LIST-ITEM-NUMBER.        20330099
203400                                                                  20340099
203500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20350099
203600         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         20360099
203700               PC-ITEMS-PER-PANEL).                               20370099
203800                                                                  20380099
203900     MOVE ASC-START-OF-SELECTED-RANGE                             20390099
204000                                   TO PV-START-OF-SELECTED-RANGE. 20400099
204100                                                                  20410099
204200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            20420099
204300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  20430099
204400               PC-ITEMS-PER-PANEL).                               20440099
204500                                                                  20450099
204600     MOVE ASC-END-OF-SELECTED-RANGE                               20460099
204700                                   TO PV-END-OF-SELECTED-RANGE.   20470099
204800                                                                  20480099
204900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             20490099
205000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    20500099
205100               PC-ITEMS-PER-PANEL).                               20510099
205200                                                                  20520099
205300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             20530099
205400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             20540099
205500                                                                  20550099
205600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    20560099
205700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        20570099
205800         MOVE +1                   TO ASC-BLK-SUB                 20580099
205900         PERFORM 5100-WRITE-TEMP-STORAGE                          20590099
206000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20600099
206100             PV-FIRST-BLOCK-IN-ARRAY - 1                          20610099
206200                                                                  20620099
206300         PERFORM                                                  20630099
206400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      20640099
206500                   PV-PREV-BLOCK-IN-ARRAY                         20650099
206600             MOVE PV-FIRST-BLOCK-IN-RANGE                         20660099
206700                                   TO PV-BLOCK-NUMBER             20670099
206800             PERFORM 4410-READ-TEMP-STORAGE                       20680099
206900             PERFORM 3510-MARK-SELECTED-INDS                      20690099
207000                 VARYING ASC-ITEM-SUB                             20700099
207100                 FROM 1 BY 1                                      20710099
207200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20720099
207300             PERFORM 5100-WRITE-TEMP-STORAGE                      20730099
207400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     20740099
207500         END-PERFORM                                              20750099
207600                                                                  20760099
207700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20770099
207800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20780099
207900         PERFORM                                                  20790099
208000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20800099
208100                   PV-LAST-BLOCK-IN-RANGE                         20810099
208200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20820099
208300                                   TO PV-BLOCK-NUMBER             20830099
208400             PERFORM 4410-READ-TEMP-STORAGE                       20840099
208500             PERFORM 3510-MARK-SELECTED-INDS                      20850099
208600                 VARYING ASC-ITEM-SUB                             20860099
208700                 FROM 1 BY 1                                      20870099
208800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20880099
208900             PERFORM 5100-WRITE-TEMP-STORAGE                      20890099
209000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20900099
209100         END-PERFORM                                              20910099
209200                                                                  20920099
209300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20930099
209400                                   TO PV-BLOCK-NUMBER             20940099
209500         PERFORM 4410-READ-TEMP-STORAGE                           20950099
209600     END-IF.                                                      20960099
209700                                                                  20970099
209800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 20980099
209900                                      ASC-END-OF-SELECTED-RANGE.  20990099
210000                                                                  21000099
210100 EJECT                                                            21010099
210200*                                                                 21020099
210300*                                                                 21030099
210400*----------------------------------------------------------------*21040099
210500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21050099
210600*----------------------------------------------------------------*21060099
210700 3510-MARK-SELECTED-INDS.                                         21070099
210800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         21080099
210900         ASC-START-OF-SELECTED-RANGE)                             21090099
211000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         21100099
211100         ASC-START-OF-SELECTED-RANGE)                             21110099
211200                                                                  21120099
211300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     21130099
211400             ASC-END-OF-SELECTED-RANGE)                           21140099
211500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     21150099
211600             ASC-END-OF-SELECTED-RANGE)                           21160099
211700                                                                  21170099
211800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21180099
211900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   21190099
212000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   21200099
212100                                   TO TRUE                        21210099
212200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              21220099
212300                                   TO TRUE                        21230099
212400                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS21240099
212500             END-IF                                               21250099
212600         END-IF                                                   21260099
212700     END-IF.                                                      21270099
212800 EJECT                                                            21280099
212900*                                                                 21290099
213000*                                                                 21300099
213100*----------------------------------------------------------------*21310099
213200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *21320099
213300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *21330099
213400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *21340099
213500*    DISPLAY THE PANEL TO USER.                                  *21350099
213600*----------------------------------------------------------------*21360099
213700 4000-BUILD-INITIAL-PANEL.                                        21370099
213800     INITIALIZE ASC-BLOCK-ENTRIES (1)                             21380099
213900                ASC-BLOCK-ENTRIES (2).                            21390099
214000                                                                  21400099
214100     MOVE +1                       TO ASC-BLK-SUB.                21410099
214200                                                                  21420099
214300     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       21430099
214400                                                                  21440099
214500     MOVE +0                       TO ASC-ITEM-SUB                21450099
214600                                      ASC-NUMBER-OF-ITEMS-READ    21460099
214700                                      ASC-NUMBER-OF-SELECTED-ITEMS21470099
214800                                      ASC-HIGHEST-BLOCK-WRITTEN   21480099
214900                                      ASC-START-OF-SELECTED-RANGE 21490099
215000                                      ASC-END-OF-SELECTED-RANGE   21500099
215100                                      ASC-ITEM-AT-TOP-OF-PANEL.   21510099
215200     PERFORM 4100-PREPARE-CSR.                                    21520099
215300     PERFORM 4050-CHECK-TROUBLE.                                  21530099
215400     PERFORM 4150-GET-DEPT-VENDOR.                                21540099
215500     PERFORM 4350-GET-TOTAL-CRTNS.                                21550099
215600                                                                  21560099
215700     PERFORM 4010-OPEN-CARTON-CSR                                 21570099
215800                                                                  21580099
215900     PERFORM 4300-READ-ITEMS-FROM-DB.                             21590099
216000                                                                  21600099
216100     PERFORM 4020-CLOSE-CARTON-CSR                                21610099
216200                                                                  21620099
216300                                                                  21630099
216400     MOVE +1                   TO  PV-TOP-ITEM.                   21640099
216500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          21650099
216600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    21660099
216700         SET DP020-MSG-FATAL   TO  TRUE                           21670099
216800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               21680099
216900     ELSE                                                         21690099
217000         MOVE -1               TO MR-SELECTL (1)                  21700099
217100         SET DP030-SET-CURSOR-APPL-1                              21710099
217200                               TO TRUE                            21720099
217300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     21730099
217400     END-IF.                                                      21740099
217500 EJECT                                                            21750099
217600*                                                                 21760099
217700*                                                                 21770099
217800*----------------------------------------------------------------*21780099
217900* OPEN CARTON CSR.                                               *21790099
218000*----------------------------------------------------------------*21800099
218100 4010-OPEN-CARTON-CSR.                                            21810099
218200     PERFORM                                                      21820099
218300         WITH TEST AFTER                                          21830099
218400         VARYING PV-RETRY-COUNTER                                 21840099
218500         FROM 1 BY 1                                              21850099
218600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21860099
218700                   OR (SQLCODE = ZERO))                           21870099
218800                                                                  21880099
218900                  EXEC SQL                                        21890099
219000                       OPEN CARTON_CSR                            21900099
219100                  END-EXEC                                        21910099
219200                                                                  21920099
219300         EVALUATE TRUE                                            21930099
219400             WHEN SQLCODE = ZERO                                  21940099
219500             WHEN SQLCODE = -904                                  21950099
219600             WHEN SQLCODE = -913                                  21960099
219700                  CONTINUE                                        21970099
219800             WHEN SQLWARN0 NOT = SPACES                           21980099
219900             WHEN SQLCODE  < ZERO                                 21990099
220000             WHEN SQLCODE  > ZERO                                 22000099
220100                  MOVE '4010-OPEN-CARTON-CSR'                     22010099
220200                                   TO DP013-PARAGRAPH             22020099
220300                  MOVE 'OPEN CARTON CSR - '                       22030099
220400                                   TO DP013-MESSAGE-TEXT (1)      22040099
220500                  MOVE SQLCA       TO DP013-SQLCA                 22050099
220600                  MOVE 'SUT00028'  TO DP013-DB2-TABLE-NAME (1)    22060099
220700                  MOVE 'SUT00024'  TO DP013-DB2-TABLE-NAME (2)    22070099
220800                  SET DP013-DB2-ABEND                             22080099
220900                      DP013-XCTL-DISPLAY-RESTART TO TRUE          22090099
221000                  PERFORM DP013-0000-PROCESS-ABEND                22100099
221100         END-EVALUATE                                             22110099
221200     END-PERFORM.                                                 22120099
221300                                                                  22130099
221400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22140099
221500         MOVE '4010-OPEN-CARTON-CSR' TO DP013-PARAGRAPH           22150099
221600         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       22160099
221700                                   TO DP013-MESSAGE-TEXT (1)      22170099
221800         MOVE SQLCA                TO DP013-SQLCA                 22180099
221900         MOVE 'SUT00028'  TO DP013-DB2-TABLE-NAME (1)             22190099
222000         MOVE 'SUT00024'  TO DP013-DB2-TABLE-NAME (2)             22200099
222100         SET DP013-DB2-ABEND                                      22210099
222200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22220099
222300         PERFORM DP013-0000-PROCESS-ABEND                         22230099
222400     END-IF.                                                      22240099
222500 EJECT                                                            22250099
222600*                                                                 22260099
222700*                                                                 22270099
222800*----------------------------------------------------------------*22280099
222900* CLOSE CARTON CSR.                                              *22290099
223000*----------------------------------------------------------------*22300099
223100 4020-CLOSE-CARTON-CSR.                                           22310099
223200             EXEC SQL                                             22320099
223300                  CLOSE CARTON_CSR                                22330099
223400             END-EXEC                                             22340099
223500                                                                  22350099
223600     EVALUATE TRUE                                                22360099
223700         WHEN SQLCODE = ZERO                                      22370099
223800              CONTINUE                                            22380099
223900         WHEN SQLWARN0 NOT = SPACES                               22390099
224000         WHEN SQLCODE  < ZERO                                     22400099
224100         WHEN SQLCODE  > ZERO                                     22410099
224200              MOVE '4020-CLOSE-CARTON-CSR'                        22420099
224300                                   TO DP013-PARAGRAPH             22430099
224400              MOVE 'CLOSE CARTON CSR'                             22440099
224500                                   TO DP013-MESSAGE-TEXT (1)      22450099
224600              MOVE SQLCA           TO DP013-SQLCA                 22460099
224700              MOVE 'SUT00028'  TO DP013-DB2-TABLE-NAME (1)        22470099
224800              MOVE 'SUT00024'  TO DP013-DB2-TABLE-NAME (2)        22480099
224900              SET DP013-DB2-ABEND                                 22490099
225000                  DP013-XCTL-DISPLAY-RESTART                      22500099
225100                                   TO TRUE                        22510099
225200              PERFORM DP013-0000-PROCESS-ABEND                    22520099
225300     END-EVALUATE.                                                22530099
225400 EJECT                                                            22540099
225500*                                                                 22550099
225600*----------------------------------------------------------------*22560099
225700* CHECK TO SEE IF PO/RECEIVER IS IN TROUBLE                      *22570099
225800*----------------------------------------------------------------*22580099
225900 4050-CHECK-TROUBLE.                                              22590099
226000     EXEC SQL                                                     22600099
226100         SELECT COUNT(*)                                          22610099
226200           INTO :PV-TROUBLE-COUNT                                 22620099
226300           FROM TTRBNTF A                                         22630099
226400               ,TTRBRSN B                                         22640099
226500          WHERE A.PO_NBR       =  :DK-PO-NBR                      22650099
226600            AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                 22660099
226700            AND A.RESOLVED_IND IN ('N','I','R')                   22670099
226800            AND A.TRBL_RSN_CDE =  B.TRBL_RSN_CDE                  22680099
226900            AND A.TRBL_RSN_CDE  NOT IN  (999,301,998)             22690099
227000            AND B.NOTIF_IND    =  'T'                             22700099
227100     END-EXEC                                                     22710099
227200                                                                  22720099
227300     EVALUATE TRUE                                                22730099
227400         WHEN SQLCODE = +0                                        22740099
227500           IF PV-TROUBLE-COUNT  >  +0                             22750099
227600              SET ASC-RCVR-TRBLE-EXISTS-YES TO TRUE               22760099
227700           ELSE                                                   22770099
227800               SET ASC-RCVR-TRBLE-EXISTS-NO  TO TRUE              22780099
227900           END-IF                                                 22790099
228000         WHEN SQLWARN0 NOT = SPACES                               22800099
228100         WHEN SQLCODE < ZERO                                      22810099
228200         WHEN SQLCODE > ZERO                                      22820099
228300             MOVE '4050-CHECK-TROUBLE'                            22830099
228400                               TO DP013-PARAGRAPH                 22840099
228500             MOVE 'CHECK IF PO/RECEIVER IN TROUBLE'               22850099
228600                               TO DP013-MESSAGE-TEXT (1)          22860099
228700             MOVE SQLCA        TO DP013-SQLCA                     22870099
228800             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        22880099
228900             SET DP013-DB2-ABEND                                  22890099
229000                 DP013-XCTL-DISPLAY-RESTART                       22900099
229100                               TO TRUE                            22910099
229200             PERFORM DP013-0000-PROCESS-ABEND                     22920099
229300     END-EVALUATE.                                                22930099
229400                                                                  22940099
229500                                                                  22950099
229600                                                                  22960099
229700*----------------------------------------------------------------*22970099
229800*    SET UP THE HOST VARIABLES.                                  *22980099
229900*    PERFORM THIS PARA WHEN MULTIPLE CSRS.                       *22990099
230000*----------------------------------------------------------------*23000099
230100 4100-PREPARE-CSR.                                                23010099
230200                                                                  23020099
230300     MOVE ASC-OPER-UNT-ID               TO DK-OPER-UNT-ID.        23030099
230400     MOVE ASC-FCLTY-ID                  TO DK-FCLTY-ID.           23040099
230500     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             23050099
230600     MOVE ASC-RECEIVER                  TO DK-REC-SEQ-NBR.        23060099
230700     MOVE ASC-STR-NUMBER                TO DK-STR-NBR.            23070099
230800*                                                                 23080099
230900*                                                                 23090099
231000*----------------------------------------------------------------*23100099
231100* GET DEPT NUMBER FROM PO TABLE                                  *23110099
231200*----------------------------------------------------------------*23120099
231300 4150-GET-DEPT-VENDOR.                                            23130099
231400                                                                  23140099
231500     EXEC SQL                                                     23150099
231600          SELECT DEPT_NBR                                         23160099
231700                ,ENT_NAME_DESC                                    23170099
231800          INTO  :PURCHS-DEPT-NBR                                  23180099
231900               ,:ENTNME-ENT-NAME-DESC                             23190099
232000           FROM TPURCHS A                                         23200099
232100               ,TENTNME B                                         23210099
232200          WHERE A.PO_NBR           = :DK-PO-NBR                   23220099
232300            AND A.VER_STATUS_CDE   = 'A'                          23230099
232400            AND A.ENT_ID           =  B.ENT_ID                    23240099
232500            AND B.TYPE_CDE         = :PC-01                       23250099
232600     END-EXEC                                                     23260099
232700                                                                  23270099
232800                                                                  23280099
232900     EVALUATE TRUE                                                23290099
233000         WHEN SQLCODE = ZERO                                      23300099
233100              MOVE ENTNME-ENT-NAME-DESC TO   ASC-VENDOR-NAME      23310099
233200              MOVE PURCHS-DEPT-NBR      TO   ASC-DEPT             23320099
233300         WHEN SQLCODE = +100                                      23330099
233400              CONTINUE                                            23340099
233500         WHEN SQLCODE = -811                                      23350099
233600         WHEN SQLWARN0 NOT = SPACE                                23360099
233700         WHEN SQLCODE NOT = ZERO                                  23370099
233800              MOVE '4150-GET-DEPT-VENDOR'                         23380099
233900                               TO DP013-PARAGRAPH                 23390099
234000              MOVE 'FETCH MESSAGE CURSOR'                         23400099
234100                               TO DP013-MESSAGE-TEXT (1)          23410099
234200              MOVE SQLCA       TO DP013-SQLCA                     23420099
234300              SET DP013-DB2-ABEND                                 23430099
234400                               TO TRUE                            23440099
234500              PERFORM DP013-0000-PROCESS-ABEND                    23450099
234600     END-EVALUATE.                                                23460099
234700                                                                  23470099
234800*----------------------------------------------------------------*23480099
234900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *23490099
235000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *23500099
235100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *23510099
235200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *23520099
235300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *23530099
235400*                                                                *23540099
235500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *23550099
235600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *23560099
235700*    UPON INITIALIZATION.                                        *23570099
235800*----------------------------------------------------------------*23580099
235900 4300-READ-ITEMS-FROM-DB.                                         23590099
236000     PERFORM                                                      23600099
236100         VARYING PV-READ-COUNT                                    23610099
236200         FROM 1 BY 1                                              23620099
236300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23630099
236400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         23640099
236500******************************************************************23650099
236600                                                                  23660099
236700         PERFORM 4310-FETCH-CARTON-CSR                            23670099
236800                                                                  23680099
236900         IF  ASC-ITEMS-LEFT-ON-DB                                 23690099
237000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                23700099
237100                 ADD +1            TO ASC-ITEM-SUB                23710099
237200             ELSE                                                 23720099
237300                 ADD +1            TO ASC-BLK-SUB                 23730099
237400                 MOVE +1           TO ASC-ITEM-SUB                23740099
237500                                                                  23750099
237600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         23760099
237700                     MOVE +1       TO ASC-BLK-SUB                 23770099
237800                     SET ASC-BLOCK-MODIFIED (1)                   23780099
237900                                   TO TRUE                        23790099
238000                     PERFORM 5100-WRITE-TEMP-STORAGE              23800099
238100                     MOVE ASC-BLOCK-ENTRIES                       23810099
238200                               (PC-MAX-BLOCKS-IN-ARRAY)           23820099
238300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 23830099
238400                     ADD +1        TO ASC-BLK-SUB                 23840099
238500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23850099
238600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      23860099
238700                                   TO TRUE                        23870099
238800                 END-IF                                           23880099
238900             END-IF                                               23890099
239000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    23900099
239100             MOVE ASC-NUMBER-OF-ITEMS-READ                        23910099
239200                                   TO ASC-LIST-ITEM-NUMBER        23920099
239300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23930099
239400******************************************************************23940099
239500                MOVE SPACES                                       23950099
239600                                 TO ASC-ACTION                    23960099
239700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23970099
239800                MOVE SUT00024-SHIPT-UNT-ID                        23980099
239900                                 TO  ASC-SERIAL-SHIP-CDE          23990099
240000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24000099
240100                                     DK-CARTON-ID                 24010099
240200                MOVE SUT00024-ACTV-IND                            24020099
240300                                 TO  ASC-ACTV-CDE                 24030099
240400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24040099
240500                MOVE SUT00024-CART-SRC-CDE                        24050099
240600                                 TO  ASC-CRE-SRC                  24060099
240700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24070099
240800                IF SUT00024-ACTV-IND = 'Y' OR 'A'                 24080099
240900                    ADD SUT00028-SHPD-UNT-QTY TO ASC-TOTAL-UNITS  24090099
241000                    PERFORM 8000-DETERMINE-LAST-ACTIVITY          24100099
241100                    SET ASC-ACTVE-CRT-FND                         24110099
241200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24120099
241300                                            TO TRUE               24130099
241400                    PERFORM 8200-CHECK-VERIFIED-STATUS            24140099
241500                ELSE                                              24150099
241600                    MOVE 'INACTIVATED' TO  ASC-CART-STATUS        24160099
241700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24170099
241800                    SET ASC-INACTVE-CRT-FND                       24180099
241900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24190099
242000                                            TO TRUE               24200099
242100                END-IF                                            24210099
242200*** MOVE FOR COUNT PER CARTON                                     24220099
242300                MOVE SUT00028-SHPD-UNT-QTY                        24230099
242400                                 TO  ASC-TOT-UNTS-CRTN            24240099
242500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24250099
242600         END-IF                                                   24260099
242700     END-PERFORM.                                                 24270099
242800******************************************************************24280099
242900       IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                        24290099
243000           MOVE +1                   TO ASC-BLK-SUB               24300099
243100           PERFORM 5100-WRITE-TEMP-STORAGE                        24310099
243200           ADD +1                    TO ASC-BLK-SUB               24320099
243300           PERFORM 5100-WRITE-TEMP-STORAGE                        24330099
243400                                                                  24340099
243500           MOVE 1                    TO ASC-BLK-SUB               24350099
243600                                        PV-BLOCK-NUMBER           24360099
243700           PERFORM 4410-READ-TEMP-STORAGE                         24370099
243800           IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1           24380099
243900               MOVE 2                TO ASC-BLK-SUB               24390099
244000                                        PV-BLOCK-NUMBER           24400099
244100               PERFORM 4410-READ-TEMP-STORAGE                     24410099
244200           END-IF                                                 24420099
244300       END-IF.                                                    24430099
244400*                                                                 24440099
244500*                                                                 24450099
244600*----------------------------------------------------------------*24460099
244700*    FETCH CARTON CSR.                                           *24470099
244800*----------------------------------------------------------------*24480099
244900 4310-FETCH-CARTON-CSR.                                           24490099
245000                                                                  24500099
245100              EXEC SQL                                            24510099
245200                   FETCH  CARTON_CSR                              24520099
245300                    INTO :SUT00024-SHIPT-UNT-ID                   24530099
245400                        ,:SUT00024-ACTV-IND                       24540099
245500                        ,:SUT00024-CART-SRC-CDE                   24550099
245600                        ,:SUT00028-SHPD-UNT-QTY                   24560099
245700              END-EXEC                                            24570099
245800                                                                  24580099
245900     EVALUATE TRUE                                                24590099
246000         WHEN SQLCODE = ZERO                                      24600099
246100                 CONTINUE                                         24610099
246200         WHEN SQLCODE = +100                                      24620099
246300                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              24630099
246400                 SET PS-EO-CARTON-CSR TO TRUE                     24640099
246500                                                                  24650099
246600         WHEN SQLWARN0 NOT = SPACES                               24660099
246700         WHEN SQLCODE NOT = ZERO                                  24670099
246800              MOVE '4310-FETCH-CARTON-CSR'                        24680099
246900                                   TO DP013-PARAGRAPH             24690099
247000              MOVE 'FETCH CARTON CSR'                             24700099
247100                                   TO DP013-MESSAGE-TEXT (1)      24710099
247200              MOVE SQLCA           TO DP013-SQLCA                 24720099
247300              SET DP013-DB2-ABEND  TO TRUE                        24730099
247400              PERFORM DP013-0000-PROCESS-ABEND                    24740099
247500     END-EVALUATE.                                                24750099
247600                                                                  24760099
247700*----------------------------------------------------------------*24770099
247800* GET TOTAL ACTIVE CARTONS                                       *24780099
247900*----------------------------------------------------------------*24790099
248000                                                                  24800099
248100 4350-GET-TOTAL-CRTNS.                                            24810099
248200                                                                  24820099
248300     INITIALIZE PV-DB2-COUNT-CRTNS.                               24830099
248400                                                                  24840099
248500     EXEC SQL                                                     24850099
248600         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   24860099
248700           INTO :PV-DB2-COUNT-CRTNS                               24870099
248800           FROM SUT_OTBND_UPC A                                   24880099
248900              , SUT_OTBND_CART B                                  24890099
249000           WHERE A.TRN_NBR          = :DK-PO-NBR                  24900099
249100            AND  A.RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR             24910099
249200            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             24920099
249300            AND  B.DEST_LOC_NBR     =  :DK-STR-NBR                24930099
249400            AND  B.CART_SRC_CDE     =  'SMO'                      24940099
249500            AND  B.ACTV_IND         =  'Y'                        24950099
249600            AND  B.CRE_PGM_NM       = 'PCKCS728'                  24960099
249700     END-EXEC.                                                    24970099
249800                                                                  24980099
249900*                                                                 24990099
250000     EVALUATE TRUE                                                25000099
250100         WHEN SQLCODE = ZERO                                      25010099
250200             MOVE PV-DB2-COUNT-CRTNS TO ASC-TOTAL-CART            25020099
250300         WHEN SQLCODE = +100                                      25030099
250400             MOVE ZEROES TO ASC-TOTAL-CART                        25040099
250500         WHEN SQLWARN0 NOT = SPACES                               25050099
250600         WHEN SQLCODE < ZERO                                      25060099
250700         WHEN SQLCODE > ZERO                                      25070099
250800             MOVE '4350-GET-TOTAL-CRTNS'                          25080099
250900                               TO DP013-PARAGRAPH                 25090099
251000             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  25100099
251100                               TO DP013-MESSAGE-TEXT (1)          25110099
251200             MOVE SQLCA        TO DP013-SQLCA                     25120099
251300             MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)        25130099
251400             SET DP013-DB2-ABEND                                  25140099
251500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25150099
251600             PERFORM DP013-0000-PROCESS-ABEND                     25160099
251700     END-EVALUATE.                                                25170099
251800                                                                  25180099
251900*----------------------------------------------------------------*25190099
252000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *25200099
252100*----------------------------------------------------------------*25210099
252200 4400-MOVE-COMMAREA-TO-SCREEN.                                    25220099
252300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             25230099
252400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          25240099
252500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          25250099
252600             MOVE +1               TO ASC-BLK-SUB                 25260099
252700             PERFORM 5100-WRITE-TEMP-STORAGE                      25270099
252800             ADD +1                TO ASC-BLK-SUB                 25280099
252900             PERFORM 5100-WRITE-TEMP-STORAGE                      25290099
253000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25300099
253100                 GIVING PV-BLOCK-NUMBER                           25310099
253200                 REMAINDER PV-REMAINDER                           25320099
253300             IF  PV-REMAINDER > ZERO                              25330099
253400                 ADD +1            TO PV-BLOCK-NUMBER             25340099
253500             END-IF                                               25350099
253600             MOVE +1               TO ASC-BLK-SUB                 25360099
253700             PERFORM 4410-READ-TEMP-STORAGE                       25370099
253800             ADD +1                TO ASC-BLK-SUB                 25380099
253900                                      PV-BLOCK-NUMBER             25390099
254000             PERFORM 4410-READ-TEMP-STORAGE                       25400099
254100     END-IF.                                                      25410099
254200                                                                  25420099
254300     MOVE +1                       TO ASC-BLK-SUB.                25430099
254400                                                                  25440099
254500     COMPUTE ASC-ITEM-SUB =                                       25450099
254600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25460099
254700         + PC-ITEMS-PER-PANEL).                                   25470099
254800                                                                  25480099
254900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25490099
255000         ADD +1                    TO ASC-BLK-SUB                 25500099
255100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25510099
255200     END-IF.                                                      25520099
255300                                                                  25530099
255400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           25540099
255500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                25550099
255600                                                                  25560099
255700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        25570099
255800     PERFORM 4420-FORMAT-LIST-LINES                               25580099
255900         VARYING PV-SUB                                           25590099
256000         FROM PC-ITEMS-PER-PANEL BY -1                            25600099
256100         UNTIL PV-SUB < +1.                                       25610099
256200                                                                  25620099
256300     COMPUTE ASC-ITEMS-DISPLAYED =                                25630099
256400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          25640099
256500                                                                  25650099
256600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    25660099
256700                                      ASTRTITO.                   25670099
256800                                                                  25680099
256900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    25690099
257000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    25700099
257100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            25710099
257200                                   TO ASELITO.                    25720099
257300                                                                  25730099
257400     MOVE ASC-PO-NBR               TO PV-PO-NBR.                  25740099
257500     MOVE ASC-RECEIVER             TO PV-RECEIVER.                25750099
257600     MOVE PV-PO-RECEIVER           TO APORCVRO.                   25760099
257700*                                                                 25770099
257800     MOVE ASC-OPER-UNT-ID          TO PV-OPER-UNT                 25780099
257900     MOVE ASC-FCLTY-ID             TO PV-FCLTY.                   25790099
258000     MOVE PV-OPER-UNT-FCLTY        TO AOPERO.                     25800099
258100*                                                                 25810099
258200     MOVE ASC-SML-PRINTER          TO APRTRO.                     25820099
258300     MOVE ASC-VENDOR-NAME          TO AVENDO.                     25830099
258400     MOVE ASC-DEPT                 TO ADEPTO.                     25840099
258500     MOVE ASC-STR-NUMBER           TO ASTRO.                      25850099
258600     MOVE ASC-TOTAL-UNITS          TO ATOTUNTO.                   25860099
258700     MOVE ASC-TOTAL-CART           TO ATOTCRTO.                   25870099
258800     MOVE ASC-STATUS-MESSAGE       TO ASTRSTO.                    25880099
258900                                                                  25890099
259000     IF  DP020-MSG-NUMBER-X = SPACES                              25900099
259100         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  25910099
259200*            --- MORE ITEMS TO DISPLAY ----                       25920099
259300             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            25930099
259400             SET DP020-MSG-INFORMATIONAL TO TRUE                  25940099
259500         END-IF                                                   25950099
259600     END-IF.                                                      25960099
259700*                                                                 25970099
259800*                                                                 25980099
259900*----------------------------------------------------------------*25990099
260000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *26000099
260100*----------------------------------------------------------------*26010099
260200 4410-READ-TEMP-STORAGE.                                          26020099
260300     EXEC CICS                                                    26030099
260400         READQ TS                                                 26040099
260500             QUEUE (ASC-LIST-QUEUE-NAME)                          26050099
260600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26060099
260700             ITEM  (PV-BLOCK-NUMBER)                              26070099
260800             RESP  (PV-CICS-RESP)                                 26080099
260900     END-EXEC.                                                    26090099
261000                                                                  26100099
261100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       26110099
261200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     26120099
261300         CONTINUE                                                 26130099
261400     ELSE                                                         26140099
261500         SET DP013-CICS-ABEND      TO TRUE                        26150099
261600         SET DP013-NO-ROLLBACK     TO TRUE                        26160099
261700         MOVE '4410-READ-TEMP-STORAGE'                            26170099
261800                                   TO DP013-PARAGRAPH             26180099
261900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      26190099
262000                                   TO DP013-MESSAGE-TEXT(1)       26200099
262100         PERFORM DP013-0000-PROCESS-ABEND                         26210099
262200     END-IF.                                                      26220099
262300                                                                  26230099
262400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26240099
262500                                                                  26250099
262600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         26260099
262700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               26270099
262800     END-IF.                                                      26280099
262900 EJECT                                                            26290099
263000*                                                                 26300099
263100*                                                                 26310099
263200*----------------------------------------------------------------*26320099
263300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *26330099
263400*----------------------------------------------------------------*26340099
263500 4420-FORMAT-LIST-LINES.                                          26350099
263600     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      26360099
263700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                26370099
263800         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           26380099
263900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           26390099
264000         MOVE SPACES             TO MR-SELECTI (PV-SUB)           26400099
264100                                    MR-ACTION (PV-SUB)            26410099
264200                                    MR-SHIP (PV-SUB)              26420099
264300                                    MR-ACTV (PV-SUB)              26430099
264400                                    MR-SRC (PV-SUB)               26440099
264500                                    MR-STAT (PV-SUB)              26450099
264600                                    MR-UNTS-CRTN-X (PV-SUB)       26460099
264700     ELSE                                                         26470099
264800         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      26480099
264900                                                   > SPACES       26490099
265000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 26500099
265100                                 TO MR-SELECTI (PV-SUB)           26510099
265200         ELSE                                                     26520099
265300             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      26530099
265400                                 TO MR-SELECTI (PV-SUB)           26540099
265500         END-IF                                                   26550099
265600                                                                  26560099
265700         IF  DP030-SET-CURSOR-TRAILER                             26570099
265800             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)26580099
265900                 > SPACES)                                        26590099
266000               OR (PV-SUB = 1))                                   26600099
266100                SET DP030-SET-CURSOR-APPL-1 TO TRUE               26610099
266200                MOVE -1            TO MR-SELECTL (PV-SUB)         26620099
266300             END-IF                                               26630099
266400         END-IF                                                   26640099
266500                                                                  26650099
266600******MOVE LIST ITEMS TO SCREEN                                   26660099
266700             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           26670099
266800                                 TO MR-ACTION (PV-SUB)            26680099
266900             MOVE ASC-SERIAL-SHIP-CDE (ASC-BLK-SUB ASC-ITEM-SUB)  26690099
267000                                 TO MR-SHIP (PV-SUB)              26700099
267100                                                                  26710099
267200             IF ASC-ACTV-CDE (ASC-BLK-SUB ASC-ITEM-SUB) =         26720099
267210                                            'Y' OR 'A'            26721099
267300                 MOVE 'A'        TO MR-ACTV (PV-SUB)              26730099
267301             ELSE                                                 26730199
267310                 MOVE 'I'        TO MR-ACTV (PV-SUB)              26731099
267320             END-IF                                               26732099
267400             MOVE ASC-CRE-SRC   (ASC-BLK-SUB ASC-ITEM-SUB)        26740099
267500                                 TO MR-SRC (PV-SUB)               26750099
267600             MOVE ASC-CART-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)      26760099
267700                                 TO MR-STAT (PV-SUB)              26770099
267800             MOVE ASC-TOT-UNTS-CRTN (ASC-BLK-SUB ASC-ITEM-SUB)    26780099
267900                                 TO MR-UNTS-CRTN (PV-SUB)         26790099
268000     END-IF.                                                      26800099
268100                                                                  26810099
268200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               26820099
268300                                                                  26830099
268400     IF  ASC-ITEM-SUB < + 1                                       26840099
268500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                26850099
268600         MOVE +1                   TO ASC-BLK-SUB                 26860099
268700     END-IF.                                                      26870099
268800*                                                                 26880099
268900*                                                                 26890099
269000*----------------------------------------------------------------*26900099
269100*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *26910099
269200*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *26920099
269300*  ISSUE A WARNING.                                              *26930099
269400*----------------------------------------------------------------*26940099
269500 4430-CHECK-FOR-BEGIN-AND-END.                                    26950099
269600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       26960099
269700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     26970099
269800*            -- NO END-OF-RANGE SPECFIED ---                      26980099
269900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            26990099
270000             SET DP020-MSG-WARNING TO TRUE                        27000099
270100             PERFORM 4431-POSITION-AT-WARNING                     27010099
270200         END-IF                                                   27020099
270300     ELSE                                                         27030099
270400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     27040099
270500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                27050099
270600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            27060099
270700             SET DP020-MSG-WARNING TO TRUE                        27070099
270800             PERFORM 4431-POSITION-AT-WARNING                     27080099
270900         END-IF                                                   27090099
271000     END-IF.                                                      27100099
271100*                                                                 27110099
271200*                                                                 27120099
271300*----------------------------------------------------------------*27130099
271400*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *27140099
271500*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *27150099
271600*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *27160099
271700*  POSITION THE CSR THERE.                                       *27170099
271800*----------------------------------------------------------------*27180099
271900 4431-POSITION-AT-WARNING.                                        27190099
272000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 27200099
272100                    - PV-TOP-ITEM + 1.                            27210099
272200                                                                  27220099
272300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27230099
272400         CONTINUE                                                 27240099
272500     ELSE                                                         27250099
272600         SET DP030-SET-CURSOR-APPL-1                              27260099
272700                                   TO TRUE                        27270099
272800         MOVE -1                   TO MR-SELECTL (PV-SUB)         27280099
272900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         27290099
273000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         27300099
273100     END-IF.                                                      27310099
273200                                                                  27320099
273300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   27330099
273400                     - PV-TOP-ITEM + 1.                           27340099
273500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      27350099
273600         CONTINUE                                                 27360099
273700     ELSE                                                         27370099
273800         SET DP030-SET-CURSOR-APPL-1                              27380099
273900                                   TO TRUE                        27390099
274000         MOVE -1                   TO MR-SELECTL (PV-SUB)         27400099
274100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         27410099
274200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         27420099
274300     END-IF.                                                      27430099
274400*----------------------------------------------------------------*27440099
274500*  PRINT AND UPDATE FUNCTION                                      27450099
274600*----------------------------------------------------------------*27460099
274700 4600-PROCESS-PRINT-FUNCTION.                                     27470099
274800                                                                  27480099
274900                                                                  27490099
275000     MOVE +1                       TO ASC-BLK-SUB.                27500099
275100     PERFORM 5100-WRITE-TEMP-STORAGE.                             27510099
275200     ADD +1                        TO ASC-BLK-SUB.                27520099
275300     PERFORM 5100-WRITE-TEMP-STORAGE.                             27530099
275400                                                                  27540099
275500     PERFORM 6112-READ-LIST-QUEUE.                                27550099
275600                                                                  27560099
275700     SET  LQW-IDX  TO   1.                                        27570099
275800                                                                  27580099
275900       IF PV-CICS-RESP = DFHRESP (NORMAL)                         27590099
276000         PERFORM                                                  27600099
276100         VARYING LQW-IDX  FROM 1 BY 1                             27610099
276200         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     27620099
276300            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27630099
276400            OR   PS-ERROR                                         27640099
276500             IF  LQW-SELECT (LQW-IDX)                             27650099
276600                 PERFORM 4605-PROCESS-SELECTED-LINES              27660099
276700             END-IF                                               27670099
276800         END-PERFORM                                              27680099
276900       END-IF.                                                    27690099
277000                                                                  27700099
277100     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           27710099
277200     PERFORM 6111-WRITE-LIST-QUEUE.                               27720099
277300                                                                  27730099
277400     MOVE +1                     TO  ASC-BLK-SUB.                 27740099
277500     PERFORM 4410-READ-TEMP-STORAGE.                              27750099
277600                                                                  27760099
277700     ADD +1                      TO  ASC-BLK-SUB                  27770099
277800                                     PV-BLOCK-NUMBER.             27780099
277900                                                                  27790099
278000     PERFORM 4410-READ-TEMP-STORAGE.                              27800099
278100                                                                  27810099
278200*----------------------------------------------------------------*27820099
278300*----------------------------------------------------------------*27830099
278400*                                                                 27840099
278500*----------------------------------------------------------------*27850099
278600 4605-PROCESS-SELECTED-LINES.                                     27860099
278700                                                                  27870099
278800     PERFORM 4620-PROCESS-LINES.                                  27880099
278900                                                                  27890099
279000     IF  PS-NO-ERROR                                              27900099
279100*        SET  LQW-DESELECT (LQW-IDX) TO TRUE                      27910099
279200         EVALUATE TRUE                                            27920099
279300             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          27930099
279400                  MOVE PC-UPD      TO LQW-ACTION (LQW-IDX)        27940099
279500                  MOVE 'I'         TO LQW-ACTV-CDE (LQW-IDX)      27950099
279600                  MOVE 'INACTIVATED'                              27960099
279700                             TO LQW-CART-STATUS (LQW-IDX)         27970099
279800         END-EVALUATE                                             27980099
279900         SUBTRACT  1                                              27990099
280000             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   28000099
280100         MOVE LQW-SELECTED-SW (LQW-IDX)                           28010099
280200                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   28020099
280300     END-IF.                                                      28030099
280400                                                                  28040099
280500                                                                  28050099
280600*----------------------------------------------------------------*28060099
280700*                                                                 28070099
280800*                                                                 28080099
280900*----------------------------------------------------------------*28090099
281000 4620-PROCESS-LINES.                                              28100099
281100                                                                  28110099
281200                                                                  28120099
281300     IF  PS-NO-ERROR                                              28130099
281400                                                                  28140099
281500         IF  LQW-SELECT (LQW-IDX)                                 28150099
281600             EVALUATE TRUE                                        28160099
281700                 WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)      28170099
281800                   IF LQW-INACTVE-CRT-FND (LQW-IDX)               28180099
281900                       SET PS-INACTV-CRTN-YES                     28190099
282000                           PS-ERROR TO TRUE                       28200099
282100                   ELSE                                           28210099
282200                      MOVE LQW-SERIAL-SHIP-CDE (LQW-IDX)          28220099
282300                             TO SUT00024-SHIPT-UNT-ID             28230099
282400                      PERFORM 4800-INACTVATE-CARTON-ID            28240099
282600                      ADD +1 TO PV-NBR-CRTNS-INACTIVATED          28260099
282700                   END-IF                                         28270099
282800             END-EVALUATE                                         28280099
282900         END-IF                                                   28290099
283000     END-IF.                                                      28300099
283100                                                                  28310099
283200                                                                  28320099
283300*----------------------------------------------------------------*28330099
283400*----------------------------------------------------------------*28340099
283500 4650-ISSUE-RESMOOTH-REQ.                                         28350099
283600                                                                  28360099
283700                                                                  28370099
283800*    INITIALIZE  PC204-INTER-APPL-COMMAREA                        28380099
283900     IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                    28390099
284000         SET PC204-REPRINT-CTN-LIST   TO TRUE                     28400099
284100     ELSE                                                         28410099
284200         SET PC204-RESMOOTH-CRTNS-DEL TO TRUE                     28420099
284300     END-IF.                                                      28430099
284400                                                                  28440099
284500     MOVE PV-RANDOM-NBR-R         TO PC204-SMTHG-PRC-ID           28450099
284600     MOVE ASC-OPER-UNT-ID         TO PC204-OPER-UNT-ID.           28460099
284700     MOVE ASC-FCLTY-ID            TO PC204-FCLTY-ID.              28470099
284800     MOVE ASC-PO-NBR              TO PC204-PO-NBR.                28480099
284900     MOVE ASC-RECEIVER            TO PC204-REC-SEQ-NBR.           28490099
285000     MOVE ASC-STR-NUMBER          TO PC204-STR-NBR.               28500099
285100     MOVE PV-ADJUST-LABEL-COUNT   TO PC204-LABELS-NEEDED.         28510099
285200                                                                  28520099
285300     MOVE LENGTH OF  PC204-INTER-APPL-COMMAREA                    28530099
285400                                        TO PV-COMMAREA-LENGTH.    28540099
285500                                                                  28550099
285600     EXEC CICS                                                    28560099
285700         LINK                                                     28570099
285800             PROGRAM   (PC-PRINT-PROGRAM)                         28580099
285900             COMMAREA  ( PC204-INTER-APPL-COMMAREA)               28590099
286000             LENGTH    (PV-COMMAREA-LENGTH)                       28600099
286100             RESP      (PV-CICS-RESP)                             28610099
286200     END-EXEC.                                                    28620099
286300                                                                  28630099
286400     EVALUATE TRUE                                                28640099
286500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     28650099
286600              IF PC204-SUCCESSFUL-REQ                             28660099
286700                  CONTINUE                                        28670099
286800              ELSE                                                28680099
286900                  IF PC204-SQL-ERROR                              28690099
287000                     MOVE PC-TSYMSG-02694  TO DP020-MSG-NUMBER    28700099
287100                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        28710099
287200                     SET PS-ERROR TO TRUE                         28720099
287300                  ELSE                                            28730099
287400                     MOVE PC-TSYMSG-02693  TO DP020-MSG-NUMBER    28740099
287500                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        28750099
287600                     SET PS-ERROR TO TRUE                         28760099
287700                  END-IF                                          28770099
287800              END-IF                                              28780099
287900*-2693 COMMUNICATION-ERROR--*                                     28790099
288000*-2694  DATABASE ERROR------*                                     28800099
288100         WHEN OTHER                                               28810099
288200              MOVE PC-TSYMSG-02693  TO DP020-MSG-NUMBER           28820099
288300              SET DP020-MSG-INFORMATIONAL  TO  TRUE               28830099
288400              SET PS-ERROR TO TRUE                                28840099
288500     END-EVALUATE.                                                28850099
288600                                                                  28860099
288700                                                                  28870099
288800                                                                  28880099
288900*----------------------------------------------------------------*28890099
289000*  INACTIVATE LABEL CROSS REFERENCE ROW                           28900099
289100*----------------------------------------------------------------*28910099
289200 4800-INACTVATE-CARTON-ID.                                        28920099
289300                                                                  28930099
289400                                                                  28940099
289500     EXEC SQL                                                     28950099
289600          UPDATE SUT_OTBND_CART                                   28960099
289700             SET                                                  28970099
289800                  ACTV_IND           = 'N'                        28980099
289900           WHERE  SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID     28990099
290000     END-EXEC.                                                    29000099
290100                                                                  29010099
290200     EVALUATE TRUE                                                29020099
290300         WHEN SQLCODE = ZERO                                      29030099
290400         WHEN SQLCODE = +100                                      29040099
290500                  CONTINUE                                        29050099
290600                                                                  29060099
290700         WHEN SQLCODE = -904                                      29070099
290800         WHEN SQLCODE = -911                                      29080099
290900         WHEN SQLCODE = -913                                      29090099
291000             EXEC CICS                                            29100099
291100                  WRITEQ TD                                       29110099
291200                   QUEUE  ('CSSL')                                29120099
291300                    FROM  (PV-CICS-MSG-AREA2)                     29130099
291400                  LENGTH  (PV-COMMAREA-LENGTH)                    29140099
291500                    RESP  (PV-CICS-RESP)                          29150099
291600             END-EXEC                                             29160099
291700                                                                  29170099
291800         WHEN SQLWARN0 NOT = SPACES                               29180099
291900         WHEN SQLCODE NOT EQUAL ZERO                              29190099
292000              MOVE '4800-INACTVATE-CARTON-ID'                     29200099
292100                                   TO DP013-PARAGRAPH             29210099
292200              MOVE 'UPDATE ACTIVE IND SUT_OTBND_CART '            29220099
292300                                   TO DP013-MESSAGE-TEXT (1)      29230099
292400              MOVE SQLCA           TO DP013-SQLCA                 29240099
292500              MOVE 'SUT00024'      TO DP013-DB2-TABLE-NAME (1)    29250099
292600              SET DP013-DB2-ABEND  TO TRUE                        29260099
292700              PERFORM DP013-0000-PROCESS-ABEND                    29270099
292800     END-EVALUATE.                                                29280099
297200*                                                                 29720099
297300*----------------------------------------------------------------*29730099
297400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *29740099
297500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *29750099
297600* FOR THE SELECTED ITEMS QUEUE.                                  *29760099
297700*                                                                *29770099
297800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *29780099
297900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *29790099
298000* THE ARRAY IS FULL.                                             *29800099
298100*----------------------------------------------------------------*29810099
298200 5000-PREPARE-SEL-QUEUE.                                          29820099
298300     MOVE +1                   TO  ASC-BLK-SUB.                   29830099
298400     PERFORM 5100-WRITE-TEMP-STORAGE.                             29840099
298500     ADD +1                    TO  ASC-BLK-SUB.                   29850099
298600     PERFORM 5100-WRITE-TEMP-STORAGE.                             29860099
298700                                                                  29870099
298800     EVALUATE TRUE                                                29880099
298900       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                29890099
299000         MOVE ASC-SEL-QUEUE-NAME TO SU009-SEL-QUEUE-NAME          29900099
299100       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                29910099
299200         MOVE ASC-SEL-QUEUE-NAME TO PC204-SEL-QUEUE-NAME          29920099
299300       WHEN OTHER                                                 29930099
299400         MOVE ASC-SEL-QUEUE-NAME     TO  PC202-SEL-QUEUE-NAME     29940099
299500     END-EVALUATE                                                 29950099
299600                                                                  29960099
299700     PERFORM 6010-DELETE-SEL-QUEUE.                               29970099
299800                                                                  29980099
299900     SET ASC-UPDATE-TSQ        TO  TRUE.                          29990099
300000     EVALUATE TRUE                                                30000099
300100       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                30010099
300200         SET SU010-IDX         TO  1                              30020099
300300         MOVE ZERO             TO SU009-NUMBER-OF-TS-ITEMS        30030099
300400         INITIALIZE SU010-SELECTED-ITEM-ARRAY                     30040099
300500       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                30050099
300600         SET PC206-IDX         TO  1                              30060099
300700         MOVE ZERO             TO PC204-NUMBER-OF-TS-ITEMS        30070099
300800         INITIALIZE PC206-SELECTED-ITEM-ARRAY                     30080099
300900       WHEN OTHER                                                 30090099
301000         SET PC203-IDX             TO  1                          30100099
301100         MOVE ZERO                 TO PC202-NUMBER-OF-TS-ITEMS    30110099
301200         INITIALIZE PC203-SELECTED-ITEM-ARRAY                     30120099
301300     END-EVALUATE                                                 30130099
301400                                                                  30140099
301500                                                                  30150099
301600     EVALUATE TRUE                                                30160099
301700       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                30170099
301800         PERFORM 5400-FILL-SEL-QUEUE-RECORD                       30180099
301900                 VARYING PV-ITEM                                  30190099
302000                 FROM 1 BY 1                                      30200099
302100                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  30210099
302200       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                30220099
302300         PERFORM 5300-FILL-SEL-QUEUE-RECORD                       30230099
302400                 VARYING PV-ITEM                                  30240099
302500                 FROM 1 BY 1                                      30250099
302600                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  30260099
302700       WHEN OTHER                                                 30270099
302800         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       30280099
302900                 VARYING PV-ITEM                                  30290099
303000                 FROM 1 BY 1                                      30300099
303100                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  30310099
303200     END-EVALUATE                                                 30320099
303300                                                                  30330099
303400                                                                  30340099
303500     EVALUATE TRUE                                                30350099
303600       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                30360099
303700         IF SU010-IDX > 1                                         30370099
303800             PERFORM 5405-WRITE-SEL-QUEUE                         30380099
303900             ADD +1 TO SU009-NUMBER-OF-TS-ITEMS                   30390099
304000         END-IF                                                   30400099
304100       WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                30410099
304200         IF PC206-IDX > 1                                         30420099
304300             PERFORM 5305-WRITE-SEL-QUEUE                         30430099
304400             ADD +1 TO PC204-NUMBER-OF-TS-ITEMS                   30440099
304500         END-IF                                                   30450099
304600       WHEN OTHER                                                 30460099
304700         IF PC203-IDX > 1                                         30470099
304800             PERFORM 5205-WRITE-SEL-QUEUE                         30480099
304900             ADD +1                TO PC202-NUMBER-OF-TS-ITEMS    30490099
305000         END-IF                                                   30500099
305100     END-EVALUATE.                                                30510099
305200 EJECT                                                            30520099
305300*                                                                 30530099
305400*                                                                 30540099
305500*----------------------------------------------------------------*30550099
305600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *30560099
305700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *30570099
305800*----------------------------------------------------------------*30580099
305900 5100-WRITE-TEMP-STORAGE.                                         30590099
306000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     30600099
306100                                   TO PV-LIST-ITEM-NUMBER.        30610099
306200     COMPUTE PV-BLOCK-NUMBER =                                    30620099
306300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    30630099
306400                                                                  30640099
306500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             30650099
306600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             30660099
306700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      30670099
306800             PERFORM 5105-REWRITE-ASC-LISTQ                       30680099
306900         END-IF                                                   30690099
307000     ELSE                                                         30700099
307100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       30710099
307200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            30720099
307300         PERFORM 5110-WRITE-ASC-LISTQ                             30730099
307400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   30740099
307500     END-IF.                                                      30750099
307600                                                                  30760099
307700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             30770099
307800*                                                                 30780099
307900*                                                                 30790099
308000*----------------------------------------------------------------*30800099
308100*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *30810099
308200*  SPECIFIC COMMAREA.                                            *30820099
308300*----------------------------------------------------------------*30830099
308400 5105-REWRITE-ASC-LISTQ.                                          30840099
308500     EXEC CICS                                                    30850099
308600         WRITEQ TS                                                30860099
308700             QUEUE (ASC-LIST-QUEUE-NAME)                          30870099
308800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30880099
308900             ITEM  (PV-BLOCK-NUMBER)                              30890099
309000             REWRITE                                              30900099
309100             RESP  (PV-CICS-RESP)                                 30910099
309200     END-EXEC.                                                    30920099
309300                                                                  30930099
309400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           30940099
309500         CONTINUE                                                 30950099
309600     ELSE                                                         30960099
309700         SET DP013-CICS-ABEND      TO TRUE                        30970099
309800         SET DP013-NO-ROLLBACK     TO TRUE                        30980099
309900         MOVE '5105-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         30990099
310000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     31000099
310100                                   TO DP013-MESSAGE-TEXT(1)       31010099
310200         PERFORM DP013-0000-PROCESS-ABEND                         31020099
310300     END-IF.                                                      31030099
310400*                                                                 31040099
310500*                                                                 31050099
310600*----------------------------------------------------------------*31060099
310700*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *31070099
310800*  SPECIFIC COMMAREA.                                            *31080099
310900*----------------------------------------------------------------*31090099
311000 5110-WRITE-ASC-LISTQ.                                            31100099
311100     EXEC CICS                                                    31110099
311200         WRITEQ TS                                                31120099
311300             QUEUE (ASC-LIST-QUEUE-NAME)                          31130099
311400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31140099
311500             ITEM  (PV-BLOCK-NUMBER)                              31150099
311600             RESP  (PV-CICS-RESP)                                 31160099
311700     END-EXEC.                                                    31170099
311800                                                                  31180099
311900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      31190099
312000         SET DP013-CICS-ABEND      TO TRUE                        31200099
312100         SET DP013-NO-ROLLBACK     TO TRUE                        31210099
312200         MOVE '5110-WRITE-ASC-LISTQ'                              31220099
312300                                   TO DP013-PARAGRAPH             31230099
312400         MOVE 'ATTEMPTING TO WRITE LIST TEMP STORAGE QUEUE'       31240099
312500                                   TO DP013-MESSAGE-TEXT(1)       31250099
312600         PERFORM DP013-0000-PROCESS-ABEND                         31260099
312700     END-IF.                                                      31270099
312800*                                                                 31280099
312900*                                                                 31290099
313000*----------------------------------------------------------------*31300099
313100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *31310099
313200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *31320099
313300* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *31330099
313400* TO THE DESTINATION APPLICATION.                                *31340099
313500*----------------------------------------------------------------*31350099
313600 5200-FILL-SEL-QUEUE-RECORD.                                      31360099
313700                                                                  31370099
313800     PERFORM 6112-READ-LIST-QUEUE.                                31380099
313900                                                                  31390099
314000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       31400099
314100         PERFORM                                                  31410099
314200         VARYING LQW-IDX                                          31420099
314300         FROM 1 BY 1                                              31430099
314400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            31440099
314500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          31450099
314600                                                                  31460099
314700             IF  LQW-SELECT (LQW-IDX)                             31470099
314800                 IF LQW-INACTVE-CRT-FND (LQW-IDX)                 31480099
314900                    SET PS-INACTV-CRTN-YES TO TRUE                31490099
315000                 END-IF                                           31500099
315100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              31510099
315200                                   TO PC203-ITEM (PC203-IDX)      31520099
315300                 MOVE SPACES       TO PC203-ACTION-SW (PC203-IDX) 31530099
315400                                                                  31540099
315500                 MOVE LQW-SERIAL-SHIP-CDE (LQW-IDX)               31550099
315600                                   TO PC203-SHIPT-UNT-ID          31560099
315700                                      (PC203-IDX)                 31570099
315800                 MOVE ASC-TOTAL-UNITS                             31580099
315900                                TO PC203-DEST-STORE-UNITS         31590099
316000                                      (PC203-IDX)                 31600099
316100                 MOVE ASC-TOTAL-CART                              31610099
316200                                TO PC203-PREV-CTN-COUNT           31620099
316300                                      (PC203-IDX)                 31630099
316400                 MOVE ASC-STR-NUMBER                              31640099
316500                                TO PC203-DEST-OPER-UNT-ID         31650099
316600                                      (PC203-IDX)                 31660099
316700                                                                  31670099
316800                 SET PC203-IDX UP BY 1                            31680099
316900                 IF  PC203-IDX > PC203-MAX-ITEMS                  31690099
317000                     PERFORM 5205-WRITE-SEL-QUEUE                 31700099
317100                     ADD +1        TO PC202-NUMBER-OF-TS-ITEMS    31710099
317200                     INITIALIZE PC203-SELECTED-ITEM-ARRAY         31720099
317300                     SET PC203-IDX TO  1                          31730099
317400                 END-IF                                           31740099
317500             END-IF                                               31750099
317600         END-PERFORM                                              31760099
317700     END-IF.                                                      31770099
317800*                                                                 31780099
317900*                                                                 31790099
318000*----------------------------------------------------------------*31800099
318100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *31810099
318200*----------------------------------------------------------------*31820099
318300 5205-WRITE-SEL-QUEUE.                                            31830099
318400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            31840099
318500                                   TO PC203-SELECTED-ITEMS.       31850099
318600                                                                  31860099
318700     EXEC CICS                                                    31870099
318800          WRITEQ TS                                               31880099
318900              QUEUE (ASC-SEL-QUEUE-NAME)                          31890099
319000              FROM  (PC203-DC-SELECT-RECORD)                      31900099
319100              ITEM  (PV-SEL-QUEUE-ITEM)                           31910099
319200              RESP  (PV-CICS-RESP)                                31920099
319300     END-EXEC.                                                    31930099
319400                                                                  31940099
319500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31950099
319600         CONTINUE                                                 31960099
319700     ELSE                                                         31970099
319800         SET DP013-CICS-ABEND      TO TRUE                        31980099
319900         SET DP013-NO-ROLLBACK     TO TRUE                        31990099
320000         MOVE '5205-WRITE-SEL-QUEUE'                              32000099
320100                                   TO DP013-PARAGRAPH             32010099
320200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          32020099
320300                                   TO DP013-MESSAGE-TEXT(1)       32030099
320400         PERFORM DP013-0000-PROCESS-ABEND                         32040099
320500     END-IF.                                                      32050099
320600 EJECT                                                            32060099
320700*                                                                 32070099
320800*----------------------------------------------------------------*32080099
320900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *32090099
321000*----------------------------------------------------------------*32100099
321100 5305-WRITE-SEL-QUEUE.                                            32110099
321200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32120099
321300                                   TO PC206-SELECTED-ITEMS.       32130099
321400                                                                  32140099
321500     EXEC CICS                                                    32150099
321600          WRITEQ TS                                               32160099
321700              QUEUE (ASC-SEL-QUEUE-NAME)                          32170099
321800              FROM  (PC206-DC-SELECT-RECORD)                      32180099
321900              ITEM  (PV-SEL-QUEUE-ITEM)                           32190099
322000              RESP  (PV-CICS-RESP)                                32200099
322100     END-EXEC.                                                    32210099
322200                                                                  32220099
322300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32230099
322400         CONTINUE                                                 32240099
322500     ELSE                                                         32250099
322600         SET DP013-CICS-ABEND      TO TRUE                        32260099
322700         SET DP013-NO-ROLLBACK     TO TRUE                        32270099
322800         MOVE '5205-WRITE-SEL-QUEUE'                              32280099
322900                                   TO DP013-PARAGRAPH             32290099
323000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          32300099
323100                                   TO DP013-MESSAGE-TEXT(1)       32310099
323200         PERFORM DP013-0000-PROCESS-ABEND                         32320099
323300     END-IF.                                                      32330099
323400 EJECT                                                            32340099
323500*                                                                 32350099
323600*----------------------------------------------------------------*32360099
323700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *32370099
323800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *32380099
323900* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *32390099
324000* TO THE DESTINATION APPLICATION.                                *32400099
324100*----------------------------------------------------------------*32410099
324200 5300-FILL-SEL-QUEUE-RECORD.                                      32420099
324300                                                                  32430099
324400     PERFORM 6112-READ-LIST-QUEUE.                                32440099
324500                                                                  32450099
324600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       32460099
324700         PERFORM                                                  32470099
324800         VARYING LQW-IDX                                          32480099
324900         FROM 1 BY 1                                              32490099
325000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            32500099
325100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          32510099
325200                                                                  32520099
325300             IF  LQW-SELECT (LQW-IDX)                             32530099
325400                 IF LQW-INACTVE-CRT-FND (LQW-IDX)                 32540099
325500                    SET PS-INACTV-CRTN-YES TO TRUE                32550099
325600                 END-IF                                           32560099
325700                 ADD  +1 TO   PC204-TOT-LABELS-CNT                32570099
325800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              32580099
325900                                   TO PC206-ITEM (PC206-IDX)      32590099
326000                 MOVE SPACES       TO PC206-ACTION-SW (PC206-IDX) 32600099
326100                                                                  32610099
326200                 MOVE LQW-SERIAL-SHIP-CDE (LQW-IDX)               32620099
326300                                   TO PC206-SHIPT-UNT-ID          32630099
326400                                      (PC206-IDX)                 32640099
326500                                                                  32650099
326600                 SET PC206-IDX UP BY 1                            32660099
326700                 IF  PC206-IDX > PC206-MAX-ITEMS                  32670099
326800                     PERFORM 5305-WRITE-SEL-QUEUE                 32680099
326900                     ADD +1        TO PC204-NUMBER-OF-TS-ITEMS    32690099
327000                     INITIALIZE PC206-SELECTED-ITEM-ARRAY         32700099
327100                     SET PC206-IDX TO  1                          32710099
327200                 END-IF                                           32720099
327300             END-IF                                               32730099
327400         END-PERFORM                                              32740099
327500     END-IF.                                                      32750099
327600*                                                                 32760099
327700*----------------------------------------------------------------*32770099
327800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *32780099
327900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *32790099
328000* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *32800099
328100* TO THE DESTINATION APPLICATION.                                *32810099
328200*----------------------------------------------------------------*32820099
328300 5400-FILL-SEL-QUEUE-RECORD.                                      32830099
328400                                                                  32840099
328500     PERFORM 6112-READ-LIST-QUEUE.                                32850099
328600                                                                  32860099
328700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       32870099
328800         PERFORM                                                  32880099
328900         VARYING LQW-IDX                                          32890099
329000         FROM 1 BY 1                                              32900099
329100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            32910099
329200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          32920099
329300                                                                  32930099
329400             IF  LQW-SELECT (LQW-IDX)                             32940099
329500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              32950099
329600                                   TO SU010-ITEM (SU010-IDX)      32960099
329700                 MOVE SPACES       TO SU010-ACTION-SW (SU010-IDX) 32970099
329800                                                                  32980099
329900                 MOVE LQW-SERIAL-SHIP-CDE (LQW-IDX)               32990099
330000                                   TO SU010-SML                   33000099
330100                                      (SU010-IDX)                 33010099
330110                 MOVE LQW-CRE-SRC (LQW-IDX)                       33011099
330120                                   TO SU010-CREATE                33012099
330121                                      (SU010-IDX)                 33012199
330131                 MOVE '-'          TO ASC-DASH                    33013199
330140                 MOVE ASC-PO-RECEIVER                             33014099
330150                                   TO SU010-PO-RCVR               33015099
330160                                      (SU010-IDX)                 33016099
330200                                                                  33020099
330300                 SET SU010-IDX UP BY 1                            33030099
330400                 IF  SU010-IDX > SU010-MAX-ITEMS                  33040099
330500                     PERFORM 5405-WRITE-SEL-QUEUE                 33050099
330600                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    33060099
330700                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         33070099
330800                     SET SU010-IDX TO  1                          33080099
330900                 END-IF                                           33090099
331000             END-IF                                               33100099
331100         END-PERFORM                                              33110099
331200     END-IF.                                                      33120099
331300*                                                                 33130099
331400*----------------------------------------------------------------*33140099
331500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *33150099
331600*----------------------------------------------------------------*33160099
331700 5405-WRITE-SEL-QUEUE.                                            33170099
331800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33180099
331900                                   TO SU010-SELECTED-ITEMS.       33190099
332000                                                                  33200099
332100     EXEC CICS                                                    33210099
332200          WRITEQ TS                                               33220099
332300              QUEUE (ASC-SEL-QUEUE-NAME)                          33230099
332400              FROM  (SU010-SELECT-RECORD)                         33240099
332500              ITEM  (PV-SEL-QUEUE-ITEM)                           33250099
332600              RESP  (PV-CICS-RESP)                                33260099
332700     END-EXEC.                                                    33270099
332800                                                                  33280099
332900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          33290099
333000         CONTINUE                                                 33300099
333100     ELSE                                                         33310099
333200         SET DP013-CICS-ABEND      TO TRUE                        33320099
333300         SET DP013-NO-ROLLBACK     TO TRUE                        33330099
333400         MOVE '5205-WRITE-SEL-QUEUE'                              33340099
333500                                   TO DP013-PARAGRAPH             33350099
333600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          33360099
333700                                   TO DP013-MESSAGE-TEXT(1)       33370099
333800         PERFORM DP013-0000-PROCESS-ABEND                         33380099
333900     END-IF.                                                      33390099
334000 EJECT                                                            33400099
334100*                                                                 33410099
334200******************************************************************33420099
334300** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **33430099
334400** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **33440099
334500** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **33450099
334600** THE USER.                                                    **33460099
334700******************************************************************33470099
334800 6000-REFRESH-PANEL-FROM-TEMP.                                    33480099
334900     IF  ASC-UPDATE-TSQ                                           33490099
335000         SET ASC-NO-TSQ-UPDATE TO TRUE                            33500099
335100         MOVE ZERO                 TO PV-SAVE-ITEM                33510099
335200                                      PV-SEL-QUEUE-ITEM           33520099
335300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        33530099
335400                                   TO PV-HOLD-SELECTED-ITEMS      33540099
335500         MOVE +1                   TO PV-ITEMS-PROCESSED          33550099
335600         EVALUATE TRUE                                            33560099
335700           WHEN ASC-FUNC03-RETURN-YES                             33570099
335800              PERFORM 6200-UPDATE-TSQ                             33580099
335900                   UNTIL PV-ITEMS-PROCESSED >                     33590099
336000                                          PV-HOLD-SELECTED-ITEMS  33600099
336100           WHEN ASC-FUNC04-RETURN-YES                             33610099
336200              PERFORM 6300-UPDATE-TSQ                             33620099
336300                   UNTIL PV-ITEMS-PROCESSED >                     33630099
336400                                          PV-HOLD-SELECTED-ITEMS  33640099
336500           WHEN ASC-FUNC01-RETURN-YES                             33650099
336600              PERFORM 2050-DELETE-LIST-QUEUE                      33660099
336700              MOVE ZEROES  TO ASC-TOTAL-UNITS                     33670099
336800                             PV-TOTAL-CART-PO-ADJ                 33680099
336900              MOVE ASC-TOTAL-CART TO  PV-TOTAL-CART-PO-PREV       33690099
337000              PERFORM 4000-BUILD-INITIAL-PANEL                    33700099
337100*                                                                 33710099
337200              COMPUTE PV-TOTAL-CART-PO-ADJ =                      33720099
337300                       (ASC-TOTAL-CART -                          33730099
337400                              PV-TOTAL-CART-PO-PREV)              33740099
337500              COMPUTE ASC-TOTAL-CART-PO  =                        33750099
337600                       (ASC-TOTAL-CART-PO  +                      33760099
337700                              PV-TOTAL-CART-PO-ADJ)               33770099
337800              PERFORM 9100-READ-SEL-QUEUE                         33780099
337900              MOVE ASC-TOTAL-CART                                 33790099
338000                    TO PC203-PREV-CTN-COUNT (ASC-SEL-SUB)         33800099
338100              MOVE ASC-TOTAL-CART-PO TO                           33810099
338200                       PC203-TOT-CRTNS-PO(ASC-SEL-SUB)            33820099
338300              PERFORM 9200-REWRITE-SEL-QUEUE                      33830099
338400           WHEN OTHER                                             33840099
338500              PERFORM 6100-UPDATE-TSQ                             33850099
338600                   UNTIL PV-ITEMS-PROCESSED >                     33860099
338700                                         PV-HOLD-SELECTED-ITEMS   33870099
338800         END-EVALUATE                                             33880099
338900                                                                  33890099
339000                                                                  33900099
339100         SET ASC-FUNC01-RETURN-NO TO TRUE                         33910099
339200         SET ASC-FUNC03-RETURN-NO TO TRUE                         33920099
339300         SET ASC-FUNC04-RETURN-NO TO TRUE                         33930099
339400                                                                  33940099
339500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         33950099
339600                    ASC-BLOCK-ENTRIES (2)                         33960099
339700     END-IF.                                                      33970099
339800                                                                  33980099
339900*----------------------------------------------------------------*33990099
340000*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *34000099
340100*----------------------------------------------------------------*34010099
340200 6010-DELETE-SEL-QUEUE.                                           34020099
340300     EXEC CICS                                                    34030099
340400         DELETEQ TS                                               34040099
340500             QUEUE (ASC-SEL-QUEUE-NAME)                           34050099
340600             RESP  (PV-CICS-RESP)                                 34060099
340700     END-EXEC.                                                    34070099
340800                                                                  34080099
340900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      34090099
341000         (PV-CICS-RESP = DFHRESP(QIDERR)))                        34100099
341100         CONTINUE                                                 34110099
341200     ELSE                                                         34120099
341300         SET DP013-CICS-ABEND      TO TRUE                        34130099
341400         SET DP013-NO-ROLLBACK     TO TRUE                        34140099
341500         MOVE '6010-DELETE-SEL-QUEUE'                             34150099
341600                                   TO DP013-PARAGRAPH             34160099
341700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         34170099
341800                                   TO DP013-MESSAGE-TEXT (1)      34180099
341900         PERFORM DP013-0000-PROCESS-ABEND                         34190099
342000     END-IF.                                                      34200099
342100*                                                                 34210099
342200*                                                                 34220099
342300*----------------------------------------------------------------*34230099
342400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *34240099
342500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *34250099
342600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *34260099
342700*    THE TEMP QUEUE.                                             *34270099
342800*----------------------------------------------------------------*34280099
342900 6100-UPDATE-TSQ.                                                 34290099
343000     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             34300099
343100     PERFORM 6105-READ-SEL-QUEUE.                                 34310099
343200     PERFORM                                                      34320099
343300         VARYING PC203-IDX                                        34330099
343400         FROM 1 BY 1                                              34340099
343500         UNTIL ((PV-ITEMS-PROCESSED >                             34350099
343600                              PV-HOLD-SELECTED-ITEMS)             34360099
343700         OR (PC203-IDX GREATER THAN PC203-MAX-ITEMS))             34370099
343800         IF  PC203-ACTION-SW (PC203-IDX) > SPACES                 34380099
343900             PERFORM 6110-PROCESS-ITEMS                           34390099
344000         END-IF                                                   34400099
344100         ADD +1                TO PV-ITEMS-PROCESSED              34410099
344200     END-PERFORM.                                                 34420099
344300     PERFORM 6111-WRITE-LIST-QUEUE.                               34430099
344400*                                                                 34440099
344500*                                                                 34450099
344600*----------------------------------------------------------------*34460099
344700*    READ THE LIST QUEUE RECORD.                                 *34470099
344800*----------------------------------------------------------------*34480099
344900 6105-READ-SEL-QUEUE.                                             34490099
345000     EXEC CICS                                                    34500099
345100          READQ TS                                                34510099
345200              QUEUE (ASC-SEL-QUEUE-NAME)                          34520099
345300              INTO  (PC203-DC-SELECT-RECORD)                      34530099
345400              ITEM  (PV-SEL-QUEUE-ITEM)                           34540099
345500              RESP  (PV-CICS-RESP)                                34550099
345600     END-EXEC.                                                    34560099
345700                                                                  34570099
345800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34580099
345900         CONTINUE                                                 34590099
346000     ELSE                                                         34600099
346100         SET DP013-CICS-ABEND      TO  TRUE                       34610099
346200         SET DP013-NO-ROLLBACK     TO  TRUE                       34620099
346300         MOVE '6105-READ-SEL-QUEUE'                               34630099
346400                                   TO  DP013-PARAGRAPH            34640099
346500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           34650099
346600                                   TO  DP013-MESSAGE-TEXT(1)      34660099
346700                                                                  34670099
346800         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              34680099
346900         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          34690099
347000         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  34700099
347100         STRING ' QUEUE 1 TERM ID-'     DELIMITED BY SIZE         34710099
347200                 PV-SEL-TERM-ID       DELIMITED BY SIZE           34720099
347300                ' QUEUE TASK-'        DELIMITED BY SIZE           34730099
347400                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           34740099
347500                ' QUEUE SEQ-'         DELIMITED BY SIZE           34750099
347600                 PV-SEL-SEQ           DELIMITED BY SIZE           34760099
347700                                 INTO  DP013-MESSAGE-TEXT(2)      34770099
347800         MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID         34780099
347900         MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER     34790099
348000         MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ             34800099
348100         STRING ' QUEUE 2 TERM ID-'     DELIMITED BY SIZE         34810099
348200                 PV-SEL-TERM-ID       DELIMITED BY SIZE           34820099
348300                ' QUEUE TASK-'        DELIMITED BY SIZE           34830099
348400                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           34840099
348500                ' QUEUE SEQ-'         DELIMITED BY SIZE           34850099
348600                 PV-SEL-SEQ           DELIMITED BY SIZE           34860099
348700                                 INTO  DP013-MESSAGE-TEXT(3)      34870099
348800         PERFORM DP013-0000-PROCESS-ABEND                         34880099
348900     END-IF.                                                      34890099
349000 EJECT                                                            34900099
349100*                                                                 34910099
349200*----------------------------------------------------------------*34920099
349300 6200-UPDATE-TSQ.                                                 34930099
349400                                                                  34940099
349500     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  34950099
349600     PERFORM 6205-READ-SEL-QUEUE.                                 34960099
349700                                                                  34970099
349800     PERFORM                                                      34980099
349900       VARYING SU010-IDX FROM 1 BY 1                              34990099
350000         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     35000099
350100            OR (SU010-IDX > SU010-MAX-ITEMS))                     35010099
350200                                                                  35020099
350300         IF SU010-ACTION-SW (SU010-IDX) > SPACE                   35030099
350400             PERFORM 6210-PROCESS-ITEMS                           35040099
350500         END-IF                                                   35050099
350600                                                                  35060099
350700         ADD +1 TO PV-ITEMS-PROCESSED                             35070099
350800     END-PERFORM.                                                 35080099
350900                                                                  35090099
351000     PERFORM 6111-WRITE-LIST-QUEUE.                               35100099
351100                                                                  35110099
351200*----------------------------------------------------------------*35120099
351300*    READ THE LIST QUEUE RECORD.                                  35130099
351400*----------------------------------------------------------------*35140099
351500 6205-READ-SEL-QUEUE.                                             35150099
351600                                                                  35160099
351700     EXEC CICS                                                    35170099
351800          READQ TS                                                35180099
351900              QUEUE (ASC-SEL-QUEUE-NAME)                          35190099
352000              INTO  (SU010-SELECT-RECORD)                         35200099
352100              ITEM  (PV-SEL-QUEUE-ITEM)                           35210099
352200              RESP  (PV-CICS-RESP)                                35220099
352300     END-EXEC.                                                    35230099
352400                                                                  35240099
352500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           35250099
352600         CONTINUE                                                 35260099
352700     ELSE                                                         35270099
352800         SET DP013-CICS-ABEND       TO  TRUE                      35280099
352900         SET DP013-NO-ROLLBACK      TO  TRUE                      35290099
353000         MOVE '6205-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           35300099
353100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           35310099
353200                                    TO  DP013-MESSAGE-TEXT(1)     35320099
353300                                                                  35330099
353400         PERFORM DP013-0000-PROCESS-ABEND                         35340099
353500     END-IF.                                                      35350099
353600                                                                  35360099
353700*                                                                 35370099
353800*----------------------------------------------------------------*35380099
353900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*35390099
354000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*35400099
354100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *35410099
354200*----------------------------------------------------------------*35420099
354300 6110-PROCESS-ITEMS.                                              35430099
354400                                                                  35440099
354500     COMPUTE PV-ITEM = 1 + ((PC203-ITEM (PC203-IDX) - 1)          35450099
354600                     / PC-ITEMS-PER-PANEL).                       35460099
354700                                                                  35470099
354800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           35480099
354900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          35490099
355000             PERFORM 6111-WRITE-LIST-QUEUE                        35500099
355100         END-IF                                                   35510099
355200         MOVE PV-ITEM          TO PV-SAVE-ITEM                    35520099
355300                                                                  35530099
355400         PERFORM 6112-READ-LIST-QUEUE                             35540099
355500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               35550099
355600             CONTINUE                                             35560099
355700         END-IF                                                   35570099
355800     END-IF.                                                      35580099
355900                                                                  35590099
356000     COMPUTE PV-SUB = (PC203-ITEM (PC203-IDX)                     35600099
356100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              35610099
356200     SET LQW-DESELECT (PV-SUB) TO    TRUE                         35620099
356300     MOVE LQW-SELECTED-SW (PV-SUB)                                35630099
356400                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  35640099
356500     EVALUATE TRUE                                                35650099
356600         WHEN PC203-INQ (PC203-IDX)                               35660099
356700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             35670099
356800                                                                  35680099
356900         WHEN PC203-UPD (PC203-IDX)                               35690099
357000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             35700099
357100                                                                  35710099
357200         WHEN PC203-DEL (PC203-IDX)                               35720099
357300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             35730099
357400                                                                  35740099
357500         WHEN PC203-ERR (PC203-IDX)                               35750099
357600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             35760099
357700     END-EVALUATE.                                                35770099
357800                                                                  35780099
357900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                35790099
358000*                                                                 35800099
358100*                                                                 35810099
358200*----------------------------------------------------------------*35820099
358300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN S550.             *35830099
358400*----------------------------------------------------------------*35840099
358500 6111-WRITE-LIST-QUEUE.                                           35850099
358600     EXEC CICS                                                    35860099
358700         WRITEQ TS                                                35870099
358800             QUEUE (ASC-LIST-QUEUE-NAME)                          35880099
358900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     35890099
359000             ITEM  (PV-SAVE-ITEM)                                 35900099
359100             REWRITE                                              35910099
359200             RESP  (PV-CICS-RESP)                                 35920099
359300     END-EXEC.                                                    35930099
359400                                                                  35940099
359500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35950099
359600         CONTINUE                                                 35960099
359700     ELSE                                                         35970099
359800         SET DP013-CICS-ABEND  TO  TRUE                           35980099
359900         SET DP013-NO-ROLLBACK TO  TRUE                           35990099
360000         MOVE '6111-WRITE-LIST-QUEUE'                             36000099
360100                               TO  DP013-PARAGRAPH                36010099
360200         MOVE 'ATTEMPTING TO WRITE LIST QUEUE'                    36020099
360300                               TO  DP013-MESSAGE-TEXT(1)          36030099
360400         PERFORM DP013-0000-PROCESS-ABEND                         36040099
360500     END-IF.                                                      36050099
360600                                                                  36060099
360700 EJECT                                                            36070099
360800*                                                                 36080099
360900*                                                                 36090099
361000*----------------------------------------------------------------*36100099
361100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*36110099
361200*----------------------------------------------------------------*36120099
361300 6112-READ-LIST-QUEUE.                                            36130099
361400     EXEC CICS                                                    36140099
361500         READQ TS                                                 36150099
361600             QUEUE (ASC-LIST-QUEUE-NAME)                          36160099
361700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     36170099
361800             ITEM  (PV-ITEM)                                      36180099
361900             RESP  (PV-CICS-RESP)                                 36190099
362000     END-EXEC.                                                    36200099
362100                                                                  36210099
362200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36220099
362300         CONTINUE                                                 36230099
362400     ELSE                                                         36240099
362500         SET DP013-CICS-ABEND      TO TRUE                        36250099
362600         SET DP013-NO-ROLLBACK     TO TRUE                        36260099
362700         MOVE '6112-READ-LIST-QUEUE'                              36270099
362800                                   TO DP013-PARAGRAPH             36280099
362900         MOVE 'ATTEMPTING TO READ LIST QUEUE'                     36290099
363000                                   TO DP013-MESSAGE-TEXT(1)       36300099
363100         PERFORM DP013-0000-PROCESS-ABEND                         36310099
363200     END-IF.                                                      36320099
363300*                                                                 36330099
363400*----------------------------------------------------------------*36340099
363500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*36350099
363600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*36360099
363700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.            36370099
363800*----------------------------------------------------------------*36380099
363900 6210-PROCESS-ITEMS.                                              36390099
364000                                                                  36400099
364100     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          36410099
364200                     / PC-ITEMS-PER-PANEL).                       36420099
364300                                                                  36430099
364400     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            36440099
364500         IF PV-SAVE-ITEM NOT EQUAL ZERO                           36450099
364600             PERFORM 6111-WRITE-LIST-QUEUE                        36460099
364700         END-IF                                                   36470099
364800                                                                  36480099
364900         MOVE PV-ITEM TO PV-SAVE-ITEM                             36490099
365000                                                                  36500099
365100         PERFORM 6112-READ-LIST-QUEUE                             36510099
365200                                                                  36520099
365300         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                36530099
365400             CONTINUE                                             36540099
365500         END-IF                                                   36550099
365600     END-IF.                                                      36560099
365700                                                                  36570099
365800     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     36580099
365900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              36590099
366000                                                                  36600099
366100     SET LQW-DESELECT (PV-SUB) TO TRUE                            36610099
366200     MOVE LQW-SELECTED-SW (PV-SUB)                                36620099
366300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  36630099
366400                                                                  36640099
366500     EVALUATE TRUE                                                36650099
366600         WHEN SU010-INQ (SU010-IDX)                               36660099
366700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             36670099
366800                                                                  36680099
366900         WHEN SU010-UPD (SU010-IDX)                               36690099
367000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             36700099
367100                                                                  36710099
367200         WHEN SU010-DEL (SU010-IDX)                               36720099
367300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             36730099
367400                                                                  36740099
367500         WHEN SU010-ERR (SU010-IDX)                               36750099
367600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             36760099
367700     END-EVALUATE.                                                36770099
367800                                                                  36780099
367900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                36790099
368000                                                                  36800099
368100*----------------------------------------------------------------*36810099
368200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *36820099
368300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *36830099
368400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *36840099
368500*    THE TEMP QUEUE.                                             *36850099
368600*----------------------------------------------------------------*36860099
368700 6300-UPDATE-TSQ.                                                 36870099
368800     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             36880099
368900     PERFORM 6305-READ-SEL-QUEUE.                                 36890099
369000     PERFORM                                                      36900099
369100         VARYING PC206-IDX                                        36910099
369200         FROM 1 BY 1                                              36920099
369300         UNTIL ((PV-ITEMS-PROCESSED >                             36930099
369400                              PV-HOLD-SELECTED-ITEMS)             36940099
369500         OR (PC206-IDX GREATER THAN PC206-MAX-ITEMS))             36950099
369600         IF  PC206-ACTION-SW (PC206-IDX) > SPACES                 36960099
369700             PERFORM 6310-PROCESS-ITEMS                           36970099
369800         END-IF                                                   36980099
369900         ADD +1                TO PV-ITEMS-PROCESSED              36990099
370000     END-PERFORM.                                                 37000099
370100     PERFORM 6111-WRITE-LIST-QUEUE.                               37010099
370200*                                                                 37020099
370300*                                                                 37030099
370400*----------------------------------------------------------------*37040099
370500*    READ THE LIST QUEUE RECORD.                                 *37050099
370600*----------------------------------------------------------------*37060099
370700 6305-READ-SEL-QUEUE.                                             37070099
370800     EXEC CICS                                                    37080099
370900          READQ TS                                                37090099
371000              QUEUE (ASC-SEL-QUEUE-NAME)                          37100099
371100              INTO  (PC206-DC-SELECT-RECORD)                      37110099
371200              ITEM  (PV-SEL-QUEUE-ITEM)                           37120099
371300              RESP  (PV-CICS-RESP)                                37130099
371400     END-EXEC.                                                    37140099
371500                                                                  37150099
371600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37160099
371700         CONTINUE                                                 37170099
371800     ELSE                                                         37180099
371900         SET DP013-CICS-ABEND      TO  TRUE                       37190099
372000         SET DP013-NO-ROLLBACK     TO  TRUE                       37200099
372100         MOVE '6305-READ-SEL-QUEUE'                               37210099
372200                                   TO  DP013-PARAGRAPH            37220099
372300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37230099
372400                                   TO  DP013-MESSAGE-TEXT(1)      37240099
372500                                                                  37250099
372600         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              37260099
372700         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          37270099
372800         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  37280099
372900         STRING ' QUEUE 1 TERM ID-'     DELIMITED BY SIZE         37290099
373000                 PV-SEL-TERM-ID       DELIMITED BY SIZE           37300099
373100                ' QUEUE TASK-'        DELIMITED BY SIZE           37310099
373200                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           37320099
373300                ' QUEUE SEQ-'         DELIMITED BY SIZE           37330099
373400                 PV-SEL-SEQ           DELIMITED BY SIZE           37340099
373500                                 INTO  DP013-MESSAGE-TEXT(2)      37350099
373600         MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID         37360099
373700         MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER     37370099
373800         MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ             37380099
373900         STRING ' QUEUE 2 TERM ID-'     DELIMITED BY SIZE         37390099
374000                 PV-SEL-TERM-ID       DELIMITED BY SIZE           37400099
374100                ' QUEUE TASK-'        DELIMITED BY SIZE           37410099
374200                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           37420099
374300                ' QUEUE SEQ-'         DELIMITED BY SIZE           37430099
374400                 PV-SEL-SEQ           DELIMITED BY SIZE           37440099
374500                                 INTO  DP013-MESSAGE-TEXT(3)      37450099
374600         PERFORM DP013-0000-PROCESS-ABEND                         37460099
374700     END-IF.                                                      37470099
374800 EJECT                                                            37480099
374900*----------------------------------------------------------------*37490099
375000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*37500099
375100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*37510099
375200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *37520099
375300*----------------------------------------------------------------*37530099
375400 6310-PROCESS-ITEMS.                                              37540099
375500                                                                  37550099
375600     COMPUTE PV-ITEM = 1 + ((PC206-ITEM (PC206-IDX) - 1)          37560099
375700                     / PC-ITEMS-PER-PANEL).                       37570099
375800                                                                  37580099
375900     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           37590099
376000         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          37600099
376100             PERFORM 6111-WRITE-LIST-QUEUE                        37610099
376200         END-IF                                                   37620099
376300         MOVE PV-ITEM          TO PV-SAVE-ITEM                    37630099
376400                                                                  37640099
376500         PERFORM 6112-READ-LIST-QUEUE                             37650099
376600         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               37660099
376700             CONTINUE                                             37670099
376800         END-IF                                                   37680099
376900     END-IF.                                                      37690099
377000                                                                  37700099
377100     COMPUTE PV-SUB = (PC206-ITEM (PC206-IDX)                     37710099
377200                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              37720099
377300     SET LQW-DESELECT (PV-SUB) TO    TRUE                         37730099
377400     MOVE LQW-SELECTED-SW (PV-SUB)                                37740099
377500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  37750099
377600     EVALUATE TRUE                                                37760099
377700         WHEN PC206-INQ (PC206-IDX)                               37770099
377800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             37780099
377900                                                                  37790099
378000         WHEN PC206-UPD (PC206-IDX)                               37800099
378100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             37810099
378200                                                                  37820099
378300         WHEN PC206-DEL (PC206-IDX)                               37830099
378400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             37840099
378500                                                                  37850099
378600         WHEN PC206-ERR (PC206-IDX)                               37860099
378700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             37870099
378800     END-EVALUATE.                                                37880099
378900                                                                  37890099
379000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                37900099
379100*                                                                 37910099
379200*                                                                 37920099
379300*                                                                 37930099
379400*----------------------------------------------------------------*37940099
379500*  CREATE A RANDOM NBR FOR SMOOTH REQUEST TABLE                   37950099
379600*----------------------------------------------------------------*37960099
379700 7000-CREATE-RANDOM-NBR.                                          37970099
379800     INITIALIZE PV-RANDOM-NBR-R.                                  37980099
379900     CALL PC-RANDOM-PGM USING DFHEIBLK                            37990099
380000                              DFHCOMMAREA                         38000099
380100                              DP902-RANDNBR-ROUTINE-FIELDS.       38010099
380200                                                                  38020099
380300     IF DP902-SUCCESSFUL                                          38030099
380400         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          38040099
380500         MOVE PV-RANDOM-1-8          TO PV-RANDOM-NBR-R           38050099
380600         SET  PS-TRANS-ID-DUP        TO TRUE                      38060099
380700         PERFORM 7250-NOT-DUP-RNDM                                38070099
380800                 UNTIL PS-TRANS-ID-NOT-DUP                        38080099
380900                                                                  38090099
381000     ELSE                                                         38100099
381100         SET DP013-CICS-ABEND  TO  TRUE                           38110099
381200         SET DP013-NO-ROLLBACK TO  TRUE                           38120099
381210         MOVE '7000-CREATE-RANDOM-NBR'                            38121099
381220                               TO  DP013-PARAGRAPH                38122099
381230         MOVE 'ATTEMPTING TO CREATE RANDM NUMBR'                  38123099
381240                               TO  DP013-MESSAGE-TEXT(1)          38124099
381250         PERFORM DP013-0000-PROCESS-ABEND                         38125099
381260     END-IF.                                                      38126099
381270*                                                                 38127099
381280*----------------------------------------------------------------*38128099
381281*  CHECK TO SEE IF RANDOM NUMBER ALREADY EXISTS                   38128199
381282*----------------------------------------------------------------*38128299
381283 7250-NOT-DUP-RNDM.                                               38128399
381284                                                                  38128499
381285     MOVE PV-RANDOM-NBR-R   TO  DK-RANDOM-NBR.                    38128599
381286                                                                  38128699
381287     EXEC SQL                                                     38128799
381288          SELECT LBL_REQ_TRN_ID                                   38128899
381289          INTO  :LBTKHS-LBL-REQ-TRN-ID                            38128999
381290          FROM   TLBTKHS                                          38129099
381291          WHERE  LBL_REQ_TRN_ID  = :DK-RANDOM-NBR                 38129199
381292     END-EXEC.                                                    38129299
381293                                                                  38129399
381294     EVALUATE TRUE                                                38129499
381295         WHEN SQLCODE = ZERO                                      38129599
381296              ADD  1  TO  PV-RANDOM-NBR-R                         38129699
381297              SET  PS-TRANS-ID-DUP    TO  TRUE                    38129799
381298                                                                  38129899
381299         WHEN SQLCODE = +100                                      38129999
381300             SET PS-TRANS-ID-NOT-DUP  TO  TRUE                    38130099
381301             SET PS-VALID-TRANS-ID    TO  TRUE                    38130199
381302                                                                  38130299
381303         WHEN OTHER                                               38130399
381304              MOVE '7250-NOT-DUP-RNDM   '                         38130499
381305                               TO DP013-PARAGRAPH                 38130599
381306              MOVE 'CHECK FOR DUPLICATE '                         38130699
381307                               TO DP013-MESSAGE-TEXT (1)          38130799
381308              MOVE SQLCA       TO DP013-SQLCA                     38130899
381309              SET DP013-DB2-ABEND                                 38130999
381310                               TO TRUE                            38131099
381311              PERFORM DP013-0000-PROCESS-ABEND                    38131199
381312                                                                  38131299
381313     END-EVALUATE.                                                38131399
381314                                                                  38131499
381315*-----------------------------------------------------------------38131599
381316* DETERMINE LAST ACTIVITY FOR CARTON (CHECK IN REVERSE ORDER)     38131699
381317*-----------------------------------------------------------------38131799
381318 8000-DETERMINE-LAST-ACTIVITY.                                    38131899
381319                                                                  38131999
381320     INITIALIZE  PC046-COMMAREA-REC.                              38132099
381321     SET   PC046-FROM-SMOOTHING  TO  TRUE.                        38132199
381322     MOVE  SUT00024-SHIPT-UNT-ID TO  PC046-CARTON-ID.             38132299
381323                                                                  38132399
381324                                                                  38132499
381325     CALL PC046-CARTON-STATUS-MODULE                              38132599
381326             USING DFHEIBLK                                       38132699
381327             PC046-COMMAREA                                       38132799
381328             PC046-COMMAREA-REC                                   38132899
381329     END-CALL                                                     38132999
381330                                                                  38133099
381340     PERFORM 8100-EVALUATE-CARTON-STATUS.                         38134099
381350                                                                  38135099
381360 8100-EVALUATE-CARTON-STATUS.                                     38136099
381370                                                                  38137099
381371      EVALUATE TRUE                                               38137199
381372         WHEN PC046-INVALID-CRTN                                  38137299
381373              MOVE 'CARTON STATUS ERROR' TO  ASC-CART-STATUS      38137399
381374                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38137499
381375              SET ASC-INACTIVATED (ASC-BLK-SUB ASC-ITEM-SUB)      38137599
381376                                       TO TRUE                    38137699
381377         WHEN PC046-SCANNED-OFF-TRLR                              38137799
381378              MOVE 'SCANNED OFF TRAILER' TO  ASC-CART-STATUS      38137899
381379                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38137999
381380         WHEN PC046-SCANNED-ONTO-TRLR                             38138099
381381              MOVE 'SCANNED ON TRAILER' TO  ASC-CART-STATUS       38138199
381382                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38138299
381383              SET ASC-SCANNED-ONTO-TRLR(ASC-BLK-SUB ASC-ITEM-SUB) 38138399
381384                                       TO TRUE                    38138499
381385         WHEN PC046-DIVERTED-TO-TRLR                              38138599
381386              MOVE 'DIVERTED TO TRAILER' TO  ASC-CART-STATUS      38138699
381387                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38138799
381388              SET ASC-DIVERTED-TO-TRLR (ASC-BLK-SUB ASC-ITEM-SUB) 38138899
381389                                       TO TRUE                    38138999
381390         WHEN PC046-LOADED-ONTO-TRLR                              38139099
381391              MOVE 'LOADED ONTO TRAILER' TO  ASC-CART-STATUS      38139199
381392                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38139299
381393              SET ASC-LOADED-ONTO-TRLR (ASC-BLK-SUB ASC-ITEM-SUB) 38139399
381394                                       TO TRUE                    38139499
381395         WHEN OTHER                                               38139599
381396              EVALUATE SUT00024-CART-SRC-CDE                      38139699
381397                WHEN 'SMO'                                        38139799
381398                   MOVE 'CREATED BY SMOOTHNG'                     38139899
381399                            TO  ASC-CART-STATUS                   38139999
381400                           (ASC-BLK-SUB ASC-ITEM-SUB)             38140099
381410                WHEN 'ASN'                                        38141099
381411                   MOVE 'UCC128 VENDOR DATA '                     38141199
381412                          TO  ASC-CART-STATUS                     38141299
381413                         (ASC-BLK-SUB ASC-ITEM-SUB)               38141399
381414                WHEN 'CPS'                                        38141499
381415                   MOVE 'CREATED BY CASEPACK'                     38141599
381416                          TO  ASC-CART-STATUS                     38141699
381417                         (ASC-BLK-SUB ASC-ITEM-SUB)               38141799
381418                WHEN 'FXR'                                        38141899
381419                   MOVE 'CREATD BY FAST XFER'                     38141999
381420                          TO  ASC-CART-STATUS                     38142099
381421                         (ASC-BLK-SUB ASC-ITEM-SUB)               38142199
381422                WHEN 'P2L'                                        38142299
381423                   MOVE 'CREATED BY P2L  '                        38142399
381424                          TO  ASC-CART-STATUS                     38142499
381425                         (ASC-BLK-SUB ASC-ITEM-SUB)               38142599
381426                WHEN 'RDM'                                        38142699
381427                   MOVE 'CREATED BY RDM     '                     38142799
381428                          TO  ASC-CART-STATUS                     38142899
381429                         (ASC-BLK-SUB ASC-ITEM-SUB)               38142999
381430                WHEN 'RCV'                                        38143099
381431                   MOVE 'CREATED BY RECVING '                     38143199
381432                          TO  ASC-CART-STATUS                     38143299
381433                         (ASC-BLK-SUB ASC-ITEM-SUB)               38143399
381434                WHEN 'MSC'                                        38143499
381435                   MOVE 'CARTON BUILD    '                        38143599
381436                          TO  ASC-CART-STATUS                     38143699
381437                         (ASC-BLK-SUB ASC-ITEM-SUB)               38143799
381438                WHEN 'MST'                                        38143899
381439                   MOVE 'MASTER CONTAINER  '                      38143999
381440                          TO  ASC-CART-STATUS                     38144099
381441                         (ASC-BLK-SUB ASC-ITEM-SUB)               38144199
381442                WHEN 'JWL'                                        38144299
381443                   MOVE 'CREATED BY FINE JWL'                     38144399
381444                          TO  ASC-CART-STATUS                     38144499
381445                         (ASC-BLK-SUB ASC-ITEM-SUB)               38144599
381446                WHEN 'DMG'                                        38144699
381447                   MOVE 'DMG BY CRTN ADJUST '                     38144799
381448                          TO  ASC-CART-STATUS                     38144899
381449                         (ASC-BLK-SUB ASC-ITEM-SUB)               38144999
381450              END-EVALUATE                                        38145099
381451      END-EVALUATE.                                               38145199
381452                                                                  38145299
381453                                                                  38145399
381454*----------------------------------------------------------------*38145499
381455* CHECK VERIFIED STATUS                                          *38145599
381456*----------------------------------------------------------------*38145699
381457                                                                  38145799
381458 8200-CHECK-VERIFIED-STATUS.                                      38145899
381460                                                                  38146099
381470     INITIALIZE PV-DB2-COUNT-CRTNS.                               38147099
381480                                                                  38148099
381490     EXEC SQL                                                     38149099
381500              SELECT COUNT(DISTINCT(B.SHIPT_UNT_ID))              38150099
381600              INTO :PV-DB2-COUNT-CRTNS                            38160099
381700              FROM  TRECITM A                                     38170099
381710                  , SUT_OTBND_UPC B                               38171099
381720              WHERE  A.ORD_NBR          =  B.TRN_NBR              38172099
381730                AND  A.REC_SEQ_NBR      =  B.RCVR_SEQ_NBR         38173099
381740                AND  A.ORD_LNE_NBR      =  B.TRN_LNE_NBR          38174099
381750                AND  A.ORD_NBR          =  :DK-PO-NBR             38175099
381751                AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR        38175199
381752                AND  B.SHIPT_UNT_ID     =  :DK-CARTON-ID          38175299
381753                AND  A.STATUS_CDE       = 'VE'                    38175399
381754                AND  A.VER_STATUS_CDE   = 'A'                     38175499
381755     END-EXEC                                                     38175599
381756*                                                                 38175699
381757     EVALUATE TRUE                                                38175799
381758         WHEN SQLCODE = ZERO                                      38175899
381759             IF PV-DB2-COUNT-CRTNS > 0                            38175999
381760                SET ASC-VERIFD-LNE-YES (ASC-BLK-SUB ASC-ITEM-SUB) 38176099
381770                                       TO TRUE                    38177099
381771                MOVE 'VERIFIED LINES EXIST' TO ASC-STATUS-MESSAGE 38177199
381772             ELSE                                                 38177299
381773                SET ASC-VERIFD-LNE-NO (ASC-BLK-SUB ASC-ITEM-SUB)  38177399
381774                                       TO TRUE                    38177499
381775             END-IF                                               38177599
381776         WHEN SQLWARN0 NOT = SPACES                               38177699
381777         WHEN SQLCODE < ZERO                                      38177799
381778         WHEN SQLCODE > ZERO                                      38177899
381779             MOVE '4350-GET-TOTAL-CRTNS'                          38177999
381780                               TO DP013-PARAGRAPH                 38178099
381781             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  38178199
381782                               TO DP013-MESSAGE-TEXT (1)          38178299
381783             MOVE SQLCA        TO DP013-SQLCA                     38178399
381784             MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)        38178499
381785             SET DP013-DB2-ABEND                                  38178599
381786                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38178699
381787             PERFORM DP013-0000-PROCESS-ABEND                     38178799
381788     END-EVALUATE.                                                38178899
381789                                                                  38178999
381790*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 38179099
381791* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *38179199
381792*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 38179299
381793 9100-READ-SEL-QUEUE.                                             38179399
381794     EXEC CICS                                                    38179499
381795         READQ TS                                                 38179599
381796             QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                      38179699
381797             INTO  (PC203-DC-SELECT-RECORD)                       38179799
381798             ITEM  (ASC-SEL-ITEM)                                 38179899
381799             RESP  (PV-CICS-RESP)                                 38179999
381800     END-EXEC.                                                    38180099
381900***GB                                                             38190099
382000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL) OR                     38200099
382100        (PV-CICS-RESP = DFHRESP(QIDERR))                          38210099
382200         CONTINUE                                                 38220099
382300     ELSE                                                         38230099
382400         SET DP013-LOGIC-ABEND                                    38240099
382500             DP013-NO-ROLLBACK   TO   TRUE                        38250099
382600         MOVE '9100-READ-SEL-QUEUE'                               38260099
382700                                 TO   DP013-PARAGRAPH             38270099
382800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   38280099
382900                                 TO   DP013-MESSAGE-TEXT (1)      38290099
383000         PERFORM DP013-0000-PROCESS-ABEND                         38300099
383100     END-IF.                                                      38310099
383200*                                                                 38320099
383300*                                                                 38330099
383400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*38340099
383500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *38350099
383600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 38360099
383700 9200-REWRITE-SEL-QUEUE.                                          38370099
383800                                                                  38380099
383900     EXEC CICS                                                    38390099
384000          WRITEQ TS                                               38400099
384100              QUEUE  (ASC-SEL-QUEUE-NAME-ORIG)                    38410099
384200              FROM   (PC203-DC-SELECT-RECORD)                     38420099
384300              ITEM   (ASC-SEL-ITEM)                               38430099
384400              RESP   (PV-CICS-RESP)                               38440099
384500              REWRITE                                             38450099
384600     END-EXEC.                                                    38460099
384700                                                                  38470099
384800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL) OR                    38480099
384900        (PV-CICS-RESP = DFHRESP(QIDERR))                          38490099
385000         CONTINUE                                                 38500099
385100     ELSE                                                         38510099
385200         SET DP013-CICS-ABEND                                     38520099
385300             DP013-NO-ROLLBACK     TO TRUE                        38530099
385400         MOVE '9200-REWRITE-SEL-QUEUE'                            38540099
385500                                   TO DP013-PARAGRAPH             38550099
385600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   38560099
385700                                   TO DP013-MESSAGE-TEXT (1)      38570099
385800         PERFORM DP013-0000-PROCESS-ABEND                         38580099
385900     END-IF.                                                      38590099
386000*                                                                 38600099
386100*                                                                 38610099
386200*----------------------------------------------------------------*38620099
386300*    ABEND PROCESSOR MODULE                                      *38630099
386400*----------------------------------------------------------------*38640099
386500     COPY DPPD013.                                                38650099
386600*----------------------------------------------------------------*38660099
386700*----------------------------------------------------------------*38670099
