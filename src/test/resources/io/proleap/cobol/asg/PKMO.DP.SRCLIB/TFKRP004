      ******************************************************************00010016
       IDENTIFICATION DIVISION.                                         00020016
      ******************************************************************00030016
                                                                        00040016
       PROGRAM-ID.             TFKRP004.                                00050055
       AUTHOR.                 KOHLS.                                   00060055
       INSTALLATION.           KOHLS.                                   00070016
       DATE-WRITTEN            DECEMBER, 2005                           00080055
       DATE-COMPILED.                                                   00090016
                                                                        00100016
      ******************************************************************00110016
      *      THIS PROGRAM PROCESSES THE INVALID ITEM TRANSFER FILE      00120056
      *  TO CREATE THE INVALID ITEM TRANSFER REPORT.                    00130056
      ******************************************************************00140016
SR3403* DATE 03/02/12 JALAJ KUMAR                WR#03403               00150082
SR3403* LARGE RETAIL AMOUNT FIELD EXPANSION                             00151082
      ******************************************************************00160016
       ENVIRONMENT DIVISION.                                            00170016
      ******************************************************************00180016
                                                                        00190016
       CONFIGURATION SECTION.                                           00200016
                                                                        00210016
       SOURCE-COMPUTER.        IBM-3090.                                00220016
       OBJECT-COMPUTER.        IBM-3090.                                00230016
                                                                        00240016
       INPUT-OUTPUT SECTION.                                            00250016
                                                                        00260016
       FILE-CONTROL.                                                    00270016
                                                                        00280016
           SELECT INVALID-ITEM-FILE                                     00290016
               ASSIGN TO INP01.                                         00300016
                                                                        00310016
           SELECT INVALID-ITEM-REPORT                                   00350016
               ASSIGN TO RPT01.                                         00360016
                                                                        00370016
      ******************************************************************00380016
       DATA DIVISION.                                                   00390016
      ******************************************************************00400016
                                                                        00410016
       FILE SECTION.                                                    00420016
                                                                        00430016
       FD  INVALID-ITEM-FILE                                            00440016
           RECORDING MODE IS F                                          00450016
           LABEL RECORDS ARE STANDARD                                   00460016
           BLOCK CONTAINS 0 RECORDS.                                    00470016
                                                                        00480016
       01  INVALID-ITEM-RECORD                 PIC X(112).              00491062
                                                                        00500016
       FD  INVALID-ITEM-REPORT                                          00580016
           RECORDING MODE IS F                                          00590016
           LABEL RECORDS ARE STANDARD                                   00600016
           BLOCK CONTAINS 0 RECORDS.                                    00610016
                                                                        00620016
       01  INVALID-ITEM-LINE                   PIC X(133).              00630056
                                                                        00640016
      ******************************************************************00650016
       WORKING-STORAGE SECTION.                                         00660016
      ******************************************************************00670016
                                                                        00680016
      *                                                                 00690016
      *  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                   00700016
      *                                                                 00710016
           COPY DPWS132O.                                               00720016
                                                                        00730016
      *                                                                 00740016
      *  RECORD LAYOUT FOR THE INVALID ITEM FILE                        00750016
      *                                                                 00760016
           COPY TFRD057.                                                00770058
                                                                        00780016
                                                                        00830016
      *                                                                 00990016
      *  DB2 FORMATTED ERROR MESSAGE                                    01000016
      *                                                                 01010016
           COPY DPWS004.                                                01020016
      *                                                                 01020163
      * PARAMETER LIST FOR THE CALENDAR ROUTINE                         01021063
      *                                                                 01021163
           COPY DPWS500.                                                01022063
                                                                        01030016
       01  ABEND-CODE                          PIC S9(04)  VALUE +0     01040016
                                                           COMP SYNC.   01050016
                                                                        01060016
       01  CD-CURRENT-DATE.                                             01070016
           05  CD-CURRENT-YEAR                 PIC  9(02)  VALUE ZEROS. 01080016
           05  CD-CURRENT-MONTH                PIC  9(02)  VALUE ZEROS. 01090016
           05  CD-CURRENT-DAY                  PIC  9(02)  VALUE ZEROS. 01100016
                                                                        01110016
       01  CT-CURRENT-TIME.                                             01120016
           05  CT-CURRENT-HOUR                 PIC  9(02)  VALUE ZEROS. 01130016
           05  CT-CURRENT-MINUTE               PIC  9(02)  VALUE ZEROS. 01140016
           05  FILLER                          PIC  9(04)  VALUE ZEROS. 01150016
                                                                        01150164
       01 DF-FORMAT-DATE.                                               01151065
           05  DF-FORMAT-DATE-MM               PIC 9(02) VALUE ZEROS.   01152065
           05  FILLER                          PIC X(01) VALUE '/'.     01153065
           05  DF-FORMAT-DATE-DD               PIC 9(02) VALUE ZEROS.   01154065
           05  FILLER                          PIC X(01) VALUE '/'.     01155065
           05  DF-FORMAT-DATE-YY               PIC 9(02) VALUE ZEROS.   01156065
                                                                        01160016
       01  CK-CURRENT-KEY-AREA.                                         01170016
           05  CK-TYP-1ST-LNE-DESC             PIC  X(18)  VALUE SPACE. 01191059
           05  CK-TYP-2ND-LNE-DESC             PIC  X(18)  VALUE SPACE. 01192059
                                                                        01200016
       01  DL-DETAIL-LINE.                                              01210016
           05  DL-TRANSFER-TYPE                PIC  X(20)  VALUE SPACE. 01220056
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01221056
           05  DL-XFER-NBR.                                             01230016
               10  DL-XFER-STR-NBR             PIC  9(04)  VALUE ZEROS. 01241056
               10  DL-DASH-ONE                 PIC  X(01)  VALUE '-'.   01250016
               10  DL-XFER-STR-SEQ-NBR         PIC  9(06)  VALUE ZEROS. 01260016
           05  FILLER                          PIC  X(04)  VALUE SPACE. 01270016
           05  DL-XFER-LNE-NBR                 PIC  9(03)  VALUE ZEROS. 01280016
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01290016
           05  DL-DEPT                         PIC  999    VALUE ZEROS. 01359079
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01359179
           05  DL-SUBCLASS                     PIC  999    VALUE ZEROS. 01359279
           05  FILLER                          PIC  X(07)  VALUE SPACE. 01362081
           05  DL-XFER-QTY                     PIC  ZZ9    VALUE ZEROS. 01370016
SR3403     05  FILLER                          PIC  X(02)  VALUE SPACE. 01381087
SR3403     05  DL-XFER-PRICE                   PIC  ZZ,ZZ9.99           01401087
                                                           VALUE ZEROS. 01402090
SR3403     05  FILLER                          PIC  X(03)  VALUE SPACE. 01412089
           05  DL-XFER-EXT-PRICE               PIC  Z,ZZZ,ZZ9.99        01420016
                                                           VALUE ZEROS. 01430016
                                                                        01470016
       01  END-OF-REPORT-LINE.                                          01480016
           05  FILLER                          PIC  X(54)  VALUE SPACE. 01490016
           05  FILLER                          PIC  X(25)  VALUE        01500016
               '***** END OF REPORT *****'.                             01510016
           05  FILLER                          PIC  X(53)  VALUE SPACE. 01520016
                                                                        01530016
       01  HL1-HEADING-LINE-1.                                          01540016
           05  FILLER                          PIC  X(46)  VALUE SPACE. 01550016
           05  FILLER                          PIC  X(32)  VALUE        01560016
               'INVALID ITEM TRANSFER REPORT FOR'.                      01570016
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01580016
           05  HL1-SCHEDULE-DTE.                                        01590016
               10  HL1-SCHEDULE-MONTH          PIC  9(02)  VALUE ZEROS. 01600016
               10  FILLER                      PIC  X(01)  VALUE '/'.   01610016
               10  HL1-SCHEDULE-DAY            PIC  9(02)  VALUE ZEROS. 01620016
               10  FILLER                      PIC  X(01)  VALUE '/'.   01630016
               10  HL1-SCHEDULE-CENTURY        PIC  9(02)  VALUE ZEROS. 01640016
               10  HL1-SCHEDULE-YEAR           PIC  9(02)  VALUE ZEROS. 01650016
           05  FILLER                          PIC  X(43)  VALUE SPACE. 01660016
                                                                        01670016
       01  HL2-HEADING-LINE-2.                                          01680016
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01690016
           05  HL2-XFER-ITEM-TYPE              PIC  X(11)  VALUE SPACE. 01700016
           05  FILLER                          PIC X(118)  VALUE SPACE. 01710016
                                                                        01720016
       01  HL3-HEADING-LINE-3.                                          01730016
           05  FILLER                          PIC  X(07)  VALUE SPACE. 01740016
           05  HL3-XFER-TYPE-DESC.                                      01750016
               10  HL3-XFER-TYPE-DESC-LN1      PIC  X(20)  VALUE SPACE. 01760016
               10  HL3-XFER-TYPE-DESC-LN2      PIC  X(20)  VALUE SPACE. 01770016
           05  FILLER                          PIC  X(85)  VALUE SPACE. 01780016
                                                                        01790016
       01  HL4-HEADING-LINE-4.                                          01800016
           05  FILLER                          PIC  X(79)  VALUE SPACE. 01810077
           05  FILLER                          PIC  X(29)  VALUE        01820072
               'EXTENDED'.                                              01830016
           05  FILLER                          PIC  X(50)  VALUE SPACE. 01840072
                                                                        01850016
       01  HL5-HEADING-LINE-5.                                          01860016
           05  FILLER                          PIC  X(23)  VALUE        01870069
               'TRANSFER TYPE       '.                                  01871068
           05  FILLER                          PIC  X(12)  VALUE        01880068
               'TRANSFER NBR'.                                          01890016
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01900016
           05  FILLER                          PIC  X(04)  VALUE        01910016
               'LINE'.                                                  01920016
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01950116
           05  FILLER                          PIC  X(05)  VALUE        01951016
031903         'D/S'.                                                   01952079
           05  FILLER                          PIC  X(09)  VALUE SPACE. 01952133
           05  FILLER                          PIC  X(03)  VALUE        01970016
               'QTY'.                                                   01980016
           05  FILLER                          PIC  X(06)  VALUE SPACE. 01990076
           05  FILLER                          PIC  X(05)  VALUE        02000073
               'PRICE'.                                                 02010016
           05  FILLER                          PIC  X(10)  VALUE SPACE. 02020078
           05  FILLER                          PIC  X(05)  VALUE        02030016
               'PRICE'.                                                 02040016
           05  FILLER                          PIC  X(70)  VALUE SPACE. 02050068
                                                                        02090016
       01  RESPROGRAM-CONSTANTS.                                        02100016
           05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        02110016
               'TFKRP004'.                                              02120056
           05  PC-COMPLETE-RSN-CDE             PIC  X(02)  VALUE 'CM'.  02130016
           05  PC-ADJ-LABEL                    PIC  X(11)  VALUE        02140016
               'ADJUSTMENTS'.                                           02150016
           05  PC-XFER-LABEL                   PIC  X(11)  VALUE        02160016
               'TRANSFER   '.                                           02170016
           05  PC-ONE                          PIC  9(01)  VALUE 1.     02180016
           05  PC-DASH                         PIC  X(01)  VALUE '-'.   02190016
           05  PC-PAGE-SIZE                    PIC S9(04)  VALUE +65    02200016
                                                           COMP SYNC.   02210016
           05  PC-NINE                         PIC S9(04)  VALUE +9     02220016
                                                           COMP SYNC.   02230016
      ******  CONSTANTS TO CHECK MAJOR CLASS AND SUBCLASS LENGTH  ******02230128
031903     05  PC-099                          PIC  9(03)  VALUE 099.   02231017
031903     05  PC-100                          PIC  9(03)  VALUE 100.   02232017
                                                                        02240016
       01  PS-PROGRAM-SWITCHES.                                         02250016
           05  PS-END-OF-INVALID-ITEM-IND      PIC  X(01)  VALUE 'N'.   02260016
               88  PS-MORE-INVALID-ITEMS                   VALUE 'N'.   02270016
               88  PS-END-OF-INVALID-ITEMS                 VALUE 'Y'.   02280016
           05  PS-PROCESSING-ADJS-IND          PIC  X(01)  VALUE 'N'.   02290016
               88  PS-NOT-PROCESSING-ADJS                  VALUE 'N'.   02300016
               88  PS-PROCESSING-ADJS                      VALUE 'Y'.   02310016
           05  PS-WRITE-HL2-IND                PIC  X(01)  VALUE 'N'.   02320016
               88  PS-DONT-WRITE-HL2                       VALUE 'N'.   02330016
               88  PS-WRITE-HL2                            VALUE 'Y'.   02340016
                                                                        02350016
       01  PV-PROGRAM-VARIABLES.                                        02360016
           05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     02370016
                                                           COMP.        02380016
           05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     02390016
                                                           COMP.        02400016
           05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     02410016
                                                           COMP.        02420016
           05  PV-LINES-NEEDED-FOR-HEADINGS    PIC S9(04)  VALUE +0     02430016
                                                           COMP.        02440016
           05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 02450016
           05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 02460016
           05  PV-DISPLAY-AREA.                                         02470016
               10  PV-DISPLAY-TYP-CDE          PIC  X(02)  VALUE SPACE. 02480016
                                                                        02490016
      ******************************************************************02500016
       PROCEDURE DIVISION.                                              02510016
      ******************************************************************02520016
                                                                        02530016
      ******************************************************************02540016
      *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    02550016
      ******************************************************************02560016
       0000-PROGRAM-MAINLINE.                                           02570016
           PERFORM 1000-INITIALIZE.                                     02580016
                                                                        02590016
           PERFORM 2000-CREATE-INVALID-ITEM-RPT                         02600016
               UNTIL  PS-END-OF-INVALID-ITEMS.                          02610016
                                                                        02620016
           PERFORM 9000-EOJ-ROUTINE.                                    02630016
                                                                        02640016
           STOP RUN.                                                    02650016
      *                                                                 02660016
       1000-INITIALIZE.                                                 02670016
           OPEN  INPUT INVALID-ITEM-FILE                                02680016
                OUTPUT INVALID-ITEM-REPORT.                             02700016
                                                                        02710016
           ACCEPT CD-CURRENT-DATE         FROM  DATE.                   02720056
           MOVE CD-CURRENT-YEAR             TO  DP132O-RUN-YEAR         02730064
                                                DF-FORMAT-DATE-YY.      02731064
           MOVE CD-CURRENT-MONTH            TO  DP132O-RUN-MONTH        02740064
                                                DF-FORMAT-DATE-MM.      02741064
           MOVE CD-CURRENT-DAY              TO  DP132O-RUN-DAY          02750064
                                                DF-FORMAT-DATE-DD.      02751064
                                                                        02760016
           ACCEPT CT-CURRENT-TIME         FROM  TIME.                   02770056
           MOVE CT-CURRENT-HOUR             TO  DP132O-RUN-HOUR.        02780016
           MOVE CT-CURRENT-MINUTE           TO  DP132O-RUN-MINUTE.      02790016
                                                                        02800016
           MOVE PC-CURRENT-PROGRAM-NAME     TO  DP132O-PROGRAM-NAME.    02890016
           MOVE PC-ONE                      TO  DP132O-REPORT-NUMBER.   02900016
                                                                        02901064
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02901164
           MOVE DF-FORMAT-DATE               TO DPG52-LK-DATE-INPUT.    02901264
           SET DPG51-ACTUAL-CALENDAR-ONLY    TO TRUE.                   02901364
           SET DPG51-DECREMENT-DATE          TO TRUE.                   02901464
           SET DPG52-LK-DTE-GREG-FMT         TO TRUE.                   02901564
           MOVE 1                            TO DPG51-INCR-DECR-DAYS-9. 02901664
                                                                        02901764
           CALL DP500-KOHLS-CALENDAR-ROUTINE                            02901864
                      USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.        02901964
                                                                        02902064
           EVALUATE TRUE                                                02902164
                WHEN DPG54-NO-ERROR                                     02902264
                   MOVE DPG55-GREG-DATE-FMT    TO HL1-SCHEDULE-DTE      02902366
                WHEN OTHER                                              02902464
                   CONTINUE                                             02902567
           END-EVALUATE.                                                02902664
                                                                        02902764
           PERFORM 7100-READ-INVALID-ITEM-FILE.                         02920016
                                                                        02930016
           IF PS-END-OF-INVALID-ITEMS                                   02940016
               MOVE SPACES  TO  HL2-HEADING-LINE-2                      02950016
                                HL3-HEADING-LINE-3                      02960016
                                HL4-HEADING-LINE-4                      02970016
                                HL5-HEADING-LINE-5                      02980016
               PERFORM 8300-WRITE-HEADING-LINES                         02990016
               PERFORM 8200-WRITE-END-OF-REPORT-LINE                    03000016
           ELSE                                                         03010016
               IF TFRD057-ADJ-RSN-CDE =  PC-COMPLETE-RSN-CDE            03020056
                   MOVE PC-XFER-LABEL      TO  HL2-XFER-ITEM-TYPE       03030016
               ELSE                                                     03040016
                   MOVE PC-ADJ-LABEL       TO  HL2-XFER-ITEM-TYPE       03050016
                   SET PS-PROCESSING-ADJS  TO  TRUE                     03060016
               END-IF                                                   03070016
               MOVE TFRD057-TYP-1ST-LNE-DESC TO  HL3-XFER-TYPE-DESC-LN1 03070156
               MOVE TFRD057-TYP-2ND-LNE-DESC TO  HL3-XFER-TYPE-DESC-LN2 03070256
               PERFORM 8300-WRITE-HEADING-LINES                         03090016
           END-IF.                                                      03100016
      *                                                                 03110016
       2000-CREATE-INVALID-ITEM-RPT.                                    03120016
               MOVE TFRD057-TYP-1ST-LNE-DESC TO CK-TYP-1ST-LNE-DESC     03121057
               MOVE TFRD057-TYP-2ND-LNE-DESC TO CK-TYP-2ND-LNE-DESC     03122057
                                                                        03140049
               PERFORM 2200-PROCESS-TYP-CDE                             03150049
                   UNTIL (PS-END-OF-INVALID-ITEMS)                      03160056
                      OR ((TFRD057-TYP-1ST-LNE-DESC NOT =               03170057
                                          CK-TYP-1ST-LNE-DESC) AND      03170157
                          (TFRD057-TYP-2ND-LNE-DESC NOT =               03171057
                                          CK-TYP-2ND-LNE-DESC))         03180057
               IF PS-MORE-INVALID-ITEMS                                 03190049
                   IF PS-PROCESSING-ADJS                                03200049
                       CONTINUE                                         03210049
                   ELSE                                                 03220049
                      IF TFRD057-ADJ-RSN-CDE NOT =  PC-COMPLETE-RSN-CDE 03230057
                           MOVE PC-ADJ-LABEL  TO  HL2-XFER-ITEM-TYPE    03240049
                                                                        03250049
                           COMPUTE PV-LINES-NEEDED-FOR-HEADINGS  =      03260049
                               (PV-LINES-NEEDED-FOR-HEADINGS  +  2)     03270049
                                                                        03280049
                           SET PS-WRITE-HL2                             03290049
                               PS-PROCESSING-ADJS      TO  TRUE         03300049
                      ELSE                                              03310057
                           SET PS-NOT-PROCESSING-ADJS  TO  TRUE         03320049
                      END-IF                                            03330057
                   END-IF                                               03340049
                                                                        03350049
                   PERFORM 3000-CONTROL-BREAK                           03360049
               ELSE                                                     03370049
                   PERFORM 8200-WRITE-END-OF-REPORT-LINE                03380049
               END-IF.                                                  03390051
      *                                                                 03400016
       2200-PROCESS-TYP-CDE.                                            03410016
           MOVE TFRD057-TYP-1ST-LNE-DESC   TO  DL-TRANSFER-TYPE.        03411070
           MOVE TFRD057-FR-STR-NBR         TO  DL-XFER-STR-NBR.         03420056
           MOVE TFRD057-XFER-SEQ-NBR       TO  DL-XFER-STR-SEQ-NBR.     03430056
           MOVE TFRD057-XFER-LNE-NBR       TO  DL-XFER-LNE-NBR.         03440056
           MOVE TFRD057-DEPT               TO  DL-DEPT.                 03471056
           MOVE TFRD057-SUBCLASS           TO  DL-SUBCLASS.             03473080
           MOVE TFRD057-ITM-QTY            TO  DL-XFER-QTY.             03486056
           MOVE TFRD057-ITM-RTL-PRIC-AMT   TO  DL-XFER-PRICE.           03490056
           MOVE TFRD057-EXTENDED-RETAIL    TO  DL-XFER-EXT-PRICE.       03500056
           MOVE PC-DASH                    TO  DL-DASH-ONE.             03520016
           PERFORM 8100-WRITE-DETAIL-LINE.                              03550016
                                                                        03560016
           PERFORM 7100-READ-INVALID-ITEM-FILE.                         03570016
      *                                                                 03580016
       3000-CONTROL-BREAK.                                              03590016
           MOVE TFRD057-TYP-1ST-LNE-DESC TO  HL3-XFER-TYPE-DESC-LN1.    03591057
           MOVE TFRD057-TYP-2ND-LNE-DESC TO  HL3-XFER-TYPE-DESC-LN2.    03593057
                                                                        03610016
           COMPUTE PV-LINES-NEEDED-FOR-HEADINGS  =                      03620016
               (PV-LINES-NEEDED-FOR-HEADINGS  +  6).                    03630016
           PERFORM 8000-LINES-NEEDED-FOR-HEADINGS.                      03640016
                                                                        03650016
           IF PS-WRITE-HL2                                              03660016
               WRITE INVALID-ITEM-LINE                                  03670016
                   FROM HL2-HEADING-LINE-2                              03680016
                   AFTER ADVANCING 2 LINES                              03690016
               SET PS-DONT-WRITE-HL2  TO  TRUE                          03700016
           END-IF.                                                      03710016
                                                                        03720016
      **  IF PV-LINE-COUNT = NINE, A NEW PAGE WAS JUST WRITTEN AND      03730016
      **  THEREFORE THIS HEADING NEED NOT BE PRINTED.                   03740016
           IF PV-LINE-COUNT NOT = PC-NINE                               03750016
               WRITE INVALID-ITEM-LINE                                  03760016
                   FROM HL3-HEADING-LINE-3                              03770016
                   AFTER ADVANCING 2 LINES                              03780016
                                                                        03790016
               WRITE INVALID-ITEM-LINE                                  03800016
                   FROM HL4-HEADING-LINE-4                              03810016
                   AFTER ADVANCING 2 LINES                              03820016
                                                                        03830016
               WRITE INVALID-ITEM-LINE                                  03840016
                   FROM HL5-HEADING-LINE-5                              03850016
                   AFTER ADVANCING 1 LINES                              03860016
                                                                        03870016
               MOVE 2 TO PV-ADVANCE-COUNT                               03880016
               COMPUTE PV-LINE-COUNT  =                                 03890016
                   (PV-LINE-COUNT +                                     03900016
                       (PV-LINES-NEEDED-FOR-HEADINGS - PC-ONE))         03910016
           END-IF.                                                      03920016
                                                                        03930016
           INITIALIZE PV-LINES-NEEDED-FOR-HEADINGS.                     03940016
      *                                                                 04239016
       7100-READ-INVALID-ITEM-FILE.                                     04240016
           READ INVALID-ITEM-FILE                                       04250016
               INTO TFRD057-INVALID-TRANSFER-ITEMS                      04260056
                   AT END                                               04270016
                       SET PS-END-OF-INVALID-ITEMS  TO  TRUE            04280016
           END-READ.                                                    04290016
      *                                                                 04300016
      ******************************************************************04310016
      * WRITES A DETAIL LINE AND COMPUTES THE LINE COUNT.               04320016
      ******************************************************************04330016
       8000-LINES-NEEDED-FOR-HEADINGS.                                  04340016
           IF (PV-LINE-COUNT + PV-LINES-NEEDED-FOR-HEADINGS) >          04350016
                   PC-PAGE-SIZE                                         04360016
               INITIALIZE PV-LINE-COUNT                                 04370016
               PERFORM 8300-WRITE-HEADING-LINES                         04380016
           END-IF.                                                      04390016
      *                                                                 04400016
      ******************************************************************04410016
      * WRITES A DETAIL LINE AND COMPUTES THE LINE COUNT.               04420016
      ******************************************************************04430016
       8100-WRITE-DETAIL-LINE.                                          04440016
           IF (PV-LINE-COUNT + PV-ADVANCE-COUNT) >                      04450016
                   PC-PAGE-SIZE                                         04460016
               INITIALIZE PV-LINE-COUNT                                 04470016
               PERFORM 8300-WRITE-HEADING-LINES                         04480016
           END-IF.                                                      04490016
                                                                        04500016
           WRITE INVALID-ITEM-LINE                                      04510016
               FROM DL-DETAIL-LINE                                      04520016
               AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04530016
           COMPUTE PV-LINE-COUNT =                                      04540016
                   PV-LINE-COUNT + PV-ADVANCE-COUNT.                    04550016
           MOVE SPACES TO DL-DETAIL-LINE.                               04560016
           MOVE 1 TO PV-ADVANCE-COUNT.                                  04570016
      *                                                                 04580016
      ******************************************************************04590016
      * WRITES THE KOHLS STANDARD END OF REPORT LINE, VERIFYING IT WILL 04600016
      * STILL FIT ON THE PAGE.                                          04610016
      ******************************************************************04620016
       8200-WRITE-END-OF-REPORT-LINE.                                   04630016
           MOVE 3  TO  PV-ADVANCE-COUNT.                                04640016
           IF (PV-LINE-COUNT + PV-ADVANCE-COUNT) >                      04650016
                   PC-PAGE-SIZE                                         04660016
               ADD 1 TO PV-PAGE-COUNT                                   04670016
               MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER                 04680016
                                                                        04690016
               WRITE INVALID-ITEM-LINE                                  04700016
                   FROM DP132O-STANDRD-HEADER-132-COLS                  04710016
                   AFTER ADVANCING PAGE                                 04720016
                                                                        04730016
               WRITE INVALID-ITEM-LINE                                  04740016
                   FROM HL1-HEADING-LINE-1                              04750016
                   AFTER ADVANCING 1 LINES                              04760016
           END-IF.                                                      04770016
                                                                        04780016
           WRITE INVALID-ITEM-LINE                                      04790016
               FROM END-OF-REPORT-LINE                                  04800016
               AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04810016
      *                                                                 04820016
      ******************************************************************04830016
      * PRODUCES HEADINGS ASSOCIATED WITH THE TRANSFER DISCREPANCY      04840016
      * REPORT.                                                         04850016
      ******************************************************************04860016
       8300-WRITE-HEADING-LINES.                                        04870016
           ADD 1 TO PV-PAGE-COUNT.                                      04880016
           MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    04890016
                                                                        04900016
           WRITE INVALID-ITEM-LINE                                      04910016
               FROM DP132O-STANDRD-HEADER-132-COLS                      04920016
               AFTER ADVANCING PAGE.                                    04930016
                                                                        04940016
           WRITE INVALID-ITEM-LINE                                      04950016
               FROM HL1-HEADING-LINE-1                                  04960016
               AFTER ADVANCING 1 LINES.                                 04970016
                                                                        04980016
           WRITE INVALID-ITEM-LINE                                      04990016
               FROM HL2-HEADING-LINE-2                                  05000016
               AFTER ADVANCING 2 LINES.                                 05010016
                                                                        05020016
           WRITE INVALID-ITEM-LINE                                      05030016
               FROM HL3-HEADING-LINE-3                                  05040016
               AFTER ADVANCING 2 LINES.                                 05050016
                                                                        05060016
           WRITE INVALID-ITEM-LINE                                      05070016
               FROM HL4-HEADING-LINE-4                                  05080016
               AFTER ADVANCING 2 LINES.                                 05090016
                                                                        05100016
           WRITE INVALID-ITEM-LINE                                      05110016
               FROM HL5-HEADING-LINE-5                                  05120016
               AFTER ADVANCING 1 LINES.                                 05130016
                                                                        05140016
           MOVE 2 TO PV-ADVANCE-COUNT.                                  05150016
           MOVE 9 TO PV-LINE-COUNT.                                     05160016
      *                                                                 05170016
       9000-EOJ-ROUTINE.                                                05180016
           CLOSE INVALID-ITEM-FILE                                      05190016
                 INVALID-ITEM-REPORT.                                   05210016
      *                                                                 05220016
