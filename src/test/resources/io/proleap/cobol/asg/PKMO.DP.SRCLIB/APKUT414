000100 IDENTIFICATION DIVISION.                                         00010003
000200 PROGRAM-ID.     APKUT414.                                        00020003
000300 AUTHOR.         MICHELE RINDFLEISCH.                             00030003
000400 DATE-WRITTEN.   MARCH 2009.                                      00040005
000500******************************************************************00050003
000600*    CREATE IMPORT COMPANANT COST BY DIVISION/DEPT/FOB FILE      *00060003
000700*                                                                *00070003
000800*   PROGRAM OVERVIEW:                                            *00080003
000900*                                                                *00090003
001000*  THIS PROGRAM CREATES A FLAT FILE CONTAINING THE POSTED        *00100003
001100*  FOB MONTHLY DATA BY DIVISION, DEPARTMENT AND FOB. EACH FOB    *00110003
001200*  WITHIN A DEPARTMENT IS WRITTEN OUT  CONTAINING THE INDIVIDUAL *00120003
001300*  COMPANENT COSTS.  EACH DEPARTMENT CAN CONTAIN MULTIPLE FOB'S  *00130003
001310*  SO THIS FILE IS TO HELP THE USER TO SUMMERIZE THE DATA TO     *00131003
001320*  FOB LEVEL WITHIN EACH DEPARTMENT, AND EACH DEPARTMENT IS      *00132003
001330*  SHOWN WITHIN EACH DIVISION.                                   *00133003
001340*                                                                *00134003
001350*   INPUT:                                                       *00135003
001360*  1. IMPORT PO COST VARIANCE DATA              (APRD036)        *00136003
001370*  2. CONTROL CARD                                               *00137003
001380*                                                                *00138003
001390*   OUTPUT:                                                      *00139003
001400*  1. POST FOB MONTHLY BY DIVISION/DEPARTMENT/FOB (OUT01)        *00140003
001500*                                                                *00150003
001600******************************************************************00160003
001700* CHANGES:                                                       *00170003
001800*                                                                *00180003
001900* MAR 2009    INITIAL VERSION.                                   *00190005
002000******************************************************************00200003
002100/                                                                 00210003
002200 ENVIRONMENT DIVISION.                                            00220003
002300 CONFIGURATION SECTION.                                           00230003
002400 INPUT-OUTPUT SECTION.                                            00240003
002500 FILE-CONTROL.                                                    00250003
002600                                                                  00260003
002700     SELECT INPUT-FILE           ASSIGN TO UT-S-INP01.            00270003
002800     SELECT OUTPUT-FILE          ASSIGN TO UT-S-OUT01.            00280003
002900                                                                  00290003
002910 DATA DIVISION.                                                   00291003
002920 FILE SECTION.                                                    00292003
002930 FD  INPUT-FILE                                                   00293003
002940     RECORDING MODE IS F                                          00294003
002950     LABEL RECORDS ARE STANDARD                                   00295003
002960     BLOCK CONTAINS 0 RECORDS                                     00296003
002970     DATA RECORD IS INPUT-RECORD.                                 00297003
002980 01  INPUT-RECORD                PIC X(170).                      00298003
002990                                                                  00299003
003000 FD  OUTPUT-FILE                                                  00300003
003100     RECORDING MODE IS F                                          00310003
003200     LABEL RECORDS ARE STANDARD                                   00320003
003300     BLOCK CONTAINS 0 RECORDS                                     00330003
003400     DATA RECORD IS OUTPUT-RECORD.                                00340003
003500 01  DEPT-OUTPUT-RECORD          PIC X(300).                      00350003
003600                                                                  00360003
003700 WORKING-STORAGE SECTION.                                         00370003
003800                                                                  00380003
003900 01  PROGRAM-WORKAREA.                                            00390003
004000     05  FILLER                  PIC  X(30)      VALUE            00400003
004100         '** BEGINING OF APKUT414 W/S **'.                        00410003
004200                                                                  00420003
004300     05  PV-CURRENT-PARAGRAPH    PIC  X(30)      VALUE SPACES.    00430003
004400     05  PV-PROGRAM-NAME         PIC  X(08)      VALUE            00440003
004500         'APKUT414'.                                              00450003
004600     05  INPUT-COUNT             PIC 9(09)       VALUE  0.        00460003
004700     05  OUTPUT-RECORD-COUNT     PIC 9(09)       VALUE  0.        00470003
004800     05  SAVE-DMA-NBR            PIC X(02)       VALUE SPACES.    00480003
004900     05  SAVE-DEPT-NBR           PIC X(03)       VALUE SPACES.    00490003
005000     05  SAVE-FOB-CDE            PIC X(03)       VALUE SPACES.    00500003
005100                                                                  00510003
005200     05  PV-CC-DATE.                                              00520003
005300         10  PV-CC-YEAR          PIC X(04)       VALUE SPACES.    00530003
005400         10  PV-CC-MONTH         PIC X(09)       VALUE SPACES.    00540003
005500                                                                  00550003
005600 01  SUM-DPT-FIELDS.                                              00560003
005610     05  WS-SUM-PO-QTY              PIC S9(11)V99  VALUE ZEROES.  00561003
005620     05  WS-SUM-FOB-INV-UNT-QTY     PIC S9(11)V99  VALUE ZEROES.  00562003
005630     05  WS-SUM-FOB-FIRST-COST      PIC S9(11)V99  VALUE ZEROES.  00563003
005640     05  WS-SUM-FOB-DUTY            PIC S9(11)V99  VALUE ZEROES.  00564003
005650     05  WS-SUM-FOB-COMMISSION      PIC S9(11)V99  VALUE ZEROES.  00565003
005660     05  WS-SUM-FOB-ROYALTY         PIC S9(11)V99  VALUE ZEROES.  00566003
005670     05  WS-SUM-FOB-FREIGHT         PIC S9(11)V99  VALUE ZEROES.  00567003
005680     05  WS-SUM-FOB-1ST-COST-LOAD   PIC S9(11)V99  VALUE ZEROES.  00568003
005690     05  WS-SUM-FOB-DECONSOL        PIC S9(11)V99  VALUE ZEROES.  00569003
005691     05  WS-SUM-FOB-ENTRY-FEE       PIC S9(11)V99  VALUE ZEROES.  00569103
005692     05  WS-SUM-FOB-DRAYAGE         PIC S9(11)V99  VALUE ZEROES.  00569203
005693     05  WS-SUM-FOB-OVERSEAS-CONSOL PIC S9(11)V99  VALUE ZEROES.  00569303
005694     05  WS-SUM-FOB-HANGER-CHRG     PIC S9(11)V99  VALUE ZEROES.  00569403
005695     05  WS-SUM-FOB-MISC-CHRGS      PIC S9(11)V99  VALUE ZEROES.  00569503
005696     05  WS-SUM-FOB-TOT-LANDED-COST PIC S9(11)V99  VALUE ZEROES.  00569603
005697                                                                  00569703
005698 01  PROGRAM-SWITCHES-SUBS.                                       00569803
005699     05  PV-EOF-SW               PIC  X(01)           VALUE 'N'.  00569903
005700         88  EOF                 VALUE 'Y'.                       00570003
005701                                                                  00570103
005702*  INPUT RECORD AREA                                              00570203
005703                                                                  00570303
005704 01  CONTROL-CARD-DATE.                                           00570403
005705     05  CC-DATE                 PIC X(14).                       00570503
005706     05  FILLER                  PIC X(66).                       00570603
005707                                                                  00570703
005708 01  CONTROL-CARD-TITLE.                                          00570803
005709     05  CC-TITLE                PIC X(55).                       00570903
005710     05  FILLER                  PIC X(25).                       00571003
005711                                                                  00571103
005712*  INPUT RECORD COPYBOOK                                          00571203
005713                                                                  00571303
005714     COPY APRD036.                                                00571403
005715                                                                  00571503
005716*  OUTPUT RECORD AREA                                             00571603
005717                                                                  00571703
005718 01  D1-DATE-RECORD.                                              00571803
005719     05  D1-DATE                PIC X(14)   VALUE SPACES.         00571903
005720     05  FILLER                 PIC X(01)   VALUE ','.            00572003
005730     05  D1-TITLE               PIC X(55)   VALUE SPACES.         00573003
005740     05  FILLER                 PIC X(01)   VALUE ','.            00574003
005750     05  FILLER                 PIC X(229)  VALUE SPACES.         00575003
005760                                                                  00576003
005761 01  D2-HEADER-RECORD.                                            00576103
005762     05  D2-HEADER1             PIC X(08)   VALUE 'DIVISION'.     00576203
005763     05  FILLER                 PIC X(01)   VALUE ','.            00576303
005764     05  D2-HEADER2             PIC X(04)   VALUE 'DEPT'.         00576403
005765     05  FILLER                 PIC X(01)   VALUE ','.            00576503
005766     05  D2-HEADER3             PIC X(04)   VALUE 'FOB'.          00576603
005767     05  FILLER                 PIC X(01)   VALUE ','.            00576703
005768     05  D2-HEADER4             PIC X(08)   VALUE 'PO COUNT'.     00576803
005769     05  FILLER                 PIC X(01)   VALUE ','.            00576903
005770     05  D2-HEADER5             PIC X(05)   VALUE 'UNITS'.        00577003
005780     05  FILLER                 PIC X(01)   VALUE ','.            00578003
005790     05  D2-HEADER6             PIC X(17)   VALUE                 00579003
005800                                          'IMPORT FIRST COST'.    00580003
005900     05  FILLER                 PIC X(01)   VALUE ','.            00590003
006000     05  D2-HEADER7             PIC X(12)   VALUE                 00600003
006100                                          'CUSTOMS DUTY'.         00610003
006200     05  FILLER                 PIC X(01)   VALUE ','.            00620003
006300     05  D2-HEADER8             PIC X(23)   VALUE                 00630003
006400                                    'IMPORT AGENT COMMISSION'.    00640003
006500     05  FILLER                 PIC X(01)   VALUE ','.            00650003
006600     05  D2-HEADER9             PIC X(24)   VALUE                 00660003
006700                                   'LETTER OF CREDIT ROYALTY'.    00670003
006800     05  FILLER                 PIC X(01)   VALUE ','.            00680003
006810     05  D2-HEADER10            PIC X(17)   VALUE                 00681003
006811                                          'OCEAN/AIR FREIGHT'.    00681103
006812     05  FILLER                 PIC X(01)   VALUE ','.            00681203
006813     05  D2-HEADER11            PIC X(26)   VALUE                 00681303
006814                                 'FIRST COST LOAD - INTERNAL'.    00681403
006815     05  FILLER                 PIC X(01)   VALUE ','.            00681503
006816     05  D2-HEADER12            PIC X(20)   VALUE                 00681603
006817                                       'DECONSOLIDATION FEES'.    00681703
006818     05  FILLER                 PIC X(01)   VALUE ','.            00681803
006819     05  D2-HEADER13            PIC X(17)   VALUE                 00681903
006820                                          'CUSTOMS ENTRY FEE'.    00682003
006821     05  FILLER                 PIC X(01)   VALUE ','.            00682103
006822     05  D2-HEADER14            PIC X(12)   VALUE                 00682203
006823                                               'DRAYAGE FEES'.    00682303
006824     05  FILLER                 PIC X(01)   VALUE ','.            00682403
006825     05  D2-HEADER15            PIC X(26)   VALUE                 00682503
006826                                 'OVERSEAS CONSOLIDATION FEE'.    00682603
006827     05  FILLER                 PIC X(01)   VALUE ','.            00682703
006828     05  D2-HEADER16            PIC X(14)   VALUE                 00682803
006829                                             'HANGER CHARGES'.    00682903
006830     05  FILLER                 PIC X(01)   VALUE ','.            00683003
006831     05  D2-HEADER17            PIC X(27)   VALUE                 00683103
006832                                'MISCELLANEOUS IMPORT CHARGE'.    00683203
006833     05  FILLER                 PIC X(01)   VALUE ','.            00683303
006834     05  D2-HEADER18            PIC X(11)   VALUE                 00683403
006835                                                'LANDED COST'.    00683503
006836     05  FILLER                 PIC X(01)   VALUE ','.            00683603
006837     05  FILLER                 PIC X(18)   VALUE SPACES.         00683703
006838                                                                  00683803
006839 01  D3-DETAIL-RECORD.                                            00683903
006840     05  D3-DMA-NBR               PIC X(02)   VALUE SPACES.       00684003
006841     05  FILLER                   PIC X(01)   VALUE ','.          00684103
006842     05  D3-DEPT-NBR              PIC X(03)   VALUE SPACES.       00684203
006843     05  FILLER                   PIC X(01)   VALUE ','.          00684303
006844     05  D3-FOB-CDE               PIC X(03)   VALUE SPACES.       00684403
006845     05  FILLER                   PIC X(01)   VALUE ','.          00684503
006846     05  D3-PO-COUNT              PIC ----------9                 00684603
006847                                              VALUE ZEROES.       00684703
006848     05  FILLER                   PIC X(01)   VALUE ','.          00684803
006849     05  D3-UNIT-COUNT            PIC ----------9                 00684903
006850                                            VALUE ZEROES.         00685003
006851     05  FILLER                   PIC X(01)   VALUE ','.          00685103
006852     05  D3-FOB-FIRST-COST-AMT    PIC -------------9.99           00685203
006853                                            VALUE ZEROES.         00685303
006854     05  FILLER                   PIC X(01)   VALUE ','.          00685403
006855     05  D3-FOB-DUTY-AMT          PIC -------------9.99           00685503
006856                                            VALUE ZEROES.         00685603
006857     05  FILLER                   PIC X(01)   VALUE ','.          00685703
006858     05  D3-FOB-COMMISSION-AMT    PIC -------------9.99           00685803
006859                                            VALUE ZEROES.         00685903
006860     05  FILLER                   PIC X(01)   VALUE ','.          00686003
006870     05  D3-FOB-ROYALTY-AMT       PIC -------------9.99           00687003
006871                                            VALUE ZEROES.         00687103
006872     05  FILLER                   PIC X(01)   VALUE ','.          00687203
006873     05  D3-FOB-FREIGHT-AMT       PIC -------------9.99           00687303
006874                                            VALUE ZEROES.         00687403
006875     05  FILLER                   PIC X(01)   VALUE ','.          00687503
006876     05  D3-FOB-FRST-COST-LD-AMT  PIC -------------9.99           00687603
006877                                            VALUE ZEROES.         00687703
006878     05  FILLER                   PIC X(01)   VALUE ','.          00687803
006879     05  D3-FOB-DECONSOL-AMT      PIC -------------9.99           00687903
006880                                            VALUE ZEROES.         00688003
006890     05  FILLER                   PIC X(01)   VALUE ','.          00689003
006891     05  D3-FOB-ENTRY-FEE-AMT     PIC -------------9.99           00689103
006892                                            VALUE ZEROES.         00689203
006893     05  FILLER                   PIC X(01)   VALUE ','.          00689303
006894     05  D3-FOB-DRAYAGE-AMT       PIC -------------9.99           00689403
006895                                            VALUE ZEROES.         00689503
006896     05  FILLER                   PIC X(01)   VALUE ','.          00689603
006897     05  D3-FOB-OVRSEA-CNSOL-AMT  PIC -------------9.99           00689703
006898                                            VALUE ZEROES.         00689803
006899     05  FILLER                   PIC X(01)   VALUE ','.          00689903
006900     05  D3-FOB-HANGER-CHRG-AMT   PIC -------------9.99           00690003
006901                                            VALUE ZEROES.         00690103
006902     05  FILLER                   PIC X(01)   VALUE ','.          00690203
006903     05  D3-FOB-MSIC-CHRG-AMT     PIC -------------9.99           00690303
006904                                            VALUE ZEROES.         00690403
006905     05  FILLER                   PIC X(01)   VALUE ','.          00690503
006906     05  D3-FOB-TOT-LAND-COST-AMT PIC -------------9.99           00690603
006907                                            VALUE ZEROES.         00690703
006908     05  FILLER                   PIC X(01)   VALUE ','.          00690803
006909     05  FILLER                   PIC X(44)   VALUE SPACES.       00690903
006910                                                                  00691003
006911*----------------------------------------------------------------*00691103
006912*  ABEND DATA AREAS                                              *00691203
006913*----------------------------------------------------------------*00691303
006914 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          00691403
006915                                             COMP SYNC.           00691503
006916                                                                  00691603
006917                                                                  00691703
006918 01  ABEND-AREAS.                                                 00691803
006919     05  AA-ABEND-LIT            PIC  X(40)  VALUE                00691903
006920             '*****       ABEND'.                                 00692003
006930     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                00693003
006940             '*****   PROGRAM: APKUT414'.                         00694003
006950     05  AA-PARAGRAPH-LIT.                                        00695003
006960         10  FILLER              PIC  X(17)  VALUE                00696003
006970             '***** PARAGRAPH: '.                                 00697003
006980         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        00698003
006990     05  AA-MESSAGE-LINE.                                         00699003
007000         10  FILLER              PIC  X(06)  VALUE '*****'.       00700003
007100         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        00710003
007200                                                                  00720003
007300 01  FILLER                      PIC  X(25)  VALUE                00730003
007400     '** END OF APKUT414 W/S **'.                                 00740003
007500                                                                  00750003
007600 PROCEDURE DIVISION.                                              00760003
007700                                                                  00770003
007800***************************************************************** 00780003
007900*  MAIN DRIVER PARAGRAPH                                          00790003
008000***************************************************************** 00800003
008100 A100-MAIN.                                                       00810003
008200                                                                  00820003
008300     MOVE 'A100-MAIN'            TO   PV-CURRENT-PARAGRAPH.       00830003
008400                                                                  00840003
008500     PERFORM B100-HOUSEKEEPING.                                   00850003
008600                                                                  00860003
008700     PERFORM B200-PROCESS-DATA UNTIL EOF.                         00870003
008800                                                                  00880003
008900     IF INPUT-COUNT > 0                                           00890003
009000        PERFORM B300-CREATE-DPT-FOB-OUT-RECORD                    00900003
009100     END-IF.                                                      00910003
009200                                                                  00920003
009300     PERFORM B500-END-PROGRAM.                                    00930003
009400                                                                  00940003
009500     GOBACK.                                                      00950003
009600                                                                  00960003
009700***************************************************************** 00970003
009800*  PROGRAM INITIALIZATION                                         00980003
009900***************************************************************** 00990003
010000 B100-HOUSEKEEPING.                                               01000003
010100                                                                  01010003
010200     MOVE 'B100-HOUSEKEEPING'    TO   PV-CURRENT-PARAGRAPH.       01020003
010300                                                                  01030003
010400     DISPLAY '**********************************************'.    01040003
010500     DISPLAY '**        APKUT414 STARTING NOW!!!!         **'.    01050003
010600     DISPLAY '**********************************************'.    01060003
010700                                                                  01070003
010800     OPEN INPUT  INPUT-FILE                                       01080003
010900          OUTPUT OUTPUT-FILE.                                     01090003
011000                                                                  01100003
011100     ACCEPT CONTROL-CARD-DATE.                                    01110003
011200     ACCEPT CONTROL-CARD-TITLE.                                   01120003
011300                                                                  01130003
011400     DISPLAY ' '.                                                 01140003
011500     DISPLAY '************************************************'.  01150003
011600     DISPLAY ' APKUT414  CONTROL INFORMATION                  '.  01160003
011700     DISPLAY ' '.                                                 01170003
011710     DISPLAY ' CONTROL-CARD-DATE  = ' CONTROL-CARD-DATE.          01171003
011711     DISPLAY ' '.                                                 01171103
011712     DISPLAY ' CONTROL-CARD-TITLE  = ' CONTROL-CARD-TITLE.        01171203
011713     DISPLAY ' '.                                                 01171303
011714     DISPLAY '************************************************'.  01171403
011715     DISPLAY ' '.                                                 01171503
011716                                                                  01171603
011717     MOVE CC-DATE                TO PV-CC-DATE.                   01171703
011718                                                                  01171803
011719     STRING  PV-CC-MONTH     DELIMITED BY SPACE                   01171903
011720              ' '            DELIMITED BY SIZE                    01172003
011721             PV-CC-YEAR      DELIMITED BY SIZE                    01172103
011722             INTO D1-DATE.                                        01172203
011723                                                                  01172303
011724     MOVE CC-TITLE              TO D1-TITLE.                      01172403
011725                                                                  01172503
011726     PERFORM W100-WRITE-D1-DATE-RECORD.                           01172603
011727                                                                  01172703
011728     INITIALIZE AP036-IMPORT-REPORT-RECORD.                       01172803
011729                                                                  01172903
011730     PERFORM R100-READ-INPUT-FILE.                                01173003
011740                                                                  01174003
011750     IF PV-EOF-SW = 'N'                                           01175003
011760       MOVE AP036-DMA-NBR         TO  SAVE-DMA-NBR                01176003
011770       MOVE AP036-DEPT-NBR        TO  SAVE-DEPT-NBR               01177003
011780       MOVE AP036-FOB-CDE         TO  SAVE-FOB-CDE                01178003
011790       PERFORM W200-WRITE-D2-HEADER-RECORD                        01179003
011800     ELSE                                                         01180003
011900       DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'      01190003
012000     END-IF.                                                      01200003
012100                                                                  01210003
012200***************************************************************** 01220003
012300*  PROCESS EACH INPUT RECORD BASED ON THE DMA (DIVISION),         01230003
012400*  DEPARTMENT AND FOB.                                            01240003
012500***************************************************************** 01250003
012600 B200-PROCESS-DATA.                                               01260003
012700                                                                  01270003
012800     MOVE 'B200-PROCESS-DATA'    TO   PV-CURRENT-PARAGRAPH.       01280003
012900                                                                  01290003
013000     IF AP036-DMA-NBR = SAVE-DMA-NBR                              01300003
013100        IF AP036-DEPT-NBR = SAVE-DEPT-NBR                         01310003
013200          IF AP036-FOB-CDE = SAVE-FOB-CDE                         01320003
013300             PERFORM B400-CALC-FOB-TOTALS                         01330003
013400          ELSE                                                    01340003
013500             PERFORM B300-CREATE-DPT-FOB-OUT-RECORD               01350003
013600             MOVE AP036-FOB-CDE  TO SAVE-FOB-CDE                  01360003
013700             PERFORM B400-CALC-FOB-TOTALS                         01370003
013800          END-IF                                                  01380003
013900        ELSE                                                      01390003
014000          PERFORM B300-CREATE-DPT-FOB-OUT-RECORD                  01400003
014100          MOVE AP036-DEPT-NBR TO SAVE-DEPT-NBR                    01410003
014200          MOVE AP036-FOB-CDE  TO SAVE-FOB-CDE                     01420003
014210          PERFORM B400-CALC-FOB-TOTALS                            01421003
014220        END-IF                                                    01422003
014230     ELSE                                                         01423003
014240         PERFORM B300-CREATE-DPT-FOB-OUT-RECORD                   01424003
014250         MOVE AP036-DMA-NBR TO SAVE-DMA-NBR                       01425003
014260         MOVE AP036-DEPT-NBR TO SAVE-DEPT-NBR                     01426003
014270         MOVE AP036-FOB-CDE  TO SAVE-FOB-CDE                      01427003
014280         PERFORM B400-CALC-FOB-TOTALS                             01428003
014290     END-IF.                                                      01429003
014300                                                                  01430003
014400     PERFORM R100-READ-INPUT-FILE.                                01440003
014500                                                                  01450003
014600***************************************************************** 01460003
014610*  CREATE THE DEPARTMENT DETAIL RECORD.  EACH RECORD WILL CONTAIN 01461003
014620*  THE DIVISION, DEPARTMENT, PO COUNT AND ALL DETAILED COUNTS/AMTS01462003
014630*  FOR EACH COMPANENT.                                            01463003
014640***************************************************************** 01464003
014641 B300-CREATE-DPT-FOB-OUT-RECORD.                                  01464103
014642                                                                  01464203
014643     MOVE 'B300-CREATE-DPT-FOB-OUT-RECORD '                       01464303
014644                                        TO PV-CURRENT-PARAGRAPH.  01464403
014645                                                                  01464503
014646     MOVE SAVE-DMA-NBR                TO D3-DMA-NBR.              01464603
014647     MOVE SAVE-DEPT-NBR               TO D3-DEPT-NBR.             01464703
014648     MOVE SAVE-FOB-CDE                TO D3-FOB-CDE.              01464803
014649     MOVE WS-SUM-PO-QTY               TO D3-PO-COUNT.             01464903
014650     MOVE WS-SUM-FOB-INV-UNT-QTY      TO D3-UNIT-COUNT.           01465003
014651     MOVE WS-SUM-FOB-FIRST-COST       TO D3-FOB-FIRST-COST-AMT.   01465103
014652     MOVE WS-SUM-FOB-DUTY             TO D3-FOB-DUTY-AMT.         01465203
014653     MOVE WS-SUM-FOB-COMMISSION       TO D3-FOB-COMMISSION-AMT.   01465303
014654     MOVE WS-SUM-FOB-ROYALTY          TO D3-FOB-ROYALTY-AMT.      01465403
014655     MOVE WS-SUM-FOB-1ST-COST-LOAD    TO D3-FOB-FRST-COST-LD-AMT. 01465503
014656     MOVE WS-SUM-FOB-HANGER-CHRG      TO D3-FOB-HANGER-CHRG-AMT.  01465603
014657     MOVE WS-SUM-FOB-FREIGHT          TO D3-FOB-FREIGHT-AMT.      01465703
014658     MOVE WS-SUM-FOB-DECONSOL         TO D3-FOB-DECONSOL-AMT.     01465803
014659     MOVE WS-SUM-FOB-DRAYAGE          TO D3-FOB-DRAYAGE-AMT.      01465903
014660     MOVE WS-SUM-FOB-ENTRY-FEE        TO D3-FOB-ENTRY-FEE-AMT.    01466003
014661     MOVE WS-SUM-FOB-OVERSEAS-CONSOL  TO D3-FOB-OVRSEA-CNSOL-AMT. 01466103
014662     MOVE WS-SUM-FOB-MISC-CHRGS       TO D3-FOB-MSIC-CHRG-AMT.    01466203
014663     MOVE WS-SUM-FOB-TOT-LANDED-COST  TO D3-FOB-TOT-LAND-COST-AMT.01466303
014664                                                                  01466403
014665     PERFORM W300-WRITE-D3-DETAIL-RECORD.                         01466503
014666                                                                  01466603
014667     INITIALIZE SUM-DPT-FIELDS.                                   01466703
014668                                                                  01466803
014669***************************************************************** 01466903
014670*  CALCULATE THE TOTALS FOR EACH COMPONENT OF THE FOB BEING       01467003
014671*  PROCEESSED.                                                    01467103
014672***************************************************************** 01467203
014673 B400-CALC-FOB-TOTALS.                                            01467303
014674                                                                  01467403
014675     MOVE 'B400-CALC-FOB-TOTALS' TO    PV-CURRENT-PARAGRAPH.      01467503
014676                                                                  01467603
014677     IF AP036-HEADER                                              01467703
014678         COMPUTE WS-SUM-FOB-INV-UNT-QTY =                         01467803
014679                 WS-SUM-FOB-INV-UNT-QTY + AP036-INV-UNT-QTY       01467903
014680         ADD +1  TO WS-SUM-PO-QTY                                 01468003
014681     ELSE                                                         01468103
014682         EVALUATE TRUE                                            01468203
014683                                                                  01468303
014684           WHEN AP036-FIRST-COST                                  01468403
014685             COMPUTE WS-SUM-FOB-FIRST-COST =                      01468503
014686                     WS-SUM-FOB-FIRST-COST + AP036-INV-COST-AMT   01468603
014687                                                                  01468703
014688           WHEN AP036-DUTY                                        01468803
014689             COMPUTE WS-SUM-FOB-DUTY =                            01468903
014690                     WS-SUM-FOB-DUTY + AP036-INV-COST-AMT         01469003
014691                                                                  01469103
014692           WHEN AP036-COMMISSION                                  01469203
014693             COMPUTE WS-SUM-FOB-COMMISSION =                      01469303
014694                     WS-SUM-FOB-COMMISSION + AP036-INV-COST-AMT   01469403
014695                                                                  01469503
014696           WHEN AP036-ROYALTY                                     01469603
014697             COMPUTE WS-SUM-FOB-ROYALTY =                         01469703
014698                     WS-SUM-FOB-ROYALTY + AP036-INV-COST-AMT      01469803
014699                                                                  01469903
014700           WHEN AP036-FREIGHT                                     01470003
014701             COMPUTE WS-SUM-FOB-FREIGHT =                         01470103
014702                     WS-SUM-FOB-FREIGHT + AP036-INV-COST-AMT      01470203
014703                                                                  01470303
014704           WHEN AP036-1ST-COST-LOAD                               01470403
014705             COMPUTE WS-SUM-FOB-1ST-COST-LOAD =                   01470503
014706                     WS-SUM-FOB-1ST-COST-LOAD + AP036-INV-COST-AMT01470603
014707                                                                  01470703
014708           WHEN AP036-DECONSOLIDATION                             01470803
014709             COMPUTE WS-SUM-FOB-DECONSOL =                        01470903
014710                     WS-SUM-FOB-DECONSOL + AP036-INV-COST-AMT     01471003
014711                                                                  01471103
014712           WHEN AP036-ENTRY-FEE                                   01471203
014713             COMPUTE WS-SUM-FOB-ENTRY-FEE =                       01471303
014714                     WS-SUM-FOB-ENTRY-FEE + AP036-INV-COST-AMT    01471403
014715                                                                  01471503
014716           WHEN AP036-DRAYAGE                                     01471603
014717             COMPUTE WS-SUM-FOB-DRAYAGE =                         01471703
014718                     WS-SUM-FOB-DRAYAGE + AP036-INV-COST-AMT      01471803
014719                                                                  01471903
014720           WHEN AP036-OVERSEAS-CONSOL                             01472003
014721             COMPUTE WS-SUM-FOB-OVERSEAS-CONSOL =                 01472103
014722                  WS-SUM-FOB-OVERSEAS-CONSOL + AP036-INV-COST-AMT 01472203
014723                                                                  01472303
014724           WHEN AP036-HANGER-CHARGE                               01472403
014725             COMPUTE WS-SUM-FOB-HANGER-CHRG =                     01472503
014726                     WS-SUM-FOB-HANGER-CHRG + AP036-INV-COST-AMT  01472603
014727                                                                  01472703
014728           WHEN AP036-MISC-CHARGES                                01472803
014729             COMPUTE WS-SUM-FOB-MISC-CHRGS =                      01472903
014730                     WS-SUM-FOB-MISC-CHRGS + AP036-INV-COST-AMT   01473003
014731                                                                  01473103
014732           WHEN AP036-TOTAL-LANDED-COST                           01473203
014733             COMPUTE WS-SUM-FOB-TOT-LANDED-COST =                 01473303
014734                   WS-SUM-FOB-TOT-LANDED-COST + AP036-INV-COST-AMT01473403
014735                                                                  01473503
014736         END-EVALUATE                                             01473603
014737     END-IF.                                                      01473703
014738                                                                  01473803
014739***************************************************************** 01473903
014740*  END OF PROCESSING.  CLOSE FILES.  DISPLAY COUNTS.              01474003
014750***************************************************************** 01475003
014760 B500-END-PROGRAM.                                                01476003
014770                                                                  01477003
014780     MOVE 'B500-END-PROGRAM'     TO   PV-CURRENT-PARAGRAPH.       01478003
014790                                                                  01479003
014800     CLOSE  INPUT-FILE                                            01480003
014810            OUTPUT-FILE.                                          01481003
014820                                                                  01482003
014821     DISPLAY '***** APKUT414 COUNTS *****'.                       01482103
014822     DISPLAY 'RECORDS READ    = ' INPUT-COUNT.                    01482203
014823     DISPLAY 'RECORDS WRITTEN = ' OUTPUT-RECORD-COUNT.            01482303
014824     DISPLAY '***************************'.                       01482403
014825                                                                  01482503
014826***************************************************************** 01482603
014827*  READ THE INPUT FILE.                                           01482703
014828***************************************************************** 01482803
014829 R100-READ-INPUT-FILE.                                            01482903
014830                                                                  01483003
014840     MOVE 'R100-READ-INPUT-FILE' TO   PV-CURRENT-PARAGRAPH.       01484003
014850                                                                  01485003
014860     READ INPUT-FILE          INTO AP036-IMPORT-REPORT-RECORD     01486003
014870         AT END                                                   01487003
014880             SET EOF TO TRUE.                                     01488003
014890                                                                  01489003
014900     IF PV-EOF-SW = 'N'                                           01490003
015000        ADD 1 TO INPUT-COUNT                                      01500003
015100     END-IF.                                                      01510003
015200                                                                  01520003
015300***************************************************************** 01530003
015400*  WRITE OUT THE DATE RECORD WHICH CONTAINS THE FISCAL MONTH      01540003
015500*  BEING PROCESSED AND THE TITLE OF THE FILE.                     01550003
015600***************************************************************** 01560003
015700 W100-WRITE-D1-DATE-RECORD.                                       01570003
015800                                                                  01580003
015900     MOVE 'W100-WRITE-D1-DATE-RECORD  '                           01590003
016000                                        TO PV-CURRENT-PARAGRAPH.  01600003
016100                                                                  01610003
016200     WRITE DEPT-OUTPUT-RECORD FROM D1-DATE-RECORD.                01620003
016300                                                                  01630003
016400     ADD 1 TO OUTPUT-RECORD-COUNT.                                01640003
016500                                                                  01650003
016600                                                                  01660003
016700***************************************************************** 01670003
016800*  WRITE OUT THE COLUMN HEADERS                                   01680003
016900***************************************************************** 01690003
017000 W200-WRITE-D2-HEADER-RECORD.                                     01700003
017100                                                                  01710003
017200     MOVE 'W200-WRITE-D2-HEADER-RECORD  '                         01720003
017300                                        TO PV-CURRENT-PARAGRAPH.  01730003
017400                                                                  01740003
017500     WRITE DEPT-OUTPUT-RECORD FROM D2-HEADER-RECORD.              01750003
017600                                                                  01760003
017700     ADD 1 TO OUTPUT-RECORD-COUNT.                                01770003
017800                                                                  01780003
017900***************************************************************** 01790003
018000*  WRITE OUT EACH DETAIL LINE.                                    01800003
018100***************************************************************** 01810003
018200 W300-WRITE-D3-DETAIL-RECORD.                                     01820003
018300                                                                  01830003
018400     MOVE 'W300-WRITE-D3-DETAIL-RECORD  '                         01840003
018500                                        TO PV-CURRENT-PARAGRAPH.  01850003
018600                                                                  01860003
018700     WRITE DEPT-OUTPUT-RECORD FROM D3-DETAIL-RECORD.              01870003
018800                                                                  01880003
018900     ADD 1 TO OUTPUT-RECORD-COUNT.                                01890003
019000     INITIALIZE D3-DETAIL-RECORD.                                 01900003
