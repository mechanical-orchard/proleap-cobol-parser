000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TRKUP235.                                          00050000
000600 AUTHOR.       MIKE FRIESS.                                       00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. MARCH 03 2000.                                     00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM UPDATES THE CONTAINER MANIFEST TABLE (TIMCNTK)   *00120000
001300*  WITH VESSEL/VOYAGE ARRIVAL DATA THAT HAS BEEN EDITED BY       *00130000
001400*  PROGRAM TRKUT230.  THE PROGRAM ALSO CREATES A DB2 WORK TABLE  *00140000
001500*  THAT CONTAINS ERROR AND DETAIL RECORDS THAT WILL BE PASSED TO *00150000
001600*  THE DETAIL AND ERROR REPORT PROGRAMS.                         *00160000
001700******************************************************************00170000
001800******************************************************************00180000
001900*  11/06/2003 TKMA643 - VISWA KARUTURI                           *00190000
002000*     REMOVED LOGIC THAT PERTAINS TO COLUMNS FRGT_CHRG_AMT,      *00200000
002100*     CONSLR_CHRG_AMT,EXTL_REF_NBR AND ADDED DOC_RCVD_ORGN_TMST, *00210000
002101*     MOM_FOB_CDE, FDR_FOB_CDE, MOM_POR_CDE AND FDR_POR_CDE.     *00210100
002102*  06/14/2012 TKMA479 - CRQ26951                                 *00210205
002103*     ADDED EOF CHECK IN PARA. 2100- WHEN CHECKING               *00210305
002104*     TO INSERT NEW RULE (7400-) INTO DATABASE.                  *00210405
002106******************************************************************00210605
002107 ENVIRONMENT DIVISION.                                            00210705
002108******************************************************************00210805
002109                                                                  00210905
002110 CONFIGURATION SECTION.                                           00211005
002111                                                                  00211105
002112 SOURCE-COMPUTER.        IBM-3090.                                00211205
002113 OBJECT-COMPUTER.        IBM-3090.                                00211305
002114                                                                  00211405
002120 INPUT-OUTPUT SECTION.                                            00212000
002130                                                                  00213000
002140 FILE-CONTROL.                                                    00214000
002150                                                                  00215000
002160     SELECT TR026-ARRIVAL-FILE                                    00216000
002170         ASSIGN TO INP01.                                         00217000
002180                                                                  00218000
002190******************************************************************00219000
002200 DATA DIVISION.                                                   00220000
002300******************************************************************00230000
002400                                                                  00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  TR026-ARRIVAL-FILE                                           00270000
002800     RECORDING MODE IS F                                          00280000
002900     LABEL RECORDS ARE STANDARD                                   00290000
003000     BLOCK CONTAINS 0 RECORDS.                                    00300000
003100                                                                  00310000
003200 01  TR026-ARRIVAL-RECORD            PIC X(300).                  00320000
003300                                                                  00330000
003400******************************************************************00340000
003500 WORKING-STORAGE SECTION.                                         00350000
003600******************************************************************00360000
003700                                                                  00370000
003800******************************************************************00380000
003900*  DB2 FORMATTED MESSAGE AREA                                     00390000
004000******************************************************************00400000
004100     COPY DPWS004.                                                00410000
004200                                                                  00420000
004300******************************************************************00430000
004400*  COMMUNICATIONS AREA FOR DB2                                    00440000
004500******************************************************************00450000
004600     EXEC SQL                                                     00460000
004700          INCLUDE SQLCA                                           00470000
004800     END-EXEC.                                                    00480000
004900                                                                  00490000
005000******************************************************************00500000
005100*  DB2 TABLE DECLARATION - IMPORT CONTAINER MANIFEST TABLE.       00510000
005200*      (TIMCNTK)                                                  00520000
005300******************************************************************00530000
005400     EXEC SQL                                                     00540000
005500          INCLUDE TIMCNTK                                         00550000
005600     END-EXEC.                                                    00560000
005700                                                                  00570000
005800******************************************************************00580000
005900*  DB2 TABLE DECLARATION - IMPORT CONTAINER MANIFEST AUDIT TABLE. 00590000
006000*      (TAUCNTK)                                                  00600000
006100******************************************************************00610000
006200     EXEC SQL                                                     00620000
006300          INCLUDE TAUCNTK                                         00630000
006400     END-EXEC.                                                    00640000
006500                                                                  00650000
006600******************************************************************00660000
006700*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO TABLE.             00670000
006800*      (TIMCNPO)                                                  00680000
006900******************************************************************00690000
007000     EXEC SQL                                                     00700000
007100          INCLUDE TIMCNPO                                         00710000
007200     END-EXEC.                                                    00720000
007300                                                                  00730000
007400******************************************************************00740000
007500*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO AUDIT TABLE.       00750000
007600*      (TAUCNPO)                                                  00760000
007700******************************************************************00770000
007800     EXEC SQL                                                     00780000
007900          INCLUDE TAUCNPO                                         00790000
008000     END-EXEC.                                                    00800000
008100                                                                  00810000
008200******************************************************************00820000
008300*  DB2 TABLE DECLARATION - DETAIL AND ERROR REPORT WORK TABLE.    00830000
008400*      (TOUTTR8)                                                  00840000
008500******************************************************************00850000
008600     EXEC SQL                                                     00860000
008700          INCLUDE TOUTTR8                                         00870000
008800     END-EXEC.                                                    00880000
008900                                                                  00890000
009000******************************************************************00900000
009100*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)00910000
009200*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT     00920000
009300*  INTERVALS.                                                     00930000
009400******************************************************************00940000
009500     EXEC SQL                                                     00950000
009600         INCLUDE TCKRSTCN                                         00960000
009700     END-EXEC.                                                    00970000
009800                                                                  00980000
009900******************************************************************00990000
010000*  DB2 TABLE DECLARATION - CHECKPOINT RESTART         (TCKRSTINF) 01000000
010100*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT     01010000
010200*  INTERVALS.                                                     01020000
010300******************************************************************01030000
010400     EXEC SQL                                                     01040000
010500         INCLUDE TCKRSTIN                                         01050000
010600     END-EXEC.                                                    01060000
010700                                                                  01070000
010800******************************************************************01080000
010900*  DB2 TABLE DECLARATION - IMPORT RULES WORK TABLE                01090000
011000*  TRTW_CONTNR_RUL_2                                              01100000
011100******************************************************************01110000
011200     EXEC SQL                                                     01120000
011300         INCLUDE TRT00034                                         01130000
011400     END-EXEC.                                                    01140000
011401                                                                  01140100
011402******************************************************************01140200
011403*  DB2 TABLE DECLARATION - MQ SERIES  WORK TABLE                  01140300
011404*  TRTW_ARRVL_CKPR                                                01140400
011405******************************************************************01140500
011406     EXEC SQL                                                     01140600
011407         INCLUDE TRT00037                                         01140700
011408     END-EXEC.                                                    01140800
011409                                                                  01140900
011410******************************************************************01141000
011420*  DB2 TABLE DECLARATION -  IMPORT FOB TABLE.                     01142000
011430*      (TIMFOB)                                                   01143000
011440******************************************************************01144000
011450     EXEC SQL                                                     01145000
011460          INCLUDE TIMFOB                                          01146000
011470     END-EXEC.                                                    01147000
011480                                                                  01148000
011490******************************************************************01149000
011500*  DB2 TABLE DECLARATION -  IMPORT POE TABLE.                     01150000
011600*      (TIMPOE)                                                   01160000
011700******************************************************************01170000
011800     EXEC SQL                                                     01180000
011900          INCLUDE TIMPOE                                          01190000
012000     END-EXEC.                                                    01200000
012010                                                                  01201000
012020******************************************************************01202000
012030*   EDITED IMPORT VESSEL/VOYAGE ARRIVAL DATA RECORD LAYOUT.       01203000
012040******************************************************************01204000
012050     COPY TRRD026.                                                01205000
012060 EJECT                                                            01206000
012070                                                                  01207000
012080******************************************************************01208000
012090*  VESSEL/VOYAGE ARRIVAL DATA DETAIL/ERROR REPORT RECORD.        *01209000
012100*  USED TO FORMAT THE DETAIL/ERROR REPORT RECORDS.  LATER THIS   *01210000
012200*  TABLE IS DUMPED TO A FLAT FILE AND SORTED WITH THE DETAIL/    *01220000
012300*  ERROR FILE FROM THE EDIT PROGRAM.  THE SORTED FILE IS USED AS *01230000
012400*  INPUT TO THE ERROR AND DETAIL REPORT PROGRAMS WHICH CREATE AN *01240000
012500*  ERROR AND A DETAIL REPORT OF VESSEL/VOYAGE ARRIVAL DATA.      *01250000
012510******************************************************************01251000
012520                                                                  01252000
012530     COPY TRRD231.                                                01253000
012540                                                                  01254000
012550******************************************************************01255000
012560*  CONTAINER RULES FILE LAYOUT                                   *01256000
012561*                                                                *01256100
012562 EJECT                                                            01256200
012563******************************************************************01256300
012564     COPY TRRD265.                                                01256400
012565 EJECT                                                            01256500
012566******************************************************************01256600
012567*    SUPPLY CHAIN MANAGEMENT MQ MESSAGE RECORD                    01256700
012568******************************************************************01256800
012569     COPY TRRD405.                                                01256900
012570 EJECT                                                            01257000
012580                                                                  01258000
012590 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01259000
012600                                                   COMP SYNC.     01260000
012700 01  PA-PROGRAM-ACCUMULATORS.                                     01270000
012800     05  PA-TOTALS.                                               01280000
012900         10 PA-TOTAL-COMMITS          PIC  S9(13)  VALUE +0       01290000
013000                                                     COMP-3.      01300000
013100         10 PA-TOTAL-ISA-RECS-READ    PIC  S9(13)  VALUE +0       01310000
013200                                                     COMP-3.      01320000
013300         10 PA-TOTAL-RECS-LOADED      PIC  S9(13)  VALUE +0       01330000
013400                                                     COMP-3.      01340000
013500         10 PA-TOT-EDI-RECS-READ      PIC  S9(13)  VALUE +0       01350000
013600                                                     COMP-3.      01360000
013700         10 PA-TOT-ETA-RECS-READ      PIC  S9(13)  VALUE +0       01370000
013800                                                     COMP-3.      01380000
013900         10 PA-TOT-ADU-RECS-READ      PIC  S9(13)  VALUE +0       01390000
014000                                                     COMP-3.      01400000
014100         10 PA-TOT-ADURD-RECS-READ    PIC  S9(13)  VALUE +0       01410000
014200                                                     COMP-3.      01420000
014300         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0       01430000
014400                                                     COMP-3.      01440000
014500         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0       01450000
014600                                                     COMP-3.      01460000
014700         10 PA-TOTAL-RULE-COUNT       PIC  S9(13)  VALUE +0       01470000
014800                                                     COMP-3.      01480000
014900         10 PA-TOT-TRN-TYP-A          PIC  S9(13)  VALUE +0       01490000
015000                                                     COMP-3.      01500000
015100         10 PA-TOT-TRN-TYP-C          PIC  S9(13)  VALUE +0       01510000
015200                                                     COMP-3.      01520000
015300         10 PA-TOT-TRN-TYP-D          PIC  S9(13)  VALUE +0       01530000
015400                                                     COMP-3.      01540000
015500         10 PA-TOT-RECS-INSERTED      PIC  S9(13)  VALUE +0       01550000
015600                                                     COMP-3.      01560000
015700         10 PA-TOT-RECS-AUDITED       PIC  S9(13)  VALUE +0       01570000
015800                                                     COMP-3.      01580000
015900         10 PA-TOT-CNTK-RECS-SELECT   PIC  S9(13)  VALUE +0       01590000
016000                                                     COMP-3.      01600000
016100         10 PA-TOT-ACNTK-INSERTS      PIC  S9(13)  VALUE +0       01610000
016200                                                     COMP-3.      01620000
016300         10 PA-TOT-CNTK-DELETES       PIC  S9(13)  VALUE +0       01630000
016400                                                     COMP-3.      01640000
016500         10 PA-TOT-RECS-UPDATED       PIC  S9(13)  VALUE +0       01650000
016600                                                     COMP-3.      01660000
016700         10 PA-TOT-CNTK-UPDATES       PIC  S9(13)  VALUE +0       01670000
016800                                                     COMP-3.      01680000
016900         10 PA-TOT-CNPO-UPDATES       PIC  S9(13)  VALUE +0       01690000
017000                                                     COMP-3.      01700000
017100         10 PA-TOT-ACNPO-INSERTS      PIC  S9(13)  VALUE +0       01710000
017200                                                     COMP-3.      01720000
017300                                                                  01730000
017400 01  PS-PROGRAM-SWITCHES.                                         01740000
017500     05  PS-END-OF-INPUT-SW            PIC  X(01)    VALUE 'N'.   01750000
017600         88  PS-END-OF-INPUT                         VALUE 'Y'.   01760000
017700         88  PS-END-OF-INPUT-NO                      VALUE 'N'.   01770000
017800     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   01780000
017900         88  NORMAL-RUN                              VALUE '0'.   01790000
018000         88  RESTART-RUN                             VALUE '9'.   01800000
018100     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   01810000
018200         88  COMMITS-TAKEN                           VALUE 'T'.   01820000
018300         88  NO-COMMITS-TAKEN                        VALUE 'N'.   01830000
018400     05  PS-SAME-COMMIT-FIELDS-SW      PIC  X(01)    VALUE 'N'.   01840000
018500         88  PS-SAME-COMMIT-FIELDS                   VALUE 'Y'.   01850000
018600         88  PS-NOT-SAME-COMMIT-FIELDS               VALUE 'N'.   01860000
018700     05  PS-CNTK-FOUND-SW              PIC  X(01)    VALUE 'N'.   01870000
018800         88  PS-CNTK-FOUND                           VALUE 'Y'.   01880000
018900         88  PS-CNTK-FOUND-NO                        VALUE 'N'.   01890000
019000     05  PS-GOOD-CNTK-INSERT-SW        PIC  X(01)    VALUE 'N'.   01900000
019100         88  PS-GOOD-CNTK-INSERT                     VALUE 'Y'.   01910000
019200         88  PS-GOOD-CNTK-INSERT-NO                  VALUE 'N'.   01920000
019300     05  PS-GOOD-CNTK-UPDATE-SW        PIC  X(01)    VALUE 'N'.   01930000
019400         88  PS-GOOD-CNTK-UPDATE                     VALUE 'Y'.   01940000
019500         88  PS-GOOD-CNTK-UPDATE-NO                  VALUE 'N'.   01950000
019600     05  PS-GOOD-CNTK-DELETE-SW        PIC  X(01)    VALUE 'N'.   01960000
019700         88  PS-GOOD-CNTK-DELETE                     VALUE 'Y'.   01970000
019800         88  PS-GOOD-CNTK-DELETE-NO                  VALUE 'N'.   01980000
019900     05  PS-GOOD-CNPO-UPDATE-SW        PIC  X(01)    VALUE 'N'.   01990000
020000         88  PS-GOOD-CNPO-UPDATE                     VALUE 'Y'.   02000000
020100         88  PS-GOOD-CNPO-UPDATE-NO                  VALUE 'N'.   02010000
020200     05  PS-AUDIT-CNPO-SW              PIC  X(01)    VALUE 'N'.   02020000
020300         88  PS-AUDIT-CNPO                           VALUE 'Y'.   02030000
020400         88  PS-AUDIT-CNPO-NO                        VALUE 'N'.   02040000
020500     05  PS-CONTROL-BREAK-SW           PIC X(01)     VALUE 'N'.   02050000
020600         88  PS-CONTROL-BREAK                        VALUE 'Y'.   02060000
020700         88  PS-CONTROL-BREAK-NO                     VALUE 'N'.   02070000
020800     05  PS-NEW-CONTAINER-SW           PIC X(01)     VALUE 'N'.   02080000
020900         88  PS-NEW-CONTAINER                        VALUE 'Y'.   02090000
021000         88  PS-NEW-CONTAINER-NO                     VALUE 'N'.   02100000
021100     05  PS-NEW-PO-KEY-SW              PIC X(01)     VALUE 'N'.   02110000
021200         88  PS-NEW-PO-KEY                           VALUE 'Y'.   02120000
021300         88  PS-NEW-PO-KEY-NO                        VALUE 'N'.   02130000
021400     05  PS-GOOD-RECORD-SW             PIC X(01)     VALUE 'N'.   02140000
021500         88  PS-GOOD-RECORD                          VALUE 'Y'.   02150000
021600         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   02160000
021700     05 PS-VALID-POE-NAME-SW           PIC X(01)     VALUE 'N'.   02170000
021800         88  PS-VALID-POE-NAME                       VALUE 'Y'.   02180000
021900         88  PS-VALID-POE-NAME-NO                    VALUE 'N'.   02190000
022000     05 PS-ETA-CHANGE-SW               PIC X(01)     VALUE 'N'.   02200000
022100         88  PS-ETA-CHANGE-YES                       VALUE 'Y'.   02210000
022200         88  PS-ETA-CHANGE-NO                        VALUE 'N'.   02220000
022300     05  PS-VALID-POE-CDE-SW           PIC X(01)     VALUE 'Y'.   02230000
022400         88  PS-VALID-POE-CDE                        VALUE 'Y'.   02240000
022500         88  PS-INVALID-POE-CDE                      VALUE 'N'.   02250000
022600                                                                  02260000
022700 01  PC-PROGRAM-CONSTANTS.                                        02270000
022800     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          02280000
022900         'TRKUP235'.                                              02290000
023000     05  PC-10                       PIC X(02)     VALUE '10'.    02300000
023100     05  PC-20                       PIC X(02)     VALUE '20'.    02310000
023200     05  PC-30                       PIC X(02)     VALUE '30'.    02320000
023300     05  PC-40                       PIC X(02)     VALUE '40'.    02330000
023400     05  PC-50                       PIC X(02)     VALUE '50'.    02340000
023500     05  PC-60                       PIC X(02)     VALUE '60'.    02350000
023600     05  PC-70                       PIC X(02)     VALUE '70'.    02360000
023700     05  PC-A                        PIC X(01)     VALUE 'A'.     02370000
023800     05  PC-C                        PIC X(01)     VALUE 'C'.     02380000
023900     05  PC-D                        PIC X(01)     VALUE 'D'.     02390000
024000     05  PC-E                        PIC X(01)     VALUE 'E'.     02400000
024100     05  PC-O                        PIC X(01)     VALUE 'O'.     02410000
024200     05  PC-U                        PIC X(01)     VALUE 'U'.     02420000
024300     05  PC-Y                        PIC X(01)     VALUE 'Y'.     02430000
024400     05  PC-ADU                      PIC X(06)     VALUE 'ADU   '.02440000
024500     05  PC-ADURDA                   PIC X(06)     VALUE 'ADURDA'.02450000
024600     05  PC-ETA                      PIC X(06)     VALUE 'ETA   '.02460000
024700     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   02470000
024800     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   02480000
024900     05  PC-DASH                     PIC X(01)     VALUE '-'.     02490000
025000     05  PC-DECIMAL                  PIC X(01)     VALUE '.'.     02500000
025100     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          02510000
025200                                     '0001-01-01-00.00.00.000000'.02520000
025300     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       02530000
025400                                                     COMP-3.      02540000
025500     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     02550000
025600     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     02560000
025700     05  PC-CMN                      PIC X(03)     VALUE 'CMN'.   02570000
025800                                                                  02580000
025900 01  PV-PROGRAM-VARIABLES.                                        02590000
026000     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  02600000
026100                                                                  02610000
026200     05 PV-PREV-KEY.                                              02620000
026300        10 PV-PREV-KEY-TRN-TYP          PIC X(01).                02630000
026400        10 PV-PREV-KEY-REC-TYP-CDE      PIC X(06).                02640000
026500        10 PV-PREV-KEY-SEQ-NBR          PIC X(02).                02650000
026600        10 PV-PREV-KEY-3RD-PARTY-CDE    PIC X(06).                02660000
026700        10 PV-PREV-KEY-CONTNR-ID        PIC X(12).                02670000
026800        10 PV-PREV-KEY-CONTNR-SEQ       PIC 9(04).                02680000
026900        10 PV-PREV-KEY-EXTL-REF-NBR     PIC X(15).                02690000
027000        10 PV-PREV-KEY-PO-NBR           PIC 9(09).                02700000
027100                                                                  02710000
027200     05 PV-HLD-FOR-TIMCNTK-INSERT.                                02720000
027300        10 PV-HLD-CONTNR-ID             PIC X(12).                02730000
027400        10 PV-HLD-CONTNR-SEQ-NBR        PIC S9(4) COMP.           02740000
027500        10 PV-HLD-MOM-POE-DELY-TMST     PIC X(26).                02750000
027600        10 PV-HLD-MOM-DEST-POE-CDE      PIC X(4).                 02760000
027700***     10 PV-HLD-EST-LBD-NM            PIC X(30).                02770000
027800***     10 PV-HLD-EST-LBD-TMST          PIC X(26).                02780000
027900        10 PV-HLD-ACTL-POE-DELY-TMST    PIC X(26).                02790000
028000        10 PV-HLD-ACTL-DEST-POE-CDE     PIC X(4).                 02800000
028100        10 PV-HLD-FILE-ID               PIC X(9).                 02810000
028101        10 PV-HLD-ORGN-SHPD-FR-CDE      PIC X(3).                 02810100
028102                                                                  02810200
028103     05 PV-HLD-FOR-RULE-INSERT.                                   02810300
028104        10 PV-HLD-PRV-MOM-POE-DELY-TMST PIC X(26).                02810400
028105        10 PV-HLD-PRV-MOM-DEST-POE-CDE  PIC X(04).                02810500
028106                                                                  02810600
028107     05 PV-HLD-FOR-TIMCNPO-UPDATE.                                02810700
028108        10 PV-HLD-ACTL-POE-DELY-CDE     PIC X(01).                02810800
028109        10 PV-HLD-EXTL-REF-NBR          PIC X(15).                02810900
028110        10 PV-HLD-PO-NBR                PIC S9(9) COMP.           02811000
028120                                                                  02812000
028130                                                                  02813000
028140     05  PV-EDI-RECORDS              PIC  X(03).                  02814000
028150         88  EDI-RECORD                            VALUE 'CTT',   02815000
028160                                                         'IEA',   02816000
028170                                                         'ISA'.   02817000
028180         88  EDI-IEA-RECORD                        VALUE 'IEA'.   02818000
028190                                                                  02819000
028200     05  PV-RECORD-TYP               PIC X(06).                   02820000
028300         88  PV-RECORD-TYP-ADU                     VALUE 'ADU   '.02830000
028400         88  PV-RECORD-TYP-ETA                     VALUE 'ETA   '.02840000
028500                                                                  02850000
028600     05  PV-TMST                     PIC X(26)     VALUE SPACES.  02860000
028700     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  02870000
028800     05  PV-CURRENT-TMST-RULES       PIC X(26)     VALUE SPACES.  02880000
028900     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.  02890000
029000     05  PA-TOTAL-RECS-READ          PIC 9(09)     VALUE ZERO     02900000
029100                                                    COMP-3.       02910000
029200     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       02920000
029300                                                    COMP SYNC.    02930000
029400     05  PV-CONTAINER-CNT            PIC S9(09)    VALUE +0       02940000
029500                                                    COMP-3.       02950000
029600                                                                  02960000
029700     05  PV-FORMAT-TMST.                                          02970000
029800         10  PV-FORMAT-TMST-DTE.                                  02980000
029900             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  02990000
030000             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     03000000
030100             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  03010000
030200             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     03020000
030300             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  03030000
030400             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     03040000
030500         10  PV-FORMAT-TMST-TM.                                   03050000
030600             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  03060000
030700             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     03070000
030800             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  03080000
030900             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          03090000
031000                                                     '.00.000000'.03100000
031100     05  PV-REFORMAT-TMST.                                        03110000
031200         10  PV-REFORMAT-TMST-DTE.                                03120000
031300             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.03130000
031400             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.03140000
031500             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.03150000
031600         10  PV-REFORMAT-TMST-TM.                                 03160000
031700             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.03170000
031800             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.03180000
031900                                                                  03190000
032000     05  PV-REFORMAT-TO-DB2-DTE.                                  03200000
032100         10  PV-REFORMAT-TO-DB2-CY    PIC X(04)  VALUE SPACES.    03210000
032200         10  PV-REFORMAT-TODB2-DASH1  PIC X(01)  VALUE '-'.       03220000
032300         10  PV-REFORMAT-TO-DB2-MM    PIC X(02)  VALUE SPACES.    03230000
032400         10  PV-REFORMAT-TODB2-DASH2  PIC X(01)  VALUE '-'.       03240000
032500         10  PV-REFORMAT-TO-DB2-DD    PIC X(02)  VALUE SPACES.    03250000
032600                                                                  03260000
032700     05  PV-REFORMAT-10BYTE-FIELD     PIC X(10)  VALUE SPACES.    03270000
032800                                                                  03280000
032900     05  PV-WRK-POE-NM                PIC X(30).                  03290000
033000     05  PV-WRK-POE-CDE               PIC X(04).                  03300000
033100     05  PV-LAST-POE-CDE              PIC X(04).                  03310000
033200     05  PV-WRK-POE-CDE-AIR           PIC X(03).                  03320000
033300     05  PV-WRK-TRIP-TYPE-CDE-MOM     PIC X(01).                  03330000
033400     05  PV-LAST-TRIP-TYPE-CDE-MOM    PIC X(01).                  03340000
033500     05  PV-TR265-FOB-CDE            PIC X(05)     VALUE SPACES.  03350000
033600     05  PV-TR265-POE-CDE            PIC X(04)     VALUE SPACES.  03360000
033700     05  PV-COMPARE-MOM-FOB-CDE      PIC X(05)     VALUE SPACES.  03370000
033800     05  PV-COMPARE-MOM-POE-CDE      PIC X(04)     VALUE SPACES.  03380000
033900     05  PV-COMPARE-TRIP-TYP-CDE     PIC X(01)     VALUE SPACES.  03390000
034000                                                                  03400000
034100 01  CKPT-RESTART-INFO.                                           03410000
034200     05  CR-INPUT-FILE-SW            PIC X(01)     VALUE 'I'.     03420000
034300         88  INPUT-ARRIVAL-FILE                    VALUE 'I'.     03430000
034400     05  CR-ARRIVAL-RECS-WORKED      PIC 9(09)     VALUE ZERO.    03440000
034500                                                                  03450000
034600 EJECT                                                            03460000
034700                                                                  03470000
034800*---------------------------------------------------------------* 03480000
034900*    CURSOR DECLARATION FOR SELECTING POE CODE AIR - DECON      * 03490000
035000*---------------------------------------------------------------* 03500000
035100                                                                  03510000
035200     EXEC SQL                                                     03520000
035300          DECLARE  POE-CSR-AIR-DCN CURSOR                         03530000
035400              FOR  SELECT DISTINCT                                03540000
035500                   A.POE_CDE                                      03550000
035600             FROM  TIMPOE  A                                      03560000
035700            WHERE  A.STD_IATA_CDE  =  :PV-COMPARE-MOM-POE-CDE     03570000
035800              AND  A.STAT_CDE      =  'A'                         03580000
035900         ORDER BY  POE_CDE                                        03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200*---------------------------------------------------------------* 03620000
036300*    CURSOR DECLARATION FOR SELECTING POE CODE OCEAN - DECON    * 03630000
036400*---------------------------------------------------------------* 03640000
036500                                                                  03650000
036600     EXEC SQL                                                     03660000
036700          DECLARE  POE-CSR-OCEAN-DCN CURSOR                       03670000
036800              FOR  SELECT DISTINCT                                03680000
036900                   A.POE_CDE                                      03690000
037000             FROM  TIMPOE  A                                      03700000
037100            WHERE  A.POE_STD_EDI_CDE  = :PV-COMPARE-MOM-POE-CDE   03710000
037200              AND  A.STAT_CDE         = 'A'                       03720000
037300         ORDER BY  POE_CDE                                        03730000
037301     END-EXEC.                                                    03730100
037302                                                                  03730200
037303                                                                  03730300
037304 EJECT                                                            03730400
037305******************************************************************03730500
037306 LINKAGE SECTION.                                                 03730600
037307******************************************************************03730700
037308                                                                  03730800
037309******************************************************************03730900
037310 PROCEDURE DIVISION.                                              03731000
037311******************************************************************03731100
037312*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *03731200
037313******************************************************************03731300
037314 0000-PROGRAM-MAINLINE.                                           03731400
037315                                                                  03731500
037316     PERFORM 1000-INITIALIZE.                                     03731600
037317                                                                  03731700
037318     PERFORM 2000-PROCESS-ARRIVAL-RECORDS                         03731800
037319         UNTIL PS-END-OF-INPUT.                                   03731900
037320                                                                  03732000
037330     PERFORM 8000-EOJ-ROUTINE.                                    03733000
037340     STOP RUN.                                                    03734000
037350                                                                  03735000
037360******************************************************************03736000
037370*  OPEN FILES, INITIALIZE FIELDS, AND DOES OTHER BEGINNING OF    *03737000
037380*  JOB PROCESSES.                                                *03738000
037390******************************************************************03739000
037400 1000-INITIALIZE.                                                 03740000
037500                                                                  03750000
037600     OPEN INPUT TR026-ARRIVAL-FILE.                               03760000
037700                                                                  03770000
037800     PERFORM 4000-GET-CHECKPOINT-CNTL.                            03780000
037900     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                  03790000
038000                                                                  03800000
038100     IF RESTART-RUN                                               03810000
038200         PERFORM 4110-CHECKPOINT-RESTART                          03820000
038300     ELSE                                                         03830000
038400         PERFORM 1010-CONTINUE-INITIALIZE                         03840000
038500     END-IF.                                                      03850000
038600                                                                  03860000
038700     PERFORM 4020-SET-COMMIT-TIME.                                03870000
038800                                                                  03880000
038900                                                                  03890000
039000 1010-CONTINUE-INITIALIZE.                                        03900000
039100                                                                  03910000
039200     INITIALIZE  TR026-REC-TYP-ETA.                               03920000
039300                                                                  03930000
039400     SET PS-GOOD-RECORD-NO TO TRUE.                               03940000
039500     PERFORM 6000-READ-ARRIVAL-FILE                               03950000
039600         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                 03960000
039700                                                                  03970000
039800     IF PS-END-OF-INPUT                                           03980000
039900         CONTINUE                                                 03990000
040000     ELSE                                                         04000000
040100         MOVE TR026-ETA-REC-KEY                                   04010000
040200                TO PV-PREV-KEY                                    04020000
040300     END-IF.                                                      04030000
040400                                                                  04040000
040500******************************************************************04050000
040600* MAIN PROCESSING PARAGRAPH.                                     *04060000
040700*   FOR EACH SET OF ARRIVAL RECORDS WITH THE SAME KEYS -         *04070000
040800*     CONTAINER, CONTAINER SEQUENCE, TRAN TYPE (A,C,D)           *04080000
040900*   - SELECT THE CONTAINER ROW                                    04090000
041000*      - PERFORM  2100-ADD-UPDATE-DELETE   UNTIL THE KEYS CHANGE  04100000
041100*        - SAVE UP DATA FROM ALL OCCURANCES OF ETA AND ADU        04110000
041200*          (CAN BE MULTIPLES BECAUSE OF MULTIPLE PO'S PER CNTR)   04120000
041300*        - WRITE DETAIL AND ERROR REPORT ROWS TO WORK TABLE       04130000
041400*      - IF THERE'S A LEGITIMATE ADD, CHANGE OR DELETE            04140000
041500*          - WRITE A ROW TO THE AUDIT TABLE                       04150000
041600*          - UPDATE THE ROW ON TIMCNTK                            04160000
041700******************************************************************04170000
041800                                                                  04180000
041900 2000-PROCESS-ARRIVAL-RECORDS.                                    04190000
042000     SET PS-CONTROL-BREAK-NO                                      04200000
042100         PS-NEW-CONTAINER-NO                                      04210000
042200         PS-NEW-PO-KEY-NO                                         04220000
042300         PS-AUDIT-CNPO-NO                                         04230000
042400         PS-GOOD-CNPO-UPDATE-NO                                   04240000
042500         PS-GOOD-CNTK-UPDATE-NO                                   04250000
042600         PS-GOOD-CNTK-INSERT-NO                                   04260000
042700         PS-GOOD-CNTK-DELETE-NO                                   04270000
042800         PS-ETA-CHANGE-NO               TO TRUE.                  04280000
042900                                                                  04290000
043000     MOVE TR026-ETA-CONTNR-ID      TO IMCNTK-CONTNR-ID.           04300000
043100     MOVE TR026-ETA-CONTNR-SEQ     TO IMCNTK-CONTNR-SEQ-NBR.      04310000
043200     MOVE TR026-ETA-EXTL-REF-NBR   TO IMCNPO-EXTL-REF-NBR.        04320000
043300     MOVE TR026-ETA-PO-NBR         TO IMCNPO-PO-NBR.              04330000
043400     PERFORM 7000-SELECT-TIMCNTK.                                 04340000
043500     PERFORM 7100-SELECT-TIMCNPO.                                 04350000
043600                                                                  04360000
043700     EVALUATE TRUE                                                04370000
043800                                                                  04380000
043900      WHEN PS-CNTK-FOUND                                          04390000
044000                                                                  04400000
044100         EVALUATE TRUE                                            04410000
044200           WHEN TR026-ADURD-REC-TYP-CDE-ADURDA                    04420000
044300              PERFORM 7999-SET-CURRENT-TMST                       04430000
044400              PERFORM 5200-MOVE-TIMCNTK-TO-HOLD                   04440000
044500              PERFORM 5210-MOVE-TIMCNPO-TO-HOLD                   04450000
044600              PERFORM 2100-ADD-UPDATE-DELETE                      04460000
044700                 UNTIL  PS-CONTROL-BREAK       OR                 04470000
044800                        PS-END-OF-INPUT                           04480000
044900                                                                  04490000
045000              IF PS-GOOD-CNTK-UPDATE   OR                         04500000
045100                 PS-GOOD-CNTK-INSERT   OR                         04510000
045200                 PS-GOOD-CNTK-DELETE                              04520000
045300                PERFORM 7010-UPDATE-TIMCNTK                       04530000
045400                ADD +1 TO PA-TOT-CNTK-UPDATES                     04540000
045500                          PA-TOT-RECS-UPDATED                     04550000
045600              END-IF                                              04560000
045700                                                                  04570000
045800           WHEN OTHER                                             04580000
045900              PERFORM 5100-MOVE-TIMCNTK-TO-TAUCNTK                04590000
046000              PERFORM 5110-MOVE-TIMCNPO-TO-TAUCNPO                04600000
046100              PERFORM 5200-MOVE-TIMCNTK-TO-HOLD                   04610000
046200              PERFORM 5210-MOVE-TIMCNPO-TO-HOLD                   04620000
046300              PERFORM 2100-ADD-UPDATE-DELETE                      04630000
046400                 UNTIL  PS-CONTROL-BREAK       OR                 04640000
046500                        PS-END-OF-INPUT                           04650000
046600                                                                  04660000
046700              IF PS-GOOD-CNTK-UPDATE   OR                         04670000
046800                 PS-GOOD-CNTK-INSERT   OR                         04680000
046900                 PS-GOOD-CNTK-DELETE                              04690000
047000                PERFORM 7030-INSERT-TAUCNTK                       04700000
047100                PERFORM 7010-UPDATE-TIMCNTK                       04710000
047200                ADD +1 TO PA-TOT-CNTK-UPDATES                     04720000
047300                          PA-TOT-RECS-UPDATED                     04730000
047400              END-IF                                              04740000
047500         END-EVALUATE                                             04750000
047600                                                                  04760000
047700      WHEN PS-CNTK-FOUND-NO                                       04770000
047800                                                                  04780000
047900         PERFORM 6307-CONTAINER-NOT-FOUND-MSG                     04790000
048000         PERFORM 2500-SPIN-THRU-CONTAINER                         04800000
048100            UNTIL  PS-NEW-CONTAINER       OR                      04810000
048200                   PS-END-OF-INPUT                                04820000
048300                                                                  04830000
048400     END-EVALUATE.                                                04840000
048500                                                                  04850000
048600     PERFORM 4100-COMMIT-CHECK.                                   04860000
048700                                                                  04870000
048800 EJECT                                                            04880000
048900******************************************************************04890000
049000* PROCESS ADDS AND CHANGES UNTIL THERE'S A NEW CONTAINER ROW.    *04900000
049100******************************************************************04910000
049200                                                                  04920000
049300 2100-ADD-UPDATE-DELETE.                                          04930000
049400                                                                  04940000
049500     EVALUATE TRUE                                                04950000
049600                                                                  04960000
049700         WHEN TR026-ETA-TRN-TYP-ADD                               04970000
049800            ADD +1 TO PA-TOT-TRN-TYP-A                            04980000
049801            PERFORM 2300-MOVE-TO-TIMCNTK-DCLGEN                   04980100
049802            PERFORM 2620-ADD-SCM-ARRIVAL-MSG                      04980200
049803                                                                  04980300
049804         WHEN TR026-ETA-TRN-TYP-CHG                               04980400
049805            ADD +1 TO PA-TOT-TRN-TYP-C                            04980500
049806            PERFORM 2300-MOVE-TO-TIMCNTK-DCLGEN                   04980600
049807            PERFORM 2625-CHG-SCM-ARRIVAL-MSG                      04980700
049808                                                                  04980800
049809         WHEN TR026-ETA-TRN-TYP-DEL                               04980900
049810            ADD +1 TO PA-TOT-TRN-TYP-D                            04981000
049811            PERFORM 2400-MOVE-TO-TIMCNTK-DCLGEN-D                 04981100
049812            PERFORM 2630-DEL-SCM-ARRIVAL-MSG                      04981200
049813                                                                  04981300
049814     END-EVALUATE.                                                04981400
049815                                                                  04981500
049816     INITIALIZE TR231-RECORD.                                     04981600
049817     MOVE PC-D  TO TR231-RPT-TYP.                                 04981700
049818     PERFORM 5000-MOVE-RPT-FIELDS.                                04981800
049819     PERFORM 7300-INSERT-TOUTTR8-RPT.                             04981900
049820                                                                  04982000
049830     PERFORM 2600-CHECK-HOLD-FIELDS.                              04983000
049840                                                                  04984000
049850     SET PS-GOOD-RECORD-NO TO TRUE.                               04985000
049860     PERFORM 6000-READ-ARRIVAL-FILE                               04986000
049870         UNTIL PS-GOOD-RECORD OR                                  04987000
049880               PS-END-OF-INPUT.                                   04988000
049890                                                                  04989000
049900     PERFORM 2610-CHECK-FOR-CONTROL-BRK.                          04990000
050000                                                                  05000000
050100**CRQ26951-START                                                  05010005
050200* WRITE OUT RULE RECORD (INSERT TO DB2) WHEN CONTROL BREAK OR EOF 05020004
050300* OCCURS AND THE ETA DATA CHANGED.                                05030004
050400                                                                  05040000
050700     IF ((PS-CONTROL-BREAK OR PS-END-OF-INPUT) AND                05070000
050800          PS-ETA-CHANGE-YES)                                      05080000
050900           PERFORM 7400-BUILD-CNTR-RULE-FILE                      05090000
051000           SET PS-ETA-CHANGE-NO TO TRUE                           05100000
051100     END-IF.                                                      05110000
051101                                                                  05110105
051110**CRQ26951-END                                                    05111005
051200                                                                  05120000
051300*    WHEN THERE IS A CHANGE IN PO CHECK IF AUDITING AND UPDATING  05130000
051400*    ARE REQUIRED.  RESET SWITCHES AND HOLD AREAS.                05140000
051500                                                                  05150000
051600     IF PS-NEW-PO-KEY  OR  PS-NEW-CONTAINER  OR                   05160000
051700        PS-END-OF-INPUT                                           05170000
051800       IF PS-GOOD-CNPO-UPDATE                                     05180000
051900         IF PS-AUDIT-CNPO                                         05190000
052000           PERFORM 7210-INSERT-TAUCNPO                            05200000
052100           SET PS-AUDIT-CNPO-NO  TO TRUE                          05210000
052200         END-IF                                                   05220000
052300         PERFORM 7020-UPDATE-TIMCNPO                              05230000
052400         ADD +1 TO PA-TOT-CNPO-UPDATES                            05240000
052500                   PA-TOT-RECS-UPDATED                            05250000
052600       END-IF                                                     05260000
052700       IF PS-NEW-PO-KEY  AND  PS-END-OF-INPUT-NO                  05270000
052800         SET PS-NEW-PO-KEY-NO                                     05280000
052900             PS-AUDIT-CNPO-NO                                     05290000
053000             PS-GOOD-CNPO-UPDATE-NO   TO TRUE                     05300000
053100         MOVE TR026-ETA-EXTL-REF-NBR  TO IMCNPO-EXTL-REF-NBR      05310000
053200         MOVE TR026-ETA-PO-NBR        TO IMCNPO-PO-NBR            05320000
053300         PERFORM 7100-SELECT-TIMCNPO                              05330000
053400         PERFORM 5110-MOVE-TIMCNPO-TO-TAUCNPO                     05340000
053500         PERFORM 5210-MOVE-TIMCNPO-TO-HOLD                        05350000
053600       END-IF                                                     05360000
053700     END-IF.                                                      05370000
053800***************************************************************** 05380000
053900* SETUP THE DCLGEN FIELDS PRIOR TO UPDATE BY MOVING THE FIELDS  * 05390000
054000* THAT ARE UNIQUE TO EACH RECORD TYPE.                          * 05400000
054100*                                                               * 05410000
054200*    BECAUSE MULTIPLE PO'S CAN EXIST ON A CONTAINER WE          * 05420000
054300*    CAN HAVE MULTIPLE CHANGES PER CONTAINER ROW. WE            * 05430000
054400*    ONLY WANT TO USE THE LAST RECORD IN THOUGH, SO WE          * 05440000
054500*    SIMPLY OVERLAY DATA BEING HELD FOR UPDATE WITH DATA        * 05450000
054600*    FROM THE CURRENT RECORD.  THE SAME LOGIC HOLDS TRUE        * 05460000
054700*    FOR ADDS.                                                  * 05470000
054800*                                                               * 05480000
054900***************************************************************** 05490000
055000                                                                  05500000
055100 2300-MOVE-TO-TIMCNTK-DCLGEN.                                     05510000
055200                                                                  05520000
055300     EVALUATE TR026-ETA-REC-TYP-CDE                               05530000
055400                                                                  05540000
055500*        ---------------------------------------------------      05550000
055600*        -  NOTE: ETA RECORDS CAN ONLY BE CHANGE, NOT ADD. -      05560000
055700*        ---------------------------------------------------      05570000
055800         WHEN PC-ETA                                              05580000
055900                                                                  05590000
056000            MOVE TR026-ETA-FILE-ID TO PV-HLD-FILE-ID              05600000
056100            MOVE TR026-ETA-EST-POE-DELY-DTE (1:4) TO              05610000
056200                   PV-FORMAT-TMST-DTE-CY                          05620000
056300            MOVE TR026-ETA-EST-POE-DELY-DTE (5:2) TO              05630000
056400                   PV-FORMAT-TMST-DTE-MM                          05640000
056500            MOVE TR026-ETA-EST-POE-DELY-DTE (7:2) TO              05650000
056600                   PV-FORMAT-TMST-DTE-DD                          05660000
056700            MOVE TR026-ETA-EST-POE-DELY-TM (1:2)   TO             05670000
056800                   PV-FORMAT-TMST-TM-HH                           05680000
056900            MOVE TR026-ETA-EST-POE-DELY-TM (3:2)   TO             05690000
057000                   PV-FORMAT-TMST-TM-MM                           05700000
057100                                                                  05710000
057200            IF IMCNTK-MOM-POE-DELY-TMST                           05720000
057300                                   NOT =  PV-FORMAT-TMST          05730000
057400              MOVE PV-FORMAT-TMST                                 05740000
057500                            TO PV-HLD-MOM-POE-DELY-TMST           05750000
057600              MOVE IMCNTK-MOM-POE-DELY-TMST                       05760000
057700                            TO PV-HLD-PRV-MOM-POE-DELY-TMST       05770000
057800              SET PS-GOOD-CNTK-UPDATE    TO TRUE                  05780000
057900              SET PS-ETA-CHANGE-YES      TO TRUE                  05790000
058000            ELSE                                                  05800000
058100              MOVE IMCNTK-MOM-POE-DELY-TMST                       05810000
058200                            TO PV-HLD-MOM-POE-DELY-TMST           05820000
058300                               PV-HLD-PRV-MOM-POE-DELY-TMST       05830000
058400            END-IF                                                05840000
058500                                                                  05850000
058600            IF IMCNTK-MOM-DEST-POE-CDE                            05860000
058700                           NOT =   TR026-ETA-DEST-POE-CDE-MOM     05870000
058800              MOVE TR026-ETA-DEST-POE-CDE-MOM                     05880000
058900                                   TO PV-HLD-MOM-DEST-POE-CDE     05890000
059000              MOVE IMCNTK-MOM-DEST-POE-CDE                        05900000
059100                              TO PV-HLD-PRV-MOM-DEST-POE-CDE      05910000
059200              SET PS-GOOD-CNTK-UPDATE    TO TRUE                  05920000
059300              SET PS-ETA-CHANGE-YES      TO TRUE                  05930000
059400            END-IF                                                05940000
059500***                                                               05950000
059600***         IF PV-HLD-EST-LBD-NM                                  05960000
059700***                        NOT =   TR026-ETA-EST-LBD-NM           05970000
059800***           MOVE TR026-ETA-EST-LBD-NM                           05980000
059900***                                TO PV-HLD-EST-LBD-NM           05990000
060000***           SET PS-GOOD-CNTK-UPDATE    TO TRUE                  06000000
060100***         END-IF                                                06010000
060200***                                                               06020000
060300***         MOVE TR026-ETA-EST-LBD-DTE (1:4) TO                   06030000
060400***                PV-FORMAT-TMST-DTE-CY                          06040000
060500***         MOVE TR026-ETA-EST-LBD-DTE (5:2) TO                   06050000
060600***                PV-FORMAT-TMST-DTE-MM                          06060000
060700***         MOVE TR026-ETA-EST-LBD-DTE (7:2) TO                   06070000
060800***                PV-FORMAT-TMST-DTE-DD                          06080000
060900***         MOVE TR026-ETA-EST-LBD-TM (1:2)  TO                   06090000
061000***                PV-FORMAT-TMST-TM-HH                           06100000
061100***         MOVE TR026-ETA-EST-LBD-TM (3:2)  TO                   06110000
061200***                PV-FORMAT-TMST-TM-MM                           06120000
061300                                                                  06130000
061400                                                                  06140000
061500***         IF IMCNTK-EST-LBD-TMST NOT =   PV-FORMAT-TMST         06150000
061600***           MOVE PV-FORMAT-TMST   TO PV-HLD-EST-LBD-TMST        06160000
061700***           SET PS-GOOD-CNTK-UPDATE    TO TRUE                  06170000
061800***         END-IF                                                06180000
061900                                                                  06190000
062000                                                                  06200000
062100*        ---------------------------------------------------      06210000
062200         WHEN PC-ADU                                              06220000
062300                                                                  06230000
062400             MOVE TR026-ADU-ACTL-POE-DELY-DTE (1:4) TO            06240000
062500                   PV-FORMAT-TMST-DTE-CY                          06250000
062600             MOVE TR026-ADU-ACTL-POE-DELY-DTE (5:2) TO            06260000
062700                   PV-FORMAT-TMST-DTE-MM                          06270000
062800             MOVE TR026-ADU-ACTL-POE-DELY-DTE (7:2) TO            06280000
062900                   PV-FORMAT-TMST-DTE-DD                          06290000
063000             MOVE TR026-ADU-ACTL-POE-DELY-TM (1:2)  TO            06300000
063100                   PV-FORMAT-TMST-TM-HH                           06310000
063200             MOVE TR026-ADU-ACTL-POE-DELY-TM (3:2)  TO            06320000
063300                   PV-FORMAT-TMST-TM-MM                           06330000
063400                                                                  06340000
063500            IF PV-HLD-ACTL-POE-DELY-CDE = SPACES                  06350000
063600              MOVE PC-Y         TO PV-HLD-ACTL-POE-DELY-CDE       06360000
063700              SET PS-GOOD-CNPO-UPDATE                             06370000
063800                  PS-AUDIT-CNPO            TO TRUE                06380000
063900            END-IF                                                06390000
064000                                                                  06400000
064100            IF TR026-ETA-TRN-TYP-ADD                              06410000
064200              IF IMCNTK-ACTL-POE-DELY-TMST = PC-DEFAULT-TMST      06420000
064300                MOVE PV-FORMAT-TMST                               06430000
064400                                TO PV-HLD-ACTL-POE-DELY-TMST      06440000
064500                SET PS-GOOD-CNTK-INSERT    TO TRUE                06450000
064600              END-IF                                              06460000
064700              IF IMCNTK-ACTL-DEST-POE-CDE = SPACES                06470000
064800                MOVE TR026-ADU-ACTL-DEST-POE-CDE                  06480000
064900                                TO PV-HLD-ACTL-DEST-POE-CDE       06490000
065000                SET PS-GOOD-CNTK-INSERT    TO TRUE                06500000
065100              END-IF                                              06510000
065200            END-IF                                                06520000
065300                                                                  06530000
065400            IF TR026-ETA-TRN-TYP-CHG                              06540000
065500              IF IMCNTK-ACTL-DEST-POE-CDE                         06550000
065600                        NOT =   TR026-ADU-ACTL-DEST-POE-CDE       06560000
065700                MOVE TR026-ADU-ACTL-DEST-POE-CDE                  06570000
065800                                TO PV-HLD-ACTL-DEST-POE-CDE       06580000
065900                SET PS-GOOD-CNTK-UPDATE    TO TRUE                06590000
066000              END-IF                                              06600000
066100              IF IMCNTK-ACTL-POE-DELY-TMST                        06610000
066200                                     NOT =   PV-FORMAT-TMST       06620000
066300                MOVE PV-FORMAT-TMST                               06630000
066400                               TO PV-HLD-ACTL-POE-DELY-TMST       06640000
066500                SET PS-GOOD-CNTK-UPDATE    TO TRUE                06650000
066600              END-IF                                              06660000
066700            END-IF                                                06670000
066800                                                                  06680000
066900*        ---------------------------------------------------      06690000
067000         WHEN PC-ADURDA                                           06700000
067100                                                                  06710000
067200             MOVE TR026-ADURD-ACTL-POE-DELY-DTE (1:4) TO          06720000
067300                   PV-FORMAT-TMST-DTE-CY                          06730000
067400             MOVE TR026-ADURD-ACTL-POE-DELY-DTE (5:2) TO          06740000
067500                   PV-FORMAT-TMST-DTE-MM                          06750000
067600             MOVE TR026-ADURD-ACTL-POE-DELY-DTE (7:2) TO          06760000
067700                   PV-FORMAT-TMST-DTE-DD                          06770000
067800             MOVE TR026-ADURD-ACTL-POE-DELY-TM (1:2)  TO          06780000
067900                   PV-FORMAT-TMST-TM-HH                           06790000
068000             MOVE TR026-ADURD-ACTL-POE-DELY-TM (3:2)  TO          06800000
068100                   PV-FORMAT-TMST-TM-MM                           06810000
068200                                                                  06820000
068300             IF PV-HLD-ACTL-POE-DELY-CDE = SPACES                 06830000
068400               MOVE PC-Y        TO PV-HLD-ACTL-POE-DELY-CDE       06840000
068500               SET PS-GOOD-CNPO-UPDATE      TO TRUE               06850000
068600             END-IF                                               06860000
068700                                                                  06870000
068800             IF TR026-ADURD-TRN-TYP-ADD                           06880000
068900               IF IMCNTK-ACTL-POE-DELY-TMST = PC-DEFAULT-TMST     06890000
069000                 MOVE PV-FORMAT-TMST                              06900000
069100                                TO PV-HLD-ACTL-POE-DELY-TMST      06910000
069200                 SET PS-GOOD-CNTK-INSERT    TO TRUE               06920000
069300               END-IF                                             06930000
069400               IF IMCNTK-ACTL-DEST-POE-CDE = SPACES               06940000
069500                 MOVE TR026-ADURD-ACTL-DEST-POE-CDE               06950000
069600                                TO PV-HLD-ACTL-DEST-POE-CDE       06960000
069700                 SET PS-GOOD-CNTK-INSERT    TO TRUE               06970000
069800               END-IF                                             06980000
069900             END-IF                                               06990000
070000                                                                  07000000
070100     END-EVALUATE.                                                07010000
070200                                                                  07020000
070300 EJECT                                                            07030000
070400***************************************************************** 07040000
070500* SETUP THE DCLGEN FIELDS PRIOR TO DELETE BY DEFAULTS TO THE    * 07050000
070600* FIELDS THAT ARE UNIQUE TO EACH RECORD TYPE.                   * 07060000
070700***************************************************************** 07070000
070800                                                                  07080000
070900 2400-MOVE-TO-TIMCNTK-DCLGEN-D.                                   07090000
071000                                                                  07100000
071100                                                                  07110000
071200     EVALUATE TR026-ETA-REC-TYP-CDE                               07120000
071300                                                                  07130000
071400*        ---------------------------------------------------      07140000
071500         WHEN PC-ETA                                              07150000
071600                                                                  07160000
071700             IF PV-HLD-MOM-POE-DELY-TMST                          07170000
071800                                      NOT =    PC-DEFAULT-TMST    07180000
071900               MOVE  PC-DEFAULT-TMST                              07190000
072000                                  TO PV-HLD-MOM-POE-DELY-TMST     07200000
072100               SET PS-GOOD-CNTK-DELETE TO TRUE                    07210000
072200             END-IF                                               07220000
072300***                                                               07230000
072400***          IF PV-HLD-EST-LBD-TMST                               07240000
072500***                                   NOT =    PC-DEFAULT-TMST    07250000
072600***            MOVE  PC-DEFAULT-TMST                              07260000
072700***                               TO PV-HLD-EST-LBD-TMST          07270000
072800***            SET PS-GOOD-CNTK-DELETE TO TRUE                    07280000
072900***          END-IF                                               07290000
073000                                                                  07300000
073100             IF PV-HLD-MOM-DEST-POE-CDE   NOT =  SPACES           07310000
073200               MOVE TR026-ETA-DEST-POE-CDE-MOM                    07320000
073300                                   TO PV-HLD-MOM-DEST-POE-CDE     07330000
073400               SET PS-GOOD-CNTK-DELETE TO TRUE                    07340000
073500             END-IF                                               07350000
073600                                                                  07360000
073700***          IF PV-HLD-EST-LBD-NM         NOT =  SPACES           07370000
073800***            MOVE TR026-ETA-EST-LBD-NM                          07380000
073900***                                TO PV-HLD-EST-LBD-NM           07390000
074000***            SET PS-GOOD-CNTK-DELETE TO TRUE                    07400000
074100***          END-IF                                               07410000
074200                                                                  07420000
074300                                                                  07430000
074400*        ---------------------------------------------------      07440000
074500         WHEN PC-ADU                                              07450000
074600                                                                  07460000
074700             IF PV-HLD-ACTL-POE-DELY-CDE NOT = SPACES             07470000
074800               MOVE SPACES        TO PV-HLD-ACTL-POE-DELY-CDE     07480000
074900               SET PS-GOOD-CNPO-UPDATE                            07490000
075000                   PS-AUDIT-CNPO           TO TRUE                07500000
075100             END-IF                                               07510000
075200                                                                  07520000
075300             PERFORM 7040-SELECT-TIMCNPO-COUNT                    07530000
075400             IF PV-CONTAINER-CNT = ZERO                           07540000
075500                 IF PV-HLD-ACTL-POE-DELY-TMST                     07550000
075600                                          NOT =    PC-DEFAULT-TMST07560000
075700                   MOVE  PC-DEFAULT-TMST                          07570000
075800                                      TO PV-HLD-ACTL-POE-DELY-TMST07580000
075900                   SET PS-GOOD-CNTK-DELETE TO TRUE                07590000
076000                 END-IF                                           07600000
076100                                                                  07610000
076200                 IF PV-HLD-ACTL-DEST-POE-CDE  NOT =  SPACES       07620000
076300                   MOVE TR026-ADU-ACTL-DEST-POE-CDE               07630000
076400                                       TO PV-HLD-ACTL-DEST-POE-CDE07640000
076500                   SET PS-GOOD-CNTK-DELETE TO TRUE                07650000
076600                 END-IF                                           07660000
076700             END-IF                                               07670000
076800                                                                  07680000
076900     END-EVALUATE.                                                07690000
077000                                                                  07700000
077100 EJECT                                                            07710000
077200******************************************************************07720000
077300* SPIN THRU INPUT FILE CREATING ERROR RECORDS UNTIL NEW CONTAINER.07730000
077400******************************************************************07740000
077500                                                                  07750000
077600 2500-SPIN-THRU-CONTAINER.                                        07760000
077700                                                                  07770000
077800     PERFORM 5000-MOVE-RPT-FIELDS.                                07780000
077900     PERFORM 7300-INSERT-TOUTTR8-RPT.                             07790000
078000                                                                  07800000
078100     SET PS-GOOD-RECORD-NO TO TRUE.                               07810000
078200     PERFORM 6000-READ-ARRIVAL-FILE                               07820000
078300         UNTIL PS-GOOD-RECORD  OR                                 07830000
078400               PS-END-OF-INPUT.                                   07840000
078500     PERFORM 2610-CHECK-FOR-CONTROL-BRK.                          07850000
078600                                                                  07860000
078700*    *---------------------------------------------------*        07870000
078800*    * IF NEW CONTAINER THEN WE'RE DONE SPINNING, ELSE   *        07880000
078900*    * THE ERROR MSG CHANGES WHEN THE TRAN TYPE CHANGES. *        07890000
079000*    *---------------------------------------------------*        07900000
079100     IF PS-NEW-CONTAINER                                          07910000
079200       CONTINUE                                                   07920000
079300     ELSE                                                         07930000
079400       IF PS-CONTROL-BREAK                                        07940000
079500         PERFORM 6307-CONTAINER-NOT-FOUND-MSG                     07950000
079600       END-IF                                                     07960000
079700     END-IF.                                                      07970000
079800                                                                  07980000
079900*************************************************************     07990000
080000* BEFORE THE NEXT READ CHECK IF THE KEY FIELDS HAVE CHANGED.*     08000000
080100* IF THEY HAVE, MOVE NEW FIELDS TO HOLD.                    *     08010000
080200*************************************************************     08020000
080300 2600-CHECK-HOLD-FIELDS.                                          08030000
080400                                                                  08040000
080500     IF PV-PREV-KEY-TRN-TYP        = TR026-ETA-TRN-TYP            08050000
080600      AND PV-PREV-KEY-CONTNR-ID    = TR026-ETA-CONTNR-ID          08060000
080700      AND PV-PREV-KEY-EXTL-REF-NBR = TR026-ETA-EXTL-REF-NBR       08070000
080800      AND PV-PREV-KEY-PO-NBR       = TR026-ETA-PO-NBR             08080000
080900        CONTINUE                                                  08090000
081000     ELSE                                                         08100000
081100        MOVE TR026-ETA-REC-KEY    TO PV-PREV-KEY                  08110000
081200     END-IF.                                                      08120000
081300                                                                  08130000
081400*************************************************************     08140000
081500* A CONTROL BREAK OCCURS IF TRAN TYPE, CONTAINER # OR CNTNR       08150000
081600* SEQ # CHANGE. YOU CAN HAVE A CONTROL BREAK WITHOUT HAVING       08160000
081700* A NEW CONTAINER ROW.                                            08170000
081800*************************************************************     08180000
081900 2610-CHECK-FOR-CONTROL-BRK.                                      08190000
082000                                                                  08200000
082100     EVALUATE TRUE                                                08210000
082200                                                                  08220000
082300      WHEN  PS-END-OF-INPUT                                       08230000
082400         CONTINUE                                                 08240000
082500                                                                  08250000
082600      WHEN TR026-ETA-CONTNR-ID     NOT =  PV-PREV-KEY-CONTNR-ID   08260000
082700      WHEN TR026-ETA-CONTNR-SEQ    NOT =  PV-PREV-KEY-CONTNR-SEQ  08270000
082800       SET  PS-NEW-CONTAINER       TO TRUE                        08280000
082900       SET  PS-NEW-PO-KEY          TO TRUE                        08290000
083000       SET  PS-CONTROL-BREAK       TO TRUE                        08300000
083100                                                                  08310000
083200      WHEN TR026-ETA-PO-NBR        NOT =  PV-PREV-KEY-PO-NBR      08320000
083300       SET  PS-NEW-PO-KEY          TO TRUE                        08330000
083400                                                                  08340000
083500     END-EVALUATE.                                                08350000
083600                                                                  08360000
083700                                                                  08370000
083800     EVALUATE TRUE                                                08380000
083900                                                                  08390000
084000      WHEN  PS-END-OF-INPUT                                       08400000
084100         CONTINUE                                                 08410000
084200                                                                  08420000
084300      WHEN TR026-ETA-TRN-TYP       NOT =  PV-PREV-KEY-TRN-TYP     08430000
084400       SET  PS-CONTROL-BREAK        TO TRUE                       08440000
084500       MOVE TR026-ETA-TRN-TYP       TO PV-PREV-KEY-TRN-TYP        08450000
084600                                                                  08460000
084700     END-EVALUATE.                                                08470000
084800                                                                  08480000
084900                                                                  08490000
085000                                                                  08500000
085100******************************************************************08510000
085200*    FORMAT MQ MESSAGE FOR AN ADD                                *08520000
085300******************************************************************08530000
085400                                                                  08540000
085500 2620-ADD-SCM-ARRIVAL-MSG.                                        08550000
085600     IF TR026-ADU-TRN-TYP-ADD                                     08560000
085700      IF TR026-ADU-REC-TYP-CDE-ADU                                08570000
085800       INITIALIZE TR405-MESSAGE-LAYOUT                            08580000
085900       MOVE 'A'                         TO TR405-ACTN-CDE         08590000
086000       MOVE 'CONTNR ARRIVED AT POE'     TO TR405-EVENT-TYP        08600000
086100       MOVE TR026-ADU-PO-NBR            TO TR405-PO-NBR           08610000
086200       MOVE TR026-ADU-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR     08620000
086300       MOVE TR026-ADU-CONTNR-ID         TO TR405-CONTNR-ID        08630000
086400       MOVE TR026-ADU-ACTL-POE-DELY-DTE TO TR405-EVENT-DTE        08640000
086500       MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR   08650000
086600       MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 08660000
086700       MOVE TR405-MESSAGE-LAYOUT TO TRT00037-CKPR-REC-1-TXT       08670000
086800       PERFORM 7500-INSERT-SCM-MESSAGE                            08680000
086900      ELSE                                                        08690000
087000      IF TR026-ADURD-REC-TYP-CDE-ADURDA                           08700000
087100       INITIALIZE TR405-MESSAGE-LAYOUT                            08710000
087200       MOVE 'A'                           TO TR405-ACTN-CDE       08720000
087300       MOVE 'CONTNR ARRIVED AT POE'       TO TR405-EVENT-TYP      08730000
087400       MOVE TR026-ADURD-PO-NBR            TO TR405-PO-NBR         08740000
087500       MOVE TR026-ADURD-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR   08750000
087600       MOVE TR026-ADURD-CONTNR-ID         TO TR405-CONTNR-ID      08760000
087700       MOVE PV-HLD-CONTNR-SEQ-NBR         TO TR405-CONTNR-SEQ-NBR 08770000
087800       MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 08780000
087900       MOVE TR026-ADURD-ACTL-POE-DELY-DTE TO TR405-EVENT-DTE      08790000
088000       MOVE TR405-MESSAGE-LAYOUT TO TRT00037-CKPR-REC-1-TXT       08800000
088001       PERFORM 7500-INSERT-SCM-MESSAGE.                           08800100
088002                                                                  08800200
088003                                                                  08800300
088004                                                                  08800400
088005******************************************************************08800500
088006*    FORMAT MQ MESSAGE FOR A CHANGE                              *08800600
088007******************************************************************08800700
088008                                                                  08800800
088009 2625-CHG-SCM-ARRIVAL-MSG.                                        08800900
088010     IF TR026-ADU-TRN-TYP-CHG                                     08801000
088020      IF TR026-ADU-REC-TYP-CDE-ADU                                08802000
088030       INITIALIZE TR405-MESSAGE-LAYOUT                            08803000
088040       MOVE 'CONTNR ARRIVED AT POE'     TO TR405-EVENT-TYP        08804000
088050       MOVE TR026-ADU-PO-NBR            TO TR405-PO-NBR           08805000
088060       MOVE TR026-ADU-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR     08806000
088070       MOVE TR026-ADU-CONTNR-ID         TO TR405-CONTNR-ID        08807000
088080       MOVE TR026-ADU-ACTL-POE-DELY-DTE TO TR405-EVENT-DTE        08808000
088090       MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR   08809000
088100       MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 08810000
088200*  PV-FORMAT-TMST-DTE CONTAINS THE TR026-ADU-ACTL-POE-DELY-DTE    08820000
088300*     REFORMATTED INTO HE DB2 DATE FORMAT.                        08830000
088400* IMCNTK-ACTL-POE-DELY-TMST CONTAINS THE DATE ON THE TIMCNTK      08840000
088500* TABLE BEFORE IT IS UPDATED.                                     08850000
088600       IF PV-FORMAT-TMST-DTE (1:10) NOT =                         08860000
088700                             IMCNTK-ACTL-POE-DELY-TMST (1:10)     08870000
088800         IF PV-FORMAT-TMST-DTE (1:10) = PC-DEFAULT-TMST (1:10)    08880000
088900           MOVE 'D'                         TO TR405-ACTN-CDE     08890000
089000           MOVE TR405-MESSAGE-LAYOUT TO TRT00037-CKPR-REC-1-TXT   08900000
089100           PERFORM 7500-INSERT-SCM-MESSAGE                        08910000
089200         ELSE                                                     08920000
089300           IF IMCNTK-ACTL-POE-DELY-TMST = PC-DEFAULT-TMST         08930000
089400             MOVE 'A'                         TO TR405-ACTN-CDE   08940000
089500             MOVE TR405-MESSAGE-LAYOUT TO TRT00037-CKPR-REC-1-TXT 08950000
089600             PERFORM 7500-INSERT-SCM-MESSAGE                      08960000
089700           ELSE                                                   08970000
089800             MOVE 'C'                         TO TR405-ACTN-CDE   08980000
089900             MOVE TR405-MESSAGE-LAYOUT TO TRT00037-CKPR-REC-1-TXT 08990000
089901             PERFORM 7500-INSERT-SCM-MESSAGE.                     08990100
089902******************************************************************08990200
089903*    FORMAT MQ MESSAGE FOR A DELETE                              *08990300
089904******************************************************************08990400
089905                                                                  08990500
089906 2630-DEL-SCM-ARRIVAL-MSG.                                        08990600
089907     IF TR026-ADU-TRN-TYP-DEL                                     08990700
089908      IF TR026-ADU-REC-TYP-CDE-ADU                                08990800
089909       INITIALIZE TR405-MESSAGE-LAYOUT                            08990900
089910       MOVE 'D'                         TO TR405-ACTN-CDE         08991000
089920       MOVE 'CONTNR ARRIVED AT POE'     TO TR405-EVENT-TYP        08992000
089930       MOVE TR026-ADU-PO-NBR            TO TR405-PO-NBR           08993000
089940       MOVE TR026-ADU-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR     08994000
089950       MOVE TR026-ADU-CONTNR-ID         TO TR405-CONTNR-ID        08995000
089960       MOVE TR026-ADU-ACTL-POE-DELY-DTE TO TR405-EVENT-DTE        08996000
089970       MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR   08997000
089980       MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE 08998000
089990       MOVE TR405-MESSAGE-LAYOUT TO TRT00037-CKPR-REC-1-TXT       08999000
089991       PERFORM 7500-INSERT-SCM-MESSAGE.                           08999100
089992******************************************************************08999200
089993*    SELECT CHECKPOINT RESTART CONTROL INFORMATION.              *08999300
089994******************************************************************08999400
089995 4000-GET-CHECKPOINT-CNTL.                                        08999500
089996                                                                  08999600
089997     PERFORM WITH TEST AFTER                                      08999700
089998         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     08999800
089999         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             08999900
090000                 SQLCODE = ZERO                                   09000000
090001                                                                  09000100
090002         EXEC SQL                                                 09000200
090003           SELECT  CKPT_STAT_CODE                                 09000300
090004             INTO :PV-CKPT-STAT-CODE                              09000400
090005             FROM  TCKRSTCNTL                                     09000500
090006            WHERE  PLAN_NAME = :PC-CURRENT-PROGRAM-NAME           09000600
090007         END-EXEC                                                 09000700
090008                                                                  09000800
090009         EVALUATE TRUE                                            09000900
090010             WHEN SQLCODE = ZERO                                  09001000
090011             WHEN SQLCODE = -904                                  09001100
090012             WHEN SQLCODE = -913                                  09001200
090013                  CONTINUE                                        09001300
090014                                                                  09001400
090015             WHEN SQLWARN0 NOT EQUAL SPACE                        09001500
090016             WHEN SQLCODE NOT EQUAL ZERO                          09001600
090017                 DISPLAY '**************************************' 09001700
090018                 DISPLAY '** ABEND                            **' 09001800
090019                 DISPLAY '** PROGRAM = TRKUP235               **' 09001900
090020                 DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT- **' 09002000
090021                 DISPLAY '**                  CNTL            **' 09002100
090022                 DISPLAY '** SELECT FROM TCKRSTCNTL           **' 09002200
090023                 DISPLAY '**CKPT-STAT-CODE ='                     09002300
090024                 DISPLAY              TCKRSTCNTL-CKPT-STAT-CODE   09002400
090025                 DISPLAY '**************************************' 09002500
090026                 PERFORM 9100-SQL-ABEND                           09002600
090027         END-EVALUATE                                             09002700
090028     END-PERFORM.                                                 09002800
090029                                                                  09002900
090030     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09003000
090031         SQLCODE NOT = ZERO                                       09003100
090032         DISPLAY '****************************************'       09003200
090033         DISPLAY '** MAX RETRIES EXCEEDED ON SELECT     **'       09003300
090034         DISPLAY '** FROM TCKRSTCNTL                    **'       09003400
090035         DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT-CNTL*'       09003500
090036         DISPLAY '****************************************'       09003600
090100         PERFORM 9100-SQL-ABEND                                   09010000
090200     END-IF.                                                      09020000
090300                                                                  09030000
090400 EJECT                                                            09040000
090500                                                                  09050000
090600******************************************************************09060000
090700*    SELECT CHECKPOINT RESTART WORKING STORAGE DESCRIPTION INFO  *09070000
090800******************************************************************09080000
090900 4010-GET-CHECKPOINT-INFO.                                        09090000
091000                                                                  09100000
091100     PERFORM                                                      09110000
091200         WITH TEST AFTER                                          09120000
091300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     09130000
091400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            09140000
091500                 SQLCODE = ZERO                                   09150000
091600                                                                  09160000
091700         EXEC SQL                                                 09170000
091800           SELECT WORK_STRG_DESC                                  09180000
091900           INTO :TCKRSTINF-WORK-STRG-DESC                         09190000
092000           FROM TCKRSTINF                                         09200000
092100           WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME             09210000
092200         END-EXEC                                                 09220000
092300                                                                  09230000
092400         EVALUATE TRUE                                            09240000
092500             WHEN SQLCODE = ZERO                                  09250000
092600             WHEN SQLCODE = -904                                  09260000
092700             WHEN SQLCODE = -913                                  09270000
092800                  CONTINUE                                        09280000
092900                                                                  09290000
093000             WHEN SQLWARN0 NOT EQUAL SPACE                        09300000
093100             WHEN SQLCODE NOT EQUAL ZERO                          09310000
093200                 DISPLAY '**************************************' 09320000
093300                 DISPLAY '** ABEND                            **' 09330000
093400                 DISPLAY '** PROGRAM = TRKUP235               **' 09340000
093500                 DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT- **' 09350000
093600                 DISPLAY '**                  INFO            **' 09360000
093700                 DISPLAY '** SELECT FROM TCKRSTINF            **' 09370000
093800                 DISPLAY '**************************************' 09380000
093900                 PERFORM 9100-SQL-ABEND                           09390000
094000         END-EVALUATE                                             09400000
094100     END-PERFORM.                                                 09410000
094200                                                                  09420000
094300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09430000
094400         SQLCODE NOT = ZERO                                       09440000
094500         DISPLAY '****************************************'       09450000
094600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09460000
094700         DISPLAY '** SELECT FROM TCKRSTINF              **'       09470000
094800         DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT-INFO*'       09480000
094900         DISPLAY '****************************************'       09490000
095000         PERFORM 9100-SQL-ABEND                                   09500000
095100     END-IF.                                                      09510000
095200                                                                  09520000
095300 EJECT                                                            09530000
095400******************************************************************09540000
095500*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *09550000
095600******************************************************************09560000
095700 4020-SET-COMMIT-TIME.                                            09570000
095800                                                                  09580000
095900      EXEC SQL                                                    09590000
096000          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    09600000
096100          INTO :PV-HOLD-TMST                                      09610000
096200          FROM TCKRSTCNTL                                         09620000
096300          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              09630000
096400      END-EXEC.                                                   09640000
096500                                                                  09650000
096600     EVALUATE TRUE                                                09660000
096700         WHEN SQLWARN0 NOT EQUAL SPACE                            09670000
096800         WHEN SQLCODE NOT EQUAL ZERO                              09680000
096900     DISPLAY '**********************************'                 09690000
097000     DISPLAY '** ABEND **'                                        09700000
097100     DISPLAY '** PROGRAM = TRKUP235 **'                           09710000
097200     DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME**'              09720000
097300     DISPLAY '**UNSUCESSFUL SET OF COMMIT INTERVAL**'             09730000
097400     DISPLAY 'IMCNTK CONTAINER ID    = ' IMCNTK-CONTNR-ID         09740000
097500     DISPLAY 'IMCNTK CNTR SEQ NBR   = '                           09750000
097600                IMCNTK-CONTNR-SEQ-NBR                             09760000
097700     DISPLAY 'ARRIVAL INPUT COUNT    = ' PA-TOTAL-RECS-READ       09770000
097800     DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES      09780000
097900     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS     09790000
098000     DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES      09800000
098100     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS     09810000
098200     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         09820000
098300     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED     09830000
098400     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     09840000
098500     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    09850000
098600     DISPLAY '**********************************'                 09860000
098700                                                                  09870000
098800             PERFORM 9100-SQL-ABEND                               09880000
098900     END-EVALUATE.                                                09890000
099000                                                                  09900000
099100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    09910000
099200         SQLCODE NOT = ZERO                                       09920000
099300         DISPLAY '****************************************'       09930000
099400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       09940000
099500         DISPLAY '** SELECT FROM TCKRSTCNTL             **'       09950000
099600         DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME   **'       09960000
099700         DISPLAY '****************************************'       09970000
099800         PERFORM 9100-SQL-ABEND                                   09980000
099900     END-IF.                                                      09990000
100000                                                                  10000000
100100 EJECT                                                            10010000
100200******************************************************************10020000
100300*    CHECK TO SEE IF A COMMIT SHOULD BE TAKEN.                   *10030000
100400******************************************************************10040000
100500 4100-COMMIT-CHECK.                                               10050000
100600                                                                  10060000
100700     EXEC SQL                                                     10070000
100800       SET :PV-TMST = CURRENT TIMESTAMP                           10080000
100900     END-EXEC.                                                    10090000
101000                                                                  10100000
101100     EVALUATE TRUE                                                10110000
101200         WHEN SQLWARN0 NOT EQUAL SPACE                            10120000
101300         WHEN SQLCODE NOT EQUAL ZERO                              10130000
101400     DISPLAY '**********************************'                 10140000
101500     DISPLAY '** ABEND **'                                        10150000
101600     DISPLAY '** PROGRAM = TRKUP235***'                           10160000
101700     DISPLAY '** PARAGRAPH = 4100-COMMIT-CHECK**'                 10170000
101800     DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'                  10180000
101900     DISPLAY 'IMCNTK CONTAINER ID    = ' IMCNTK-CONTNR-ID         10190000
102000     DISPLAY 'IMCNTK CNTR SEQ NBR   = '                           10200000
102100                IMCNTK-CONTNR-SEQ-NBR                             10210000
102200     DISPLAY 'ARRIVAL INPUT COUNT    = ' PA-TOTAL-RECS-READ       10220000
102300     DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES      10230000
102400     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS     10240000
102500     DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES      10250000
102600     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS     10260000
102700     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         10270000
102800     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED     10280000
102900     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     10290000
103000     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    10300000
103100     DISPLAY '**********************************'                 10310000
103200                                                                  10320000
103300             PERFORM 9100-SQL-ABEND                               10330000
103400     END-EVALUATE.                                                10340000
103500                                                                  10350000
103600     IF PV-TMST > PV-HOLD-TMST                                    10360000
103700         IF NO-COMMITS-TAKEN                                      10370000
103800             MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE         10380000
103900             PERFORM 4200-UPDATE-TCKRSTCNTL                       10390000
104000             SET COMMITS-TAKEN TO TRUE                            10400000
104100         END-IF                                                   10410000
104200        PERFORM 4210-UPDATE-TCKRSTINF                             10420000
104300        PERFORM 4300-COMMIT                                       10430000
104400        DISPLAY 'COMMIT TAKEN AT '                                10440000
104500        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)10450000
104600         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)10460000
104700        DISPLAY 'IMCNTK CONTAINER ID    = ' PV-HLD-CONTNR-ID      10470000
104800        DISPLAY 'IMCNTK CNTR SEQ NBR    = '                       10480000
104900                                         PV-HLD-CONTNR-SEQ-NBR    10490000
105000        DISPLAY 'ARRIVAL INPUT COUNT    = ' PA-TOTAL-RECS-READ    10500000
105100        DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES   10510000
105200        DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS  10520000
105300        DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES   10530000
105400        DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS  10540000
105500        DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS      10550000
105600        DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED  10560000
105700        DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT  10570000
105800        DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT 10580000
105900        DISPLAY '**********************************'              10590000
106000        PERFORM 4020-SET-COMMIT-TIME                              10600000
106100     END-IF.                                                      10610000
106200                                                                  10620000
106300 EJECT                                                            10630000
106400******************************************************************10640000
106500*    CHECK TO SEE IF A CHECKPOINT RESTART SHOULD BE DONE.        *10650000
106600******************************************************************10660000
106700 4110-CHECKPOINT-RESTART.                                         10670000
106800                                                                  10680000
106900     PERFORM 4010-GET-CHECKPOINT-INFO.                            10690000
107000     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.     10700000
107100                                                                  10710000
107200     DISPLAY '***********************************************'.   10720000
107300     DISPLAY '** TRKUP235 CHECKPOINT RESTART **'.                 10730000
107400     DISPLAY '** ARRIVAL RECS BYPASSED ON RESTART = '.            10740000
107500     DISPLAY  CR-ARRIVAL-RECS-WORKED.                             10750000
107600     DISPLAY '***********************************************'.   10760000
107700                                                                  10770000
107800     IF INPUT-ARRIVAL-FILE                                        10780000
107900         PERFORM 6000-READ-ARRIVAL-FILE                           10790000
108000             CR-ARRIVAL-RECS-WORKED TIMES                         10800000
108100     ELSE                                                         10810000
108200         MOVE CR-ARRIVAL-RECS-WORKED TO PA-TOTAL-RECS-READ        10820000
108300         SET PS-END-OF-INPUT TO TRUE                              10830000
108400     END-IF.                                                      10840000
108500                                                                  10850000
108600 EJECT                                                            10860000
108700******************************************************************10870000
108800*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *10880000
108900*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *10890000
109000******************************************************************10900000
109100 4200-UPDATE-TCKRSTCNTL.                                          10910000
109200                                                                  10920000
109300     PERFORM WITH TEST AFTER                                      10930000
109400             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 10940000
109500             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         10950000
109600                     SQLCODE = ZERO                               10960000
109700                                                                  10970000
109800         EXEC SQL                                                 10980000
109900             UPDATE TCKRSTCNTL                                    10990000
110000             SET CKPT_STAT_CODE = :PV-CKPT-STAT-CODE              11000000
110100             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME      11010000
110200         END-EXEC                                                 11020000
110300                                                                  11030000
110400         EVALUATE TRUE                                            11040000
110500             WHEN SQLCODE = ZERO                                  11050000
110600             WHEN SQLCODE = -904                                  11060000
110700             WHEN SQLCODE = -913                                  11070000
110800                  CONTINUE                                        11080000
110900                                                                  11090000
111000             WHEN SQLWARN0 NOT EQUAL SPACE                        11100000
111100             WHEN SQLCODE NOT EQUAL ZERO                          11110000
111200                 DISPLAY '**************************************' 11120000
111300                 DISPLAY '** ABEND                            **' 11130000
111400                 DISPLAY '** PROGRAM = TRKUP235               **' 11140000
111500                 DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL*' 11150000
111600                 DISPLAY '** UPDATE TCKRSTCNTL                **' 11160000
111700                 DISPLAY '**' PV-CKPT-STAT-CODE                   11170000
111800                 DISPLAY '**************************************' 11180000
111900                 PERFORM 9100-SQL-ABEND                           11190000
112000         END-EVALUATE                                             11200000
112100     END-PERFORM.                                                 11210000
112200                                                                  11220000
112300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11230000
112400         SQLCODE NOT = ZERO                                       11240000
112500         DISPLAY '****************************************'       11250000
112600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11260000
112700         DISPLAY '** UPDATE TO TCKRSTCNTL               **'       11270000
112800         DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL **'       11280000
112900         DISPLAY '**' PV-CKPT-STAT-CODE                           11290000
113000         DISPLAY '****************************************'       11300000
113100         PERFORM 9100-SQL-ABEND                                   11310000
113200     END-IF.                                                      11320000
113300                                                                  11330000
113400 EJECT                                                            11340000
113500******************************************************************11350000
113600*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING     *11360000
113700*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE CURRENT INPUT *11370000
113800*    FILE RECORD COUNTS AND THE FILE PROCESSOR INDICATOR.        *11380000
113900******************************************************************11390000
114000 4210-UPDATE-TCKRSTINF.                                           11400000
114100                                                                  11410000
114200     MOVE PA-TOTAL-RECS-READ  TO CR-ARRIVAL-RECS-WORKED.          11420000
114300     MOVE CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.   11430000
114400     MOVE 4022                TO TCKRSTINF-WORK-STRG-DESC-LEN.    11440000
114500                                                                  11450000
114600     PERFORM WITH TEST AFTER                                      11460000
114700             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 11470000
114800             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         11480000
114900                     SQLCODE = ZERO                               11490000
115000                                                                  11500000
115100         EXEC SQL                                                 11510000
115200             UPDATE TCKRSTINF                                     11520000
115300             SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC     11530000
115400             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME      11540000
115500         END-EXEC                                                 11550000
115600                                                                  11560000
115700         EVALUATE TRUE                                            11570000
115800             WHEN SQLCODE = ZERO                                  11580000
115900             WHEN SQLCODE = -904                                  11590000
116000             WHEN SQLCODE = -913                                  11600000
116100                  CONTINUE                                        11610000
116200                                                                  11620000
116300             WHEN SQLWARN0 NOT EQUAL SPACE                        11630000
116400             WHEN SQLCODE NOT EQUAL ZERO                          11640000
116500                 DISPLAY '**************************************' 11650000
116600                 DISPLAY '** ABEND                            **' 11660000
116700                 DISPLAY '** PROGRAM = TRKUP235               **' 11670000
116800                 DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF**' 11680000
116900                 DISPLAY '** UPDATE TCKRSTINF                 **' 11690000
117000                 DISPLAY '**' TCKRSTINF-WORK-STRG-DESC            11700000
117100                 DISPLAY '**************************************' 11710000
117200                 PERFORM 9100-SQL-ABEND                           11720000
117300         END-EVALUATE                                             11730000
117400     END-PERFORM.                                                 11740000
117500                                                                  11750000
117600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11760000
117700         SQLCODE NOT = ZERO                                       11770000
117800         DISPLAY '****************************************'       11780000
117900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       11790000
118000         DISPLAY '** UPDATE TCKRSTINF                   **'       11800000
118100         DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF  **'       11810000
118200         DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                    11820000
118300         DISPLAY '****************************************'       11830000
118400         PERFORM 9100-SQL-ABEND                                   11840000
118500     END-IF.                                                      11850000
118600                                                                  11860000
118700 EJECT                                                            11870000
118800******************************************************************11880000
118900*  ISSUES AN SQL COMMIT AFTER A LOGICAL UNIT OF WORK HAS BEEN    *11890000
119000*  COMPLETED.                                                    *11900000
119100******************************************************************11910000
119200 4300-COMMIT.                                                     11920000
119300                                                                  11930000
119400     EXEC SQL                                                     11940000
119500         COMMIT                                                   11950000
119600     END-EXEC.                                                    11960000
119700                                                                  11970000
119800     EVALUATE TRUE                                                11980000
119900         WHEN SQLWARN0 NOT EQUAL SPACE                            11990000
120000         WHEN SQLCODE NOT EQUAL ZERO                              12000000
120100     DISPLAY '**********************************'                 12010000
120200     DISPLAY 'IMCNTK CONTAINER ID    = ' IMCNTK-CONTNR-ID         12020000
120300     DISPLAY 'IMCNTK CNTR SEQ NBR    = '                          12030000
120400                                         IMCNTK-CONTNR-SEQ-NBR    12040000
120500     DISPLAY 'ARRIVAL INPUT COUNT    = ' PA-TOTAL-RECS-READ       12050000
120600     DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES      12060000
120700     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS     12070000
120800     DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES      12080000
120900     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS     12090000
121000     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         12100000
121100     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED     12110000
121200     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     12120000
121300     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    12130000
121400     DISPLAY '**********************************'                 12140000
121500     DISPLAY '** ABEND **'                                        12150000
121600     DISPLAY '** PROGRAM = TRKUP235 **'                           12160000
121700     DISPLAY '** PARAGRAPH = 4300-COMMIT**'                       12170000
121800     DISPLAY '**UNSUCCESSFUL COMMIT**'                            12180000
121900     DISPLAY '**********************************'                 12190000
122000             PERFORM 9100-SQL-ABEND                               12200000
122100         WHEN SQLCODE EQUAL ZERO                                  12210000
122200             ADD +1 TO PA-TOTAL-COMMITS                           12220000
122300     END-EVALUATE.                                                12230000
122400                                                                  12240000
122500 EJECT                                                            12250000
122600***************************************************************** 12260000
122700* SETUP THE TR231 RECORD BY MOVING FIELDS THAT ARE INCLUDED IN  * 12270000
122800* BOTH DETAIL AND ERROR RECORDS.                                * 12280000
122900***************************************************************** 12290000
123000                                                                  12300000
123100 5000-MOVE-RPT-FIELDS.                                            12310000
123200                                                                  12320000
123300     MOVE TR026-ETA-TRN-TYP        TO TR231-TRN-TYP.              12330000
123400     MOVE TR026-ETA-CONTNR-ID      TO TR231-CONTNR-ID.            12340000
123500     MOVE TR026-ETA-TRIP-TYP-CDE-MOM                              12350000
123600                                   TO TR231-ETA-TRIP-TYP-CDE-MOM. 12360000
123700     MOVE TR026-ETA-EXTL-REF-NBR   TO TR231-EXTL-REF-NBR.         12370000
123800     MOVE TR026-ETA-PO-NBR         TO TR231-PO-NBR.               12380000
123900                                                                  12390000
124000     EVALUATE TR026-ETA-REC-TYP-CDE                               12400000
124100                                                                  12410000
124200*        ---------------------------------------------------      12420000
124300         WHEN PC-ETA                                              12430000
124400                                                                  12440000
124500             MOVE TR026-ETA-PROCESS-SEQ-NBR                       12450000
124600                        TO TR231-PROCESS-SEQ-NBR                  12460000
124700             MOVE PC-ETA                                          12470000
124800                        TO TR231-REC-TYP-ETA-CDE                  12480000
124900             MOVE PC-10                                           12490000
125000                        TO TR231-ETA-SEQ-NBR                      12500000
125100             MOVE TR026-ETA-CARR-SCAC-ID                          12510000
125200                        TO TR231-ETA-CARR-SCAC-ID                 12520000
125300             MOVE TR026-ETA-IMPRT-TRIP-ID                         12530000
125400                        TO TR231-ETA-IMPRT-TRIP-ID                12540000
125500             MOVE TR026-ETA-IMPRT-VEH-NM                          12550000
125600                        TO TR231-ETA-IMPRT-VEH-NM                 12560000
125700             MOVE TR026-ETA-FOB-CDE                               12570000
125800                        TO TR231-FOB-CDE                          12580000
125900             MOVE TR026-ETA-EXTENT-SCAC-CDE                       12590000
126000                        TO TR231-EXTENT-SCAC-CDE                  12600000
126100                                                                  12610000
126200             MOVE TR026-ETA-DEST-POE-NAME                         12620000
126300                        TO TR231-ETA-DEST-POE-NM                  12630000
126400                                                                  12640000
126500             MOVE TR026-ETA-EST-POE-DELY-DTE                      12650000
126600                        TO TR231-ETA-EST-POE-DELY-DTE             12660000
126700             MOVE TR026-ETA-EST-POE-DELY-TM                       12670000
126800                        TO TR231-ETA-EST-POE-DELY-TM              12680000
126810             MOVE TR026-ETA-DAT-SRC-ENT-ID                        12681000
126820                        TO TR231-DAT-SRC-ENT-ID                   12682000
126900***          MOVE TR026-ETA-EST-LBD-NM                            12690000
127000***                     TO TR231-ETA-EST-LBD-NM                   12700000
127100***          MOVE TR026-ETA-EST-LBD-DTE                           12710000
127200***                     TO TR231-ETA-EST-LBD-DTE                  12720000
127300***          MOVE TR026-ETA-EST-LBD-TM                            12730000
127400***                     TO TR231-ETA-EST-LBD-TM                   12740000
127500                                                                  12750000
127600*        ---------------------------------------------------      12760000
127700         WHEN PC-ADU                                              12770000
127800                                                                  12780000
127900             MOVE TR026-ADU-PROCESS-SEQ-NBR                       12790000
128000                        TO TR231-PROCESS-SEQ-NBR                  12800000
128100             MOVE PC-ADU                                          12810000
128200                        TO TR231-REC-TYP-ADU-CDE                  12820000
128300             MOVE PC-20                                           12830000
128400                        TO TR231-ADU-SEQ-NBR                      12840000
128500             MOVE TR026-ADU-CARR-SCAC-ID                          12850000
128600                        TO TR231-ADU-CARR-SCAC-ID                 12860000
128700             MOVE TR026-ADU-IMPRT-TRIP-ID                         12870000
128800                        TO TR231-ADU-IMPRT-TRIP-ID                12880000
128900             MOVE TR026-ADU-IMPRT-VEH-NM                          12890000
129000                        TO TR231-ADU-IMPRT-VEH-NM                 12900000
129100             MOVE TR026-ADU-FOB-CDE                               12910000
129200                        TO TR231-FOB-CDE                          12920000
129300             MOVE TR026-ADU-EXTENT-SCAC-CDE                       12930000
129400                        TO TR231-EXTENT-SCAC-CDE                  12940000
129500                                                                  12950000
129600             MOVE TR026-ADU-ACTL-DEST-POE-NAME                    12960000
129700                        TO TR231-ADU-ACTL-DEST-POE-NM             12970000
129800                                                                  12980000
129900             MOVE TR026-ADU-ACTL-POE-DELY-DTE                     12990000
130000                        TO TR231-ADU-ACTL-POE-DELY-DTE            13000000
130100             MOVE TR026-ADU-ACTL-POE-DELY-TM                      13010000
130200                        TO TR231-ADU-ACTL-POE-DELY-TM             13020000
130210             MOVE TR026-ADU-DAT-SRC-ENT-ID                        13021000
130220                        TO TR231-DAT-SRC-ENT-ID                   13022000
130300                                                                  13030000
130400*        ---------------------------------------------------      13040000
130500         WHEN PC-ADURDA                                           13050000
130600                                                                  13060000
130700             MOVE TR026-ADURD-PROCESS-SEQ-NBR                     13070000
130800                        TO TR231-PROCESS-SEQ-NBR                  13080000
130900             MOVE PC-ADURDA                                       13090000
131000                        TO TR231-REC-TYP-ADURD-CDE                13100000
131100             MOVE PC-30                                           13110000
131200                        TO TR231-ADURD-SEQ-NBR                    13120000
131300             MOVE TR026-ADURD-CARR-SCAC-ID                        13130000
131400                        TO TR231-ADURD-CARR-SCAC-ID               13140000
131500             MOVE TR026-ADURD-IMPRT-TRIP-ID                       13150000
131600                        TO TR231-ADURD-IMPRT-TRIP-ID              13160000
131700             MOVE TR026-ADURD-IMPRT-VEH-NM                        13170000
131800                        TO TR231-ADURD-IMPRT-VEH-NM               13180000
131900             MOVE TR026-ADURD-FOB-CDE                             13190000
132000                        TO TR231-FOB-CDE                          13200000
132100             MOVE TR026-ADURD-EXTENT-SCAC-CDE                     13210000
132200                        TO TR231-EXTENT-SCAC-CDE                  13220000
132300                                                                  13230000
132400             MOVE TR026-ADURD-ACTL-DEST-POE-NAME                  13240000
132500                        TO TR231-ADURD-ACTL-DEST-POE-NM           13250000
132600                                                                  13260000
132700             MOVE TR026-ADURD-ACTL-POE-DELY-DTE                   13270000
132800                        TO TR231-ADURD-ACTL-POE-DELY-DTE          13280000
132900             MOVE TR026-ADURD-ACTL-POE-DELY-TM                    13290000
133000                        TO TR231-ADURD-ACTL-POE-DELY-TM           13300000
133100             MOVE 'RDA - RECYCLE FROM CONTAINER DELETE     '      13310000
133200                        TO TR231-ADURD-TEXT-MSG1                  13320000
133210             MOVE TR026-ADURD-DAT-SRC-ENT-ID                      13321000
133220                        TO TR231-DAT-SRC-ENT-ID                   13322000
133300                                                                  13330000
133400                                                                  13340000
133500     END-EVALUATE.                                                13350000
133600                                                                  13360000
133700 EJECT                                                            13370000
133800******************************************************************13380000
133900* SETUP THE TAUCNTK DCLGEN FIELDS PRIOR TO INSERT.               *13390000
134000******************************************************************13400000
134100 5100-MOVE-TIMCNTK-TO-TAUCNTK.                                    13410000
134200                                                                  13420000
134300     INITIALIZE DCLTAUCNTK.                                       13430000
134400                                                                  13440000
134500     MOVE IMCNTK-CONTNR-ID          TO AUCNTK-CONTNR-ID.          13450000
134600     MOVE IMCNTK-CONTNR-SEQ-NBR     TO AUCNTK-CONTNR-SEQ-NBR.     13460000
134800     MOVE IMCNTK-CONSLR-SCAC-ID     TO AUCNTK-CONSLR-SCAC-ID.     13480000
134900     MOVE IMCNTK-MOM-IMPRT-TRIP-ID  TO AUCNTK-MOM-IMPRT-TRIP-ID.  13490000
135000     MOVE IMCNTK-MOM-DPRTR-TMST     TO AUCNTK-MOM-DPRTR-TMST.     13500000
135100     MOVE IMCNTK-MOM-POE-DELY-TMST  TO AUCNTK-MOM-POE-DELY-TMST.  13510000
135200     MOVE IMCNTK-MOM-CARR-SCAC-ID   TO AUCNTK-MOM-CARR-SCAC-ID.   13520000
135300     MOVE IMCNTK-MOM-POL-CDE        TO AUCNTK-MOM-POL-CDE.        13530000
135400     MOVE IMCNTK-MOM-IMPRT-VEH-NM   TO AUCNTK-MOM-IMPRT-VEH-NM.   13540000
135500     MOVE IMCNTK-MOM-TRIP-TYP-CDE   TO AUCNTK-MOM-TRIP-TYP-CDE.   13550000
135600     MOVE IMCNTK-MOM-DEST-POE-CDE   TO AUCNTK-MOM-DEST-POE-CDE.   13560000
135700     MOVE IMCNTK-FDR-IMPRT-TRIP-ID  TO AUCNTK-FDR-IMPRT-TRIP-ID.  13570000
135800     MOVE IMCNTK-FDR-DPRTR-TMST     TO AUCNTK-FDR-DPRTR-TMST.     13580000
135900     MOVE IMCNTK-FDR-POE-DELY-TMST  TO AUCNTK-FDR-POE-DELY-TMST.  13590000
136000     MOVE IMCNTK-FDR-CARR-SCAC-ID   TO AUCNTK-FDR-CARR-SCAC-ID.   13600000
136100     MOVE IMCNTK-FDR-POL-CDE        TO AUCNTK-FDR-POL-CDE.        13610000
136200     MOVE IMCNTK-FDR-IMPRT-VEH-NM   TO AUCNTK-FDR-IMPRT-VEH-NM.   13620000
136300     MOVE IMCNTK-FDR-TRIP-TYP-CDE   TO AUCNTK-FDR-TRIP-TYP-CDE.   13630000
136400     MOVE IMCNTK-FDR-DEST-POE-CDE   TO AUCNTK-FDR-DEST-POE-CDE.   13640000
136500     MOVE IMCNTK-SIZE-CDE           TO AUCNTK-SIZE-CDE.           13650000
136600     MOVE IMCNTK-CART-CNT           TO AUCNTK-CART-CNT.           13660000
136700     MOVE IMCNTK-CBMT-QTY           TO AUCNTK-CBMT-QTY.           13670000
136800     MOVE IMCNTK-WT-KGRM-QTY        TO AUCNTK-WT-KGRM-QTY.        13680000
136900     MOVE IMCNTK-UNT-QTY            TO AUCNTK-UNT-QTY.            13690000
137200     MOVE IMCNTK-ORGN-SHPD-FR-CDE   TO AUCNTK-ORGN-SHPD-FR-CDE.   13720000
137300     MOVE IMCNTK-ORGN-SHPD-TO-CDE   TO AUCNTK-ORGN-SHPD-TO-CDE.   13730000
137400     MOVE IMCNTK-EST-LBD-NM         TO AUCNTK-EST-LBD-NM.         13740000
137500     MOVE IMCNTK-EST-LBD-TMST       TO AUCNTK-EST-LBD-TMST.       13750000
137600     MOVE IMCNTK-RISU-DO-RSN-CDE    TO AUCNTK-RISU-DO-RSN-CDE.    13760000
137700     MOVE IMCNTK-BKR-FRGT-RLSE-TMST TO AUCNTK-BKR-FRGT-RLSE-TMST. 13770000
137800     MOVE IMCNTK-DO-TO-DCONSLR-TMST TO AUCNTK-DO-TO-DCONSLR-TMST. 13780000
137900     MOVE IMCNTK-DO-RCVD-TMST       TO AUCNTK-DO-RCVD-TMST.       13790000
138000     MOVE IMCNTK-CONTNR-PU-TMST     TO AUCNTK-CONTNR-PU-TMST.     13800000
138100     MOVE IMCNTK-DAT-SRC-ENT-ID     TO AUCNTK-DAT-SRC-ENT-ID.     13810000
138200     MOVE IMCNTK-LAST-UPD-BY-USR-ID TO AUCNTK-LAST-UPD-BY-USR-ID. 13820000
138300     MOVE IMCNTK-LAST-UPD-TMST      TO AUCNTK-LAST-UPD-TMST.      13830000
138400     MOVE IMCNTK-ACTL-POE-DELY-TMST TO AUCNTK-ACTL-POE-DELY-TMST. 13840000
138500     MOVE IMCNTK-ACTL-DEST-POE-CDE  TO AUCNTK-ACTL-DEST-POE-CDE.  13850000
138600     MOVE IMCNTK-ACTL-LBD-TMST      TO AUCNTK-ACTL-LBD-TMST.      13860000
138700     MOVE IMCNTK-ACTL-LBD-NM        TO AUCNTK-ACTL-LBD-NM.        13870000
138800     MOVE IMCNTK-DVN-TMST           TO AUCNTK-DVN-TMST.           13880000
138900     MOVE IMCNTK-DCONSLR-SCAC-ID    TO AUCNTK-DCONSLR-SCAC-ID.    13890000
139000     MOVE IMCNTK-DCONSLR-RET-TMST   TO AUCNTK-DCONSLR-RET-TMST.   13900000
139100     MOVE IMCNTK-MOM-FOB-CDE        TO AUCNTK-MOM-FOB-CDE.        13910000
139200     MOVE IMCNTK-FDR-FOB-CDE        TO AUCNTK-FDR-FOB-CDE.        13920000
139300     MOVE IMCNTK-MOM-POR-CDE        TO AUCNTK-MOM-POR-CDE.        13930000
139301     MOVE IMCNTK-FDR-POR-CDE        TO AUCNTK-FDR-POR-CDE.        13930100
139302                                                                  13930200
139303     IF TR026-ETA-TRN-TYP-DEL                                     13930300
139304         MOVE PC-D                  TO AUCNTK-AUD-FUNC-CDE        13930400
139400     ELSE                                                         13940000
139500         MOVE PC-U                  TO AUCNTK-AUD-FUNC-CDE        13950000
139600     END-IF.                                                      13960000
139700                                                                  13970000
139800     PERFORM 7999-SET-CURRENT-TMST.                               13980000
139900     MOVE PV-CURRENT-TMST           TO AUCNTK-AUD-TMST.           13990000
140000                                                                  14000000
140100******************************************************************14010000
140200* SETUP THE TAUCNPO DCLGEN FIELDS PRIOR TO INSERT.               *14020000
140300******************************************************************14030000
140400 5110-MOVE-TIMCNPO-TO-TAUCNPO.                                    14040000
140500                                                                  14050000
140600     INITIALIZE DCLTAUCNPO.                                       14060000
140700                                                                  14070000
140800     MOVE IMCNPO-CONTNR-ID          TO AUCNPO-CONTNR-ID.          14080000
140900     MOVE IMCNPO-CONTNR-SEQ-NBR     TO AUCNPO-CONTNR-SEQ-NBR.     14090000
141000     MOVE IMCNPO-PO-NBR             TO AUCNPO-PO-NBR.             14100000
141100     MOVE IMCNPO-CSTM-ENTR-ID       TO AUCNPO-CSTM-ENTR-ID.       14110000
141200     MOVE IMCNPO-MSTR-BOL-NBR       TO AUCNPO-MSTR-BOL-NBR.       14120000
141300     MOVE IMCNPO-HSE-BOL-NBR        TO AUCNPO-HSE-BOL-NBR.        14130000
141400     MOVE IMCNPO-LTR-OF-CR-NBR      TO AUCNPO-LTR-OF-CR-NBR.      14140000
141500     MOVE IMCNPO-PO-RCVD-DELY-TMST  TO AUCNPO-PO-RCVD-DELY-TMST.  14150000
141600     MOVE IMCNPO-PO-C-O-PROD-CDE    TO AUCNPO-PO-C-O-PROD-CDE.    14160000
141700     MOVE IMCNPO-PO-CART-CNT        TO AUCNPO-PO-CART-CNT.        14170000
141800     MOVE IMCNPO-PO-CBMT-QTY        TO AUCNPO-PO-CBMT-QTY.        14180000
141900     MOVE IMCNPO-PO-WT-KGRM-QTY     TO AUCNPO-PO-WT-KGRM-QTY.     14190000
142000     MOVE IMCNPO-PO-UNT-QTY         TO AUCNPO-PO-UNT-QTY.         14200000
142300     MOVE IMCNPO-LAST-UPD-BY-USR-ID TO AUCNPO-LAST-UPD-BY-USR-ID. 14230000
142400     MOVE IMCNPO-LAST-UPD-TMST      TO AUCNPO-LAST-UPD-TMST.      14240000
142500     MOVE IMCNPO-EXTL-REF-NBR       TO AUCNPO-EXTL-REF-NBR.       14250000
142600     MOVE IMCNPO-BKR-FRGT-RLSE-CDE  TO AUCNPO-BKR-FRGT-RLSE-CDE.  14260000
142700     MOVE IMCNPO-DO-RCVD-CDE        TO AUCNPO-DO-RCVD-CDE.        14270000
142800     MOVE IMCNPO-CONTNR-PU-CDE      TO AUCNPO-CONTNR-PU-CDE.      14280000
142900     MOVE IMCNPO-ACTL-POE-DELY-CDE  TO AUCNPO-ACTL-POE-DELY-CDE.  14290000
143000     MOVE IMCNPO-DVN-CDE            TO AUCNPO-DVN-CDE.            14300000
143100     MOVE IMCNPO-DCONSLR-RET-CDE    TO AUCNPO-DCONSLR-RET-CDE.    14310000
143200     MOVE IMCNPO-SPLT-XMIT-CDE      TO AUCNPO-SPLT-XMIT-CDE.      14320000
143201     MOVE IMCNPO-DOC-RCVD-ORGN-TMST TO AUCNPO-DOC-RCVD-ORGN-TMST. 14320100
143202                                                                  14320200
143300     IF TR026-ETA-TRN-TYP = PC-D                                  14330000
143400         MOVE PC-D                  TO AUCNPO-AUD-FUNC-CDE        14340000
143500     ELSE                                                         14350000
143600         MOVE PC-U                  TO AUCNPO-AUD-FUNC-CDE        14360000
143700     END-IF.                                                      14370000
143800                                                                  14380000
143900     MOVE PV-CURRENT-TMST           TO AUCNPO-AUD-TMST.           14390000
144000                                                                  14400000
144100******************************************************************14410000
144200* SETUP THE HOLD FIELDS PRIOR TO ADD UPDATE PROCESSING           *14420000
144300******************************************************************14430000
144400                                                                  14440000
144500 5200-MOVE-TIMCNTK-TO-HOLD.                                       14450000
144600                                                                  14460000
144700     MOVE IMCNTK-CONTNR-ID                                        14470000
144800                          TO PV-HLD-CONTNR-ID.                    14480000
144900     MOVE IMCNTK-CONTNR-SEQ-NBR                                   14490000
145000                          TO PV-HLD-CONTNR-SEQ-NBR.               14500000
145001     MOVE IMCNTK-ORGN-SHPD-FR-CDE                                 14500100
145002                          TO PV-HLD-ORGN-SHPD-FR-CDE.             14500200
145100     MOVE IMCNTK-MOM-POE-DELY-TMST                                14510000
145200                          TO PV-HLD-MOM-POE-DELY-TMST.            14520000
145300     MOVE IMCNTK-MOM-DEST-POE-CDE                                 14530000
145400                          TO PV-HLD-MOM-DEST-POE-CDE.             14540000
145500***  MOVE IMCNTK-EST-LBD-NM                                       14550000
145600***                       TO PV-HLD-EST-LBD-NM.                   14560000
145700***  MOVE IMCNTK-EST-LBD-TMST                                     14570000
145800***                       TO PV-HLD-EST-LBD-TMST.                 14580000
145900     MOVE IMCNTK-ACTL-POE-DELY-TMST                               14590000
146000                          TO PV-HLD-ACTL-POE-DELY-TMST.           14600000
146100     MOVE IMCNTK-ACTL-DEST-POE-CDE                                14610000
146200                         TO PV-HLD-ACTL-DEST-POE-CDE.             14620000
146300                                                                  14630000
146400******************************************************************14640000
146500* SETUP THE HOLD FIELDS PRIOR TO ADD UPDATE PROCESSING           *14650000
146600******************************************************************14660000
146700 5210-MOVE-TIMCNPO-TO-HOLD.                                       14670000
146800                                                                  14680000
146900     MOVE IMCNPO-PO-NBR             TO PV-HLD-PO-NBR.             14690000
147000     MOVE IMCNPO-EXTL-REF-NBR       TO PV-HLD-EXTL-REF-NBR.       14700000
147100     MOVE IMCNPO-ACTL-POE-DELY-CDE  TO PV-HLD-ACTL-POE-DELY-CDE.  14710000
147200                                                                  14720000
147300 EJECT                                                            14730000
147400                                                                  14740000
147500******************************************************************14750000
147600* READ THE VESSEL-VOYAGE ARRIVAL FILE.                           *14760000
147700******************************************************************14770000
147800 6000-READ-ARRIVAL-FILE.                                          14780000
147900                                                                  14790000
148000     READ TR026-ARRIVAL-FILE                                      14800000
148100         INTO TR026-REC-TYP-ETA                                   14810000
148200         AT END                                                   14820000
148300           SET PS-END-OF-INPUT TO TRUE.                           14830000
148400                                                                  14840000
148500     IF PS-END-OF-INPUT                                           14850000
148600         CONTINUE                                                 14860000
148700     ELSE                                                         14870000
148800         MOVE TR026-REC-TYP-ETA (1:3)   TO PV-EDI-RECORDS         14880000
148900         IF EDI-RECORD                                            14890000
149000             ADD +1 TO PA-TOT-EDI-RECS-READ                       14900000
149100                       PA-TOTAL-RECS-READ                         14910000
149200         ELSE                                                     14920000
149300             SET PS-GOOD-RECORD TO TRUE                           14930000
149400             ADD +1 TO PA-TOTAL-RECS-READ                         14940000
149500             EVALUATE TR026-ETA-REC-TYP-CDE                       14950000
149600                 WHEN PC-ETA                                      14960000
149700                    ADD +1 TO PA-TOT-ETA-RECS-READ                14970000
149800                 WHEN PC-ADU                                      14980000
149900                    ADD +1 TO PA-TOT-ADU-RECS-READ                14990000
150000                 WHEN PC-ADURDA                                   15000000
150100                    ADD +1 TO PA-TOT-ADURD-RECS-READ              15010000
150200             END-EVALUATE                                         15020000
150300         END-IF                                                   15030000
150400     END-IF.                                                      15040000
150500                                                                  15050000
150600                                                                  15060000
150700******************************************************************15070000
150800* LOAD THE ERROR FIELDS WHEN CONTAINER ON TIMCNTK DOES NOT MATCH *15080000
150900* WHAT THE CONSOLIDATOR HAS SENT.                                *15090000
151000******************************************************************15100000
151100                                                                  15110000
151200 6307-CONTAINER-NOT-FOUND-MSG.                                    15120000
151300                                                                  15130000
151400     MOVE PC-E                  TO TR231-RPT-TYP.                 15140000
151500     MOVE 'CONTNR ID'           TO TR231-DATA-IN-ERROR.           15150000
151600     MOVE TR026-ETA-CONTNR-ID   TO TR231-DATA-VALUE.              15160000
151700     MOVE PC-ERROR              TO TR231-ERROR-TYPE.              15170000
151800                                                                  15180000
151900     EVALUATE TR026-ETA-TRN-TYP                                   15190000
152000                                                                  15200000
152100       WHEN PC-A                                                  15210000
152200        MOVE                                                      15220000
152300         'ADD SENT - CONTAINER NOT FOUND - NOT PROCESSED'         15230000
152400                    TO TR231-ERROR-MSG                            15240000
152500       WHEN PC-C                                                  15250000
152600        MOVE                                                      15260000
152700         'CHANGE SENT - CONTAINER NOT FOUND - NOT PROCESSED'      15270000
152800               TO TR231-ERROR-MSG                                 15280000
152900       WHEN PC-D                                                  15290000
153000        MOVE                                                      15300000
153100         'DELETE SENT - CONTAINER NOT FOUND - NOT PROCESSED'      15310000
153200               TO TR231-ERROR-MSG                                 15320000
153300                                                                  15330000
153400     END-EVALUATE.                                                15340000
153500                                                                  15350000
153600******************************************************************15360000
153700* SELECT IMPORT CONTAINER MANIFEST TABLE (TIMCNTK) ROW.           15370000
153800******************************************************************15380000
153900                                                                  15390000
154000 7000-SELECT-TIMCNTK.                                             15400000
154100                                                                  15410000
154200     PERFORM                                                      15420000
154300         WITH TEST AFTER                                          15430000
154400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     15440000
154500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            15450000
154600                 SQLCODE = ZERO                     OR            15460000
154700                 SQLCODE = +100                                   15470000
154800                                                                  15480000
154900         EXEC SQL                                                 15490000
155000             SELECT A.CONTNR_ID,                                  15500000
155100                    A.CONTNR_SEQ_NBR,                             15510000
155300                    A.CONSLR_SCAC_ID,                             15530000
155400                    A.MOM_IMPRT_TRIP_ID,                          15540000
155500                    A.MOM_DPRTR_TMST,                             15550000
155600                    A.MOM_POE_DELY_TMST,                          15560000
155700                    A.MOM_CARR_SCAC_ID,                           15570000
155800                    A.MOM_POL_CDE,                                15580000
155900                    A.MOM_IMPRT_VEH_NM,                           15590000
156000                    A.MOM_TRIP_TYP_CDE,                           15600000
156100                    A.MOM_DEST_POE_CDE,                           15610000
156200                    A.FDR_IMPRT_TRIP_ID,                          15620000
156300                    A.FDR_DPRTR_TMST,                             15630000
156400                    A.FDR_POE_DELY_TMST,                          15640000
156500                    A.FDR_CARR_SCAC_ID,                           15650000
156600                    A.FDR_POL_CDE,                                15660000
156700                    A.FDR_IMPRT_VEH_NM,                           15670000
156800                    A.FDR_TRIP_TYP_CDE,                           15680000
156900                    A.FDR_DEST_POE_CDE,                           15690000
157000                    A.SIZE_CDE,                                   15700000
157100                    A.CART_CNT,                                   15710000
157200                    A.CBMT_QTY,                                   15720000
157300                    A.WT_KGRM_QTY,                                15730000
157400                    A.UNT_QTY,                                    15740000
157700                    A.ORGN_SHPD_FR_CDE,                           15770000
157800                    A.ORGN_SHPD_TO_CDE,                           15780000
157900                    A.EST_LBD_NM,                                 15790000
158000                    A.EST_LBD_TMST,                               15800000
158100                    A.RISU_DO_RSN_CDE,                            15810000
158200                    A.BKR_FRGT_RLSE_TMST,                         15820000
158300                    A.DO_TO_DCONSLR_TMST,                         15830000
158400                    A.DO_RCVD_TMST,                               15840000
158500                    A.CONTNR_PU_TMST,                             15850000
158600                    A.DAT_SRC_ENT_ID,                             15860000
158700                    A.CRE_BY_USR_ID,                              15870000
158800                    A.CRE_TMST,                                   15880000
158900                    A.LAST_UPD_BY_USR_ID,                         15890000
159000                    A.LAST_UPD_TMST,                              15900000
159100                    A.ACTL_POE_DELY_TMST,                         15910000
159200                    A.ACTL_DEST_POE_CDE,                          15920000
159300                    A.ACTL_LBD_NM,                                15930000
159400                    A.ACTL_LBD_TMST,                              15940000
159500                    A.DVN_TMST,                                   15950000
159600                    A.DCONSLR_SCAC_ID,                            15960000
159700                    A.DCONSLR_RET_TMST,                           15970000
159800                    A.MOM_FOB_CDE,                                15980000
159900                    A.FDR_FOB_CDE,                                15990000
160000                    A.MOM_POR_CDE,                                16000000
160001                    A.FDR_POR_CDE                                 16000100
160002              INTO :IMCNTK-CONTNR-ID,                             16000200
160003                   :IMCNTK-CONTNR-SEQ-NBR,                        16000300
160100                   :IMCNTK-CONSLR-SCAC-ID,                        16010000
160200                   :IMCNTK-MOM-IMPRT-TRIP-ID,                     16020000
160300                   :IMCNTK-MOM-DPRTR-TMST,                        16030000
160400                   :IMCNTK-MOM-POE-DELY-TMST,                     16040000
160500                   :IMCNTK-MOM-CARR-SCAC-ID,                      16050000
160600                   :IMCNTK-MOM-POL-CDE,                           16060000
160700                   :IMCNTK-MOM-IMPRT-VEH-NM,                      16070000
160800                   :IMCNTK-MOM-TRIP-TYP-CDE,                      16080000
160900                   :IMCNTK-MOM-DEST-POE-CDE,                      16090000
161000                   :IMCNTK-FDR-IMPRT-TRIP-ID,                     16100000
161100                   :IMCNTK-FDR-DPRTR-TMST,                        16110000
161200                   :IMCNTK-FDR-POE-DELY-TMST,                     16120000
161300                   :IMCNTK-FDR-CARR-SCAC-ID,                      16130000
161400                   :IMCNTK-FDR-POL-CDE,                           16140000
161500                   :IMCNTK-FDR-IMPRT-VEH-NM,                      16150000
161600                   :IMCNTK-FDR-TRIP-TYP-CDE,                      16160000
161700                   :IMCNTK-FDR-DEST-POE-CDE,                      16170000
161800                   :IMCNTK-SIZE-CDE,                              16180000
161900                   :IMCNTK-CART-CNT,                              16190000
162000                   :IMCNTK-CBMT-QTY,                              16200000
162100                   :IMCNTK-WT-KGRM-QTY,                           16210000
162200                   :IMCNTK-UNT-QTY,                               16220000
162500                   :IMCNTK-ORGN-SHPD-FR-CDE,                      16250000
162600                   :IMCNTK-ORGN-SHPD-TO-CDE,                      16260000
162700                   :IMCNTK-EST-LBD-NM,                            16270000
162800                   :IMCNTK-EST-LBD-TMST,                          16280000
162900                   :IMCNTK-RISU-DO-RSN-CDE,                       16290000
163000                   :IMCNTK-BKR-FRGT-RLSE-TMST,                    16300000
163100                   :IMCNTK-DO-TO-DCONSLR-TMST,                    16310000
163200                   :IMCNTK-DO-RCVD-TMST,                          16320000
163300                   :IMCNTK-CONTNR-PU-TMST,                        16330000
163400                   :IMCNTK-DAT-SRC-ENT-ID,                        16340000
163500                   :IMCNTK-CRE-BY-USR-ID,                         16350000
163600                   :IMCNTK-CRE-TMST,                              16360000
163700                   :IMCNTK-LAST-UPD-BY-USR-ID,                    16370000
163800                   :IMCNTK-LAST-UPD-TMST,                         16380000
163900                   :IMCNTK-ACTL-POE-DELY-TMST,                    16390000
164000                   :IMCNTK-ACTL-DEST-POE-CDE,                     16400000
164100                   :IMCNTK-ACTL-LBD-NM,                           16410000
164200                   :IMCNTK-ACTL-LBD-TMST,                         16420000
164300                   :IMCNTK-DVN-TMST,                              16430000
164400                   :IMCNTK-DCONSLR-SCAC-ID,                       16440000
164500                   :IMCNTK-DCONSLR-RET-TMST,                      16450000
164600                   :IMCNTK-MOM-FOB-CDE,                           16460000
164700                   :IMCNTK-FDR-FOB-CDE,                           16470000
164800                   :IMCNTK-MOM-POR-CDE,                           16480000
164801                   :IMCNTK-FDR-POR-CDE                            16480100
164802               FROM TIMCNTK A                                     16480200
164803              WHERE A.CONTNR_ID        = :IMCNTK-CONTNR-ID        16480300
164804                AND A.CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR   16480400
164900         END-EXEC                                                 16490000
165000                                                                  16500000
165100         EVALUATE TRUE                                            16510000
165200             WHEN SQLCODE = ZERO                                  16520000
165300                 SET PS-CNTK-FOUND TO TRUE                        16530000
165400                 ADD +1 TO PA-TOT-CNTK-RECS-SELECT                16540000
165500                                                                  16550000
165600             WHEN SQLCODE = +100                                  16560000
165700                 SET PS-CNTK-FOUND-NO TO TRUE                     16570000
165800                                                                  16580000
165900             WHEN SQLCODE = -904                                  16590000
166000             WHEN SQLCODE = -913                                  16600000
166100                 CONTINUE                                         16610000
166200                                                                  16620000
166300             WHEN SQLWARN0 NOT EQUAL SPACE                        16630000
166400             WHEN SQLCODE NOT EQUAL ZERO                          16640000
166500                 DISPLAY '**************************************' 16650000
166600                 DISPLAY '** ABEND                            **' 16660000
166700                 DISPLAY '** PROGRAM = TRKUP235               **' 16670000
166800                 DISPLAY '** PARAGRAPH = 7000-SELECT-TIMCNTK  **' 16680000
166900                 DISPLAY '** SELECT TIMCNTK                   **' 16690000
167000                 DISPLAY '**************************************' 16700000
167100                 DISPLAY '** CONTNR ID          '                 16710000
167200                                    IMCNTK-CONTNR-ID              16720000
167300                 DISPLAY '** IMCNTK-CONTNR-SEQ-NBR '              16730000
167400                                    IMCNTK-CONTNR-SEQ-NBR         16740000
167500                 DISPLAY '** TR026-ETA-EXTL-REF-NBR '             16750000
167600                                    TR026-ETA-EXTL-REF-NBR        16760000
167700                 DISPLAY '** TR026-ETA-PO-NBR        '            16770000
167800                                    TR026-ETA-PO-NBR              16780000
167900                 DISPLAY '**************************************' 16790000
168000                 PERFORM 9100-SQL-ABEND                           16800000
168100         END-EVALUATE                                             16810000
168200     END-PERFORM.                                                 16820000
168300                                                                  16830000
168400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    16840000
168500         (SQLCODE NOT = ZERO  AND                                 16850000
168600          SQLCODE NOT = +100)                                     16860000
168700                                                                  16870000
168800         DISPLAY '****************************************'       16880000
168900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       16890000
169000         DISPLAY '** SELECT FROM TIMCNTK                **'       16900000
169100         DISPLAY '** PARAGRAPH = 7000-SELECT-TIMCNTK    **'       16910000
169200                 DISPLAY '** CONTNR ID          '                 16920000
169300                                    IMCNTK-CONTNR-ID              16930000
169400                 DISPLAY '** IMCNTK-CONTNR-SEQ-NBR '              16940000
169500                                    IMCNTK-CONTNR-SEQ-NBR         16950000
169600                 DISPLAY '** TR026-ETA-EXTL-REF-NBR '             16960000
169700                                    TR026-ETA-EXTL-REF-NBR        16970000
169800                 DISPLAY '** TR026-ETA-PO-NBR        '            16980000
169900                                    TR026-ETA-PO-NBR              16990000
170000         DISPLAY '****************************************'       17000000
170100         PERFORM 9100-SQL-ABEND                                   17010000
170200     END-IF.                                                      17020000
170300                                                                  17030000
170400 EJECT                                                            17040000
170500******************************************************************17050000
170600*  UPDATE THE IMPORT CONTAINER MANIFEST TABLE  (TIMCNTK).        *17060000
170700******************************************************************17070000
170800 7010-UPDATE-TIMCNTK.                                             17080000
170900                                                                  17090000
171000     PERFORM                                                      17100000
171100         WITH TEST AFTER                                          17110000
171200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     17120000
171300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            17130000
171400                 SQLCODE = ZERO                     OR            17140000
171500                 SQLCODE = +100                                   17150000
171600                                                                  17160000
171700         EXEC SQL                                                 17170000
171800             UPDATE TIMCNTK                                       17180000
171900             SET LAST_UPD_BY_USR_ID = :PC-CURRENT-PROGRAM-NAME    17190000
172000                ,LAST_UPD_TMST      = :PV-CURRENT-TMST            17200000
172100                ,MOM_POE_DELY_TMST  = :PV-HLD-MOM-POE-DELY-TMST   17210000
172200                ,MOM_DEST_POE_CDE   = :PV-HLD-MOM-DEST-POE-CDE    17220000
172300                ,ACTL_POE_DELY_TMST = :PV-HLD-ACTL-POE-DELY-TMST  17230000
172400                ,ACTL_DEST_POE_CDE  = :PV-HLD-ACTL-DEST-POE-CDE   17240000
172500              WHERE CONTNR_ID       = :PV-HLD-CONTNR-ID           17250000
172600                AND CONTNR_SEQ_NBR  = :PV-HLD-CONTNR-SEQ-NBR      17260000
172700         END-EXEC                                                 17270000
172800                                                                  17280000
172900         EVALUATE TRUE                                            17290000
173000             WHEN SQLCODE = ZERO                                  17300000
173100                 SET PS-GOOD-CNTK-UPDATE TO TRUE                  17310000
173200                                                                  17320000
173300             WHEN SQLCODE = -904                                  17330000
173400             WHEN SQLCODE = -913                                  17340000
173500                 CONTINUE                                         17350000
173600                                                                  17360000
173700             WHEN SQLWARN0 NOT EQUAL SPACE                        17370000
173800             WHEN SQLCODE NOT EQUAL ZERO                          17380000
173900                 DISPLAY '**************************************' 17390000
174000                 DISPLAY '** ABEND                            **' 17400000
174100                 DISPLAY '** PROGRAM = TRKUP235               **' 17410000
174200                 DISPLAY '** PARAGRAPH = 7010-UPDATE-TIMCNTK  **' 17420000
174300                 DISPLAY '** UPDATE TIMCNTK                   **' 17430000
174400                 DISPLAY '** CONTNR ID       = '                  17440000
174500                 DISPLAY            IMCNTK-CONTNR-ID              17450000
174600                 DISPLAY '** CONTNR SEQ NBR  = '                  17460000
174700                 DISPLAY            IMCNTK-CONTNR-SEQ-NBR         17470000
174800                 DISPLAY '**************************************' 17480000
174900                 PERFORM 9100-SQL-ABEND                           17490000
175000         END-EVALUATE                                             17500000
175100     END-PERFORM.                                                 17510000
175200                                                                  17520000
175300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    17530000
175400         (SQLCODE NOT = ZERO AND                                  17540000
175500          SQLCODE NOT = +100)                                     17550000
175600         DISPLAY '****************************************'       17560000
175700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       17570000
175800         DISPLAY '** UPDATE FROM TIMCNTK                **'       17580000
175900         DISPLAY '** PARAGRAPH = 7010-UPDATE-TIMCNTK    **'       17590000
176000         DISPLAY '** CONTNR ID       = '                          17600000
176100         DISPLAY            IMCNTK-CONTNR-ID                      17610000
176200         DISPLAY '** CONTNR SEQ NBR  = '                          17620000
176300         DISPLAY            IMCNTK-CONTNR-SEQ-NBR                 17630000
176400         DISPLAY '****************************************'       17640000
176500         PERFORM 9100-SQL-ABEND                                   17650000
176600     END-IF.                                                      17660000
176700                                                                  17670000
176800 EJECT                                                            17680000
176900                                                                  17690000
177000******************************************************************17700000
177100*  UPDATE THE IMPORT CONTAINER PURCHASE ORDER TABLE (TIMCNPO).   *17710000
177200******************************************************************17720000
177300 7020-UPDATE-TIMCNPO.                                             17730000
177400                                                                  17740000
177500     PERFORM                                                      17750000
177600         WITH TEST AFTER                                          17760000
177700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     17770000
177800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            17780000
177900                 SQLCODE = ZERO                                   17790000
178000                                                                  17800000
178100         EXEC SQL                                                 17810000
178200             UPDATE TIMCNPO                                       17820000
178300                SET LAST_UPD_BY_USR_ID = :PC-CURRENT-PROGRAM-NAME 17830000
178400                   ,LAST_UPD_TMST      = :PV-CURRENT-TMST         17840000
178500                   ,ACTL_POE_DELY_CDE  = :PV-HLD-ACTL-POE-DELY-CDE17850000
178600              WHERE CONTNR_ID       = :PV-HLD-CONTNR-ID           17860000
178700                AND CONTNR_SEQ_NBR  = :PV-HLD-CONTNR-SEQ-NBR      17870000
178800                AND PO_NBR          = :PV-HLD-PO-NBR              17880000
178900                AND EXTL_REF_NBR    = :PV-HLD-EXTL-REF-NBR        17890000
179000         END-EXEC                                                 17900000
179100                                                                  17910000
179200         EVALUATE TRUE                                            17920000
179300             WHEN SQLCODE = ZERO                                  17930000
179400                 SET PS-GOOD-CNPO-UPDATE TO TRUE                  17940000
179500                                                                  17950000
179600             WHEN SQLCODE = -904                                  17960000
179700             WHEN SQLCODE = -913                                  17970000
179800                 CONTINUE                                         17980000
179900                                                                  17990000
180000             WHEN OTHER                                           18000000
180100                 DISPLAY '**************************************' 18010000
180200                 DISPLAY '** ABEND                            **' 18020000
180300                 DISPLAY '** PROGRAM = TRKUP235               **' 18030000
180400                 DISPLAY '** PARAGRAPH = 7020-UPDATE-TIMCNPO  **' 18040000
180500                 DISPLAY '** UPDATE TIMCNPO                   **' 18050000
180600                 DISPLAY '** CONTNR ID       = '                  18060000
180700                 DISPLAY            PV-HLD-CONTNR-ID              18070000
180800                 DISPLAY '** PO NBR          = '                  18080000
180900                 DISPLAY            PV-HLD-PO-NBR                 18090000
181000                 DISPLAY '** EXTL REF NBR    = '                  18100000
181100                 DISPLAY            PV-HLD-EXTL-REF-NBR           18110000
181200                 DISPLAY '**************************************' 18120000
181300                 PERFORM 9100-SQL-ABEND                           18130000
181400         END-EVALUATE                                             18140000
181500     END-PERFORM.                                                 18150000
181600                                                                  18160000
181700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    18170000
181800          SQLCODE NOT = ZERO                                      18180000
181900         DISPLAY '****************************************'       18190000
182000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       18200000
182100         DISPLAY '** UPDATE FROM TIMCNPO                **'       18210000
182200         DISPLAY '** PARAGRAPH = 7020-UPDATE-TIMCNPO    **'       18220000
182300         DISPLAY '** CONTNR ID       = '                          18230000
182400         DISPLAY            PV-HLD-CONTNR-ID                      18240000
182500         DISPLAY '** PO NBR          = '                          18250000
182600         DISPLAY            PV-HLD-PO-NBR                         18260000
182700         DISPLAY '** EXTL REF NBR    = '                          18270000
182800         DISPLAY            PV-HLD-EXTL-REF-NBR                   18280000
182900         DISPLAY '****************************************'       18290000
183000         PERFORM 9100-SQL-ABEND                                   18300000
183100     END-IF.                                                      18310000
183200                                                                  18320000
183300 EJECT                                                            18330000
183400                                                                  18340000
183500******************************************************************18350000
183600* INSERT A ROW INTO THE CONTAINER AUDIT TABLE  (TAUCNTK).        *18360000
183700******************************************************************18370000
183800 7030-INSERT-TAUCNTK.                                             18380000
183900                                                                  18390000
184000     PERFORM                                                      18400000
184100         WITH TEST AFTER                                          18410000
184200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     18420000
184300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            18430000
184400                 SQLCODE = ZERO                                   18440000
184500                                                                  18450000
184600         EXEC SQL                                                 18460000
184700             INSERT INTO TAUCNTK                                  18470000
184800                   (CONTNR_ID,                                    18480000
184900                    CONTNR_SEQ_NBR,                               18490000
185100                    CONSLR_SCAC_ID,                               18510000
185200                    MOM_IMPRT_TRIP_ID,                            18520000
185300                    MOM_DPRTR_TMST,                               18530000
185400                    MOM_POE_DELY_TMST,                            18540000
185500                    MOM_CARR_SCAC_ID,                             18550000
185600                    MOM_POL_CDE,                                  18560000
185700                    MOM_IMPRT_VEH_NM,                             18570000
185800                    MOM_TRIP_TYP_CDE,                             18580000
185900                    MOM_DEST_POE_CDE,                             18590000
186000                    FDR_IMPRT_TRIP_ID,                            18600000
186100                    FDR_DPRTR_TMST,                               18610000
186200                    FDR_POE_DELY_TMST,                            18620000
186300                    FDR_CARR_SCAC_ID,                             18630000
186400                    FDR_POL_CDE,                                  18640000
186500                    FDR_IMPRT_VEH_NM,                             18650000
186600                    FDR_TRIP_TYP_CDE,                             18660000
186700                    FDR_DEST_POE_CDE,                             18670000
186800                    SIZE_CDE,                                     18680000
186900                    CART_CNT,                                     18690000
187000                    CBMT_QTY,                                     18700000
187100                    WT_KGRM_QTY,                                  18710000
187200                    UNT_QTY,                                      18720000
187500                    ORGN_SHPD_FR_CDE,                             18750000
187600                    ORGN_SHPD_TO_CDE,                             18760000
187700                    EST_LBD_NM,                                   18770000
187800                    EST_LBD_TMST,                                 18780000
187900                    RISU_DO_RSN_CDE,                              18790000
188000                    BKR_FRGT_RLSE_TMST,                           18800000
188100                    DO_TO_DCONSLR_TMST,                           18810000
188200                    DO_RCVD_TMST,                                 18820000
188300                    CONTNR_PU_TMST,                               18830000
188400                    DAT_SRC_ENT_ID,                               18840000
188500                    LAST_UPD_BY_USR_ID,                           18850000
188600                    LAST_UPD_TMST,                                18860000
188700                    AUD_FUNC_CDE,                                 18870000
188800                    AUD_TMST,                                     18880000
188900                    ACTL_POE_DELY_TMST,                           18890000
189000                    ACTL_DEST_POE_CDE,                            18900000
189100                    ACTL_LBD_NM,                                  18910000
189200                    ACTL_LBD_TMST,                                18920000
189300                    DVN_TMST,                                     18930000
189400                    DCONSLR_SCAC_ID,                              18940000
189500                    DCONSLR_RET_TMST,                             18950000
189600                    MOM_FOB_CDE,                                  18960000
189700                    FDR_FOB_CDE,                                  18970000
189800                    MOM_POR_CDE,                                  18980000
189801                    FDR_POR_CDE)                                  18980100
189802             VALUES                                               18980200
189803                  (:AUCNTK-CONTNR-ID,                             18980300
189804                   :AUCNTK-CONTNR-SEQ-NBR,                        18980400
190000                   :AUCNTK-CONSLR-SCAC-ID,                        19000000
190100                   :AUCNTK-MOM-IMPRT-TRIP-ID,                     19010000
190200                   :AUCNTK-MOM-DPRTR-TMST,                        19020000
190300                   :AUCNTK-MOM-POE-DELY-TMST,                     19030000
190400                   :AUCNTK-MOM-CARR-SCAC-ID,                      19040000
190500                   :AUCNTK-MOM-POL-CDE,                           19050000
190600                   :AUCNTK-MOM-IMPRT-VEH-NM,                      19060000
190700                   :AUCNTK-MOM-TRIP-TYP-CDE,                      19070000
190800                   :AUCNTK-MOM-DEST-POE-CDE,                      19080000
190900                   :AUCNTK-FDR-IMPRT-TRIP-ID,                     19090000
191000                   :AUCNTK-FDR-DPRTR-TMST,                        19100000
191100                   :AUCNTK-FDR-POE-DELY-TMST,                     19110000
191200                   :AUCNTK-FDR-CARR-SCAC-ID,                      19120000
191300                   :AUCNTK-FDR-POL-CDE,                           19130000
191400                   :AUCNTK-FDR-IMPRT-VEH-NM,                      19140000
191500                   :AUCNTK-FDR-TRIP-TYP-CDE,                      19150000
191600                   :AUCNTK-FDR-DEST-POE-CDE,                      19160000
191700                   :AUCNTK-SIZE-CDE,                              19170000
191800                   :AUCNTK-CART-CNT,                              19180000
191900                   :AUCNTK-CBMT-QTY,                              19190000
192000                   :AUCNTK-WT-KGRM-QTY,                           19200000
192100                   :AUCNTK-UNT-QTY,                               19210000
192400                   :AUCNTK-ORGN-SHPD-FR-CDE,                      19240000
192500                   :AUCNTK-ORGN-SHPD-TO-CDE,                      19250000
192600                   :AUCNTK-EST-LBD-NM,                            19260000
192700                   :AUCNTK-EST-LBD-TMST,                          19270000
192800                   :AUCNTK-RISU-DO-RSN-CDE,                       19280000
192900                   :AUCNTK-BKR-FRGT-RLSE-TMST,                    19290000
193000                   :AUCNTK-DO-TO-DCONSLR-TMST,                    19300000
193100                   :AUCNTK-DO-RCVD-TMST,                          19310000
193200                   :AUCNTK-CONTNR-PU-TMST,                        19320000
193300                   :AUCNTK-DAT-SRC-ENT-ID,                        19330000
193400                   :AUCNTK-LAST-UPD-BY-USR-ID,                    19340000
193500                   :AUCNTK-LAST-UPD-TMST,                         19350000
193600                   :AUCNTK-AUD-FUNC-CDE,                          19360000
193700                   :AUCNTK-AUD-TMST,                              19370000
193800                   :AUCNTK-ACTL-POE-DELY-TMST,                    19380000
193900                   :AUCNTK-ACTL-DEST-POE-CDE,                     19390000
194000                   :AUCNTK-ACTL-LBD-NM,                           19400000
194100                   :AUCNTK-ACTL-LBD-TMST,                         19410000
194200                   :AUCNTK-DVN-TMST,                              19420000
194300                   :AUCNTK-DCONSLR-SCAC-ID,                       19430000
194400                   :AUCNTK-DCONSLR-RET-TMST,                      19440000
194500                   :AUCNTK-MOM-FOB-CDE,                           19450000
194600                   :AUCNTK-FDR-FOB-CDE,                           19460000
194700                   :AUCNTK-MOM-POR-CDE,                           19470000
194701                   :AUCNTK-FDR-POR-CDE)                           19470100
194702         END-EXEC                                                 19470200
194703                                                                  19470300
194704         EVALUATE TRUE                                            19470400
194800             WHEN SQLCODE = ZERO                                  19480000
194900                 ADD +1 TO PA-TOT-ACNTK-INSERTS                   19490000
195000                 ADD +1 TO PA-TOT-RECS-AUDITED                    19500000
195100                                                                  19510000
195200             WHEN SQLCODE = -904                                  19520000
195300             WHEN SQLCODE = -913                                  19530000
195400                 CONTINUE                                         19540000
195500                                                                  19550000
195600             WHEN SQLWARN0 NOT EQUAL SPACE                        19560000
195700             WHEN SQLCODE NOT EQUAL ZERO                          19570000
195800                 DISPLAY '**************************************' 19580000
195900                 DISPLAY '** ABEND                            **' 19590000
196000                 DISPLAY '** PROGRAM = TRKUP235               **' 19600000
196100                 DISPLAY '** PARAGRAPH = 7030-INSERT-TAUCNTK  **' 19610000
196200                 DISPLAY '** INSERT INTO TAUCNTK              **' 19620000
196300                 DISPLAY '** AUCNTK-CONTNR-ID = '                 19630000
196400                 DISPLAY                   AUCNTK-CONTNR-ID       19640000
196500                 DISPLAY '** CONTNR SEQ NBR  = '                  19650000
196600                 DISPLAY                   AUCNTK-CONTNR-SEQ-NBR  19660000
196700                 DISPLAY '**************************************' 19670000
196800                 PERFORM 9100-SQL-ABEND                           19680000
196900         END-EVALUATE                                             19690000
197000     END-PERFORM.                                                 19700000
197100                                                                  19710000
197200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    19720000
197300         SQLCODE NOT = ZERO                                       19730000
197400         DISPLAY '****************************************'       19740000
197500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       19750000
197600         DISPLAY '** INSERT TO TAUCNTK                  **'       19760000
197700         DISPLAY '** PARAGRAPH = 7030-INSERT-TAUCNTK    **'       19770000
197800         DISPLAY '** AUCNTK-CONTNR-ID = ' AUCNTK-CONTNR-ID        19780000
197900         DISPLAY '** CONTNR SEQ NBR  = '                          19790000
198000         DISPLAY                   AUCNTK-CONTNR-SEQ-NBR          19800000
198100         DISPLAY '****************************************'       19810000
198200         PERFORM 9100-SQL-ABEND                                   19820000
198300     END-IF.                                                      19830000
198400                                                                  19840000
198500 EJECT                                                            19850000
198600******************************************************************19860000
198700*  CHECK IF THERE ARE MORE PURCHASE ORDERS ASSIGNED TO A         *19870000
198800*  CONTAINER.                                                    *19880000
198900******************************************************************19890000
199000 7040-SELECT-TIMCNPO-COUNT.                                       19900000
199100                                                                  19910000
199200     PERFORM                                                      19920000
199300         WITH TEST AFTER                                          19930000
199400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     19940000
199500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            19950000
199600                 SQLCODE = ZERO                                   19960000
199700                                                                  19970000
199800         EXEC SQL                                                 19980000
199900             SELECT  COUNT(*)                                     19990000
200000               INTO :PV-CONTAINER-CNT                             20000000
200100               FROM  TIMCNPO                                      20010000
200200              WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID       20020000
200300                AND CONTNR_SEQ_NBR      = :PV-HLD-CONTNR-SEQ-NBR  20030000
200400                AND  PO_NBR            <> :PV-HLD-PO-NBR          20040000
200500                AND  EXTL_REF_NBR      <> :PV-HLD-EXTL-REF-NBR    20050000
200600                AND  ACTL_POE_DELY_CDE  = 'Y'                     20060000
200700         END-EXEC                                                 20070000
200800                                                                  20080000
200900         EVALUATE TRUE                                            20090000
201000             WHEN SQLCODE = ZERO                                  20100000
201100                 CONTINUE                                         20110000
201200                                                                  20120000
201300             WHEN SQLCODE = -904                                  20130000
201400             WHEN SQLCODE = -913                                  20140000
201500                 CONTINUE                                         20150000
201600                                                                  20160000
201700             WHEN OTHER                                           20170000
201800                 DISPLAY '**************************************' 20180000
201900                 DISPLAY '** ABEND                            **' 20190000
202000                 DISPLAY '** PROGRAM = TRKUP235               **' 20200000
202100                 DISPLAY '** PARAGRAPH = '                        20210000
202200                         '7040-SELECT-TIMCNPO-COUNT'              20220000
202300                 DISPLAY '** SELECT COUNT ON TIMCNPO          **' 20230000
202400                 DISPLAY '** CONTNR ID       = '                  20240000
202500                 DISPLAY            PV-HLD-CONTNR-ID              20250000
202600                 DISPLAY '** PO NBR          = '                  20260000
202700                 DISPLAY            PV-HLD-PO-NBR                 20270000
202800                 DISPLAY '** EXTL REF NBR    = '                  20280000
202900                 DISPLAY            PV-HLD-EXTL-REF-NBR           20290000
203000                 DISPLAY '**************************************' 20300000
203100                 PERFORM 9100-SQL-ABEND                           20310000
203200         END-EVALUATE                                             20320000
203300     END-PERFORM.                                                 20330000
203400                                                                  20340000
203500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20350000
203600          SQLCODE NOT = ZERO                                      20360000
203700         DISPLAY '****************************************'       20370000
203800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       20380000
203900         DISPLAY '** SELECT COUNT ON TIMCNPO            **'       20390000
204000         DISPLAY '** PARAGRAPH = '                                20400000
204100                 '7040-SELECT-TIMCNPO-COUNT'                      20410000
204200         DISPLAY '** CONTNR ID       = '                          20420000
204300         DISPLAY            PV-HLD-CONTNR-ID                      20430000
204400         DISPLAY '** PO NBR          = '                          20440000
204500         DISPLAY            PV-HLD-PO-NBR                         20450000
204600         DISPLAY '** EXTL REF NBR    = '                          20460000
204700         DISPLAY            PV-HLD-EXTL-REF-NBR                   20470000
204800         DISPLAY '****************************************'       20480000
204900         PERFORM 9100-SQL-ABEND                                   20490000
205000     END-IF.                                                      20500000
205100                                                                  20510000
205200 EJECT                                                            20520000
205300                                                                  20530000
205400******************************************************************20540000
205500* JOIN IMPORT CONTAINER MANIFEST TABLE (TIMCNTK) TO CONTAINER PO *20550000
205600* TABLE (TIMCNPO) TO RETRIEVE TIMCNPO DATA                       *20560000
205700******************************************************************20570000
205800 7100-SELECT-TIMCNPO.                                             20580000
205900                                                                  20590000
206000     PERFORM                                                      20600000
206100         WITH TEST AFTER                                          20610000
206200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     20620000
206300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            20630000
206400                 SQLCODE = ZERO                     OR            20640000
206500                 SQLCODE = +100                                   20650000
206600                                                                  20660000
206700         EXEC SQL                                                 20670000
206800             SELECT B.CONTNR_ID                                   20680000
206900                   ,B.CONTNR_SEQ_NBR                              20690000
207000                   ,B.PO_NBR                                      20700000
207100                   ,B.CSTM_ENTR_ID                                20710000
207200                   ,B.MSTR_BOL_NBR                                20720000
207300                   ,B.HSE_BOL_NBR                                 20730000
207400                   ,B.LTR_OF_CR_NBR                               20740000
207500                   ,B.PO_RCVD_DELY_TMST                           20750000
207600                   ,B.PO_C_O_PROD_CDE                             20760000
207700                   ,B.PO_CART_CNT                                 20770000
207800                   ,B.PO_CBMT_QTY                                 20780000
207900                   ,B.PO_WT_KGRM_QTY                              20790000
208000                   ,B.PO_UNT_QTY                                  20800000
208300                   ,B.CRE_BY_USR_ID                               20830000
208400                   ,B.CRE_TMST                                    20840000
208500                   ,B.LAST_UPD_BY_USR_ID                          20850000
208600                   ,B.LAST_UPD_TMST                               20860000
208700                   ,B.EXTL_REF_NBR                                20870000
208800                   ,B.BKR_FRGT_RLSE_CDE                           20880000
208900                   ,B.DO_RCVD_CDE                                 20890000
209000                   ,B.CONTNR_PU_CDE                               20900000
209100                   ,B.ACTL_POE_DELY_CDE                           20910000
209200                   ,B.DVN_CDE                                     20920000
209300                   ,B.DCONSLR_RET_CDE                             20930000
209400                   ,B.SPLT_XMIT_CDE                               20940000
209401                   ,B.DOC_RCVD_ORGN_TMST                          20940100
209402              INTO :IMCNPO-CONTNR-ID                              20940200
209500                  ,:IMCNPO-CONTNR-SEQ-NBR                         20950000
209600                  ,:IMCNPO-PO-NBR                                 20960000
209700                  ,:IMCNPO-CSTM-ENTR-ID                           20970000
209800                  ,:IMCNPO-MSTR-BOL-NBR                           20980000
209900                  ,:IMCNPO-HSE-BOL-NBR                            20990000
210000                  ,:IMCNPO-LTR-OF-CR-NBR                          21000000
210100                  ,:IMCNPO-PO-RCVD-DELY-TMST                      21010000
210200                  ,:IMCNPO-PO-C-O-PROD-CDE                        21020000
210300                  ,:IMCNPO-PO-CART-CNT                            21030000
210400                  ,:IMCNPO-PO-CBMT-QTY                            21040000
210500                  ,:IMCNPO-PO-WT-KGRM-QTY                         21050000
210600                  ,:IMCNPO-PO-UNT-QTY                             21060000
210900                  ,:IMCNPO-CRE-BY-USR-ID                          21090000
211000                  ,:IMCNPO-CRE-TMST                               21100000
211100                  ,:IMCNPO-LAST-UPD-BY-USR-ID                     21110000
211200                  ,:IMCNPO-LAST-UPD-TMST                          21120000
211300                  ,:IMCNPO-EXTL-REF-NBR                           21130000
211400                  ,:IMCNPO-BKR-FRGT-RLSE-CDE                      21140000
211500                  ,:IMCNPO-DO-RCVD-CDE                            21150000
211600                  ,:IMCNPO-CONTNR-PU-CDE                          21160000
211700                  ,:IMCNPO-ACTL-POE-DELY-CDE                      21170000
211800                  ,:IMCNPO-DVN-CDE                                21180000
211900                  ,:IMCNPO-DCONSLR-RET-CDE                        21190000
212000                  ,:IMCNPO-SPLT-XMIT-CDE                          21200000
212001                  ,:IMCNPO-DOC-RCVD-ORGN-TMST                     21200100
212002               FROM TIMCNTK A                                     21200200
212100                  , TIMCNPO B                                     21210000
212200              WHERE B.PO_NBR           = :IMCNPO-PO-NBR           21220000
212300                AND B.EXTL_REF_NBR     = :IMCNPO-EXTL-REF-NBR     21230000
212400                AND B.CONTNR_ID        = :IMCNTK-CONTNR-ID        21240000
212500                AND B.CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR   21250000
212600                AND A.CONTNR_ID        = B.CONTNR_ID              21260000
212700                AND A.CONTNR_SEQ_NBR   = B.CONTNR_SEQ_NBR         21270000
212800         END-EXEC                                                 21280000
212900                                                                  21290000
213000         EVALUATE TRUE                                            21300000
213100             WHEN SQLCODE = ZERO                                  21310000
213200                 SET PS-CNTK-FOUND TO TRUE                        21320000
213300                                                                  21330000
213400             WHEN SQLCODE = +100                                  21340000
213500                 SET PS-CNTK-FOUND-NO TO TRUE                     21350000
213600                                                                  21360000
213700             WHEN SQLCODE = -904                                  21370000
213800             WHEN SQLCODE = -913                                  21380000
213900                 CONTINUE                                         21390000
214000                                                                  21400000
214100             WHEN OTHER                                           21410000
214200                 DISPLAY '**************************************' 21420000
214300                 DISPLAY '** ABEND                            **' 21430000
214400                 DISPLAY '** PROGRAM = TRKUP235               **' 21440000
214500                 DISPLAY '** PARAGRAPH = 7100-SELECT-TIMCNPO  **' 21450000
214600                 DISPLAY '** SELECT TIMCNPO                   **' 21460000
214700                 DISPLAY '**************************************' 21470000
214800                 DISPLAY '** CONTNR ID          '                 21480000
214900                                    IMCNTK-CONTNR-ID              21490000
215000                 DISPLAY '** IMCNPO-EXTL-REF-NBR '                21500000
215100                                    IMCNPO-EXTL-REF-NBR           21510000
215200                 DISPLAY '** TR026-ETA-PO-NBR        '            21520000
215300                                    TR026-ETA-PO-NBR              21530000
215400                 DISPLAY '**************************************' 21540000
215500                 PERFORM 9100-SQL-ABEND                           21550000
215600         END-EVALUATE                                             21560000
215700     END-PERFORM.                                                 21570000
215800                                                                  21580000
215900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21590000
216000         (SQLCODE NOT = ZERO  AND                                 21600000
216100          SQLCODE NOT = +100)                                     21610000
216200                                                                  21620000
216300         DISPLAY '****************************************'       21630000
216400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       21640000
216500         DISPLAY '** SELECT FROM TIMCNPO                **'       21650000
216600         DISPLAY '** PARAGRAPH = 7100-SELECT-TIMCNPO    **'       21660000
216700                 DISPLAY '** CONTNR ID          '                 21670000
216800                                    IMCNTK-CONTNR-ID              21680000
216900                 DISPLAY '** IMCNPO-EXTL-REF-NBR '                21690000
217000                                    IMCNPO-EXTL-REF-NBR           21700000
217100                 DISPLAY '** TR026-ETA-PO-NBR        '            21710000
217200                                    TR026-ETA-PO-NBR              21720000
217300         DISPLAY '****************************************'       21730000
217400         PERFORM 9100-SQL-ABEND                                   21740000
217500     END-IF.                                                      21750000
217600                                                                  21760000
217700 EJECT                                                            21770000
236200                                                                  23620000
236201******************************************************************23620100
236202* INSERT A ROW INTO THE CONTAINER PO AUDIT TABLE (TAUCNPO).      *23620200
236203******************************************************************23620300
236204 7210-INSERT-TAUCNPO.                                             23620400
236205                                                                  23620500
236206     PERFORM                                                      23620600
236207         WITH TEST AFTER                                          23620700
236208         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     23620800
236209         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            23620900
236210                 SQLCODE = ZERO                                   23621000
236211                                                                  23621100
236212         EXEC SQL                                                 23621200
236213             INSERT INTO TAUCNPO                                  23621300
236214                   ( CONTNR_ID                                    23621400
236215                    ,CONTNR_SEQ_NBR                               23621500
236216                    ,PO_NBR                                       23621600
236217                    ,CSTM_ENTR_ID                                 23621700
236218                    ,MSTR_BOL_NBR                                 23621800
236219                    ,HSE_BOL_NBR                                  23621900
236220                    ,LTR_OF_CR_NBR                                23622000
236221                    ,PO_RCVD_DELY_TMST                            23622100
236222                    ,PO_C_O_PROD_CDE                              23622200
236223                    ,PO_CART_CNT                                  23622300
236224                    ,PO_CBMT_QTY                                  23622400
236225                    ,PO_WT_KGRM_QTY                               23622500
236226                    ,PO_UNT_QTY                                   23622600
236227                    ,LAST_UPD_BY_USR_ID                           23622700
236228                    ,LAST_UPD_TMST                                23622800
236229                    ,AUD_FUNC_CDE                                 23622900
236230                    ,AUD_TMST                                     23623000
236231                    ,EXTL_REF_NBR                                 23623100
236232                    ,BKR_FRGT_RLSE_CDE                            23623200
236233                    ,DO_RCVD_CDE                                  23623300
236234                    ,CONTNR_PU_CDE                                23623400
236235                    ,ACTL_POE_DELY_CDE                            23623500
236236                    ,DVN_CDE                                      23623600
236237                    ,DCONSLR_RET_CDE                              23623700
236238                    ,SPLT_XMIT_CDE                                23623800
236239                    ,DOC_RCVD_ORGN_TMST)                          23623900
236240             VALUES                                               23624000
236241                    (:AUCNPO-CONTNR-ID                            23624100
236242                    ,:AUCNPO-CONTNR-SEQ-NBR                       23624200
236243                    ,:AUCNPO-PO-NBR                               23624300
236244                    ,:AUCNPO-CSTM-ENTR-ID                         23624400
236245                    ,:AUCNPO-MSTR-BOL-NBR                         23624500
236246                    ,:AUCNPO-HSE-BOL-NBR                          23624600
236247                    ,:AUCNPO-LTR-OF-CR-NBR                        23624700
236248                    ,:AUCNPO-PO-RCVD-DELY-TMST                    23624800
236249                    ,:AUCNPO-PO-C-O-PROD-CDE                      23624900
236250                    ,:AUCNPO-PO-CART-CNT                          23625000
236251                    ,:AUCNPO-PO-CBMT-QTY                          23625100
236252                    ,:AUCNPO-PO-WT-KGRM-QTY                       23625200
236253                    ,:AUCNPO-PO-UNT-QTY                           23625300
236254                    ,:AUCNPO-LAST-UPD-BY-USR-ID                   23625400
236255                    ,:AUCNPO-LAST-UPD-TMST                        23625500
236256                    ,:AUCNPO-AUD-FUNC-CDE                         23625600
236257                    ,:AUCNPO-AUD-TMST                             23625700
236258                    ,:AUCNPO-EXTL-REF-NBR                         23625800
236259                    ,:AUCNPO-BKR-FRGT-RLSE-CDE                    23625900
236260                    ,:AUCNPO-DO-RCVD-CDE                          23626000
236261                    ,:AUCNPO-CONTNR-PU-CDE                        23626100
236262                    ,:AUCNPO-ACTL-POE-DELY-CDE                    23626200
236263                    ,:AUCNPO-DVN-CDE                              23626300
236264                    ,:AUCNPO-DCONSLR-RET-CDE                      23626400
236265                    ,:AUCNPO-SPLT-XMIT-CDE                        23626500
236266                    ,:AUCNPO-DOC-RCVD-ORGN-TMST)                  23626600
236267                                                                  23626700
236268         END-EXEC                                                 23626800
236269                                                                  23626900
236270         EVALUATE TRUE                                            23627000
236271             WHEN SQLCODE = ZERO                                  23627100
236272                 ADD +1 TO PA-TOT-ACNPO-INSERTS                   23627200
236273                 ADD +1 TO PA-TOT-RECS-AUDITED                    23627300
236274                                                                  23627400
236275             WHEN SQLCODE = -904                                  23627500
236276             WHEN SQLCODE = -913                                  23627600
236277                 CONTINUE                                         23627700
236278                                                                  23627800
236279             WHEN OTHER                                           23627900
236280                 DISPLAY '**************************************' 23628000
236281                 DISPLAY '** ABEND                            **' 23628100
236282                 DISPLAY '** PROGRAM = TRKUP235               **' 23628200
236283                 DISPLAY '** PARAGRAPH = 7210-INSERT-TAUCNPO  **' 23628300
236284                 DISPLAY '** INSERT INTO TAUCNPO              **' 23628400
236285                 DISPLAY '** AUCNPO-CONTNR-ID = '                 23628500
236286                 DISPLAY                   AUCNPO-CONTNR-ID       23628600
236287                 DISPLAY '** CONTNR SEQ NBR  = '                  23628700
236288                 DISPLAY                   AUCNPO-CONTNR-SEQ-NBR  23628800
236289                 DISPLAY '** CONTNR PO NBR   = '                  23628900
236290                 DISPLAY                   AUCNPO-PO-NBR          23629000
236291                 DISPLAY '** EXTL REF NBR    = '                  23629100
236292                 DISPLAY                   AUCNPO-EXTL-REF-NBR    23629200
236293                 DISPLAY '**************************************' 23629300
236294                 PERFORM 9100-SQL-ABEND                           23629400
236295         END-EVALUATE                                             23629500
236296     END-PERFORM.                                                 23629600
236297                                                                  23629700
236298     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    23629800
236299         SQLCODE NOT = ZERO                                       23629900
236300         DISPLAY '****************************************'       23630000
236301         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       23630100
236302         DISPLAY '** INSERT TO TAUCNPO                  **'       23630200
236303         DISPLAY '** PARAGRAPH = 7210-INSERT-TAUCNPO    **'       23630300
236304         DISPLAY '** AUCNPO-CONTNR-ID = ' AUCNPO-CONTNR-ID        23630400
236305         DISPLAY '** CONTNR SEQ NBR   = '                         23630500
236306         DISPLAY                     AUCNPO-CONTNR-SEQ-NBR        23630600
236307         DISPLAY '** CONTNR PO NBR    = '                         23630700
236308         DISPLAY                     AUCNPO-PO-NBR                23630800
236309         DISPLAY '** EXTL REF NBR     = '                         23630900
236310         DISPLAY                     AUCNPO-EXTL-REF-NBR          23631000
236311         DISPLAY '****************************************'       23631100
236312         PERFORM 9100-SQL-ABEND                                   23631200
236313     END-IF.                                                      23631300
236314                                                                  23631400
236315 EJECT                                                            23631500
236316******************************************************************23631600
236317* INSERT A ROW INTO THE DB2 WORK TABLE (TOUTTR8).                *23631700
236318******************************************************************23631800
236319 7300-INSERT-TOUTTR8-RPT.                                         23631900
236320                                                                  23632000
236321     MOVE TR231-ARRVL-PAR-1-ODR    TO OUTTR8-ARRVL-PAR-1-ODR.     23632100
236322     MOVE TR231-ARRVL-PAR-2-ODR    TO OUTTR8-ARRVL-PAR-2-ODR.     23632200
236323                                                                  23632300
236324     IF TR231-RPT-TYP = PC-D                                      23632400
236325        ADD +1                  TO PA-TOTAL-DETAIL-COUNT          23632500
236326        ADD +1                  TO PA-TOTAL-RECS-LOADED           23632600
236327     ELSE                                                         23632700
236328        ADD +1                  TO PA-TOTAL-ERROR-COUNT           23632800
236329        ADD +1                  TO PA-TOTAL-RECS-LOADED           23632900
236330     END-IF.                                                      23633000
236331                                                                  23633100
236332       PERFORM                                                    23633200
236333         WITH TEST AFTER                                          23633300
236334         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     23633400
236335         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            23633500
236336                 SQLCODE = ZERO                                   23633600
236337                                                                  23633700
236338     EXEC SQL                                                     23633800
236339         INSERT INTO TOUTTR8                                      23633900
236340           (ARRVL_PAR_1_ODR,                                      23634000
236341            ARRVL_PAR_2_ODR)                                      23634100
236342          VALUES  (:OUTTR8-ARRVL-PAR-1-ODR,                       23634200
236343                   :OUTTR8-ARRVL-PAR-2-ODR)                       23634300
236344     END-EXEC                                                     23634400
236345                                                                  23634500
236346         EVALUATE TRUE                                            23634600
236347             WHEN SQLCODE = ZERO                                  23634700
236348                 CONTINUE                                         23634800
236349                                                                  23634900
236350             WHEN SQLCODE = -904                                  23635000
236351             WHEN SQLCODE = -913                                  23635100
236352                 CONTINUE                                         23635200
236353                                                                  23635300
236354             WHEN SQLWARN0 NOT EQUAL SPACE                        23635400
236355             WHEN SQLCODE NOT EQUAL ZERO                          23635500
236356                 DISPLAY '**************************************' 23635600
236357                 DISPLAY '** ABEND                            **' 23635700
236358                 DISPLAY '** PROGRAM = TRKUP235               **' 23635800
236359              DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR8-RPT **' 23635900
236360                 DISPLAY '** INSERT INTO TOUTTR8              **' 23636000
236361                 DISPLAY '** TR231-CONTNR-ID = ' TR231-CONTNR-ID  23636100
236362                 DISPLAY '** CONTNR ID          '                 23636200
236363                                    IMCNTK-CONTNR-ID              23636300
236364                 DISPLAY '** TR026-ETA-EXTL-REF-NBR '             23636400
236365                                    TR026-ETA-EXTL-REF-NBR        23636500
236366                 DISPLAY '** TR026-ETA-PO-NBR        '            23636600
236367                                    TR026-ETA-PO-NBR              23636700
236368                 DISPLAY '**************************************' 23636800
236369                 PERFORM 9100-SQL-ABEND                           23636900
236370         END-EVALUATE                                             23637000
236371     END-PERFORM.                                                 23637100
236372                                                                  23637200
236373     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    23637300
236374         (SQLCODE NOT = ZERO)                                     23637400
236375        DISPLAY '****************************************'        23637500
236376        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    23637600
236377        DISPLAY '** INSERT TO TOUTTR8                      **'    23637700
236378        DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR8-RPT    **'    23637800
236379        DISPLAY '** TR231-CONTNR-ID = ' TR231-CONTNR-ID           23637900
236380        DISPLAY '** TR231-PROCESS-SEQ-NBR = '                     23638000
236381        DISPLAY                TR231-PROCESS-SEQ-NBR              23638100
236382        DISPLAY '****************************************'        23638200
236383      PERFORM 9100-SQL-ABEND                                      23638300
236384     END-IF.                                                      23638400
236385                                                                  23638500
236386 EJECT                                                            23638600
236387                                                                  23638700
236388******************************************************************23638800
236389* BUILD CONTAINER RULES FILE FOR DECONSOLIDATOR CONTROL          *23638900
236390* PROCESSING.                                                    *23639000
236391******************************************************************23639100
236392                                                                  23639200
236393 7400-BUILD-CNTR-RULE-FILE.                                       23639300
236394                                                                  23639400
236395     INITIALIZE TR265-CONTNR-RULES-REC.                           23639500
236396                                                                  23639600
236397     PERFORM 7410-SET-RULES-CURRENT-TMST.                         23639700
236398     MOVE PV-CURRENT-TMST-RULES   TO TR265-CONTNR-CURRENT-TMST.   23639800
236399     MOVE PC-CMN                  TO TR265-CONTNR-REC-SRC.        23639900
236400     MOVE PC-C                    TO TR265-CONTNR-TRN-TYP.        23640000
236500     MOVE IMCNTK-CONTNR-ID        TO TR265-CONTNR-ID.             23650000
236600     MOVE IMCNTK-DAT-SRC-ENT-ID   TO TR265-CONTNR-DAT-SRC-ENTID.  23660000
236700     MOVE IMCNTK-DVN-TMST         TO TR265-CONTNR-DVN-TMST.       23670000
236800     MOVE PV-HLD-FILE-ID          TO TR265-CONTNR-FILE-ID.        23680000
236900     MOVE IMCNTK-CONTNR-SEQ-NBR   TO TR265-CONTNR-SEQ-NBR-CUR     23690000
237000                                     TR265-CONTNR-SEQ-NBR-PREV.   23700000
237100     MOVE IMCNTK-MOM-IMPRT-TRIP-ID                                23710000
237200                                  TO TR265-CONTNR-TRIP-ID-CUR     23720000
237300                                     TR265-CONTNR-TRIP-ID-PREV.   23730000
237400     MOVE IMCNTK-MOM-DPRTR-TMST   TO                              23740000
237500                                  TR265-CONTNR-DPRTR-TMST-CUR     23750000
237600                                  TR265-CONTNR-DPRTR-TMST-PREV.   23760000
237700     MOVE PV-HLD-MOM-POE-DELY-TMST TO                             23770000
237800                                  TR265-CONTNR-POE-DELY-TMST-CUR. 23780000
237900     MOVE PV-HLD-PRV-MOM-POE-DELY-TMST TO                         23790000
238000                                  TR265-CONTNR-POE-DELY-TMST-PRV. 23800000
238100     MOVE IMCNTK-MOM-IMPRT-VEH-NM TO TR265-CONTNR-VEH-NM-CUR      23810000
238200                                     TR265-CONTNR-VEH-NM-PREV.    23820000
238300                                                                  23830000
238400     IF IMCNTK-MOM-FOB-CDE > SPACES                               23840000
238500         MOVE IMCNTK-MOM-FOB-CDE TO PV-COMPARE-MOM-FOB-CDE        23850000
238600         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO PV-COMPARE-TRIP-TYP-CDE  23860000
238700         PERFORM 7420-EDIT-FOB-CDE-DCN                            23870000
238800         MOVE PV-TR265-FOB-CDE    TO TR265-CONTNR-FOB-CDE-CUR     23880000
238900                                     TR265-CONTNR-FOB-CDE-PREV    23890000
239000     END-IF.                                                      23900000
239100                                                                  23910000
239200     IF PV-HLD-MOM-DEST-POE-CDE > SPACES                          23920000
239300         MOVE PV-HLD-MOM-DEST-POE-CDE TO PV-COMPARE-MOM-POE-CDE   23930000
239400         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO PV-COMPARE-TRIP-TYP-CDE  23940000
239500         PERFORM 7430-EDIT-POE-CDE-DCN                            23950000
239600         MOVE PV-TR265-POE-CDE    TO TR265-CONTNR-POE-CDE-CUR     23960000
239700                                                                  23970000
239800     END-IF.                                                      23980000
239900                                                                  23990000
240000     IF AUCNTK-MOM-DEST-POE-CDE > SPACES                          24000000
240100         MOVE AUCNTK-MOM-DEST-POE-CDE                             24010000
240200                                  TO PV-COMPARE-MOM-POE-CDE       24020000
240300         MOVE AUCNTK-MOM-TRIP-TYP-CDE TO                          24030000
240400                                    PV-COMPARE-TRIP-TYP-CDE       24040000
240500         PERFORM 7430-EDIT-POE-CDE-DCN                            24050000
240600         MOVE PV-TR265-POE-CDE TO TR265-CONTNR-POE-CDE-PREV       24060000
240700                                                                  24070000
240800     END-IF.                                                      24080000
240900                                                                  24090000
241000     MOVE TR265-COMMON-FIELDS1  TO TRT00034-RUL-REC-1-TXT.        24100000
241100     MOVE TR265-COMMON-FIELDS2  TO TRT00034-RUL-REC-2-TXT.        24110000
241200     PERFORM 7499-INSERT-LOAD-RULE-TABLE.                         24120000
241201                                                                  24120100
241202                                                                  24120200
241203******************************************************************24120300
241204* SET THE CURRENT TIMESTAMP FOR DECONSOLIDATOR RULES PROCESSING  *24120400
241205******************************************************************24120500
241206 7410-SET-RULES-CURRENT-TMST.                                     24120600
241207                                                                  24120700
241208          EXEC SQL                                                24120800
241209              SET :PV-CURRENT-TMST-RULES = CURRENT TIMESTAMP      24120900
241210          END-EXEC                                                24121000
241220                                                                  24122000
241230         EVALUATE TRUE                                            24123000
241240             WHEN SQLCODE = ZERO                                  24124000
241250                 CONTINUE                                         24125000
241260                                                                  24126000
241270             WHEN SQLWARN0 NOT EQUAL SPACE                        24127000
241280             WHEN SQLCODE NOT EQUAL ZERO                          24128000
241290              DISPLAY '**************************************'    24129000
241300              DISPLAY '** ABEND                            **'    24130000
241400              DISPLAY '** PROGRAM = TRKUP235               **'    24140000
241500              DISPLAY '** PARAGRAPH = 7410-SET-RULES-CURRENT-TMST'24150000
241600              DISPLAY '** SET CURRENT TIMESTAMP            **'    24160000
241700              DISPLAY '** CURRENT TMST = ' PV-CURRENT-TMST-RULES  24170000
241800              DISPLAY '**************************************'    24180000
241900              PERFORM 9100-SQL-ABEND                              24190000
242000         END-EVALUATE.                                            24200000
242100                                                                  24210000
242200******************************************************************24220000
242300* EDIT THE FOB CODE FOR DECON CONTROL PANEL CHANGES              *24230000
242400******************************************************************24240000
242500 7420-EDIT-FOB-CDE-DCN.                                           24250000
242600                                                                  24260000
242700     EVALUATE TRUE                                                24270000
242800         WHEN PV-COMPARE-TRIP-TYP-CDE = PC-A                      24280000
242900             PERFORM 7421-SELECT-FOB-AIR-DCN                      24290000
243000                                                                  24300000
243100         WHEN PV-COMPARE-TRIP-TYP-CDE = PC-O                      24310000
243200             PERFORM 7422-SELECT-FOB-OCEAN-DCN                    24320000
243300     END-EVALUATE.                                                24330000
243400                                                                  24340000
243500******************************************************************24350000
243600* SELECT FOB CODE FOR AIR - DECON CONTROL PANEL CHANGES          *24360000
243700******************************************************************24370000
243800 7421-SELECT-FOB-AIR-DCN.                                         24380000
243900                                                                  24390000
244000     PERFORM                                                      24400000
244100         WITH TEST AFTER                                          24410000
244200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     24420000
244300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            24430000
244400                 SQLCODE = ZERO                     OR            24440000
244500                 SQLCODE = -811                     OR            24450000
244600                 SQLCODE = +100                                   24460000
244700                                                                  24470000
244800         EXEC SQL                                                 24480000
244900             SELECT A.FOB_CDE                                     24490000
245000              INTO :IMFOB-FOB-CDE                                 24500000
245100               FROM TIMFOB  A                                     24510000
245200              WHERE A.FOB_CDE     =   :PV-COMPARE-MOM-FOB-CDE     24520000
245300                AND A.STAT_CDE    =   'A'                         24530000
245400         END-EXEC                                                 24540000
245500                                                                  24550000
245600         EVALUATE TRUE                                            24560000
245700             WHEN SQLCODE = ZERO                                  24570000
245800             WHEN SQLCODE = -811                                  24580000
245900                 MOVE IMFOB-FOB-CDE TO PV-TR265-FOB-CDE           24590000
246000                                                                  24600000
246100             WHEN SQLCODE = +100                                  24610000
246200                 MOVE SPACES TO PV-TR265-FOB-CDE                  24620000
246300                                                                  24630000
246400             WHEN SQLWARN0 NOT EQUAL SPACE                        24640000
246500             WHEN SQLCODE NOT EQUAL ZERO                          24650000
246600                 DISPLAY '**************************************' 24660000
246700                 DISPLAY '** ABEND                            **' 24670000
246800                 DISPLAY '** PROGRAM = TRKUP235               **' 24680000
246900                 DISPLAY '** PARAGRAPH = 7421-SELECT-FOB-AIR-DCN' 24690000
247000                 DISPLAY '** SELECT TIMFOB FOB CODE - DECON   **' 24700000
247100                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     24710000
247200                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST24720000
247300                 DISPLAY '** FOB CODE    = ' IMCNTK-MOM-FOB-CDE   24730000
247400                 DISPLAY '**************************************' 24740000
247500                 PERFORM 9100-SQL-ABEND                           24750000
247600         END-EVALUATE                                             24760000
247700     END-PERFORM.                                                 24770000
247800                                                                  24780000
247900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    24790000
248000         (SQLCODE NOT = ZERO    AND                               24800000
248100          SQLCODE NOT = -811    AND                               24810000
248200          SQLCODE NOT = +100)                                     24820000
248300         DISPLAY '****************************************'       24830000
248400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       24840000
248500         DISPLAY '** SELECT FROM TIMFOB                 **'       24850000
248600         DISPLAY '** PARAGRAPH = 7421-SELECT-FOB-AIR-DCN**'       24860000
248700         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            24870000
248800         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       24880000
248900         DISPLAY '** FOB CODE     = ' IMCNTK-MOM-FOB-CDE          24890000
249000         DISPLAY '****************************************'       24900000
249100         PERFORM 9100-SQL-ABEND                                   24910000
249200     END-IF.                                                      24920000
249300                                                                  24930000
249400 EJECT                                                            24940000
249500******************************************************************24950000
249600* SELECT FOB CODE FOR OCEAN - DECON CONTROL PANEL CHANGES        *24960000
249700******************************************************************24970000
249800 7422-SELECT-FOB-OCEAN-DCN.                                       24980000
249900                                                                  24990000
250000     PERFORM                                                      25000000
250100         WITH TEST AFTER                                          25010000
250200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     25020000
250300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            25030000
250400                 SQLCODE = ZERO                     OR            25040000
250500                 SQLCODE = -811                     OR            25050000
250600                 SQLCODE = +100                                   25060000
250700                                                                  25070000
250800         EXEC SQL                                                 25080000
250900             SELECT A.FOB_CDE                                     25090000
251000              INTO :IMFOB-FOB-CDE                                 25100000
251100               FROM TIMFOB  A                                     25110000
251200              WHERE A.FOB_STD_EDI_CDE  = :PV-COMPARE-MOM-FOB-CDE  25120000
251300                AND A.STAT_CDE         = 'A'                      25130000
251400         END-EXEC                                                 25140000
251500                                                                  25150000
251600         EVALUATE TRUE                                            25160000
251700             WHEN SQLCODE = ZERO                                  25170000
251800             WHEN SQLCODE = -811                                  25180000
251900                 MOVE IMFOB-FOB-CDE TO PV-TR265-FOB-CDE           25190000
252000                                                                  25200000
252100             WHEN SQLCODE = +100                                  25210000
252200                 MOVE SPACES TO PV-TR265-FOB-CDE                  25220000
252300                                                                  25230000
252400             WHEN SQLWARN0 NOT EQUAL SPACE                        25240000
252500             WHEN SQLCODE NOT EQUAL ZERO                          25250000
252600                 DISPLAY '**************************************' 25260000
252700                 DISPLAY '** ABEND                            **' 25270000
252800                 DISPLAY '** PROGRAM = TRKUP235               **' 25280000
252900              DISPLAY '** PARAGRAPH = 7422-SELECT-FOB-OCEAN-DCN'  25290000
253000                 DISPLAY '** SELECT TIMFOB FOB CODE - DECON   **' 25300000
253100                 DISPLAY '** CONTNR ID   = ' IMCNTK-CONTNR-ID     25310000
253200                 DISPLAY '** SAIL DATE   = ' IMCNTK-MOM-DPRTR-TMST25320000
253300                 DISPLAY '** FOB CODE    = ' IMCNTK-MOM-FOB-CDE   25330000
253400                 DISPLAY '**************************************' 25340000
253500                 PERFORM 9100-SQL-ABEND                           25350000
253600         END-EVALUATE                                             25360000
253700     END-PERFORM.                                                 25370000
253800                                                                  25380000
253900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25390000
254000         (SQLCODE NOT = ZERO    AND                               25400000
254100          SQLCODE NOT = -811 AND                                  25410000
254200          SQLCODE NOT = +100)                                     25420000
254300         DISPLAY '****************************************'       25430000
254400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       25440000
254500         DISPLAY '** SELECT FROM TIMFOB                 **'       25450000
254600         DISPLAY '** PARAGRAPH = 7422-SELECT-FOB-OCEAN-DCN'       25460000
254700         DISPLAY '** CONTNR ID    = ' IMCNTK-CONTNR-ID            25470000
254800         DISPLAY '** SAIL DATE    = ' IMCNTK-MOM-DPRTR-TMST       25480000
254900         DISPLAY '** FOB CODE     = ' IMCNTK-MOM-FOB-CDE          25490000
255000         DISPLAY '****************************************'       25500000
255100         PERFORM 9100-SQL-ABEND                                   25510000
255200     END-IF.                                                      25520000
255300                                                                  25530000
255400                                                                  25540000
255500******************************************************************25550000
255600* EDIT THE POE CODE FOR DECON CONTROL PANEL                      *25560000
255700******************************************************************25570000
255800 7430-EDIT-POE-CDE-DCN.                                           25580000
255900                                                                  25590000
256000     EVALUATE TRUE                                                25600000
256100         WHEN PV-COMPARE-TRIP-TYP-CDE = PC-A                      25610000
256200             PERFORM 7431-OPEN-POE-CURSOR-AIR-DCN                 25620000
256300             PERFORM 7433-FETCH-POE-CURSOR-AIR-DCN                25630000
256400             PERFORM 7432-CLOSE-POE-CURSOR-AIR-DCN                25640000
256500                                                                  25650000
256600         WHEN PV-COMPARE-TRIP-TYP-CDE = PC-O                      25660000
256700             PERFORM 7441-OPEN-POE-CURSOR-OCEAN-DCN               25670000
256800             PERFORM 7443-FETCH-POE-CURSOR-OCN-DCN                25680000
256900             PERFORM 7442-CLOSE-POE-CURSOR-OCN-DCN                25690000
257000     END-EVALUATE.                                                25700000
257100                                                                  25710000
257200******************************************************************25720000
257300*   OPEN THE POE CODE AIR CURSOR FOR CONTROL DECON PANEL         *25730000
257400******************************************************************25740000
257500 7431-OPEN-POE-CURSOR-AIR-DCN.                                    25750000
257600                                                                  25760000
257700     PERFORM                                                      25770000
257800         WITH TEST AFTER                                          25780000
257900         VARYING PV-RETRY-COUNTER                                 25790000
258000         FROM 1 BY 1                                              25800000
258100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25810000
258200                   OR (SQLCODE = ZERO))                           25820000
258300                                                                  25830000
258400         EXEC SQL                                                 25840000
258500              OPEN POE-CSR-AIR-DCN                                25850000
258600         END-EXEC                                                 25860000
258700                                                                  25870000
258800         EVALUATE TRUE                                            25880000
258900             WHEN SQLCODE = ZERO                                  25890000
259000                 CONTINUE                                         25900000
259100             WHEN SQLWARN0 NOT EQUAL SPACE                        25910000
259200             WHEN SQLCODE NOT EQUAL ZERO                          25920000
259300                 DISPLAY '**************************************' 25930000
259400                 DISPLAY '** ABEND                            **' 25940000
259500                 DISPLAY '** PROGRAM = TRKUP235               **' 25950000
259600              DISPLAY '** PARAGRAPH = 7431-OPEN-POE-CSR-AIR-DCN*' 25960000
259700                 DISPLAY '** OPEN POE CODE AIR CURSOR - DECON **' 25970000
259800                 DISPLAY '**************************************' 25980000
259900                 PERFORM 9100-SQL-ABEND                           25990000
260000         END-EVALUATE                                             26000000
260100     END-PERFORM.                                                 26010000
260200                                                                  26020000
260300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26030000
260400         (SQLCODE NOT = ZERO)                                     26040000
260500         DISPLAY '****************************************'       26050000
260600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       26060000
260700         DISPLAY '** OPEN POE CODE AIR CURSOR - DECON   **'       26070000
260800         DISPLAY '** PARAGRAPH = 7431-OPEN-POE-CURSOR-AIR-DCN'    26080000
260900         DISPLAY '****************************************'       26090000
261000         PERFORM 9100-SQL-ABEND                                   26100000
261100     END-IF.                                                      26110000
261200                                                                  26120000
261300 EJECT                                                            26130000
261400******************************************************************26140000
261500*   CLOSE THE POE CODE AIR CURSOR FOR DECON CONTROL PANEL        *26150000
261600******************************************************************26160000
261700 7432-CLOSE-POE-CURSOR-AIR-DCN.                                   26170000
261800                                                                  26180000
261900     PERFORM                                                      26190000
262000         WITH TEST AFTER                                          26200000
262100         VARYING PV-RETRY-COUNTER                                 26210000
262200         FROM 1 BY 1                                              26220000
262300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26230000
262400                   OR (SQLCODE = ZERO))                           26240000
262500                                                                  26250000
262600         EXEC SQL                                                 26260000
262700             CLOSE POE-CSR-AIR-DCN                                26270000
262800         END-EXEC                                                 26280000
262900                                                                  26290000
263000         EVALUATE TRUE                                            26300000
263100             WHEN SQLCODE = ZERO                                  26310000
263200                 CONTINUE                                         26320000
263300             WHEN SQLWARN0 NOT EQUAL SPACE                        26330000
263400             WHEN SQLCODE NOT EQUAL ZERO                          26340000
263500                 DISPLAY '**************************************' 26350000
263600                 DISPLAY '** ABEND                            **' 26360000
263700                 DISPLAY '** PROGRAM = TRKUP235               **' 26370000
263800              DISPLAY '** PARAGRAPH = 7432-CLOSE-POE-CSR-AIR-DCN' 26380000
263900                 DISPLAY '** CLOSE POE CODE AIR CURSOR - DECON**' 26390000
264000                 DISPLAY '**************************************' 26400000
264100                 PERFORM 9100-SQL-ABEND                           26410000
264200         END-EVALUATE                                             26420000
264300     END-PERFORM.                                                 26430000
264400                                                                  26440000
264500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26450000
264600         (SQLCODE NOT = ZERO)                                     26460000
264700         DISPLAY '****************************************'       26470000
264800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       26480000
264900         DISPLAY '** CLOSE POE CODE AIR CURSOR - DECON  **'       26490000
265000         DISPLAY '** PARAGRAPH = 7432-CLOSE-POE-CSR-AIR-DCN'      26500000
265100         DISPLAY '****************************************'       26510000
265200         PERFORM 9100-SQL-ABEND                                   26520000
265300     END-IF.                                                      26530000
265400                                                                  26540000
265500 EJECT                                                            26550000
265600******************************************************************26560000
265700*    FETCH THE POE CODE AIR CURSOR FOR DECON CONTROL PANEL       *26570000
265800******************************************************************26580000
265900 7433-FETCH-POE-CURSOR-AIR-DCN.                                   26590000
266000                                                                  26600000
266100     EXEC SQL                                                     26610000
266200          FETCH POE-CSR-AIR-DCN                                   26620000
266300          INTO  :IMPOE-POE-CDE                                    26630000
266400     END-EXEC.                                                    26640000
266500                                                                  26650000
266600     EVALUATE TRUE                                                26660000
266700         WHEN SQLCODE = ZERO                                      26670000
266800         WHEN SQLCODE = -811                                      26680000
266900             SET PS-VALID-POE-CDE    TO TRUE                      26690000
267000             MOVE IMPOE-POE-CDE TO PV-TR265-POE-CDE               26700000
267100                                                                  26710000
267200         WHEN SQLCODE = +100                                      26720000
267300             SET PS-INVALID-POE-CDE  TO TRUE                      26730000
267400             MOVE SPACES TO PV-TR265-POE-CDE                      26740000
267500                                                                  26750000
267600         WHEN SQLWARN0 NOT EQUAL SPACE                            26760000
267700         WHEN SQLCODE NOT EQUAL ZERO                              26770000
267800             DISPLAY '**************************************'     26780000
267900             DISPLAY '** ABEND                            **'     26790000
268000             DISPLAY '** PROGRAM = TRKUP235               **'     26800000
268100             DISPLAY '** PARAGRAPH = 7433-FETCH-POE-CSR-AIR-DCN'  26810000
268200             DISPLAY '** FETCH TIMPOE POE CODE AIR - DECON**'     26820000
268300             DISPLAY '** POE CDE AIR = ' PV-COMPARE-MOM-POE-CDE   26830000
268400             DISPLAY '**************************************'     26840000
268500             PERFORM 9100-SQL-ABEND                               26850000
268600     END-EVALUATE.                                                26860000
268700                                                                  26870000
268800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26880000
268900         (SQLCODE NOT = ZERO    AND                               26890000
269000          SQLCODE NOT = -811    AND                               26900000
269100          SQLCODE NOT = +100)                                     26910000
269200         DISPLAY '****************************************'       26920000
269300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       26930000
269400         DISPLAY '** FETCH FROM TIMPOE                  **'       26940000
269500         DISPLAY '** PARAGRAPH = 7433-FETCH-POE-CSR-AIR-DCN'      26950000
269600         DISPLAY '** POE CDE AIR = ' PV-COMPARE-MOM-POE-CDE       26960000
269700         DISPLAY '****************************************'       26970000
269800         PERFORM 9100-SQL-ABEND                                   26980000
269900     END-IF.                                                      26990000
270000                                                                  27000000
270100 EJECT                                                            27010000
270200******************************************************************27020000
270300*   OPEN THE POE CODE OCEAN CURSOR FOR DECON CONTROL PANEL       *27030000
270400******************************************************************27040000
270500 7441-OPEN-POE-CURSOR-OCEAN-DCN.                                  27050000
270600                                                                  27060000
270700     PERFORM                                                      27070000
270800         WITH TEST AFTER                                          27080000
270900         VARYING PV-RETRY-COUNTER                                 27090000
271000         FROM 1 BY 1                                              27100000
271100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27110000
271200                   OR (SQLCODE = ZERO))                           27120000
271300                                                                  27130000
271400         EXEC SQL                                                 27140000
271500              OPEN POE-CSR-OCEAN-DCN                              27150000
271600         END-EXEC                                                 27160000
271700                                                                  27170000
271800         EVALUATE TRUE                                            27180000
271900             WHEN SQLCODE = ZERO                                  27190000
272000                 CONTINUE                                         27200000
272100             WHEN SQLWARN0 NOT EQUAL SPACE                        27210000
272200             WHEN SQLCODE NOT EQUAL ZERO                          27220000
272300                 DISPLAY '**************************************' 27230000
272400                 DISPLAY '** ABEND                            **' 27240000
272500                 DISPLAY '** PROGRAM = TRKUP235               **' 27250000
272600               DISPLAY '** PARAGRAPH = 7441-OPEN-POE-CSR-OCN-DCN' 27260000
272700                 DISPLAY '** OPEN POE CODE OCEAN CURSOR- DECON**' 27270000
272800                 DISPLAY '**************************************' 27280000
272900                 PERFORM 9100-SQL-ABEND                           27290000
273000         END-EVALUATE                                             27300000
273100     END-PERFORM.                                                 27310000
273200                                                                  27320000
273300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27330000
273400         (SQLCODE NOT = ZERO)                                     27340000
273500         DISPLAY '****************************************'       27350000
273600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       27360000
273700         DISPLAY '** OPEN POE CODE OCEAN CURSOR - DECON **'       27370000
273800         DISPLAY '** PARAGRAPH = 7441-OPEN-POE-CURSOR-OCN-DCN'    27380000
273900         DISPLAY '****************************************'       27390000
274000         PERFORM 9100-SQL-ABEND                                   27400000
274100     END-IF.                                                      27410000
274200                                                                  27420000
274300 EJECT                                                            27430000
274400******************************************************************27440000
274500*   CLOSE THE POE CODE OCEAN CURSOR FOR DECON CONTROL PANEL      *27450000
274600******************************************************************27460000
274700 7442-CLOSE-POE-CURSOR-OCN-DCN.                                   27470000
274800                                                                  27480000
274900     PERFORM                                                      27490000
275000         WITH TEST AFTER                                          27500000
275100         VARYING PV-RETRY-COUNTER                                 27510000
275200         FROM 1 BY 1                                              27520000
275300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27530000
275400                   OR (SQLCODE = ZERO))                           27540000
275500                                                                  27550000
275600         EXEC SQL                                                 27560000
275700             CLOSE POE-CSR-OCEAN-DCN                              27570000
275800         END-EXEC                                                 27580000
275900                                                                  27590000
276000         EVALUATE TRUE                                            27600000
276100             WHEN SQLCODE = ZERO                                  27610000
276200                 CONTINUE                                         27620000
276300             WHEN SQLWARN0 NOT EQUAL SPACE                        27630000
276400             WHEN SQLCODE NOT EQUAL ZERO                          27640000
276500                 DISPLAY '**************************************' 27650000
276600                 DISPLAY '** ABEND                            **' 27660000
276700                 DISPLAY '** PROGRAM = TRKUP235               **' 27670000
276800              DISPLAY '** PARAGRAPH = 7442-CLOSE-POE-CSR-OCN-DCN' 27680000
276900                 DISPLAY '** CLOSE POE CODE OCEAN CURSOR-DECON**' 27690000
277000                 DISPLAY '**************************************' 27700000
277100                 PERFORM 9100-SQL-ABEND                           27710000
277200         END-EVALUATE                                             27720000
277300     END-PERFORM.                                                 27730000
277400                                                                  27740000
277500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27750000
277600         (SQLCODE NOT = ZERO)                                     27760000
277700         DISPLAY '****************************************'       27770000
277800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       27780000
277900         DISPLAY '** CLOSE POE CODE OCEAN CURSOR-DECON  **'       27790000
278000         DISPLAY '** PARAGRAPH = 7442-CLOSE-POE-CSR-OCN-DCN'      27800000
278100         DISPLAY '****************************************'       27810000
278200         PERFORM 9100-SQL-ABEND                                   27820000
278300     END-IF.                                                      27830000
278400                                                                  27840000
278500 EJECT                                                            27850000
278600******************************************************************27860000
278700*    FETCH THE POE CODE OCEAN CURSOR FOR DECON CONTROL PANEL     *27870000
278800******************************************************************27880000
278900 7443-FETCH-POE-CURSOR-OCN-DCN.                                   27890000
279000                                                                  27900000
279100     EXEC SQL                                                     27910000
279200          FETCH POE-CSR-OCEAN-DCN                                 27920000
279300          INTO  :IMPOE-POE-CDE                                    27930000
279400     END-EXEC.                                                    27940000
279500                                                                  27950000
279600     EVALUATE TRUE                                                27960000
279700         WHEN SQLCODE = ZERO                                      27970000
279800         WHEN SQLCODE = -811                                      27980000
279900             MOVE IMPOE-POE-CDE TO PV-TR265-POE-CDE               27990000
280000                                                                  28000000
280100         WHEN SQLCODE = +100                                      28010000
280200             MOVE SPACES TO PV-TR265-POE-CDE                      28020000
280300                                                                  28030000
280400                                                                  28040000
280500         WHEN SQLWARN0 NOT EQUAL SPACE                            28050000
280600         WHEN SQLCODE NOT EQUAL ZERO                              28060000
280700             DISPLAY '**************************************'     28070000
280800             DISPLAY '** ABEND                            **'     28080000
280900             DISPLAY '** PROGRAM = TRKUP235               **'     28090000
281000             DISPLAY '** PARAGRAPH = 7443-FETCH-POE-CSR-OCN-DCN'  28100000
281100             DISPLAY '** FETCH TIMPOE POE CODE OCEAN - DECON'     28110000
281200             DISPLAY '** POE CDE OCEAN  = ' PV-COMPARE-MOM-POE-CDE28120000
281300             DISPLAY '**************************************'     28130000
281400             PERFORM 9100-SQL-ABEND                               28140000
281500     END-EVALUATE.                                                28150000
281600                                                                  28160000
281700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28170000
281800         (SQLCODE NOT = ZERO    AND                               28180000
281900          SQLCODE NOT = -811    AND                               28190000
282000          SQLCODE NOT = +100)                                     28200000
282100         DISPLAY '****************************************'       28210000
282200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       28220000
282300         DISPLAY '** FETCH FROM TIMPOE                  **'       28230000
282400         DISPLAY '** PARAGRAPH = 7443-FETCH-POE-CSR-OCN-DCN'      28240000
282500         DISPLAY '** POE CDE OCEAN = ' PV-COMPARE-MOM-POE-CDE     28250000
282600         DISPLAY '****************************************'       28260000
282700         PERFORM 9100-SQL-ABEND                                   28270000
282800     END-IF.                                                      28280000
282900                                                                  28290000
283000******************************************************************28300000
283100* INSERT ROW INTO TRTW_CONTNR_RUL, THE DB2 WORK TABLE FOR THE    *28310000
283200* ERROR AND DETAIL RULE EXTRACT.                                 *28320000
283300******************************************************************28330000
283400 7499-INSERT-LOAD-RULE-TABLE.                                     28340000
283500                                                                  28350000
283600     PERFORM                                                      28360000
283700         WITH TEST AFTER                                          28370000
283800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28380000
283900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            28390000
284000                 SQLCODE = ZERO                                   28400000
284100                                                                  28410000
284200         EXEC SQL                                                 28420000
284300              INSERT INTO TRTW_CONTNR_RUL_2                       28430000
284400                  (RUL_REC_1_TXT,                                 28440000
284500                   RUL_REC_2_TXT)                                 28450000
284600                 VALUES  (:TRT00034-RUL-REC-1-TXT,                28460000
284700                          :TRT00034-RUL-REC-2-TXT)                28470000
284800         END-EXEC                                                 28480000
284900                                                                  28490000
285000         EVALUATE TRUE                                            28500000
285100                                                                  28510000
285200             WHEN SQLCODE = ZERO                                  28520000
285300                 ADD +1 TO PA-TOTAL-RULE-COUNT                    28530000
285400                                                                  28540000
285500             WHEN SQLWARN0 NOT EQUAL SPACE                        28550000
285600             WHEN SQLCODE NOT EQUAL ZERO                          28560000
285700                 DISPLAY '**************************************' 28570000
285800                 DISPLAY '** ABEND                            **' 28580000
285900                 DISPLAY '** PROGRAM = TRKUP235               **' 28590000
286000                 DISPLAY '** PARAGRAPH = 7499-INSERT-LOAD-    **' 28600000
286100                 DISPLAY '**                  RULE-TABLE      **' 28610000
286200                 DISPLAY '** INSERT TRTW_CONTNR_RUL_2         **' 28620000
286300                 DISPLAY '** TRT00033-RECORD = '                  28630000
286400                 DISPLAY '*'           TRT00034-RUL-REC-1-TXT     28640000
286500                 DISPLAY '**************************************' 28650000
286600                 PERFORM 9100-SQL-ABEND                           28660000
286700         END-EVALUATE                                             28670000
286800     END-PERFORM.                                                 28680000
286900                                                                  28690000
287000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28700000
287100         SQLCODE NOT = ZERO                                       28710000
287200         DISPLAY '****************************************'       28720000
287300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       28730000
287400         DISPLAY '** INSERT INTO TRTW_CONTNR_RUL_2      **'       28740000
287500         DISPLAY '** PARAGRAPH = 7499-INSERT-LOAD-RULE-TABLE'     28750000
287600         DISPLAY '** TRT00034-RECORD = '                          28760000
287700         DISPLAY '*'           TRT00034-RUL-REC-1-TXT             28770000
287800         DISPLAY '****************************************'       28780000
287900         PERFORM 9100-SQL-ABEND                                   28790000
288000     END-IF.                                                      28800000
288001                                                                  28800100
288002                                                                  28800200
288003 EJECT                                                            28800300
288004******************************************************************28800400
288005* INSERT ROW INTO TRTW_ARRVL_CKPR, THE DB2 WORK TABLE FOR THE    *28800500
288006* TR405 MQ MESSAGE.                                              *28800600
288007******************************************************************28800700
288008 7500-INSERT-SCM-MESSAGE.                                         28800800
288009                                                                  28800900
288010     PERFORM                                                      28801000
288020         WITH TEST AFTER                                          28802000
288030         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     28803000
288040         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            28804000
288050                 SQLCODE = ZERO                                   28805000
288060                                                                  28806000
288070         EXEC SQL                                                 28807000
288080              INSERT INTO TRTW_ARRVL_CKPR                         28808000
288090                  (CKPR_REC_1_TXT)                                28809000
288100                 VALUES  (:TRT00037-CKPR-REC-1-TXT)               28810000
288200         END-EXEC                                                 28820000
288300                                                                  28830000
288400         EVALUATE TRUE                                            28840000
288500                                                                  28850000
288600             WHEN SQLCODE = ZERO                                  28860000
288700                 CONTINUE                                         28870000
288800                                                                  28880000
288900             WHEN SQLWARN0 NOT EQUAL SPACE                        28890000
289000             WHEN SQLCODE NOT EQUAL ZERO                          28900000
289100                 DISPLAY '**************************************' 28910000
289200                 DISPLAY '** ABEND                            **' 28920000
289300                 DISPLAY '** PROGRAM = TRKUP235               **' 28930000
289400                 DISPLAY '** PARAGRAPH = 7500-INSERT-SCM-     **' 28940000
289500                 DISPLAY '**                  MESSAGE         **' 28950000
289600                 DISPLAY '** INSERT TRTW_ARRVL_CKPR           **' 28960000
289700                 DISPLAY '** TRT00037-RECORD = '                  28970000
289800                 DISPLAY '*'         TRT00037-CKPR-REC-1-TXT      28980000
289900                 DISPLAY '**************************************' 28990000
290000                 PERFORM 9100-SQL-ABEND                           29000000
290100         END-EVALUATE                                             29010000
290200     END-PERFORM.                                                 29020000
290300                                                                  29030000
290400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    29040000
290500         SQLCODE NOT = ZERO                                       29050000
290600         DISPLAY '****************************************'       29060000
290700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       29070000
290800         DISPLAY '** INSERT INTO TRTW_ARRVL_CKPR        **'       29080000
290900         DISPLAY '** PARAGRAPH = 7500-INSERT-SCM-MESSAGE**'       29090000
291000         DISPLAY '** TRT00037-RECORD = '                          29100000
291100         DISPLAY '*'           TRT00037-CKPR-REC-1-TXT            29110000
291200         DISPLAY '****************************************'       29120000
291300         PERFORM 9100-SQL-ABEND                                   29130000
291400     END-IF.                                                      29140000
291401                                                                  29140100
291402                                                                  29140200
291403 EJECT                                                            29140300
291404******************************************************************29140400
291405* SET THE CURRENT TIMESTAMP.                                     *29140500
291406******************************************************************29140600
291407 7999-SET-CURRENT-TMST.                                           29140700
291408                                                                  29140800
291409          EXEC SQL                                                29140900
291410              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            29141000
291411          END-EXEC                                                29141100
291412                                                                  29141200
291413         EVALUATE TRUE                                            29141300
291414             WHEN SQLCODE = ZERO                                  29141400
291415                 CONTINUE                                         29141500
291416                                                                  29141600
291417             WHEN SQLWARN0 NOT EQUAL SPACE                        29141700
291418             WHEN SQLCODE NOT EQUAL ZERO                          29141800
291419                 DISPLAY '**************************************' 29141900
291420                 DISPLAY '** ABEND                            **' 29142000
291421                 DISPLAY '** PROGRAM = TRKUP235               **' 29142100
291422                 DISPLAY '** PARAGRAPH = 7999-SET-CURRENT-TMST**' 29142200
291423                 DISPLAY '** SET CURRENT TIMESTAMP            **' 29142300
291424                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   29142400
291425                 DISPLAY '**************************************' 29142500
291426                 PERFORM 9100-SQL-ABEND                           29142600
291427         END-EVALUATE.                                            29142700
291428                                                                  29142800
291429 EJECT                                                            29142900
291430******************************************************************29143000
291431* TAKES A FINAL COMMIT, CLOSES THE INPUT FILE, AND DISPLAYS      *29143100
291432* MISCELLANEOUS JOB SUMMARY INFORMATION.                         *29143200
291433* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *29143300
291434* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *29143400
291435* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *29143500
291436* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*29143600
291437* NO RETURN CODE OR MESSAGE IS SENT.                             *29143700
291438******************************************************************29143800
291439 8000-EOJ-ROUTINE.                                                29143900
291440                                                                  29144000
291441     PERFORM 4300-COMMIT.                                         29144100
291442     DISPLAY 'COMMIT TAKEN AT '.                                  29144200
291443     DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)   29144300
291444      '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2).  29144400
291445                                                                  29144500
291446     CLOSE TR026-ARRIVAL-FILE.                                    29144600
291447                                                                  29144700
291448     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              29144800
291449     PERFORM 4200-UPDATE-TCKRSTCNTL.                              29144900
291450                                                                  29145000
291451     DISPLAY '**************************************'.            29145100
291452     DISPLAY '** TRKUP235 SUMMARY **'.                            29145200
291453     DISPLAY 'TOTAL ETA RECORDS      = ' PA-TOT-ETA-RECS-READ.    29145300
291454     DISPLAY 'TOTAL ADU RECORDS      = ' PA-TOT-ADU-RECS-READ.    29145400
291455     DISPLAY 'TOTAL ADURD RECORDS    = ' PA-TOT-ADURD-RECS-READ.  29145500
291456     DISPLAY 'TOTAL RECORDS READ     = ' PA-TOTAL-RECS-READ.      29145600
291457     DISPLAY '**************************************'.            29145700
291458*                                                                 29145800
291459     DISPLAY 'TOTAL ADD    TRANS     = ' PA-TOT-TRN-TYP-A.        29145900
291460     DISPLAY 'TOTAL CHANGE TRANS     = ' PA-TOT-TRN-TYP-C.        29146000
291461     DISPLAY 'TOTAL DELETE TRANS     = ' PA-TOT-TRN-TYP-D.        29146100
291462     DISPLAY '**************************************'.            29146200
291463*                                                                 29146300
291464     DISPLAY 'TOTAL CNTK UPDTE COUNT = ' PA-TOT-CNTK-UPDATES.     29146400
291465     DISPLAY 'TOTAL CNPO UPDTE COUNT = ' PA-TOT-CNPO-UPDATES.     29146500
291466     DISPLAY '**************************************'.            29146600
291467*                                                                 29146700
291468     DISPLAY 'TOTAL CNTK AUDIT COUNT = ' PA-TOT-ACNTK-INSERTS.    29146800
291469     DISPLAY 'TOTAL CNPO AUDIT COUNT = ' PA-TOT-ACNPO-INSERTS.    29146900
291470     DISPLAY '**************************************'.            29147000
291471*                                                                 29147100
291472     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS.        29147200
291473*                                                                 29147300
291474     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.    29147400
291475     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.   29147500
291476     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED.    29147600
291477     DISPLAY 'TOTAL RULE RECORDS     = ' PA-TOTAL-RULE-COUNT.     29147700
291478     DISPLAY '**************************************'.            29147800
291479                                                                  29147900
291480 EJECT                                                            29148000
291481******************************************************************29148100
291482* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *29148200
291483* ERROR OR WARNING CODE OCCURS.                                  *29148300
291484******************************************************************29148400
291485 9100-SQL-ABEND.                                                  29148500
291486******************************************************************29148600
291487* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *29148700
291488* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *29148800
291489* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *29148900
291490* FORMAT.                                                        *29149000
291491******************************************************************29149100
291492                                                                  29149200
291493     COPY DPPD004.                                                29149300
291494                                                                  29149400
291495     DISPLAY 'CONTNR ABEND     '  TR026-ETA-CONTNR-ID.            29149500
291496     DISPLAY 'CONTAINER SEQUENCE NBR  '                           29149600
291497                                TR026-ETA-SEQ-NBR.                29149700
291498     MOVE +4013 TO ABEND-CODE.                                    29149800
291499     CALL 'ILBOABN0' USING ABEND-CODE.                            29149900
