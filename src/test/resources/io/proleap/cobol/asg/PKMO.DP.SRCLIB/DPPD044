00001 ******************************************************************10/06/93
00002 *  INCLUDE MEMBER DPPD044.                                       *DPPD044 
00003 *                                                                *   LV001
00004 *  THIS INCLUDE CONTAINS THE PROCEDURE DIVISION STATEMENTS THAT  *DPPD044 
00005 *  ARE REQUIRED TO CALL THE CICS OBJECT LOCKING MODULE DPKCS044. *DPPD044 
00006 *                                                                *DPPD044 
00007 *  THIS PROCEDURE DIVISION INCLUDE CAN ONLY BE USED BY           *DPPD044 
00008 *  ARCHITECTURE PROGRAMS.  NON-ARCHITECTURE PROGRAMS CAN LINK    *DPPD044 
00009 *  TO MODULE DPKCS044, BUT YOU MUST CODE YOUR OWN PROCEDURE      *DPPD044 
00010 *  DIVISION STATEMENTS IN THIS CASE.                             *DPPD044 
00011 *                                                                *DPPD044 
00012 *  INCLUDE DPWS044 CONTAINS THE WORKING STORAGE FIELDS WHICH     *DPPD044 
00013 *  SHOULD BE USED TO COMMUNICATE WITH THE MODULE DPKCS044.       *DPPD044 
00014 *                                                                *DPPD044 
00015 ******************************************************************DPPD044 
00016 *                                                                *DPPD044 
00017 *  BEFORE EXECUTING THIS INCLUDE, YOU SHOULD DO THE FOLLOWING:   *DPPD044 
00018 *   -- SET DP044-ACTION REQUESTED TO THE DESIRED ACTION.         *DPPD044 
00019 *   -- IF ACTION REQUESTED IS 'LOCK-OBJECT' OR 'UNLOCK-OBJECT':  *DPPD044 
00020 *      -- MOVE THE KEY OF YOUR OBJECT TO DP044-OBJECT-KEY.       *DPPD044 
00021 *      -- SET DP044-OBJECT-TYPE TO THE CORRECT OBJECT TYPE.      *DPPD044 
00022 *                                                                *DPPD044 
00023 *  AFTER RETURNING, CHECK DP044-RETURN-CODE.                     *DPPD044 
00024 *                                                                *DPPD044 
00025 ******************************************************************DPPD044 
00026  EJECT                                                            DPPD044 
00027                                                                   DPPD044 
00028  DP044-0000-LINK-TO-OBJ-LOCK.                                     DPPD044 
00029                                                                   DPPD044 
00030      MOVE DP020-SRC-TASK-NUMBER    TO DP044-TASK-NUMBER.          DPPD044 
00031      MOVE DP020-NETNAME            TO DP044-NETNAME.              DPPD044 
00032      MOVE DP020-USERID             TO DP044-USERID.               DPPD044 
00033      MOVE DP020-SRC-MNEMONIC       TO DP044-MNEMONIC.             DPPD044 
00034                                                                   DPPD044 
00035      EXEC CICS                                                    DPPD044 
00036           LINK                                                    DPPD044 
00037                PROGRAM  ('DPKCS044')                              DPPD044 
00038                COMMAREA (DP044-OBJECT-LOCK-FIELDS)                DPPD044 
00039      END-EXEC.                                                    DPPD044 
00040                                                                   DPPD044 
00041      IF  DP044-RC-CALL-SUCCESSFUL                                 DPPD044 
00042          IF  DP044-ACTION-LOCK-OBJECT                             DPPD044 
00043              SET DP020-SRC-LOCK-HELD TO TRUE                      DPPD044 
00044          ELSE                                                     DPPD044 
00045              IF DP044-ACTION-UNLOCK-TASK                          DPPD044 
00046                  SET DP020-SRC-NO-LOCK-HELD TO TRUE               DPPD044 
00047              END-IF                                               DPPD044 
00048          END-IF                                                   DPPD044 
00049      END-IF.                                                      DPPD044 
00050                                                                   DPPD044 
00051                                                                   DPPD044 
