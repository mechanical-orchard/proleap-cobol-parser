000100 IDENTIFICATION DIVISION.                                         00010062
000200 PROGRAM-ID.             PCKUT713.                                00020062
000300 AUTHOR.                 DENISE HAHN.                             00030062
000400 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00040062
000500 DATE-WRITTEN            MAY, 2001.                               00050062
000600 DATE-COMPILED.                                                   00060062
000700******************************************************************00070062
000800* THIS PROGRAM WILL BE USED TO DETERMINE THE CURRENT STATUS       00080062
000900* OF A GIVEN CARTON (EX - LOADED ON A TRAILER)                    00090062
001000******************************************************************00100062
001100* 02/08/19 MADE BY: JIM HUNTER              CHG0217830            00110062
001200*  MAINFRAME REFACTORING - DB2 LUW HANDLES CALLS WITH CHAR        00120062
001300*  FORMATTING OF DECIMAL FIELDS DIFFERENTLY THAN THE MAINFRAME    00130062
001400*  VERSION OF DB2.   REPLACING THE CHAR FORMATTING WITH DIGITS.   00140062
001500*  CHAR RETURNS A LEADING SPACE AND TRAILING DECIMAL POINT        00150062
001600*  AND DIGITS DOESN'T.                                            00160062
001700*  SEE PARAGRAPHS 1000-CHECK-IF-ACTIVE AND 1050-ORIG-CART-ID.     00170062
001800******************************************************************00180062
001900 ENVIRONMENT DIVISION.                                            00190062
002000 DATA DIVISION.                                                   00200062
002100 WORKING-STORAGE SECTION.                                         00210062
002200*    COPY PCWS713.                                                00220062
002300 01  DK-DB2-KEYS.                                                 00230062
002400     05  DK-CARTON-ID             PIC S9(18)V COMP-3.             00240062
002500     05  DK-OPER-UNT-ID           PIC S9(04)  COMP.               00250062
002600     05  DK-DOOR-ID               PIC  X(04).                     00260062
002700     05  DK-OTBND-TRIP-ID         PIC S9(09)  COMP.               00270062
002800     05  DK-CARTON-TMST           PIC  X(26).                     00280062
002900     05  DK-PO-TRN-NBR            PIC Z(09).                      00290062
003000     05  DK-TRN-NBR-9.                                            00300062
003100         10  FILLER               PIC X(01) VALUE SPACES.         00310062
003200         10  DK-TRN-NBR-8         PIC X(08) VALUE SPACES.         00320062
003300                                                                  00330062
003400     05  DK-PO-RCVR-NBR-N         PIC 9(09) VALUE ZEROES.         00340062
003500     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00350062
003600         10  DK-RCVR-NBR-X        PIC X(09).                      00360062
003700     05  DK-RCVR-NBR-9.                                           00370062
003800         10  FILLER               PIC X(06) VALUE SPACES.         00380062
003900         10  DK-RCVR-NBR-3        PIC X(03) VALUE SPACES.         00390062
004000                                                                  00400062
004100                                                                  00410062
004200*----------------------------------------------------------------*00420062
004300* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00430062
004400*----------------------------------------------------------------*00440062
004500     COPY PCWS046.                                                00450062
004600                                                                  00460062
004700*----------------------------------------------------------------*00470062
004800*  PROGRAM CONSTANTS                                             *00480062
004900*----------------------------------------------------------------*00490062
005000 01  PC-PROGRAM-CONSTANTS.                                        00500062
005100     05  PC-BEGIN                 PIC  X(01)  VALUE 'S'.          00510062
005200     05  PC-END                   PIC  X(01)  VALUE 'E'.          00520062
005300     05  PC-DEFAULT-DATE          PIC X(26)   VALUE               00530062
005400                                  '9999-09-09-09.09.09.999999'.   00540062
005500     05  PC-LOW-DATE              PIC X(26)   VALUE               00550062
005600                                  '0001-01-01-01.01.01.000000'.   00560062
005700                                                                  00570062
005800*----------------------------------------------------------------*00580062
005900*  PROGRAM SWITCHES                                              *00590062
006000*----------------------------------------------------------------*00600062
006100 01  PS-PROGRAM-SWITCHES.                                         00610062
006200     05  PS-TRIP-FOUND-SW                PIC  X(01)  VALUE 'N'.   00620062
006300         88  PS-TRIP-FOUND                           VALUE 'Y'.   00630062
006400         88  PS-TRIP-NOT-FOUND                       VALUE 'N'.   00640062
006500     05  PS-EOF-TRIP-CSR-SW              PIC  X(01)  VALUE 'N'.   00650062
006600         88  PS-EOF-TRIP-CSR                         VALUE 'Y'.   00660062
006700         88  PS-NOT-EOF-TRIP-CSR                     VALUE 'N'.   00670062
006800     05  PS-EOF-BEG-END-CSR-SW           PIC  X(01)  VALUE 'N'.   00680062
006900         88  PS-EOF-BEG-END-CSR                      VALUE 'Y'.   00690062
007000         88  PS-NOT-EOF-BEG-END-CSR                  VALUE 'N'.   00700062
007100     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   00710062
007200         88  PS-ERROR                                VALUE 'Y'.   00720062
007300         88  PS-NO-ERROR                             VALUE 'N'.   00730062
007400     05  PS-CARTON-RANGE-FOUND-SW        PIC  X(01)  VALUE 'N'.   00740062
007500         88  PS-CARTON-RANGE-FOUND                   VALUE 'Y'.   00750062
007600         88  PS-CARTON-RANGE-NOT-FOUND               VALUE 'N'.   00760062
007700     05  PS-FOUND-ON-OTBNDCART-SW        PIC  X(01)  VALUE 'N'.   00770062
007800         88  PS-FOUND-ON-OTBNDCART                   VALUE 'Y'.   00780062
007900         88  PS-NOT-FOUND-ON-OTBNDCART               VALUE 'N'.   00790062
008000     05  PS-FOUND-ON-TSULBXF-SW          PIC  X(01)  VALUE 'N'.   00800062
008100         88  PS-FOUND-ON-TSULBXF                     VALUE 'Y'.   00810062
008200         88  PS-NOT-FOUND-ON-TSULBXF                 VALUE 'N'.   00820062
008300     05  PS-INACTIVE-CRTN-FND-SW         PIC  X(01)  VALUE 'N'.   00830062
008400         88  PS-INACTIVE-CRTN-FND                    VALUE 'Y'.   00840062
008500         88  PS-INACTIVE-NOT-CRTN-FND                VALUE 'N'.   00850062
008600                                                                  00860062
008700*----------------------------------------------------------------*00870062
008800*  PROGRAM VARIABLES                                             *00880062
008900*----------------------------------------------------------------*00890062
009000 01  PV-PROGRAM-VARIABLES.                                        00900062
009100                                                                  00910062
009200     05  PV-LINE-SHPD-UNITS              PIC S9(9)V COMP-3.       00920062
009300     05  PV-CICS-MSG-AREA2               PIC  X(133) VALUE SPACE. 00930062
009400     05  PV-DISPLAY-CARTON-ID            PIC  9(18).              00940062
009500     05  PV-DISPLAY-OPER-UNT             PIC  9(04).              00950062
009600     05  PV-DISPLAY-DIVERT-NBR           PIC  9(09).              00960062
009700     05  PV-DISPLAY-DIVERT-LOC           PIC  X(04).              00970062
009800     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 00980062
009900     05  DK-DISPLAY-TRIP                 PIC  9(09) VALUE ZEROES. 00990062
010000     05  PV-SQL-RETURN-CD                PIC  999-.               01000062
010010     05  PV-NULL-IND                     PIC S9(04) VALUE +0      01001063
010020                                                 COMP.            01002063
010100                                                                  01010062
010200     05  PV-SHIPT-UNT-SRC-ID             PIC  X(03)  VALUE SPACE. 01020062
010300         88  PV-SRC-ASN                              VALUE 'ASN'. 01030062
010400         88  PV-SRC-CHECK-IN                         VALUE 'CKN'. 01040062
010500         88  PV-SRC-CSEPK-SPLT                       VALUE 'CPS'. 01050062
010600         88  PV-SRC-P2L                              VALUE 'P2L'. 01060062
010700         88  PV-SRC-MANUAL                           VALUE 'MAN'. 01070062
010800         88  PV-SRC-RECEIVING                        VALUE 'RCV'. 01080062
010900         88  PV-SRC-RDM                              VALUE 'RDM'. 01090062
011000         88  PV-SRC-SMOOTHING                        VALUE 'SMO'. 01100062
011100         88  PV-SRC-FAST-XFER                        VALUE 'FXR'. 01110062
011200         88  PV-SRC-MSTR-CNTR                        VALUE 'MST'. 01120062
011300         88  PV-SRC-CRTN-BULD                        VALUE 'MSC'. 01130062
011400         88  PV-SRC-JWL                              VALUE 'JWL'. 01140062
011500         88  PV-SRC-DMG                              VALUE 'DMG'. 01150062
011510         88  PV-SRC-3WD                              VALUE '3WD'. 01151062
011520         88  PV-SRC-UNKNOWN                          VALUE '   '. 01152062
011530                                                                  01153062
011540     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         01154062
011550                                                     VALUE ZERO.  01155062
011560     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  01156062
011570                                                     COMP SYNC.   01157062
011580                                                                  01158062
011590     05  PV-BEG-END-DVRT-TMST            PIC  X(26)  VALUE SPACES.01159062
011600     05  PV-BEGIN-SCAN-TMST              PIC  X(26)  VALUE SPACES.01160062
011700     05  PV-BEGIN-DVRT-TMST              PIC  X(26)  VALUE SPACES.01170062
011800     05  PV-BEGIN-SHIPT-UNT-ID           PIC S9(18)  VALUE ZEROES.01180062
011900     05  PV-END-SCAN-TMST                PIC  X(26)  VALUE SPACES.01190062
012000     05  PV-END-DVRT-TMST                PIC  X(26)  VALUE SPACES.01200062
012100     05  PV-END-SHIPT-UNT-ID             PIC S9(18)  VALUE ZEROES.01210062
012200                                                                  01220062
012300 01  PV-TRACE.                                                    01230062
012400     05  FILLER                          PIC X(03) VALUE ' T='.   01240062
012500     05  PV-EIBTASKN                     PIC Z(06)9.              01250062
012600     05  PV-PARA                         PIC X(70).               01260062
012700                                                                  01270062
012800                                                                  01280062
012900*    SUT_OTBND_CART                                               01290062
013000     EXEC SQL                                                     01300062
013100          INCLUDE SUT00024                                        01310062
013200     END-EXEC.                                                    01320062
013300                                                                  01330062
013400*  SUT_OTBND_VND                                                  01340062
013500                                                                  01350062
013600     EXEC SQL                                                     01360062
013700          INCLUDE SUT00026                                        01370062
013800     END-EXEC.                                                    01380062
013900                                                                  01390062
014000*  SUT_OTBND_LOC                                                  01400062
014100     EXEC SQL                                                     01410062
014200          INCLUDE SUT00027                                        01420062
014300     END-EXEC.                                                    01430062
014400                                                                  01440062
014500*  SUT_OTBND_UPC                                                  01450062
014600     EXEC SQL                                                     01460062
014700          INCLUDE SUT00028                                        01470062
014800     END-EXEC.                                                    01480062
014900                                                                  01490062
015000*  INBOUND SHIPPING UNIT TABLE                                    01500062
015100     EXEC SQL                                                     01510062
015200          INCLUDE TSHPUNT                                         01520062
015300     END-EXEC.                                                    01530062
015400                                                                  01540062
015500*  INBOUND SHIPPING UNIT LOCATION                                 01550062
015600     EXEC SQL                                                     01560062
015700          INCLUDE TSHUNLO                                         01570062
015800     END-EXEC.                                                    01580062
015900                                                                  01590062
016000*  SHIPPING UNIT CARTON DIVERT TABLE                              01600062
016100     EXEC SQL                                                     01610062
016200          INCLUDE TSUCRDV                                         01620062
016300     END-EXEC.                                                    01630062
016400                                                                  01640062
016500                                                                  01650062
016600*  OUTBOUND TRIP STATUS TABLE                                     01660062
016700     EXEC SQL                                                     01670062
016800          INCLUDE TSUOBTS                                         01680062
016900     END-EXEC.                                                    01690062
017000                                                                  01700062
017100*  OUTBOUND TRIP CARTON DIVERT ASSOCIATION TABLE                  01710062
017200     EXEC SQL                                                     01720062
017300          INCLUDE TSUCDOT                                         01730062
017400     END-EXEC.                                                    01740062
017500                                                                  01750062
017600*  LABEL CROSS REFERENCE                                          01760062
017700     EXEC SQL                                                     01770062
017800          INCLUDE TSULBXF                                         01780062
017900     END-EXEC.                                                    01790062
018000                                                                  01800062
018100*  SHIPT UNIT UPC REFERENCE                                       01810062
018200     EXEC SQL                                                     01820062
018300          INCLUDE TSHUUPC                                         01830062
018400     END-EXEC.                                                    01840062
018500                                                                  01850062
018600*  PACK SLIP  REFERENCE                                           01860062
018700     EXEC SQL                                                     01870062
018800          INCLUDE TINPKSU                                         01880062
018900     END-EXEC.                                                    01890062
019000                                                                  01900062
019100******************************************************************01910062
019200*  DB2 TABLE FOR OUTBOUND TRAILER TRIP TABLE                      01920062
019300******************************************************************01930062
019400     EXEC SQL                                                     01940062
019500          INCLUDE TSUOBTR                                         01950062
019600     END-EXEC.                                                    01960062
019700                                                                  01970062
019800******************************************************************01980062
019900*  DB2 TABLE FOR TRAILER ID TABLE                                 01990062
020000******************************************************************02000062
020100     EXEC SQL                                                     02010062
020200          INCLUDE TCNTRID                                         02020062
020300     END-EXEC.                                                    02030062
020400                                                                  02040062
020500******************************************************************02050062
020600*  DB2 TABLE FOR PACK SLIPS                                       02060062
020700******************************************************************02070062
020800     EXEC SQL                                                     02080062
020900          INCLUDE TPKSLIP                                         02090062
021000     END-EXEC.                                                    02100062
021100                                                                  02110062
021200*----------------------------------------------------------------*02120062
021300*  COMMUNICATIONS AREA FOR DB2                                   *02130062
021400*----------------------------------------------------------------*02140062
021500     EXEC SQL                                                     02150062
021600         INCLUDE SQLCA                                            02160062
021700     END-EXEC.                                                    02170062
021800                                                                  02180062
021900******************************************************************02190062
022000*  OUTBOUND TRIP BY DOOR CURSOR                                   02200062
022100******************************************************************02210062
022200     EXEC SQL                                                     02220062
022300         DECLARE  OTBND_TRIP_CSR CURSOR FOR                       02230062
022400          SELECT  OTBND_TRIP_ID                                   02240062
022500                , OTBND_STAT_TMST                                 02250062
022600                , TRIP_STAT_CDE                                   02260062
022700                , STAT_OPER_UNT_ID                                02270062
022800            FROM  TSUOBTS A                                       02280062
022900           WHERE  A.STAT_OPER_UNT_ID  =  :DK-OPER-UNT-ID          02290062
023000             AND  A.DOOR_ID           =  :DK-DOOR-ID              02300062
023100             AND  A.TRIP_STAT_CDE     =  'DO'                     02310062
023200             AND  NOT EXISTS                                      02320062
023300               (SELECT OTBND_TRIP_ID                              02330062
023400                  FROM TSUOBTS B                                  02340062
023500                 WHERE  A.OTBND_TRIP_ID   =  B.OTBND_TRIP_ID      02350062
023600                   AND  B.TRIP_STAT_CDE   =  'DC'                 02360062
023700                   AND  B.DOOR_ID         =  A.DOOR_ID            02370062
023800                   AND  B.OTBND_STAT_TMST >  A.OTBND_STAT_TMST    02380062
023900                   AND  B.OTBND_STAT_TMST <  :SUCRDV-DIVERT-TMST) 02390062
024000            ORDER  BY OTBND_STAT_TMST DESC                        02400062
024100     END-EXEC.                                                    02410062
024200                                                                  02420062
024300******************************************************************02430062
024400*  OUTBOUND TRIP DIVERT BEGINNING & ENDING CURSOR                 02440062
024500******************************************************************02450062
024600*LMM EXEC SQL                                                     02460062
024700*        DECLARE  TRIP_BEG_END_CSR CURSOR FOR                     02470062
024800*         SELECT  SHIPT_UNT_ID                                    02480062
024900*               , SCN_TMST                                        02490062
025000*               , SCN_TYP_CDE                                     02500062
025100*               , SCN_USR_ID                                      02510062
025200*           FROM  TSUCDOT                                         02520062
025300*          WHERE  OTBND_TRIP_ID  =  :DK-OTBND-TRIP-ID             02530062
025400*          ORDER  BY SCN_TMST                                     02540062
025500*    END-EXEC.                                                    02550062
025600                                                                  02560062
025700 LINKAGE SECTION.                                                 02570062
025800 01  LINK-PARMS                         PIC X(600).               02580062
025900/                                                                 02590062
026000 PROCEDURE DIVISION USING LINK-PARMS.                             02600062
026100*    COPY PCPD713.                                                02610062
026200 0000-PROGRAM-MAINLINE.                                           02620062
026300                                                                  02630062
026400     SET PS-TRIP-NOT-FOUND                                        02640062
026500         PS-NOT-EOF-TRIP-CSR                                      02650062
026600         PS-NOT-EOF-BEG-END-CSR                                   02660062
026700         PS-NO-ERROR                                              02670062
026800         PS-CARTON-RANGE-NOT-FOUND                                02680062
026900         PS-NOT-FOUND-ON-OTBNDCART                                02690062
027000         PS-NOT-FOUND-ON-TSULBXF                                  02700062
027100         PS-INACTIVE-NOT-CRTN-FND TO TRUE.                        02710062
027200     INITIALIZE                        PC046-COMMAREA-REC         02720062
027300                                       DK-CARTON-ID               02730062
027400                                       DK-OPER-UNT-ID             02740062
027500                                       DK-DOOR-ID                 02750062
027600                                       DK-OTBND-TRIP-ID           02760062
027700                                       DK-CARTON-TMST             02770062
027800                                       DK-PO-TRN-NBR              02780062
027900                                       DK-TRN-NBR-9               02790062
028000                                       DK-PO-RCVR-NBR-N           02800062
028100                                       DK-RCVR-NBR-9              02810062
028200                                       PV-LINE-SHPD-UNITS         02820062
028300                                       PV-CICS-MSG-AREA2          02830062
028400                                       PV-DISPLAY-CARTON-ID       02840062
028500                                       PV-DISPLAY-OPER-UNT        02850062
028600                                       PV-DISPLAY-DIVERT-NBR      02860062
028700                                       PV-DISPLAY-DIVERT-LOC      02870062
028800                                       PV-DISPLAY-SQLCODE         02880062
028900                                       DK-DISPLAY-TRIP            02890062
029000                                       PV-SQL-RETURN-CD           02900062
029100                                       PV-SHIPT-UNT-SRC-ID        02910062
029200                                       PV-COMMAREA-LENGTH         02920062
029300                                       PV-CICS-RESP               02930062
029400                                       PV-BEG-END-DVRT-TMST       02940062
029500                                       PV-BEGIN-SCAN-TMST         02950062
029600                                       PV-BEGIN-DVRT-TMST         02960062
029700                                       PV-BEGIN-SHIPT-UNT-ID      02970062
029800                                       PV-END-SCAN-TMST           02980062
029900                                       PV-END-DVRT-TMST           02990062
030000                                       PV-END-SHIPT-UNT-ID.       03000062
030100     MOVE LINK-PARMS               TO  PC046-COMMAREA-REC.        03010062
030200                                                                  03020062
030300     MOVE  PC046-CARTON-ID         TO  DK-CARTON-ID               03030062
030400                                       PV-DISPLAY-CARTON-ID       03040062
030500     MOVE  SPACES                  TO  PC046-CRTN-STATUS.         03050062
030600                                                                  03060062
030700     PERFORM 1000-CHECK-IF-ACTIVE.                                03070062
030800                                                                  03080062
030900     IF PS-NO-ERROR                                               03090062
031000         IF  PC046-CRTN-STATUS = SPACES                           03100062
031100             PERFORM 1100-CHECK-SCAN-OFF                          03110062
031200         END-IF                                                   03120062
031300     END-IF                                                       03130062
031400                                                                  03140062
031500     IF PS-NO-ERROR                                               03150062
031600         IF PC046-CRTN-STATUS = SPACES OR                         03160062
031700             PC046-SCANNED-OFF-TRLR                               03170062
031800             PERFORM 1200-CHECK-MANUAL-SCAN-ON                    03180062
031900         END-IF                                                   03190062
032000     END-IF.                                                      03200062
032100                                                                  03210062
032200     IF PS-NO-ERROR                                               03220062
032300         IF PS-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF         03230062
032400             CONTINUE                                             03240062
032500*            MOVE DK-CARTON-ID-18 TO DK-CARTON-ID                 03250062
032600         ELSE                                                     03260062
032700             IF PS-NOT-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF 03270062
032800             CONTINUE                                             03280062
032900*                MOVE DK-CARTON-ID-18 TO DK-CARTON-ID             03290062
033000             ELSE                                                 03300062
033100                 MOVE PC046-CARTON-ID TO DK-CARTON-ID             03310062
033200             END-IF                                               03320062
033300         END-IF                                                   03330062
033400     END-IF                                                       03340062
033500                                                                  03350062
033600     IF PS-NO-ERROR                                               03360062
033700         IF PC046-CRTN-STATUS = SPACES OR                         03370062
033800             PC046-SCANNED-ONTO-TRLR OR                           03380062
033900             PC046-SCANNED-OFF-TRLR OR                            03390062
034000             PC046-INVALID-CRTN OR                                03400062
034100             PS-INACTIVE-CRTN-FND                                 03410062
034200             PERFORM 1300-CHECK-DIVERTED                          03420062
034300         END-IF                                                   03430062
034400     END-IF.                                                      03440062
034500                                                                  03450062
034600     IF PS-NO-ERROR                                               03460062
034700         IF PC046-DIVERTED-TO-TRLR                                03470062
034800             PERFORM 2000-LOAD-ONTO-TRAILER                       03480062
034900         END-IF                                                   03490062
035000     END-IF                                                       03500062
035100                                                                  03510062
035200     IF PS-NO-ERROR                                               03520062
035300         IF PS-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF         03530062
035400             MOVE PC046-VENDOR-SHIPT-UNT-ID TO DK-CARTON-ID       03540062
035500         ELSE                                                     03550062
035600             IF PS-NOT-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF 03560062
035700                 MOVE PC046-VENDOR-SHIPT-UNT-ID TO DK-CARTON-ID   03570062
035800             ELSE                                                 03580062
035900                 MOVE PC046-CARTON-ID TO DK-CARTON-ID             03590062
036000             END-IF                                               03600062
036100         END-IF                                                   03610062
036200     END-IF                                                       03620062
036300                                                                  03630062
036400     IF PS-NO-ERROR                                               03640062
036500         IF PC046-CRTN-STATUS = SPACES                            03650062
036600             PERFORM 3000-CHECK-PROCESS-AREA                      03660062
036700         END-IF                                                   03670062
036800     END-IF                                                       03680062
036900                                                                  03690062
037000     IF PS-NO-ERROR                                               03700062
037100         IF PC046-OTBD-TRIP-ID > SPACES AND                       03710062
037200             PC046-OTBD-TRIP-ID > ZEROES                          03720062
037300             PERFORM 3500-GET-TRIP-INFO                           03730062
037400         END-IF                                                   03740062
037500     END-IF                                                       03750062
037600                                                                  03760062
037700     IF PS-NO-ERROR                                               03770062
037800         IF PC046-SHPUNT-SRC-ID NOT = 'MST'                       03780062
037900             IF PC046-CALC-UNITS                                  03790062
038000                 PERFORM 4000-DETERMIN-NBR-UNITS                  03800062
038100             END-IF                                               03810062
038200             PERFORM 5000-DETERMIN-PO-RCVR                        03820062
038300         END-IF                                                   03830062
038400     END-IF                                                       03840062
038500                                                                  03850062
038600                                                                  03860062
038700     IF PS-NO-ERROR                                               03870062
038800         IF PC046-SHPUNT-SRC-ID = 'ASN' AND                       03880062
038900            SULBXF-CART-LBL-TYP-CDE = 'P'                         03890062
039000             PERFORM 4100-DETERMIN-NBR-UNITS-P2L                  03900062
039100             PERFORM 5100-DETERMIN-PO-RCVR-P2L                    03910062
039200         END-IF                                                   03920062
039300     END-IF                                                       03930062
039400                                                                  03940062
039500     IF PS-NO-ERROR                                               03950062
039600         IF PS-INACTIVE-CRTN-FND                                  03960062
039700            SET PC046-INACTIVATED TO TRUE                         03970062
039800         END-IF                                                   03980062
039900     END-IF                                                       03990062
040000                                                                  04000062
040100     MOVE SQLCA                         TO PC046-SQLCA            04010062
040200     MOVE PC046-COMMAREA-REC TO    LINK-PARMS                     04020062
040300                                                                  04030062
040400     GOBACK.                                                      04040062
040500                                                                  04050062
040600                                                                  04060062
040700*-----------------------------------------------------------------04070062
040800*CHECK TO SEE IF THE CARTON IS INACTIVATED.                       04080062
040900*-----------------------------------------------------------------04090062
041000 1000-CHECK-IF-ACTIVE.                                            04100062
041100     MOVE ' 1000-CHECK-IF-ACTIVE' TO PV-PARA.                     04110062
041200                                                                  04120062
041300     EXEC SQL                                                     04130062
041400          SELECT                                                  04140062
041500             TIMESTAMP                                            04150062
041600             (                                                    04160062
041700             CHAR(CRE_DTE) || '-' || CHAR(CRE_TM) || '.000000'    04170062
041800             )                                                    04180062
041900                 ,ACTV_IND                                        04190062
042000                 ,CART_SRC_CDE                                    04200062
042100                 ,DEST_LOC_NBR                                    04210062
042200                 ,ORIG_CART_ID                                    04220062
042300             ,    '00' || DIGITS(SHIPT_UNT_ID)                    04230062
042400            INTO                                                  04240062
042500                 :PC046-CRTN-STAT-TMST                            04250062
042600             ,   :SUT00024-ACTV-IND                               04260062
042700             ,   :PV-SHIPT-UNT-SRC-ID                             04270062
042800             ,   :SUT00024-DEST-LOC-NBR                           04280062
042900             ,   :SUT00024-ORIG-CART-ID                           04290062
043000             ,   :PC046-KOHLS-BARCODE                             04300062
043100            FROM  SUT_OTBND_CART                                  04310062
043200           WHERE  SHIPT_UNT_ID    = :DK-CARTON-ID                 04320062
043300     END-EXEC.                                                    04330062
043400                                                                  04340062
043500     EVALUATE TRUE                                                04350062
043600         WHEN SQLCODE = ZERO                                      04360062
043700              IF  SUT00024-ACTV-IND = 'N'                         04370062
043800                  SET PC046-INACTIVATED                           04380062
043900                      PS-INACTIVE-CRTN-FND  TO TRUE               04390062
044000                  PERFORM 1250-SELECT-CARTLOC                     04400062
044100              END-IF                                              04410062
044200                                                                  04420062
044300              MOVE DK-CARTON-ID      TO PC046-VENDOR-SHIPT-UNT-ID 04430062
044400                                        PC046-KOHLS-BARCODE       04440062
044500              MOVE SUT00024-DEST-LOC-NBR                          04450062
044600                                        TO PC046-DEST-OPER-UNT-ID 04460062
044700              MOVE PV-SHIPT-UNT-SRC-ID  TO PC046-SHPUNT-SRC-ID    04470062
044800*DMH 10/17/02 BEGIN                                               04480062
044900              IF  PC046-SRC-ASN                                   04490062
045000                  MOVE 'CKN'         TO PV-SHIPT-UNT-SRC-ID       04500062
045100                                        PC046-SHPUNT-SRC-ID       04510062
045200              END-IF                                              04520062
045300*DMH 10/17/02 END                                                 04530062
045400              SET PS-FOUND-ON-OTBNDCART TO TRUE                   04540062
045500         WHEN SQLCODE = +100                                      04550062
045600              PERFORM 1050-ORIG-CART-ID                           04560062
045700                                                                  04570062
045800         WHEN SQLWARN0 NOT = SPACES                               04580062
045900         WHEN SQLCODE NOT EQUAL ZERO                              04590062
046000             SET PS-ERROR                                         04600062
046100                 PC046-INVALID-SQL    TO TRUE                     04610062
046200             MOVE  DK-CARTON-ID       TO  PV-DISPLAY-CARTON-ID    04620062
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      04630062
046400                                          PV-SQL-RETURN-CD        04640062
046500              STRING  ' PCKUT713-1000-'                           04650062
046600                      PV-DISPLAY-CARTON-ID                        04660062
046700                      '  CALLED BY-'                              04670062
046800                      PC046-CALLING-PGM-NME                       04680062
046900                      '  SQLCODE='                                04690062
047000                      PV-DISPLAY-SQLCODE                          04700062
047100                      ' TASK= ' PV-EIBTASKN                       04710062
047200                      DELIMITED BY SIZE                           04720062
047300                                      INTO PC046-CRA-RET-MSG      04730062
047400             MOVE '1000-'                TO PC046-CRA-REQ-ID      04740062
047500             PERFORM 9998-RETURN                                  04750062
047600     END-EVALUATE.                                                04760062
047700                                                                  04770062
047800*----------------------------------------------------------------*04780062
047900*  CHECK THE SHIPPING UNIT CROSS REFERENCE TABLE TO CHECK IF THE  04790062
048000*  CARTON ID/BARCODE ENTERED IS THERE                             04800062
048100*----------------------------------------------------------------*04810062
048200 1050-ORIG-CART-ID.                                               04820062
048300     MOVE ' 1050-ORIG-CART-ID' TO PV-PARA                         04830062
048400                                                                  04840062
048500     EXEC SQL                                                     04850062
048600          SELECT                                                  04860062
048700              SHIPT_UNT_ID                                        04870062
048800         ,    '00' || DIGITS(SHIPT_UNT_ID)                        04880062
048900                                                                  04890062
049000         ,   TIMESTAMP                                            04900062
049100             (                                                    04910062
049200             CHAR(CRE_DTE) || '-' || CHAR(CRE_TM) || '.000000'    04920062
049300             )                                                    04930062
049400                                                                  04940062
049500         ,     ACTV_IND                                           04950062
049600         ,     CART_SRC_CDE                                       04960062
049700         ,     DEST_LOC_NBR                                       04970062
049800         ,     ORIG_CART_ID                                       04980062
049900         ,     CART_TYP_CDE                                       04990062
050000            INTO                                                  05000062
050100               :SUT00024-SHIPT-UNT-ID                             05010062
050200         ,     :PC046-KOHLS-BARCODE                               05020062
050300         ,     :PC046-CRTN-STAT-TMST                              05030062
050400         ,     :SUT00024-ACTV-IND                                 05040062
050500         ,     :PV-SHIPT-UNT-SRC-ID                               05050062
050600         ,     :SUT00024-DEST-LOC-NBR                             05060062
050700         ,     :SUT00024-ORIG-CART-ID                             05070062
050800         ,     :SUT00024-CART-TYP-CDE                             05080062
050900            FROM                                                  05090062
051000               SUT_OTBND_CART                                     05100062
051100         WHERE                                                    05110062
051200            ORIG_CART_ID     = :DK-CARTON-ID                      05120062
051300     END-EXEC.                                                    05130062
051400                                                                  05140062
051500     EVALUATE TRUE                                                05150062
051600         WHEN SQLCODE = ZERO                                      05160062
051700              IF  SUT00024-ACTV-IND  =  'N'                       05170062
051800                  SET PC046-INACTIVATED                           05180062
051900                      PS-INACTIVE-CRTN-FND  TO TRUE               05190062
052000                  PERFORM 1250-SELECT-CARTLOC                     05200062
052100              END-IF                                              05210062
052200                                                                  05220062
052300              MOVE SUT00024-SHIPT-UNT-ID  TO                      05230062
052400                                        PC046-VENDOR-SHIPT-UNT-ID 05240062
052500                                        PC046-KOHLS-BARCODE       05250062
052600                                        DK-CARTON-ID              05260062
052700              MOVE SUT00024-DEST-LOC-NBR   TO                     05270062
052800                                         PC046-DEST-OPER-UNT-ID   05280062
052900              SET PS-FOUND-ON-TSULBXF TO TRUE                     05290062
053000              PERFORM 1075-CHECK-OTBNDCART                        05300062
053100                                                                  05310062
053200         WHEN SQLCODE = -811                                      05320062
053300* DMH - 6/03/03 BEGIN                                             05330062
053400              IF DK-CARTON-ID  =  ZEROES                          05340062
053500                 PERFORM 1055-CHECK-TSULBXF                       05350062
053600              ELSE                                                05360062
053700* DMH - 6/03/03 END                                               05370062
053800                 IF  SUT00024-ACTV-IND  =  'N'                    05380062
053900                     SET PC046-INACTIVATED                        05390062
054000                         PS-INACTIVE-CRTN-FND  TO TRUE            05400062
054100                     PERFORM 1250-SELECT-CARTLOC                  05410062
054200                 END-IF                                           05420062
054300                                                                  05430062
054400                 MOVE SUT00024-SHIPT-UNT-ID  TO                   05440062
054500                                        PC046-VENDOR-SHIPT-UNT-ID 05450062
054600                                        PC046-KOHLS-BARCODE       05460062
054700                                        DK-CARTON-ID              05470062
054800                 MOVE SUT00024-DEST-LOC-NBR   TO                  05480062
054900                                         PC046-DEST-OPER-UNT-ID   05490062
055000                 SET PS-FOUND-ON-TSULBXF TO TRUE                  05500062
055100                 PERFORM 1075-CHECK-OTBNDCART                     05510062
055200              END-IF                                              05520062
055300                                                                  05530062
055400         WHEN SQLCODE = +100                                      05540062
055500             PERFORM 1055-CHECK-TSULBXF                           05550062
055600         WHEN SQLWARN0 NOT = SPACES                               05560062
055700         WHEN SQLCODE < +0                                        05570062
055800         WHEN SQLCODE > +0                                        05580062
055900              SET PS-ERROR                                        05590062
056000                  PC046-INVALID-SQL     TO TRUE                   05600062
056100              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  05610062
056200              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    05620062
056300                                            PV-SQL-RETURN-CD      05630062
056400              STRING  ' PCKUT713-1050-'                           05640062
056500                      PV-DISPLAY-CARTON-ID                        05650062
056600                      '  CALLED BY-'                              05660062
056700                      PC046-CALLING-PGM-NME                       05670062
056800                      '  SQLCODE='                                05680062
056900                      PV-DISPLAY-SQLCODE                          05690062
057000                      ' TASK= ' PV-EIBTASKN                       05700062
057100                      DELIMITED BY SIZE                           05710062
057200                                      INTO PC046-CRA-RET-MSG      05720062
057300             MOVE '1050-'                TO PC046-CRA-REQ-ID      05730062
057400             PERFORM 9998-RETURN                                  05740062
057500                                                                  05750062
057600     END-EVALUATE.                                                05760062
057700                                                                  05770062
057800*----------------------------------------------------------------*05780062
057900*  CHECK IF CARTON CHECKED IN (P2L)                               05790062
058000*----------------------------------------------------------------*05800062
058100 1055-CHECK-TSULBXF.                                              05810062
058200     MOVE ' 1055-CHECK-TSULBXF' TO PV-PARA                        05820062
058300                                                                  05830062
058400     EXEC SQL                                                     05840062
058500        SELECT A.SHIPT_UNT_ID                                     05850062
058600              ,A.BRCDE_NBR                                        05860062
058700              ,A.CRE_TMST                                         05870062
058800              ,A.CART_LBL_TYP_CDE                                 05880062
058900              ,A.DEST_OPER_UNT_ID                                 05890062
059000              ,A.STAT_CDE                                         05900062
059100              ,B.OPER_UNT_ID                                      05910062
059200              ,B.CRE_USR_ID                                       05920062
059300          INTO :SULBXF-SHIPT-UNT-ID                               05930062
059400              ,:SULBXF-BRCDE-NBR                                  05940062
059500              ,:SULBXF-CRE-TMST                                   05950062
059600              ,:SULBXF-CART-LBL-TYP-CDE                           05960062
059700              ,:SULBXF-DEST-OPER-UNT-ID                           05970062
059800              ,:SULBXF-STAT-CDE                                   05980062
059900              ,:SHUNLO-OPER-UNT-ID                                05990062
060000              ,:SHUNLO-CRE-USR-ID                                 06000062
060100          FROM  TSULBXF A                                         06010062
060200              , TSHUNLO B                                         06020062
060300         WHERE  A.SHIPT_UNT_ID     = :DK-CARTON-ID                06030062
060400           AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID              06040062
060500           AND  A.CRE_TMST         =  B.CRE_TMST                  06050062
060600           AND  A.LAST_STAT_CHG_TMST =                            06060062
060700          (SELECT MAX(C.LAST_STAT_CHG_TMST)                       06070062
060800            FROM TSULBXF C                                        06080062
060900            WHERE C.SHIPT_UNT_ID     = :DK-CARTON-ID)             06090062
061000     END-EXEC.                                                    06100062
061100                                                                  06110062
061200     EVALUATE TRUE                                                06120062
061300         WHEN SQLCODE = ZERO                                      06130062
061400         WHEN SQLCODE = -811                                      06140062
061500              IF SULBXF-STAT-CDE =  'I'                           06150062
061600                  SET PC046-INACTIVATED                           06160062
061700                      PS-INACTIVE-CRTN-FND  TO TRUE               06170062
061800              END-IF                                              06180062
061900              MOVE SULBXF-SHIPT-UNT-ID  TO                        06190062
062000                                         PC046-VENDOR-SHIPT-UNT-ID06200062
062100              MOVE SULBXF-BRCDE-NBR TO   PC046-KOHLS-BARCODE      06210062
062200              SET  PS-FOUND-ON-TSULBXF  TO  TRUE                  06220062
062300              MOVE SULBXF-DEST-OPER-UNT-ID                        06230062
062400                TO PC046-DEST-OPER-UNT-ID                         06240062
062500              MOVE SHUNLO-CRE-USR-ID                              06250062
062600                TO PC046-STATUS-USERID                            06260062
062700              MOVE SHUNLO-OPER-UNT-ID                             06270062
062800                TO PC046-STATUS-USERID                            06280062
062900              MOVE SULBXF-CRE-TMST                                06290062
063000                TO PC046-CRTN-STAT-TMST                           06300062
063100              SET  PC046-CHECKED-IN                               06310062
063200                   PC046-CK-IN-DESC                               06320062
063300                   PC046-SRC-ASN     TO  TRUE                     06330062
063400                                                                  06340062
063500         WHEN SQLCODE = +100                                      06350062
063600             PERFORM 1060-INBOUND-SHPUNT                          06360062
063700         WHEN SQLWARN0 NOT = SPACES                               06370062
063800         WHEN SQLCODE < +0                                        06380062
063900         WHEN SQLCODE > +0                                        06390062
064000              SET PS-ERROR                                        06400062
064100                  PC046-INVALID-SQL     TO TRUE                   06410062
064200              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  06420062
064300              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    06430062
064400                                            PV-SQL-RETURN-CD      06440062
064500              STRING  ' PCKUT713-1055-'                           06450062
064600                      PV-DISPLAY-CARTON-ID                        06460062
064700                      '  CALLED BY-'                              06470062
064800                      PC046-CALLING-PGM-NME                       06480062
064900                      '  SQLCODE='                                06490062
065000                      PV-DISPLAY-SQLCODE                          06500062
065100                      ' TASK= ' PV-EIBTASKN                       06510062
065200                      DELIMITED BY SIZE                           06520062
065300                                      INTO PC046-CRA-RET-MSG      06530062
065400             MOVE '1055-'                TO PC046-CRA-REQ-ID      06540062
065500             PERFORM 9998-RETURN                                  06550062
065600                                                                  06560062
065700     END-EVALUATE.                                                06570062
065800                                                                  06580062
065900 1060-INBOUND-SHPUNT.                                             06590062
066000                                                                  06600062
066100     EXEC SQL                                                     06610062
066200          SELECT                                                  06620062
066300                                                                  06630062
066400             TIMESTAMP                                            06640062
066500             (                                                    06650062
066600             CHAR(CRE_DTE) || '-' || CHAR(CRE_TM) || '.000000'    06660062
066700             )                                                    06670062
066800                 ,ACTV_IND                                        06680062
066900                 ,SHIPT_UNT_SRC_ID                                06690062
067000                 ,DEST_OPER_UNT_ID                                06700062
067100            INTO :PC046-CRTN-STAT-TMST                            06710062
067200                ,:SHPUNT-ACTV-IND                                 06720062
067300                ,:PV-SHIPT-UNT-SRC-ID                             06730062
067400                ,:SHPUNT-DEST-OPER-UNT-ID                         06740062
067500            FROM  TSHPUNT                                         06750062
067600           WHERE  SHIPT_UNT_ID    = :DK-CARTON-ID                 06760062
067700     END-EXEC.                                                    06770062
067800                                                                  06780062
067900     MOVE SQLCODE TO PV-DISPLAY-SQLCODE.                          06790062
068000     EVALUATE TRUE                                                06800062
068100         WHEN SQLCODE = ZERO                                      06810062
068200              IF  SHPUNT-ACTV-IND  =  'I'                         06820062
068300                  SET PC046-INACTIVATED                           06830062
068400                      PS-INACTIVE-CRTN-FND  TO TRUE               06840062
068500                  PERFORM 1260-SELECT-TSHUNLO                     06850062
068600              END-IF                                              06860062
068700                                                                  06870062
068800              MOVE SHPUNT-DEST-OPER-UNT-ID                        06880062
068900                                        TO PC046-DEST-OPER-UNT-ID 06890062
069000              MOVE PV-SHIPT-UNT-SRC-ID  TO PC046-SHPUNT-SRC-ID    06900062
069100*             SET PS-FOUND-ON-TSHPUNT   TO TRUE                   06910062
069200         WHEN SQLCODE = +100                                      06920062
069300              SET PC046-INVALID-CRTN                              06930062
069400                  PC046-INVALID-DESC    TO TRUE                   06940062
069500              MOVE ZERO                 TO                        06950062
069600                                         PC046-VENDOR-SHIPT-UNT-ID06960062
069700                                                                  06970062
069800         WHEN SQLWARN0 NOT = SPACES                               06980062
069900         WHEN SQLCODE NOT EQUAL ZERO                              06990062
070000              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  07000062
070100              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    07010062
070200                                            PV-SQL-RETURN-CD      07020062
070300              STRING 'ERR FILE# SQL='                             07030062
070400                      PV-SQL-RETURN-CD      DELIMITED BY SIZE     07040062
070500                                       INTO PC046-CRA-RET-MSG     07050062
070600              SET PC046-INVALID-SQL      TO TRUE                  07060062
070700              MOVE '1000-'               TO PC046-CRA-REQ-ID      07070062
070800     END-EVALUATE.                                                07080062
070900                                                                  07090062
071000*-----------------------------------------------------------------07100062
071100*CHECK TO SEE IF THE VENDOR BARCODE IS ON OTBNDCART.              07110062
071200*-----------------------------------------------------------------07120062
071300 1075-CHECK-OTBNDCART.                                            07130062
071400     MOVE ' 1075-CHECK-OTBNDCART' TO PV-PARA.                     07140062
071500                                                                  07150062
071600     EXEC SQL                                                     07160062
071700          SELECT  ACTV_IND                                        07170062
071800            INTO :SUT00024-ACTV-IND                               07180062
071900            FROM  SUT_OTBND_CART                                  07190062
072000           WHERE  SHIPT_UNT_ID    = :DK-CARTON-ID                 07200062
072100     END-EXEC.                                                    07210062
072200                                                                  07220062
072300     EVALUATE TRUE                                                07230062
072400         WHEN SQLCODE = ZERO                                      07240062
072500              IF  SUT00024-ACTV-IND = 'N'                         07250062
072600                  SET PC046-INACTIVATED     TO TRUE               07260062
072700                  PERFORM 1250-SELECT-CARTLOC                     07270062
072800              END-IF                                              07280062
072900              SET PS-FOUND-ON-OTBNDCART TO TRUE                   07290062
073000         WHEN SQLCODE = +100                                      07300062
073100              SET PC046-INVALID-CRTN                              07310062
073200                  PC046-INVALID-DESC    TO TRUE                   07320062
073300                                                                  07330062
073400         WHEN SQLWARN0 NOT = SPACES                               07340062
073500         WHEN SQLCODE NOT EQUAL ZERO                              07350062
073600              SET PS-ERROR                                        07360062
073700                  PC046-INVALID-SQL     TO TRUE                   07370062
073800              MOVE PC046-VENDOR-SHIPT-UNT-ID                      07380062
073900                                        TO  PV-DISPLAY-CARTON-ID  07390062
074000              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    07400062
074100                                            PV-SQL-RETURN-CD      07410062
074200              STRING  ' PCKUT713-1075-'                           07420062
074300                      PV-DISPLAY-CARTON-ID                        07430062
074400                      '  CALLED BY-'                              07440062
074500                      PC046-CALLING-PGM-NME                       07450062
074600                      '  SQLCODE='                                07460062
074700                      PV-DISPLAY-SQLCODE                          07470062
074800                      ' TASK= ' PV-EIBTASKN                       07480062
074900                                      DELIMITED BY SIZE           07490062
075000                                      INTO PC046-CRA-RET-MSG      07500062
075100             MOVE '1075-'                TO PC046-CRA-REQ-ID      07510062
075200             PERFORM 9998-RETURN                                  07520062
075300     END-EVALUATE.                                                07530062
075400                                                                  07540062
075500*-----------------------------------------------------------------07550062
075600* CHECK TO SEE IF THE CARTON HAS BEEN SCANNED OFF THE TRAILER     07560062
075700*-----------------------------------------------------------------07570062
075800 1100-CHECK-SCAN-OFF.                                             07580062
075900     MOVE ' 1100-CHECK-SCAN-OFF' TO PV-PARA                       07590062
076000                                                                  07600062
076100     IF PS-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF             07610062
076200         PERFORM 1115-CHK-DIVERT-SCAN-OFF-BRCDE                   07620062
076300     ELSE                                                         07630062
076400         IF PS-NOT-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF     07640062
076500             PERFORM 1115-CHK-DIVERT-SCAN-OFF-BRCDE               07650062
076600         ELSE                                                     07660062
076700             PERFORM 1110-CHECK-DIVERT-SCAN-OFF                   07670062
076800         END-IF                                                   07680062
076900     END-IF.                                                      07690062
077100     IF PS-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF             07710062
077200         MOVE PC046-VENDOR-SHIPT-UNT-ID  TO DK-CARTON-ID          07720062
077300     ELSE                                                         07730062
077400         IF PS-NOT-FOUND-ON-OTBNDCART AND PS-FOUND-ON-TSULBXF     07740062
077500             MOVE PC046-VENDOR-SHIPT-UNT-ID  TO DK-CARTON-ID      07750062
077600         ELSE                                                     07760062
077700             MOVE PC046-CARTON-ID  TO DK-CARTON-ID                07770062
077800         END-IF                                                   07780062
077900     END-IF.                                                      07790062
078000     IF  PC046-CRTN-STATUS = SPACES                               07800062
078100         PERFORM 1120-CHECK-MANUAL-SCAN-OFF                       07810062
078200     END-IF.                                                      07820062
078300                                                                  07830062
078400*-----------------------------------------------------------------07840062
078500* CHECK IF SCANNED OFF - FROM CONVEYOR SYSTEM                     07850062
078600*-----------------------------------------------------------------07860062
078700 1110-CHECK-DIVERT-SCAN-OFF.                                      07870062
078800     MOVE ' 1110-CHECK-DIVERT-SCAN-OFF' TO PV-PARA                07880062
078900                                                                  07890062
079000     EXEC SQL                                                     07900062
079100          SELECT  A.DIVERT_TMST                                   07910062
079200                 ,A.ACTV_CDE                                      07920062
079300                 ,A.DOOR_ID                                       07930062
079400            INTO :SUCRDV-DIVERT-TMST                              07940062
079500                ,:SUCRDV-ACTV-CDE                                 07950062
079600                ,:SUCRDV-DOOR-ID                                  07960062
079700            FROM  TSUCRDV A                                       07970062
079800           WHERE  A.SHIPT_UNT_ID = :DK-CARTON-ID                  07980062
079900             AND  A.ACTV_CDE     = 'I'                            07990062
080000             AND  A.DIVERT_TMST  =                                08000062
080100                  (SELECT  MAX(B.DIVERT_TMST)                     08010062
080200                     FROM  TSUCRDV B                              08020062
080300                    WHERE  B.SHIPT_UNT_ID = :DK-CARTON-ID)        08030062
080400     END-EXEC.                                                    08040062
080500                                                                  08050062
080600     EVALUATE TRUE                                                08060062
080700         WHEN SQLCODE = ZERO                                      08070062
080800              SET PC046-SCANNED-OFF-TRLR                          08080062
080900                  PC046-SC-OF-DESC       TO TRUE                  08090062
081000              MOVE SUCRDV-DIVERT-TMST    TO PC046-CRTN-STAT-TMST  08100062
081100              MOVE SUCRDV-DOOR-ID        TO PC046-DOOR-ID         08110062
081200                                                                  08120062
081300         WHEN SQLCODE = +100                                      08130062
081400              CONTINUE                                            08140062
081500                                                                  08150062
081600         WHEN SQLWARN0 NOT = SPACES                               08160062
081700         WHEN SQLCODE NOT EQUAL ZERO                              08170062
081800              SET PS-ERROR                                        08180062
081900                  PC046-INVALID-SQL      TO TRUE                  08190062
082000              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  08200062
082100              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    08210062
082200                                            PV-SQL-RETURN-CD      08220062
082300              STRING  ' PCKUT713-1110-'                           08230062
082400                      PV-DISPLAY-CARTON-ID                        08240062
082500                      '  CALLED BY-'                              08250062
082600                      PC046-CALLING-PGM-NME                       08260062
082700                      '  SQLCODE='                                08270062
082800                      PV-DISPLAY-SQLCODE                          08280062
082900                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     08290062
083000                                      INTO PC046-CRA-RET-MSG      08300062
083100             SET  PC046-INVALID-SQL      TO TRUE                  08310062
083200             MOVE '1110-'                TO PC046-CRA-REQ-ID      08320062
083300             PERFORM 9998-RETURN                                  08330062
083400                                                                  08340062
083500     END-EVALUATE.                                                08350062
083600                                                                  08360062
083700*-----------------------------------------------------------------08370062
083800* CHECK IF SCANNED OFF - FROM CONVEYOR SYSTEM - USING BARCODE     08380062
083900*-----------------------------------------------------------------08390062
084000 1115-CHK-DIVERT-SCAN-OFF-BRCDE.                                  08400062
084100     MOVE ' 1115-CHK-DIVERT-SCAN-OFF-BRCDE' TO PV-PARA            08410062
084200                                                                  08420062
084300     EXEC SQL                                                     08430062
084400          SELECT  A.DIVERT_TMST                                   08440062
084500                 ,A.ACTV_CDE                                      08450062
084600                 ,A.DOOR_ID                                       08460062
084700            INTO :SUCRDV-DIVERT-TMST                              08470062
084800                ,:SUCRDV-ACTV-CDE                                 08480062
084900                ,:SUCRDV-DOOR-ID                                  08490062
085000            FROM  TSUCRDV A                                       08500062
085100           WHERE  A.BRCDE_NBR    = :PC046-KOHLS-BARCODE           08510062
085200             AND  A.ACTV_CDE     = 'I'                            08520062
085300             AND  A.DIVERT_TMST  =                                08530062
085400                  (SELECT  MAX(B.DIVERT_TMST)                     08540062
085500                     FROM  TSUCRDV B                              08550062
085600                    WHERE  B.BRCDE_NBR  = :PC046-KOHLS-BARCODE)   08560062
085700     END-EXEC.                                                    08570062
085800                                                                  08580062
085900     EVALUATE TRUE                                                08590062
086000         WHEN SQLCODE = ZERO                                      08600062
086100              SET PC046-SCANNED-OFF-TRLR                          08610062
086200                  PC046-SC-OF-DESC       TO TRUE                  08620062
086300              MOVE SUCRDV-DIVERT-TMST    TO PC046-CRTN-STAT-TMST  08630062
086400              MOVE SUCRDV-DOOR-ID        TO PC046-DOOR-ID         08640062
086500                                                                  08650062
086600         WHEN SQLCODE = +100                                      08660062
086700              CONTINUE                                            08670062
086800         WHEN SQLWARN0 NOT = SPACES                               08680062
086900         WHEN SQLCODE NOT EQUAL ZERO                              08690062
087000              SET PS-ERROR                                        08700062
087100                  PC046-INVALID-SQL     TO TRUE                   08710062
087200              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  08720062
087300              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    08730062
087400                                            PV-SQL-RETURN-CD      08740062
087500              STRING  ' PCKUT713-1115-'                           08750062
087600                      PV-DISPLAY-CARTON-ID                        08760062
087700                      '  CALLED BY-'                              08770062
087800                      PC046-CALLING-PGM-NME                       08780062
087900                      '  SQLCODE='                                08790062
088000                      PV-DISPLAY-SQLCODE                          08800062
088100                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     08810062
088200                                      INTO PC046-CRA-RET-MSG      08820062
088300             MOVE '1115-'                TO PC046-CRA-REQ-ID      08830062
088400             PERFORM 9998-RETURN                                  08840062
088500                                                                  08850062
088600     END-EVALUATE.                                                08860062
088700                                                                  08870062
088800*-----------------------------------------------------------------08880062
088900* CHECK IF CARTON MANUALLY SCANNED OFF OF TRAILER (CARTLOC - SCOF)08890062
088910* 3/31/22 GB ADD CHECK FOR NULL TRIP ID, IF NULL MOVE 0 TO TRIP ID08891073
089000*-----------------------------------------------------------------08900062
089100 1120-CHECK-MANUAL-SCAN-OFF.                                      08910062
089200     MOVE ' 1120-CHECK-MANUAL-SCAN-OFF' TO PV-PARA                08920062
089400     EXEC SQL                                                     08940062
089500          SELECT  A.SCN_CDE                                       08950062
089600                 ,A.ACTV_CDE                                      08960062
089700                 ,A.CRE_USR_ID                                    08970062
089800                 ,A.CRE_TMST                                      08980062
089900                 ,A.OTBND_TRIP_ID                                 08990062
090000            INTO :SUT00027-SCN-CDE                                09000062
090100                ,:SUT00027-ACTV-CDE                               09010062
090200                ,:SUT00027-CRE-USR-ID                             09020062
090300                ,:SUT00027-CRE-TMST                               09030062
090400                ,:SUT00027-OTBND-TRIP-ID :PV-NULL-IND             09040070
090500            FROM  SUT_OTBND_LOC A                                 09050062
090600           WHERE  A.SHIPT_UNT_ID = :DK-CARTON-ID                  09060062
090700             AND  A.SCN_CDE      = 'SHOF'                         09070062
090800             AND  A.ACTV_CDE     = 'I'                            09080062
090900             AND  A.CRE_TMST     =                                09090062
091000                  (SELECT  MAX(B.CRE_TMST)                        09100062
091100                     FROM  SUT_OTBND_LOC B                        09110062
091200                    WHERE  SHIPT_UNT_ID = :DK-CARTON-ID           09120062
091300                      AND  B.SCN_CDE   IN ('SHOF','SHON'))        09130062
091400     END-EXEC.                                                    09140062
091500                                                                  09150073
091600     EVALUATE TRUE                                                09160062
091700         WHEN SQLCODE = ZERO                                      09170062
091800              SET PC046-SCANNED-OFF-TRLR                          09180062
091900                  PC046-SC-OF-DESC       TO TRUE                  09190062
091910              IF PV-NULL-IND  = -1                                09191070
091920                 MOVE +0     TO      PC046-OTBD-TRIP-ID           09192070
091930              ELSE                                                09193070
092000                 MOVE SUT00027-OTBND-TRIP-ID TO PC046-OTBD-TRIP-ID09200070
092010              END-IF                                              09201070
092100              MOVE SUT00027-CRE-TMST     TO PC046-CRTN-STAT-TMST  09210062
092200                                                                  09220062
092300         WHEN SQLCODE = +100                                      09230062
092400              CONTINUE                                            09240062
092500                                                                  09250062
092600         WHEN SQLWARN0 NOT = SPACES                               09260062
092700         WHEN SQLCODE NOT EQUAL ZERO                              09270062
092800              SET PS-ERROR                                        09280062
092900                  PC046-INVALID-SQL      TO TRUE                  09290062
093000              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  09300062
093100              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    09310062
093200                                            PV-SQL-RETURN-CD      09320062
093300              STRING  ' PCKUT713-1120-'                           09330062
093400                      PV-DISPLAY-CARTON-ID                        09340062
093500                      '  CALLED BY-'                              09350062
093600                      PC046-CALLING-PGM-NME                       09360062
093700                      '  SQLCODE='                                09370062
093800                      PV-DISPLAY-SQLCODE                          09380062
093900                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     09390062
094000                                      INTO PC046-CRA-RET-MSG      09400062
094100             MOVE '1120-'                TO PC046-CRA-REQ-ID      09410062
094200             PERFORM 9998-RETURN                                  09420062
094300                                                                  09430062
094400     END-EVALUATE.                                                09440062
094500                                                                  09450062
094600*-----------------------------------------------------------------09460062
094700* CHECK TO SEE IF CARTON WAS MANUALLY SCANNED ONTO A TRAILER      09470062
094800*-----------------------------------------------------------------09480062
094900 1200-CHECK-MANUAL-SCAN-ON.                                       09490062
095000     MOVE ' 1200-CHECK-MANUAL-SCAN-ON' TO PV-PARA                 09500062
095100                                                                  09510062
095200     EXEC SQL                                                     09520062
095300          SELECT  SCN_CDE                                         09530062
095400                 ,ACTV_CDE                                        09540062
095500                 ,CRE_USR_ID                                      09550062
095600                 ,CRE_TMST                                        09560062
095700                 ,OTBND_TRIP_ID                                   09570064
095800            INTO :SUT00027-SCN-CDE                                09580062
095900                ,:SUT00027-ACTV-CDE                               09590062
096000                ,:SUT00027-CRE-USR-ID                             09600062
096100                ,:SUT00027-CRE-TMST                               09610062
096200                ,:SUT00027-OTBND-TRIP-ID                          09620065
096300            FROM  SUT_OTBND_LOC A                                 09630062
096400           WHERE A.SHIPT_UNT_ID = :DK-CARTON-ID                   09640062
096500             AND A.SCN_CDE      = 'SHON'                          09650062
096600             AND A.ACTV_CDE     = 'A'                             09660062
096700             AND A.CRE_TMST IN                                    09670062
096800                 (SELECT MAX(B.CRE_TMST)                          09680062
096900                    FROM SUT_OTBND_LOC B                          09690062
097000                   WHERE A.SHIPT_UNT_ID = B.SHIPT_UNT_ID          09700062
097100                     AND B.ACTV_CDE     = 'A'                     09710062
097200                     AND B.SCN_CDE   IN ('SHOF','SHON'))          09720062
097300     END-EXEC.                                                    09730062
097400                                                                  09740062
097500     EVALUATE TRUE                                                09750062
097600         WHEN SQLCODE = ZERO                                      09760062
097700              SET  PC046-SCANNED-ONTO-TRLR                        09770062
097800                   PC046-SC-ON-DESC       TO TRUE                 09780062
097900              MOVE SUT00027-OTBND-TRIP-ID TO PC046-OTBD-TRIP-ID   09790065
098000              MOVE SUT00027-CRE-USR-ID    TO PC046-STATUS-USERID  09800062
098100              MOVE SUT00027-CRE-TMST      TO PC046-CRTN-STAT-TMST 09810062
098200                                                                  09820062
098300         WHEN SQLCODE = +100                                      09830062
098400             CONTINUE                                             09840062
098500                                                                  09850062
098600         WHEN SQLWARN0 NOT = SPACES                               09860062
098700         WHEN SQLCODE NOT EQUAL ZERO                              09870062
098800              SET PS-ERROR                                        09880062
098900                  PC046-INVALID-SQL      TO TRUE                  09890062
099000              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  09900062
099100              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    09910062
099200                                            PV-SQL-RETURN-CD      09920062
099300              STRING  ' PCKUT713-1200-'                           09930062
099400                      PV-DISPLAY-CARTON-ID                        09940062
099500                      '  CALLED BY-'                              09950062
099600                      PC046-CALLING-PGM-NME                       09960062
099700                      '  SQLCODE='                                09970062
099800                      PV-DISPLAY-SQLCODE                          09980062
099900                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     09990062
100000                                      INTO PC046-CRA-RET-MSG      10000062
100100             MOVE '1200-'                TO PC046-CRA-REQ-ID      10010062
100200             PERFORM 9998-RETURN                                  10020062
100300                                                                  10030062
100400     END-EVALUATE.                                                10040062
100500                                                                  10050062
100600*-----------------------------------------------------------------10060062
100700 1250-SELECT-CARTLOC.                                             10070062
100800     MOVE ' 1250-SELECT-CARTLOC'   TO PV-PARA                     10080062
100900                                                                  10090062
101000     EXEC SQL                                                     10100062
101100          SELECT  A.SCN_CDE                                       10110062
101200            INTO :SUT00027-SCN-CDE                                10120062
101300            FROM  SUT_OTBND_LOC A                                 10130062
101400           WHERE  A.SHIPT_UNT_ID = :DK-CARTON-ID                  10140062
101500             AND  A.CRE_TMST     =                                10150062
101600                  (SELECT  MAX(B.CRE_TMST)                        10160062
101700                     FROM  SUT_OTBND_LOC B                        10170062
101800                    WHERE  SHIPT_UNT_ID = :DK-CARTON-ID)          10180062
101900     END-EXEC.                                                    10190062
102000                                                                  10200062
102100     EVALUATE TRUE                                                10210062
102200         WHEN SQLCODE = ZERO                                      10220062
102300              IF SUT00027-SCN-CDE = 'NUSE'                        10230062
102400                  SET PC046-INACT-UNUSD-DESC  TO TRUE             10240062
102500              ELSE                                                10250062
102600                  IF SUT00027-SCN-CDE = 'RCLM'                    10260062
102700                      SET PC046-INACT-RECLM-DESC  TO TRUE         10270062
102800                  ELSE                                            10280062
102900                      IF  PV-SRC-SMOOTHING                        10290062
103000                          SET PC046-INACT-SMOOTH-DESC TO TRUE     10300062
103100                      ELSE                                        10310062
103200                          IF  PV-SRC-MSTR-CNTR                    10320062
103300                              SET PC046-INACT-MASTER-DESC TO TRUE 10330062
103400                          ELSE                                    10340062
103500                              SET PC046-INACT-CASEPK-DESC TO TRUE 10350062
103600                          END-IF                                  10360062
103700                      END-IF                                      10370062
103800                  END-IF                                          10380062
103900              END-IF                                              10390062
104000                                                                  10400062
104100         WHEN SQLCODE = +100                                      10410062
104200             IF PV-SRC-MSTR-CNTR                                  10420062
104300                 SET PC046-INACT-MASTER-DESC TO TRUE              10430062
104400             ELSE                                                 10440062
104500                 SET PC046-INACT-CASEPK-DESC TO TRUE              10450062
104600             END-IF                                               10460062
104700                                                                  10470062
104800         WHEN SQLWARN0 NOT = SPACES                               10480062
104900         WHEN SQLCODE NOT EQUAL ZERO                              10490062
105000              SET PS-ERROR                                        10500062
105100                  PC046-INVALID-SQL     TO TRUE                   10510062
105200              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  10520062
105300              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    10530062
105400                                            PV-SQL-RETURN-CD      10540062
105500              STRING  ' PCKUT713-1250-'                           10550062
105600                      PV-DISPLAY-CARTON-ID                        10560062
105700                      '  CALLED BY-'                              10570062
105800                      PC046-CALLING-PGM-NME                       10580062
105900                      '  SQLCODE='                                10590062
106000                      PV-DISPLAY-SQLCODE                          10600062
106100                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     10610062
106200                                      INTO PC046-CRA-RET-MSG      10620062
106300             MOVE '1250-'                TO PC046-CRA-REQ-ID      10630062
106400             PERFORM 9998-RETURN                                  10640062
106500                                                                  10650062
106600     END-EVALUATE.                                                10660062
106700/                                                                 10670062
106800 1260-SELECT-TSHUNLO.                                             10680062
106900     EXEC SQL                                                     10690062
107000          SELECT  A.SCN_LOC_ID                                    10700062
107100            INTO :SHUNLO-SCN-LOC-ID                               10710062
107200            FROM  TSHUNLO A                                       10720062
107300           WHERE  A.SHIPT_UNT_ID = :DK-CARTON-ID                  10730062
107400             AND  A.CRE_TMST     =                                10740062
107500                  (SELECT  MAX(B.CRE_TMST)                        10750062
107600                     FROM  TSHUNLO B                              10760062
107700                    WHERE  SHIPT_UNT_ID = :DK-CARTON-ID)          10770062
107800     END-EXEC.                                                    10780062
107900                                                                  10790062
108000     EVALUATE TRUE                                                10800062
108100         WHEN SQLCODE = ZERO                                      10810062
108200              IF SHUNLO-SCN-LOC-ID = 'NUSE'                       10820062
108300                  SET PC046-INACT-UNUSD-DESC  TO TRUE             10830062
108400              ELSE                                                10840062
108500                  IF SHUNLO-SCN-LOC-ID = 'RCCM'                   10850062
108600                      SET PC046-INACT-RECLM-DESC  TO TRUE         10860062
108700                  ELSE                                            10870062
108800                      IF  SUT00024-CART-TYP-CDE  =  'K'           10880062
108900                          SET PC046-INACT-SMOOTH-DESC TO TRUE     10890062
109000                      ELSE                                        10900062
109100                          SET PC046-INACT-CASEPK-DESC TO TRUE     10910062
109200                      END-IF                                      10920062
109300                  END-IF                                          10930062
109400              END-IF                                              10940062
109500                                                                  10950062
109600         WHEN SQLCODE = +100                                      10960062
109700             IF PV-SHIPT-UNT-SRC-ID = 'MST'                       10970062
109800                 SET PC046-INACT-MASTER-DESC TO TRUE              10980062
109900             ELSE                                                 10990062
110000                 IF PV-SHIPT-UNT-SRC-ID = 'ASN'                   11000062
110100                    SET PC046-INACT-SMOOTH-DESC TO TRUE           11010062
110200                 ELSE                                             11020062
110300                    SET PC046-INACT-CASEPK-DESC TO TRUE           11030062
110400                 END-IF                                           11040062
110500             END-IF                                               11050062
110600                                                                  11060062
110700         WHEN SQLWARN0 NOT = SPACES                               11070062
110800         WHEN SQLCODE NOT EQUAL ZERO                              11080062
110900              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  11090062
111000              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    11100062
111100                                            PV-SQL-RETURN-CD      11110062
111200             STRING 'ERR FILE# SQL='                              11120062
111300                PV-SQL-RETURN-CD            DELIMITED BY SIZE     11130062
111400                                       INTO PC046-CRA-RET-MSG     11140062
111500             SET  PC046-INVALID-SQL      TO TRUE                  11150062
111600             MOVE '1260-'                TO PC046-CRA-REQ-ID      11160062
111700                                                                  11170062
111800     END-EVALUATE.                                                11180062
111900                                                                  11190062
112000*-----------------------------------------------------------------11200062
112100*IF THE CARTON WAS DIVERTED, THE ACTIVE ENTRY CODE WILL = 'A'.    11210062
112200*-----------------------------------------------------------------11220062
112300 1300-CHECK-DIVERTED.                                             11230062
112400     MOVE ' 1300-CHECK-DIVERTED' TO PV-PARA                       11240062
112500                                                                  11250062
112600     EXEC SQL                                                     11260062
112700          SELECT  DIVERT_TMST                                     11270062
112800                 ,NACTV_USR_ID                                    11280062
112900                 ,ACTV_CDE                                        11290062
113000                 ,OPER_UNT_ID                                     11300062
113100                 ,DIVERT_NBR                                      11310062
113200                 ,DIVERT_LOC_ID                                   11320062
113300                 ,DOOR_ID                                         11330062
113400            INTO :SUCRDV-DIVERT-TMST                              11340062
113500                ,:SUCRDV-NACTV-USR-ID                             11350062
113600                ,:SUCRDV-ACTV-CDE                                 11360062
113700                ,:SUCRDV-OPER-UNT-ID                              11370062
113800                ,:SUCRDV-DIVERT-NBR                               11380062
113900                ,:SUCRDV-DIVERT-LOC-ID                            11390062
114000                ,:SUCRDV-DOOR-ID                                  11400062
114100            FROM  TSUCRDV                                         11410062
114200           WHERE  SHIPT_UNT_ID = :DK-CARTON-ID                    11420062
114300             AND  ACTV_CDE     = 'A'                              11430062
114400             AND  DIVERT_TMST =                                   11440062
114500                   (SELECT MAX(B.DIVERT_TMST)                     11450062
114600                      FROM TSUCRDV B                              11460062
114700                     WHERE B.SHIPT_UNT_ID = :DK-CARTON-ID)        11470062
114800     END-EXEC.                                                    11480062
114900                                                                  11490062
115000     EVALUATE TRUE                                                11500062
115100         WHEN SQLCODE = ZERO                                      11510062
115200              IF  PC046-SCANNED-ONTO-TRLR  AND                    11520062
115300                  SUCRDV-DIVERT-TMST  >  PC046-CRTN-STAT-TMST     11530062
115400                      SET  PC046-CRTN-STAT-ERROR  TO  TRUE        11540062
115500                     MOVE DK-CARTON-ID   TO PV-DISPLAY-CARTON-ID  11550062
115600                     MOVE SUCRDV-OPER-UNT-ID                      11560062
115700                                         TO PV-DISPLAY-OPER-UNT   11570062
115800                     MOVE SQLCODE        TO PV-DISPLAY-SQLCODE    11580062
115900                                            PV-SQL-RETURN-CD      11590062
116000                      STRING  ' PCKUT713-1300-'                   11600062
116100                              PV-DISPLAY-CARTON-ID                11610062
116200                              ' SQLCODE-'                         11620062
116300                              PV-DISPLAY-SQLCODE                  11630062
116400                              ' OPER-'                            11640062
116500                              PV-DISPLAY-OPER-UNT                 11650062
116600                              ' DOOR-'                            11660062
116700                              SUCRDV-DOOR-ID                      11670062
116800                              ' TASK= ' PV-EIBTASKN               11680062
116900                                           DELIMITED BY SIZE      11690062
117000                                      INTO PC046-CRA-RET-MSG      11700062
117100                      MOVE '1300-'      TO PC046-CRA-REQ-ID       11710062
117200                                                                  11720062
117300              ELSE                                                11730062
117400                  SET  PC046-DIVERTED-TO-TRLR                     11740062
117500                       PC046-DVRT-DESC        TO TRUE             11750062
117600* DMH                                                             11760062
117700                  IF  SUCRDV-DIVERT-TMST > PC046-CRTN-STAT-TMST   11770062
117800                      MOVE  ZEROES  TO  PC046-OTBD-TRIP-ID        11780062
117900                  END-IF                                          11790062
118000* DMH                                                             11800062
118100                  MOVE SUCRDV-DIVERT-TMST  TO PC046-CRTN-STAT-TMST11810062
118200                  MOVE SUCRDV-NACTV-USR-ID TO PC046-STATUS-USERID 11820062
118300              END-IF                                              11830062
118400              MOVE SUCRDV-OPER-UNT-ID   TO DK-OPER-UNT-ID         11840062
118500              MOVE SUCRDV-DOOR-ID       TO DK-DOOR-ID             11850062
118600                                           PC046-DOOR-ID          11860062
118700              MOVE SUCRDV-DIVERT-TMST   TO DK-CARTON-TMST         11870062
118800              PERFORM 1400-CHECK-4-BEGIN-END                      11880062
118900         WHEN SQLCODE = +100                                      11890062
119000              CONTINUE                                            11900062
119100         WHEN SQLWARN0 NOT = SPACES                               11910062
119200         WHEN SQLCODE NOT EQUAL ZERO                              11920062
119300              SET PS-ERROR                                        11930062
119400                  PC046-INVALID-SQL     TO TRUE                   11940062
119500              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  11950062
119600              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    11960062
119700                                            PV-SQL-RETURN-CD      11970062
119800              STRING  ' PCKUT713-1300-'                           11980062
119900                      PV-DISPLAY-CARTON-ID                        11990062
120000                      ' SQLCODE-'                                 12000062
120100                      PV-DISPLAY-SQLCODE                          12010062
120200                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     12020062
120300                                      INTO PC046-CRA-RET-MSG      12030062
120400             MOVE '1300-'                TO PC046-CRA-REQ-ID      12040062
120500             PERFORM 9998-RETURN                                  12050062
120600                                                                  12060062
120700     END-EVALUATE.                                                12070062
120800                                                                  12080062
120900*-----------------------------------------------------------------12090062
121000*CHECK TO SEE IF CARTON IS A BEGIN OR END DIVERT                  12100062
121100*-----------------------------------------------------------------12110062
121200 1400-CHECK-4-BEGIN-END.                                          12120062
121300     MOVE ' 1400-CHECK-4-BEGIN-END' TO PV-PARA                    12130062
121400                                                                  12140062
121500     EXEC SQL                                                     12150062
121600          SELECT  STRT_DIVERT_TMST                                12160062
121700                 ,END_DIVERT_TMST                                 12170062
121800            INTO :SUCDOT-STRT-DIVERT-TMST                         12180062
121900                ,:SUCDOT-END-DIVERT-TMST                          12190062
122000            FROM  TSUCDOT                                         12200062
122100           WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID             12210062
122200             AND  DOOR_ID           = :DK-DOOR-ID                 12220062
122300             AND  STRT_DIVERT_TMST >                              12230062
122400                     TIMESTAMP(:DK-CARTON-TMST) - 45 DAYS         12240062
122500             AND  (STRT_DIVERT_TMST = :DK-CARTON-TMST             12250062
122600              OR   END_DIVERT_TMST  = :DK-CARTON-TMST)            12260062
122700     END-EXEC.                                                    12270062
122800                                                                  12280062
122900     EVALUATE TRUE                                                12290062
123000         WHEN SQLCODE = ZERO                                      12300062
123100              IF SUCDOT-STRT-DIVERT-TMST = DK-CARTON-TMST         12310062
123200                  SET PC046-BEGIN-DIVERT TO TRUE                  12320062
123300              ELSE                                                12330062
123400                  IF SUCDOT-END-DIVERT-TMST = DK-CARTON-TMST      12340062
123500                      SET PC046-END-DIVERT TO TRUE                12350062
123600                  END-IF                                          12360062
123700              END-IF                                              12370062
123800         WHEN SQLCODE = +100                                      12380062
123900              CONTINUE                                            12390062
124000         WHEN SQLWARN0 NOT = SPACES                               12400062
124100         WHEN SQLCODE NOT EQUAL ZERO                              12410062
124200              SET PS-ERROR                                        12420062
124300                  PC046-INVALID-SQL      TO TRUE                  12430062
124400              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  12440062
124500              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    12450062
124600                                            PV-SQL-RETURN-CD      12460062
124700              STRING  ' PCKUT713-1400-'                           12470062
124800                      PV-DISPLAY-CARTON-ID                        12480062
124900                      ' SQLCODE-'                                 12490062
125000                      PV-DISPLAY-SQLCODE                          12500062
125100                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     12510062
125200                                      INTO PC046-CRA-RET-MSG      12520062
125300             MOVE '1400-'                TO PC046-CRA-REQ-ID      12530062
125400             PERFORM 9998-RETURN                                  12540062
125500                                                                  12550062
125600     END-EVALUATE.                                                12560062
125700                                                                  12570062
125800*-----------------------------------------------------------------12580062
125900* IF THE CARTON WAS DIVERTED, CHECK TO SEE IF THE CARTON WAS      12590062
126000* LOADED ONTO A TRAILER.                                          12600062
126100*****                                                             12610062
126200* GET OUTBOUND TRIPS ASSOCIATED TO THE DC DOOR.                   12620062
126300* DESCENDING SEQUENCE BY OPEN STATUS DATE.                        12630062
126400*-----------------------------------------------------------------12640062
126500 2000-LOAD-ONTO-TRAILER.                                          12650062
126600     MOVE ' 2000-LOAD-ONTO-TRAILER'  TO PV-PARA                   12660062
126700                                                                  12670062
126800                                                                  12680062
126900     MOVE  SUCRDV-OPER-UNT-ID   TO  DK-OPER-UNT-ID.               12690062
127000     MOVE  SUCRDV-DOOR-ID       TO  DK-DOOR-ID.                   12700062
127100     MOVE  SUCRDV-DIVERT-TMST   TO  DK-CARTON-TMST.               12710062
127200                                                                  12720062
127300     PERFORM 2110-OPEN-TRIP-CSR.                                  12730062
127400                                                                  12740062
127500     IF  PS-NO-ERROR                                              12750062
127600         PERFORM 2120-FETCH-TRIP-CSR                              12760062
127700     END-IF.                                                      12770062
127800                                                                  12780062
127900     SET PS-TRIP-NOT-FOUND TO TRUE.                               12790062
128000     IF  PS-NO-ERROR                                              12800062
128100         PERFORM 2200-PROCESS-TRIP-CSR                            12810062
128200           UNTIL PS-TRIP-FOUND                                    12820062
128300              OR PS-EOF-TRIP-CSR                                  12830062
128400              OR PS-ERROR                                         12840062
128500     END-IF.                                                      12850062
128600                                                                  12860062
128700     IF  PS-NO-ERROR                                              12870062
128800         PERFORM 2130-CLOSE-TRIP-CSR                              12880062
128900     END-IF.                                                      12890062
129000                                                                  12900062
129100*-----------------------------------------------------------------12910062
129200* OPEN OUTBOUND TRIP CURSOR                                       12920062
129300*-----------------------------------------------------------------12930062
129400 2110-OPEN-TRIP-CSR.                                              12940062
129500     MOVE ' 2110-OPEN-TRIP-CSR' TO PV-PARA                        12950062
129600                                                                  12960062
129700                                                                  12970062
129800     EXEC SQL                                                     12980062
129900          OPEN OTBND_TRIP_CSR                                     12990062
130000     END-EXEC.                                                    13000062
130100                                                                  13010062
130200     EVALUATE TRUE                                                13020062
130300         WHEN SQLCODE = ZERO                                      13030062
130400             SET PS-NOT-EOF-TRIP-CSR TO TRUE                      13040062
130500                                                                  13050062
130600         WHEN SQLCODE = -904                                      13060062
130700         WHEN SQLCODE = -911                                      13070062
130800         WHEN SQLCODE = -913                                      13080062
130900              SET PS-ERROR                                        13090062
131000                  PC046-ERROR           TO TRUE                   13100062
131100              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  13110062
131200              MOVE  DK-OPER-UNT-ID      TO  PV-DISPLAY-OPER-UNT   13120062
131300              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    13130062
131400                                            PV-SQL-RETURN-CD      13140062
131500              STRING  ' PCKUT713-2110-'                           13150062
131600                      PV-DISPLAY-CARTON-ID                        13160062
131700                      ' SQLCODE-'                                 13170062
131800                      PV-DISPLAY-SQLCODE                          13180062
131900                      ' OPER-'                                    13190062
132000                      PV-DISPLAY-OPER-UNT                         13200062
132100                      ' DOOR-'                                    13210062
132200                      DK-DOOR-ID                                  13220062
132300                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     13230062
132400                                      INTO PC046-CRA-RET-MSG      13240062
132500             MOVE '2110-'               TO PC046-CRA-REQ-ID       13250062
132600             PERFORM 9998-RETURN                                  13260062
132700                                                                  13270062
132800         WHEN SQLWARN0 NOT = SPACES                               13280062
132900         WHEN SQLCODE < ZERO                                      13290062
133000         WHEN SQLCODE > ZERO                                      13300062
133100              SET PS-ERROR                                        13310062
133200                  PC046-INVALID-SQL     TO TRUE                   13320062
133300              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  13330062
133400              MOVE  DK-OPER-UNT-ID      TO  PV-DISPLAY-OPER-UNT   13340062
133500              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    13350062
133600                                            PV-SQL-RETURN-CD      13360062
133700              STRING  ' PCKUT713-2110-'                           13370062
133800                      PV-DISPLAY-CARTON-ID                        13380062
133900                      ' SQLCODE-'                                 13390062
134000                      PV-DISPLAY-SQLCODE                          13400062
134100                      ' OPER-'                                    13410062
134200                      PV-DISPLAY-OPER-UNT                         13420062
134300                      ' DOOR-'                                    13430062
134400                      DK-DOOR-ID                                  13440062
134500                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     13450062
134600                                      INTO PC046-CRA-RET-MSG      13460062
134700             MOVE '2110-'             TO PC046-CRA-REQ-ID         13470062
134800             PERFORM 9998-RETURN                                  13480062
134900                                                                  13490062
135000     END-EVALUATE.                                                13500062
135100                                                                  13510062
135200                                                                  13520062
135300*-----------------------------------------------------------------13530062
135400* FETCH OUTBOUND TRIP CURSOR                                      13540062
135500*-----------------------------------------------------------------13550062
135600 2120-FETCH-TRIP-CSR.                                             13560062
135700     MOVE ' 2120-FETCH-TRIP-CSR' TO PV-PARA                       13570062
135800                                                                  13580062
135900                                                                  13590062
136000     EXEC SQL                                                     13600062
136100          FETCH OTBND_TRIP_CSR                                    13610062
136200           INTO   :SUOBTS-OTBND-TRIP-ID                           13620062
136300                , :SUOBTS-OTBND-STAT-TMST                         13630062
136400                , :SUOBTS-TRIP-STAT-CDE                           13640062
136500                , :SUOBTS-STAT-OPER-UNT-ID                        13650062
136600     END-EXEC.                                                    13660062
136700                                                                  13670062
136800     EVALUATE TRUE                                                13680062
136900         WHEN SQLCODE = ZERO                                      13690062
137000              MOVE SUOBTS-OTBND-TRIP-ID TO DK-OTBND-TRIP-ID       13700062
137100                                                                  13710062
137200         WHEN SQLCODE = +100                                      13720062
137300              SET PS-EOF-TRIP-CSR     TO TRUE                     13730062
137400                                                                  13740062
137500         WHEN SQLCODE = -904                                      13750062
137600         WHEN SQLCODE = -911                                      13760062
137700         WHEN SQLCODE = -913                                      13770062
137800              SET   PS-ERROR                                      13780062
137900                    PC046-DATABASE-BUSY TO TRUE                   13790062
138000              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  13800062
138100              MOVE  DK-OPER-UNT-ID      TO  PV-DISPLAY-OPER-UNT   13810062
138200              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    13820062
138300                                            PV-SQL-RETURN-CD      13830062
138400              STRING  ' PCKUT713-2120-'                           13840062
138500                      PV-DISPLAY-CARTON-ID                        13850062
138600                      ' SQLCODE-'                                 13860062
138700                      PV-DISPLAY-SQLCODE                          13870062
138800                      ' OPER-'                                    13880062
138900                      PV-DISPLAY-OPER-UNT                         13890062
139000                      ' DOOR-'                                    13900062
139100                      DK-DOOR-ID                                  13910062
139200                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     13920062
139300                                      INTO PC046-CRA-RET-MSG      13930062
139400             MOVE '2120-'               TO PC046-CRA-REQ-ID       13940062
139500             PERFORM 9998-RETURN                                  13950062
139600                                                                  13960062
139700                                                                  13970062
139800         WHEN SQLWARN0 NOT = SPACES                               13980062
139900         WHEN SQLCODE < ZERO                                      13990062
140000         WHEN SQLCODE > ZERO                                      14000062
140100              SET PS-ERROR                                        14010062
140200                  PC046-INVALID-SQL     TO TRUE                   14020062
140300              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  14030062
140400              MOVE  DK-OPER-UNT-ID      TO  PV-DISPLAY-OPER-UNT   14040062
140500              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    14050062
140600                                            PV-SQL-RETURN-CD      14060062
140700              STRING  ' PCKUT713-2120-'                           14070062
140800                      PV-DISPLAY-CARTON-ID                        14080062
140900                      ' SQLCODE-'                                 14090062
141000                      PV-DISPLAY-SQLCODE                          14100062
141100                      ' OPER-'                                    14110062
141200                      PV-DISPLAY-OPER-UNT                         14120062
141300                      ' DOOR-'                                    14130062
141400                      DK-DOOR-ID                                  14140062
141500                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     14150062
141600                                      INTO PC046-CRA-RET-MSG      14160062
141700                                                                  14170062
141800             MOVE '2120-'             TO PC046-CRA-REQ-ID         14180062
141900             PERFORM 9998-RETURN                                  14190062
142000                                                                  14200062
142100     END-EVALUATE.                                                14210062
142200                                                                  14220062
142300                                                                  14230062
142400*-----------------------------------------------------------------14240062
142500* CLOSE OUTBOUND TRIP CURSOR                                      14250062
142600*-----------------------------------------------------------------14260062
142700 2130-CLOSE-TRIP-CSR.                                             14270062
142800     MOVE ' 2130-CLOSE-TRIP-CSR' TO PV-PARA                       14280062
142900                                                                  14290062
143000                                                                  14300062
143100     EXEC SQL                                                     14310062
143200          CLOSE OTBND_TRIP_CSR                                    14320062
143300     END-EXEC.                                                    14330062
143400                                                                  14340062
143500     EVALUATE TRUE                                                14350062
143600         WHEN SQLCODE = ZERO                                      14360062
143700             CONTINUE                                             14370062
143800                                                                  14380062
143900         WHEN SQLCODE = -904                                      14390062
144000         WHEN SQLCODE = -911                                      14400062
144100         WHEN SQLCODE = -913                                      14410062
144200              SET PS-ERROR                                        14420062
144300                  PC046-DATABASE-BUSY   TO TRUE                   14430062
144400              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  14440062
144500              MOVE  DK-OPER-UNT-ID      TO  PV-DISPLAY-OPER-UNT   14450062
144600              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    14460062
144700                                            PV-SQL-RETURN-CD      14470062
144800              STRING  ' PCKUT713-2130-'                           14480062
144900                      PV-DISPLAY-CARTON-ID                        14490062
145000                      ' SQLCODE-'                                 14500062
145100                      PV-DISPLAY-SQLCODE                          14510062
145200                      ' OPER-'                                    14520062
145300                      PV-DISPLAY-OPER-UNT                         14530062
145400                      ' DOOR-'                                    14540062
145500                      DK-DOOR-ID                                  14550062
145600                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     14560062
145700                                      INTO PC046-CRA-RET-MSG      14570062
145800             MOVE '2130-'               TO PC046-CRA-REQ-ID       14580062
145900             PERFORM 9998-RETURN                                  14590062
146000                                                                  14600062
146100         WHEN SQLWARN0 NOT = SPACES                               14610062
146200         WHEN SQLCODE < ZERO                                      14620062
146300         WHEN SQLCODE > ZERO                                      14630062
146400              SET PS-ERROR                                        14640062
146500                  PC046-INVALID-SQL     TO TRUE                   14650062
146600              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  14660062
146700              MOVE  DK-OPER-UNT-ID      TO  PV-DISPLAY-OPER-UNT   14670062
146800              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    14680062
146900                                            PV-SQL-RETURN-CD      14690062
147000              STRING  ' PCKUT713-2130-'                           14700062
147100                      PV-DISPLAY-CARTON-ID                        14710062
147200                      ' SQLCODE-'                                 14720062
147300                      PV-DISPLAY-SQLCODE                          14730062
147400                      ' OPER-'                                    14740062
147500                      PV-DISPLAY-OPER-UNT                         14750062
147600                      ' DOOR-'                                    14760062
147700                      DK-DOOR-ID                                  14770062
147800                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     14780062
147900                                      INTO PC046-CRA-RET-MSG      14790062
148000             MOVE '2130-'             TO PC046-CRA-REQ-ID         14800062
148100             PERFORM 9998-RETURN                                  14810062
148200                                                                  14820062
148300     END-EVALUATE.                                                14830062
148400                                                                  14840062
148500                                                                  14850062
148600*-----------------------------------------------------------------14860062
148700* PROCESS OUTBOUND TRIP CURSOR                                    14870062
148800*-----------------------------------------------------------------14880062
148900 2200-PROCESS-TRIP-CSR.                                           14890062
149000     MOVE ' 2200-PROCESS-TRIP-CSR' TO PV-PARA                     14900062
149100                                                                  14910062
149200                                                                  14920062
149300     MOVE  SUOBTS-OTBND-TRIP-ID TO  DK-OTBND-TRIP-ID.             14930062
149400                                                                  14940062
149500     SET PS-CARTON-RANGE-NOT-FOUND TO TRUE.                       14950062
149600     PERFORM 2205-GET-OUTBOUND-TRIP-BEG-END.                      14960062
149700                                                                  14970062
149800     IF  PS-CARTON-RANGE-NOT-FOUND                                14980062
149900         PERFORM 2210-GET-OUTBD-TRIP-BEG-NO-END                   14990062
150000     END-IF.                                                      15000062
150100                                                                  15010062
150200     IF  PS-CARTON-RANGE-FOUND                                    15020062
150300         IF  SUCRDV-DIVERT-TMST  >=  SUCDOT-STRT-DIVERT-TMST AND  15030062
150400             SUCRDV-DIVERT-TMST  <=  SUCDOT-END-DIVERT-TMST       15040062
150500             SET  PS-TRIP-FOUND  TO  TRUE                         15050062
150600             SET  PC046-LOADED-ONTO-TRLR                          15060062
150700                  PC046-LOADED-DESC       TO TRUE                 15070062
150800             MOVE SUCDOT-END-SCN-USR-ID   TO PC046-STATUS-USERID  15080062
150900             MOVE SUCDOT-END-SCN-TMST     TO PC046-CRTN-STAT-TMST 15090062
151000             MOVE SUOBTS-OTBND-TRIP-ID    TO PC046-OTBD-TRIP-ID   15100062
151100         END-IF                                                   15110062
151200     END-IF.                                                      15120062
151300                                                                  15130062
151400*DMH                                                              15140062
151500     IF  PC046-DIVERTED-TO-TRLR  AND                              15150062
151600         PS-CARTON-RANGE-FOUND                                    15160062
151700         SET  PS-TRIP-NOT-FOUND  TO TRUE                          15170062
151800     END-IF.                                                      15180062
151900*DMH                                                              15190062
152000                                                                  15200062
152100     IF  PS-NO-ERROR  AND                                         15210062
152200         PS-TRIP-NOT-FOUND                                        15220062
152300         PERFORM 2120-FETCH-TRIP-CSR                              15230062
152400     END-IF.                                                      15240062
152500                                                                  15250062
152600*-----------------------------------------------------------------15260062
152700* SELECT OUTBOUND TRIP BEGINNING AND ENDING                       15270062
152800*-----------------------------------------------------------------15280062
152900 2205-GET-OUTBOUND-TRIP-BEG-END.                                  15290062
153000     MOVE ' 2205-GET-OUTBOUND-TRIP-BEG-END' TO PV-PARA            15300062
153100                                                                  15310062
153200     EXEC SQL                                                     15320062
153300          SELECT  STRT_DIVERT_TMST                                15330062
153400                , END_DIVERT_TMST                                 15340062
153500                , STRT_SCN_TMST                                   15350062
153600                , STRT_SCN_USR_ID                                 15360062
153700                , END_SCN_TMST                                    15370062
153800                , END_SCN_USR_ID                                  15380062
153900            INTO  :SUCDOT-STRT-DIVERT-TMST                        15390062
154000                , :SUCDOT-END-DIVERT-TMST                         15400062
154100                , :SUCDOT-STRT-SCN-TMST                           15410062
154200                , :SUCDOT-STRT-SCN-USR-ID                         15420062
154300                , :SUCDOT-END-SCN-TMST                            15430062
154400                , :SUCDOT-END-SCN-USR-ID                          15440062
154500            FROM  TSUCDOT                                         15450062
154600           WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID             15460062
154700             AND  OTBND_TRIP_ID     = :DK-OTBND-TRIP-ID           15470062
154800             AND  DOOR_ID           = :DK-DOOR-ID                 15480062
154900             AND  STRT_DIVERT_TMST <= :DK-CARTON-TMST             15490062
155000             AND  END_DIVERT_TMST  >= :DK-CARTON-TMST             15500062
155100             AND NOT                                              15510062
155200                 END_DIVERT_TMST    = :PC-DEFAULT-DATE            15520062
155300     END-EXEC.                                                    15530062
155400                                                                  15540062
155500     EVALUATE TRUE                                                15550062
155600         WHEN SQLCODE = ZERO                                      15560062
155700              SET PS-CARTON-RANGE-FOUND TO TRUE                   15570062
155800         WHEN SQLCODE = +100                                      15580062
155900              CONTINUE                                            15590062
156000         WHEN SQLCODE = -904                                      15600062
156100         WHEN SQLCODE = -911                                      15610062
156200         WHEN SQLCODE = -913                                      15620062
156300              SET PS-ERROR                                        15630062
156400                  PC046-DATABASE-BUSY   TO TRUE                   15640062
156500              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  15650062
156600              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    15660062
156700                                            PV-SQL-RETURN-CD      15670062
156800              STRING  ' PCKUT713-2205-'                           15680062
156900                      PV-DISPLAY-CARTON-ID                        15690062
157000                      ' SQLCODE-'                                 15700062
157100                      PV-DISPLAY-SQLCODE                          15710062
157200                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     15720062
157300                                      INTO PC046-CRA-RET-MSG      15730062
157400                                                                  15740062
157500             MOVE '2205-'               TO PC046-CRA-REQ-ID       15750062
157600             PERFORM 9998-RETURN                                  15760062
157700                                                                  15770062
157800         WHEN SQLWARN0 NOT = SPACES                               15780062
157900         WHEN SQLCODE NOT EQUAL ZERO                              15790062
158000              SET PS-ERROR                                        15800062
158100                  PC046-INVALID-SQL     TO TRUE                   15810062
158200              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  15820062
158300              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    15830062
158400                                            PV-SQL-RETURN-CD      15840062
158500              STRING  ' PCKUT713-2205-'                           15850062
158600                      PV-DISPLAY-CARTON-ID                        15860062
158700                      ' SQLCODE-'                                 15870062
158800                      PV-DISPLAY-SQLCODE                          15880062
158900                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     15890062
159000                                      INTO PC046-CRA-RET-MSG      15900062
159100                                                                  15910062
159200             MOVE '2205-'                TO PC046-CRA-REQ-ID      15920062
159300             PERFORM 9998-RETURN                                  15930062
159400                                                                  15940062
159500     END-EVALUATE.                                                15950062
159600*                                                                 15960062
159700                                                                  15970062
159800                                                                  15980062
159900*-----------------------------------------------------------------15990062
160000* SELECT OUTBOUND TRIP BEGINNING AND ENDING IF NO END             16000062
160100*-----------------------------------------------------------------16010062
160200 2210-GET-OUTBD-TRIP-BEG-NO-END.                                  16020062
160300     MOVE ' 2210-GET-OUTBD-TRIP-BEG-NO-END' TO PV-PARA            16030062
160400                                                                  16040062
160500     EXEC SQL                                                     16050062
160600          SELECT  STRT_DIVERT_TMST                                16060062
160700                , END_DIVERT_TMST                                 16070062
160800                , STRT_SCN_TMST                                   16080062
160900                , STRT_SCN_USR_ID                                 16090062
161000                , STRT_SCN_TMST                                   16100062
161100                , STRT_SCN_USR_ID                                 16110062
161200            INTO  :SUCDOT-STRT-DIVERT-TMST                        16120062
161300                , :SUCDOT-END-DIVERT-TMST                         16130062
161400                , :SUCDOT-STRT-SCN-TMST                           16140062
161500                , :SUCDOT-STRT-SCN-USR-ID                         16150062
161600                , :SUCDOT-END-SCN-TMST                            16160062
161700                , :SUCDOT-END-SCN-USR-ID                          16170062
161800            FROM  TSUCDOT                                         16180062
161900           WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID             16190062
162000             AND  OTBND_TRIP_ID     = :DK-OTBND-TRIP-ID           16200062
162100             AND  DOOR_ID           = :DK-DOOR-ID                 16210062
162200             AND  STRT_DIVERT_TMST  = :DK-CARTON-TMST             16220062
162300             AND  END_DIVERT_TMST   = :PC-DEFAULT-DATE            16230062
162400     END-EXEC.                                                    16240062
162500                                                                  16250062
162600     EVALUATE TRUE                                                16260062
162700         WHEN SQLCODE = ZERO                                      16270062
162800              SET PS-CARTON-RANGE-FOUND TO TRUE                   16280062
162900         WHEN SQLCODE = +100                                      16290062
163000              CONTINUE                                            16300062
163100         WHEN SQLCODE = -904                                      16310062
163200         WHEN SQLCODE = -911                                      16320062
163300         WHEN SQLCODE = -913                                      16330062
163400              SET PS-ERROR                                        16340062
163500                  PC046-DATABASE-BUSY    TO TRUE                  16350062
163600              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  16360062
163700              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    16370062
163800                                            PV-SQL-RETURN-CD      16380062
163900              STRING  ' PCKUT713-2210-'                           16390062
164000                      PV-DISPLAY-CARTON-ID                        16400062
164100                      ' SQLCODE-'                                 16410062
164200                      PV-DISPLAY-SQLCODE                          16420062
164300                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     16430062
164400                                      INTO PC046-CRA-RET-MSG      16440062
164500             MOVE '2210-'               TO PC046-CRA-REQ-ID       16450062
164600             PERFORM 9998-RETURN                                  16460062
164700                                                                  16470062
164800         WHEN SQLWARN0 NOT = SPACES                               16480062
164900         WHEN SQLCODE NOT EQUAL ZERO                              16490062
165000             SET PS-ERROR                                         16500062
165100                 PC046-INVALID-SQL      TO TRUE                   16510062
165200              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  16520062
165300              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    16530062
165400                                            PV-SQL-RETURN-CD      16540062
165500              STRING  ' PCKUT713-2210-'                           16550062
165600                      PV-DISPLAY-CARTON-ID                        16560062
165700                      ' SQLCODE-'                                 16570062
165800                      PV-DISPLAY-SQLCODE                          16580062
165900                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     16590062
166000                                      INTO PC046-CRA-RET-MSG      16600062
166100                                                                  16610062
166200             MOVE '2210-'                TO PC046-CRA-REQ-ID      16620062
166300             PERFORM 9998-RETURN                                  16630062
166400                                                                  16640062
166500     END-EVALUATE.                                                16650062
166600*                                                                 16660062
166700                                                                  16670062
166800                                                                  16680062
166900*-----------------------------------------------------------------16690062
167000*  FINAL CHECK FOR CARTON ACTIVITY - PROCESS AREA                 16700062
167100*-----------------------------------------------------------------16710062
167200 3000-CHECK-PROCESS-AREA.                                         16720062
167300     MOVE ' 3000-CHECK-PROCESS-AREA' TO PV-PARA                   16730062
167400                                                                  16740062
167500     EXEC SQL                                                     16750062
167600          SELECT                                                  16760062
167700                                                                  16770062
167800             TIMESTAMP                                            16780062
167900             (                                                    16790062
168000             CHAR(CRE_DTE) || '-' || CHAR(CRE_TM) || '.000000'    16800062
168100             )                                                    16810062
168200                                                                  16820062
168300            ,  ACTV_IND                                           16830062
168400                                                                  16840062
168500            INTO                                                  16850062
168600                                                                  16860062
168700                 :PC046-CRTN-STAT-TMST                            16870062
168800                ,:SUT00024-ACTV-IND                               16880062
168900            FROM  SUT_OTBND_CART                                  16890062
169000           WHERE  SHIPT_UNT_ID  = :DK-CARTON-ID                   16900062
169100             AND  ACTV_IND      = 'Y'                             16910062
169200     END-EXEC.                                                    16920062
169300                                                                  16930062
169400     EVALUATE TRUE                                                16940062
169500         WHEN SQLCODE = ZERO                                      16950062
169600              PERFORM 3100-SET-STATUS                             16960062
169700                                                                  16970062
169800         WHEN SQLCODE = +100                                      16980062
169900             PERFORM 3100-SET-STATUS                              16990062
170000                                                                  17000062
170100         WHEN SQLCODE = -904                                      17010062
170200         WHEN SQLCODE = -911                                      17020062
170300         WHEN SQLCODE = -913                                      17030062
170400              SET PS-ERROR                                        17040062
170500                  PC046-DATABASE-BUSY    TO TRUE                  17050062
170600              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  17060062
170700              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    17070062
170800                                            PV-SQL-RETURN-CD      17080062
170900              STRING  ' PCKUT713-3000-'                           17090062
171000                      PV-DISPLAY-CARTON-ID                        17100062
171100                      ' SQLCODE-'                                 17110062
171200                      PV-DISPLAY-SQLCODE                          17120062
171300                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     17130062
171400                                      INTO PC046-CRA-RET-MSG      17140062
171500                                                                  17150062
171600             MOVE '3000-'               TO PC046-CRA-REQ-ID       17160062
171700             PERFORM 9998-RETURN                                  17170062
171800                                                                  17180062
171900         WHEN SQLWARN0 NOT = SPACES                               17190062
172000         WHEN SQLCODE NOT EQUAL ZERO                              17200062
172100              SET PS-ERROR                                        17210062
172200                  PC046-INVALID-SQL      TO TRUE                  17220062
172300              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  17230062
172400              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    17240062
172500                                            PV-SQL-RETURN-CD      17250062
172600              STRING  ' PCKUT713-3000-'                           17260062
172700                      PV-DISPLAY-CARTON-ID                        17270062
172800                      '  CALLED BY-'                              17280062
172900                      PC046-CALLING-PGM-NME                       17290062
173000                      '  SQLCODE='                                17300062
173100                      PV-DISPLAY-SQLCODE                          17310062
173200                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     17320062
173300                                      INTO PC046-CRA-RET-MSG      17330062
173400             MOVE '3000-'                TO PC046-CRA-REQ-ID      17340062
173500             PERFORM 9998-RETURN                                  17350062
173600                                                                  17360062
173700     END-EVALUATE.                                                17370062
173800                                                                  17380062
173900                                                                  17390062
174000*-----------------------------------------------------------------17400062
174100* IF THE CARTON IS ACTIVE, SEE IF CARTON HAS BEEN PROCESSED       17410062
174200* FURTHER.                                                        17420062
174300*-----------------------------------------------------------------17430062
174400 3100-SET-STATUS.                                                 17440062
174500     MOVE ' 3100-SET-STATUS' TO PV-PARA                           17450062
174600                                                                  17460062
174700     EVALUATE TRUE                                                17470062
174800         WHEN PV-SRC-ASN                                          17480062
174900              SET PC046-CRE-BY-ASN         TO TRUE                17490062
175000              IF PS-FOUND-ON-TSULBXF                              17500062
175100                  SET PC046-CK-IN-DESC     TO TRUE                17510062
175200              ELSE                                                17520062
175300                  SET PC046-ASN-DESC       TO TRUE                17530062
175400              END-IF                                              17540062
175500         WHEN PV-SRC-CHECK-IN                                     17550062
175600              SET PC046-CHECKED-IN                                17560062
175700                  PC046-CK-IN-DESC         TO TRUE                17570062
175800         WHEN PV-SRC-CSEPK-SPLT                                   17580062
175900              SET PC046-CASEPACK-SPLIT                            17590062
176000                  PC046-CSEPK-DESC         TO TRUE                17600062
176100         WHEN PV-SRC-P2L                                          17610062
176200              SET PC046-ROUTED-FROM-P2L                           17620062
176300                  PC046-P2L-DESC           TO TRUE                17630062
176400         WHEN PV-SRC-RECEIVING                                    17640062
176500              SET PC046-CRE-BY-RECV                               17650062
176600                  PC046-RECV-DESC          TO TRUE                17660062
176700         WHEN PV-SRC-RDM                                          17670062
176800              SET PC046-CRE-BY-RDM                                17680062
176900                  PC046-RDM-DESC           TO TRUE                17690062
177000         WHEN PV-SRC-SMOOTHING                                    17700062
177100              SET PC046-CRE-BY-SMOOTHING                          17710062
177200                  PC046-SMTH-DESC          TO TRUE                17720062
177300         WHEN PV-SRC-FAST-XFER                                    17730062
177400              SET PC046-CRE-BY-FAST-XFER                          17740062
177500                  PC046-XFER-DESC          TO TRUE                17750062
177600         WHEN PV-SRC-MSTR-CNTR                                    17760062
177700              SET PC046-CRE-BY-MSTR-CNTR                          17770062
177800                  PC046-MSTR-DESC          TO TRUE                17780062
177900         WHEN PV-SRC-CRTN-BULD                                    17790062
178000              SET PC046-CRE-BY-CRTN-BULD                          17800062
178100                  PC046-BLD-DESC           TO TRUE                17810062
178200         WHEN PV-SRC-JWL                                          17820062
178300              SET PC046-ROUTED-FROM-JWL                           17830062
178400                  PC046-JWL-DESC           TO TRUE                17840062
178500         WHEN PV-SRC-DMG                                          17850062
178600              SET PC046-ROUTED-FROM-DMG                           17860062
178700                  PC046-DMG-DESC           TO TRUE                17870062
178800         WHEN PV-SRC-3WD                                          17880062
178810              SET PC046-CRE-BY-3WD                                17881062
178820                  PC046-3WD-DESC           TO TRUE                17882062
178830         WHEN OTHER                                               17883062
178840              MOVE SPACES TO PC046-CRTN-STATUS                    17884062
178850     END-EVALUATE.                                                17885062
178860                                                                  17886062
178870                                                                  17887062
178880*-----------------------------------------------------------------17888062
178890*  IF CARTON HAS BEEN LOADED ON TRAILER - GET TRIP INFORMATION    17889062
178900*-----------------------------------------------------------------17890062
179000 3500-GET-TRIP-INFO.                                              17900062
179100     MOVE ' 3500-GET-TRIP-INFO' TO PV-PARA                        17910062
179200                                                                  17920062
179300     PERFORM 3510-SCAC-TRLR-INFO.                                 17930062
179400                                                                  17940062
179500     IF  PS-NO-ERROR                                              17950062
179600         PERFORM 3520-TRIP-STATUS-INFO                            17960062
179700     END-IF.                                                      17970062
179800                                                                  17980062
179900*-----------------------------------------------------------------17990062
180000*  IF CARTON HAS BEEN LOADED ON TRAILER - GET TRIP INFORMATION    18000062
180100*-----------------------------------------------------------------18010062
180200 3510-SCAC-TRLR-INFO.                                             18020062
180300     MOVE ' 3510-SCAC-TRLR-INFO' TO PV-PARA                       18030062
180400                                                                  18040062
180500                                                                  18050062
180600     MOVE  PC046-OTBD-TRIP-ID  TO  DK-OTBND-TRIP-ID.              18060062
180700                                                                  18070062
180800     EXEC SQL                                                     18080062
180900          SELECT  A.TRLR_SRL_NBR                                  18090062
181000                , A.DOOR_TYP_CDE                                  18100062
181100                , B.TRLR_ID                                       18110062
181200                , B.SCAC_CDE                                      18120062
181300            INTO  :SUOBTR-TRLR-SRL-NBR                            18130062
181400                , :SUOBTR-DOOR-TYP-CDE                            18140062
181500                , :CNTRID-TRLR-ID                                 18150062
181600                , :CNTRID-SCAC-CDE                                18160062
181700            FROM  TSUOBTR A                                       18170062
181800                , TCNTRID B                                       18180062
181900           WHERE  A.OTBND_TRIP_ID  =  :DK-OTBND-TRIP-ID           18190062
182000             AND  A.TRLR_SRL_NBR   =  B.TRLR_SRL_NBR              18200062
182100     END-EXEC.                                                    18210062
182200                                                                  18220062
182300     EVALUATE TRUE                                                18230062
182400         WHEN SQLCODE = +0                                        18240062
182500              MOVE  SUOBTR-TRLR-SRL-NBR  TO  PC046-TRLR-SRL       18250062
182600              MOVE  SUOBTR-DOOR-TYP-CDE  TO  PC046-DOOR-TYP-CDE   18260062
182700              MOVE  CNTRID-TRLR-ID       TO  PC046-TRLR-ID        18270062
182800              MOVE  CNTRID-SCAC-CDE      TO  PC046-SCAC           18280062
182900                                                                  18290062
183000         WHEN SQLCODE = +100                                      18300062
183100              MOVE  ZEROES               TO  PC046-TRLR-SRL       18310062
183200                                             PC046-TRLR-ID        18320062
183300              MOVE  SPACES               TO  PC046-DOOR-TYP-CDE   18330062
183400              MOVE  'UNKN'               TO  PC046-SCAC           18340062
183500                                                                  18350062
183600              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  18360062
183700              MOVE  DK-OTBND-TRIP-ID    TO  DK-DISPLAY-TRIP       18370062
183800              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    18380062
183900                                            PV-SQL-RETURN-CD      18390062
184000              STRING  ' PCKUT713-3510-'                           18400062
184100                      PV-DISPLAY-CARTON-ID                        18410062
184200                      ' SQLCODE-'                                 18420062
184300                      PV-DISPLAY-SQLCODE                          18430062
184400                      ' TRIP-'                                    18440062
184500                      DK-DISPLAY-TRIP                             18450062
184600                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     18460062
184700                                      INTO PC046-CRA-RET-MSG      18470062
184800                                                                  18480062
184900         WHEN SQLCODE = -904                                      18490062
185000         WHEN SQLCODE = -911                                      18500062
185100         WHEN SQLCODE = -913                                      18510062
185200              SET PS-ERROR                                        18520062
185300                  PC046-DATABASE-BUSY   TO TRUE                   18530062
185400              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  18540062
185500              MOVE  DK-OTBND-TRIP-ID    TO  DK-DISPLAY-TRIP       18550062
185600              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    18560062
185700                                            PV-SQL-RETURN-CD      18570062
185800              STRING  ' PCKUT713-3510-'                           18580062
185900                      PV-DISPLAY-CARTON-ID                        18590062
186000                      ' SQLCODE-'                                 18600062
186100                      PV-DISPLAY-SQLCODE                          18610062
186200                      ' TRIP-'                                    18620062
186300                      DK-DISPLAY-TRIP                             18630062
186400                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     18640062
186500                                      INTO PC046-CRA-RET-MSG      18650062
186600             MOVE '3510-'               TO PC046-CRA-REQ-ID       18660062
186700             PERFORM 9998-RETURN                                  18670062
186800                                                                  18680062
186900         WHEN SQLWARN0 NOT = SPACES                               18690062
187000         WHEN SQLCODE < +0                                        18700062
187100         WHEN SQLCODE > +0                                        18710062
187200              SET PS-ERROR                                        18720062
187300                  PC046-INVALID-SQL     TO TRUE                   18730062
187400              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  18740062
187500              MOVE  DK-OTBND-TRIP-ID    TO  DK-DISPLAY-TRIP       18750062
187600              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    18760062
187700                                            PV-SQL-RETURN-CD      18770062
187800              STRING  ' PCKUT713-3510-'                           18780062
187900                      PV-DISPLAY-CARTON-ID                        18790062
188000                      '  CALLED BY-'                              18800062
188100                      PC046-CALLING-PGM-NME                       18810062
188200                      '  SQLCODE='                                18820062
188300                      PV-DISPLAY-SQLCODE                          18830062
188400                      ' TRIP-'                                    18840062
188500                      DK-DISPLAY-TRIP                             18850062
188600                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     18860062
188700                                      INTO PC046-CRA-RET-MSG      18870062
188800             MOVE '3510-'                TO PC046-CRA-REQ-ID      18880062
188900             PERFORM 9998-RETURN                                  18890062
189000                                                                  18900062
189100     END-EVALUATE.                                                18910062
189200                                                                  18920062
189300*-----------------------------------------------------------------18930062
189400*  GET TRIP STATUS                                                18940062
189500*-----------------------------------------------------------------18950062
189600 3520-TRIP-STATUS-INFO.                                           18960062
189700     MOVE ' 3520-TRIP-STATUS-INFO' TO PV-PARA                     18970062
189800                                                                  18980062
189900                                                                  18990062
190000     MOVE  PC046-OTBD-TRIP-ID  TO  DK-OTBND-TRIP-ID.              19000062
190100                                                                  19010062
190200     EXEC SQL                                                     19020062
190300          SELECT  A.TRIP_STAT_CDE                                 19030062
190400                 ,A.OTBND_STAT_TMST                               19040062
190500            INTO  :SUOBTS-TRIP-STAT-CDE                           19050062
190600                 ,:SUOBTS-OTBND-STAT-TMST                         19060062
190700            FROM  TSUOBTS A                                       19070062
190800           WHERE  A.OTBND_TRIP_ID  =  :DK-OTBND-TRIP-ID           19080062
190900             AND  A.OTBND_STAT_TMST =                             19090062
191000                  (SELECT  MAX(B.OTBND_STAT_TMST)                 19100062
191100                     FROM  TSUOBTS B                              19110062
191200                    WHERE  B.OTBND_TRIP_ID  =  :DK-OTBND-TRIP-ID) 19120062
191300     END-EXEC.                                                    19130062
191400                                                                  19140062
191500     EVALUATE TRUE                                                19150062
191600         WHEN SQLCODE = +0                                        19160062
191700              MOVE SUOBTS-TRIP-STAT-CDE   TO PC046-TRIP-STATUS    19170062
191800              MOVE SUOBTS-OTBND-STAT-TMST TO PC046-TRIP-STAT-TMST 19180062
191900                                                                  19190062
192000         WHEN SQLCODE = +100                                      19200062
192100              MOVE SPACES                 TO PC046-TRIP-STATUS    19210062
192200                                             PC046-TRIP-STAT-TMST 19220062
192300                                                                  19230062
192400              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  19240062
192500              MOVE  DK-OTBND-TRIP-ID    TO  DK-DISPLAY-TRIP       19250062
192600              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    19260062
192700                                            PV-SQL-RETURN-CD      19270062
192800              STRING  ' PCKUT713-3520-'                           19280062
192900                      PV-DISPLAY-CARTON-ID                        19290062
193000                      ' SQLCODE-'                                 19300062
193100                      PV-DISPLAY-SQLCODE                          19310062
193200                      ' TRIP-'                                    19320062
193300                      DK-DISPLAY-TRIP                             19330062
193400                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     19340062
193500                                      INTO PC046-CRA-RET-MSG      19350062
193600                                                                  19360062
193700         WHEN SQLCODE = -904                                      19370062
193800         WHEN SQLCODE = -911                                      19380062
193900         WHEN SQLCODE = -913                                      19390062
194000              SET   PS-ERROR                                      19400062
194100                    PC046-DATABASE-BUSY TO  TRUE                  19410062
194200              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  19420062
194300              MOVE  DK-OTBND-TRIP-ID    TO  DK-DISPLAY-TRIP       19430062
194400              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    19440062
194500                                            PV-SQL-RETURN-CD      19450062
194600              STRING  ' PCKUT713-3520-'                           19460062
194700                      PV-DISPLAY-CARTON-ID                        19470062
194800                      ' SQLCODE-'                                 19480062
194900                      PV-DISPLAY-SQLCODE                          19490062
195000                      ' TRIP-'                                    19500062
195100                      DK-DISPLAY-TRIP                             19510062
195200                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     19520062
195300                                      INTO PC046-CRA-RET-MSG      19530062
195400                                                                  19540062
195500             MOVE '3520-'               TO PC046-CRA-REQ-ID       19550062
195600             PERFORM 9998-RETURN                                  19560062
195700                                                                  19570062
195800         WHEN SQLWARN0 NOT = SPACES                               19580062
195900         WHEN SQLCODE < +0                                        19590062
196000         WHEN SQLCODE > +0                                        19600062
196100              SET PS-ERROR                                        19610062
196200                  PC046-INVALID-SQL     TO TRUE                   19620062
196300              MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID  19630062
196400              MOVE  SQLCODE             TO  PV-DISPLAY-SQLCODE    19640062
196500                                            PV-SQL-RETURN-CD      19650062
196600              STRING  ' PCKUT713-3520-'                           19660062
196700                      PV-DISPLAY-CARTON-ID                        19670062
196800                      '  CALLED BY-'                              19680062
196900                      PC046-CALLING-PGM-NME                       19690062
197000                      '  SQLCODE='                                19700062
197100                      PV-DISPLAY-SQLCODE                          19710062
197200                      ' TASK= ' PV-EIBTASKN DELIMITED BY SIZE     19720062
197300                                      INTO PC046-CRA-RET-MSG      19730062
197400             MOVE '3520-'                TO PC046-CRA-REQ-ID      19740062
197500             PERFORM 9998-RETURN                                  19750062
197600                                                                  19760062
197700     END-EVALUATE.                                                19770062
197800                                                                  19780062
197900*-----------------------------------------------------------------19790062
198000 4000-DETERMIN-NBR-UNITS.                                         19800062
198100*-----------------------------------------------------------------19810062
198200     MOVE ' 4000-DETERMIN-NBR-UNITS' TO PV-PARA                   19820062
198300                                                                  19830062
198400     EXEC SQL                                                     19840062
198500         SELECT SUM(SHPD_UNT_QTY)                                 19850062
198600          INTO :PV-LINE-SHPD-UNITS                                19860062
198700          FROM SUT_OTBND_UPC                                      19870062
198800         WHERE SHIPT_UNT_ID     =  :DK-CARTON-ID                  19880062
198900     END-EXEC                                                     19890062
199000                                                                  19900062
199100     EVALUATE TRUE                                                19910062
199200         WHEN SQLCODE = +0                                        19920062
199300             MOVE PV-LINE-SHPD-UNITS TO  PC046-NBR-UNITS          19930062
199400         WHEN SQLCODE < +0                                        19940062
199500         WHEN SQLCODE > +0                                        19950062
199600             MOVE ZEROES             TO  PC046-NBR-UNITS          19960062
199700     END-EVALUATE.                                                19970062
199800                                                                  19980062
199900*-----------------------------------------------------------------19990062
200000 4100-DETERMIN-NBR-UNITS-P2L.                                     20000062
200100*-----------------------------------------------------------------20010062
200200     MOVE ' 4100-DETERMIN-NBR-UNITS-P2L' TO PV-PARA               20020062
200300                                                                  20030062
200400     EXEC SQL                                                     20040062
200500         SELECT SUM(SHPD_QTY)                                     20050062
200600          INTO :PV-LINE-SHPD-UNITS                                20060062
200700          FROM TSHUUPC                                            20070062
200800         WHERE SHIPT_UNT_ID     =  :DK-CARTON-ID                  20080062
200900     END-EXEC                                                     20090062
201000                                                                  20100062
201100     EVALUATE TRUE                                                20110062
201200         WHEN SQLCODE = +0                                        20120062
201300             MOVE PV-LINE-SHPD-UNITS TO  PC046-NBR-UNITS          20130062
201400         WHEN SQLCODE < +0                                        20140062
201500         WHEN SQLCODE > +0                                        20150062
201600             MOVE ZEROES             TO  PC046-NBR-UNITS          20160062
201700     END-EVALUATE.                                                20170062
201800                                                                  20180062
201900*-----------------------------------------------------------------20190062
202000 5000-DETERMIN-PO-RCVR.                                           20200062
202100*-----------------------------------------------------------------20210062
202200     MOVE ' 5000-DETERMIN-PO-RCVR' TO PV-PARA                     20220062
202300                                                                  20230062
202400     MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID           20240062
202500     STRING ' CARTON = ' PV-DISPLAY-CARTON-ID DELIMITED BY SIZE   20250062
202600                  INTO PV-PARA                                    20260062
202700                                                                  20270062
202800                                                                  20280062
202900     EXEC SQL                                                     20290062
203000         SELECT DISTINCT(TRN_NBR)                                 20300062
203100               ,RCVR_SEQ_NBR                                      20310062
203200          INTO :SUT00028-TRN-NBR                                  20320062
203300              ,:SUT00028-RCVR-SEQ-NBR                             20330062
203400          FROM SUT_OTBND_UPC                                      20340062
203500         WHERE SHIPT_UNT_ID     =  :DK-CARTON-ID                  20350062
203600           AND SHPD_UNT_QTY     >  0                              20360062
203700     END-EXEC                                                     20370062
203800                                                                  20380062
203900     EVALUATE TRUE                                                20390062
204000         WHEN SQLCODE = +0                                        20400062
204100             MOVE SUT00028-TRN-NBR   TO  PC046-PO-NBR             20410062
204200                                         PC046-TRN-NBR            20420062
204300                                         DK-PO-TRN-NBR            20430062
204400             IF  SUT00028-RCVR-SEQ-NBR = ZERO                     20440062
204500                 PERFORM 6000-TRY-TPKSLIP                         20450062
204600             ELSE                                                 20460062
204700                 MOVE SUT00028-RCVR-SEQ-NBR TO DK-PO-RCVR-NBR-N   20470062
204800                 MOVE DK-RCVR-NBR-X       TO DK-RCVR-NBR-9        20480062
204900                 MOVE DK-RCVR-NBR-3       TO PC046-RCVR-NBR       20490062
205000             END-IF                                               20500062
205100         WHEN SQLCODE = -811                                      20510062
205200             MOVE 'MULTIPLE'         TO  PC046-MULT-PO            20520062
205300         WHEN SQLCODE = +100                                      20530062
205400             PERFORM 5500-TRY-TSHUUPC-AGAIN                       20540062
205500         WHEN SQLCODE < +0                                        20550062
205600         WHEN SQLCODE > +0                                        20560062
205700             MOVE ZEROES             TO  PC046-PO-NBR             20570062
205800     END-EVALUATE.                                                20580062
205900                                                                  20590062
206000*-----------------------------------------------------------------20600062
206100 5100-DETERMIN-PO-RCVR-P2L.                                       20610062
206200*-----------------------------------------------------------------20620062
206300*    MOVE ' 5100-DETERMIN-PO-RCVR-P2L' TO PV-PARA                 20630062
206400                                                                  20640062
206500*    MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID           20650062
206600*    STRING ' CARTON = ' PV-DISPLAY-CARTON-ID DELIMITED BY SIZE   20660062
206700*                 INTO PV-PARA                                    20670062
206800                                                                  20680062
206900                                                                  20690062
207000     EXEC SQL                                                     20700062
207100         SELECT DISTINCT(TRN_NBR)                                 20710062
207200               ,RCVR_SEQ_NBR                                      20720062
207300          INTO :SHUUPC-TRN-NBR                                    20730062
207400              ,:SHUUPC-RCVR-SEQ-NBR                               20740062
207500          FROM TSHUUPC                                            20750062
207600         WHERE SHIPT_UNT_ID     =  :DK-CARTON-ID                  20760062
207700           AND SHPD_QTY         >  0                              20770062
207800     END-EXEC                                                     20780062
207900                                                                  20790062
208000     EVALUATE TRUE                                                20800062
208100         WHEN SQLCODE = +0                                        20810062
208200             MOVE SHUUPC-TRN-NBR   TO  PC046-PO-NBR               20820062
208300                                        PC046-TRN-NBR             20830062
208400                                        DK-PO-TRN-NBR             20840062
208500             IF  SHUUPC-RCVR-SEQ-NBR = ZERO                       20850062
208600                 PERFORM 6100-TRY-TPKSLIP-P2L                     20860062
208700             ELSE                                                 20870062
208800                 MOVE SHUUPC-RCVR-SEQ-NBR TO DK-PO-RCVR-NBR-N     20880062
208900                 MOVE DK-RCVR-NBR-X       TO DK-RCVR-NBR-9        20890062
209000                 MOVE DK-RCVR-NBR-3       TO PC046-RCVR-NBR       20900062
209100             END-IF                                               20910062
209200         WHEN SQLCODE = -811                                      20920062
209300             MOVE 'MULTIPLE'         TO  PC046-MULT-PO            20930062
209400         WHEN SQLCODE = +100                                      20940062
209500             MOVE ZEROES             TO  DK-PO-RCVR-NBR-N         20950062
209600             MOVE DK-RCVR-NBR-X      TO  DK-RCVR-NBR-9            20960062
209700             MOVE DK-RCVR-NBR-3      TO  PC046-RCVR-NBR           20970062
209800         WHEN SQLCODE < +0                                        20980062
209900         WHEN SQLCODE > +0                                        20990062
210000             MOVE ZEROES             TO  PC046-PO-NBR             21000062
210100     END-EVALUATE.                                                21010062
210200                                                                  21020062
210300*-----------------------------------------------------------------21030062
210400 5500-TRY-TSHUUPC-AGAIN.                                          21040062
210500*-----------------------------------------------------------------21050062
210600*    MOVE ' 5500-TRY-TSHUUPC-AGAIN' TO PV-PARA                    21060062
210700                                                                  21070062
210800                                                                  21080062
210900     MOVE PC046-VENDOR-SHIPT-UNT-ID  TO DK-CARTON-ID.             21090062
211000                                                                  21100062
211100*    MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID           21110062
211200*    STRING ' CARTON = ' PV-DISPLAY-CARTON-ID  DELIMITED BY SIZE  21120062
211300*                 INTO PV-PARA                                    21130062
211400                                                                  21140062
211500                                                                  21150062
211600     EXEC SQL                                                     21160062
211700         SELECT DISTINCT(TRN_NBR)                                 21170062
211800               ,RCVR_SEQ_NBR                                      21180062
211900          INTO :SUT00028-TRN-NBR                                  21190062
212000              ,:SUT00028-RCVR-SEQ-NBR                             21200062
212100          FROM SUT_OTBND_UPC                                      21210062
212200         WHERE SHIPT_UNT_ID     =  :DK-CARTON-ID                  21220062
212300           AND SHPD_UNT_QTY     >  0                              21230062
212400     END-EXEC                                                     21240062
212500                                                                  21250062
212600     EVALUATE TRUE                                                21260062
212700         WHEN SQLCODE = +0                                        21270062
212800             MOVE SUT00028-TRN-NBR   TO  PC046-PO-NBR             21280062
212900                                         PC046-TRN-NBR            21290062
213000                                         DK-PO-TRN-NBR            21300062
213100             IF  SUT00028-RCVR-SEQ-NBR = ZERO                     21310062
213200                 PERFORM 6000-TRY-TPKSLIP                         21320062
213300             ELSE                                                 21330062
213400                 MOVE SUT00028-RCVR-SEQ-NBR TO DK-PO-RCVR-NBR-N   21340062
213500                 MOVE DK-RCVR-NBR-X       TO DK-RCVR-NBR-9        21350062
213600                 MOVE DK-RCVR-NBR-3       TO PC046-RCVR-NBR       21360062
213700             END-IF                                               21370062
213800         WHEN SQLCODE = -811                                      21380062
213900             MOVE 'MULTIPLE'         TO  PC046-MULT-PO            21390062
214000         WHEN SQLCODE < +0                                        21400062
214100         WHEN SQLCODE > +0                                        21410062
214200             MOVE ZEROES             TO  PC046-PO-NBR             21420062
214300     END-EVALUATE.                                                21430062
214400                                                                  21440062
214500*-----------------------------------------------------------------21450062
214600 6000-TRY-TPKSLIP.                                                21460062
214700*-----------------------------------------------------------------21470062
214800*    MOVE ' 6000-TRY-TPKSLIP' TO PV-PARA                          21480062
214900                                                                  21490062
215000*    MOVE PC046-VENDOR-SHIPT-UNT-ID  TO DK-CARTON-ID.             21500062
215100                                                                  21510062
215200*    MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID           21520062
215300*    STRING ' CARTON = ' PV-DISPLAY-CARTON-ID  DELIMITED BY SIZE  21530062
215400*                 INTO PV-PARA                                    21540062
215500                                                                  21550062
215600     EXEC SQL                                                     21560062
215700          SELECT  B.REC_SEQ_NBR                                   21570062
215800            INTO  :PKSLIP-REC-SEQ-NBR                             21580062
215900            FROM  SUT_OTBND_VND A                                 21590062
216000                 ,TPKSLIP B                                       21600062
216100            WHERE A.SHIPT_UNT_ID  =  :DK-CARTON-ID                21610062
216200              AND A.PO_NBR        =  :SUT00028-TRN-NBR            21620062
216300              AND A.PO_NBR        =  B.PO_NBR                     21630062
216400              AND A.PKSL_SEQ_NBR  =  B.SEQ_NBR                    21640062
216500              AND B.VER_STAT_CDE  =  'A'                          21650062
216600     END-EXEC.                                                    21660062
216700                                                                  21670062
216800     EVALUATE TRUE                                                21680062
216900         WHEN SQLCODE = +0                                        21690062
217000             MOVE PKSLIP-REC-SEQ-NBR TO  DK-PO-RCVR-NBR-N         21700062
217100             MOVE DK-RCVR-NBR-X      TO  DK-RCVR-NBR-9            21710062
217200             MOVE DK-RCVR-NBR-3      TO  PC046-RCVR-NBR           21720062
217300         WHEN SQLCODE = +100                                      21730062
217400             PERFORM 6100-TRY-TPKSLIP-P2L                         21740062
217500         WHEN OTHER                                               21750062
217600             MOVE ZEROES             TO  DK-PO-RCVR-NBR-N         21760062
217700             MOVE DK-RCVR-NBR-X      TO  DK-RCVR-NBR-9            21770062
217800             MOVE DK-RCVR-NBR-3      TO  PC046-RCVR-NBR           21780062
217900     END-EVALUATE.                                                21790062
218000                                                                  21800062
218100*-----------------------------------------------------------------21810062
218200 6100-TRY-TPKSLIP-P2L.                                            21820062
218300*-----------------------------------------------------------------21830062
218400*    MOVE ' 6100-TRY-TPKSLIP-P2L' TO PV-PARA                      21840062
218500*    PERFORM 9999A-WRITE-TRACE.                                   21850062
218600                                                                  21860062
218700     MOVE PC046-VENDOR-SHIPT-UNT-ID  TO DK-CARTON-ID.             21870062
218800                                                                  21880062
218900*    MOVE  DK-CARTON-ID        TO  PV-DISPLAY-CARTON-ID           21890062
219000*    STRING ' CARTON = ' PV-DISPLAY-CARTON-ID  DELIMITED BY SIZE  21900062
219100*                 INTO PV-PARA                                    21910062
219200*    PERFORM 9999A-WRITE-TRACE.                                   21920062
219300                                                                  21930062
219400     EXEC SQL                                                     21940062
219500          SELECT  B.REC_SEQ_NBR                                   21950062
219600            INTO  :PKSLIP-REC-SEQ-NBR                             21960062
219700            FROM  TINPKSU A                                       21970062
219800                 ,TPKSLIP B                                       21980062
219900            WHERE A.SHIPT_UNT_ID  =  :DK-CARTON-ID                21990062
220000              AND A.PO_NBR        =  :SHUUPC-TRN-NBR              22000062
220100              AND A.PO_NBR        =  B.PO_NBR                     22010062
220200              AND A.SEQ_NBR       =  B.SEQ_NBR                    22020062
220300              AND B.VER_STAT_CDE  =  'A'                          22030062
220400     END-EXEC.                                                    22040062
220500                                                                  22050062
220600     EVALUATE TRUE                                                22060062
220700         WHEN SQLCODE = +0                                        22070062
220800             MOVE PKSLIP-REC-SEQ-NBR TO  DK-PO-RCVR-NBR-N         22080062
220900             MOVE DK-RCVR-NBR-X      TO  DK-RCVR-NBR-9            22090062
221000             MOVE DK-RCVR-NBR-3      TO  PC046-RCVR-NBR           22100062
221100         WHEN OTHER                                               22110062
221200             MOVE ZEROES             TO  DK-PO-RCVR-NBR-N         22120062
221300             MOVE DK-RCVR-NBR-X      TO  DK-RCVR-NBR-9            22130062
221400             MOVE DK-RCVR-NBR-3      TO  PC046-RCVR-NBR           22140062
221500     END-EVALUATE.                                                22150062
221600                                                                  22160062
221700*-----------------------------------------------------------------22170062
221800*  RETURN TO CALLING PROGRAM                                      22180062
221900*-----------------------------------------------------------------22190062
222000 9998-RETURN.                                                     22200062
222100                                                                  22210062
222200     MOVE SQLCA                         TO PC046-SQLCA            22220062
222300     MOVE PC046-COMMAREA-REC            TO LINK-PARMS.            22230062
222400                                                                  22240062
