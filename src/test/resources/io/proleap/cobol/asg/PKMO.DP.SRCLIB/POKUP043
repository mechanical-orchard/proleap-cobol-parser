000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    POKUP043.                                         00020001
000300 AUTHOR.        BILL SCHROEDER - STRATAGEM.                       00030001
000400 INSTALLATION.  KOHLS.                                            00040001
000500 DATE-WRITTEN.  04/28/2003.                                       00050001
000600 DATE-COMPILED.                                                   00060001
000700******************************************************************00070001
000800* THIS PROGRAM WILL UPDATE AND/OR REPORT ON DUPLICATE SKU         00080001
000900* CONDITIONS THAT WILL REQUIRE MANUAL OR AUTOMATIC CLEAN-UP.      00090001
001000* THIS PROGRAM WILL RUN IN 3 MODES:                               00100040
001100*  "A"  1) AUDIT MODE                                             00110040
001200*  "U"  2) UPDATE & AUDIT MODE.                                   00120040
001300*  "P"  3) PACK PROCESSING  & AUDIT MODE.                         00130040
001400*                                                                 00140001
001500* "AUDIT MODE" WILL REPORT ON THE PO/SKU'S THAT ARE DUPLICATE     00150001
001600*  SKU'S.                                                         00160001
001700*                                                                 00170001
001800* "UPDATE MODE" WILL CREATE THE SAME REPORT AS AUDIT MODE, BUT    00180036
001900*  WILL UPDATE THE PO DATABASE BY DELETING CERTAIN DUPLICATE SKU  00190036
002000*  CONDITIONS.                                                    00200036
002100*                                                                 00210036
002200* "PACK MODE" WILL CREATE THE SAME REPORT AS AUDIT MODE, BUT      00220036
002300*  WILL UPDATE THE PO DATABASE CONVERTING PO'S WITH DUPLICATE     00230036
002400*  SKU'S TO PACK PO'S.                                            00240036
002500******************************************************************00250001
002600 ENVIRONMENT DIVISION.                                            00260001
002700 CONFIGURATION SECTION.                                           00270001
002800 SOURCE-COMPUTER. IBM-3090.                                       00280001
002900 OBJECT-COMPUTER. IBM-3090.                                       00290001
003000 INPUT-OUTPUT SECTION.                                            00300001
003100 FILE-CONTROL.                                                    00310001
003200*                                                                 00320006
003300     SELECT INPUT-FILE                                            00330001
003400         ASSIGN TO INP01.                                         00340001
003500     SELECT PORPT-FILE                                            00350001
003600         ASSIGN TO RPT01.                                         00360001
003700*                                                                 00370006
003800******************************************************************00380001
003900 DATA DIVISION.                                                   00390001
004000******************************************************************00400001
004100 FILE SECTION.                                                    00410001
004200*                                                                 00420006
004300 FD  INPUT-FILE                                                   00430001
004400     RECORDING MODE IS F                                          00440009
004500     RECORD CONTAINS 80 CHARACTERS                                00450001
004600     BLOCK CONTAINS 0 RECORDS.                                    00460001
004700 01  INPUT-RECORD                     PIC  X(80).                 00470001
004800*                                                                 00480006
004900 FD  PORPT-FILE                                                   00490001
005000     RECORDING MODE IS F                                          00500009
005100     RECORD CONTAINS 132 CHARACTERS                               00510008
005200     DATA RECORD IS PORPT-RECORD.                                 00520001
005300 01  PORPT-RECORD                     PIC X(132).                 00530008
005400*                                                                 00540006
005500 WORKING-STORAGE SECTION.                                         00550001
005600*                                                                 00560006
005700 01  IR-INPUT-RECORD.                                             00570001
005800     05  IR-RUN-MODE                  PIC  X(01).                 00580005
005900     05  FILLER                       PIC  X(01).                 00590015
006000     05  IR-OTB-LOW-DTE.                                          00600015
006100         10  IR-OTB-LD-CC             PIC  X(02).                 00610015
006200         10  IR-OTB-LD-YY             PIC  X(02).                 00620015
006300         10  IR-OTB-LD-MM             PIC  X(02).                 00630015
006400     05  FILLER                       PIC  X(01).                 00640015
006500     05  IR-OTB-HIGH-DTE.                                         00650015
006600         10  IR-OTB-HD-CC             PIC  X(02).                 00660015
006700         10  IR-OTB-HD-YY             PIC  X(02).                 00670015
006800         10  IR-OTB-HD-MM             PIC  X(02).                 00680015
006900     05  FILLER                       PIC  X(65).                 00690015
007000*                                                                 00700006
007100 01  OR-REPORT-LINE.                                              00710006
007200*    05  OR-RPT-CC                    PIC  X(01).                 00720008
007300     05  OR-RPT-LINE                  PIC  X(132).                00730008
007400*                                                                 00740006
007500 01  SD-SYSTEM-DATE.                                              00750001
007600     05  SD-SYSTEM-YY                 PIC  9(02) VALUE ZEROES.    00760001
007700     05  SD-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    00770001
007800     05  SD-SYSTEM-DD                 PIC  9(02) VALUE ZEROES.    00780001
007900*                                                                 00790006
008000 01  ST-SYSTEM-TIME.                                              00800001
008100     05  ST-SYSTEM-HH                 PIC  9(02) VALUE ZEROES.    00810001
008200     05  ST-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    00820001
008300     05  ST-SYSTEM-SS                 PIC  9(02) VALUE ZEROES.    00830001
008400     05  FILLER                       PIC  9(02) VALUE ZEROES.    00840001
008500*                                                                 00850006
008600 01  PS-PROGRAM-SWITCHES.                                         00860001
008700     05  PS-EOF-INPUT-FILE-SW         PIC  X(01) VALUE 'N'.       00870001
008800         88  PS-EOF-INPUT-FILE                   VALUE 'Y'.       00880001
008900     05  PS-ROWS-FOUND-SW             PIC  X(01) VALUE 'N'.       00890018
009000         88  PS-ROWS-FOUND                       VALUE 'Y'.       00900018
009100         88  PS-ROWS-NOT-FOUND                   VALUE 'N'.       00910018
009200     05  PS-EOF-PRE-APRVL-PACK-CSR-SW PIC  X(01) VALUE 'N'.       00920006
009300         88  PS-EOF-PRE-APRVL-PACK-CSR           VALUE 'Y'.       00930006
009400         88  PS-NOT-EOF-PRE-APRVL-PACK-CSR       VALUE 'N'.       00940006
009500     05  PS-EOF-ACTV-DUPA-PACK-CSR-SW PIC  X(01) VALUE 'N'.       00950012
009600         88  PS-EOF-ACTV-DUPA-PACK-CSR           VALUE 'Y'.       00960012
009700         88  PS-NOT-EOF-ACTV-DUPA-PACK-CSR       VALUE 'N'.       00970012
009800     05  PS-EOF-ACTV-DUPC-PACK-CSR-SW PIC  X(01) VALUE 'N'.       00980012
009900         88  PS-EOF-ACTV-DUPC-PACK-CSR           VALUE 'Y'.       00990012
010000         88  PS-NOT-EOF-ACTV-DUPC-PACK-CSR       VALUE 'N'.       01000012
010100     05  PS-EOF-CNCL-DUPL-PACK-CSR-SW PIC  X(01) VALUE 'N'.       01010012
010200         88  PS-EOF-CNCL-DUPL-PACK-CSR           VALUE 'Y'.       01020012
010300         88  PS-NOT-EOF-CNCL-DUPL-PACK-CSR       VALUE 'N'.       01030012
010400     05  PS-EOF-PACK-PRCS-PACK-CSR-SW PIC  X(01) VALUE 'N'.       01040015
010500         88  PS-EOF-PACK-PRCS-PACK-CSR           VALUE 'Y'.       01050015
010600         88  PS-NOT-EOF-PACK-PRCS-PACK-CSR       VALUE 'N'.       01060015
010700     05  PS-EOF-PPUPDT-ITM-CSR-SW     PIC  X(01) VALUE 'N'.       01070022
010800         88  PS-EOF-PPUPDT-ITM-CSR               VALUE 'Y'.       01080021
010900         88  PS-NOT-EOF-PPUPDT-ITM-CSR           VALUE 'N'.       01090021
011000     05  PS-DELETE-SKU-SW             PIC  X(01) VALUE 'N'.       01100023
011100         88  PS-DELETE-SKU                       VALUE 'Y'.       01110023
011200         88  PS-DO-NOT-DELETE-SKU                VALUE 'N'.       01120023
011300     05  PS-REPORT-TYPE               PIC  X(01) VALUE ' '.       01130009
011400         88  PRAPDUPL                            VALUE '1'.       01140009
011500         88  ACTVDUPA                            VALUE '2'.       01150009
011600         88  ACTVDUPC                            VALUE '3'.       01160009
011700         88  CNCLDUPL                            VALUE '4'.       01170009
011800         88  PACKPRCS                            VALUE '5'.       01180015
011900     05  PS-RECEIPTS-SW               PIC  X(01) VALUE 'N'.       01190012
012000         88  PS-NO-DC-RECEIPTS                   VALUE 'N'.       01200012
012100         88  PS-DC-RECEIPTS-EXIST                VALUE 'Y'.       01210012
012200     05  PS-DELETE-ALL-TBL-SW         PIC  X(01) VALUE 'N'.       01220018
012300         88  PS-NO-DELETE-ALL-TBL-ROWS           VALUE 'N'.       01230018
012400         88  PS-DELETE-ALL-TBL-ROWS              VALUE 'Y'.       01240018
012500     05  PS-BYPASS-PO-SW              PIC  X(01) VALUE 'N'.       01250019
012600         88  PS-BYPASS-PO-NO                     VALUE 'N'.       01260019
012700         88  PS-BYPASS-PO-YES                    VALUE 'Y'.       01270019
012800     05  PS-DB2-ERROR-SW             PIC  X(01)  VALUE  'N'.      01280023
012900         88  PS-DB2-ERROR                        VALUE  'Y'.      01290023
013000         88  PS-NO-DB2-ERROR                     VALUE  'N'.      01300023
013100*                                                                 01310006
013200 01  PC-PROGRAM-CONSTANTS.                                        01320001
013300     05  DFHEIBLK                     PIC  X(08) VALUE 'DFHEIBLK'.01330007
013400     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08) VALUE 'POKUP043'.01340022
013500     05  PC-INIT-DATE                 PIC  X(10) VALUE            01350007
013600                                                     '0001-01-01'.01360001
013700     05  PC-HEADER-LINE-CNT           PIC S9(2)  VALUE +10.       01370042
013800     05  PC-MONTH-ABBR-TABLE.                                     01380001
013900         10  FILLER                   PIC  X(03) VALUE 'JAN'.     01390001
014000         10  FILLER                   PIC  X(03) VALUE 'FEB'.     01400001
014100         10  FILLER                   PIC  X(03) VALUE 'MAR'.     01410001
014200         10  FILLER                   PIC  X(03) VALUE 'APR'.     01420001
014300         10  FILLER                   PIC  X(03) VALUE 'MAY'.     01430001
014400         10  FILLER                   PIC  X(03) VALUE 'JUN'.     01440001
014500         10  FILLER                   PIC  X(03) VALUE 'JUL'.     01450001
014600         10  FILLER                   PIC  X(03) VALUE 'AUG'.     01460001
014700         10  FILLER                   PIC  X(03) VALUE 'SEP'.     01470001
014800         10  FILLER                   PIC  X(03) VALUE 'OCT'.     01480001
014900         10  FILLER                   PIC  X(03) VALUE 'NOV'.     01490001
015000         10  FILLER                   PIC  X(03) VALUE 'DEC'.     01500001
015100     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    01510001
015200         10  PC-MONTH-ABBR OCCURS 12 TIMES                        01520001
015300                                      PIC  X(03).                 01530001
015400     05  PC-DPKUT410                  PIC  X(08) VALUE 'DPKUT410'.01540001
015500     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +30       01550001
015600                                                 COMP.            01560001
015700     05  PC-TSYMSG-NUMBERS.                                       01570023
015800         10  PC-TSYMSG-00482          PIC  9(05) VALUE  00482.    01580023
015900*                                                                 01590006
016000 01  PC-PROGRAM-MESSAGES.                                         01600006
016100*----------------------------------------------------------------*01610006
016200* PRE-APPROVAL PO'S WITH DUPLICATE SKU'S THAT NEED MANUAL CLEANUP 01620006
016300     05  PC-PRE-APRVL-POS-DUPL-SKU-MAN.                           01630006
016400         10  FILLER                   PIC  X(34) VALUE SPACES.    01640009
016500         10  FILLER                   PIC  X(15) VALUE            01650006
016600        'PRE-APPROVAL PO'.                                        01660006
016700         10  FILLER                   PIC  X(01) VALUE QUOTE.     01670006
016800         10  FILLER                   PIC  X(20) VALUE            01680006
016900        'S WITH DUPLICATE SKU'.                                   01690006
017000         10  FILLER                   PIC  X(01) VALUE QUOTE.     01700006
017100         10  FILLER                   PIC  X(26) VALUE            01710006
017200        'S THAT NEED MANUAL CLEANUP'.                             01720006
017300         10  FILLER                   PIC  X(35) VALUE SPACES.    01730017
017400*----------------------------------------------------------------*01740006
017500* ACTIVE DUPLICATE SKU'S ON ACTIVE PO'S THAT NEED MANUAL CLEANUP  01750006
017600     05  PC-ACTV-DUPL-SKU-ACTV-PO-MAN.                            01760006
017700         10  FILLER                   PIC  X(35) VALUE SPACES.    01770009
017800         10  FILLER                   PIC  X(20) VALUE            01780006
017900        'ACTIVE DUPLICATE SKU'.                                   01790006
018000         10  FILLER                   PIC  X(01) VALUE QUOTE.     01800006
018100         10  FILLER                   PIC  X(14) VALUE            01810006
018200        'S ON ACTIVE PO'.                                         01820006
018300         10  FILLER                   PIC  X(01) VALUE QUOTE.     01830006
018400         10  FILLER                   PIC  X(26) VALUE            01840006
018500        'S THAT NEED MANUAL CLEANUP'.                             01850006
018600         10  FILLER                   PIC  X(35) VALUE SPACES.    01860017
018700*----------------------------------------------------------------*01870006
018800* ACTIVE DUPLICATE SKU'S ON CANCELLED PO'S THAT WILL BE CONVERTED 01880017
018900* TO PACKS IF THEY ARE NOT CLEANED UP.  CLEAN UP OPTIONAL.        01890017
019000     05  PC-ACTV-DUPL-SKU-CNCL-CNVRTD.                            01900017
019100         10  FILLER                   PIC  X(07) VALUE SPACES.    01910017
019200         10  FILLER                   PIC  X(20) VALUE            01920006
019300        'ACTIVE DUPLICATE SKU'.                                   01930006
019400         10  FILLER                   PIC  X(01) VALUE QUOTE.     01940006
019500         10  FILLER                   PIC  X(17) VALUE            01950017
019600        'S ON CANCELLED PO'.                                      01960017
019700         10  FILLER                   PIC  X(01) VALUE QUOTE.     01970006
019800         10  FILLER                   PIC  X(42) VALUE            01980017
019900        'S THAT WILL BE CONVERTED TO PACKS IF THEY '.             01990017
020000         10  FILLER                   PIC  X(37) VALUE            02000017
020100        'ARE NOT CLEANED UP. CLEAN UP OPTIONAL'.                  02010017
020200         10  FILLER                   PIC  X(07) VALUE SPACES.    02020017
020300*----------------------------------------------------------------*02030006
020400* CANCELLED (CA) DUPLICATE SKU'S - OTB CCYY-MM AND GREATER        02040041
020500* (CCYY-MM INPUT PV-OTB-HIGH-DTE)                                 02050041
020600     05  PC-CNCL-DUPL-SKU-WILL-BE-DLTD1.                          02060042
020700         10  FILLER                   PIC  X(38) VALUE SPACES.    02070041
020800         10  FILLER                   PIC  X(28) VALUE            02080006
020900        'CANCELLED (CA) DUPLICATE SKU'.                           02090006
021000         10  FILLER                   PIC  X(01) VALUE QUOTE.     02100006
021100         10  FILLER                   PIC  X(08) VALUE            02110041
021200        'S - OTB '.                                               02120041
021300         10  PC-CNCLDUPL-OTB-HIGH-DTE PIC  X(07).                 02130017
021400         10  FILLER                   PIC  X(12) VALUE            02140017
021500        ' AND GREATER'.                                           02150017
021600         10  FILLER                   PIC  X(38) VALUE SPACES.    02160041
021700*----------------------------------------------------------------*02170006
021800* THE ASTERISK (*) INDICATES WHICH DUP SKU WILL BE DELETED        02180041
021900     05  PC-CNCL-DUPL-SKU-WILL-BE-DLTD2.                          02190042
022000         10  FILLER                   PIC  X(38) VALUE SPACES.    02200041
022100         10  FILLER                   PIC  X(44) VALUE            02210041
022200        'THE ASTERISK (*) INDICATES WHICH DUP SKU WIL'.           02220041
022300         10  FILLER                   PIC  X(12) VALUE            02230041
022400        'L BE DELETED'.                                           02240041
022500         10  FILLER                   PIC  X(38) VALUE SPACES.    02250041
022600*----------------------------------------------------------------*02260041
022700* PO'S WITH DUPLICATE SKU'S THAT WILL BE CONVERTED TO PACK PO'S   02270041
022800     05  PC-PACK-PRCS-POS-WILL-BE-CNVTD.                          02280017
022900         10  FILLER                   PIC  X(35) VALUE SPACES.    02290017
023000         10  FILLER                   PIC  X(02) VALUE            02300017
023100        'PO'.                                                     02310017
023200         10  FILLER                   PIC  X(01) VALUE QUOTE.     02320017
023300         10  FILLER                   PIC  X(20) VALUE            02330017
023400        'S WITH DUPLICATE SKU'.                                   02340017
023500         10  FILLER                   PIC  X(01) VALUE QUOTE.     02350017
023600         10  FILLER                   PIC  X(35) VALUE            02360017
023700        'S THAT WILL BE CONVERTED TO PACK PO'.                    02370017
023800         10  FILLER                   PIC  X(01) VALUE QUOTE.     02380017
023900         10  FILLER                   PIC  X(01) VALUE            02390017
024000        'S'.                                                      02400017
024100         10  FILLER                   PIC  X(36) VALUE SPACES.    02410017
024200*----------------------------------------------------------------*02420006
024300* THERE ARE NO PRE-APPROVAL DUPLICATE SKU'S TO REPORT             02430006
024400     05  PC-NO-PREAPRVL-DUPL-SKU-TO-RPT.                          02440006
024500         10  FILLER                   PIC  X(40) VALUE SPACES.    02450009
024600         10  FILLER                   PIC  X(39) VALUE            02460006
024700        'THERE ARE NO PRE-APPROVAL DUPLICATE SKU'.                02470006
024800         10  FILLER                   PIC  X(01) VALUE QUOTE.     02480006
024900         10  FILLER                   PIC  X(11) VALUE            02490006
025000        'S TO REPORT'.                                            02500006
025100         10  FILLER                   PIC  X(41) VALUE SPACES.    02510017
025200*----------------------------------------------------------------*02520006
025300* THERE ARE NO ACTIVE DUPLICATE ACTIVE PO SKU'S TO REPORT         02530018
025400     05  PC-NO-ACTV-DUPA-SKU-TO-RPT.                              02540018
025500         10  FILLER                   PIC  X(38) VALUE SPACES.    02550018
025600         10  FILLER                   PIC  X(43) VALUE            02560018
025700        'THERE ARE NO ACTIVE DUPLICATE ACTIVE PO SKU'.            02570018
025800         10  FILLER                   PIC  X(01) VALUE QUOTE.     02580006
025900         10  FILLER                   PIC  X(11) VALUE            02590006
026000        'S TO REPORT'.                                            02600006
026100         10  FILLER                   PIC  X(39) VALUE SPACES.    02610018
026200*----------------------------------------------------------------*02620018
026300* THERE ARE NO ACTIVE DUPLICATE CANCELLED PO SKU'S TO REPORT      02630018
026400     05  PC-NO-ACTV-DUPC-SKU-TO-RPT.                              02640018
026500         10  FILLER                   PIC  X(37) VALUE SPACES.    02650018
026600         10  FILLER                   PIC  X(46) VALUE            02660018
026700        'THERE ARE NO ACTIVE DUPLICATE CANCELLED PO SKU'.         02670018
026800         10  FILLER                   PIC  X(01) VALUE QUOTE.     02680018
026900         10  FILLER                   PIC  X(11) VALUE            02690018
027000        'S TO REPORT'.                                            02700018
027100         10  FILLER                   PIC  X(37) VALUE SPACES.    02710018
027200*----------------------------------------------------------------*02720006
027300* THERE ARE NO CANCELLED DUPLICATE SKU'S TO DELETE WITH OTB OF    02730019
027400* CCYY-MM AND GREATER  (CCYY-MM INPUT PV-OTB-HIGH-DTE)            02740019
027500     05  PC-NO-CNCLD-DUPL-SKU-TO-RPT.                             02750006
027600         10  FILLER                   PIC  X(26) VALUE SPACES.    02760019
027700         10  FILLER                   PIC  X(36) VALUE            02770006
027800        'THERE ARE NO CANCELLED DUPLICATE SKU'.                   02780006
027900         10  FILLER                   PIC  X(01) VALUE QUOTE.     02790006
028000         10  FILLER                   PIC  X(24) VALUE            02800019
028100        'S TO DELETE WITH OTB OF '.                               02810019
028200         10  PC-NO-CNCLDUPL-OTB-HIGH-DTE                          02820019
028300                                      PIC  X(07).                 02830019
028400         10  FILLER                   PIC  X(11) VALUE            02840019
028500        ' OR GREATER'.                                            02850019
028600         10  FILLER                   PIC  X(27) VALUE SPACES.    02860019
028700*----------------------------------------------------------------*02870006
028800* THERE ARE NO PACK PROCESS PURCHASE ORDERS TO REPORT             02880018
028900     05  PC-NO-PACK-PRCS-SKU-TO-RPT.                              02890015
029000         10  FILLER                   PIC  X(40) VALUE SPACES.    02900018
029100         10  FILLER                   PIC  X(44) VALUE            02910006
029200        'THERE ARE NO PACK PROCESS PURCHASE ORDERS TO'.           02920018
029300         10  FILLER                   PIC  X(07) VALUE            02930018
029400        ' REPORT'.                                                02940018
029500         10  FILLER                   PIC  X(41) VALUE SPACES.    02950018
029600*                                                                 02960006
029600 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      02961052
029600                                                  COMP SYNC.      02962052
029600     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    02963052
029600     88  AC-DB2-ERROR                             VALUE +4013.    02964052
029600     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    02965052
029600*                                                                 02966052
029700 01  PV-PROGRAM-VARIABLES.                                        02970001
029800     05  PV-HOLD-IDX                  PIC S9(06) VALUE +0         02980001
029900                                                 COMP.            02990001
030000     05  PV-LNE-SUB                   PIC S9(04) VALUE +0         03000013
030100                                                 COMP.            03010013
030200     05  PV-LNE-SUB-LST               PIC S9(04) VALUE +0         03020013
030300                                                 COMP.            03030013
030400     05  PV-HOLD-DEPT-NBR             PIC X(03)  VALUE SPACES.    03040008
030500     05  PV-HOLD-OTB-PER-NBR          PIC X(06)  VALUE SPACES.    03050019
030600     05  PV-HOLD-PO-NBR               PIC S9(09) VALUE +0         03060010
030700                                                 COMP.            03070010
030800*                                                                 03080014
030900     05  PV-HLD-NXT-OTB-PER-NBR       PIC X(06).                  03090014
031000     05  PV-HLD-NXT-PO-NBR            PIC 9(09) COMP.             03100014
031100     05  PV-HLD-NXT-PUR-STATUS-CDE    PIC X(02).                  03110014
031200     05  PV-HLD-NXT-DEPT-NBR          PIC X(03).                  03120014
031300     05  PV-HLD-NXT-PO-LNE-NBR        PIC 9(09) COMP.             03130014
031400     05  PV-HLD-NXT-ITM-NBR           PIC 9(15) COMP.             03140014
031500     05  PV-HLD-NXT-ITM-STATUS-CDE    PIC X(02).                  03150014
031600     05  PV-HLD-NXT-RMS-PO-SKU-NBR    PIC 9(08) COMP.             03160014
031700     05  PV-HLD-NXT-LAST-UPD-TMST     PIC X(26).                  03170014
031710     05  PV-HLD-NXT-APP-PO-LNE-NBR    PIC S9(4) COMP.             03171045
031800*                                                                 03180014
031900     05  PV-SQL-REC-CNT               PIC S9(04) VALUE +0         03190018
032000                                                 COMP.            03200012
032100     05  PV-ITM-DUPL-CNT              PIC S9(04) VALUE +0         03210013
032200                                                 COMP.            03220013
032300     05  PV-HOLD-STATUS-CDE           PIC X(02)  VALUE SPACES.    03230012
032400     05  PV-TIMES-THROUGH             PIC S9(06) VALUE +0         03240001
032500                                                 COMP.            03250001
032600     05  PV-DIFF                      PIC S9(06) VALUE +0         03260001
032700                                                 COMP SYNC.       03270001
032800     05  PV-ABS-DIFF                  PIC 9(06).                  03280001
032900     05  PV-ABEND-PARAGRAPH           PIC  X(30) VALUE SPACES.    03290001
033000     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         03300001
033100                                                 COMP.            03310001
033200     05  PV-NULL-IND                  PIC S9(04) VALUE +0         03320001
033300                                                 COMP.            03330001
033400     05  PV-PAGE-CNT                  PIC S9(07) VALUE  0         03340001
033500                                                 COMP-3.          03350001
033600     05  PV-QUOTIENT                  PIC S9(04) VALUE +0         03360001
033700                                                 COMP.            03370001
033800     05  PV-REMAINDER                 PIC S9(04) VALUE +0         03380001
033900                                                 COMP.            03390001
034000     05  PV-LINE-CNT                  PIC 9(06).                  03400001
034100     05  PV-TIMES                     PIC S9(06) VALUE +0         03410001
034200                                                 COMP-3.          03420001
034300     05  PV-TIMES2                    PIC S9(06) VALUE +0         03430001
034400                                                 COMP-3.          03440001
034500     05  PV-START                     PIC S9(06) VALUE +0         03450001
034600                                                 COMP-3.          03460001
034700     05  PV-END                       PIC S9(06) VALUE +0         03470001
034800                                                 COMP-3.          03480001
BARB       05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   03481048
BARB       05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   03482048
BARB       05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   03483048
BARB       05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   03484048
BARB                                                                    03485048
034900     05  PV-NBR-STORES                PIC S9(06) VALUE +0         03490001
035000                                                 COMP-3.          03500001
035100     05  PV-NBR-WRITES                PIC S9(06) VALUE +0         03510001
035200                                                 COMP-3.          03520001
035300     05  PV-STR-ADJ                   PIC S9(06) VALUE +0         03530001
035400                                                 COMP-3.          03540001
035500     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         03550001
035600                                                 COMP-3.          03560001
035700     05  PV-CURRENT-TMST              PIC X(26)  VALUE SPACES.    03570021
035800     05  PV-DATE-BREAK.                                           03580001
035900         10  PV-DB-CC                 PIC  X(02).                 03590001
036000         10  PV-DB-YY                 PIC  X(02).                 03600001
036100         10  FILLER                   PIC  X(01).                 03610001
036200         10  PV-DB-MM                 PIC  X(02).                 03620001
036300         10  FILLER                   PIC  X(01).                 03630001
036400         10  PV-DB-DD                 PIC  X(02).                 03640001
036500     05  PV-DATE-BREAK-SLASH.                                     03650001
036600         10  PV-DBS-MM                PIC  X(02).                 03660001
036700         10  FILLER                   PIC  X(01) VALUE '/'.       03670001
036800         10  PV-DBS-DD                PIC  X(02).                 03680001
036900         10  FILLER                   PIC  X(01) VALUE '/'.       03690001
037000         10  PV-DBS-YY                PIC  X(02).                 03700001
037100     05  PV-OTB-PER-BREAK             PIC  X(06).                 03710001
037200     05  FILLER REDEFINES PV-OTB-PER-BREAK.                       03720001
037300         10  PV-OTBP-CC               PIC  X(02).                 03730001
037400         10  PV-OTBP-YY               PIC  X(02).                 03740001
037500         10  PV-OTBP-MM               PIC  X(02).                 03750001
037600         10  PV-OTBP-MM-N REDEFINES PV-OTBP-MM                    03760001
037700                                      PIC  9(02).                 03770001
037800     05  PV-EDIT-ZIP-CODE             PIC  9(09).                 03780001
037900     05  PV-EDIT-ZIP-CODE-BREAK REDEFINES PV-EDIT-ZIP-CODE.       03790001
038000         10  PV-EZCB-1-5              PIC  X(05).                 03800001
038100         10  PV-EZCB-6-9              PIC  X(04).                 03810001
038200     05  PV-ZIP-CODE-DISPLAY.                                     03820001
038300         10  PV-ZCD-1-5               PIC  X(05).                 03830001
038400         10  FILLER                   PIC  X(01) VALUE '-'.       03840001
038500         10  PV-ZCD-6-9               PIC  X(04).                 03850001
038600     05  PV-EDIT-MU-PCT               PIC  ZZZ.99.                03860001
038700     05  PV-DOL-FORM-9                PIC  $$,$$$.99.             03870001
038800     05  PV-DOL-FORM-11               PIC  $$$$,$$$.99.           03880001
038900     05  PV-DOL-FORM-13               PIC  $$,$$$,$$$.99.         03890001
039000     05  PV-DOL-FORM-14               PIC  $$$,$$$,$$$.99.        03900001
039100     05  PV-PCT-HOLD                  PIC  9(04)V9(04).           03910001
039200     05  PV-RECIP-CDE-HOLD            PIC  X(02).                 03920001
039300     05  PV-PO-PREPK-ID               PIC  X(13).                 03930039
039400     05  PV-PO-LINE-NBR               PIC S9(03) COMP-3.          03940001
039500     05  PV-PO-NBR                    PIC S9(09) COMP.            03950010
039600     05  PV-ALLOC-CNT                 PIC S9(09) COMP-3.          03960001
039700     05  PV-UPC-DTL-CNT               PIC S9(09) COMP-3.          03970001
039800     05  PV-NBR-TIMES                 PIC S9(09) COMP-3.          03980001
039900     05  PV-GRP-PRICE.                                            03990001
040000         10  PV-GP-QTY                PIC  ZZZ.                   04000001
040100         10  FILLER                   PIC  X(01) VALUE '/'.       04010001
040200         10  PV-GP-AMT                PIC  $$$$$$.99.             04020001
040300     05  PV-SUB                       PIC S9(04) COMP VALUE +0.   04030001
040400     05  PV-SUB1                      PIC S9(04) COMP VALUE +0.   04040001
040500     05  PV-SUB2                      PIC S9(04) COMP VALUE +0.   04050001
040600     05  PV-MAX-PO-ITM-PREPK-ID       PIC S9(04) COMP VALUE +0.   04060022
040700     05  PV-MAX-PRPK-PREPK-ID         PIC S9(04) COMP VALUE +0.   04070022
040800     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         04080001
040900                                                 COMP SYNC.       04090001
041000     05  PV-PRAPDUPL-CNT              PIC S9(09) VALUE +0         04100009
041100                                                 COMP SYNC.       04110006
041200     05  PV-ACTVDUPA-CNT              PIC S9(09) VALUE +0         04120009
041300                                                 COMP SYNC.       04130006
041400     05  PV-ACTVDUPC-CNT              PIC S9(09) VALUE +0         04140009
041500                                                 COMP SYNC.       04150009
041600     05  PV-CNCLDUPL-CNT              PIC S9(09) VALUE +0         04160009
041700                                                 COMP SYNC.       04170006
041800     05  PV-PACKPRCS-CNT              PIC S9(09) VALUE +0         04180015
041900                                                 COMP SYNC.       04190006
042000     05  PV-PACKPRCS-REPORT-CNT       PIC S9(09) VALUE +0         04200019
042100                                                 COMP SYNC.       04210019
042200     05  PV-PACKPRCS-BYPASS-CNT       PIC S9(09) VALUE +0         04220019
042300                                                 COMP SYNC.       04230019
042400     05  PV-PPUPDT-ITM-CNT            PIC S9(09) VALUE +0         04240021
042500                                                 COMP SYNC.       04250021
042600     05  PV-FIND-DC-RCPT-ATMPT-CNT    PIC S9(09) VALUE +0         04260023
042700                                                 COMP SYNC.       04270023
042800     05  PV-FIND-DC-RCPT-SUCSS-CNT    PIC S9(09) VALUE +0         04280023
042900                                                 COMP SYNC.       04290023
043000     05  PV-GET-PO-ITM-ATMPT-CNT      PIC S9(09) VALUE +0         04300023
043100                                                 COMP SYNC.       04310023
043200     05  PV-GET-PO-ITM-SUCSS-CNT      PIC S9(09) VALUE +0         04320023
043300                                                 COMP SYNC.       04330023
043400     05  PV-CNCLDUPL-PK-DELT-CNT      PIC S9(09) VALUE +0         04340023
043500                                                 COMP SYNC.       04350023
043600     05  PV-FND-POTPK-TMP-ATMPT-CNT   PIC S9(09) VALUE +0         04360023
043700                                                 COMP SYNC.       04370023
043800     05  PV-FND-POTPK-TMP-SUCSS-CNT   PIC S9(09) VALUE +0         04380023
043900                                                 COMP SYNC.       04390023
044000     05  PV-UPD-PURCHS-ATMPT-CNT      PIC S9(09) VALUE +0         04400023
044100                                                 COMP SYNC.       04410023
044200     05  PV-UPD-PURCHS-SUCSS-CNT      PIC S9(09) VALUE +0         04420023
044300                                                 COMP SYNC.       04430023
044400     05  PV-ISRT-PURCHS-ATMPT-CNT     PIC S9(09) VALUE +0         04440038
044500                                                 COMP SYNC.       04450038
044600     05  PV-ISRT-PURCHS-SUCSS-CNT     PIC S9(09) VALUE +0         04460038
044700                                                 COMP SYNC.       04470038
044800     05  PV-UPD-PURITM-ATMPT-CNT      PIC S9(09) VALUE +0         04480023
044900                                                 COMP SYNC.       04490023
045000     05  PV-UPD-PURITM-SUCSS-CNT      PIC S9(09) VALUE +0         04500023
045100                                                 COMP SYNC.       04510023
045200     05  PV-GMAX-POITM-ATMPT-CNT      PIC S9(09) VALUE +0         04520023
045300                                                 COMP SYNC.       04530023
045400     05  PV-GMAX-POITM-SUCSS-CNT      PIC S9(09) VALUE +0         04540023
045500                                                 COMP SYNC.       04550023
045600     05  PV-GMAX-PREPK-ATMPT-CNT      PIC S9(09) VALUE +0         04560023
045700                                                 COMP SYNC.       04570023
045800     05  PV-GMAX-PREPK-SUCSS-CNT      PIC S9(09) VALUE +0         04580023
045900                                                 COMP SYNC.       04590023
046000     05  PV-ISRT-POPRPK-ATMPT-CNT     PIC S9(09) VALUE +0         04600035
046100                                                 COMP SYNC.       04610023
046200     05  PV-ISRT-POPRPK-SUCSS-CNT     PIC S9(09) VALUE +0         04620035
046300                                                 COMP SYNC.       04630023
046400     05  PV-ISRT-POINST-ATMPT-CNT     PIC S9(09) VALUE +0         04640035
046500                                                 COMP SYNC.       04650035
046600     05  PV-ISRT-POINST-SUCSS-CNT     PIC S9(09) VALUE +0         04660035
046700                                                 COMP SYNC.       04670035
046800     05  PV-DELT-MESTDS-ATMPT-CNT     PIC S9(09) VALUE +0         04680023
046900                                                 COMP SYNC.       04690023
047000     05  PV-DELT-MESTDS-SUCSS-CNT     PIC S9(09) VALUE +0         04700023
047100                                                 COMP SYNC.       04710023
047200     05  PV-DELT-ALLPLN-ATMPT-CNT     PIC S9(09) VALUE +0         04720023
047300                                                 COMP SYNC.       04730023
047400     05  PV-DELT-ALLPLN-SUCSS-CNT     PIC S9(09) VALUE +0         04740023
047500                                                 COMP SYNC.       04750023
047600     05  PV-DELT-PURITM-ATMPT-CNT     PIC S9(09) VALUE +0         04760023
047700                                                 COMP SYNC.       04770023
047800     05  PV-DELT-PURITM-SUCSS-CNT     PIC S9(09) VALUE +0         04780023
047900                                                 COMP SYNC.       04790023
048000     05  PV-ISRT-PURITM-ATMPT-CNT     PIC S9(09) VALUE +0         04800035
048100                                                 COMP SYNC.       04810035
048200     05  PV-ISRT-PURITM-SUCSS-CNT     PIC S9(09) VALUE +0         04820035
048300                                                 COMP SYNC.       04830035
048400     05  PV-RUN-MODE                  PIC  X(01).                 04840023
048500         88  AUDIT-MODE                          VALUE 'A'.       04850006
048600         88  UPDATE-MODE                         VALUE 'U'.       04860006
048700         88  PACK-MODE                           VALUE 'P'.       04870015
048800     05  PV-OTB-LOW-DTE               PIC  X(06).                 04880016
048900     05  PV-OTB-LOW-DTE-REDF REDEFINES                            04890016
049000         PV-OTB-LOW-DTE.                                          04900016
049100         10  PV-OTB-LD-CC             PIC  X(02).                 04910016
049200         10  PV-OTB-LD-YY             PIC  X(02).                 04920016
049300         10  PV-OTB-LD-MM             PIC  X(02).                 04930016
049400     05  PV-OTB-HIGH-DTE              PIC  X(06).                 04940016
049500     05  PV-OTB-HIGH-DTE-REDF REDEFINES                           04950016
049600         PV-OTB-HIGH-DTE.                                         04960016
049700         10  PV-OTB-HD-CC             PIC  X(02).                 04970015
049800         10  PV-OTB-HD-YY             PIC  X(02).                 04980015
049900         10  PV-OTB-HD-MM             PIC  X(02).                 04990015
050000*                                                                 05000017
050100 01  PV-TPURCHS.                                                  05010021
050200     10  PVT-PRCHS-PO-NBR             PIC  S9(9) COMP.            05020021
050300     10  PVT-PRCHS-VER-NBR            PIC  S9(9) COMP.            05030021
050400     10  PVT-PRCHS-VER-STATUS-CDE     PIC   X(1).                 05040021
050500     10  PVT-PRCHS-PO-TYP-CDE         PIC   X(2).                 05050021
050600     10  PVT-PRCHS-PO-CATEG-CDE       PIC   X(2).                 05060021
050700     10  PVT-PRCHS-EDI-IND            PIC   X(1).                 05070021
050800     10  PVT-PRCHS-TOT-UNT-QTY        PIC  S9(9) COMP.            05080021
050900     10  PVT-PRCHS-TOT-VAL-COST-AMT   PIC  S9(8)V9(2) COMP-3.     05090021
051000     10  PVT-PRCHS-TOT-VAL-RTL-AMT    PIC  S9(8)V9(2) COMP-3.     05100021
051100     10  PVT-PRCHS-TOT-MU-PCT         PIC  S9(3)V9(2) COMP-3.     05110021
051200     10  PVT-PRCHS-TOT-SKUS-QTY       PIC  S9(4) COMP.            05120021
051300     10  PVT-PRCHS-IMPRT-AGNT-PO-NBR  PIC  S9(9) COMP.            05130021
051400     10  PVT-PRCHS-IMPRT-ORD-OFF-NAME PIC   X(20).                05140021
051500     10  PVT-PRCHS-IMPRT-VEND-NAME    PIC   X(35).                05150021
051600     10  PVT-PRCHS-IMPRT-FCTRY-NAME   PIC   X(35).                05160021
051700     10  PVT-PRCHS-IMPRT-CNTRY-NAME   PIC   X(20).                05170021
051800     10  PVT-PRCHS-VEND-CNTRY-NAME    PIC   X(20).                05180021
051900     10  PVT-PRCHS-NEW-STR-PO-IND     PIC   X(1).                 05190021
052000     10  PVT-PRCHS-IMPRT-PO-IND       PIC   X(1).                 05200021
052100     10  PVT-PRCHS-IMPRT-AGNT-PO-IND  PIC   X(1).                 05210021
052200     10  PVT-PRCHS-STATUS-TMST        PIC   X(26).                05220021
052300     10  PVT-PRCHS-LAST-UPD-TMST      PIC   X(26).                05230021
052400     10  PVT-PRCHS-EDI-REXMIT-IND     PIC   X(1).                 05240021
052500     10  PVT-PRCHS-EDI-REXMIT-TMST    PIC   X(26).                05250021
052600     10  PVT-PRCHS-DIR-STR-IND        PIC   X(1).                 05260021
052700     10  PVT-PRCHS-LAST-UPD-BY-UID    PIC   X(8).                 05270021
052800     10  PVT-PRCHS-APP-BY-UID         PIC   X(8).                 05280021
052900     10  PVT-PRCHS-OTB-PER-NBR        PIC   X(6).                 05290021
053000     10  PVT-PRCHS-DEPT-NBR           PIC   X(3).                 05300021
053100     10  PVT-PRCHS-ENT-ID             PIC  S9(9) COMP.            05310021
053200     10  PVT-PRCHS-STATUS-CDE         PIC   X(2).                 05320021
053300     10  PVT-PRCHS-CRE-BY-UID         PIC   X(8).                 05330021
053400     10  PVT-PRCHS-REJ-CT             PIC  S9(4) COMP.            05340021
053500     10  PVT-PRCHS-REJ-UID            PIC   X(8).                 05350021
053600     10  PVT-PRCHS-ORD-DTE            PIC   X(10).                05360021
053700     10  PVT-PRCHS-REVISION-CT        PIC  S9(4) COMP.            05370021
053800     10  PVT-PRCHS-ADR-SEQ-NBR        PIC  S9(4) COMP.            05380021
053900     10  PVT-PRCHS-DEST-KNOWN-IND     PIC   X(1).                 05390021
054000     10  PVT-PRCHS-RLSE-IND           PIC   X(1).                 05400021
054100     10  PVT-PRCHS-RLSE-DTE           PIC   X(10).                05410021
054200     10  PVT-PRCHS-ANLYS-HOLD-IND     PIC   X(1).                 05420021
054300     10  PVT-PRCHS-PLCMNT-CNTRY-CDE   PIC   X(3).                 05430021
054400     10  PVT-PRCHS-PROD-CNTRY-CDE     PIC   X(3).                 05440021
054500     10  PVT-PRCHS-UNT-PER-CBMT-QTY   PIC  S9(9) COMP.            05450021
054600     10  PVT-PRCHS-TKT-FMT-NBR        PIC   X(15).                05460021
054700     10  PVT-PRCHS-TKT-FMT-DESC       PIC   X(30).                05470021
054800     10  PVT-PRCHS-CRE-TMST           PIC   X(26).                05480021
054900     10  PVT-PRCHS-PRG-LAST-ACTVY-DTE PIC   X(10).                05490021
055000     10  PVT-PRCHS-PKGNG-CDE          PIC   X(1).                 05500021
055100     10  PVT-PRCHS-SEASET-YR          PIC   X(4).                 05510021
055200     10  PVT-PRCHS-SEASET-SHRT-NM     PIC   X(5).                 05520021
055300     10  PVT-PRCHS-QTA-CTG-CDE        PIC   X(5).                 05530021
055400     10  PVT-PRCHS-PO-IN-RMS-IND      PIC   X(1).                 05540021
055500     10  PVT-PRCHS-RMS-PO-UPD-TMST    PIC   X(26).                05550025
055600     10  PVT-PRCHS-DUP-SKU-IND        PIC   X(1).                 05560022
055700     10  PVT-PRCHS-ORIG-PKGNG-CDE     PIC   X(1).                 05570022
055800*                                                                 05580021
055900* THIS TABLE WILL HOLD UP TO 999 STORES                           05590021
056000* BUMP OCCURS UP IF KOHL'S IS OPERATING > 999 STORES              05600001
056100* THIS TABLE HOLDS ALL THE STORES FOR A SKU ON AN ORDER           05610001
056200* IT IS CLEARED OUT BETWEEN LINE NUMBERS                          05620001
056300     05  PV-SAVE-TABLE.                                           05630001
056400         10  PV-SAVE-OCC                OCCURS 999 TIMES          05640001
056500                                        INDEXED BY PV-STR-IDX.    05650001
056600             15  PV-SAVE-STR-NBR         PIC 9(03).               05660001
056700             15  PV-SAVE-STR-NAME        PIC X(05).               05670001
056800             15  PV-SAVE-STR-QTY         PIC 9(06).               05680001
056900             15  PV-SAVE-STR-SUBTOTAL    PIC S9(09) COMP-3.       05690001
057000             15  PV-UPC-OCC             OCCURS 50 TIMES           05700001
057100                                        INDEXED BY PV-UPC-IDX.    05710001
057200                 20  PV-SAVE-UPC-DESC        PIC X(10).           05720001
057300                 20  PV-SAVE-UPC-QTY-STR     PIC 9(06).           05730001
057400                 20  PV-SAVE-POUPC-QTY       PIC 9(06).           05740001
057500                 20  PV-SAVE-UPC-SUBTOTAL    PIC S9(09) COMP-3.   05750001
057600     05  PV-LINE-TABLE.                                           05760013
057700         10  PV-LINE-OCC                  OCCURS 010 TIMES        05770013
057800                                          INDEXED BY PV-LNE-IDX.  05780013
057900             15  PLT-DEPT-NBR             PIC X(03).              05790013
058000             15  PLT-OTB-PER-NBR          PIC X(06).              05800014
058100             15  PLT-PO-NBR               PIC S9(9)  COMP.        05810014
058200             15  PLT-PURCHS-STATUS-CDE    PIC X(02).              05820013
058300             15  PLT-ITM-NBR              PIC S9(15) COMP.        05830014
058400             15  PLT-PO-LNE-NBR           PIC S9(9)  COMP.        05840014
058500             15  PLT-PURITM-STATUS-CDE    PIC X(02).              05850013
058600             15  PLT-RMS-PO-SKU-NBR       PIC S9(8)  COMP.        05860014
058700             15  PLT-RECEIPT-ACTIVITY     PIC X(03).              05870013
058800             15  PLT-PURITM-LAST-UPD-TMST PIC X(26).              05880014
058900             15  PLT-APP-PO-LNE-NBR       PIC S9(4)  COMP.        05890045
059000             15  PLT-DELETE-SKU           PIC X(01).              05900023
059100******************************************************************05910001
059200*  COMMUNICATIONS AREA2 FOR DB2                                   05920001
059300******************************************************************05930001
059400     COPY SQLCA2.                                                 05940001
059500/                                                                 05950007
059600************************************************************      05960012
059700*  WORKING STORAGE AREA FOR PAYMENT TERMS                         05970012
059800************************************************************      05980012
059900     COPY POWS020.                                                05990012
060000/                                                                 06000012
060100*-----------------------------------------------------------      06010007
060200*                                                                 06020012
060300*-----------------------------------------------------------      06030007
060400     COPY DPWS020.                                                06040012
060500/                                                                 06050007
060500******************************************************************06051049
060500*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            06052049
060500******************************************************************06053049
060500     COPY DPWS004.                                                06054049
060600*-----------------------------------------------------------      06060012
060700*    ABEND PROCESSING COPYBOOK.                                   06070012
060800*-----------------------------------------------------------      06080012
060900*    COPY DPWS013.                                                06090049
061000/                                                                 06100012
061100******************************************************************06110001
061200*  PURCHASE ORDER REPORT PRINT LINES                              06120001
061300******************************************************************06130001
061400 01  HEADER-LINE1.                                                06140001
061500     05  FILLER                       PIC  X(42) VALUE SPACES.    06150009
061600     05  FILLER                       PIC  X(08) VALUE 'K O H L '.06160001
061700     05  FILLER                       PIC  X(01) VALUE QUOTE.     06170001
061800     05  FILLER                       PIC  X(38) VALUE            06180001
061900         ' S   D E P A R T M E N T   S T O R E S'.                06190001
062000     05  FILLER                       PIC  X(09) VALUE SPACES.    06200009
062100     05  FILLER                       PIC  X(06) VALUE 'DATE: '.  06210001
062200     05  HL1-RUN-MONTH                PIC  X(02).                 06220001
062300     05  FILLER                       PIC  X(01) VALUE '/'.       06230001
062400     05  HL1-RUN-DAY                  PIC  X(02).                 06240001
062500     05  FILLER                       PIC  X(01) VALUE '/'.       06250001
062600     05  HL1-RUN-YEAR                 PIC  X(02).                 06260001
062700     05  FILLER                       PIC  X(06) VALUE SPACES.    06270001
062800     05  FILLER                       PIC  X(06) VALUE 'TIME: '.  06280001
062900     05  HL1-RUN-HOUR                 PIC  X(02).                 06290001
063000     05  FILLER                       PIC  X(01) VALUE ':'.       06300001
063100     05  HL1-RUN-MINUTE               PIC  X(02).                 06310001
063200     05  FILLER                       PIC  X(01) VALUE ':'.       06320001
063300     05  HL1-RUN-SECOND               PIC  X(02).                 06330001
063400*                                                                 06340006
063500 01  HEADER-LINE2.                                                06350001
063600     05  FILLER                       PIC  X(35) VALUE SPACES.    06360009
063700     05  FILLER                       PIC  X(44) VALUE            06370002
063800         'P O   L E G A C Y   D U P L I C A T E   S K'.           06380006
063900     05  FILLER                       PIC  X(17) VALUE            06390002
064000         ' U   R E P O R T'.                                      06400002
064100     05  FILLER                       PIC  X(22) VALUE SPACES.    06410009
064200     05  FILLER                       PIC  X(06) VALUE 'PAGE: '.  06420001
064300     05  HL2-PAGE                     PIC  ZZZZ,ZZZ.              06430001
064400*                                                                 06440006
064500 01  HEADER-LINE3.                                                06450002
064600     05  FILLER                       PIC  X(56) VALUE SPACES.    06460009
064700     05  FILLER                       PIC  X(19) VALUE            06470002
064800         'A U D I T   M O D E'.                                   06480006
064900     05  FILLER                       PIC  X(57) VALUE SPACES.    06490009
065000*                                                                 06500006
065100 01  HEADER-LINE4.                                                06510002
065200     05  FILLER                       PIC  X(55) VALUE SPACES.    06520009
065300     05  FILLER                       PIC  X(21) VALUE            06530002
065400         'U P D A T E   M O D E'.                                 06540006
065500     05  FILLER                       PIC  X(56) VALUE SPACES.    06550009
065600*                                                                 06560015
065700 01  HEADER-LINE5.                                                06570016
065800     05  FILLER                       PIC  X(57) VALUE SPACES.    06580015
065900     05  FILLER                       PIC  X(17) VALUE            06590015
066000         'P A C K   M O D E'.                                     06600015
066100     05  FILLER                       PIC  X(58) VALUE SPACES.    06610015
066200*                                                                 06620006
066300 01  DETAIL-HEADING-1.                                            06630005
066400     05  FILLER                       PIC  X(07) VALUE SPACES.    06640005
066500     05  FILLER                       PIC  X(04) VALUE            06650012
066600         'DEPT'.                                                  06660012
066700     05  FILLER                       PIC  X(03) VALUE SPACES.    06670005
066800     05  FILLER                       PIC  X(10) VALUE            06680012
066900         'OTB PERIOD'.                                            06690012
067000     05  FILLER                       PIC  X(03) VALUE SPACES.    06700005
067100     05  FILLER                       PIC  X(06) VALUE            06710005
067200         'PO NBR'.                                                06720005
067300     05  FILLER                       PIC  X(06) VALUE SPACES.    06730005
067400     05  FILLER                       PIC  X(09) VALUE            06740005
067500         'PO STATUS'.                                             06750005
067600     05  FILLER                       PIC  X(03) VALUE SPACES.    06760005
067700     05  FILLER                       PIC  X(08) VALUE            06770005
067800         'ITEM NBR'.                                              06780005
067900     05  FILLER                       PIC  X(10) VALUE SPACES.    06790005
068000     05  FILLER                       PIC  X(08) VALUE            06800005
068100         'LINE NBR'.                                              06810005
068200     05  FILLER                       PIC  X(04) VALUE SPACES.    06820005
068300     05  FILLER                       PIC  X(11) VALUE            06830005
068400         'LINE STATUS'.                                           06840005
068500     05  FILLER                       PIC  X(03) VALUE SPACES.    06850005
068600     05  FILLER                       PIC  X(11) VALUE            06860005
068700         'RMS SKU NBR'.                                           06870005
068800     05  FILLER                       PIC  X(03) VALUE SPACES.    06880005
068900     05  FILLER                       PIC  X(16) VALUE            06890005
069000         'RECEIPT ACTIVITY'.                                      06900041
069100     05  FILLER                       PIC  X(07) VALUE SPACES.    06910005
069200*                                                                 06920006
069300 01  DETAIL-HDG-1-BRK.                                            06930006
069400     05  FILLER                       PIC  X(07) VALUE SPACES.    06940005
069500     05  FILLER                       PIC  X(04) VALUE            06950012
069600         '----'.                                                  06960012
069700     05  FILLER                       PIC  X(03) VALUE SPACES.    06970005
069800     05  FILLER                       PIC  X(10) VALUE            06980012
069900         '----------'.                                            06990012
070000     05  FILLER                       PIC  X(03) VALUE SPACES.    07000005
070100     05  FILLER                       PIC  X(09) VALUE            07010005
070200         '---------'.                                             07020005
070300     05  FILLER                       PIC  X(03) VALUE SPACES.    07030005
070400     05  FILLER                       PIC  X(09) VALUE            07040005
070500         '---------'.                                             07050005
070600     05  FILLER                       PIC  X(03) VALUE SPACES.    07060005
070700     05  FILLER                       PIC  X(15) VALUE            07070005
070800         '---------------'.                                       07080005
070900     05  FILLER                       PIC  X(03) VALUE SPACES.    07090005
071000     05  FILLER                       PIC  X(09) VALUE            07100005
071100         '---------'.                                             07110005
071200     05  FILLER                       PIC  X(03) VALUE SPACES.    07120005
071300     05  FILLER                       PIC  X(11) VALUE            07130005
071400         '-----------'.                                           07140005
071500     05  FILLER                       PIC  X(03) VALUE SPACES.    07150005
071600     05  FILLER                       PIC  X(11) VALUE            07160005
071700         '-----------'.                                           07170005
071800     05  FILLER                       PIC  X(03) VALUE SPACES.    07180005
071900     05  FILLER                       PIC  X(16) VALUE            07190005
072000         '----------------'.                                      07200005
072100     05  FILLER                       PIC  X(07) VALUE SPACES.    07210005
072200*                                                                 07220006
072300 01  DETAIL-LINE-1.                                               07230005
072400     05  FILLER                       PIC  X(07) VALUE SPACES.    07240005
072500     05  DL1-DEPT-NBR                 PIC  X(03).                 07250005
072600     05  FILLER                       PIC  X(04) VALUE SPACES.    07260005
072700     05  DL1-OTB-PER-NBR              PIC  X(07).                 07270019
072800     05  FILLER                       PIC  X(06) VALUE SPACES.    07280019
072900     05  DL1-PO-NBR                   PIC  ZZ9(7).                07290012
073000     05  DL1-PO-NBR-SPACES REDEFINES                              07300012
073100         DL1-PO-NBR                   PIC  X(09).                 07310012
073200     05  FILLER                       PIC  X(03) VALUE SPACES.    07320005
073300     05  DL1-PURCHS-STATUS-CDE        PIC  X(02).                 07330012
073400     05  FILLER                       PIC  X(08) VALUE SPACES.    07340019
073500     05  DL1-DELETE-SKU               PIC  X(01).                 07350019
073600     05  FILLER                       PIC  X(01) VALUE SPACES.    07360019
073700     05  DL1-ITM-NBR                  PIC  Z(15).                 07370019
073800     05  FILLER                       PIC  X(03) VALUE SPACES.    07380005
073900     05  DL1-PO-LNE-NBR               PIC  Z(9).                  07390019
074000     05  FILLER                       PIC  X(03) VALUE SPACES.    07400005
074100     05  DL1-PURITM-STATUS-CDE        PIC  X(02).                 07410005
074200     05  FILLER                       PIC  X(12) VALUE SPACES.    07420005
074300     05  DL1-RMS-PO-SKU-NBR           PIC  Z(8).                  07430012
074400     05  FILLER                       PIC  X(06) VALUE SPACES.    07440005
074500     05  DL1-RECEIPT-ACTIVITY         PIC  X(03).                 07450005
074600     05  FILLER                       PIC  X(20) VALUE SPACES.    07460005
074700*                                                                 07470006
074800 01  BLANK-REPORT-LINE.                                           07480005
074900     05  FILLER                         PIC X(132) VALUE SPACES.  07490005
075000*                                                                 07500006
075100/                                                                 07510001
075200******************************************************************07520001
075300*  COMMUNICATIONS AREA FOR DB2                                    07530001
075400******************************************************************07540001
075500     EXEC SQL                                                     07550001
075600          INCLUDE SQLCA                                           07560001
075700     END-EXEC.                                                    07570001
075800/                                                                 07580012
075900******************************************************************07590001
076000*  COPY BOOK FOR PURCHASE ORDER TABLE                             07600001
076100******************************************************************07610001
076200     EXEC SQL                                                     07620001
076300          INCLUDE TPURCHS                                         07630001
076400     END-EXEC.                                                    07640001
076500/                                                                 07650012
076600******************************************************************07660001
076700*  COPY BOOK FOR PURCHASE ITEM TABLE                              07670001
076800******************************************************************07680001
076900     EXEC SQL                                                     07690001
077000          INCLUDE TPURITM                                         07700001
077100     END-EXEC.                                                    07710001
077200/                                                                 07720012
077300******************************************************************07730001
077400*  COPY BOOK FOR                                                  07740002
077500******************************************************************07750001
077600     EXEC SQL                                                     07760001
077700          INCLUDE TRECITM                                         07770012
077800     END-EXEC.                                                    07780001
077900/                                                                 07790012
078000******************************************************************07800019
078100*  COPY BOOK FOR                                                  07810019
078200******************************************************************07820019
078300*    EXEC SQL                                                     07830057
078400*         INCLUDE POT00003                                        07840057
078500*    END-EXEC.                                                    07850057
078600/                                                                 07860019
078700******************************************************************07870021
078800*  COPY BOOK FOR                                                  07880021
078900******************************************************************07890021
079000     EXEC SQL                                                     07900021
079100          INCLUDE TPOPRPK                                         07910021
079200     END-EXEC.                                                    07920021
079300/                                                                 07930021
079400******************************************************************07940021
079500*  COPY BOOK FOR                                                  07950021
079600******************************************************************07960021
079700     EXEC SQL                                                     07970021
079800          INCLUDE TPOINST                                         07980021
079900     END-EXEC.                                                    07990021
080000/                                                                 08000021
080100******************************************************************08010023
080200*  COPY BOOK FOR                                                  08020023
080300******************************************************************08030023
080400     EXEC SQL                                                     08040023
080500          INCLUDE TMESTDS                                         08050023
080600     END-EXEC.                                                    08060023
080700/                                                                 08070023
080800******************************************************************08080023
080900*  COPY BOOK FOR                                                  08090023
081000******************************************************************08100023
081100     EXEC SQL                                                     08110023
081200          INCLUDE TALLPLN                                         08120023
081300     END-EXEC.                                                    08130023
081400/                                                                 08140023
081500******************************************************************08150021
081600* THIS QUERY WILL SELECT ALL PO/LINES THAT ARE DUPLICATE SKU'S FOR08160006
081700* ORDERS THAT ARE PRE-APPROVAL.  STATUS-CDE OF WK, FE, PA.        08170006
081800******************************************************************08180002
081900     EXEC SQL                                                     08190002
082000       DECLARE PRE-APRVL-PACK-CSR CURSOR FOR                      08200016
082100         SELECT P.OTB_PER_NBR                                     08210016
082200               ,P.DEPT_NBR                                        08220016
082300               ,P.PO_NBR                                          08230016
082400               ,P.STATUS_CDE                                      08240016
082500               ,I.PO_LNE_NBR                                      08250016
082600               ,I.ITM_NBR                                         08260016
082700               ,I.STATUS_CDE                                      08270016
082800               ,I.RMS_PO_SKU_NBR                                  08280016
082900           FROM TPURCHS P                                         08290016
083000               ,TPURITM I                                         08300016
083100          WHERE P.VER_STATUS_CDE   = 'A'                          08310016
083200            AND P.STATUS_CDE      IN ('WK','FE','PA')             08320016
083300            AND P.OTB_PER_NBR     >= :PV-OTB-LOW-DTE              08330016
083400            AND I.PO_PREPK_ID      =  0                           08340016
083500* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******08350027
083600*           AND P.PO_NBR          IN (1966046,1919303)            08360047
083700*                                    ,2003467                     08370040
083800*                                    ,2003470)                    08380040
083900* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******08390027
084000            AND I.PO_NBR           =  P.PO_NBR                    08400027
084100            AND I.PO_LNE_NBR       >  0                           08410016
084200            AND I.VER_STATUS_CDE   = 'A'                          08420016
084300            AND I.SKU_SEQ_NBR NOT IN ('000', '999')               08430016
084400            AND EXISTS                                            08440016
084500               (SELECT *                                          08450016
084600                  FROM TPURCHS C                                  08460016
084700                      ,TPURITM D                                  08470016
084800                 WHERE C.PO_NBR           =  P.PO_NBR             08480016
084900                   AND C.VER_STATUS_CDE   = 'A'                   08490016
085000                   AND C.STATUS_CDE      IN ('WK','FE','PA')      08500016
085100                   AND C.OTB_PER_NBR     >= :PV-OTB-LOW-DTE       08510016
085200                   AND D.PO_NBR           =  C.PO_NBR             08520016
085300                   AND D.VER_STATUS_CDE   = 'A'                   08530016
085400                   AND D.PO_PREPK_ID      =  0                    08540016
085500                   AND D.PO_LNE_NBR      <> I.PO_LNE_NBR          08550016
085600                   AND D.ITM_NBR          =  I.ITM_NBR            08560016
085700                   AND D.SKU_SEQ_NBR NOT IN ('000', '999'))       08570016
085800       ORDER BY P.DEPT_NBR                                        08580016
085900               ,P.OTB_PER_NBR                                     08590016
086000               ,P.PO_NBR                                          08600016
086100               ,I.ITM_NBR                                         08610016
086200               ,I.PO_LNE_NBR                                      08620016
086300     END-EXEC.                                                    08630006
086400/                                                                 08640012
086500******************************************************************08650006
086600*   THIS QUERY WILL SELECT ALL PO/LINES                           08660006
086700*   THAT ARE DUPLICATE SKU'S FOR ORDERS WHERE THE                 08670006
086800*     PO STATUS-CDE IS: 'AP' OR 'AC'                              08680006
086900*     LINE STATUS   IS: 'AP' OR 'AC',                             08690006
087000*   AND THERE ARE DUPLICATES WHERE THE                            08700006
087100*     LINE STATUS   IS: 'AP' OR 'AC'.                             08710006
087200******************************************************************08720006
087300     EXEC SQL                                                     08730006
087400       DECLARE ACTV-DUPA-PACK-CSR CURSOR FOR                      08740016
087500         SELECT P.OTB_PER_NBR                                     08750016
087600               ,P.DEPT_NBR                                        08760016
087700               ,P.PO_NBR                                          08770016
087800               ,P.STATUS_CDE                                      08780016
087900               ,I.PO_LNE_NBR                                      08790016
088000               ,I.ITM_NBR                                         08800016
088100               ,I.STATUS_CDE                                      08810016
088200               ,I.RMS_PO_SKU_NBR                                  08820016
088300           FROM TPURCHS P                                         08830016
088400               ,TPURITM I                                         08840016
088500          WHERE P.VER_STATUS_CDE   = 'A'                          08850016
088600            AND P.STATUS_CDE      IN ('AP','AC')                  08860016
088700            AND P.OTB_PER_NBR     >= :PV-OTB-HIGH-DTE             08870016
088800            AND I.PO_PREPK_ID      =  0                           08880016
088900* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******08890027
089000*           AND P.PO_NBR          IN (1966046,1919303)            08900047
089100*                                    ,2003467                     08910040
089200*                                    ,2003470)                    08920040
089300* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******08930027
089400            AND I.PO_NBR           =  P.PO_NBR                    08940016
089500            AND I.VER_NBR          >  0                           08950016
089600            AND I.PO_LNE_NBR       >  0                           08960016
089700            AND I.VER_STATUS_CDE   = 'A'                          08970016
089800            AND I.STATUS_CDE      IN ('AP','AC')                  08980016
089900            AND I.SKU_SEQ_NBR NOT IN ('000','999')                08990016
090000            AND EXISTS                                            09000016
090100               (SELECT *                                          09010016
090200                  FROM TPURCHS C                                  09020016
090300                      ,TPURITM D                                  09030016
090400                 WHERE C.PO_NBR           =  P.PO_NBR             09040016
090500                   AND C.VER_STATUS_CDE   = 'A'                   09050016
090600                   AND C.STATUS_CDE      IN ('AP','AC')           09060016
090700                   AND C.OTB_PER_NBR     >= :PV-OTB-HIGH-DTE      09070016
090800                   AND D.PO_NBR           =  C.PO_NBR             09080016
090900                   AND D.VER_NBR          >  0                    09090016
091000                   AND D.VER_STATUS_CDE   = 'A'                   09100016
091100                   AND D.STATUS_CDE      IN ('AP','AC')           09110016
091200                   AND D.PO_PREPK_ID      =  0                    09120016
091300                   AND D.PO_LNE_NBR      <> I.PO_LNE_NBR          09130016
091400                   AND D.ITM_NBR          = I.ITM_NBR             09140016
091500                   AND D.SKU_SEQ_NBR NOT IN ('000','999'))        09150016
091600       ORDER BY P.DEPT_NBR                                        09160016
091700               ,P.OTB_PER_NBR                                     09170016
091800               ,P.PO_NBR                                          09180016
091900               ,I.ITM_NBR                                         09190016
092000               ,I.PO_LNE_NBR                                      09200016
092100     END-EXEC.                                                    09210002
092200/                                                                 09220012
092300******************************************************************09230012
092400*  THIS QUERY WILL SELECT ALL PO/LINES THAT ARE DUPLICATE SKU'S   09240012
092500*  FOR ORDERS THAT ARE POST-APPROVAL, PO STATUS-CDE OF CA OR CM,  09250012
092600*  WHERE LINE STATUS IS 'AP' OR 'AC', AND THERE ARE DUPLICATES    09260012
092700*  WITH A LINE STATUS OF 'AP' OR 'AC'.                            09270012
092800*                                                                 09280012
092900******************************************************************09290012
093000     EXEC SQL                                                     09300012
093100       DECLARE ACTV-DUPC-PACK-CSR CURSOR FOR                      09310016
093200         SELECT P.OTB_PER_NBR                                     09320016
093300               ,P.DEPT_NBR                                        09330016
093400               ,P.PO_NBR                                          09340016
093500               ,P.STATUS_CDE                                      09350016
093600               ,I.PO_LNE_NBR                                      09360016
093700               ,I.ITM_NBR                                         09370016
093800               ,I.STATUS_CDE                                      09380016
093900               ,I.RMS_PO_SKU_NBR                                  09390016
094000           FROM TPURCHS P                                         09400016
094100               ,TPURITM I                                         09410016
094200          WHERE P.VER_STATUS_CDE   = 'A'                          09420016
094300            AND P.STATUS_CDE      IN ('CA')                       09430016
094400            AND P.OTB_PER_NBR     >= :PV-OTB-HIGH-DTE             09440016
094500            AND I.PO_PREPK_ID      = 0                            09450016
094600* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******09460027
094700*           AND P.PO_NBR          IN (1966046,1919303)            09470047
094800*                                    ,2003467                     09480040
094900*                                    ,2003470)                    09490040
095000* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******09500027
095100            AND I.PO_NBR           = P.PO_NBR                     09510016
095200            AND I.VER_NBR          > 0                            09520016
095300            AND I.PO_LNE_NBR       > 0                            09530016
095400            AND I.VER_STATUS_CDE   = 'A'                          09540016
095500            AND I.STATUS_CDE      IN ('AP','AC')                  09550016
095600            AND I.SKU_SEQ_NBR NOT IN ('000','999')                09560016
095700            AND EXISTS                                            09570016
095800               (SELECT *                                          09580016
095900                  FROM TPURCHS C                                  09590016
096000                      ,TPURITM D                                  09600016
096100                 WHERE C.PO_NBR           = P.PO_NBR              09610016
096200                   AND C.VER_STATUS_CDE   = 'A'                   09620016
096300                   AND C.STATUS_CDE      IN ('CA')                09630016
096400                   AND C.OTB_PER_NBR     >= :PV-OTB-HIGH-DTE      09640016
096500                   AND D.PO_NBR           = C.PO_NBR              09650016
096600                   AND D.VER_NBR          > 0                     09660016
096700                   AND D.VER_STATUS_CDE   = 'A'                   09670016
096800                   AND D.STATUS_CDE      IN ('AP','AC')           09680016
096900                   AND D.PO_PREPK_ID      = 0                     09690016
097000                   AND D.PO_LNE_NBR      <> I.PO_LNE_NBR          09700016
097100                   AND D.ITM_NBR          = I.ITM_NBR             09710016
097200                   AND D.SKU_SEQ_NBR NOT IN ('000','999'))        09720016
097300       ORDER BY P.DEPT_NBR                                        09730016
097400               ,P.OTB_PER_NBR                                     09740016
097500               ,P.PO_NBR                                          09750016
097600               ,I.ITM_NBR                                         09760016
097700               ,I.PO_LNE_NBR                                      09770016
097800     END-EXEC.                                                    09780012
097900/                                                                 09790012
098000******************************************************************09800012
098100*  THIS QUERY WILL SELECT ALL PO/LINES THAT ARE DUPLICATE SKU'S   09810012
098200*  FOR ORDERS THAT ARE POST-APPROVAL, PO STATUS-CDE OF AP, AC,    09820012
098300*  CA, CM LINE STATUS IS CA.                                      09830012
098400******************************************************************09840012
098500     EXEC SQL                                                     09850012
098600       DECLARE CNCL-DUPL-PACK-CSR CURSOR WITH HOLD FOR            09860028
098700         SELECT P.OTB_PER_NBR                                     09870016
098800               ,P.DEPT_NBR                                        09880016
098900               ,P.PO_NBR                                          09890016
099000               ,P.STATUS_CDE                                      09900016
099100               ,I.PO_LNE_NBR                                      09910016
099200               ,I.ITM_NBR                                         09920016
099300               ,I.STATUS_CDE                                      09930016
099400               ,I.RMS_PO_SKU_NBR                                  09940016
099500               ,I.LAST_UPD_TMST                                   09950016
099600               ,I.APP_PO_LNE_NBR                                  09960040
099700           FROM TPURCHS P                                         09970016
099800               ,TPURITM I                                         09980016
099900          WHERE P.VER_STATUS_CDE   = 'A'                          09990016
100000            AND P.STATUS_CDE      IN ('AP','AC','CA')             10000016
100100            AND P.OTB_PER_NBR     >= :PV-OTB-HIGH-DTE             10010016
100200* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******10020027
100300*           AND P.PO_NBR          IN (1966046,1919303)            10030047
100400*                                    ,2003467                     10040040
100500*                                    ,2003470)                    10050040
100600* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******10060027
100700            AND I.PO_PREPK_ID      = 0                            10070016
100800            AND I.PO_NBR           = P.PO_NBR                     10080016
100900            AND I.VER_NBR          > 0                            10090016
101000            AND I.PO_LNE_NBR       > 0                            10100016
101100            AND I.VER_STATUS_CDE   = 'A'                          10110016
101200            AND I.STATUS_CDE      IN ('CA')                       10120016
101300            AND I.SKU_SEQ_NBR NOT IN ('000','999')                10130016
101400            AND EXISTS                                            10140016
101500               (SELECT *                                          10150018
101600                  FROM TPURCHS C                                  10160018
101700                      ,TPURITM D                                  10170018
101800                 WHERE C.PO_NBR           = P.PO_NBR              10180018
101900                   AND C.VER_STATUS_CDE   = 'A'                   10190018
102000                   AND C.STATUS_CDE      IN ('AP','AC','CA')      10200018
102100                   AND C.OTB_PER_NBR     >= :PV-OTB-HIGH-DTE      10210018
102200                   AND D.PO_NBR           = C.PO_NBR              10220018
102300                   AND D.VER_NBR          > 0                     10230018
102400                   AND D.VER_STATUS_CDE   = 'A'                   10240018
102500                   AND D.PO_PREPK_ID      = 0                     10250018
102600                   AND D.PO_LNE_NBR      <> I.PO_LNE_NBR          10260018
102700                   AND D.ITM_NBR          = I.ITM_NBR             10270018
102800                   AND D.SKU_SEQ_NBR NOT IN ('000', '999'))       10280018
102900          ORDER BY P.DEPT_NBR                                     10290018
103000                  ,P.PO_NBR                                       10300018
103100                  ,I.ITM_NBR                                      10310018
103200                  ,I.LAST_UPD_TMST DESC                           10320040
103300                  ,P.OTB_PER_NBR                                  10330018
103400     END-EXEC.                                                    10340012
103500/                                                                 10350012
103600******************************************************************10360019
103700*  THIS QUERY WILL SELECT ALL PO LINES THAT CONTAIN DUPLICATE     10370019
103800*  SKU'S THAT WILL BE CONVERTED INTO PACK PO'S AND/OR PACK SKU'S  10380019
103900******************************************************************10390019
104000     EXEC SQL                                                     10400019
104100       DECLARE PACK-PRCS-PACK-CSR CURSOR WITH HOLD FOR            10410028
104200         SELECT DISTINCT                                          10420019
104300                P.OTB_PER_NBR                                     10430019
104400               ,P.DEPT_NBR                                        10440019
104500               ,P.PO_NBR                                          10450019
104600               ,P.STATUS_CDE                                      10460019
104700               ,P.PKGNG_CDE                                       10470019
104800           FROM TPURCHS P                                         10480019
104900               ,TPURITM I                                         10490019
105000          WHERE P.VER_STATUS_CDE   = 'A'                          10500019
105100            AND P.STATUS_CDE      IN ('AP','AC','CA','CM')        10510019
105200            AND P.OTB_PER_NBR     >= :PV-OTB-LOW-DTE              10520019
105300* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******10530027
105400*           AND P.PO_NBR          IN (1966046,1919303)            10540047
105500*                                    ,2003467                     10550040
105600*                                    ,2003470)                    10560040
105700* TKMA888 ADDED FOR UPDATE TESTING * REMOVE B4 MOVE TO PROD ******10570027
105800            AND I.PO_PREPK_ID      = 0                            10580019
105900            AND I.PO_NBR           = P.PO_NBR                     10590019
106000            AND I.VER_NBR          > 0                            10600019
106100            AND I.PO_LNE_NBR       > 0                            10610019
106200            AND I.VER_STATUS_CDE   = 'A'                          10620019
106300            AND I.SKU_SEQ_NBR NOT IN ('000','999')                10630019
106400            AND EXISTS                                            10640019
106500               (SELECT *                                          10650019
106600                  FROM TPURCHS C                                  10660019
106700                      ,TPURITM D                                  10670019
106800                 WHERE C.PO_NBR           = P.PO_NBR              10680019
106900                   AND C.VER_STATUS_CDE   = 'A'                   10690019
107000                   AND C.STATUS_CDE      IN ('AP','AC','CA','CM') 10700019
107100                   AND C.OTB_PER_NBR     >= :PV-OTB-LOW-DTE       10710019
107200                   AND D.PO_NBR           = C.PO_NBR              10720019
107300                   AND D.VER_NBR          > 0                     10730019
107400                   AND D.VER_STATUS_CDE   = 'A'                   10740019
107500                   AND D.PO_PREPK_ID      = 0                     10750019
107600                   AND D.PO_LNE_NBR      <> I.PO_LNE_NBR          10760019
107700                   AND D.ITM_NBR          = I.ITM_NBR             10770019
107800                   AND D.SKU_SEQ_NBR NOT IN ('000', '999'))       10780019
107900          ORDER BY P.DEPT_NBR                                     10790019
108000                  ,P.OTB_PER_NBR                                  10800019
108100                  ,P.PO_NBR                                       10810019
108200     END-EXEC.                                                    10820019
108300/                                                                 10830019
108400******************************************************************10840021
108500*  THIS QUERY WILL SELECT ALL PO LINE ITEMS FOR A PO THAT NEED TO 10850021
108600*  BE CHANGED TO PACKS                                            10860021
108700******************************************************************10870021
108800     EXEC SQL                                                     10880021
108900       DECLARE PPUPDT-ITM-CSR CURSOR FOR                          10890021
109000         SELECT PO_NBR                                            10900021
109100               ,VER_NBR                                           10910033
109200               ,PO_LNE_NBR                                        10920033
109300               ,VER_STATUS_CDE                                    10930033
109400               ,SKU_SEQ_NBR                                       10940033
109500               ,CL_NBR                                            10950033
109600               ,VEND_STYL_NAME                                    10960033
109700               ,COLOR_DESC                                        10970033
109800               ,SIZE_DESC                                         10980033
109900               ,UM_IND                                            10990033
110000               ,UNT_QTY                                           11000033
110100               ,UNT_RTL_PR_AMT                                    11010033
110200               ,UNT_COST_AMT                                      11020033
110300               ,TOT_VAL_COST_AMT                                  11030033
110400               ,TOT_VAL_RTL_AMT                                   11040033
110500               ,MU_PCT                                            11050033
110600               ,CRE_TMST                                          11060033
110700               ,LAST_UPD_TMST                                     11070033
110800               ,ITM_NBR                                           11080033
110900               ,SKU_DESC                                          11090033
111000               ,COLOR_CDE                                         11100033
111100               ,SIZE_CDE                                          11110033
111200               ,AD_EVNT_DTE                                       11120033
111300               ,STATUS_CDE                                        11130033
111400               ,CRE_BY_UID                                        11140033
111500               ,LAST_UPD_BY_UID                                   11150033
111600               ,GP_RTL_AMT                                        11160033
111700               ,GP_QTY                                            11170033
111800               ,APP_PO_LNE_NBR                                    11180033
111900               ,PIC_ITM_IND                                       11190033
112000               ,PIC_PG_NBR                                        11200033
112100               ,PRD_1ST_COST_AMT                                  11210033
112200               ,STAT_TMST                                         11220033
112300               ,PO_PREPK_ID                                       11230033
112400               ,PREPK_RATO_QTY                                    11240033
112500               ,SHIP_TO_TMP_DC_IND                                11250033
112600               ,RMS_PO_SKU_NBR                                    11260033
112700               ,CNCLD_UNT_QTY                                     11270033
112800           FROM TPURITM                                           11280021
112900          WHERE PO_NBR           = :PURCHS-PO-NBR                 11290021
113000            AND VER_STATUS_CDE   = 'A'                            11300021
113100            AND PO_PREPK_ID      = 0                              11310039
113200          ORDER                                                   11320021
113300             BY PO_NBR                                            11330021
113400               ,PO_LNE_NBR                                        11340021
113500     END-EXEC.                                                    11350021
113600/                                                                 11360021
113700 PROCEDURE DIVISION.                                              11370021
113800******************************************************************11380021
113900*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   11390001
114000******************************************************************11400001
114100 0000-MAINLINE.                                                   11410001
114200*                                                                 11420006
114300     PERFORM 1000-INITIALIZE.                                     11430001
114400     PERFORM 3100-PRE-APPRVL-DUPLICATE-SKU.                       11440008
114500     PERFORM 3200-ACTV-DUPA-SKU-ON-ACTV-PO.                       11450016
114600     PERFORM 3300-ACTV-DUPC-SKU-ON-CNCL-PO.                       11460018
114700     PERFORM 3400-CANCELLED-DUPLICATE-SKU.                        11470012
114800     PERFORM 3500-PACK-PROCESSING-SKU.                            11480015
114900     PERFORM 9000-END-PROCESSING.                                 11490019
115000     CLOSE INPUT-FILE                                             11500001
115100           PORPT-FILE.                                            11510001
115200     GOBACK.                                                      11520006
115300*                                                                 11530006
115400/                                                                 11540006
115500******************************************************************11550001
115600*  OPENS THE FILES  READ INPUT FILE, INITS HEADER FIELDS          11560001
115700******************************************************************11570001
115800 1000-INITIALIZE.                                                 11580001
115900*                                                                 11590006
116000     OPEN INPUT  INPUT-FILE.                                      11600001
116100     OPEN OUTPUT PORPT-FILE.                                      11610001
116200*                                                                 11620006
116300     READ INPUT-FILE                                              11630001
116400         INTO IR-INPUT-RECORD                                     11640001
116500         AT END SET PS-EOF-INPUT-FILE                             11650001
116600                                   TO TRUE.                       11660001
116700     IF  PS-EOF-INPUT-FILE                                        11670001
116800         DISPLAY  '****** ABEND IN PROGRAM POKUP043 *******'      11680001
116900         DISPLAY  'EMPTY INPUT FILE'                              11690001
117000         MOVE +4003                TO PV-ABEND-CODE               11700001
117100         CALL 'ILBOABN0' USING PV-ABEND-CODE                      11710001
117200     END-IF.                                                      11720001
117300*                                                                 11730006
117400     DISPLAY '**** PROGRAM POKUP043 STARTED **************'.      11740009
117500     MOVE IR-RUN-MODE              TO PV-RUN-MODE.                11750015
117600     DISPLAY '**** RUN MODE STATUS INPUT    = ' PV-RUN-MODE.      11760020
117700     MOVE IR-OTB-LOW-DTE           TO PV-OTB-LOW-DTE.             11770016
117800     DISPLAY '**** OTB LOW DATE CARD INPUT  = ' PV-OTB-LOW-DTE.   11780020
117900     MOVE IR-OTB-HIGH-DTE          TO PV-OTB-HIGH-DTE.            11790016
118000     DISPLAY '**** OTB HIGH DATE CARD INPUT = ' PV-OTB-HIGH-DTE.  11800020
118100     DISPLAY '**** --------------------------------- *****'.      11810020
118200*                                                                 11820015
118300     STRING PV-OTB-HIGH-DTE(5:2) DELIMITED BY SIZE                11830019
118400            '-'                  DELIMITED BY SIZE                11840019
118500            PV-OTB-HIGH-DTE(1:4) DELIMITED BY SIZE                11850019
118600       INTO PC-CNCLDUPL-OTB-HIGH-DTE                              11860019
118700     END-STRING.                                                  11870019
118800     STRING PV-OTB-HIGH-DTE(5:2) DELIMITED BY SIZE                11880019
118900            '-'                  DELIMITED BY SIZE                11890019
119000            PV-OTB-HIGH-DTE(1:4) DELIMITED BY SIZE                11900019
119100       INTO PC-NO-CNCLDUPL-OTB-HIGH-DTE                           11910019
119200     END-STRING.                                                  11920019
119300*                                                                 11930019
119400     ACCEPT SD-SYSTEM-DATE FROM DATE.                             11940001
119500     MOVE SD-SYSTEM-MM             TO HL1-RUN-MONTH.              11950001
119600     MOVE SD-SYSTEM-DD             TO HL1-RUN-DAY.                11960001
119700     MOVE SD-SYSTEM-YY             TO HL1-RUN-YEAR.               11970001
119800*                                                                 11980006
119900     ACCEPT ST-SYSTEM-TIME FROM TIME.                             11990001
120000     MOVE ST-SYSTEM-HH             TO HL1-RUN-HOUR.               12000001
120100     MOVE ST-SYSTEM-MM             TO HL1-RUN-MINUTE.             12010001
120200     MOVE ST-SYSTEM-SS             TO HL1-RUN-SECOND.             12020001
120300*                                                                 12030006
120400     EXEC SQL                                                     12040021
120500         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 12050021
120600     END-EXEC.                                                    12060021
120700*                                                                 12070021
120800/                                                                 12080006
120900******************************************************************12090006
121000*                                                                 12100006
121100******************************************************************12110006
121200 3100-PRE-APPRVL-DUPLICATE-SKU.                                   12120008
121300*                                                                 12130006
121400     SET PRAPDUPL      TO TRUE                                    12140018
121500     SET PS-ROWS-FOUND TO TRUE                                    12150018
121600     PERFORM 3110-OPEN-PR-APRVL-CSR                               12160008
121700     MOVE +0  TO PV-PRAPDUPL-CNT                                  12170009
121800*                                                                 12180006
121900     PERFORM 3120-FETCH-PR-APRVL-CSR                              12190008
122000       UNTIL PS-EOF-PRE-APRVL-PACK-CSR                            12200006
122100*                                                                 12210006
122200     PERFORM 3130-CLOSE-PR-APRVL-CSR                              12220008
122300*                                                                 12230006
122400     IF PV-PRAPDUPL-CNT = +0                                      12240009
122500         SET PS-ROWS-NOT-FOUND TO TRUE                            12250018
122600         MOVE PC-NO-PREAPRVL-DUPL-SKU-TO-RPT                      12260006
122700           TO OR-RPT-LINE                                         12270006
122800         PERFORM 8000-WRITE-REPORT                                12280006
122900     END-IF.                                                      12290007
123000/                                                                 12300006
123100******************************************************************12310006
123200*  TPURCHS CURSOR OPERATION                                       12320006
123300******************************************************************12330006
123400 3110-OPEN-PR-APRVL-CSR.                                          12340008
123500*                                                                 12350006
123600     PERFORM                                                      12360006
123700         WITH TEST AFTER                                          12370006
123800         VARYING PV-RETRY-COUNTER                                 12380006
123900         FROM 1 BY 1                                              12390006
124000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12400006
124100            OR (SQLCODE = +0))                                    12410006
124200*                                                                 12420006
124300         EXEC SQL                                                 12430006
124400             OPEN PRE-APRVL-PACK-CSR                              12440006
124500         END-EXEC                                                 12450006
124600*                                                                 12460006
124700         EVALUATE TRUE                                            12470006
124800             WHEN SQLCODE = +0                                    12480006
124900             WHEN SQLCODE = -904                                  12490006
125000             WHEN SQLCODE = -913                                  12500006
125100                  CONTINUE                                        12510006
125200                                                                  12520006
125300             WHEN SQLWARN0 NOT = SPACE                            12530006
125400             WHEN SQLCODE  NOT = +0                               12540006
125500                  MOVE '3110-OPEN-PR-APRVL-CSR'                   12550008
125600                                   TO PV-PARAGRAPH-NAME           12560048
125700                  MOVE 'OPEN PRE-APRVL-PACK-CSR'                  12570006
125800                                   TO PV-DB2-OPERATION            12580048
125900                  PERFORM 9100-SQL-ABEND                          12590048
126400         END-EVALUATE                                             12640006
126500     END-PERFORM.                                                 12650006
126600                                                                  12660006
126700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12670006
126800         MOVE '3110-OPEN-PR-APRVL-CSR'                            12680048
125600                                   TO PV-PARAGRAPH-NAME           12681048
126900         MOVE 'MAX RETRIES EXCEED OPEN CURSOR'                    12690048
125800                                   TO PV-DB2-OPERATION            12691048
125900         PERFORM 9100-SQL-ABEND                                   12692048
127400     END-IF.                                                      12740006
127500/                                                                 12750006
127600******************************************************************12760006
127700*    FETCH A LINE ITEM ROW                                        12770006
127800******************************************************************12780006
127900 3120-FETCH-PR-APRVL-CSR.                                         12790008
128000*                                                                 12800006
128100     EXEC SQL                                                     12810006
128200         FETCH PRE-APRVL-PACK-CSR                                 12820006
128300          INTO                                                    12830006
128400             :PURCHS-OTB-PER-NBR                                  12840006
128500            ,:PURCHS-DEPT-NBR                                     12850006
128600            ,:PURCHS-PO-NBR                                       12860006
128700            ,:PURCHS-STATUS-CDE                                   12870006
128800            ,:PURITM-PO-LNE-NBR                                   12880006
128900            ,:PURITM-ITM-NBR                                      12890006
129000            ,:PURITM-STATUS-CDE                                   12900006
129100            ,:PURITM-RMS-PO-SKU-NBR                               12910006
129200     END-EXEC.                                                    12920006
129300*                                                                 12930006
129400     EVALUATE TRUE                                                12940006
129500         WHEN SQLCODE = +0                                        12950006
129600              ADD +1 TO PV-PRAPDUPL-CNT                           12960009
129700              PERFORM 3121-PRE-APRVL-PACK-RPT                     12970008
129800*                                                                 12980017
129900         WHEN SQLCODE = +100                                      12990017
130000              INITIALIZE DCLTPURCHS                               13000018
130100              INITIALIZE DCLTPURITM                               13010018
130200              MOVE 0               TO PV-HOLD-DEPT-NBR            13020027
130300              SET PS-EOF-PRE-APRVL-PACK-CSR                       13030017
130400                                   TO TRUE                        13040017
130500*                                                                 13050006
130600         WHEN SQLWARN0 NOT = SPACE                                13060006
130700         WHEN SQLCODE < +0                                        13070006
130800         WHEN SQLCODE > +0                                        13080006
130900              MOVE '3120-FETCH-PR-APRVL-CSR'                      13090008
125600                                   TO PV-PARAGRAPH-NAME           13100048
131100              MOVE 'FETCH PRE-APRVL-PACK-CSR'                     13110006
125800                                   TO PV-DB2-OPERATION            13111048
125900              PERFORM 9100-SQL-ABEND                              13125048
131700     END-EVALUATE.                                                13170006
131800/                                                                 13180006
131900******************************************************************13190006
132000* PRINT REPORT LINES FOR PRE-APPROVAL PACKS                       13200006
132100******************************************************************13210006
132200 3121-PRE-APRVL-PACK-RPT.                                         13220008
132300*                                                                 13230006
132400     MOVE PURITM-ITM-NBR        TO DL1-ITM-NBR.                   13240009
132500     MOVE PURITM-PO-LNE-NBR     TO DL1-PO-LNE-NBR.                13250009
132600     MOVE PURITM-STATUS-CDE     TO DL1-PURITM-STATUS-CDE.         13260009
132700     MOVE PURITM-RMS-PO-SKU-NBR TO DL1-RMS-PO-SKU-NBR.            13270009
132800     MOVE 'NO '                 TO DL1-RECEIPT-ACTIVITY.          13280012
132900     PERFORM 8000-WRITE-REPORT.                                   13290009
133000/                                                                 13300006
133100******************************************************************13310006
133200* CLOSE THE LINE ITEM CURSOR                                      13320006
133300******************************************************************13330006
133400 3130-CLOSE-PR-APRVL-CSR.                                         13340008
133500*                                                                 13350006
133600     EXEC SQL                                                     13360006
133700         CLOSE PRE-APRVL-PACK-CSR                                 13370006
133800     END-EXEC.                                                    13380006
133900*                                                                 13390006
134000     EVALUATE TRUE                                                13400006
134100         WHEN SQLCODE = +0                                        13410006
134200              CONTINUE                                            13420006
134300*                                                                 13430006
134400         WHEN SQLWARN0 NOT = SPACE                                13440006
134500         WHEN SQLCODE  NOT = +0                                   13450006
134600              MOVE '3130-CLOSE-PR-APRVL-CSR'                      13460008
125600                                   TO PV-PARAGRAPH-NAME           13470048
134800              MOVE 'CLOSE PRE-APRVL-PACK-CSR'                     13480006
125800                                   TO PV-DB2-OPERATION            13490048
125900              PERFORM 9100-SQL-ABEND                              13495048
135400     END-EVALUATE.                                                13540006
135500/                                                                 13550006
135600******************************************************************13560006
135700*                                                                 13570006
135800******************************************************************13580006
135900 3200-ACTV-DUPA-SKU-ON-ACTV-PO.                                   13590016
136000*                                                                 13600012
136100     SET ACTVDUPA TO TRUE                                         13610012
136200     SET PS-ROWS-FOUND TO TRUE                                    13620018
136300     PERFORM 3210-OPEN-ACTV-DUPA-CSR                              13630016
136400     MOVE +0  TO PV-ACTVDUPA-CNT                                  13640012
136500*                                                                 13650012
136600     PERFORM 3220-FETCH-ACTV-DUPA-CSR                             13660016
136700       UNTIL PS-EOF-ACTV-DUPA-PACK-CSR                            13670012
136800*                                                                 13680012
136900     PERFORM 3230-CLOSE-ACTV-DUPA-CSR                             13690016
137000*                                                                 13700012
137100     IF PV-ACTVDUPA-CNT = +0                                      13710012
137200         SET PS-ROWS-NOT-FOUND TO TRUE                            13720018
137300         MOVE PC-NO-ACTV-DUPA-SKU-TO-RPT                          13730018
137400           TO OR-RPT-LINE                                         13740012
137500         PERFORM 8000-WRITE-REPORT                                13750012
137600     END-IF.                                                      13760012
137700/                                                                 13770012
137800******************************************************************13780012
137900*  TPURCHS CURSOR OPERATION                                       13790012
138000******************************************************************13800012
138100 3210-OPEN-ACTV-DUPA-CSR.                                         13810016
138200*                                                                 13820012
138300     PERFORM                                                      13830012
138400         WITH TEST AFTER                                          13840012
138500         VARYING PV-RETRY-COUNTER                                 13850012
138600         FROM 1 BY 1                                              13860012
138700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13870012
138800            OR (SQLCODE = +0))                                    13880012
138900*                                                                 13890012
139000         EXEC SQL                                                 13900012
139100             OPEN ACTV-DUPA-PACK-CSR                              13910012
139200         END-EXEC                                                 13920012
139300*                                                                 13930012
139400         EVALUATE TRUE                                            13940012
139500             WHEN SQLCODE = +0                                    13950012
139600             WHEN SQLCODE = -904                                  13960012
139700             WHEN SQLCODE = -913                                  13970012
139800                  CONTINUE                                        13980012
139900                                                                  13990012
140000             WHEN SQLWARN0 NOT = SPACE                            14000012
140100             WHEN SQLCODE  NOT = +0                               14010012
140200                  MOVE '3210-OPEN-ACTV-DUPA-CSR'                  14020016
125600                                   TO PV-PARAGRAPH-NAME           14030050
140400                  MOVE 'OPEN ACTV-DUPA-PACK-CSR'                  14040012
125800                                   TO PV-DB2-OPERATION            14050050
125900                  PERFORM 9100-SQL-ABEND                          14050150
141100         END-EVALUATE                                             14110012
141200     END-PERFORM.                                                 14120012
141300                                                                  14130012
141400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14140012
141500         MOVE '3210-OPEN-ACTV-DUPA-CSR'                           14150050
125600                                   TO PV-PARAGRAPH-NAME           14151050
141600         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              14160012
125800                                   TO PV-DB2-OPERATION            14170050
125900         PERFORM 9100-SQL-ABEND                                   14170150
142100     END-IF.                                                      14210012
142200/                                                                 14220012
142300******************************************************************14230012
142400*    FETCH A LINE ITEM ROW                                        14240012
142500******************************************************************14250012
142600 3220-FETCH-ACTV-DUPA-CSR.                                        14260016
142700*                                                                 14270012
142800     EXEC SQL                                                     14280012
142900         FETCH ACTV-DUPA-PACK-CSR                                 14290012
143000          INTO                                                    14300012
143100             :PURCHS-OTB-PER-NBR                                  14310012
143200            ,:PURCHS-DEPT-NBR                                     14320012
143300            ,:PURCHS-PO-NBR                                       14330012
143400            ,:PURCHS-STATUS-CDE                                   14340012
143500            ,:PURITM-PO-LNE-NBR                                   14350012
143600            ,:PURITM-ITM-NBR                                      14360012
143700            ,:PURITM-STATUS-CDE                                   14370012
143800            ,:PURITM-RMS-PO-SKU-NBR                               14380012
143900     END-EXEC.                                                    14390012
144000*                                                                 14400012
144100     EVALUATE TRUE                                                14410012
144200         WHEN SQLCODE = +0                                        14420012
144300              ADD +1 TO PV-ACTVDUPA-CNT                           14430012
144400              PERFORM 3221-ACTV-DUPA-PACK-RPT                     14440016
144500*                                                                 14450012
144600         WHEN SQLCODE = +100                                      14460012
144700              INITIALIZE DCLTPURCHS                               14470018
144800              INITIALIZE DCLTPURITM                               14480018
144900              MOVE 0               TO PV-HOLD-DEPT-NBR            14490027
145000              SET PS-EOF-ACTV-DUPA-PACK-CSR                       14500012
145100                                   TO TRUE                        14510012
145200*                                                                 14520012
145300         WHEN SQLWARN0 NOT = SPACE                                14530012
145400         WHEN SQLCODE < +0                                        14540012
145500         WHEN SQLCODE > +0                                        14550012
145600              MOVE '3220-FETCH-ACTV-DUPA-CSR'                     14560016
125600                                   TO PV-PARAGRAPH-NAME           14561050
145800              MOVE 'FETCH ACTV-DUPA-PACK-CSR'                     14580012
125800                                   TO PV-DB2-OPERATION            14590050
125900              PERFORM 9100-SQL-ABEND                              14590150
146400     END-EVALUATE.                                                14640012
146500/                                                                 14650012
146600******************************************************************14660012
146700* PRINT REPORT LINES FOR ACTIVE DUPA  PACKS                       14670019
146800******************************************************************14680012
146900 3221-ACTV-DUPA-PACK-RPT.                                         14690016
147000*                                                                 14700012
147100     MOVE PURITM-ITM-NBR        TO DL1-ITM-NBR.                   14710012
147200     MOVE PURITM-PO-LNE-NBR     TO DL1-PO-LNE-NBR.                14720012
147300     MOVE PURITM-STATUS-CDE     TO DL1-PURITM-STATUS-CDE.         14730012
147400     MOVE PURITM-RMS-PO-SKU-NBR TO DL1-RMS-PO-SKU-NBR.            14740012
147500     MOVE ZEROES TO PV-SQL-REC-CNT.                               14750043
147600     PERFORM 5100-FIND-DC-RECEIPTS.                               14760012
147700     IF PV-SQL-REC-CNT > +0                                       14770018
147800         MOVE 'YES'             TO DL1-RECEIPT-ACTIVITY           14780012
147900     ELSE                                                         14790012
148000         MOVE 'NO '             TO DL1-RECEIPT-ACTIVITY           14800012
148100     END-IF.                                                      14810012
148200     PERFORM 8000-WRITE-REPORT.                                   14820012
148300/                                                                 14830012
148400******************************************************************14840012
148500* CLOSE THE LINE ITEM CURSOR                                      14850012
148600******************************************************************14860012
148700 3230-CLOSE-ACTV-DUPA-CSR.                                        14870016
148800*                                                                 14880012
148900     EXEC SQL                                                     14890012
149000         CLOSE ACTV-DUPA-PACK-CSR                                 14900012
149100     END-EXEC.                                                    14910012
149200*                                                                 14920012
149300     EVALUATE TRUE                                                14930012
149400         WHEN SQLCODE = +0                                        14940012
149500              CONTINUE                                            14950012
149600*                                                                 14960012
149700         WHEN SQLWARN0 NOT = SPACE                                14970012
149800         WHEN SQLCODE  NOT = +0                                   14980012
149900              MOVE '3230-CLOSE-ACTV-DUPA-CSR'                     14990016
125600                                   TO PV-PARAGRAPH-NAME           15000050
150100              MOVE 'CLOSE ACTV-DUPA-PACK-CSR'                     15010012
125600                                   TO PV-PARAGRAPH-NAME           15020050
125900              PERFORM 9100-SQL-ABEND                              15020150
150700     END-EVALUATE.                                                15070012
150800/                                                                 15080012
150900******************************************************************15090012
151000*                                                                 15100012
151100******************************************************************15110012
151200 3300-ACTV-DUPC-SKU-ON-CNCL-PO.                                   15120018
151300*                                                                 15130012
151400     SET ACTVDUPC TO TRUE                                         15140012
151500     SET PS-ROWS-FOUND TO TRUE                                    15150018
151600     PERFORM 3310-OPEN-ACTV-DUPC-CSR                              15160016
151700     MOVE +0  TO PV-ACTVDUPC-CNT                                  15170012
151800*                                                                 15180012
151900     PERFORM 3320-FETCH-ACTV-DUPC-CSR                             15190016
152000       UNTIL PS-EOF-ACTV-DUPC-PACK-CSR                            15200012
152100*                                                                 15210012
152200     PERFORM 3330-CLOSE-ACTV-DUPC-CSR                             15220016
152300*                                                                 15230012
152400     IF PV-ACTVDUPC-CNT = +0                                      15240012
152500         SET PS-ROWS-NOT-FOUND TO TRUE                            15250018
152600         MOVE PC-NO-ACTV-DUPC-SKU-TO-RPT                          15260018
152700           TO OR-RPT-LINE                                         15270012
152800         PERFORM 8000-WRITE-REPORT                                15280012
152900     END-IF.                                                      15290012
153000/                                                                 15300012
153100******************************************************************15310012
153200*  TPURCHS CURSOR OPERATION                                       15320012
153300******************************************************************15330012
153400 3310-OPEN-ACTV-DUPC-CSR.                                         15340016
153500*                                                                 15350012
153600     PERFORM                                                      15360012
153700         WITH TEST AFTER                                          15370012
153800         VARYING PV-RETRY-COUNTER                                 15380012
153900         FROM 1 BY 1                                              15390012
154000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15400012
154100            OR (SQLCODE = +0))                                    15410012
154200*                                                                 15420012
154300         EXEC SQL                                                 15430012
154400             OPEN ACTV-DUPC-PACK-CSR                              15440012
154500         END-EXEC                                                 15450012
154600*                                                                 15460012
154700         EVALUATE TRUE                                            15470012
154800             WHEN SQLCODE = +0                                    15480012
154900             WHEN SQLCODE = -904                                  15490012
155000             WHEN SQLCODE = -913                                  15500012
155100                  CONTINUE                                        15510012
155200                                                                  15520012
155300             WHEN SQLWARN0 NOT = SPACE                            15530012
155400             WHEN SQLCODE  NOT = +0                               15540012
155500                  MOVE '3310-OPEN-ACTV-DUPC-CSR'                  15550016
125600                                   TO PV-PARAGRAPH-NAME           15560050
155700                  MOVE 'OPEN ACTV-DUPC-PACK-CSR'                  15570012
125800                                   TO PV-DB2-OPERATION            15580050
125900              PERFORM 9100-SQL-ABEND                              15580150
156400         END-EVALUATE                                             15640012
156500     END-PERFORM.                                                 15650012
156600                                                                  15660012
156700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15670012
156800         MOVE '3310-OPEN-ACTV-DUPC-CSR'                           15680050
125600                                   TO PV-PARAGRAPH-NAME           15681050
156900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              15690012
125800                                   TO PV-DB2-OPERATION            15700050
125900         PERFORM 9100-SQL-ABEND                                   15700150
157400     END-IF.                                                      15740012
157500/                                                                 15750012
157600******************************************************************15760012
157700*    FETCH A LINE ITEM ROW                                        15770012
157800******************************************************************15780012
157900 3320-FETCH-ACTV-DUPC-CSR.                                        15790016
158000*                                                                 15800012
158100     EXEC SQL                                                     15810012
158200         FETCH ACTV-DUPC-PACK-CSR                                 15820012
158300          INTO                                                    15830012
158400             :PURCHS-OTB-PER-NBR                                  15840012
158500            ,:PURCHS-DEPT-NBR                                     15850012
158600            ,:PURCHS-PO-NBR                                       15860012
158700            ,:PURCHS-STATUS-CDE                                   15870012
158800            ,:PURITM-PO-LNE-NBR                                   15880012
158900            ,:PURITM-ITM-NBR                                      15890012
159000            ,:PURITM-STATUS-CDE                                   15900012
159100            ,:PURITM-RMS-PO-SKU-NBR                               15910012
159200     END-EXEC.                                                    15920012
159300*                                                                 15930012
159400     EVALUATE TRUE                                                15940012
159500         WHEN SQLCODE = +0                                        15950012
159600              ADD +1 TO PV-ACTVDUPC-CNT                           15960012
159700              PERFORM 3321-ACTV-DUPC-PACK-RPT                     15970016
159800*                                                                 15980012
159900         WHEN SQLCODE = +100                                      15990012
160000              INITIALIZE DCLTPURCHS                               16000018
160100              INITIALIZE DCLTPURITM                               16010018
160200              MOVE 0               TO PV-HOLD-DEPT-NBR            16020027
160300              SET PS-EOF-ACTV-DUPC-PACK-CSR                       16030012
160400                                   TO TRUE                        16040012
160500*                                                                 16050012
160600         WHEN SQLWARN0 NOT = SPACE                                16060012
160700         WHEN SQLCODE < +0                                        16070012
160800         WHEN SQLCODE > +0                                        16080012
160900              MOVE '3320-FETCH-ACTV-DUPC-CSR'                     16090016
125600                                   TO PV-PARAGRAPH-NAME           16100050
161100              MOVE 'FETCH ACTV-DUPC-PACK-CSR'                     16110012
125600                                   TO PV-PARAGRAPH-NAME           16120050
125900              PERFORM 9100-SQL-ABEND                              16120150
161700     END-EVALUATE.                                                16170012
161800/                                                                 16180012
161900******************************************************************16190012
162000* PRINT REPORT LINES FOR ACTIVE DUPC  PACKS                       16200019
162100******************************************************************16210012
162200 3321-ACTV-DUPC-PACK-RPT.                                         16220016
162300*                                                                 16230012
162400     MOVE PURITM-ITM-NBR        TO DL1-ITM-NBR.                   16240012
162500     MOVE PURITM-PO-LNE-NBR     TO DL1-PO-LNE-NBR.                16250012
162600     MOVE PURITM-STATUS-CDE     TO DL1-PURITM-STATUS-CDE.         16260012
162700     MOVE PURITM-RMS-PO-SKU-NBR TO DL1-RMS-PO-SKU-NBR.            16270012
162800     MOVE ZEROES TO PV-SQL-REC-CNT.                               16280044
162900     PERFORM 5100-FIND-DC-RECEIPTS.                               16290012
163000     IF PV-SQL-REC-CNT > +0                                       16300018
163100         MOVE 'YES'             TO DL1-RECEIPT-ACTIVITY           16310012
163200     ELSE                                                         16320012
163300         MOVE 'NO '             TO DL1-RECEIPT-ACTIVITY           16330012
163400     END-IF.                                                      16340012
163500     PERFORM 8000-WRITE-REPORT.                                   16350012
163600/                                                                 16360012
163700******************************************************************16370012
163800* CLOSE THE LINE ITEM CURSOR                                      16380012
163900******************************************************************16390012
164000 3330-CLOSE-ACTV-DUPC-CSR.                                        16400016
164100*                                                                 16410012
164200     EXEC SQL                                                     16420012
164300         CLOSE ACTV-DUPC-PACK-CSR                                 16430012
164400     END-EXEC.                                                    16440012
164500*                                                                 16450012
164600     EVALUATE TRUE                                                16460012
164700         WHEN SQLCODE = +0                                        16470012
164800              CONTINUE                                            16480012
164900*                                                                 16490012
165000         WHEN SQLWARN0 NOT = SPACE                                16500012
165100         WHEN SQLCODE  NOT = +0                                   16510012
165200              MOVE '3330-CLOSE-ACTV-DUPC-CSR'                     16520016
125600                                   TO PV-PARAGRAPH-NAME           16530050
165400              MOVE 'CLOSE ACTV-DUPC-PACK-CSR'                     16540012
125800                                   TO PV-DB2-OPERATION            16550050
125900              PERFORM 9100-SQL-ABEND                              16550150
166000     END-EVALUATE.                                                16600012
166100/                                                                 16610006
166200******************************************************************16620006
166300*                                                                 16630006
166400******************************************************************16640006
166500 3400-CANCELLED-DUPLICATE-SKU.                                    16650012
166600*                                                                 16660006
166700     SET CNCLDUPL TO TRUE.                                        16670013
166800     SET PS-ROWS-FOUND TO TRUE                                    16680018
166900     PERFORM 3410-OPEN-CNCL-DUPL-CSR.                             16690013
167000*                                                                 16700012
167100     MOVE +0        TO PV-CNCLDUPL-CNT                            16710013
167200                       PV-LNE-SUB-LST                             16720013
167300                       PV-LNE-SUB.                                16730013
167400     PERFORM 3420-FETCH-CNCL-DUPL-CSR                             16740012
167500       UNTIL PS-EOF-CNCL-DUPL-PACK-CSR.                           16750013
167600*                                                                 16760012
167700     PERFORM 3430-CLOSE-CNCL-DUPL-CSR.                            16770013
167800*                                                                 16780012
167900     IF PV-CNCLDUPL-CNT = +0                                      16790012
168000         SET PS-ROWS-NOT-FOUND TO TRUE                            16800018
168100         MOVE PC-NO-CNCLD-DUPL-SKU-TO-RPT                         16810012
168200           TO OR-RPT-LINE                                         16820012
168300         PERFORM 8000-WRITE-REPORT                                16830012
168400     END-IF.                                                      16840018
168500/                                                                 16850018
168600******************************************************************16860018
168700*  TPURCHS CURSOR OPERATION                                       16870018
168800******************************************************************16880018
168900 3410-OPEN-CNCL-DUPL-CSR.                                         16890018
169000*                                                                 16900018
169100     PERFORM                                                      16910018
169200         WITH TEST AFTER                                          16920018
169300         VARYING PV-RETRY-COUNTER                                 16930018
169400         FROM 1 BY 1                                              16940018
169500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16950018
169600            OR (SQLCODE = +0))                                    16960018
169700*                                                                 16970018
169800         EXEC SQL                                                 16980018
169900             OPEN CNCL-DUPL-PACK-CSR                              16990018
170000         END-EXEC                                                 17000018
170100*                                                                 17010018
170200         EVALUATE TRUE                                            17020018
170300             WHEN SQLCODE = +0                                    17030018
170400             WHEN SQLCODE = -904                                  17040018
170500             WHEN SQLCODE = -913                                  17050018
170600                  CONTINUE                                        17060018
170700                                                                  17070018
170800             WHEN SQLWARN0 NOT = SPACE                            17080018
170900             WHEN SQLCODE  NOT = +0                               17090018
171000                  MOVE '3410-OPEN-CNCL-DUPL-CSR'                  17100018
125600                                   TO PV-PARAGRAPH-NAME           17110050
171200                  MOVE 'OPEN CNCL-DUPL-PACK-CSR'                  17120018
125800                                   TO PV-DB2-OPERATION            17130050
125900                  PERFORM 9100-SQL-ABEND                          17130150
171900         END-EVALUATE                                             17190018
172000     END-PERFORM.                                                 17200018
172100                                                                  17210018
172200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17220018
172300         MOVE '3410-OPEN-CNCL-DUPL-CSR'                           17230050
125600                                   TO PV-PARAGRAPH-NAME           17231050
172400         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              17240018
125800                                   TO PV-DB2-OPERATION            17250050
125900         PERFORM 9100-SQL-ABEND                                   17250150
172900     END-IF.                                                      17290018
173000/                                                                 17300018
173100******************************************************************17310018
173200*    FETCH A LINE ITEM ROW                                        17320018
173300******************************************************************17330018
173400 3420-FETCH-CNCL-DUPL-CSR.                                        17340018
173500*                                                                 17350018
173600     EXEC SQL                                                     17360018
173700         FETCH CNCL-DUPL-PACK-CSR                                 17370018
173800          INTO                                                    17380018
173900             :PURCHS-OTB-PER-NBR                                  17390018
174000            ,:PURCHS-DEPT-NBR                                     17400018
174100            ,:PURCHS-PO-NBR                                       17410018
174200            ,:PURCHS-STATUS-CDE                                   17420018
174300            ,:PURITM-PO-LNE-NBR                                   17430012
174400            ,:PURITM-ITM-NBR                                      17440012
174500            ,:PURITM-STATUS-CDE                                   17450012
174600            ,:PURITM-RMS-PO-SKU-NBR                               17460012
174700            ,:PURITM-LAST-UPD-TMST                                17470013
174800            ,:PURITM-APP-PO-LNE-NBR                               17480040
174900     END-EXEC.                                                    17490012
175000*                                                                 17500012
175100     EVALUATE TRUE                                                17510012
175200         WHEN SQLCODE = +0                                        17520012
175300              ADD +1 TO PV-CNCLDUPL-CNT                           17530012
175400                        PV-LNE-SUB                                17540013
175500              IF PV-LNE-SUB = +1                                  17550013
175600                  PERFORM 3421-TBL-CNCL-DUPL-PACK                 17560013
175700              ELSE                                                17570013
175800                  IF ((PURCHS-PO-NBR NOT =                        17580014
175900                       PLT-PO-NBR(PV-LNE-SUB - 1)) OR             17590014
176000                      (PURITM-ITM-NBR NOT =                       17600013
176100                       PLT-ITM-NBR(PV-LNE-SUB - 1)))              17610014
176200                      SUBTRACT +1 FROM PV-LNE-SUB                 17620014
176300                        GIVING PV-LNE-SUB                         17630014
176400                      END-SUBTRACT                                17640014
176500                      MOVE PV-LNE-SUB TO PV-LNE-SUB-LST           17650014
176600                      PERFORM 5300-SAVE-CURRENT-REC               17660014
176700                      PERFORM 3423-PROCESS-CNCL-DUPL-PACK         17670013
176800                      PERFORM 5400-RETURN-CURRENT-REC             17680014
176900                      MOVE +1 TO PV-LNE-SUB                       17690014
177000                      MOVE +0 TO PV-LNE-SUB-LST                   17700014
177100                      PERFORM 3421-TBL-CNCL-DUPL-PACK             17710014
177200                  ELSE                                            17720013
177300                      PERFORM 3421-TBL-CNCL-DUPL-PACK             17730013
177400                  END-IF                                          17740013
177500              END-IF                                              17750013
177600*                                                                 17760013
177700         WHEN SQLCODE = +100                                      17770013
177800              IF PV-LNE-SUB > +0                                  17780017
177900                  MOVE PV-LNE-SUB               TO PV-LNE-SUB-LST 17790017
178000                  PERFORM 3423-PROCESS-CNCL-DUPL-PACK             17800013
178100              END-IF                                              17810017
178200              INITIALIZE DCLTPURCHS                               17820018
178300              INITIALIZE DCLTPURITM                               17830018
178400              MOVE 0               TO PV-HOLD-DEPT-NBR            17840027
178500              SET PS-EOF-CNCL-DUPL-PACK-CSR TO TRUE               17850018
178600*                                                                 17860013
178700         WHEN SQLWARN0 NOT = SPACE                                17870013
178800         WHEN SQLCODE < +0                                        17880013
178900         WHEN SQLCODE > +0                                        17890013
179000              MOVE '3420-FETCH-CNCL-DUPL-CSR'                     17900013
125600                                   TO PV-PARAGRAPH-NAME           17910050
179200              MOVE 'FETCH CNCL-DUPL-PACK-CSR'                     17920013
125800                                   TO PV-DB2-OPERATION            17930050
125900              PERFORM 9100-SQL-ABEND                              17930150
179800     END-EVALUATE.                                                17980013
179900/                                                                 17990013
180000******************************************************************18000013
180100* TABLE THE ITEM FOR A PO                                         18010013
180200******************************************************************18020013
180300 3421-TBL-CNCL-DUPL-PACK.                                         18030013
180400*                                                                 18040013
180500     MOVE PURCHS-DEPT-NBR TO PLT-DEPT-NBR(PV-LNE-SUB).            18050013
180600     MOVE PURCHS-OTB-PER-NBR                                      18060013
180700                          TO PLT-OTB-PER-NBR(PV-LNE-SUB).         18070013
180800     MOVE PURCHS-STATUS-CDE                                       18080013
180900                          TO PLT-PURCHS-STATUS-CDE(PV-LNE-SUB).   18090013
181000     MOVE PURCHS-PO-NBR   TO PLT-PO-NBR(PV-LNE-SUB).              18100013
181100     MOVE PURITM-ITM-NBR  TO PLT-ITM-NBR(PV-LNE-SUB).             18110013
181200     MOVE PURITM-PO-LNE-NBR                                       18120013
181300                          TO PLT-PO-LNE-NBR(PV-LNE-SUB).          18130013
181400     MOVE PURITM-STATUS-CDE                                       18140013
181500                          TO PLT-PURITM-STATUS-CDE(PV-LNE-SUB).   18150013
181600     MOVE PURITM-RMS-PO-SKU-NBR                                   18160013
181700                          TO PLT-RMS-PO-SKU-NBR(PV-LNE-SUB).      18170013
181800     MOVE 'NO '           TO PLT-RECEIPT-ACTIVITY(PV-LNE-SUB).    18180013
181900     MOVE PURITM-LAST-UPD-TMST                                    18190013
182000                          TO PLT-PURITM-LAST-UPD-TMST(PV-LNE-SUB).18200013
182100     MOVE PURITM-APP-PO-LNE-NBR                                   18210040
182200                          TO PLT-APP-PO-LNE-NBR(PV-LNE-SUB).      18220040
182300     MOVE 'Y'             TO PLT-DELETE-SKU(PV-LNE-SUB).          18230023
182400/                                                                 18240013
182500******************************************************************18250013
182600* PROCESS EACH TABLE LINE ITEM FOR A PO                           18260013
182700******************************************************************18270013
182800 3423-PROCESS-CNCL-DUPL-PACK.                                     18280013
182900*                                                                 18290013
183000     IF PV-LNE-SUB = +1                                           18300013
183010         SET PS-NO-DELETE-ALL-TBL-ROWS TO TRUE                    18301045
183100         PERFORM 3425-A-CHK-DUP-ITM-NBR                           18310019
183200         PERFORM 3425-B-MOVE-TBL-PACK-RPT                         18320019
183300     ELSE                                                         18330013
183400         MOVE +1 TO PV-LNE-SUB                                    18340019
183500         SET PS-NO-DELETE-ALL-TBL-ROWS TO TRUE                    18350040
183600         PERFORM 3425-A-CHK-DUP-ITM-NBR                           18360019
183700           UNTIL (PS-DELETE-ALL-TBL-ROWS      OR                  18370018
183800                  PV-LNE-SUB > PV-LNE-SUB-LST)                    18380040
183900         MOVE +1 TO PV-LNE-SUB                                    18390019
184000         PERFORM 3425-B-MOVE-TBL-PACK-RPT                         18400019
184100           UNTIL PV-LNE-SUB > PV-LNE-SUB-LST                      18410040
184200     END-IF.                                                      18420013
184300/                                                                 18430013
184400******************************************************************18440016
184500* CHECK FOR DUPLICATE LINE ITEMS ON SAME PO                       18450016
184600******************************************************************18460016
184700 3425-A-CHK-DUP-ITM-NBR.                                          18470019
184800*                                                                 18480016
184900     PERFORM 5200-GET-PO-ITM-NBR.                                 18490016
185000     IF PV-ITM-DUPL-CNT > 0                                       18500016
185100         SET PS-DELETE-ALL-TBL-ROWS TO TRUE                       18510044
185110     ELSE                                                         18511044
185120         SET PS-NO-DELETE-ALL-TBL-ROWS TO TRUE                    18512044
185130     END-IF.                                                      18513044
185200     IF PV-LNE-SUB-LST > +1                                       18520019
185300         ADD +1 TO PV-LNE-SUB.                                    18530019
185400/                                                                 18540016
185500******************************************************************18550019
185600* MOVE DUPLICATE PO/LINES TO THE TABLE FOR PROCESSING             18560019
185700******************************************************************18570019
185800 3425-B-MOVE-TBL-PACK-RPT.                                        18580019
185900*                                                                 18590019
186000     MOVE PLT-DEPT-NBR(PV-LNE-SUB)                                18600019
186100                                TO PURCHS-DEPT-NBR.               18610019
186200     MOVE PLT-OTB-PER-NBR(PV-LNE-SUB)                             18620019
186300                                TO PURCHS-OTB-PER-NBR.            18630019
186400     MOVE PLT-PURCHS-STATUS-CDE(PV-LNE-SUB)                       18640019
186500                                TO PURCHS-STATUS-CDE.             18650019
186600     MOVE PLT-PO-NBR(PV-LNE-SUB)                                  18660019
186700                                TO PURCHS-PO-NBR.                 18670019
186800     MOVE PLT-ITM-NBR(PV-LNE-SUB)                                 18680019
186900                                TO PURITM-ITM-NBR.                18690019
187000     MOVE PLT-PO-LNE-NBR(PV-LNE-SUB)                              18700019
187100                                TO PURITM-PO-LNE-NBR.             18710019
187200     MOVE PLT-PURITM-STATUS-CDE(PV-LNE-SUB)                       18720019
187300                                TO PURITM-STATUS-CDE.             18730019
187400     MOVE PLT-RMS-PO-SKU-NBR(PV-LNE-SUB)                          18740019
187500                                TO PURITM-RMS-PO-SKU-NBR.         18750019
187600     MOVE PLT-APP-PO-LNE-NBR(PV-LNE-SUB)                          18760040
187700                                TO PURITM-APP-PO-LNE-NBR.         18770040
187800     IF PS-DELETE-ALL-TBL-ROWS                                    18780019
187900         MOVE PLT-DELETE-SKU(PV-LNE-SUB)                          18790023
188000                                TO PS-DELETE-SKU-SW               18800023
188100     ELSE                                                         18810019
188200         IF PV-LNE-SUB = +1                                       18820019
188300             SET PS-DO-NOT-DELETE-SKU TO TRUE                     18830023
188400         ELSE                                                     18840019
188500             MOVE PLT-DELETE-SKU(PV-LNE-SUB)                      18850023
188600                                TO PS-DELETE-SKU-SW               18860023
188700         END-IF                                                   18870019
188800     END-IF.                                                      18880019
188900     PERFORM 3427-CNCL-DUPL-PACK-RPT.                             18890019
189000     IF (UPDATE-MODE                  AND                         18900040
189100         PS-DELETE-SKU                AND                         18910040
189200         DL1-RECEIPT-ACTIVITY = 'NO ')                            18920023
189300             PERFORM 5500-CNCL-DUPL-PACK-DELETE                   18930023
189400             PERFORM 8999-COMMIT                                  18940023
189500             ADD +1 TO PV-CNCLDUPL-PK-DELT-CNT                    18950023
189600     END-IF.                                                      18960019
189700     IF PV-LNE-SUB-LST > +1                                       18970019
189800         ADD +1 TO PV-LNE-SUB                                     18980019
189900     END-IF.                                                      18990019
190000/                                                                 19000019
190100******************************************************************19010016
190200* PRINT REPORT LINES FOR CANCEL DUPL PACKS                        19020019
190300******************************************************************19030016
190400 3427-CNCL-DUPL-PACK-RPT.                                         19040016
190500*                                                                 19050016
190600     MOVE PURITM-ITM-NBR        TO DL1-ITM-NBR.                   19060016
190700     MOVE PURITM-PO-LNE-NBR     TO DL1-PO-LNE-NBR.                19070016
190800     MOVE PURITM-STATUS-CDE     TO DL1-PURITM-STATUS-CDE.         19080016
190900     MOVE PURITM-RMS-PO-SKU-NBR TO DL1-RMS-PO-SKU-NBR.            19090016
191000     MOVE ZEROES TO PV-SQL-REC-CNT.                               19100044
191100     PERFORM 5100-FIND-DC-RECEIPTS.                               19110016
191200     IF PV-SQL-REC-CNT > +0                                       19120018
191300         MOVE 'YES'             TO DL1-RECEIPT-ACTIVITY           19130016
191400     ELSE                                                         19140016
191500         MOVE 'NO '             TO DL1-RECEIPT-ACTIVITY           19150016
191600     END-IF.                                                      19160016
191700     IF (PS-DELETE-SKU                AND                         19170040
191800         DL1-RECEIPT-ACTIVITY = 'NO ')                            19180040
191900         MOVE '*'               TO DL1-DELETE-SKU                 19190040
192000     ELSE                                                         19200040
192100         MOVE ' '               TO DL1-DELETE-SKU                 19210040
192200     END-IF.                                                      19220040
192300     PERFORM 8000-WRITE-REPORT.                                   19230013
192400/                                                                 19240013
192500******************************************************************19250013
192600* CLOSE THE LINE ITEM CURSOR                                      19260013
192700******************************************************************19270013
192800 3430-CLOSE-CNCL-DUPL-CSR.                                        19280013
192900*                                                                 19290013
193000     EXEC SQL                                                     19300013
193100         CLOSE CNCL-DUPL-PACK-CSR                                 19310013
193200     END-EXEC.                                                    19320013
193300*                                                                 19330013
193400     EVALUATE TRUE                                                19340013
193500         WHEN SQLCODE = +0                                        19350013
193600              CONTINUE                                            19360013
193700*                                                                 19370013
193800         WHEN SQLWARN0 NOT = SPACE                                19380013
193900         WHEN SQLCODE  NOT = +0                                   19390013
194000              MOVE '3430-CLOSE-CNCL-DUPL-CSR'                     19400013
194300                               TO PV-PARAGRAPH-NAME               19401051
194200              MOVE 'CLOSE CNCL-DUPL-PACK-CSR'                     19420013
194300                               TO PV-DB2-OPERATION                19421051
194300              PERFORM 9100-SQL-ABEND                              19422051
194800     END-EVALUATE.                                                19480013
194900/                                                                 19490013
195000******************************************************************19500006
195100*                                                                 19510006
195200******************************************************************19520006
195300 3500-PACK-PROCESSING-SKU.                                        19530015
195400*                                                                 19540006
195500     SET PACKPRCS TO TRUE                                         19550015
195600     SET PS-ROWS-FOUND TO TRUE                                    19560019
195700     PERFORM 3510-OPEN-PACK-PRCS-CSR                              19570019
195800     MOVE +0  TO PV-PACKPRCS-CNT                                  19580019
195900*                                                                 19590019
196000     PERFORM 3520-FETCH-PACK-PRCS-CSR                             19600019
196100       UNTIL PS-EOF-PACK-PRCS-PACK-CSR                            19610019
196200*                                                                 19620019
196300     PERFORM 3530-CLOSE-PACK-PRCS-CSR                             19630019
196400*                                                                 19640019
196500     IF PV-PACKPRCS-CNT = +0                                      19650019
196600         SET PS-ROWS-NOT-FOUND TO TRUE                            19660019
196700         MOVE PC-NO-PACK-PRCS-SKU-TO-RPT                          19670019
196800           TO OR-RPT-LINE                                         19680019
196900         PERFORM 8000-WRITE-REPORT                                19690019
197000     END-IF.                                                      19700019
197100/                                                                 19710019
197200******************************************************************19720019
197300*  TPURCHS CURSOR OPERATION                                       19730019
197400******************************************************************19740019
197500 3510-OPEN-PACK-PRCS-CSR.                                         19750019
197600*                                                                 19760019
197700     PERFORM                                                      19770019
197800         WITH TEST AFTER                                          19780019
197900         VARYING PV-RETRY-COUNTER                                 19790019
198000         FROM 1 BY 1                                              19800019
198100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19810019
198200            OR (SQLCODE = +0))                                    19820019
198300*                                                                 19830019
198400         EXEC SQL                                                 19840019
198500             OPEN PACK-PRCS-PACK-CSR                              19850019
198600         END-EXEC                                                 19860019
198700*                                                                 19870019
198800         EVALUATE TRUE                                            19880019
198900             WHEN SQLCODE = +0                                    19890019
199000             WHEN SQLCODE = -904                                  19900019
199100             WHEN SQLCODE = -913                                  19910019
199200                  CONTINUE                                        19920019
199300                                                                  19930019
199400             WHEN SQLWARN0 NOT = SPACE                            19940019
199500             WHEN SQLCODE  NOT = +0                               19950019
199600                  MOVE '3510-OPEN-PACK-PRCS-CSR'                  19960019
194300                               TO PV-PARAGRAPH-NAME               19961051
199800                  MOVE 'OPEN PACK-PRCS-PACK-CSR'                  19980019
194300                               TO PV-DB2-OPERATION                19990051
194300                  PERFORM 9100-SQL-ABEND                          19990151
200500         END-EVALUATE                                             20050019
200600     END-PERFORM.                                                 20060019
200700                                                                  20070019
200800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20080019
200900         MOVE '3510-OPEN-PACK-PRCS-CSR'                           20090051
194300                               TO PV-PARAGRAPH-NAME               20091051
201000         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              20100019
194300                               TO PV-DB2-OPERATION                20110051
194300         PERFORM 9100-SQL-ABEND                                   20110151
201500     END-IF.                                                      20150019
201600/                                                                 20160019
201700******************************************************************20170019
201800*    FETCH A LINE ITEM ROW                                        20180019
201900******************************************************************20190019
202000 3520-FETCH-PACK-PRCS-CSR.                                        20200019
202100*                                                                 20210019
202200     EXEC SQL                                                     20220019
202300         FETCH PACK-PRCS-PACK-CSR                                 20230019
202400          INTO                                                    20240019
202500             :PURCHS-OTB-PER-NBR                                  20250019
202600            ,:PURCHS-DEPT-NBR                                     20260019
202700            ,:PURCHS-PO-NBR                                       20270019
202800            ,:PURCHS-STATUS-CDE                                   20280019
202900            ,:PURCHS-PKGNG-CDE                                    20290019
203000     END-EXEC.                                                    20300019
203100*                                                                 20310019
203200     EVALUATE TRUE                                                20320019
203300         WHEN SQLCODE = +0                                        20330019
203400              ADD +1 TO PV-PACKPRCS-CNT                           20340019
203500              PERFORM 3521-PACK-PRCS-PACK-RPT                     20350019
203600*                                                                 20360019
203700         WHEN SQLCODE = +100                                      20370019
203800              INITIALIZE DCLTPURCHS                               20380019
203900              INITIALIZE DCLTPURITM                               20390019
204000              MOVE 0               TO PV-HOLD-DEPT-NBR            20400027
204100              SET PS-EOF-PACK-PRCS-PACK-CSR                       20410019
204200                                   TO TRUE                        20420019
204300*                                                                 20430019
204400         WHEN SQLWARN0 NOT = SPACE                                20440019
204500         WHEN SQLCODE < +0                                        20450019
204600         WHEN SQLCODE > +0                                        20460019
204700              MOVE '3520-FETCH-PACK-PRCS-CSR'                     20470019
194300                               TO PV-PARAGRAPH-NAME               20481051
204900              MOVE 'FETCH PACK-PRCS-PACK-CSR'                     20490019
194300                               TO PV-DB2-OPERATION                20500051
194300              PERFORM 9100-SQL-ABEND                              20500151
205500     END-EVALUATE.                                                20550019
205600/                                                                 20560019
205700******************************************************************20570019
205800* PRINT REPORT LINES FOR PACK PROCESS PACKS                       20580019
205900******************************************************************20590019
206000 3521-PACK-PRCS-PACK-RPT.                                         20600019
206100*                                                                 20610019
206200     MOVE +0                    TO DL1-ITM-NBR                    20620019
206300                                   DL1-PO-LNE-NBR                 20630019
206400                                   DL1-RMS-PO-SKU-NBR.            20640019
206500     MOVE SPACES                TO DL1-DELETE-SKU                 20650019
206600                                   DL1-PURITM-STATUS-CDE          20660019
206700                                   DL1-RECEIPT-ACTIVITY.          20670019
206800     MOVE +0                    TO PV-SQL-REC-CNT.                20680019
206900*    IF PURCHS-PKGNG-CDE = 'M' OR 'I'                             20690057
207000*        PERFORM 5600-FIND-POT-PK-TMP                             20700057
207100*    END-IF.                                                      20710057
207200*    IF PV-SQL-REC-CNT > +0                                       20720057
207300*        SET PS-BYPASS-PO-YES   TO TRUE                           20730057
207400*    ELSE                                                         20740057
207500         SET PS-BYPASS-PO-NO    TO TRUE                           20750019
207600*    END-IF.                                                      20760057
207700     IF PS-BYPASS-PO-NO                                           20770019
207800         ADD +1                 TO PV-PACKPRCS-REPORT-CNT         20780019
207900         PERFORM 8000-WRITE-REPORT                                20790019
208000         IF PACK-MODE                                             20800019
208100             PERFORM 5700-CNVRT-PO-TO-PACK                        20810019
208200             PERFORM 8999-COMMIT                                  20820023
208300         END-IF                                                   20830019
208400     ELSE                                                         20840019
208500         ADD +1                 TO PV-PACKPRCS-BYPASS-CNT         20850019
208600         DISPLAY ' **  PO IN PACK REVISION      = ' PURCHS-PO-NBR 20860020
208700     END-IF.                                                      20870019
208800/                                                                 20880019
208900******************************************************************20890019
209000* CLOSE THE LINE ITEM CURSOR                                      20900019
209100******************************************************************20910019
209200 3530-CLOSE-PACK-PRCS-CSR.                                        20920019
209300*                                                                 20930019
209400     EXEC SQL                                                     20940019
209500         CLOSE PACK-PRCS-PACK-CSR                                 20950019
209600     END-EXEC.                                                    20960019
209700*                                                                 20970019
209800     EVALUATE TRUE                                                20980019
209900         WHEN SQLCODE = +0                                        20990019
210000              CONTINUE                                            21000019
210100*                                                                 21010019
210200         WHEN SQLWARN0 NOT = SPACE                                21020019
210300         WHEN SQLCODE  NOT = +0                                   21030019
210400              MOVE '3530-CLOSE-PACK-PRCS-CSR'                     21040019
194300                               TO PV-PARAGRAPH-NAME               21050051
210600              MOVE 'CLOSE PACK-PRCS-PACK-CSR'                     21060019
194300                               TO PV-DB2-OPERATION                21061051
194300              PERFORM 9100-SQL-ABEND                              21070151
211200     END-EVALUATE.                                                21120019
211300/                                                                 21130019
211400******************************************************************21140006
211500*                                                                 21150006
211600******************************************************************21160006
211700 5100-FIND-DC-RECEIPTS.                                           21170012
211800*                                                                 21180006
211900     ADD +1 TO PV-FIND-DC-RCPT-ATMPT-CNT                          21190023
212000     PERFORM                                                      21200012
212100         WITH TEST AFTER                                          21210012
212200         VARYING PV-RETRY-COUNTER                                 21220012
212300         FROM 1 BY 1                                              21230012
212400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21240012
212500            OR  (SQLCODE = ZERO)                                  21250012
212600            OR  (SQLCODE = +100))                                 21260012
212700*                                                                 21270012
212800         EXEC SQL                                                 21280012
212900             SELECT COUNT(*)                                      21290017
213000               INTO :PV-SQL-REC-CNT                               21300018
213100               FROM TRECITM                                       21310012
213200              WHERE ORD_NBR        = :PURCHS-PO-NBR               21320012
213300                AND ORD_LNE_NBR    = :PURITM-APP-PO-LNE-NBR       21330021
213400                AND VER_STATUS_CDE = 'A'                          21340012
213500         END-EXEC                                                 21350012
213600*                                                                 21360012
213700         EVALUATE TRUE                                            21370012
213800             WHEN SQLCODE = +0                                    21380012
213900                 ADD +1 TO PV-FIND-DC-RCPT-SUCSS-CNT              21390023
214000             WHEN SQLCODE = +100                                  21400012
214100             WHEN SQLCODE = -904                                  21410012
214200             WHEN SQLCODE = -913                                  21420012
214300                  CONTINUE                                        21430012
214400             WHEN SQLWARN0 NOT = SPACES                           21440012
214500             WHEN SQLCODE < ZERO                                  21450012
214600             WHEN SQLCODE > ZERO                                  21460012
214700                  MOVE '5100-FIND-DC-RECEIPTS'                    21470012
194300                               TO PV-PARAGRAPH-NAME               21480051
214900                  MOVE 'UNSUCCESSFUL SELECT TRECITM - DC RECEIPTS'21490012
194300                               TO PV-DB2-OPERATION                21500051
194300                  PERFORM 9100-SQL-ABEND                          21500151
215500         END-EVALUATE                                             21550012
215600     END-PERFORM.                                                 21560012
215700*                                                                 21570012
215800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21580012
215900         MOVE '5100-FIND-DC-RECEIPTS'                             21590012
194300                               TO PV-PARAGRAPH-NAME               21600051
216100         MOVE 'MAX RETRIES EXCEEDED ON SELECT TRECITM - DC RECPTS'21610012
194300                               TO PV-DB2-OPERATION                21620051
194300         PERFORM 9100-SQL-ABEND                                   21630051
216500     END-IF.                                                      21650012
216600/                                                                 21660013
216700******************************************************************21670013
216800*                                                                 21680013
216900******************************************************************21690013
217000 5200-GET-PO-ITM-NBR.                                             21700013
217100*                                                                 21710013
217200     MOVE PLT-PO-NBR(PV-LNE-SUB)  TO PURCHS-PO-NBR.               21720013
217300     MOVE PLT-ITM-NBR(PV-LNE-SUB) TO PURITM-ITM-NBR.              21730013
217400     ADD +1 TO PV-GET-PO-ITM-ATMPT-CNT.                           21740023
217500*                                                                 21750016
217600     PERFORM                                                      21760013
217700         WITH TEST AFTER                                          21770013
217800         VARYING PV-RETRY-COUNTER                                 21780013
217900         FROM 1 BY 1                                              21790013
218000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21800013
218100            OR  (SQLCODE = ZERO)                                  21810013
218200            OR  (SQLCODE = +100))                                 21820013
218300*                                                                 21830013
218400         EXEC SQL                                                 21840013
218500             SELECT COUNT(*)                                      21850013
218600               INTO :PV-ITM-DUPL-CNT                              21860013
218700               FROM TPURITM                                       21870013
218800              WHERE PO_NBR           = :PURCHS-PO-NBR             21880013
218900                AND ITM_NBR          = :PURITM-ITM-NBR            21890013
219000                AND VER_STATUS_CDE   = 'A'                        21900013
219100                AND SKU_SEQ_NBR NOT IN ('000','999')              21910013
219200                AND PO_PREPK_ID      = 0                          21920013
219300                AND STATUS_CDE      IN ('AP','AC','CM','CB')      21930013
219400         END-EXEC                                                 21940013
219500*                                                                 21950013
219600         EVALUATE TRUE                                            21960013
219700             WHEN SQLCODE = +0                                    21970013
219800                 ADD +1 TO PV-GET-PO-ITM-SUCSS-CNT                21980023
219900             WHEN SQLCODE = +100                                  21990013
220000             WHEN SQLCODE = -904                                  22000013
220100             WHEN SQLCODE = -913                                  22010013
220200                  CONTINUE                                        22020013
220300             WHEN SQLWARN0 NOT = SPACES                           22030013
220400             WHEN SQLCODE < ZERO                                  22040013
220500             WHEN SQLCODE > ZERO                                  22050013
220600                  MOVE '5200-GET-PO-ITM-NBR'                      22060013
194300                               TO PV-PARAGRAPH-NAME               22070051
220800                  MOVE 'UNSUCCESSFUL SELECT TPURITM - LNE ITM DUP'22080013
194300                               TO PV-DB2-OPERATION                22081051
194300                  PERFORM 9100-SQL-ABEND                          22082051
221400         END-EVALUATE                                             22140013
221500     END-PERFORM.                                                 22150013
221600*                                                                 22160013
221700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22170013
221800         MOVE '5200-GET-PO-ITM-NBR'                               22180013
194300                               TO PV-PARAGRAPH-NAME               22191051
222000         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM - LN ITM DP'22200013
194300                               TO PV-DB2-OPERATION                22210051
194300         PERFORM 9100-SQL-ABEND                                   22210151
222400     END-IF.                                                      22240013
222500*                                                                 22250013
222600/                                                                 22260013
222700******************************************************************22270013
222800*                                                                 22280012
222900******************************************************************22290012
223000 5300-SAVE-CURRENT-REC.                                           22300014
223100*                                                                 22310012
223200     MOVE PURCHS-OTB-PER-NBR    TO PV-HLD-NXT-OTB-PER-NBR.        22320014
223300     MOVE PURCHS-PO-NBR         TO PV-HLD-NXT-PO-NBR.             22330014
223400     MOVE PURCHS-STATUS-CDE     TO PV-HLD-NXT-PUR-STATUS-CDE.     22340014
223500     MOVE PURCHS-DEPT-NBR       TO PV-HLD-NXT-DEPT-NBR.           22350014
223600     MOVE PURITM-PO-LNE-NBR     TO PV-HLD-NXT-PO-LNE-NBR.         22360014
223700     MOVE PURITM-ITM-NBR        TO PV-HLD-NXT-ITM-NBR.            22370014
223800     MOVE PURITM-STATUS-CDE     TO PV-HLD-NXT-ITM-STATUS-CDE.     22380014
223900     MOVE PURITM-RMS-PO-SKU-NBR TO PV-HLD-NXT-RMS-PO-SKU-NBR.     22390014
224000     MOVE PURITM-LAST-UPD-TMST  TO PV-HLD-NXT-LAST-UPD-TMST.      22400014
224010     MOVE PURITM-APP-PO-LNE-NBR TO PV-HLD-NXT-APP-PO-LNE-NBR.     22401045
224100/                                                                 22410014
224200******************************************************************22420014
224300*                                                                 22430014
224400******************************************************************22440014
224500 5400-RETURN-CURRENT-REC.                                         22450014
224600*                                                                 22460014
224700     MOVE PV-HLD-NXT-OTB-PER-NBR    TO PURCHS-OTB-PER-NBR.        22470014
224800     MOVE PV-HLD-NXT-PO-NBR         TO PURCHS-PO-NBR.             22480014
224900     MOVE PV-HLD-NXT-PUR-STATUS-CDE TO PURCHS-STATUS-CDE.         22490014
225000     MOVE PV-HLD-NXT-DEPT-NBR       TO PURCHS-DEPT-NBR.           22500014
225100     MOVE PV-HLD-NXT-PO-LNE-NBR     TO PURITM-PO-LNE-NBR.         22510014
225200     MOVE PV-HLD-NXT-ITM-NBR        TO PURITM-ITM-NBR.            22520014
225300     MOVE PV-HLD-NXT-ITM-STATUS-CDE TO PURITM-STATUS-CDE.         22530014
225400     MOVE PV-HLD-NXT-RMS-PO-SKU-NBR TO PURITM-RMS-PO-SKU-NBR.     22540014
225500     MOVE PV-HLD-NXT-LAST-UPD-TMST  TO PURITM-LAST-UPD-TMST.      22550014
225510     MOVE PV-HLD-NXT-APP-PO-LNE-NBR TO PURITM-APP-PO-LNE-NBR.     22551045
225600/                                                                 22560016
225700******************************************************************22570016
225800*  DELETES CANCELLED DUPLICATE SKU'S ON PO'S WITH NO ACTIVITY     22580023
225900******************************************************************22590016
226000 5500-CNCL-DUPL-PACK-DELETE.                                      22600016
226100*                                                                 22610016
226200     PERFORM 8910-DELETE-TMESTDS.                                 22620023
226300*                                                                 22630023
226400     PERFORM 8920-DELETE-TALLPLN.                                 22640023
226500*                                                                 22650023
226600     PERFORM 8930-DELETE-TPURITM.                                 22660023
226700*                                                                 22670023
226800/                                                                 22680014
226900******************************************************************22690019
227000*                                                                 22700019
227100******************************************************************22710019
227200*5600-FIND-POT-PK-TMP.                                            22720058
227300*                                                                 22730019
227400*    ADD +1 TO PV-FND-POTPK-TMP-ATMPT-CNT.                        22740058
227500*    PERFORM                                                      22750058
227600*        WITH TEST AFTER                                          22760058
227700*        VARYING PV-RETRY-COUNTER                                 22770058
227800*        FROM 1 BY 1                                              22780058
227900*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22790058
228000*           OR  (SQLCODE = ZERO)                                  22800058
228100*           OR  (SQLCODE = +100))                                 22810058
228200*                                                                 22820019
228300*        EXEC SQL                                                 22830058
228400*            SELECT COUNT(*)                                      22840058
228500*              INTO :PV-SQL-REC-CNT                               22850058
228600*              FROM POT_PK_TMP                                    22860058
228700*             WHERE PO_NBR         = :PURCHS-PO-NBR               22870058
228800*        END-EXEC                                                 22880058
228900*                                                                 22890019
229000*        EVALUATE TRUE                                            22900058
229100*            WHEN SQLCODE = +0                                    22910058
229200*                ADD +1 TO PV-FND-POTPK-TMP-SUCSS-CNT             22920058
229300*            WHEN SQLCODE = +100                                  22930058
229400*            WHEN SQLCODE = -904                                  22940058
229500*            WHEN SQLCODE = -913                                  22950058
229600*                 CONTINUE                                        22960058
229700*            WHEN SQLWARN0 NOT = SPACES                           22970058
229800*            WHEN SQLCODE < ZERO                                  22980058
229900*            WHEN SQLCODE > ZERO                                  22990058
230000*                 MOVE '5600-FIND-POT-PK-TMP'                     23000058
194300*                              TO PV-PARAGRAPH-NAME               23010058
230200*                 MOVE 'UNSUCCESSFUL SELECT POT_PK_TMP'           23020058
194300*                              TO PV-DB2-OPERATION                23030058
194300*             PERFORM 9100-SQL-ABEND                              23030158
230800*        END-EVALUATE                                             23080058
230900*    END-PERFORM.                                                 23090058
231000*                                                                 23100019
231100*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23110058
231200*        MOVE '5600-FIND-POT-PK-TMP'                              23120058
194300*                              TO PV-PARAGRAPH-NAME               23130058
231400*        MOVE 'MAX RETRIES EXCEEDED ON SELECT POT_PK_TMP'         23140058
194300*                              TO PV-DB2-OPERATION                23150058
194300*        PERFORM 9100-SQL-ABEND                                   23150158
231800*    END-IF.                                                      23180058
231900/                                                                 23190019
232000******************************************************************23200019
232100*                                                                 23210019
232200******************************************************************23220019
232300 5700-CNVRT-PO-TO-PACK.                                           23230019
232400*                                                                 23240019
232500     PERFORM 5710-UPDT-PURCHS.                                    23250021
232600*                                                                 23260021
232700     PERFORM 5740-OPEN-PPUPDT-ITM-CSR.                            23270021
232800*                                                                 23280021
232900     SET PS-NOT-EOF-PPUPDT-ITM-CSR TO TRUE.                       23290037
233000     PERFORM 5750-FETCH-PPUPDT-ITM-CSR                            23300021
233100       UNTIL PS-EOF-PPUPDT-ITM-CSR.                               23310021
233200*                                                                 23320021
233300     PERFORM 5760-CLOSE-PPUPDT-ITM-CSR.                           23330021
233400*                                                                 23340021
233500     PERFORM 5770-ISRT-POINST.                                    23350022
233600/                                                                 23360021
233700******************************************************************23370021
233800*  TPURCHS UPDATE OPERATION                                       23380021
233900******************************************************************23390021
234000 5710-UPDT-PURCHS.                                                23400021
234100*                                                                 23410021
234200     PERFORM 8300-SELECT-TPURCHS.                                 23420021
234300*                                                                 23430022
234400     MOVE 'I'                     TO PVT-PRCHS-VER-STATUS-CDE.    23440038
234500     MOVE PV-CURRENT-TMST         TO PVT-PRCHS-LAST-UPD-TMST.     23450038
234600     MOVE PC-CURRENT-PROGRAM-NAME TO PVT-PRCHS-LAST-UPD-BY-UID.   23460038
234700*                                                                 23470038
234800     PERFORM 8400-UPDATE-TPURCHS.                                 23480038
234900*                                                                 23490038
235000     ADD +1                       TO PVT-PRCHS-VER-NBR.           23500038
235100     MOVE 'A'                     TO PVT-PRCHS-VER-STATUS-CDE.    23510038
235200     MOVE PVT-PRCHS-PKGNG-CDE     TO PVT-PRCHS-ORIG-PKGNG-CDE.    23520038
235300     IF PVT-PRCHS-PKGNG-CDE = 'M' OR 'I'                          23530038
235400         CONTINUE                                                 23540038
235500     ELSE                                                         23550038
235600         MOVE 'M'                 TO PVT-PRCHS-PKGNG-CDE          23560038
235700     END-IF.                                                      23570038
235800     MOVE 'Y'                     TO PVT-PRCHS-DUP-SKU-IND.       23580038
235900     MOVE PV-CURRENT-TMST         TO PVT-PRCHS-LAST-UPD-TMST.     23590034
236000     MOVE PC-CURRENT-PROGRAM-NAME TO PVT-PRCHS-LAST-UPD-BY-UID.   23600022
236100*                                                                 23610038
236200     PERFORM 8450-INSERT-TPURCHS.                                 23620038
236300/                                                                 23630022
236400******************************************************************23640022
236500*  UPDATE TPURITM CURSOR OPERATION                                23650022
236600******************************************************************23660022
236700 5740-OPEN-PPUPDT-ITM-CSR.                                        23670022
236800*                                                                 23680022
236900     PERFORM                                                      23690022
237000         WITH TEST AFTER                                          23700022
237100         VARYING PV-RETRY-COUNTER                                 23710022
237200         FROM 1 BY 1                                              23720022
237300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23730022
237400            OR (SQLCODE = +0))                                    23740022
237500*                                                                 23750022
237600         EXEC SQL                                                 23760022
237700             OPEN PPUPDT-ITM-CSR                                  23770022
237800         END-EXEC                                                 23780022
237900*                                                                 23790022
238000         EVALUATE TRUE                                            23800022
238100             WHEN SQLCODE = +0                                    23810022
238200             WHEN SQLCODE = -904                                  23820022
238300             WHEN SQLCODE = -913                                  23830022
238400                  CONTINUE                                        23840022
238500                                                                  23850022
238600             WHEN SQLWARN0 NOT = SPACE                            23860022
238700             WHEN SQLCODE  NOT = +0                               23870022
238800                  MOVE '5740-OPEN-PPUPDT-ITM-CSR'                 23880022
194300                               TO PV-PARAGRAPH-NAME               23890051
239000                  MOVE 'OPEN PPUPDT-ITM-CSR'                      23900022
194300                               TO PV-DB2-OPERATION                23910051
194300                  PERFORM 9100-SQL-ABEND                          23910151
239700         END-EVALUATE                                             23970022
239800     END-PERFORM.                                                 23980022
239900                                                                  23990022
240000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24000022
240100         MOVE '5740-OPEN-PPUPDT-ITM-CSR'                          24010051
194300                               TO PV-PARAGRAPH-NAME               24011051
240200         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              24020022
194300                               TO PV-DB2-OPERATION                24030051
194300         PERFORM 9100-SQL-ABEND                                   24030151
194300                                                                  24030251
240700     END-IF.                                                      24070022
240800/                                                                 24080022
240900******************************************************************24090022
241000*    FETCH A LINE ITEM ROW                                        24100022
241100******************************************************************24110022
241200 5750-FETCH-PPUPDT-ITM-CSR.                                       24120022
241300*                                                                 24130022
241400     EXEC SQL                                                     24140022
241500         FETCH PPUPDT-ITM-CSR                                     24150022
241600          INTO                                                    24160022
241700                :PURITM-PO-NBR                                    24170022
241800               ,:PURITM-VER-NBR                                   24180033
241900               ,:PURITM-PO-LNE-NBR                                24190033
242000               ,:PURITM-VER-STATUS-CDE                            24200033
242100               ,:PURITM-SKU-SEQ-NBR                               24210033
242200               ,:PURITM-CL-NBR                                    24220033
242300               ,:PURITM-VEND-STYL-NAME                            24230033
242400               ,:PURITM-COLOR-DESC                                24240033
242500               ,:PURITM-SIZE-DESC                                 24250033
242600               ,:PURITM-UM-IND                                    24260033
242700               ,:PURITM-UNT-QTY                                   24270033
242800               ,:PURITM-UNT-RTL-PR-AMT                            24280033
242900               ,:PURITM-UNT-COST-AMT                              24290033
243000               ,:PURITM-TOT-VAL-COST-AMT                          24300033
243100               ,:PURITM-TOT-VAL-RTL-AMT                           24310033
243200               ,:PURITM-MU-PCT                                    24320033
243300               ,:PURITM-CRE-TMST                                  24330033
243400               ,:PURITM-LAST-UPD-TMST                             24340033
243500               ,:PURITM-ITM-NBR                                   24350033
243600               ,:PURITM-SKU-DESC                                  24360033
243700               ,:PURITM-COLOR-CDE                                 24370033
243800               ,:PURITM-SIZE-CDE                                  24380033
243900               ,:PURITM-AD-EVNT-DTE                               24390033
244000               ,:PURITM-STATUS-CDE                                24400033
244100               ,:PURITM-CRE-BY-UID                                24410033
244200               ,:PURITM-LAST-UPD-BY-UID                           24420033
244300               ,:PURITM-GP-RTL-AMT                                24430033
244400               ,:PURITM-GP-QTY                                    24440033
244500               ,:PURITM-APP-PO-LNE-NBR                            24450033
244600               ,:PURITM-PIC-ITM-IND                               24460033
244700               ,:PURITM-PIC-PG-NBR                                24470033
244800               ,:PURITM-PRD-1ST-COST-AMT                          24480033
244900               ,:PURITM-STAT-TMST                                 24490033
245000               ,:PURITM-PO-PREPK-ID                               24500033
245100               ,:PURITM-PREPK-RATO-QTY                            24510033
245200               ,:PURITM-SHIP-TO-TMP-DC-IND                        24520033
245300               ,:PURITM-RMS-PO-SKU-NBR                            24530033
245400               ,:PURITM-CNCLD-UNT-QTY                             24540033
245500     END-EXEC.                                                    24550022
245600*                                                                 24560022
245700     EVALUATE TRUE                                                24570022
245800         WHEN SQLCODE = +0                                        24580022
245900              ADD +1 TO PV-PPUPDT-ITM-CNT                         24590022
246000              PERFORM 5751-PPUPDT-PURITM                          24600022
246100*                                                                 24610022
246200         WHEN SQLCODE = +100                                      24620022
246300              SET PS-EOF-PPUPDT-ITM-CSR                           24630022
246400                                   TO TRUE                        24640022
246500*                                                                 24650022
246600         WHEN SQLWARN0 NOT = SPACE                                24660022
246700         WHEN SQLCODE < +0                                        24670022
246800         WHEN SQLCODE > +0                                        24680022
246900              MOVE '5750-FETCH-PPUPDT-ITM-CSR'                    24690022
194300                               TO PV-PARAGRAPH-NAME               24701051
247100              MOVE 'FETCH PPUPDT-ITM-CSR'                         24710022
194300                               TO PV-DB2-OPERATION                24720051
194300              PERFORM 9100-SQL-ABEND                              24720151
247700     END-EVALUATE.                                                24770022
247800/                                                                 24780022
247900******************************************************************24790022
248000* UPDT & ISRT PURITM & ISRT POPRPK FOR ACTV PURITM ON PURCHS      24800022
248100******************************************************************24810022
248200 5751-PPUPDT-PURITM.                                              24820022
248300*                                                                 24830022
248400     MOVE 'I'                           TO PURITM-VER-STATUS-CDE. 24840034
248500     MOVE PV-CURRENT-TMST               TO PURITM-LAST-UPD-TMST.  24850034
248600     MOVE PC-CURRENT-PROGRAM-NAME       TO PURITM-LAST-UPD-BY-UID.24860034
248700*                                                                 24870022
248800     PERFORM 8500-UPDATE-TPURITM.                                 24880021
248900*                                                                 24890022
249000     ADD  +1                            TO PURITM-VER-NBR.        24900034
249100     MOVE 'A'                           TO PURITM-VER-STATUS-CDE. 24910034
249200     IF PVT-PRCHS-ORIG-PKGNG-CDE = 'M' OR 'I'                     24920022
249300         PERFORM 5751-A-GET-MAX-PO-ITM-PREPK-ID                   24930022
249400         ADD +1 PV-MAX-PO-ITM-PREPK-ID                            24940022
249500                                    GIVING PURITM-PO-PREPK-ID     24950034
249600     ELSE                                                         24960021
249700         MOVE PURITM-APP-PO-LNE-NBR     TO PURITM-PO-PREPK-ID     24970034
249800     END-IF.                                                      24980021
249900     MOVE +1                            TO PURITM-PREPK-RATO-QTY. 24990034
250000     MOVE +0                            TO PURITM-RMS-PO-SKU-NBR. 25000034
250100*                                                                 25010022
250200     PERFORM 8600-INSERT-TPURITM.                                 25020022
250300*                                                                 25030022
250400     MOVE PURITM-PO-NBR             TO POPRPK-PO-NBR.             25040034
250500     MOVE +1                        TO POPRPK-VER-NBR.            25050034
250600     IF PVT-PRCHS-ORIG-PKGNG-CDE = 'M' OR 'I'                     25060034
250700         PERFORM 5751-B-GET-MAX-PRPK-PREPK-ID                     25070034
250800         ADD +1 PV-MAX-PRPK-PREPK-ID                              25080034
250900                                GIVING POPRPK-PO-PREPK-ID         25090034
251000     ELSE                                                         25100034
251100         MOVE PURITM-APP-PO-LNE-NBR TO POPRPK-PO-PREPK-ID         25110034
251200     END-IF.                                                      25120034
251300     IF PVT-PRCHS-ORIG-PKGNG-CDE = 'I'                            25130034
251400         MOVE PVT-PRCHS-ORIG-PKGNG-CDE                            25140034
251500                                    TO POPRPK-PREPK-TYP-CDE       25150034
251600     ELSE                                                         25160034
251700         MOVE 'M'                   TO POPRPK-PREPK-TYP-CDE       25170034
251800     END-IF.                                                      25180034
251900     MOVE POPRPK-PO-PREPK-ID        TO PV-PO-PREPK-ID.            25190034
252000     STRING 'DUPLICATE SKU ORDER - PACK ' DELIMITED BY SIZE       25200034
252100             PV-PO-PREPK-ID               DELIMITED BY SIZE       25210034
252200                                  INTO POPRPK-PREPK-DESC          25220034
252300     END-STRING.                                                  25230034
252400     IF PURITM-STATUS-CDE = 'AP' OR 'AC' OR 'CM'                  25240034
252500         MOVE 'A'                   TO POPRPK-PREPK-STAT-CDE      25250034
252600     ELSE                                                         25260034
252700         IF PURITM-STATUS-CDE = 'CA' OR 'CB'                      25270034
252800             MOVE 'C'               TO POPRPK-PREPK-STAT-CDE      25280034
252900         END-IF                                                   25290034
253000     END-IF.                                                      25300034
253100     MOVE +0                        TO POPRPK-PREPK-UPC-NBR.      25310034
253200     MOVE +1                        TO POPRPK-INPK-UNT-QTY.       25320034
253300     MOVE 'N'                       TO POPRPK-INPK-CNVYB-IND.     25330034
253400     IF POPRPK-PREPK-TYP-CDE = 'M'                                25340034
253500         MOVE +0                    TO POPRPK-OTPK-UNT-QTY        25350034
253600     ELSE                                                         25360034
253700         IF POPRPK-PREPK-TYP-CDE = 'I'                            25370034
253800             MOVE +1                TO POPRPK-OTPK-UNT-QTY        25380034
253900         END-IF                                                   25390034
254000     END-IF.                                                      25400034
254100     MOVE PURITM-UNT-QTY            TO POPRPK-OTPK-ORD-QTY.       25410034
254200     MOVE PV-CURRENT-TMST           TO POPRPK-PK-DTL-CHG-TMST.    25420034
254300     MOVE +0                        TO POPRPK-PK-SKU-NBR.         25430034
254400*                                                                 25440022
254500     PERFORM 8700-INSERT-TPOPRPK.                                 25450034
254600*                                                                 25460022
254700*    END-IF.                                                      25470034
254800/                                                                 25480022
254900******************************************************************25490022
255000* GET MAX PO-PREPK-ID FOR PURITM                                  25500022
255100******************************************************************25510022
255200 5751-A-GET-MAX-PO-ITM-PREPK-ID.                                  25520022
255300*                                                                 25530022
255400     ADD +1 TO PV-GMAX-POITM-ATMPT-CNT.                           25540023
255500     PERFORM                                                      25550022
255600         WITH TEST AFTER                                          25560022
255700         VARYING PV-RETRY-COUNTER                                 25570022
255800         FROM 1 BY 1                                              25580022
255900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25590022
256000            OR  (SQLCODE = ZERO))                                 25600022
256100*                                                                 25610022
256200         EXEC SQL                                                 25620022
256300             SELECT IFNULL(MAX(PO_PREPK_ID),0)                    25630035
256400               INTO :PV-MAX-PO-ITM-PREPK-ID                       25640022
256500               FROM TPURITM                                       25650022
256600              WHERE PO_NBR         = :PURCHS-PO-NBR               25660022
256700                AND VER_STATUS_CDE = 'A'                          25670040
256800         END-EXEC                                                 25680022
256900*                                                                 25690022
257000         EVALUATE TRUE                                            25700022
257100             WHEN SQLCODE = +0                                    25710022
257200                 ADD +1 TO PV-GMAX-POITM-SUCSS-CNT                25720023
257300             WHEN SQLCODE = -904                                  25730022
257400             WHEN SQLCODE = -913                                  25740022
257500                  CONTINUE                                        25750022
257600             WHEN SQLWARN0 NOT = SPACES                           25760022
257700             WHEN SQLCODE < ZERO                                  25770022
257800             WHEN SQLCODE > ZERO                                  25780022
257900                  MOVE '5751-A-GET-MAX-PO-ITM-PREPK-ID'           25790022
194300                               TO PV-PARAGRAPH-NAME               25791051
258100                  MOVE 'UNSUCCESSFUL SELECT TPURITM-MAX PREPK ID' 25810022
194300                               TO PV-DB2-OPERATION                25820051
194300                  PERFORM 9100-SQL-ABEND                          25820151
258700         END-EVALUATE                                             25870022
258800     END-PERFORM.                                                 25880022
258900*                                                                 25890022
259000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25900022
259100         MOVE '5751-A-GET-MAX-PO-ITM-PREPK-ID'                    25910022
194300                               TO PV-PARAGRAPH-NAME               25920051
259300         MOVE 'MAX RETRIES EXCEEDED SELECT TPURITM-MAX PREPK ID'  25930022
194300                               TO PV-DB2-OPERATION                25931051
194300         PERFORM 9100-SQL-ABEND                                   25940151
259700     END-IF.                                                      25970022
259800/                                                                 25980022
259900******************************************************************25990022
260000* GET MAX PO-PREPKID FOR POPPRK                                   26000022
260100******************************************************************26010022
260200 5751-B-GET-MAX-PRPK-PREPK-ID.                                    26020022
260300*                                                                 26030022
260400     ADD +1 TO PV-GMAX-PREPK-ATMPT-CNT.                           26040023
260500     PERFORM                                                      26050022
260600         WITH TEST AFTER                                          26060022
260700         VARYING PV-RETRY-COUNTER                                 26070022
260800         FROM 1 BY 1                                              26080022
260900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26090022
261000            OR  (SQLCODE = ZERO))                                 26100022
261100*                                                                 26110022
261200         EXEC SQL                                                 26120022
261300             SELECT IFNULL(MAX(PO_PREPK_ID),0)                    26130035
261400               INTO :PV-MAX-PRPK-PREPK-ID                         26140022
261500               FROM TPOPRPK                                       26150022
261600              WHERE PO_NBR         = :PURCHS-PO-NBR               26160022
261700         END-EXEC                                                 26170022
261800*                                                                 26180022
261900         EVALUATE TRUE                                            26190022
262000             WHEN SQLCODE = +0                                    26200022
262100                 ADD +1 TO PV-GMAX-PREPK-SUCSS-CNT                26210023
262200             WHEN SQLCODE = -904                                  26220022
262300             WHEN SQLCODE = -913                                  26230022
262400                  CONTINUE                                        26240022
262500             WHEN SQLWARN0 NOT = SPACES                           26250022
262600             WHEN SQLCODE < ZERO                                  26260022
262700             WHEN SQLCODE > ZERO                                  26270022
262800                  MOVE '5751-B-GET-MAX-PRPK-PREPK-ID'             26280022
194300                               TO PV-PARAGRAPH-NAME               26290051
263000                  MOVE 'UNSUCCESSFUL SELECT TPURITM-MAX PREPK ID' 26300022
194300                               TO PV-DB2-OPERATION                26310051
194300                  PERFORM 9100-SQL-ABEND                          26310151
263600         END-EVALUATE                                             26360022
263700     END-PERFORM.                                                 26370022
263800*                                                                 26380022
263900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26390022
264000         MOVE '5751-B-GET-MAX-PRPK-PREPK-ID'                      26400022
194300                               TO PV-PARAGRAPH-NAME               26410051
264200         MOVE 'MAX RETRIES EXCEEDED SELECT TPURITM-MAX PREPK ID'  26420022
194300                               TO PV-DB2-OPERATION                26430051
194300         PERFORM 9100-SQL-ABEND                                   26430151
264600     END-IF.                                                      26460022
264700/                                                                 26470022
264800******************************************************************26480022
264900* CLOSE THE LINE ITEM CURSOR                                      26490022
265000******************************************************************26500022
265100 5760-CLOSE-PPUPDT-ITM-CSR.                                       26510022
265200*                                                                 26520022
265300     EXEC SQL                                                     26530022
265400         CLOSE PPUPDT-ITM-CSR                                     26540022
265500     END-EXEC.                                                    26550022
265600*                                                                 26560022
265700     EVALUATE TRUE                                                26570022
265800         WHEN SQLCODE = +0                                        26580022
265900              CONTINUE                                            26590022
266000*                                                                 26600022
266100         WHEN SQLWARN0 NOT = SPACE                                26610022
266200         WHEN SQLCODE  NOT = +0                                   26620022
266300              MOVE '5760-CLOSE-PPUPDT-ITM-CSR'                    26630022
194300                               TO PV-PARAGRAPH-NAME               26640051
266500              MOVE 'CLOSE PPUPDT-ITM-CSR'                         26650022
194300                               TO PV-DB2-OPERATION                26660051
194300              PERFORM 9100-SQL-ABEND                              26660151
267100     END-EVALUATE.                                                26710022
267200/                                                                 26720022
267300******************************************************************26730022
267400* INSERT TPOINST FOR PURCHS                                       26740022
267500******************************************************************26750022
267600 5770-ISRT-POINST.                                                26760022
267700*                                                                 26770022
267800     MOVE PURCHS-PO-NBR           TO POINST-PO-NBR.               26780022
267900     MOVE 'BO'                    TO POINST-RECIP-CDE.            26790022
268000     MOVE +681325                 TO POINST-INSTR-NBR.            26800022
268100     MOVE PC-CURRENT-PROGRAM-NAME TO POINST-CRE-BY-UID.           26810022
268200     MOVE PV-CURRENT-TMST         TO POINST-CRE-TMST.             26820022
268300*                                                                 26830022
268400     PERFORM 8800-INSERT-TPOINST.                                 26840022
268500*                                                                 26850022
268600/                                                                 26860022
268700******************************************************************26870022
268800*                                                                 26880022
268900******************************************************************26890022
269000 8000-WRITE-REPORT.                                               26900022
269100*                                                                 26910022
269200     IF (PV-LINE-CNT          > 59              OR                26920022
269300         PV-HOLD-DEPT-NBR NOT = PURCHS-DEPT-NBR)                  26930022
269400         PERFORM 8100-AUDIT-RPT-HEADINGS                          26940021
269500     END-IF.                                                      26950009
269600*                                                                 26960009
269700     PERFORM 8200-CHK-RPT-BRKS                                    26970019
269800*                                                                 26980008
269900     WRITE PORPT-RECORD FROM OR-REPORT-LINE                       26990006
270000         AFTER 1 LINE.                                            27000012
270100     ADD +1 TO PV-LINE-CNT.                                       27010007
270200/                                                                 27020008
270300******************************************************************27030019
270400*  PRINTS REPORT HEADINGS                                         27040019
270500******************************************************************27050019
270600 8100-AUDIT-RPT-HEADINGS.                                         27060019
270700*                                                                 27070019
270800     ADD  +1                      TO PV-PAGE-CNT.                 27080020
270900     MOVE PV-PAGE-CNT             TO HL2-PAGE.                    27090020
271000     MOVE +0                      TO PV-LINE-CNT.                 27100020
271100     WRITE PORPT-RECORD                                           27110020
271200      FROM HEADER-LINE1 AFTER ADVANCING PAGE.                     27120020
271300     WRITE PORPT-RECORD                                           27130020
271400      FROM HEADER-LINE2 AFTER 1 LINE.                             27140020
271500     EVALUATE TRUE                                                27150019
271600         WHEN AUDIT-MODE                                          27160020
271700             WRITE PORPT-RECORD                                   27170020
271800              FROM HEADER-LINE3 AFTER 2 LINE                      27180041
271900         WHEN UPDATE-MODE                                         27190020
272000             WRITE PORPT-RECORD                                   27200020
272100              FROM HEADER-LINE4 AFTER 2 LINE                      27210041
272200         WHEN PACK-MODE                                           27220020
272300             WRITE PORPT-RECORD                                   27230020
272400              FROM HEADER-LINE5 AFTER 2 LINE                      27240041
272500     END-EVALUATE.                                                27250020
272600     WRITE PORPT-RECORD                                           27260020
272700      FROM BLANK-REPORT-LINE AFTER 1 LINE.                        27270020
272800     EVALUATE TRUE                                                27280019
272900         WHEN PRAPDUPL                                            27290019
273000             WRITE PORPT-RECORD                                   27300019
273100              FROM PC-PRE-APRVL-POS-DUPL-SKU-MAN  AFTER 1 LINE    27310020
273200         WHEN ACTVDUPA                                            27320019
273300             WRITE PORPT-RECORD                                   27330019
273400              FROM PC-ACTV-DUPL-SKU-ACTV-PO-MAN   AFTER 1 LINE    27340020
273500         WHEN ACTVDUPC                                            27350019
273600             WRITE PORPT-RECORD                                   27360019
273700              FROM PC-ACTV-DUPL-SKU-CNCL-CNVRTD   AFTER 1 LINE    27370020
273800         WHEN CNCLDUPL                                            27380019
273900             WRITE PORPT-RECORD                                   27390019
274000              FROM PC-CNCL-DUPL-SKU-WILL-BE-DLTD1 AFTER 1 LINE    27400042
274100             WRITE PORPT-RECORD                                   27410041
274200              FROM PC-CNCL-DUPL-SKU-WILL-BE-DLTD2 AFTER 1 LINE    27420042
274300         WHEN PACKPRCS                                            27430019
274400             WRITE PORPT-RECORD                                   27440019
274500              FROM PC-PACK-PRCS-POS-WILL-BE-CNVTD AFTER 1 LINE    27450019
274600     END-EVALUATE.                                                27460020
274700     WRITE PORPT-RECORD                                           27470020
274800      FROM BLANK-REPORT-LINE AFTER 1 LINE.                        27480020
274900     WRITE PORPT-RECORD                                           27490020
275000      FROM DETAIL-HEADING-1  AFTER 1 LINE.                        27500020
275100     WRITE PORPT-RECORD                                           27510020
275200      FROM DETAIL-HDG-1-BRK  AFTER 1 LINE.                        27520020
275300     ADD  PC-HEADER-LINE-CNT      TO PV-LINE-CNT.                 27530020
275400/                                                                 27540019
275500******************************************************************27550008
275600*                                                                 27560008
275700******************************************************************27570008
275800 8200-CHK-RPT-BRKS.                                               27580019
275900*                                                                 27590008
276000     EVALUATE TRUE                                                27600008
276100* NEW PAGE                                                        27610010
276200       WHEN  PV-LINE-CNT               = PC-HEADER-LINE-CNT       27620020
276300           MOVE PURCHS-DEPT-NBR       TO PV-HOLD-DEPT-NBR         27630010
276400                                         DL1-DEPT-NBR             27640010
276500           MOVE PURCHS-OTB-PER-NBR    TO PV-HOLD-OTB-PER-NBR      27650010
276600           STRING PURCHS-OTB-PER-NBR(5:2) DELIMITED BY SIZE       27660012
276700                  '-'                     DELIMITED BY SIZE       27670012
276800                  PURCHS-OTB-PER-NBR(1:4) DELIMITED BY SIZE       27680012
276900                                    INTO DL1-OTB-PER-NBR          27690012
277000           END-STRING                                             27700012
277100           MOVE PURCHS-PO-NBR         TO PV-HOLD-PO-NBR           27710010
277200                                         DL1-PO-NBR               27720010
277300           MOVE PURCHS-STATUS-CDE     TO PV-HOLD-STATUS-CDE       27730010
277400                                         DL1-PURCHS-STATUS-CDE    27740010
277500* NO CHANGES                                                      27750010
277600       WHEN (PV-HOLD-STATUS-CDE        = PURCHS-STATUS-CDE  AND   27760010
277700             PV-HOLD-PO-NBR            = PURCHS-PO-NBR      AND   27770010
277800             PV-HOLD-OTB-PER-NBR       = PURCHS-OTB-PER-NBR AND   27780010
277900             PV-HOLD-DEPT-NBR          = PURCHS-DEPT-NBR)         27790010
278000         MOVE SPACES                  TO DL1-OTB-PER-NBR          27800010
278100                                         DL1-DEPT-NBR             27810010
278200                                         DL1-PO-NBR-SPACES        27820012
278300                                         DL1-PURCHS-STATUS-CDE    27830010
278400* OTB PER NBR CHANGES                                             27840010
278500       WHEN (PV-HOLD-OTB-PER-NBR   NOT = PURCHS-OTB-PER-NBR AND   27850010
278600             PV-HOLD-DEPT-NBR          = PURCHS-DEPT-NBR)         27860010
278700         MOVE PURCHS-OTB-PER-NBR      TO PV-HOLD-OTB-PER-NBR      27870012
278800         STRING PURCHS-OTB-PER-NBR(5:2)  DELIMITED BY SIZE        27880012
278900                '-'                      DELIMITED BY SIZE        27890012
279000                PURCHS-OTB-PER-NBR(1:4)  DELIMITED BY SIZE        27900012
279100                                    INTO DL1-OTB-PER-NBR          27910012
279200         END-STRING                                               27920012
279300         MOVE PURCHS-PO-NBR           TO PV-HOLD-PO-NBR           27930010
279400                                         DL1-PO-NBR               27940010
279500         MOVE PURCHS-STATUS-CDE       TO PV-HOLD-STATUS-CDE       27950010
279600                                         DL1-PURCHS-STATUS-CDE    27960010
279700         MOVE SPACES                  TO DL1-DEPT-NBR             27970010
279800         WRITE PORPT-RECORD FROM BLANK-REPORT-LINE                27980012
279900             AFTER 1 LINE                                         27990012
280000         ADD +1 TO PV-LINE-CNT                                    28000012
280100* PO NBR CHANGES                                                  28010010
280200       WHEN (PV-HOLD-PO-NBR        NOT = PURCHS-PO-NBR      AND   28020010
280300             PV-HOLD-OTB-PER-NBR       = PURCHS-OTB-PER-NBR AND   28030010
280400             PV-HOLD-DEPT-NBR          = PURCHS-DEPT-NBR)         28040010
280500         MOVE PURCHS-PO-NBR           TO PV-HOLD-PO-NBR           28050010
280600                                         DL1-PO-NBR               28060010
280700         MOVE PURCHS-STATUS-CDE       TO PV-HOLD-STATUS-CDE       28070010
280800                                         DL1-PURCHS-STATUS-CDE    28080010
280900         MOVE SPACES                  TO DL1-OTB-PER-NBR          28090010
281000                                         DL1-DEPT-NBR             28100010
281100         WRITE PORPT-RECORD FROM BLANK-REPORT-LINE                28110012
281200             AFTER 1 LINE                                         28120012
281300         ADD +1 TO PV-LINE-CNT                                    28130012
281400* STATUS CODE CHANGES                                             28140010
281500       WHEN (PV-HOLD-STATUS-CDE    NOT = PURCHS-STATUS-CDE  AND   28150010
281600             PV-HOLD-PO-NBR            = PURCHS-PO-NBR      AND   28160010
281700             PV-HOLD-OTB-PER-NBR       = PURCHS-OTB-PER-NBR AND   28170010
281800             PV-HOLD-DEPT-NBR          = PURCHS-DEPT-NBR)         28180010
281900         MOVE PURCHS-STATUS-CDE       TO PV-HOLD-STATUS-CDE       28190010
282000                                         DL1-PURCHS-STATUS-CDE    28200010
282100         MOVE SPACES                  TO DL1-PO-NBR-SPACES        28210012
282200                                         DL1-OTB-PER-NBR          28220010
282300                                         DL1-DEPT-NBR             28230010
282400     END-EVALUATE.                                                28240008
282500     IF PS-ROWS-FOUND                                             28250018
282600         MOVE DETAIL-LINE-1       TO OR-RPT-LINE                  28260018
282700     END-IF.                                                      28270018
282800/                                                                 28280006
282900******************************************************************28290021
283000*                                                                 28300021
283100******************************************************************28310021
283200 8300-SELECT-TPURCHS.                                             28320021
283300*                                                                 28330021
283400     PERFORM                                                      28340021
283500         WITH TEST AFTER                                          28350021
283600         VARYING PV-RETRY-COUNTER                                 28360021
283700         FROM 1 BY 1                                              28370021
283800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28380021
283900            OR  (SQLCODE = ZERO)                                  28390021
284000            OR  (SQLCODE = +100))                                 28400021
284100*                                                                 28410021
284200         EXEC SQL                                                 28420021
284300             SELECT PO_NBR                                        28430021
284400                   ,VER_NBR                                       28440021
284500                   ,VER_STATUS_CDE                                28450021
284600                   ,PO_TYP_CDE                                    28460021
284700                   ,PO_CATEG_CDE                                  28470021
284800                   ,EDI_IND                                       28480021
284900                   ,TOT_UNT_QTY                                   28490021
285000                   ,TOT_VAL_COST_AMT                              28500021
285100                   ,TOT_VAL_RTL_AMT                               28510021
285200                   ,TOT_MU_PCT                                    28520021
285300                   ,TOT_SKUS_QTY                                  28530021
285400                   ,IMPRT_AGNT_PO_NBR                             28540021
285500                   ,IMPRT_ORD_OFF_NAME                            28550021
285600                   ,IMPRT_VEND_NAME                               28560021
285700                   ,IMPRT_FCTRY_NAME                              28570021
285800                   ,IMPRT_CNTRY_NAME                              28580021
285900                   ,VEND_CNTRY_NAME                               28590021
286000                   ,NEW_STR_PO_IND                                28600021
286100                   ,IMPRT_PO_IND                                  28610021
286200                   ,IMPRT_AGNT_PO_IND                             28620021
286300                   ,STATUS_TMST                                   28630021
286400                   ,LAST_UPD_TMST                                 28640021
286500                   ,EDI_REXMIT_IND                                28650021
286600                   ,EDI_REXMIT_TMST                               28660021
286700                   ,DIR_STR_IND                                   28670021
286800                   ,LAST_UPD_BY_UID                               28680021
286900                   ,APP_BY_UID                                    28690021
287000                   ,OTB_PER_NBR                                   28700021
287100                   ,DEPT_NBR                                      28710021
287200                   ,ENT_ID                                        28720021
287300                   ,STATUS_CDE                                    28730021
287400                   ,CRE_BY_UID                                    28740021
287500                   ,REJ_CT                                        28750021
287600                   ,REJ_UID                                       28760021
287700                   ,ORD_DTE                                       28770021
287800                   ,REVISION_CT                                   28780021
287900                   ,ADR_SEQ_NBR                                   28790021
288000                   ,DEST_KNOWN_IND                                28800021
288100                   ,RLSE_IND                                      28810021
288200                   ,RLSE_DTE                                      28820021
288300                   ,ANLYS_HOLD_IND                                28830021
288400                   ,PLCMNT_CNTRY_CDE                              28840021
288500                   ,PROD_CNTRY_CDE                                28850021
288600                   ,UNT_PER_CBMT_QTY                              28860021
288700                   ,TKT_FMT_NBR                                   28870021
288800                   ,TKT_FMT_DESC                                  28880021
288900                   ,CRE_TMST                                      28890021
289000                   ,PRG_LAST_ACTVY_DTE                            28900021
289100                   ,PKGNG_CDE                                     28910021
289200                   ,SEASET_YR                                     28920021
289300                   ,SEASET_SHRT_NM                                28930021
289400                   ,QTA_CTG_CDE                                   28940021
289500                   ,PO_IN_RMS_IND                                 28950021
289600                   ,RMS_PO_UPD_TMST                               28960025
289700                   ,DUP_SKU_IND                                   28970022
289800                   ,ORIG_PKGNG_CDE                                28980022
289900               INTO                                               28990021
290000                    :PVT-PRCHS-PO-NBR                             29000022
290100                   ,:PVT-PRCHS-VER-NBR                            29010022
290200                   ,:PVT-PRCHS-VER-STATUS-CDE                     29020022
290300                   ,:PVT-PRCHS-PO-TYP-CDE                         29030022
290400                   ,:PVT-PRCHS-PO-CATEG-CDE                       29040022
290500                   ,:PVT-PRCHS-EDI-IND                            29050022
290600                   ,:PVT-PRCHS-TOT-UNT-QTY                        29060022
290700                   ,:PVT-PRCHS-TOT-VAL-COST-AMT                   29070022
290800                   ,:PVT-PRCHS-TOT-VAL-RTL-AMT                    29080022
290900                   ,:PVT-PRCHS-TOT-MU-PCT                         29090022
291000                   ,:PVT-PRCHS-TOT-SKUS-QTY                       29100022
291100                   ,:PVT-PRCHS-IMPRT-AGNT-PO-NBR                  29110022
291200                   ,:PVT-PRCHS-IMPRT-ORD-OFF-NAME                 29120022
291300                   ,:PVT-PRCHS-IMPRT-VEND-NAME                    29130022
291400                   ,:PVT-PRCHS-IMPRT-FCTRY-NAME                   29140022
291500                   ,:PVT-PRCHS-IMPRT-CNTRY-NAME                   29150022
291600                   ,:PVT-PRCHS-VEND-CNTRY-NAME                    29160022
291700                   ,:PVT-PRCHS-NEW-STR-PO-IND                     29170022
291800                   ,:PVT-PRCHS-IMPRT-PO-IND                       29180022
291900                   ,:PVT-PRCHS-IMPRT-AGNT-PO-IND                  29190022
292000                   ,:PVT-PRCHS-STATUS-TMST                        29200022
292100                   ,:PVT-PRCHS-LAST-UPD-TMST                      29210022
292200                   ,:PVT-PRCHS-EDI-REXMIT-IND                     29220022
292300                   ,:PVT-PRCHS-EDI-REXMIT-TMST                    29230022
292400                   ,:PVT-PRCHS-DIR-STR-IND                        29240022
292500                   ,:PVT-PRCHS-LAST-UPD-BY-UID                    29250022
292600                   ,:PVT-PRCHS-APP-BY-UID                         29260022
292700                   ,:PVT-PRCHS-OTB-PER-NBR                        29270022
292800                   ,:PVT-PRCHS-DEPT-NBR                           29280022
292900                   ,:PVT-PRCHS-ENT-ID                             29290022
293000                   ,:PVT-PRCHS-STATUS-CDE                         29300022
293100                   ,:PVT-PRCHS-CRE-BY-UID                         29310022
293200                   ,:PVT-PRCHS-REJ-CT                             29320022
293300                   ,:PVT-PRCHS-REJ-UID                            29330022
293400                   ,:PVT-PRCHS-ORD-DTE                            29340022
293500                   ,:PVT-PRCHS-REVISION-CT                        29350022
293600                   ,:PVT-PRCHS-ADR-SEQ-NBR                        29360022
293700                   ,:PVT-PRCHS-DEST-KNOWN-IND                     29370022
293800                   ,:PVT-PRCHS-RLSE-IND                           29380022
293900                   ,:PVT-PRCHS-RLSE-DTE                           29390022
294000                   ,:PVT-PRCHS-ANLYS-HOLD-IND                     29400022
294100                   ,:PVT-PRCHS-PLCMNT-CNTRY-CDE                   29410022
294200                   ,:PVT-PRCHS-PROD-CNTRY-CDE                     29420022
294300                   ,:PVT-PRCHS-UNT-PER-CBMT-QTY                   29430022
294400                   ,:PVT-PRCHS-TKT-FMT-NBR                        29440022
294500                   ,:PVT-PRCHS-TKT-FMT-DESC                       29450022
294600                   ,:PVT-PRCHS-CRE-TMST                           29460022
294700                   ,:PVT-PRCHS-PRG-LAST-ACTVY-DTE                 29470022
294800                   ,:PVT-PRCHS-PKGNG-CDE                          29480022
294900                   ,:PVT-PRCHS-SEASET-YR                          29490022
295000                   ,:PVT-PRCHS-SEASET-SHRT-NM                     29500022
295100                   ,:PVT-PRCHS-QTA-CTG-CDE                        29510022
295200                   ,:PVT-PRCHS-PO-IN-RMS-IND                      29520022
295300                   ,:PVT-PRCHS-RMS-PO-UPD-TMST                    29530025
295400                   ,:PVT-PRCHS-DUP-SKU-IND                        29540022
295500                   ,:PVT-PRCHS-ORIG-PKGNG-CDE                     29550022
295600               FROM TPURCHS                                       29560021
295700              WHERE PO_NBR         = :PURCHS-PO-NBR               29570032
295800                AND VER_STATUS_CDE = 'A'                          29580032
295900                AND STATUS_CDE     = :PURCHS-STATUS-CDE           29590021
296000                AND OTB_PER_NBR    = :PURCHS-OTB-PER-NBR          29600021
296100         END-EXEC                                                 29610021
296200*                                                                 29620021
296300         EVALUATE TRUE                                            29630021
296400             WHEN SQLCODE = +0                                    29640021
296500             WHEN SQLCODE = -904                                  29650021
296600             WHEN SQLCODE = -913                                  29660021
296700                  CONTINUE                                        29670021
296800             WHEN SQLCODE = +100                                  29680021
296900             WHEN SQLWARN0 NOT = SPACES                           29690021
297000             WHEN SQLCODE < ZERO                                  29700021
297100             WHEN SQLCODE > ZERO                                  29710021
297200                  MOVE '8300-SELECT-TPURCHS'                      29720021
194300                               TO PV-PARAGRAPH-NAME               29730051
297400                  MOVE 'UNSUCCESSFUL SELECT TPURCHS'              29740021
194300                               TO PV-DB2-OPERATION                29750051
194300                  PERFORM 9100-SQL-ABEND                          29750151
298000         END-EVALUATE                                             29800021
298100     END-PERFORM.                                                 29810021
298200*                                                                 29820021
298300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29830021
298400         MOVE '8300-SELECT-TPURCHS'                               29840021
194300                               TO PV-PARAGRAPH-NAME               29850051
298600         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURCHS'            29860021
194300                               TO PV-DB2-OPERATION                29870051
194300         PERFORM 9100-SQL-ABEND                                   29870151
299000     END-IF.                                                      29900021
299100/                                                                 29910021
299200******************************************************************29920021
299300*                                                                 29930021
299400******************************************************************29940021
299500 8400-UPDATE-TPURCHS.                                             29950021
299600*                                                                 29960021
299700     ADD +1 TO PV-UPD-PURCHS-ATMPT-CNT.                           29970023
299800     PERFORM                                                      29980021
299900         WITH TEST AFTER                                          29990021
300000         VARYING PV-RETRY-COUNTER                                 30000021
300100         FROM 1 BY 1                                              30010021
300200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30020021
300300            OR  (SQLCODE = ZERO)                                  30030021
300400            OR  (SQLCODE = +100))                                 30040021
300500*                                                                 30050021
300600         EXEC SQL                                                 30060021
300700             UPDATE TPURCHS                                       30070021
300800                SET(PO_NBR                                        30080021
300900                   ,VER_NBR                                       30090021
301000                   ,VER_STATUS_CDE                                30100021
301100                   ,PO_TYP_CDE                                    30110021
301200                   ,PO_CATEG_CDE                                  30120021
301300                   ,EDI_IND                                       30130021
301400                   ,TOT_UNT_QTY                                   30140021
301500                   ,TOT_VAL_COST_AMT                              30150021
301600                   ,TOT_VAL_RTL_AMT                               30160021
301700                   ,TOT_MU_PCT                                    30170021
301800                   ,TOT_SKUS_QTY                                  30180021
301900                   ,IMPRT_AGNT_PO_NBR                             30190021
302000                   ,IMPRT_ORD_OFF_NAME                            30200021
302100                   ,IMPRT_VEND_NAME                               30210021
302200                   ,IMPRT_FCTRY_NAME                              30220021
302300                   ,IMPRT_CNTRY_NAME                              30230021
302400                   ,VEND_CNTRY_NAME                               30240021
302500                   ,NEW_STR_PO_IND                                30250021
302600                   ,IMPRT_PO_IND                                  30260021
302700                   ,IMPRT_AGNT_PO_IND                             30270021
302800                   ,STATUS_TMST                                   30280021
302900                   ,LAST_UPD_TMST                                 30290021
303000                   ,EDI_REXMIT_IND                                30300021
303100                   ,EDI_REXMIT_TMST                               30310021
303200                   ,DIR_STR_IND                                   30320021
303300                   ,LAST_UPD_BY_UID                               30330021
303400                   ,APP_BY_UID                                    30340021
303500                   ,OTB_PER_NBR                                   30350021
303600                   ,DEPT_NBR                                      30360021
303700                   ,ENT_ID                                        30370021
303800                   ,STATUS_CDE                                    30380021
303900                   ,CRE_BY_UID                                    30390021
304000                   ,REJ_CT                                        30400021
304100                   ,REJ_UID                                       30410021
304200                   ,ORD_DTE                                       30420021
304300                   ,REVISION_CT                                   30430021
304400                   ,ADR_SEQ_NBR                                   30440021
304500                   ,DEST_KNOWN_IND                                30450021
304600                   ,RLSE_IND                                      30460021
304700                   ,RLSE_DTE                                      30470021
304800                   ,ANLYS_HOLD_IND                                30480021
304900                   ,PLCMNT_CNTRY_CDE                              30490021
305000                   ,PROD_CNTRY_CDE                                30500021
305100                   ,UNT_PER_CBMT_QTY                              30510021
305200                   ,TKT_FMT_NBR                                   30520021
305300                   ,TKT_FMT_DESC                                  30530021
305400                   ,CRE_TMST                                      30540021
305500                   ,PRG_LAST_ACTVY_DTE                            30550021
305600                   ,PKGNG_CDE                                     30560021
305700                   ,SEASET_YR                                     30570021
305800                   ,SEASET_SHRT_NM                                30580021
305900                   ,QTA_CTG_CDE                                   30590021
306000                   ,PO_IN_RMS_IND                                 30600022
306100                   ,RMS_PO_UPD_TMST                               30610025
306200                   ,DUP_SKU_IND                                   30620022
306300                   ,ORIG_PKGNG_CDE)                               30630022
306400                  =                                               30640021
306500                   (:PVT-PRCHS-PO-NBR                             30650021
306600                   ,:PVT-PRCHS-VER-NBR                            30660021
306700                   ,:PVT-PRCHS-VER-STATUS-CDE                     30670021
306800                   ,:PVT-PRCHS-PO-TYP-CDE                         30680021
306900                   ,:PVT-PRCHS-PO-CATEG-CDE                       30690021
307000                   ,:PVT-PRCHS-EDI-IND                            30700021
307100                   ,:PVT-PRCHS-TOT-UNT-QTY                        30710021
307200                   ,:PVT-PRCHS-TOT-VAL-COST-AMT                   30720021
307300                   ,:PVT-PRCHS-TOT-VAL-RTL-AMT                    30730021
307400                   ,:PVT-PRCHS-TOT-MU-PCT                         30740021
307500                   ,:PVT-PRCHS-TOT-SKUS-QTY                       30750021
307600                   ,:PVT-PRCHS-IMPRT-AGNT-PO-NBR                  30760021
307700                   ,:PVT-PRCHS-IMPRT-ORD-OFF-NAME                 30770021
307800                   ,:PVT-PRCHS-IMPRT-VEND-NAME                    30780021
307900                   ,:PVT-PRCHS-IMPRT-FCTRY-NAME                   30790021
308000                   ,:PVT-PRCHS-IMPRT-CNTRY-NAME                   30800021
308100                   ,:PVT-PRCHS-VEND-CNTRY-NAME                    30810021
308200                   ,:PVT-PRCHS-NEW-STR-PO-IND                     30820021
308300                   ,:PVT-PRCHS-IMPRT-PO-IND                       30830021
308400                   ,:PVT-PRCHS-IMPRT-AGNT-PO-IND                  30840021
308500                   ,:PVT-PRCHS-STATUS-TMST                        30850021
308600                   ,:PVT-PRCHS-LAST-UPD-TMST                      30860021
308700                   ,:PVT-PRCHS-EDI-REXMIT-IND                     30870021
308800                   ,:PVT-PRCHS-EDI-REXMIT-TMST                    30880021
308900                   ,:PVT-PRCHS-DIR-STR-IND                        30890021
309000                   ,:PVT-PRCHS-LAST-UPD-BY-UID                    30900021
309100                   ,:PVT-PRCHS-APP-BY-UID                         30910021
309200                   ,:PVT-PRCHS-OTB-PER-NBR                        30920021
309300                   ,:PVT-PRCHS-DEPT-NBR                           30930021
309400                   ,:PVT-PRCHS-ENT-ID                             30940021
309500                   ,:PVT-PRCHS-STATUS-CDE                         30950021
309600                   ,:PVT-PRCHS-CRE-BY-UID                         30960021
309700                   ,:PVT-PRCHS-REJ-CT                             30970021
309800                   ,:PVT-PRCHS-REJ-UID                            30980021
309900                   ,:PVT-PRCHS-ORD-DTE                            30990021
310000                   ,:PVT-PRCHS-REVISION-CT                        31000021
310100                   ,:PVT-PRCHS-ADR-SEQ-NBR                        31010021
310200                   ,:PVT-PRCHS-DEST-KNOWN-IND                     31020021
310300                   ,:PVT-PRCHS-RLSE-IND                           31030021
310400                   ,:PVT-PRCHS-RLSE-DTE                           31040021
310500                   ,:PVT-PRCHS-ANLYS-HOLD-IND                     31050021
310600                   ,:PVT-PRCHS-PLCMNT-CNTRY-CDE                   31060021
310700                   ,:PVT-PRCHS-PROD-CNTRY-CDE                     31070021
310800                   ,:PVT-PRCHS-UNT-PER-CBMT-QTY                   31080021
310900                   ,:PVT-PRCHS-TKT-FMT-NBR                        31090021
311000                   ,:PVT-PRCHS-TKT-FMT-DESC                       31100021
311100                   ,:PVT-PRCHS-CRE-TMST                           31110021
311200                   ,:PVT-PRCHS-PRG-LAST-ACTVY-DTE                 31120021
311300                   ,:PVT-PRCHS-PKGNG-CDE                          31130021
311400                   ,:PVT-PRCHS-SEASET-YR                          31140021
311500                   ,:PVT-PRCHS-SEASET-SHRT-NM                     31150021
311600                   ,:PVT-PRCHS-QTA-CTG-CDE                        31160021
311700                   ,:PVT-PRCHS-PO-IN-RMS-IND                      31170022
311800                   ,:PVT-PRCHS-RMS-PO-UPD-TMST                    31180025
311900                   ,:PVT-PRCHS-DUP-SKU-IND                        31190022
312000                   ,:PVT-PRCHS-ORIG-PKGNG-CDE)                    31200022
312100              WHERE PO_NBR         = :PVT-PRCHS-PO-NBR            31210021
312200                AND VER_NBR        = :PVT-PRCHS-VER-NBR           31220021
312300         END-EXEC                                                 31230021
312400*                                                                 31240021
312500         EVALUATE TRUE                                            31250021
312600             WHEN SQLCODE = +0                                    31260021
312700                 ADD +1 TO PV-UPD-PURCHS-SUCSS-CNT                31270023
312800             WHEN SQLCODE = -904                                  31280021
312900             WHEN SQLCODE = -913                                  31290021
313000                  CONTINUE                                        31300021
313100             WHEN SQLCODE = +100                                  31310021
313200             WHEN SQLWARN0 NOT = SPACES                           31320021
313300             WHEN SQLCODE < ZERO                                  31330021
313400             WHEN SQLCODE > ZERO                                  31340021
313500                  MOVE '8400-UPDATE-TPURCHS'                      31350023
194300                               TO PV-PARAGRAPH-NAME               31360051
313700                  MOVE 'UNSUCCESSFUL UPDATE TPURCHS'              31370023
194300                               TO PV-DB2-OPERATION                31380051
194300                  PERFORM 9100-SQL-ABEND                          31380151
314300         END-EVALUATE                                             31430021
314400     END-PERFORM.                                                 31440021
314500*                                                                 31450021
314600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31460021
314700         MOVE '8400-UPDATE-TPURCHS'                               31470023
194300                               TO PV-PARAGRAPH-NAME               31480051
314900         MOVE 'MAX RETRIES EXCEEDED ON UPDATE TPURCHS'            31490023
194300                               TO PV-DB2-OPERATION                31500051
194300         PERFORM 9100-SQL-ABEND                                   31500151
316200     END-IF.                                                      31620021
316300/                                                                 31630021
316400******************************************************************31640021
316500*                                                                 31650021
316600******************************************************************31660021
316700 8450-INSERT-TPURCHS.                                             31670038
316800*                                                                 31680021
316900     ADD +1 TO PV-ISRT-PURCHS-ATMPT-CNT.                          31690038
317000     PERFORM                                                      31700021
317100         WITH TEST AFTER                                          31710021
317200         VARYING PV-RETRY-COUNTER                                 31720021
317300         FROM 1 BY 1                                              31730021
317400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31740021
317500            OR  (SQLCODE = ZERO))                                 31750038
317600*                                                                 31760021
317700         EXEC SQL                                                 31770038
317800             INSERT INTO TPURCHS                                  31780038
317900                   (PO_NBR                                        31790038
318000                   ,VER_NBR                                       31800038
318100                   ,VER_STATUS_CDE                                31810038
318200                   ,PO_TYP_CDE                                    31820038
318300                   ,PO_CATEG_CDE                                  31830038
318400                   ,EDI_IND                                       31840038
318500                   ,TOT_UNT_QTY                                   31850038
318600                   ,TOT_VAL_COST_AMT                              31860038
318700                   ,TOT_VAL_RTL_AMT                               31870038
318800                   ,TOT_MU_PCT                                    31880038
318900                   ,TOT_SKUS_QTY                                  31890038
319000                   ,IMPRT_AGNT_PO_NBR                             31900038
319100                   ,IMPRT_ORD_OFF_NAME                            31910038
319200                   ,IMPRT_VEND_NAME                               31920038
319300                   ,IMPRT_FCTRY_NAME                              31930038
319400                   ,IMPRT_CNTRY_NAME                              31940038
319500                   ,VEND_CNTRY_NAME                               31950038
319600                   ,NEW_STR_PO_IND                                31960038
319700                   ,IMPRT_PO_IND                                  31970038
319800                   ,IMPRT_AGNT_PO_IND                             31980038
319900                   ,STATUS_TMST                                   31990038
320000                   ,LAST_UPD_TMST                                 32000038
320100                   ,EDI_REXMIT_IND                                32010038
320200                   ,EDI_REXMIT_TMST                               32020038
320300                   ,DIR_STR_IND                                   32030038
320400                   ,LAST_UPD_BY_UID                               32040038
320500                   ,APP_BY_UID                                    32050038
320600                   ,OTB_PER_NBR                                   32060038
320700                   ,DEPT_NBR                                      32070038
320800                   ,ENT_ID                                        32080038
320900                   ,STATUS_CDE                                    32090038
321000                   ,CRE_BY_UID                                    32100038
321100                   ,REJ_CT                                        32110038
321200                   ,REJ_UID                                       32120038
321300                   ,ORD_DTE                                       32130038
321400                   ,REVISION_CT                                   32140038
321500                   ,ADR_SEQ_NBR                                   32150038
321600                   ,DEST_KNOWN_IND                                32160038
321700                   ,RLSE_IND                                      32170038
321800                   ,RLSE_DTE                                      32180038
321900                   ,ANLYS_HOLD_IND                                32190038
322000                   ,PLCMNT_CNTRY_CDE                              32200038
322100                   ,PROD_CNTRY_CDE                                32210038
322200                   ,UNT_PER_CBMT_QTY                              32220038
322300                   ,TKT_FMT_NBR                                   32230038
322400                   ,TKT_FMT_DESC                                  32240038
322500                   ,CRE_TMST                                      32250038
322600                   ,PRG_LAST_ACTVY_DTE                            32260038
322700                   ,PKGNG_CDE                                     32270038
322800                   ,SEASET_YR                                     32280038
322900                   ,SEASET_SHRT_NM                                32290038
323000                   ,QTA_CTG_CDE                                   32300038
323100                   ,PO_IN_RMS_IND                                 32310038
323200                   ,RMS_PO_UPD_TMST                               32320038
323300                   ,DUP_SKU_IND                                   32330038
323400                   ,ORIG_PKGNG_CDE)                               32340038
323500             VALUES                                               32350038
323600                   (:PVT-PRCHS-PO-NBR                             32360038
323700                   ,:PVT-PRCHS-VER-NBR                            32370038
323800                   ,:PVT-PRCHS-VER-STATUS-CDE                     32380038
323900                   ,:PVT-PRCHS-PO-TYP-CDE                         32390038
324000                   ,:PVT-PRCHS-PO-CATEG-CDE                       32400038
324100                   ,:PVT-PRCHS-EDI-IND                            32410038
324200                   ,:PVT-PRCHS-TOT-UNT-QTY                        32420038
324300                   ,:PVT-PRCHS-TOT-VAL-COST-AMT                   32430038
324400                   ,:PVT-PRCHS-TOT-VAL-RTL-AMT                    32440038
324500                   ,:PVT-PRCHS-TOT-MU-PCT                         32450038
324600                   ,:PVT-PRCHS-TOT-SKUS-QTY                       32460038
324700                   ,:PVT-PRCHS-IMPRT-AGNT-PO-NBR                  32470038
324800                   ,:PVT-PRCHS-IMPRT-ORD-OFF-NAME                 32480038
324900                   ,:PVT-PRCHS-IMPRT-VEND-NAME                    32490038
325000                   ,:PVT-PRCHS-IMPRT-FCTRY-NAME                   32500038
325100                   ,:PVT-PRCHS-IMPRT-CNTRY-NAME                   32510038
325200                   ,:PVT-PRCHS-VEND-CNTRY-NAME                    32520038
325300                   ,:PVT-PRCHS-NEW-STR-PO-IND                     32530038
325400                   ,:PVT-PRCHS-IMPRT-PO-IND                       32540038
325500                   ,:PVT-PRCHS-IMPRT-AGNT-PO-IND                  32550038
325600                   ,:PVT-PRCHS-STATUS-TMST                        32560038
325700                   ,:PVT-PRCHS-LAST-UPD-TMST                      32570038
325800                   ,:PVT-PRCHS-EDI-REXMIT-IND                     32580038
325900                   ,:PVT-PRCHS-EDI-REXMIT-TMST                    32590038
326000                   ,:PVT-PRCHS-DIR-STR-IND                        32600038
326100                   ,:PVT-PRCHS-LAST-UPD-BY-UID                    32610038
326200                   ,:PVT-PRCHS-APP-BY-UID                         32620038
326300                   ,:PVT-PRCHS-OTB-PER-NBR                        32630038
326400                   ,:PVT-PRCHS-DEPT-NBR                           32640038
326500                   ,:PVT-PRCHS-ENT-ID                             32650038
326600                   ,:PVT-PRCHS-STATUS-CDE                         32660038
326700                   ,:PVT-PRCHS-CRE-BY-UID                         32670038
326800                   ,:PVT-PRCHS-REJ-CT                             32680038
326900                   ,:PVT-PRCHS-REJ-UID                            32690038
327000                   ,:PVT-PRCHS-ORD-DTE                            32700038
327100                   ,:PVT-PRCHS-REVISION-CT                        32710038
327200                   ,:PVT-PRCHS-ADR-SEQ-NBR                        32720038
327300                   ,:PVT-PRCHS-DEST-KNOWN-IND                     32730038
327400                   ,:PVT-PRCHS-RLSE-IND                           32740038
327500                   ,:PVT-PRCHS-RLSE-DTE                           32750038
327600                   ,:PVT-PRCHS-ANLYS-HOLD-IND                     32760038
327700                   ,:PVT-PRCHS-PLCMNT-CNTRY-CDE                   32770038
327800                   ,:PVT-PRCHS-PROD-CNTRY-CDE                     32780038
327900                   ,:PVT-PRCHS-UNT-PER-CBMT-QTY                   32790038
328000                   ,:PVT-PRCHS-TKT-FMT-NBR                        32800038
328100                   ,:PVT-PRCHS-TKT-FMT-DESC                       32810038
328200                   ,:PVT-PRCHS-CRE-TMST                           32820038
328300                   ,:PVT-PRCHS-PRG-LAST-ACTVY-DTE                 32830038
328400                   ,:PVT-PRCHS-PKGNG-CDE                          32840038
328500                   ,:PVT-PRCHS-SEASET-YR                          32850038
328600                   ,:PVT-PRCHS-SEASET-SHRT-NM                     32860038
328700                   ,:PVT-PRCHS-QTA-CTG-CDE                        32870038
328800                   ,:PVT-PRCHS-PO-IN-RMS-IND                      32880038
328900                   ,:PVT-PRCHS-RMS-PO-UPD-TMST                    32890038
329000                   ,:PVT-PRCHS-DUP-SKU-IND                        32900038
329100                   ,:PVT-PRCHS-ORIG-PKGNG-CDE)                    32910038
329200         END-EXEC                                                 32920038
329300*                                                                 32930038
329400         EVALUATE TRUE                                            32940038
329500             WHEN SQLCODE = +0                                    32950038
329600                 ADD +1 TO PV-ISRT-PURCHS-SUCSS-CNT               32960038
329700             WHEN SQLCODE = -904                                  32970038
329800             WHEN SQLCODE = -913                                  32980038
329900                  CONTINUE                                        32990038
330000             WHEN SQLWARN0 NOT = SPACES                           33000038
330100             WHEN SQLCODE < ZERO                                  33010038
330200             WHEN SQLCODE > ZERO                                  33020038
330300                  MOVE '8450-INSERT-TPURCHS'                      33030038
194300                               TO PV-PARAGRAPH-NAME               33040051
330500                  MOVE 'UNSUCCESSFUL INSERT TPURCHS'              33050038
194300                               TO PV-DB2-OPERATION                33060051
194300                  PERFORM 9100-SQL-ABEND                          33060151
331100         END-EVALUATE                                             33110038
331200     END-PERFORM.                                                 33120038
331300*                                                                 33130038
331400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33140038
331500         MOVE '8450-INSERT-TPURCHS'                               33150038
194300                               TO PV-PARAGRAPH-NAME               33160051
331700         MOVE 'MAX RETRIES EXCEEDED ON INSERT TPURCHS'            33170038
194300                               TO PV-DB2-OPERATION                33180051
194300         PERFORM 9100-SQL-ABEND                                   33180151
333000     END-IF.                                                      33300038
333100/                                                                 33310038
333200******************************************************************33320038
333300*                                                                 33330038
333400******************************************************************33340038
333500 8500-UPDATE-TPURITM.                                             33350038
333600*                                                                 33360038
333700     ADD +1 TO PV-UPD-PURITM-ATMPT-CNT.                           33370038
333800     PERFORM                                                      33380038
333900         WITH TEST AFTER                                          33390038
334000         VARYING PV-RETRY-COUNTER                                 33400038
334100         FROM 1 BY 1                                              33410038
334200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33420038
334300            OR  (SQLCODE = ZERO)                                  33430038
334400            OR  (SQLCODE = +100))                                 33440038
334500*                                                                 33450038
334600         EXEC SQL                                                 33460038
334700             UPDATE TPURITM                                       33470021
334800                SET(PO_NBR                                        33480021
334900                   ,VER_NBR                                       33490021
335000                   ,PO_LNE_NBR                                    33500021
335100                   ,VER_STATUS_CDE                                33510021
335200                   ,SKU_SEQ_NBR                                   33520021
335300                   ,CL_NBR                                        33530021
335400                   ,VEND_STYL_NAME                                33540021
335500                   ,COLOR_DESC                                    33550021
335600                   ,SIZE_DESC                                     33560021
335700                   ,UM_IND                                        33570021
335800                   ,UNT_QTY                                       33580021
335900                   ,UNT_RTL_PR_AMT                                33590021
336000                   ,UNT_COST_AMT                                  33600021
336100                   ,TOT_VAL_COST_AMT                              33610021
336200                   ,TOT_VAL_RTL_AMT                               33620021
336300                   ,MU_PCT                                        33630021
336400                   ,CRE_TMST                                      33640021
336500                   ,LAST_UPD_TMST                                 33650021
336600                   ,ITM_NBR                                       33660021
336700                   ,SKU_DESC                                      33670021
336800                   ,COLOR_CDE                                     33680021
336900                   ,SIZE_CDE                                      33690021
337000                   ,AD_EVNT_DTE                                   33700021
337100                   ,STATUS_CDE                                    33710021
337200                   ,CRE_BY_UID                                    33720021
337300                   ,LAST_UPD_BY_UID                               33730021
337400                   ,GP_RTL_AMT                                    33740021
337500                   ,GP_QTY                                        33750021
337600                   ,APP_PO_LNE_NBR                                33760021
337700                   ,PIC_ITM_IND                                   33770021
337800                   ,PIC_PG_NBR                                    33780021
337900                   ,PRD_1ST_COST_AMT                              33790021
338000                   ,STAT_TMST                                     33800021
338100                   ,PO_PREPK_ID                                   33810021
338200                   ,PREPK_RATO_QTY                                33820021
338300                   ,SHIP_TO_TMP_DC_IND                            33830021
338400                   ,RMS_PO_SKU_NBR)                               33840021
338500                 = (:PURITM-PO-NBR                                33850053
338600                   ,:PURITM-VER-NBR                               33860021
338700                   ,:PURITM-PO-LNE-NBR                            33870021
338800                   ,:PURITM-VER-STATUS-CDE                        33880021
338900                   ,:PURITM-SKU-SEQ-NBR                           33890021
339000                   ,:PURITM-CL-NBR                                33900021
339100                   ,:PURITM-VEND-STYL-NAME                        33910021
339200                   ,:PURITM-COLOR-DESC                            33920021
339300                   ,:PURITM-SIZE-DESC                             33930021
339400                   ,:PURITM-UM-IND                                33940021
339500                   ,:PURITM-UNT-QTY                               33950021
339600                   ,:PURITM-UNT-RTL-PR-AMT                        33960021
339700                   ,:PURITM-UNT-COST-AMT                          33970021
339800                   ,:PURITM-TOT-VAL-COST-AMT                      33980021
339900                   ,:PURITM-TOT-VAL-RTL-AMT                       33990021
340000                   ,:PURITM-MU-PCT                                34000021
340100                   ,:PURITM-CRE-TMST                              34010021
340200                   ,:PURITM-LAST-UPD-TMST                         34020021
340300                   ,:PURITM-ITM-NBR                               34030021
340400                   ,:PURITM-SKU-DESC                              34040021
340500                   ,:PURITM-COLOR-CDE                             34050021
340600                   ,:PURITM-SIZE-CDE                              34060021
340700                   ,:PURITM-AD-EVNT-DTE                           34070021
340800                   ,:PURITM-STATUS-CDE                            34080021
340900                   ,:PURITM-CRE-BY-UID                            34090021
341000                   ,:PURITM-LAST-UPD-BY-UID                       34100021
341100                   ,:PURITM-GP-RTL-AMT                            34110021
341200                   ,:PURITM-GP-QTY                                34120021
341300                   ,:PURITM-APP-PO-LNE-NBR                        34130021
341400                   ,:PURITM-PIC-ITM-IND                           34140021
341500                   ,:PURITM-PIC-PG-NBR                            34150021
341600                   ,:PURITM-PRD-1ST-COST-AMT                      34160021
341700                   ,:PURITM-STAT-TMST                             34170021
341800                   ,:PURITM-PO-PREPK-ID                           34180021
341900                   ,:PURITM-PREPK-RATO-QTY                        34190021
342000                   ,:PURITM-SHIP-TO-TMP-DC-IND                    34200021
342100                   ,:PURITM-RMS-PO-SKU-NBR)                       34210021
342200              WHERE PO_NBR         = :PURITM-PO-NBR               34220021
342300                AND VER_NBR        = :PURITM-VER-NBR              34230021
342400                AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR           34240021
342500         END-EXEC                                                 34250021
342600*                                                                 34260021
342700         EVALUATE TRUE                                            34270021
342800             WHEN SQLCODE = +0                                    34280021
342900                 ADD +1 TO PV-UPD-PURITM-SUCSS-CNT                34290023
343000             WHEN SQLCODE = -904                                  34300021
343100             WHEN SQLCODE = -913                                  34310021
343200                  CONTINUE                                        34320021
343300             WHEN SQLCODE = +100                                  34330021
343400             WHEN SQLWARN0 NOT = SPACES                           34340021
343500             WHEN SQLCODE < ZERO                                  34350021
343600             WHEN SQLCODE > ZERO                                  34360021
343700                  MOVE '8500-UPDATE-TPURITM'                      34370021
194300                               TO PV-PARAGRAPH-NAME               34381051
343900                  MOVE 'UNSUCCESSFUL UPDATE TPURITM'              34390021
194300                               TO PV-DB2-OPERATION                34400151
194300                  PERFORM 9100-SQL-ABEND                          34400251
344500         END-EVALUATE                                             34450021
344600     END-PERFORM.                                                 34460021
344700*                                                                 34470021
344800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34480021
344900         MOVE '8500-UPDATE-TPURITM'                               34490021
194300                               TO PV-PARAGRAPH-NAME               34501051
345100         MOVE 'MAX RETRIES EXCEEDED ON UPDATE TPURITM'            34510023
194300                               TO PV-DB2-OPERATION                34520051
194300         PERFORM 9100-SQL-ABEND                                   34520151
346400     END-IF.                                                      34640021
346500/                                                                 34650021
346600******************************************************************34660021
346700*                                                                 34670021
346800******************************************************************34680021
346900 8600-INSERT-TPURITM.                                             34690021
347000*                                                                 34700021
347100     ADD +1                    TO PV-ISRT-PURITM-ATMPT-CNT.       34710035
347200     PERFORM                                                      34720022
347300         WITH TEST AFTER                                          34730022
347400         VARYING PV-RETRY-COUNTER                                 34740022
347500         FROM 1 BY 1                                              34750022
347600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34760022
347700            OR  (SQLCODE = ZERO)                                  34770022
347800            OR  (SQLCODE = -803))                                 34780022
347900*                                                                 34790022
348000         EXEC SQL                                                 34800022
348100             INSERT INTO TPURITM                                  34810022
348200                  ( PO_NBR                                        34820034
348300                   ,VER_NBR                                       34830034
348400                   ,PO_LNE_NBR                                    34840034
348500                   ,VER_STATUS_CDE                                34850034
348600                   ,SKU_SEQ_NBR                                   34860034
348700                   ,CL_NBR                                        34870034
348800                   ,VEND_STYL_NAME                                34880034
348900                   ,COLOR_DESC                                    34890034
349000                   ,SIZE_DESC                                     34900034
349100                   ,UM_IND                                        34910034
349200                   ,UNT_QTY                                       34920034
349300                   ,UNT_RTL_PR_AMT                                34930034
349400                   ,UNT_COST_AMT                                  34940034
349500                   ,TOT_VAL_COST_AMT                              34950034
349600                   ,TOT_VAL_RTL_AMT                               34960034
349700                   ,MU_PCT                                        34970034
349800                   ,CRE_TMST                                      34980034
349900                   ,LAST_UPD_TMST                                 34990034
350000                   ,ITM_NBR                                       35000034
350100                   ,SKU_DESC                                      35010034
350200                   ,COLOR_CDE                                     35020034
350300                   ,SIZE_CDE                                      35030034
350400                   ,AD_EVNT_DTE                                   35040034
350500                   ,STATUS_CDE                                    35050034
350600                   ,CRE_BY_UID                                    35060034
350700                   ,LAST_UPD_BY_UID                               35070034
350800                   ,GP_RTL_AMT                                    35080034
350900                   ,GP_QTY                                        35090034
351000                   ,APP_PO_LNE_NBR                                35100034
351100                   ,PIC_ITM_IND                                   35110034
351200                   ,PIC_PG_NBR                                    35120034
351300                   ,PRD_1ST_COST_AMT                              35130034
351400                   ,STAT_TMST                                     35140034
351500                   ,PO_PREPK_ID                                   35150034
351600                   ,PREPK_RATO_QTY                                35160034
351700                   ,SHIP_TO_TMP_DC_IND                            35170034
351800                   ,RMS_PO_SKU_NBR                                35180034
351900                   ,CNCLD_UNT_QTY)                                35190034
352000            VALUES (:PURITM-PO-NBR                                35200022
352100                   ,:PURITM-VER-NBR                               35210034
352200                   ,:PURITM-PO-LNE-NBR                            35220034
352300                   ,:PURITM-VER-STATUS-CDE                        35230034
352400                   ,:PURITM-SKU-SEQ-NBR                           35240034
352500                   ,:PURITM-CL-NBR                                35250034
352600                   ,:PURITM-VEND-STYL-NAME                        35260034
352700                   ,:PURITM-COLOR-DESC                            35270034
352800                   ,:PURITM-SIZE-DESC                             35280034
352900                   ,:PURITM-UM-IND                                35290034
353000                   ,:PURITM-UNT-QTY                               35300034
353100                   ,:PURITM-UNT-RTL-PR-AMT                        35310034
353200                   ,:PURITM-UNT-COST-AMT                          35320034
353300                   ,:PURITM-TOT-VAL-COST-AMT                      35330034
353400                   ,:PURITM-TOT-VAL-RTL-AMT                       35340034
353500                   ,:PURITM-MU-PCT                                35350034
353600                   ,:PURITM-CRE-TMST                              35360034
353700                   ,:PURITM-LAST-UPD-TMST                         35370034
353800                   ,:PURITM-ITM-NBR                               35380034
353900                   ,:PURITM-SKU-DESC                              35390034
354000                   ,:PURITM-COLOR-CDE                             35400034
354100                   ,:PURITM-SIZE-CDE                              35410034
354200                   ,:PURITM-AD-EVNT-DTE                           35420034
354300                   ,:PURITM-STATUS-CDE                            35430034
354400                   ,:PURITM-CRE-BY-UID                            35440034
354500                   ,:PURITM-LAST-UPD-BY-UID                       35450034
354600                   ,:PURITM-GP-RTL-AMT                            35460034
354700                   ,:PURITM-GP-QTY                                35470034
354800                   ,:PURITM-APP-PO-LNE-NBR                        35480034
354900                   ,:PURITM-PIC-ITM-IND                           35490034
355000                   ,:PURITM-PIC-PG-NBR                            35500034
355100                   ,:PURITM-PRD-1ST-COST-AMT                      35510034
355200                   ,:PURITM-STAT-TMST                             35520034
355300                   ,:PURITM-PO-PREPK-ID                           35530034
355400                   ,:PURITM-PREPK-RATO-QTY                        35540034
355500                   ,:PURITM-SHIP-TO-TMP-DC-IND                    35550034
355600                   ,:PURITM-RMS-PO-SKU-NBR                        35560034
355700                   ,:PURITM-CNCLD-UNT-QTY)                        35570034
355800         END-EXEC                                                 35580022
355900*                                                                 35590022
356000         EVALUATE TRUE                                            35600022
356100             WHEN SQLCODE = +0                                    35610022
356200                 ADD +1 TO PV-ISRT-PURITM-SUCSS-CNT               35620035
356300             WHEN SQLCODE = -803                                  35630022
356400             WHEN SQLCODE = -904                                  35640022
356500             WHEN SQLCODE = -913                                  35650022
356600                  CONTINUE                                        35660022
356700             WHEN SQLWARN0 NOT = SPACES                           35670022
356800             WHEN SQLCODE < ZERO                                  35680022
356900             WHEN SQLCODE > ZERO                                  35690022
357000                  MOVE '8600-INSERT-TPURITM'                      35700022
194300                               TO PV-PARAGRAPH-NAME               35710051
357200                  MOVE 'UNSUCCESSFUL INSERT TPURITM'              35720022
194300                               TO PV-DB2-OPERATION                35730051
194300                  PERFORM 9100-SQL-ABEND                          35730151
357800         END-EVALUATE                                             35780022
357900     END-PERFORM.                                                 35790022
358000*                                                                 35800022
358100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35810022
358200         MOVE '8600-INSERT-TPURITM'                               35820022
194300                               TO PV-PARAGRAPH-NAME               35830051
358400         MOVE 'MAX RETRIES EXCEEDED ON INSERT TPURITM'            35840023
194300                               TO PV-DB2-OPERATION                35850051
194300         PERFORM 9100-SQL-ABEND                                   35850151
359700     END-IF.                                                      35970022
359800/                                                                 35980021
359900******************************************************************35990021
360000*  INSERT A TPOPRPK FOR EACH CORRESPONDING PURITM                 36000022
360100******************************************************************36010021
360200 8700-INSERT-TPOPRPK.                                             36020022
360300*                                                                 36030022
360400     ADD +1                    TO PV-ISRT-POPRPK-ATMPT-CNT.       36040035
360500     PERFORM                                                      36050022
360600         WITH TEST AFTER                                          36060022
360700         VARYING PV-RETRY-COUNTER                                 36070022
360800         FROM 1 BY 1                                              36080022
360900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36090022
361000            OR  (SQLCODE = ZERO)                                  36100022
361100            OR  (SQLCODE = -803))                                 36110022
361200*                                                                 36120022
361300         EXEC SQL                                                 36130022
361400             INSERT INTO TPOPRPK                                  36140022
361500                   (PO_NBR                                        36150022
361600                   ,VER_NBR                                       36160022
361700                   ,PO_PREPK_ID                                   36170022
361800                   ,PREPK_TYP_CDE                                 36180022
361900                   ,PREPK_DESC                                    36190022
362000                   ,PREPK_STAT_CDE                                36200022
362100                   ,PREPK_UPC_NBR                                 36210022
362200                   ,INPK_UNT_QTY                                  36220022
362300                   ,INPK_CNVYB_IND                                36230022
362400                   ,OTPK_UNT_QTY                                  36240022
362500                   ,OTPK_ORD_QTY                                  36250022
362600                   ,PK_DTL_CHG_TMST                               36260022
362700                   ,PK_SKU_NBR)                                   36270022
362800            VALUES (:POPRPK-PO-NBR                                36280022
362900                   ,:POPRPK-VER-NBR                               36290022
363000                   ,:POPRPK-PO-PREPK-ID                           36300022
363100                   ,:POPRPK-PREPK-TYP-CDE                         36310022
363200                   ,:POPRPK-PREPK-DESC                            36320022
363300                   ,:POPRPK-PREPK-STAT-CDE                        36330022
363400                   ,:POPRPK-PREPK-UPC-NBR                         36340022
363500                   ,:POPRPK-INPK-UNT-QTY                          36350022
363600                   ,:POPRPK-INPK-CNVYB-IND                        36360022
363700                   ,:POPRPK-OTPK-UNT-QTY                          36370022
363800                   ,:POPRPK-OTPK-ORD-QTY                          36380022
363900                   ,:POPRPK-PK-DTL-CHG-TMST                       36390022
364000                   ,:POPRPK-PK-SKU-NBR)                           36400022
364100         END-EXEC                                                 36410022
364200*                                                                 36420022
364300         EVALUATE TRUE                                            36430022
364400             WHEN SQLCODE = +0                                    36440022
364500                 ADD +1 TO PV-ISRT-POPRPK-SUCSS-CNT               36450035
364600             WHEN SQLCODE = -803                                  36460022
364700             WHEN SQLCODE = -904                                  36470022
364800             WHEN SQLCODE = -913                                  36480022
364900                  CONTINUE                                        36490022
365000             WHEN SQLWARN0 NOT = SPACES                           36500022
365100             WHEN SQLCODE < ZERO                                  36510022
365200             WHEN SQLCODE > ZERO                                  36520022
365300                  MOVE '8700-INSERT-TPOPRPK'                      36530022
194300                               TO PV-PARAGRAPH-NAME               36540051
365500                  MOVE 'UNSUCCESSFUL INSERT TPOPRPK'              36550022
194300                               TO PV-DB2-OPERATION                36560051
194300                  PERFORM 9100-SQL-ABEND                          36560151
366100         END-EVALUATE                                             36610022
366200     END-PERFORM.                                                 36620022
366300*                                                                 36630022
366400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36640022
366500         MOVE '8700-INSERT-TPOPRPK'                               36650022
194300                               TO PV-PARAGRAPH-NAME               36660051
366700         MOVE 'MAX RETRIES EXCEEDED ON INSERT TPOPRPK'            36670023
194300                               TO PV-DB2-OPERATION                36680051
194300         PERFORM 9100-SQL-ABEND                                   36680151
368000     END-IF.                                                      36800022
368100*                                                                 36810021
368200/                                                                 36820021
368300******************************************************************36830022
368400*                                                                 36840022
368500******************************************************************36850022
368600 8800-INSERT-TPOINST.                                             36860022
368700*                                                                 36870022
368800     ADD +1 TO PV-ISRT-POINST-ATMPT-CNT.                          36880023
368900     PERFORM                                                      36890022
369000         WITH TEST AFTER                                          36900022
369100         VARYING PV-RETRY-COUNTER                                 36910022
369200         FROM 1 BY 1                                              36920022
369300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36930022
369400            OR  (SQLCODE = ZERO)                                  36940022
369500            OR  (SQLCODE = -803))                                 36950022
369600*                                                                 36960022
369700         EXEC SQL                                                 36970022
369800             INSERT INTO TPOINST                                  36980022
369900                   (PO_NBR                                        36990022
370000                   ,RECIP_CDE                                     37000022
370100                   ,INSTR_NBR                                     37010022
370200                   ,CRE_BY_UID                                    37020022
370300                   ,CRE_TMST)                                     37030022
370400            VALUES (:POINST-PO-NBR                                37040022
370500                   ,:POINST-RECIP-CDE                             37050022
370600                   ,:POINST-INSTR-NBR                             37060022
370700                   ,:POINST-CRE-BY-UID                            37070022
370800                   ,:POINST-CRE-TMST)                             37080022
370900         END-EXEC                                                 37090022
371000*                                                                 37100022
371100         EVALUATE TRUE                                            37110022
371200             WHEN SQLCODE = +0                                    37120022
371300                 ADD +1 TO PV-ISRT-POINST-SUCSS-CNT               37130023
371400             WHEN SQLCODE = -803                                  37140022
371500             WHEN SQLCODE = -904                                  37150022
371600             WHEN SQLCODE = -913                                  37160022
371700                  CONTINUE                                        37170022
371800             WHEN SQLWARN0 NOT = SPACES                           37180022
371900             WHEN SQLCODE < ZERO                                  37190022
372000             WHEN SQLCODE > ZERO                                  37200022
372100                  MOVE '8800-INSERT-TPOINST'                      37210022
194300                               TO PV-PARAGRAPH-NAME               37211051
372300                  MOVE 'UNSUCCESSFUL INSERT TPOINST'              37230022
194300                               TO PV-DB2-OPERATION                37240051
194300                  PERFORM 9100-SQL-ABEND                          37240151
194300         END-EVALUATE                                             37240252
373000     END-PERFORM.                                                 37300022
373100*                                                                 37310022
373200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37320022
373300         MOVE '8800-INSERT-TPOINST'                               37330022
194300                               TO PV-PARAGRAPH-NAME               37340051
373500         MOVE 'MAX RETRIES EXCEEDED ON INSERT TPOINST'            37350023
194300                               TO PV-DB2-OPERATION                37360051
194300         PERFORM 9100-SQL-ABEND                                   37360151
374800     END-IF.                                                      37480022
374900/                                                                 37490022
375000******************************************************************37500021
375100*                                                                 37510023
375200******************************************************************37520021
375300 8910-DELETE-TMESTDS.                                             37530023
375400*                                                                 37540021
375500     ADD +1 TO PV-DELT-MESTDS-ATMPT-CNT.                          37550023
375600     PERFORM                                                      37560023
375700         WITH TEST AFTER                                          37570023
375800         VARYING PV-RETRY-COUNTER                                 37580023
375900         FROM 1 BY 1                                              37590023
376000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37600023
376100            OR  (SQLCODE = ZERO)                                  37610030
376200            OR  (SQLCODE = +100))                                 37620030
376300*                                                                 37630023
376400         EXEC SQL                                                 37640023
376500             DELETE FROM TMESTDS                                  37650023
376600              WHERE PO_NBR      = :PURCHS-PO-NBR                  37660023
376700                AND PO_LNE_NBR  = :PURITM-PO-LNE-NBR              37670023
376800         END-EXEC                                                 37680023
376900*                                                                 37690023
377000         EVALUATE TRUE                                            37700023
377100             WHEN SQLCODE = +0                                    37710023
377200                 ADD +1 TO PV-DELT-MESTDS-SUCSS-CNT               37720023
377300             WHEN SQLCODE = +100                                  37730028
377400             WHEN SQLCODE = -904                                  37740028
377500             WHEN SQLCODE = -913                                  37750023
377600                 CONTINUE                                         37760023
377700             WHEN SQLWARN0 NOT = SPACES                           37770023
377800             WHEN SQLCODE < ZERO                                  37780023
377900             WHEN SQLCODE > ZERO                                  37790023
378000                  MOVE '8910-DELETE-TMESTDS'                      37800023
194300                               TO PV-PARAGRAPH-NAME               37810051
378200                  MOVE 'UNSUCCESSFUL DELETE TMESTDS'              37820023
194300                               TO PV-DB2-OPERATION                37830051
194300                  PERFORM 9100-SQL-ABEND                          37830151
378800         END-EVALUATE                                             37880023
378900     END-PERFORM.                                                 37890023
379000*                                                                 37900023
379100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37910023
379200         MOVE '8910-DELETE-TMESTDS'                               37920023
194300                               TO PV-PARAGRAPH-NAME               37930051
379400         MOVE 'MAX RETRIES EXCEEDED ON DELETE TMESTDS'            37940023
194300                               TO PV-DB2-OPERATION                37950051
194300         PERFORM 9100-SQL-ABEND                                   37950151
380700     END-IF.                                                      38070023
380800/                                                                 38080023
380900******************************************************************38090023
381000*                                                                 38100023
381100******************************************************************38110023
381200 8920-DELETE-TALLPLN.                                             38120023
381300*                                                                 38130023
381400     ADD +1 TO PV-DELT-ALLPLN-ATMPT-CNT.                          38140023
381500     PERFORM                                                      38150023
381600         WITH TEST AFTER                                          38160023
381700         VARYING PV-RETRY-COUNTER                                 38170023
381800         FROM 1 BY 1                                              38180023
381900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38190023
382000            OR  (SQLCODE = ZERO)                                  38200030
382100            OR  (SQLCODE = +100))                                 38210030
382200*                                                                 38220023
382300         EXEC SQL                                                 38230023
382400             DELETE FROM TALLPLN                                  38240023
382500              WHERE PO_NBR      = :PURCHS-PO-NBR                  38250023
382600                AND PO_LNE_NBR  = :PURITM-PO-LNE-NBR              38260023
382700         END-EXEC                                                 38270023
382800*                                                                 38280023
382900         EVALUATE TRUE                                            38290023
383000             WHEN SQLCODE = +0                                    38300023
383100                 ADD +1 TO PV-DELT-ALLPLN-SUCSS-CNT               38310023
383200             WHEN SQLCODE = +100                                  38320028
383300             WHEN SQLCODE = -904                                  38330023
383400             WHEN SQLCODE = -913                                  38340023
383500                 CONTINUE                                         38350023
383600             WHEN SQLWARN0 NOT = SPACES                           38360023
383700             WHEN SQLCODE < ZERO                                  38370023
383800             WHEN SQLCODE > ZERO                                  38380023
383900                  MOVE '8920-DELETE-TALLPLN'                      38390023
194300                               TO PV-PARAGRAPH-NAME               38400051
384100                  MOVE 'UNSUCCESSFUL DELETE TALLPLN'              38410023
194300                               TO PV-DB2-OPERATION                38420051
194300                  PERFORM 9100-SQL-ABEND                          38420151
384700         END-EVALUATE                                             38470023
384800     END-PERFORM.                                                 38480023
384900*                                                                 38490023
385000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38500023
385100         MOVE '8920-DELETE-TALLPLN'                               38510023
194300                               TO PV-PARAGRAPH-NAME               38520051
385300         MOVE 'MAX RETRIES EXCEEDED ON DELETE TALLPLN'            38530023
194300                               TO PV-DB2-OPERATION                38540051
194300         PERFORM 9100-SQL-ABEND                                   38540151
386600     END-IF.                                                      38660023
386700/                                                                 38670023
386800******************************************************************38680023
386900*                                                                 38690023
387000******************************************************************38700023
387100 8930-DELETE-TPURITM.                                             38710023
387200*                                                                 38720023
387300     ADD +1 TO PV-DELT-PURITM-ATMPT-CNT.                          38730023
387400     PERFORM                                                      38740023
387500         WITH TEST AFTER                                          38750023
387600         VARYING PV-RETRY-COUNTER                                 38760023
387700         FROM 1 BY 1                                              38770023
387800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38780023
387900            OR  (SQLCODE = ZERO)                                  38790030
388000            OR  (SQLCODE = +100))                                 38800030
388100*                                                                 38810023
388200         EXEC SQL                                                 38820023
388300             DELETE FROM TPURITM                                  38830023
388400              WHERE PO_NBR      = :PURCHS-PO-NBR                  38840023
388500                AND PO_LNE_NBR  = :PURITM-PO-LNE-NBR              38850023
388600         END-EXEC                                                 38860023
388700*                                                                 38870023
388800         EVALUATE TRUE                                            38880023
388900             WHEN SQLCODE = +0                                    38890023
389000                 ADD +1 TO PV-DELT-PURITM-SUCSS-CNT               38900023
389100             WHEN SQLCODE = +100                                  38910030
389200             WHEN SQLCODE = -904                                  38920030
389300             WHEN SQLCODE = -913                                  38930023
389400                 CONTINUE                                         38940023
389500             WHEN SQLWARN0 NOT = SPACES                           38950023
389600             WHEN SQLCODE < ZERO                                  38960023
389700             WHEN SQLCODE > ZERO                                  38970023
389800                  MOVE '8930-DELETE-TPURITM'                      38980023
194300                               TO PV-PARAGRAPH-NAME               38990051
390000                  MOVE 'UNSUCCESSFUL DELETE TPURITM'              39000023
194300                               TO PV-DB2-OPERATION                39010051
194300                  PERFORM 9100-SQL-ABEND                          39010151
390600         END-EVALUATE                                             39060023
390700     END-PERFORM.                                                 39070023
390800*                                                                 39080023
390900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39090023
391000         MOVE '8930-DELETE-TPURITM'                               39100023
194300                               TO PV-PARAGRAPH-NAME               39110051
391200         MOVE 'MAX RETRIES EXCEEDED ON DELETE TPURITM'            39120023
194300                               TO PV-DB2-OPERATION                39130051
194300         PERFORM 9100-SQL-ABEND                                   39130151
392500     END-IF.                                                      39250023
392600/                                                                 39260023
392700******************************************************************39270023
392800*  COMMITS ALL UPDATES ASSOCIATED WITH A TPURCHS ROW AND ALL      39280023
392900*  CORRESPONDING TPURITM, TPOPRPK AND TPOINST ROWS.               39290023
393000******************************************************************39300023
393100 8999-COMMIT.                                                     39310023
393200*                                                                 39320023
393300     EXEC SQL                                                     39330023
393400         COMMIT                                                   39340023
393500     END-EXEC.                                                    39350023
393600                                                                  39360023
393700     EVALUATE TRUE                                                39370023
393800         WHEN SQLCODE = ZEROS                                     39380023
393900             CONTINUE                                             39390023
394000         WHEN OTHER                                               39400023
394100              MOVE '8999-COMMIT'                                  39410023
194300                               TO PV-PARAGRAPH-NAME               39420051
394300              MOVE 'UNSUCCESSFUL COMMIT TPURCHS'                  39430023
194300                               TO PV-DB2-OPERATION                39440051
194300              PERFORM 9100-SQL-ABEND                              39440151
394900     END-EVALUATE.                                                39490023
395000/                                                                 39500023
395100******************************************************************39510023
395200*                                                                 39520023
395300******************************************************************39530023
395400 9000-END-PROCESSING.                                             39540023
395500*                                                                 39550023
395600     DISPLAY '**** --------------------------------- *****'.      39560021
395700     DISPLAY '**** PRE-APRVL DUPL LN COUNT  = ' PV-PRAPDUPL-CNT.  39570021
395800     DISPLAY '**** ACTV DUPL ACTV LN COUNT  = ' PV-ACTVDUPA-CNT.  39580021
395900     DISPLAY '**** ACTV DUPL CNCL LN COUNT  = ' PV-ACTVDUPC-CNT.  39590021
396000     DISPLAY '**** FIND DC RCPT ATMPT  CNT  = '                   39600023
396100                                      PV-FIND-DC-RCPT-ATMPT-CNT.  39610023
396200     DISPLAY '**** FIND DC RCPT SUCSS  CNT  = '                   39620023
396300                                      PV-FIND-DC-RCPT-SUCSS-CNT.  39630023
396400     DISPLAY '**** CANCELLED DUPL LN COUNT  = ' PV-CNCLDUPL-CNT.  39640035
396500     DISPLAY '**** GET PO ITEM  ATMPT  CNT  = '                   39650040
396600                                      PV-GET-PO-ITM-ATMPT-CNT.    39660040
396700     DISPLAY '**** GET PO ITEM  SUCSS  CNT  = '                   39670040
396800                                      PV-GET-PO-ITM-SUCSS-CNT.    39680040
396900     DISPLAY '**** CNCLDUPL PK DELETE  CNT  = '                   39690023
397000                                      PV-CNCLDUPL-PK-DELT-CNT.    39700023
397100     DISPLAY '**** INSERT MESTDS ATMPT CNT  = '                   39710035
397200                                      PV-DELT-MESTDS-ATMPT-CNT.   39720035
397300     DISPLAY '**** INSERT MESTDS SUCSS CNT  = '                   39730035
397400                                      PV-DELT-MESTDS-SUCSS-CNT.   39740035
397500     DISPLAY '**** INSERT ALLPLN ATMPT CNT  = '                   39750035
397600                                      PV-DELT-ALLPLN-ATMPT-CNT.   39760035
397700     DISPLAY '**** INSERT ALLPLN SUCSS CNT  = '                   39770035
397800                                      PV-DELT-ALLPLN-SUCSS-CNT.   39780035
397900     DISPLAY '**** DELETE PURITM ATMPT CNT  = '                   39790035
398000                                      PV-DELT-PURITM-ATMPT-CNT.   39800035
398100     DISPLAY '**** DELETE PURITM SUCSS CNT  = '                   39810035
398200                                      PV-DELT-PURITM-SUCSS-CNT.   39820035
398300     DISPLAY '**** PACK PROCESS   PO COUNT  = ' PV-PACKPRCS-CNT.  39830035
398400     DISPLAY '**** FND POTPK TMP ATMPT CNT  = '                   39840035
398500                                      PV-FND-POTPK-TMP-ATMPT-CNT. 39850035
398600     DISPLAY '**** FND POTPK TMP SUCSS CNT  = '                   39860035
398700                                      PV-FND-POTPK-TMP-SUCSS-CNT. 39870035
398800     DISPLAY '**** PACK PROCESS REPORT CNT  = '                   39880035
398900                                      PV-PACKPRCS-REPORT-CNT.     39890035
399000     DISPLAY '**** PACK PROCESS BYPASS CNT  = '                   39900035
399100                                      PV-PACKPRCS-BYPASS-CNT.     39910035
399200     DISPLAY '**** UPDATE PURCHS ATMPT CNT  = '                   39920023
399300                                      PV-UPD-PURCHS-ATMPT-CNT.    39930023
399400     DISPLAY '**** UPDATE PURCHS SUCSS CNT  = '                   39940023
399500                                      PV-UPD-PURCHS-SUCSS-CNT.    39950023
399600     DISPLAY '**** INSERT PURCHS ATMPT CNT  = '                   39960038
399700                                      PV-ISRT-PURCHS-ATMPT-CNT.   39970038
399800     DISPLAY '**** INSERT PURCHS SUCSS CNT  = '                   39980038
399900                                      PV-ISRT-PURCHS-SUCSS-CNT.   39990038
400000     DISPLAY '**** UPDATE PURITM ATMPT CNT  = '                   40000023
400100                                      PV-UPD-PURITM-ATMPT-CNT.    40010023
400200     DISPLAY '**** UPDATE PURITM SUCSS CNT  = '                   40020023
400300                                      PV-UPD-PURITM-SUCSS-CNT.    40030023
400400     DISPLAY '**** GET MAX POITM ATMPT CNT  = '                   40040023
400500                                      PV-GMAX-POITM-ATMPT-CNT.    40050023
400600     DISPLAY '**** GET MAX POITM SUCSS CNT  = '                   40060023
400700                                      PV-GMAX-POITM-SUCSS-CNT.    40070023
400800     DISPLAY '**** INSERT PURITM ATMPT CNT  = '                   40080035
400900                                      PV-ISRT-PURITM-ATMPT-CNT.   40090035
401000     DISPLAY '**** INSERT PURITM SUCSS CNT  = '                   40100035
401100                                      PV-ISRT-PURITM-SUCSS-CNT.   40110035
401200     DISPLAY '**** GET MAX PREPK ATMPT CNT  = '                   40120023
401300                                      PV-GMAX-PREPK-ATMPT-CNT.    40130023
401400     DISPLAY '**** GET MAX PREPK SUCSS CNT  = '                   40140023
401500                                      PV-GMAX-PREPK-SUCSS-CNT.    40150023
401600     DISPLAY '**** INSERT POPRPK ATMPT CNT  = '                   40160035
401700                                      PV-ISRT-POPRPK-ATMPT-CNT.   40170035
401800     DISPLAY '**** INSERT POPRPK SUCSS CNT  = '                   40180035
401900                                      PV-ISRT-POPRPK-SUCSS-CNT.   40190035
402000     DISPLAY '**** INSERT POINST ATMPT CNT  = '                   40200023
402100                                      PV-ISRT-POINST-ATMPT-CNT.   40210023
402200     DISPLAY '**** INSERT POINST SUCSS CNT  = '                   40220023
402300                                      PV-ISRT-POINST-SUCSS-CNT.   40230023
402400     DISPLAY '**** PROGRAM POKUP043 END SUCCESSFULLY *****'.      40240021
402500******************************************************************40250048
402500* 9100-SQL-ABEND                                                  40251048
402500*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.40252048
402500******************************************************************40253048
402500 9100-SQL-ABEND.                                                  40254048
402500     DISPLAY '** ABEND     **'.                                   40255048
402500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        40256048
402500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              40257048
402500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               40258048
402500                                                                  40259048
402500******************************************************************40259148
402500* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     40259248
402500* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      40259348
402500******************************************************************40259448
402500     COPY DPPD004.                                                40259548
402500                                                                  40259748
402500     SET AC-DB2-ERROR TO TRUE.                                    40259848
402500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         40259948
402500                                                                  40260048
