000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.             SUKRP020.                                00040001
000500 AUTHOR.                 JOE LAROSA.                              00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN            JANUARY, 2000                            00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  PROGRAM CREATES THE 'INTRA-COMPANY MISDIRECTS FROM UCC128    * 00100001
001100*  SCAN RESULTS BY DC, VENDOR' REPORT.                          * 00110001
001200*                                                               * 00120001
001300*  THIS REPORT CAN BE PRINTED WEEKLY OR MONTHLY (PARM CARD).    * 00130001
001200*                                                               * 00120001
000098*  CHANGED 10/14/14 BY CHERI PARMLEY                            *         
000099*   CHG#0098147 EXPAND PO# FROM 7 TO 8 DIGITS                   *         
001400***************************************************************** 00140001
001500*                                                                 00150001
001600***************************************************************** 00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800***************************************************************** 00180001
001900 CONFIGURATION SECTION.                                           00190001
002000                                                                  00200001
002100 SOURCE-COMPUTER.        IBM-3090.                                00210001
002200 OBJECT-COMPUTER.        IBM-3090.                                00220001
002300                                                                  00230001
002400***************************************************************** 00240001
002500 INPUT-OUTPUT SECTION.                                            00250001
002600                                                                  00260001
002700 FILE-CONTROL.                                                    00270001
002800                                                                  00280001
002900     SELECT INPUT-EXTRACT-FILE                                    00290001
003000         ASSIGN TO INP01.                                         00300001
003100                                                                  00310001
003200     SELECT OUTPUT-REPORT                                         00320001
003300         ASSIGN TO RPT01.                                         00330001
003400                                                                  00340001
003500***************************************************************** 00350001
003600 DATA DIVISION.                                                   00360001
003700***************************************************************** 00370001
003800 FILE SECTION.                                                    00380001
003900                                                                  00390001
004000 FD  INPUT-EXTRACT-FILE                                           00400001
004100     LABEL RECORDS ARE STANDARD                                   00410001
004200     RECORDING MODE IS F                                          00420001
004300     BLOCK CONTAINS 0 RECORDS                                     00430001
004400     RECORD CONTAINS 200 CHARACTERS.                              00440001
004500 01  EXTRACT-REC                     PIC X(200).                  00450001
004600                                                                  00460001
004700 FD  OUTPUT-REPORT                                                00470001
004800     RECORDING MODE IS F                                          00480001
004900     BLOCK CONTAINS 0  RECORDS.                                   00490001
005000 01  OUTPUT-REC                      PIC X(132).                  00500001
005100                                                                  00510001
005200***************************************************************** 00520001
005300 WORKING-STORAGE SECTION.                                         00530001
005400                                                                  00540001
005500 01  PROGRAM-SWITCHES.                                            00550001
005600     05  PS-NORMAL-RUN-SW            PIC X(01) VALUE 'N'.         00560003
005700         88  PS-NORMAL-RUN                     VALUE 'Y'.         00570003
005800         88  PS-SPECIAL-RUN                    VALUE 'N'.         00580003
005900     05  PS-FIRST-TIME-SW            PIC X(01) VALUE 'N'.         00590001
006000         88  PS-FIRST-TIME-YES                 VALUE 'Y'.         00600001
006100         88  PS-FIRST-TIME-NO                  VALUE 'N'.         00610001
006200     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00620001
006300         88  PS-END-OF-INPUT                   VALUE 'Y'.         00630001
006400         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00640001
006500     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00650001
006600         88  PS-NEW-PAGE                       VALUE 'Y'.         00660001
006700         88  PS-SAME-PAGE                      VALUE 'N'.         00670001
006800     05  PS-TYPE-DATA-SW             PIC X(01) VALUE 'N'.         00680011
006900         88  PS-TYPE-DATA-YES                  VALUE 'Y'.         00690011
007000         88  PS-TYPE-DATA-NO                   VALUE 'N'.         00700011
007100     05  PS-ALL-TYPES-PRINTED-SW     PIC X(01) VALUE 'N'.         00710015
007200         88  PS-ALL-TYPES-PRINTED              VALUE 'Y'.         00720015
007300         88  PS-TYPES-PRINTED-NO               VALUE 'N'.         00730015
007400     05  PS-END-OF-CURSOR-SW         PIC X(01) VALUE 'N'.         00740031
007500         88  PS-END-OF-CURSOR                  VALUE 'Y'.         00750031
007600         88  PS-NOT-END-OF-CURSOR              VALUE 'N'.         00760031
007700     05  PS-END-OF-TABLE-SW          PIC X(01) VALUE 'N'.         00770029
007800         88  PS-END-OF-TABLE                   VALUE 'Y'.         00780029
007900         88  PS-NOT-END-OF-TABLE               VALUE 'N'.         00790029
008000                                                                  00800001
008100 01  PC-PROGRAM-CONSTANTS.                                        00810001
008200     05  PC-SUKRP020                 PIC X(08) VALUE              00820001
008300                                               'SUKRP020'.        00830001
008400     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00840001
008500     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00850001
008600                                               COMP-3.            00860001
008700     05  PC-MISDIRECT-DESC-1.                                     00870001
008800         10  FILLER                  PIC X(50) VALUE              00880001
008900         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    00890001
009000         10  FILLER                  PIC X(42) VALUE              00900001
009100         'AT CORRECT DC BASED ON LOCATION MASTER    '.            00910001
009200     05  PC-MISDIRECT-DESC-2.                                     00920001
009300         10  FILLER                  PIC X(50) VALUE              00930001
009400         'ASN DOWNLOADED TO WRONG DC -- CARTON WAS RECEIVED '.    00940001
009500         10  FILLER                  PIC X(42) VALUE              00950001
009600         'AT WRONG DC BASED ON LOCATION MASTER      '.            00960001
009700     05  PC-MISDIRECT-DESC-3.                                     00970001
009800         10  FILLER                  PIC X(50) VALUE              00980001
009900         'ASN DOWNLOADED TO CORRECT DC -- CARTON WAS RECEIVE'.    00990001
010000         10  FILLER                  PIC X(42) VALUE              01000001
010100         'D AT WRONG DC BASED ON LOCATION MASTER    '.            01010001
010200     05  PC-MISDIRECT-DESC-4.                                     01020041
010300         10  FILLER                  PIC X(50) VALUE              01030041
010400         'DC ON ASN DOWNLOAD DOES NOT MATCH RECEIVING DC    '.    01040041
010500         10  FILLER                  PIC X(42) VALUE              01050041
010600         '                                          '.            01060041
010700     05  PC-MISDIRECT-DESC-5.                                     01070041
010800         10  FILLER                  PIC X(50) VALUE              01080019
010900         '                                                  '.    01090041
011000         10  FILLER                  PIC X(42) VALUE              01100019
011100         '                                          '.            01110041
011200     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.01120003
011300     05  PC-SYSTEM-DATE              PIC 9(06) VALUE ZERO.        01130003
011400     05  PC-ONE                      PIC 9(02) VALUE 1.           01140006
011500     05  PC-SEVEN                    PIC 9(02) VALUE 7.           01150006
011600     05  PC-TWENTY-EIGHT             PIC 9(02) VALUE 28.          01160003
011700     05  PC-SPRING                   PIC X(06) VALUE 'SPRING'.    01170003
011800     05  PC-FALL                     PIC X(06) VALUE '  FALL'.    01180003
011900                                                                  01190001
012000 01  PV-PROGRAM-VARIABLES.                                        01200001
012100     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       01210001
012200     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        01220007
012300     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01230001
012400                                               COMP-3.            01240001
012500     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01250001
012600                                               COMP-3.            01260001
012700     05  PV-REC-IN-QTY               PIC 9(07).                   01270007
012800     05  PV-REC-OUT-QTY              PIC 9(07).                   01280007
012900     05  PV-FIELDS.                                               01290001
013000         10  PV-CURR-LOCN            PIC 9(04) VALUE ZEROES.      01300001
013100         10  PV-PREV-LOCN            PIC 9(04) VALUE ZEROES.      01310001
013200         10  PV-CURR-VEND            PIC X(30) VALUE SPACES.      01320009
013300         10  PV-CURR-TYPE            PIC X(01) VALUE SPACES.      01330001
013400         10  PV-PREV-TYPE            PIC X(01) VALUE SPACES.      01340001
013500         10  PV-CURR-SCAC            PIC X(04) VALUE SPACES.      01350010
013600         10  PV-CURR-VEH-NBR         PIC X(11) VALUE SPACES.      01360010
013700         10  PV-CURR-PO-NBR          PIC S9(9) VALUE ZEROES.      01370010
013800         10  PV-CURR-REC-SEQ-NBR     PIC S9(9) VALUE ZEROES.      01380010
013900                                                                  01390001
014000     05  PV-ACCUMULATORS.                                         01400001
014100         10  PV-ACCUM-TYPE           PIC 9(09) VALUE ZEROES.      01410001
014200         10  PV-ACCUM-VEND           PIC 9(09) VALUE ZEROES.      01420003
014300         10  PV-ACCUM-LOCN           PIC 9(09) VALUE ZEROES.      01430010
014400         10  PV-ACCUM-T1             PIC 9(09) VALUE ZEROES.      01440036
014500         10  PV-ACCUM-T2             PIC 9(09) VALUE ZEROES.      01450036
014600         10  PV-ACCUM-T3             PIC 9(09) VALUE ZEROES.      01460036
014700         10  PV-ACCUM-T4             PIC 9(09) VALUE ZEROES.      01470036
014800         10  PV-ACCUM-T5             PIC 9(09) VALUE ZEROES.      01480036
014900         10  PV-ACCUM-TOTL           PIC 9(09) VALUE ZEROES.      01490036
015000                                                                  01500001
015100     05  PV-FORMAT-QTY-4             PIC ZZZ9.                    01510051
015200     05  PV-FORMAT-QTY               PIC ZZZ,ZZZ,ZZ9.             01511051
015300     05  PV-FORMAT-ACCUM             PIC ZZZ,ZZ9.                 01520003
015400     05  PV-FORMAT-FACILITY          PIC ZZZZ9.                   01530020
015500                                                                  01540010
015600     05  PV-INPUT-DATE.                                           01550010
015700         10  PV-INPUT-DATE-CC        PIC 9(02) VALUE ZEROES.      01560012
015800         10  PV-INPUT-DATE-YY        PIC 9(02) VALUE ZEROES.      01570012
015900         10  FILLER                  PIC X(01) VALUE '-'.         01580010
016000         10  PV-INPUT-DATE-MM        PIC 9(02) VALUE ZEROES.      01590012
016100         10  FILLER                  PIC X(01) VALUE '-'.         01600010
016200         10  PV-INPUT-DATE-DD        PIC 9(02) VALUE ZEROES.      01610012
016300     05  PV-INPUT-TIME.                                           01620010
016400         10  PV-INPUT-TIME-HH        PIC 9(02) VALUE ZEROES.      01630012
016500         10  FILLER                  PIC X(01) VALUE '.'.         01640010
016600         10  PV-INPUT-TIME-MM        PIC 9(02) VALUE ZEROES.      01650012
016700         10  FILLER                  PIC X(01) VALUE '.'.         01660010
016800         10  PV-INPUT-TIME-SS        PIC 9(02) VALUE ZEROES.      01670012
016900                                                                  01680010
017000     05  PV-YEAR-FORMAT.                                          01690008
017100         10  PV-YEAR-FORMAT-CC       PIC 9(02) VALUE 0.           01700008
017200         10  PV-YEAR-FORMAT-YY       PIC 9(02) VALUE 0.           01710008
017300     05  PV-FORMAT-PO.                                            01720010
      *CLP 10/14/14                                                             
017400         10  PV-FORMAT-PO-NBR        PIC 9(08) VALUE ZEROES.      01730027
017500         10  FILLER                  PIC X(01) VALUE '-'.         01740010
017600         10  PV-FORMAT-REC-SEQ       PIC 9(03) VALUE ZEROES.      01750027
017700     05  PV-FORMAT-DATE.                                          01760010
017800         10  PV-FORMAT-DATE-MM       PIC X(02) VALUE SPACES.      01770010
017900         10  FILLER                  PIC X(01) VALUE '/'.         01780010
018000         10  PV-FORMAT-DATE-DD       PIC X(02) VALUE SPACES.      01790010
018100         10  FILLER                  PIC X(01) VALUE '/'.         01800001
018200         10  PV-FORMAT-DATE-YY       PIC X(02) VALUE SPACES.      01810001
018300     05  PV-FORMAT-TIME.                                          01820010
018400         10  PV-FORMAT-TIME-HH       PIC X(02) VALUE SPACES.      01830010
018500         10  FILLER                  PIC X(01) VALUE ':'.         01840010
018600         10  PV-FORMAT-TIME-MM       PIC X(02) VALUE SPACES.      01850010
018700                                                                  01860001
018800     05  PV-SEASON-DESC              PIC X(06) VALUE SPACES.      01870006
018900     05  PV-CURRENT-DB2-DATE-ONE     PIC X(10).                   01880006
019000     05  PV-CURRENT-DB2-DATE         PIC X(10).                   01890006
019100     05  PV-CURRENT-DB2-DATE-ONEYR   PIC X(10) VALUE SPACES.      01900006
019200     05  FILLER REDEFINES PV-CURRENT-DB2-DATE-ONEYR.              01910006
019300         10  PV-CDD-ONEYR-CCYY       PIC 9(04).                   01920006
019400         10  FILLER                  PIC X(06).                   01930006
019500                                                                  01940006
019600     05  PV-CURR-DATE.                                            01950006
019700         10  PV-CURRENT-DB2-CCYY.                                 01960006
019800             15  PV-CURRENT-DB2-CC   PIC 9(02) VALUE 0.           01970006
019900             15  PV-CURRENT-DB2-YY   PIC 9(02) VALUE 0.           01980006
020000         10  FILLER                  PIC X(01) VALUE '-'.         01990006
020100         10  PV-CURRENT-DB2-MM       PIC 9(02) VALUE 0.           02000006
020200         10  FILLER                  PIC X(01) VALUE '-'.         02010006
020300         10  PV-CURRENT-DB2-DD       PIC 9(02) VALUE 0.           02020006
020400                                                                  02030006
020500     05  PV-CURRENT-DATE.                                         02040006
020600         10  PV-CURRENT-CCYY.                                     02050006
020700             15  PV-CURRENT-CC       PIC 9(02) VALUE 0.           02060006
020800             15  PV-CURRENT-YY       PIC 9(02) VALUE 0.           02070006
020900         10  PV-CURRENT-MM           PIC 9(02) VALUE 0.           02080006
021000         10  PV-CURRENT-DD           PIC 9(02) VALUE 0.           02090006
021100                                                                  02100006
021200     05  PV-CURRENT-YYMMDD-DATE.                                  02110006
021300         10  PV-CURRENT-YYMMDD-YY    PIC 9(02) VALUE 0.           02120006
021400         10  PV-CURRENT-YYMMDD-MM    PIC 9(02) VALUE 0.           02130006
021500         10  PV-CURRENT-YYMMDD-DD    PIC 9(02) VALUE 0.           02140006
021600                                                                  02150006
021700     05  PV-CURR-DATE-10             PIC X(10).                   02160048
021800     05  PV-TODAYS-DATE.                                          02240046
021900         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        02250046
022000         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        02260046
022100         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        02270046
022200     05  PV-TODAYS-DATE-YYYY.                                     02280001
022300         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          02290001
022400         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        02300001
022500                                                                  02310001
022600     05  PV-TODAYS-TIME.                                          02320001
022700         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        02330001
022800         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        02340001
022900         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        02350001
023000         10  FILLER                  PIC 9(02) VALUE ZERO.        02360001
023100                                                                  02370001
023200     05  PV-DATE-AREA.                                            02380003
023300         10  PV-DATE-AREA-MM         PIC 9(02) VALUE ZEROS.       02390003
023400         10  FILLER                  PIC X(01) VALUE '/'.         02400003
023500         10  PV-DATE-AREA-DD         PIC 9(02) VALUE ZEROS.       02410003
023600         10  FILLER                  PIC X(01) VALUE '/'.         02420003
023700         10  PV-DATE-AREA-YY         PIC 9(02) VALUE ZEROS.       02430003
023800                                                                  02440003
023900     05  PV-BEG-DATE-CYMD.                                        02450003
024000         10  PV-BEG-YMD-CC           PIC 9(02) VALUE ZEROS.       02460003
024100         10  PV-BEG-YMD-YY           PIC 9(02) VALUE ZEROS.       02470003
024200         10  PV-BEG-YMD-MM           PIC 9(02) VALUE ZEROS.       02480003
024300         10  PV-BEG-YMD-DD           PIC 9(02) VALUE ZEROS.       02490003
024400                                                                  02500003
024500     05  PV-END-DATE-CYMD.                                        02510003
024600         10  PV-END-YMD-CC           PIC 9(02) VALUE ZEROS.       02520003
024700         10  PV-END-YMD-YY           PIC 9(02) VALUE ZEROS.       02530003
024800         10  PV-END-YMD-MM           PIC 9(02) VALUE ZEROS.       02540003
024900         10  PV-END-YMD-DD           PIC 9(02) VALUE ZEROS.       02550003
025000                                                                  02560003
025100     05  PV-BEG-DATE.                                             02570003
025200         10  PV-BEG-MM               PIC 9(02) VALUE ZEROS.       02580003
025300         10  FILLER                  PIC X(01) VALUE '/'.         02590003
025400         10  PV-BEG-DD               PIC 9(02) VALUE ZEROS.       02600003
025500         10  FILLER                  PIC X(01) VALUE '/'.         02610003
025600         10  PV-BEG-YY               PIC 9(02) VALUE ZEROS.       02620003
025700                                                                  02630003
025800     05  PV-END-DATE.                                             02640003
025900         10  PV-END-MM               PIC 9(02) VALUE ZEROS.       02650003
026000         10  FILLER                  PIC X(01) VALUE '/'.         02660003
026100         10  PV-END-DD               PIC 9(02) VALUE ZEROS.       02670003
026200         10  FILLER                  PIC X(01) VALUE '/'.         02680003
026300         10  PV-END-YY               PIC 9(02) VALUE ZEROS.       02690003
026400                                                                  02700003
026500     05  PV-START-EXTRACT            PIC X(26) VALUE SPACE.       02710006
026600     05  FILLER  REDEFINES PV-START-EXTRACT.                      02720006
026700         10  PV-START-EXTRACT-YYYY   PIC 9999.                    02730006
026800         10  PV-START-EXTRACT-1ST    PIC X.                       02740006
026900         10  PV-START-EXTRACT-MM     PIC 99.                      02750006
027000         10  PV-START-EXTRACT-2ND    PIC X.                       02760006
027100         10  PV-START-EXTRACT-DD     PIC 99.                      02770006
027200         10  PV-START-EXTRACT-3RD    PIC X.                       02780006
027300         10  PV-START-TIMESTAMP      PIC X(15).                   02790006
027400                                                                  02800006
027500     05  PV-END-EXTRACT              PIC X(26) VALUE SPACE.       02810006
027600     05  FILLER  REDEFINES PV-END-EXTRACT.                        02820006
027700         10  PV-END-EXTRACT-YYYY     PIC 9999.                    02830006
027800         10  PV-END-EXTRACT-YYYY-RE REDEFINES PV-END-EXTRACT-YYYY.02840006
027900             15  PV-END-EXTRACT-CC   PIC 99.                      02850006
028000             15  PV-END-EXTRACT-YY   PIC 99.                      02860006
028100         10  PV-END-EXTRACT-1ST      PIC X.                       02870006
028200         10  PV-END-EXTRACT-MM       PIC 99.                      02880006
028300         10  PV-END-EXTRACT-2ND      PIC X.                       02890006
028400         10  PV-END-EXTRACT-DD       PIC 99.                      02900006
028500         10  PV-END-EXTRACT-3RD      PIC X.                       02910006
028600         10  PV-END-TIMESTAMP        PIC X(15).                   02920006
028700                                                                  02930006
028800     05  WS-START-EXTRACT.                                        02940003
028900         10  WS-START-EXTRACT-YYYY   PIC 9999.                    02950003
029000         10  WS-START-EXTRACT-MM     PIC 99.                      02960003
029100         10  WS-START-EXTRACT-DD     PIC 99.                      02970003
029200                                                                  02980003
029300     05  WS-END-EXTRACT.                                          02990003
029400         10  WS-END-EXTRACT-YYYY     PIC 9999.                    03000003
029500         10  WS-END-EXTRACT-MM       PIC 99.                      03010003
029600         10  WS-END-EXTRACT-DD       PIC 99.                      03020003
029700                                                                  03030003
029800     05  WS-FISCAL-PERIOD-NBR        PIC 9(02) VALUE ZEROES.      03040006
029900     05  WS-FISCAL-PERIOD-WEEK       PIC 9(02) VALUE ZEROES.      03050006
030000     05  WS-FISCAL-QTR-NBR           PIC 9(01) VALUE ZERO.        03060006
030100     05  WS-FISCAL-WEEK-NBR          PIC 9(02) VALUE ZEROES.      03070006
030200                                                                  03080006
030300     05  WS-ARRIVE-DATE-WORK.                                     03090007
030400         10  WS-WORK-ARRIVE-MM       PIC 9(02) VALUE ZEROES.      03100007
030500         10  FILLER                  PIC X     VALUE '/'.         03110007
030600         10  WS-WORK-ARRIVE-DD       PIC 9(02) VALUE ZEROES.      03120007
030700         10  FILLER                  PIC X     VALUE '/'.         03130007
030800         10  WS-WORK-ARRIVE-CC       PIC 9(02) VALUE ZEROES.      03140007
030900         10  WS-WORK-ARRIVE-YY       PIC 9(02) VALUE ZEROES.      03150007
031000                                                                  03160007
031100     05  WS-ARRIVE-DATE.                                          03170007
031200         10  WS-ARRIVE-CC            PIC 9(02) VALUE ZEROES.      03180007
031300         10  WS-ARRIVE-YY            PIC 9(02) VALUE ZEROES.      03190007
031400         10  FILLER                  PIC X     VALUE '-'.         03200007
031500         10  WS-ARRIVE-MM            PIC 9(02) VALUE ZEROES.      03210007
031600         10  FILLER                  PIC X     VALUE '-'.         03220007
031700         10  WS-ARRIVE-DD            PIC 9(02) VALUE ZEROES.      03230007
031800                                                                  03240007
031900 01  CC-CONTROL-CARD-PARAMETERS.                                  03250003
032000     05  CC-BEG-DATE.                                             03260003
032100         10  CC-BEG-CC               PIC 9(02) VALUE ZEROS.       03270003
032200         10  CC-BEG-YY               PIC 9(02) VALUE ZEROS.       03280003
032300         10  FILLER                  PIC X(01) VALUE SPACE.       03290003
032400         10  CC-BEG-MM               PIC 9(02) VALUE ZEROS.       03300003
032500         10  FILLER                  PIC X(01) VALUE SPACE.       03310003
032600         10  CC-BEG-DD               PIC 9(02) VALUE ZEROS.       03320003
032700     05  FILLER                      PIC X(01) VALUE SPACE.       03330003
032800     05  CC-END-DATE.                                             03340003
032900         10  CC-END-CC               PIC 9(02) VALUE ZEROS.       03350003
033000         10  CC-END-YY               PIC 9(02) VALUE ZEROS.       03360003
033100         10  FILLER                  PIC X(01) VALUE SPACE.       03370003
033200         10  CC-END-MM               PIC 9(02) VALUE ZEROS.       03380003
033300         10  FILLER                  PIC X(01) VALUE SPACE.       03390003
033400         10  CC-END-DD               PIC 9(02) VALUE ZEROS.       03400003
033500     05  FILLER                      PIC X(01) VALUE SPACE.       03410003
033600     05  CC-MODE-IND                 PIC X(01) VALUE SPACE.       03420003
033700         88  CC-VALID-MODE-IND                 VALUE 'W', 'M',    03430003
033800                                                'F', 'C', 'S'.    03440003
033900         88  CC-WEEKLY-EXTRACT                 VALUE 'W'.         03450003
034000         88  CC-MONTHLY-EXTRACT                VALUE 'M'.         03460003
034100         88  CC-FISCAL-EXTRACT                 VALUE 'F'.         03470003
034200         88  CC-CALENDAR-EXTRACT               VALUE 'C'.         03480003
034300         88  CC-SEASONAL-EXTRACT               VALUE 'S'.         03490003
034400     05  FILLER                      PIC X(57) VALUE SPACE.       03500003
034500                                                                  03510003
034600 01  PV-DATETIME-WORK.                                            03520003
034700     05  PV-DATETIME-CC              PIC 9(02).                   03530003
034800     05  PV-DATETIME-YY              PIC 9(02).                   03540003
034900     05  FILLER                      PIC X(01) VALUE '-'.         03550003
035000     05  PV-DATETIME-MM              PIC 9(02).                   03560003
035100     05  FILLER                      PIC X(01) VALUE '-'.         03570003
035200     05  PV-DATETIME-DD              PIC 9(02).                   03580003
035300     05  FILLER                      PIC X(01) VALUE '-'.         03590003
035400     05  PV-DATETIME-HO              PIC 9(02).                   03600003
035500     05  FILLER                      PIC X(01) VALUE '.'.         03610003
035600     05  PV-DATETIME-MI              PIC 9(02).                   03620003
035700     05  FILLER                      PIC X(01) VALUE '.'.         03630003
035800     05  PV-DATETIME-SS              PIC 9(02).                   03640003
035900     05  FILLER                      PIC X(01) VALUE '.'.         03650003
036000     05  PV-DATETIME-MSEC            PIC 9(06).                   03660003
036100                                                                  03670003
036200 01  PV-DATE-RECORD.                                              03680003
036300     05  PV-DATE-START-MM            PIC X(02) VALUE SPACE.       03690003
036400     05  FILLER                      PIC X(01) VALUE '/'.         03700003
036500     05  PV-DATE-START-DD            PIC X(02) VALUE SPACE.       03710003
036600     05  FILLER                      PIC X(01) VALUE '/'.         03720003
036700     05  PV-DATE-START-CCYY          PIC X(04) VALUE SPACE.       03730003
036800     05  FILLER                      PIC X(01) VALUE SPACE.       03740003
036900     05  PV-DATE-END-MM              PIC X(02) VALUE SPACE.       03750003
037000     05  FILLER                      PIC X(01) VALUE '/'.         03760003
037100     05  PV-DATE-END-DD              PIC X(02) VALUE SPACE.       03770003
037200     05  FILLER                      PIC X(01) VALUE '/'.         03780003
037300     05  PV-DATE-END-CCYY            PIC X(04) VALUE SPACE.       03790003
037400     05  FILLER                      PIC X(01) VALUE SPACE.       03800003
037500     05  PV-DATE-FISCAL-PERIOD       PIC 9(02) VALUE ZEROES.      03810003
037600     05  FILLER                      PIC X(01) VALUE SPACE.       03820003
037700     05  PV-DATE-FISCAL-QUARTER      PIC 9(01) VALUE ZERO.        03830003
037800     05  FILLER                      PIC X(01) VALUE SPACE.       03840003
037900     05  PV-DATE-SEASON              PIC X(06) VALUE SPACES.      03850003
038000     05  FILLER                      PIC X(47) VALUE SPACES.      03860003
038100                                                                  03870003
038200 01  PV-ABEND-FIELDS.                                             03880003
038300     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           03890003
038400                                               COMP SYNC.         03900003
038500     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP020'.  03910003
038600     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      03920003
038700     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      03930003
038800     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      03940003
038900     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      03950006
039000     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      03960006
039100     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      03970006
039200     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      03980006
039300     05  PV-DB2-TABLE-NAME           PIC X(08) VALUE SPACES.      03990006
039400                                                                  04000029
039500 01  CORPORATE-SUMMARY-TABLE.                                     04010029
039600     05  SUMMARY-TABLE  OCCURS 50 TIMES INDEXED BY CS-IDX.        04020029
039700         10  SUMMARY-LOCN-NBR        PIC  9(04).                  04030035
039800         10  SUMMARY-LOCN-NAME       PIC  X(25).                  04040035
039900         10  SUMMARY-TYPE-1          PIC  9(09).                  04050030
040000         10  SUMMARY-TYPE-2          PIC  9(09).                  04060030
040100         10  SUMMARY-TYPE-3          PIC  9(09).                  04070030
040200         10  SUMMARY-TYPE-4          PIC  9(09).                  04080030
040300         10  SUMMARY-TYPE-5          PIC  9(09).                  04090030
040400         10  SUMMARY-TOTAL           PIC  9(09).                  04100030
040500                                                                  04110003
040600******************************************************************04120003
040700*  COPYBOOK USED BY CALENDAR ROUTINE                              04130003
040800******************************************************************04140003
040900     COPY DPWS500.                                                04150003
041000                                                                  04160003
041100******************************************************************04170001
041200*  RECORD LAYOUT FOR INPUT FILE                                   04180001
041300******************************************************************04190001
041400     COPY SURD008.                                                04200003
041500                                                                  04210001
041600******************************************************************04220001
041700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               04230001
041800******************************************************************04240001
041900     COPY DPWS132.                                                04250001
042000                                                                  04260001
042100 01  WS-BATCH-PROC-DATE.                                          04270001
042200     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      04280001
042300     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      04290001
042400     05  FILLER                      PIC X(01) VALUE SPACES.      04300001
042500     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      04310001
042600     05  FILLER                      PIC X(01) VALUE SPACES.      04320001
042700     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      04330001
042800*                                                                 04340001
042900 01  HEADING-LINES.                                               04350001
043000     05  HEADING-LINE-1.                                          04360001
043100         10  FILLER                  PIC X(34) VALUE SPACES.      04370001
043200         10  FILLER                  PIC X(49) VALUE              04380001
043300             'INTRA-COMPANY MISDIRECTS FROM UCC128 SCAN RESULTS'. 04390001
043400         10  FILLER                  PIC X(14) VALUE              04400001
043500                                               ' BY DC, VENDOR'.  04410001
043600         10  FILLER                  PIC X(35) VALUE SPACES.      04420001
043700                                                                  04430001
043800     05  HEADING-LINE-2.                                          04440001
043900         10  FILLER                  PIC X(43) VALUE SPACES.      04450001
044000         10  FILLER                  PIC X(15) VALUE              04460001
044100                                               'TIME PERIOD OF '. 04470001
044200         10  HL2-FROM-DATE-MM        PIC X(02) VALUE SPACES.      04480001
044300         10  FILLER                  PIC X(01) VALUE '-'.         04490001
044400         10  HL2-FROM-DATE-DD        PIC X(02) VALUE SPACES.      04500001
044500         10  FILLER                  PIC X(01) VALUE '-'.         04510001
044600         10  HL2-FROM-DATE-YYYY      PIC X(04) VALUE SPACES.      04520001
044700         10  FILLER                  PIC X(06) VALUE ' THRU '.    04530001
044800         10  HL2-TO-DATE-MM          PIC X(02) VALUE SPACES.      04540001
044900         10  FILLER                  PIC X(01) VALUE '-'.         04550001
045000         10  HL2-TO-DATE-DD          PIC X(02) VALUE SPACES.      04560001
045100         10  FILLER                  PIC X(01) VALUE '-'.         04570001
045200         10  HL2-TO-DATE-YYYY        PIC X(04) VALUE SPACES.      04580001
045300         10  FILLER                  PIC X(48) VALUE SPACES.      04590001
045400                                                                  04600001
045500     05  HEADING-LINE-3.                                          04610001
045600         10  FILLER                  PIC X(01) VALUE SPACES.      04620001
045700         10  FILLER                  PIC X(21) VALUE              04630001
045800                                     'RECEIVING LOCATION:  '.     04640001
045900         10  HL3-PROCESS-DC-NBR      PIC X(04) VALUE SPACES.      04650001
046000         10  FILLER                  PIC X(106) VALUE SPACES.     04660001
046100                                                                  04670001
046200     05  HEADING-LINE-3-CS.                                       04680030
046300         10  FILLER                  PIC X(01) VALUE SPACES.      04690030
046400         10  FILLER                  PIC X(21) VALUE              04700030
046500                                     'RECEIVING LOCATION:  '.     04710030
046600         10  FILLER                  PIC X(18) VALUE              04720031
046700                                     'CORPORATE SUMMARY '.        04730030
046800         10  FILLER                  PIC X(92) VALUE SPACES.      04740030
046900                                                                  04750030
047000     05  HEADING-LINE-4.                                          04760001
047100         10  FILLER                  PIC X(01) VALUE SPACES.      04770001
047200         10  FILLER                  PIC X(13) VALUE              04780001
047300                                               'VENDOR NAME: '.   04790001
047400         10  HL4-VEND-NAME           PIC X(30) VALUE SPACES.      04800001
047500         10  FILLER                  PIC X(88) VALUE SPACES.      04810001
047600                                                                  04820001
047700     05  HEADING-LINE-4-CS.                                       04830030
047800         10  FILLER                  PIC X(09) VALUE SPACES.      04840052
047900         10  FILLER                  PIC X(11) VALUE              04850030
048000                                               '           '.     04860035
048100         10  FILLER                  PIC X(25) VALUE SPACES.      04870032
048200         10  FILLER                  PIC X(11) VALUE              04880030
048300                                               ' MISDIRECT '.     04890030
048400         10  FILLER                  PIC X(02) VALUE SPACES.      04900030
048500         10  FILLER                  PIC X(11) VALUE              04910030
048600                                               ' MISDIRECT '.     04920030
048700         10  FILLER                  PIC X(02) VALUE SPACES.      04930030
048800         10  FILLER                  PIC X(11) VALUE              04940030
048900                                               ' MISDIRECT '.     04950030
049000         10  FILLER                  PIC X(02) VALUE SPACES.      04960030
049100         10  FILLER                  PIC X(11) VALUE              04970030
049200                                               ' MISDIRECT '.     04980030
049300         10  FILLER                  PIC X(02) VALUE SPACES.      04990030
049400         10  FILLER                  PIC X(11) VALUE              05000030
049500                                               ' MISDIRECT '.     05010030
049600         10  FILLER                  PIC X(02) VALUE SPACES.      05020030
049700         10  FILLER                  PIC X(11) VALUE              05030030
049800                                               '           '.     05040044
049900         10  FILLER                  PIC X(06) VALUE SPACES.      05050052
050000                                                                  05060030
050100     05  HEADING-LINE-5.                                          05070001
050200         10  FILLER                  PIC X(01) VALUE SPACES.      05080001
050300         10  FILLER                  PIC X(16) VALUE              05090001
050400                                     'MISDIRECT TYPE #'.          05100001
050500         10  HL5-MISDIRECT-TYPE      PIC X(01) VALUE SPACES.      05110001
050600         10  FILLER                  PIC X(02) VALUE ': '.        05120001
050700         10  HL5-MISDIRECT-DESC      PIC X(92) VALUE SPACES.      05130001
050800         10  FILLER                  PIC X(20) VALUE SPACES.      05140001
050900                                                                  05150030
051000     05  HEADING-LINE-5-CS.                                       05160030
051100         10  FILLER                  PIC X(09) VALUE SPACES.      05170052
051200         10  FILLER                  PIC X(11) VALUE              05180030
051300                                               'DC LOCATION'.     05190035
051400         10  FILLER                  PIC X(25) VALUE SPACES.      05200032
051500         10  FILLER                  PIC X(11) VALUE              05210030
051600                                               '  TYPE #1  '.     05220030
051700         10  FILLER                  PIC X(02) VALUE SPACES.      05230030
051800         10  FILLER                  PIC X(11) VALUE              05240030
051900                                               '  TYPE #2  '.     05250030
052000         10  FILLER                  PIC X(02) VALUE SPACES.      05260030
052100         10  FILLER                  PIC X(11) VALUE              05270030
052200                                               '  TYPE #3  '.     05280030
052300         10  FILLER                  PIC X(02) VALUE SPACES.      05290030
052400         10  FILLER                  PIC X(11) VALUE              05300030
052500                                               '  TYPE #4  '.     05310030
052600         10  FILLER                  PIC X(02) VALUE SPACES.      05320030
052700         10  FILLER                  PIC X(11) VALUE              05330030
052800                                               '   TOTAL   '.     05340044
052900         10  FILLER                  PIC X(02) VALUE SPACES.      05350030
053000         10  FILLER                  PIC X(11) VALUE              05360030
053100                                               '           '.     05370044
053200         10  FILLER                  PIC X(06) VALUE SPACES.      05380052
053300                                                                  05390002
053400     05  HEADING-LINE-6.                                          05400002
053500         10  FILLER                  PIC X(01) VALUE SPACES.      05410002
053600         10  FILLER                  PIC X(04) VALUE SPACES.      05420002
053700         10  FILLER                  PIC X(01) VALUE SPACES.      05430002
053800         10  FILLER                  PIC X(11) VALUE SPACES.      05440002
053900         10  FILLER                  PIC X(01) VALUE SPACES.      05450002
054000         10  FILLER                  PIC X(11) VALUE SPACES.      05460002
054100         10  FILLER                  PIC X(01) VALUE SPACES.      05470002
054200         10  FILLER                  PIC X(04) VALUE SPACES.      05480002
054300         10  FILLER                  PIC X(01) VALUE SPACES.      05490002
054400         10  FILLER                  PIC X(04) VALUE 'STR '.      05500002
054500         10  FILLER                  PIC X(16) VALUE SPACES.      05501065
054600         10  FILLER                  PIC X(01) VALUE SPACES.      05510002
054700         10  FILLER                  PIC X(08) VALUE SPACES.      05520002
054800         10  FILLER                  PIC X(01) VALUE SPACES.      05530002
054900         10  FILLER                  PIC X(05) VALUE SPACES.      05540002
055000         10  FILLER                  PIC X(01) VALUE SPACES.      05550002
055100         10  FILLER                  PIC X(08) VALUE SPACES.      05560002
055200         10  FILLER                  PIC X(01) VALUE SPACES.      05570002
055300         10  FILLER                  PIC X(25) VALUE SPACES.      05580061
055400         10  FILLER                  PIC X(04) VALUE SPACES.      05590063
055500         10  FILLER                  PIC X(19) VALUE              05600002
055600                                     '- ASN INFORMATION -'.       05610002
055700         10  FILLER                  PIC X(02) VALUE SPACES.      05620002
055800                                                                  05630002
055900     05  HEADING-LINE-7.                                          05640002
056000         10  FILLER                  PIC X(01) VALUE SPACES.      05650002
056100         10  FILLER                  PIC X(04) VALUE SPACES.      05660002
056200         10  FILLER                  PIC X(01) VALUE SPACES.      05670002
056300         10  FILLER                  PIC X(11) VALUE SPACES.      05680002
056400         10  FILLER                  PIC X(01) VALUE SPACES.      05690002
      *CLP 10/14/14                                                             
056500         10  FILLER                  PIC X(12) VALUE SPACES.      05700002
056600         10  FILLER                  PIC X(01) VALUE SPACES.      05710002
056700         10  FILLER                  PIC X(04) VALUE 'DEST'.      05720002
056800         10  FILLER                  PIC X(01) VALUE SPACES.      05730002
056900         10  FILLER                  PIC X(04) VALUE 'PRCS'.      05740002
057000         10  FILLER                  PIC X(16) VALUE SPACES.      05741066
057100         10  FILLER                  PIC X(03) VALUE SPACES.      05750062
057200         10  FILLER                  PIC X(07) VALUE ' SCAN  '.   05760056
057300         10  FILLER                  PIC X(03) VALUE SPACES.      05770058
057400         10  FILLER                  PIC X(04) VALUE 'SCAN'.      05780058
057500         10  FILLER                  PIC X(01) VALUE SPACES.      05790002
      *CLP 10/14/14                                                             
057600         10  FILLER                  PIC X(07) VALUE ' SCAN  '.   05800002
057700         10  FILLER                  PIC X(01) VALUE SPACES.      05810002
057800         10  FILLER                  PIC X(26) VALUE SPACES.      05820058
057900         10  FILLER                  PIC X(01) VALUE SPACES.      05830002
058000         10  FILLER                  PIC X(14) VALUE              05840002
058100                                     '--DOWNLOAD--- '.            05850002
058200         10  FILLER                  PIC X(01) VALUE SPACES.      05860002
058300         10  FILLER                  PIC X(04) VALUE 'RCVG'.      05870002
058400         10  FILLER                  PIC X(02) VALUE SPACES.      05880002
058500                                                                  05890002
058600     05  HEADING-LINE-8.                                          05900002
058700         10  FILLER                  PIC X(01) VALUE SPACES.      05910002
058800         10  FILLER                  PIC X(04) VALUE 'SCAC'.      05920002
058900         10  FILLER                  PIC X(01) VALUE SPACES.      05930002
059000         10  FILLER                  PIC X(11) VALUE              05940002
059100                                     'TRAILER    '.               05950066
059200         10  FILLER                  PIC X(01) VALUE SPACES.      05960002
      *CLP 10/14/14                                                             
059300         10  FILLER                  PIC X(12) VALUE              05970002
059400                                     'PO/RECEIVER '.              05980002
059500         10  FILLER                  PIC X(01) VALUE SPACES.      05990002
059600         10  FILLER                  PIC X(04) VALUE 'STR '.      06000002
059700         10  FILLER                  PIC X(01) VALUE SPACES.      06010062
059800         10  FILLER                  PIC X(04) VALUE 'DC  '.      06010166
059900         10  FILLER                  PIC X(01) VALUE SPACES.      06010262
060000         10  FILLER                  PIC X(16) VALUE              06020054
060100                                     'SERIAL SHIP CODE'.          06030054
060200         10  FILLER                  PIC X(03) VALUE SPACES.      06040063
060300         10  FILLER                  PIC X(06) VALUE 'DATE  '.    06050063
060400         10  FILLER                  PIC X(03) VALUE SPACES.      06060057
060500         10  FILLER                  PIC X(05) VALUE 'TIME '.     06070002
060600         10  FILLER                  PIC X(01) VALUE SPACES.      06080002
      *CLP 10/14/14                                                             
060700         10  FILLER                  PIC X(07) VALUE 'USER ID'.   06090002
060800         10  FILLER                  PIC X(01) VALUE SPACES.      06100002
060900         10  FILLER                  PIC X(25) VALUE              06110054
061000             'ASN NUMBER               '.                         06120054
061100         10  FILLER                  PIC X(01) VALUE SPACES.      06130002
061200         10  FILLER                  PIC X(08) VALUE 'DATE    '.  06140002
061300         10  FILLER                  PIC X(01) VALUE SPACES.      06150002
061400         10  FILLER                  PIC X(05) VALUE 'TIME '.     06160002
061500         10  FILLER                  PIC X(01) VALUE SPACES.      06170002
061600         10  FILLER                  PIC X(04) VALUE 'OPER'.      06180002
061700                                                                  06200002
061800 01  DETAIL-LINES.                                                06210001
061900     05  DETAIL-LINE-1.                                           06220001
062000         10  FILLER                  PIC X(01) VALUE SPACES.      06230002
062100         10  DL1-SCAC                PIC X(04) VALUE SPACES.      06240002
062200         10  FILLER                  PIC X(01) VALUE SPACES.      06250002
062300         10  DL1-TRAILER             PIC X(11) VALUE SPACES.      06260002
062400         10  FILLER                  PIC X(01) VALUE SPACES.      06270002
      *CLP 10/14/14                                                             
062500         10  DL1-PO-RCVR             PIC X(12) VALUE SPACES.      06280002
062600         10  FILLER                  PIC X(01) VALUE SPACES.      06290002
062700         10  DL1-DEST-STR            PIC 9(04) VALUE ZEROES.      06300010
062800         10  FILLER                  PIC X(01) VALUE SPACES.      06310059
062900         10  DL1-PRCS-DC             PIC 9(04) VALUE ZEROES.      06310160
063000         10  FILLER                  PIC X(01) VALUE SPACES.      06310266
063100         10  DL1-SERIAL-SHIP-CODE    PIC 9(18) VALUE ZEROES.      06320010
063200         10  FILLER                  PIC X(01) VALUE SPACES.      06330059
063300         10  DL1-SCAN-DATE           PIC X(08) VALUE SPACES.      06340002
063400         10  FILLER                  PIC X(01) VALUE SPACES.      06350002
063500         10  DL1-SCAN-TIME           PIC X(05) VALUE SPACES.      06360002
063600         10  FILLER                  PIC X(01) VALUE SPACES.      06370002
      *CLP 10/14/14                                                             
063700         10  DL1-SCAN-USERID         PIC X(07) VALUE SPACES.      06380002
063800         10  FILLER                  PIC X(01) VALUE SPACES.      06390002
063900         10  DL1-ASN-NUMBER          PIC X(25) VALUE SPACES.      06400054
064000         10  FILLER                  PIC X(01) VALUE SPACES.      06410002
064100         10  DL1-ASN-DATE            PIC X(08) VALUE SPACES.      06420002
064200         10  FILLER                  PIC X(01) VALUE SPACES.      06430002
064300         10  DL1-ASN-TIME            PIC X(05) VALUE SPACES.      06440002
064400         10  FILLER                  PIC X(01) VALUE SPACES.      06450002
064500         10  DL1-RCVG-OPER           PIC 9(04) VALUE ZEROES.      06460010
064600                                                                  06480030
064700     05  DETAIL-LINE-1-CS.                                        06490030
064800         10  FILLER                  PIC X(07) VALUE SPACES.      06500030
064900         10  CS-LOCN-NBR             PIC X(04) VALUE SPACES.      06510030
065000         10  FILLER                  PIC X(02) VALUE '  '.        06520051
065100         10  CS-LOCN-NAME            PIC X(25) VALUE SPACES.      06530030
065200         10  FILLER                  PIC X(01) VALUE ' '.         06540051
065300         10  FILLER                  PIC X(04) VALUE SPACES.      06550030
065400         10  CS-LOCN-TYPE-1          PIC X(11) VALUE SPACES.      06560030
065500         10  FILLER                  PIC X(02) VALUE SPACES.      06570030
065600         10  CS-LOCN-TYPE-2          PIC X(11) VALUE SPACES.      06580030
065700         10  FILLER                  PIC X(02) VALUE SPACES.      06590030
065800         10  CS-LOCN-TYPE-3          PIC X(11) VALUE SPACES.      06600030
065900         10  FILLER                  PIC X(02) VALUE SPACES.      06610030
066000         10  CS-LOCN-TYPE-4          PIC X(11) VALUE SPACES.      06620030
066100         10  FILLER                  PIC X(02) VALUE SPACES.      06630030
066200***      10  CS-LOCN-TYPE-5          PIC X(11) VALUE SPACES.      06640041
066300***      10  FILLER                  PIC X(02) VALUE SPACES.      06650041
066400         10  CS-LOCN-TOTAL           PIC X(11) VALUE SPACES.      06660030
066500         10  FILLER                  PIC X(26) VALUE SPACES.      06670041
066600                                                                  06680002
066700 01  TOTAL-LINES.                                                 06690001
066800     05  TOTAL-LINE-1.                                            06700001
066900         10  FILLER                  PIC X(01) VALUE SPACES.      06710002
067000         10  FILLER                  PIC X(26) VALUE              06720002
067100             'TOTAL FOR MISDIRECT TYPE #'.                        06730002
067200         10  TL1-MISDIRECT-TYPE      PIC X(01) VALUE SPACES.      06740002
067300         10  FILLER                  PIC X(02) VALUE ': '.        06750002
067400         10  TL1-TOTAL-TYPE          PIC X(07).                   06760002
067500         10  FILLER                  PIC X(95) VALUE SPACES.      06770002
067600                                                                  06780002
067700     05  TOTAL-LINE-1-CS.                                         06790030
067800         10  FILLER                  PIC X(22) VALUE SPACES.      06800030
067900         10  FILLER                  PIC X(17) VALUE              06810031
068000                                     'CORPORATE TOTALS:'.         06820030
068100         10  FILLER                  PIC X(04) VALUE SPACES.      06830030
068200         10  CS-TOTL-TYPE-1          PIC ZZZ,ZZZ,ZZ9.             06840030
068300         10  FILLER                  PIC X(02) VALUE SPACES.      06850030
068400         10  CS-TOTL-TYPE-2          PIC ZZZ,ZZZ,ZZ9.             06860030
068500         10  FILLER                  PIC X(02) VALUE SPACES.      06870030
068600         10  CS-TOTL-TYPE-3          PIC ZZZ,ZZZ,ZZ9.             06880030
068700         10  FILLER                  PIC X(02) VALUE SPACES.      06890030
068800         10  CS-TOTL-TYPE-4          PIC ZZZ,ZZZ,ZZ9.             06900030
068900         10  FILLER                  PIC X(02) VALUE SPACES.      06910030
069000***      10  CS-TOTL-TYPE-5          PIC ZZZ,ZZZ,ZZ9.             06920041
069100***      10  FILLER                  PIC X(02) VALUE SPACES.      06930041
069200         10  CS-TOTL-TOTAL           PIC ZZZ,ZZZ,ZZ9.             06940030
069300         10  FILLER                  PIC X(26) VALUE SPACES.      06950041
069400                                                                  06960030
069500     05  TOTAL-LINE-2.                                            06970002
069600         10  FILLER                  PIC X(01) VALUE SPACES.      06980002
069700         10  FILLER                  PIC X(29) VALUE              06990002
069800             'TOTAL MISDIRECTS FOR VENDOR: '.                     07000002
069900         10  TL2-TOTAL-VEND          PIC X(07).                   07010002
070000         10  FILLER                  PIC X(95) VALUE SPACES.      07020002
070100                                                                  07030002
070200     05  TOTAL-LINE-3.                                            07040002
070300         10  FILLER                  PIC X(01) VALUE SPACES.      07050002
070400         10  FILLER                  PIC X(31) VALUE              07060002
070500             'TOTAL MISDIRECTS FOR FACILITY: '.                   07070002
070600         10  TL3-TOTAL-LOCN          PIC X(05).                   07080012
070700         10  FILLER                  PIC X(95) VALUE SPACES.      07090002
070800                                                                  07100002
070900 01  MISCELLANEOUS-LINES.                                         07110001
071000     05  BLANK-LINE.                                              07120001
071100         10  FILLER                  PIC X(132) VALUE SPACES.     07130002
071200                                                                  07140001
071300     05  END-OF-REPORT-LINE.                                      07150001
071400         10  FILLER                  PIC X(44) VALUE SPACES.      07160002
071500         10  FILLER                  PIC X(45) VALUE              07170002
071600             '*******   E N D   O F   R E P O R T   *******'.     07180001
071700         10  FILLER                  PIC X(43) VALUE SPACES.      07190002
071800                                                                  07200001
071900     05  NO-MISDIRECT-DATA-LINE.                                  07210002
072000         10  FILLER                  PIC X(01) VALUE SPACES.      07220002
072100         10  FILLER                  PIC X(23) VALUE              07230002
072200                                     '** NO DATA TO REPORT **'.   07240002
072300         10  FILLER                  PIC X(108) VALUE SPACES.     07250002
072400                                                                  07260002
072500     05  NO-DATA-TO-REPORT-LINE.                                  07270002
072600         10  FILLER                  PIC X(40) VALUE SPACES.      07280002
072700         10  FILLER                  PIC  X(52)    VALUE          07290002
072800         '*******  N O   D A T A   T O   R E P O R T   *******'.  07300002
072900         10  FILLER                  PIC  X(40)    VALUE SPACES.  07310002
073000                                                                  07320002
073100******************************************************************07330006
073200*  USED FOR DB2 ERROR MESSAGE BUILDING                            07340006
073300******************************************************************07350006
073400     COPY DPWS004.                                                07360067
073500                                                                  07370006
073600******************************************************************07380006
073700*   DB2 SQL COMMUNICATION AREA                                    07390006
073800******************************************************************07400006
073900     EXEC SQL                                                     07410006
074000          INCLUDE SQLCA                                           07420006
074100     END-EXEC.                                                    07430006
074200                                                                  07440006
074300******************************************************************07450006
074400*  DCLGEN FOR THE COMPANY CONTROL TABLE                           07460006
074500******************************************************************07470006
074600     EXEC SQL                                                     07480006
074700         INCLUDE TCOCNTL                                          07490006
074800     END-EXEC.                                                    07500006
074900                                                                  07510006
075000******************************************************************07520029
075100*  DOMAIN LOCATION TABLE                                          07530067
075200******************************************************************07540029
075300                                                                  07550029
075400     EXEC SQL                                                     07560029
075500          INCLUDE XLT00010                                        07570067
075600     END-EXEC.                                                    07580029
075700                                                                  07590029
075800     EXEC SQL                                                     07600029
075900         DECLARE DC-CSR CURSOR FOR                                07610034
076000          SELECT LOC_NBR                                          07620067
076100               , LOC_NM                                           07630067
076200            FROM XLT_LOC                                          07640067
076300           WHERE LOC_TYP_CDE   = 'DC'                             07650046
076400             AND CLO_DTE > :PV-CURR-DATE-10                       07660067
076500        ORDER BY 1                                                07670029
076600     END-EXEC.                                                    07680029
076700                                                                  07690029
076800******************************************************************07700001
076900******************************************************************07710001
077000 PROCEDURE DIVISION.                                              07720001
077100     DISPLAY '**** START OF SUKRP020 ****'.                       07730002
077200                                                                  07740001
077300*OPEN FILES.                                                      07750001
077400     OPEN INPUT  INPUT-EXTRACT-FILE                               07760001
077500          OUTPUT OUTPUT-REPORT.                                   07770001
077600                                                                  07780001
077700*READ FIRST INPUT RECORD.                                         07790001
077800     SET PS-NOT-END-OF-INPUT TO TRUE.                             07800003
077900     SET PS-TYPE-DATA-NO     TO TRUE.                             07810011
078000     MOVE 0 TO PV-REC-IN-QTY.                                     07820009
078100     PERFORM 0100-READ-EXTRACT.                                   07830003
078200                                                                  07840003
078300*SET/PRINT REPORT HEADINGS.                                       07850003
078400     IF NOT PS-END-OF-INPUT                                       07860009
078500         MOVE SU008-SCN-OPER-UNT-ID TO PV-CURR-LOCN               07870022
078600         MOVE SU008-VEND-NAME       TO PV-CURR-VEND               07880022
078700         MOVE SU008-MISDIRECT-TYPE  TO PV-CURR-TYPE               07890049
078800         MOVE 1                     TO PV-REC-IN-QTY              07900022
078900     END-IF.                                                      07910009
079000     DISPLAY '  ** 1000-INITIALIZATION **'.                       07920016
079100     PERFORM 1000-INITIALIZATION.                                 07930003
079200     DISPLAY '  ** 1000-INITIALIZATION DONE **'.                  07940016
079300                                                                  07950003
079400*PROCESS INPUT FILE.                                              07960003
079500     IF PS-END-OF-INPUT                                           07970019
079600         PERFORM 1300-NO-DETAIL-LINE                              07980009
079700     ELSE                                                         07990019
079800         PERFORM 2000-PROCESS-EXTRACT                             08000021
079900           UNTIL PS-END-OF-INPUT                                  08010021
080000         PERFORM 0200-PRINT-LAST-TOTALS                           08020019
080100     END-IF.                                                      08030019
080200                                                                  08040003
080300     DISPLAY '**** RECORDS READ    ==> ' PV-REC-IN-QTY.           08050009
080400     DISPLAY '**** RECORDS WRITTEN ==> ' PV-REC-OUT-QTY.          08060009
080500                                                                  08070009
080600*WRITE CORPORATE SUMMARY.                                         08080030
080700     PERFORM 3000-PRINT-SUMMARY.                                  08090030
080800                                                                  08100030
080900*WRITE END-OF-REPORT LINE.                                        08110015
081000     PERFORM 1400-END-OF-RPT-LINE.                                08120009
081100                                                                  08130009
081200*CLOSE FILES.                                                     08140009
081300     CLOSE INPUT-EXTRACT-FILE                                     08150009
081400           OUTPUT-REPORT.                                         08160009
081500                                                                  08170009
081600     GOBACK.                                                      08180009
081700                                                                  08190003
081800******************************************************************08200003
081900*  READ NEXT INPUT FILE RECORD.                                  *08210003
082000******************************************************************08220003
082100 0100-READ-EXTRACT.                                               08230003
082200                                                                  08240003
082300     READ INPUT-EXTRACT-FILE INTO SU008-EXTRACT-RECORD            08250003
082400       AT END                                                     08260003
082500           SET PS-END-OF-INPUT TO TRUE.                           08270003
082600                                                                  08280003
082700******************************************************************08290019
082800*  PRINT REMAINING TOTAL LINES AFTER LAST RECORD READ.           *08300019
082900******************************************************************08310019
083000 0200-PRINT-LAST-TOTALS.                                          08320019
083100                                                                  08330019
083200*WRITE LAST TOTALS.                                               08340019
083300     PERFORM 2010-TYPE-BREAK.                                     08350019
083400     PERFORM 2020-VEND-BREAK.                                     08360019
083500     PERFORM 2030-LOCN-BREAK.                                     08370019
083600                                                                  08380019
083700******************************************************************08390003
083800*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *08400003
083900******************************************************************08410003
084000 1000-INITIALIZATION.                                             08420003
084100                                                                  08430003
084200     EXEC SQL                                                             
084300         SET :PV-CURR-DATE-10     =  CURRENT DATE                         
084400     END-EXEC                                                             
084500                                                                  08490003
084600     PERFORM 1010-INITIALIZE-SUMMARY-TABLE.                       08500046
084700     PERFORM 1020-LOAD-SUMMARY-TABLE.                             08510046
084800                                                                  08520046
084900     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                08530003
085000     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  08540003
085100     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              08550003
085200     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 08560003
085300                                                                  08570003
085400     ACCEPT PV-TODAYS-TIME FROM TIME.                             08580046
085500     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 08590003
085600     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               08600003
085700                                                                  08610003
085800     MOVE PC-SUKRP020          TO DP132-PROGRAM-NAME.             08620003
085900     MOVE PC-REPORT-NBR        TO DP132-REPORT-NUMBER.            08630003
086000                                                                  08640003
086100     SET PS-FIRST-TIME-YES     TO TRUE.                           08650003
086200                                                                  08660003
086300     MOVE +0                   TO PV-REC-OUT-QTY.                 08670009
086400                                                                  08680009
086500     MOVE +0                   TO PV-PAGE-COUNT                   08690003
086600                                  PV-ACCUM-TYPE                   08700003
086700                                  PV-ACCUM-VEND                   08710003
086800                                  PV-ACCUM-LOCN.                  08720037
086900                                                                  08730033
087000     MOVE ZEROES               TO PV-ACCUM-T1                     08740036
087100                                  PV-ACCUM-T2                     08750036
087200                                  PV-ACCUM-T3                     08760036
087300                                  PV-ACCUM-T4                     08770036
087400                                  PV-ACCUM-T5                     08780036
087500                                  PV-ACCUM-TOTL.                  08790036
087600                                                                  08800003
087700     PERFORM 1100-PROCESS-DATECARD.                               08810003
087800                                                                  08820003
087900     PERFORM 1200-PRINT-HEADINGS.                                 08830009
088000                                                                  08840003
088100******************************************************************08850029
088200*   INITIALIZE SUMMARY TABLE.                                    *08860029
088300******************************************************************08870029
088400 1010-INITIALIZE-SUMMARY-TABLE.                                   08880029
088500                                                                  08890029
088600     PERFORM                                                      08900029
088700       VARYING CS-IDX FROM 1 BY 1 UNTIL CS-IDX > 50               08910030
088800         MOVE ZEROES TO SUMMARY-LOCN-NBR (CS-IDX)                 08920035
088900                        SUMMARY-TYPE-1 (CS-IDX)                   08930030
089000                        SUMMARY-TYPE-2 (CS-IDX)                   08940030
089100                        SUMMARY-TYPE-3 (CS-IDX)                   08950030
089200                        SUMMARY-TYPE-4 (CS-IDX)                   08960030
089300                        SUMMARY-TYPE-5 (CS-IDX)                   08970030
089400                        SUMMARY-TOTAL (CS-IDX)                    08980030
089500         MOVE SPACES TO SUMMARY-LOCN-NAME (CS-IDX)                08990035
089600     END-PERFORM.                                                 09000029
089700                                                                  09010029
089800******************************************************************09020029
089900*   LOAD SUMMARY TABLE.                                          *09030029
090000******************************************************************09040029
090100 1020-LOAD-SUMMARY-TABLE.                                         09050029
090200                                                                  09060029
090300*OPEN CURSOR.                                                     09070029
090400     EXEC SQL                                                     09080029
090500         OPEN DC-CSR                                              09090034
090600     END-EXEC.                                                    09100029
090700                                                                  09110029
090800     EVALUATE TRUE                                                09120029
090900       WHEN SQLCODE = ZERO                                        09130029
091000           CONTINUE                                               09140029
091100       WHEN OTHER                                                 09150029
091200           MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARAGRAPH   09160029
091300           MOVE 'OPEN CURSOR' TO PV-DB2-OPERATION-MESSAGE-1       09170029
091400           MOVE 'XLT_LOC'     TO PV-DB2-TABLE-NAME                09180029
091500           PERFORM 9900-DB2-ABEND                                 09190029
091600     END-EVALUATE.                                                09200029
091700                                                                  09210029
091800*LOAD INTERNAL TABLE FROM CURSOR.                                 09220029
091900     PERFORM 1030-FETCH-CURSOR.                                   09230029
092000                                                                  09240029
092100     PERFORM                                                      09250029
092200       VARYING CS-IDX FROM 1 BY 1                                 09260029
092300         UNTIL CS-IDX > 50 OR PS-END-OF-CURSOR                    09270029
092400                                                                  09280029
092500         MOVE XLT00010-LOC-NBR    TO SUMMARY-LOCN-NBR (CS-IDX)    09290067
092600         MOVE XLT00010-LOC-NM     TO SUMMARY-LOCN-NAME (CS-IDX)   09300035
092700                                                                  09310029
092800         PERFORM 1030-FETCH-CURSOR                                09320029
092900     END-PERFORM.                                                 09330029
093000                                                                  09340029
093100*CLOSE CURSOR.                                                    09350029
093200     EXEC SQL                                                     09360029
093300         CLOSE DC-CSR                                             09370034
093400     END-EXEC.                                                    09380029
093500                                                                  09390029
093600     EVALUATE TRUE                                                09400029
093700       WHEN SQLCODE = ZERO                                        09410029
093800           CONTINUE                                               09420029
093900       WHEN OTHER                                                 09430029
094000           MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARAGRAPH   09440029
094100           MOVE 'CLOSE CURSOR' TO PV-DB2-OPERATION-MESSAGE-1      09450029
094200           MOVE 'XLT_LOC'      TO PV-DB2-TABLE-NAME               09460029
094300           PERFORM 9900-DB2-ABEND                                 09470029
094400     END-EVALUATE.                                                09480029
094500                                                                  09490029
094600******************************************************************09500029
094700*  FETCH NEXT CURSOR ROW (FROM STORE MASTER)                     *09510029
094800******************************************************************09520029
094900 1030-FETCH-CURSOR.                                               09530029
095000                                                                  09540029
095100     EXEC SQL                                                     09550029
095200         FETCH DC-CSR                                             09560034
095300          INTO :XLT00010-LOC-NBR                                  09570067
095400             , :XLT00010-LOC-NM                                   09580067
095500     END-EXEC.                                                    09590029
095600                                                                  09600029
095700     EVALUATE TRUE                                                09610029
095800       WHEN SQLCODE = ZERO                                        09620029
095900           CONTINUE                                               09630029
096000       WHEN SQLCODE = +100                                        09640029
096100           SET PS-END-OF-CURSOR TO TRUE                           09650029
096200       WHEN OTHER                                                 09660029
096300           MOVE '1030-FETCH-CURSOR' TO PV-ABEND-PARAGRAPH         09670029
096400           MOVE 'FETCH CURSOR' TO PV-DB2-OPERATION-MESSAGE-1      09680029
096500           MOVE 'XLT_LOC'      TO PV-DB2-TABLE-NAME               09690029
096600           PERFORM 9900-DB2-ABEND                                 09700029
096700     END-EVALUATE.                                                09710029
096800                                                                  09720029
096900******************************************************************09730003
097000*  READ SYSIN TO DETERMINE DATE RANGE DISPLAYED IN HEADING.      *09740003
097100******************************************************************09750003
097200 1100-PROCESS-DATECARD.                                           09760003
097300                                                                  09770003
097400     EXEC SQL                                                     09780006
097500         SELECT (CURRENT DATE - 1 DAY)                            09790006
097600              , CURRENT DATE                                      09800006
097700              , (CURRENT DATE - 1 YEAR)                           09810006
097800           INTO :PV-CURRENT-DB2-DATE-ONE                          09820006
097900              , :PV-CURRENT-DB2-DATE                              09830006
098000              , :PV-CURRENT-DB2-DATE-ONEYR                        09840006
098100           FROM TCOCNTL                                           09850006
098200          WHERE OPER_UNT_ID = 90                                  09860006
098300     END-EXEC.                                                    09870006
098400                                                                  09880006
098500     EVALUATE TRUE                                                09890006
098600       WHEN SQLCODE = ZERO                                        09900006
098700           MOVE PV-CURRENT-DB2-DATE     TO PV-CURR-DATE           09910006
098800           MOVE PV-CURRENT-DB2-CC       TO PV-CURRENT-CC          09920006
098900           MOVE PV-CURRENT-DB2-YY       TO PV-CURRENT-YY          09930006
099000                                           PV-CURRENT-YYMMDD-YY   09940006
099100           MOVE PV-CURRENT-DB2-MM       TO PV-CURRENT-MM          09950006
099200                                           PV-CURRENT-YYMMDD-MM   09960006
099300           MOVE PV-CURRENT-DB2-DD       TO PV-CURRENT-DD          09970006
099400                                           PV-CURRENT-YYMMDD-DD   09980006
099500       WHEN OTHER                                                 09990006
099600           MOVE '1100-PROCESS-DATECARD' TO PV-ABEND-PARAGRAPH     10000006
099700           MOVE 'SET DATE   ' TO PV-DB2-OPERATION-MESSAGE-1       10010006
099800           MOVE 'TCOCNTL'     TO PV-DB2-TABLE-NAME                10020006
099900           PERFORM 9900-DB2-ABEND                                 10030006
100000      END-EVALUATE.                                               10040006
100100                                                                  10050006
100200     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                10060003
100300                                                                  10070003
100400     DISPLAY '  CONTROL CARD SET-UP FOR THIS RUN IS: '            10080003
100500             CC-CONTROL-CARD-PARAMETERS.                          10090003
100600                                                                  10100003
100700     PERFORM 1110-CHECK-CC-PARAMETERS.                            10110003
100800     PERFORM 1120-SET-DATE-RANGE.                                 10120003
100900                                                                  10130003
101000******************************************************************10140003
101100 1110-CHECK-CC-PARAMETERS.                                        10150003
101200     MOVE '1110-CHECK-CC-PARAMETERS'   TO PV-ABEND-PARAGRAPH.     10160003
101300                                                                  10170003
101400     IF NOT CC-VALID-MODE-IND                                     10180003
101500         DISPLAY '***************************'                    10190003
101600         DISPLAY '**       ABEND           **'                    10200003
101700         DISPLAY '**  IN PROGRAM SUKRP020  **'                    10210003
101800         DISPLAY '***************************'                    10220003
101900         DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH    10230003
102000         DISPLAY '**   ERROR         ** = '                       10240003
102100                 'MODE INDICATOR "' CC-MODE-IND '"'               10250003
102200                 ' IS INVALID'                                    10260003
102300         DISPLAY '***************************'                    10270003
102400         DISPLAY '** CONTROL PARAMETERS = '                       10280003
102500                  CC-CONTROL-CARD-PARAMETERS                      10290003
102600         DISPLAY 'RUN ABORTED'                                    10300003
102700         DISPLAY '***************************'                    10310003
102800         MOVE 4003  TO PV-ABEND-CODE                              10320003
102900         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 10330003
103000         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    10340003
103100     END-IF.                                                      10350003
103200                                                                  10360003
103300     IF CC-BEG-DATE = PC-DEFAULT-CC-DATE                          10370003
103400       AND CC-END-DATE = PC-DEFAULT-CC-DATE                       10380003
103500         SET PS-NORMAL-RUN     TO TRUE                            10390003
103600     ELSE                                                         10400003
103700         SET PS-SPECIAL-RUN    TO TRUE                            10410003
103800         MOVE CC-BEG-CC        TO PV-BEG-YMD-CC                   10420003
103900         MOVE CC-BEG-YY        TO PV-BEG-YY                       10430003
104000         MOVE CC-BEG-YY        TO PV-BEG-YMD-YY                   10440003
104100         MOVE CC-BEG-MM        TO PV-BEG-MM                       10450003
104200         MOVE CC-BEG-MM        TO PV-BEG-YMD-MM                   10460003
104300         MOVE CC-BEG-DD        TO PV-BEG-DD                       10470003
104400         MOVE CC-BEG-DD        TO PV-BEG-YMD-DD                   10480003
104500         MOVE CC-END-CC        TO PV-END-YMD-CC                   10490003
104600         MOVE CC-END-YY        TO PV-END-YY                       10500003
104700         MOVE CC-END-YY        TO PV-END-YMD-YY                   10510003
104800         MOVE CC-END-MM        TO PV-END-MM                       10520003
104900         MOVE CC-END-MM        TO PV-END-YMD-MM                   10530003
105000         MOVE CC-END-DD        TO PV-END-DD                       10540003
105100         MOVE CC-END-DD        TO PV-END-YMD-DD                   10550003
105200                                                                  10560003
105300         IF PV-BEG-DATE-CYMD IS NOT < PV-END-DATE-CYMD            10570003
105400           AND PV-BEG-DATE-CYMD IS NOT = PV-END-DATE-CYMD         10580003
105500             DISPLAY '***************************'                10590003
105600             DISPLAY 'CONTROL PARAMETERS: '                       10600003
105700                     CC-CONTROL-CARD-PARAMETERS                   10610003
105800             DISPLAY 'THE BEGINNING DATE MUST BE LESS THAN '      10620003
105900                     'OR EQUAL TO THE ENDING DATE'                10630003
106000             DISPLAY 'PV-BEG-DATE - ' PV-BEG-DATE                 10640003
106100             DISPLAY 'PV-END-DATE - ' PV-BEG-DATE                 10650003
106200             DISPLAY 'PV-BEG-DATE-CYMD - ' PV-BEG-DATE-CYMD       10660003
106300             DISPLAY 'PV-END-DATE-CYMD - ' PV-BEG-DATE-CYMD       10670003
106400             DISPLAY 'RUN ABORTED'                                10680003
106500             DISPLAY '***************************'                10690003
106600             MOVE 4003  TO PV-ABEND-CODE                          10700003
106700             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             10710003
106800             CALL 'ILBOABN0'   USING PV-ABEND-CODE                10720003
106900         END-IF                                                   10730003
107000                                                                  10740003
107100         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           10750003
107200         SET DPG51-FISCAL-454-CALENDAR   TO TRUE                  10760003
107300         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  10770003
107400         SET DPG52-LK-DTE-GREG-FMT       TO TRUE                  10780003
107500         MOVE PV-BEG-DATE                TO DPG52-LK-DATE-INPUT   10790003
107600         PERFORM 9100-CALL-DATE-MODULE                            10800003
107700         IF DPG54-DATE-INVALID                                    10810003
107800             DISPLAY '***************************'                10820003
107900             DISPLAY 'CONTROL PARAMETERS: '                       10830003
108000                     CC-CONTROL-CARD-PARAMETERS                   10840003
108100             DISPLAY 'BEGINNING DATE  ' CC-BEG-DATE               10850003
108200                     ' IS INVALID.'                               10860003
108300             DISPLAY 'RUN ABORTED'                                10870003
108400             DISPLAY '***************************'                10880003
108500             MOVE 4003  TO PV-ABEND-CODE                          10890003
108600             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             10900003
108700             CALL 'ILBOABN0'   USING PV-ABEND-CODE                10910003
108800         END-IF                                                   10920003
108900                                                                  10930003
109000         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           10940003
109100         SET DPG51-FISCAL-454-CALENDAR   TO TRUE                  10950003
109200         SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  10960003
109300         SET DPG52-LK-DTE-GREG-FMT       TO TRUE                  10970003
109400         MOVE PV-END-DATE                TO DPG52-LK-DATE-INPUT   10980003
109500         PERFORM 9100-CALL-DATE-MODULE                            10990003
109600         IF DPG54-DATE-INVALID                                    11000003
109700             DISPLAY '***************************'                11010003
109800             DISPLAY 'CONTROL PARAMETERS: '                       11020003
109900                     CC-CONTROL-CARD-PARAMETERS                   11030003
110000             DISPLAY 'ENDING DATE ' CC-END-DATE                   11040003
110100                     ' IS INVALID.'                               11050003
110200             DISPLAY 'RUN ABORTED'                                11060003
110300             DISPLAY '***************************'                11070003
110400             MOVE 4003  TO PV-ABEND-CODE                          11080003
110500             DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE             11090003
110600             CALL 'ILBOABN0'   USING PV-ABEND-CODE                11100003
110700         END-IF                                                   11110003
110800     END-IF.                                                      11120003
110900                                                                  11130003
111000     IF PS-SPECIAL-RUN                                            11140003
111100       AND CC-SEASONAL-EXTRACT                                    11150003
111200       AND DPG56-FISCAL-PERIOD-NBR < 7                            11160003
111300         MOVE PC-SPRING TO PV-SEASON-DESC                         11170003
111400     ELSE                                                         11180003
111500     IF PS-SPECIAL-RUN                                            11190003
111600       AND CC-SEASONAL-EXTRACT                                    11200003
111700         MOVE PC-FALL   TO PV-SEASON-DESC                         11210003
111800     END-IF.                                                      11220003
111900                                                                  11230003
112000******************************************************************11240003
112100 1120-SET-DATE-RANGE.                                             11250003
112200     MOVE '1120-SET-DATE-RANGE      ' TO PV-ABEND-PARAGRAPH.      11260003
112300                                                                  11270003
112400     IF PS-NORMAL-RUN                                             11280003
112500         PERFORM 1130-DETERMINE-DATE-RANGE                        11290003
112600     ELSE                                                         11300003
112700         MOVE CC-BEG-DATE TO PV-START-EXTRACT                     11310003
112800         MOVE CC-END-DATE TO PV-END-EXTRACT                       11320003
112900     END-IF.                                                      11330003
113000                                                                  11340003
113100     MOVE PV-START-EXTRACT-YYYY    TO WS-START-EXTRACT-YYYY.      11350003
113200     MOVE PV-START-EXTRACT-MM      TO WS-START-EXTRACT-MM.        11360003
113300     MOVE PV-START-EXTRACT-DD      TO WS-START-EXTRACT-DD.        11370003
113400     MOVE PV-END-EXTRACT-YYYY      TO WS-END-EXTRACT-YYYY.        11380003
113500     MOVE PV-END-EXTRACT-MM        TO WS-END-EXTRACT-MM.          11390003
113600     MOVE PV-END-EXTRACT-DD        TO WS-END-EXTRACT-DD.          11400003
113700                                                                  11410003
113800     MOVE DPG56-FISCAL-PERIOD-NBR  TO WS-FISCAL-PERIOD-NBR.       11420003
113900     MOVE DPG56-FISCAL-PERIOD-WEEK TO WS-FISCAL-PERIOD-WEEK.      11430003
114000     MOVE DPG56-FISCAL-QTR-NBR     TO WS-FISCAL-QTR-NBR.          11440003
114100     MOVE DPG56-FISCAL-WEEK-NBR    TO WS-FISCAL-WEEK-NBR.         11450003
114200                                                                  11460003
114300     MOVE PV-START-EXTRACT-MM      TO PV-DATE-START-MM.           11470003
114400     MOVE PV-START-EXTRACT-DD      TO PV-DATE-START-DD.           11480003
114500     MOVE PV-START-EXTRACT-YYYY    TO PV-DATE-START-CCYY.         11490003
114600     MOVE PV-END-EXTRACT-MM        TO PV-DATE-END-MM.             11500003
114700     MOVE PV-END-EXTRACT-DD        TO PV-DATE-END-DD.             11510003
114800     MOVE PV-END-EXTRACT-YYYY      TO PV-DATE-END-CCYY.           11520003
114900     MOVE WS-FISCAL-PERIOD-NBR     TO PV-DATE-FISCAL-PERIOD.      11530003
115000     MOVE WS-FISCAL-QTR-NBR        TO PV-DATE-FISCAL-QUARTER.     11540003
115100     MOVE PV-SEASON-DESC           TO PV-DATE-SEASON.             11550003
115200                                                                  11560003
115300     DISPLAY '  DATE RANGE SET-UP FOR THIS RUN IS: '              11570003
115400             PV-DATE-RECORD.                                      11580003
115500                                                                  11590003
115600******************************************************************11600003
115700 1130-DETERMINE-DATE-RANGE.                                       11610003
115800     MOVE '1130-DETERMINE-DATE-RANGE' TO PV-ABEND-PARAGRAPH.      11620003
115900                                                                  11630003
116000     EVALUATE TRUE                                                11640003
116100       WHEN CC-WEEKLY-EXTRACT                                     11650003
116200            PERFORM 1131-WEEKLY-RPT-DTE-RANGE                     11660003
116300                                                                  11670003
116400       WHEN CC-MONTHLY-EXTRACT                                    11680003
116500                PERFORM 1132-MONTHLY-RPT-DTE-RANGE                11690003
116600                                                                  11700003
116700       WHEN CC-FISCAL-EXTRACT                                     11710003
116800                PERFORM 1133-FISCAL-RPT-DTE-RANGE                 11720003
116900                                                                  11730003
117000       WHEN CC-CALENDAR-EXTRACT                                   11740003
117100                PERFORM 1134-CALENDAR-RPT-DTE-RANGE               11750003
117200                                                                  11760003
117300       WHEN CC-SEASONAL-EXTRACT                                   11770003
117400                PERFORM 1135-SEASONAL-RPT-DTE-RANGE               11780003
117500                                                                  11790003
117600     END-EVALUATE.                                                11800003
117700                                                                  11810003
117800*--------------------------------------------------------------   11820003
117900**** GET START/END DATES OF THE PREVIOUS WEEK.                    11830003
118000*--------------------------------------------------------------   11840003
118100 1131-WEEKLY-RPT-DTE-RANGE.                                       11850003
118200     MOVE '1131-WEEKLY-RPT-DTE-RANGE'  TO PV-ABEND-PARAGRAPH.     11860003
118300                                                                  11870003
118400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11880003
118500     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               11890003
118600     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               11900003
118700     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               11910003
118800     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           11920003
118900     MOVE   PC-SEVEN           TO DPG51-INCR-DECR-DAYS-9.         11930003
119000                                                                  11940003
119100     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11950003
119200     SET DPG51-DECREMENT-DATE       TO TRUE.                      11960003
119300     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      11970003
119400                                                                  11980003
119500     PERFORM 9100-CALL-DATE-MODULE                                11990003
119600                                                                  12000003
119700     IF DPG54-DATE-VALID                                          12010003
119800         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO PV-START-EXTRACT      12020003
119900         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PV-END-EXTRACT        12030003
120000     ELSE                                                         12040003
120100         DISPLAY 'DPG55-1ST-WKDY-DB2ISO-FMT - '                   12050003
120200                  DPG55-1ST-WKDY-DB2ISO-FMT                       12060003
120300         DISPLAY 'DPG55-LAST-WKDY-DB2ISO-FMT - '                  12070003
120400                  DPG55-LAST-WKDY-DB2ISO-FMT                      12080003
120500     END-IF.                                                      12090003
120600                                                                  12100003
120700*--------------------------------------------------------------   12110003
120800*** GET START/END DATES OF THE PREVIOUS MONTH.                    12120003
120900*--------------------------------------------------------------   12130003
121000 1132-MONTHLY-RPT-DTE-RANGE.                                      12140003
121100     MOVE '1132-MONTHLY-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.     12150003
121200                                                                  12160003
121300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12170003
121400     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                12180003
121500     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                12190003
121600     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                12200003
121700     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            12210003
121800                                                                  12220003
121900     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9          12230003
122000                                                                  12240003
122100     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      12250003
122200     SET DPG51-DECREMENT-DATE       TO TRUE.                      12260003
122300     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      12270003
122400                                                                  12280003
122500     PERFORM 9100-CALL-DATE-MODULE                                12290003
122600                                                                  12300003
122700     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           12310003
122800                                  PV-START-EXTRACT                12320003
122900     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           12330003
123000                                  PV-END-EXTRACT.                 12340003
123100                                                                  12350003
123200*-------------------------------------------------------------    12360003
123300*** GET START/END DATES OF THE FISCAL PERIOD.                     12370003
123400*-------------------------------------------------------------    12380003
123500 1133-FISCAL-RPT-DTE-RANGE.                                       12390003
123600     MOVE '1133-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     12400003
123700                                                                  12410003
123800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12420003
123900     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               12430003
124000     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               12440003
124100     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               12450003
124200     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            12460003
124300                                                                  12470003
124400     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         12480003
124500                                                                  12490003
124600     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      12500003
124700     SET DPG51-DECREMENT-DATE       TO TRUE.                      12510003
124800     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      12520003
124900                                                                  12530003
125000     PERFORM 9100-CALL-DATE-MODULE                                12540003
125100                                                                  12550003
125200     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         12560003
125300         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12570003
125400                                  PV-START-EXTRACT                12580003
125500         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       12590003
125600                                  PV-END-EXTRACT                  12600003
125700     ELSE                                                         12610003
125800         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       12620003
125900                                  PV-START-EXTRACT                12630003
126000         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           12640003
126100         MOVE PC-ONE                   TO DPG51-INCR-DECR-DAYS-9  12650003
126200         MOVE PV-DATE-AREA             TO DPG52-LK-DATE-INPUT     12660003
126300         SET DPG51-FISCAL-454-CALENDAR TO TRUE                    12670003
126400         SET DPG51-DECREMENT-DATE      TO TRUE                    12680003
126500         SET DPG52-LK-DTE-GREG-FMT     TO TRUE                    12690003
126600         PERFORM 9100-CALL-DATE-MODULE                            12700003
126700         MOVE DPG55-DB2-ISO-DATE-FMT    TO  PV-END-EXTRACT        12710003
126800     END-IF.                                                      12720003
126900                                                                  12730003
127000*---------------------------------------------------------------- 12740003
127100*** GET START/END DATES OF THE CALENDAR PERIOD.                   12750003
127200*---------------------------------------------------------------- 12760003
127300 1134-CALENDAR-RPT-DTE-RANGE.                                     12770003
127400     MOVE '1134-CALENDAR-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    12780003
127500                                                                  12790003
127600     IF PV-CURRENT-MM = 1 THEN                                    12800003
127700****   IF JANUARY WANT TO CREATE REPORT FOR PREV. CALENDAR YEAR   12810003
127800         MOVE PV-CDD-ONEYR-CCYY         TO PV-START-EXTRACT-YYYY  12820003
127900                                           PV-END-EXTRACT-YYYY    12830003
128000         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   12840003
128100         MOVE  01      TO  PV-START-EXTRACT-MM                    12850003
128200         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   12860003
128300         MOVE  01      TO  PV-START-EXTRACT-DD                    12870003
128400         MOVE  '-'     TO  PV-END-EXTRACT-1ST                     12880003
128500         MOVE   12     TO  PV-END-EXTRACT-MM                      12890003
128600         MOVE  '-'     TO  PV-END-EXTRACT-2ND                     12900003
128700         MOVE   31     TO  PV-END-EXTRACT-DD                      12910003
128800     ELSE                                                         12920003
128900*        CURRENT MONTH > 01                                       12930003
129000*                          BEGINNING DATE = CURRENT YEAR, 01, 01  12940003
129100*                          ENDING DATE    = CURRENT DATE - 1      12950003
129200         MOVE PV-CURRENT-CCYY TO PV-START-EXTRACT-YYYY            12960003
129300         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   12970003
129400         MOVE  01      TO  PV-START-EXTRACT-MM                    12980003
129500         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   12990003
129600         MOVE  01      TO  PV-START-EXTRACT-DD                    13000003
129700                                                                  13010003
129800         MOVE PV-CURRENT-DB2-DATE-ONE TO PV-END-EXTRACT           13020003
129900     END-IF.                                                      13030003
130000                                                                  13040003
130100*-----------------------------------------------------------------13050003
130200* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             13060003
130300*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           13070003
130400* FROM PV-END-EXTRACT DATE.                                       13080003
130500*-----------------------------------------------------------------13090003
130600                                                                  13100003
130700     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     13110003
130800     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     13120003
130900     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     13130003
131000     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     13140003
131100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13150003
131200     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   13160003
131300     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  13170003
131400     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  13180003
131500     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  13190003
131600                                                                  13200003
131700     PERFORM 9100-CALL-DATE-MODULE.                               13210003
131800                                                                  13220003
131900*-------------------------------------------------------------    13230003
132000*** GET START/END DATES SEASONAL                                  13240003
132100*-------------------------------------------------------------    13250003
132200 1135-SEASONAL-RPT-DTE-RANGE.                                     13260003
132300     MOVE '1135-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    13270003
132400                                                                  13280003
132500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13290003
132600     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               13300003
132700     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               13310003
132800     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               13320003
132900     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           13330003
133000                                                                  13340003
133100     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         13350003
133200                                                                  13360003
133300     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      13370003
133400     SET DPG51-DECREMENT-DATE       TO TRUE.                      13380003
133500     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      13390003
133600                                                                  13400003
133700     PERFORM 9100-CALL-DATE-MODULE                                13410003
133800                                                                  13420003
133900     IF DPG56-FISCAL-PERIOD-NBR < 7                               13430003
134000        MOVE PC-SPRING TO PV-SEASON-DESC                          13440003
134100     ELSE                                                         13450003
134200        MOVE PC-FALL   TO PV-SEASON-DESC                          13460003
134300     END-IF.                                                      13470003
134400     IF DPG56-FISCAL-PERIOD-NBR < 6 THEN                          13480003
134500         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       13490003
134600                                  PV-START-EXTRACT                13500003
134700         MOVE PV-CURRENT-DB2-DATE-ONE TO                          13510003
134800                           PV-END-EXTRACT                         13520003
134900     END-IF.                                                      13530003
135000     IF DPG56-FISCAL-PERIOD-NBR = 6 THEN                          13540003
135100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       13550003
135200                                  PV-START-EXTRACT                13560003
135300         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       13570003
135400                                  PV-END-EXTRACT                  13580003
135500     END-IF.                                                      13590003
135600     IF DPG56-FISCAL-PERIOD-NBR = 7 THEN                          13600003
135700         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       13610003
135800                                  PV-START-EXTRACT                13620003
135900         MOVE PV-CURRENT-DB2-DATE-ONE TO                          13630003
136000                                  PV-END-EXTRACT                  13640003
136100     END-IF.                                                      13650003
136200     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          13660003
136300         MOVE PV-CURRENT-DB2-DATE-ONE TO                          13670003
136400                                  PV-END-EXTRACT                  13680003
136500     END-IF.                                                      13690003
136600     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         13700003
136700         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       13710003
136800                                  PV-END-EXTRACT                  13720003
136900     END-IF.                                                      13730003
137000     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          13740003
137100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT-YR                       13750009
137200                               TO  PV-YEAR-FORMAT                 13760003
137300         MOVE PV-YEAR-FORMAT-YY TO PV-DATE-AREA-YY                13770009
137400         MOVE 01               TO  PV-DATE-AREA-MM                13780009
137500         MOVE 01               TO  PV-DATE-AREA-DD                13790009
137600         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           13800003
137700         MOVE PV-DATE-AREA     TO  DPG52-LK-DATE-INPUT            13810009
137800         MOVE 220              TO DPG51-INCR-DECR-DAYS-9          13820003
137900         SET DPG51-FISCAL-454-CALENDAR  TO TRUE                   13830003
138000         SET DPG51-INCREMENT-DATE       TO TRUE                   13840003
138100         SET DPG52-LK-DTE-GREG-FMT      TO TRUE                   13850003
138200         PERFORM 9100-CALL-DATE-MODULE                            13860003
138300         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                       13870003
138400                                  PV-START-EXTRACT                13880003
138500     END-IF.                                                      13890003
138600                                                                  13900003
138700*-----------------------------------------------------------------13910003
138800* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             13920003
138900*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           13930003
139000* FROM PV-END-EXTRACT DATE.                                       13940003
139100*-----------------------------------------------------------------13950003
139200                                                                  13960003
139300     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     13970003
139400     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     13980003
139500     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     13990003
139600     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     14000003
139700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              14010003
139800     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   14020003
139900     MOVE  ZEROES                      TO  DPG51-INCR-DECR-DAYS-9.14030003
140000     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  14040003
140100     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  14050003
140200     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  14060003
140300                                                                  14070003
140400     PERFORM 9100-CALL-DATE-MODULE.                               14080003
140500                                                                  14090009
140600******************************************************************14100009
140700*  PRINT THE REPORT HEADINGS.                                    *14110009
140800******************************************************************14120009
140900 1200-PRINT-HEADINGS.                                             14130009
141000                                                                  14140009
141100     ADD 1  TO PV-PAGE-COUNT.                                     14150009
141200     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     14160009
141300                                                                  14170009
141400     WRITE OUTPUT-REC                                             14180009
141500       FROM DP132-STANDRD-HEADER-132-COLS                         14190009
141600         AFTER ADVANCING PAGE.                                    14200009
141700                                                                  14210009
141800     MOVE +1 TO PV-LINE-COUNT.                                    14220009
141900                                                                  14230009
142000     WRITE OUTPUT-REC                                             14240009
142100       FROM HEADING-LINE-1                                        14250009
142200         AFTER ADVANCING 2 LINES.                                 14260009
142300                                                                  14270009
142400     MOVE PV-DATE-START-MM   TO HL2-FROM-DATE-MM.                 14280009
142500     MOVE PV-DATE-START-DD   TO HL2-FROM-DATE-DD.                 14290009
142600     MOVE PV-DATE-START-CCYY TO HL2-FROM-DATE-YYYY.               14300009
142700     MOVE PV-DATE-END-MM     TO HL2-TO-DATE-MM.                   14310009
142800     MOVE PV-DATE-END-DD     TO HL2-TO-DATE-DD.                   14320009
142900     MOVE PV-DATE-END-CCYY   TO HL2-TO-DATE-YYYY.                 14330009
143000     WRITE OUTPUT-REC                                             14340009
143100       FROM HEADING-LINE-2                                        14350009
143200         AFTER ADVANCING 1 LINES.                                 14360009
143300                                                                  14370009
143400     MOVE PV-CURR-LOCN TO HL3-PROCESS-DC-NBR.                     14380009
143500     WRITE OUTPUT-REC                                             14390009
143600       FROM HEADING-LINE-3                                        14400009
143700         AFTER ADVANCING 2 LINES.                                 14410009
143800                                                                  14420009
143900     MOVE PV-CURR-VEND TO HL4-VEND-NAME.                          14430009
144000     WRITE OUTPUT-REC                                             14440009
144100       FROM HEADING-LINE-4                                        14450009
144200         AFTER ADVANCING 2 LINES.                                 14460009
144300                                                                  14470009
144400     WRITE OUTPUT-REC                                             14480045
144500       FROM HEADING-LINE-6                                        14490045
144600         AFTER ADVANCING 1 LINES.                                 14500045
144700                                                                  14510045
144800     WRITE OUTPUT-REC                                             14520009
144900       FROM HEADING-LINE-7                                        14530009
145000         AFTER ADVANCING 1 LINES.                                 14540009
145100                                                                  14550009
145200     WRITE OUTPUT-REC                                             14560009
145300       FROM HEADING-LINE-8                                        14570009
145400         AFTER ADVANCING 1 LINES.                                 14580009
145500                                                                  14590009
145600     PERFORM 1210-TYPE-HEADING.                                   14600045
145700                                                                  14610045
145800     WRITE OUTPUT-REC                                             14620045
145900       FROM BLANK-LINE                                            14630045
146000         AFTER ADVANCING 1 LINES.                                 14640045
146100                                                                  14650045
146200     MOVE +15 TO PV-LINE-COUNT.                                   14660009
146300                                                                  14670009
146400******************************************************************14680011
146500 1210-TYPE-HEADING.                                               14690011
146600                                                                  14700011
146700     MOVE PV-CURR-TYPE TO HL5-MISDIRECT-TYPE.                     14710011
146800                                                                  14720011
146900     IF PV-CURR-TYPE = '1'                                        14730011
147000         MOVE PC-MISDIRECT-DESC-1 TO HL5-MISDIRECT-DESC           14740011
147100     END-IF.                                                      14750011
147200     IF PV-CURR-TYPE = '2'                                        14760011
147300         MOVE PC-MISDIRECT-DESC-2 TO HL5-MISDIRECT-DESC           14770011
147400     END-IF.                                                      14780011
147500     IF PV-CURR-TYPE = '3'                                        14790011
147600         MOVE PC-MISDIRECT-DESC-3 TO HL5-MISDIRECT-DESC           14800011
147700     END-IF.                                                      14810011
147800     IF PV-CURR-TYPE = '4'                                        14820011
147900         MOVE PC-MISDIRECT-DESC-4 TO HL5-MISDIRECT-DESC           14830011
148000     END-IF.                                                      14840011
148100                                                                  14850011
148200     WRITE OUTPUT-REC                                             14860011
148300       FROM HEADING-LINE-5                                        14870011
148400         AFTER ADVANCING 2 LINES.                                 14880011
148500                                                                  14890011
148600******************************************************************14900009
148700*  PRINT A 'NO INPUT' REPORT LINE.                               *14910009
148800******************************************************************14920009
148900 1300-NO-DETAIL-LINE.                                             14930009
149000                                                                  14940009
149100     WRITE OUTPUT-REC                                             14950009
149200       FROM NO-DATA-TO-REPORT-LINE                                14960009
149300         AFTER ADVANCING 3 LINES.                                 14970009
149400                                                                  14980009
149500******************************************************************14990009
149600*  PRINT A 'END OF REPORT' REPORT LINE.                          *15000009
149700******************************************************************15010009
149800 1400-END-OF-RPT-LINE.                                            15020009
149900                                                                  15030009
150000*CHECK FOR OVERFLOW.                                              15040009
150100*    ADD 3 TO PV-LINE-COUNT.                                      15050053
150200*    IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         15060053
150300*        SET PS-NEW-PAGE TO TRUE                                  15070053
150400*        PERFORM 1200-PRINT-HEADINGS                              15080053
150500*    END-IF.                                                      15090053
150600                                                                  15100009
150700*PRINT LINE.                                                      15110009
150800     WRITE OUTPUT-REC                                             15120009
150900       FROM END-OF-REPORT-LINE                                    15130009
151000         AFTER ADVANCING 3 LINES.                                 15140009
151100                                                                  15150009
151200******************************************************************15160009
151300*  PRINT A BLANK REPORT LINE.                                    *15170009
151400******************************************************************15180009
151500 1500-PRINT-BLANK-LINE.                                           15190009
151600                                                                  15200009
151700*CHECK FOR OVERFLOW.                                              15210009
151800     ADD 1 TO PV-LINE-COUNT.                                      15220009
151900     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         15230009
152000         SET PS-NEW-PAGE TO TRUE                                  15240009
152100         PERFORM 1200-PRINT-HEADINGS                              15250009
152200     ELSE                                                         15260009
152300*PRINT LINE.                                                      15270009
152400         WRITE OUTPUT-REC                                         15280009
152500           FROM BLANK-LINE                                        15290009
152600             AFTER ADVANCING 1 LINES                              15300009
152700     END-IF.                                                      15310009
152800                                                                  15320009
152900******************************************************************15330009
153000*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR READING THE INPUT  *15340009
153100*  EXTRACT FILE (FORMAT SURD008) AND CREATING THE 'INTRA-COMPANY *15350009
153200*  MISDIRECTS FROM UCC128 SCAN RESULTS BY DC, VENDOR' REPORT.    *15360009
153300******************************************************************15370015
153400 2000-PROCESS-EXTRACT.                                            15380009
153500                                                                  15390003
153600*CHECK FOR BREAKS.                                                15400009
153700     IF SU008-SCN-OPER-UNT-ID NOT = PV-CURR-LOCN                  15410010
153800         PERFORM 2010-TYPE-BREAK                                  15420010
153900         PERFORM 2020-VEND-BREAK                                  15430010
154000         PERFORM 2030-LOCN-BREAK                                  15440010
154100         MOVE 0 TO PV-PAGE-COUNT                                  15450010
154200         MOVE SU008-MISDIRECT-TYPE  TO PV-CURR-TYPE               15460049
154300         MOVE SU008-VEND-NAME       TO PV-CURR-VEND               15470049
154400         MOVE SU008-SCN-OPER-UNT-ID TO PV-CURR-LOCN               15480015
154500         PERFORM 1200-PRINT-HEADINGS                              15490010
154600         MOVE SPACES TO PV-CURR-SCAC                              15510026
154700                        PV-CURR-VEH-NBR                           15520026
154800         MOVE ZEROES TO PV-CURR-PO-NBR                            15530026
154900                        PV-CURR-REC-SEQ-NBR                       15540026
155000     ELSE                                                         15550010
155100         IF SU008-VEND-NAME NOT = PV-CURR-VEND                    15560012
155200             PERFORM 2010-TYPE-BREAK                              15570010
155300             PERFORM 2020-VEND-BREAK                              15580010
155400             MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE            15590049
155500             MOVE SU008-VEND-NAME      TO PV-CURR-VEND            15600049
155600             PERFORM 1200-PRINT-HEADINGS                          15610010
155700             MOVE SPACES TO PV-CURR-SCAC                          15630026
155800                            PV-CURR-VEH-NBR                       15640026
155900             MOVE ZEROES TO PV-CURR-PO-NBR                        15650026
156000                            PV-CURR-REC-SEQ-NBR                   15660026
156100         ELSE                                                     15670010
156200             IF SU008-MISDIRECT-TYPE NOT = PV-CURR-TYPE           15680010
156300                 PERFORM 2010-TYPE-BREAK                          15690010
156400                 MOVE SU008-MISDIRECT-TYPE TO PV-CURR-TYPE        15700049
156500                 PERFORM 1210-TYPE-HEADING                        15710049
156600                 PERFORM 1500-PRINT-BLANK-LINE                    15720012
156700                 MOVE SPACES TO PV-CURR-SCAC                      15730026
156800                                PV-CURR-VEH-NBR                   15740026
156900                 MOVE ZEROES TO PV-CURR-PO-NBR                    15750026
157000                                PV-CURR-REC-SEQ-NBR               15760026
157100             END-IF                                               15770010
157200         END-IF                                                   15780010
157300     END-IF.                                                      15790010
157400                                                                  15800003
157500*PRINT DETAIL LINE.                                               15810009
157600     PERFORM 2100-PRINT-DETAIL.                                   15820009
157700     SET PS-FIRST-TIME-NO TO TRUE.                                15830009
157800     ADD +1 TO PV-REC-OUT-QTY.                                    15840009
157900                                                                  15850009
158000*READ NEXT INPUT RECORD.                                          15860009
158100     PERFORM 0100-READ-EXTRACT.                                   15870009
158200     IF NOT PS-END-OF-INPUT                                       15880009
158300         ADD +1 TO PV-REC-IN-QTY                                  15890025
158400     END-IF.                                                      15900009
158500                                                                  15910003
158600******************************************************************15920010
158700*  PRINT A REPORT SUB-TOTAL LINE (BY MISDIRECT TYPE).            *15930010
158800******************************************************************15940010
158900 2010-TYPE-BREAK.                                                 15950010
159000                                                                  15960010
159100*FILL NUMBER OF MISDIRECTS.                                       15970011
159200     MOVE PV-CURR-TYPE    TO TL1-MISDIRECT-TYPE.                  15980011
159300     MOVE PV-ACCUM-TYPE   TO PV-FORMAT-ACCUM.                     15990011
159400     MOVE PV-FORMAT-ACCUM TO TL1-TOTAL-TYPE.                      16000011
159500                                                                  16010011
159600*CHECK FOR OVERFLOW.                                              16020011
159700     ADD 2 TO PV-LINE-COUNT.                                      16030011
159800     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         16040011
159900         SET PS-NEW-PAGE TO TRUE                                  16050011
160000         PERFORM 1200-PRINT-HEADINGS                              16060011
160100     END-IF.                                                      16070011
160200                                                                  16080011
160300*WRITE TOTAL LINE.                                                16090011
160400     WRITE OUTPUT-REC                                             16100011
160500       FROM TOTAL-LINE-1                                          16110011
160600         AFTER ADVANCING 2 LINES.                                 16120011
160700                                                                  16130011
160800*RE-INITIALIZE ACCUMULATORS.                                      16140011
160900     MOVE ZEROES TO PV-ACCUM-TYPE.                                16150011
161000                                                                  16160011
161100******************************************************************16170010
161200*  PRINT A REPORT SUB-TOTAL LINE (BY VENDOR NAME).               *16180010
161300******************************************************************16190010
161400 2020-VEND-BREAK.                                                 16200010
161500                                                                  16210010
161600*FILL NUMBER OF MISDIRECTS.                                       16220010
161700     MOVE PV-ACCUM-VEND   TO PV-FORMAT-ACCUM.                     16230010
161800     MOVE PV-FORMAT-ACCUM TO TL2-TOTAL-VEND.                      16240010
161900                                                                  16250010
162000*CHECK FOR OVERFLOW.                                              16260010
162100     ADD 2 TO PV-LINE-COUNT.                                      16270011
162200     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         16280010
162300         SET PS-NEW-PAGE TO TRUE                                  16290010
162400         PERFORM 1200-PRINT-HEADINGS                              16300010
162500     END-IF.                                                      16310010
162600                                                                  16320010
162700*WRITE TOTAL LINE.                                                16330010
162800     WRITE OUTPUT-REC                                             16340010
162900       FROM TOTAL-LINE-2                                          16350010
163000         AFTER ADVANCING 2 LINES.                                 16360011
163100                                                                  16370010
163200*RE-INITIALIZE ACCUMULATORS.                                      16380010
163300     MOVE ZEROES TO PV-ACCUM-VEND.                                16390010
163400                                                                  16400010
163500******************************************************************16410010
163600*  PRINT A REPORT SUB-TOTAL LINE (BY DC LOCATION).               *16420010
163700******************************************************************16430010
163800 2030-LOCN-BREAK.                                                 16440010
163900                                                                  16450010
164000*FILL NUMBER OF MISDIRECTS.                                       16460010
164100     MOVE PV-ACCUM-LOCN      TO PV-FORMAT-FACILITY.               16470020
164200     MOVE PV-FORMAT-FACILITY TO TL3-TOTAL-LOCN.                   16480020
164300                                                                  16490010
164400*CHECK FOR OVERFLOW.                                              16500010
164500     ADD 2 TO PV-LINE-COUNT.                                      16510015
164600     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         16520010
164700         SET PS-NEW-PAGE TO TRUE                                  16530010
164800         PERFORM 1200-PRINT-HEADINGS                              16540010
164900     END-IF.                                                      16550010
165000                                                                  16560010
165100*WRITE TOTAL LINE.                                                16570010
165200     WRITE OUTPUT-REC                                             16580010
165300       FROM TOTAL-LINE-3                                          16590010
165400         AFTER ADVANCING 2 LINES.                                 16600015
165500                                                                  16610010
165600*RE-INITIALIZE ACCUMULATORS.                                      16620010
165700     MOVE ZEROES TO PV-ACCUM-LOCN.                                16630010
165800                                                                  16640010
165900******************************************************************16650009
166000*  FILL AND DETAIL REPORT LINE.                                  *16660009
166100******************************************************************16670010
166200 2100-PRINT-DETAIL.                                               16680009
166300                                                                  16690009
166400*FILL SCAC.                                                       16700010
166500     IF (SU008-SCAC-CDE = PV-CURR-SCAC)                           16710010
166600       AND (SU008-VEH-NBR  = PV-CURR-VEH-NBR)                     16720010
166700         MOVE SPACES             TO DL1-SCAC                      16730010
166800     ELSE                                                         16740010
166900         MOVE SU008-SCAC-CDE     TO DL1-SCAC                      16750010
167000                                    PV-CURR-SCAC                  16760010
167100         MOVE ZEROES             TO PV-CURR-PO-NBR                16770035
167200                                    PV-CURR-REC-SEQ-NBR           16780035
167300     END-IF.                                                      16790010
167400*FILL TRAILER.                                                    16800010
167500     IF (SU008-VEH-NBR  = PV-CURR-VEH-NBR)                        16810035
167600         MOVE SPACES             TO DL1-TRAILER                   16820010
167700     ELSE                                                         16830010
167800         MOVE SU008-VEH-NBR      TO DL1-TRAILER                   16840010
167900                                    PV-CURR-VEH-NBR               16850010
168000     END-IF.                                                      16860010
168100*FILL PO/RECEIVER.                                                16870010
168200     IF (SU008-PO-NBR = PV-CURR-PO-NBR)                           16880010
168300       AND (SU008-REC-SEQ-NBR = PV-CURR-REC-SEQ-NBR)              16890010
168400         MOVE SPACES             TO DL1-PO-RCVR                   16900010
168500     ELSE                                                         16910010
168600         MOVE SU008-PO-NBR       TO PV-FORMAT-PO-NBR              16920012
168700                                    PV-CURR-PO-NBR                16930010
168800         MOVE SU008-REC-SEQ-NBR  TO PV-FORMAT-REC-SEQ             16940010
168900                                    PV-CURR-REC-SEQ-NBR           16950010
169000         MOVE PV-FORMAT-PO       TO DL1-PO-RCVR                   16960010
169100     END-IF.                                                      16970010
169200*FILL DEST STORE.                                                 16980010
169300     MOVE SU008-DEST-OPER-UNT-ID TO DL1-DEST-STR.                 16990010
169400     MOVE SU008-PROCESS-DC-NBR   TO DL1-PRCS-DC.                  16991066
169500*FILL SERIAL SHIP CODE.                                           17000010
169600     MOVE SU008-SHIPT-UNT-ID     TO DL1-SERIAL-SHIP-CODE.         17010010
169700*FILL SCAN DATE.                                                  17020010
169800     MOVE SU008-SCN-DATE         TO PV-INPUT-DATE.                17030010
169900     MOVE PV-INPUT-DATE-YY       TO PV-FORMAT-DATE-YY             17040010
170000     MOVE PV-INPUT-DATE-MM       TO PV-FORMAT-DATE-MM             17050010
170100     MOVE PV-INPUT-DATE-DD       TO PV-FORMAT-DATE-DD             17060010
170200     MOVE PV-FORMAT-DATE         TO DL1-SCAN-DATE.                17070010
170300*FILL SCAN TIME.                                                  17080010
170400     MOVE SU008-SCN-TIME         TO PV-INPUT-TIME.                17090010
170500     MOVE PV-INPUT-TIME-HH       TO PV-FORMAT-TIME-HH.            17100010
170600     MOVE PV-INPUT-TIME-MM       TO PV-FORMAT-TIME-MM.            17110010
170700     MOVE PV-FORMAT-TIME         TO DL1-SCAN-TIME.                17120010
170800*FILL SCAN USER ID.                                               17130010
170900     MOVE SU008-SCN-USR-ID       TO DL1-SCAN-USERID.              17140010
171000*FILL ASN NUMBER.                                                 17150010
171100     MOVE SU008-ASN-NBR          TO DL1-ASN-NUMBER.               17160014
171200*FILL ASN DATE.                                                   17170010
171300     MOVE SU008-ASN-CRE-DATE     TO PV-INPUT-DATE.                17180010
171400     MOVE PV-INPUT-DATE-YY       TO PV-FORMAT-DATE-YY             17190010
171500     MOVE PV-INPUT-DATE-MM       TO PV-FORMAT-DATE-MM             17200010
171600     MOVE PV-INPUT-DATE-DD       TO PV-FORMAT-DATE-DD             17210010
171700     MOVE PV-FORMAT-DATE         TO DL1-ASN-DATE.                 17220010
171800*FILL ASN TIME.                                                   17230010
171900     MOVE SU008-ASN-CRE-TIME     TO PV-INPUT-TIME.                17240010
172000     MOVE PV-INPUT-TIME-HH       TO PV-FORMAT-TIME-HH.            17250010
172100     MOVE PV-INPUT-TIME-MM       TO PV-FORMAT-TIME-MM.            17260010
172200     MOVE PV-FORMAT-TIME         TO DL1-ASN-TIME.                 17270010
172300*FILL ASN RECEIVING OPERATOR.                                     17280010
172400     MOVE SU008-ORGN-OPER-UNT-ID TO DL1-RCVG-OPER.                17290010
172500                                                                  17300010
172600*ACCUMULATE QUANTITY FIELDS.                                      17310009
172700     ADD +1                     TO PV-ACCUM-TYPE                  17320010
172800                                   PV-ACCUM-VEND                  17330010
172900                                   PV-ACCUM-LOCN.                 17340037
173000     PERFORM 2200-SUMMARY-ACCUM.                                  17350034
173100     IF PS-END-OF-TABLE                                           17360034
173200         DISPLAY ' ***************************************'       17370034
173300         DISPLAY ' *** WARNING *** WARNING *** WARNING ***'       17380034
173400         DISPLAY '  RECEIVING LOCATION ' PV-CURR-LOCN             17390034
173500                 ' NOT A VALID DC NUMBER!!!'                      17400034
173600         DISPLAY ' ***************************************'       17410034
173700     END-IF.                                                      17420034
173800                                                                  17430009
173900*CHECK FOR OVERFLOW.                                              17440009
174000     ADD 1 TO PV-LINE-COUNT.                                      17450009
174100     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         17460009
174200         SET PS-NEW-PAGE TO TRUE                                  17470009
174300         PERFORM 1200-PRINT-HEADINGS                              17480009
174400     END-IF.                                                      17490009
174500                                                                  17500009
174600*IF NEW PAGE, DISPLAY SCAC, TRAILER & PO# ON FIRST LINE.          17510045
174700     IF PS-NEW-PAGE                                               17520045
174800         MOVE SU008-SCAC-CDE     TO DL1-SCAC                      17530045
174900         MOVE SU008-VEH-NBR      TO DL1-TRAILER                   17540045
175000         MOVE SU008-PO-NBR       TO PV-FORMAT-PO-NBR              17550045
175100         MOVE SU008-REC-SEQ-NBR  TO PV-FORMAT-REC-SEQ             17560045
175200         MOVE PV-FORMAT-PO       TO DL1-PO-RCVR                   17570045
175300         SET PS-SAME-PAGE        TO TRUE                          17580045
175400     END-IF.                                                      17590045
175500                                                                  17600045
175600*WRITE DETAIL LINE.                                               17610009
175700     WRITE OUTPUT-REC                                             17620009
175800       FROM DETAIL-LINE-1                                         17630009
175900         AFTER ADVANCING 1 LINES.                                 17640009
176000                                                                  17650009
176100*SET SWITCH FOR IDENTIFYING DATA PRESENT FOR MISDIRECT TYPE.      17660015
176200     SET PS-TYPE-DATA-YES TO TRUE.                                17670011
176300                                                                  17680003
176400******************************************************************17690034
176500 2200-SUMMARY-ACCUM.                                              17700034
176600                                                                  17710034
176700     SET CS-IDX TO 1.                                             17720034
176800                                                                  17730034
176900     SEARCH SUMMARY-TABLE                                         17740034
177000       VARYING CS-IDX                                             17750034
177100         AT END SET PS-END-OF-TABLE TO TRUE                       17760034
177200                                                                  17770034
177300                                                                  17780035
177400         WHEN SUMMARY-LOCN-NBR (CS-IDX) = PV-CURR-LOCN            17790035
177500             IF PV-CURR-TYPE = '1'                                17800034
177600                 ADD +1 TO SUMMARY-TYPE-1 (CS-IDX)                17810034
177700                           PV-ACCUM-T1                            17820036
177800             END-IF                                               17830034
177900             IF PV-CURR-TYPE = '2'                                17840034
178000                 ADD +1 TO SUMMARY-TYPE-2 (CS-IDX)                17850034
178100                           PV-ACCUM-T2                            17860036
178200             END-IF                                               17870034
178300             IF PV-CURR-TYPE = '3'                                17880034
178400                 ADD +1 TO SUMMARY-TYPE-3 (CS-IDX)                17890034
178500                           PV-ACCUM-T3                            17900036
178600             END-IF                                               17910034
178700             IF PV-CURR-TYPE = '4'                                17920034
178800                 ADD +1 TO SUMMARY-TYPE-4 (CS-IDX)                17930034
178900                           PV-ACCUM-T4                            17940036
179000             END-IF                                               17950034
179100             IF PV-CURR-TYPE = '5'                                17960041
179200                 ADD +1 TO SUMMARY-TYPE-5 (CS-IDX)                17970041
179300                           PV-ACCUM-T5                            17980041
179400             END-IF                                               17990041
179500             ADD +1 TO SUMMARY-TOTAL (CS-IDX)                     18000034
179600                       PV-ACCUM-TOTL                              18010036
179700                                                                  18020034
179800     END-SEARCH.                                                  18030034
179900                                                                  18040034
180000******************************************************************18050030
180100*  PRINT CORPORATE SUMMARY PAGE                                  *18060030
180200******************************************************************18070030
180300 3000-PRINT-SUMMARY.                                              18080030
180400                                                                  18090030
180500     MOVE 1 TO PV-PAGE-COUNT.                                     18100030
180600     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     18110030
180700                                                                  18120030
180800     WRITE OUTPUT-REC                                             18130030
180900       FROM DP132-STANDRD-HEADER-132-COLS                         18140030
181000         AFTER ADVANCING PAGE.                                    18150030
181100                                                                  18160030
181200     WRITE OUTPUT-REC                                             18170030
181300       FROM HEADING-LINE-1                                        18180030
181400         AFTER ADVANCING 2 LINES.                                 18190030
181500                                                                  18200030
181600     MOVE PV-DATE-START-MM   TO HL2-FROM-DATE-MM.                 18210030
181700     MOVE PV-DATE-START-DD   TO HL2-FROM-DATE-DD.                 18220030
181800     MOVE PV-DATE-START-CCYY TO HL2-FROM-DATE-YYYY.               18230030
181900     MOVE PV-DATE-END-MM     TO HL2-TO-DATE-MM.                   18240030
182000     MOVE PV-DATE-END-DD     TO HL2-TO-DATE-DD.                   18250030
182100     MOVE PV-DATE-END-CCYY   TO HL2-TO-DATE-YYYY.                 18260030
182200     WRITE OUTPUT-REC                                             18270030
182300       FROM HEADING-LINE-2                                        18280030
182400         AFTER ADVANCING 1 LINES.                                 18290030
182500                                                                  18300030
182600     WRITE OUTPUT-REC                                             18310030
182700       FROM HEADING-LINE-3-CS                                     18320030
182800         AFTER ADVANCING 2 LINES.                                 18330030
182900                                                                  18340030
183000*PRINT MISDIRECT TYPE DESCRIPTIONS.                               18350038
183100     MOVE '1' TO HL5-MISDIRECT-TYPE.                              18360038
183200     MOVE PC-MISDIRECT-DESC-1 TO HL5-MISDIRECT-DESC.              18370038
183300     WRITE OUTPUT-REC                                             18380038
183400       FROM HEADING-LINE-5                                        18390038
183500         AFTER ADVANCING 3 LINES.                                 18400038
183600                                                                  18410038
183700     MOVE '2' TO HL5-MISDIRECT-TYPE.                              18420038
183800     MOVE PC-MISDIRECT-DESC-2 TO HL5-MISDIRECT-DESC.              18430038
183900     WRITE OUTPUT-REC                                             18440038
184000       FROM HEADING-LINE-5                                        18450038
184100         AFTER ADVANCING 2 LINES.                                 18460038
184200                                                                  18470038
184300     MOVE '3' TO HL5-MISDIRECT-TYPE.                              18480038
184400     MOVE PC-MISDIRECT-DESC-3 TO HL5-MISDIRECT-DESC.              18490038
184500     WRITE OUTPUT-REC                                             18500038
184600       FROM HEADING-LINE-5                                        18510038
184700         AFTER ADVANCING 2 LINES.                                 18520038
184800                                                                  18530038
184900     MOVE '4' TO HL5-MISDIRECT-TYPE.                              18540038
185000     MOVE PC-MISDIRECT-DESC-4 TO HL5-MISDIRECT-DESC.              18550038
185100     WRITE OUTPUT-REC                                             18560038
185200       FROM HEADING-LINE-5                                        18570038
185300         AFTER ADVANCING 2 LINES.                                 18580038
185400                                                                  18590038
185500***  MOVE '5' TO HL5-MISDIRECT-TYPE.                              18600041
185600***  MOVE PC-MISDIRECT-DESC-5 TO HL5-MISDIRECT-DESC.              18610041
185700***  WRITE OUTPUT-REC                                             18620041
185800***    FROM HEADING-LINE-5                                        18630041
185900***      AFTER ADVANCING 2 LINES.                                 18640041
186000                                                                  18650038
186100*PRINT DC LOCATION/TYPE HEADINGS.                                 18660038
186200     WRITE OUTPUT-REC                                             18670030
186300       FROM HEADING-LINE-4-CS                                     18680030
186400         AFTER ADVANCING 3 LINES.                                 18690033
186500                                                                  18700030
186600     WRITE OUTPUT-REC                                             18710030
186700       FROM HEADING-LINE-5-CS                                     18720030
186800         AFTER ADVANCING 1 LINES.                                 18730030
186900                                                                  18740030
187000     WRITE OUTPUT-REC                                             18750030
187100       FROM BLANK-LINE                                            18760030
187200         AFTER ADVANCING 1 LINES.                                 18770030
187300                                                                  18780030
187400*PRINT CORPORATE SUMMARY DETAIL (BY DC).                          18790038
187500     PERFORM VARYING CS-IDX FROM 1 BY 1                           18800030
187600       UNTIL SUMMARY-LOCN-NBR (CS-IDX) = ZEROS                    18810035
187700                                                                  18820030
187800         MOVE SUMMARY-LOCN-NBR (CS-IDX)   TO PV-FORMAT-QTY-4      18830051
187900         MOVE PV-FORMAT-QTY-4             TO CS-LOCN-NBR          18831051
188000         MOVE SUMMARY-LOCN-NAME (CS-IDX)  TO CS-LOCN-NAME         18840035
188100         MOVE SUMMARY-TYPE-1 (CS-IDX)     TO PV-FORMAT-QTY        18850030
188200         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-1       18860030
188300         MOVE SUMMARY-TYPE-2 (CS-IDX)     TO PV-FORMAT-QTY        18870030
188400         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-2       18880030
188500         MOVE SUMMARY-TYPE-3 (CS-IDX)     TO PV-FORMAT-QTY        18890030
188600         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-3       18900030
188700         MOVE SUMMARY-TYPE-4 (CS-IDX)     TO PV-FORMAT-QTY        18910030
188800         MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-4       18920030
188900***      MOVE SUMMARY-TYPE-5 (CS-IDX)     TO PV-FORMAT-QTY        18930041
189000***      MOVE PV-FORMAT-QTY               TO CS-LOCN-TYPE-5       18940041
189100         MOVE SUMMARY-TOTAL (CS-IDX)      TO PV-FORMAT-QTY        18950030
189200         MOVE PV-FORMAT-QTY               TO CS-LOCN-TOTAL        18960030
189300                                                                  18970030
189400         WRITE OUTPUT-REC                                         18980030
189500           FROM DETAIL-LINE-1-CS                                  18990030
189600             AFTER ADVANCING 1 LINES                              19000030
189700     END-PERFORM.                                                 19010030
189800                                                                  19020030
189900*BLANK LINES.                                                     19030030
190000     WRITE OUTPUT-REC                                             19040030
190100       FROM BLANK-LINE                                            19050030
190200         AFTER ADVANCING 5 LINES.                                 19060030
190300                                                                  19070030
190400*PRINT CORPORATE SUMMARY TOTALS.                                  19080038
190500     MOVE PV-ACCUM-T1   TO CS-TOTL-TYPE-1.                        19090036
190600     MOVE PV-ACCUM-T2   TO CS-TOTL-TYPE-2.                        19100036
190700     MOVE PV-ACCUM-T3   TO CS-TOTL-TYPE-3.                        19110036
190800     MOVE PV-ACCUM-T4   TO CS-TOTL-TYPE-4.                        19120036
190900***  MOVE PV-ACCUM-T5   TO CS-TOTL-TYPE-5.                        19130041
191000     MOVE PV-ACCUM-TOTL TO CS-TOTL-TOTAL.                         19140036
191100     WRITE OUTPUT-REC                                             19150030
191200       FROM TOTAL-LINE-1-CS                                       19160030
191300         AFTER ADVANCING 1 LINES.                                 19170030
191400                                                                  19180030
191500******************************************************************19190003
191600******************************************************************19200011
191700 9100-CALL-DATE-MODULE.                                           19210003
191800     MOVE '9100-CALL-DATE-MODULE   ' TO PV-ABEND-PARAGRAPH.       19220003
191900                                                                  19230003
192000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            19240003
192100                           USING DPG51 DPG52 DPG53                19250003
192200                                 DPG54 DPG55 DPG56.               19260003
192300     EVALUATE TRUE                                                19270003
192400       WHEN DPG54-SEVERE-ERROR                                    19280003
192500           DISPLAY '** ABEND **'                                  19290003
192600           DISPLAY '** PGM = SUKRP020'                            19300040
192700           DISPLAY PV-ABEND-PARAGRAPH                             19310003
192800           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '    19320003
192900           DISPLAY '** ERROR MESSAGE = '                          19330003
193000                   DPG54-ERROR-MESSAGE                            19340003
193100           DISPLAY '** DPG51 = ' DPG51                            19350003
193200           DISPLAY '** DPG52 = ' DPG52                            19360003
193300           DISPLAY '** DPG53 = ' DPG53                            19370003
193400           DISPLAY '** DPG54 = ' DPG54                            19380003
193500           MOVE +4003 TO PV-ABEND-CODE                            19390003
193600           CALL 'ILBOABN0' USING PV-ABEND-CODE                    19400003
193700       WHEN OTHER                                                 19410003
193800           CONTINUE                                               19420003
193900     END-EVALUATE.                                                19430003
194000                                                                  19440003
194100******************************************************************19450006
194200*  ABEND ROUTINE                                                 *19460006
194300******************************************************************19470006
194400 9900-DB2-ABEND.                                                  19480006
194500                                                                  19490006
194600     MOVE SQLCODE TO PV-SQLCODE.                                  19500006
194700     DISPLAY '*** DB2 ERROR '.                                    19510006
194800     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       19520006
194900     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 19530006
195000     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               19540006
195100     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               19550006
195200     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       19560006
195300     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       19570006
195400     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             19580006
195500                                                                  19590006
195600     COPY DPPD004.                                                19600029
195700                                                                  19610029
195800     MOVE +4013 TO PV-ABEND-CODE.                                 19620029
195900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         19630029
196000                                                                  19640029
196100******************************************************************19650029
196200******************************************************************19660029
