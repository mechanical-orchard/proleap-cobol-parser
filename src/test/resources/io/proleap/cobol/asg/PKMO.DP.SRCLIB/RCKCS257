000100 IDENTIFICATION DIVISION.                                         00010067
000200 PROGRAM-ID.    RCKCS257.                                         00020067
000300 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00030067
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040067
000500 DATE-WRITTEN.  02/25/96.                                         00050067
000600 DATE-COMPILED.                                                   00060067
000700                                                                  00070067
000800*---------------------------------------------------------------* 00080067
000900*    TRANID      - E257                                         * 00090067
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100067
001100*    DESCRIPTION - ADD A RECEIPT ITEM                           * 00110067
001200*    MAPSET      - RCKM257                                      * 00120067
001300*                                                               * 00130067
001400*    THIS PROGRAM ALLOWS THE USER TO ADD A NEW ROW TO THE       * 00140067
001500*    RECITM TABLE.  THE USER ENTERS THIS PROGRAM FROM THE       * 00150067
001600*    RECEIPT ITEM ADD LIST PROGRAM (RCKCS256).                  * 00160067
001700*                                                               * 00170067
001800*---------------------------------------------------------------* 00180067
001810*---------------------------------------------------------------* 00181099
001820* CHANGE HISTORY                                                * 00182099
001830*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00183099
001840*     DATE:    10/20/2014                                       * 00184099
001850*                                                               * 00185099
001860*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# * 00186099
001870*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/20/2014    * 00187099
001880*---------------------------------------------------------------* 00188099
001891* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00189199
001892* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00189299
001893* MAKING THE CALL DYNAMIC VS STATIC.                              00189399
001894*---------------------------------------------------------------* 00189499
001900                                                                  00190067
002000 ENVIRONMENT DIVISION.                                            00200067
002100 DATA DIVISION.                                                   00210067
002200                                                                  00220067
002300 WORKING-STORAGE SECTION.                                         00230067
002400                                                                  00240067
002500 01  DK-DB2-KEYS.                                                 00250067
002600     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00260067
002700     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00270067
002800     05  DK-PO-LNE-NBR                PIC S9(9) COMP VALUE +0.    00280067
002900     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    00290067
003000     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    00300067
003100     05  DK-DEPT-NBR                  PIC X(03) VALUE SPACES.     00310067
003200     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    00320067
003300     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   00330067
003400     05  DK-MERCH-DEPT-NMBR           PIC X(03) VALUE SPACE.      00340067
003500     05  DK-MERCH-CLASS-NMBR          PIC X(03) VALUE SPACE.      00350067
003600     05  DK-TICKET-DESC               PIC X(20) VALUE SPACE.      00360067
003700     05  DK-ENT-ID                    PIC S9(9) COMP VALUE +0.    00370067
003800     05  DK-MDSEAR-ID                 PIC S9(9) COMP VALUE +0.    00380067
003900     05  DK-CHARTC-SEQ-NBR            PIC S9(4) COMP VALUE +0.    00390067
004000     05  DK-TKT-TYP-SEQ-NBR           PIC S9(4) COMP VALUE +0.    00400067
004100                                                                  00410067
004200 01  PC-PROGRAM-CONSTANTS.                                        00420067
004300     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E257'.    00430067
004400     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS257'.00440067
004500     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC257A  '.00450067
004600     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM257 '.00460067
004700     05  PC-LINE-TROUBLE-RTN          PIC X(08)  VALUE 'TMKCS520'.00470067
004800     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00480096
005000     05  PC-LINE-TROUBLE-RTN-LENGTH   PIC S9(04) VALUE +600       00500098
005100                                                 COMP.            00510067
005200     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00520067
005300                                                 COMP.            00530067
005400     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00540067
005500                                                 COMP.            00550067
005600     05  PC-DEFAULT-TMST              PIC  X(26) VALUE            00560067
005700                             '9999-09-09-09.09.09.999999'.        00570067
005800     05  PC-DEFAULT-DATE              PIC X(10) VALUE             00580067
005900                                                '9999-09-09'.     00590067
006000     05  PC-LONG-ZERO                 PIC S9(9) VALUE +0          00600067
006100                                                COMP.             00610067
006200     05  PC-1                         PIC S9(09) VALUE +1         00620067
006300                                                 COMP.            00630067
006400     05  PC-DWNLD-CDE                   PIC  X(06) VALUE 'ASNDWN'.00640096
006600     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       00660067
006700     05  PC-INACTIVE                  PIC X(01)  VALUE 'I'.       00670067
006800     05  PC-A                         PIC X(01)  VALUE 'A'.       00680067
006900     05  PC-RC                        PIC X(02)  VALUE 'RC'.      00690096
007000     05  PC-L                         PIC X(01)  VALUE 'L'.       00700067
007100     05  PC-R                         PIC X(01)  VALUE 'R'.       00710067
007200     05  PC-T                         PIC X(01)  VALUE 'T'.       00720067
007300     05  PC-Y                         PIC X(01)  VALUE 'Y'.       00730067
007400     05  PC-AC                        PIC X(02)  VALUE 'AC'.      00740067
007500     05  PC-CM                        PIC X(02)  VALUE 'CM'.      00750067
007600     05  PC-VE                        PIC X(02)  VALUE 'VE'.      00760067
007700     05  PC-IN                        PIC X(02)  VALUE 'IN'.      00770067
007800     05  PC-IP                        PIC X(02)  VALUE 'IP'.      00780067
007900     05  PC-01                        PIC X(02)  VALUE '01'.      00790067
008000     05  PC-DPKUT500                  PIC X(08)  VALUE 'DPKUT500'.00800067
008100     05  PC-INTER-APPL-CODES.                                     00810067
008200         10  PC-INTER-APPL-RCVG       PIC X(01)  VALUE '1'.       00820067
008300     05  PC-DASH                      PIC X(01)  VALUE '-'.       00830067
008400     05  PC-999                       PIC 9(04)  VALUE 999.       00840067
008500     05  PC-000                       PIC 9(04)  VALUE ZEROES.    00850067
008600     05  PC-1000                      PIC 9(04)  VALUE 1000.      00860067
008700     05  PC-8999                      PIC 9(04)  VALUE 8999.      00870067
008800     05  PC-9000                      PIC 9(04)  VALUE 9000.      00880067
008900     05  PC-MULTIPLE-MSG              PIC X(25)  VALUE            00890067
009000         'MULTIPLE TROUBLE EXISTS  '.                             00900067
009100     05  PC-SUBCLASS-MDSELV-CDE      PIC X(03) VALUE 'SCL'.       00910067
009200     05  PC-MAJCLASS-MDSELV-CDE      PIC X(03) VALUE 'MCL'.       00920067
009300     05  PC-DPT-MDSELV-CDE           PIC X(03) VALUE 'DPT'.       00930067
009400     05  PC-VS-TICKET-TYPE-CDE       PIC S9(04) COMP              00940067
009500                                                VALUE +2.         00950067
009600     05  PC-CURRENT-DATE              PIC X(10) VALUE SPACE.      00960067
009700                                                                  00970067
009800     05  PC-TSYMSG-NUMBERS.                                       00980067
009900         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00990067
010000*            INVALID VALUE                                        01000067
010100         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     01010067
010200*            REQUIRED ENTRY                                       01020067
010300         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     01030067
010400*            MUST BE NUMERIC                                      01040067
010500         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01050067
010600*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01060067
010700         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01070067
010800*            UPDATE(S) SUCCESSFUL                                 01080067
010900         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01090067
011000*            TOP OF LIST                                          01100067
011100         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01110067
011200*            BOTTOM OF LIST                                       01120067
011300         10  PC-TSYMSG-00084          PIC 9(05)  VALUE 00084.     01130067
011400*            PURCHASE ORDER LINE DOES NOT EXIST                   01140067
011500         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     01150067
011600*            CANNOT ADD - RECORD ALREADY EXISTS                   01160067
011700         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01170067
011800*            DATA DOES NOT EXIST                                  01180067
011900         10  PC-TSYMSG-00342          PIC 9(05)  VALUE 00342.     01190067
012000*            MUST BE NUMERIC AND > ZERO                           01200067
012100         10  PC-TSYMSG-00551          PIC 9(05)  VALUE 00551.     01210067
012200*            DB2 TIMEOUT.  TRY AFTER SOMETIME                     01220067
012300         10  PC-TSYMSG-00808          PIC 9(05)  VALUE 00808.     01230067
012400*            PURCHASE ORDER LINE STATUS MUST BE ACTIVE OR APPROVED01240067
012500         10  PC-TSYMSG-00790          PIC 9(05)  VALUE 00790.     01250067
012600*            TRANSCRIPTION COMPLETE -&VAR LINES IN TROUBLE        01260067
012700         10  PC-TSYMSG-01002          PIC 9(05)  VALUE 01002.     01270067
012800* TRANSCRIPTION COMPLETE -&VAR LINES IN TROUBLE;PO TROUBLE EXISTS 01280067
012900         10  PC-TSYMSG-01293          PIC 9(05)  VALUE 01293.     01290067
013000*            LINE ADDED                                           01300067
013100         10  PC-TSYMSG-03535             PIC  9(05)  VALUE 03535. 01310097
013200*TRIP DOWNLOADED TO WMS - ONLY TRANSCRIBED RECEIVERS INCLUDED     01320099
013300         10  PC-TSYMSG-03536             PIC  9(05)  VALUE 03536. 01330097
013400*TRAILER DOES NOT CONTAIN TRANSCRIBED RECEIVERS - NOTHING         01340099
013401*DOWNLOADED TO WMS                                                01340199
013410         10  PC-TSYMSG-03546             PIC  9(05)  VALUE 03536. 01341099
013411*ERROR IN WMS DOWNLOAD MODULE - CONTACT HELP DESK                 01341199
013420                                                                  01342099
013500 01  PS-PROGRAM-SWITCHES.                                         01350067
013600     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01360067
013700         88  PS-ERROR                            VALUE 'Y'.       01370067
013800         88  PS-NO-ERROR                         VALUE 'N'.       01380067
013900     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X     VALUE 'N'.       01390079
014000         88  PS-ORIG-ASN-PKSLIP-YES              VALUE 'Y'.       01400079
014100         88  PS-ORIG-ASN-PKSLIP-NO               VALUE 'N'.       01410079
014200     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01420067
014300         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01430067
014400         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01440067
014500     05  PS-PKITEM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01450067
014600         88  PS-PKITEM-FOUND                     VALUE 'Y'.       01460067
014700         88  PS-PKITEM-NOT-FOUND                 VALUE 'N'.       01470067
014800         88  PS-MULTI-PKITEM-FOUND               VALUE 'M'.       01480067
014900     05  PS-PURITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01490067
015000         88  PS-PURITM-FOUND                     VALUE 'Y'.       01500067
015100         88  PS-PURITM-NOT-FOUND                 VALUE 'N'.       01510067
015200     05  PS-UNPKSL-EXISTS-SW          PIC X(01)  VALUE 'N'.       01520067
015300         88  PS-UNPKSL-FOUND                     VALUE 'Y'.       01530067
015400         88  PS-UNPKSL-NOT-FOUND                 VALUE 'N'.       01540067
015500     05  PS-RECITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01550067
015600         88  PS-RECITM-FOUND                     VALUE 'Y'.       01560067
015700         88  PS-RECITM-NOT-FOUND                 VALUE 'N'.       01570067
015800     05  PS-RTV-QTY-ERROR-SW          PIC X(01)  VALUE 'N'.       01580067
015900         88  PS-RTV-QTY-ERROR                    VALUE 'Y'.       01590067
016000         88  PS-NO-RTV-QTY-ERROR                 VALUE 'N'.       01600067
016100     05  PS-PREV-UPDATE-SW            PIC X(01)  VALUE 'N'.       01610067
016200         88  PS-PREV-UPDATE                      VALUE 'Y'.       01620067
016300         88  PS-NO-PREV-UPDATE                   VALUE 'N'.       01630067
016400     05  PS-LIST-SW                   PIC X(01)  VALUE 'N'.       01640067
016500         88  PS-LIST-END                         VALUE 'Y'.       01650067
016600         88  PS-NO-LIST-END                      VALUE 'N'.       01660067
016700     05  PS-REDISTRO-SW               PIC X(01)  VALUE 'N'.       01670067
016800         88  PS-REDISTRO-OK                      VALUE 'Y'.       01680067
016900         88  PS-REDISTRO-NOT-OK                  VALUE 'N'.       01690067
017000     05  PS-INACTIVE-EXISTS-SW        PIC X(01)  VALUE 'N'.       01700067
017100         88  PS-INACTIVE-EXISTS                  VALUE 'Y'.       01710067
017200     05  PS-PRETICKET-SW              PIC X      VALUE 'N'.       01720067
017300         88  PS-NOT-PRETICKET                    VALUE 'N'.       01730067
017400         88  PS-PRETICKET                        VALUE 'Y'.       01740067
017500     05  PS-VSM-SW                    PIC X      VALUE 'N'.       01750067
017600         88  PS-NOT-VSM                          VALUE 'N'.       01760067
017700         88  PS-VSM                              VALUE 'Y'.       01770067
017800     05  PS-DWNLD-TO-WMS-SW            PIC  X(01)    VALUE 'N'.   01780097
017900         88  PS-DWNLD-TO-WMS-YES                     VALUE 'Y'.   01790097
018000         88  PS-DWNLD-TO-WMS-NO                      VALUE 'N'.   01800097
018100                                                                  01810067
018200 01  PV-PROGRAM-VARIABLES.                                        01820067
018300     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         01830067
018400                                                 COMP SYNC.       01840067
018500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01850097
018600                                                     COMP.        01860097
018700     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01870067
018800                                                 COMP-3.          01880067
018900     05  PV-LINE-NBR-IND              PIC S9(04) VALUE +0         01890067
019000                                                 COMP SYNC.       01900067
019100     05  PV-MAX-LINE-NBR              PIC S9(04) VALUE +0         01910067
019200                                                 COMP.            01920067
019300     05  PV-NEXT-LINE-NBR             PIC S9(04) VALUE +0         01930067
019400                                                 COMP.            01940067
019500     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01950067
019600                                                 COMP.            01960067
019700     05  PV-COUNTER                   PIC S9(04) VALUE +0         01970081
019800                                                 COMP.            01980081
019900     05  DN-TKT-FMT-ID                PIC S9(04) VALUE +0         01990067
020000                                                 COMP.            02000067
020100     05  PV-ABSTIME                   PIC S9(15) COMP.            02010067
020200     05  PV-CURRENT-TIME              PIC  9(06).                 02020067
020300     05  PV-CURRENT-DATE              PIC  9(06).                 02030067
020400     05  FILLER REDEFINES PV-CURRENT-DATE.                        02040067
020500         10  PV-CURRENT-DATE-YY       PIC  X(02).                 02050067
020600         10  PV-CURRENT-DATE-MM       PIC  X(02).                 02060067
020700         10  PV-CURRENT-DATE-DD       PIC  X(02).                 02070067
020800                                                                  02080067
020900     05  PV-CURRENT-DATE-ISO          PIC  X(10).                 02090067
021000     05  FILLER REDEFINES PV-CURRENT-DATE-ISO.                    02100067
021100         10  PV-CD-ISO-YEAR           PIC  9(04).                 02110067
021200         10  FILLER                   PIC  X(01).                 02120067
021300         10  PV-CD-ISO-MM             PIC  9(02).                 02130067
021400         10  FILLER                   PIC  X(01).                 02140067
021500         10  PV-CD-ISO-DD             PIC  9(02).                 02150067
021600                                                                  02160067
021700     05  PV-COMPARE-DATE1             PIC  X(04).                 02170067
021800     05  FILLER REDEFINES PV-COMPARE-DATE1.                       02180067
021900         10  PV-CD-YY-N               PIC  9(02).                 02190067
022000         10  PV-CD-MM-N               PIC  9(02).                 02200067
022100     05  PV-COMPARE-DATE2             PIC  X(04).                 02210067
022200     05  PV-DB2-RETURN-AREAS.                                     02220067
022300         10  PV-DB2-MONTH             PIC S9(09)   VALUE +0       02230067
022400                                                   COMP.          02240067
022500         10  PV-DB2-DAY               PIC S9(09)   VALUE +0       02250067
022600                                                   COMP.          02260067
022700         10  PV-DB2-YEAR              PIC S9(09)   VALUE +0       02270067
022800                                                   COMP.          02280067
022900         10  PV-DB2-HOUR              PIC S9(09)   VALUE +0       02290067
023000                                                   COMP.          02300067
023100         10  PV-DB2-MINUTE            PIC S9(09)   VALUE +0       02310067
023200                                                   COMP.          02320067
023300         10  PV-DB2-TMST.                                         02330067
023400             15  PV-DB2-DATE-AREA     PIC  X(10)   VALUE SPACES.  02340067
023500             15  FILLER               PIC  X(01)   VALUE SPACES.  02350067
023600             15  PV-DB2-TIME-AREA     PIC  X(15)   VALUE SPACES.  02360067
023700     05  PV-DISPLAY-DATE.                                         02370067
023800         10  PV-MONTH                 PIC  9(02)   VALUE ZEROES.  02380067
023900         10  FILLER                   PIC  X(01)   VALUE '-'.     02390067
024000         10  PV-DAY                   PIC  9(02)   VALUE ZEROES.  02400067
024100         10  FILLER                   PIC  X(01)   VALUE '-'.     02410067
024200         10  PV-YEAR                  PIC  9(04)   VALUE ZEROES.  02420067
024300     05  PV-DISPLAY-TIME.                                         02430067
024400         10  PV-HOUR                  PIC  9(02)   VALUE ZEROES.  02440067
024500         10  FILLER                   PIC  X(01)   VALUE ':'.     02450067
024600         10  PV-MINUTE                PIC  9(02)   VALUE ZEROES.  02460067
024700     05  PV-DB2-DATE-HOST             PIC  X(10).                 02470067
024800     05  PV-DB2-DATE                  PIC  X(10).                 02480067
024900     05  FILLER  REDEFINES PV-DB2-DATE.                           02490067
025000         10  PV-DB2-DATE-CCYY.                                    02500067
025100             15  PV-DB2-DATE-CC       PIC  X(02).                 02510067
025200             15  PV-DB2-DATE-YY       PIC  X(02).                 02520067
025300         10  FILLER                   PIC  X(01).                 02530067
025400         10  PV-DB2-DATE-MM           PIC  X(02).                 02540067
025500         10  FILLER                   PIC  X(01).                 02550067
025600         10  PV-DB2-DATE-DD           PIC  X(02).                 02560067
025700     05  PV-DB2-TIME                  PIC  X(16).                 02570067
025800     05  FILLER  REDEFINES PV-DB2-TIME.                           02580067
025900         10  PV-DB2-TIME-HH           PIC  X(02).                 02590067
026000         10  FILLER                   PIC  X(01).                 02600067
026100         10  PV-DB2-TIME-MM           PIC  X(02).                 02610067
026200         10  FILLER                   PIC  X(01).                 02620067
026300         10  PV-DB2-TIME-SS           PIC  X(02).                 02630067
026400         10  FILLER                   PIC  X(01).                 02640067
026500         10  PV-DB2-TIME-HS           PIC  X(06).                 02650067
026600     05  PV-INTEGER                   PIC  9(6).                  02660067
026700     05  PV-REMAINDER                 PIC  9(3).                  02670067
026800     05  PV-STATUS                    PIC  X(02)   VALUE SPACES.  02680067
026900     05  PV-PKSL-STAT-CDE             PIC  X(02)   VALUE SPACES.  02690067
027000         88 PV-PKSL-STAT-CDE-BEING-WORKED          VALUES         02700067
027100            'IP', 'CM'.                                           02710067
027200     05  PV-PURITM-STATUS-CDE         PIC  X(02)   VALUE SPACES.  02720067
027300         88  PV-PURITM-STATUS-CDE-VALID            VALUES         02730067
027400                                                   'AC', 'AP'.    02740067
027500                                                                  02750067
027600     05  PV-BASE-DISTRO-QTY           PIC S9(07)   VALUE +0.      02760067
027700     05  PV-DISTRO-QTY                PIC S9(07)   VALUE +0.      02770067
027800     05  PV-TROUBLE-COUNT             PIC 9(03)    VALUE ZEROS.   02780067
027900     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9)    VALUE ZERO     02790079
028000                                                   COMP.          02800079
028100     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03)    VALUE ZEROS.   02810067
028200     05  PV-PACK-BY-ST-IND            PIC X(01)    VALUE SPACE.   02820067
028300         88  PV-PACK-BY-ST-IND-YES                 VALUE 'Y'.     02830067
028400     05  PV-PO-NBR                    PIC S9(09)   COMP           02840067
028500                                                   VALUE ZERO.    02850067
028600     05  PV-REC-SEQ-NBR               PIC S9(09)   COMP           02860067
028700                                                   VALUE ZERO.    02870067
028800     05  PV-UNPACK-OPER-UNT-ID        PIC  9(04)   VALUE ZERO.    02880093
028900     05  PV-UNPACK-LOC-NBR            PIC  9(04)   VALUE ZERO.    02890091
029000     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        02900067
029100                                                COMP SYNC.        02910067
029200     05  PV-CICS-MSG-AREA             PIC X(75)  VALUE SPACE.     02920012
029300     05  PV-DISPLAY-NUMBER            PIC 9(05).                  02930012
029400     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        02940012
029500                                                COMP SYNC.        02950012
029600     05  PV-BOMB-TMST                 PIC X(26)  VALUE SPACE.     02960012
029700     05  PV-LAST-PARAGRAPH            PIC X(40)  VALUE SPACE.     02970012
029800     05  PV-STACK-SUB                 PIC S9(04) VALUE ZERO.      02980012
029900     05  PV-MSG-KEYS.                                             02990012
030000         10  FILLER                   PIC X(03) VALUE 'PO '.      03000012
030100*PS 10/20/2014 CHANGE STARTS                                      03010099
030110         10  PV-MSG-KEY-PO            PIC X(08) VALUE SPACES.     03011099
030120*PS 10/20/2014 CHANGE ENDS                                        03012099
030200         10  FILLER                   PIC X(05) VALUE ' SEQ '.    03020012
030300         10  PV-MSG-KEY-REC-SEQ-NBR.                              03030012
030400             15  PV-MSG-KEY-REC-SEQ-NBR-N                         03040012
030500                                      PIC 9(03) VALUE ZEROS.      03050012
030600         10  FILLER                   PIC X(06) VALUE ' LINE '.   03060012
030700         10  PV-MSG-KEY-PO-LNE-NBR.                               03070012
030800             15  PV-MSG-KEY-PO-LNE-NBR-N                          03080012
030900                                      PIC 9(03) VALUE ZEROS.      03090012
031000         10  FILLER                   PIC X(05) VALUE ' STR '.    03100012
031100         10  PV-MSG-KEY-STR-NBR.                                  03110012
031200             15  PV-MSG-KEY-STR-NBR-N PIC 9(04) VALUE ZEROS.      03120088
031300/                                                                 03130067
031400*----------------------------------------------------------------*03140067
031500*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *03150067
031600*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *03160067
031700*----------------------------------------------------------------*03170067
031800                                                                  03180067
031900     COPY PCWS016.                                                03190067
032000/                                                                 03200067
032100                                                                  03210067
032200*----------------------------------------------------------------*03220067
032300*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     03230067
032400*----------------------------------------------------------------*03240067
032500                                                                  03250067
032600     COPY TMWS500.                                                03260067
032700/                                                                 03270067
032800                                                                  03280067
032900*----------------------------------------------------------------*03290067
033000*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               03300071
033100*----------------------------------------------------------------*03310067
033200                                                                  03320067
033300     COPY XLWS001.                                                03330067
033400/                                                                 03340067
033500                                                                  03350067
033600*----------------------------------------------------------------*03360088
033700*  COPYBOOK FOR LOGISTICS DOMAIN LOCATION ACCESS MODULE           03370088
033800*----------------------------------------------------------------*03380088
033900                                                                  03390088
034000     COPY XLWS071.                                                03400088
034100/                                                                 03410088
034200                                                                  03420088
034300*-----------------------------------------------------------------03430094
034400*  ASN DOWNLOAD CONTROL TABLE MAINTENANCE                         03440094
034500*-----------------------------------------------------------------03450094
034600     COPY WSWS001.                                                03460094
034700                                                                  03470094
034800/                                                                 03480094
034900*----------------------------------------------------------------*03490067
035000*    MAP LAYOUT                                                  *03500067
035100*----------------------------------------------------------------*03510067
035200                                                                  03520067
035300     COPY RCKM257.                                                03530067
035400                                                                  03540067
035500/                                                                 03550067
035600*----------------------------------------------------------------*03560067
035700*    ATTRIBUTE SETTINGS COPYBOOK.                                *03570067
035800*----------------------------------------------------------------*03580067
035900                                                                  03590067
036000     COPY DPWS015.                                                03600067
036100                                                                  03610067
036200/                                                                 03620067
036300*----------------------------------------------------------------*03630067
036400*    FUNCTION KEYS COPYBOOK                                      *03640067
036500*----------------------------------------------------------------*03650067
036600                                                                  03660067
036700     COPY DPWS016.                                                03670067
036800                                                                  03680067
036900/                                                                 03690067
037000*----------------------------------------------------------------*03700067
037100*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *03710067
037200*    SUB-ROUTINE (POKUT100).                                     *03720067
037300*----------------------------------------------------------------*03730067
037400     COPY DPWS010I.                                               03740067
037500                                                                  03750067
037600/                                                                 03760067
037700*----------------------------------------------------------------*03770067
037800*  WORK AREA PASSED IN CALL TO DPKUT500                          *03780067
037900*----------------------------------------------------------------*03790067
038000     COPY DPWS500.                                                03800067
038100                                                                  03810067
038200/                                                                 03820067
038300******************************************************************03830099
038400** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **03840099
038500** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **03850099
038600******************************************************************03860099
038700     COPY DPWS030.                                                03870067
038710     COPY DPWS930.                                                03871099
038800                                                                  03880067
038900/                                                                 03890067
039000*----------------------------------------------------------------*03900067
039100*    STANDARD COMMAREA.                                          *03910067
039200*----------------------------------------------------------------*03920067
039300                                                                  03930067
039400     COPY DPWS020.                                                03940067
039500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03950067
039600                                                                  03960067
039700*----------------------------------------------------------------*03970067
039800*    INTER-APPLICATION COMMAREA.                                 *03980067
039900*----------------------------------------------------------------*03990067
040000                                                                  04000067
040100         10  INTER-APPL-COMM-AREA PIC X(200).                     04010067
040200     COPY PCWS000.                                                04020067
040300*----------------------------------------------------------------*04030067
040400*    SPECIFIC COMMMAREA FOR RCKCS257.                            *04040067
040500*----------------------------------------------------------------*04050067
040600         10  ASC-SPECIFIC-COMMAREA.                               04060067
040700             15  ASC-USE-SELECTION-QUEUE-IND                      04070067
040800                                            PIC X(01).            04080067
040900                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        04090067
041000             15  ASC-SEL-QUEUE-NAME         PIC X(08).            04100067
041100             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    04110067
041200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04120067
041300                                            PIC S9(09) COMP-3.    04130067
041400             15  ASC-SEL-SUB                PIC S9(04) COMP.      04140067
041500             15  ASC-SEL-ITEM               PIC S9(04) COMP.      04150067
041600             15  ASC-CURRENT-DATE           PIC X(10).            04160067
041700             15  ASC-ACTION-SW              PIC X(03).            04170067
041800                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          04180067
041900             15  ASC-KEY-FIELDS.                                  04190067
041910*PS 10/20/2014 CHANGE STARTS                                      04191099
042000                 20  ASC-KEY-PO-NBR         PIC 9(08).            04200099
042010*PS 10/20/2014 CHANGE ENDS                                        04201099
042100                 20  ASC-KEY-PO-LNE-NBR     PIC S9(09) COMP.      04210067
042200                 20  ASC-KEY-REC-SEQ-NBR    PIC 9(04).            04220067
042300                 20  ASC-KEY-OPER-UNT-ID    PIC S9(4)  COMP.      04230067
042400                 20  ASC-KEY-FCLTY-ID       PIC S9(4)  COMP.      04240067
042500             15  ASC-SCREEN-FIELDS.                               04250067
042600                 20  ASC-OPER-UNT-ID        PIC S9(4)  COMP.      04260067
042700                 20  ASC-FCLTY-ID           PIC S9(4)  COMP.      04270067
042800                 20  ASC-FCLTY-DESC         PIC X(25).            04280067
042900                 20  ASC-RECEIVER.                                04290067
043000*PS 10/20/2014 CHANGE STARTS                                      04300099
043010                     25  ASC-PO-NBR         PIC 9(08).            04301099
043020*PS 10/20/2014 CHANGE ENDS                                        04302099
043100                     25  ASC-REC-DASH       PIC X(01).            04310067
043200                     25  ASC-REC-SEQ-NBR    PIC 9(04).            04320067
043300                 20  ASC-PO-LNE-NBR.                              04330067
043400                     25  ASC-PO-LNE-NBR-N   PIC 9(04).            04340067
043500                 20  ASC-STATUS-DESC        PIC X(10).            04350067
043600                 20  ASC-TROUBLE-DESC       PIC X(26).            04360067
043700                 20  ASC-INNR-PACK-QTY.                           04370067
043800                     25  ASC-INNR-PACK-QTY-N                      04380067
043900                                            PIC 9(03).            04390067
044000                 20  ASC-PKSL-ITM-QTY       PIC 9(07).            04400067
044100                 20  ASC-GP-RTL-AMT         PIC 9(06)V99.         04410084
044200                 20  ASC-CASE-PACK-QTY.                           04420067
044300                     25  ASC-CASE-PACK-QTY-N                      04430067
044400                                            PIC 9(03).            04440067
044500                 20  ASC-DTL-CK-ITM-QTY.                          04450067
044600                     25  ASC-DTL-CK-ITM-QTY-N                     04460067
044700                                            PIC 9(05).            04470067
044800                 20  ASC-GP-QTY             PIC 9(04).            04480084
044900                 20  ASC-PRE-TKT-IND        PIC X(01).            04490067
045000                 20  ASC-EXPTED-CART-CNT    PIC 9(04).            04500067
045100                 20  ASC-UNT-RTL-PR-AMT     PIC 9(06)V99.         04510084
045200                 20  ASC-UNT-COST-AMT       PIC 9(06)V99.         04520084
045300                 20  ASC-ACTL-CART-CNT      PIC 9(04).            04530067
045400                 20  ASC-TKT-TYP-DESC       PIC X(06).            04540067
045500                 20  ASC-SKU.                                     04550067
045600                     25  ASC-DEPT-NBR       PIC X(03).            04560067
045700                     25  ASC-SKU-DASH-1     PIC X(01).            04570067
045800                     25  ASC-CLASS-NBR      PIC X(02).            04580067
045900                     25  ASC-SKU-DASH-2     PIC X(01).            04590067
046000                     25  ASC-SKU-SEQ-NBR    PIC X(08).            04600067
046100                 20  ASC-VEND-STYL-NAME     PIC X(20).            04610067
046200                 20  ASC-COLOR-DESC         PIC X(25).            04620067
046300                 20  ASC-SIZE-DESC          PIC X(25).            04630067
046400             15  ASC-PURITM-VER-NBR         PIC S9(04) COMP.      04640067
046500             15  ASC-ITM-NBR                PIC S9(15) COMP-3.    04650067
046600             15  ASC-PURITM-PIC-ITM-IND     PIC X(01).            04660067
046700             15  ASC-ENT-ID                 PIC S9(09) COMP.      04670067
046800             15  ASC-NOT-FOUND-SW           PIC X(01).            04680067
046900                 88  ASC-FOUND                         VALUE 'F'. 04690067
047000                 88  ASC-NOT-FOUND                     VALUE 'N'. 04700067
047100             15  ASC-RECITM-STATUS-CDE      PIC X(02).            04710067
047200                 88  ASC-RECITM-STATUS-CM-VE           VALUES     04720067
047300                     'CM', 'VE'.                                  04730067
047400             15  ASC-RECITM-SETUP-PREV-SW   PIC X(01).            04740067
047500                 88  ASC-RECITM-SETUP-PREV             VALUE 'Y'. 04750067
047600                 88  ASC-RECITM-NOT-SETUP-PREV         VALUE 'N'. 04760067
047700             15  ASC-ORIGINATION-IND        PIC X(01).            04770067
047800                 88  ASC-CAME-FROM-RCVG                VALUE '1'. 04780067
047900                 88  ASC-CAME-FROM-TRBL                VALUE '2'. 04790067
048000             15  ASC-TKT-DESC               PIC X(16).            04800067
048100/                                                                 04810067
048200*----------------------------------------------------------------*04820067
048300*    ABEND PROCESSING COPYBOOK.                                  *04830067
048400*----------------------------------------------------------------*04840067
048500                                                                  04850067
048600     COPY DPWS013.                                                04860067
048700/                                                                 04870067
048800                                                                  04880067
048900*----------------------------------------------------------------*04890067
049000*    SYSTEM MESSAGE COPYBOOK                                     *04900067
049100*----------------------------------------------------------------*04910067
049200                                                                  04920067
049300     COPY DPRD507I.                                               04930067
049400/                                                                 04940067
049500                                                                  04950067
049600*----------------------------------------------------------------*04960067
049700*    DB2 SQL COMMUNICATION AREA                                   04970067
049800*----------------------------------------------------------------*04980067
049900     EXEC SQL                                                     04990067
050000          INCLUDE SQLCA                                           05000067
050100     END-EXEC.                                                    05010067
050200                                                                  05020067
050300/                                                                 05030067
050400*----------------------------------------------------------------*05040067
050500*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            05050067
050600*----------------------------------------------------------------*05060067
050700     EXEC SQL                                                     05070067
050800          INCLUDE TPOAGMT                                         05080067
050900     END-EXEC.                                                    05090067
051000                                                                  05100067
051100/                                                                 05110067
051200*----------------------------------------------------------------*05120067
051300*    DB2 DCLGEN FOR THE PACK SLIP TABLE                           05130067
051400*----------------------------------------------------------------*05140067
051500     EXEC SQL                                                     05150067
051600          INCLUDE TPKSLIP                                         05160067
051700     END-EXEC.                                                    05170067
051800                                                                  05180067
051900/                                                                 05190067
052000*----------------------------------------------------------------*05200067
052100*    DB2 DCLGEN FOR THE PACK SLIP ITEM TABLE                      05210067
052200*----------------------------------------------------------------*05220067
052300     EXEC SQL                                                     05230067
052400          INCLUDE TPKITEM                                         05240067
052500     END-EXEC.                                                    05250067
052600                                                                  05260067
052700/                                                                 05270067
052800*----------------------------------------------------------------*05280067
052900*    DB2 DCLGEN FOR THE UNMATCHED PACK SLIP ITEM TABLE            05290067
053000*----------------------------------------------------------------*05300067
053100     EXEC SQL                                                     05310067
053200          INCLUDE TUNPKSL                                         05320067
053300     END-EXEC.                                                    05330067
053400                                                                  05340067
053500/                                                                 05350067
053600*----------------------------------------------------------------*05360067
053700*    DB2 DCLGEN FOR THE RECEIVER TABLE                            05370067
053800*----------------------------------------------------------------*05380067
053900     EXEC SQL                                                     05390067
054000          INCLUDE TRECEIV                                         05400067
054100     END-EXEC.                                                    05410067
054200                                                                  05420067
054300/                                                                 05430067
054400*----------------------------------------------------------------*05440067
054500*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       05450067
054600*----------------------------------------------------------------*05460067
054700     EXEC SQL                                                     05470067
054800          INCLUDE TRECITM                                         05480067
054900     END-EXEC.                                                    05490067
055000                                                                  05500067
055100/                                                                 05510067
055200*----------------------------------------------------------------*05520067
055300*    DB2 DCLGEN FOR THE RECEIVER DISTRIBUTION TABLE               05530067
055400*----------------------------------------------------------------*05540067
055500     EXEC SQL                                                     05550067
055600          INCLUDE TRECDIS                                         05560067
055700     END-EXEC.                                                    05570067
055800                                                                  05580067
055900/                                                                 05590067
056000*----------------------------------------------------------------*05600067
056100*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          05610067
056200*----------------------------------------------------------------*05620067
056300     EXEC SQL                                                     05630067
056400          INCLUDE TPURCHS                                         05640067
056500     END-EXEC.                                                    05650067
056600                                                                  05660067
056700/                                                                 05670067
056800*----------------------------------------------------------------*05680067
056900*    DB2 DCLGEN FOR PURCHASE ORDER STATUS CODE TABLE              05690067
057000*----------------------------------------------------------------*05700067
057100     EXEC SQL                                                     05710067
057200          INCLUDE TSTATCD                                         05720067
057300     END-EXEC.                                                    05730067
057400                                                                  05740067
057500/                                                                 05750067
057501*JAK 04/08/07 - ADD SHIPMT AND SHPTPO TABLES                      05750199
057510*----------------------------------------------------------------*05751099
057520*    DB2 DCLGEN FOR SHIPMENT TABLE                                05752099
057530*----------------------------------------------------------------*05753099
057540     EXEC SQL                                                     05754099
057550          INCLUDE TSHIPMT                                         05755099
057560     END-EXEC.                                                    05756099
057570                                                                  05757099
057580/                                                                 05758099
057590*----------------------------------------------------------------*05759099
057591*    DB2 DCLGEN FOR SHIPMENT PO TABLE                             05759199
057592*----------------------------------------------------------------*05759299
057593     EXEC SQL                                                     05759399
057594          INCLUDE TSHPTPO                                         05759499
057595     END-EXEC.                                                    05759599
057596                                                                  05759699
057597/                                                                 05759799
057600*----------------------------------------------------------------*05760067
057700*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                05770067
057800*----------------------------------------------------------------*05780067
057900     EXEC SQL                                                     05790067
058000          INCLUDE TPURITM                                         05800067
058100     END-EXEC.                                                    05810067
058200                                                                  05820067
058300*----------------------------------------------------------------*05830067
058400*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                05840067
058500*----------------------------------------------------------------*05850067
058600     EXEC SQL                                                     05860067
058700          INCLUDE TTRBNTF                                         05870067
058800     END-EXEC.                                                    05880067
058900                                                                  05890067
059000*----------------------------------------------------------------*05900067
059100*    DB2 DCLGEN FOR THE TROUBLE REASON CODE TABLE                 05910067
059200*----------------------------------------------------------------*05920067
059300     EXEC SQL                                                     05930067
059400          INCLUDE TTRBRSN                                         05940067
059500     END-EXEC.                                                    05950067
059600                                                                  05960067
059700*----------------------------------------------------------------*05970067
059800*    DB2 DCLGEN FOR THE WORK ORDER TABLE                          05980067
059900*----------------------------------------------------------------*05990067
060000     EXEC SQL                                                     06000067
060100          INCLUDE TWRKORD                                         06010067
060200     END-EXEC.                                                    06020067
060300                                                                  06030067
060400*----------------------------------------------------------------*06040067
060500*    DB2 DCLGEN FOR THE WORK ORDER INSTRUCTION TABLE              06050067
060600*----------------------------------------------------------------*06060067
060700     EXEC SQL                                                     06070067
060800          INCLUDE TWKORIN                                         06080067
060900     END-EXEC.                                                    06090067
061000                                                                  06100067
061900******************************************************************06190067
062000*    DB2 DCLGEN FOR THE PRE TICKET REQUEST TABLE                  06200067
062100******************************************************************06210067
062200     EXEC SQL                                                     06220067
062300          INCLUDE TPTKREQ                                         06230067
062400     END-EXEC.                                                    06240067
062500/                                                                 06250067
062600******************************************************************06260067
062700*    DB2 DCLGEN FOR THE TICKET FORMAT TABLE                       06270067
062800******************************************************************06280067
062900     EXEC SQL                                                     06290067
063000          INCLUDE TTKTFMT                                         06300067
063100     END-EXEC.                                                    06310067
063200/                                                                 06320067
063300******************************************************************06330067
063400*    DB2 DCLGEN FOR THE PRE TICKET LINE DETAIL TABLE              06340067
063500******************************************************************06350067
063600     EXEC SQL                                                     06360067
063700          INCLUDE TPTKLNE                                         06370067
063800     END-EXEC.                                                    06380067
063900/                                                                 06390067
064000*-----------------------------------------------------------------06400095
064100*  DB2 TABLE DECLARATION - RC-KOHLS TO RETEK PROCESSING PARAMETERS06410095
064200*      (TKRPRPM)                                                  06420095
064300*-----------------------------------------------------------------06430095
064400     EXEC SQL                                                     06440095
064500          INCLUDE TKRPRPM                                         06450095
064600     END-EXEC.                                                    06460095
064700/                                                                 06470095
064800******************************************************************06480067
064900*    DB2 DCLGEN FOR THE TMDSEAR TABLE                             06490067
065000******************************************************************06500067
065100*    EXEC SQL                                                     06510067
065200*         INCLUDE TMDSEAR                                         06520067
065300*    END-EXEC.                                                    06530067
065400/                                                                 06540067
065500******************************************************************06550067
065600*    DB2 DCLGEN FOR THE TDCVSVL TABLE                             06560067
065700******************************************************************06570067
065800*    EXEC SQL                                                     06580067
065900*         INCLUDE TDCVSVL                                         06590067
066000*    END-EXEC.                                                    06600067
066100/                                                                 06610067
066200******************************************************************06620067
066300*    DB2 DCLGEN FOR THE TDCVSVL TABLE                             06630067
066400******************************************************************06640067
066500*    EXEC SQL                                                     06650067
066600*         INCLUDE TVSCHVL                                         06660067
066700*    END-EXEC.                                                    06670067
066800/                                                                 06680067
066900******************************************************************06690067
067000*    DB2 DCLGEN FOR THE TVNDSTL TABLE                             06700067
067100******************************************************************06710067
067200*    EXEC SQL                                                     06720067
067300*         INCLUDE TVNDSTL                                         06730067
067400*    END-EXEC.                                                    06740067
067500/                                                                 06750067
067600******************************************************************06760067
067700*    DB2 DCLGEN FOR THE TMDARVS TABLE                             06770067
067800******************************************************************06780067
067900*    EXEC SQL                                                     06790067
068000*         INCLUDE TMDARVS                                         06800067
068100*    END-EXEC.                                                    06810067
068200 LINKAGE SECTION.                                                 06820067
068300                                                                  06830067
068400 01  DFHCOMMAREA.                                                 06840067
068500     05  FILLER                       OCCURS  1 TO 4072 TIMES     06850067
068600                                      DEPENDING ON EIBCALEN.      06860067
068700         10  FILLER                   PIC X.                      06870067
068800                                                                  06880067
068900/                                                                 06890067
069000 PROCEDURE DIVISION.                                              06900067
069100                                                                  06910067
069200*----------------------------------------------------------------*06920067
069300*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *06930067
069400*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *06940067
069500*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *06950067
069600*                                                                *06960067
069700*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *06970067
069800*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *06980067
069900*----------------------------------------------------------------*06990067
070000 0000-MAIN-MODULE.                                                07000067
070100                                                                  07010067
070200     INITIALIZE DP030-CICS-API-FIELDS.                            07020067
070300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07030067
070400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07040067
070500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07050067
070600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07060067
070700     MOVE LENGTH OF RC257AI        TO DP030-MAP-LENGTH (1).       07070067
070800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07080067
070900     PERFORM 0001-CALL-CICS-ARCH-API.                             07090067
071000                                                                  07100067
071100     PERFORM 1000-CONTROL-PROCESSING.                             07110067
071200                                                                  07120067
071300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07130067
071400     PERFORM 0001-CALL-CICS-ARCH-API.                             07140067
071500                                                                  07150067
071600/                                                                 07160067
071700 0001-CALL-CICS-ARCH-API.                                         07170067
071800                                                                  07180067
071910     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07191099
072000                                    DFHCOMMAREA                   07200099
072100                                    DP030-CICS-API-FIELDS         07210099
072200                                    DP020-STANDARD-COMMAREA       07220099
072300                                    RC257AI.                      07230099
072400                                                                  07240067
072500     IF  DP030-RC-CALL-SUCCESSFUL                                 07250067
072600         CONTINUE                                                 07260067
072700     ELSE                                                         07270067
072800         SET DP013-NO-ROLLBACK                                    07280067
072900             DP013-XCTL-DISPLAY-RESTART                           07290067
073000             DP013-CICS-ABEND      TO TRUE                        07300067
073100         MOVE 'BEFORE 0000-MAIN-MODULE'                           07310067
073200                                   TO DP013-PARAGRAPH             07320067
073220         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O07322099
073230-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07323099
073500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07350067
073600         PERFORM DP013-0000-PROCESS-ABEND                         07360067
073700     END-IF.                                                      07370067
073800                                                                  07380067
073900/                                                                 07390067
074000*----------------------------------------------------------------*07400067
074100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07410067
074200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07420067
074300*----------------------------------------------------------------*07430067
074400                                                                  07440067
074500 1000-CONTROL-PROCESSING.                                         07450067
074600                                                                  07460067
074700     EVALUATE TRUE                                                07470067
074800         WHEN DP020-NEXT-ACT-INITIAL                              07480067
074900              INITIALIZE ASC-SPECIFIC-COMMAREA                    07490067
075000              PERFORM 1100-PROCESS-INTER-APPL-COMM                07500067
075100              PERFORM 4000-BUILD-INITIAL-PANEL                    07510067
075200              PERFORM 3200-RESET-ATTRIBUTES                       07520067
075300                                                                  07530067
075400         WHEN DP020-NEXT-ACT-READ-MAP                             07540067
075500              PERFORM 2000-PROCESS-PANEL                          07550067
075600                                                                  07560067
075700         WHEN DP020-NEXT-ACT-RETURN                               07570067
075800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07580067
075900                                                                  07590067
076000         WHEN OTHER                                               07600067
076100              SET DP013-LOGIC-ABEND                               07610067
076200                  DP013-NO-ROLLBACK                               07620067
076300                                   TO TRUE                        07630067
076400              MOVE '1000-CONTROL-PROCESSING'                      07640067
076500                                   TO DP013-PARAGRAPH             07650067
076600              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  07660067
076700                                   TO DP013-MESSAGE-TEXT(1)       07670067
076800              MOVE DP020-NEXT-APPL-ACTIVITY                       07680067
076900                                   TO DP013-MESSAGE-TEXT(2)       07690067
077000              PERFORM DP013-0000-PROCESS-ABEND                    07700067
077100     END-EVALUATE.                                                07710067
077200                                                                  07720067
077300/                                                                 07730067
077400*----------------------------------------------------------------*07740067
077500*    SAVE THE KEYS PASSED IN THE INTER-APPL COMMAREA             *07750067
077600*----------------------------------------------------------------*07760067
077700 1100-PROCESS-INTER-APPL-COMM.                                    07770067
077800                                                                  07780067
077900     SET PS-COMMAREA-VALID         TO TRUE.                       07790067
078000                                                                  07800067
078100     IF PC000-NUMBER-OF-SELECTED-ITEMS = ZERO                     07810067
078200         MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER            07820067
078300         SET DP020-MSG-FATAL       TO TRUE                        07830067
078400         SET DP020-NEXT-ACT-APPL-ERROR                            07840067
078500                                   TO TRUE                        07850067
078600         SET PS-ERROR              TO TRUE                        07860067
078700     ELSE                                                         07870067
078800         SET ASC-USE-SELECTION-QUEUE                              07880067
078900                                   TO TRUE                        07890067
079000         MOVE PC000-NUMBER-OF-SELECTED-ITEMS                      07900067
079100                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07910067
079200         MOVE PC000-NUMBER-OF-TS-ITEMS                            07920067
079300                                   TO ASC-NUMBER-OF-TS-ITEMS      07930067
079400         MOVE PC000-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME          07940067
079500         PERFORM 1120-PREPARE-LIST-ENTRY                          07950067
079600         SET ASC-UPDATE-PENDING    TO TRUE                        07960067
079700     END-IF.                                                      07970067
079800                                                                  07980067
079900                                                                  07990067
080000     EVALUATE DP020-INT-APPL-FORMAT-IND                           08000067
080100         WHEN PC-INTER-APPL-RCVG                                  08010067
080200             SET ASC-CAME-FROM-RCVG                               08020067
080300                                   TO TRUE                        08030067
080400     END-EVALUATE.                                                08040067
080500                                                                  08050067
080600/                                                                 08060067
080700*----------------------------------------------------------------*08070067
080800*    ENTRY IS FROM A LIST.  GET THE PO NUMBER FROM THE           *08080067
080900*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *08090067
081000*----------------------------------------------------------------*08100067
081100 1120-PREPARE-LIST-ENTRY.                                         08110067
081200                                                                  08120067
081300     MOVE PC016-MAX-ITEMS          TO ASC-SEL-SUB.                08130067
081400     MOVE ZERO                     TO ASC-SEL-ITEM.               08140067
081500                                                                  08150067
081600     PERFORM 2110-GET-NEXT-RECITM-SELECT.                         08160067
081700                                                                  08170067
081800/                                                                 08180067
081900*----------------------------------------------------------------*08190067
082000*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*08200067
082100*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*08210067
082200*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *08220067
082300*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *08230067
082400*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *08240067
082500*----------------------------------------------------------------*08250067
082600                                                                  08260067
082700 2000-PROCESS-PANEL.                                              08270067
082800                                                                  08280067
082900     EVALUATE TRUE                                                08290067
083000                                                                  08300067
083100         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  08310067
083200             MOVE ASC-KEY-PO-NBR   TO PC000-PO-NBR-N              08320067
083300             MOVE ASC-DEPT-NBR     TO PC000-DEPT-NBR              08330067
083400             MOVE ASC-ENT-ID       TO PC000-ENT-ID                08340067
083500             MOVE ASC-PO-LNE-NBR-N TO PC000-LINE-NBR-N            08350067
083600             MOVE ASC-SEL-QUEUE-NAME                              08360067
083700                                   TO PC000-SEL-QUEUE-NAME        08370067
083800             MOVE ASC-KEY-REC-SEQ-NBR                             08380067
083900                                   TO PC000-REC-SEQ-NBR-N         08390067
084000             MOVE ASC-KEY-OPER-UNT-ID                             08400067
084100                                   TO PC000-OPERATING-UNIT-ID     08410067
084200             MOVE ASC-KEY-FCLTY-ID TO PC000-FACILITY-ID           08420067
084300             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    08430067
084400                               TO PC000-NUMBER-OF-SELECTED-ITEMS  08440067
084500             MOVE ASC-NUMBER-OF-TS-ITEMS                          08450067
084600                                   TO PC000-NUMBER-OF-TS-ITEMS    08460067
084700                                                                  08470067
084800         WHEN DP020-SRC-AID = DP016-CLEAR                         08480067
084900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08490067
085000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08500067
085100                                                                  08510067
085200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08520067
085300             INITIALIZE ASC-SCREEN-FIELDS                         08530067
085400             MOVE ASC-KEY-PO-NBR   TO DK-PO-NBR                   08540067
085500                                      ASC-PO-NBR                  08550067
085600             MOVE ASC-KEY-PO-LNE-NBR                              08560067
085700                                   TO ASC-PO-LNE-NBR-N            08570067
085800                                      DK-PO-LNE-NBR               08580067
085900             MOVE ASC-KEY-REC-SEQ-NBR                             08590067
086000                                   TO ASC-REC-SEQ-NBR             08600067
086100                                      DK-REC-SEQ-NBR              08610067
086200                                                                  08620067
086300             MOVE ASC-KEY-OPER-UNT-ID                             08630067
086400                                   TO ASC-OPER-UNT-ID             08640067
086500                                                                  08650067
086600             MOVE ASC-KEY-FCLTY-ID TO ASC-FCLTY-ID                08660067
086700             PERFORM 2050-SELECT-TRECITM                          08670067
086800             PERFORM 4000-BUILD-INITIAL-PANEL                     08680067
086900             PERFORM 3200-RESET-ATTRIBUTES                        08690067
087000                                                                  08700067
087100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08710067
087200             IF  ASC-USE-SELECTION-QUEUE                          08720067
087300                 PERFORM 2110-GET-NEXT-RECITM-SELECT              08730067
087400                 IF PS-LIST-END                                   08740067
087500                     SET PS-NO-LIST-END                           08750067
087600                                   TO TRUE                        08760067
087700                 ELSE                                             08770067
087800                     INITIALIZE ASC-SCREEN-FIELDS                 08780067
087900                     MOVE ASC-KEY-PO-NBR                          08790067
088000                                   TO DK-PO-NBR                   08800067
088100                                      ASC-PO-NBR                  08810067
088200                     MOVE ASC-KEY-PO-LNE-NBR                      08820067
088300                                   TO ASC-PO-LNE-NBR-N            08830067
088400                                      DK-PO-LNE-NBR               08840067
088500                     MOVE ASC-KEY-REC-SEQ-NBR                     08850067
088600                                   TO ASC-REC-SEQ-NBR             08860067
088700                                      DK-REC-SEQ-NBR              08870067
088800                     MOVE ASC-KEY-OPER-UNT-ID                     08880067
088900                                   TO ASC-OPER-UNT-ID             08890067
089000                     MOVE ASC-KEY-FCLTY-ID                        08900067
089100                                   TO ASC-FCLTY-ID                08910067
089200                                                                  08920067
089300                     PERFORM 2050-SELECT-TRECITM                  08930067
089400                     PERFORM 4000-BUILD-INITIAL-PANEL             08940067
089500                     PERFORM 3200-RESET-ATTRIBUTES                08950067
089600                 END-IF                                           08960067
089700             ELSE                                                 08970067
089800*                --- BOTTOM OF LIST ---                           08980067
089900                 MOVE PC-TSYMSG-00070                             08990067
090000                                   TO DP020-MSG-NUMBER            09000067
090100                 SET DP020-MSG-INFORMATIONAL                      09010067
090200                     PS-LIST-END   TO TRUE                        09020067
090300             END-IF                                               09030067
090400                                                                  09040067
090500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09050067
090600             IF  ASC-USE-SELECTION-QUEUE                          09060067
090700                 PERFORM 2120-GET-PREV-RECITM-SELECT              09070067
090800                 IF PS-LIST-END                                   09080067
090900                     SET PS-NO-LIST-END                           09090067
091000                                   TO TRUE                        09100067
091100                 ELSE                                             09110067
091200                     MOVE ASC-KEY-PO-NBR                          09120067
091300                                   TO DK-PO-NBR                   09130067
091400                                      ASC-PO-NBR                  09140067
091500                     MOVE ASC-KEY-PO-LNE-NBR                      09150067
091600                                   TO ASC-PO-LNE-NBR-N            09160067
091700                                      DK-PO-LNE-NBR               09170067
091800                     MOVE ASC-KEY-REC-SEQ-NBR                     09180067
091900                                   TO ASC-REC-SEQ-NBR             09190067
092000                                      DK-REC-SEQ-NBR              09200067
092100                     MOVE ASC-KEY-OPER-UNT-ID                     09210067
092200                                   TO ASC-OPER-UNT-ID             09220067
092300                     MOVE ASC-KEY-FCLTY-ID                        09230067
092400                                   TO ASC-FCLTY-ID                09240067
092500                                                                  09250067
092600                     PERFORM 2050-SELECT-TRECITM                  09260067
092700                     PERFORM 4000-BUILD-INITIAL-PANEL             09270067
092800                     PERFORM 3200-RESET-ATTRIBUTES                09280067
092900                 END-IF                                           09290067
093000             ELSE                                                 09300067
093100*                --- TOP OF LIST ---                              09310067
093200                 MOVE PC-TSYMSG-00069                             09320067
093300                                   TO DP020-MSG-NUMBER            09330067
093400                 SET DP020-MSG-INFORMATIONAL                      09340067
093500                     PS-LIST-END   TO TRUE                        09350067
093600             END-IF                                               09360067
093700                                                                  09370067
093800         WHEN OTHER                                               09380067
093900              IF  ASC-NOT-FOUND                                   09390067
094000                  MOVE PC-TSYMSG-00148                            09400067
094100                                   TO  DP020-MSG-NUMBER           09410067
094200                  SET DP020-MSG-FATAL                             09420067
094300                          PS-ERROR TO  TRUE                       09430067
094400              ELSE                                                09440067
094500                  PERFORM 2200-MOVE-SCREEN-TO-COMMAREA            09450067
094600                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              09460067
094700                  IF  PS-NO-ERROR                                 09470067
094800                      SET DP030-CONTINUE-GO                       09480067
094900                                   TO TRUE                        09490067
095000                      PERFORM 2100-CHECK-FUNCTION-KEY             09500067
095100                  ELSE                                            09510067
095200                      SET DP030-OVERRIDE-GO                       09520067
095300                                   TO TRUE                        09530067
095400                  END-IF                                          09540067
095500              END-IF                                              09550067
095600     END-EVALUATE.                                                09560067
095700                                                                  09570067
095800/                                                                 09580067
095900 2050-SELECT-TRECITM.                                             09590067
096000     EXEC SQL                                                     09600067
096100          SELECT STATUS_CDE                                       09610067
096110              ,  INNR_PACK_QTY                                    09611099
096120              ,  CASE_PACK_QTY                                    09612099
096200          INTO   :RECITM-STATUS-CDE                               09620067
096210               , :RECITM-INNR-PACK-QTY                            09621099
096220               , :RECITM-CASE-PACK-QTY                            09622099
096300          FROM  TRECITM                                           09630067
096400          WHERE ORD_NBR            =  :DK-PO-NBR                  09640067
096500          AND   ORD_LNE_NBR        =  :DK-PO-LNE-NBR              09650067
096600          AND   REC_SEQ_NBR        =  :DK-REC-SEQ-NBR             09660067
096700          AND   OPER_UNT_ID        =  :ASC-KEY-OPER-UNT-ID        09670067
096800          AND   FCLTY_ID           =  :ASC-KEY-FCLTY-ID           09680067
096900          AND   VER_STATUS_CDE     =  :PC-A                       09690067
097000     END-EXEC.                                                    09700067
097100                                                                  09710067
097200     EVALUATE TRUE                                                09720067
097300         WHEN SQLCODE = ZERO                                      09730067
097310             SET PS-RECITM-FOUND TO TRUE                          09731099
097500         WHEN SQLCODE = +100                                      09750067
097600             MOVE SPACES TO RECITM-STATUS-CDE                     09760067
097610             SET PS-RECITM-NOT-FOUND TO TRUE                      09761099
097700         WHEN SQLWARN0 NOT = SPACE                                09770067
097800         WHEN SQLCODE NOT = ZERO                                  09780067
097900              MOVE '2050-SELECT-TRECITM'                          09790067
098000                               TO DP013-PARAGRAPH                 09800067
098100              MOVE 'SELECT STATUS CODE'                           09810067
098200                               TO DP013-MESSAGE-TEXT (1)          09820067
098300              MOVE SQLCA       TO DP013-SQLCA                     09830067
098400              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        09840067
098500              SET DP013-DB2-ABEND                                 09850067
098600                               TO TRUE                            09860067
098700              PERFORM DP013-0000-PROCESS-ABEND                    09870067
098800     END-EVALUATE.                                                09880067
098900/                                                                 09890067
099000*----------------------------------------------------------------*09900067
099100*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *09910067
099200*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*09920067
099300*    FROM THE CICS ARCHITECTURE API.                             *09930067
099400*----------------------------------------------------------------*09940067
099500                                                                  09950067
099600 2100-CHECK-FUNCTION-KEY.                                         09960067
099700                                                                  09970067
099800     MOVE '2100-CHECK-FUNCTION-KEY'   TO PV-LAST-PARAGRAPH.       09980012
099900     EVALUATE TRUE                                                09990067
100000         WHEN DP020-SRC-AID = DP016-ENTER                         10000067
100100             CONTINUE                                             10010067
100200                                                                  10020067
100300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10030067
100400             SET DP030-CONTINUE-GO TO TRUE                        10040067
100500             IF  ASC-RECITM-SETUP-PREV                            10050067
100600                 MOVE PC-TSYMSG-00117                             10060067
100700                                   TO DP020-MSG-NUMBER            10070067
100800                 SET DP020-MSG-INFORMATIONAL                      10080067
100900                     DP030-OVERRIDE-GO                            10090067
101000                                   TO TRUE                        10100067
101100             ELSE                                                 10110067
101200                PERFORM 5000-ADD-RECITM                           10120067
101300*TCR 3/07 BEGIN                                                   10130099
101310                SET PS-DWNLD-TO-WMS-NO TO TRUE                    10131099
101400                PERFORM 6310-SELECT-TRECEIV                       10140099
101410                PERFORM 6300-CHECK-DC-OK-FOR-DWNLD                10141099
101500                IF PS-DWNLD-TO-WMS-YES                            10150099
101800                   PERFORM 6600-CALL-WMS-MODULE                   10180094
102000                   IF WS001-SUCCESSFUL                            10200099
102010*JAK 5/07 - CHG TO ONLY USE MSGS 3535 & 3546 IF PS-DWNLD-TO-WMS   10201099
102100                      MOVE PC-TSYMSG-03535 TO DP020-MSG-NUMBER    10210099
102200                      SET DP020-MSG-INFORMATIONAL TO TRUE         10220099
102300                   ELSE                                           10230099
102310                      IF WS001-INVALID-SQL                        10231099
102320                      OR WS001-DATABASE-BUSY                      10232099
102330                         MOVE PC-TSYMSG-03546 TO DP020-MSG-NUMBER 10233099
102340                         SET DP020-MSG-WARNING TO TRUE            10234099
102350                      END-IF                                      10235099
102600                   END-IF                                         10260099
102610                END-IF                                            10261099
102700*TCR 3/07 END                                                     10270099
102800                IF PV-PACK-BY-ST-IND = PC-Y                       10280067
102900                    CONTINUE                                      10290067
103000                ELSE                                              10300067
103100                    SET DP030-OVERRIDE-GO TO TRUE                 10310067
103200                END-IF                                            10320067
103300                PERFORM 4030-GET-TROUBLE-DESC                     10330067
103400                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              10340067
103500             END-IF                                               10350067
103600             MOVE ASC-KEY-PO-NBR   TO PC000-PO-NBR-N              10360067
103700             MOVE ASC-DEPT-NBR     TO PC000-DEPT-NBR              10370067
103800             MOVE ASC-ENT-ID       TO PC000-ENT-ID                10380067
103900             MOVE ASC-PO-LNE-NBR-N TO PC000-LINE-NBR-N            10390067
104000             MOVE ASC-KEY-REC-SEQ-NBR                             10400067
104100                                   TO PC000-REC-SEQ-NBR-N         10410067
104200             MOVE ASC-KEY-OPER-UNT-ID                             10420067
104300                                   TO PC000-OPERATING-UNIT-ID     10430067
104400             MOVE ASC-KEY-FCLTY-ID TO PC000-FACILITY-ID           10440067
104500             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    10450067
104600                               TO PC000-NUMBER-OF-SELECTED-ITEMS  10460067
104700             MOVE ASC-NUMBER-OF-TS-ITEMS                          10470067
104800                                   TO PC000-NUMBER-OF-TS-ITEMS    10480067
104900                                                                  10490067
105000                                                                  10500067
105100                                                                  10510067
105200         WHEN OTHER                                               10520067
105300             SET DP013-NO-ROLLBACK                                10530067
105400                 DP013-XCTL-DISPLAY-RESTART                       10540067
105500                 DP013-CICS-ABEND  TO TRUE                        10550067
105600             MOVE '2100-CHECK-FUNCTION-KEY'                       10560067
105700                                   TO DP013-PARAGRAPH             10570067
105800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10580067
105900                                   TO DP013-MESSAGE-TEXT (1)      10590067
106000             PERFORM DP013-0000-PROCESS-ABEND                     10600067
106100     END-EVALUATE.                                                10610067
106200                                                                  10620067
106300/                                                                 10630067
106400*----------------------------------------------------------------*10640067
106500*    GET THE RECITM (KEY) OF THE NEXT SELECTED OBJECT            *10650067
106600*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *10660067
106700*----------------------------------------------------------------*10670067
106800 2110-GET-NEXT-RECITM-SELECT.                                     10680067
106900                                                                  10690067
107000     ADD +1                        TO ASC-SEL-SUB.                10700067
107100     IF  ASC-SEL-SUB > PC016-MAX-ITEMS                            10710067
107200         ADD +1                    TO ASC-SEL-ITEM                10720067
107300         MOVE +1                   TO ASC-SEL-SUB                 10730067
107400     END-IF.                                                      10740067
107500                                                                  10750067
107600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10760067
107700         PERFORM 9100-READ-SEL-QUEUE                              10770067
107800         IF  PC016-ITEM (ASC-SEL-SUB) > ZERO                      10780067
107900             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  10790067
108000                                   TO ASC-PO-LNE-NBR-N            10800067
108100                                      ASC-KEY-PO-LNE-NBR          10810067
108200                                      DK-PO-LNE-NBR               10820067
108300                                                                  10830067
108400             MOVE PC016-PO-NBR-N (ASC-SEL-SUB)                    10840067
108500                                   TO DK-PO-NBR                   10850067
108600                                      ASC-KEY-PO-NBR              10860067
108700                                      ASC-PO-NBR                  10870067
108800                                                                  10880067
108900             MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)               10890067
109000                                   TO ASC-KEY-REC-SEQ-NBR         10900067
109100                                      ASC-REC-SEQ-NBR             10910067
109200                                      DK-REC-SEQ-NBR              10920067
109300                                                                  10930067
109400             MOVE PC016-OPER-UNT-ID (ASC-SEL-SUB)                 10940067
109500                                   TO ASC-KEY-OPER-UNT-ID         10950067
109600                                      ASC-OPER-UNT-ID             10960067
109700                                                                  10970067
109800             MOVE PC016-FCLTY-ID (ASC-SEL-SUB)                    10980067
109900                                   TO ASC-KEY-FCLTY-ID            10990067
110000                                      ASC-FCLTY-ID                11000067
110100             IF PC016-UPD (ASC-SEL-SUB)                           11010067
110200                 SET ASC-RECITM-SETUP-PREV    TO TRUE             11020067
110300             ELSE                                                 11030067
110400                 SET ASC-RECITM-NOT-SETUP-PREV TO TRUE            11040067
110500             END-IF                                               11050067
110600             SET PC016-INQ           (ASC-SEL-SUB)                11060067
110700                                   TO TRUE                        11070067
110800             PERFORM 9200-REWRITE-SEL-QUEUE                       11080067
110900         ELSE                                                     11090067
111000             SUBTRACT +1 FROM ASC-SEL-SUB                         11100067
111100*            --- BOTTOM OF LIST ---                               11110067
111200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11120067
111300             SET DP020-MSG-INFORMATIONAL                          11130067
111400                 PS-LIST-END                                      11140067
111500                                   TO TRUE                        11150067
111600         END-IF                                                   11160067
111700     ELSE                                                         11170067
111800         SUBTRACT +1 FROM ASC-SEL-ITEM                            11180067
111900         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 11190067
112000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11200067
112100         SET DP020-MSG-INFORMATIONAL                              11210067
112200             PS-LIST-END           TO TRUE                        11220067
112300     END-IF.                                                      11230067
112400                                                                  11240067
112500/                                                                 11250067
112600*----------------------------------------------------------------*11260067
112700*    GET THE RECITM (KEY) OF THE PREVIOUS SELECTED               *11270067
112800*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *11280067
112900*----------------------------------------------------------------*11290067
113000 2120-GET-PREV-RECITM-SELECT.                                     11300067
113100                                                                  11310067
113200     SUBTRACT +1 FROM ASC-SEL-SUB.                                11320067
113300     IF  ASC-SEL-SUB < +1                                         11330067
113400         SUBTRACT +1 FROM ASC-SEL-ITEM                            11340067
113500         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 11350067
113600     END-IF.                                                      11360067
113700                                                                  11370067
113800     IF  ASC-SEL-ITEM > ZERO                                      11380067
113900         PERFORM 9100-READ-SEL-QUEUE                              11390067
114000         INITIALIZE ASC-SCREEN-FIELDS                             11400067
114100         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      11410067
114200                                   TO ASC-PO-LNE-NBR-N            11420067
114300                                      ASC-KEY-PO-LNE-NBR          11430067
114400                                      DK-PO-LNE-NBR               11440067
114500                                                                  11450067
114600         MOVE PC016-PO-NBR-N (ASC-SEL-SUB)                        11460067
114700                                   TO DK-PO-NBR                   11470067
114800                                      ASC-KEY-PO-NBR              11480067
114900                                      ASC-PO-NBR                  11490067
115000                                                                  11500067
115100         MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)                   11510067
115200                                   TO ASC-KEY-REC-SEQ-NBR         11520067
115300                                      ASC-REC-SEQ-NBR             11530067
115400                                      DK-REC-SEQ-NBR              11540067
115500                                                                  11550067
115600         MOVE PC016-OPER-UNT-ID (ASC-SEL-SUB)                     11560067
115700                                   TO ASC-KEY-OPER-UNT-ID         11570067
115800                                      ASC-OPER-UNT-ID             11580067
115900                                                                  11590067
116000         MOVE PC016-FCLTY-ID (ASC-SEL-SUB)                        11600067
116100                                   TO ASC-KEY-FCLTY-ID            11610067
116200                                      ASC-FCLTY-ID                11620067
116300         IF PC016-UPD (ASC-SEL-SUB)                               11630067
116400             SET ASC-RECITM-SETUP-PREV    TO TRUE                 11640067
116500         ELSE                                                     11650067
116600             SET ASC-RECITM-NOT-SETUP-PREV TO TRUE                11660067
116700         END-IF                                                   11670067
116800     ELSE                                                         11680067
116900         MOVE +1                   TO ASC-SEL-ITEM                11690067
117000                                      ASC-SEL-SUB                 11700067
117100*        --- TOP OF LIST ---                                      11710067
117200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11720067
117300         SET DP020-MSG-INFORMATIONAL                              11730067
117400             PS-LIST-END           TO TRUE                        11740067
117500     END-IF.                                                      11750067
117600/                                                                 11760067
117700*----------------------------------------------------------------*11770067
117800*    GET THE CURRENT ROW FOR PROCESSING.                         *11780067
117900*----------------------------------------------------------------*11790067
118000                                                                  11800067
118100 2130-CHECK-PACK-BY-STORE.                                        11810067
118200     MOVE ASC-KEY-PO-NBR           TO PV-PO-NBR.                  11820067
118300     MOVE ASC-KEY-REC-SEQ-NBR      TO PV-REC-SEQ-NBR.             11830067
118400                                                                  11840067
118500     EXEC SQL                                                     11850067
118600          SELECT PACK_BY_ST_IND                                   11860067
118700            INTO :PV-PACK-BY-ST-IND                               11870067
118800            FROM TRECEIV                                          11880067
118900           WHERE ORD_NBR         =  :PV-PO-NBR                    11890067
119000             AND REC_SEQ_NBR     =  :PV-REC-SEQ-NBR               11900067
119100             AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          11910067
119200             AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             11920067
119300             AND VER_STATUS_CDE  =  :PC-A                         11930067
119400     END-EXEC.                                                    11940067
119500                                                                  11950067
119600     EVALUATE TRUE                                                11960067
119700         WHEN SQLCODE = ZERO                                      11970067
119800              CONTINUE                                            11980067
119900         WHEN SQLWARN0 NOT = SPACE                                11990067
120000         WHEN SQLCODE NOT = ZERO                                  12000067
120100              MOVE '2130-CHECK-PACK-BY-STORE'                     12010067
120200                               TO DP013-PARAGRAPH                 12020067
120300              MOVE 'SELECT TRECEIV'                               12030067
120400                               TO DP013-MESSAGE-TEXT (1)          12040067
120500              MOVE SQLCA       TO DP013-SQLCA                     12050067
120600              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        12060067
120700              SET DP013-DB2-ABEND                                 12070067
120800                               TO TRUE                            12080067
120900              PERFORM DP013-0000-PROCESS-ABEND                    12090067
121000     END-EVALUATE.                                                12100067
121100/                                                                 12110067
121200*----------------------------------------------------------------*12120067
121300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *12130067
121400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *12140067
121500*----------------------------------------------------------------*12150067
121600 2200-MOVE-SCREEN-TO-COMMAREA.                                    12160067
121700                                                                  12170067
121800     IF AINNRL > ZERO                                             12180067
121900         MOVE AINNRI               TO ASC-INNR-PACK-QTY           12190067
122000     ELSE                                                         12200067
122100         IF AINNRF = DP015-ERASE-EOF                              12210067
122200             MOVE ZEROS            TO ASC-INNR-PACK-QTY-N         12220067
122300         END-IF                                                   12230067
122400     END-IF.                                                      12240067
122500                                                                  12250067
122600     IF ACASEL > ZERO                                             12260067
122700         MOVE ACASEI               TO ASC-CASE-PACK-QTY           12270067
122800     ELSE                                                         12280067
122900         IF ACASEF = DP015-ERASE-EOF                              12290067
123000             MOVE ZEROS            TO ASC-CASE-PACK-QTY-N         12300067
123100         END-IF                                                   12310067
123200     END-IF.                                                      12320067
123300                                                                  12330067
123400     IF ADCQTYL > ZERO                                            12340067
123500         MOVE ADCQTYI              TO ASC-DTL-CK-ITM-QTY          12350067
123600     ELSE                                                         12360067
123700         IF ADCQTYF = DP015-ERASE-EOF                             12370067
123800             MOVE ZEROS            TO ASC-DTL-CK-ITM-QTY-N        12380067
123900         END-IF                                                   12390067
124000     END-IF.                                                      12400067
124100                                                                  12410067
124200/                                                                 12420067
124300*----------------------------------------------------------------*12430067
124400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *12440067
124500*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *12450067
124600*----------------------------------------------------------------*12460067
124700 3000-EDIT-DATA-IN-COMMAREA.                                      12470067
124800                                                                  12480067
124900     MOVE '3000-EDIT-DATA-IN-COMMAREA' TO PV-LAST-PARAGRAPH.      12490012
125000     SET PS-NO-ERROR               TO TRUE.                       12500067
125100                                                                  12510067
125200     PERFORM 3200-RESET-ATTRIBUTES.                               12520067
125300                                                                  12530067
125400     IF  ASC-DTL-CK-ITM-QTY > SPACES                              12540067
125500         MOVE ASC-DTL-CK-ITM-QTY   TO DP010I-UNEDITED-FIELD       12550067
125600         MOVE LENGTH OF ASC-DTL-CK-ITM-QTY                        12560067
125700                                   TO DP010I-MAXIMUM-DIGITS       12570067
125800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     12580067
125900         SET DP010I-NEGATIVE-NOT-ALLOWED                          12590067
126000                                   TO TRUE                        12600067
126110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12611099
126120              USING DP010I-NUMERIC-EDIT-AREA                      12612099
126200                                                                  12620067
126300         IF  DP010I-ERROR-DETECTED                                12630067
126400             SET PS-ERROR                                         12640067
126500                 DP020-MSG-FATAL   TO TRUE                        12650067
126600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12660067
126700             MOVE DP015-UNP-NUM-BRT-OFF                           12670067
126800                                   TO ADCQTYA                     12680067
126900             MOVE DP015-RED        TO ADCQTYC                     12690067
127000             MOVE DP015-REVERSE    TO ADCQTYH                     12700067
127100             MOVE -1               TO ADCQTYL                     12710067
127200             SET DP030-SET-CURSOR-APPL-1                          12720067
127300                                   TO TRUE                        12730067
127400         ELSE                                                     12740067
127500             IF DP010I-NUMERIC-FIELD = 0                          12750067
127600                 SET PS-ERROR                                     12760067
127700                     DP020-MSG-FATAL   TO TRUE                    12770067
127800                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        12780067
127900                 MOVE DP015-UNP-NUM-BRT-OFF                       12790067
128000                                       TO ADCQTYA                 12800067
128100                 MOVE DP015-RED        TO ADCQTYC                 12810067
128200                 MOVE DP015-REVERSE    TO ADCQTYH                 12820067
128300                 MOVE -1               TO ADCQTYL                 12830067
128400                 SET DP030-SET-CURSOR-APPL-1                      12840067
128500                                       TO TRUE                    12850067
128600             ELSE                                                 12860067
128700                 MOVE DP010I-NUMERIC-FIELD                        12870067
128800                                   TO ASC-DTL-CK-ITM-QTY-N        12880067
128900                 MOVE ASC-DTL-CK-ITM-QTY-N                        12890067
129000                                   TO ADCQTYO                     12900067
129100             END-IF                                               12910067
129200         END-IF                                                   12920067
129300     ELSE                                                         12930067
129400         SET PS-ERROR                                             12940067
129500             DP020-MSG-FATAL   TO TRUE                            12950067
129600         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                12960067
129700         MOVE DP015-UNP-NUM-BRT-OFF                               12970067
129800                               TO ADCQTYA                         12980067
129900         MOVE DP015-RED        TO ADCQTYC                         12990067
130000         MOVE DP015-REVERSE    TO ADCQTYH                         13000067
130100         MOVE -1               TO ADCQTYL                         13010067
130200         SET DP030-SET-CURSOR-APPL-1                              13020067
130300                               TO TRUE                            13030067
130400     END-IF.                                                      13040067
130500                                                                  13050067
130600     IF  ASC-CASE-PACK-QTY > SPACES                               13060067
130700         MOVE ASC-CASE-PACK-QTY    TO DP010I-UNEDITED-FIELD       13070067
130800         MOVE LENGTH OF ASC-CASE-PACK-QTY                         13080067
130900                                   TO DP010I-MAXIMUM-DIGITS       13090067
131000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13100067
131100         SET DP010I-NEGATIVE-NOT-ALLOWED                          13110067
131200                                   TO TRUE                        13120067
131310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13131099
131320              USING DP010I-NUMERIC-EDIT-AREA                      13132099
131400                                                                  13140067
131500         IF  DP010I-ERROR-DETECTED                                13150067
131600             SET PS-ERROR                                         13160067
131700                 DP020-MSG-FATAL   TO TRUE                        13170067
131800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13180067
131900             MOVE DP015-UNP-NUM-BRT-OFF                           13190067
132000                                   TO ACASEA                      13200067
132100             MOVE DP015-RED        TO ACASEC                      13210067
132200             MOVE DP015-REVERSE    TO ACASEH                      13220067
132300             MOVE -1               TO ACASEL                      13230067
132400             SET DP030-SET-CURSOR-APPL-1                          13240067
132500                                   TO TRUE                        13250067
132600         ELSE                                                     13260067
132700             MOVE DP010I-NUMERIC-FIELD                            13270067
132800                                   TO ASC-CASE-PACK-QTY-N         13280067
132900         END-IF                                                   13290067
133000     END-IF.                                                      13300067
133100                                                                  13310067
133200     IF  ASC-INNR-PACK-QTY > SPACES                               13320067
133300         MOVE ASC-INNR-PACK-QTY    TO DP010I-UNEDITED-FIELD       13330067
133400         MOVE LENGTH OF ASC-INNR-PACK-QTY                         13340067
133500                                   TO DP010I-MAXIMUM-DIGITS       13350067
133600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13360067
133700         SET DP010I-NEGATIVE-NOT-ALLOWED                          13370067
133800                                   TO TRUE                        13380067
133910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13391099
133920              USING DP010I-NUMERIC-EDIT-AREA                      13392099
134000                                                                  13400067
134100         IF  DP010I-ERROR-DETECTED                                13410067
134200             SET PS-ERROR                                         13420067
134300                 DP020-MSG-FATAL   TO TRUE                        13430067
134400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13440067
134500             MOVE DP015-UNP-NUM-BRT-OFF                           13450067
134600                                   TO AINNRA                      13460067
134700             MOVE DP015-RED        TO AINNRC                      13470067
134800             MOVE DP015-REVERSE    TO AINNRH                      13480067
134900             MOVE -1               TO AINNRL                      13490067
135000             SET DP030-SET-CURSOR-APPL-1                          13500067
135100                                   TO TRUE                        13510067
135200         ELSE                                                     13520067
135300             MOVE DP010I-NUMERIC-FIELD                            13530067
135400                                   TO ASC-INNR-PACK-QTY-N         13540067
135500         END-IF                                                   13550067
135600     END-IF.                                                      13560067
135700                                                                  13570067
135800                                                                  13580067
135900     IF  PS-NO-ERROR                                              13590067
136000         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     13600067
136100         MOVE -1               TO AINNRL                          13610067
136200         SET DP030-SET-CURSOR-APPL-1                              13620067
136300                                   TO TRUE                        13630067
136400     END-IF.                                                      13640067
136500                                                                  13650067
136600/                                                                 13660067
136700*----------------------------------------------------------------*13670067
136800*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *13680067
136900*----------------------------------------------------------------*13690067
137000                                                                  13700067
137100 3200-RESET-ATTRIBUTES.                                           13710067
137200                                                                  13720067
137300      MOVE DP015-PRO-NOR-OFF                                      13730067
137400                           TO APRETKTA.                           13740067
137500      MOVE DP015-UNP-NUM-NOR-OFF                                  13750067
137600                           TO AINNRA                              13760067
137700                              ACASEA                              13770067
137800                              ADCQTYA.                            13780067
137900      MOVE DP015-BLUE      TO APRETKTC.                           13790067
138000      MOVE DP015-GREEN     TO AINNRC                              13800067
138100                              ACASEC                              13810067
138200                              ADCQTYC.                            13820067
138300      MOVE DP015-UNDERLINE TO AINNRH                              13830067
138400                              ACASEH                              13840067
138500                              ADCQTYH.                            13850067
138600                                                                  13860067
138700     IF  DP020-NEXT-ACT-INITIAL                                   13870067
138800         SET DP030-SET-CURSOR-APPL-1                              13880067
138900                                   TO TRUE                        13890067
139000         MOVE -1                   TO AINNRL                      13900067
139100     END-IF.                                                      13910067
139200                                                                  13920067
139300     IF ASC-RECITM-STATUS-CM-VE                                   13930067
139400         SET DP030-SET-CURSOR-TRAILER                             13940067
139500                                   TO TRUE                        13950067
139600     END-IF.                                                      13960067
139700/                                                                 13970067
139800*----------------------------------------------------------------*13980067
139900*  THIS PARAGRAPH BUILDS THE INITIAL SCREEN                      *13990067
140000*----------------------------------------------------------------*14000067
140100                                                                  14010067
140200 4000-BUILD-INITIAL-PANEL.                                        14020067
140300                                                                  14030067
140400     PERFORM 4010-GET-LOC-DESC.                                   14040088
140500                                                                  14050067
140600     MOVE ASC-PO-LNE-NBR-N         TO DK-PO-LNE-NBR.              14060067
140700                                                                  14070067
140800     PERFORM 9050-GET-PURITM.                                     14080067
140900*----------------------------------------------------------------*14090067
141000*                                                                *14100067
141100*----------------------------------------------------------------*14110067
141200     MOVE PURITM-ITM-NBR           TO ASC-ITM-NBR.                14120067
141300     MOVE PURITM-VER-NBR           TO ASC-PURITM-VER-NBR.         14130067
141400*                                                                 14140067
141500*----------------------------------------------------------------*14150067
141600* ADDED THE LOGIC TO CHECK FOR THE DUMMY SKU                     *14160067
141700* IF NOT DUMMY SKU CALL LOGISTICS DOMAIN ITEM ACCESS MODULE      *14170067
141800*----------------------------------------------------------------*14180067
141900     INITIALIZE XL001-ITEM-COMMAREA                               14190067
142000                ASC-SKU-SEQ-NBR                                   14200067
142100*                                                                 14210067
142200     IF  PS-PURITM-FOUND                  AND                     14220067
142300        (PURITM-SKU-SEQ-NBR NOT = PC-000  AND                     14230067
142400         PURITM-SKU-SEQ-NBR NOT = PC-999)                         14240067
142500                                                                  14250067
142600         PERFORM 9060-CALL-CICS-API-ARCH                          14260067
142700     ELSE                                                         14270067
142800         IF PURITM-SKU-SEQ-NBR = PC-000                           14280067
142900            MOVE '00000000'      TO  ASC-SKU-SEQ-NBR              14290067
143000         ELSE                                                     14300067
143100            IF PURITM-SKU-SEQ-NBR = PC-999                        14310067
143200               MOVE '99999999'   TO  ASC-SKU-SEQ-NBR              14320067
143300            END-IF                                                14330067
143400         END-IF                                                   14340067
143500     END-IF                                                       14350067
143600*                                                                 14360067
143700     MOVE PURITM-GP-RTL-AMT        TO ASC-GP-RTL-AMT.             14370067
143800     MOVE PURITM-GP-QTY            TO ASC-GP-QTY.                 14380067
143900     MOVE PURITM-UNT-RTL-PR-AMT    TO ASC-UNT-RTL-PR-AMT.         14390067
144000     MOVE PURITM-UNT-COST-AMT      TO ASC-UNT-COST-AMT.           14400084
144100                                                                  14410067
144200     PERFORM 4020-GET-STATUS-DESC.                                14420067
144300                                                                  14430067
144400*    CHECK THE PRE TICKET CODE ON THE PO AGREEMENT TABLE          14440067
144500     INITIALIZE PV-DB2-COUNT.                                     14450067
144600     MOVE 4                      TO DK-AGRMT-TYP-ID.              14460067
144700     MOVE 1                      TO DK-TYP-CDE.                   14470067
144800                                                                  14480067
144900     PERFORM 4005-CHECK-PO-SERVICE-INFO.                          14490067
145000                                                                  14500067
145100     IF  PV-DB2-COUNT > +0                                        14510067
145200         MOVE 'Y'                TO ASC-PRE-TKT-IND               14520067
145300                                    APRETKTI                      14530067
145400                                    APRETKTO                      14540067
145500     ELSE                                                         14550067
145600         MOVE 'N'                TO ASC-PRE-TKT-IND               14560067
145700                                    APRETKTI                      14570067
145800                                    APRETKTO                      14580067
145900     END-IF.                                                      14590067
146000                                                                  14600067
146100                                                                  14610067
146200     MOVE RECITM-STATUS-CDE        TO ASC-RECITM-STATUS-CDE.      14620067
146300                                                                  14630067
146400     PERFORM 4035-GET-TICKET-TYPE.                                14640067
146500     PERFORM 4030-GET-TROUBLE-DESC.                               14650067
146600** GB 3/25/2012                                                   14660099
146610     IF PS-RECITM-FOUND                                           14661099
146611        MOVE  RECITM-INNR-PACK-QTY    TO ASC-INNR-PACK-QTY-N      14661199
146612        MOVE  RECITM-CASE-PACK-QTY    TO ASC-CASE-PACK-QTY-N      14661299
146620     ELSE                                                         14662099
146700        MOVE  PURITM-INNR-PK-QTY      TO ASC-INNR-PACK-QTY-N      14670099
146701        MOVE  PURITM-OUTR-PK-QTY      TO ASC-CASE-PACK-QTY-N      14670199
146710     END-IF                                                       14671099
146711** GB 3/25/2012                                                   14671199
146720                                                                  14672099
146800     IF ASC-PO-LNE-NBR > PC-8999                                  14680067
146900         PERFORM 4200-BUILD-UNPKSL-SCREEN                         14690067
147000     ELSE                                                         14700067
147100         PERFORM 4100-BUILD-PKITEM-SCREEN                         14710067
147200     END-IF.                                                      14720067
147300                                                                  14730067
147400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14740067
147500                                                                  14750067
147600/                                                                 14760067
147700*----------------------------------------------------------------*14770067
147800*    CHECK TO SEE WHAT TYPES OF SERVICES THIS PO HAS             *14780067
147900*----------------------------------------------------------------*14790067
148000 4005-CHECK-PO-SERVICE-INFO.                                      14800067
148100                                                                  14810067
148200     EXEC SQL                                                     14820067
148300          SELECT COUNT(*)                                         14830067
148400            INTO :PV-DB2-COUNT                                    14840067
148500            FROM TPOAGMT                                          14850067
148600           WHERE PO_NBR         = :DK-PO-NBR                      14860067
148700             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                14870067
148800             AND VER_STATUS_CDE = 'A'                             14880067
148900             AND TYP_CDE        = :DK-TYP-CDE                     14890067
149000     END-EXEC.                                                    14900067
149100                                                                  14910067
149200     EVALUATE TRUE                                                14920067
149300         WHEN SQLCODE = +0                                        14930067
149400         WHEN SQLCODE = +100                                      14940067
149500              CONTINUE                                            14950067
149600                                                                  14960067
149700         WHEN SQLWARN0 NOT = SPACES                               14970067
149800         WHEN SQLCODE < +0                                        14980067
149900         WHEN SQLCODE > +0                                        14990067
150000              MOVE '4005-CHECK-PO-SERVICE-INFO'                   15000067
150100                              TO DP013-PARAGRAPH                  15010067
150200              MOVE 'UNSUCCESSFUL SELECT PURCHASE AGREEMENT'       15020067
150300                              TO DP013-MESSAGE-TEXT (1)           15030067
150400              MOVE SQLCA      TO DP013-SQLCA                      15040067
150500              MOVE 'TPOAGMT ' TO DP013-DB2-TABLE-NAME (1)         15050067
150600              SET DP013-DB2-ABEND                                 15060067
150700                  DP013-XCTL-DISPLAY-RESTART                      15070067
150800                              TO TRUE                             15080067
150900              PERFORM DP013-0000-PROCESS-ABEND                    15090067
151000     END-EVALUATE.                                                15100067
151100                                                                  15110067
151200/                                                                 15120067
151300*----------------------------------------------------------------*15130067
151400*  CALL XLKUT071 TO GET THE LOCATION DESCRIPTION                 *15140088
151500*----------------------------------------------------------------*15150067
151600                                                                  15160067
151700 4010-GET-LOC-DESC.                                               15170088
151800     INITIALIZE XL071-COMMAREA-REC.                               15180088
151900     MOVE ASC-KEY-OPER-UNT-ID   TO PV-UNPACK-OPER-UNT-ID.         15190089
152000     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         15200089
152100                                                                  15210089
152200     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    15220089
152300                                      XL071-COMMAREA              15230089
152400                                      XL071-COMMAREA-REC.         15240089
152500                                                                  15250067
152600     EVALUATE TRUE                                                15260067
152700         WHEN XL071-NO-ERRORS                                     15270089
152800             MOVE XL071-LOC-NM TO ASC-FCLTY-DESC                  15280089
152900                                  AFDESCO                         15290067
153000         WHEN XL071-LOC-NOT-FOUND                                 15300089
153100             SET PS-ERROR                                         15310089
153200                 DP020-MSG-FATAL         TO TRUE                  15320089
153300             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      15330089
153400             MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA               15340089
153500             MOVE DP015-RED              TO AFCLTYC               15350089
153600             MOVE DP015-REVERSE          TO AFCLTYH               15360089
153700             MOVE -1                     TO AFCLTYL               15370089
153800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15380089
153900         WHEN XL071-BAD-DB2-RETURN                                15390089
154000             MOVE '4010-GET-LOC-DESC'    TO DP013-PARAGRAPH       15400089
154100             MOVE 'SELECT LOCATION DESC' TO DP013-MESSAGE-TEXT (1)15410089
154200             MOVE XL071-SQLCA            TO DP013-SQLCA           15420092
154300             MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)15430089
154400             SET DP013-DB2-ABEND                                  15440067
154500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15450089
154600             PERFORM DP013-0000-PROCESS-ABEND                     15460067
154700     END-EVALUATE.                                                15470067
154800                                                                  15480067
154900*----------------------------------------------------------------*15490067
155000*  SELECT THE STATUS CODE DESCRIPTION                            *15500067
155100*----------------------------------------------------------------*15510067
155200                                                                  15520067
155300 4020-GET-STATUS-DESC.                                            15530067
155400                                                                  15540067
155500     EXEC SQL                                                     15550067
155600        SELECT  STATUS_DESC                                       15560067
155700          INTO :STATCD-STATUS-DESC                                15570067
155800          FROM  TSTATCD                                           15580067
155900         WHERE  STATUS_CDE     = :RECITM-STATUS-CDE               15590067
156000           AND  STATUS_TYP_CDE = :PC-R                            15600067
156100     END-EXEC.                                                    15610067
156200                                                                  15620067
156300     EVALUATE TRUE                                                15630067
156400         WHEN SQLCODE = +0                                        15640067
156500             MOVE STATCD-STATUS-DESC                              15650067
156600                               TO ASC-STATUS-DESC                 15660067
156700                                                                  15670067
156800         WHEN SQLCODE = +100                                      15680067
156900             MOVE RECITM-STATUS-CDE                               15690067
157000                               TO ASC-STATUS-DESC                 15700067
157100                                                                  15710067
157200         WHEN SQLWARN0 NOT = SPACES                               15720067
157300         WHEN SQLCODE < +0                                        15730067
157400         WHEN SQLCODE > +0                                        15740067
157500             MOVE '4020-GET-STATUS-DESC'                          15750067
157600                               TO DP013-PARAGRAPH                 15760067
157700             MOVE 'SELECT STATUS DESC '                           15770067
157800                               TO DP013-MESSAGE-TEXT (1)          15780067
157900             MOVE SQLCA        TO DP013-SQLCA                     15790067
158000             MOVE 'TSTATCD'    TO DP013-DB2-TABLE-NAME (1)        15800067
158100             SET DP013-DB2-ABEND                                  15810067
158200                               TO TRUE                            15820067
158300             SET DP013-XCTL-DISPLAY-RESTART                       15830067
158400                               TO TRUE                            15840067
158500             PERFORM DP013-0000-PROCESS-ABEND                     15850067
158600     END-EVALUATE.                                                15860067
158700                                                                  15870067
158800*----------------------------------------------------------------*15880067
158900*  CHECK IF THE PURCHASE ORDER LINE IS IN TROUBLE                *15890067
159000*----------------------------------------------------------------*15900067
159100                                                                  15910067
159200 4030-GET-TROUBLE-DESC.                                           15920067
159300                                                                  15930067
159400     EXEC SQL                                                     15940067
159500        SELECT  TRBL_LONG_DESC                                    15950067
159600          INTO :TRBRSN-TRBL-LONG-DESC                             15960067
159700          FROM  TTRBNTF A,                                        15970067
159800                TTRBRSN B                                         15980067
159900         WHERE  A.OPER_UNT_ID   = :ASC-KEY-OPER-UNT-ID            15990067
160000           AND  A.FCLTY_ID      = :ASC-KEY-FCLTY-ID               16000067
160100           AND  A.PO_NBR        = :DK-PO-NBR                      16010067
160200           AND  A.PO_LNE_NBR    = :ASC-KEY-PO-LNE-NBR             16020067
160300           AND  A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                 16030067
160400           AND (A.RESOLVED_IND ^= :PC-A                           16040067
160500           AND  A.RESOLVED_IND ^= :PC-R)                          16050067
160600           AND  A.TRBL_RSN_CDE  = B.TRBL_RSN_CDE                  16060067
160700           AND  B.NOTIF_IND     = :PC-T                           16070067
160800     END-EXEC.                                                    16080067
160900                                                                  16090067
161000     EVALUATE TRUE                                                16100067
161100         WHEN SQLCODE = +0                                        16110067
161200             MOVE TRBRSN-TRBL-LONG-DESC                           16120067
161300                               TO ASC-TROUBLE-DESC                16130067
161400                                                                  16140067
161500         WHEN SQLCODE = +100                                      16150067
161600             MOVE SPACES       TO ASC-TROUBLE-DESC                16160067
161700                                                                  16170067
161800         WHEN SQLCODE = -811                                      16180067
161900             STRING TRBRSN-TRBL-LONG-DESC '*'                     16190067
162000                 DELIMITED BY SIZE                                16200067
162100                 INTO ASC-TROUBLE-DESC                            16210067
162200                                                                  16220067
162300         WHEN SQLWARN0 NOT = SPACES                               16230067
162400         WHEN SQLCODE < +0                                        16240067
162500         WHEN SQLCODE > +0                                        16250067
162600             MOVE '4030-GET-TROUBLE-DESC'                         16260067
162700                               TO DP013-PARAGRAPH                 16270067
162800             MOVE 'SELECT TROUBLE LONG DESC '                     16280067
162900                               TO DP013-MESSAGE-TEXT (1)          16290067
163000             MOVE SQLCA        TO DP013-SQLCA                     16300067
163100             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        16310067
163200             MOVE 'TTRBRSN'    TO DP013-DB2-TABLE-NAME (2)        16320067
163300             SET DP013-DB2-ABEND                                  16330067
163400                               TO TRUE                            16340067
163500             SET DP013-XCTL-DISPLAY-RESTART                       16350067
163600                               TO TRUE                            16360067
163700             PERFORM DP013-0000-PROCESS-ABEND                     16370067
163800     END-EVALUATE.                                                16380067
163900                                                                  16390067
164000*----------------------------------------------------------------*16400067
164100*  PERFORM ROUTINE TO GET THE TICKET TYPE                        *16410067
164200*----------------------------------------------------------------*16420067
164300 4035-GET-TICKET-TYPE.                                            16430067
164400     PERFORM 4040-SELECT-PRETICKET-TKT-TYPE.                      16440067
164500     IF PS-PRETICKET                                              16450067
164600         PERFORM 4065-SELECT-TKT-FMT-ID                           16460067
164700     ELSE                                                         16470067
164800         MOVE XL001-HNG-FOLD-DESC TO DK-TICKET-DESC               16480070
164900                                     ASC-TKT-DESC                 16490070
165000         PERFORM 4065-SELECT-TKT-FMT-ID                           16500070
165100      END-IF.                                                     16510067
165200                                                                  16520067
165300*----------------------------------------------------------------*16530067
165400*4040-SELECT-PRETICKET-TKT-TYPE                                  *16540067
165500**                                                                16550067
165600*    GET THE TICKET TYPE FROM THE PRETICKET REQUEST              *16560067
165700*----------------------------------------------------------------*16570067
165800                                                                  16580067
165900 4040-SELECT-PRETICKET-TKT-TYPE.                                  16590067
166000                                                                  16600067
166100     EXEC SQL                                                     16610067
166200          SELECT                                                  16620067
166300                TKT_DESC                                          16630067
166400          INTO                                                    16640067
166500                :PTKLNE-TKT-DESC                                  16650067
166600          FROM                                                    16660067
166700                TPTKREQ  A                                        16670067
166800              , TPTKLNE  B                                        16680067
166900          WHERE                                                   16690067
167000              A.PO_NBR     = :DK-PO-NBR                           16700067
167100          AND A.PO_REQ_NBR = B.PO_REQ_NBR                         16710067
167200          AND B.PO_LNE_NBR = :RECITM-ORD-LNE-NBR                  16720067
167300     END-EXEC.                                                    16730067
167400                                                                  16740067
167500     EVALUATE TRUE                                                16750067
167600         WHEN SQLCODE = ZERO                                      16760067
167700              MOVE PTKLNE-TKT-DESC  TO   DK-TICKET-DESC           16770067
167800                                        ASC-TKT-DESC              16780067
167900              SET PS-PRETICKET TO TRUE                            16790067
168000         WHEN SQLCODE = +100                                      16800067
168100              SET PS-NOT-PRETICKET TO TRUE                        16810067
168200*        WHEN SQLCODE = -904                                      16820067
168300*        WHEN SQLCODE = -911                                      16830067
168400*        WHEN SQLCODE = -913                                      16840067
168500*             PERFORM 9900-SOFT-ABORT                             16850067
168600         WHEN SQLWARN0 NOT = SPACE                                16860067
168700         WHEN SQLCODE NOT = ZERO                                  16870067
168800              MOVE '4040-SELECT-PRETICKET-TKT-TYPE'               16880067
168900                               TO DP013-PARAGRAPH                 16890067
169000              MOVE 'SELECT TICKET TYPE FROM REQUEST LINE TABLE'   16900067
169100                               TO DP013-MESSAGE-TEXT (1)          16910067
169200              MOVE SQLCA       TO DP013-SQLCA                     16920067
169300              SET DP013-DB2-ABEND                                 16930067
169400                               TO TRUE                            16940067
169500              PERFORM DP013-0000-PROCESS-ABEND                    16950067
169600     END-EVALUATE.                                                16960067
169700                                                                  16970067
169800 4065-SELECT-TKT-FMT-ID.                                          16980067
169900      EXEC SQL                                                    16990067
170000          SELECT DISTINCT TKT_FMT_ID                              17000067
170100                INTO :TKTFMT-TKT-FMT-ID                           17010067
170200              FROM TTKTFMT                                        17020067
170300           WHERE                                                  17030067
170400              TKT_FMT_DESC = :DK-TICKET-DESC                      17040067
170500     END-EXEC                                                     17050067
170600                                                                  17060067
170700     EVALUATE TRUE                                                17070067
170800           WHEN SQLCODE = +0                                      17080067
170900             MOVE TKTFMT-TKT-FMT-ID  TO RECITM-TKT-FMT-ID         17090067
171000           WHEN SQLCODE = +100                                    17100067
171100                  MOVE SPACES    TO RECITM-TKT-FMT-ID             17110067
171200*            WHEN SQLCODE = -904                                  17120067
171300*            WHEN SQLCODE = -911                                  17130067
171400*            WHEN SQLCODE = -913                                  17140067
171500*                 PERFORM 9900-SOFT-ABORT                         17150067
171600             WHEN SQLWARN0 NOT = SPACES                           17160067
171700             WHEN SQLCODE  NOT = ZERO                             17170067
171800                  MOVE '4065-SELECT-TKT-FMT-ID'                   17180067
171900                                 TO DP013-PARAGRAPH               17190067
172000                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMG'           17200067
172100                                 TO DP013-MESSAGE-TEXT (1)        17210067
172200                  MOVE DK-TICKET-DESC                             17220067
172300                                 TO DP013-MESSAGE-TEXT (2)        17230067
172400                  MOVE SQLCA     TO DP013-SQLCA                   17240067
172500                  MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)      17250067
172600                  SET DP013-DB2-ABEND                             17260067
172700                      DP013-XCTL-DISPLAY-RESTART                  17270067
172800                                 TO TRUE                          17280067
172900                  PERFORM DP013-0000-PROCESS-ABEND                17290067
173000         END-EVALUATE.                                            17300067
173100                                                                  17310067
173200 4100-BUILD-PKITEM-SCREEN.                                        17320067
173300                                                                  17330067
173400     MOVE PURCHS-DEPT-NBR          TO ASC-DEPT-NBR.               17340067
173500     MOVE PURCHS-ENT-ID            TO ASC-ENT-ID.                 17350067
173600     MOVE XL001-SUB-CL-NBR-2CH     TO ASC-CLASS-NBR.              17360088
173700     MOVE PURITM-VEND-STYL-NAME    TO ASC-VEND-STYL-NAME.         17370067
173800     MOVE PURITM-COLOR-DESC        TO ASC-COLOR-DESC.             17380067
173900     MOVE PURITM-SIZE-DESC         TO ASC-SIZE-DESC.              17390067
174000                                                                  17400067
174100/                                                                 17410067
174200                                                                  17420067
174300 4200-BUILD-UNPKSL-SCREEN.                                        17430067
174400                                                                  17440067
174500     MOVE RECITM-VEND-STYL-NAME    TO ASC-VEND-STYL-NAME.         17450067
174600     MOVE RECITM-COLOR-DESC        TO ASC-COLOR-DESC.             17460067
174700     MOVE RECITM-SIZE-DESC         TO ASC-SIZE-DESC.              17470067
174800                                                                  17480067
174900/                                                                 17490067
175000*----------------------------------------------------------------*17500067
175100*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *17510067
175200*----------------------------------------------------------------*17520067
175300 4400-MOVE-COMMAREA-TO-SCREEN.                                    17530067
175400                                                                  17540067
175500     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     17550067
175600     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    17560067
175700     MOVE ASC-FCLTY-DESC           TO AFDESCO.                    17570067
175800     MOVE PC-DASH                  TO ASC-REC-DASH.               17580067
175900     MOVE ASC-RECEIVER             TO ARCVRO.                     17590067
176000     MOVE ASC-PO-LNE-NBR-N         TO ALINEO.                     17600067
176100     MOVE ASC-STATUS-DESC          TO ASTDESCO.                   17610067
176200     MOVE ASC-TROUBLE-DESC         TO ATRBLO.                     17620067
176300     MOVE ASC-INNR-PACK-QTY-N      TO AINNRO.                     17630067
176400     MOVE ASC-PKSL-ITM-QTY         TO APSQTYO.                    17640067
176500     MOVE ASC-GP-RTL-AMT           TO AGRPRTLO.                   17650067
176600     MOVE ASC-CASE-PACK-QTY-N      TO ACASEO.                     17660067
176700     MOVE ASC-DTL-CK-ITM-QTY-N     TO ADCQTYO.                    17670067
176800     MOVE ASC-GP-QTY               TO AGRPQTYO.                   17680067
176900     MOVE ASC-PRE-TKT-IND          TO APRETKTO.                   17690067
177000     MOVE ASC-EXPTED-CART-CNT      TO AEXPCTNO.                   17700067
177100     MOVE ASC-UNT-RTL-PR-AMT       TO ARTLO.                      17710067
177200     MOVE ASC-ACTL-CART-CNT        TO AACTCTNO.                   17720067
177300     MOVE ASC-TKT-DESC             TO ATKTO.                      17730067
177400     MOVE SPACES                   TO ASC-SKU-DASH-1              17740067
177500                                      ASC-SKU-DASH-2.             17750067
177600     MOVE ASC-SKU                  TO ASKUO.                      17760067
177700     MOVE ASC-VEND-STYL-NAME       TO ASTYLEO.                    17770067
177800     MOVE ASC-COLOR-DESC           TO ACOLORO.                    17780067
177900                                                                  17790067
178000     MOVE ASC-SIZE-DESC            TO ASIZEO.                     17800067
178100                                                                  17810067
178200/                                                                 17820067
178300 5000-ADD-RECITM.                                                 17830067
178400     MOVE '5000-ADD-RECITM'           TO PV-LAST-PARAGRAPH.       17840012
178500     MOVE ASC-PO-NBR           TO RECITM-ORD-NBR                  17850067
178600                                  DK-PO-NBR.                      17860067
178700     MOVE ASC-PO-LNE-NBR-N     TO RECITM-ORD-LNE-NBR.             17870067
178800     MOVE ASC-REC-SEQ-NBR      TO RECITM-REC-SEQ-NBR              17880067
178900                                  DK-REC-SEQ-NBR.                 17890067
179000     MOVE ASC-KEY-OPER-UNT-ID  TO RECITM-OPER-UNT-ID.             17900067
179100     MOVE ASC-KEY-FCLTY-ID     TO RECITM-FCLTY-ID.                17910067
179200     MOVE ASC-PURITM-VER-NBR   TO RECITM-PO-VER-NBR.              17920067
179300     MOVE ASC-ITM-NBR          TO RECITM-ITM-NBR.                 17930067
179400     MOVE ASC-PRE-TKT-IND      TO RECITM-PRE-TKT-IND.             17940067
179500     MOVE SPACES               TO RECITM-TKT-FMT-ID.              17950067
179600     MOVE SPACES               TO RECITM-RTV-IND.                 17960067
179700     MOVE PC-IP                TO RECITM-STATUS-CDE.              17970067
179800     MOVE ZERO                 TO RECITM-PKSL-ITM-QTY.            17980078
179900     MOVE ASC-DTL-CK-ITM-QTY-N TO RECITM-DTL-CK-ITM-QTY.          17990067
180000     MOVE ASC-INNR-PACK-QTY-N  TO RECITM-INNR-PACK-QTY.           18000067
180100     MOVE ASC-CASE-PACK-QTY-N  TO RECITM-CASE-PACK-QTY.           18010067
180200     MOVE ZERO                 TO RECITM-RTV-QTY.                 18020067
180300     MOVE ZERO                 TO RECITM-EXPTED-CART-CNT.         18030067
180400     MOVE ZERO                 TO RECITM-ACTL-CART-CNT.           18040067
180500     MOVE ASC-UNT-COST-AMT     TO RECITM-UNT-COST-AMT.            18050083
180600     MOVE ASC-UNT-RTL-PR-AMT   TO RECITM-UNT-RTL-AMT.             18060083
180700     MOVE ASC-GP-RTL-AMT       TO RECITM-GP-RTL-AMT.              18070083
180800     MOVE ASC-GP-QTY           TO RECITM-GP-QTY.                  18080083
180900                                                                  18090075
181000     MOVE SPACES               TO RECITM-COLOR-DESC.              18100067
181100     MOVE SPACES               TO RECITM-SIZE-DESC.               18110067
181200     MOVE SPACES               TO RECITM-VEND-STYL-NAME.          18120067
181300     MOVE SPACES               TO RECITM-VEND-DESC.               18130067
181400     MOVE SPACES               TO RECITM-PKSL-NBR.                18140067
181500     MOVE ZERO                 TO RECITM-REC-INV-LNE-NBR          18150067
181600                                  RECITM-DMG-ITM-QTY.             18160067
181700     MOVE PC-DEFAULT-TMST      TO RECITM-MKING-APRON-TMST         18170067
181800                                  RECITM-VERFYD-TMST.             18180067
181900     MOVE ASC-DEPT-NBR         TO DK-DEPT-NBR.                    18190067
182000     MOVE ASC-KEY-OPER-UNT-ID  TO DK-OPER-UNT-ID.                 18200067
182100     MOVE ASC-KEY-FCLTY-ID     TO DK-FCLTY-ID.                    18210067
182200                                                                  18220067
182300     MOVE ASC-TKT-DESC TO DK-TICKET-DESC.                         18230067
182400     PERFORM 4065-SELECT-TKT-FMT-ID.                              18240067
182500                                                                  18250067
182600     PERFORM 9005-SELECT-INACTIVE.                                18260067
182700                                                                  18270067
182800     IF PS-INACTIVE-EXISTS                                        18280067
182900        PERFORM 9006-UPDATE-RECITM                                18290067
183000     ELSE                                                         18300067
183100        PERFORM 9010-INSERT-RECITM                                18310067
183200     END-IF.                                                      18320067
183300                                                                  18330067
183400     IF  SQLCODE = +0                                             18340067
183500                                                                  18350067
183600         PERFORM 2130-CHECK-PACK-BY-STORE                         18360067
183700                                                                  18370067
183800         SET DP020-MSG-INFORMATIONAL                              18380067
183900                                 TO  TRUE                         18390067
184000         IF PV-PACK-BY-ST-IND = PC-Y                              18400067
184100             MOVE PC-TSYMSG-01293 TO DP020-MSG-NUMBER             18410067
184200         ELSE                                                     18420067
184300*            PERFORM 9020-PREPARE-TRECDIS                         18430067
184400             PERFORM 9040-CHECK-FOR-TROUBLE                       18440067
184500             MOVE PV-TROUBLE-COUNT   TO  DP020-MSG-TEXT           18450067
184600                                                                  18460067
184700             PERFORM 5050-CHECK-IF-IN-TROUBLE                     18470067
184800             IF PV-DB2-COUNT > ZERO                               18480067
184900                 MOVE PC-TSYMSG-01002 TO DP020-MSG-NUMBER         18490067
185000             ELSE                                                 18500067
185100                 MOVE PC-TSYMSG-00790 TO DP020-MSG-NUMBER         18510067
185200             END-IF                                               18520067
185300         END-IF                                                   18530067
185400                                                                  18540067
185500         IF  ASC-USE-SELECTION-QUEUE                              18550067
185600             PERFORM 5300-UPDATE-SELECTION-QUEUE                  18560067
185700         END-IF                                                   18570067
185800     ELSE                                                         18580067
185900         MOVE PC-TSYMSG-00117                                     18590067
186000                           TO DP020-MSG-NUMBER                    18600067
186100         SET DP020-MSG-INFORMATIONAL                              18610067
186200             DP030-OVERRIDE-GO                                    18620067
186300                           TO TRUE                                18630067
186400                                                                  18640067
186500     END-IF.                                                      18650067
186600                                                                  18660067
186700     PERFORM 4020-GET-STATUS-DESC.                                18670067
186800                                                                  18680067
186900/                                                                 18690067
187000 5050-CHECK-IF-IN-TROUBLE.                                        18700067
187100                                                                  18710067
187200     MOVE ZERO           TO  PV-DB2-COUNT.                        18720067
187300         EXEC SQL                                                 18730067
187400              SELECT COUNT(*)                                     18740067
187500                INTO :PV-DB2-COUNT :PV-NULL-IND                   18750067
187600                FROM TTRBNTF A                                    18760067
187700               WHERE A.PO_NBR        = :DK-PO-NBR                 18770067
187800                 AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR            18780067
187900                 AND A.PO_LNE_NBR    = :PC-LONG-ZERO              18790067
188000                 AND A.RESOLVED_IND IN ('N','I')                  18800067
188100         END-EXEC                                                 18810067
188200                                                                  18820067
188300         EVALUATE TRUE                                            18830067
188400             WHEN SQLCODE = +0                                    18840067
188500             WHEN SQLCODE = +100                                  18850067
188600                  CONTINUE                                        18860067
188700             WHEN SQLWARN0 NOT = SPACES                           18870067
188800             WHEN SQLCODE < +0                                    18880067
188900             WHEN SQLCODE > +0                                    18890067
189000                  MOVE '5050-CHECK-IF-IN-TROUBLE'                 18900067
189100                                  TO DP013-PARAGRAPH              18910067
189200                  MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'        18920067
189300                                  TO DP013-MESSAGE-TEXT (1)       18930067
189400                  MOVE SQLCA      TO DP013-SQLCA                  18940067
189500                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     18950067
189600                  SET DP013-DB2-ABEND                             18960067
189700                      DP013-XCTL-DISPLAY-RESTART                  18970067
189800                                  TO TRUE                         18980067
189900                  PERFORM DP013-0000-PROCESS-ABEND                18990067
190000         END-EVALUATE.                                            19000067
190100/                                                                 19010067
190200/                                                                 19020067
190300*----------------------------------------------------------------*19030067
190400* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *19040067
190500* OBJECT WAS UDPATED.                                            *19050067
190600*----------------------------------------------------------------*19060067
190700                                                                  19070067
190800 5300-UPDATE-SELECTION-QUEUE.                                     19080067
190900                                                                  19090067
191000     PERFORM 9100-READ-SEL-QUEUE.                                 19100067
191100                                                                  19110067
191200     SET PC016-UPD (ASC-SEL-SUB)   TO TRUE.                       19120067
191300     SET ASC-RECITM-SETUP-PREV     TO TRUE.                       19130067
191400                                                                  19140067
191500     PERFORM 9200-REWRITE-SEL-QUEUE.                              19150067
191600                                                                  19160067
191700/                                                                 19170067
191800*-----------------------------------------------------------------19180094
191900* CHECK TO SEE IF THIS DC IS DOWNLOADING ASN'S TO WMS             19190094
192000*-----------------------------------------------------------------19200094
192100 6300-CHECK-DC-OK-FOR-DWNLD.                                      19210094
192200                                                                  19220094
192300     SET PS-DWNLD-TO-WMS-NO   TO TRUE.                            19230094
192400     MOVE RECEIV-CURR-OPER-UNT-ID  TO KRPRPM-LOC-ID.              19240099
192500                                                                  19250094
192600     PERFORM                                                      19260094
192700         WITH TEST AFTER                                          19270094
192800         VARYING PV-RETRY-COUNTER                                 19280094
192900         FROM 1 BY 1                                              19290094
193000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19300094
193100            OR (SQLCODE = +0)                                     19310094
193200            OR (SQLCODE = +100))                                  19320094
193300                                                                  19330094
193400         EXEC SQL                                                 19340094
193500              SELECT   FUNC_TXT                                   19350094
193600                    ,  FUNC_BEG_TMST                              19360094
193700                    ,  FUNC_END_TMST                              19370094
193800                INTO  :KRPRPM-FUNC-TXT                            19380094
193900                    , :KRPRPM-FUNC-BEG-TMST                       19390094
194000                    , :KRPRPM-FUNC-END-TMST                       19400094
194100                FROM                                              19410094
194200                      TKRPRPM A                                   19420094
194300                WHERE                                             19430094
194400                      LOC_ID            = :KRPRPM-LOC-ID          19440094
194500                  AND SYS_PRC_FUNC_CDE  = :PC-DWNLD-CDE           19450094
194600                  AND FUNC_PRC_STAT_CDE = 'AC'                    19460094
194700                  AND INTFC_SYS_CDE     = 'KHL'                   19470094
194800                  AND FUNC_BEG_TMST     <= CURRENT TIMESTAMP      19480094
194900         END-EXEC                                                 19490094
195000                                                                  19500094
195100         EVALUATE TRUE                                            19510094
195200             WHEN SQLCODE = +0                                    19520094
195300                  SET  PS-DWNLD-TO-WMS-YES TO  TRUE               19530094
195310             WHEN SQLCODE = +100                                  19531099
195320                  SET  PS-DWNLD-TO-WMS-NO  TO  TRUE               19532099
195400                                                                  19540094
195500             WHEN SQLWARN0 NOT = SPACES                           19550094
195600             WHEN SQLCODE < +0                                    19560094
195700             WHEN SQLCODE > +0                                    19570094
195800                  MOVE '6300-CHECK-DC-OK-FOR-DWNLD'               19580094
195900                                  TO DP013-PARAGRAPH              19590094
196000                  MOVE 'UNSUCCESSFUL SELECT ON TKRPRPM'           19600094
196100                                  TO DP013-MESSAGE-TEXT (1)       19610094
196200                  MOVE SQLCA      TO DP013-SQLCA                  19620094
196300                  MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)     19630094
196400                  SET DP013-DB2-ABEND                             19640094
196500                      DP013-XCTL-DISPLAY-RESTART                  19650094
196600                                  TO TRUE                         19660094
196700                  PERFORM DP013-0000-PROCESS-ABEND                19670094
196800         END-EVALUATE                                             19680094
196900     END-PERFORM.                                                 19690094
197000                                                                  19700094
197100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    19710094
197200         SQLCODE NOT = +0                                         19720094
197300         MOVE '6300-CHECK-DC-OK-FOR-DWNLD'                        19730094
197400                                  TO DP013-PARAGRAPH              19740094
197500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TKRPRPM'            19750094
197600                                  TO DP013-MESSAGE-TEXT (1)       19760094
197700         MOVE SQLCA               TO DP013-SQLCA                  19770094
197800         MOVE 'TKRPRPM '          TO DP013-DB2-TABLE-NAME (1)     19780094
197900         SET DP013-DB2-ABEND                                      19790094
198000             DP013-XCTL-DISPLAY-RESTART                           19800094
198100                                  TO TRUE                         19810094
198200         PERFORM DP013-0000-PROCESS-ABEND                         19820094
198300     END-IF.                                                      19830094
198400                                                                  19840094
198410***************************************************************** 19841099
198420*  THIS PARAGRAPH GETS THE CURRENT OPER ID FOR THE PO/RCVR        19842099
198430***************************************************************** 19843099
198440 6310-SELECT-TRECEIV.                                             19844099
198450                                                                  19845099
198460     MOVE ASC-KEY-PO-NBR       TO RECEIV-ORD-NBR.                 19846099
198470     MOVE ASC-KEY-REC-SEQ-NBR  TO RECEIV-REC-SEQ-NBR.             19847099
198480                                                                  19848099
198490     EXEC SQL                                                     19849099
198491          SELECT   CURR_OPER_UNT_ID                               19849199
198492            INTO  :RECEIV-CURR-OPER-UNT-ID                        19849299
198493            FROM                                                  19849399
198494                  TRECEIV                                         19849499
198495            WHERE                                                 19849599
198496                  ORD_NBR           = :RECEIV-ORD-NBR             19849699
198497              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         19849799
198498              AND VER_STATUS_CDE    = 'A'                         19849899
198499     END-EXEC.                                                    19849999
198500                                                                  19850099
198501     EVALUATE TRUE                                                19850199
198502         WHEN SQLCODE = ZERO                                      19850299
198503         WHEN SQLCODE = -811                                      19850399
198504              CONTINUE                                            19850499
198505         WHEN SQLCODE = +100                                      19850599
198506              MOVE ZERO             TO RECEIV-CURR-OPER-UNT-ID    19850699
198507         WHEN SQLWARN0 NOT = SPACES                               19850799
198508         WHEN SQLCODE  NOT = ZERO                                 19850899
198511             MOVE '6310-SELECT-TRECEIV'                           19851199
198512                                  TO DP013-PARAGRAPH              19851299
198513             MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'                19851399
198514                                  TO DP013-MESSAGE-TEXT (1)       19851499
198515             MOVE SQLCA      TO DP013-SQLCA                       19851599
198516             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          19851699
198517             SET DP013-DB2-ABEND                                  19851799
198518                 DP013-XCTL-DISPLAY-RESTART                       19851899
198519                                  TO TRUE                         19851999
198520             PERFORM DP013-0000-PROCESS-ABEND                     19852099
198521     END-EVALUATE.                                                19852199
198522                                                                  19852299
198530*-----------------------------------------------------------------19853094
198600*  CALL CONTROL MODULE TO DOWNLOAD TO WMS                         19860094
198700*-----------------------------------------------------------------19870094
198800 6600-CALL-WMS-MODULE.                                            19880094
198900                                                                  19890094
199000     INITIALIZE WS001-FIELDS.                                     19900094
199100                                                                  19910094
199110* JAK 04/08/07 - CHANGED FROM MANUAL-DOWNLOAD TO INSERT           19911099
199200     SET WS001-INSERT               TO TRUE.                      19920099
199600     SET WS001-SOURCE-RCVNG         TO TRUE.                      19960099
199601     MOVE 'RC'                      TO WS001-SHIPMENT-SOURCE.     19960199
199610     MOVE ASC-KEY-OPER-UNT-ID       TO WS001-OPER-UNT-ID.         19961099
199700     MOVE DP020-USERID              TO WS001-USER-ID.             19970099
199701     MOVE DP020-SRC-TASK-NUMBER     TO WS001-SRC-TASK-NUMBER.     19970199
199710     MOVE ASC-KEY-PO-NBR            TO WS001-PO-NBR.              19971099
199720     MOVE ASC-KEY-REC-SEQ-NBR       TO WS001-RCVR-NBR.            19972099
199800     MOVE ASC-KEY-PO-LNE-NBR        TO WS001-PO-LNE-NBR.          19980099
200100     MOVE SPACES                    TO WS001-DTL-ASN-LEVEL-IND.   20010099
200110     MOVE PC-CURRENT-PROGRAM-NAME   TO WS001-CALLING-PROGRAM-NAME.20011099
200120* JAK 04/08/07 - GET THE TRIP-ID AND LOAD TO WS001                20012099
200130     PERFORM 6610-GET-TRIP-ID.                                    20013099
200140     MOVE SHIPMT-TRIP-ID            TO WS001-TRIP-ID.             20014099
200200                                                                  20020097
200300     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         20030097
200400                                                                  20040097
200500     EXEC CICS                                                    20050097
200600         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       20060097
200700              COMMAREA (WS001-FIELDS)                             20070097
200800              LENGTH   (PV-COMMAREA-LENGTH)                       20080097
200900     END-EXEC.                                                    20090097
201000                                                                  20100097
201100     EVALUATE TRUE                                                20110097
201200         WHEN WS001-SUCCESSFUL                                    20120097
201300              CONTINUE                                            20130097
201310         WHEN WS001-DATABASE-BUSY OR                              20131099
201320              WS001-INVALID-SQL                                   20132099
201330                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       20133099
201340                  SET DP020-MSG-WARNING TO TRUE                   20134099
201350                  SET DP030-OVERRIDE-GO TO TRUE                   20135099
201360                  SET PS-ERROR          TO TRUE                   20136099
201370                                                                  20137099
201380                                                                  20138099
201390              INITIALIZE PV-CICS-MSG-AREA                         20139099
201391              STRING 'RCKCS257-'                                  20139199
201392                     '6600-CALL-WMS-MODULE - '                    20139299
201393              DELIMITED BY SIZE                                   20139399
201394              INTO PV-CICS-MSG-AREA                               20139499
201395              PERFORM 9903-WRITE-CICS-LOG                         20139599
201396                                                                  20139699
201397              INITIALIZE PV-CICS-MSG-AREA                         20139799
201398              STRING 'RCKCS257-'                                  20139899
201399                     WS001-CRA-RET-MSG                            20139999
201400              DELIMITED BY SIZE                                   20140099
201401              INTO PV-CICS-MSG-AREA                               20140199
201402              PERFORM 9903-WRITE-CICS-LOG                         20140299
201403                                                                  20140399
201404                                                                  20140499
201405         WHEN WS001-ERROR                                         20140599
201406                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       20140699
201407                  SET DP020-MSG-WARNING TO TRUE                   20140799
201408                  SET DP030-OVERRIDE-GO TO TRUE                   20140899
201409                  SET PS-ERROR          TO TRUE                   20140999
201410                                                                  20141099
201411              INITIALIZE PV-CICS-MSG-AREA                         20141199
201412              STRING 'RCKCS257-'                                  20141299
201413                     '6600-CALL-WMS-MODULE - '                    20141399
201414              DELIMITED BY SIZE                                   20141499
201415              INTO PV-CICS-MSG-AREA                               20141599
201416              PERFORM 9903-WRITE-CICS-LOG                         20141699
201417                                                                  20141799
201418              INITIALIZE PV-CICS-MSG-AREA                         20141899
201419              STRING 'RCKCS257-'                                  20141999
201420                     WS001-CRA-RET-MSG                            20142099
201421              DELIMITED BY SIZE                                   20142199
201422              INTO PV-CICS-MSG-AREA                               20142299
201423              PERFORM 9903-WRITE-CICS-LOG                         20142399
201424                                                                  20142499
201425         WHEN OTHER                                               20142599
201426                                                                  20142699
201427              INITIALIZE PV-CICS-MSG-AREA                         20142799
201428              STRING 'RCKCS257-'                                  20142899
201429                     '6600-CALL-WMS-MODULE - '                    20142999
201430              DELIMITED BY SIZE                                   20143099
201431              INTO PV-CICS-MSG-AREA                               20143199
201432              PERFORM 9903-WRITE-CICS-LOG                         20143299
201433                                                                  20143399
201434              INITIALIZE PV-CICS-MSG-AREA                         20143499
201435              STRING 'RCKCS257-'                                  20143599
201436                     WS001-CRA-RET-MSG                            20143699
201437              DELIMITED BY SIZE                                   20143799
201438              INTO PV-CICS-MSG-AREA                               20143899
201439              PERFORM 9903-WRITE-CICS-LOG                         20143999
201440                                                                  20144099
201441             MOVE '6600-CALL-WMS-MODULE' TO DP013-PARAGRAPH       20144199
201442             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 20144299
201443                                         TO DP013-MESSAGE-TEXT (1)20144399
201444             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)20144499
201445             MOVE WS001-SQLCA            TO DP013-SQLCA           20144599
201446             SET DP013-DB2-ABEND                                  20144699
201447                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              20144799
201448             SET PS-ERROR                    TO TRUE              20144899
201449             PERFORM DP013-0000-PROCESS-ABEND                     20144999
201450                                                                  20145099
208300     END-EVALUATE.                                                20830097
208400                                                                  20840097
208500/                                                                 20850097
208501* JAK 04/08/07 - NEW PARAGRAPH TO GET THE TRIP-ID                 20850199
208510*----------------------------------------------------------------*20851099
208520*    GET THE TRIP ID                                              20852099
208530*----------------------------------------------------------------*20853099
208550 6610-GET-TRIP-ID.                                                20855099
208560                                                                  20856099
208570     MOVE '6610-GET-TRIP-ID'          TO PV-LAST-PARAGRAPH.       20857099
208580                                                                  20858099
208590     EXEC SQL                                                     20859099
208591          SELECT A.TRIP_ID                                        20859199
208592            INTO :SHIPMT-TRIP-ID                                  20859299
208593            FROM TSHIPMT   A                                      20859399
208594               , TSHPTPO   B                                      20859499
208595           WHERE B.PO_NBR       = :WS001-PO-NBR                   20859599
208596             AND B.REC_SEQ_NBR  = :WS001-RCVR-NBR                 20859699
208597             AND A.SHIPT_ID     = B.SHIPT_ID                      20859799
208599     END-EXEC.                                                    20859999
208600                                                                  20860099
208601     EVALUATE TRUE                                                20860199
208602         WHEN SQLCODE = +0                                        20860299
208603              CONTINUE                                            20860399
208607         WHEN SQLWARN0 NOT = SPACES                               20860799
208608         WHEN SQLCODE < +0                                        20860899
208609         WHEN SQLCODE > +0                                        20860999
208610              MOVE '6610-GET-TRIP-ID'                             20861099
208611                               TO DP013-PARAGRAPH                 20861199
208612              MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT & TSHPTPO'     20861299
208613                               TO DP013-MESSAGE-TEXT (1)          20861399
208614              MOVE SQLCA       TO DP013-SQLCA                     20861499
208615              MOVE 'TSHIPMT '  TO DP013-DB2-TABLE-NAME (1)        20861599
208616              MOVE 'TSHPTPO '  TO DP013-DB2-TABLE-NAME (2)        20861699
208617              SET DP013-DB2-ABEND                                 20861799
208618                  DP013-XCTL-DISPLAY-RESTART                      20861899
208619                               TO TRUE                            20861999
208620              PERFORM DP013-0000-PROCESS-ABEND                    20862099
208621     END-EVALUATE.                                                20862199
208622                                                                  20862299
208630*----------------------------------------------------------------*20863097
208700*    INSERT A RECEIPT ITEM ROW                                   *20870097
208800*----------------------------------------------------------------*20880067
208900                                                                  20890067
209000 9005-SELECT-INACTIVE.                                            20900067
209100                                                                  20910067
209200     MOVE '9005-SELECT-INACTIVE'      TO PV-LAST-PARAGRAPH.       20920012
209300                                                                  20930067
209400     EXEC SQL                                                     20940067
209500          SELECT ORD_NBR                                          20950067
209600            INTO :RECITM-ORD-NBR                                  20960067
209700            FROM TRECITM                                          20970067
209800           WHERE ORD_NBR        = :RECITM-ORD-NBR                 20980067
209900             AND ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR             20990067
210000             AND REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR             21000067
210100             AND VER_STATUS_CDE = 'I'                             21010067
210200     END-EXEC.                                                    21020067
210300                                                                  21030067
210400     EVALUATE TRUE                                                21040067
210500         WHEN SQLCODE = +0                                        21050067
210600              SET PS-INACTIVE-EXISTS TO TRUE                      21060067
210700         WHEN SQLCODE = +100                                      21070067
210800              CONTINUE                                            21080067
210900                                                                  21090067
211000         WHEN SQLWARN0 NOT = SPACES                               21100067
211100         WHEN SQLCODE < +0                                        21110067
211200         WHEN SQLCODE > +0                                        21120067
211300              MOVE '9010-SELECT-INACTIVE'                         21130067
211400                               TO DP013-PARAGRAPH                 21140067
211500              MOVE 'UNSUCCESSFUL SELECT ON TRECITM'               21150067
211600                               TO DP013-MESSAGE-TEXT (1)          21160067
211700              MOVE SQLCA       TO DP013-SQLCA                     21170067
211800              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        21180067
211900              SET DP013-DB2-ABEND                                 21190067
212000                  DP013-XCTL-DISPLAY-RESTART                      21200067
212100                               TO TRUE                            21210067
212200              PERFORM DP013-0000-PROCESS-ABEND                    21220067
212300     END-EVALUATE.                                                21230067
212400                                                                  21240067
212500 9006-UPDATE-RECITM.                                              21250067
212600                                                                  21260067
212700                                                                  21270067
212800     EXEC SQL                                                     21280067
212900          UPDATE TRECITM                                          21290067
213000             SET DTL_CK_ITM_QTY  = :RECITM-DTL-CK-ITM-QTY         21300067
213100                ,INNR_PACK_QTY   = :RECITM-INNR-PACK-QTY          21310067
213200                ,CASE_PACK_QTY   = :RECITM-CASE-PACK-QTY          21320067
213300                ,VER_STATUS_CDE  = 'A'                            21330067
213400           WHERE ORD_NBR      = :RECITM-ORD-NBR                   21340067
213500             AND ORD_LNE_NBR  = :RECITM-ORD-LNE-NBR               21350067
213600             AND REC_SEQ_NBR  = :RECITM-REC-SEQ-NBR               21360067
213700     END-EXEC.                                                    21370067
213800                                                                  21380067
213900     EVALUATE TRUE                                                21390067
214000         WHEN SQLCODE = +0                                        21400067
214100              CONTINUE                                            21410067
214200                                                                  21420067
214300         WHEN SQLWARN0 NOT = SPACES                               21430067
214400         WHEN SQLCODE < +0                                        21440067
214500         WHEN SQLCODE > +0                                        21450067
214600              MOVE '9010-SELECT-INACTIVE'                         21460067
214700                               TO DP013-PARAGRAPH                 21470067
214800              MOVE 'UNSUCCESSFUL SELECT ON TRECITM'               21480067
214900                               TO DP013-MESSAGE-TEXT (1)          21490067
215000              MOVE SQLCA       TO DP013-SQLCA                     21500067
215100              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        21510067
215200              SET DP013-DB2-ABEND                                 21520067
215300                  DP013-XCTL-DISPLAY-RESTART                      21530067
215400                               TO TRUE                            21540067
215500              PERFORM DP013-0000-PROCESS-ABEND                    21550067
215600     END-EVALUATE.                                                21560067
215700                                                                  21570067
215800 9010-INSERT-RECITM.                                              21580067
215900                                                                  21590067
216000                                                                  21600012
216100* THIS CODE WRITES AN AUDIT TRAIL TO THE CICS LOG WHEN            21610067
216200* A REC-SEQ-NBR COULD BE WRITTEN                                  21620067
216300     IF RECITM-REC-SEQ-NBR = ZERO                                 21630012
216400         MOVE SPACES                  TO PV-CICS-MSG-AREA         21640012
216500         PERFORM 9903-WRITE-CICS-LOG                              21650012
216600         MOVE ALL '*'                 TO PV-CICS-MSG-AREA         21660012
216700         PERFORM 9903-WRITE-CICS-LOG                              21670012
216800                                                                  21680012
216900         EXEC SQL SET :PV-BOMB-TMST = CURRENT TIMESTAMP END-EXEC  21690012
217000                                                                  21700012
217100         STRING ' RCKCS257 IS WRITING AN INVALID ROW TO RECITM'   21710012
217200                 ' ' PV-BOMB-TMST DELIMITED BY SIZE               21720012
217300                                      INTO PV-CICS-MSG-AREA       21730012
217400                                                                  21740012
217500         PERFORM 9903-WRITE-CICS-LOG                              21750012
217600                                                                  21760012
217700         STRING ' MODIFYING PARA: ' PV-LAST-PARAGRAPH             21770012
217800                 DELIMITED BY SIZE    INTO PV-CICS-MSG-AREA       21780012
217900         PERFORM 9903-WRITE-CICS-LOG                              21790012
218000                                                                  21800012
218100         MOVE ASC-KEY-REC-SEQ-NBR     TO PV-DISPLAY-NUMBER        21810012
218200         STRING ' ASC-KEY-REC-SEQ-NBR: ' PV-DISPLAY-NUMBER        21820012
218300                 DELIMITED BY SIZE    INTO PV-CICS-MSG-AREA       21830012
218400         PERFORM 9903-WRITE-CICS-LOG                              21840012
218500                                                                  21850012
218600         MOVE RECITM-ORD-NBR          TO PV-MSG-KEY-PO            21860012
218700         MOVE RECITM-REC-SEQ-NBR      TO PV-MSG-KEY-REC-SEQ-NBR-N 21870012
218800         MOVE RECITM-ORD-LNE-NBR      TO PV-MSG-KEY-PO-LNE-NBR-N  21880012
218900         MOVE PV-MSG-KEYS             TO PV-CICS-MSG-AREA         21890012
219000         PERFORM 9903-WRITE-CICS-LOG                              21900012
219100                                                                  21910012
219200         MOVE DP020-LOCATION-NBR      TO PV-UNPACK-LOC-NBR        21920091
219300         STRING ' USER= '              DP020-USERID               21930091
219400                ' LOCATION= '          PV-UNPACK-LOC-NBR          21940091
219500                ' NEXT APPL= '         DP020-NEXT-APPL-ACTIVITY   21950091
219600                 DELIMITED BY SIZE                                21960091
219700                                      INTO PV-CICS-MSG-AREA       21970091
219800         PERFORM 9903-WRITE-CICS-LOG                              21980091
219900         PERFORM 9903-WRITE-CICS-LOG                              21990091
220000                                                                  22000091
220100         STRING ' DP020-SRC-TRAN-ID= '  DP020-SRC-TRAN-ID         22010091
220200                ' DP020-SRC-MNEMONIC= ' DP020-SRC-MNEMONIC        22020091
220300                 DELIMITED BY SIZE                                22030091
220400                 INTO PV-CICS-MSG-AREA                            22040091
220500         PERFORM 9903-WRITE-CICS-LOG                              22050091
220600                                                                  22060091
220700         STRING ' DP020-SRC-AID= '      DP020-SRC-AID             22070091
220800                ' DP020-FK-ACTION= '    DP020-FK-ACTION           22080091
220900                                           (DP020-SRC-AID)        22090091
221000                ' DP020-FK-MNEMONIC= '    DP020-FK-MNEMONIC       22100091
221100                                           (DP020-SRC-AID)        22110091
221200                 DELIMITED BY SIZE                                22120091
221300                 INTO PV-CICS-MSG-AREA                            22130091
221400         PERFORM 9903-WRITE-CICS-LOG                              22140091
221500         PERFORM 9903-WRITE-CICS-LOG                              22150091
221600                                                                  22160091
221700         PERFORM VARYING PV-STACK-SUB FROM 1 BY 1                 22170091
221800             UNTIL PV-STACK-SUB > DP020-ENTRIES-IN-STACK          22180091
221900             STRING ' ' DP020-STACK-TRAN-ID (PV-STACK-SUB)        22190091
222000                    '  ' DP020-STACK-MNEMONIC (PV-STACK-SUB)      22200091
222100                    DELIMITED BY SIZE                             22210091
222200                                      INTO PV-CICS-MSG-AREA       22220091
222300             PERFORM 9903-WRITE-CICS-LOG                          22230091
222400         END-PERFORM                                              22240091
222500                                                                  22250091
222600         MOVE ALL '*'                 TO PV-CICS-MSG-AREA         22260091
222700         PERFORM 9903-WRITE-CICS-LOG                              22270091
222800         PERFORM 9903-WRITE-CICS-LOG                              22280091
222900     END-IF.                                                      22290091
223000                                                                  22300079
223100*TCR  AUTOVE                                                      22310079
223200         SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                     22320079
223300         PERFORM 9015-CHECK-ASN.                                  22330079
223400         MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                          22340079
223500         IF PS-ORIG-ASN-PKSLIP-YES                                22350079
223600            MOVE RECITM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY      22360079
223700         END-IF.                                                  22370079
223800*TCR  AUTOVE                                                      22380079
223900                                                                  22390079
224000                                                                  22400067
224100     EXEC SQL                                                     22410067
224200          INSERT INTO TRECITM                                     22420067
224300                 (ORD_NBR,                                        22430067
224400                  ORD_LNE_NBR,                                    22440067
224500                  REC_SEQ_NBR,                                    22450067
224600                  OPER_UNT_ID,                                    22460067
224700                  FCLTY_ID,                                       22470067
224800                  CRE_TMST,                                       22480067
224900                  CRE_UID,                                        22490067
225000                  PO_VER_NBR,                                     22500067
225100                  ITM_NBR,                                        22510067
225200                  PRE_TKT_IND,                                    22520067
225300                  TKT_FMT_ID,                                     22530067
225400                  RTV_IND,                                        22540067
225500                  STATUS_CDE,                                     22550067
225600                  VER_STATUS_CDE,                                 22560067
225700                  PKSL_ITM_QTY,                                   22570067
225800                  DTL_CK_ITM_QTY,                                 22580067
225900                  INNR_PACK_QTY,                                  22590067
226000                  CASE_PACK_QTY,                                  22600067
226100                  RTV_QTY,                                        22610067
226200                  EXPTED_CART_CNT,                                22620067
226300                  ACTL_CART_CNT,                                  22630067
226400                  MKING_APRON_TMST,                               22640067
226500                  UNT_COST_AMT,                                   22650067
226600                  COLOR_DESC,                                     22660067
226700                  SIZE_DESC,                                      22670067
226800                  VEND_STYL_NAME,                                 22680067
226900                  VEND_DESC,                                      22690067
227000                  VERFYD_TMST,                                    22700067
227100                  PKSL_NBR,                                       22710067
227200                  REC_INV_LNE_NBR,                                22720067
227300                  DMG_ITM_QTY,                                    22730067
227400                  UPD_PGM_ID,                                     22740067
227500                  LAST_TRSCP_TMST,                                22750067
227600                  LAST_TRSCP_USR_ID,                              22760076
227700                  UNT_RTL_AMT,                                    22770076
227800                  GP_RTL_AMT,                                     22780076
227900                  GP_QTY,                                         22790078
228000                  ORIG_PKSL_ITM_QTY)                              22800078
228100          VALUES (:RECITM-ORD-NBR,                                22810067
228200                  :RECITM-ORD-LNE-NBR,                            22820067
228300                  :RECITM-REC-SEQ-NBR,                            22830067
228400                  :RECITM-OPER-UNT-ID,                            22840067
228500                  :RECITM-FCLTY-ID,                               22850067
228600                   CURRENT TIMESTAMP,                             22860067
228700                  :DP020-USERID,                                  22870067
228800                  :RECITM-PO-VER-NBR,                             22880067
228900                  :RECITM-ITM-NBR,                                22890067
229000                  :RECITM-PRE-TKT-IND,                            22900067
229100                  :RECITM-TKT-FMT-ID,                             22910067
229200                  :RECITM-RTV-IND,                                22920067
229300                  :RECITM-STATUS-CDE,                             22930067
229400                  :PC-ACTIVE,                                     22940067
229500                  :RECITM-PKSL-ITM-QTY,                           22950067
229600                  :RECITM-DTL-CK-ITM-QTY,                         22960067
229700                  :RECITM-INNR-PACK-QTY,                          22970067
229800                  :RECITM-CASE-PACK-QTY,                          22980067
229900                  :RECITM-RTV-QTY,                                22990067
230000                  :RECITM-EXPTED-CART-CNT,                        23000067
230100                  :RECITM-ACTL-CART-CNT,                          23010067
230200                  :RECITM-MKING-APRON-TMST,                       23020067
230300                  :RECITM-UNT-COST-AMT,                           23030067
230400                  :RECITM-COLOR-DESC,                             23040067
230500                  :RECITM-SIZE-DESC,                              23050067
230600                  :RECITM-VEND-STYL-NAME,                         23060067
230700                  :RECITM-VEND-DESC,                              23070067
230800                  :RECITM-VERFYD-TMST,                            23080067
230900                  :RECITM-PKSL-NBR,                               23090067
231000                  :RECITM-REC-INV-LNE-NBR,                        23100067
231100                  :RECITM-DMG-ITM-QTY,                            23110067
231200                  :PC-CURRENT-PROGRAM-NAME,                       23120067
231300                  CURRENT TIMESTAMP,                              23130067
231400                  :DP020-USERID,                                  23140076
231500                  :RECITM-UNT-RTL-AMT,                            23150076
231600                  :RECITM-GP-RTL-AMT,                             23160076
231700                  :RECITM-GP-QTY,                                 23170078
231800                  :PV-ORIG-PKSL-ITM-QTY)                          23180079
231900     END-EXEC.                                                    23190067
232000                                                                  23200067
232100     EVALUATE TRUE                                                23210067
232200         WHEN SQLCODE = +0                                        23220067
232300         WHEN SQLCODE = +100                                      23230067
232400              CONTINUE                                            23240067
232500                                                                  23250067
232600         WHEN SQLWARN0 NOT = SPACES                               23260067
232700         WHEN SQLCODE < +0                                        23270067
232800         WHEN SQLCODE > +0                                        23280067
232900              MOVE '9010-INSERT-RECITM'                           23290067
233000                               TO DP013-PARAGRAPH                 23300067
233100              MOVE 'UNSUCCESSFUL INSERT FOR TRECITM'              23310067
233200                               TO DP013-MESSAGE-TEXT (1)          23320067
233300              MOVE SQLCA       TO DP013-SQLCA                     23330067
233400              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        23340067
233500              SET DP013-DB2-ABEND                                 23350067
233600                  DP013-XCTL-DISPLAY-RESTART                      23360067
233700                               TO TRUE                            23370067
233800              PERFORM DP013-0000-PROCESS-ABEND                    23380067
233900     END-EVALUATE.                                                23390067
234000                                                                  23400067
234100******************************************************************23410079
234200**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **23420079
234300******************************************************************23430079
234400 9015-CHECK-ASN.                                                  23440079
234500                                                                  23450079
234600         MOVE 0  TO PV-COUNTER                                    23460081
234700                    PV-NULL-IND.                                  23470081
234800                                                                  23480081
234900         EXEC SQL                                                 23490079
235000           SELECT COUNT(CRE_UID)                                  23500081
235100           INTO  :PV-COUNTER:PV-NULL-IND                          23510081
235200           FROM   TPKSLIP                                         23520079
235300           WHERE  PO_NBR       = :DK-PO-NBR                       23530079
235400             AND  REC_SEQ_NBR  = :PV-REC-SEQ-NBR                  23540086
235500             AND  CRE_UID      = 'RCKUP006'                       23550082
235600         END-EXEC.                                                23560079
235700                                                                  23570079
235800         EVALUATE TRUE                                            23580079
235900             WHEN SQLCODE = ZERO                                  23590079
236000                  IF PV-COUNTER > 0                               23600081
236100                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          23610079
236200                  END-IF                                          23620079
236300             WHEN SQLCODE = +100                                  23630079
236400                  CONTINUE                                        23640079
236500             WHEN SQLCODE = -904                                  23650079
236600             WHEN SQLCODE = -911                                  23660079
236700             WHEN SQLCODE = -913                                  23670079
236800                  PERFORM 9900-SOFT-ABORT                         23680079
236900                                                                  23690079
237000             WHEN SQLWARN0 NOT = SPACES                           23700079
237100             WHEN SQLCODE  NOT = ZERO                             23710079
237200                  MOVE '9015-CHECK-ASN'                           23720079
237300                                 TO DP013-PARAGRAPH               23730079
237400                  MOVE 'UNSUCCESSFUL SELECT OF TPKSLIP'           23740079
237500                                 TO DP013-MESSAGE-TEXT (1)        23750079
237600                  MOVE ASC-KEY-PO-NBR                             23760079
237700                                 TO PV-MSG-KEY-PO                 23770079
237800                  MOVE DK-REC-SEQ-NBR                             23780079
237900                                 TO PV-MSG-KEY-REC-SEQ-NBR-N      23790079
238000                  MOVE RECITM-ORD-LNE-NBR                         23800079
238100                                 TO PV-MSG-KEY-PO-LNE-NBR-N       23810079
238200                  MOVE PV-MSG-KEYS                                23820079
238300                                 TO DP013-MESSAGE-TEXT (2)        23830079
238400                  MOVE SQLCA     TO DP013-SQLCA                   23840079
238500                  MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)      23850079
238600                  SET DP013-DB2-ABEND                             23860079
238700                      DP013-XCTL-DISPLAY-RESTART                  23870079
238800                                 TO TRUE                          23880079
238900                  PERFORM DP013-0000-PROCESS-ABEND                23890079
239000         END-EVALUATE.                                            23900079
239100                                                                  23910079
239200 9020-PREPARE-TRECDIS.                                            23920067
239300                                                                  23930067
239400     INITIALIZE DCLTRECDIS.                                       23940067
239500                                                                  23950067
239600     MOVE ASC-PO-NBR           TO RECDIS-ORD-NBR.                 23960067
239700     MOVE ASC-PO-LNE-NBR-N     TO RECDIS-ORD-LNE-NBR.             23970067
239800     MOVE ASC-REC-SEQ-NBR      TO RECDIS-REC-SEQ-NBR.             23980067
239900     MOVE ASC-KEY-OPER-UNT-ID  TO RECDIS-OPER-UNT-ID.             23990067
240000     MOVE PC-CURRENT-PROGRAM-NAME                                 24000067
240100                               TO RECDIS-CRE-UID.                 24010067
240200     MOVE PC-ACTIVE            TO RECDIS-VER-STATUS-CDE.          24020067
240300     MOVE ZERO                 TO RECDIS-EXPTED-ITM-QTY.          24030067
240400     MOVE ASC-KEY-OPER-UNT-ID  TO RECDIS-STR-NBR.                 24040067
240500     MOVE 1                    TO RECDIS-FCLTY-ID.                24050067
240600     MOVE 1                    TO RECDIS-STR-FCLTY-ID.            24060067
240700                                                                  24070067
240800     MOVE PC-DEFAULT-DATE      TO RECDIS-AP-PRC-DTE.              24080067
240900                                                                  24090067
241000     PERFORM 9030-INSERT-TRECDIS.                                 24100067
241100                                                                  24110067
241200 9030-INSERT-TRECDIS.                                             24120067
241300                                                                  24130067
241400     EXEC SQL                                                     24140067
241500          INSERT INTO TRECDIS                                     24150067
241600                 (ORD_NBR                                         24160067
241700               ,  ORD_LNE_NBR                                     24170067
241800               ,  REC_SEQ_NBR                                     24180067
241900               ,  OPER_UNT_ID                                     24190067
242000               ,  FCLTY_ID                                        24200067
242100               ,  CRE_TMST                                        24210067
242200               ,  CRE_UID                                         24220067
242300               ,  VER_STATUS_CDE                                  24230067
242400               ,  EXPTED_ITM_QTY                                  24240067
242500               ,  VERIFY_ITM_QTY                                  24250067
242600               ,  AP_VERIFY_ITM_QTY                               24260067
242700               ,  STR_NBR                                         24270067
242800               ,  STR_FCLTY_ID                                    24280067
242900               ,  PLAN_ITM_QTY                                    24290067
243000               ,  AP_PRC_CDE                                      24300067
243100               ,  AP_PRC_DTE)                                     24310067
243200          VALUES (:RECDIS-ORD-NBR                                 24320067
243300               ,  :RECDIS-ORD-LNE-NBR                             24330067
243400               ,  :RECDIS-REC-SEQ-NBR                             24340067
243500               ,  :RECDIS-OPER-UNT-ID                             24350067
243600               ,  :RECDIS-FCLTY-ID                                24360067
243700               ,  CURRENT TIMESTAMP                               24370067
243800               ,  :RECDIS-CRE-UID                                 24380067
243900               ,  :RECDIS-VER-STATUS-CDE                          24390067
244000               ,  :RECDIS-EXPTED-ITM-QTY                          24400067
244100               ,  :RECDIS-VERIFY-ITM-QTY                          24410067
244200               ,  :RECDIS-AP-VERIFY-ITM-QTY                       24420067
244300               ,  :RECDIS-STR-NBR                                 24430067
244400               ,  :RECDIS-STR-FCLTY-ID                            24440067
244500               ,  :RECDIS-PLAN-ITM-QTY                            24450067
244600               ,  :RECDIS-AP-PRC-CDE                              24460067
244700               ,  :RECDIS-AP-PRC-DTE)                             24470067
244800     END-EXEC.                                                    24480067
244900                                                                  24490067
245000     EVALUATE TRUE                                                24500067
245100         WHEN SQLCODE = +0                                        24510067
245200              CONTINUE                                            24520067
245300                                                                  24530067
245400         WHEN OTHER                                               24540067
245500             MOVE '9030-INSERT-TRECDIS'                           24550067
245600                               TO DP013-PARAGRAPH                 24560067
245700             MOVE 'DB2 ERROR INSERTING A PACK BY STR RECDIS'      24570067
245800                               TO DP013-MESSAGE-TEXT (1)          24580067
245900             MOVE SQLCA        TO DP013-SQLCA                     24590067
246000             MOVE 'TRECDIS'    TO DP013-DB2-TABLE-NAME (1)        24600067
246100             SET DP013-DB2-ABEND                                  24610067
246200                               TO TRUE                            24620067
246300             SET DP013-XCTL-DISPLAY-RESTART                       24630067
246400                               TO TRUE                            24640067
246500             PERFORM DP013-0000-PROCESS-ABEND                     24650067
246600     END-EVALUATE.                                                24660067
246700                                                                  24670067
246800                                                                  24680067
246900 9040-CHECK-FOR-TROUBLE.                                          24690067
247000                                                                  24700067
247100     INITIALIZE TM500-FIELDS.                                     24710067
247200                                                                  24720067
247300     SET  TM500-CREATE-AUTO        TO TRUE.                       24730067
247400     SET  TM500-LINE-LEVEL         TO TRUE.                       24740067
247500     SET  TM500-NO-DETAILS         TO TRUE.                       24750067
247600     MOVE DK-PO-NBR                TO TM500-PO-NBR.               24760067
247700     MOVE ASC-PO-LNE-NBR-N         TO TM500-PO-LNE-NBR.           24770067
247800     MOVE ASC-KEY-OPER-UNT-ID      TO TM500-OPER-UNT-ID.          24780067
247900     MOVE ASC-KEY-FCLTY-ID         TO TM500-FCLTY-ID.             24790067
248000     MOVE ASC-REC-SEQ-NBR          TO TM500-REC-SEQ-NBR.          24800067
248100     MOVE ASC-DTL-CK-ITM-QTY-N     TO TM500-UNITS-TO-ALLOC.       24810067
248200     MOVE ASC-PURITM-PIC-ITM-IND   TO TM500-AD-SW.                24820067
248300     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            24830067
248400                                                                  24840067
248500     EXEC CICS                                                    24850067
248600         LINK PROGRAM  (PC-LINE-TROUBLE-RTN)                      24860067
248700              COMMAREA (TM500-FIELDS)                             24870067
248800              LENGTH   (PC-LINE-TROUBLE-RTN-LENGTH)               24880067
248900     END-EXEC.                                                    24890067
249000                                                                  24900067
249100     EVALUATE TRUE                                                24910067
249200         WHEN TM500-CALL-SUCCESSFUL                               24920067
249300         WHEN TM500-DUPLICATE-TROUBLE                             24930067
249400         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        24940067
249500         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       24950067
249600              IF TM500-IN-TROUBLE                                 24960067
249700                  ADD 1 TO PV-TROUBLE-COUNT                       24970067
249800              ELSE                                                24980067
249900                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                24990067
250000              END-IF                                              25000067
250100                                                                  25010067
250200         WHEN OTHER                                               25020067
250300              MOVE '9040-CHECK-FOR-TROUBLE'                       25030067
250400                                    TO DP013-PARAGRAPH            25040067
250500              MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'             25050067
250600                                    TO DP013-MESSAGE-TEXT (1)     25060067
250700              MOVE TM500-RETURN-MSG TO DP013-MESSAGE-TEXT (2)     25070067
250800              MOVE TM500-SQLCA      TO DP013-SQLCA                25080067
250900              SET DP013-DB2-ABEND                                 25090067
251000                  DP013-XCTL-DISPLAY-RESTART                      25100067
251100                                    TO TRUE                       25110067
251200              PERFORM DP013-0000-PROCESS-ABEND                    25120067
251300     END-EVALUATE.                                                25130067
251400                                                                  25140067
251500*----------------------------------------------------------------*25150067
251600*    RETRIEVE THE VERSION NUMBER AND SEQUENCE NUMBER             *25160093
251700*    OF THE PURCHASE ORDER LINE                                  *25170067
251800*----------------------------------------------------------------*25180067
251900 9050-GET-PURITM.                                                 25190067
252000                                                                  25200067
252100     MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR.                  25210067
252200                                                                  25220067
252300     EXEC SQL                                                     25230067
252400          SELECT DISTINCT                                         25240067
252500                 A.DEPT_NBR,                                      25250067
252600                 A.ENT_ID,                                        25260067
252700                 B.VER_NBR,                                       25270067
252800                 B.SKU_SEQ_NBR,                                   25280067
252900                 B.VEND_STYL_NAME,                                25290067
253000                 B.COLOR_DESC,                                    25300067
253100                 B.SIZE_DESC,                                     25310067
253200                 B.UNT_RTL_PR_AMT,                                25320067
253300                 B.UNT_COST_AMT,                                  25330075
253400                 B.STATUS_CDE,                                    25340067
253500                 B.ITM_NBR,                                       25350067
253600                 B.GP_RTL_AMT,                                    25360067
253700                 B.GP_QTY,                                        25370067
253800                 B.PIC_ITM_IND,                                   25380099
253810                 B.INNR_PK_QTY,                                   25381099
253820                 B.OUTR_PK_QTY                                    25382099
253900            INTO :PURCHS-DEPT-NBR,                                25390067
254000                 :PURCHS-ENT-ID,                                  25400067
254100                 :PURITM-VER-NBR,                                 25410067
254200                 :PURITM-SKU-SEQ-NBR,                             25420067
254300                 :PURITM-VEND-STYL-NAME,                          25430067
254400                 :PURITM-COLOR-DESC,                              25440067
254500                 :PURITM-SIZE-DESC,                               25450067
254600                 :PURITM-UNT-RTL-PR-AMT,                          25460067
254700                 :PURITM-UNT-COST-AMT,                            25470075
254800                 :PV-PURITM-STATUS-CDE,                           25480067
254900                 :PURITM-ITM-NBR,                                 25490067
255000                 :PURITM-GP-RTL-AMT,                              25500067
255100                 :PURITM-GP-QTY,                                  25510067
255200                 :ASC-PURITM-PIC-ITM-IND ,                        25520099
255210                 :PURITM-INNR-PK-QTY,                             25521099
255220                 :PURITM-OUTR-PK-QTY                              25522099
255300            FROM TPURCHS A                                        25530067
255400               , TPURITM B                                        25540067
255500*              , TRECITM C                                        25550067
255600           WHERE A.PO_NBR         = :DK-PO-NBR                    25560067
255700             AND A.VER_STATUS_CDE = :PC-ACTIVE                    25570067
255800             AND A.PO_NBR         = B.PO_NBR                      25580067
255900             AND B.VER_STATUS_CDE = :PC-ACTIVE                    25590067
256000             AND B.APP_PO_LNE_NBR = :DK-PO-LNE-NBR                25600067
256100     END-EXEC.                                                    25610067
256200                                                                  25620067
256300     EVALUATE TRUE                                                25630067
256400         WHEN SQLCODE = +0                                        25640067
256500              SET PS-PURITM-FOUND                                 25650067
256600                               TO TRUE                            25660067
256700                                                                  25670067
256800         WHEN SQLCODE = +100                                      25680067
256900              SET PS-PURITM-NOT-FOUND                             25690067
257000                               TO TRUE                            25700067
257100         WHEN SQLWARN0 NOT = SPACES                               25710067
257200         WHEN SQLCODE < +0                                        25720067
257300         WHEN SQLCODE > +0                                        25730067
257400              MOVE '9050-GET-PURITM'                              25740067
257500                               TO DP013-PARAGRAPH                 25750067
257600              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               25760067
257700                               TO DP013-MESSAGE-TEXT (1)          25770067
257800              MOVE SQLCA       TO DP013-SQLCA                     25780067
257900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        25790067
258000              SET DP013-DB2-ABEND                                 25800067
258100                  DP013-XCTL-DISPLAY-RESTART                      25810067
258200                               TO TRUE                            25820067
258300              PERFORM DP013-0000-PROCESS-ABEND                    25830067
258400     END-EVALUATE.                                                25840067
258500/                                                                 25850067
258600*                                                                 25860067
258700*----------------------------------------------------------------*25870067
258800* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *25880067
258900*                                                                 25890067
259000 9060-CALL-CICS-API-ARCH.                                         25900067
259100******************************************************            25910067
259200******************************************************            25920067
259300                                                                  25930067
259400        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               25940067
259500                                                                  25950067
259600        SET  XL001-BY-ITEM                                        25960067
259700             XL001-SELECT-SKU                                     25970067
259800             XL001-SELECT-VND-STYL TO TRUE.                       25980067
259900                                                                  25990067
260000        CALL XL001-VSM-PGM USING  DFHEIBLK                        26000067
260100                                  XL001-COMMAREA                  26010067
260200                                  XL001-ITEM-COMMAREA.            26020067
260300                                                                  26030067
260400        EVALUATE TRUE                                             26040067
260500                                                                  26050067
260600            WHEN XL001-SKU-SQLCODE = +0                           26060067
260700                 MOVE XL001-SKU-NBR   TO ASC-SKU-SEQ-NBR          26070067
260800**GB 3/25/2012   MOVE XL001-INNR-PACK-QTY                         26080099
260900**GB 3/25/2012                        TO ASC-INNR-PACK-QTY-N      26090099
261000                 PERFORM 9065-SELECT-VND-STYL                     26100067
261100                                                                  26110067
261200            WHEN XL001-SKU-SQLCODE = +100                         26120067
261300*                CONTINUE                                         26130067
261400**GB 3/25/2012   MOVE ZEROES TO XL001-INNR-PACK-QTY               26140099
261500                                                                  26150067
261600            WHEN XL001-INVALID-ACCESS                             26160067
261700              MOVE '9060-CALL-CICS-API-ARCH'                      26170067
261800                                   TO DP013-PARAGRAPH             26180067
261900              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           26190067
262000                                   TO DP013-MESSAGE-TEXT (1)      26200067
262100              MOVE SQLCA           TO DP013-SQLCA                 26210067
262200              MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)    26220067
262300*             MOVE 'XLV_VND_STYL'  TO DP013-DB2-TABLE-NAME (2)    26230067
262400              SET DP013-DB2-ABEND  TO TRUE                        26240067
262500              PERFORM DP013-0000-PROCESS-ABEND                    26250067
262600                                                                  26260067
262700            WHEN XL001-SKU-SQLCODE = -904                         26270067
262800            WHEN XL001-SKU-SQLCODE = -911                         26280067
262900            WHEN XL001-SKU-SQLCODE = -913                         26290067
263000              PERFORM 9900-SOFT-ABORT                             26300067
263100                                                                  26310067
263200            WHEN OTHER                                            26320067
263300              MOVE '9060-CALL-CICS-API-ARCH'                      26330067
263400                                   TO DP013-PARAGRAPH             26340067
263500              MOVE 'FETCH SKU SEQUENCE'                           26350067
263600                                   TO DP013-MESSAGE-TEXT (1)      26360067
263700              MOVE XL001-SKU-SQLCODE                              26370073
263800                                   TO SQLCODE                     26380074
263900              MOVE SQLCA           TO DP013-SQLCA                 26390067
264000              MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)    26400067
264100*             MOVE 'XLV_VND_STYL'  TO DP013-DB2-TABLE-NAME (2)    26410067
264200              SET DP013-DB2-ABEND  TO TRUE                        26420067
264300              PERFORM DP013-0000-PROCESS-ABEND                    26430067
264400            END-EVALUATE.                                         26440067
264500                                                                  26450067
264600 9065-SELECT-VND-STYL.                                            26460067
264700        EVALUATE TRUE                                             26470067
264800                                                                  26480067
264900            WHEN XL001-VND-STYL-SQLCODE = +0                      26490067
265000                 CONTINUE                                         26500067
265100                                                                  26510067
265200            WHEN XL001-VND-STYL-SQLCODE = +100                    26520067
265300                 MOVE SPACES TO XL001-HNG-FOLD-DESC               26530070
265400                                                                  26540067
265500            WHEN XL001-VND-STYL-SQLCODE = -904                    26550067
265600            WHEN XL001-VND-STYL-SQLCODE = -911                    26560067
265700            WHEN XL001-VND-STYL-SQLCODE = -913                    26570067
265800              PERFORM 9900-SOFT-ABORT                             26580067
265900                                                                  26590067
266000            WHEN XL001-INVALID-ACCESS                             26600067
266100              MOVE '9065-SELECT-VND-STYL'                         26610067
266200                                   TO DP013-PARAGRAPH             26620067
266300              MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'           26630067
266400                                   TO DP013-MESSAGE-TEXT (1)      26640067
266500              MOVE SQLCA           TO DP013-SQLCA                 26650067
266600              MOVE 'XLV_VND_STYL'  TO DP013-DB2-TABLE-NAME (1)    26660067
266700              SET DP013-DB2-ABEND  TO TRUE                        26670067
266800              PERFORM DP013-0000-PROCESS-ABEND                    26680067
266900                                                                  26690067
267000            WHEN OTHER                                            26700067
267100              MOVE '9065-SELECT-VND-STYL'                         26710067
267200                                   TO DP013-PARAGRAPH             26720067
267300              MOVE 'FETCH HANG-FOLD-DESC'                         26730067
267400                                   TO DP013-MESSAGE-TEXT (1)      26740067
267500              MOVE XL001-VND-STYL-SQLCODE                         26750074
267600                                   TO SQLCODE                     26760074
267700              MOVE SQLCA           TO DP013-SQLCA                 26770067
267800              MOVE 'XLV_VND_STYL'  TO DP013-DB2-TABLE-NAME (1)    26780067
267900              SET DP013-DB2-ABEND  TO TRUE                        26790067
268000              PERFORM DP013-0000-PROCESS-ABEND                    26800067
268100            END-EVALUATE.                                         26810067
268200*                                                                 26820067
268300*----------------------------------------------------------------*26830067
268400*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *26840067
268500*----------------------------------------------------------------*26850067
268600                                                                  26860067
268700 9100-READ-SEL-QUEUE.                                             26870067
268800                                                                  26880067
268900     EXEC CICS                                                    26890067
269000         READQ TS                                                 26900067
269100             QUEUE (ASC-SEL-QUEUE-NAME)                           26910067
269200             INTO  (PC016-TS-SEL-REC)                             26920067
269300             ITEM  (ASC-SEL-ITEM)                                 26930067
269400             RESP  (PV-CICS-RESPONSE)                             26940067
269500     END-EXEC.                                                    26950067
269600                                                                  26960067
269700     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       26970067
269800         CONTINUE                                                 26980067
269900     ELSE                                                         26990067
270000         SET DP013-LOGIC-ABEND                                    27000067
270100             DP013-NO-ROLLBACK     TO TRUE                        27010067
270200         MOVE '9100-READ-SEL-QUEUE'                               27020067
270300                                   TO DP013-PARAGRAPH             27030067
270400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   27040067
270500                                   TO DP013-MESSAGE-TEXT (1)      27050067
270600         PERFORM DP013-0000-PROCESS-ABEND                         27060067
270700     END-IF.                                                      27070067
270800                                                                  27080067
270900/                                                                 27090067
271000*----------------------------------------------------------------*27100067
271100*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *27110067
271200*----------------------------------------------------------------*27120067
271300 9200-REWRITE-SEL-QUEUE.                                          27130067
271400                                                                  27140067
271500     EXEC CICS                                                    27150067
271600          WRITEQ TS                                               27160067
271700              QUEUE  (ASC-SEL-QUEUE-NAME)                         27170067
271800              FROM   (PC016-TS-SEL-REC)                           27180067
271900              ITEM   (ASC-SEL-ITEM)                               27190067
272000              RESP   (PV-CICS-RESPONSE)                           27200067
272100              REWRITE                                             27210067
272200     END-EXEC.                                                    27220067
272300                                                                  27230067
272400     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   27240067
272500         SET DP013-CICS-ABEND                                     27250067
272600             DP013-NO-ROLLBACK     TO TRUE                        27260067
272700         MOVE '9200-REWRITE-SEL-QUEUE'                            27270067
272800                                   TO DP013-PARAGRAPH             27280067
272900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   27290067
273000                                   TO DP013-MESSAGE-TEXT (1)      27300067
273100         PERFORM DP013-0000-PROCESS-ABEND                         27310067
273200     END-IF.                                                      27320067
273300                                                                  27330067
273400/                                                                 27340067
273500                                                                  27350012
273600 9903-WRITE-CICS-LOG.                                             27360012
273700                                                                  27370012
273800     EXEC CICS                                                    27380012
273900         WRITEQ TD                                                27390012
274000             QUEUE  ('CSSL')                                      27400012
274100             FROM   (PV-CICS-MSG-AREA)                            27410012
274200             RESP   (PV-CICS-RESP)                                27420012
274300     END-EXEC.                                                    27430012
274400     MOVE SPACES                  TO PV-CICS-MSG-AREA.            27440012
274410/                                                                 27441099
274600*---------------------------------------------------------------- 27460067
274700*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE     27470067
274800*    AND THE ERROR SWITCHES.                                      27480067
274900*---------------------------------------------------------------- 27490067
275000 9900-SOFT-ABORT.                                                 27500067
275100     SET PS-ERROR         TO TRUE.                                27510067
275200     SET DP020-MSG-FATAL  TO TRUE.                                27520067
275300     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    27530067
275400     SET  DP020-NEXT-ACT-APPL-ERROR TO TRUE.                      27540067
275500     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       27550067
275600     PERFORM 0001-CALL-CICS-ARCH-API.                             27560067
275700*----------------------------------------------------------------*27570067
275800*    ABEND PROCESSOR MODULE                                      *27580067
275900*----------------------------------------------------------------*27590067
276000                                                                  27600067
276100     COPY DPPD013.                                                27610067
