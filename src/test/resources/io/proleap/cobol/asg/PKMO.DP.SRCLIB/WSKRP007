000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.      WSKRP007.                                       00020001
000300 AUTHOR.          DENISE HAHN.                                    00030002
000400 DATE-WRITTEN.    11/17/20.                                       00040002
000500 ENVIRONMENT DIVISION.                                            00050001
000600 CONFIGURATION SECTION.                                           00060001
000700 SOURCE-COMPUTER. IBM-3090.                                       00070001
000800 OBJECT-COMPUTER. IBM-3090.                                       00080001
000900                                                                  00090001
001000 INPUT-OUTPUT SECTION.                                            00100001
001100 FILE-CONTROL.                                                    00110001
001200                                                                  00120001
001300     SELECT ERROR-FILE ASSIGN TO INP01.                           00130001
001400     SELECT ERROR-RPT  ASSIGN TO RPT01.                           00140001
001500                                                                  00150001
001600 DATA DIVISION.                                                   00160001
001700 FILE SECTION.                                                    00170001
001800                                                                  00180001
001900 FD  ERROR-FILE                                                   00190001
002000     RECORDING MODE F                                             00200001
002100     BLOCK CONTAINS 0 RECORDS                                     00210001
002200     LABEL RECORDS ARE OMITTED.                                   00220001
002300 01  ERROR-REC                        PIC X(226).                 00230004
002400                                                                  00240001
002500 FD  ERROR-RPT                                                    00250001
002600     RECORDING MODE F                                             00260001
002700     BLOCK CONTAINS 0 RECORDS                                     00270001
002800     RECORD CONTAINS 150 CHARACTERS.                              00280002
002900 01  ERROR-RPT-REC                    PIC X(150).                 00290002
003000                                                                  00300001
003100 WORKING-STORAGE SECTION.                                         00310001
003200                                                                  00320001
003210*  COMMUNICATIONS AREA FOR DB2                                    00321001
003220     EXEC SQL                                                     00322001
003230          INCLUDE SQLCA                                           00323001
003240     END-EXEC.                                                    00324001
003250                                                                  00325001
003260     COPY SQLCA2.                                                 00326001
003270                                                                  00327001
003280*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     00328001
003290     COPY DPWS004.                                                00329001
003300                                                                  00330001
003400*  DB2 TABLE XLT_LOC                                              00340001
003500     EXEC SQL                                                     00350001
003510          INCLUDE XLT00010                                        00351001
003520     END-EXEC.                                                    00352001
003530                                                                  00353001
003540*  DB2 TABLE WST_SHPMT_XREF_HDR                                   00354001
003550     EXEC SQL                                                     00355015
003560          INCLUDE WST00001                                        00356015
003570     END-EXEC.                                                    00357015
003580                                                                  00358001
003590*  STANDARD HEADER LINE - KOHLS 150 COL                           00359015
003591*                                                                 00359101
003592     COPY DPWS150O.                                               00359203
003593                                                                  00359301
003594 01  HEADING-LINE1.                                               00359401
003595     05  FILLER                       PIC X(60)   VALUE SPACES.   00359503
003596     05  FILLER                       PIC X(29)   VALUE           00359602
003597         'CASE RECEIPT ERRORS FROM WMOS'.                         00359702
003598     05  FILLER                       PIC X(61)   VALUE SPACES.   00359803
003599 01  HEADING-LINE2.                                               00359901
003600     05  FILLER                       PIC X(1)    VALUE SPACES.   00360001
003700     05  FILLER                       PIC X(16)   VALUE           00370001
003800         'DC ...........:'.                                       00380001
003900     05  HD2-DC-NBR                   PIC ZZZZ9.                  00390001
004000     05  FILLER                       PIC X(02)   VALUE SPACES.   00400001
004100     05  HD2-DC-NAME                  PIC X(40).                  00410001
004200     05  FILLER                       PIC X(86)   VALUE SPACES.   00420021
004300 01  HEADING-LINE3.                                               00430001
004410     05  FILLER                       PIC X(4)    VALUE 'OPER'.   00441025
004420     05  FILLER                       PIC X(2)    VALUE SPACES.   00442026
004500     05  FILLER                       PIC X(11)   VALUE           00450004
004600         'PO/RECEIVER'.                                           00460004
004700     05  FILLER                       PIC X(03)   VALUE SPACES.   00470003
004800     05  FILLER                       PIC X(07)   VALUE           00480003
004900         'SKU NBR'.                                               00490003
004910     05  FILLER                       PIC X(01)   VALUE SPACES.   00491003
004920     05  FILLER                       PIC X(04)   VALUE           00492001
004930         'LINE'.                                                  00493001
004940     05  FILLER                       PIC X(02)   VALUE SPACES.   00494001
004950     05  FILLER                       PIC X(03)   VALUE           00495003
004960         'QTY'.                                                   00496003
004970     05  FILLER                       PIC X(02)   VALUE SPACES.   00497003
004980     05  FILLER                       PIC X(11)   VALUE           00498003
004990         'CASE NUMBER'.                                           00499001
004991     05  FILLER                       PIC X(10)   VALUE SPACES.   00499104
004992     05  FILLER                       PIC X(04)   VALUE           00499201
004993         'SCAC'.                                                  00499301
004994     05  FILLER                       PIC X(01)   VALUE SPACES.   00499403
004995     05  FILLER                       PIC X(07)   VALUE           00499503
004996         'VEHICLE'.                                               00499601
004997     05  FILLER                       PIC X(04)   VALUE SPACES.   00499703
005002     05  FILLER                       PIC X(12)   VALUE           00500214
005003         'ERROR REASON'.                                          00500314
005004     05  FILLER                       PIC X(08)   VALUE SPACES.   00500427
005005     05  FILLER                       PIC X(02)   VALUE           00500514
005006         'TY'.                                                    00500614
005007     05  FILLER                       PIC X(01)   VALUE SPACES.   00500714
005008     05  FILLER                       PIC X(02)   VALUE           00500818
005009         'TR'.                                                    00500918
005010     05  FILLER                       PIC X(01)   VALUE SPACES.   00501020
005011     05  FILLER                       PIC X(13)   VALUE           00501114
005012         'WMOS SHIPMENT'.                                         00501214
005013     05  FILLER                       PIC X(05)   VALUE SPACES.   00501314
005014     05  FILLER                       PIC X(14)   VALUE           00501414
005015         'SCAN DATE/TIME'.                                        00501514
005016     05  FILLER                       PIC X(02)   VALUE SPACES.   00501614
005017     05  FILLER                       PIC X(06)   VALUE           00501714
005018         'USERID'.                                                00501814
005019     05  FILLER                       PIC X(08)   VALUE SPACES.   00501928
005020 01  HEADING-LINE4.                                               00502014
005021     05  FILLER                       PIC X(04)   VALUE           00502125
005022         '----'.                                                  00502225
005023     05  FILLER                       PIC X(01)   VALUE SPACES.   00502314
005024     05  FILLER                       PIC X(13)   VALUE           00502425
005025         '-------------'.                                         00502525
005026     05  FILLER                       PIC X(01)   VALUE SPACES.   00502625
005027     05  FILLER                       PIC X(08)   VALUE           00502714
005028         '--------'.                                              00502814
005029     05  FILLER                       PIC X(01)   VALUE SPACES.   00502914
005030     05  FILLER                       PIC X(04)   VALUE           00503014
005031         '----'.                                                  00503114
005032     05  FILLER                       PIC X(01)   VALUE SPACES.   00503214
005033     05  FILLER                       PIC X(05)   VALUE           00503314
005034         '-----'.                                                 00503414
005035     05  FILLER                       PIC X(01)   VALUE SPACES.   00503514
005036     05  FILLER                       PIC X(20)   VALUE           00503614
005037         '--------------------'.                                  00503714
005038     05  FILLER                       PIC X(01)   VALUE SPACES.   00503814
005039     05  FILLER                       PIC X(04)   VALUE           00503914
005040         '----'.                                                  00504014
005041     05  FILLER                       PIC X(01)   VALUE SPACES.   00504114
005042     05  FILLER                       PIC X(10)   VALUE           00504214
005043         '----------'.                                            00504314
005044     05  FILLER                       PIC X(01)   VALUE SPACES.   00504414
005045     05  FILLER                       PIC X(19)   VALUE           00504524
005046         '-------------------'.                                   00504624
005047     05  FILLER                       PIC X(01)   VALUE SPACES.   00504708
005048     05  FILLER                       PIC X(02)   VALUE           00504812
005049         '--'.                                                    00504912
005050     05  FILLER                       PIC X(01)   VALUE SPACES.   00505004
005051     05  FILLER                       PIC X(02)   VALUE           00505118
005052         '--'.                                                    00505217
005053     05  FILLER                       PIC X(01)   VALUE SPACES.   00505314
005054     05  FILLER                       PIC X(16)   VALUE           00505401
005055         '----------------'.                                      00505501
005056     05  FILLER                       PIC X(01)   VALUE SPACES.   00505601
005057     05  FILLER                       PIC X(16)   VALUE           00505701
005058         '----------------'.                                      00505801
005059     05  FILLER                       PIC X(01)   VALUE SPACES.   00505903
005060     05  FILLER                       PIC X(14)   VALUE           00506028
005061         '--------------'.                                        00506128
005063                                                                  00506301
005064 01  DETAIL-LINE-1.                                               00506401
005065     05  DT1-OPER                     PIC Z(04).                  00506524
005066     05  FILLER                       PIC X(01)   VALUE SPACE.    00506624
005067     05  DT1-PO                       PIC X(08).                  00506724
005068     05  FILLER                       PIC X(01)   VALUE '-'.      00506824
005069     05  DT1-RECEIVER                 PIC 9999.                   00506910
005070     05  FILLER                       PIC X(01)   VALUE SPACES.   00507003
005071     05  DT1-SKU-NBR                  PIC X(08).                  00507101
005072     05  FILLER                       PIC X(01)   VALUE SPACES.   00507203
005073     05  DT1-LINE                     PIC ZZZ9.                   00507301
005080     05  FILLER                       PIC X(01)   VALUE SPACES.   00508003
005090     05  DT1-QTY                      PIC ZZ999.                  00509001
005100     05  FILLER                       PIC X(01)   VALUE SPACES.   00510001
005200     05  DT1-CASE-NBR                 PIC X(20).                  00520001
005300     05  FILLER                       PIC X(01)   VALUE SPACES.   00530001
005400     05  DT1-SCAC                     PIC X(04).                  00540001
005500     05  FILLER                       PIC X(01)   VALUE SPACES.   00550003
005600     05  DT1-VEHICLE                  PIC X(10).                  00560001
005700     05  FILLER                       PIC X(01)   VALUE SPACES.   00570001
005730     05  DT1-ERROR-RSN                PIC X(19).                  00573023
005740     05  FILLER                       PIC X(01)   VALUE SPACES.   00574004
005800     05  DT1-TYPE                     PIC X(02).                  00580012
005900     05  FILLER                       PIC X(01)   VALUE SPACES.   00590003
005901     05  DT1-SHPMT-TYPE               PIC X(02).                  00590117
005902     05  FILLER                       PIC X(01)   VALUE SPACES.   00590214
005910     05  DT1-WMS-SHPMT                PIC X(16).                  00591001
005920     05  FILLER                       PIC X(01)   VALUE SPACES.   00592001
005930     05  DT1-SCAN-TIME                PIC X(16).                  00593001
005940     05  FILLER                       PIC X(01)   VALUE SPACES.   00594003
005950     05  DT1-USERID                   PIC X(14).                  00595024
005960                                                                  00596001
005970                                                                  00597001
005980 01  END-OF-REPORT-LINE.                                          00598001
005990     05  FILLER                       PIC X(55)   VALUE SPACES.   00599001
006000     05  FILLER                       PIC X(25)   VALUE           00600001
006100         '***** END OF REPORT *****'.                             00610001
006200     05  FILLER                       PIC X(70)   VALUE SPACES.   00620021
006300                                                                  00630001
006400 01  TOTAL-LINE-1.                                                00640001
006500     05  FILLER                       PIC X(08)   VALUE SPACES.   00650001
006600     05  FILLER                       PIC X(31)   VALUE           00660001
006700         'TOTAL ERROR CASES RECEIVED:'.                           00670001
006800     05  TL1-CASE-CNT                 PIC ZZZ,ZZ9.                00680001
006900     05  FILLER                       PIC X(104)  VALUE SPACES.   00690022
007000                                                                  00700001
007100*  COPYBOOK FOR RECEIPT PIX RECORD                                00710001
007200     COPY WSRD014.                                                00720001
007300*  COPYBOOK FOR ERROR RECORD                                      00730001
007400     COPY WSRD020.                                                00740002
007401                                                                  00740102
007410**************************************************************    00741002
007411*  COPYBOOK FOR XLKUT067                                          00741102
007412*  THIS WILL BE USED TO GET THE ASSOCIATES NAME                   00741202
007413**************************************************************    00741302
007420     COPY XLWS067.                                                00742001
007430                                                                  00743001
007440 01  CD-CPU-DATE.                                                 00744001
007450     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE 0.     00745001
007460     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE 0.     00746001
007470     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE 0.     00747001
007480                                                                  00748001
007490 01  CT-CPU-TIME.                                                 00749001
007500     05  CT-CPU-TIME-HH               PIC 9(02)      VALUE 0.     00750001
007600     05  CT-CPU-TIME-MM               PIC 9(02)      VALUE 0.     00760001
007700     05  CT-CPU-TIME-SS               PIC 9(02)      VALUE 0.     00770001
007800     05  CT-CPU-TIME-HS               PIC 9(02)      VALUE 0.     00780001
007900                                                                  00790001
008000 01  PV-CD-TIME.                                                  00800001
008100     05  PV-CD-SS                     PIC 9(02)      VALUE 0.     00810001
008200     05  PV-CD-HS                     PIC 9(02)      VALUE 0.     00820001
008300                                                                  00830001
008400 01  PV-PROGRAM-VARIABLES.                                        00840001
008500     05  PV-HOLD-DC-LOCATION          PIC 9(04)      VALUE 0.     00850001
008600     05  PV-ABEND-CODE                PIC S9(04)     VALUE +0.    00860001
008700     05  PV-USER-NAME                 PIC X(15).                  00870001
008800     05  PV-SHPMT-TYPE                PIC X(02).                  00880017
008900                                                                  00890001
009000 01  PA-PROGRAM-ACCUMULATORS.                                     00900001
009100     05  PA-LINE-CNT                  PIC 9(03)      VALUE 99.    00910001
009200     05  PA-PAGE-CNT                  PIC 9(03)      VALUE 0.     00920001
009300     05  PA-CASE-CNT                  PIC 9(06)      VALUE 0.     00930001
009400                                                                  00940001
009500 01  PC-PROGRAM-CONTROLS.                                         00950001
009600     05  PC-MAX-LINES                 PIC 9(03)      VALUE 55.    00960001
009700                                                                  00970001
009800 01  DK-PROGRAM-KEYS.                                             00980001
009810     05  DK-DC-LOCATION               PIC S9(04) COMP.            00981001
009820     05  DK-EXT-SHP-ID                PIC X(20).                  00982001
009830                                                                  00983001
009840 01  PS-SWITCHES.                                                 00984001
009850     05  PS-EOF-SW                    PIC X(1)       VALUE 'N'.   00985001
009860         88  PS-INPUT-FILE-EOF                       VALUE 'Y'.   00986001
009870         88  PS-INPUT-FILE-NOT-EOF                   VALUE 'N'.   00987001
009880                                                                  00988001
009890 PROCEDURE DIVISION.                                              00989001
009900                                                                  00990001
010000 0000-MAINLINE.                                                   01000001
010100                                                                  01010001
010200     OPEN INPUT  ERROR-FILE                                       01020001
010300          OUTPUT ERROR-RPT.                                       01030001
010400                                                                  01040001
010500     PERFORM 0100-ACCEPT-CURR-DATE-TIME.                          01050001
010600     PERFORM 0200-READ-INPUT-FILE.                                01060001
010700     MOVE WS014-DC-LOCATION TO PV-HOLD-DC-LOCATION.               01070001
010800     PERFORM 0800-GET-DC-NAME.                                    01080001
010900                                                                  01090001
011000     IF PS-INPUT-FILE-EOF                                         01100001
011100        PERFORM 0600-PROCESS-HEADING-LINES                        01110001
011200     ELSE                                                         01120001
011300        PERFORM 0300-FILL-WRITE-DETAIL-LINE                       01130001
011400           UNTIL PS-INPUT-FILE-EOF                                01140001
011500     END-IF.                                                      01150001
011600                                                                  01160001
011700     PERFORM 0700-PROCESS-TOTAL-LINES.                            01170001
011800     PERFORM 0400-WRITE-EOF-RPT.                                  01180001
011900                                                                  01190001
012000     CLOSE ERROR-FILE                                             01200001
012100           ERROR-RPT.                                             01210001
012200                                                                  01220001
012300*    MOVE 4095 TO RETURN-CODE.                                    01230001
012400                                                                  01240001
012500     STOP RUN.                                                    01250001
012600                                                                  01260001
012700***************************************************************** 01270001
012800*     ACCEPT-CURR-DATE-TIME                                     * 01280001
012900***************************************************************** 01290001
013000 0100-ACCEPT-CURR-DATE-TIME.                                      01300001
013100                                                                  01310001
013200     ACCEPT CT-CPU-TIME FROM TIME.                                01320001
013300                                                                  01330001
013400     MOVE CT-CPU-TIME-HH         TO DP150O-RUN-HOUR.              01340003
013500     MOVE CT-CPU-TIME-MM         TO DP150O-RUN-MINUTE.            01350003
013600                                                                  01360001
013700     ACCEPT CD-CPU-DATE FROM DATE.                                01370001
013800     MOVE CD-CPU-DATE-MM         TO DP150O-RUN-MONTH.             01380003
013900     MOVE CD-CPU-DATE-DD         TO DP150O-RUN-DAY.               01390003
014000     MOVE CD-CPU-DATE-YY         TO DP150O-RUN-YEAR.              01400003
014100                                                                  01410001
014200****************************************************************  01420001
014300* READ INPUT ERROR FILE                                           01430001
014400****************************************************************  01440001
014500 0200-READ-INPUT-FILE.                                            01450001
014600                                                                  01460001
014700     READ ERROR-FILE INTO WS020-RECEIPT-PIX-ERROR-REC             01470002
014800        AT END                                                    01480001
014900           SET PS-INPUT-FILE-EOF    TO TRUE.                      01490002
015000                                                                  01500001
015100     MOVE WS020-WSRD014-RECORD      TO WS014-RECEIPT-PIX-RECORD.  01510002
015200     ADD 1                          TO PA-CASE-CNT.               01520002
015300                                                                  01530001
015400****************************************************************  01540001
015500* FILL & WRITE DETAIL LINE                                        01550001
015600****************************************************************  01560001
015700                                                                  01570001
015800 0300-FILL-WRITE-DETAIL-LINE.                                     01580001
015900                                                                  01590001
016000     IF WS014-DC-LOCATION NOT = PV-HOLD-DC-LOCATION               01600001
016100         MOVE WS014-DC-LOCATION TO PV-HOLD-DC-LOCATION            01610001
016200         PERFORM 0700-PROCESS-TOTAL-LINES                         01620001
016210         PERFORM 0800-GET-DC-NAME                                 01621001
016220     END-IF.                                                      01622001
016230                                                                  01623001
016240     MOVE WS014-DC-LOCATION      TO DT1-OPER.                     01624024
016241     MOVE WS014-PO-NUMBER        TO DT1-PO.                       01624124
016250     MOVE WS014-REC-SEQ-NUMBER   TO DT1-RECEIVER.                 01625001
016260     MOVE WS014-SKU-NUMBER       TO DT1-SKU-NBR.                  01626001
016270     MOVE WS014-PO-LINE-NUMBER   TO DT1-LINE.                     01627001
016280     MOVE WS014-SKU-QTY          TO DT1-QTY.                      01628001
016290     MOVE WS014-CASE-NUMBER      TO DT1-CASE-NBR.                 01629001
016300     MOVE WS014-SCAC             TO DT1-SCAC.                     01630001
016400     MOVE WS014-VEHICLE          TO DT1-VEHICLE.                  01640001
016410     MOVE WS014-RCVD-SHPMT-NBR   TO DT1-WMS-SHPMT.                01641001
016420     STRING WS014-CRE-TMST(1:4)                                   01642001
016430            '/'                                                   01643001
016440            WS014-CRE-TMST(6:2)                                   01644001
016450            '/'                                                   01645001
016460            WS014-CRE-TMST(9:2)                                   01646001
016470            ' '                                                   01647001
016480            WS014-CRE-TMST(12:2)                                  01648001
016490            ':'                                                   01649001
016491            WS014-CRE-TMST(15:2)                                  01649101
016492                             DELIMITED BY SIZE                    01649201
016493                               INTO DT1-SCAN-TIME.                01649301
016494                                                                  01649401
016498     IF WS014-CRE-USER-ID = ' '                                   01649801
016499        MOVE WS014-CRE-USER-ID     TO PV-USER-NAME                01649901
016500        MOVE 'UNKNOWN'             TO DT1-USERID                  01650006
016501     ELSE                                                         01650101
016502        PERFORM 0900-GET-USER-NAME                                01650201
016503        MOVE PV-USER-NAME          TO DT1-USERID                  01650306
016504     END-IF.                                                      01650401
016506                                                                  01650601
016508     MOVE WS014-RCVNG-TRANS-TYPE TO DT1-TYPE.                     01650812
016509                                                                  01650914
016510     PERFORM 1000-GET-SHPMT-TYPE.                                 01651014
016511     MOVE PV-SHPMT-TYPE          TO DT1-SHPMT-TYPE.               01651114
016520                                                                  01652012
016539     EVALUATE TRUE                                                01653904
016540         WHEN WS020-REC-NOT-FOUND                                 01654004
016541              MOVE 'RECEIVER NOT FOUND '    TO  DT1-ERROR-RSN     01654123
016542         WHEN WS020-DUP-INSERT                                    01654204
016543              MOVE 'DUPLICATE INSERT   '    TO  DT1-ERROR-RSN     01654323
016544         WHEN WS020-SQL-ERROR                                     01654404
016547              IF  WS020-SQLCODE  = -803                           01654711
016548                  IF  WS020-ERROR-PARA-NBR = '4120-'              01654811
016549                      MOVE 'DUPL INSERT UPC    '                  01654923
016550                                            TO  DT1-ERROR-RSN     01655011
016551                  ELSE                                            01655111
016552                      MOVE 'DUPLICATE INSERT   '                  01655223
016553                                            TO  DT1-ERROR-RSN     01655311
016554                  END-IF                                          01655411
016555              ELSE                                                01655511
016556              IF  WS020-SQLCODE        = -811                     01655611
016557                                                                  01655711
016558                  IF  WS020-ERROR-PARA-NBR = '1010-'              01655811
016559                      MOVE 'MLT RCVR IN OTBND  '                  01655923
016560                                            TO  DT1-ERROR-RSN     01656011
016561                  ELSE                                            01656111
016562                      MOVE 'MULTIPLE RECORDS   '                  01656223
016563                                            TO  DT1-ERROR-RSN     01656311
016564                  END-IF                                          01656411
016565              ELSE                                                01656529
016566              IF  WS020-SQLCODE        = +100                     01656629
016567                                                                  01656729
016568                  IF  WS020-ERROR-PARA-NBR = '6050A'              01656830
016569                      MOVE 'SKU NOT IN CASE-DUPLCAT'              01656930
016570                                            TO  DT1-ERROR-RSN     01657029
016571                  ELSE                                            01657129
016572                  IF  WS020-ERROR-PARA-NBR = '6050-'              01657230
016573                      MOVE 'SKU NOT IN CASE NBR'                  01657331
016574                                            TO  DT1-ERROR-RSN     01657430
016575                  ELSE                                            01657530
016576                  IF  WS020-ERROR-PARA-NBR = '5010-'              01657629
016577                      MOVE 'INVALID WMOS SHIPMT'                  01657731
016578                                            TO  DT1-ERROR-RSN     01657829
016579                  ELSE                                            01657929
016580                      MOVE 'SQL ERROR          '                  01658029
016581                                            TO  DT1-ERROR-RSN     01658129
016582                  END-IF                                          01658229
016583                  END-IF                                          01658330
016584                  END-IF                                          01658430
016585              ELSE                                                01658530
016586              IF  WS020-SQLCODE        = -904                     01658630
016587                  MOVE 'SQL ERR-DB LOCK    '                      01658730
016588                                            TO  DT1-ERROR-RSN     01658830
016589              ELSE                                                01658930
016590              IF  WS020-SQLCODE        = -911                     01659030
016591                  MOVE 'SQL ERR-DB CONTENTN'                      01659130
016592                                            TO  DT1-ERROR-RSN     01659230
016593              ELSE                                                01659330
016594                  MOVE 'SQL ERROR          '                      01659430
016595                                            TO  DT1-ERROR-RSN     01659530
016596              END-IF                                              01659630
016597              END-IF                                              01659730
016598              END-IF                                              01659830
016599              END-IF                                              01659930
016600              END-IF                                              01660030
016601         WHEN WS020-INVALID-REC                                   01660130
016602              MOVE 'INVALID RECEIVER   '    TO  DT1-ERROR-RSN     01660230
016603         WHEN WS020-ASN-LVL-ERR                                   01660330
016604              MOVE 'ASN LEVEL ERROR    '    TO  DT1-ERROR-RSN     01660430
016605         WHEN WS020-NO-PURITM                                     01660530
016606              MOVE 'ITEM NOT ON PO     '    TO  DT1-ERROR-RSN     01660630
016607         WHEN WS020-VRFD-RCVR-ERR                                 01660730
016608              IF  WS020-SQLCODE        = -811  AND                01660830
016609                  WS020-ERROR-PARA-NBR = '1010-'                  01660930
016610                  MOVE 'MLT RCVR IN OTBND  '                      01661030
016611                                            TO  DT1-ERROR-RSN     01661130
016612              ELSE                                                01661230
016613                  MOVE 'VERIFIED RCVR ERROR'                      01661330
016614                                            TO  DT1-ERROR-RSN     01661430
016615              END-IF                                              01661530
016616         WHEN WS020-UPD-PKSLIP-ERR                                01661630
016617              MOVE 'UPDATE PKSLIP ERROR'    TO  DT1-ERROR-RSN     01661730
016618         WHEN WS020-RCVR-CRE-ERR                                  01661830
016619              MOVE 'RECEIVER CREATE ERR'    TO  DT1-ERROR-RSN     01661930
016620         WHEN WS020-NO-USABLE-PO                                  01662030
016621              MOVE 'NO USABLE PO       '    TO  DT1-ERROR-RSN     01662130
016622         WHEN WS020-VEM-ERROR                                     01662230
016623              MOVE 'VE ELIGBLTY MOD ERR'    TO  DT1-ERROR-RSN     01662330
016624         WHEN WS020-INVALID-REC-TYP                               01662430
016625              MOVE 'INVALID RCVR TYPE  '    TO  DT1-ERROR-RSN     01662530
016626         WHEN WS020-INVALID-SHPMT-NBR                             01662630
016627              MOVE 'INVALID SHIPMT NBR '    TO  DT1-ERROR-RSN     01662730
016628         WHEN OTHER                                               01662830
016629              MOVE 'UNKNOWN            '    TO  DT1-ERROR-RSN     01662930
016630     END-EVALUATE.                                                01663030
016631                                                                  01663130
016632     PERFORM 0500-WRITE-REPORT-LINE.                              01663230
016633                                                                  01663330
016634     PERFORM 0200-READ-INPUT-FILE.                                01663430
016635                                                                  01663530
016636                                                                  01663630
016637****************************************************************  01663730
016638* WRITE EOF RPT                                                   01663830
016639****************************************************************  01663930
016640                                                                  01664030
016650 0400-WRITE-EOF-RPT.                                              01665001
016700                                                                  01670001
016800     WRITE ERROR-RPT-REC FROM END-OF-REPORT-LINE                  01680001
016900        AFTER ADVANCING 2 LINES.                                  01690001
017000                                                                  01700001
017100****************************************************************  01710001
017200* WRITE THE REPORT LINE AFTER ADVANCING ONE LINE                  01720001
017300****************************************************************  01730001
017400 0500-WRITE-REPORT-LINE.                                          01740001
017500                                                                  01750001
017600     IF PA-LINE-CNT > PC-MAX-LINES                                01760001
017700        PERFORM 0600-PROCESS-HEADING-LINES                        01770001
017800     END-IF.                                                      01780001
017900                                                                  01790001
018000     WRITE ERROR-RPT-REC FROM DETAIL-LINE-1                       01800001
018100         AFTER ADVANCING 1 LINE.                                  01810001
018200                                                                  01820001
018300     ADD 2 TO PA-LINE-CNT.                                        01830001
018400                                                                  01840001
018500****************************************************************  01850001
018600* CONTROL THE LOADING AND PRINTING OF THE HEADING LINES           01860001
018700****************************************************************  01870001
018800 0600-PROCESS-HEADING-LINES.                                      01880001
018900                                                                  01890001
019000     MOVE 'WSKRP007'             TO DP150O-PROGRAM-NAME.          01900003
019100     MOVE 1                      TO DP150O-REPORT-NUMBER.         01910003
019200     ADD 1                       TO PA-PAGE-CNT.                  01920001
019300     MOVE PA-PAGE-CNT            TO DP150O-PAGE-NUMBER.           01930003
019400                                                                  01940001
019500     WRITE ERROR-RPT-REC FROM DP150O-STANDRD-HEADER-150-COLS      01950007
019600        AFTER ADVANCING PAGE.                                     01960001
019700                                                                  01970001
019800     WRITE ERROR-RPT-REC FROM HEADING-LINE1                       01980001
019900        AFTER ADVANCING 2 LINES.                                  01990001
020000                                                                  02000001
020100     MOVE WS014-DC-LOCATION        TO HD2-DC-NBR.                 02010001
020200     MOVE XLT00010-LOC-NM          TO HD2-DC-NAME.                02020001
020300     WRITE ERROR-RPT-REC FROM HEADING-LINE2                       02030001
020400        AFTER ADVANCING 2 LINES.                                  02040001
020500                                                                  02050001
020600     WRITE ERROR-RPT-REC FROM HEADING-LINE3                       02060001
020700        AFTER ADVANCING 2 LINES.                                  02070001
020800                                                                  02080001
020900     WRITE ERROR-RPT-REC FROM HEADING-LINE4                       02090001
021000        AFTER ADVANCING 1 LINE.                                   02100001
021100                                                                  02110001
021200     MOVE SPACES TO ERROR-RPT-REC.                                02120001
021300                                                                  02130001
021400     WRITE ERROR-RPT-REC                                          02140001
021500         AFTER ADVANCING 1 LINE.                                  02150001
021600                                                                  02160001
021700     MOVE 9 TO PA-LINE-CNT.                                       02170001
021800                                                                  02180001
021900****************************************************************  02190001
022000* CONTROL THE LOADING AND PRINTING OF THE TOTAL LINES             02200001
022100****************************************************************  02210001
022200 0700-PROCESS-TOTAL-LINES.                                        02220001
022300                                                                  02230001
022400     IF PA-LINE-CNT > PC-MAX-LINES                                02240001
022500        PERFORM 0600-PROCESS-HEADING-LINES                        02250001
022600     END-IF.                                                      02260001
022700                                                                  02270001
022800     SUBTRACT 1                  FROM PA-CASE-CNT.                02280001
022900     MOVE PA-CASE-CNT            TO TL1-CASE-CNT.                 02290001
023000                                                                  02300001
023100     WRITE ERROR-RPT-REC FROM TOTAL-LINE-1                        02310001
023200        AFTER ADVANCING 2 LINES.                                  02320001
023300                                                                  02330001
023400     MOVE 1                      TO PA-CASE-CNT.                  02340001
023500     MOVE 70                     TO PA-LINE-CNT.                  02350001
023600                                                                  02360001
023700                                                                  02370001
023800****************************************************************  02380001
023900* GET THE NAME OF THE DC                                          02390001
024000****************************************************************  02400001
024100 0800-GET-DC-NAME.                                                02410001
024200                                                                  02420001
024300     MOVE WS014-DC-LOCATION      TO DK-DC-LOCATION.               02430001
024400                                                                  02440001
024500     EXEC SQL                                                     02450001
024600        SELECT  LOC_NM                                            02460001
024700         INTO  :XLT00010-LOC-NM                                   02470001
024800         FROM   XLT_LOC                                           02480001
024900        WHERE   LOC_NBR        = :DK-DC-LOCATION                  02490001
025000     END-EXEC.                                                    02500001
025100                                                                  02510001
025200     EVALUATE TRUE                                                02520001
025300         WHEN SQLCODE = 0                                         02530001
025400             CONTINUE                                             02540001
025500         WHEN SQLCODE = +100                                      02550001
025600             MOVE 'UNKNOWN'    TO XLT00010-LOC-NM                 02560001
025700                                                                  02570001
025800         WHEN OTHER                                               02580001
025900             MOVE SQLCODE TO SQLCODE2                             02590001
026000             DISPLAY '******************************************' 02600001
026100             DISPLAY '* ABEND                                   ' 02610001
026200             DISPLAY '* PROGRAM = WSKRP007                      ' 02620001
026300             DISPLAY '* PARAGRAPH = 0800-GET-DC-NAME'             02630001
026400             DISPLAY '** SQLCODE   = ' SQLCODE2                   02640001
026500             DISPLAY '******************************************' 02650001
026600             PERFORM 9100-SQL-ABEND                               02660001
026700     END-EVALUATE.                                                02670001
026800                                                                  02680001
026900                                                                  02690001
027000****************************************************************  02700001
027100* GET THE NAME OF THE CLIENT                                      02710001
027200****************************************************************  02720001
027300 0900-GET-USER-NAME.                                              02730001
027400                                                                  02740001
027500     INITIALIZE XL067-USER-COMMAREA.                              02750001
027600     DISPLAY WS014-CRE-USER-ID.                                   02760001
027700     MOVE WS014-CRE-USER-ID      TO XL067-KEY-USER-ID.            02770001
027800     SET XL067-BY-USER-ID        TO TRUE.                         02780001
027900     SET XL067-SELECT-KOHLS-USER TO TRUE.                         02790001
028000     MOVE 'WSKRP007'             TO XL067-ORIG-CALLING-PGM-NM.    02800001
028100                                                                  02810001
028200     CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               02820001
028300                                                                  02830001
028400     EVALUATE TRUE                                                02840001
028500         WHEN XL067-SUCCESSFUL                                    02850001
028600             IF XL067-USER-NOT-FOUND                              02860001
028700                 MOVE WS014-CRE-USER-ID     TO PV-USER-NAME       02870001
028800             ELSE                                                 02880001
028900                 MOVE XL067-COMBINED-NAME-3 TO PV-USER-NAME       02890001
029000             END-IF                                               02900001
029100             DISPLAY XL067-USER-FOUND-CODE ' '                    02910001
029200                     XL067-COMBINED-NAME-3                        02920001
029300         WHEN OTHER                                               02930001
029400* JAK - TEMP FIX FOR INVALID TRANS FROM EFC4                      02940001
029500             IF XL067-USER-NOT-FOUND                              02950001
029510                 MOVE WS014-CRE-USER-ID     TO PV-USER-NAME       02951001
029520             ELSE                                                 02952001
029530             MOVE WS014-CRE-USER-ID     TO PV-USER-NAME           02953001
029540             DISPLAY '******************************************' 02954001
029550             DISPLAY '* ABEND                                   ' 02955001
029551             DISPLAY '* PROGRAM = WSKRP007                      ' 02955101
029552             DISPLAY '* PARAGRAPH = 0900-GET-USER-NAME'           02955201
029553             DISPLAY '* INVALID RETURN FROM XLKUT067'             02955301
029554             DISPLAY '** RETURN CODE = ' XL067-RETURN-CODE        02955401
029555             DISPLAY '******************************************' 02955501
029556             PERFORM 9100-SQL-ABEND                               02955601
029557             END-IF                                               02955701
029558     END-EVALUATE.                                                02955801
029559                                                                  02955901
029560*                                                                 02956006
029561****************************************************************  02956101
029562* GET THE SHIPMENT TYPE CODE                                      02956201
029563****************************************************************  02956301
029564 1000-GET-SHPMT-TYPE.                                             02956414
029565                                                                  02956514
029566     MOVE WS014-RCVD-SHPMT-NBR   TO DK-EXT-SHP-ID.                02956614
029567                                                                  02956714
029568     EXEC SQL                                                     02956814
029569        SELECT  SOR_CDE                                           02956914
029570         INTO  :WST00001-SOR-CDE                                  02957014
029571         FROM   WST_SHPMT_XREF_HDR                                02957114
029572        WHERE   EXT_SHP_ID     = :DK-EXT-SHP-ID                   02957214
029573     END-EXEC.                                                    02957314
029574                                                                  02957414
029575     EVALUATE TRUE                                                02957514
029576         WHEN SQLCODE = 0                                         02957614
029579                 MOVE WST00001-SOR-CDE  TO  PV-SHPMT-TYPE         02957917
029580                                                                  02958019
029585         WHEN SQLCODE = +100                                      02958514
029586             MOVE ' '           TO PV-SHPMT-TYPE                  02958614
029587                                                                  02958714
029588         WHEN OTHER                                               02958814
029589             MOVE SQLCODE TO SQLCODE2                             02958914
029590             DISPLAY '******************************************' 02959014
029591             DISPLAY '* ABEND                                   ' 02959114
029592             DISPLAY '* PROGRAM = WSKRP007                      ' 02959214
029593             DISPLAY '* PARAGRAPH = 1000-GET-SHPMT-TYPE'          02959314
029594             DISPLAY '** SQLCODE   = ' SQLCODE2                   02959414
029595             DISPLAY '******************************************' 02959514
029596             PERFORM 9100-SQL-ABEND                               02959614
029597     END-EVALUATE.                                                02959714
029598                                                                  02959801
029599                                                                  02959901
029600******************************************************************02960001
029601* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      02960101
029602* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 02960201
029603******************************************************************02960301
029604 9100-SQL-ABEND.                                                  02960401
029605                                                                  02960501
029606* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    02960601
029607* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02960701
029608* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     02960801
029609* FORMAT                                                          02960901
029610     COPY DPPD004.                                                02961001
029620                                                                  02962001
029630     MOVE +4013               TO PV-ABEND-CODE.                   02963001
029640     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         02964001
029650                                                                  02965001
