000100*-----------------------*                                         00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300*-----------------------*                                         00030004
000400 PROGRAM-ID.    RCKCS262.                                         00040004
000500 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00050004
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  04-11-95.                                         00070004
000800 DATE-COMPILED.                                                   00080004
000900                                                                  00090004
001000*---------------------------------------------------------------* 00100004
001100*    Y262 - RECEIVING PO LIST.                                  * 00110004
001200*                                                               * 00120004
001300*    THIS PROGRAM GENERATES A LIST OF PO'S THAT ARE             * 00130004
001400*    ASSOCIATED TO THE SPECIFIED VEHICLE AND ALSO ALL OF        * 00140004
001500*    FORECAST SHIPMENTS FOR THE ORIGIN OR THE DELIVERY SCAC.    * 00150004
001600*                                                               * 00160004
001700*---------------------------------------------------------------* 00170004
001800* CHANGED 12-01-2011 CHRISTINE TWIEHAUS     WR#40574            * 00180008
001900*         ADDED CAN (CARR_AUTH_ID)                              * 00190005
002000*---------------------------------------------------------------* 00200005
002020* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00202008
002030* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00203008
002040* MAKING THE CALL DYNAMIC VS STATIC.                              00204008
002050*---------------------------------------------------------------* 00205008
002100 EJECT                                                            00210004
002200 ENVIRONMENT DIVISION.                                            00220004
002300                                                                  00230004
002400 DATA DIVISION.                                                   00240004
002500                                                                  00250004
002600 WORKING-STORAGE SECTION.                                         00260004
002700                                                                  00270004
002800 01  DK-DB2-KEYS.                                                 00280004
002900     05  DK-DEPT-NBR                    PIC X(03)   VALUE SPACES. 00290004
003000     05  DK-PO-NBR                      PIC S9(09)  COMP VALUE +0.00300004
003100     05  DK-RCVR-NBR                    PIC S9(09)  COMP VALUE +0.00310004
003200     05  DK-OPER-SET-ID                 PIC S9(04)  COMP VALUE +0.00320004
003300     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00330004
003400                                                    COMP.         00340004
003500     05  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00350004
003600                                                    COMP.         00360004
003700     05  DK-AGRMT-TYP-ID                PIC  X(01)  VALUE SPACE.  00370004
003800     05  DK-TYP-CDE                     PIC S9(04)  VALUE ZERO    00380004
003900                                                    COMP.         00390004
004000     05  DK-ORIGIN-SCAC-ID              PIC  X(04)  VALUE SPACE.  00400004
004100     05  DK-DELIVERY-SCAC-ID            PIC  X(04)  VALUE SPACE.  00410004
004200     05  DK-VEH-NBR                     PIC  X(10)  VALUE SPACE.  00420004
004300     05  DK-SHIPT-ID                    PIC S9(09)  VALUE +0      00430004
004400                                                    COMP.         00440004
004500     05  DK-TRIP-ID                     PIC S9(09)  VALUE +0      00450004
004600                                                    COMP.         00460004
004700     05  DK-PRO-B                       PIC  X(22)  VALUE SPACE.  00470004
004800     05  DK-PRO-E                       PIC  X(22)  VALUE SPACE.  00480004
004900     05  DK-PRO-NBR                     PIC  X(22)  VALUE SPACE.  00490004
005000     05  DK-BOL-NBR                     PIC  X(30)  VALUE SPACE.  00500004
005100     05  DK-PO-B                        PIC S9(09)  VALUE +0      00510004
005200                                                    COMP.         00520004
005300     05  DK-PO-E                        PIC S9(09)  VALUE +0      00530004
005400                                                    COMP.         00540004
005500* JAK 04/2007 - ADD NEW KEY FIELD                                 00550004
005600     05  DK-RCVR-SEQ-NBR                PIC S9(09)  VALUE +0      00560004
005700                                                    COMP.         00570004
005800                                                                  00580004
005900 01  PC-PROGRAM-CONSTANTS.                                        00590004
006000     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00600004
006100                                                    'RC262A  '.   00610004
006200     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00620004
006300                                                    'RCKM262 '.   00630004
006400     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00640004
006500                                                    'RCKCS262'.   00650004
006600     05  PC-DPKUT500                    PIC  X(08)  VALUE         00660004
006700                                                    'DPKUT500'.   00670004
006800     05  PC-TROUBLE-RTN                 PIC X(08)   VALUE         00680004
006900                                                    'TMKCS520'.   00690004
007000* JAK 04/2007 - ADD NEW FIELD                                     00700004
007100     05  PC-WMS-CONTROL-MOD             PIC X(8)    VALUE         00710004
007200                                                    'WSKCS305'.   00720004
007300     05  PC-TROUBLE-RTN-LENGTH          PIC S9(04)  VALUE         00730004
007400                                                    +600 COMP.    00740004
007500     05  PC-DEFAULT-9DATE               PIC X(10)   VALUE         00750004
007600                                                    '9999-09-09'. 00760004
007700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00770004
007800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00780004
007900     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00790004
008000     05  PC-INTER-APPL-SHIP-LIST        PIC  X(01)  VALUE '2'.    00800004
008100     05  PC-DELETED-STATUS-CDE          PIC  X(02)  VALUE 'DE'.   00810004
008200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00820004
008300                                                    COMP SYNC.    00830004
008400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00840004
008500                                                    COMP SYNC.    00850004
008600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00860004
008700                                                    +1000000      00870004
008800                                                    COMP-3.       00880004
008900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00890004
009000                                                    COMP SYNC.    00900004
009100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00910004
009200                                                    COMP-3.       00920004
009300     05  PC-9-9                         PIC S9(09)  VALUE         00930004
009400                                                    +999999999    00940004
009500                                                    COMP.         00950004
009600     05  PC-I                           PIC  X(01)  VALUE  'I'.   00960004
009700     05  PC-A                           PIC  X(01)  VALUE  'A'.   00970004
009800     05  PC-U                           PIC  X(01)  VALUE  'U'.   00980004
009900     05  PC-ET                          PIC  X(02)  VALUE  'ET'.  00990004
010000     05  PC-49                          PIC  X(02)  VALUE  '49'.  01000004
010100*                                                                 01010004
010200     05  PC-TSYMSG-NUMBERS.                                       01020004
010300         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01030004
010400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01040004
010500         10  PC-TSYMSG-00009            PIC  9(05)  VALUE 00009.  01050004
010600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01060004
010700         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01070004
010800         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01080004
010900         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01090004
011000         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01100004
011100         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01110004
011200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01120004
011300         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01130004
011400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01140004
011500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01150004
011600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01160004
011700         10  PC-TSYMSG-00117            PIC  9(05)  VALUE 00117.  01170004
011800         10  PC-TSYMSG-00146            PIC  9(05)  VALUE 00146.  01180004
011900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01190004
012000         10  PC-TSYMSG-00391            PIC  9(05)  VALUE 00391.  01200004
012100         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01210004
012200         10  PC-TSYMSG-00847            PIC  9(05)  VALUE 00847.  01220004
012300         10  PC-TSYMSG-01015            PIC  9(05)  VALUE 01015.  01230004
012400         10  PC-TSYMSG-02285            PIC  9(05)  VALUE 02285.  01240004
012500         10  PC-TSYMSG-02301            PIC  9(05)  VALUE 02301.  01250004
012600* JAK 04/2007 - ADD ERROR MESSAGES - BEGIN                        01260004
012700         10  PC-TSYMSG-03533            PIC  9(05)  VALUE 03533.  01270004
012800         10  PC-TSYMSG-03534            PIC  9(05)  VALUE 03534.  01280004
012900         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01290004
013000         10  PC-TSYMSG-03548            PIC  9(05)  VALUE 03548.  01300004
013100         10  PC-TSYMSG-05343            PIC  9(05)  VALUE 05343.  01310004
013200* JAK 04/2007 - ADD ERROR MESSAGES - BEGIN                        01320004
013300*                                                                 01330004
013400 01  PS-PROGRAM-SWITCHES.                                         01340004
013500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01350004
013600         88  PS-NO-ERROR                            VALUE 'Y'.    01360004
013700         88  PS-ERROR                               VALUE 'N'.    01370004
013800     05  PS-VEND-SHIP-DTE-SW            PIC  X(01)  VALUE 'N'.    01380004
013900         88  PS-NO-VND-SHP-DTE-ERR                  VALUE 'N'.    01390004
014000         88  PS-VEND-SHIP-DTE-ERROR                 VALUE 'Y'.    01400004
014100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01410004
014200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01420004
014300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01430004
014400     05  PS-END-OF-CURSOR-SW            PIC  X(01)  VALUE 'N'.    01440004
014500         88  PS-END-OF-CURSOR                       VALUE 'Y'.    01450004
014600         88  PS-NOT-END-OF-CURSOR                   VALUE 'N'.    01460004
014700     05  PS-LIST-END-SW                 PIC X(01)   VALUE 'N'.    01470004
014800         88  PS-LIST-END                            VALUE 'Y'.    01480004
014900         88  PS-NO-LIST-END                         VALUE 'N'.    01490004
015000     05  PS-UPDATE-SHPTPO-SW            PIC  X(01)  VALUE 'N'.    01500004
015100         88  PS-UPDATE-SHPTPO                       VALUE 'Y'.    01510004
015200         88  PS-DONT-UPDATE-SHPTPO                  VALUE 'N'.    01520004
015300     05  PS-TRECVER-CURSOR-SW           PIC  X(01)  VALUE 'N'.    01530004
015400         88  PS-EOF-TRECVER-CSR                     VALUE 'Y'.    01540004
015500         88  PS-NOT-EOF-TRECVER-CSR                 VALUE 'N'.    01550004
015600     05  PS-TOSOPFA-CURSOR-SW           PIC  X(01)  VALUE 'N'.    01560004
015700         88  PS-EOF-TOSOPFA-CSR                     VALUE 'Y'.    01570004
015800     05  PS-INSTRUCTION-SW              PIC  X(01)  VALUE 'N'.    01580004
015900         88  PS-FIRST-INSTRUCTION                   VALUE 'Y'.    01590004
016000     05  PS-OR-AND-CURSOR-SW            PIC  X(01)  VALUE 'N'.    01600004
016100         88  PS-OR-CURSOR                           VALUE 'Y'.    01610004
016200         88  PS-AND-CURSOR                          VALUE 'N'.    01620004
016300     05  PS-RCVR-FOUND-SW               PIC  X(01)  VALUE 'N'.    01630004
016400         88  PS-RCVR-FOUND                          VALUE 'Y'.    01640004
016500         88  PS-NO-RCVR-FOUND                       VALUE 'N'.    01650004
016600* JAK 04/2007 - ADD SWITCHES - BEGIN                              01660004
016700     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        01670004
016800         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        01680004
016900         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        01690004
017000     05  PS-MSGS-TRNSCRB-SW           PIC X(01) VALUE 'N'.        01700004
017100         88  PS-MSGS-TRNSCRB-YES                VALUE 'Y'.        01710004
017200         88  PS-MSGS-TRNSCRB-NO                 VALUE 'N'.        01720004
017300     05  PS-RECEIVING-BEGUN-SW        PIC X(01) VALUE 'N'.        01730004
017400         88  PS-RECEIVING-BEGUN-YES             VALUE 'Y'.        01740004
017500         88  PS-RECEIVING-BEGUN-NO              VALUE 'N'.        01750004
017600     05  PS-WMS-MESSAGE-SW            PIC X(01) VALUE 'N'.        01760004
017700         88  PS-WMS-MESSAGE-YES                 VALUE 'Y'.        01770004
017800         88  PS-WMS-MESSAGE-NO                  VALUE 'N'.        01780004
017900* JAK 04/2007 - ADD SWITCHES - END                                01790004
018000*                                                                 01800004
018100 01  PV-PROGRAM-VARIABLES.                                        01810004
018200     05  PV-SUB                         PIC S9(04)  VALUE +0      01820004
018300                                                    COMP SYNC.    01830004
018400     05  PV-TRN-CDE                     PIC  X(01) VALUE SPACE.   01840004
018500     05  PV-PACK-BY-ST-IND              PIC  X(01).               01850004
018600     05  PV-PRE-TICKET-IND              PIC  X(01).               01860004
018700     05  PV-GARM-ON-HNGR-IND            PIC  X(01).               01870004
018800     05  PV-WO-INSTR-SEQ-NBR            PIC S9(04)  VALUE +0      01880004
018900                                                    COMP SYNC.    01890004
019000     05  PV-NULL-TRIP-ID-IND            PIC S9(04)  VALUE +0      01900004
019100                                                    COMP.         01910004
019200     05  PV-NULL-TRIP-VEH-IND           PIC S9(04)  VALUE +0      01920004
019300                                                    COMP.         01930004
019400     05  PV-NULL-EST-AR-TMST            PIC S9(04)  VALUE +0      01940004
019500                                                    COMP.         01950004
019600     05  PV-SHIPMENT-COUNT              PIC S9(09)  VALUE +0      01960004
019700                                                    COMP-3.       01970004
019800     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      01980004
019900                                                    COMP-3.       01990004
020000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02000004
020100                                                    COMP SYNC.    02010004
020200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02020004
020300                                                    COMP-3.       02030004
020400     05  PV-COUNT                       PIC S9(09)  VALUE +0      02040004
020500                                                    COMP-3.       02050004
020600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02060004
020700                                                    COMP-3.       02070004
020800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02080004
020900                                                    COMP-3.       02090004
021000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02100004
021100                                                    COMP-3.       02110004
021200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02120004
021300                                                    COMP SYNC.    02130004
021400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02140004
021500                                                    COMP SYNC.    02150004
021600     05  PV-ITEM                        PIC S9(04)  VALUE +0      02160004
021700                                                    COMP SYNC.    02170004
021800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02180004
021900                                                    COMP SYNC.    02190004
022000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02200004
022100                                                    COMP SYNC.    02210004
022200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02220004
022300                                                    COMP SYNC.    02230004
022400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02240004
022500                                                    COMP SYNC.    02250004
022600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02260004
022700                                                    COMP SYNC.    02270004
022800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02280004
022900                                                    COMP SYNC.    02290004
023000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02300004
023100                                                    COMP SYNC.    02310004
023200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02320004
023300                                                    COMP SYNC.    02330004
023400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02340004
023500                                                    COMP SYNC.    02350004
023600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02360004
023700                                                    COMP SYNC.    02370004
023800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02380004
023900                                                    COMP SYNC.    02390004
024000     05  PV-PO-CSR-IND                  PIC  X(01)  VALUE SPACES. 02400004
024100     05  PV-DB2-COUNT                   PIC S9(04)  VALUE +0      02410004
024200                                                    COMP SYNC.    02420004
024300     05  PV-VEND-SHIP-DTE               PIC  X(10)  VALUE SPACES. 02430004
024400     05  PV-REC-SEQ-NBR                 PIC S9(09)  VALUE +0      02440004
024500                                                    COMP SYNC.    02450004
024600     05  PV-SAVE-TRIP-ID                PIC S9(09)  VALUE +0      02460004
024700                                                    COMP SYNC.    02470004
024800     05  PV-VER-NBR                     PIC S9(09)  VALUE +0      02480004
024900                                                    COMP SYNC.    02490004
025000     05  PV-CLASS-NBR-99                PIC 99.                   02500004
025100     05  PV-CLASS-NBR-2CH               PIC X(2).                 02510004
025200     05  PV-MESSAGE.                                              02520004
025300         10  PV-MESSAGE1                PIC X(10).                02530004
025400         10  FILLER                     PIC X(01).                02540004
025500         10  PV-MESSAGE2                PIC X(10).                02550004
025600* JAK 04/2007 - ADD NEW FIELDS - START                            02560004
025700     05  PV-SQL-COUNT                   PIC S9(09)  VALUE +0      02570004
025800                                                    COMP-3.       02580004
025900     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      02590004
026000                                                     COMP SYNC.   02600004
026100* JAK 04/2007 - ADD NEW FIELDS - END                              02610004
026200                                                                  02620004
026300 01  PW-PROGRAM-WORKAREA.                                         02630004
026400     05  PW-CONTROL-REC.                                          02640004
026500         10  PW-CONTROL-KEYREC.                                   02650004
026600             20  PW-CONTROL-PANL-NBR.                             02660004
026700                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   02670004
026800                 30  PW-CONTROL-KEYREC-NBR                        02680004
026900                                         PIC 9(02)  VALUE ZERO.   02690004
027000             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  02700004
027100                                       PW-CONTROL-PANL-NBR        02710004
027200                                         PIC 9(7).                02720004
027300             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   02730004
027400         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      02740004
027500                                         PIC 9(08).               02750004
027600         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  02760004
027700                                                                  02770004
027800     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   02780004
027900     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   02790004
028000                                                                  02800004
028100*----------------------------------------------------------------*02810004
028200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02820004
028300**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02830004
028400**  APPLICATION-SPECIFIC COMMAREA.                              **02840004
028500*----------------------------------------------------------------*02850004
028600 01  LQW-LIST-QUEUE-WORK-AREA.                                    02860004
028700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02870004
028800     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           02880004
028900                                        INDEXED BY LQW-IDX.       02890004
029000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02900004
029100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02910004
029200         10  LQW-SELECTED-SW            PIC  X(01).               02920004
029300             88  LQW-SELECT                         VALUE 'S'.    02930004
029400             88  LQW-DESELECT                       VALUE ' '.    02940004
029500         10  LQW-ACTION                 PIC  X(03).               02950004
029600         10  LQW-SHIPT-ID               PIC S9(09)  COMP.         02960004
029700         10  LQW-TRIP-ID                PIC S9(09)  COMP.         02970004
029800         10  LQW-CSR-IND                PIC  X(01).               02980004
029900         10  LQW-STATUS                 PIC  X(02).               02990004
030000         10  LQW-RECEIVER               PIC  9(03).               03000004
030100         10  LQW-EXP-CTN-CNT            PIC S9(09) COMP.          03010004
030200         10  LQW-VEND-CTN-CNT           PIC S9(09) COMP.          03020004
030300         10  LQW-PO                     PIC S9(09) COMP.          03030004
030400         10  LQW-FREIGHT-BILL           PIC  X(20).               03040004
030500         10  LQW-BILL-OF-LADING         PIC  X(20).               03050004
030600         10  LQW-ADJ-CART-CNT           PIC S9(09) COMP.          03060004
030700         10  LQW-ASN-CART-CNT           PIC S9(09) COMP.          03070004
030800         10  LQW-VENDOR                 PIC  X(10).               03080004
030900         10  LQW-ORIGIN-SCAC            PIC  X(04).               03090004
031000                                                                  03100004
031100* JAK 04/2007 - ADD WMS COPYBOOK                                  03110004
031200***************************************************************** 03120004
031300* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 03130004
031400***************************************************************** 03140004
031500     COPY WSWS001.                                                03150004
031600                                                                  03160004
031700     EJECT                                                        03170004
031800*---------------------------------------------------------------* 03180004
031900*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 03190004
032000*---------------------------------------------------------------* 03200004
032100                                                                  03210004
032200     COPY RCWS013.                                                03220004
032300                                                                  03230004
032400*----------------------------------------------------------------*03240004
032500*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     03250004
032600*----------------------------------------------------------------*03260004
032700     COPY TMWS500.                                                03270004
032800                                                                  03280004
032900/                                                                 03290004
033000*----------------------------------------------------------------*03300004
033100*  WORK AREA PASSED IN CALL TO DPKUT500                          *03310004
033200*----------------------------------------------------------------*03320004
033300     COPY DPWS500.                                                03330004
033400                                                                  03340004
033500     EJECT                                                        03350004
033600*---------------------------------------------------------------* 03360004
033700*    MAP LAYOUT                                                 * 03370004
033800*---------------------------------------------------------------* 03380004
033900                                                                  03390004
034000     COPY RCKM262.                                                03400004
034100*                                                                 03410004
034200 01  MR-OCCURS-LAYOUT                   REDEFINES  RC262AO.       03420004
034300     05  FILLER                         PIC X(91).                03430004
034400     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          03440004
034500         10  MR-SELECTL                 PIC S9(04) COMP.          03450004
034600         10  MR-SELECTA                 PIC  X(01).               03460004
034700         10  MR-SELECTC                 PIC  X(01).               03470004
034800         10  MR-SELECTH                 PIC  X(01).               03480004
034900         10  MR-SELECTI                 PIC  X(01).               03490004
035000                                                                  03500004
035100         10  MR-STATUSL                 PIC S9(04) COMP.          03510004
035200         10  MR-STATUSA                 PIC  X(01).               03520004
035300         10  MR-STATUSC                 PIC  X(01).               03530004
035400         10  MR-STATUSH                 PIC  X(01).               03540004
035500         10  MR-STATUS                  PIC  X(02).               03550004
035600                                                                  03560004
035700         10  MR-RECEIVERL               PIC S9(04) COMP.          03570004
035800         10  MR-RECEIVERA               PIC  X(01).               03580004
035900         10  MR-RECEIVERC               PIC  X(01).               03590004
036000         10  MR-RECEIVERH               PIC  X(01).               03600004
036100         10  MR-RECEIVER-X.                                       03610004
036200             15  MR-RECEIVER            PIC  Z(03).               03620004
036300                                                                  03630004
036400         10  MR-PO-NBRL                 PIC S9(04) COMP.          03640004
036500         10  MR-PO-NBRA                 PIC  X(01).               03650004
036600         10  MR-PO-NBRC                 PIC  X(01).               03660004
036700         10  MR-PO-NBRH                 PIC  X(01).               03670004
036800         10  MR-PO-NBR-X.                                         03680004
036900** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03690007
037000             15  MR-PO-NBR              PIC  Z(08).               03700007
037100                                                                  03710004
037200         10  MR-FREIGHT-BILLL           PIC S9(04) COMP.          03720004
037300         10  MR-FREIGHT-BILLA           PIC  X(01).               03730004
037400         10  MR-FREIGHT-BILLC           PIC  X(01).               03740004
037500         10  MR-FREIGHT-BILLH           PIC  X(01).               03750004
037600         10  MR-FREIGHT-BILL            PIC  X(16).               03760004
037700                                                                  03770004
037800         10  MR-BILL-OF-LADINGL         PIC S9(04) COMP.          03780004
037900         10  MR-BILL-OF-LADINGA         PIC  X(01).               03790004
038000         10  MR-BILL-OF-LADINGC         PIC  X(01).               03800004
038100         10  MR-BILL-OF-LADINGH         PIC  X(01).               03810004
038200         10  MR-BILL-OF-LADING          PIC  X(16).               03820004
038300                                                                  03830004
038400         10  MR-ADJ-CART-CNTL           PIC S9(04) COMP.          03840004
038500         10  MR-ADJ-CART-CNTA           PIC  X(01).               03850004
038600         10  MR-ADJ-CART-CNTC           PIC  X(01).               03860004
038700         10  MR-ADJ-CART-CNTH           PIC  X(01).               03870004
038800         10  MR-ADJ-CART-CNT-X.                                   03880004
038900             15  MR-ADJ-CART-CNT        PIC ZZZ9.                 03890004
039000                                                                  03900004
039100         10  MR-ASN-CART-CNTL           PIC S9(04) COMP.          03910004
039200         10  MR-ASN-CART-CNTA           PIC  X(01).               03920004
039300         10  MR-ASN-CART-CNTC           PIC  X(01).               03930004
039400         10  MR-ASN-CART-CNTH           PIC  X(01).               03940004
039500         10  MR-ASN-CART-CNT-X.                                   03950004
039600             15  MR-ASN-CART-CNT        PIC ZZZ9.                 03960004
039700                                                                  03970004
039800         10  MR-VENDORL                 PIC S9(04) COMP.          03980004
039900         10  MR-VENDORA                 PIC  X(01).               03990004
040000         10  MR-VENDORC                 PIC  X(01).               04000004
040100         10  MR-VENDORH                 PIC  X(01).               04010004
040200         10  MR-VENDOR                  PIC  X(10).               04020004
040300                                                                  04030004
040400         10  MR-ORIGIN-SCACL            PIC S9(04) COMP.          04040004
040500         10  MR-ORIGIN-SCACA            PIC  X(01).               04050004
040600         10  MR-ORIGIN-SCACC            PIC  X(01).               04060004
040700         10  MR-ORIGIN-SCACH            PIC  X(01).               04070004
040800         10  MR-ORIGIN-SCAC             PIC  X(04).               04080004
040900                                                                  04090004
041000     EJECT                                                        04100004
041100*---------------------------------------------------------------* 04110004
041200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04120004
041300*---------------------------------------------------------------* 04130004
041400                                                                  04140004
041500     COPY DPWS015.                                                04150004
041600                                                                  04160004
041700*---------------------------------------------------------------* 04170004
041800*    FUNCTION KEYS COPYBOOK.                                    * 04180004
041900*---------------------------------------------------------------* 04190004
042000                                                                  04200004
042100     COPY DPWS016.                                                04210004
042200                                                                  04220004
042300*---------------------------------------------------------------* 04230004
042400*    NUMERIC EDIT LAYOUT.                                       * 04240004
042500*---------------------------------------------------------------* 04250004
042600                                                                  04260004
042700     COPY DPWS010I.                                               04270004
042800 EJECT                                                            04280004
042900******************************************************************04290009
043000** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04300009
043010** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04301009
043100******************************************************************04310009
043200                                                                  04320004
043300     COPY DPWS030.                                                04330004
043310     COPY DPWS930.                                                04331009
043400 EJECT                                                            04340004
043500*---------------------------------------------------------------* 04350004
043600*    STANDARD COMMAREA.                                         * 04360004
043700*---------------------------------------------------------------* 04370004
043800                                                                  04380004
043900     COPY DPWS020.                                                04390004
044000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04400004
044100                                                                  04410004
044200*---------------------------------------------------------------* 04420004
044300* INTER-APPLICATION COMMAREA.                                   * 04430004
044400*   RCWS012 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04440004
044500*             SPEC SCREEN.                                      * 04450004
044600*   RCWS015 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04460004
044700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04470004
044800*---------------------------------------------------------------* 04480004
044900                                                                  04490004
045000         10  INTER-APPL-COMM-AREA       PIC X(200).               04500004
045100     COPY RCWS012.                                                04510004
045200     COPY RCWS015.                                                04520004
045300*---------------------------------------------------------------* 04530004
045400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04540004
045500*---------------------------------------------------------------* 04550004
045600         10  ASC-SPECIFIC-COMMAREA.                               04560004
045700             15  ASC-LIST-KEYS.                                   04570004
045800                 20  ASC-KEY-OPER-UNT-ID             PIC  X(04).  04580004
045900                 20  ASC-KEY-OPER-UNT-ID-N REDEFINES              04590004
046000                     ASC-KEY-OPER-UNT-ID             PIC  9(04).  04600004
046100                 20  ASC-KEY-FCLTY-ID                PIC  X(04).  04610004
046200                 20  ASC-KEY-FCLTY-ID-N REDEFINES                 04620004
046300                     ASC-KEY-FCLTY-ID                PIC  9(04).  04630004
046400                 20  ASC-KEY-ORIGIN-SCAC-ID          PIC  X(04).  04640004
046500                 20  ASC-KEY-DELIVERY-SCAC-ID        PIC  X(04).  04650004
046600                 20  ASC-KEY-VEH-NBR                 PIC  X(10).  04660004
046700                 20  ASC-KEY-STATUS                  PIC  X(02).  04670004
046800                 20  ASC-KEY-TRIP-ID                 PIC S9(09)   04680004
046900                                                     COMP.        04690004
047000                 20  ASC-KEY-PRO-NBR                 PIC  X(22).  04700004
047100                 20  ASC-KEY-BOL-NBR                 PIC  X(30).  04710004
047200                 20  ASC-KEY-PO-NBR                  PIC S9(9)    04720004
047300                                                     COMP.        04730004
047400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04740004
047500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04750004
047600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04760004
047700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04770004
047800                                                                  04780004
047900                 20  ASC-ITEM-ARRAY.                              04790004
048000                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        04800004
048100                         30  ASC-LIST-ITEM-NUMBER                 04810004
048200                                                     PIC S9(09)   04820004
048300                                                     COMP-3.      04830004
048400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  04840004
048500                             88  ASC-VALID-SELECT    VALUE ' '    04850004
048600                                                           'S'    04860004
048700                                                           'B'    04870004
048800                                                           'E'.   04880004
048900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04890004
049000                             88  ASC-TEMP-SELECT     VALUE 'S'.   04900004
049100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04910004
049200                             88  ASC-TEMP-END        VALUE 'E'.   04920004
049300                         30  ASC-SELECTED-SW         PIC  X(01).  04930004
049400                             88  ASC-NO-SELECT       VALUE ' '.   04940004
049500                             88  ASC-SELECT          VALUE 'S'.   04950004
049600                             88  ASC-BEGIN           VALUE 'B'.   04960004
049700                             88  ASC-END             VALUE 'E'.   04970004
049800                         30  ASC-ACTION              PIC  X(03).  04980004
049900                         30  ASC-SHIPT-ID            PIC S9(09)   04990004
050000                                                          COMP.   05000004
050100                         30  ASC-TRIP-ID             PIC S9(09)   05010004
050200                                                          COMP.   05020004
050300                         30  ASC-CSR-IND             PIC  X(01).  05030004
050400                         30  ASC-STATUS              PIC  X(02).  05040004
050500                         30  ASC-RECEIVER            PIC  9(03).  05050004
050600                         30  ASC-EXP-CTN-CNT         PIC S9(09)   05060004
050700                                                          COMP.   05070004
050800                         30  ASC-VEND-CTN-CNT        PIC S9(09)   05080004
050900                                                          COMP.   05090004
051000                         30  ASC-PO                  PIC S9(09)   05100004
051100                                                          COMP.   05110004
051200                         30  ASC-FREIGHT-BILL        PIC  X(20).  05120004
051300                         30  ASC-BILL-OF-LADING      PIC  X(20).  05130004
051400                         30  ASC-ADJ-CART-CNT        PIC S9(09)   05140004
051500                                                          COMP.   05150004
051600                         30  ASC-ASN-CART-CNT        PIC S9(09)   05160004
051700                                                          COMP.   05170004
051800                         30  ASC-VENDOR              PIC  X(10).  05180004
051900                         30  ASC-ORIGIN-SCAC         PIC  X(04).  05190004
052000                                                                  05200004
052100             15  ASC-BLK-SUB                         PIC S9(04)   05210004
052200                                                          COMP    05220004
052300                                                          SYNC.   05230004
052400             15  ASC-ITEM-SUB                        PIC S9(04)   05240004
052500                                                          COMP    05250004
052600                                                          SYNC.   05260004
052700             15  ASC-SEL-SUB                         PIC S9(04)   05270004
052800                                                         COMP.    05280004
052900             15  ASC-SEL-ITEM                        PIC S9(04)   05290004
053000                                                         COMP.    05300004
053100             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05310004
053200                                                          COMP-3. 05320004
053300             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05330004
053400                                                          COMP-3. 05340004
053500             15  ASC-NUMBER-OF-TS-ITEMS      PIC S9(05)           05350004
053600                                                 COMP-3.          05360004
053700             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05370004
053800                                                          COMP-3. 05380004
053900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05390004
054000                                                          COMP-3. 05400004
054100             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05410004
054200                                                          COMP-3. 05420004
054300             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05430004
054400                                                          COMP    05440004
054500                                                          SYNC.   05450004
054600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05460004
054700                                                          COMP-3. 05470004
054800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05480004
054900                                                          COMP-3. 05490004
055000             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05500004
055100                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05510004
055200                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05520004
055300             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05530004
055400                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05540004
055500                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05550004
055600             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          05560004
055700                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         05570004
055800             15  ASC-LIST-QUEUE-NAME.                             05580004
055900                 20  ASC-LIST-TERM-ID                PIC  X(04).  05590004
056000                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05600004
056100                                                          COMP-3. 05610004
056200                 20  ASC-LIST-SEQ                    PIC  9(01).  05620004
056300             15  ASC-PREV-LIST-QUEUE-NAME            PIC  X(08).  05630004
056400             15  ASC-SEL-QUEUE-NAME.                              05640004
056500                 20  ASC-SEL-TERM-ID                 PIC  X(04).  05650004
056600                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   05660004
056700                                                          COMP-3. 05670004
056800                 20  ASC-SEL-SEQ                     PIC  9(01).  05680004
056900                                                                  05690004
057000             15  ASC-PREV-SEL-QUEUE-NAME             PIC  X(08).  05700004
057100             15  ASC-START-ITEM-REQUEST.                          05710004
057200                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05720004
057300     EJECT                                                        05730004
057400*---------------------------------------------------------------* 05740004
057500*    ABEND PROCESSING COPYBOOK.                                 * 05750004
057600*---------------------------------------------------------------* 05760004
057700                                                                  05770004
057800     COPY DPWS013.                                                05780004
057900                                                                  05790004
058000 EJECT                                                            05800004
058100*----------------------------------------------------------------*05810004
058200*    DB2 DCLGEN FOR THE COMPANY CONTROL TABLE                     05820004
058300*----------------------------------------------------------------*05830004
058400     EXEC SQL                                                     05840004
058500          INCLUDE TCOCNTL                                         05850004
058600     END-EXEC.                                                    05860004
058700                                                                  05870004
058800*----------------------------------------------------------------*05880004
058900*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     05890004
059000*----------------------------------------------------------------*05900004
059100     EXEC SQL                                                     05910004
059200          INCLUDE TRECVER                                         05920004
059300     END-EXEC.                                                    05930004
059400                                                                  05940004
059500*----------------------------------------------------------------*05950004
059600*    DB2 DCLGEN FOR THE PURCHASE ORDER  TABLE                     05960004
059700*----------------------------------------------------------------*05970004
059800     EXEC SQL                                                     05980004
059900          INCLUDE TPURCHS                                         05990004
060000     END-EXEC.                                                    06000004
060100                                                                  06010004
060200*----------------------------------------------------------------*06020004
060300*    DB2 DCLGEN FOR THE PURCHASE ITEM TABLE                       06030004
060400*----------------------------------------------------------------*06040004
060500     EXEC SQL                                                     06050004
060600          INCLUDE TPURITM                                         06060004
060700     END-EXEC.                                                    06070004
060800                                                                  06080004
060900*----------------------------------------------------------------*06090004
061000*    DB2 DCLGEN FOR THE OPER SET TABLE                            06100004
061100*----------------------------------------------------------------*06110004
061200     EXEC SQL                                                     06120004
061300          INCLUDE TOPRSET                                         06130004
061400     END-EXEC.                                                    06140004
061500                                                                  06150004
061600*----------------------------------------------------------------*06160004
061700*    DB2 DCLGEN FOR THE WORK ORDER TABLE                          06170004
061800*----------------------------------------------------------------*06180004
061900     EXEC SQL                                                     06190004
062000          INCLUDE TWRKORD                                         06200004
062100     END-EXEC.                                                    06210004
062200                                                                  06220004
062300*----------------------------------------------------------------*06230004
062400*    DB2 DCLGEN FOR THE EXTERNAL ENTITY NAME TABLE                06240004
062500*----------------------------------------------------------------*06250004
062600     EXEC SQL                                                     06260004
062700          INCLUDE TENTNME                                         06270004
062800     END-EXEC.                                                    06280004
062900                                                                  06290004
063000*----------------------------------------------------------------*06300004
063100*    DB2 AREA FOR OPERATION SET/FACILITY TABLE                   *06310004
063200*----------------------------------------------------------------*06320004
063300                                                                  06330004
063400     EXEC SQL                                                     06340004
063500          INCLUDE TOSOPFA                                         06350004
063600     END-EXEC.                                                    06360004
063700                                                                  06370004
063800*----------------------------------------------------------------*06380004
063900*    DB2 AREA FOR WORK ORDER INSTRUCTION TABLE                   *06390004
064000*----------------------------------------------------------------*06400004
064100                                                                  06410004
064200     EXEC SQL                                                     06420004
064300          INCLUDE TWKORIN                                         06430004
064400     END-EXEC.                                                    06440004
064500                                                                  06450004
064600*----------------------------------------------------------------*06460004
064700*    DB2 AREA FOR TDCFAAS  DEPT/CLASS FACILITY LOC. ASSIGNMENTS  *06470004
064800*----------------------------------------------------------------*06480004
064900                                                                  06490004
065000     EXEC SQL                                                     06500004
065100          INCLUDE TDCFAAS                                         06510004
065200     END-EXEC.                                                    06520004
065300                                                                  06530004
065400*---------------------------------------------------------------* 06540004
065500*    DB2 AREA FOR PO AGREEMENT TABLE                            * 06550004
065600*---------------------------------------------------------------* 06560004
065700     EXEC SQL                                                     06570004
065800          INCLUDE TPOAGMT                                         06580004
065900     END-EXEC.                                                    06590004
066000*---------------------------------------------------------------* 06600004
066100*    DB2 AREA FOR VEHICL TABLE                                  * 06610004
066200*---------------------------------------------------------------* 06620004
066300     EXEC SQL                                                     06630004
066400          INCLUDE TVEHICL                                         06640004
066500     END-EXEC.                                                    06650004
066600*---------------------------------------------------------------* 06660004
066700*    DB2 AREA FOR SHIPMENT TABLE                                * 06670004
066800*---------------------------------------------------------------* 06680004
066900     EXEC SQL                                                     06690004
067000          INCLUDE TSHIPMT                                         06700004
067100     END-EXEC.                                                    06710004
067200*---------------------------------------------------------------* 06720004
067300*    DB2 AREA FOR SHIPMENT PO AUDIT TABLE                       * 06730004
067400*---------------------------------------------------------------* 06740004
067500     EXEC SQL                                                     06750004
067600          INCLUDE TAUSHPO                                         06760004
067700     END-EXEC.                                                    06770004
067800*---------------------------------------------------------------* 06780004
067900*    DB2 AREA FOR THE SHIPMENT AUDIT TABLE                      * 06790004
068000*---------------------------------------------------------------* 06800004
068100     EXEC SQL                                                     06810004
068200          INCLUDE TAUSHIP                                         06820004
068300     END-EXEC.                                                    06830004
068400*---------------------------------------------------------------* 06840004
068500*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 06850004
068600*---------------------------------------------------------------* 06860004
068700     EXEC SQL                                                     06870004
068800          INCLUDE TSHIPST                                         06880004
068900     END-EXEC.                                                    06890004
069000*---------------------------------------------------------------* 06900004
069100*    DB2 AREA FOR SHIPMENT PO TABLE                             * 06910004
069200*---------------------------------------------------------------* 06920004
069300     EXEC SQL                                                     06930004
069400          INCLUDE TSHPTPO                                         06940004
069500     END-EXEC.                                                    06950004
069600*---------------------------------------------------------------* 06960004
069700*    DB2 AREA FOR STATUS TYPE TABLE                             * 06970004
069800*---------------------------------------------------------------* 06980004
069900     EXEC SQL                                                     06990004
070000          INCLUDE TSHSTYP                                         07000004
070100     END-EXEC.                                                    07010004
070200*---------------------------------------------------------------* 07020004
070300*    DB2 AREA FOR TRIP STATUS TABLE                             * 07030004
070400*---------------------------------------------------------------* 07040004
070500     EXEC SQL                                                     07050004
070600          INCLUDE TTRSTYP                                         07060004
070700     END-EXEC.                                                    07070004
070800*---------------------------------------------------------------* 07080004
070900*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 07090004
071000*---------------------------------------------------------------* 07100004
071100     EXEC SQL                                                     07110004
071200          INCLUDE TVHTRIP                                         07120004
071300     END-EXEC.                                                    07130004
071400*---------------------------------------------------------------* 07140004
071500*    DB2 AREA FOR TRIP STATUS TABLE                             * 07150004
071600*---------------------------------------------------------------* 07160004
071700     EXEC SQL                                                     07170004
071800          INCLUDE TTRIPST                                         07180004
071900     END-EXEC.                                                    07190004
072000*---------------------------------------------------------------* 07200004
072100*    DB2 AREA FOR RECEIVER TABLE                                * 07210004
072200*---------------------------------------------------------------* 07220004
072300     EXEC SQL                                                     07230004
072400          INCLUDE TRECEIV                                         07240004
072500     END-EXEC.                                                    07250004
072600                                                                  07260004
072700     EXEC SQL                                                     07270004
072800          INCLUDE TPOSYNC                                         07280004
072900     END-EXEC.                                                    07290004
073000******************************************************************07300004
073100*    DB2 DCLGEN XLV00000 (XLV_SKU)                                07310004
073200******************************************************************07320004
073300     EXEC SQL                                                     07330004
073400          INCLUDE XLV00000                                        07340004
073500     END-EXEC.                                                    07350004
073600                                                                  07360004
073700******************************************************************07370004
073800*    DB2 DCLGEN XLV00001 (XLV_VND_STYL)                           07380004
073900******************************************************************07390004
074000     EXEC SQL                                                     07400004
074100          INCLUDE XLV00001                                        07410004
074200     END-EXEC.                                                    07420004
074300* JAK 04/2007 - ADD TRECITM, TKRPRPM TABLES                       07430004
074400*----------------------------------------------------------------*07440004
074500*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       07450004
074600*----------------------------------------------------------------*07460004
074700     EXEC SQL                                                     07470004
074800          INCLUDE TRECITM                                         07480004
074900     END-EXEC.                                                    07490004
075000                                                                  07500004
075100*---------------------------------------------------------------* 07510004
075200*    DB2 AREA FOR THE PARM TABLE                                * 07520004
075300*---------------------------------------------------------------* 07530004
075400     EXEC SQL                                                     07540004
075500          INCLUDE TKRPRPM                                         07550004
075600     END-EXEC.                                                    07560004
075700                                                                  07570004
075800*---------------------------------------------------------------* 07580004
075900*    DB2 AREA FOR COMMUNICATIONS                                * 07590004
076000*---------------------------------------------------------------* 07600004
076100     EXEC SQL                                                     07610004
076200          INCLUDE SQLCA                                           07620004
076300     END-EXEC.                                                    07630004
076400                                                                  07640004
076500                                                                  07650004
076600*---------------------------------------------------------------* 07660004
076700*    SHIPMENT CURSOR WHICH WILL LIST ALL SHIPMENTS ON A TRAILER,* 07670004
076800*    THEN LIST ALL FORECAST SHIPMENTS FOR THE CARRIER           * 07680004
076900*---------------------------------------------------------------* 07690004
077000                                                                  07700004
077100     EXEC SQL                                                     07710004
077200          DECLARE PO-CSR CURSOR FOR                               07720004
077300              SELECT 'A'                                          07730004
077400              , A.TRIP_ID                                         07740004
077500              , A.SHIPT_ID                                        07750004
077600              , A.PRO_NBR                                         07760004
077700              , A.BOL_NBR                                         07770004
077800              , A.EXPTED_PKG_QTY                                  07780004
077900              , A.VEND_CART_CT                                    07790004
078000              , D.PO_NBR                                          07800004
078100              , D.REC_SEQ_NBR                                     07810004
078200              , D.EXPTED_CART_CNT                                 07820004
078300              , D.ACTL_CART_CNT                                   07830004
078400              , D.CARR_CART_CT                                    07840004
078500              , D.VEND_CART_CT                                    07850004
078600              , D.VEND_NAME                                       07860004
078700              , A.ORIG_SCAC_ID                                    07870004
078800          FROM                                                    07880004
078900                TSHIPMT A                                         07890004
079000              , TVHTRIP B                                         07900004
079100              , TTRIPST C                                         07910004
079200              , TSHPTPO D                                         07920004
079300              , TVEHICL E                                         07930004
079400          WHERE B.OWNER_SCAC_ID     = :DK-ORIGIN-SCAC-ID          07940004
079500            AND B.VEH_NBR           = :DK-VEH-NBR                 07950004
079600            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             07960004
079700            AND C.FCLTY_ID          = :DK-FCLTY-ID                07970004
079800            AND B.TRIP_ID           = C.TRIP_ID                   07980004
079900            AND B.TRIP_ID           = A.TRIP_ID                   07990004
080000            AND A.SHIPT_ID          = D.SHIPT_ID                  08000004
080100            AND E.CURR_TRIP_ID      = B.REF_TRIP_ID               08010004
080200       UNION                                                      08020004
080300          SELECT 'B'                                              08030004
080400              , A.TRIP_ID                                         08040004
080500              , A.SHIPT_ID                                        08050004
080600              , A.PRO_NBR                                         08060004
080700              , A.BOL_NBR                                         08070004
080800              , A.EXPTED_PKG_QTY                                  08080004
080900              , A.VEND_CART_CT                                    08090004
081000              , D.PO_NBR                                          08100004
081100              , D.REC_SEQ_NBR                                     08110004
081200              , D.EXPTED_CART_CNT                                 08120004
081300              , D.ACTL_CART_CNT                                   08130004
081400              , D.CARR_CART_CT                                    08140004
081500              , D.VEND_CART_CT                                    08150004
081600              , D.VEND_NAME                                       08160004
081700              , A.ORIG_SCAC_ID                                    08170004
081800          FROM                                                    08180004
081900                TSHIPMT A                                         08190004
082000              , TVHTRIP B                                         08200004
082100              , TTRIPST C                                         08210004
082200              , TSHPTPO D                                         08220004
082300          WHERE A.PRO_SCAC_ID      IN (:DK-DELIVERY-SCAC-ID,      08230004
082400                                      :DK-ORIGIN-SCAC-ID)         08240004
082500            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             08250004
082600            AND C.FCLTY_ID          = :DK-FCLTY-ID                08260004
082700            AND B.TRIP_ID           = C.TRIP_ID                   08270004
082800            AND B.TRIP_ID           = A.TRIP_ID                   08280004
082900            AND B.VEH_NBR           IS NULL                       08290004
083000            AND A.SHIPT_ID          = D.SHIPT_ID                  08300004
083100            AND A.PRO_NBR BETWEEN     :DK-PRO-B                   08310004
083200                          AND         :DK-PRO-E                   08320004
083300            AND D.PO_NBR BETWEEN      :DK-PO-B                    08330004
083400                         AND          :DK-PO-E                    08340004
083500          ORDER BY 1, 4, 5                                        08350004
083600     END-EXEC.                                                    08360004
083700                                                                  08370004
083800     EXEC SQL                                                     08380004
083900          DECLARE PO-OR-CSR CURSOR FOR                            08390004
084000              SELECT 'A'                                          08400004
084100              , A.TRIP_ID                                         08410004
084200              , A.SHIPT_ID                                        08420004
084300              , A.PRO_NBR                                         08430004
084400              , A.BOL_NBR                                         08440004
084500              , A.EXPTED_PKG_QTY                                  08450004
084600              , A.VEND_CART_CT                                    08460004
084700              , D.PO_NBR                                          08470004
084800              , D.REC_SEQ_NBR                                     08480004
084900              , D.EXPTED_CART_CNT                                 08490004
085000              , D.ACTL_CART_CNT                                   08500004
085100              , D.CARR_CART_CT                                    08510004
085200              , D.VEND_CART_CT                                    08520004
085300              , D.VEND_NAME                                       08530004
085400              , A.ORIG_SCAC_ID                                    08540004
085500          FROM                                                    08550004
085600                TSHIPMT A                                         08560004
085700              , TVHTRIP B                                         08570004
085800              , TTRIPST C                                         08580004
085900              , TSHPTPO D                                         08590004
086000              , TVEHICL E                                         08600004
086100          WHERE B.OWNER_SCAC_ID     = :DK-ORIGIN-SCAC-ID          08610004
086200            AND B.VEH_NBR           = :DK-VEH-NBR                 08620004
086300            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             08630004
086400            AND C.FCLTY_ID          = :DK-FCLTY-ID                08640004
086500            AND B.TRIP_ID           = C.TRIP_ID                   08650004
086600            AND B.TRIP_ID           = A.TRIP_ID                   08660004
086700            AND A.SHIPT_ID          = D.SHIPT_ID                  08670004
086800            AND E.CURR_TRIP_ID      = B.REF_TRIP_ID               08680004
086900       UNION                                                      08690004
087000          SELECT 'B'                                              08700004
087100              , A.TRIP_ID                                         08710004
087200              , A.SHIPT_ID                                        08720004
087300              , A.PRO_NBR                                         08730004
087400              , A.BOL_NBR                                         08740004
087500              , A.EXPTED_PKG_QTY                                  08750004
087600              , A.VEND_CART_CT                                    08760004
087700              , D.PO_NBR                                          08770004
087800              , D.REC_SEQ_NBR                                     08780004
087900              , D.EXPTED_CART_CNT                                 08790004
088000              , D.ACTL_CART_CNT                                   08800004
088100              , D.CARR_CART_CT                                    08810004
088200              , D.VEND_CART_CT                                    08820004
088300              , D.VEND_NAME                                       08830004
088400              , A.ORIG_SCAC_ID                                    08840004
088500          FROM                                                    08850004
088600                TSHIPMT A                                         08860004
088700              , TVHTRIP B                                         08870004
088800              , TTRIPST C                                         08880004
088900              , TSHPTPO D                                         08890004
089000          WHERE A.PRO_SCAC_ID      IN (:DK-DELIVERY-SCAC-ID,      08900004
089100                                      :DK-ORIGIN-SCAC-ID)         08910004
089200            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             08920004
089300            AND C.FCLTY_ID          = :DK-FCLTY-ID                08930004
089400            AND B.TRIP_ID           = C.TRIP_ID                   08940004
089500            AND B.TRIP_ID           = A.TRIP_ID                   08950004
089600            AND B.VEH_NBR           IS NULL                       08960004
089700            AND A.SHIPT_ID          = D.SHIPT_ID                  08970004
089800            AND (A.PRO_NBR BETWEEN     :DK-PRO-B                  08980004
089900                          AND         :DK-PRO-E                   08990004
090000             OR D.PO_NBR BETWEEN      :DK-PO-B                    09000004
090100                         AND          :DK-PO-E)                   09010004
090200          ORDER BY 1, 4, 5                                        09020004
090300     END-EXEC.                                                    09030004
090400                                                                  09040004
090500                                                                  09050004
090600     EXEC SQL                                                     09060004
090700          DECLARE PO1-CSR CURSOR FOR                              09070004
090800              SELECT 'A'                                          09080004
090900              , A.TRIP_ID                                         09090004
091000              , A.SHIPT_ID                                        09100004
091100              , A.PRO_NBR                                         09110004
091200              , A.BOL_NBR                                         09120004
091300              , A.EXPTED_PKG_QTY                                  09130004
091400              , A.VEND_CART_CT                                    09140004
091500              , D.PO_NBR                                          09150004
091600              , D.REC_SEQ_NBR                                     09160004
091700              , D.EXPTED_CART_CNT                                 09170004
091800              , D.ACTL_CART_CNT                                   09180004
091900              , D.CARR_CART_CT                                    09190004
092000              , D.VEND_CART_CT                                    09200004
092100              , D.VEND_NAME                                       09210004
092200              , A.ORIG_SCAC_ID                                    09220004
092300              , B.VEH_NBR                                         09230004
092400              , C.TRIP_STATUS_CDE                                 09240004
092500          FROM                                                    09250004
092600                TSHIPMT A                                         09260004
092700              , TVHTRIP B                                         09270004
092800              , TTRIPST C                                         09280004
092900              , TSHPTPO D                                         09290004
093000              , TTRSTYP E                                         09300004
093100          WHERE A.PRO_NBR           = :DK-PRO-NBR                 09310004
093200            AND A.BOL_NBR           = :DK-BOL-NBR                 09320004
093300            AND A.PRO_SCAC_ID       = :DK-DELIVERY-SCAC-ID        09330004
093400            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             09340004
093500            AND C.FCLTY_ID          = :DK-FCLTY-ID                09350004
093600            AND B.TRIP_ID           = C.TRIP_ID                   09360004
093700            AND B.TRIP_ID           = A.TRIP_ID                   09370004
093800            AND A.SHIPT_ID          = D.SHIPT_ID                  09380004
093900            AND C.TRIP_STATUS_CDE   = E.TRIP_STATUS_CDE           09390004
094000            AND E.PRTY_CDE =                                      09400004
094100              (SELECT MAX(G.PRTY_CDE)                             09410004
094200                 FROM TTRIPST F                                   09420004
094300                     ,TTRSTYP G                                   09430004
094400                WHERE F.TRIP_ID       = B.TRIP_ID                 09440004
094500                AND F.TRIP_STATUS_CDE = G.TRIP_STATUS_CDE)        09450004
094600          ORDER BY 1, 4, 5                                        09460004
094700     END-EXEC.                                                    09470004
094800                                                                  09480004
094900     EXEC SQL                                                     09490004
095000          DECLARE SHPTPO-CSR CURSOR FOR                           09500004
095100          SELECT PO_NBR                                           09510004
095200               , REC_SEQ_NBR                                      09520004
095300               , EXPTED_CART_CNT                                  09530004
095400               , ACTL_CART_CNT                                    09540004
095500               , CARR_CART_CT                                     09550004
095600               , VEND_CART_CT                                     09560004
095700            FROM TSHPTPO                                          09570004
095800           WHERE SHIPT_ID = :DK-SHIPT-ID                          09580004
095900     END-EXEC                                                     09590004
096000                                                                  09600004
096100 EJECT                                                            09610004
096200 LINKAGE SECTION.                                                 09620004
096300                                                                  09630004
096400 01  DFHCOMMAREA.                                                 09640004
096500     05  FILLER                         OCCURS  1 TO 4072 TIMES   09650004
096600                                        DEPENDING ON EIBCALEN.    09660004
096700         10  FILLER                     PIC X.                    09670004
096800                                                                  09680004
096900 EJECT                                                            09690004
097000 PROCEDURE DIVISION.                                              09700004
097100******************************************************************09710004
097200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09720004
097300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09730004
097400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09740004
097500******************************************************************09750004
097600 0000-MAIN-MODULE.                                                09760004
097700     INITIALIZE DP030-CICS-API-FIELDS.                            09770004
097800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09780004
097900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09790004
098000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09800004
098100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09810004
098200     MOVE LENGTH OF RC262AI        TO DP030-MAP-LENGTH (1).       09820004
098300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09830004
098400     PERFORM 0001-CALL-CICS-ARCH-API.                             09840004
098500*                                                                 09850004
098600     PERFORM 1000-CONTROL-PROCESSING                              09860004
098700*                                                                 09870004
098800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09880004
098900     PERFORM 0001-CALL-CICS-ARCH-API.                             09890004
099000                                                                  09900004
099100******************************************************************09910004
099200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09920004
099300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09930004
099400******************************************************************09940004
099500 0001-CALL-CICS-ARCH-API.                                         09950004
099610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09961009
099700                                    DFHCOMMAREA                   09970009
099800                                    DP030-CICS-API-FIELDS         09980009
099900                                    DP020-STANDARD-COMMAREA       09990009
100000                                    RC262AI.                      10000009
100100*                                                                 10010004
100200     IF  DP030-RC-CALL-SUCCESSFUL                                 10020004
100300         CONTINUE                                                 10030004
100400     ELSE                                                         10040004
100500         SET DP013-NO-ROLLBACK                                    10050004
100600             DP013-XCTL-DISPLAY-RESTART                           10060004
100700             DP013-CICS-ABEND      TO TRUE                        10070004
100800         MOVE '0001-CALL-CICS-ARCH-API'                           10080004
100900                                   TO DP013-PARAGRAPH             10090004
100920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10092009
100930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10093009
101200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10120004
101300         PERFORM DP013-0000-PROCESS-ABEND                         10130004
101400     END-IF.                                                      10140004
101500*----------------------------------------------------------------*10150004
101600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10160004
101700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10170004
101800*                                                                *10180004
101900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10190004
102000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10200004
102100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10210004
102200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10220004
102300*----------------------------------------------------------------*10230004
102400                                                                  10240004
102500 1000-CONTROL-PROCESSING.                                         10250004
102600                                                                  10260004
102700     EVALUATE TRUE                                                10270004
102800         WHEN DP020-NEXT-ACT-INITIAL                              10280004
102900             INITIALIZE ASC-SPECIFIC-COMMAREA                     10290004
103000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10300004
103100                                      ASC-SEL-TERM-ID             10310004
103200             MOVE DP020-SRC-TASK-NUMBER                           10320004
103300                                   TO ASC-LIST-TASK-NUMBER        10330004
103400                                      ASC-SEL-TASK-NUMBER         10340004
103500             MOVE PC-LIST-QUEUE-SEQ                               10350004
103600                                   TO ASC-LIST-SEQ                10360004
103700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 10370004
103800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10380004
103900***-----$TEMPLATE NOTE$-------------------------------------------10390004
104000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,10400004
104100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  10410004
104200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.10420004
104300***---------------------------------------------------------------10430004
104400             IF  PS-COMMAREA-NOT-VALID                            10440004
104500                 SET DP020-NEXT-ACT-APPL-ERROR                    10450004
104600                                   TO TRUE                        10460004
104700             ELSE                                                 10470004
104800                 PERFORM 4000-BUILD-INITIAL-PANEL                 10480004
104900             END-IF                                               10490004
105000                                                                  10500004
105100         WHEN DP020-NEXT-ACT-READ-MAP                             10510004
105200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10520004
105300                                   TO PV-TOP-ITEM                 10530004
105400             PERFORM 2000-PROCESS-PANEL                           10540004
105500                                                                  10550004
105600         WHEN DP020-NEXT-ACT-RETURN                               10560004
105700             MOVE ASC-KEY-OPER-UNT-ID-N                           10570004
105800                                    TO DK-OPER-UNT-ID             10580004
105900             MOVE ASC-KEY-FCLTY-ID-N                              10590004
106000                                    TO DK-FCLTY-ID                10600004
106100             MOVE ASC-KEY-ORIGIN-SCAC-ID                          10610004
106200                                   TO DK-ORIGIN-SCAC-ID           10620004
106300             MOVE ASC-KEY-DELIVERY-SCAC-ID                        10630004
106400                                    TO DK-DELIVERY-SCAC-ID        10640004
106500             MOVE ASC-KEY-VEH-NBR   TO DK-VEH-NBR                 10650004
106600             IF ASC-KEY-PRO-NBR = SPACE                           10660004
106700                 MOVE SPACES            TO DK-PRO-B               10670004
106800                 MOVE HIGH-VALUES       TO DK-PRO-E               10680004
106900             ELSE                                                 10690004
107000                 MOVE ASC-KEY-PRO-NBR   TO DK-PRO-B               10700004
107100                 MOVE ASC-KEY-PRO-NBR   TO DK-PRO-E               10710004
107200             END-IF                                               10720004
107300             IF ASC-KEY-PO-NBR = ZERO                             10730004
107400                 MOVE ZERO              TO DK-PO-B                10740007
107500                 MOVE PC-9-9            TO DK-PO-E                10750004
107600             ELSE                                                 10760004
107700                 MOVE ASC-KEY-PO-NBR    TO DK-PO-B                10770004
107800                 MOVE ASC-KEY-PO-NBR    TO DK-PO-E                10780004
107900             END-IF                                               10790004
108000             IF ASC-KEY-PRO-NBR NOT = SPACE AND                   10800004
108100                ASC-KEY-PO-NBR NOT = ZERO                         10810004
108200                 SET PS-OR-CURSOR TO TRUE                         10820004
108300             ELSE                                                 10830004
108400                 SET PS-AND-CURSOR TO TRUE                        10840004
108500             END-IF                                               10850004
108600             MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR             10860004
108700             MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR             10870004
108800             PERFORM 2050-DELETE-LIST-QUEUE                       10880004
108900             PERFORM 4000-BUILD-INITIAL-PANEL                     10890004
109000                                                                  10900004
109100                                                                  10910004
109200         WHEN OTHER                                               10920004
109300             SET DP013-LOGIC-ABEND TO TRUE                        10930004
109400             SET DP013-NO-ROLLBACK TO TRUE                        10940004
109500             MOVE '1000-CONTROL-PROCESSING'                       10950004
109600                                   TO DP013-PARAGRAPH             10960004
109700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10970004
109800                                   TO DP013-MESSAGE-TEXT(1)       10980004
109900             PERFORM DP013-0000-PROCESS-ABEND                     10990004
110000     END-EVALUATE.                                                11000004
110100                                                                  11010004
110200 EJECT                                                            11020004
110300*----------------------------------------------------------------*11030004
110400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11040004
110500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11050004
110600*----------------------------------------------------------------*11060004
110700                                                                  11070004
110800 1100-PROCESS-INTER-APPL-COMM.                                    11080004
110900                                                                  11090004
111000     SET PS-COMMAREA-VALID          TO TRUE.                      11100004
111100     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    11110004
111200     EVALUATE DP020-INT-APPL-FORMAT-IND                           11120004
111300       WHEN PC-CRIT-SPEC-FORMAT                                   11130004
111400         IF RC012-TRIP-ID = ZERO                                  11140004
111500           MOVE PC-TSYMSG-00743  TO DP020-MSG-NUMBER              11150004
111600           SET PS-COMMAREA-NOT-VALID TO TRUE                      11160004
111700         ELSE                                                     11170004
111800         IF RC012-STATUS = PC-ET                                  11180004
111900           MOVE PC-TSYMSG-01015  TO DP020-MSG-NUMBER              11190004
112000           MOVE PC-ET            TO DP020-MSG-TEXT                11200004
112100           SET PS-COMMAREA-NOT-VALID TO TRUE                      11210004
112200         ELSE                                                     11220004
112300           MOVE RC012-OPER-UNT-ID   TO ASC-KEY-OPER-UNT-ID        11230004
112400           MOVE RC012-FCLTY-ID      TO ASC-KEY-FCLTY-ID           11240004
112500           MOVE RC012-OWNER-SCAC-ID TO ASC-KEY-DELIVERY-SCAC-ID   11250004
112600           MOVE RC012-STATUS        TO ASC-KEY-STATUS             11260004
112700           MOVE RC012-TRIP-ID       TO ASC-KEY-TRIP-ID            11270004
112800           MOVE RC012-PRO-NBR       TO ASC-KEY-PRO-NBR            11280004
112900           MOVE RC012-PO-NBR        TO ASC-KEY-PO-NBR             11290004
113000           IF RC012-ORIGIN-SCAC-ID > SPACES                       11300004
113100             MOVE RC012-ORIGIN-SCAC-ID                            11310004
113200                                    TO ASC-KEY-ORIGIN-SCAC-ID     11320004
113300           ELSE                                                   11330004
113400             MOVE RC012-OWNER-SCAC-ID                             11340004
113500                                    TO ASC-KEY-ORIGIN-SCAC-ID     11350004
113600           END-IF                                                 11360004
113700           MOVE RC012-VEH-NBR       TO ASC-KEY-VEH-NBR            11370004
113800         END-IF                                                   11380004
113900         END-IF                                                   11390004
114000       WHEN PC-INTER-APPL-SHIP-LIST                               11400004
114100         SET ASC-USE-SELECTION-QUEUE TO TRUE                      11410004
114200         MOVE RC015-NUMBER-OF-TS-ITEMS                            11420004
114300                           TO ASC-NUMBER-OF-TS-ITEMS              11430004
114400         MOVE RC015-SEL-QUEUE-NAME                                11440004
114500                           TO ASC-PREV-SEL-QUEUE-NAME             11450004
114600         PERFORM 1120-PREPARE-LIST-ENTRY                          11460004
114700       WHEN OTHER                                                 11470004
114800         SET PS-COMMAREA-NOT-VALID TO TRUE                        11480004
114900     END-EVALUATE.                                                11490004
115000                                                                  11500004
115100*----------------------------------------------------------------*11510004
115200*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *11520004
115300*----------------------------------------------------------------*11530004
115400                                                                  11540004
115500 1120-PREPARE-LIST-ENTRY.                                         11550004
115600                                                                  11560004
115700     MOVE RC013-MAX-ITEMS TO ASC-SEL-SUB.                         11570004
115800     MOVE ZERO            TO ASC-SEL-ITEM.                        11580004
115900     PERFORM 2160-GET-NEXT-RECORD.                                11590004
116000                                                                  11600004
116100 EJECT                                                            11610004
116200*----------------------------------------------------------------*11620004
116300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11630004
116400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11640004
116500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11650004
116600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11660004
116700* FUNCTION KEYS CAN GET THIS FAR.                                *11670004
116800*----------------------------------------------------------------*11680004
116900                                                                  11690004
117000 2000-PROCESS-PANEL.                                              11700004
117100     EVALUATE TRUE                                                11710004
117200         WHEN DP020-SRC-AID = DP016-CLEAR                         11720004
117300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11730004
117400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11740004
117500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11750004
117600                                                                  11760004
117700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11770004
117800             MOVE ASC-KEY-OPER-UNT-ID-N                           11780004
117900                                    TO DK-OPER-UNT-ID             11790004
118000             MOVE ASC-KEY-FCLTY-ID-N                              11800004
118100                                    TO DK-FCLTY-ID                11810004
118200             MOVE ASC-KEY-ORIGIN-SCAC-ID                          11820004
118300                                   TO DK-ORIGIN-SCAC-ID           11830004
118400             MOVE ASC-KEY-DELIVERY-SCAC-ID                        11840004
118500                                    TO DK-DELIVERY-SCAC-ID        11850004
118600             MOVE ASC-KEY-VEH-NBR   TO DK-VEH-NBR                 11860004
118700             IF ASC-KEY-PRO-NBR = SPACE                           11870004
118800                 MOVE SPACES            TO DK-PRO-B               11880004
118900                 MOVE HIGH-VALUES       TO DK-PRO-E               11890004
119000             ELSE                                                 11900004
119100                 MOVE ASC-KEY-PRO-NBR   TO DK-PRO-B               11910004
119200                 MOVE ASC-KEY-PRO-NBR   TO DK-PRO-E               11920004
119300             END-IF                                               11930004
119400             IF ASC-KEY-PO-NBR = ZERO                             11940004
119500                 MOVE ZERO              TO DK-PO-B                11950004
119600                 MOVE PC-9-9            TO DK-PO-E                11960004
119700             ELSE                                                 11970004
119800                 MOVE ASC-KEY-PO-NBR    TO DK-PO-B                11980004
119900                 MOVE ASC-KEY-PO-NBR    TO DK-PO-E                11990004
120000             END-IF                                               12000004
120100             IF ASC-KEY-PRO-NBR NOT = SPACE AND                   12010004
120200                ASC-KEY-PO-NBR NOT = ZERO                         12020004
120300                 SET PS-OR-CURSOR TO TRUE                         12030004
120400             ELSE                                                 12040004
120500                 SET PS-AND-CURSOR TO TRUE                        12050004
120600             END-IF                                               12060004
120700             MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR             12070004
120800             MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR             12080004
120900             PERFORM 2050-DELETE-LIST-QUEUE                       12090004
121000             PERFORM 4000-BUILD-INITIAL-PANEL                     12100004
121100                                                                  12110004
121200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12120004
121300             IF  ASC-USE-SELECTION-QUEUE                          12130004
121400                 PERFORM 2160-GET-NEXT-RECORD                     12140004
121500                 IF PS-LIST-END                                   12150004
121600                    SET PS-NO-LIST-END                            12160004
121700                                   TO TRUE                        12170004
121800                 ELSE                                             12180004
121900                    PERFORM 2050-DELETE-LIST-QUEUE                12190004
122000                    PERFORM 3200-RESET-ATTRIBUTES                 12200004
122100                    PERFORM 4000-BUILD-INITIAL-PANEL              12210004
122200                 END-IF                                           12220004
122300             ELSE                                                 12230004
122400*                --- BOTTOM OF LIST ---                           12240004
122500                 MOVE PC-TSYMSG-00070                             12250004
122600                                   TO DP020-MSG-NUMBER            12260004
122700                 SET DP020-MSG-INFORMATIONAL                      12270004
122800                     PS-LIST-END   TO TRUE                        12280004
122900             END-IF                                               12290004
123000                                                                  12300004
123100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12310004
123200             IF  ASC-USE-SELECTION-QUEUE                          12320004
123300                 PERFORM 2170-GET-PREV-RECORD                     12330004
123400                 IF PS-LIST-END                                   12340004
123500                    SET PS-NO-LIST-END                            12350004
123600                                   TO TRUE                        12360004
123700                 ELSE                                             12370004
123800                    PERFORM 2050-DELETE-LIST-QUEUE                12380004
123900                    PERFORM 3200-RESET-ATTRIBUTES                 12390004
124000                    PERFORM 4000-BUILD-INITIAL-PANEL              12400004
124100                 END-IF                                           12410004
124200             ELSE                                                 12420004
124300*                --- TOP OF LIST ---                              12430004
124400                 MOVE PC-TSYMSG-00069                             12440004
124500                                   TO DP020-MSG-NUMBER            12450004
124600                 SET DP020-MSG-INFORMATIONAL                      12460004
124700                     PS-LIST-END   TO TRUE                        12470004
124800             END-IF                                               12480004
124900                                                                  12490004
125000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12500004
125100             PERFORM 2140-DESELECT-ALL-ITEMS                      12510004
125200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12520004
125300                                                                  12530004
125400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12540004
125500             PERFORM 2150-SELECT-ALL-ITEMS                        12550004
125600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12560004
125700                                                                  12570004
125800         WHEN OTHER                                               12580004
125900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12590004
126000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12600004
126100             IF  PS-NO-ERROR                                      12610004
126200                 SET DP030-CONTINUE-GO                            12620004
126300                                 TO TRUE                          12630004
126400                 PERFORM 2100-CHECK-FUNCTION-KEY                  12640004
126500             ELSE                                                 12650004
126600                 SET DP030-OVERRIDE-GO                            12660004
126700                                 TO TRUE                          12670004
126800             END-IF                                               12680004
126900     END-EVALUATE.                                                12690004
127000 EJECT                                                            12700004
127100*----------------------------------------------------------------*12710004
127200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12720004
127300*----------------------------------------------------------------*12730004
127400 2050-DELETE-LIST-QUEUE.                                          12740004
127500                                                                  12750004
127600     EXEC CICS                                                    12760004
127700         DELETEQ TS                                               12770004
127800             QUEUE (ASC-LIST-QUEUE-NAME)                          12780004
127900             RESP  (PV-CICS-RESP)                                 12790004
128000     END-EXEC.                                                    12800004
128100                                                                  12810004
128200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12820004
128300        (PV-CICS-RESP = DFHRESP(QIDERR))                          12830004
128400         CONTINUE                                                 12840004
128500     ELSE                                                         12850004
128600         SET DP013-CICS-ABEND      TO TRUE                        12860004
128700         SET DP013-NO-ROLLBACK     TO TRUE                        12870004
128800                                                                  12880004
128900         MOVE '2050-DELETE-LIST-QUEUE'                            12890004
129000                                   TO DP013-PARAGRAPH             12900004
129100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12910004
129200                                   TO DP013-MESSAGE-TEXT (1)      12920004
129300         PERFORM DP013-0000-PROCESS-ABEND                         12930004
129400     END-IF.                                                      12940004
129500                                                                  12950004
129600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12960004
129700 EJECT                                                            12970004
129800*----------------------------------------------------------------*12980004
129900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12990004
130000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13000004
130100* CICS ARCHITECTURE API.                                         *13010004
130200*----------------------------------------------------------------*13020004
130300 2100-CHECK-FUNCTION-KEY.                                         13030004
130400     EVALUATE TRUE                                                13040004
130500         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  13050004
130600                 INITIALIZE RC015-INTER-APPL-COMMAREA             13060004
130700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13070004
130800                                TO RC015-NUMBER-OF-SELECTED-ITEMS 13080004
130900                 MOVE ASC-KEY-OPER-UNT-ID                         13090004
131000                                   TO RC015-OPER-UNT-ID           13100004
131100                 MOVE ASC-KEY-FCLTY-ID TO RC015-FCLTY-ID          13110004
131200                 PERFORM 5000-PREPARE-SEL-QUEUE                   13120004
131300                                                                  13130004
131400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13140004
131500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13150004
131600                 INITIALIZE RC015-INTER-APPL-COMMAREA             13160004
131700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13170004
131800                                TO RC015-NUMBER-OF-SELECTED-ITEMS 13180004
131900                 PERFORM 5000-PREPARE-SEL-QUEUE                   13190004
132000                 IF PS-ERROR                                      13200004
132100                     CONTINUE                                     13210004
132200                 ELSE                                             13220004
132300                     IF PV-NUMBER-OF-UPDATES > 0                  13230004
132400                         MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER 13240004
132500                     ELSE                                         13250004
132600                         MOVE PC-TSYMSG-00146 TO DP020-MSG-NUMBER 13260004
132700                     END-IF                                       13270004
132800                 END-IF                                           13280004
132900                 MOVE ASC-KEY-OPER-UNT-ID-N                       13290004
133000                                        TO DK-OPER-UNT-ID         13300004
133100                 MOVE ASC-KEY-FCLTY-ID-N                          13310004
133200                                        TO DK-FCLTY-ID            13320004
133300                 MOVE ASC-KEY-ORIGIN-SCAC-ID                      13330004
133400                                       TO DK-ORIGIN-SCAC-ID       13340004
133500                 MOVE ASC-KEY-DELIVERY-SCAC-ID                    13350004
133600                                        TO DK-DELIVERY-SCAC-ID    13360004
133700                 MOVE ASC-KEY-VEH-NBR   TO DK-VEH-NBR             13370004
133800                 IF ASC-KEY-PRO-NBR = SPACE                       13380004
133900                     MOVE SPACES            TO DK-PRO-B           13390004
134000                     MOVE HIGH-VALUES       TO DK-PRO-E           13400004
134100                 ELSE                                             13410004
134200                     MOVE ASC-KEY-PRO-NBR   TO DK-PRO-B           13420004
134300                     MOVE ASC-KEY-PRO-NBR   TO DK-PRO-E           13430004
134400                 END-IF                                           13440004
134500                 IF ASC-KEY-PO-NBR = ZERO                         13450004
134600                     MOVE ZERO              TO DK-PO-B            13460004
134700                     MOVE PC-9-9            TO DK-PO-E            13470004
134800                 ELSE                                             13480004
134900                     MOVE ASC-KEY-PO-NBR    TO DK-PO-B            13490004
135000                     MOVE ASC-KEY-PO-NBR    TO DK-PO-E            13500004
135100                 END-IF                                           13510004
135200                 MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR         13520004
135300                 MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR         13530004
135400                 IF ASC-KEY-PRO-NBR NOT = SPACE AND               13540004
135500                    ASC-KEY-PO-NBR NOT = ZERO                     13550004
135600                     SET PS-OR-CURSOR TO TRUE                     13560004
135700                 ELSE                                             13570004
135800                     SET PS-AND-CURSOR TO TRUE                    13580004
135900                 END-IF                                           13590004
136000                 PERFORM 2050-DELETE-LIST-QUEUE                   13600004
136100                 PERFORM 4000-BUILD-INITIAL-PANEL                 13610004
136200             ELSE                                                 13620004
136300                 SET DP030-OVERRIDE-GO                            13630004
136400                                   TO TRUE                        13640004
136500                 MOVE PC-TSYMSG-00057                             13650004
136600                                   TO DP020-MSG-NUMBER            13660004
136700                 SET DP020-MSG-WARNING                            13670004
136800                                   TO TRUE                        13680004
136900             END-IF                                               13690004
137000                                                                  13700004
137100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13710004
137200             PERFORM 5800-SELECT-TVEHICL                          13720004
137300             IF SQLCODE = +100                                    13730004
137400                 SET DP030-OVERRIDE-GO                            13740004
137500                                   TO TRUE                        13750004
137600                 MOVE PC-TSYMSG-00743                             13760004
137700                                   TO DP020-MSG-NUMBER            13770004
137800                 SET DP020-MSG-WARNING                            13780004
137900                                   TO TRUE                        13790004
138000             ELSE                                                 13800004
138100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13810004
138200                 INITIALIZE RC015-INTER-APPL-COMMAREA             13820004
138300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13830004
138400                                TO RC015-NUMBER-OF-SELECTED-ITEMS 13840004
138500                 PERFORM 5000-PREPARE-SEL-QUEUE                   13850004
138600                 IF PV-NUMBER-OF-UPDATES > 0                      13860004
138700                     IF PS-VEND-SHIP-DTE-ERROR                    13870004
138800                        CONTINUE                                  13880004
138900                     ELSE                                         13890004
139000                        MOVE PC-TSYMSG-00059                      13900004
139100                                             TO DP020-MSG-NUMBER  13910004
139200                     END-IF                                       13920004
139300                 ELSE                                             13930004
139400                     MOVE PC-TSYMSG-00146    TO DP020-MSG-NUMBER  13940004
139500                 END-IF                                           13950004
139600                 MOVE ASC-KEY-OPER-UNT-ID-N                       13960004
139700                                        TO DK-OPER-UNT-ID         13970004
139800                 MOVE ASC-KEY-FCLTY-ID-N                          13980004
139900                                        TO DK-FCLTY-ID            13990004
140000                 MOVE ASC-KEY-ORIGIN-SCAC-ID                      14000004
140100                                       TO DK-ORIGIN-SCAC-ID       14010004
140200                 MOVE ASC-KEY-DELIVERY-SCAC-ID                    14020004
140300                                        TO DK-DELIVERY-SCAC-ID    14030004
140400                 MOVE ASC-KEY-VEH-NBR   TO DK-VEH-NBR             14040004
140500                 IF ASC-KEY-PRO-NBR = SPACE                       14050004
140600                     MOVE SPACES            TO DK-PRO-B           14060004
140700                     MOVE HIGH-VALUES       TO DK-PRO-E           14070004
140800                 ELSE                                             14080004
140900                     MOVE ASC-KEY-PRO-NBR   TO DK-PRO-B           14090004
141000                     MOVE ASC-KEY-PRO-NBR   TO DK-PRO-E           14100004
141100                 END-IF                                           14110004
141200                 IF ASC-KEY-PO-NBR = ZERO                         14120004
141300                     MOVE ZERO              TO DK-PO-B            14130004
141400                     MOVE PC-9-9            TO DK-PO-E            14140004
141500                 ELSE                                             14150004
141600                     MOVE ASC-KEY-PO-NBR    TO DK-PO-B            14160004
141700                     MOVE ASC-KEY-PO-NBR    TO DK-PO-E            14170004
141800                 END-IF                                           14180004
141900                 MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR         14190004
142000                 MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR         14200004
142100                 IF ASC-KEY-PRO-NBR NOT = SPACE AND               14210004
142200                    ASC-KEY-PO-NBR NOT = ZERO                     14220004
142300                     SET PS-OR-CURSOR TO TRUE                     14230004
142400                 ELSE                                             14240004
142500                     SET PS-AND-CURSOR TO TRUE                    14250004
142600                 END-IF                                           14260004
142700                 PERFORM 2050-DELETE-LIST-QUEUE                   14270004
142800                 PERFORM 4000-BUILD-INITIAL-PANEL                 14280004
142900* JAK 04/2007 - ADD PERFORM OF 8000-                              14290004
143000                 PERFORM 8000-WMS-SHIPMENT-CHECK                  14300004
143100             ELSE                                                 14310004
143200                 SET DP030-OVERRIDE-GO                            14320004
143300                                   TO TRUE                        14330004
143400                 MOVE PC-TSYMSG-00057                             14340004
143500                                   TO DP020-MSG-NUMBER            14350004
143600                 SET DP020-MSG-WARNING                            14360004
143700                                   TO TRUE                        14370004
143800             END-IF                                               14380004
143900             END-IF                                               14390004
144000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14400004
144100             MOVE +1               TO PV-TOP-ITEM                 14410004
144200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14420004
144300                                                                  14430004
144400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14440004
144500             PERFORM 2110-BROWSE-BACKWARD                         14450004
144600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14460004
144700                                                                  14470004
144800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14480004
144900             PERFORM 2120-BROWSE-FORWARD                          14490004
145000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14500004
145100                                                                  14510004
145200         WHEN DP020-SRC-AID = DP016-ENTER                         14520004
145300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14530004
145400             IF  PS-ERROR                                         14540004
145500                 CONTINUE                                         14550004
145600             ELSE                                                 14560004
145700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14570004
145800             END-IF                                               14580004
145900                                                                  14590004
146000         WHEN OTHER                                               14600004
146100             SET DP013-NO-ROLLBACK                                14610004
146200                 DP013-XCTL-DISPLAY-RESTART                       14620004
146300                 DP013-CICS-ABEND  TO TRUE                        14630004
146400             MOVE '2100-CHECK-FUNCTION-KEY'                       14640004
146500                                   TO DP013-PARAGRAPH             14650004
146600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14660004
146700                                   TO DP013-MESSAGE-TEXT (1)      14670004
146800             PERFORM DP013-0000-PROCESS-ABEND                     14680004
146900     END-EVALUATE.                                                14690004
147000*                                                                 14700004
147100*----------------------------------------------------------------*14710004
147200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14720004
147300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14730004
147400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14740004
147500*    MESSAGE.                                                    *14750004
147600*----------------------------------------------------------------*14760004
147700                                                                  14770004
147800 2110-BROWSE-BACKWARD.                                            14780004
147900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14790004
148000         GIVING PV-TOP-ITEM.                                      14800004
148100*                                                                 14810004
148200     IF  ((PV-TOP-ITEM < +1)                                      14820004
148300       OR (PV-TOP-ITEM = +1))                                     14830004
148400         MOVE +1                   TO PV-TOP-ITEM                 14840004
148500*        -- TOP OF LIST --                                        14850004
148600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14860004
148700         SET DP020-MSG-INFORMATIONAL TO TRUE                      14870004
148800     END-IF.                                                      14880004
148900                                                                  14890004
149000 EJECT                                                            14900004
149100*----------------------------------------------------------------*14910004
149200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14920004
149300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14930004
149400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14940004
149500*----------------------------------------------------------------*14950004
149600                                                                  14960004
149700 2120-BROWSE-FORWARD.                                             14970004
149800                                                                  14980004
149900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14990004
150000         GIVING PV-TOP-ITEM.                                      15000004
150100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15010004
150200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15020004
150300                                   TO PV-TOP-ITEM                 15030004
150400*        -- BOTTOM OF LIST --                                     15040004
150500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15050004
150600         SET DP020-MSG-INFORMATIONAL                              15060004
150700                                   TO TRUE                        15070004
150800     ELSE                                                         15080004
150900         COMPUTE PV-BOTTOM-ITEM =                                 15090004
151000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15100004
151100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            15110004
151200*            -- BOTTOM OF LIST --                                 15120004
151300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15130004
151400             SET DP020-MSG-INFORMATIONAL                          15140004
151500                                   TO TRUE                        15150004
151600         END-IF                                                   15160004
151700     END-IF.                                                      15170004
151800 EJECT                                                            15180004
151900*----------------------------------------------------------------*15190004
152000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *15200004
152100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *15210004
152200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *15220004
152300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *15230004
152400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *15240004
152500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *15250004
152600*----------------------------------------------------------------*15260004
152700                                                                  15270004
152800 2130-CHECK-FOR-JUMP-BROWSE.                                      15280004
152900     SET PS-NO-ERROR               TO TRUE.                       15290004
153000     IF (ASC-START-ITEM-REQUEST = SPACE)                          15300004
153100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15310004
153200                                   TO PV-TOP-ITEM                 15320004
153300     ELSE                                                         15330004
153400         MOVE ASC-START-ITEM-REQUEST                              15340004
153500                                   TO DP010I-UNEDITED-FIELD       15350004
153600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15360004
153700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15370004
153800         SET DP010I-NEGATIVE-NOT-ALLOWED                          15380004
153900                                   TO TRUE                        15390004
154010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15401008
154020              USING DP010I-NUMERIC-EDIT-AREA                      15402008
154100                                                                  15410004
154200         IF  NOT DP010I-ERROR-DETECTED                            15420004
154300             MOVE DP010I-NUMERIC-FIELD                            15430004
154400                                   TO  ASC-START-ITEM-REQUEST-N   15440004
154500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15450004
154600                 IF  ASC-START-ITEM-REQUEST-N >                   15460004
154700                                          ASC-NUMBER-OF-ITEMS-READ15470004
154800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15480004
154900                     COMPUTE PV-TOP-ITEM =                        15490004
155000                             ASC-NUMBER-OF-ITEMS-READ             15500004
155100                             - PC-ITEMS-PER-PANEL + 1             15510004
155200                     IF  PV-TOP-ITEM < +1                         15520004
155300                         MOVE +1   TO PV-TOP-ITEM                 15530004
155400                         MOVE PC-TSYMSG-00070                     15540004
155500                                   TO DP020-MSG-NUMBER            15550004
155600                         SET DP020-MSG-INFORMATIONAL              15560004
155700                                   TO TRUE                        15570004
155800                     END-IF                                       15580004
155900                 ELSE                                             15590004
156000                     MOVE ASC-START-ITEM-REQUEST-N                15600004
156100                                   TO PV-TOP-ITEM                 15610004
156200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      15620004
156300                     COMPUTE PV-BOTTOM-ITEM =                     15630004
156400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15640004
156500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ15650004
156600*                        -- BOTTOM OF LIST --                     15660004
156700                         MOVE PC-TSYMSG-00070                     15670004
156800                                   TO DP020-MSG-NUMBER            15680004
156900                         SET DP020-MSG-INFORMATIONAL              15690004
157000                                   TO TRUE                        15700004
157100                     END-IF                                       15710004
157200                 END-IF                                           15720004
157300             ELSE                                                 15730004
157400*                --- VALUE OUT OF RANGE ----                      15740004
157500                 MOVE PC-TSYMSG-00101                             15750004
157600                                   TO DP020-MSG-NUMBER            15760004
157700                 MOVE -1           TO ASTRTITL                    15770004
157800                 SET DP030-SET-CURSOR-APPL-1                      15780004
157900                                   TO TRUE                        15790004
158000                 MOVE DP015-REVERSE                               15800004
158100                                   TO ASTRTITH                    15810004
158200                 MOVE DP015-RED    TO ASTRTITC                    15820004
158300                 MOVE DP015-UNP-NUM-BRT-MDT                       15830004
158400                                   TO ASTRTITA                    15840004
158500                 SET DP020-MSG-FATAL                              15850004
158600                                   TO TRUE                        15860004
158700                 SET PS-ERROR      TO TRUE                        15870004
158800             END-IF                                               15880004
158900                                                                  15890004
159000         ELSE                                                     15900004
159100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15910004
159200             MOVE -1               TO ASTRTITL                    15920004
159300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15930004
159400             MOVE DP015-REVERSE    TO ASTRTITH                    15940004
159500             MOVE DP015-RED        TO ASTRTITC                    15950004
159600             MOVE DP015-UNP-NUM-BRT-MDT                           15960004
159700                                   TO ASTRTITA                    15970004
159800             SET DP020-MSG-FATAL   TO TRUE                        15980004
159900             SET PS-ERROR          TO TRUE                        15990004
160000         END-IF                                                   16000004
160100     END-IF.                                                      16010004
160200 EJECT                                                            16020004
160300*----------------------------------------------------------------*16030004
160400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16040004
160500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16050004
160600*----------------------------------------------------------------*16060004
160700 2140-DESELECT-ALL-ITEMS.                                         16070004
160800     MOVE +1                       TO ASC-BLK-SUB.                16080004
160900                                                                  16090004
161000     PERFORM 2141-CLEAR-SELECTED-INDS                             16100004
161100         VARYING ASC-ITEM-SUB                                     16110004
161200         FROM 1 BY 1                                              16120004
161300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16130004
161400                                                                  16140004
161500     ADD +1                        TO ASC-BLK-SUB.                16150004
161600                                                                  16160004
161700     PERFORM 2141-CLEAR-SELECTED-INDS                             16170004
161800         VARYING ASC-ITEM-SUB                                     16180004
161900         FROM 1 BY 1                                              16190004
162000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16200004
162100                                                                  16210004
162200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16220004
162300                                   TO PV-LIST-ITEM-NUMBER.        16230004
162400                                                                  16240004
162500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16250004
162600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16260004
162700                                                                  16270004
162800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16280004
162900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16290004
163000         MOVE +1                   TO ASC-BLK-SUB                 16300004
163100                                                                  16310004
163200         PERFORM 5100-WRITE-TEMP-STORAGE                          16320004
163300                                                                  16330004
163400         MOVE +1                   TO PV-BLOCK-NUMBER             16340004
163500                                                                  16350004
163600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16360004
163700             PV-FIRST-BLOCK-IN-ARRAY - 1                          16370004
163800                                                                  16380004
163900         PERFORM                                                  16390004
164000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16400004
164100                                                                  16410004
164200             PERFORM 4410-READ-TEMP-STORAGE                       16420004
164300                                                                  16430004
164400             PERFORM 2141-CLEAR-SELECTED-INDS                     16440004
164500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16450004
164600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16460004
164700                                                                  16470004
164800             PERFORM 5100-WRITE-TEMP-STORAGE                      16480004
164900                                                                  16490004
165000             ADD +1                TO PV-BLOCK-NUMBER             16500004
165100                                                                  16510004
165200         END-PERFORM                                              16520004
165300                                                                  16530004
165400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16540004
165500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16550004
165600                                                                  16560004
165700         PERFORM                                                  16570004
165800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16580004
165900                   ASC-HIGHEST-BLOCK-WRITTEN                      16590004
166000                                                                  16600004
166100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16610004
166200                                   TO PV-BLOCK-NUMBER             16620004
166300                                                                  16630004
166400             PERFORM 4410-READ-TEMP-STORAGE                       16640004
166500                                                                  16650004
166600             PERFORM 2141-CLEAR-SELECTED-INDS                     16660004
166700                 VARYING ASC-ITEM-SUB                             16670004
166800                 FROM 1 BY 1                                      16680004
166900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16690004
167000                                                                  16700004
167100             PERFORM 5100-WRITE-TEMP-STORAGE                      16710004
167200                                                                  16720004
167300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16730004
167400                                                                  16740004
167500         END-PERFORM                                              16750004
167600                                                                  16760004
167700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16770004
167800                                   TO PV-BLOCK-NUMBER             16780004
167900                                                                  16790004
168000         PERFORM 4410-READ-TEMP-STORAGE                           16800004
168100     END-IF.                                                      16810004
168200                                                                  16820004
168300                                                                  16830004
168400     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 16840004
168500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.16850004
168600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  16860004
168700                                                                  16870004
168800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16880004
168900                                                                  16890004
169000 EJECT                                                            16900004
169100*----------------------------------------------------------------*16910004
169200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16920004
169300*----------------------------------------------------------------*16930004
169400                                                                  16940004
169500 2141-CLEAR-SELECTED-INDS.                                        16950004
169600                                                                  16960004
169700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16970004
169800             NOT EQUAL ZERO                                       16980004
169900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16990004
170000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17000004
170100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17010004
170200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17020004
170300                                   TO TRUE                        17030004
170400         END-IF                                                   17040004
170500     END-IF.                                                      17050004
170600                                                                  17060004
170700 EJECT                                                            17070004
170800*----------------------------------------------------------------*17080004
170900*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17090004
171000*  FOR ALL ITEMS.                                                *17100004
171100*----------------------------------------------------------------*17110004
171200                                                                  17120004
171300 2150-SELECT-ALL-ITEMS.                                           17130004
171400                                                                  17140004
171500     MOVE +1                       TO ASC-BLK-SUB.                17150004
171600                                                                  17160004
171700     PERFORM 2151-SET-SELECTED-INDS                               17170004
171800         VARYING ASC-ITEM-SUB                                     17180004
171900         FROM 1 BY 1                                              17190004
172000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17200004
172100                                                                  17210004
172200     ADD +1                        TO ASC-BLK-SUB.                17220004
172300                                                                  17230004
172400     PERFORM 2151-SET-SELECTED-INDS                               17240004
172500         VARYING ASC-ITEM-SUB                                     17250004
172600         FROM 1 BY 1                                              17260004
172700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17270004
172800                                                                  17280004
172900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17290004
173000                                   TO PV-LIST-ITEM-NUMBER.        17300004
173100                                                                  17310004
173200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17320004
173300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17330004
173400                                                                  17340004
173500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17350004
173600        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17360004
173700         MOVE +1                   TO ASC-BLK-SUB                 17370004
173800                                                                  17380004
173900         PERFORM 5100-WRITE-TEMP-STORAGE                          17390004
174000                                                                  17400004
174100         MOVE +1                   TO PV-BLOCK-NUMBER             17410004
174200                                                                  17420004
174300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17430004
174400             PV-FIRST-BLOCK-IN-ARRAY - 1                          17440004
174500                                                                  17450004
174600         PERFORM                                                  17460004
174700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17470004
174800                                                                  17480004
174900             PERFORM 4410-READ-TEMP-STORAGE                       17490004
175000                                                                  17500004
175100             PERFORM 2151-SET-SELECTED-INDS                       17510004
175200                 VARYING ASC-ITEM-SUB                             17520004
175300                 FROM 1 BY 1                                      17530004
175400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17540004
175500                                                                  17550004
175600             PERFORM 5100-WRITE-TEMP-STORAGE                      17560004
175700                                                                  17570004
175800             ADD +1                TO PV-BLOCK-NUMBER             17580004
175900                                                                  17590004
176000         END-PERFORM                                              17600004
176100                                                                  17610004
176200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17620004
176300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17630004
176400                                                                  17640004
176500         PERFORM                                                  17650004
176600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17660004
176700                   ASC-HIGHEST-BLOCK-WRITTEN                      17670004
176800                                                                  17680004
176900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17690004
177000                                   TO PV-BLOCK-NUMBER             17700004
177100                                                                  17710004
177200             PERFORM 4410-READ-TEMP-STORAGE                       17720004
177300                                                                  17730004
177400             PERFORM 2151-SET-SELECTED-INDS                       17740004
177500                 VARYING ASC-ITEM-SUB                             17750004
177600                 FROM 1 BY 1                                      17760004
177700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17770004
177800                                                                  17780004
177900             PERFORM 5100-WRITE-TEMP-STORAGE                      17790004
178000                                                                  17800004
178100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17810004
178200                                                                  17820004
178300         END-PERFORM                                              17830004
178400                                                                  17840004
178500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17850004
178600                                   TO PV-BLOCK-NUMBER             17860004
178700                                                                  17870004
178800         PERFORM 4410-READ-TEMP-STORAGE                           17880004
178900     END-IF.                                                      17890004
179000                                                                  17900004
179100                                                                  17910004
179200     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             17920004
179300                       ASC-NUMBER-OF-SELECTED-ITEMS.              17930004
179400                                                                  17940004
179500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17950004
179600                                                                  17960004
179700 EJECT                                                            17970004
179800*----------------------------------------------------------------*17980004
179900*    MARK EACH ITEM AS BEING SELECTED.                           *17990004
180000*----------------------------------------------------------------*18000004
180100                                                                  18010004
180200 2151-SET-SELECTED-INDS.                                          18020004
180300                                                                  18030004
180400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18040004
180500             NOT EQUAL ZERO                                       18050004
180600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18060004
180700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18070004
180800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18080004
180900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18090004
181000                               TO  TRUE                           18100004
181100         END-IF                                                   18110004
181200     END-IF.                                                      18120004
181300                                                                  18130004
181400 2160-GET-NEXT-RECORD.                                            18140004
181500                                                                  18150004
181600     ADD +1                       TO ASC-SEL-SUB.                 18160004
181700     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            18170004
181800         ADD +1                   TO ASC-SEL-ITEM                 18180004
181900         MOVE +1                  TO ASC-SEL-SUB                  18190004
182000     END-IF.                                                      18200004
182100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                18210004
182200         PERFORM 9100-READ-SEL-QUEUE                              18220004
182300         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      18230004
182400             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 18240004
182500                                    TO ASC-KEY-OPER-UNT-ID        18250004
182600             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    18260004
182700                                    TO ASC-KEY-FCLTY-ID           18270004
182800             MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)               18280004
182900                                    TO ASC-KEY-ORIGIN-SCAC-ID     18290004
183000                                       ASC-KEY-DELIVERY-SCAC-ID   18300004
183100             MOVE RC013-TRIP-ID (ASC-SEL-SUB)                     18310004
183200                                    TO ASC-KEY-TRIP-ID            18320004
183300             MOVE RC013-PRO-NBR (ASC-SEL-SUB)                     18330004
183400                                    TO ASC-KEY-PRO-NBR            18340004
183500             MOVE RC013-BOL-NBR (ASC-SEL-SUB)                     18350004
183600                                    TO ASC-KEY-BOL-NBR            18360004
183700             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  18370004
183800             PERFORM 9200-REWRITE-SEL-QUEUE                       18380004
183900         ELSE                                                     18390004
184000             SUBTRACT +1 FROM ASC-SEL-SUB                         18400004
184100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             18410004
184200             SET DP020-MSG-INFORMATIONAL TO TRUE                  18420004
184300             SET PS-LIST-END             TO TRUE                  18430004
184400         END-IF                                                   18440004
184500     ELSE                                                         18450004
184600         SUBTRACT +1 FROM ASC-SEL-ITEM                            18460004
184700         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  18470004
184800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             18480004
184900         SET DP020-MSG-INFORMATIONAL TO TRUE                      18490004
185000         SET PS-LIST-END             TO TRUE                      18500004
185100     END-IF.                                                      18510004
185200                                                                  18520004
185300/                                                                 18530004
185400 2170-GET-PREV-RECORD.                                            18540004
185500                                                                  18550004
185600     SUBTRACT +1 FROM ASC-SEL-SUB.                                18560004
185700     IF  ASC-SEL-SUB < +1                                         18570004
185800         SUBTRACT +1 FROM ASC-SEL-ITEM                            18580004
185900         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 18590004
186000     END-IF.                                                      18600004
186100                                                                  18610004
186200     IF  ASC-SEL-ITEM > ZERO                                      18620004
186300         PERFORM 9100-READ-SEL-QUEUE                              18630004
186400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         18640004
186500                    ASC-BLOCK-ENTRIES (2)                         18650004
186600         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     18660004
186700                                    TO ASC-KEY-OPER-UNT-ID        18670004
186800         MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                        18680004
186900                                    TO ASC-KEY-FCLTY-ID           18690004
187000         MOVE RC013-OWNER-SCAC-ID (ASC-SEL-SUB)                   18700004
187100                                    TO ASC-KEY-ORIGIN-SCAC-ID     18710004
187200                                       ASC-KEY-DELIVERY-SCAC-ID   18720004
187300         MOVE RC013-TRIP-ID (ASC-SEL-SUB)                         18730004
187400                                    TO ASC-KEY-TRIP-ID            18740004
187500         MOVE RC013-PRO-NBR (ASC-SEL-SUB)                         18750004
187600                                    TO ASC-KEY-PRO-NBR            18760004
187700         MOVE RC013-BOL-NBR (ASC-SEL-SUB)                         18770004
187800                                    TO ASC-KEY-BOL-NBR            18780004
187900         SET RC013-INQ (ASC-SEL-SUB) TO TRUE                      18790004
188000     ELSE                                                         18800004
188100         MOVE +1                   TO ASC-SEL-ITEM                18810004
188200                                      ASC-SEL-SUB                 18820004
188300*        --- TOP OF LIST ---                                      18830004
188400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18840004
188500         SET DP020-MSG-INFORMATIONAL                              18850004
188600             PS-LIST-END           TO TRUE                        18860004
188700     END-IF.                                                      18870004
188800/                                                                 18880004
188900******************************************************************18890004
189000** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **18900004
189100** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **18910004
189200******************************************************************18920004
189300 2200-MOVE-SCREEN-TO-COMMAREA.                                    18930004
189400                                                                  18940004
189500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18950004
189600     MOVE +1                       TO PV-SUB.                     18960004
189700*                                                                 18970004
189800     PERFORM 3100-SET-SUBSCRIPTS.                                 18980004
189900     IF  ASTRTITL > ZERO                                          18990004
190000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          19000004
190100     ELSE                                                         19010004
190200         IF  ASTRTITF = DP015-ERASE-EOF                           19020004
190300             INITIALIZE ASC-START-ITEM-REQUEST                    19030004
190400         END-IF                                                   19040004
190500     END-IF.                                                      19050004
190600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          19060004
190700         VARYING PV-SUB                                           19070004
190800         FROM 1 BY 1                                              19080004
190900         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19090004
191000******************************************************************19100004
191100** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**19110004
191200******************************************************************19120004
191300 2210-MOVE-LINES-TO-COMMAREA.                                     19130004
191400     IF  MR-SELECTL (PV-SUB) > ZERO                               19140004
191500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19150004
191600         MOVE MR-SELECTI (PV-SUB)                                 19160004
191700                                   TO ASC-TEMP-SELECTED-SW        19170004
191800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19180004
191900     ELSE                                                         19190004
192000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19200004
192100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19210004
192200                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19220004
192300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19230004
192400         END-IF                                                   19240004
192500     END-IF.                                                      19250004
192600     ADD +1                        TO ASC-ITEM-SUB.               19260004
192700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19270004
192800         ADD +1                    TO ASC-BLK-SUB                 19280004
192900         MOVE +1                   TO ASC-ITEM-SUB                19290004
193000     END-IF.                                                      19300004
193100******************************************************************19310004
193200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **19320004
193300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **19330004
193400******************************************************************19340004
193500 3000-EDIT-DATA-IN-COMMAREA.                                      19350004
193600     SET PS-NO-ERROR               TO TRUE.                       19360004
193700     PERFORM 3200-RESET-ATTRIBUTES.                               19370004
193800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     19380004
193900**                                                                19390004
194000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19400004
194100* EDITTING IS DONE FROM THE BOTTOM UP.                            19410004
194200**                                                                19420004
194300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19430004
194400         ASC-ITEMS-DISPLAYED - 1.                                 19440004
194500     PERFORM 3100-SET-SUBSCRIPTS.                                 19450004
194600     PERFORM 3300-EDIT-SELECTIONS                                 19460004
194700         VARYING PV-SUB                                           19470004
194800         FROM PV-SUB BY -1                                        19480004
194900         UNTIL PV-SUB < +1                                        19490004
195000*                                                                 19500004
195100     IF  PS-NO-ERROR                                              19510004
195200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19520004
195300     END-IF.                                                      19530004
195400*                                                                 19540004
195500     IF  ((PS-NO-ERROR)                                           19550004
195600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19560004
195700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    19570004
195800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  19580004
195900     END-IF.                                                      19590004
196000 EJECT                                                            19600004
196100*----------------------------------------------------------------*19610004
196200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *19620004
196300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*19630004
196400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *19640004
196500*                                                                *19650004
196600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *19660004
196700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *19670004
196800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *19680004
196900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *19690004
197000*----------------------------------------------------------------*19700004
197100                                                                  19710004
197200 3100-SET-SUBSCRIPTS.                                             19720004
197300                                                                  19730004
197400     COMPUTE ASC-ITEM-SUB =                                       19740004
197500         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        19750004
197600                                                                  19760004
197700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19770004
197800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19780004
197900                                                                  19790004
198000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               19800004
198100     ELSE                                                         19810004
198200         MOVE +1                     TO ASC-BLK-SUB               19820004
198300     END-IF.                                                      19830004
198400******************************************************************19840004
198500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **19850004
198600******************************************************************19860004
198700                                                                  19870004
198800 3200-RESET-ATTRIBUTES.                                           19880004
198900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19890004
199000     MOVE DP015-GREEN              TO ASTRTITC.                   19900004
199100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19910004
199200*                                                                 19920004
199300     PERFORM                                                      19930004
199400         VARYING PV-SUB                                           19940004
199500         FROM 1 BY 1                                              19950004
199600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19960004
199700         MOVE DP015-UNP-ALP-NOR-OFF                               19970004
199800                                   TO MR-SELECTA (PV-SUB)         19980004
199900         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         19990004
200000         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         20000004
200100     END-PERFORM.                                                 20010004
200200******************************************************************20020004
200300** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **20030004
200400** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **20040004
200500** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **20050004
200600** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **20060004
200700******************************************************************20070004
200800 3300-EDIT-SELECTIONS.                                            20080004
200900     EVALUATE TRUE                                                20090004
201000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20100004
201100             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20110004
201200                 CONTINUE                                         20120004
201300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         20130004
201400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20140004
201500                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   20150004
201600                 MOVE ASC-TEMP-SELECTED-SW                        20160004
201700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20170004
201800                                TO ASC-SELECTED-SW                20180004
201900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20190004
202000             END-IF                                               20200004
202100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20210004
202200                 = SPACE                                          20220004
202300             EVALUATE TRUE                                        20230004
202400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       20240004
202500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20250004
202600                     MOVE SPACE TO ASC-SELECTED-SW                20260004
202700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20270004
202800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        20280004
202900                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    20290004
203000                     MOVE SPACE TO ASC-SELECTED-SW                20300004
203100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20310004
203200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          20320004
203300                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      20330004
203400                     MOVE SPACE TO ASC-SELECTED-SW                20340004
203500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20350004
203600             END-EVALUATE                                         20360004
203700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           20370004
203800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20380004
203900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20390004
204000             END-IF                                               20400004
204100             PERFORM 3310-EDIT-RANGE                              20410004
204200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             20420004
204300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20430004
204400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20440004
204500             END-IF                                               20450004
204600             PERFORM 3310-EDIT-RANGE                              20460004
204700         WHEN OTHER                                               20470004
204800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           20480004
204900             SET DP020-MSG-FATAL    TO TRUE                       20490004
205000             MOVE -1                TO MR-SELECTL (PV-SUB)        20500004
205100             SET DP030-SET-CURSOR-APPL-1                          20510004
205200                                    TO TRUE                       20520004
205300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        20530004
205400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        20540004
205500             SET PS-ERROR TO TRUE                                 20550004
205600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20560004
205700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     20570004
205800                 MOVE SPACE         TO ASC-SELECTED-SW            20580004
205900                                        (ASC-BLK-SUB ASC-ITEM-SUB)20590004
206000             END-IF                                               20600004
206100     END-EVALUATE.                                                20610004
206200                                                                  20620004
206300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 20630004
206400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               20640004
206500     IF  ASC-ITEM-SUB < 1                                         20650004
206600         SUBTRACT +1 FROM ASC-BLK-SUB                             20660004
206700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                20670004
206800     END-IF.                                                      20680004
206900******************************************************************20690004
207000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20700004
207100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20710004
207200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20720004
207300** THE ENDING.                                                  **20730004
207400******************************************************************20740004
207500 3310-EDIT-RANGE.                                                 20750004
207600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20760004
207700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20770004
207800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20780004
207900                                   TO ASC-SELECTED-SW             20790004
208000                                        (ASC-BLK-SUB ASC-ITEM-SUB)20800004
208100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20810004
208200         ELSE                                                     20820004
208300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20830004
208400                 CONTINUE                                         20840004
208500             ELSE                                                 20850004
208600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20860004
208700                 MOVE PC-TSYMSG-00054                             20870004
208800                                   TO DP020-MSG-NUMBER            20880004
208900                 SET DP020-MSG-FATAL                              20890004
209000                                   TO TRUE                        20900004
209100                 MOVE -1           TO MR-SELECTL (PV-SUB)         20910004
209200                 SET DP030-SET-CURSOR-APPL-1                      20920004
209300                                   TO TRUE                        20930004
209400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20940004
209500                 MOVE DP015-UNDERLINE                             20950004
209600                                   TO MR-SELECTH (PV-SUB)         20960004
209700                 SET PS-ERROR      TO TRUE                        20970004
209800             END-IF                                               20980004
209900         END-IF                                                   20990004
210000     ELSE                                                         21000004
210100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21010004
210200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 21020004
210300                                   TO ASC-SELECTED-SW             21030004
210400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21040004
210500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   21050004
210600         ELSE                                                     21060004
210700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       21070004
210800                 CONTINUE                                         21080004
210900             ELSE                                                 21090004
211000*                -- ONLY ONE END-OF-RANGE ALLOWED --              21100004
211100                 MOVE PC-TSYMSG-00055                             21110004
211200                                   TO DP020-MSG-NUMBER            21120004
211300                 SET DP020-MSG-FATAL                              21130004
211400                                   TO TRUE                        21140004
211500                 MOVE -1           TO MR-SELECTL (PV-SUB)         21150004
211600                 SET DP030-SET-CURSOR-APPL-1                      21160004
211700                                   TO TRUE                        21170004
211800                 SET PS-ERROR      TO TRUE                        21180004
211900             END-IF                                               21190004
212000         END-IF                                                   21200004
212100     END-IF.                                                      21210004
212200*                                                                 21220004
212300******************************************************************21230004
212400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **21240004
212500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **21250004
212600******************************************************************21260004
212700 3400-CHECK-RANGE-SEQUENCE.                                       21270004
212800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       21280004
212900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      21290004
213000       AND  ASC-START-OF-SELECTED-RANGE >                         21300004
213100                                         ASC-END-OF-SELECTED-RANGE21310004
213200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                21320004
213300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 21330004
213400         SET DP020-MSG-FATAL TO TRUE                              21340004
213500         SET PS-ERROR TO TRUE                                     21350004
213600         PERFORM 3410-POSITION-AT-ERROR                           21360004
213700     END-IF.                                                      21370004
213800******************************************************************21380004
213900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **21390004
214000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **21400004
214100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **21410004
214200******************************************************************21420004
214300 3410-POSITION-AT-ERROR.                                          21430004
214400     SET DP030-SET-CURSOR-APPL-1                                  21440004
214500                                   TO TRUE.                       21450004
214600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 21460004
214700                    - PV-TOP-ITEM + 1.                            21470004
214800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21480004
214900         CONTINUE                                                 21490004
215000     ELSE                                                         21500004
215100         MOVE -1                   TO MR-SELECTL (PV-SUB)         21510004
215200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21520004
215300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21530004
215400     END-IF.                                                      21540004
215500*                                                                 21550004
215600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   21560004
215700                    - PV-TOP-ITEM + 1.                            21570004
215800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      21580004
215900         CONTINUE                                                 21590004
216000     ELSE                                                         21600004
216100         MOVE -1                   TO MR-SELECTL (PV-SUB)         21610004
216200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21620004
216300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21630004
216400     END-IF.                                                      21640004
216500 EJECT                                                            21650004
216600*----------------------------------------------------------------*21660004
216700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21670004
216800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21680004
216900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21690004
217000*----------------------------------------------------------------*21700004
217100                                                                  21710004
217200 3500-MARK-RANGE-AS-SELECTED.                                     21720004
217300     MOVE +1                       TO  ASC-BLK-SUB.               21730004
217400     PERFORM 3510-MARK-SELECTED-INDS                              21740004
217500         VARYING ASC-ITEM-SUB                                     21750004
217600         FROM 1 BY 1                                              21760004
217700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21770004
217800                                                                  21780004
217900     ADD +1                        TO ASC-BLK-SUB.                21790004
218000     PERFORM 3510-MARK-SELECTED-INDS                              21800004
218100         VARYING ASC-ITEM-SUB                                     21810004
218200         FROM 1 BY 1                                              21820004
218300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21830004
218400                                                                  21840004
218500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21850004
218600                                   TO  PV-LIST-ITEM-NUMBER.       21860004
218700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21870004
218800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21880004
218900               PC-ITEMS-PER-PANEL).                               21890004
219000                                                                  21900004
219100     MOVE ASC-START-OF-SELECTED-RANGE                             21910004
219200                                   TO PV-START-OF-SELECTED-RANGE. 21920004
219300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21930004
219400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21940004
219500               PC-ITEMS-PER-PANEL).                               21950004
219600                                                                  21960004
219700     MOVE ASC-END-OF-SELECTED-RANGE                               21970004
219800                                   TO  PV-END-OF-SELECTED-RANGE.  21980004
219900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21990004
220000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    22000004
220100               PC-ITEMS-PER-PANEL).                               22010004
220200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             22020004
220300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             22030004
220400                                                                  22040004
220500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    22050004
220600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        22060004
220700         MOVE +1                   TO ASC-BLK-SUB                 22070004
220800         PERFORM 5100-WRITE-TEMP-STORAGE                          22080004
220900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22090004
221000             PV-FIRST-BLOCK-IN-ARRAY - 1                          22100004
221100                                                                  22110004
221200         PERFORM                                                  22120004
221300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      22130004
221400                   PV-PREV-BLOCK-IN-ARRAY                         22140004
221500             MOVE PV-FIRST-BLOCK-IN-RANGE                         22150004
221600                                   TO PV-BLOCK-NUMBER             22160004
221700             PERFORM 4410-READ-TEMP-STORAGE                       22170004
221800             PERFORM 3510-MARK-SELECTED-INDS                      22180004
221900                 VARYING ASC-ITEM-SUB                             22190004
222000                 FROM 1 BY 1                                      22200004
222100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22210004
222200             PERFORM 5100-WRITE-TEMP-STORAGE                      22220004
222300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     22230004
222400         END-PERFORM                                              22240004
222500                                                                  22250004
222600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22260004
222700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22270004
222800         PERFORM                                                  22280004
222900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       22290004
223000                   PV-LAST-BLOCK-IN-RANGE                         22300004
223100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22310004
223200                                   TO PV-BLOCK-NUMBER             22320004
223300             PERFORM 4410-READ-TEMP-STORAGE                       22330004
223400             PERFORM 3510-MARK-SELECTED-INDS                      22340004
223500                 VARYING ASC-ITEM-SUB                             22350004
223600                 FROM 1 BY 1                                      22360004
223700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22370004
223800             PERFORM 5100-WRITE-TEMP-STORAGE                      22380004
223900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22390004
224000         END-PERFORM                                              22400004
224100                                                                  22410004
224200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22420004
224300                                   TO PV-BLOCK-NUMBER             22430004
224400         PERFORM 4410-READ-TEMP-STORAGE                           22440004
224500     END-IF.                                                      22450004
224600                                                                  22460004
224700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 22470004
224800                                      ASC-END-OF-SELECTED-RANGE.  22480004
224900                                                                  22490004
225000 EJECT                                                            22500004
225100*----------------------------------------------------------------*22510004
225200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *22520004
225300*----------------------------------------------------------------*22530004
225400                                                                  22540004
225500 3510-MARK-SELECTED-INDS.                                         22550004
225600                                                                  22560004
225700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22570004
225800                                ASC-ITEM-SUB) >                   22580004
225900         ASC-START-OF-SELECTED-RANGE)                             22590004
226000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         22600004
226100                                ASC-ITEM-SUB) =                   22610004
226200         ASC-START-OF-SELECTED-RANGE)                             22620004
226300                                                                  22630004
226400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22640004
226500                                    ASC-ITEM-SUB) <               22650004
226600             ASC-END-OF-SELECTED-RANGE)                           22660004
226700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22670004
226800                                    ASC-ITEM-SUB) =               22680004
226900             ASC-END-OF-SELECTED-RANGE)                           22690004
227000                                                                  22700004
227100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22710004
227200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22720004
227300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22730004
227400                               TO TRUE                            22740004
227500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22750004
227600                               TO TRUE                            22760004
227700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    22770004
227800             END-IF                                               22780004
227900         END-IF                                                   22790004
228000     END-IF.                                                      22800004
228100                                                                  22810004
228200 EJECT                                                            22820004
228300*----------------------------------------------------------------*22830004
228400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22840004
228500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22850004
228600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22860004
228700*    DISPLAY THE PANEL TO USER.                                  *22870004
228800*----------------------------------------------------------------*22880004
228900                                                                  22890004
229000 4000-BUILD-INITIAL-PANEL.                                        22900004
229100                                                                  22910004
229200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            22920004
229300                                 ASC-BLOCK-ENTRIES (2).           22930004
229400     MOVE +1                 TO ASC-BLK-SUB.                      22940004
229500     SET ASC-ITEMS-LEFT-ON-DB                                     22950004
229600                             TO TRUE.                             22960004
229700                                                                  22970004
229800     MOVE +0                 TO ASC-ITEM-SUB                      22980004
229900                                ASC-NUMBER-OF-ITEMS-READ          22990004
230000                                ASC-NUMBER-OF-SELECTED-ITEMS      23000004
230100                                ASC-HIGHEST-BLOCK-WRITTEN         23010004
230200                                ASC-START-OF-SELECTED-RANGE       23020004
230300                                ASC-END-OF-SELECTED-RANGE         23030004
230400                                ASC-ITEM-AT-TOP-OF-PANEL.         23040004
230500     PERFORM 4100-PREPARE-CURSOR                                  23050004
230600                                                                  23060004
230700     PERFORM 4010-OPEN-CURSOR.                                    23070004
230800                                                                  23080004
230900     PERFORM 4300-READ-ITEMS-FROM-DB.                             23090004
231000                                                                  23100004
231100     PERFORM 4020-CLOSE-CURSOR.                                   23110004
231200                                                                  23120004
231300     MOVE +1                   TO  PV-TOP-ITEM.                   23130004
231400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          23140004
231500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    23150004
231600         SET DP020-MSG-FATAL   TO  TRUE                           23160004
231700         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               23170004
231800     ELSE                                                         23180004
231900         MOVE -1               TO MR-SELECTL (1)                  23190004
232000         SET DP030-SET-CURSOR-APPL-1                              23200004
232100                               TO TRUE                            23210004
232200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     23220004
232300     END-IF.                                                      23230004
232400 EJECT                                                            23240004
232500*----------------------------------------------------------------*23250004
232600* OPEN THE TMESSAGE CURSOR.                                      *23260004
232700*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *23270004
232800*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *23280004
232900*   USER.                                                        *23290004
233000*----------------------------------------------------------------*23300004
233100                                                                  23310004
233200 4010-OPEN-CURSOR.                                                23320004
233300     PERFORM                                                      23330004
233400         WITH TEST AFTER                                          23340004
233500         VARYING PV-RETRY-COUNTER                                 23350004
233600         FROM 1 BY 1                                              23360004
233700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23370004
233800                   OR (SQLCODE = ZERO))                           23380004
233900                                                                  23390004
234000             IF ASC-USE-SELECTION-QUEUE                           23400004
234100                 EXEC SQL                                         23410004
234200                      OPEN PO1-CSR                                23420004
234300                 END-EXEC                                         23430004
234400             ELSE                                                 23440004
234500                 IF PS-OR-CURSOR                                  23450004
234600                     EXEC SQL                                     23460004
234700                          OPEN PO-OR-CSR                          23470004
234800                     END-EXEC                                     23480004
234900                 ELSE                                             23490004
235000                     EXEC SQL                                     23500004
235100                          OPEN PO-CSR                             23510004
235200                     END-EXEC                                     23520004
235300                 END-IF                                           23530004
235400             END-IF                                               23540004
235500                                                                  23550004
235600                                                                  23560004
235700         EVALUATE TRUE                                            23570004
235800             WHEN SQLCODE = ZERO                                  23580004
235900             WHEN SQLCODE = -904                                  23590004
236000             WHEN SQLCODE = -913                                  23600004
236100                 CONTINUE                                         23610004
236200             WHEN SQLWARN0 NOT = SPACES                           23620004
236300             WHEN SQLCODE < ZERO                                  23630004
236400             WHEN SQLCODE > ZERO                                  23640004
236500                 MOVE '4010-OPEN-CURSOR'                          23650004
236600                                   TO DP013-PARAGRAPH             23660004
236700                 MOVE 'OPEN SYSTEM MESSAGE CURSOR - '             23670004
236800                                   TO DP013-MESSAGE-TEXT (1)      23680004
236900                 MOVE SQLCA        TO DP013-SQLCA                 23690004
237000                 MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)    23700004
237100                 SET DP013-DB2-ABEND                              23710004
237200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23720004
237300                 PERFORM DP013-0000-PROCESS-ABEND                 23730004
237400         END-EVALUATE                                             23740004
237500     END-PERFORM.                                                 23750004
237600*                                                                 23760004
237700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    23770004
237800         SQLCODE NOT = ZERO                                       23780004
237900         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             23790004
238000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   23800004
238100                                   TO DP013-MESSAGE-TEXT (1)      23810004
238200         MOVE SQLCA                TO DP013-SQLCA                 23820004
238300         MOVE 'TSHIPMT '           TO DP013-DB2-TABLE-NAME (1)    23830004
238400         SET DP013-DB2-ABEND                                      23840004
238500             DP013-XCTL-DISPLAY-RESTART                           23850004
238600                                   TO TRUE                        23860004
238700         PERFORM DP013-0000-PROCESS-ABEND                         23870004
238800     END-IF.                                                      23880004
238900                                                                  23890004
239000 EJECT                                                            23900004
239100*----------------------------------------------------------------*23910004
239200* CLOSE THE TMESSAGE CURSOR.                                     *23920004
239300*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *23930004
239400*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *23940004
239500*   USER.                                                        *23950004
239600*----------------------------------------------------------------*23960004
239700                                                                  23970004
239800 4020-CLOSE-CURSOR.                                               23980004
239900     IF ASC-USE-SELECTION-QUEUE                                   23990004
240000         EXEC SQL                                                 24000004
240100             CLOSE PO1-CSR                                        24010004
240200         END-EXEC                                                 24020004
240300     ELSE                                                         24030004
240400         IF PS-OR-CURSOR                                          24040004
240500             EXEC SQL                                             24050004
240600                  CLOSE PO-OR-CSR                                 24060004
240700             END-EXEC                                             24070004
240800         ELSE                                                     24080004
240900             EXEC SQL                                             24090004
241000                  CLOSE PO-CSR                                    24100004
241100             END-EXEC                                             24110004
241200         END-IF                                                   24120004
241300     END-IF.                                                      24130004
241400                                                                  24140004
241500*                                                                 24150004
241600     EVALUATE TRUE                                                24160004
241700         WHEN SQLCODE = ZERO                                      24170004
241800             CONTINUE                                             24180004
241900         WHEN SQLWARN0 NOT = SPACES                               24190004
242000         WHEN SQLCODE < ZERO                                      24200004
242100         WHEN SQLCODE > ZERO                                      24210004
242200             MOVE '4020-CLOSE-CURSOR'                             24220004
242300                               TO DP013-PARAGRAPH                 24230004
242400             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  24240004
242500                               TO DP013-MESSAGE-TEXT (1)          24250004
242600             MOVE SQLCA        TO DP013-SQLCA                     24260004
242700             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        24270004
242800             SET DP013-DB2-ABEND                                  24280004
242900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24290004
243000             PERFORM DP013-0000-PROCESS-ABEND                     24300004
243100     END-EVALUATE.                                                24310004
243200                                                                  24320004
243300 EJECT                                                            24330004
243400*----------------------------------------------------------------*24340004
243500*    SET UP THE HOST VARIABLES.                                  *24350004
243600*----------------------------------------------------------------*24360004
243700                                                                  24370004
243800 4100-PREPARE-CURSOR.                                             24380004
243900                                                                  24390004
244000     MOVE ASC-KEY-OPER-UNT-ID-N TO DK-OPER-UNT-ID.                24400004
244100     MOVE ASC-KEY-FCLTY-ID-N    TO DK-FCLTY-ID.                   24410004
244200     MOVE ASC-KEY-ORIGIN-SCAC-ID TO DK-ORIGIN-SCAC-ID.            24420004
244300     MOVE ASC-KEY-DELIVERY-SCAC-ID TO DK-DELIVERY-SCAC-ID.        24430004
244400     MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR.                    24440004
244500     IF ASC-KEY-PRO-NBR = SPACE                                   24450004
244600         MOVE SPACES            TO DK-PRO-B                       24460004
244700         MOVE HIGH-VALUES       TO DK-PRO-E                       24470004
244800     ELSE                                                         24480004
244900         MOVE ASC-KEY-PRO-NBR   TO DK-PRO-B                       24490004
245000         MOVE ASC-KEY-PRO-NBR   TO DK-PRO-E                       24500004
245100     END-IF.                                                      24510004
245200     IF ASC-KEY-PO-NBR = ZERO                                     24520004
245300         MOVE ZERO              TO DK-PO-B                        24530004
245400         MOVE PC-9-9            TO DK-PO-E                        24540004
245500     ELSE                                                         24550004
245600         MOVE ASC-KEY-PO-NBR    TO DK-PO-B                        24560004
245700         MOVE ASC-KEY-PO-NBR    TO DK-PO-E                        24570004
245800     END-IF.                                                      24580004
245900     MOVE ASC-KEY-BOL-NBR       TO DK-BOL-NBR.                    24590004
246000     MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR.                    24600004
246100     IF ASC-KEY-PRO-NBR NOT = SPACE AND                           24610004
246200        ASC-KEY-PO-NBR NOT = ZERO                                 24620004
246300         SET PS-OR-CURSOR TO TRUE                                 24630004
246400     ELSE                                                         24640004
246500         SET PS-AND-CURSOR TO TRUE                                24650004
246600     END-IF.                                                      24660004
246700                                                                  24670004
246800 EJECT                                                            24680004
246900*----------------------------------------------------------------*24690004
247000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *24700004
247100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *24710004
247200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *24720004
247300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *24730004
247400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *24740004
247500*                                                                *24750004
247600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *24760004
247700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *24770004
247800*    UPON INITIALIZATION.                                        *24780004
247900*----------------------------------------------------------------*24790004
248000                                                                  24800004
248100 4300-READ-ITEMS-FROM-DB.                                         24810004
248200                                                                  24820004
248300     PERFORM                                                      24830004
248400         VARYING PV-READ-COUNT                                    24840004
248500         FROM 1 BY 1                                              24850004
248600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    24860004
248700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         24870004
248800                                                                  24880004
248900         PERFORM 4310-FETCH                                       24890004
249000                                                                  24900004
249100         IF  ASC-ITEMS-LEFT-ON-DB                                 24910004
249200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                24920004
249300                 ADD +1            TO ASC-ITEM-SUB                24930004
249400             ELSE                                                 24940004
249500                 ADD +1            TO ASC-BLK-SUB                 24950004
249600                 MOVE +1           TO ASC-ITEM-SUB                24960004
249700                                                                  24970004
249800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         24980004
249900                     MOVE +1       TO ASC-BLK-SUB                 24990004
250000                     SET ASC-BLOCK-MODIFIED (1)                   25000004
250100                                   TO TRUE                        25010004
250200                     PERFORM 5100-WRITE-TEMP-STORAGE              25020004
250300                     MOVE ASC-BLOCK-ENTRIES                       25030004
250400                               (PC-MAX-BLOCKS-IN-ARRAY)           25040004
250500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 25050004
250600                     ADD +1        TO ASC-BLK-SUB                 25060004
250700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   25070004
250800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      25080004
250900                                   TO TRUE                        25090004
251000                 END-IF                                           25100004
251100             END-IF                                               25110004
251200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    25120004
251300             MOVE ASC-NUMBER-OF-ITEMS-READ                        25130004
251400                                   TO ASC-LIST-ITEM-NUMBER        25140004
251500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25150004
251600             MOVE SHIPMT-SHIPT-ID  TO ASC-SHIPT-ID                25160004
251700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25170004
251800                                      DK-SHIPT-ID                 25180004
251900             MOVE SHIPMT-TRIP-ID   TO ASC-TRIP-ID                 25190004
252000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25200004
252100             PERFORM 4350-SELECT-TSHIPST                          25210004
252200             MOVE PV-PO-CSR-IND    TO ASC-CSR-IND                 25220004
252300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25230004
252400             MOVE SHIPST-SHIPT-STATUS-CDE                         25240004
252500                                   TO ASC-STATUS                  25250004
252600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25260004
252700             MOVE SHIPMT-EXPTED-PKG-QTY                           25270004
252800                                   TO ASC-EXP-CTN-CNT             25280004
252900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25290004
253000             MOVE SHIPMT-VEND-CART-CT                             25300004
253100                                   TO ASC-VEND-CTN-CNT            25310004
253200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25320004
253300             MOVE SHPTPO-REC-SEQ-NBR                              25330004
253400                                   TO ASC-RECEIVER                25340004
253500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25350004
253600             MOVE SHPTPO-PO-NBR    TO ASC-PO                      25360004
253700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25370004
253800             IF SHPTPO-ACTL-CART-CNT > 0                          25380004
253900                 MOVE SHPTPO-ACTL-CART-CNT                        25390004
254000                                   TO ASC-ADJ-CART-CNT            25400004
254100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25410004
254200             ELSE                                                 25420004
254300                 IF SHPTPO-EXPTED-CART-CNT > 0                    25430004
254400                     MOVE SHPTPO-EXPTED-CART-CNT                  25440004
254500                                   TO ASC-ADJ-CART-CNT            25450004
254600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25460004
254700                 ELSE                                             25470004
254800                     IF SHPTPO-CARR-CART-CT > 0                   25480004
254900                         MOVE SHPTPO-CARR-CART-CT                 25490004
255000                                   TO ASC-ADJ-CART-CNT            25500004
255100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25510004
255200                     ELSE                                         25520004
255300                         MOVE SHPTPO-VEND-CART-CT                 25530004
255400                                   TO ASC-ADJ-CART-CNT            25540004
255500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25550004
255600                     END-IF                                       25560004
255700                 END-IF                                           25570004
255800             END-IF                                               25580004
255900             MOVE SHPTPO-VEND-CART-CT                             25590004
256000                                   TO ASC-ASN-CART-CNT            25600004
256100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25610004
256200             MOVE SHIPMT-PRO-NBR   TO ASC-FREIGHT-BILL            25620004
256300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25630004
256400             MOVE SHIPMT-BOL-NBR   TO ASC-BILL-OF-LADING          25640004
256500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25650004
256600             MOVE SHPTPO-VEND-NAME TO ASC-VENDOR                  25660004
256700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25670004
256800             MOVE SHIPMT-ORIG-SCAC-ID                             25680004
256900                                   TO ASC-ORIGIN-SCAC             25690004
257000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25700004
257100         END-IF                                                   25710004
257200     END-PERFORM.                                                 25720004
257300                                                                  25730004
257400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          25740004
257500         MOVE +1               TO ASC-BLK-SUB                     25750004
257600         PERFORM 5100-WRITE-TEMP-STORAGE                          25760004
257700         ADD +1                TO ASC-BLK-SUB                     25770004
257800         PERFORM 5100-WRITE-TEMP-STORAGE                          25780004
257900                                                                  25790004
258000         MOVE 1                TO ASC-BLK-SUB                     25800004
258100                                  PV-BLOCK-NUMBER                 25810004
258200         PERFORM 4410-READ-TEMP-STORAGE                           25820004
258300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             25830004
258400             MOVE 2            TO ASC-BLK-SUB                     25840004
258500                                  PV-BLOCK-NUMBER                 25850004
258600             PERFORM 4410-READ-TEMP-STORAGE                       25860004
258700         END-IF                                                   25870004
258800     END-IF.                                                      25880004
258900 EJECT                                                            25890004
259000*----------------------------------------------------------------*25900004
259100*    FETCH THE MESSAGE CURSOR.                                   *25910004
259200*----------------------------------------------------------------*25920004
259300                                                                  25930004
259400 4310-FETCH.                                                      25940004
259500                                                                  25950004
259600     IF ASC-USE-SELECTION-QUEUE                                   25960004
259700         EXEC SQL                                                 25970004
259800              FETCH PO1-CSR                                       25980004
259900              INTO  :PV-PO-CSR-IND                                25990004
260000                  , :SHIPMT-TRIP-ID                               26000004
260100                  , :SHIPMT-SHIPT-ID                              26010004
260200                  , :SHIPMT-PRO-NBR                               26020004
260300                  , :SHIPMT-BOL-NBR                               26030004
260400                  , :SHIPMT-EXPTED-PKG-QTY                        26040004
260500                  , :SHIPMT-VEND-CART-CT                          26050004
260600                  , :SHPTPO-PO-NBR                                26060004
260700                  , :SHPTPO-REC-SEQ-NBR                           26070004
260800                  , :SHPTPO-EXPTED-CART-CNT                       26080004
260900                  , :SHPTPO-ACTL-CART-CNT                         26090004
261000                  , :SHPTPO-CARR-CART-CT                          26100004
261100                  , :SHPTPO-VEND-CART-CT                          26110004
261200                  , :SHPTPO-VEND-NAME                             26120004
261300                  , :SHIPMT-ORIG-SCAC-ID                          26130004
261400                  , :VHTRIP-VEH-NBR                               26140004
261500                         :PV-NULL-TRIP-VEH-IND                    26150004
261600                  , :TRIPST-TRIP-STATUS-CDE                       26160004
261700         END-EXEC                                                 26170004
261800     ELSE                                                         26180004
261900         IF PS-OR-CURSOR                                          26190004
262000             EXEC SQL                                             26200004
262100                  FETCH PO-OR-CSR                                 26210004
262200                  INTO  :PV-PO-CSR-IND                            26220004
262300                      , :SHIPMT-TRIP-ID                           26230004
262400                      , :SHIPMT-SHIPT-ID                          26240004
262500                      , :SHIPMT-PRO-NBR                           26250004
262600                      , :SHIPMT-BOL-NBR                           26260004
262700                      , :SHIPMT-EXPTED-PKG-QTY                    26270004
262800                      , :SHIPMT-VEND-CART-CT                      26280004
262900                      , :SHPTPO-PO-NBR                            26290004
263000                      , :SHPTPO-REC-SEQ-NBR                       26300004
263100                      , :SHPTPO-EXPTED-CART-CNT                   26310004
263200                      , :SHPTPO-ACTL-CART-CNT                     26320004
263300                      , :SHPTPO-CARR-CART-CT                      26330004
263400                      , :SHPTPO-VEND-CART-CT                      26340004
263500                      , :SHPTPO-VEND-NAME                         26350004
263600                      , :SHIPMT-ORIG-SCAC-ID                      26360004
263700             END-EXEC                                             26370004
263800         ELSE                                                     26380004
263900             EXEC SQL                                             26390004
264000                  FETCH PO-CSR                                    26400004
264100                  INTO  :PV-PO-CSR-IND                            26410004
264200                      , :SHIPMT-TRIP-ID                           26420004
264300                      , :SHIPMT-SHIPT-ID                          26430004
264400                      , :SHIPMT-PRO-NBR                           26440004
264500                      , :SHIPMT-BOL-NBR                           26450004
264600                      , :SHIPMT-EXPTED-PKG-QTY                    26460004
264700                      , :SHIPMT-VEND-CART-CT                      26470004
264800                      , :SHPTPO-PO-NBR                            26480004
264900                      , :SHPTPO-REC-SEQ-NBR                       26490004
265000                      , :SHPTPO-EXPTED-CART-CNT                   26500004
265100                      , :SHPTPO-ACTL-CART-CNT                     26510004
265200                      , :SHPTPO-CARR-CART-CT                      26520004
265300                      , :SHPTPO-VEND-CART-CT                      26530004
265400                      , :SHPTPO-VEND-NAME                         26540004
265500                      , :SHIPMT-ORIG-SCAC-ID                      26550004
265600             END-EXEC                                             26560004
265700     END-IF.                                                      26570004
265800                                                                  26580004
265900                                                                  26590004
266000     EVALUATE TRUE                                                26600004
266100         WHEN SQLCODE = ZERO                                      26610004
266200         WHEN SQLCODE = +100                                      26620004
266300              CONTINUE                                            26630004
266400         WHEN SQLWARN0 NOT = SPACE                                26640004
266500         WHEN SQLCODE NOT = ZERO                                  26650004
266600              MOVE '4310-FETCH-CURSOR'                            26660004
266700                               TO DP013-PARAGRAPH                 26670004
266800              MOVE 'FETCH MESSAGE CURSOR'                         26680004
266900                               TO DP013-MESSAGE-TEXT (1)          26690004
267000              MOVE SQLCA       TO DP013-SQLCA                     26700004
267100              SET DP013-DB2-ABEND                                 26710004
267200                               TO TRUE                            26720004
267300              PERFORM DP013-0000-PROCESS-ABEND                    26730004
267400     END-EVALUATE.                                                26740004
267500                                                                  26750004
267600     IF  SQLCODE EQUAL +100                                       26760004
267700         SET ASC-NO-ITEMS-LEFT-ON-DB                              26770004
267800                                   TO TRUE                        26780004
267900     ELSE                                                         26790004
268000         IF ASC-USE-SELECTION-QUEUE                               26800004
268100             IF PV-NULL-TRIP-VEH-IND = -1                         26810004
268200                 MOVE SPACES            TO ASC-KEY-VEH-NBR        26820004
268300             ELSE                                                 26830004
268400                 MOVE VHTRIP-VEH-NBR    TO ASC-KEY-VEH-NBR        26840004
268500             END-IF                                               26850004
268600             MOVE TRIPST-TRIP-STATUS-CDE                          26860004
268700                                    TO ASC-KEY-STATUS             26870004
268800         END-IF                                                   26880004
268900     END-IF.                                                      26890004
269000                                                                  26900004
269100*----------------------------------------------------------------*26910004
269200*  SELECT LATEST SHIPMENT STATUS ROW                             *26920004
269300*----------------------------------------------------------------*26930004
269400 4350-SELECT-TSHIPST.                                             26940004
269500                                                                  26950004
269600     PERFORM                                                      26960004
269700         WITH TEST AFTER                                          26970004
269800         VARYING PV-RETRY-COUNTER                                 26980004
269900         FROM 1 BY 1                                              26990004
270000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27000004
270100             OR (SQLCODE = +0))                                   27010004
270200                                                                  27020004
270300         EXEC SQL                                                 27030004
270400             SELECT  A.SHIPT_ID                                   27040004
270500                    ,A.SHIPT_STATUS_CDE                           27050004
270600                    ,A.STATUS_DTE                                 27060004
270700                    ,A.STATUS_TME                                 27070004
270800                    ,A.STATUS_UID                                 27080004
270900                    ,A.DELAY_RSN_CDE                              27090004
271000             INTO    :SHIPST-SHIPT-ID                             27100004
271100                    ,:SHIPST-SHIPT-STATUS-CDE                     27110004
271200                    ,:SHIPST-STATUS-DTE                           27120004
271300                    ,:SHIPST-STATUS-TME                           27130004
271400                    ,:SHIPST-STATUS-UID                           27140004
271500                    ,:SHIPST-DELAY-RSN-CDE                        27150004
271600           FROM   TSHIPST A                                       27160004
271700                 ,TSHSTYP B                                       27170004
271800           WHERE  A.SHIPT_ID = :DK-SHIPT-ID                       27180004
271900             AND  B.PRTY_CDE =                                    27190004
272000                  (SELECT MAX(D.PRTY_CDE)                         27200004
272100                     FROM TSHIPST C                               27210004
272200                         ,TSHSTYP D                               27220004
272300                    WHERE C.SHIPT_ID         = A.SHIPT_ID         27230004
272400                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)27240004
272500             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         27250004
272600         END-EXEC                                                 27260004
272700                                                                  27270004
272800         EVALUATE TRUE                                            27280004
272900             WHEN SQLCODE = +0                                    27290004
273000             WHEN SQLCODE = -904                                  27300004
273100             WHEN SQLCODE = -913                                  27310004
273200                 CONTINUE                                         27320004
273300                                                                  27330004
273400             WHEN SQLWARN0 NOT = SPACES                           27340004
273500             WHEN SQLCODE < +0                                    27350004
273600             WHEN SQLCODE > +0                                    27360004
273700                 MOVE '4350-SELECT-TSHIPST'                       27370004
273800                                   TO DP013-PARAGRAPH             27380004
273900                 MOVE 'SELECT A TSHIPST ROW   '                   27390004
274000                                   TO DP013-MESSAGE-TEXT(1)       27400004
274100                 MOVE SQLCA        TO DP013-SQLCA                 27410004
274200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    27420004
274300                 SET DP013-DB2-ABEND                              27430004
274400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27440004
274500                 PERFORM DP013-0000-PROCESS-ABEND                 27450004
274600         END-EVALUATE                                             27460004
274700     END-PERFORM.                                                 27470004
274800                                                                  27480004
274900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27490004
275000         SQLCODE NOT = ZERO                                       27500004
275100         MOVE '4350-SELECT-TSHIPST'                               27510004
275200                                   TO DP013-PARAGRAPH             27520004
275300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              27530004
275400                                   TO DP013-MESSAGE-TEXT (1)      27540004
275500         MOVE 'TO SELECT A TSHIPST ROW'                           27550004
275600                                   TO DP013-MESSAGE-TEXT (2)      27560004
275700         MOVE SQLCA                TO DP013-SQLCA                 27570004
275800         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    27580004
275900         SET DP013-DB2-ABEND                                      27590004
276000             DP013-XCTL-DISPLAY-RESTART                           27600004
276100                                   TO TRUE                        27610004
276200         PERFORM DP013-0000-PROCESS-ABEND                         27620004
276300     END-IF.                                                      27630004
276400                                                                  27640004
276500/                                                                 27650004
276600 EJECT                                                            27660004
276700*----------------------------------------------------------------*27670004
276800* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *27680004
276900*----------------------------------------------------------------*27690004
277000                                                                  27700004
277100 4400-MOVE-COMMAREA-TO-SCREEN.                                    27710004
277200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             27720004
277300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          27730004
277400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          27740004
277500             MOVE +1    TO ASC-BLK-SUB                            27750004
277600             PERFORM 5100-WRITE-TEMP-STORAGE                      27760004
277700             ADD +1     TO ASC-BLK-SUB                            27770004
277800             PERFORM 5100-WRITE-TEMP-STORAGE                      27780004
277900             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             27790004
278000                 GIVING PV-BLOCK-NUMBER                           27800004
278100                 REMAINDER PV-REMAINDER                           27810004
278200             IF  PV-REMAINDER > ZERO                              27820004
278300                 ADD +1 TO PV-BLOCK-NUMBER                        27830004
278400             END-IF                                               27840004
278500             MOVE +1    TO ASC-BLK-SUB                            27850004
278600             PERFORM 4410-READ-TEMP-STORAGE                       27860004
278700             ADD +1     TO ASC-BLK-SUB                            27870004
278800                           PV-BLOCK-NUMBER                        27880004
278900             PERFORM 4410-READ-TEMP-STORAGE                       27890004
279000     END-IF.                                                      27900004
279100     MOVE +1            TO ASC-BLK-SUB.                           27910004
279200     COMPUTE ASC-ITEM-SUB =                                       27920004
279300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              27930004
279400         + PC-ITEMS-PER-PANEL).                                   27940004
279500*                                                                 27950004
279600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        27960004
279700         ADD +1         TO ASC-BLK-SUB                            27970004
279800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27980004
279900     END-IF.                                                      27990004
280000*                                                                 28000004
280100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           28010004
280200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                28020004
280300     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        28030004
280400     PERFORM 4420-FORMAT-LIST-LINES                               28040004
280500         VARYING PV-SUB                                           28050004
280600         FROM PC-ITEMS-PER-PANEL BY -1                            28060004
280700         UNTIL PV-SUB < +1.                                       28070004
280800*                                                                 28080004
280900     COMPUTE ASC-ITEMS-DISPLAYED =                                28090004
281000         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          28100004
281100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    28110004
281200                                      ASTRTITO.                   28120004
281300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    28130004
281400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    28140004
281500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            28150004
281600                                   TO ASELITO.                    28160004
281700     MOVE ASC-KEY-OPER-UNT-ID      TO AOPRUNTO.                   28170004
281800     MOVE ASC-KEY-FCLTY-ID         TO AFCLTYO.                    28180004
281900     MOVE ASC-KEY-DELIVERY-SCAC-ID TO ADELSCAO.                   28190004
282000     MOVE ASC-KEY-VEH-NBR          TO ATRALERO.                   28200004
282100     MOVE ASC-KEY-STATUS           TO ASTATUSO.                   28210004
282200*                                                                 28220004
282300     IF  DP020-MSG-NUMBER-X = SPACE                               28230004
282400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  28240004
282500*            --- MORE ITEMS TO DISPLAY ----                       28250004
282600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            28260004
282700             SET DP020-MSG-INFORMATIONAL TO TRUE                  28270004
282800         END-IF                                                   28280004
282900     END-IF.                                                      28290004
283000*----------------------------------------------------------------*28300004
283100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *28310004
283200*----------------------------------------------------------------*28320004
283300                                                                  28330004
283400 4410-READ-TEMP-STORAGE.                                          28340004
283500                                                                  28350004
283600     EXEC CICS                                                    28360004
283700         READQ TS                                                 28370004
283800             QUEUE (ASC-LIST-QUEUE-NAME)                          28380004
283900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28390004
284000             ITEM  (PV-BLOCK-NUMBER)                              28400004
284100             RESP  (PV-CICS-RESP)                                 28410004
284200     END-EXEC.                                                    28420004
284300                                                                  28430004
284400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       28440004
284500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     28450004
284600         CONTINUE                                                 28460004
284700     ELSE                                                         28470004
284800         SET DP013-CICS-ABEND     TO TRUE                         28480004
284900         SET DP013-NO-ROLLBACK    TO TRUE                         28490004
285000         MOVE '4410-READ-TEMP-STORAGE'                            28500004
285100                                  TO DP013-PARAGRAPH              28510004
285200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      28520004
285300                                  TO DP013-MESSAGE-TEXT(1)        28530004
285400         PERFORM DP013-0000-PROCESS-ABEND                         28540004
285500     END-IF.                                                      28550004
285600                                                                  28560004
285700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28570004
285800*                                                                 28580004
285900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         28590004
286000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               28600004
286100     END-IF.                                                      28610004
286200 EJECT                                                            28620004
286300*----------------------------------------------------------------*28630004
286400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *28640004
286500*----------------------------------------------------------------*28650004
286600                                                                  28660004
286700 4420-FORMAT-LIST-LINES.                                          28670004
286800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      28680004
286900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                28690004
287000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           28700004
287100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           28710004
287200         MOVE SPACE              TO MR-SELECTI (PV-SUB)           28720004
287300                                    MR-STATUS (PV-SUB)            28730004
287400                                    MR-RECEIVER-X (PV-SUB)        28740004
287500                                    MR-PO-NBR-X (PV-SUB)          28750004
287600                                    MR-FREIGHT-BILL (PV-SUB)      28760004
287700                                    MR-BILL-OF-LADING (PV-SUB)    28770004
287800                                    MR-ADJ-CART-CNT-X (PV-SUB)    28780004
287900                                    MR-ASN-CART-CNT-X (PV-SUB)    28790004
288000                                    MR-VENDOR (PV-SUB)            28800004
288100                                    MR-ORIGIN-SCAC (PV-SUB)       28810004
288200     ELSE                                                         28820004
288300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      28830004
288400                                                   > SPACE        28840004
288500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 28850004
288600                                 TO MR-SELECTI (PV-SUB)           28860004
288700         ELSE                                                     28870004
288800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      28880004
288900                                 TO MR-SELECTI (PV-SUB)           28890004
289000         END-IF                                                   28900004
289100*                                                                 28910004
289200         IF  DP030-SET-CURSOR-TRAILER                             28920004
289300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)28930004
289400                 > SPACE)                                         28940004
289500               OR (PV-SUB = 1))                                   28950004
289600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               28960004
289700                MOVE -1          TO MR-SELECTL (PV-SUB)           28970004
289800             END-IF                                               28980004
289900         END-IF                                                   28990004
290000*                                                                 29000004
290100         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           29010004
290200             IF ASC-CSR-IND (ASC-BLK-SUB ASC-ITEM-SUB) = 'B'      29020004
290300                 MOVE DP015-YELLOW TO MR-STATUSC (PV-SUB)         29030004
290400                                      MR-RECEIVERC (PV-SUB)       29040004
290500                                      MR-PO-NBRC (PV-SUB)         29050004
290600                                      MR-FREIGHT-BILLC (PV-SUB)   29060004
290700                                      MR-BILL-OF-LADINGC (PV-SUB) 29070004
290800                                      MR-ADJ-CART-CNTC (PV-SUB)   29080004
290900                                      MR-ASN-CART-CNTC (PV-SUB)   29090004
291000                                      MR-VENDORC (PV-SUB)         29100004
291100                                      MR-ORIGIN-SCACC (PV-SUB)    29110004
291200             ELSE                                                 29120004
291300                 MOVE DP015-GREEN  TO MR-STATUSC (PV-SUB)         29130004
291400                                      MR-RECEIVERC (PV-SUB)       29140004
291500                                      MR-PO-NBRC (PV-SUB)         29150004
291600                                      MR-FREIGHT-BILLC (PV-SUB)   29160004
291700                                      MR-BILL-OF-LADINGC (PV-SUB) 29170004
291800                                      MR-ADJ-CART-CNTC (PV-SUB)   29180004
291900                                      MR-ASN-CART-CNTC (PV-SUB)   29190004
292000                                      MR-VENDORC (PV-SUB)         29200004
292100                                      MR-ORIGIN-SCACC (PV-SUB)    29210004
292200             END-IF                                               29220004
292300             MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           29230004
292400                                 TO MR-STATUS (PV-SUB)            29240004
292500             MOVE ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB)         29250004
292600                                 TO MR-RECEIVER (PV-SUB)          29260004
292700             MOVE ASC-PO       (ASC-BLK-SUB ASC-ITEM-SUB)         29270004
292800                                 TO MR-PO-NBR (PV-SUB)            29280004
292900             MOVE ASC-FREIGHT-BILL (ASC-BLK-SUB ASC-ITEM-SUB)     29290004
293000                                 TO MR-FREIGHT-BILL (PV-SUB)      29300004
293100             MOVE ASC-BILL-OF-LADING (ASC-BLK-SUB ASC-ITEM-SUB)   29310004
293200                                 TO MR-BILL-OF-LADING (PV-SUB)    29320004
293300             MOVE ASC-ADJ-CART-CNT (ASC-BLK-SUB ASC-ITEM-SUB)     29330004
293400                                 TO MR-ADJ-CART-CNT (PV-SUB)      29340004
293500             MOVE ASC-ASN-CART-CNT (ASC-BLK-SUB ASC-ITEM-SUB)     29350004
293600                                 TO MR-ASN-CART-CNT (PV-SUB)      29360004
293700             MOVE ASC-VENDOR (ASC-BLK-SUB ASC-ITEM-SUB)           29370004
293800                                 TO MR-VENDOR (PV-SUB)            29380004
293900             MOVE ASC-ORIGIN-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)      29390004
294000                                 TO MR-ORIGIN-SCAC (PV-SUB)       29400004
294100         END-IF                                                   29410004
294200     END-IF.                                                      29420004
294300     SUBTRACT +1 FROM ASC-ITEM-SUB                                29430004
294400     IF  ASC-ITEM-SUB < + 1                                       29440004
294500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  29450004
294600         MOVE +1                 TO ASC-BLK-SUB                   29460004
294700     END-IF.                                                      29470004
294800******************************************************************29480004
294900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **29490004
295000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **29500004
295100** ISSUE A WARNING.                                             **29510004
295200******************************************************************29520004
295300 4430-CHECK-FOR-BEGIN-AND-END.                                    29530004
295400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       29540004
295500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     29550004
295600*            -- NO END-OF-RANGE SPECFIED ---                      29560004
295700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            29570004
295800             SET DP020-MSG-WARNING TO TRUE                        29580004
295900             PERFORM 4431-POSITION-AT-WARNING                     29590004
296000         END-IF                                                   29600004
296100     ELSE                                                         29610004
296200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     29620004
296300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                29630004
296400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            29640004
296500             SET DP020-MSG-WARNING TO TRUE                        29650004
296600             PERFORM 4431-POSITION-AT-WARNING                     29660004
296700         END-IF                                                   29670004
296800     END-IF.                                                      29680004
296900******************************************************************29690004
297000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **29700004
297100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **29710004
297200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **29720004
297300** POSITION THE CURSOR THERE.                                   **29730004
297400******************************************************************29740004
297500 4431-POSITION-AT-WARNING.                                        29750004
297600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 29760004
297700                    - PV-TOP-ITEM + 1.                            29770004
297800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29780004
297900         CONTINUE                                                 29790004
298000     ELSE                                                         29800004
298100         SET DP030-SET-CURSOR-APPL-1                              29810004
298200                                   TO TRUE                        29820004
298300         MOVE -1                   TO MR-SELECTL (PV-SUB)         29830004
298400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29840004
298500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29850004
298600     END-IF.                                                      29860004
298700*                                                                 29870004
298800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   29880004
298900                    - PV-TOP-ITEM + 1.                            29890004
299000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29900004
299100         CONTINUE                                                 29910004
299200     ELSE                                                         29920004
299300         SET DP030-SET-CURSOR-APPL-1                              29930004
299400                                   TO TRUE                        29940004
299500         MOVE -1                   TO MR-SELECTL (PV-SUB)         29950004
299600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29960004
299700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29970004
299800     END-IF.                                                      29980004
299900 EJECT                                                            29990004
300000*----------------------------------------------------------------*30000004
300100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *30010004
300200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *30020004
300300* FOR THE SELECTED ITEMS QUEUE.                                  *30030004
300400*                                                                *30040004
300500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *30050004
300600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *30060004
300700* THE ARRAY IS FULL.                                             *30070004
300800*----------------------------------------------------------------*30080004
300900                                                                  30090004
301000 5000-PREPARE-SEL-QUEUE.                                          30100004
301100                                                                  30110004
301200     MOVE +1                   TO  ASC-BLK-SUB.                   30120004
301300     PERFORM 5100-WRITE-TEMP-STORAGE.                             30130004
301400     ADD +1                    TO  ASC-BLK-SUB.                   30140004
301500     PERFORM 5100-WRITE-TEMP-STORAGE.                             30150004
301600                                                                  30160004
301700     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          30170004
301800     PERFORM 6010-DELETE-SEL-QUEUE.                               30180004
301900                                                                  30190004
302000     SET ASC-UPDATE-TSQ        TO  TRUE.                          30200004
302100                                                                  30210004
302200     SET RC013-IDX             TO  1.                             30220004
302300     MOVE ZERO                 TO RC015-NUMBER-OF-TS-ITEMS.       30230004
302400     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        30240004
302500                                                                  30250004
302600     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           30260004
302700             VARYING PV-ITEM                                      30270004
302800             FROM 1 BY 1                                          30280004
302900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     30290004
303000                                                                  30300004
303100     IF  RC013-IDX > 1                                            30310004
303200         PERFORM 5205-WRITE-SEL-QUEUE                             30320004
303300         ADD +1                TO RC015-NUMBER-OF-TS-ITEMS        30330004
303400     END-IF.                                                      30340004
303500 EJECT                                                            30350004
303600*----------------------------------------------------------------*30360004
303700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *30370004
303800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *30380004
303900*----------------------------------------------------------------*30390004
304000                                                                  30400004
304100 5100-WRITE-TEMP-STORAGE.                                         30410004
304200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     30420004
304300                                   TO PV-LIST-ITEM-NUMBER.        30430004
304400     COMPUTE PV-BLOCK-NUMBER =                                    30440004
304500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    30450004
304600                                                                  30460004
304700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             30470004
304800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             30480004
304900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      30490004
305000             PERFORM 5105-REWRITE-ASC-LISTQ                       30500004
305100         END-IF                                                   30510004
305200     ELSE                                                         30520004
305300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       30530004
305400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            30540004
305500         PERFORM 5110-WRITE-ASC-LISTQ                             30550004
305600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   30560004
305700     END-IF.                                                      30570004
305800                                                                  30580004
305900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             30590004
306000******************************************************************30600004
306100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **30610004
306200** SPECIFIC COMMAREA.                                           **30620004
306300******************************************************************30630004
306400 5105-REWRITE-ASC-LISTQ.                                          30640004
306500     EXEC CICS                                                    30650004
306600         WRITEQ TS                                                30660004
306700             QUEUE (ASC-LIST-QUEUE-NAME)                          30670004
306800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30680004
306900             ITEM  (PV-BLOCK-NUMBER)                              30690004
307000             REWRITE                                              30700004
307100             RESP  (PV-CICS-RESP)                                 30710004
307200     END-EXEC.                                                    30720004
307300                                                                  30730004
307400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           30740004
307500         CONTINUE                                                 30750004
307600     ELSE                                                         30760004
307700         SET DP013-CICS-ABEND            TO TRUE                  30770004
307800         SET DP013-NO-ROLLBACK           TO TRUE                  30780004
307900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       30790004
308000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     30800004
308100                                         TO DP013-MESSAGE-TEXT(1) 30810004
308200         PERFORM DP013-0000-PROCESS-ABEND                         30820004
308300     END-IF.                                                      30830004
308400                                                                  30840004
308500******************************************************************30850004
308600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **30860004
308700** SPECIFIC COMMAREA.                                           **30870004
308800******************************************************************30880004
308900 5110-WRITE-ASC-LISTQ.                                            30890004
309000     EXEC CICS                                                    30900004
309100         WRITEQ TS                                                30910004
309200             QUEUE (ASC-LIST-QUEUE-NAME)                          30920004
309300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30930004
309400             ITEM  (PV-BLOCK-NUMBER)                              30940004
309500             RESP  (PV-CICS-RESP)                                 30950004
309600     END-EXEC.                                                    30960004
309700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      30970004
309800         SET DP013-CICS-ABEND      TO TRUE                        30980004
309900         SET DP013-NO-ROLLBACK     TO TRUE                        30990004
310000         MOVE '5110-WRITE-ASC-LISTQ'                              31000004
310100                                   TO DP013-PARAGRAPH             31010004
310200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           31020004
310300                                   TO DP013-MESSAGE-TEXT(1)       31030004
310400         PERFORM DP013-0000-PROCESS-ABEND                         31040004
310500     END-IF.                                                      31050004
310600 EJECT                                                            31060004
310700*----------------------------------------------------------------*31070004
310800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *31080004
310900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *31090004
311000*----------------------------------------------------------------*31100004
311100                                                                  31110004
311200 5200-FILL-SEL-QUEUE-RECORD.                                      31120004
311300                                                                  31130004
311400     PERFORM 6112-READ-LIST-QUEUE.                                31140004
311500                                                                  31150004
311600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       31160004
311700         PERFORM                                                  31170004
311800         VARYING LQW-IDX                                          31180004
311900         FROM 1 BY 1                                              31190004
312000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            31200004
312100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          31210004
312200                                                                  31220004
312300             IF  LQW-SELECT (LQW-IDX)                             31230004
312400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              31240004
312500                                   TO RC013-ITEM (RC013-IDX)      31250004
312600                 MOVE LQW-SHIPT-ID       (LQW-IDX)                31260004
312700                                   TO RC013-SHIPT-ID              31270004
312800                                        (RC013-IDX)               31280004
312900                                      DK-SHIPT-ID                 31290004
313000                 MOVE LQW-TRIP-ID (LQW-IDX) TO                    31300004
313100                                      PV-SAVE-TRIP-ID             31310004
313200                 IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) AND    31320004
313300                    LQW-CSR-IND (LQW-IDX) = 'B' AND               31330004
313400                    ASC-KEY-TRIP-ID > 0                           31340004
313500                     ADD 1 TO PV-NUMBER-OF-UPDATES                31350004
313600                     IF LQW-EXP-CTN-CNT  (LQW-IDX) > 0            31360004
313700                         MOVE LQW-EXP-CTN-CNT  (LQW-IDX)          31370004
313800                             TO SHIPMT-EXPTED-PKG-QTY             31380004
313900                     ELSE                                         31390004
314000                         MOVE LQW-VEND-CTN-CNT (LQW-IDX)          31400004
314100                             TO SHIPMT-EXPTED-PKG-QTY             31410004
314200                     END-IF                                       31420004
314300                     PERFORM 5300-ASSIGN-SHIPMENT-TO-TRIP         31430004
314400                 END-IF                                           31440004
314500                 IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) AND    31450004
314600                    LQW-RECEIVER (LQW-IDX) = ZERO                 31460004
314700                     ADD 1 TO PV-NUMBER-OF-UPDATES                31470004
314800                     MOVE LQW-PO (LQW-IDX)   TO SHPTPO-PO-NBR     31480004
314900                     PERFORM 5250-SELECT-TSHPTPO                  31490004
315000                     IF SHPTPO-EXPTED-CART-CNT > 0                31500004
315100                         CONTINUE                                 31510004
315200                     ELSE                                         31520004
315300                         IF SHPTPO-CARR-CART-CT > 0               31530004
315400                             MOVE SHPTPO-CARR-CART-CT             31540004
315500                                   TO SHPTPO-EXPTED-CART-CNT      31550004
315600                         ELSE                                     31560004
315700                             IF SHPTPO-VEND-CART-CT > 0           31570004
315800                                 MOVE SHPTPO-VEND-CART-CT         31580004
315900                                       TO SHPTPO-EXPTED-CART-CNT  31590004
316000                             END-IF                               31600004
316100                         END-IF                                   31610004
316200                     END-IF                                       31620004
316300                                                                  31630004
316400                     EXEC SQL                                     31640004
316500                       SELECT                                     31650004
316600                           VEND_SHIP_DTE                          31660004
316700                       INTO                                       31670004
316800                           :SHIPMT-VEND-SHIP-DTE                  31680004
316900                       FROM TSHIPMT                               31690004
317000                       WHERE SHIPT_ID = :DK-SHIPT-ID              31700004
317100                     END-EXEC                                     31710004
317200                                                                  31720004
317300                     IF SHIPMT-VEND-SHIP-DTE = '9999-09-09' OR    31730004
317400                        SHIPMT-VEND-SHIP-DTE = '0001-01-01'       31740004
317500                        SET PS-ERROR   TO TRUE                    31750004
317600                        SET DP030-OVERRIDE-GO                     31760004
317700                                       TO TRUE                    31770004
317800                        MOVE PC-TSYMSG-02285                      31780004
317900                                       TO DP020-MSG-NUMBER        31790004
318000                        SET DP020-MSG-WARNING                     31800004
318100                                       TO TRUE                    31810004
318200                     ELSE                                         31820004
318300                       MOVE PV-SAVE-TRIP-ID    TO DK-TRIP-ID      31830004
318400                       PERFORM 5900-ADD-RECEIVER                  31840004
318500                       IF PS-NO-ERROR                             31850004
318600                         MOVE PV-REC-SEQ-NBR TO SHPTPO-REC-SEQ-NBR31860004
318700                         PERFORM 5490-UPDATE-SHPTPO               31870004
318800                       END-IF                                     31880004
318900                     END-IF                                       31890004
319000                 ELSE                                             31900004
319100                     PERFORM 5270-SELECT-TSHIPMT                  31910004
319200                     MOVE SHIPMT-PRO-NBR                          31920004
319300                                   TO RC013-PRO-NBR               31930004
319400                                        (RC013-IDX)               31940004
319500                     MOVE SHIPMT-BOL-NBR                          31950004
319600                                   TO RC013-BOL-NBR               31960004
319700                                        (RC013-IDX)               31970004
319800                     MOVE LQW-PO (LQW-IDX)                        31980004
319900                                   TO RC013-PO-NBR                31990004
320000                                        (RC013-IDX)               32000004
320100                                      RC015-PO-NBR                32010004
320200                     MOVE ASC-KEY-DELIVERY-SCAC-ID                32020004
320300                                   TO RC013-OWNER-SCAC-ID         32030004
320400                                        (RC013-IDX)               32040004
320500                     MOVE ASC-KEY-VEH-NBR                         32050004
320600                                   TO RC013-VEH-NBR               32060004
320700                                        (RC013-IDX)               32070004
320800                     MOVE ASC-KEY-STATUS                          32080004
320900                                   TO RC013-PKSL-STAT-CDE         32090004
321000                                        (RC013-IDX)               32100004
321100                     MOVE ASC-KEY-OPER-UNT-ID-N                   32110004
321200                                   TO RC013-OPER-UNT-ID           32120004
321300                                        (RC013-IDX)               32130004
321400                     MOVE ASC-KEY-FCLTY-ID-N                      32140004
321500                                   TO RC013-FCLTY-ID              32150004
321600                                        (RC013-IDX)               32160004
321700                     MOVE LQW-RECEIVER (LQW-IDX)                  32170004
321800                                   TO RC013-REC-SEQ-NBR           32180004
321900                                        (RC013-IDX)               32190004
322000                                      RC015-REC-SEQ-NBR           32200004
322100                 END-IF                                           32210004
322200                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 32220004
322300                 SET RC013-IDX UP BY 1                            32230004
322400                 IF  RC013-IDX > RC013-MAX-ITEMS                  32240004
322500                     PERFORM 5205-WRITE-SEL-QUEUE                 32250004
322600                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    32260004
322700                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         32270004
322800                     SET RC013-IDX TO  1                          32280004
322900                 END-IF                                           32290004
323000             END-IF                                               32300004
323100         END-PERFORM                                              32310004
323200     END-IF.                                                      32320004
323300                                                                  32330004
323400*----------------------------------------------------------------*32340004
323500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *32350004
323600*----------------------------------------------------------------*32360004
323700                                                                  32370004
323800 5205-WRITE-SEL-QUEUE.                                            32380004
323900                                                                  32390004
324000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32400004
324100                                   TO RC013-SELECTED-ITEMS.       32410004
324200                                                                  32420004
324300     EXEC CICS                                                    32430004
324400          WRITEQ TS                                               32440004
324500              QUEUE (ASC-SEL-QUEUE-NAME)                          32450004
324600              FROM  (RC013-DC-SELECT-RECORD)                      32460004
324700              ITEM  (PV-SEL-QUEUE-ITEM)                           32470004
324800              RESP  (PV-CICS-RESP)                                32480004
324900     END-EXEC.                                                    32490004
325000                                                                  32500004
325100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32510004
325200         CONTINUE                                                 32520004
325300     ELSE                                                         32530004
325400         SET DP013-CICS-ABEND      TO TRUE                        32540004
325500         SET DP013-NO-ROLLBACK     TO TRUE                        32550004
325600         MOVE '5205-WRITE-SEL-QUEUE'                              32560004
325700                                   TO DP013-PARAGRAPH             32570004
325800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          32580004
325900                                   TO DP013-MESSAGE-TEXT(1)       32590004
326000         PERFORM DP013-0000-PROCESS-ABEND                         32600004
326100     END-IF.                                                      32610004
326200/                                                                 32620004
326300*----------------------------------------------------------------*32630004
326400* SELECT A VEHICLE                                               *32640004
326500*----------------------------------------------------------------*32650004
326600 5250-SELECT-TSHPTPO.                                             32660004
326700                                                                  32670004
326800     PERFORM                                                      32680004
326900         WITH TEST AFTER                                          32690004
327000         VARYING PV-RETRY-COUNTER                                 32700004
327100         FROM 1 BY 1                                              32710004
327200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32720004
327300            OR (SQLCODE = +0)                                     32730004
327400            OR (SQLCODE = +100))                                  32740004
327500                                                                  32750004
327600         EXEC SQL                                                 32760004
327700          SELECT PO_NBR                                           32770004
327800               , REC_SEQ_NBR                                      32780004
327900               , EXPTED_CART_CNT                                  32790004
328000               , ACTL_CART_CNT                                    32800004
328100               , CARR_CART_CT                                     32810004
328200               , VEND_CART_CT                                     32820004
328300            INTO  :SHPTPO-PO-NBR                                  32830004
328400               ,  :SHPTPO-REC-SEQ-NBR                             32840004
328500               ,  :SHPTPO-EXPTED-CART-CNT                         32850004
328600               ,  :SHPTPO-ACTL-CART-CNT                           32860004
328700               ,  :SHPTPO-CARR-CART-CT                            32870004
328800               ,  :SHPTPO-VEND-CART-CT                            32880004
328900            FROM TSHPTPO                                          32890004
329000           WHERE SHIPT_ID = :DK-SHIPT-ID                          32900004
329100             AND PO_NBR   = :SHPTPO-PO-NBR                        32910004
329200         END-EXEC                                                 32920004
329300                                                                  32930004
329400         EVALUATE TRUE                                            32940004
329500             WHEN SQLCODE = +0                                    32950004
329600             WHEN SQLCODE = +100                                  32960004
329700             WHEN SQLCODE = -904                                  32970004
329800             WHEN SQLCODE = -913                                  32980004
329900                 CONTINUE                                         32990004
330000                                                                  33000004
330100             WHEN SQLWARN0 NOT = SPACES                           33010004
330200             WHEN SQLCODE < ZERO                                  33020004
330300             WHEN SQLCODE > ZERO                                  33030004
330400                 MOVE '5250-SELECT-TSHPTPO'                       33040004
330500                                   TO DP013-PARAGRAPH             33050004
330600                 MOVE 'SELECT ON TSHPTPO'                         33060004
330700                                   TO DP013-MESSAGE-TEXT (1)      33070004
330800                 MOVE SQLCA        TO DP013-SQLCA                 33080004
330900                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    33090004
331000                 SET DP013-DB2-ABEND                              33100004
331100                     DP013-XCTL-DISPLAY-RESTART                   33110004
331200                                   TO TRUE                        33120004
331300                 PERFORM DP013-0000-PROCESS-ABEND                 33130004
331400         END-EVALUATE                                             33140004
331500     END-PERFORM.                                                 33150004
331600                                                                  33160004
331700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    33170004
331800         SQLCODE NOT = ZERO                                       33180004
331900         MOVE '5250-SELECT-TSHPTPO'                               33190004
332000                                   TO DP013-PARAGRAPH             33200004
332100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     33210004
332200                                   TO DP013-MESSAGE-TEXT (1)      33220004
332300         MOVE 'A TSHPTPO ROW   '   TO DP013-MESSAGE-TEXT (2)      33230004
332400         MOVE SQLCA                TO DP013-SQLCA                 33240004
332500         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (1)    33250004
332600         SET DP013-DB2-ABEND                                      33260004
332700             DP013-XCTL-DISPLAY-RESTART                           33270004
332800                                   TO TRUE                        33280004
332900         PERFORM DP013-0000-PROCESS-ABEND                         33290004
333000     END-IF.                                                      33300004
333100                                                                  33310004
333200 5270-SELECT-TSHIPMT.                                             33320004
333300                                                                  33330004
333400     INITIALIZE DCLTAUSHIP.                                       33340004
333500                                                                  33350004
333600     PERFORM                                                      33360004
333700         WITH TEST AFTER                                          33370004
333800         VARYING PV-RETRY-COUNTER                                 33380004
333900         FROM 1 BY 1                                              33390004
334000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33400004
334100             OR (SQLCODE = +0))                                   33410004
334200                                                                  33420004
334300         EXEC SQL                                                 33430004
334400             SELECT  PRO_NBR                                      33440004
334500                    ,BOL_NBR                                      33450004
334600            INTO     :SHIPMT-PRO-NBR                              33460004
334700                    ,:SHIPMT-BOL-NBR                              33470004
334800           FROM   TSHIPMT                                         33480004
334900           WHERE  SHIPT_ID = :DK-SHIPT-ID                         33490004
335000         END-EXEC                                                 33500004
335100                                                                  33510004
335200         EVALUATE TRUE                                            33520004
335300             WHEN SQLCODE = +0                                    33530004
335400             WHEN SQLCODE = -904                                  33540004
335500             WHEN SQLCODE = -913                                  33550004
335600                 CONTINUE                                         33560004
335700                                                                  33570004
335800             WHEN SQLWARN0 NOT = SPACES                           33580004
335900             WHEN SQLCODE < +0                                    33590004
336000             WHEN SQLCODE > +0                                    33600004
336100                 MOVE '5270-SELECT-TSHIPMT'                       33610004
336200                                   TO DP013-PARAGRAPH             33620004
336300                 MOVE 'SELECT A TSHIPMT ROW   '                   33630004
336400                                   TO DP013-MESSAGE-TEXT(1)       33640004
336500                 MOVE SQLCA        TO DP013-SQLCA                 33650004
336600                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    33660004
336700                 SET DP013-DB2-ABEND                              33670004
336800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33680004
336900                 PERFORM DP013-0000-PROCESS-ABEND                 33690004
337000         END-EVALUATE                                             33700004
337100     END-PERFORM.                                                 33710004
337200                                                                  33720004
337300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    33730004
337400         SQLCODE NOT = ZERO                                       33740004
337500         MOVE '5270-SELECT-TSHIPMT '                              33750004
337600                                   TO DP013-PARAGRAPH             33760004
337700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              33770004
337800                                   TO DP013-MESSAGE-TEXT (1)      33780004
337900         MOVE 'TO SELECT A TSHIPMT ROW'                           33790004
338000                                   TO DP013-MESSAGE-TEXT (2)      33800004
338100         MOVE SQLCA                TO DP013-SQLCA                 33810004
338200         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    33820004
338300         SET DP013-DB2-ABEND                                      33830004
338400             DP013-XCTL-DISPLAY-RESTART                           33840004
338500                                   TO TRUE                        33850004
338600         PERFORM DP013-0000-PROCESS-ABEND                         33860004
338700     END-IF.                                                      33870004
338800                                                                  33880004
338900******************************************************************33890004
339000** THIS PARAGRAPH WILL ASSIGN THE SELECTED OPEN SHIPMENTS TO    **33900004
339100** A SPECIFIC TRIP.                                             **33910004
339200******************************************************************33920004
339300 5300-ASSIGN-SHIPMENT-TO-TRIP.                                    33930004
339400                                                                  33940004
339500     PERFORM                                                      33950004
339600         WITH TEST AFTER                                          33960004
339700         VARYING PV-RETRY-COUNTER                                 33970004
339800         FROM 1 BY 1                                              33980004
339900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33990004
340000             OR (SQLCODE = +0))                                   34000004
340100                                                                  34010004
340200         EXEC SQL                                                 34020004
340300           UPDATE TSHIPMT                                         34030004
340400              SET LAST_UPD_DTE     = CURRENT DATE,                34040004
340500                  LAST_UPD_TME     = CURRENT TIME,                34050004
340600                  LAST_UPD_UID     = :DP020-USERID,               34060004
340700                  EXPTED_PKG_QTY   = :SHIPMT-EXPTED-PKG-QTY,      34070004
340800                  LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME,    34080004
340900                  TRIP_ID          = :ASC-KEY-TRIP-ID             34090004
341000                                       :PV-NULL-TRIP-ID-IND,      34100004
341100                  PRO_SCAC_ID      = :ASC-KEY-DELIVERY-SCAC-ID    34110004
341200           WHERE  SHIPT_ID = :DK-SHIPT-ID                         34120004
341300         END-EXEC                                                 34130004
341400                                                                  34140004
341500         EVALUATE TRUE                                            34150004
341600             WHEN SQLCODE = +0                                    34160004
341700             WHEN SQLCODE = -904                                  34170004
341800             WHEN SQLCODE = -913                                  34180004
341900                 CONTINUE                                         34190004
342000                                                                  34200004
342100             WHEN SQLWARN0 NOT = SPACES                           34210004
342200             WHEN SQLCODE < +0                                    34220004
342300             WHEN SQLCODE > +0                                    34230004
342400                 MOVE '5300-ASSIGN-SHIPMENT-TO-TRIP'              34240004
342500                                   TO DP013-PARAGRAPH             34250004
342600                 MOVE 'UPDATE INFO ON TSHIPMT     '               34260004
342700                                   TO DP013-MESSAGE-TEXT(1)       34270004
342800                 MOVE SQLCA        TO DP013-SQLCA                 34280004
342900                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    34290004
343000                 SET DP013-DB2-ABEND                              34300004
343100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           34310004
343200                 PERFORM DP013-0000-PROCESS-ABEND                 34320004
343300         END-EVALUATE                                             34330004
343400     END-PERFORM.                                                 34340004
343500                                                                  34350004
343600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34360004
343700         SQLCODE NOT = ZERO                                       34370004
343800         MOVE '5300-ASSIGN-SHIPMENT-TO-TRIP'                      34380004
343900                                   TO DP013-PARAGRAPH             34390004
344000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              34400004
344100                                   TO DP013-MESSAGE-TEXT (1)      34410004
344200         MOVE 'TO UPDATE A TSHIPMT ROW'                           34420004
344300                                   TO DP013-MESSAGE-TEXT (2)      34430004
344400         MOVE SQLCA                TO DP013-SQLCA                 34440004
344500         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    34450004
344600         SET DP013-DB2-ABEND                                      34460004
344700             DP013-XCTL-DISPLAY-RESTART                           34470004
344800                                   TO TRUE                        34480004
344900         PERFORM DP013-0000-PROCESS-ABEND                         34490004
345000     END-IF.                                                      34500004
345100                                                                  34510004
345200     PERFORM 5350-INSERT-TSHIPST.                                 34520004
345300     PERFORM 5370-AUDIT-TSHIPMT.                                  34530004
345400     PERFORM 5400-COUNT-REMAINING-SHIPMENTS.                      34540004
345500     PERFORM 5450-UPDATE-SHPTPO-RECS.                             34550004
345600                                                                  34560004
345700/                                                                 34570004
345800*----------------------------------------------------------------*34580004
345900*  INSERT A SHIPMENT STATUS ROW                                  *34590004
346000*----------------------------------------------------------------*34600004
346100 5350-INSERT-TSHIPST.                                             34610004
346200     MOVE DK-SHIPT-ID TO SHIPST-SHIPT-ID.                         34620004
346300     MOVE VEHICL-CURR-STATUS-CDE TO SHIPST-SHIPT-STATUS-CDE.      34630004
346400                                                                  34640004
346500     PERFORM                                                      34650004
346600         WITH TEST AFTER                                          34660004
346700         VARYING PV-RETRY-COUNTER                                 34670004
346800         FROM 1 BY 1                                              34680004
346900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34690004
347000             OR (SQLCODE = +0)                                    34700004
347100             OR (SQLCODE = -803))                                 34710004
347200                                                                  34720004
347300         EXEC SQL                                                 34730004
347400             INSERT  INTO TSHIPST                                 34740004
347500                    (SHIPT_ID                                     34750004
347600                    ,SHIPT_STATUS_CDE                             34760004
347700                    ,STATUS_DTE                                   34770004
347800                    ,STATUS_TME                                   34780004
347900                    ,STATUS_UID)                                  34790004
348000            VALUES  (:SHIPST-SHIPT-ID                             34800004
348100                    ,:SHIPST-SHIPT-STATUS-CDE                     34810004
348200                    ,CURRENT DATE                                 34820004
348300                    ,CURRENT TIME                                 34830004
348400                    ,:DP020-USERID)                               34840004
348500         END-EXEC                                                 34850004
348600                                                                  34860004
348700         EVALUATE TRUE                                            34870004
348800             WHEN SQLCODE = +0                                    34880004
348900             WHEN SQLCODE = -803                                  34890004
349000             WHEN SQLCODE = -904                                  34900004
349100             WHEN SQLCODE = -913                                  34910004
349200                 CONTINUE                                         34920004
349300                                                                  34930004
349400             WHEN SQLWARN0 NOT = SPACES                           34940004
349500             WHEN SQLCODE < +0                                    34950004
349600             WHEN SQLCODE > +0                                    34960004
349700                 MOVE '5350-INSERT-TSHIPST'                       34970004
349800                                   TO DP013-PARAGRAPH             34980004
349900                 MOVE 'INSERT A ROW ON TSHIPST'                   34990004
350000                                   TO DP013-MESSAGE-TEXT(1)       35000004
350100                 MOVE SQLCA        TO DP013-SQLCA                 35010004
350200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    35020004
350300                 SET DP013-DB2-ABEND                              35030004
350400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35040004
350500                 PERFORM DP013-0000-PROCESS-ABEND                 35050004
350600         END-EVALUATE                                             35060004
350700     END-PERFORM.                                                 35070004
350800                                                                  35080004
350900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    35090004
351000         SQLCODE NOT = ZERO                                       35100004
351100         MOVE '5350-INSERT-TSHIPST'                               35110004
351200                                   TO DP013-PARAGRAPH             35120004
351300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              35130004
351400                                   TO DP013-MESSAGE-TEXT (1)      35140004
351500         MOVE 'TO INSERT A TSHIPST ROW'                           35150004
351600                                   TO DP013-MESSAGE-TEXT (2)      35160004
351700         MOVE SQLCA                TO DP013-SQLCA                 35170004
351800         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    35180004
351900         SET DP013-DB2-ABEND                                      35190004
352000             DP013-XCTL-DISPLAY-RESTART                           35200004
352100                                   TO TRUE                        35210004
352200         PERFORM DP013-0000-PROCESS-ABEND                         35220004
352300     END-IF.                                                      35230004
352400                                                                  35240004
352500                                                                  35250004
352600*----------------------------------------------------------------*35260004
352700*  TAKE A SNAPSHOT OF THE AFTER IMAGE OF TSHIPMT AND WRITE       *35270004
352800*  TO THE AUDIT TABLE.                                           *35280004
352900*----------------------------------------------------------------*35290004
353000 5370-AUDIT-TSHIPMT.                                              35300004
353100                                                                  35310004
353200     INITIALIZE DCLTAUSHIP.                                       35320004
353300                                                                  35330004
353400     PERFORM                                                      35340004
353500         WITH TEST AFTER                                          35350004
353600         VARYING PV-RETRY-COUNTER                                 35360004
353700         FROM 1 BY 1                                              35370004
353800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35380004
353900             OR (SQLCODE = +0))                                   35390004
354000                                                                  35400004
354100* CLT 12-02-2011 WR40574 ADDED CARR-AUTH-ID BELOW                 35410005
354200         EXEC SQL                                                 35420005
354300             SELECT  TRIP_ID                                      35430004
354400                    ,SHIPT_ID                                     35440004
354500                    ,CRT_SRC_CDE                                  35450004
354600                    ,LAST_UPD_DTE                                 35460004
354700                    ,LAST_UPD_TME                                 35470004
354800                    ,LAST_UPD_UID                                 35480004
354900                    ,PRO_SCAC_ID                                  35490004
355000                    ,PRO_NBR                                      35500004
355100                    ,BOL_NBR                                      35510004
355200                    ,SHIPPER_NME                                  35520004
355300                    ,SHIPT_TYP_CDE                                35530004
355400                    ,EXPTED_GRO_WGHT                              35540004
355500                    ,PKG_TYP_CDE                                  35550004
355600                    ,EXPTED_PKG_QTY                               35560004
355700                    ,FRGT_CHG_AMT                                 35570004
355800                    ,FRGT_TERMS_CDE                               35580004
355900                    ,EXPTED_PLT_QTY                               35590004
356000                    ,VEND_SHIP_DTE                                35600004
356100                    ,EST_AR_TMST                                  35610004
356200                    ,ORIG_SCAC_ID                                 35620004
356300                    ,LAST_UPD_PGM_ID                              35630004
356400                    ,CRE_USER_ID                                  35640004
356500                    ,CARR_CART_CT                                 35650004
356600                    ,CARR_LAST_UPD_DTE                            35660004
356700                    ,CARR_LAST_UPD_TIME                           35670004
356800                    ,VEND_CART_CT                                 35680004
356900                    ,VEND_LAST_UPD_DTE                            35690004
357000                    ,VEND_LAST_UPD_TIME                           35700004
357100                    ,VEH_NBR                                      35710004
357200                    ,AUTH_NBR                                     35720004
357300                    ,AUTH_DTE                                     35730004
357400                    ,CONFIRM_DTE                                  35740004
357500                    ,CONFIRM_TIME                                 35750004
357600                    ,COMPLETE_PRO_NBR                             35760004
357700                    ,COMPLETE_BOL_NBR                             35770004
357800                    ,PROCESSED_DTE                                35780004
357900                    ,INVC_NBR                                     35790004
358000                    ,CARR_AUTH_ID                                 35800006
358100            INTO     :SHIPMT-TRIP-ID                              35810004
358200                       :PV-NULL-TRIP-ID-IND                       35820004
358300                    ,:SHIPMT-SHIPT-ID                             35830004
358400                    ,:SHIPMT-CRT-SRC-CDE                          35840004
358500                    ,:SHIPMT-LAST-UPD-DTE                         35850004
358600                    ,:SHIPMT-LAST-UPD-TME                         35860004
358700                    ,:SHIPMT-LAST-UPD-UID                         35870004
358800                    ,:SHIPMT-PRO-SCAC-ID                          35880004
358900                    ,:SHIPMT-PRO-NBR                              35890004
359000                    ,:SHIPMT-BOL-NBR                              35900004
359100                    ,:SHIPMT-SHIPPER-NME                          35910004
359200                    ,:SHIPMT-SHIPT-TYP-CDE                        35920004
359300                    ,:SHIPMT-EXPTED-GRO-WGHT                      35930004
359400                    ,:SHIPMT-PKG-TYP-CDE                          35940004
359500                    ,:SHIPMT-EXPTED-PKG-QTY                       35950004
359600                    ,:SHIPMT-FRGT-CHG-AMT                         35960004
359700                    ,:SHIPMT-FRGT-TERMS-CDE                       35970004
359800                    ,:SHIPMT-EXPTED-PLT-QTY                       35980004
359900                    ,:SHIPMT-VEND-SHIP-DTE                        35990004
360000                    ,:SHIPMT-EST-AR-TMST                          36000004
360100                       :PV-NULL-EST-AR-TMST                       36010004
360200                    ,:SHIPMT-ORIG-SCAC-ID                         36020004
360300                    ,:SHIPMT-LAST-UPD-PGM-ID                      36030004
360400                    ,:SHIPMT-CRE-USER-ID                          36040004
360500                    ,:SHIPMT-CARR-CART-CT                         36050004
360600                    ,:SHIPMT-CARR-LAST-UPD-DTE                    36060004
360700                    ,:SHIPMT-CARR-LAST-UPD-TIME                   36070004
360800                    ,:SHIPMT-VEND-CART-CT                         36080004
360900                    ,:SHIPMT-VEND-LAST-UPD-DTE                    36090004
361000                    ,:SHIPMT-VEND-LAST-UPD-TIME                   36100004
361100                    ,:SHIPMT-VEH-NBR                              36110004
361200                    ,:SHIPMT-AUTH-NBR                             36120004
361300                    ,:SHIPMT-AUTH-DTE                             36130004
361400                    ,:SHIPMT-CONFIRM-DTE                          36140004
361500                    ,:SHIPMT-CONFIRM-TIME                         36150004
361600                    ,:SHIPMT-COMPLETE-PRO-NBR                     36160004
361700                    ,:SHIPMT-COMPLETE-BOL-NBR                     36170004
361800                    ,:SHIPMT-PROCESSED-DTE                        36180004
361900                    ,:SHIPMT-INVC-NBR                             36190004
362000                    ,:SHIPMT-CARR-AUTH-ID                         36200005
362100           FROM   TSHIPMT                                         36210004
362200           WHERE  SHIPT_ID = :DK-SHIPT-ID                         36220004
362300         END-EXEC                                                 36230004
362400                                                                  36240004
362500         EVALUATE TRUE                                            36250004
362600             WHEN SQLCODE = +0                                    36260004
362700             WHEN SQLCODE = -904                                  36270004
362800             WHEN SQLCODE = -913                                  36280004
362900                 CONTINUE                                         36290004
363000                                                                  36300004
363100             WHEN SQLWARN0 NOT = SPACES                           36310004
363200             WHEN SQLCODE < +0                                    36320004
363300             WHEN SQLCODE > +0                                    36330004
363400                 MOVE '5370-AUDIT-TSHIPMT'                        36340004
363500                                   TO DP013-PARAGRAPH             36350004
363600                 MOVE 'SELECT A TSHIPMT ROW   '                   36360004
363700                                   TO DP013-MESSAGE-TEXT(1)       36370004
363800                 MOVE SQLCA        TO DP013-SQLCA                 36380004
363900                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    36390004
364000                 SET DP013-DB2-ABEND                              36400004
364100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36410004
364200                 PERFORM DP013-0000-PROCESS-ABEND                 36420004
364300         END-EVALUATE                                             36430004
364400     END-PERFORM.                                                 36440004
364500                                                                  36450004
364600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    36460004
364700         SQLCODE NOT = ZERO                                       36470004
364800         MOVE '5370-AUDIT-TSHIPMT '                               36480004
364900                                   TO DP013-PARAGRAPH             36490004
365000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              36500004
365100                                   TO DP013-MESSAGE-TEXT (1)      36510004
365200         MOVE 'TO SELECT A TSHIPMT ROW'                           36520004
365300                                   TO DP013-MESSAGE-TEXT (2)      36530004
365400         MOVE SQLCA                TO DP013-SQLCA                 36540004
365500         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    36550004
365600         SET DP013-DB2-ABEND                                      36560004
365700             DP013-XCTL-DISPLAY-RESTART                           36570004
365800                                   TO TRUE                        36580004
365900         PERFORM DP013-0000-PROCESS-ABEND                         36590004
366000     END-IF.                                                      36600004
366100                                                                  36610004
366200* CLT 12-02-2011 WR40574 ADDED CARR-AUTH-ID BELOW                 36620005
366300     PERFORM                                                      36630004
366400         WITH TEST AFTER                                          36640004
366500         VARYING PV-RETRY-COUNTER                                 36650004
366600         FROM 1 BY 1                                              36660004
366700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36670004
366800             OR (SQLCODE = +0))                                   36680004
366900                                                                  36690004
367000         EXEC SQL                                                 36700004
367100             INSERT  INTO TAUSHIP                                 36710004
367200                    (TRIP_ID                                      36720004
367300                    ,SHIPT_ID                                     36730004
367400                    ,CRT_SRC_CDE                                  36740004
367500                    ,LAST_UPD_DTE                                 36750004
367600                    ,LAST_UPD_TME                                 36760004
367700                    ,LAST_UPD_UID                                 36770004
367800                    ,PRO_SCAC_ID                                  36780004
367900                    ,PRO_NBR                                      36790004
368000                    ,BOL_NBR                                      36800004
368100                    ,SHIPPER_NME                                  36810004
368200                    ,SHIPT_TYP_CDE                                36820004
368300                    ,EXPTED_GRO_WGHT                              36830004
368400                    ,PKG_TYP_CDE                                  36840004
368500                    ,EXPTED_PKG_QTY                               36850004
368600                    ,FRGT_CHG_AMT                                 36860004
368700                    ,FRGT_TERMS_CDE                               36870004
368800                    ,EST_AR_TMST                                  36880004
368900                    ,VEND_SHIP_DTE                                36890004
369000                    ,EXPTED_PLT_QTY                               36900004
369100                    ,ORIG_SCAC_ID                                 36910004
369200                    ,LAST_UPD_PGM_ID                              36920004
369300                    ,CRE_USER_ID                                  36930004
369400                    ,CARR_CART_CT                                 36940004
369500                    ,CARR_LAST_UPD_DTE                            36950004
369600                    ,CARR_LAST_UPD_TIME                           36960004
369700                    ,VEND_CART_CT                                 36970004
369800                    ,VEND_LAST_UPD_DTE                            36980004
369900                    ,VEND_LAST_UPD_TIME                           36990004
370000                    ,VEH_NBR                                      37000004
370100                    ,AUTH_NBR                                     37010004
370200                    ,AUTH_DTE                                     37020004
370300                    ,CONFIRM_DTE                                  37030004
370400                    ,CONFIRM_TIME                                 37040004
370500                    ,PROCESSED_DTE                                37050004
370600                    ,INVC_NBR                                     37060004
370700                    ,AUD_STATUS_CDE                               37070005
370800                    ,CARR_AUTH_ID  )                              37080005
370900            VALUES  (:SHIPMT-TRIP-ID                              37090004
371000                       :PV-NULL-TRIP-ID-IND                       37100004
371100                    ,:SHIPMT-SHIPT-ID                             37110004
371200                    ,:SHIPMT-CRT-SRC-CDE                          37120004
371300                    ,:SHIPMT-LAST-UPD-DTE                         37130004
371400                    ,:SHIPMT-LAST-UPD-TME                         37140004
371500                    ,:SHIPMT-LAST-UPD-UID                         37150004
371600                    ,:SHIPMT-PRO-SCAC-ID                          37160004
371700                    ,:SHIPMT-COMPLETE-PRO-NBR                     37170004
371800                    ,:SHIPMT-COMPLETE-BOL-NBR                     37180004
371900                    ,:SHIPMT-SHIPPER-NME                          37190004
372000                    ,:SHIPMT-SHIPT-TYP-CDE                        37200004
372100                    ,:SHIPMT-EXPTED-GRO-WGHT                      37210004
372200                    ,:SHIPMT-PKG-TYP-CDE                          37220004
372300                    ,:SHIPMT-EXPTED-PKG-QTY                       37230004
372400                    ,:SHIPMT-FRGT-CHG-AMT                         37240004
372500                    ,:SHIPMT-FRGT-TERMS-CDE                       37250004
372600                    ,:SHIPMT-EST-AR-TMST                          37260004
372700                       :PV-NULL-EST-AR-TMST                       37270004
372800                    ,:SHIPMT-VEND-SHIP-DTE                        37280004
372900                    ,:SHIPMT-EXPTED-PLT-QTY                       37290004
373000                    ,:SHIPMT-ORIG-SCAC-ID                         37300004
373100                    ,:SHIPMT-LAST-UPD-PGM-ID                      37310004
373200                    ,:SHIPMT-CRE-USER-ID                          37320004
373300                    ,:SHIPMT-CARR-CART-CT                         37330004
373400                    ,:SHIPMT-CARR-LAST-UPD-DTE                    37340004
373500                    ,:SHIPMT-CARR-LAST-UPD-TIME                   37350004
373600                    ,:SHIPMT-VEND-CART-CT                         37360004
373700                    ,:SHIPMT-VEND-LAST-UPD-DTE                    37370004
373800                    ,:SHIPMT-VEND-LAST-UPD-TIME                   37380004
373900                    ,:SHIPMT-VEH-NBR                              37390004
374000                    ,:SHIPMT-AUTH-NBR                             37400004
374100                    ,:SHIPMT-AUTH-DTE                             37410004
374200                    ,:SHIPMT-CONFIRM-DTE                          37420004
374300                    ,:SHIPMT-CONFIRM-TIME                         37430004
374400                    ,:SHIPMT-PROCESSED-DTE                        37440004
374500                    ,:SHIPMT-INVC-NBR                             37450004
374600                    ,:SHIPST-SHIPT-STATUS-CDE                     37460005
374700                    ,:SHIPMT-CARR-AUTH-ID     )                   37470005
374800         END-EXEC                                                 37480004
374900                                                                  37490004
375000         EVALUATE TRUE                                            37500004
375100             WHEN SQLCODE = +0                                    37510004
375200             WHEN SQLCODE = -904                                  37520004
375300             WHEN SQLCODE = -913                                  37530004
375400                 CONTINUE                                         37540004
375500                                                                  37550004
375600             WHEN SQLWARN0 NOT = SPACES                           37560004
375700             WHEN SQLCODE < +0                                    37570004
375800             WHEN SQLCODE > +0                                    37580004
375900                 MOVE '5370-AUDIT-TSHIPMT '                       37590004
376000                                   TO DP013-PARAGRAPH             37600004
376100                 MOVE 'INSERT A ROW ON TAUSHIP'                   37610004
376200                                   TO DP013-MESSAGE-TEXT(1)       37620004
376300                 MOVE SQLCA        TO DP013-SQLCA                 37630004
376400                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    37640004
376500                 SET DP013-DB2-ABEND                              37650004
376600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37660004
376700                 PERFORM DP013-0000-PROCESS-ABEND                 37670004
376800         END-EVALUATE                                             37680004
376900     END-PERFORM.                                                 37690004
377000                                                                  37700004
377100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37710004
377200         SQLCODE NOT = ZERO                                       37720004
377300         MOVE '5370-AUDIT-TSHIPMT'                                37730004
377400                                   TO DP013-PARAGRAPH             37740004
377500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              37750004
377600                                   TO DP013-MESSAGE-TEXT (1)      37760004
377700         MOVE 'TO INSERT A TAUSHIP ROW'                           37770004
377800                                   TO DP013-MESSAGE-TEXT (2)      37780004
377900         MOVE SQLCA                TO DP013-SQLCA                 37790004
378000         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    37800004
378100         SET DP013-DB2-ABEND                                      37810004
378200             DP013-XCTL-DISPLAY-RESTART                           37820004
378300                                   TO TRUE                        37830004
378400         PERFORM DP013-0000-PROCESS-ABEND                         37840004
378500     END-IF.                                                      37850004
378600                                                                  37860004
378700 EJECT                                                            37870004
378800******************************************************************37880004
378900** COUNT THE NUMBER OF REMAINING SHIPMENTS ASSIGNED TO THIS     **37890004
379000** SPECIFIC TRIP ID.  IF THERE ARE NO MORE SHIPMENTS ASSIGNED,  **37900004
379100** STATUS THE TRIP "DELETED".                                   **37910004
379200******************************************************************37920004
379300 5400-COUNT-REMAINING-SHIPMENTS.                                  37930004
379400                                                                  37940004
379500     PERFORM                                                      37950004
379600         WITH TEST AFTER                                          37960004
379700         VARYING PV-RETRY-COUNTER                                 37970004
379800         FROM 1 BY 1                                              37980004
379900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37990004
380000             OR (SQLCODE = +0))                                   38000004
380100                                                                  38010004
380200         EXEC SQL                                                 38020004
380300           SELECT                                                 38030004
380400                COUNT(*)                                          38040004
380500           INTO                                                   38050004
380600                :PV-SHIPMENT-COUNT                                38060004
380700          FROM                                                    38070004
380800                TSHIPST A,                                        38080004
380900                TSHIPMT B,                                        38090004
381000                TVHTRIP C                                         38100004
381100          WHERE                                                   38110004
381200                B.TRIP_ID = :PV-SAVE-TRIP-ID                      38120004
381300            AND C.VEH_NBR IS NULL                                 38130004
381400            AND A.SHIPT_ID = B.SHIPT_ID                           38140004
381500            AND B.TRIP_ID = C.TRIP_ID                             38150004
381600         END-EXEC                                                 38160004
381700                                                                  38170004
381800         EVALUATE TRUE                                            38180004
381900             WHEN SQLCODE = +0                                    38190004
382000             WHEN SQLCODE = -904                                  38200004
382100             WHEN SQLCODE = -913                                  38210004
382200                 CONTINUE                                         38220004
382300                                                                  38230004
382400             WHEN SQLWARN0 NOT = SPACES                           38240004
382500             WHEN SQLCODE < +0                                    38250004
382600             WHEN SQLCODE > +0                                    38260004
382700                 MOVE '5400-COUNT-REMAINING-SHIPMENTS'            38270004
382800                                   TO DP013-PARAGRAPH             38280004
382900                 MOVE 'COUNTING OPEN SHIPMENTS FOR A TRIP'        38290004
383000                                   TO DP013-MESSAGE-TEXT(1)       38300004
383100                 MOVE SQLCA        TO DP013-SQLCA                 38310004
383200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    38320004
383300                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (2)    38330004
383400                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (3)    38340004
383500                 SET DP013-DB2-ABEND                              38350004
383600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38360004
383700                 PERFORM DP013-0000-PROCESS-ABEND                 38370004
383800         END-EVALUATE                                             38380004
383900     END-PERFORM.                                                 38390004
384000                                                                  38400004
384100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38410004
384200         SQLCODE NOT = ZERO                                       38420004
384300         MOVE '5400-COUNT-REMAINING-SHIPMENTS'                    38430004
384400                                   TO DP013-PARAGRAPH             38440004
384500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              38450004
384600                                   TO DP013-MESSAGE-TEXT (1)      38460004
384700         MOVE 'TO COUNT OPEN SHIPMENTS FOR A TRIP'                38470004
384800                                   TO DP013-MESSAGE-TEXT (2)      38480004
384900         MOVE SQLCA                TO DP013-SQLCA                 38490004
385000         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    38500004
385100         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (2)    38510004
385200         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (3)    38520004
385300         SET DP013-DB2-ABEND                                      38530004
385400             DP013-XCTL-DISPLAY-RESTART                           38540004
385500                                   TO TRUE                        38550004
385600         PERFORM DP013-0000-PROCESS-ABEND                         38560004
385700     END-IF.                                                      38570004
385800                                                                  38580004
385900     IF  PV-SHIPMENT-COUNT = +0                                   38590004
386000         PERFORM 5500-STATUS-TRIP-DELETED                         38600004
386100     END-IF.                                                      38610004
386200                                                                  38620004
386300 5450-UPDATE-SHPTPO-RECS.                                         38630004
386400     PERFORM 5460-OPEN-CURSOR.                                    38640004
386500     SET PS-NOT-END-OF-CURSOR TO TRUE.                            38650004
386600     PERFORM 5480-FETCH-CURSOR                                    38660004
386700         UNTIL PS-END-OF-CURSOR.                                  38670004
386800     PERFORM 5470-CLOSE-CURSOR.                                   38680004
386900*----------------------------------------------------------------*38690004
387000* OPEN THE SHIPMT CURSOR.                                        *38700004
387100*----------------------------------------------------------------*38710004
387200                                                                  38720004
387300 5460-OPEN-CURSOR.                                                38730004
387400     PERFORM                                                      38740004
387500         WITH TEST AFTER                                          38750004
387600         VARYING PV-RETRY-COUNTER                                 38760004
387700         FROM 1 BY 1                                              38770004
387800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38780004
387900                   OR (SQLCODE = ZERO))                           38790004
388000                                                                  38800004
388100             EXEC SQL                                             38810004
388200                  OPEN SHPTPO-CSR                                 38820004
388300             END-EXEC                                             38830004
388400                                                                  38840004
388500                                                                  38850004
388600         EVALUATE TRUE                                            38860004
388700             WHEN SQLCODE = ZERO                                  38870004
388800             WHEN SQLCODE = -904                                  38880004
388900             WHEN SQLCODE = -913                                  38890004
389000                 CONTINUE                                         38900004
389100             WHEN SQLWARN0 NOT = SPACES                           38910004
389200             WHEN SQLCODE < ZERO                                  38920004
389300             WHEN SQLCODE > ZERO                                  38930004
389400                 MOVE '5460-OPEN-CURSOR'                          38940004
389500                                   TO DP013-PARAGRAPH             38950004
389600                 MOVE 'OPEN SHPTPO CURSOR - '                     38960004
389700                                   TO DP013-MESSAGE-TEXT (1)      38970004
389800                 MOVE SQLCA        TO DP013-SQLCA                 38980004
389900                 MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (1)    38990004
390000                 SET DP013-DB2-ABEND                              39000004
390100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39010004
390200                 PERFORM DP013-0000-PROCESS-ABEND                 39020004
390300         END-EVALUATE                                             39030004
390400     END-PERFORM.                                                 39040004
390500*                                                                 39050004
390600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39060004
390700         SQLCODE NOT = ZERO                                       39070004
390800         MOVE '5460-OPEN-CURSOR'   TO DP013-PARAGRAPH             39080004
390900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   39090004
391000                                   TO DP013-MESSAGE-TEXT (1)      39100004
391100         MOVE SQLCA                TO DP013-SQLCA                 39110004
391200         MOVE 'TSHPTPO '           TO DP013-DB2-TABLE-NAME (1)    39120004
391300         SET DP013-DB2-ABEND                                      39130004
391400             DP013-XCTL-DISPLAY-RESTART                           39140004
391500                                   TO TRUE                        39150004
391600         PERFORM DP013-0000-PROCESS-ABEND                         39160004
391700     END-IF.                                                      39170004
391800                                                                  39180004
391900 EJECT                                                            39190004
392000*----------------------------------------------------------------*39200004
392100* CLOSE THE TMESSAGE CURSOR.                                     *39210004
392200*----------------------------------------------------------------*39220004
392300                                                                  39230004
392400 5470-CLOSE-CURSOR.                                               39240004
392500     EXEC SQL                                                     39250004
392600         CLOSE SHPTPO-CSR                                         39260004
392700     END-EXEC.                                                    39270004
392800                                                                  39280004
392900*                                                                 39290004
393000     EVALUATE TRUE                                                39300004
393100         WHEN SQLCODE = ZERO                                      39310004
393200             CONTINUE                                             39320004
393300         WHEN SQLWARN0 NOT = SPACES                               39330004
393400         WHEN SQLCODE < ZERO                                      39340004
393500         WHEN SQLCODE > ZERO                                      39350004
393600             MOVE '5470-CLOSE-CURSOR'                             39360004
393700                               TO DP013-PARAGRAPH                 39370004
393800             MOVE 'CLOSE SHPTPO CURSOR '                          39380004
393900                               TO DP013-MESSAGE-TEXT (1)          39390004
394000             MOVE SQLCA        TO DP013-SQLCA                     39400004
394100             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        39410004
394200             SET DP013-DB2-ABEND                                  39420004
394300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39430004
394400             PERFORM DP013-0000-PROCESS-ABEND                     39440004
394500     END-EVALUATE.                                                39450004
394600                                                                  39460004
394700 EJECT                                                            39470004
394800 5480-FETCH-CURSOR.                                               39480004
394900     PERFORM                                                      39490004
395000         WITH TEST AFTER                                          39500004
395100         VARYING PV-RETRY-COUNTER                                 39510004
395200         FROM 1 BY 1                                              39520004
395300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39530004
395400             OR (SQLCODE = +0)                                    39540004
395500             OR (SQLCODE = +100))                                 39550004
395600                                                                  39560004
395700         EXEC SQL                                                 39570004
395800              FETCH SHPTPO-CSR                                    39580004
395900              INTO  :SHPTPO-PO-NBR                                39590004
396000                 ,  :SHPTPO-REC-SEQ-NBR                           39600004
396100                 ,  :SHPTPO-EXPTED-CART-CNT                       39610004
396200                 ,  :SHPTPO-ACTL-CART-CNT                         39620004
396300                 ,  :SHPTPO-CARR-CART-CT                          39630004
396400                 ,  :SHPTPO-VEND-CART-CT                          39640004
396500         END-EXEC                                                 39650004
396600                                                                  39660004
396700         EVALUATE TRUE                                            39670004
396800             WHEN SQLCODE = +0                                    39680004
396900             WHEN SQLCODE = -904                                  39690004
397000             WHEN SQLCODE = -913                                  39700004
397100                  CONTINUE                                        39710004
397200                                                                  39720004
397300             WHEN SQLCODE = +100                                  39730004
397400                 SET PS-END-OF-CURSOR TO TRUE                     39740004
397500                                                                  39750004
397600             WHEN SQLWARN0 NOT = SPACES                           39760004
397700             WHEN SQLCODE < +0                                    39770004
397800             WHEN SQLCODE > +0                                    39780004
397900                  MOVE '5480-FETCH-CURSOR'                        39790004
398000                                  TO DP013-PARAGRAPH              39800004
398100                  MOVE 'UNSUCCESSFUL FETCH ON TSHPTPO CURSOR'     39810004
398200                                  TO DP013-MESSAGE-TEXT (1)       39820004
398300                  MOVE SQLCA      TO DP013-SQLCA                  39830004
398400                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     39840004
398500                  SET DP013-DB2-ABEND                             39850004
398600                      DP013-XCTL-DISPLAY-RESTART                  39860004
398700                                  TO TRUE                         39870004
398800                  PERFORM DP013-0000-PROCESS-ABEND                39880004
398900         END-EVALUATE                                             39890004
399000     END-PERFORM.                                                 39900004
399100                                                                  39910004
399200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39920004
399300         SQLCODE NOT = ZERO                                       39930004
399400         MOVE '5480-FETCH-CURSOR' TO DP013-PARAGRAPH              39940004
399500         MOVE 'MAX RETRIES EXCEEDED ON FETCH TSHPTPO CURSOR'      39950004
399600                                  TO DP013-MESSAGE-TEXT (1)       39960004
399700         MOVE SQLCA               TO DP013-SQLCA                  39970004
399800         MOVE 'TSHPTPO'           TO DP013-DB2-TABLE-NAME (1)     39980004
399900         SET DP013-DB2-ABEND                                      39990004
400000             DP013-XCTL-DISPLAY-RESTART                           40000004
400100                                  TO TRUE                         40010004
400200         PERFORM DP013-0000-PROCESS-ABEND                         40020004
400300     END-IF.                                                      40030004
400400                                                                  40040004
400500     IF SQLCODE = +0                                              40050004
400600         SET PS-DONT-UPDATE-SHPTPO TO TRUE                        40060004
400700         IF SHPTPO-REC-SEQ-NBR = ZERO                             40070004
400800             IF SHPTPO-EXPTED-CART-CNT > 0                        40080004
400900                 CONTINUE                                         40090004
401000             ELSE                                                 40100004
401100                 IF SHPTPO-CARR-CART-CT > 0                       40110004
401200                     MOVE SHPTPO-CARR-CART-CT                     40120004
401300                           TO SHPTPO-EXPTED-CART-CNT              40130004
401400                     SET PS-UPDATE-SHPTPO TO TRUE                 40140004
401500                 ELSE                                             40150004
401600                     IF SHPTPO-VEND-CART-CT > 0                   40160004
401700                         MOVE SHPTPO-VEND-CART-CT                 40170004
401800                               TO SHPTPO-EXPTED-CART-CNT          40180004
401900                         SET PS-UPDATE-SHPTPO TO TRUE             40190004
402000                     END-IF                                       40200004
402100                 END-IF                                           40210004
402200             END-IF                                               40220004
402300         END-IF                                                   40230004
402400         IF SHPTPO-REC-SEQ-NBR = ZERO                             40240004
402500            IF SHIPMT-VEND-SHIP-DTE = '9999-09-09' OR             40250004
402600               SHIPMT-VEND-SHIP-DTE = '0001-01-01'                40260004
402700               SET PS-ERROR                                       40270004
402800                   PS-VEND-SHIP-DTE-ERROR TO TRUE                 40280004
402900               SET DP030-OVERRIDE-GO                              40290004
403000                             TO TRUE                              40300004
403100               MOVE PC-TSYMSG-02301                               40310004
403200                             TO DP020-MSG-NUMBER                  40320004
403300               SET DP020-MSG-WARNING                              40330004
403400                             TO TRUE                              40340004
403500            ELSE                                                  40350004
403600               MOVE ASC-KEY-TRIP-ID     TO DK-TRIP-ID             40360004
403700               PERFORM 5900-ADD-RECEIVER                          40370004
403800               MOVE PV-REC-SEQ-NBR TO SHPTPO-REC-SEQ-NBR          40380004
403900               SET PS-UPDATE-SHPTPO TO TRUE                       40390004
404000            END-IF                                                40400004
404100         ELSE                                                     40410004
404200             MOVE ASC-KEY-TRIP-ID     TO DK-TRIP-ID               40420004
404300             PERFORM 5600-SELECT-TTRIPST                          40430004
404400             IF TRSTYP-PRTY-CDE > PC-49                           40440004
404500                 STRING TRIPST-STATUS-DTE DELIMITED BY SIZE,      40450004
404600                        '-' DELIMITED BY SIZE,                    40460004
404700                        TRIPST-STATUS-TME DELIMITED BY SIZE,      40470004
404800                        '.000000' DELIMITED BY SIZE               40480004
404900                        INTO                RECEIV-REC-TMST       40490004
405000                 PERFORM 5530-UPDATE-RECEIVER                     40500004
405100             END-IF                                               40510004
405200         END-IF                                                   40520004
405300         IF PS-UPDATE-SHPTPO                                      40530004
405400             PERFORM 5490-UPDATE-SHPTPO                           40540004
405500         END-IF                                                   40550004
405600     END-IF.                                                      40560004
405700                                                                  40570004
405800 5490-UPDATE-SHPTPO.                                              40580004
405900     PERFORM                                                      40590004
406000         WITH TEST AFTER                                          40600004
406100         VARYING PV-RETRY-COUNTER                                 40610004
406200         FROM 1 BY 1                                              40620004
406300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40630004
406400             OR (SQLCODE = +0))                                   40640004
406500                                                                  40650004
406600         EXEC SQL                                                 40660004
406700           UPDATE TSHPTPO                                         40670004
406800              SET REC_SEQ_NBR      = :SHPTPO-REC-SEQ-NBR,         40680004
406900                  EXPTED_CART_CNT  = :SHPTPO-EXPTED-CART-CNT,     40690004
407000                  LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME,    40700004
407100                  LAST_UPD_DTE     = CURRENT DATE,                40710004
407200                  LAST_UPD_TIME    = CURRENT TIME,                40720004
407300                  LAST_UPD_USER_ID = :DP020-USERID                40730004
407400           WHERE  SHIPT_ID = :DK-SHIPT-ID                         40740004
407500             AND  PO_NBR   = :SHPTPO-PO-NBR                       40750004
407600         END-EXEC                                                 40760004
407700                                                                  40770004
407800         EVALUATE TRUE                                            40780004
407900             WHEN SQLCODE = +0                                    40790004
408000             WHEN SQLCODE = -904                                  40800004
408100             WHEN SQLCODE = -913                                  40810004
408200                 CONTINUE                                         40820004
408300                                                                  40830004
408400             WHEN SQLWARN0 NOT = SPACES                           40840004
408500             WHEN SQLCODE < +0                                    40850004
408600             WHEN SQLCODE > +0                                    40860004
408700                 MOVE '5300-ASSIGN-SHIPMENT-TO-TRIP'              40870004
408800                                   TO DP013-PARAGRAPH             40880004
408900                 MOVE 'UPDATE INFO ON TSHIPMT     '               40890004
409000                                   TO DP013-MESSAGE-TEXT(1)       40900004
409100                 MOVE SQLCA        TO DP013-SQLCA                 40910004
409200                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    40920004
409300                 SET DP013-DB2-ABEND                              40930004
409400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40940004
409500                 PERFORM DP013-0000-PROCESS-ABEND                 40950004
409600         END-EVALUATE                                             40960004
409700     END-PERFORM.                                                 40970004
409800                                                                  40980004
409900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    40990004
410000         SQLCODE NOT = ZERO                                       41000004
410100         MOVE '5300-ASSIGN-SHIPMENT-TO-TRIP'                      41010004
410200                                   TO DP013-PARAGRAPH             41020004
410300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              41030004
410400                                   TO DP013-MESSAGE-TEXT (1)      41040004
410500         MOVE 'TO UPDATE A TSHIPMT ROW'                           41050004
410600                                   TO DP013-MESSAGE-TEXT (2)      41060004
410700         MOVE SQLCA                TO DP013-SQLCA                 41070004
410800         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    41080004
410900         SET DP013-DB2-ABEND                                      41090004
411000             DP013-XCTL-DISPLAY-RESTART                           41100004
411100                                   TO TRUE                        41110004
411200         PERFORM DP013-0000-PROCESS-ABEND                         41120004
411300     END-IF.                                                      41130004
411400                                                                  41140004
411500     EVALUATE TRUE                                                41150004
411600         WHEN SQLCODE = ZERO                                      41160004
411700              MOVE PC-U TO PV-TRN-CDE                             41170004
411800              PERFORM 5495-INSERT-TAUSHPO                         41180004
411900     END-EVALUATE.                                                41190004
412000                                                                  41200004
412100                                                                  41210004
412200 EJECT                                                            41220004
412300*----------------------------------------------------------------*41230004
412400*  INSERT THE PO TO THE SHIPEMENT PO ASSOCIATION AUDIT TABLE      41240004
412500*                                                                 41250004
412600*  PERFORMED FROM 5000-INSERT-TAUSHPO                             41260004
412700*----------------------------------------------------------------*41270004
412800                                                                  41280004
412900 5495-INSERT-TAUSHPO.                                             41290004
413000                                                                  41300004
413100     PERFORM                                                      41310004
413200         WITH TEST AFTER                                          41320004
413300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     41330004
413400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            41340004
413500                (SQLCODE = ZERO)   OR                             41350004
413600                (SQLCODE = +100)                                  41360004
413700                                                                  41370004
413800         EXEC SQL                                                 41380004
413900             SELECT SHIPT_ID,                                     41390004
414000                    PO_NBR,                                       41400004
414100                    REC_SEQ_NBR,                                  41410004
414200                    EXPTED_CART_CNT,                              41420004
414300                    ACTL_CART_CNT,                                41430004
414400                    DMG_CART_CNT,                                 41440004
414500                    PKSL_IND,                                     41450004
414600                    VEND_NAME,                                    41460004
414700                    FRGT_CHG_AMT,                                 41470004
414800                    LAST_UPD_PGM_ID,                              41480004
414900                    CRE_USER_ID,                                  41490004
415000                    CARR_CART_CT,                                 41500004
415100                    CARR_LAST_UPD_DTE,                            41510004
415200                    CARR_LAST_UPD_TIME,                           41520004
415300                    VEND_CART_CT,                                 41530004
415400                    VEND_LAST_UPD_DTE,                            41540004
415500                    VEND_LAST_UPD_TIME,                           41550004
415600                    CRE_TMST,                                     41560004
415700                    LAST_UPD_DTE,                                 41570004
415800                    LAST_UPD_TIME,                                41580004
415900                    LAST_UPD_USER_ID,                             41590004
416000                    PRIM_SHIPT_IND                                41600004
416100                  , SPLT_XMIT_IND                                 41610004
416200                  , SPLT_XMIT_DTE                                 41620004
416300                  , SPLT_XMIT_TM                                  41630004
416400               INTO :SHPTPO-SHIPT-ID,                             41640004
416500                    :SHPTPO-PO-NBR,                               41650004
416600                    :SHPTPO-REC-SEQ-NBR,                          41660004
416700                    :SHPTPO-EXPTED-CART-CNT,                      41670004
416800                    :SHPTPO-ACTL-CART-CNT,                        41680004
416900                    :SHPTPO-DMG-CART-CNT,                         41690004
417000                    :SHPTPO-PKSL-IND,                             41700004
417100                    :SHPTPO-VEND-NAME,                            41710004
417200                    :SHPTPO-FRGT-CHG-AMT,                         41720004
417300                    :SHPTPO-LAST-UPD-PGM-ID,                      41730004
417400                    :SHPTPO-CRE-USER-ID,                          41740004
417500                    :SHPTPO-CARR-CART-CT,                         41750004
417600                    :SHPTPO-CARR-LAST-UPD-DTE,                    41760004
417700                    :SHPTPO-CARR-LAST-UPD-TIME,                   41770004
417800                    :SHPTPO-VEND-CART-CT,                         41780004
417900                    :SHPTPO-VEND-LAST-UPD-DTE,                    41790004
418000                    :SHPTPO-VEND-LAST-UPD-TIME,                   41800004
418100                    :SHPTPO-CRE-TMST,                             41810004
418200                    :SHPTPO-LAST-UPD-DTE,                         41820004
418300                    :SHPTPO-LAST-UPD-TIME,                        41830004
418400                    :SHPTPO-LAST-UPD-USER-ID,                     41840004
418500                    :SHPTPO-PRIM-SHIPT-IND                        41850004
418600                  , :SHPTPO-SPLT-XMIT-IND                         41860004
418700                  , :SHPTPO-SPLT-XMIT-DTE                         41870004
418800                  , :SHPTPO-SPLT-XMIT-TM                          41880004
418900               FROM TSHPTPO                                       41890004
419000              WHERE  SHIPT_ID = :DK-SHIPT-ID                      41900004
419100                AND  PO_NBR   = :SHPTPO-PO-NBR                    41910004
419200         END-EXEC                                                 41920004
419300                                                                  41930004
419400         EVALUATE TRUE                                            41940004
419500             WHEN SQLCODE = ZERO                                  41950004
419600             WHEN SQLCODE = +100                                  41960004
419700             WHEN SQLCODE = -904                                  41970004
419800             WHEN SQLCODE = -913                                  41980004
419900                 CONTINUE                                         41990004
420000                                                                  42000004
420100             WHEN SQLWARN0 NOT = SPACE                            42010004
420200             WHEN SQLCODE  NOT = +0                               42020004
420300                  MOVE SPACES TO PV-MESSAGE                       42030004
420400                  MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1             42040004
420500                  MOVE SHPTPO-PO-NBR   TO PV-MESSAGE2             42050004
420600                  MOVE '5495-INSERT-TAUSHPO'                      42060004
420700                                   TO DP013-PARAGRAPH             42070004
420800                  MOVE 'SELECT TSHPTPO DATA'                      42080004
420900                                   TO DP013-MESSAGE-TEXT (1)      42090004
421000                  MOVE PV-MESSAGE  TO DP013-MESSAGE-TEXT (2)      42100004
421100                  MOVE SQLCA       TO DP013-SQLCA                 42110004
421200                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    42120004
421300                  SET DP013-DB2-ABEND                             42130004
421400                                   TO TRUE                        42140004
421500                  PERFORM DP013-0000-PROCESS-ABEND                42150004
421600         END-EVALUATE                                             42160004
421700                                                                  42170004
421800     END-PERFORM.                                                 42180004
421900                                                                  42190004
422000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42200004
422100         SQLCODE NOT = ZERO                                       42210004
422200         MOVE '5495-INSERT-TAUSHPO'                               42220004
422300                                   TO DP013-PARAGRAPH             42230004
422400         MOVE 'MAX RETRIES EXCEEDED FOR SELECT TAUSHPO'           42240004
422500                                   TO DP013-MESSAGE-TEXT (1)      42250004
422600         MOVE SQLCA                TO DP013-SQLCA                 42260004
422700         SET DP013-DB2-ABEND       TO TRUE                        42270004
422800         PERFORM DP013-0000-PROCESS-ABEND                         42280004
422900     END-IF.                                                      42290004
423000                                                                  42300004
423100     MOVE PV-TRN-CDE               TO AUSHPO-TRN-CDE              42310004
423200     PERFORM                                                      42320004
423300         WITH TEST AFTER                                          42330004
423400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     42340004
423500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            42350004
423600                 SQLCODE = ZERO                                   42360004
423700                                                                  42370004
423800         EXEC SQL                                                 42380004
423900             INSERT INTO TAUSHPO                                  42390004
424000                   (SHIPT_ID,                                     42400004
424100                    PO_NBR,                                       42410004
424200                    REC_SEQ_NBR,                                  42420004
424300                    EXPTED_CART_CNT,                              42430004
424400                    ACTL_CART_CNT,                                42440004
424500                    DMG_CART_CNT,                                 42450004
424600                    PKSL_IND,                                     42460004
424700                    VEND_NAME,                                    42470004
424800                    FRGT_CHG_AMT,                                 42480004
424900                    LAST_UPD_PGM_ID,                              42490004
425000                    CRE_USER_ID,                                  42500004
425100                    CARR_CART_CT,                                 42510004
425200                    CARR_LAST_UPD_DTE,                            42520004
425300                    CARR_LAST_UPD_TIME,                           42530004
425400                    VEND_CART_CT,                                 42540004
425500                    VEND_LAST_UPD_DTE,                            42550004
425600                    VEND_LAST_UPD_TIME,                           42560004
425700                    CRE_TMST,                                     42570004
425800                    LAST_UPD_DTE,                                 42580004
425900                    LAST_UPD_TIME,                                42590004
426000                    LAST_UPD_USER_ID,                             42600004
426100                    PRIM_SHIPT_IND                                42610004
426200                  , SPLT_XMIT_IND                                 42620004
426300                  , SPLT_XMIT_DTE                                 42630004
426400                  , SPLT_XMIT_TM                                  42640004
426500                  , TRN_CDE )                                     42650004
426600             VALUES                                               42660004
426700                  (:SHPTPO-SHIPT-ID,                              42670004
426800                   :SHPTPO-PO-NBR,                                42680004
426900                   :SHPTPO-REC-SEQ-NBR,                           42690004
427000                   :SHPTPO-EXPTED-CART-CNT,                       42700004
427100                   :SHPTPO-ACTL-CART-CNT,                         42710004
427200                   :SHPTPO-DMG-CART-CNT,                          42720004
427300                   :SHPTPO-PKSL-IND,                              42730004
427400                   :SHPTPO-VEND-NAME,                             42740004
427500                   :SHPTPO-FRGT-CHG-AMT,                          42750004
427600                   :SHPTPO-LAST-UPD-PGM-ID,                       42760004
427700                   :SHPTPO-CRE-USER-ID,                           42770004
427800                   :SHPTPO-CARR-CART-CT,                          42780004
427900                   :SHPTPO-CARR-LAST-UPD-DTE,                     42790004
428000                   :SHPTPO-CARR-LAST-UPD-TIME,                    42800004
428100                   :SHPTPO-VEND-CART-CT,                          42810004
428200                   :SHPTPO-VEND-LAST-UPD-DTE,                     42820004
428300                   :SHPTPO-VEND-LAST-UPD-TIME,                    42830004
428400                   :SHPTPO-CRE-TMST,                              42840004
428500                   :SHPTPO-LAST-UPD-DTE,                          42850004
428600                   :SHPTPO-LAST-UPD-TIME,                         42860004
428700                   :SHPTPO-LAST-UPD-USER-ID,                      42870004
428800                   :SHPTPO-PRIM-SHIPT-IND                         42880004
428900                 , :SHPTPO-SPLT-XMIT-IND                          42890004
429000                 , :SHPTPO-SPLT-XMIT-DTE                          42900004
429100                 , :SHPTPO-SPLT-XMIT-TM                           42910004
429200                 , :AUSHPO-TRN-CDE )                              42920004
429300         END-EXEC                                                 42930004
429400                                                                  42940004
429500         EVALUATE TRUE                                            42950004
429600             WHEN SQLCODE = +0                                    42960004
429700             WHEN SQLCODE = -904                                  42970004
429800             WHEN SQLCODE = -913                                  42980004
429900                 CONTINUE                                         42990004
430000                                                                  43000004
430100             WHEN SQLWARN0 NOT = SPACES                           43010004
430200             WHEN SQLCODE < +0                                    43020004
430300             WHEN SQLCODE > +0                                    43030004
430400                 MOVE SPACES TO PV-MESSAGE                        43040004
430500                 MOVE SHPTPO-SHIPT-ID TO PV-MESSAGE1              43050004
430600                 MOVE SHPTPO-PO-NBR   TO PV-MESSAGE2              43060004
430700                 MOVE '5005-INSERT-TAUSHPO'                       43070004
430800                                   TO DP013-PARAGRAPH             43080004
430900                 MOVE 'INSERT A ROW ON TAUSHPO'                   43090004
431000                                   TO DP013-MESSAGE-TEXT(1)       43100004
431100                 MOVE PV-MESSAGE   TO DP013-MESSAGE-TEXT(2)       43110004
431200                 MOVE SQLCA        TO DP013-SQLCA                 43120004
431300                 MOVE 'TAUSHPO'    TO DP013-DB2-TABLE-NAME (1)    43130004
431400                 SET DP013-DB2-ABEND                              43140004
431500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           43150004
431600                 PERFORM DP013-0000-PROCESS-ABEND                 43160004
431700         END-EVALUATE                                             43170004
431800     END-PERFORM.                                                 43180004
431900                                                                  43190004
432000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43200004
432100         SQLCODE NOT = ZERO                                       43210004
432200         MOVE '5000-INSERT-TAUSHPO'                               43220004
432300                                   TO DP013-PARAGRAPH             43230004
432400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              43240004
432500                                   TO DP013-MESSAGE-TEXT (1)      43250004
432600         MOVE 'TO INSERT A TAUSHPO ROW'                           43260004
432700                                   TO DP013-MESSAGE-TEXT (2)      43270004
432800         MOVE SQLCA                TO DP013-SQLCA                 43280004
432900         MOVE 'TAUSHPO'            TO DP013-DB2-TABLE-NAME (1)    43290004
433000         SET DP013-DB2-ABEND                                      43300004
433100             DP013-XCTL-DISPLAY-RESTART                           43310004
433200                                   TO TRUE                        43320004
433300         PERFORM DP013-0000-PROCESS-ABEND                         43330004
433400     END-IF.                                                      43340004
433500                                                                  43350004
433600******************************************************************43360004
433700** WHEN THERE ARE NO MORE SHIPMENTS ASSIGNED TO THIS TRIP,      **43370004
433800** STATUS THE TRIP DELETED.                                     **43380004
433900******************************************************************43390004
434000 5500-STATUS-TRIP-DELETED.                                        43400004
434100                                                                  43410004
434200     MOVE PV-SAVE-TRIP-ID         TO DK-TRIP-ID.                  43420004
434300     PERFORM 5600-SELECT-TTRIPST.                                 43430004
434400                                                                  43440004
434500     MOVE PC-DELETED-STATUS-CDE  TO TRIPST-TRIP-STATUS-CDE.       43450004
434600                                                                  43460004
434700     PERFORM 5700-INSERT-TTRIPST.                                 43470004
434800                                                                  43480004
434900                                                                  43490004
435000 5530-UPDATE-RECEIVER.                                            43500004
435100                                                                  43510004
435200     PERFORM                                                      43520004
435300         WITH TEST AFTER                                          43530004
435400         VARYING PV-RETRY-COUNTER                                 43540004
435500         FROM 1 BY 1                                              43550004
435600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43560004
435700             OR (SQLCODE = +0))                                   43570004
435800                                                                  43580004
435900         EXEC SQL                                                 43590004
436000           UPDATE TRECEIV                                         43600004
436100              SET REC_TMST         = :RECEIV-REC-TMST,            43610004
436200                  UPD_TMST         = CURRENT TIMESTAMP,           43620004
436300                  UPD_UID          = :DP020-USERID,               43630004
436400                  UPD_PGM_ID       = :PC-CURRENT-PROGRAM-NAME     43640004
436500           WHERE  ORD_NBR      = :SHPTPO-PO-NBR                   43650004
436600             AND  REC_SEQ_NBR  = :SHPTPO-REC-SEQ-NBR              43660004
436700         END-EXEC                                                 43670004
436800                                                                  43680004
436900         EVALUATE TRUE                                            43690004
437000             WHEN SQLCODE = +0                                    43700004
437100             WHEN SQLCODE = -904                                  43710004
437200             WHEN SQLCODE = -913                                  43720004
437300                 CONTINUE                                         43730004
437400                                                                  43740004
437500             WHEN SQLWARN0 NOT = SPACE                            43750004
437600             WHEN SQLCODE < +0                                    43760004
437700             WHEN SQLCODE > +0                                    43770004
437800                 MOVE '5530-UPDATE-RECEIVER'                      43780004
437900                                 TO DP013-PARAGRAPH               43790004
438000                 MOVE 'UPDATE ON RECEIPTS TABLE'                  43800004
438100                                 TO DP013-MESSAGE-TEXT (1)        43810004
438200                 MOVE SQLCA      TO DP013-SQLCA                   43820004
438300                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      43830004
438400                     SET DP013-DB2-ABEND                          43840004
438500                         DP013-XCTL-DISPLAY-RESTART               43850004
438600                                     TO TRUE                      43860004
438700                 PERFORM DP013-0000-PROCESS-ABEND                 43870004
438800         END-EVALUATE                                             43880004
438900     END-PERFORM.                                                 43890004
439000                                                                  43900004
439100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43910004
439200         SQLCODE NOT = ZERO                                       43920004
439300         MOVE '5530-UPDATE-RECEIVER'                              43930004
439400                                  TO DP013-PARAGRAPH              43940004
439500         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TRECEIV'         43950004
439600                                  TO DP013-MESSAGE-TEXT (1)       43960004
439700         MOVE SQLCA               TO DP013-SQLCA                  43970004
439800         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     43980004
439900         SET DP013-DB2-ABEND                                      43990004
440000             DP013-XCTL-DISPLAY-RESTART                           44000004
440100                                  TO TRUE                         44010004
440200         PERFORM DP013-0000-PROCESS-ABEND                         44020004
440300     END-IF.                                                      44030004
440400                                                                  44040004
440500*----------------------------------------------------------------*44050004
440600*  SELECT CURRENT TRIP STATUS ROW                                *44060004
440700*----------------------------------------------------------------*44070004
440800 5600-SELECT-TTRIPST.                                             44080004
440900                                                                  44090004
441000     PERFORM                                                      44100004
441100         WITH TEST AFTER                                          44110004
441200         VARYING PV-RETRY-COUNTER                                 44120004
441300         FROM 1 BY 1                                              44130004
441400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44140004
441500             OR (SQLCODE = +0))                                   44150004
441600                                                                  44160004
441700         EXEC SQL                                                 44170004
441800             SELECT  A.TRIP_ID,                                   44180004
441900                     A.TRIP_STATUS_CDE,                           44190004
442000                     A.STATUS_DTE,                                44200004
442100                     A.STATUS_TME,                                44210004
442200                     A.STATUS_UID,                                44220004
442300                     A.OPER_UNT_ID,                               44230004
442400                     A.FCLTY_ID,                                  44240004
442500                     A.FCLTY_AREA_ID,                             44250004
442600                     B.PRTY_CDE                                   44260004
442700              INTO   :TRIPST-TRIP-ID,                             44270004
442800                     :TRIPST-TRIP-STATUS-CDE,                     44280004
442900                     :TRIPST-STATUS-DTE,                          44290004
443000                     :TRIPST-STATUS-TME,                          44300004
443100                     :TRIPST-STATUS-UID,                          44310004
443200                     :TRIPST-OPER-UNT-ID,                         44320004
443300                     :TRIPST-FCLTY-ID,                            44330004
443400                     :TRIPST-FCLTY-AREA-ID,                       44340004
443500                     :TRSTYP-PRTY-CDE                             44350004
443600              FROM  TTRIPST A,                                    44360004
443700                    TTRSTYP B                                     44370004
443800             WHERE  A.TRIP_ID          = :DK-TRIP-ID              44380004
443900               AND  A.TRIP_STATUS_CDE ^= 'DE'                     44390004
444000               AND  B.PRTY_CDE =                                  44400004
444100                  (SELECT MAX(D.PRTY_CDE)                         44410004
444200                     FROM TTRIPST C,                              44420004
444300                          TTRSTYP D                               44430004
444400                    WHERE C.TRIP_ID         = A.TRIP_ID           44440004
444500                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  44450004
444600               AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE         44460004
444700         END-EXEC                                                 44470004
444800                                                                  44480004
444900         EVALUATE TRUE                                            44490004
445000             WHEN SQLCODE = +0                                    44500004
445100             WHEN SQLCODE = -904                                  44510004
445200             WHEN SQLCODE = -913                                  44520004
445300                 CONTINUE                                         44530004
445400                                                                  44540004
445500             WHEN SQLWARN0 NOT = SPACES                           44550004
445600             WHEN SQLCODE < +0                                    44560004
445700             WHEN SQLCODE > +0                                    44570004
445800                 MOVE '5600-SELECT-TTRIPST'                       44580004
445900                                   TO DP013-PARAGRAPH             44590004
446000                 MOVE 'SELECT A ROW ON TTRIPST'                   44600004
446100                                   TO DP013-MESSAGE-TEXT(1)       44610004
446200                 MOVE SQLCA        TO DP013-SQLCA                 44620004
446300                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    44630004
446400                 MOVE 'TTRSTYP'    TO DP013-DB2-TABLE-NAME (2)    44640004
446500                 SET DP013-DB2-ABEND                              44650004
446600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44660004
446700                 PERFORM DP013-0000-PROCESS-ABEND                 44670004
446800         END-EVALUATE                                             44680004
446900     END-PERFORM.                                                 44690004
447000                                                                  44700004
447100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44710004
447200         SQLCODE NOT = ZERO                                       44720004
447300         MOVE '5600-INSERT-TTRIPST'                               44730004
447400                                   TO DP013-PARAGRAPH             44740004
447500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              44750004
447600                                   TO DP013-MESSAGE-TEXT (1)      44760004
447700         MOVE 'TO SELECT A TTRIPST ROW'                           44770004
447800                                   TO DP013-MESSAGE-TEXT (2)      44780004
447900         MOVE SQLCA                TO DP013-SQLCA                 44790004
448000         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    44800004
448100         MOVE 'TTRSTYP'            TO DP013-DB2-TABLE-NAME (2)    44810004
448200         SET DP013-DB2-ABEND                                      44820004
448300             DP013-XCTL-DISPLAY-RESTART                           44830004
448400                                   TO TRUE                        44840004
448500         PERFORM DP013-0000-PROCESS-ABEND                         44850004
448600     END-IF.                                                      44860004
448700                                                                  44870004
448800                                                                  44880004
448900*----------------------------------------------------------------*44890004
449000*  INSERT A ROW ON THE VEHICLE TRIP STATUS TABLE                 *44900004
449100*----------------------------------------------------------------*44910004
449200 5700-INSERT-TTRIPST.                                             44920004
449300                                                                  44930004
449400     PERFORM                                                      44940004
449500         WITH TEST AFTER                                          44950004
449600         VARYING PV-RETRY-COUNTER                                 44960004
449700         FROM 1 BY 1                                              44970004
449800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44980004
449900             OR (SQLCODE = +0))                                   44990004
450000                                                                  45000004
450100         EXEC SQL                                                 45010004
450200             INSERT  INTO TTRIPST                                 45020004
450300                    (TRIP_ID,                                     45030004
450400                     TRIP_STATUS_CDE,                             45040004
450500                     STATUS_DTE,                                  45050004
450600                     STATUS_TME,                                  45060004
450700                     STATUS_UID,                                  45070004
450800                     OPER_UNT_ID,                                 45080004
450900                     FCLTY_ID,                                    45090004
451000                     FCLTY_AREA_ID)                               45100004
451100            VALUES  (:TRIPST-TRIP-ID,                             45110004
451200                     :TRIPST-TRIP-STATUS-CDE,                     45120004
451300                     CURRENT DATE,                                45130004
451400                     CURRENT TIME,                                45140004
451500                     :DP020-USERID,                               45150004
451600                     :TRIPST-OPER-UNT-ID,                         45160004
451700                     :TRIPST-FCLTY-ID,                            45170004
451800                     :TRIPST-FCLTY-AREA-ID)                       45180004
451900         END-EXEC                                                 45190004
452000                                                                  45200004
452100         EVALUATE TRUE                                            45210004
452200             WHEN SQLCODE = +0                                    45220004
452300             WHEN SQLCODE = -904                                  45230004
452400             WHEN SQLCODE = -913                                  45240004
452500                 CONTINUE                                         45250004
452600                                                                  45260004
452700             WHEN SQLWARN0 NOT = SPACES                           45270004
452800             WHEN SQLCODE < +0                                    45280004
452900             WHEN SQLCODE > +0                                    45290004
453000                 MOVE '5700-INSERT-TTRIPST'                       45300004
453100                                   TO DP013-PARAGRAPH             45310004
453200                 MOVE 'INSERT A ROW ON TTRIPST'                   45320004
453300                                   TO DP013-MESSAGE-TEXT(1)       45330004
453400                 MOVE SQLCA        TO DP013-SQLCA                 45340004
453500                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    45350004
453600                 SET DP013-DB2-ABEND                              45360004
453700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           45370004
453800                 PERFORM DP013-0000-PROCESS-ABEND                 45380004
453900         END-EVALUATE                                             45390004
454000     END-PERFORM.                                                 45400004
454100                                                                  45410004
454200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45420004
454300         SQLCODE NOT = ZERO                                       45430004
454400         MOVE '5700-INSERT-TTRIPST'                               45440004
454500                                   TO DP013-PARAGRAPH             45450004
454600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              45460004
454700                                   TO DP013-MESSAGE-TEXT (1)      45470004
454800         MOVE 'TO INSERT A TTRIPST ROW'                           45480004
454900                                   TO DP013-MESSAGE-TEXT (2)      45490004
455000         MOVE SQLCA                TO DP013-SQLCA                 45500004
455100         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    45510004
455200         SET DP013-DB2-ABEND                                      45520004
455300             DP013-XCTL-DISPLAY-RESTART                           45530004
455400                                   TO TRUE                        45540004
455500         PERFORM DP013-0000-PROCESS-ABEND                         45550004
455600     END-IF.                                                      45560004
455700                                                                  45570004
455800/                                                                 45580004
455900*----------------------------------------------------------------*45590004
456000* SELECT A VEHICLE                                               *45600004
456100*----------------------------------------------------------------*45610004
456200 5800-SELECT-TVEHICL.                                             45620004
456300                                                                  45630004
456400     PERFORM                                                      45640004
456500         WITH TEST AFTER                                          45650004
456600         VARYING PV-RETRY-COUNTER                                 45660004
456700         FROM 1 BY 1                                              45670004
456800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45680004
456900            OR (SQLCODE = +0)                                     45690004
457000            OR (SQLCODE = +100))                                  45700004
457100                                                                  45710004
457200         EXEC SQL                                                 45720004
457300          SELECT CURR_STATUS_CDE                                  45730004
457400           INTO  :VEHICL-CURR-STATUS-CDE                          45740004
457500           FROM   TVEHICL A                                       45750004
457600           WHERE  A.VEH_NBR       = :ASC-KEY-VEH-NBR              45760004
457700             AND  A.OWNER_SCAC_ID = :ASC-KEY-DELIVERY-SCAC-ID     45770004
457800         END-EXEC                                                 45780004
457900                                                                  45790004
458000         EVALUATE TRUE                                            45800004
458100             WHEN SQLCODE = +0                                    45810004
458200             WHEN SQLCODE = +100                                  45820004
458300             WHEN SQLCODE = -904                                  45830004
458400             WHEN SQLCODE = -913                                  45840004
458500                 CONTINUE                                         45850004
458600                                                                  45860004
458700             WHEN SQLWARN0 NOT = SPACES                           45870004
458800             WHEN SQLCODE < ZERO                                  45880004
458900             WHEN SQLCODE > ZERO                                  45890004
459000                 MOVE '5800-SELECT-TVEHICL'                       45900004
459100                                   TO DP013-PARAGRAPH             45910004
459200                 MOVE 'SELECT ON TVEHICL'                         45920004
459300                                   TO DP013-MESSAGE-TEXT (1)      45930004
459400                 MOVE SQLCA        TO DP013-SQLCA                 45940004
459500                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    45950004
459600                 SET DP013-DB2-ABEND                              45960004
459700                     DP013-XCTL-DISPLAY-RESTART                   45970004
459800                                   TO TRUE                        45980004
459900                 PERFORM DP013-0000-PROCESS-ABEND                 45990004
460000         END-EVALUATE                                             46000004
460100     END-PERFORM.                                                 46010004
460200                                                                  46020004
460300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    46030004
460400         SQLCODE NOT = ZERO                                       46040004
460500         MOVE '5800-SELECT-TVEHICL'                               46050004
460600                                   TO DP013-PARAGRAPH             46060004
460700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46070004
460800                                   TO DP013-MESSAGE-TEXT (1)      46080004
460900         MOVE 'A VEHICLE ROW   '   TO DP013-MESSAGE-TEXT (2)      46090004
461000         MOVE SQLCA                TO DP013-SQLCA                 46100004
461100         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    46110004
461200         SET DP013-DB2-ABEND                                      46120004
461300             DP013-XCTL-DISPLAY-RESTART                           46130004
461400                                   TO TRUE                        46140004
461500         PERFORM DP013-0000-PROCESS-ABEND                         46150004
461600     END-IF.                                                      46160004
461700                                                                  46170004
461800                                                                  46180004
461900 5900-ADD-RECEIVER.                                               46190004
462000                                                                  46200004
462100     MOVE SHPTPO-PO-NBR      TO DK-PO-NBR.                        46210004
462200     MOVE ASC-KEY-OPER-UNT-ID-N                                   46220004
462300                             TO DK-OPER-UNT-ID.                   46230004
462400     MOVE ASC-KEY-FCLTY-ID-N                                      46240004
462500                             TO DK-FCLTY-ID.                      46250004
462600                                                                  46260004
462700     PERFORM 5905-GET-MAX-SEQ-NBR.                                46270004
462800     PERFORM 5910-GET-ENT-NAME-DESC.                              46280004
462900     INITIALIZE PV-DB2-COUNT.                                     46290004
463000     MOVE 4                  TO DK-AGRMT-TYP-ID.                  46300004
463100     MOVE 4                  TO DK-TYP-CDE.                       46310004
463200     PERFORM 5915-CHECK-PO-SERVICE-INFO.                          46320004
463300     IF PV-DB2-COUNT > +0                                         46330004
463400         MOVE 'Y'                   TO PV-PACK-BY-ST-IND          46340004
463500     ELSE                                                         46350004
463600         MOVE 'N'                   TO PV-PACK-BY-ST-IND          46360004
463700     END-IF.                                                      46370004
463800     INITIALIZE PV-DB2-COUNT.                                     46380004
463900     MOVE 4                  TO DK-AGRMT-TYP-ID.                  46390004
464000     MOVE 2                  TO DK-TYP-CDE.                       46400004
464100     PERFORM 5915-CHECK-PO-SERVICE-INFO.                          46410004
464200     IF PV-DB2-COUNT > +0                                         46420004
464300         MOVE 'Y'                   TO PV-GARM-ON-HNGR-IND        46430004
464400     ELSE                                                         46440004
464500         MOVE 'N'                   TO PV-GARM-ON-HNGR-IND        46450004
464600     END-IF.                                                      46460004
464700     INITIALIZE PV-DB2-COUNT.                                     46470004
464800     MOVE 4                  TO DK-AGRMT-TYP-ID.                  46480004
464900     MOVE 1                  TO DK-TYP-CDE.                       46490004
465000     PERFORM 5915-CHECK-PO-SERVICE-INFO.                          46500004
465100     IF PV-DB2-COUNT > +0                                         46510004
465200         MOVE 'Y'                   TO PV-PRE-TICKET-IND          46520004
465300     ELSE                                                         46530004
465400         MOVE 'N'                   TO PV-PRE-TICKET-IND          46540004
465500     END-IF.                                                      46550004
465600     PERFORM 5920-BUILD-RECEIVER-INFO.                            46560004
465700     IF  PS-NO-ERROR                                              46570004
465800         PERFORM 5965-BUILD-ZERO-LINE-WORK-ORD                    46580004
465900     END-IF.                                                      46590004
466000                                                                  46600004
466100     IF  PS-NO-ERROR                                              46610004
466200         IF TM500-NO-TROUBLE                                      46620004
466300             MOVE PC-TSYMSG-00391    TO DP020-MSG-NUMBER          46630004
466400             MOVE PV-REC-SEQ-NBR     TO DP020-MSG-TEXT            46640004
466500         ELSE                                                     46650004
466600             MOVE PC-TSYMSG-00847    TO DP020-MSG-NUMBER          46660004
466700             MOVE PV-REC-SEQ-NBR     TO DP020-MSG-TEXT            46670004
466800         END-IF                                                   46680004
466900         SET DP020-MSG-INFORMATIONAL                              46690004
467000                                 TO TRUE                          46700004
467100     END-IF.                                                      46710004
467200                                                                  46720004
467300 5901-GET-SHIPMT-INFO.                                            46730004
467400                                                                  46740004
467500     PERFORM                                                      46750004
467600         WITH TEST AFTER                                          46760004
467700         VARYING PV-RETRY-COUNTER                                 46770004
467800         FROM 1 BY 1                                              46780004
467900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46790004
468000             OR (SQLCODE = +0))                                   46800004
468100                                                                  46810004
468200         EXEC SQL                                                 46820004
468300             SELECT                                               46830004
468400                     VEND_SHIP_DTE                                46840004
468500            INTO     :SHIPMT-VEND-SHIP-DTE                        46850004
468600           FROM   TSHIPMT                                         46860004
468700           WHERE  SHIPT_ID = :DK-SHIPT-ID                         46870004
468800         END-EXEC                                                 46880004
468900                                                                  46890004
469000         EVALUATE TRUE                                            46900004
469100             WHEN SQLCODE = +0                                    46910004
469200             WHEN SQLCODE = -904                                  46920004
469300             WHEN SQLCODE = -913                                  46930004
469400                 CONTINUE                                         46940004
469500                                                                  46950004
469600             WHEN SQLWARN0 NOT = SPACES                           46960004
469700             WHEN SQLCODE < +0                                    46970004
469800             WHEN SQLCODE > +0                                    46980004
469900                 MOVE '5901-GET-SHIPMT-INFO'                      46990004
470000                                   TO DP013-PARAGRAPH             47000004
470100                 MOVE 'SELECT A TSHIPMT ROW   '                   47010004
470200                                   TO DP013-MESSAGE-TEXT(1)       47020004
470300                 MOVE SQLCA        TO DP013-SQLCA                 47030004
470400                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    47040004
470500                 SET DP013-DB2-ABEND                              47050004
470600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47060004
470700                 PERFORM DP013-0000-PROCESS-ABEND                 47070004
470800         END-EVALUATE                                             47080004
470900     END-PERFORM.                                                 47090004
471000                                                                  47100004
471100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47110004
471200         SQLCODE NOT = ZERO                                       47120004
471300         MOVE '5901-GET-SHIPMT-INFO'                              47130004
471400                                   TO DP013-PARAGRAPH             47140004
471500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              47150004
471600                                   TO DP013-MESSAGE-TEXT (1)      47160004
471700         MOVE 'TO SELECT A TSHIPMT ROW'                           47170004
471800                                   TO DP013-MESSAGE-TEXT (2)      47180004
471900         MOVE SQLCA                TO DP013-SQLCA                 47190004
472000         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    47200004
472100         SET DP013-DB2-ABEND                                      47210004
472200             DP013-XCTL-DISPLAY-RESTART                           47220004
472300                                   TO TRUE                        47230004
472400         PERFORM DP013-0000-PROCESS-ABEND                         47240004
472500     END-IF.                                                      47250004
472600                                                                  47260004
472700*----------------------------------------------------------------*47270004
472800* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *47280004
472900*----------------------------------------------------------------*47290004
473000 5905-GET-MAX-SEQ-NBR.                                            47300004
473100                                                                  47310004
473200     PERFORM                                                      47320004
473300         WITH TEST AFTER                                          47330004
473400         VARYING PV-RETRY-COUNTER                                 47340004
473500         FROM 1 BY 1                                              47350004
473600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47360004
473700            OR (SQLCODE = +0)                                     47370004
473800            OR (SQLCODE = +100)                                   47380004
473900            OR (SQLCODE = -305))                                  47390004
474000                                                                  47400004
474100         EXEC SQL                                                 47410004
474200           SELECT MAX(REC_SEQ_NBR)                                47420004
474300           INTO  :RECEIV-REC-SEQ-NBR                              47430004
474400           FROM   TRECEIV                                         47440004
474500           WHERE  ORD_NBR = :DK-PO-NBR                            47450004
474600         END-EXEC                                                 47460004
474700                                                                  47470004
474800         EVALUATE TRUE                                            47480004
474900             WHEN SQLCODE = +0                                    47490004
475000                 MOVE RECEIV-REC-SEQ-NBR                          47500004
475100                                 TO PV-REC-SEQ-NBR                47510004
475200                 ADD +1          TO PV-REC-SEQ-NBR                47520004
475300                                                                  47530004
475400             WHEN SQLCODE = +100                                  47540004
475500             WHEN SQLCODE = -305                                  47550004
475600                 MOVE +1         TO PV-REC-SEQ-NBR                47560004
475700                                                                  47570004
475800             WHEN SQLCODE = -904                                  47580004
475900             WHEN SQLCODE = -913                                  47590004
476000                 CONTINUE                                         47600004
476100                                                                  47610004
476200             WHEN SQLWARN0 NOT = SPACE                            47620004
476300             WHEN SQLCODE < +0                                    47630004
476400             WHEN SQLCODE > +0                                    47640004
476500                 MOVE '5905-GET-MAX-SEQ-NBR  '                    47650004
476600                                 TO DP013-PARAGRAPH               47660004
476700                 MOVE 'SELECT MAX ON RECEIPTS TABLE'              47670004
476800                                 TO DP013-MESSAGE-TEXT (1)        47680004
476900                 MOVE SQLCA      TO DP013-SQLCA                   47690004
477000                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      47700004
477100                     SET DP013-DB2-ABEND                          47710004
477200                         DP013-XCTL-DISPLAY-RESTART               47720004
477300                                     TO TRUE                      47730004
477400                 PERFORM DP013-0000-PROCESS-ABEND                 47740004
477500         END-EVALUATE                                             47750004
477600     END-PERFORM.                                                 47760004
477700                                                                  47770004
477800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47780004
477900         SQLCODE NOT = ZERO                                       47790004
478000         MOVE '5905-GET-MAX-SEQ-NBR  '                            47800004
478100                                  TO DP013-PARAGRAPH              47810004
478200         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TRECEIV'         47820004
478300                                  TO DP013-MESSAGE-TEXT (1)       47830004
478400         MOVE SQLCA               TO DP013-SQLCA                  47840004
478500         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     47850004
478600         SET DP013-DB2-ABEND                                      47860004
478700             DP013-XCTL-DISPLAY-RESTART                           47870004
478800                                  TO TRUE                         47880004
478900         PERFORM DP013-0000-PROCESS-ABEND                         47890004
479000     END-IF.                                                      47900004
479100                                                                  47910004
479200/                                                                 47920004
479300*----------------------------------------------------------------*47930004
479400*  RETRIEVE THE PRIMARY VENDOR NAME                               47940004
479500*----------------------------------------------------------------*47950004
479600                                                                  47960004
479700 5910-GET-ENT-NAME-DESC.                                          47970004
479800                                                                  47980004
479900     PERFORM                                                      47990004
480000         WITH TEST AFTER                                          48000004
480100         VARYING PV-RETRY-COUNTER                                 48010004
480200         FROM 1 BY 1                                              48020004
480300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48030004
480400             OR (SQLCODE = +0)                                    48040004
480500             OR (SQLCODE = +100))                                 48050004
480600                                                                  48060004
480700         EXEC SQL                                                 48070004
480800              SELECT A.DEPT_NBR                                   48080004
480900                    ,A.VER_NBR                                    48090004
481000                    ,B.ENT_NAME_DESC                              48100004
481100                INTO :PURCHS-DEPT-NBR                             48110004
481200                    ,:PURCHS-VER-NBR                              48120004
481300                    ,:ENTNME-ENT-NAME-DESC                        48130004
481400                FROM TPURCHS A                                    48140004
481500                    ,TENTNME B                                    48150004
481600               WHERE A.PO_NBR         = :DK-PO-NBR                48160004
481700                 AND A.VER_STATUS_CDE = 'A'                       48170004
481800                 AND B.TYPE_CDE       = '01'                      48180004
481900                 AND A.ENT_ID = B.ENT_ID                          48190004
482000         END-EXEC                                                 48200004
482100                                                                  48210004
482200         EVALUATE TRUE                                            48220004
482300             WHEN SQLCODE = +0                                    48230004
482400                  MOVE PURCHS-VER-NBR                             48240004
482500                                  TO PV-VER-NBR                   48250004
482600                  MOVE PURCHS-DEPT-NBR                            48260004
482700                                  TO DK-DEPT-NBR                  48270004
482800                                                                  48280004
482900             WHEN SQLCODE = +100                                  48290004
483000                  MOVE +1         TO PV-VER-NBR                   48300004
483100                  MOVE SPACES     TO DK-DEPT-NBR                  48310004
483200                                                                  48320004
483300             WHEN SQLCODE = -904                                  48330004
483400             WHEN SQLCODE = -913                                  48340004
483500                  CONTINUE                                        48350004
483600                                                                  48360004
483700             WHEN SQLWARN0 NOT = SPACES                           48370004
483800             WHEN SQLCODE < +0                                    48380004
483900             WHEN SQLCODE > +0                                    48390004
484000                  MOVE '5910-GET-ENT-NAME-DESC'                   48400004
484100                                  TO DP013-PARAGRAPH              48410004
484200                  MOVE 'UNSUCCESSFUL SELECT ENTERPRISE NAME'      48420004
484300                                  TO DP013-MESSAGE-TEXT (1)       48430004
484400                  MOVE SQLCA      TO DP013-SQLCA                  48440004
484500                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     48450004
484600                  SET DP013-DB2-ABEND                             48460004
484700                      DP013-XCTL-DISPLAY-RESTART                  48470004
484800                                  TO TRUE                         48480004
484900                  PERFORM DP013-0000-PROCESS-ABEND                48490004
485000         END-EVALUATE                                             48500004
485100     END-PERFORM.                                                 48510004
485200                                                                  48520004
485300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    48530004
485400         SQLCODE NOT = ZERO                                       48540004
485500         MOVE '5910-GET-ENT-NAME-DESC'                            48550004
485600                                  TO DP013-PARAGRAPH              48560004
485700         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    48570004
485800                                  TO DP013-MESSAGE-TEXT (1)       48580004
485900         MOVE SQLCA               TO DP013-SQLCA                  48590004
486000         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (1)     48600004
486100         SET DP013-DB2-ABEND                                      48610004
486200             DP013-XCTL-DISPLAY-RESTART                           48620004
486300                                  TO TRUE                         48630004
486400         PERFORM DP013-0000-PROCESS-ABEND                         48640004
486500     END-IF.                                                      48650004
486600                                                                  48660004
486700/                                                                 48670004
486800*----------------------------------------------------------------*48680004
486900*    CHECK TO SEE WHAT TYPES OF SERVICES THIS PO HAS             *48690004
487000*----------------------------------------------------------------*48700004
487100 5915-CHECK-PO-SERVICE-INFO.                                      48710004
487200                                                                  48720004
487300     PERFORM                                                      48730004
487400         WITH TEST AFTER                                          48740004
487500         VARYING PV-RETRY-COUNTER                                 48750004
487600         FROM 1 BY 1                                              48760004
487700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48770004
487800             OR (SQLCODE = +0)                                    48780004
487900             OR (SQLCODE = +100))                                 48790004
488000                                                                  48800004
488100         EXEC SQL                                                 48810004
488200              SELECT COUNT(*)                                     48820004
488300                INTO :PV-DB2-COUNT                                48830004
488400                FROM TPOAGMT                                      48840004
488500               WHERE PO_NBR         = :DK-PO-NBR                  48850004
488600                 AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID            48860004
488700                 AND VER_STATUS_CDE = 'A'                         48870004
488800                 AND TYP_CDE        = :DK-TYP-CDE                 48880004
488900         END-EXEC                                                 48890004
489000                                                                  48900004
489100         EVALUATE TRUE                                            48910004
489200             WHEN SQLCODE = +0                                    48920004
489300             WHEN SQLCODE = +100                                  48930004
489400             WHEN SQLCODE = -904                                  48940004
489500             WHEN SQLCODE = -913                                  48950004
489600                  CONTINUE                                        48960004
489700                                                                  48970004
489800             WHEN SQLWARN0 NOT = SPACES                           48980004
489900             WHEN SQLCODE < +0                                    48990004
490000             WHEN SQLCODE > +0                                    49000004
490100                  MOVE '5915-CHECK-PO-SERVICE-INFO'               49010004
490200                                  TO DP013-PARAGRAPH              49020004
490300                  MOVE 'UNSUCCESSFUL SELECT PURCHASE AGREEMENT'   49030004
490400                                  TO DP013-MESSAGE-TEXT (1)       49040004
490500                  MOVE SQLCA      TO DP013-SQLCA                  49050004
490600                  MOVE 'TPOAGMT ' TO DP013-DB2-TABLE-NAME (1)     49060004
490700                  SET DP013-DB2-ABEND                             49070004
490800                      DP013-XCTL-DISPLAY-RESTART                  49080004
490900                                  TO TRUE                         49090004
491000                  PERFORM DP013-0000-PROCESS-ABEND                49100004
491100         END-EVALUATE                                             49110004
491200     END-PERFORM.                                                 49120004
491300                                                                  49130004
491400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    49140004
491500         SQLCODE NOT = ZERO                                       49150004
491600         MOVE '5915-CHECK-PO-SERVICE-INFO'                        49160004
491700                                  TO DP013-PARAGRAPH              49170004
491800         MOVE 'MAX RETRIES EXCEEDED ON SELECT PURCHASE AGREEMENT' 49180004
491900                                  TO DP013-MESSAGE-TEXT (1)       49190004
492000         MOVE SQLCA               TO DP013-SQLCA                  49200004
492100         MOVE 'TPOAGMT '          TO DP013-DB2-TABLE-NAME (1)     49210004
492200         SET DP013-DB2-ABEND                                      49220004
492300             DP013-XCTL-DISPLAY-RESTART                           49230004
492400                                  TO TRUE                         49240004
492500         PERFORM DP013-0000-PROCESS-ABEND                         49250004
492600     END-IF.                                                      49260004
492700                                                                  49270004
492800                                                                  49280004
492900 5920-BUILD-RECEIVER-INFO.                                        49290004
493000                                                                  49300004
493100     INITIALIZE DCLTRECEIV.                                       49310004
493200                                                                  49320004
493300     MOVE SHPTPO-PO-NBR          TO RECEIV-ORD-NBR.               49330004
493400     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            49340004
493500                                    RECEIV-REFER-BACK-SEQ-NBR.    49350004
493600     MOVE PV-VER-NBR             TO RECEIV-PO-VER-NBR.            49360004
493700     MOVE ASC-KEY-OPER-UNT-ID-N  TO RECEIV-OPER-UNT-ID.           49370004
493800     MOVE ASC-KEY-FCLTY-ID-N     TO RECEIV-FCLTY-ID.              49380004
493900     MOVE 'IP'                   TO RECEIV-STATUS-CDE.            49390004
494000     MOVE 'I'                    TO RECEIV-SYST-CRE-CDE.          49400004
494100     MOVE 'MR'                   TO RECEIV-REC-TYP-CDE.           49410004
494200     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        49420004
494300     MOVE PV-PACK-BY-ST-IND      TO RECEIV-PACK-BY-ST-IND.        49430004
494400     MOVE PV-GARM-ON-HNGR-IND    TO RECEIV-GOH-IND.               49440004
494500     MOVE SHPTPO-EXPTED-CART-CNT TO RECEIV-EXPTED-CART-CNT.       49450004
494600     MOVE ZERO                   TO RECEIV-ACTL-CART-CNT.         49460004
494700     MOVE '9999-09-09'           TO RECEIV-AP-PRC-DTE.            49470004
494800     MOVE '9999-09-09-09.09.09.999999'                            49480004
494900                                 TO RECEIV-ML-POST-TMST           49490004
495000                                    RECEIV-MKNG-APRN-PRT-TMST     49500004
495100                                    RECEIV-FS-POST-TMST           49510004
495200                                    RECEIV-IN-TRBL-TMST           49520004
495300                                    RECEIV-VERFYD-TMST            49530004
495400                                    RECEIV-REC-TMST.              49540004
495500                                                                  49550004
495600     IF DK-TRIP-ID > 0                                            49560004
495700         PERFORM 5600-SELECT-TTRIPST                              49570004
495800                                                                  49580004
495900         IF TRSTYP-PRTY-CDE > PC-49                               49590004
496000             STRING TRIPST-STATUS-DTE DELIMITED BY SIZE,          49600004
496100                    '-' DELIMITED BY SIZE,                        49610004
496200                    TRIPST-STATUS-TME DELIMITED BY SIZE,          49620004
496300                    '.000000' DELIMITED BY SIZE                   49630004
496400                    INTO                RECEIV-REC-TMST           49640004
496500         END-IF                                                   49650004
496600     END-IF.                                                      49660004
496700                                                                  49670004
496800     MOVE DP020-LOCATION-NBR      TO RECEIV-CURR-OPER-UNT-ID.     49680004
496900     MOVE ASC-KEY-OPER-UNT-ID-N   TO RECEIV-CRE-OPER-UNT-ID.      49690004
497000     MOVE DP020-FCLTY-ID          TO RECEIV-CURR-FCLTY-ID.        49700004
497100     MOVE ASC-KEY-FCLTY-ID-N      TO RECEIV-CRE-FCLTY-ID.         49710004
497200     MOVE DP020-USERID            TO RECEIV-UPD-UID.              49720004
497300     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID.           49730004
497400                                                                  49740004
497500     MOVE PV-PRE-TICKET-IND      TO RECEIV-PRE-TKT-IND.           49750004
497600     MOVE SPACES                 TO RECEIV-RCVG-CLERK-INIT-ID.    49760004
497700                                                                  49770004
497800*    SET PS-RCVR-FOUND TO TRUE.                                   49780004
497900*    PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   49790004
498000*         PV-COUNT > 10 OR PS-NO-RCVR-FOUND                       49800004
498100         SET PS-NOT-EOF-TRECVER-CSR TO TRUE                       49810004
498200         PERFORM 5935-OPEN-TRECVER-CSR                            49820004
498300         PERFORM 5940-FETCH-TRECVER-CSR                           49830004
498400                                                                  49840004
498500         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       49850004
498600         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     49860004
498700                                       REMAINDER  PW-REMAINDER    49870004
498800         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      49880004
498900         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        49890004
499000         ADD +1                    TO RECVER-MAX-RCVR-NBR         49900004
499100         PERFORM 5945-DELETE-TRECVER-CSR                          49910004
499200         PERFORM 5950-INSERT-TRECVER                              49920004
499300         PERFORM 5955-CLOSE-TRECVER-CSR                           49930004
499400                                                                  49940004
499500         MOVE RECEIV-RCVR-NBR          TO DK-RCVR-NBR             49950004
499600                                                                  49960004
499700*        INITIALIZE PV-DB2-COUNT                                  49970004
499800*        PERFORM 5925-CHECK-DUPL-RCVR-NBR                         49980004
499900*    END-PERFORM.                                                 49990004
500000*    IF PS-RCVR-FOUND                                             50000004
500100*        SET PS-ERROR                                             50010004
500200*        DP020-MSG-FATAL       TO TRUE                            50020004
500300*        MOVE PC-TSYMSG-00117  TO DP020-MSG-NUMBER                50030004
500400*        SET DP030-SET-CURSOR-TRAILER                             50040004
500500*                              TO TRUE                            50050004
500600*    END-IF.                                                      50060004
500700                                                                  50070004
500800     PERFORM 5928-GET-PKGNG-CDE.                                  50080004
500900                                                                  50090004
501000     IF  PS-NO-ERROR                                              50100004
501100         PERFORM 5930-INSERT-TRECEIV                              50110004
501200         IF SQLCODE = ZERO                                        50120004
501300             PERFORM 5931-INSERT-TPOSYNC                          50130004
501400         END-IF                                                   50140004
501500         PERFORM 5960-CHECK-FOR-TROUBLE                           50150004
501600     END-IF.                                                      50160004
501700                                                                  50170004
501800/                                                                 50180004
501900*----------------------------------------------------------------*50190004
502000*    CHECK TO SEE IF RCVR NBR IS UNIQUE                          *50200004
502100*----------------------------------------------------------------*50210004
502200*5925-CHECK-DUPL-RCVR-NBR.                                        50220004
502300                                                                  50230004
502400*    PERFORM                                                      50240004
502500*        WITH TEST AFTER                                          50250004
502600*        VARYING PV-RETRY-COUNTER                                 50260004
502700*        FROM 1 BY 1                                              50270004
502800*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50280004
502900*            OR (SQLCODE = +0)                                    50290004
503000*            OR (SQLCODE = +100))                                 50300004
503100                                                                  50310004
503200*        EXEC SQL                                                 50320004
503300*             SELECT COUNT(*)                                     50330004
503400*               INTO :PV-DB2-COUNT                                50340004
503500*               FROM TRECEIV                                      50350004
503600*              WHERE RCVR_NBR = :DK-RCVR-NBR                      50360004
503700*        END-EXEC                                                 50370004
503800                                                                  50380004
503900*        EVALUATE TRUE                                            50390004
504000*            WHEN SQLCODE = +0                                    50400004
504100*            WHEN SQLCODE = +100                                  50410004
504200*            WHEN SQLCODE = -904                                  50420004
504300*            WHEN SQLCODE = -913                                  50430004
504400*                 CONTINUE                                        50440004
504500                                                                  50450004
504600*            WHEN SQLWARN0 NOT = SPACES                           50460004
504700*            WHEN SQLCODE < +0                                    50470004
504800*            WHEN SQLCODE > +0                                    50480004
504900*                 MOVE '5925-CHECK-DUPL-RCVR-NBR  '               50490004
505000*                                 TO DP013-PARAGRAPH              50500004
505100*                 MOVE 'UNSUCCESSFUL SELECT RCVR NBR '            50510004
505200*                                 TO DP013-MESSAGE-TEXT (1)       50520004
505300*                 MOVE SQLCA      TO DP013-SQLCA                  50530004
505400*                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     50540004
505500*                 SET DP013-DB2-ABEND                             50550004
505600*                     DP013-XCTL-DISPLAY-RESTART                  50560004
505700*                                 TO TRUE                         50570004
505800*                 PERFORM DP013-0000-PROCESS-ABEND                50580004
505900*        END-EVALUATE                                             50590004
506000*    END-PERFORM.                                                 50600004
506100                                                                  50610004
506200*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    50620004
506300*        SQLCODE NOT = ZERO                                       50630004
506400*        MOVE '5925-CHECK-DUPL-RCVR-NBR  '                        50640004
506500*                                 TO DP013-PARAGRAPH              50650004
506600*        MOVE 'MAX RETRIES EXCEEDED ON SELECT RCVR NBR '          50660004
506700*                                 TO DP013-MESSAGE-TEXT (1)       50670004
506800*        MOVE SQLCA               TO DP013-SQLCA                  50680004
506900*        MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     50690004
507000*        SET DP013-DB2-ABEND                                      50700004
507100*            DP013-XCTL-DISPLAY-RESTART                           50710004
507200*                                 TO TRUE                         50720004
507300*        PERFORM DP013-0000-PROCESS-ABEND                         50730004
507400*    END-IF.                                                      50740004
507500                                                                  50750004
507600*    IF SQLCODE = +0 AND                                          50760004
507700*       PV-DB2-COUNT = +0                                         50770004
507800*        SET PS-NO-RCVR-FOUND TO TRUE                             50780004
507900*    END-IF.                                                      50790004
508000                                                                  50800004
508100 5928-GET-PKGNG-CDE.                                              50810004
508200     PERFORM                                                      50820004
508300       WITH TEST AFTER                                            50830004
508400         VARYING PV-RETRY-COUNTER                                 50840004
508500           FROM 1 BY 1                                            50850004
508600             UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)           50860004
508700              OR (SQLCODE = +0)                                   50870004
508800              OR (SQLCODE = +100))                                50880004
508900                                                                  50890004
509000         EXEC SQL                                                 50900004
509100             SELECT PKGNG_CDE                                     50910004
509200               INTO :PURCHS-PKGNG-CDE                             50920004
509300               FROM TPURCHS A                                     50930004
509400              WHERE PO_NBR         = :DK-PO-NBR                   50940004
509500                AND VER_STATUS_CDE = 'A'                          50950004
509600         END-EXEC                                                 50960004
509700                                                                  50970004
509800         EVALUATE TRUE                                            50980004
509900             WHEN SQLCODE = +0                                    50990004
510000                 MOVE PURCHS-PKGNG-CDE TO RECEIV-PKGNG-CDE        51000004
510100                                                                  51010004
510200             WHEN SQLCODE = +100                                  51020004
510300             WHEN SQLCODE = -904                                  51030004
510400             WHEN SQLCODE = -913                                  51040004
510500                 CONTINUE                                         51050004
510600                                                                  51060004
510700             WHEN SQLWARN0 NOT = SPACES                           51070004
510800             WHEN SQLCODE < +0                                    51080004
510900             WHEN SQLCODE > +0                                    51090004
511000                 MOVE '5928-GET-PKGNG-CDE'                        51100004
511100                                  TO DP013-PARAGRAPH              51110004
511200                 MOVE 'UNSUCCESSFUL SELECT PKGNG-CDE'             51120004
511300                                 TO DP013-MESSAGE-TEXT (1)        51130004
511400                 MOVE SQLCA      TO DP013-SQLCA                   51140004
511500                 MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)      51150004
511600                 SET DP013-DB2-ABEND                              51160004
511700                     DP013-XCTL-DISPLAY-RESTART                   51170004
511800                                 TO TRUE                          51180004
511900                 PERFORM DP013-0000-PROCESS-ABEND                 51190004
512000         END-EVALUATE                                             51200004
512100     END-PERFORM.                                                 51210004
512200                                                                  51220004
512300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         51230004
512400             AND (SQLCODE = -904 OR -913)                         51240004
512500         MOVE '5928-GET-PKGNG-CDE'                                51250004
512600                                  TO DP013-PARAGRAPH              51260004
512700         MOVE 'MAX RETRIES EXCEEDED ON SELECT PKGNG-CDE'          51270004
512800                                  TO DP013-MESSAGE-TEXT (1)       51280004
512900         MOVE SQLCA               TO DP013-SQLCA                  51290004
513000         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     51300004
513100         SET DP013-DB2-ABEND                                      51310004
513200             DP013-XCTL-DISPLAY-RESTART                           51320004
513300                                  TO TRUE                         51330004
513400         PERFORM DP013-0000-PROCESS-ABEND                         51340004
513500     END-IF.                                                      51350004
513600                                                                  51360004
513700 5930-INSERT-TRECEIV.                                             51370004
513800                                                                  51380004
513900     PERFORM                                                      51390004
514000         WITH TEST AFTER                                          51400004
514100         VARYING PV-RETRY-COUNTER                                 51410004
514200         FROM 1 BY 1                                              51420004
514300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               51430004
514400             OR (SQLCODE = +0))                                   51440004
514500                                                                  51450004
514600         EXEC SQL                                                 51460004
514700              INSERT INTO TRECEIV                                 51470004
514800                     ( ORD_NBR                                    51480004
514900                      ,REC_SEQ_NBR                                51490004
515000                      ,CRE_TMST                                   51500004
515100                      ,CRE_UID                                    51510004
515200                      ,PO_VER_NBR                                 51520004
515300                      ,OPER_UNT_ID                                51530004
515400                      ,FCLTY_ID                                   51540004
515500                      ,STATUS_CDE                                 51550004
515600                      ,SYST_CRE_CDE                               51560004
515700                      ,REC_TYP_CDE                                51570004
515800                      ,VER_STATUS_CDE                             51580004
515900                      ,PACK_BY_ST_IND                             51590004
516000                      ,REC_TMST                                   51600004
516100                      ,EXPTED_CART_CNT                            51610004
516200                      ,ACTL_CART_CNT                              51620004
516300                      ,EXPTED_ITM_QTY                             51630004
516400                      ,ACTL_ITM_QTY                               51640004
516500                      ,RCVR_NBR                                   51650004
516600                      ,ML_POST_TMST                               51660004
516700                      ,FS_POST_TMST                               51670004
516800                      ,PRE_TKT_IND                                51680004
516900                      ,AD_INFO_DESC                               51690004
517000                      ,IN_TRBL_TMST                               51700004
517100                      ,IN_TRBL_MIN_CNT                            51710004
517200                      ,IN_TRBL_HOUR_CNT                           51720004
517300                      ,VERFYD_TMST                                51730004
517400                      ,RCVG_CLERK_INIT_ID                         51740004
517500                      ,REFER_BACK_SEQ_NBR                         51750004
517600                      ,AP_PRC_CDE                                 51760004
517700                      ,AP_PRC_DTE                                 51770004
517800                      ,MIS_DIRECT_IND                             51780004
517900                      ,IMPRT_IND                                  51790004
518000                      ,CRE_OPER_UNT_ID                            51800004
518100                      ,CRE_FCLTY_ID                               51810004
518200                      ,CURR_OPER_UNT_ID                           51820004
518300                      ,CURR_FCLTY_ID                              51830004
518400                      ,UPD_TMST                                   51840004
518500                      ,UPD_UID                                    51850004
518600                      ,UPD_PGM_ID                                 51860004
518700                      ,GOH_IND                                    51870004
518800                      ,MKNG_APRN_PRT_TMST                         51880004
518900                      ,AP_RVRSL_DTE                               51890004
519000                      ,PKGNG_CDE                                  51900004
519100                      )                                           51910004
519200             VALUES ( :RECEIV-ORD-NBR                             51920004
519300                     ,:RECEIV-REC-SEQ-NBR                         51930004
519400                     ,CURRENT TIMESTAMP                           51940004
519500                     ,:DP020-USERID                               51950004
519600                     ,:RECEIV-PO-VER-NBR                          51960004
519700                     ,:RECEIV-OPER-UNT-ID                         51970004
519800                     ,:RECEIV-FCLTY-ID                            51980004
519900                     ,:RECEIV-STATUS-CDE                          51990004
520000                     ,:RECEIV-SYST-CRE-CDE                        52000004
520100                     ,:RECEIV-REC-TYP-CDE                         52010004
520200                     ,:RECEIV-VER-STATUS-CDE                      52020004
520300                     ,:RECEIV-PACK-BY-ST-IND                      52030004
520400                     ,:RECEIV-REC-TMST                            52040004
520500                     ,:RECEIV-EXPTED-CART-CNT                     52050004
520600                     ,:RECEIV-ACTL-CART-CNT                       52060004
520700                     ,:RECEIV-EXPTED-ITM-QTY                      52070004
520800                     ,:RECEIV-ACTL-ITM-QTY                        52080004
520900                     ,:RECEIV-RCVR-NBR                            52090004
521000                     ,:RECEIV-ML-POST-TMST                        52100004
521100                     ,:RECEIV-FS-POST-TMST                        52110004
521200                     ,:RECEIV-PRE-TKT-IND                         52120004
521300                     ,:RECEIV-AD-INFO-DESC                        52130004
521400                     ,:RECEIV-IN-TRBL-TMST                        52140004
521500                     ,:RECEIV-IN-TRBL-MIN-CNT                     52150004
521600                     ,:RECEIV-IN-TRBL-HOUR-CNT                    52160004
521700                     ,:RECEIV-VERFYD-TMST                         52170004
521800                     ,:RECEIV-RCVG-CLERK-INIT-ID                  52180004
521900                     ,:RECEIV-REFER-BACK-SEQ-NBR                  52190004
522000                     ,:RECEIV-AP-PRC-CDE                          52200004
522100                     ,:RECEIV-AP-PRC-DTE                          52210004
522200                     ,:RECEIV-MIS-DIRECT-IND                      52220004
522300                     ,:RECEIV-IMPRT-IND                           52230004
522400                     ,:RECEIV-CRE-OPER-UNT-ID                     52240004
522500                     ,:RECEIV-CRE-FCLTY-ID                        52250004
522600                     ,:RECEIV-CURR-OPER-UNT-ID                    52260004
522700                     ,:RECEIV-CURR-FCLTY-ID                       52270004
522800                     ,CURRENT TIMESTAMP                           52280004
522900                     ,:RECEIV-UPD-UID                             52290004
523000                     ,:RECEIV-UPD-PGM-ID                          52300004
523100                     ,:RECEIV-GOH-IND                             52310004
523200                     ,:RECEIV-MKNG-APRN-PRT-TMST                  52320004
523300                     ,:PC-DEFAULT-9DATE                           52330004
523400                     ,:RECEIV-PKGNG-CDE                           52340004
523500                     )                                            52350004
523600         END-EXEC                                                 52360004
523700                                                                  52370004
523800         EVALUATE TRUE                                            52380004
523900             WHEN SQLCODE = +0                                    52390004
524000             WHEN SQLCODE = -904                                  52400004
524100             WHEN SQLCODE = -913                                  52410004
524200                 CONTINUE                                         52420004
524300                                                                  52430004
524400             WHEN SQLWARN0 NOT = SPACE                            52440004
524500             WHEN SQLCODE < +0                                    52450004
524600             WHEN SQLCODE > +0                                    52460004
524700                 MOVE '5930-INSERT-TRECEIV'                       52470004
524800                                 TO DP013-PARAGRAPH               52480004
524900                 MOVE 'INSERT ON RECEIPTS TABLE'                  52490004
525000                                 TO DP013-MESSAGE-TEXT (1)        52500004
525100                 MOVE SQLCA      TO DP013-SQLCA                   52510004
525200                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      52520004
525300                     SET DP013-DB2-ABEND                          52530004
525400                         DP013-XCTL-DISPLAY-RESTART               52540004
525500                                     TO TRUE                      52550004
525600                 PERFORM DP013-0000-PROCESS-ABEND                 52560004
525700         END-EVALUATE                                             52570004
525800     END-PERFORM.                                                 52580004
525900                                                                  52590004
526000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    52600004
526100         SQLCODE NOT = ZERO                                       52610004
526200         MOVE '5930-INSERT-TRECEIV'                               52620004
526300                                  TO DP013-PARAGRAPH              52630004
526400         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TRECEIV'         52640004
526500                                  TO DP013-MESSAGE-TEXT (1)       52650004
526600         MOVE SQLCA               TO DP013-SQLCA                  52660004
526700         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     52670004
526800         SET DP013-DB2-ABEND                                      52680004
526900             DP013-XCTL-DISPLAY-RESTART                           52690004
527000                                  TO TRUE                         52700004
527100         PERFORM DP013-0000-PROCESS-ABEND                         52710004
527200     END-IF.                                                      52720004
527300/                                                                 52730004
527400 5931-INSERT-TPOSYNC.                                             52740004
527500     EXEC SQL                                                     52750004
527600         INSERT INTO TPOSYNC                                      52760004
527700           ( PO_NBR                                               52770004
527800            ,LAST_SYNC_TMST                                       52780004
527900            ,SYNC_STAT_CDE                                        52790004
528000           )                                                      52800004
528100         VALUES                                                   52810004
528200           ( :RECEIV-ORD-NBR                                      52820004
528300           , CURRENT TIMESTAMP                                    52830004
528400           , 'N'                                                  52840004
528500           )                                                      52850004
528600     END-EXEC                                                     52860004
528700                                                                  52870004
528800     EVALUATE TRUE                                                52880004
528900         WHEN SQLCODE = ZERO                                      52890004
529000         WHEN SQLCODE = -803                                      52900004
529100                 CONTINUE                                         52910004
529200         WHEN SQLCODE = -904                                      52920004
529300         WHEN SQLCODE = -913                                      52930004
529400         WHEN SQLCODE = -911                                      52940004
529500         MOVE '5931-INSERT-TPOSYNC'                               52950004
529600                                 TO DP013-PARAGRAPH               52960004
529700         MOVE 'DB2 TIMEOUT ON INSERT ON TPOSYNC'                  52970004
529800                                  TO DP013-MESSAGE-TEXT (1)       52980004
529900         MOVE SQLCA               TO DP013-SQLCA                  52990004
530000         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     53000004
530100         SET DP013-DB2-ABEND                                      53010004
530200             DP013-XCTL-DISPLAY-RESTART                           53020004
530300                                  TO TRUE                         53030004
530400         PERFORM DP013-0000-PROCESS-ABEND                         53040004
530500                                                                  53050004
530600         WHEN SQLWARN0 NOT = SPACE                                53060004
530700         WHEN SQLCODE < ZERO                                      53070004
530800         WHEN SQLCODE > ZERO                                      53080004
530900             MOVE '5931-INSERT-TPOSYNC'                           53090004
531000                                 TO DP013-PARAGRAPH               53100004
531100             MOVE 'INSERT ON POSYNC TABLE'                        53110004
531200                                 TO DP013-MESSAGE-TEXT (1)        53120004
531300             MOVE SQLCA      TO DP013-SQLCA                       53130004
531400             MOVE 'TPOSYNC'  TO DP013-DB2-TABLE-NAME (1)          53140004
531500             SET DP013-DB2-ABEND                                  53150004
531600                 DP013-XCTL-DISPLAY-RESTART                       53160004
531700                                     TO TRUE                      53170004
531800             PERFORM DP013-0000-PROCESS-ABEND                     53180004
531900     END-EVALUATE.                                                53190004
532000/                                                                 53200004
532100/                                                                 53210004
532200*----------------------------------------------------------------*53220004
532300* OPEN THE TRECVER CURSOR                                        *53230004
532400*----------------------------------------------------------------*53240004
532500                                                                  53250004
532600 5935-OPEN-TRECVER-CSR.                                           53260004
532700                                                                  53270004
532800     EXEC SQL                                                     53280004
532900          DECLARE TRECVER-CSR CURSOR FOR                          53290004
533000           SELECT MAX_RCVR_NBR                                    53300004
533100           FROM   TRECVER                                         53310004
533200           WHERE  OPERCO_NBR = '03'                               53320004
533300           FOR UPDATE OF MAX_RCVR_NBR                             53330004
533400     END-EXEC.                                                    53340004
533500                                                                  53350004
533600     PERFORM                                                      53360004
533700         WITH TEST AFTER                                          53370004
533800         VARYING PV-RETRY-COUNTER                                 53380004
533900         FROM 1 BY 1                                              53390004
534000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               53400004
534100            OR (SQLCODE = +0))                                    53410004
534200                                                                  53420004
534300         EXEC SQL                                                 53430004
534400              OPEN TRECVER-CSR                                    53440004
534500         END-EXEC                                                 53450004
534600                                                                  53460004
534700         EVALUATE TRUE                                            53470004
534800             WHEN SQLCODE = +0                                    53480004
534900                  CONTINUE                                        53490004
535000             WHEN SQLCODE = -904                                  53500004
535100             WHEN SQLCODE = -913                                  53510004
535200                  CONTINUE                                        53520004
535300             WHEN SQLWARN0 NOT = SPACE                            53530004
535400             WHEN SQLCODE  NOT = +0                               53540004
535500                  MOVE '5935-OPEN-TRECVER-CSR'                    53550004
535600                                   TO DP013-PARAGRAPH             53560004
535700                  MOVE 'OPEN TRECVER CURSOR'                      53570004
535800                                   TO DP013-MESSAGE-TEXT (1)      53580004
535900                  MOVE SQLCA       TO DP013-SQLCA                 53590004
536000                  MOVE 'TRECVER'   TO DP013-DB2-TABLE-NAME (1)    53600004
536100                  SET DP013-DB2-ABEND                             53610004
536200                                   TO TRUE                        53620004
536300                  PERFORM DP013-0000-PROCESS-ABEND                53630004
536400         END-EVALUATE                                             53640004
536500     END-PERFORM.                                                 53650004
536600                                                                  53660004
536700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    53670004
536800         SQLCODE NOT = ZERO                                       53680004
536900         MOVE '5935-OPEN-TRECVER-CSR' TO DP013-PARAGRAPH          53690004
537000         MOVE 'MAX RETRIES EXCEEDED FOR OPEN TRECVER CURSOR'      53700004
537100                                   TO DP013-MESSAGE-TEXT (1)      53710004
537200         MOVE SQLCA                TO DP013-SQLCA                 53720004
537300         SET DP013-DB2-ABEND       TO TRUE                        53730004
537400         PERFORM DP013-0000-PROCESS-ABEND                         53740004
537500     END-IF.                                                      53750004
537600                                                                  53760004
537700/                                                                 53770004
537800*----------------------------------------------------------------*53780004
537900*    FETCH A TRECVER ROW                                         *53790004
538000*----------------------------------------------------------------*53800004
538100                                                                  53810004
538200 5940-FETCH-TRECVER-CSR.                                          53820004
538300                                                                  53830004
538400     EXEC SQL                                                     53840004
538500          FETCH TRECVER-CSR                                       53850004
538600          INTO :RECVER-MAX-RCVR-NBR                               53860004
538700     END-EXEC                                                     53870004
538800                                                                  53880004
538900     EVALUATE TRUE                                                53890004
539000         WHEN SQLCODE = +0                                        53900004
539100              CONTINUE                                            53910004
539200                                                                  53920004
539300         WHEN SQLCODE = +100                                      53930004
539400              SET PS-EOF-TRECVER-CSR TO TRUE                      53940004
539500                                                                  53950004
539600         WHEN SQLWARN0 NOT = SPACE                                53960004
539700         WHEN SQLCODE < +0                                        53970004
539800         WHEN SQLCODE > +0                                        53980004
539900              MOVE '5940-FETCH-TRECVER-CSR'                       53990004
540000                                   TO DP013-PARAGRAPH             54000004
540100              MOVE 'FETCH TRECVER CURSOR'                         54010004
540200                                   TO DP013-MESSAGE-TEXT (1)      54020004
540300              MOVE SQLCA           TO DP013-SQLCA                 54030004
540400              MOVE 'TRECVER'       TO DP013-DB2-TABLE-NAME (1)    54040004
540500              SET DP013-DB2-ABEND  TO TRUE                        54050004
540600              PERFORM DP013-0000-PROCESS-ABEND                    54060004
540700     END-EVALUATE.                                                54070004
540800                                                                  54080004
540900/                                                                 54090004
541000*----------------------------------------------------------------*54100004
541100*    UDPATE CURRENT CURSOR                                       *54110004
541200*----------------------------------------------------------------*54120004
541300                                                                  54130004
541400 5945-DELETE-TRECVER-CSR.                                         54140004
541500                                                                  54150004
541600     EXEC SQL                                                     54160004
541700          DELETE FROM TRECVER                                     54170004
541800            WHERE CURRENT OF TRECVER-CSR                          54180004
541900     END-EXEC                                                     54190004
542000                                                                  54200004
542100     EVALUATE TRUE                                                54210004
542200         WHEN SQLCODE = +0                                        54220004
542300              CONTINUE                                            54230004
542400                                                                  54240004
542500         WHEN SQLWARN0 NOT = SPACE                                54250004
542600         WHEN SQLCODE < +0                                        54260004
542700         WHEN SQLCODE > +0                                        54270004
542800              MOVE '5945-DELETE-TRECVER-CSR'                      54280004
542900                                   TO DP013-PARAGRAPH             54290004
543000              MOVE 'DELETE TRECVER CURSOR'                        54300004
543100                                   TO DP013-MESSAGE-TEXT (1)      54310004
543200              MOVE SQLCA           TO DP013-SQLCA                 54320004
543300              MOVE 'TRECVER'       TO DP013-DB2-TABLE-NAME (1)    54330004
543400              SET DP013-DB2-ABEND  TO TRUE                        54340004
543500              PERFORM DP013-0000-PROCESS-ABEND                    54350004
543600     END-EVALUATE.                                                54360004
543700                                                                  54370004
543800/                                                                 54380004
543900*----------------------------------------------------------------*54390004
544000* INSERT THE TRECVER ROW                                         *54400004
544100*----------------------------------------------------------------*54410004
544200                                                                  54420004
544300 5950-INSERT-TRECVER.                                             54430004
544400                                                                  54440004
544500     PERFORM                                                      54450004
544600         WITH TEST AFTER                                          54460004
544700         VARYING PV-RETRY-COUNTER                                 54470004
544800         FROM 1 BY 1                                              54480004
544900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               54490004
545000             OR (SQLCODE = +0))                                   54500004
545100                                                                  54510004
545200         EXEC SQL                                                 54520004
545300              INSERT INTO TRECVER                                 54530004
545400                     ( OPERCO_NBR                                 54540004
545500                      ,MAX_RCVR_NBR )                             54550004
545600              VALUES ( '03'                                       54560004
545700                      ,:RECVER-MAX-RCVR-NBR )                     54570004
545800         END-EXEC                                                 54580004
545900                                                                  54590004
546000         EVALUATE TRUE                                            54600004
546100             WHEN SQLCODE = +0                                    54610004
546200             WHEN SQLCODE = -904                                  54620004
546300             WHEN SQLCODE = -913                                  54630004
546400                 CONTINUE                                         54640004
546500                                                                  54650004
546600             WHEN SQLWARN0 NOT = SPACE                            54660004
546700             WHEN SQLCODE < +0                                    54670004
546800             WHEN SQLCODE > +0                                    54680004
546900                 MOVE '5315-INSERT-TRECVER'                       54690004
547000                                 TO DP013-PARAGRAPH               54700004
547100                 MOVE 'INSERT ON TRECVER TABLE   '                54710004
547200                                 TO DP013-MESSAGE-TEXT (1)        54720004
547300                 MOVE SQLCA      TO DP013-SQLCA                   54730004
547400                 MOVE 'TRECVER'  TO DP013-DB2-TABLE-NAME (1)      54740004
547500                     SET DP013-DB2-ABEND                          54750004
547600                         DP013-XCTL-DISPLAY-RESTART               54760004
547700                                     TO TRUE                      54770004
547800                 PERFORM DP013-0000-PROCESS-ABEND                 54780004
547900         END-EVALUATE                                             54790004
548000     END-PERFORM.                                                 54800004
548100                                                                  54810004
548200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    54820004
548300         SQLCODE NOT = ZERO                                       54830004
548400         MOVE '5315-INSERT-TRECVER'                               54840004
548500                                  TO DP013-PARAGRAPH              54850004
548600         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TRECVER'         54860004
548700                                  TO DP013-MESSAGE-TEXT (1)       54870004
548800         MOVE SQLCA               TO DP013-SQLCA                  54880004
548900         MOVE 'TRECVER '          TO DP013-DB2-TABLE-NAME (1)     54890004
549000         SET DP013-DB2-ABEND                                      54900004
549100             DP013-XCTL-DISPLAY-RESTART                           54910004
549200                                  TO TRUE                         54920004
549300         PERFORM DP013-0000-PROCESS-ABEND                         54930004
549400     END-IF.                                                      54940004
549500                                                                  54950004
549600/                                                                 54960004
549700*----------------------------------------------------------------*54970004
549800* CLOSE THE TRECVER CURSOR                                       *54980004
549900*----------------------------------------------------------------*54990004
550000                                                                  55000004
550100 5955-CLOSE-TRECVER-CSR.                                          55010004
550200                                                                  55020004
550300     EXEC SQL                                                     55030004
550400          CLOSE TRECVER-CSR                                       55040004
550500     END-EXEC                                                     55050004
550600                                                                  55060004
550700     EVALUATE TRUE                                                55070004
550800         WHEN SQLCODE = +0                                        55080004
550900              CONTINUE                                            55090004
551000         WHEN SQLWARN0 NOT = SPACE                                55100004
551100         WHEN SQLCODE  NOT = +0                                   55110004
551200              MOVE '5955-CLOSE-TRECVER-CSR'                       55120004
551300                                   TO DP013-PARAGRAPH             55130004
551400              MOVE 'CLOSE TRECVER CURSOR'                         55140004
551500                                   TO DP013-MESSAGE-TEXT (1)      55150004
551600              MOVE SQLCA           TO DP013-SQLCA                 55160004
551700              MOVE 'TRECVER'       TO DP013-DB2-TABLE-NAME (1)    55170004
551800              SET DP013-DB2-ABEND  TO TRUE                        55180004
551900              PERFORM DP013-0000-PROCESS-ABEND                    55190004
552000     END-EVALUATE.                                                55200004
552100                                                                  55210004
552200/                                                                 55220004
552300 5960-CHECK-FOR-TROUBLE.                                          55230004
552400                                                                  55240004
552500     INITIALIZE TM500-FIELDS.                                     55250004
552600                                                                  55260004
552700     SET  TM500-CREATE-AUTO        TO TRUE.                       55270004
552800     SET  TM500-PO-LEVEL           TO TRUE.                       55280004
552900     SET  TM500-NO-DETAILS         TO TRUE.                       55290004
553000                                                                  55300004
553100     MOVE RECEIV-ORD-NBR           TO TM500-PO-NBR.               55310004
553200     MOVE RECEIV-OPER-UNT-ID       TO TM500-OPER-UNT-ID.          55320004
553300     MOVE RECEIV-FCLTY-ID          TO TM500-FCLTY-ID.             55330004
553400     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            55340004
553500     PERFORM 5901-GET-SHIPMT-INFO.                                55350004
553600     MOVE SHIPMT-VEND-SHIP-DTE     TO PV-VEND-SHIP-DTE.           55360004
553700     IF PV-VEND-SHIP-DTE = '0001-01-01'                           55370004
553800         MOVE SPACES               TO TM500-VEND-SHIP-DTE         55380004
553900     ELSE                                                         55390004
554000        MOVE PV-VEND-SHIP-DTE      TO DPG52-LK-DATE-INPUT         55400004
554100        INITIALIZE DPG51                                          55410004
554200        SET DPG51-ACTUAL-CALENDAR-ONLY                            55420004
554300            DPG51-DO-NOT-INCR-DECR-DATE                           55430004
554400            DPG52-LK-DTE-ISO-FMT TO TRUE                          55440004
554500        CALL PC-DPKUT500 USING DPG51 DPG52 DPG53                  55450004
554600                               DPG54 DPG55 DPG56                  55460004
554700        IF (DPG54-DATE-INVALID                                    55470004
554800        OR  DPG54-SEVERE-ERROR)                                   55480004
554900            SET PS-ERROR                                          55490004
555000                DP020-MSG-FATAL    TO TRUE                        55500004
555100            MOVE PC-TSYMSG-00009   TO DP020-MSG-NUMBER            55510004
555200        ELSE                                                      55520004
555300            MOVE DPG55-DB2-ISO-DATE-FMT                           55530004
555400                                   TO TM500-VEND-SHIP-DTE         55540004
555500     END-IF.                                                      55550004
555600     MOVE RECEIV-REC-SEQ-NBR       TO TM500-REC-SEQ-NBR.          55560004
555700                                                                  55570004
555800     EXEC CICS                                                    55580004
555900         LINK PROGRAM  (PC-TROUBLE-RTN)                           55590004
556000              COMMAREA (TM500-FIELDS)                             55600004
556100              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    55610004
556200     END-EXEC.                                                    55620004
556300                                                                  55630004
556400     IF TM500-CALL-SUCCESSFUL        OR                           55640004
556500        TM500-TPURCHS-SELECT-NOT-FND OR                           55650004
556600        TM500-DUPLICATE-TROUBLE      OR                           55660004
556700        TM500-TTRBNTF-UPDATE-NOT-FND                              55670004
556800         CONTINUE                                                 55680004
556900     ELSE                                                         55690004
557000         MOVE '5960-CHECK-FOR-TROUBLE '                           55700004
557100                         TO DP013-PARAGRAPH                       55710004
557200         MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'                  55720004
557300                         TO DP013-MESSAGE-TEXT (1)                55730004
557400         MOVE TM500-RETURN-MSG                                    55740004
557500                         TO DP013-MESSAGE-TEXT (2)                55750004
557600         MOVE TM500-SQLCA                                         55760004
557700                         TO DP013-SQLCA                           55770004
557800         SET DP013-DB2-ABEND                                      55780004
557900             DP013-XCTL-DISPLAY-RESTART                           55790004
558000                         TO TRUE                                  55800004
558100         PERFORM DP013-0000-PROCESS-ABEND                         55810004
558200     END-IF.                                                      55820004
558300                                                                  55830004
558400/                                                                 55840004
558500 5965-BUILD-ZERO-LINE-WORK-ORD.                                   55850004
558600                                                                  55860004
558700     INITIALIZE DCLTWRKORD.                                       55870004
558800                                                                  55880004
558900     MOVE SHPTPO-PO-NBR          TO WRKORD-ORD-NBR.               55890004
559000     MOVE PV-REC-SEQ-NBR         TO WRKORD-RCVR-SEQ-NBR.          55900004
559100     MOVE ASC-KEY-OPER-UNT-ID-N  TO WRKORD-OPER-UNT-ID.           55910004
559200     MOVE ASC-KEY-FCLTY-ID-N     TO WRKORD-FCLTY-ID.              55920004
559300     MOVE +1                     TO WRKORD-WORK-ORD-SEQ-NBR.      55930004
559400     MOVE ZERO                   TO WRKORD-ACTL-CART-CNT.         55940004
559500     MOVE SHPTPO-EXPTED-CART-CNT TO WRKORD-EXPTED-CART-CNT.       55950004
559600     MOVE 'A'                    TO WRKORD-VER-STATUS-CDE.        55960004
559700     MOVE 'IP'                   TO WRKORD-STAT-CDE.              55970004
559800     MOVE 'N'                    TO WRKORD-WORK-ORD-DISTR-IND.    55980004
559900     PERFORM 5994-GET-OPER-SET-INFO.                              55990004
560000     IF  SQLCODE = +0                                             56000004
560100         MOVE DCFAAS-OPER-SET-ID   TO DK-OPER-SET-ID              56010004
560200     ELSE                                                         56020004
560300         PERFORM 5967-GET-OPER-SET-ID                             56030004
560400         MOVE  COCNTL-DFLT-OPER-SET-ID  TO  DK-OPER-SET-ID        56040004
560500         PERFORM 5995-VALIDATE-OPER-SET-ID                        56050004
560600     END-IF.                                                      56060004
560700     MOVE DK-OPER-SET-ID         TO WRKORD-OPER-SET-ID.           56070004
560800                                                                  56080004
560900     PERFORM 5970-INACTIVATE-TWRKORD.                             56090004
561000     PERFORM 5975-INSERT-TWRKORD.                                 56100004
561100                                                                  56110004
561200     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR.          56120004
561300     MOVE 'N'                    TO PS-TOSOPFA-CURSOR-SW.         56130004
561400     MOVE 'Y'                    TO PS-INSTRUCTION-SW.            56140004
561500                                                                  56150004
561600                                                                  56160004
561700     PERFORM 5980-OPEN-TOSOPFA-CSR.                               56170004
561800     PERFORM 5985-FETCH-TOSOPFA-CSR.                              56180004
561900                                                                  56190004
562000     PERFORM UNTIL PS-EOF-TOSOPFA-CSR                             56200004
562100        PERFORM 5991-BUILD-WORK-ORDER-INSTR                       56210004
562200        PERFORM 5985-FETCH-TOSOPFA-CSR                            56220004
562300     END-PERFORM.                                                 56230004
562400                                                                  56240004
562500     PERFORM 5990-CLOSE-TOSOPFA-CSR.                              56250004
562600                                                                  56260004
562700                                                                  56270004
562800*----------------------------------------------------------------*56280004
562900*  GET OPER-SET-ID FROM TCOCNTL                                  *56290004
563000*----------------------------------------------------------------*56300004
563100 5967-GET-OPER-SET-ID.                                            56310004
563200                                                                  56320004
563300     EXEC SQL                                                     56330004
563400          SELECT  DFLT_OPER_SET_ID                                56340004
563500            INTO :COCNTL-DFLT-OPER-SET-ID                         56350004
563600            FROM  TCOCNTL                                         56360004
563700           WHERE  OPER_UNT_ID    = :DK-OPER-UNT-ID                56370004
563800             AND  FCLTY_ID       = :DK-FCLTY-ID                   56380004
563900     END-EXEC.                                                    56390004
564000                                                                  56400004
564100     EVALUATE TRUE                                                56410004
564200         WHEN SQLCODE = +0                                        56420004
564300              CONTINUE                                            56430004
564400                                                                  56440004
564500         WHEN SQLCODE = +100                                      56450004
564600              MOVE  ZEROES  TO  COCNTL-DFLT-OPER-SET-ID           56460004
564700                                                                  56470004
564800         WHEN SQLWARN0 NOT = SPACES                               56480004
564900         WHEN SQLCODE < +0                                        56490004
565000         WHEN SQLCODE > +0                                        56500004
565100              MOVE '5967-GET-OPER-SET-ID'                         56510004
565200                                       TO DP013-PARAGRAPH         56520004
565300              MOVE 'SELECT OPERATION SET ID FROM TCOCNTL'         56530004
565400                                       TO DP013-MESSAGE-TEXT(1)   56540004
565500              MOVE SQLCA               TO DP013-SQLCA             56550004
565600              MOVE 'TCOCNTL'           TO DP013-DB2-TABLE-NAME(1) 56560004
565700              SET DP013-DB2-ABEND      TO TRUE                    56570004
565800              SET DP013-XCTL-DISPLAY-RESTART                      56580004
565900                                       TO TRUE                    56590004
566000              PERFORM DP013-0000-PROCESS-ABEND                    56600004
566100     END-EVALUATE.                                                56610004
566200                                                                  56620004
566300                                                                  56630004
566400*----------------------------------------------------------------*56640004
566500*                                                                *56650004
566600*----------------------------------------------------------------*56660004
566700 5970-INACTIVATE-TWRKORD.                                         56670004
566800                                                                  56680004
566900         EXEC SQL                                                 56690004
567000           UPDATE TWRKORD                                         56700004
567100              SET VER_STATUS_CDE   =  :PC-I                       56710004
567200           WHERE                                                  56720004
567300                 ORD_NBR           = :WRKORD-ORD-NBR              56730004
567400            AND  RCVR_SEQ_NBR      = :WRKORD-RCVR-SEQ-NBR         56740004
567500            AND  ORD_LNE_NBR       = :WRKORD-ORD-LNE-NBR          56750004
567600            AND  WORK_ORD_SEQ_NBR  = :WRKORD-WORK-ORD-SEQ-NBR     56760004
567700            AND  OPER_UNT_ID       = :WRKORD-OPER-UNT-ID          56770004
567800            AND  FCLTY_ID          = :WRKORD-FCLTY-ID             56780004
567900         END-EXEC.                                                56790004
568000                                                                  56800004
568100         EVALUATE TRUE                                            56810004
568200             WHEN SQLCODE = +0                                    56820004
568300             WHEN SQLCODE = +100                                  56830004
568400                 CONTINUE                                         56840004
568500                                                                  56850004
568600             WHEN SQLWARN0 NOT = SPACES                           56860004
568700             WHEN SQLCODE < +0                                    56870004
568800             WHEN SQLCODE > +0                                    56880004
568900                 MOVE '5970-INACTIVATE-TWRKORD'                   56890004
569000                                   TO DP013-PARAGRAPH             56900004
569100                 MOVE 'UPDATE VER STATUS CODE ON TWRKORD'         56910004
569200                                   TO DP013-MESSAGE-TEXT(1)       56920004
569300                 MOVE SQLCA        TO DP013-SQLCA                 56930004
569400                 MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)    56940004
569500                 SET DP013-DB2-ABEND                              56950004
569600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           56960004
569700                 PERFORM DP013-0000-PROCESS-ABEND                 56970004
569800         END-EVALUATE.                                            56980004
569900/                                                                 56990004
570000 5975-INSERT-TWRKORD.                                             57000004
570100                                                                  57010004
570200     PERFORM                                                      57020004
570300         WITH TEST AFTER                                          57030004
570400         VARYING PV-RETRY-COUNTER                                 57040004
570500         FROM 1 BY 1                                              57050004
570600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               57060004
570700             OR (SQLCODE = +0))                                   57070004
570800                                                                  57080004
570900         EXEC SQL                                                 57090004
571000              INSERT INTO TWRKORD                                 57100004
571100                     ( ORD_NBR                                    57110004
571200                      ,RCVR_SEQ_NBR                               57120004
571300                      ,ORD_LNE_NBR                                57130004
571400                      ,WORK_ORD_SEQ_NBR                           57140004
571500                      ,OPER_UNT_ID                                57150004
571600                      ,FCLTY_ID                                   57160004
571700                      ,CRE_TMST                                   57170004
571800                      ,VER_STATUS_CDE                             57180004
571900                      ,CRE_UID_ID                                 57190004
572000                      ,EXPTED_CART_CNT                            57200004
572100                      ,ACTL_CART_CNT                              57210004
572200                      ,EXPTED_ITM_CNT                             57220004
572300                      ,ACTL_ITM_CNT                               57230004
572400                      ,STAT_CDE                                   57240004
572500                      ,WORK_ORD_DISTR_IND                         57250004
572600                      ,OPER_SET_ID )                              57260004
572700              VALUES ( :WRKORD-ORD-NBR                            57270004
572800                      ,:WRKORD-RCVR-SEQ-NBR                       57280004
572900                      ,:WRKORD-ORD-LNE-NBR                        57290004
573000                      ,:WRKORD-WORK-ORD-SEQ-NBR                   57300004
573100                      ,:WRKORD-OPER-UNT-ID                        57310004
573200                      ,:WRKORD-FCLTY-ID                           57320004
573300                      ,CURRENT TIMESTAMP                          57330004
573400                      ,:WRKORD-VER-STATUS-CDE                     57340004
573500                      ,:DP020-USERID                              57350004
573600                      ,:WRKORD-EXPTED-CART-CNT                    57360004
573700                      ,:WRKORD-ACTL-CART-CNT                      57370004
573800                      ,:WRKORD-EXPTED-ITM-CNT                     57380004
573900                      ,:WRKORD-ACTL-ITM-CNT                       57390004
574000                      ,:WRKORD-STAT-CDE                           57400004
574100                      ,:WRKORD-WORK-ORD-DISTR-IND                 57410004
574200                      ,:WRKORD-OPER-SET-ID )                      57420004
574300         END-EXEC                                                 57430004
574400                                                                  57440004
574500         EVALUATE TRUE                                            57450004
574600             WHEN SQLCODE = +0                                    57460004
574700             WHEN SQLCODE = -904                                  57470004
574800             WHEN SQLCODE = -913                                  57480004
574900                 CONTINUE                                         57490004
575000                                                                  57500004
575100             WHEN SQLWARN0 NOT = SPACE                            57510004
575200             WHEN SQLCODE < +0                                    57520004
575300             WHEN SQLCODE > +0                                    57530004
575400                 MOVE '5975-INSERT-TWRKORD'                       57540004
575500                                 TO DP013-PARAGRAPH               57550004
575600                 MOVE 'INSERT ON WORK ORDER TABLE'                57560004
575700                                 TO DP013-MESSAGE-TEXT (1)        57570004
575800                 MOVE SQLCA      TO DP013-SQLCA                   57580004
575900                 MOVE 'TWRKORD'  TO DP013-DB2-TABLE-NAME (1)      57590004
576000                     SET DP013-DB2-ABEND                          57600004
576100                         DP013-XCTL-DISPLAY-RESTART               57610004
576200                                     TO TRUE                      57620004
576300                 PERFORM DP013-0000-PROCESS-ABEND                 57630004
576400         END-EVALUATE                                             57640004
576500     END-PERFORM.                                                 57650004
576600                                                                  57660004
576700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    57670004
576800         SQLCODE NOT = ZERO                                       57680004
576900         MOVE '5975-INSERT-TWRKORD'                               57690004
577000                                  TO DP013-PARAGRAPH              57700004
577100         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TWRKORD'         57710004
577200                                  TO DP013-MESSAGE-TEXT (1)       57720004
577300         MOVE SQLCA               TO DP013-SQLCA                  57730004
577400         MOVE 'TWRKORD '          TO DP013-DB2-TABLE-NAME (1)     57740004
577500         SET DP013-DB2-ABEND                                      57750004
577600             DP013-XCTL-DISPLAY-RESTART                           57760004
577700                                  TO TRUE                         57770004
577800         PERFORM DP013-0000-PROCESS-ABEND                         57780004
577900     END-IF.                                                      57790004
578000                                                                  57800004
578100/                                                                 57810004
578200*----------------------------------------------------------------*57820004
578300* OPEN THE TOSOPFA CURSOR                                        *57830004
578400*----------------------------------------------------------------*57840004
578500                                                                  57850004
578600 5980-OPEN-TOSOPFA-CSR.                                           57860004
578700                                                                  57870004
578800     EXEC SQL                                                     57880004
578900          DECLARE TOSOPFA-CSR CURSOR FOR                          57890004
579000           SELECT OPER_SET_ID                                     57900004
579100                 ,OPER_ID                                         57910004
579200                 ,OPER_UNT_ID                                     57920004
579300                 ,FCLTY_ID                                        57930004
579400                 ,FCLTY_AREA_ID                                   57940004
579500                 ,PRC_FCLTY_AREA_ID                               57950004
579600                 ,SCRN_SEQ_NBR                                    57960004
579700           FROM   TOSOPFA                                         57970004
579800           WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                57980004
579900             AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                57990004
580000             AND  FCLTY_ID       = :DK-FCLTY-ID                   58000004
580100             AND  VER_STATUS_CDE = 'A'                            58010004
580200           ORDER BY SCRN_SEQ_NBR                                  58020004
580300     END-EXEC.                                                    58030004
580400                                                                  58040004
580500     PERFORM                                                      58050004
580600         WITH TEST AFTER                                          58060004
580700         VARYING PV-RETRY-COUNTER                                 58070004
580800         FROM 1 BY 1                                              58080004
580900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58090004
581000            OR (SQLCODE = +0))                                    58100004
581100                                                                  58110004
581200         EXEC SQL                                                 58120004
581300              OPEN TOSOPFA-CSR                                    58130004
581400         END-EXEC                                                 58140004
581500                                                                  58150004
581600         EVALUATE TRUE                                            58160004
581700             WHEN SQLCODE = +0                                    58170004
581800                  CONTINUE                                        58180004
581900             WHEN SQLCODE = -904                                  58190004
582000             WHEN SQLCODE = -913                                  58200004
582100                  CONTINUE                                        58210004
582200             WHEN SQLWARN0 NOT = SPACE                            58220004
582300             WHEN SQLCODE  NOT = +0                               58230004
582400                  MOVE '5980-OPEN-TOSOPFA-CSR'                    58240004
582500                                   TO DP013-PARAGRAPH             58250004
582600                  MOVE 'OPEN TOSOPFA CURSOR'                      58260004
582700                                   TO DP013-MESSAGE-TEXT (1)      58270004
582800                  MOVE SQLCA       TO DP013-SQLCA                 58280004
582900                  MOVE 'TOSOPFA'   TO DP013-DB2-TABLE-NAME (1)    58290004
583000                  SET DP013-DB2-ABEND                             58300004
583100                                   TO TRUE                        58310004
583200                  PERFORM DP013-0000-PROCESS-ABEND                58320004
583300         END-EVALUATE                                             58330004
583400     END-PERFORM.                                                 58340004
583500                                                                  58350004
583600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58360004
583700         SQLCODE NOT = ZERO                                       58370004
583800         MOVE '5980-OPEN-TOSOPFA-CSR' TO DP013-PARAGRAPH          58380004
583900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN TOSOPFA CURSOR'      58390004
584000                                   TO DP013-MESSAGE-TEXT (1)      58400004
584100         MOVE SQLCA                TO DP013-SQLCA                 58410004
584200         SET DP013-DB2-ABEND       TO TRUE                        58420004
584300         PERFORM DP013-0000-PROCESS-ABEND                         58430004
584400     END-IF.                                                      58440004
584500                                                                  58450004
584600/                                                                 58460004
584700*----------------------------------------------------------------*58470004
584800*    FETCH A TOSOPFA ROW                                         *58480004
584900*----------------------------------------------------------------*58490004
585000                                                                  58500004
585100 5985-FETCH-TOSOPFA-CSR.                                          58510004
585200                                                                  58520004
585300     EXEC SQL                                                     58530004
585400          FETCH TOSOPFA-CSR                                       58540004
585500          INTO :OSOPFA-OPER-SET-ID                                58550004
585600              ,:OSOPFA-OPER-ID                                    58560004
585700              ,:OSOPFA-OPER-UNT-ID                                58570004
585800              ,:OSOPFA-FCLTY-ID                                   58580004
585900              ,:OSOPFA-FCLTY-AREA-ID                              58590004
586000              ,:OSOPFA-PRC-FCLTY-AREA-ID                          58600004
586100              ,:OSOPFA-SCRN-SEQ-NBR                               58610004
586200     END-EXEC                                                     58620004
586300                                                                  58630004
586400     EVALUATE TRUE                                                58640004
586500         WHEN SQLCODE = +0                                        58650004
586600              CONTINUE                                            58660004
586700                                                                  58670004
586800         WHEN SQLCODE = +100                                      58680004
586900              SET PS-EOF-TOSOPFA-CSR TO TRUE                      58690004
587000                                                                  58700004
587100         WHEN SQLWARN0 NOT = SPACE                                58710004
587200         WHEN SQLCODE < +0                                        58720004
587300         WHEN SQLCODE > +0                                        58730004
587400              MOVE '5985-FETCH-TOSOPFA-CSR'                       58740004
587500                                   TO DP013-PARAGRAPH             58750004
587600              MOVE 'FETCH TOSOPFA CURSOR'                         58760004
587700                                   TO DP013-MESSAGE-TEXT (1)      58770004
587800              MOVE SQLCA           TO DP013-SQLCA                 58780004
587900              MOVE 'TOSOPFA'       TO DP013-DB2-TABLE-NAME (1)    58790004
588000              SET DP013-DB2-ABEND  TO TRUE                        58800004
588100              PERFORM DP013-0000-PROCESS-ABEND                    58810004
588200     END-EVALUATE.                                                58820004
588300                                                                  58830004
588400/                                                                 58840004
588500*----------------------------------------------------------------*58850004
588600* CLOSE THE TOSOPFA CURSOR                                       *58860004
588700*----------------------------------------------------------------*58870004
588800                                                                  58880004
588900 5990-CLOSE-TOSOPFA-CSR.                                          58890004
589000                                                                  58900004
589100     EXEC SQL                                                     58910004
589200          CLOSE TOSOPFA-CSR                                       58920004
589300     END-EXEC                                                     58930004
589400                                                                  58940004
589500     EVALUATE TRUE                                                58950004
589600         WHEN SQLCODE = +0                                        58960004
589700              CONTINUE                                            58970004
589800         WHEN SQLWARN0 NOT = SPACE                                58980004
589900         WHEN SQLCODE  NOT = +0                                   58990004
590000              MOVE '5990-CLOSE-TOSOPFA-CSR'                       59000004
590100                                   TO DP013-PARAGRAPH             59010004
590200              MOVE 'CLOSE TOSOPFA CURSOR'                         59020004
590300                                   TO DP013-MESSAGE-TEXT (1)      59030004
590400              MOVE SQLCA           TO DP013-SQLCA                 59040004
590500              MOVE 'TOSOPFA'       TO DP013-DB2-TABLE-NAME (1)    59050004
590600              SET DP013-DB2-ABEND  TO TRUE                        59060004
590700              PERFORM DP013-0000-PROCESS-ABEND                    59070004
590800     END-EVALUATE.                                                59080004
590900                                                                  59090004
591000/                                                                 59100004
591100 5991-BUILD-WORK-ORDER-INSTR.                                     59110004
591200                                                                  59120004
591300     INITIALIZE DCLTWKORIN.                                       59130004
591400                                                                  59140004
591500     MOVE LQW-PO (LQW-IDX)       TO WKORIN-ORD-NBR.               59150004
591600     MOVE PV-REC-SEQ-NBR         TO WKORIN-RCVR-SEQ-NBR.          59160004
591700     MOVE +1                     TO WKORIN-WORK-ORD-SEQ-NBR.      59170004
591800     ADD +1                      TO PV-WO-INSTR-SEQ-NBR.          59180004
591900     MOVE PV-WO-INSTR-SEQ-NBR    TO WKORIN-WO-INSTR-SEQ-NBR.      59190004
592000     MOVE 'A'                    TO WKORIN-VER-STATUS-CDE.        59200004
592100     MOVE ASC-KEY-OPER-UNT-ID-N  TO WKORIN-OPER-UNT-ID.           59210004
592200     MOVE ASC-KEY-FCLTY-ID-N     TO WKORIN-FCLTY-ID.              59220004
592300     MOVE OSOPFA-OPER-ID         TO WKORIN-OPER-ID.               59230004
592400     MOVE OSOPFA-FCLTY-AREA-ID   TO WKORIN-FCLTY-AREA-ID.         59240004
592500     MOVE OSOPFA-PRC-FCLTY-AREA-ID                                59250004
592600                                 TO WKORIN-PRC-FCLTY-AREA-ID.     59260004
592700     MOVE OSOPFA-SCRN-SEQ-NBR    TO WKORIN-SCREEN-SEQ-NBR.        59270004
592800     IF  PS-FIRST-INSTRUCTION                                     59280004
592900         MOVE 'N'                TO PS-INSTRUCTION-SW             59290004
593000         MOVE SHPTPO-EXPTED-CART-CNT                              59300004
593100                                 TO WKORIN-EXPTED-CART-CNT        59310004
593200         MOVE ZERO                                                59320004
593300                                 TO WKORIN-ACTL-CART-CNT          59330004
593400     END-IF.                                                      59340004
593500     MOVE 'N'                    TO WKORIN-ALLOC-IND              59350004
593600                                    WKORIN-REPACK-IND.            59360004
593700     MOVE '9999-09-09-09.09.09.000000'                            59370004
593800                                 TO WKORIN-STRT-TMST              59380004
593900                                    WKORIN-STOP-TMST.             59390004
594000                                                                  59400004
594100     PERFORM 5992-INACTIVATE-TWKORIN.                             59410004
594200     PERFORM 5993-INSERT-TWKORIN.                                 59420004
594300                                                                  59430004
594400 5992-INACTIVATE-TWKORIN.                                         59440004
594500                                                                  59450004
594600     EXEC SQL                                                     59460004
594700          UPDATE                                                  59470004
594800                 TWKORIN                                          59480004
594900             SET                                                  59490004
595000                 VER_STATUS_CDE      =  :PC-I                     59500004
595100           WHERE                                                  59510004
595200                 ORD_NBR             =  :WKORIN-ORD-NBR           59520004
595300             AND RCVR_SEQ_NBR        =  :WKORIN-RCVR-SEQ-NBR      59530004
595400             AND ORD_LNE_NBR         =  :WKORIN-ORD-LNE-NBR       59540004
595500             AND WORK_ORD_SEQ_NBR    =  :WKORIN-WORK-ORD-SEQ-NBR  59550004
595600             AND WO_INSTR_SEQ_NBR    =  :WKORIN-WO-INSTR-SEQ-NBR  59560004
595700             AND VER_STATUS_CDE      =  :PC-A                     59570004
595800     END-EXEC.                                                    59580004
595900                                                                  59590004
596000     EVALUATE TRUE                                                59600004
596100         WHEN SQLCODE = ZERO                                      59610004
596200         WHEN SQLCODE = +100                                      59620004
596300              CONTINUE                                            59630004
596400         WHEN SQLWARN0 NOT = SPACES                               59640004
596500         WHEN SQLCODE NOT EQUAL ZERO                              59650004
596600              MOVE '5992-INACTIVATE-TWKORIN'                      59660004
596700                                   TO DP013-PARAGRAPH             59670004
596800              MOVE '"LOGICAL" DELETE; SET STATUS TO I'            59680004
596900                                   TO DP013-MESSAGE-TEXT (1)      59690004
597000              MOVE SQLCA           TO DP013-SQLCA                 59700004
597100              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    59710004
597200              SET DP013-DB2-ABEND                                 59720004
597300                  DP013-XCTL-DISPLAY-RESTART                      59730004
597400                                   TO TRUE                        59740004
597500              PERFORM DP013-0000-PROCESS-ABEND                    59750004
597600     END-EVALUATE.                                                59760004
597700/                                                                 59770004
597800 5993-INSERT-TWKORIN.                                             59780004
597900                                                                  59790004
598000     PERFORM                                                      59800004
598100         WITH TEST AFTER                                          59810004
598200         VARYING PV-RETRY-COUNTER                                 59820004
598300         FROM 1 BY 1                                              59830004
598400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59840004
598500             OR (SQLCODE = +0))                                   59850004
598600                                                                  59860004
598700         EXEC SQL                                                 59870004
598800              INSERT INTO TWKORIN                                 59880004
598900                     ( ORD_NBR                                    59890004
599000                      ,RCVR_SEQ_NBR                               59900004
599100                      ,ORD_LNE_NBR                                59910004
599200                      ,WORK_ORD_SEQ_NBR                           59920004
599300                      ,OPER_UNT_ID                                59930004
599400                      ,FCLTY_ID                                   59940004
599500                      ,WO_INSTR_SEQ_NBR                           59950004
599600                      ,CRE_TMST                                   59960004
599700                      ,VER_STATUS_CDE                             59970004
599800                      ,CRE_UID_ID                                 59980004
599900                      ,OPER_ID                                    59990004
600000                      ,FCLTY_AREA_ID                              60000004
600100                      ,PRC_FCLTY_AREA_ID                          60010004
600200                      ,EXPTED_CART_CNT                            60020004
600300                      ,ACTL_CART_CNT                              60030004
600400                      ,ALLOC_IND                                  60040004
600500                      ,REPACK_IND                                 60050004
600600                      ,STRT_TMST                                  60060004
600700                      ,STOP_TMST                                  60070004
600800                      ,SCREEN_SEQ_NBR                             60080004
600900                      ,LNE_LOC_CDE                                60090004
601000                      ,REC_SEL_IND )                              60100004
601100              VALUES ( :WKORIN-ORD-NBR                            60110004
601200                      ,:WKORIN-RCVR-SEQ-NBR                       60120004
601300                      ,:WKORIN-ORD-LNE-NBR                        60130004
601400                      ,:WKORIN-WORK-ORD-SEQ-NBR                   60140004
601500                      ,:WKORIN-OPER-UNT-ID                        60150004
601600                      ,:WKORIN-FCLTY-ID                           60160004
601700                      ,:WKORIN-WO-INSTR-SEQ-NBR                   60170004
601800                      ,CURRENT TIMESTAMP                          60180004
601900                      ,:WKORIN-VER-STATUS-CDE                     60190004
602000                      ,:DP020-USERID                              60200004
602100                      ,:WKORIN-OPER-ID                            60210004
602200                      ,:WKORIN-FCLTY-AREA-ID                      60220004
602300                      ,:WKORIN-PRC-FCLTY-AREA-ID                  60230004
602400                      ,:WKORIN-EXPTED-CART-CNT                    60240004
602500                      ,:WKORIN-ACTL-CART-CNT                      60250004
602600                      ,:WKORIN-ALLOC-IND                          60260004
602700                      ,:WKORIN-REPACK-IND                         60270004
602800                      ,:WKORIN-STRT-TMST                          60280004
602900                      ,:WKORIN-STOP-TMST                          60290004
603000                      ,:WKORIN-SCREEN-SEQ-NBR                     60300004
603100                      ,:WKORIN-LNE-LOC-CDE                        60310004
603200                      ,:WKORIN-REC-SEL-IND )                      60320004
603300         END-EXEC                                                 60330004
603400                                                                  60340004
603500         EVALUATE TRUE                                            60350004
603600             WHEN SQLCODE = +0                                    60360004
603700             WHEN SQLCODE = -904                                  60370004
603800             WHEN SQLCODE = -913                                  60380004
603900                 CONTINUE                                         60390004
604000                                                                  60400004
604100             WHEN SQLWARN0 NOT = SPACE                            60410004
604200             WHEN SQLCODE < +0                                    60420004
604300             WHEN SQLCODE > +0                                    60430004
604400                 MOVE '5993-INSERT-TWKORIN'                       60440004
604500                                 TO DP013-PARAGRAPH               60450004
604600                 MOVE 'INSERT ON WORK ORDER INSTRUCTION TABLE'    60460004
604700                                 TO DP013-MESSAGE-TEXT (1)        60470004
604800                 MOVE SQLCA      TO DP013-SQLCA                   60480004
604900                 MOVE 'TWKORIN'  TO DP013-DB2-TABLE-NAME (1)      60490004
605000                     SET DP013-DB2-ABEND                          60500004
605100                         DP013-XCTL-DISPLAY-RESTART               60510004
605200                                     TO TRUE                      60520004
605300                 PERFORM DP013-0000-PROCESS-ABEND                 60530004
605400         END-EVALUATE                                             60540004
605500     END-PERFORM.                                                 60550004
605600                                                                  60560004
605700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60570004
605800         SQLCODE NOT = ZERO                                       60580004
605900         MOVE '5993-INSERT-TWKORIN'                               60590004
606000                                  TO DP013-PARAGRAPH              60600004
606100         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TWKORIN'         60610004
606200                                  TO DP013-MESSAGE-TEXT (1)       60620004
606300         MOVE SQLCA               TO DP013-SQLCA                  60630004
606400         MOVE 'TWKORIN '          TO DP013-DB2-TABLE-NAME (1)     60640004
606500         SET DP013-DB2-ABEND                                      60650004
606600             DP013-XCTL-DISPLAY-RESTART                           60660004
606700                                  TO TRUE                         60670004
606800         PERFORM DP013-0000-PROCESS-ABEND                         60680004
606900     END-IF.                                                      60690004
607000                                                                  60700004
607100/                                                                 60710004
607200 5994-GET-OPER-SET-INFO.                                          60720004
607300*  THIS IS THE OPER SET DEFAULT THAT IS ASSIGNED IN CNUDCLOC      60730004
607400*  BY OPER-UNIT, FACILTY, DEPT, AND CLASS.                        60740004
607500                                                                  60750004
607600     PERFORM 5994-GET-MIN-LNE-NBR.                                60760004
607700                                                                  60770004
607800     IF SQLCODE = 0                                               60780004
607900        PERFORM                                                   60790004
608000            WITH TEST AFTER                                       60800004
608100            VARYING PV-RETRY-COUNTER                              60810004
608200            FROM 1 BY 1                                           60820004
608300            UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)            60830004
608400                OR (SQLCODE = +0)                                 60840004
608500                OR (SQLCODE = +100))                              60850004
608600                                                                  60860004
608700            EXEC SQL                                              60870004
608800                 SELECT A.OPER_SET_ID                             60880004
608900                   INTO :DCFAAS-OPER-SET-ID                       60890004
609000                   FROM TDCFAAS A                                 60900004
609100                       ,TOPRSET B                                 60910004
609200                  WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID     60920004
609300                    AND A.FCLTY_ID          = :DK-FCLTY-ID        60930004
609400                    AND A.DEPT_NBR          = :DK-DEPT-NBR        60940004
609500                    AND A.FCLTY_LOC_TYP_CDE = 'PA'                60950004
609600                    AND A.RANK_NBR          = 1                   60960004
609700                    AND B.VER_STATUS_CDE    = 'A'                 60970004
609800                    AND A.CL_NBR            = :PV-CLASS-NBR-2CH   60980004
609900                    AND A.OPER_SET_ID = B.OPER_SET_ID             60990004
610000                    AND A.OPER_UNT_ID       = B.OPER_UNT_ID       61000004
610100            END-EXEC                                              61010004
610200                                                                  61020004
610300            EVALUATE TRUE                                         61030004
610400                WHEN SQLCODE = +0                                 61040004
610500                WHEN SQLCODE = +100                               61050004
610600                WHEN SQLCODE = -904                               61060004
610700                WHEN SQLCODE = -913                               61070004
610800                     CONTINUE                                     61080004
610900                                                                  61090004
611000                WHEN SQLWARN0 NOT = SPACES                        61100004
611100                WHEN SQLCODE < +0                                 61110004
611200                WHEN SQLCODE > +0                                 61120004
611300                     MOVE '5994-GET-OPER-SET-INFO'                61130004
611400                                     TO DP013-PARAGRAPH           61140004
611500                     MOVE 'UNSUCCESSFUL SELECT ON TDCFAAS TABLE'  61150004
611600                                     TO DP013-MESSAGE-TEXT (1)    61160004
611700                     MOVE SQLCA      TO DP013-SQLCA               61170004
611800                     MOVE 'TDCFAAS ' TO DP013-DB2-TABLE-NAME (1)  61180004
611900                     MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (2)  61190004
612000                     SET DP013-DB2-ABEND                          61200004
612100                         DP013-XCTL-DISPLAY-RESTART               61210004
612200                                     TO TRUE                      61220004
612300                     PERFORM DP013-0000-PROCESS-ABEND             61230004
612400            END-EVALUATE                                          61240004
612500        END-PERFORM                                               61250004
612600                                                                  61260004
612700        IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                 61270004
612800            SQLCODE NOT = ZERO                                    61280004
612900            MOVE '5994-GET-OPER-SET-INFO'  TO DP013-PARAGRAPH     61290004
613000            MOVE                                                  61300004
613100            'MAX RETRIES EXCEEDED ON FACILITY LOC ASSIGNMENTS'    61310004
613200                                     TO DP013-MESSAGE-TEXT (1)    61320004
613300            MOVE SQLCA               TO DP013-SQLCA               61330004
613400            MOVE 'TDCFAAS'           TO DP013-DB2-TABLE-NAME (1)  61340004
613500            MOVE 'TOPRSET'           TO DP013-DB2-TABLE-NAME (2)  61350004
613600            SET DP013-DB2-ABEND                                   61360004
613700                DP013-XCTL-DISPLAY-RESTART                        61370004
613800                                     TO TRUE                      61380004
613900            PERFORM DP013-0000-PROCESS-ABEND                      61390004
614000        END-IF                                                    61400004
614100     END-IF.                                                      61410004
614200                                                                  61420004
614300 5994-GET-MIN-LNE-NBR.                                            61430004
614400     PERFORM                                                      61440004
614500         WITH TEST AFTER                                          61450004
614600         VARYING PV-RETRY-COUNTER                                 61460004
614700         FROM 1 BY 1                                              61470004
614800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61480004
614900             OR (SQLCODE = +0)                                    61490004
615000             OR (SQLCODE = +100))                                 61500004
615100                                                                  61510004
615200*        EXEC SQL                                                 61520004
615300*             SELECT                                              61530004
615400*                    A.CL_NBR                                     61540004
615500*               INTO :PURITM-CL-NBR                               61550004
615600*               FROM TPURITM A                                    61560004
615700*              WHERE A.PO_NBR        = :DK-PO-NBR                 61570004
615800*                AND A.VER_STATUS_CDE = 'A'                       61580004
615900*                AND A.PO_LNE_NBR =                               61590004
616000*                  (SELECT MIN(B.PO_LNE_NBR)                      61600004
616100*                     FROM TPURITM B                              61610004
616200*                     WHERE B.PO_NBR = A.PO_NBR                   61620004
616300*                       AND B.VER_STATUS_CDE = 'A'                61630004
616400*                       AND B.STATUS_CDE IN ('AP','AC'))          61640004
616500         EXEC SQL                                                 61650004
616600              SELECT                                              61660004
616700                    SUB_CL_NBR                                    61670004
616800                INTO :XLV00001-SUB-CL-NBR                         61680004
616900              FROM  XLV_SKU A,                                    61690004
617000                    XLV_VND_STYL B                                61700004
617100              WHERE A.STYL_ID = B.STYL_ID                         61710004
617200                AND A.ITM_NBR =                                   61720004
617300                     (SELECT MIN(C.ITM_NBR)                       61730004
617400                        FROM TPURITM C                            61740004
617500                       WHERE C.PO_NBR         = :DK-PO-NBR        61750004
617600                         AND C.VER_STATUS_CDE = 'A'               61760004
617700                         AND C.STATUS_CDE     IN ('AP','AC'))     61770004
617800         END-EXEC                                                 61780004
617900                                                                  61790004
618000         EVALUATE TRUE                                            61800004
618100             WHEN SQLCODE = +0                                    61810004
618200                  MOVE XLV00001-SUB-CL-NBR                        61820004
618300                                  TO PV-CLASS-NBR-99              61830004
618400                  MOVE PV-CLASS-NBR-99                            61840004
618500                                  TO PV-CLASS-NBR-2CH             61850004
618600             WHEN SQLCODE = +100                                  61860004
618700             WHEN SQLCODE = -904                                  61870004
618800             WHEN SQLCODE = -913                                  61880004
618900                  CONTINUE                                        61890004
619000                                                                  61900004
619100             WHEN SQLWARN0 NOT = SPACES                           61910004
619200             WHEN SQLCODE < +0                                    61920004
619300             WHEN SQLCODE > +0                                    61930004
619400                  MOVE '5994-GET-MIN-LNE-NBR'                     61940004
619500                                  TO DP013-PARAGRAPH              61950004
619600                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM TABLE'     61960004
619700                                  TO DP013-MESSAGE-TEXT (1)       61970004
619800                  MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)       61980004
619900                  MOVE SQLCA      TO DP013-SQLCA                  61990004
620000                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     62000004
620100                  SET DP013-DB2-ABEND                             62010004
620200                      DP013-XCTL-DISPLAY-RESTART                  62020004
620300                                  TO TRUE                         62030004
620400                  PERFORM DP013-0000-PROCESS-ABEND                62040004
620500         END-EVALUATE                                             62050004
620600     END-PERFORM.                                                 62060004
620700                                                                  62070004
620800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        62080004
620900             AND (SQLCODE = -904 OR -913)                         62090004
621000         MOVE '5994-GET-MIN-LNE-NBR'    TO DP013-PARAGRAPH        62100004
621100         MOVE 'MAX RETRIES EXCEEDED ON FACILITY LOC ASSIGNMENTS'  62110004
621200                                  TO DP013-MESSAGE-TEXT (1)       62120004
621300         MOVE SQLCA               TO DP013-SQLCA                  62130004
621400         MOVE 'TPURITM'           TO DP013-DB2-TABLE-NAME (1)     62140004
621500         SET DP013-DB2-ABEND                                      62150004
621600             DP013-XCTL-DISPLAY-RESTART                           62160004
621700                                  TO TRUE                         62170004
621800         PERFORM DP013-0000-PROCESS-ABEND                         62180004
621900     END-IF.                                                      62190004
622000                                                                  62200004
622100/                                                                 62210004
622200 5995-VALIDATE-OPER-SET-ID.                                       62220004
622300                                                                  62230004
622400     PERFORM                                                      62240004
622500         WITH TEST AFTER                                          62250004
622600         VARYING PV-RETRY-COUNTER                                 62260004
622700         FROM 1 BY 1                                              62270004
622800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62280004
622900                   OR (SQLCODE = +0)                              62290004
623000                   OR (SQLCODE = +100))                           62300004
623100                                                                  62310004
623200         EXEC SQL                                                 62320004
623300            SELECT  OPER_SET_DESC                                 62330004
623400              INTO :OPRSET-OPER-SET-DESC                          62340004
623500              FROM  TOPRSET                                       62350004
623600             WHERE  OPER_SET_ID    = :DK-OPER-SET-ID              62360004
623700               AND  VER_STATUS_CDE = 'A'                          62370004
623800               AND  OPER_UNT_ID    = :DK-OPER-UNT-ID              62380004
623900               AND  FCLTY_ID       = :DK-FCLTY-ID                 62390004
624000         END-EXEC                                                 62400004
624100                                                                  62410004
624200         EVALUATE TRUE                                            62420004
624300             WHEN SQLCODE = +0                                    62430004
624400             WHEN SQLCODE = +100                                  62440004
624500             WHEN SQLCODE = -904                                  62450004
624600             WHEN SQLCODE = -913                                  62460004
624700                 CONTINUE                                         62470004
624800                                                                  62480004
624900             WHEN SQLWARN0 NOT = SPACES                           62490004
625000             WHEN SQLCODE < +0                                    62500004
625100             WHEN SQLCODE > +0                                    62510004
625200                 MOVE '5995-VALIDATE-OPER-SET-ID'                 62520004
625300                                 TO DP013-PARAGRAPH               62530004
625400                 MOVE 'SELECT OPERATION SET ID'                   62540004
625500                                 TO DP013-MESSAGE-TEXT (1)        62550004
625600                 MOVE SQLCA      TO DP013-SQLCA                   62560004
625700                 MOVE 'TOPRSET'  TO DP013-DB2-TABLE-NAME (1)      62570004
625800                 SET DP013-DB2-ABEND                              62580004
625900                                 TO TRUE                          62590004
626000                 SET DP013-XCTL-DISPLAY-RESTART                   62600004
626100                                 TO TRUE                          62610004
626200                 PERFORM DP013-0000-PROCESS-ABEND                 62620004
626300         END-EVALUATE                                             62630004
626400     END-PERFORM.                                                 62640004
626500                                                                  62650004
626600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    62660004
626700         SQLCODE NOT = ZERO                                       62670004
626800         MOVE '5995-VALIDATE-OPER-SET-ID'                         62680004
626900                                 TO DP013-PARAGRAPH               62690004
627000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     62700004
627100                                 TO DP013-MESSAGE-TEXT (1)        62710004
627200         MOVE 'ON TOPRSET    '   TO DP013-MESSAGE-TEXT (2)        62720004
627300         MOVE SQLCA              TO DP013-SQLCA                   62730004
627400         MOVE 'TOPRSET'          TO DP013-DB2-TABLE-NAME (1)      62740004
627500         SET DP013-DB2-ABEND     TO TRUE                          62750004
627600         SET DP013-XCTL-DISPLAY-RESTART                           62760004
627700                                 TO TRUE                          62770004
627800         PERFORM DP013-0000-PROCESS-ABEND                         62780004
627900     END-IF.                                                      62790004
628000                                                                  62800004
628100 EJECT                                                            62810004
628200*----------------------------------------------------------------*62820004
628300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *62830004
628400*----------------------------------------------------------------*62840004
628500 6010-DELETE-SEL-QUEUE.                                           62850004
628600                                                                  62860004
628700     EXEC CICS                                                    62870004
628800         DELETEQ TS                                               62880004
628900             QUEUE (ASC-SEL-QUEUE-NAME)                           62890004
629000             RESP  (PV-CICS-RESP)                                 62900004
629100     END-EXEC.                                                    62910004
629200*                                                                 62920004
629300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      62930004
629400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         62940004
629500         CONTINUE                                                 62950004
629600     ELSE                                                         62960004
629700         SET DP013-CICS-ABEND TO TRUE                             62970004
629800         SET DP013-NO-ROLLBACK TO TRUE                            62980004
629900         MOVE '6010-DELETE-SEL-QUEUE'                             62990004
630000                        TO DP013-PARAGRAPH                        63000004
630100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         63010004
630200                        TO DP013-MESSAGE-TEXT (1)                 63020004
630300         PERFORM DP013-0000-PROCESS-ABEND                         63030004
630400     END-IF.                                                      63040004
630500                                                                  63050004
630600 EJECT                                                            63060004
630700*----------------------------------------------------------------*63070004
630800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*63080004
630900*----------------------------------------------------------------*63090004
631000                                                                  63100004
631100 6112-READ-LIST-QUEUE.                                            63110004
631200                                                                  63120004
631300     EXEC CICS                                                    63130004
631400         READQ TS                                                 63140004
631500             QUEUE (ASC-LIST-QUEUE-NAME)                          63150004
631600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     63160004
631700             ITEM  (PV-ITEM)                                      63170004
631800             RESP  (PV-CICS-RESP)                                 63180004
631900     END-EXEC.                                                    63190004
632000*                                                                 63200004
632100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          63210004
632200         CONTINUE                                                 63220004
632300     ELSE                                                         63230004
632400         SET DP013-CICS-ABEND        TO TRUE                      63240004
632500         SET DP013-NO-ROLLBACK       TO TRUE                      63250004
632600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           63260004
632700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    63270004
632800                                     TO DP013-MESSAGE-TEXT(1)     63280004
632900         PERFORM DP013-0000-PROCESS-ABEND                         63290004
633000     END-IF.                                                      63300004
633100                                                                  63310004
633200                                                                  63320004
633300*----------------------------------------------------------------*63330004
633400* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *63340004
633500*----------------------------------------------------------------*63350004
633600                                                                  63360004
633700 9100-READ-SEL-QUEUE.                                             63370004
633800     EXEC CICS                                                    63380004
633900         READQ TS                                                 63390004
634000             QUEUE (ASC-PREV-SEL-QUEUE-NAME)                      63400004
634100             INTO  (RC013-DC-SELECT-RECORD)                       63410004
634200             ITEM  (ASC-SEL-ITEM)                                 63420004
634300             RESP  (PV-CICS-RESP)                                 63430004
634400     END-EXEC.                                                    63440004
634500                                                                  63450004
634600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       63460004
634700         CONTINUE                                                 63470004
634800     ELSE                                                         63480004
634900         SET DP013-LOGIC-ABEND                                    63490004
635000             DP013-NO-ROLLBACK     TO TRUE                        63500004
635100         MOVE '9100-READ-SEL-QUEUE'                               63510004
635200                                   TO DP013-PARAGRAPH             63520004
635300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   63530004
635400                                   TO DP013-MESSAGE-TEXT (1)      63540004
635500         PERFORM DP013-0000-PROCESS-ABEND                         63550004
635600     END-IF.                                                      63560004
635700*----------------------------------------------------------------*63570004
635800* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *63580004
635900*----------------------------------------------------------------*63590004
636000 9200-REWRITE-SEL-QUEUE.                                          63600004
636100     EXEC CICS                                                    63610004
636200          WRITEQ TS                                               63620004
636300              QUEUE  (ASC-PREV-SEL-QUEUE-NAME)                    63630004
636400              FROM   (RC013-DC-SELECT-RECORD)                     63640004
636500              ITEM   (ASC-SEL-ITEM)                               63650004
636600              RESP   (PV-CICS-RESP)                               63660004
636700              REWRITE                                             63670004
636800     END-EXEC.                                                    63680004
636900                                                                  63690004
637000     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   63700004
637100         SET DP013-CICS-ABEND                                     63710004
637200             DP013-NO-ROLLBACK     TO TRUE                        63720004
637300         MOVE '9200-REWRITE-SEL-QUEUE'                            63730004
637400                                   TO DP013-PARAGRAPH             63740004
637500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   63750004
637600                                   TO DP013-MESSAGE-TEXT (1)      63760004
637700         PERFORM DP013-0000-PROCESS-ABEND                         63770004
637800     END-IF.                                                      63780004
637900                                                                  63790004
638000* JAK 04/2007 - ADD WMS CODE - BEGIN                              63800004
638100*----------------------------------------------------------------*63810004
638200*  CHECK TO SEE IF THE RECEIVER NEEDS TO BE PROCESSED THRU THE    63820004
638300*  WMS VENDOR SHIPMENT CONTROL MODULE.                            63830004
638400*----------------------------------------------------------------*63840004
638500 8000-WMS-SHIPMENT-CHECK.                                         63850004
638600                                                                  63860004
638700*    CHECK TO SEE IF THE DC IS DOWNLOADING TO WMS                 63870004
638800*    IF THE DC IS DOWNLOADING                                     63880004
638900*        CHECK TO SEE IF RECEIVER IS TRANSCRIBED                  63890004
639000*        IF RECEIVER IS TRANSCRIBED                               63900004
639100*            DOWNLOAD TO ASN                                      63910004
639200                                                                  63920004
639300     INITIALIZE PS-ASNS-TO-WMS-SW.                                63930004
639400     INITIALIZE PS-MSGS-TRNSCRB-SW.                               63940004
639500     INITIALIZE PS-RECEIVING-BEGUN-SW.                            63950004
639600     INITIALIZE PS-WMS-MESSAGE-SW.                                63960004
639700     MOVE ASC-KEY-OPER-UNT-ID-N TO DK-OPER-UNT-ID.                63970004
639800     MOVE PV-REC-SEQ-NBR        TO DK-RCVR-SEQ-NBR.               63980004
639900                                                                  63990004
640000     PERFORM 8010-CHECK-TKRPRPM.                                  64000004
640100     IF PS-ASNS-TO-WMS-YES                                        64010004
640200         PERFORM 8020-RCVR-TRANSCRIBED                            64020004
640300         IF PS-MSGS-TRNSCRB-YES                                   64030004
640400             PERFORM 8030-CALL-WMS-MODULE                         64040004
640500         END-IF                                                   64050004
640600     END-IF.                                                      64060004
640700                                                                  64070004
640800*----------------------------------------------------------------*64080004
640900*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S   64090004
641000*  TO WMS.                                                        64100004
641100*----------------------------------------------------------------*64110004
641200 8010-CHECK-TKRPRPM.                                              64120004
641300                                                                  64130004
641400     EXEC SQL                                                     64140004
641500          SELECT   FUNC_TXT                                       64150004
641600            INTO  :KRPRPM-FUNC-TXT                                64160004
641700            FROM                                                  64170004
641800                  TKRPRPM A                                       64180004
641900            WHERE                                                 64190004
642000                  LOC_ID            = :DK-OPER-UNT-ID             64200004
642100              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    64210004
642200              AND FUNC_PRC_STAT_CDE = 'AC'                        64220004
642300              AND INTFC_SYS_CDE     = 'KHL'                       64230004
642400              AND FUNC_TXT          = 'Y'                         64240004
642500              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            64250004
642600     END-EXEC.                                                    64260004
642700                                                                  64270004
642800     EVALUATE TRUE                                                64280004
642900         WHEN SQLCODE = ZERO                                      64290004
643000             SET PS-ASNS-TO-WMS-YES    TO TRUE                    64300004
643100         WHEN SQLCODE = +100                                      64310004
643200             SET PS-ASNS-TO-WMS-NO     TO TRUE                    64320004
643300         WHEN SQLWARN0 NOT = SPACES                               64330004
643400         WHEN SQLCODE  NOT = ZERO                                 64340004
643500             MOVE '8010-CHECK-TKRPRPM'                            64350004
643600                                   TO DP013-PARAGRAPH             64360004
643700             MOVE 'SELECT A TKRPRPM ROW   '                       64370004
643800                                   TO DP013-MESSAGE-TEXT(1)       64380004
643900             MOVE DK-OPER-UNT-ID   TO DP013-MESSAGE-TEXT(2)       64390004
644000             MOVE SQLCA            TO DP013-SQLCA                 64400004
644100             MOVE 'TKRPRPM'        TO DP013-DB2-TABLE-NAME (1)    64410004
644200             SET DP013-DB2-ABEND                                  64420004
644300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               64430004
644400             PERFORM DP013-0000-PROCESS-ABEND                     64440004
644500     END-EVALUATE.                                                64450004
644600                                                                  64460004
644700                                                                  64470004
644800*----------------------------------------------------------------*64480004
644900*  CHECK TO SEE IF ANY OF THE RECEIVERS HAVE BEEN TRANSCRIBED     64490004
645000*----------------------------------------------------------------*64500004
645100 8020-RCVR-TRANSCRIBED.                                           64510004
645200                                                                  64520004
645300     EXEC SQL                                                     64530004
645400          SELECT   COUNT(*)                                       64540004
645500            INTO  :PV-SQL-COUNT                                   64550004
645600            FROM  TRECITM                                         64560004
645700            WHERE   ORD_NBR        = :DK-PO-NBR                   64570004
645800            AND     REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             64580004
645900            AND     VER_STATUS_CDE = 'A'                          64590004
646000     END-EXEC.                                                    64600004
646100                                                                  64610004
646200     EVALUATE TRUE                                                64620004
646300         WHEN SQLCODE = ZERO                                      64630004
646400             IF PV-SQL-COUNT > 0                                  64640004
646500                 SET PS-MSGS-TRNSCRB-YES   TO TRUE                64650004
646600             ELSE                                                 64660004
646700                 SET PS-MSGS-TRNSCRB-NO    TO TRUE                64670004
646800             END-IF                                               64680004
646900         WHEN SQLWARN0 NOT = SPACES                               64690004
647000         WHEN SQLCODE  NOT = ZERO                                 64700004
647100             MOVE '8020-RCVR-TRANSCRIBED'                         64710004
647200                                   TO DP013-PARAGRAPH             64720004
647300             MOVE 'SELECT TRANSCRIBED RCVR COUNT'                 64730004
647400                                   TO DP013-MESSAGE-TEXT(1)       64740004
647500             MOVE DK-PO-NBR        TO DP013-MESSAGE-TEXT(2)       64750004
647600             MOVE DK-RCVR-SEQ-NBR  TO DP013-MESSAGE-TEXT(3)       64760004
647700             MOVE SQLCA            TO DP013-SQLCA                 64770004
647800             MOVE 'TRECITM'        TO DP013-DB2-TABLE-NAME (1)    64780004
647900             SET DP013-DB2-ABEND                                  64790004
648000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               64800004
648100             PERFORM DP013-0000-PROCESS-ABEND                     64810004
648200     END-EVALUATE.                                                64820004
648300                                                                  64830004
648400                                                                  64840004
648500*----------------------------------------------------------------*64850004
648600* CALL TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     64860004
648700*  COPYBOOK WSWS001.                                              64870004
648800*----------------------------------------------------------------*64880004
648900 8030-CALL-WMS-MODULE.                                            64890004
649000                                                                  64900004
649100     SET WS001-INSERT           TO TRUE.                          64910004
649200     MOVE 'RC'                  TO WS001-SHIPMENT-SOURCE.         64920004
649300     MOVE SHIPMT-TRIP-ID        TO WS001-TRIP-ID.                 64930004
649400     MOVE SHPTPO-PO-NBR         TO WS001-PO-NBR.                  64940004
649500     MOVE SHPTPO-REC-SEQ-NBR    TO WS001-RCVR-NBR.                64950004
649600     MOVE DK-OPER-UNT-ID        TO WS001-OPER-UNT-ID.             64960004
649700     MOVE DP020-USERID          TO WS001-USER-ID.                 64970004
649800     MOVE ZEROS                 TO WS001-KOHLS-SHIPT-ID.          64980004
649900     MOVE ZEROS                 TO WS001-PO-LNE-NBR.              64990004
650000     MOVE ZEROS                 TO WS001-PREPK-ID.                65000004
650100     MOVE ZEROS                 TO WS001-SKU-NBR.                 65010004
650200     MOVE SPACES                TO WS001-DTL-ASN-LEVEL-IND.       65020004
650300     MOVE 'RCKCS262'            TO WS001-CALLING-PROGRAM-NAME.    65030004
650400     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         65040004
650500                                                                  65050004
650600     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         65060004
650700     EXEC CICS                                                    65070004
650800         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       65080004
650900              COMMAREA (WS001-FIELDS)                             65090004
651000              LENGTH   (PV-COMMAREA-LENGTH)                       65100004
651100     END-EXEC.                                                    65110004
651200                                                                  65120004
651300     EVALUATE TRUE                                                65130004
651400         WHEN WS001-SUCCESSFUL                                    65140004
651500             CONTINUE                                             65150004
651600         WHEN WS001-INVALID-SQL                                   65160004
651700         WHEN WS001-DATABASE-BUSY                                 65170004
651800             MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER            65180004
651900             MOVE '8030-CALL-WMS-MODULE'                          65190004
652000                              TO DP013-PARAGRAPH                  65200004
652100             MOVE 'UNABLE TO CALL WMS CONTROL MOD'                65210004
652200                              TO DP013-MESSAGE-TEXT (1)           65220004
652300             MOVE WS001-CRA-RET-MSG                               65230004
652400                         TO DP013-MESSAGE-TEXT (2)                65240004
652500             SET DP013-DB2-ABEND                                  65250004
652600                 DP013-XCTL-DISPLAY-RESTART                       65260004
652700                                         TO TRUE                  65270004
652800             SET PS-ERROR                TO TRUE                  65280004
652900             PERFORM DP013-0000-PROCESS-ABEND                     65290004
653000         WHEN OTHER                                               65300004
653100             MOVE PC-TSYMSG-03548  TO DP020-MSG-NUMBER            65310004
653200             MOVE '8030-CALL-WMS-MODULE'                          65320004
653300                              TO DP013-PARAGRAPH                  65330004
653400             MOVE 'INVALID RETURN FROM WMS CONTROL MOD'           65340004
653500                              TO DP013-MESSAGE-TEXT (1)           65350004
653600             MOVE WS001-CRA-RET-MSG                               65360004
653700                         TO DP013-MESSAGE-TEXT (2)                65370004
653800             SET DP013-DB2-ABEND                                  65380004
653900                 DP013-XCTL-DISPLAY-RESTART                       65390004
654000                                    TO TRUE                       65400004
654100             SET PS-ERROR                    TO TRUE              65410004
654200             PERFORM DP013-0000-PROCESS-ABEND                     65420004
654300     END-EVALUATE.                                                65430004
654400* JAK 04/2007 - ADD WMS CODE - END                                65440004
654500                                                                  65450004
654600                                                                  65460004
654700 EJECT                                                            65470004
654800*----------------------------------------------------------------*65480004
654900*    ABEND PROCESSOR MODULE                                      *65490004
655000*----------------------------------------------------------------*65500004
655100                                                                  65510004
655200     COPY DPPD013.                                                65520004
