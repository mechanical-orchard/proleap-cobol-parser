000400 IDENTIFICATION DIVISION.                                         00040001
000500                                                                  00050001
000600 PROGRAM-ID.         PCKUT125.                                    00060001
000700 AUTHOR.             DENISE HAHN.                                 00070002
000800 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00080001
000900 DATE-WRITTEN.       MARCH 2024.                                  00090002
001000 DATE-COMPILED.                                                   00100001
001100************************************************************      00110001
001200* THIS PROGRAM PREPS THE PACK-TO-LIGHT UNITS WORK FILE FOR        00120001
001300* CHECKPOINT/RESTART PROCESSING FUNCTIONS WHEN UPDATING THE       00130001
001400* UNITS WORKED TABLES IN PROGRAM PCKUP024.                        00140001
001410*                                                                 00141004
001411* CHECKPOINT RESTART DB2 TABLES USED IN THE MODULES               00141104
001420*     - MODULES DPKUT900/DPKUT901                                 00142004
001421*     - TCKRSTINF                                                 00142104
001430*     - TCKRSTCNTL                                                00143003
001500************************************************************      00150001
001600 ENVIRONMENT DIVISION.                                            00160001
001700 CONFIGURATION SECTION.                                           00170001
001800                                                                  00180001
001900 SOURCE-COMPUTER.    IBM-3090.                                    00190001
002000 OBJECT-COMPUTER.    IBM-3090.                                    00200001
002100                                                                  00210001
002200 INPUT-OUTPUT SECTION.                                            00220001
002300 FILE-CONTROL.                                                    00230001
002400                                                                  00240001
002500     SELECT PICKMADE-EXTRACT-IN          ASSIGN TO INP01.         00250001
002600                                                                  00260001
002700 DATA DIVISION.                                                   00270001
002800 FILE SECTION.                                                    00280001
002900                                                                  00290001
003000 FD  PICKMADE-EXTRACT-IN                                          00300001
003100     LABEL RECORDS ARE STANDARD                                   00310001
003200     RECORDING MODE IS F                                          00320001
003300     BLOCK CONTAINS 0 RECORDS                                     00330001
003400     RECORD CONTAINS 300 CHARACTERS                               00340002
003500     DATA RECORD IS PICKMADE-RECORD-IN.                           00350002
003600 01  PICKMADE-RECORD-IN   PIC  X(300).                            00360002
003700                                                                  00370001
003800*                                                                 00380001
003900 WORKING-STORAGE SECTION.                                         00390001
004000                                                                  00400001
004100 01  ABEND-CODE                  PIC S9(04)     VALUE +0  COMP.   00410001
004200                                                                  00420001
004300 01  PROGRAM-CONSTANTS.                                           00430001
004400     05  PC-PROGRAM-NAME         PIC X(08)      VALUE 'PCKUT125'. 00440001
004500     05  PC-TRAN-PREP-FUNC-CODES.                                 00450001
004600         10  PC-TRAN-PREP-FUNC-OPEN                               00460001
004700                                 PIC X(05)      VALUE 'OPEN '.    00470001
004800         10  PC-TRAN-PREP-FUNC-WRITE                              00480001
004900                                 PIC X(05)      VALUE 'WRITE'.    00490001
005000         10  PC-TRAN-PREP-FUNC-CLOSE                              00500001
005100                                 PIC X(05)      VALUE 'CLOSE'.    00510001
005200     05  PC-TRANS-RECORD-LENGTH  PIC S9(04)     VALUE +300 COMP.  00520002
005300     05  PC-JOB-NAME             PIC X(08)      VALUE 'PCK004  '. 00530002
005400     05  PC-PLAN-NAME            PIC X(08)      VALUE 'PCKUP024'. 00540002
005500                                                                  00550001
005600 01  PROGRAM-VARIABLES.                                           00560001
005700     05  PV-CHECKPOINT-TYPE      PIC X(01)      VALUE SPACE.      00570001
005800         88  CONTROL-BREAK                      VALUE 'C'.        00580001
005900         88  LOGICAL-TRANSACTION                VALUE 'L'.        00590001
006000         88  TIME-INTERVAL                      VALUE 'T'.        00600001
006100         88  REQUESTED-BY-PROGRAM               VALUE 'R'.        00610001
006200     05  PS-EOF-SW               PIC X(01)      VALUE 'N'.        00620002
006300         88  PS-EOF                             VALUE 'Y'.        00630002
006310         88  PS-EOF-NO                          VALUE 'N'.        00631002
006600     05  PV-CURRENT-DATE         PIC X(10).                       00660001
006700                                                                  00670001
006710*-----------------------------------------------------------------00671002
006800*     INPUT RECORD                                                00680002
006810*-----------------------------------------------------------------00681002
006900     COPY PCRD086.                                                00690002
007000                                                                  00700002
007010*-----------------------------------------------------------------00701002
007100*     CHECKPOINT PREPARATION MODULE LINKAGE SECTION - DPKUT900    00710002
007110*-----------------------------------------------------------------00711002
007300     COPY DPWS990.                                                00730001
007400                                                                  00740001
007410*-----------------------------------------------------------------00741002
007411*     CHECKPOINT PREPARATION MODULE LINKAGE SECTION               00741102
007430*-----------------------------------------------------------------00743002
007500     COPY DPLS000.                                                00750001
007600                                                                  00760001
007700     EXEC SQL                                                     00770001
007800         INCLUDE SQLCA                                            00780001
007900     END-EXEC.                                                    00790001
008000     COPY SQLCA2.                                                 00800001
008100                                                                  00810001
008200 PROCEDURE DIVISION.                                              00820001
008210*-----------------------------------------------------------------00821002
008400* 0000-MAINLINE-PROCESSING                                       *00840001
008500*      CONTROLS FLOW OF THE PROGRAM.                             *00850001
008510*-----------------------------------------------------------------00851002
008700 0000-MAINLINE-PROCESSING.                                        00870001
008800                                                                  00880001
008900     PERFORM 1000-INITIALIZE.                                     00890001
009000     PERFORM 2000-PROCESS UNTIL PS-EOF                            00900002
009100     PERFORM 9000-EOJ.                                            00910001
009200                                                                  00920001
009300     GOBACK.                                                      00930001
009400                                                                  00940001
009410*-----------------------------------------------------------------00941002
009420*                                                                 00942002
009430*-----------------------------------------------------------------00943002
009500 1000-INITIALIZE.                                                 00950001
009600                                                                  00960001
009700     OPEN INPUT PICKMADE-EXTRACT-IN.                              00970001
009800                                                                  00980001
009900     ACCEPT PC-JOB-NAME FROM SYSIN.                               00990001
010000                                                                  01000001
010100     EXEC SQL                                                     01010001
010200          SET :PV-CURRENT-DATE = CURRENT DATE                     01020001
010300     END-EXEC.                                                    01030001
010400                                                                  01040001
010500     PERFORM 8000-READ-INPUT-FILE.                                01050002
010600                                                                  01060001
011100     PERFORM 1100-ISSUE-OPEN-REQUEST.                             01110002
011300                                                                  01130001
011310*-----------------------------------------------------------------01131002
011320*                                                                 01132002
011330*-----------------------------------------------------------------01133002
011400 1100-ISSUE-OPEN-REQUEST.                                         01140001
011500                                                                  01150001
011600     MOVE PC-TRAN-PREP-FUNC-OPEN      TO DP000-FUNC-CODE.         01160001
011700     MOVE PC-JOB-NAME                 TO DP000-JOB-NAME.          01170001
011800     MOVE PC-PLAN-NAME                TO DP000-PLAN-NAME.         01180001
011900     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         01190001
012000     MOVE DP000-CKPT-TYPE-CODE        TO PV-CHECKPOINT-TYPE.      01200001
012100                                                                  01210001
012110*-----------------------------------------------------------------01211002
012120*                                                                 01212002
012130*-----------------------------------------------------------------01213002
012200 2000-PROCESS.                                                    01220001
012300     PERFORM 2100-MOVE-TRANS-DATA                                 01230001
012400                                                                  01240001
012500     PERFORM 8000-READ-INPUT-FILE.                                01250002
012600                                                                  01260001
012610*-----------------------------------------------------------------01261002
012620*                                                                 01262002
012630*-----------------------------------------------------------------01263002
012700 2100-MOVE-TRANS-DATA.                                            01270001
012800                                                                  01280001
013500     MOVE LENGTH OF PC086-EXPORT-RECORD-LAYOUT                    01350002
013600                                      TO DP000-TRANS-REC-LENGTH.  01360001
013700                                                                  01370001
013800     MOVE PC086-EXPORT-RECORD-LAYOUT  TO DP000-TRANS-REC.         01380002
013900                                                                  01390001
014000     MOVE PC-TRAN-PREP-FUNC-WRITE     TO DP000-FUNC-CODE.         01400001
014100     MOVE PC-JOB-NAME                 TO DP000-JOB-NAME.          01410001
014200     MOVE PC-PLAN-NAME                TO DP000-PLAN-NAME.         01420001
014300                                                                  01430001
014400     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         01440001
014500                                                                  01450001
014510*-----------------------------------------------------------------01451002
014520*                                                                 01452002
014530*-----------------------------------------------------------------01453002
014600 8000-READ-INPUT-FILE.                                            01460002
014700                                                                  01470001
014800     READ PICKMADE-EXTRACT-IN INTO PC086-EXPORT-RECORD-LAYOUT     01480002
014900         AT END                                                   01490001
015000           SET PS-EOF                 TO TRUE                     01500002
015100     END-READ.                                                    01510001
015200                                                                  01520001
015210*-----------------------------------------------------------------01521002
015220*                                                                 01522002
015230*-----------------------------------------------------------------01523002
015300 9000-EOJ.                                                        01530001
015400     CLOSE PICKMADE-EXTRACT-IN.                                   01540001
015500                                                                  01550001
015900     PERFORM 9100-ISSUE-CLOSE-REQUEST.                            01590002
016100                                                                  01610001
016110*-----------------------------------------------------------------01611002
016120*                                                                 01612002
016130*-----------------------------------------------------------------01613002
016200 9100-ISSUE-CLOSE-REQUEST.                                        01620001
016300                                                                  01630001
016400     MOVE PC-TRAN-PREP-FUNC-CLOSE TO DP000-FUNC-CODE.             01640001
016500     MOVE PC-JOB-NAME TO DP000-JOB-NAME.                          01650001
016600     MOVE PC-PLAN-NAME TO DP000-PLAN-NAME.                        01660001
016700                                                                  01670001
016800     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         01680001
016900                                                                  01690001
016910*-----------------------------------------------------------------01691002
016920*     TRANSACTION PREPARATION MODULE CALL AND ERROR ROUTINES.     01692002
016930*-----------------------------------------------------------------01693002
017000     COPY DPPD000.                                                01700001
017100*                                                                 01710001
