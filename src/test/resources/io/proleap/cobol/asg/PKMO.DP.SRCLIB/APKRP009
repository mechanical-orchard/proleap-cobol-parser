000100******************************************************************00010021
000200 IDENTIFICATION DIVISION.                                         00020021
000300******************************************************************00030021
000400                                                                  00040021
000500 PROGRAM-ID.             APKRP009.                                00050021
000600 AUTHOR.                 NANCY EILBES.                            00060021
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070021
000800 DATE-WRITTEN            01-06-98.                                00080021
000900 DATE-COMPILED.                                                   00090021
001000                                                                  00100021
001100******************************************************************00110021
001200*   IMPORT DISCOUNTS AND CHARGES FOR BALANCING REPORT            *00120021
001210*                                                                *00130021
001300*  THIS PROGRAM WILL GENERATE A REPORT OF ANY DISCOUNTS OR MISC  *00140021
001400*  CHARGES OR FREIGHT CHARGES THAT WERE INCLUDED IN AN IMPORT    *00150021
001500*  INVOICE THAT WAS RELEASED FOR POSTING TODAY.  THESE AMOUNTS   *00160021
001600*  ARE REFLECTED IN THE ADDITIONS TO ADJUSTMENT JOURNAL REPORT   *00170021
001610*  BUT ARE EXCLUDED FROM PEOPLESOFT SO AP IS UNABLE TO BALANCE   *00180021
001620*  WITHOUT A REPORT OF THESE AMOUNTS.                            *00190021
001810*                                                                *00200021
001820* INPUT:                                                         *00210021
001830*  1. IMPORT AP TRANSACTIONS  COPYBOOK APRD040                   *00220021
001901*                                                                *00230021
001910* OUTPUT:                                                        *00240021
001920*  1. IMPORT DISCOUNTS AND CHARGES BALANCING REPORT              *00250021
001930*                                                                *00260021
002000******************************************************************00270021
002001* CHANGE LOG:                                                    *00280021
002002*                                                                *00290021
002003*  07/20/01                                                      *00300021
002004*     CHANGED THE IMPORT-AP-FILE LRECL SIZE FROM 400 TO 500.     *00310021
002005*     THIS CHANGE WAS MADE SINCE COPYBOOK APRD040 WAS EXPANDED   *00320021
002006*     TO 500.                                                    *00330021
002007*     MADE BY: ALEXIS KEIKER              WR/IR #: WR22467       *00340021
002008*                                                                *00350021
002009*  09/26/2006                                                    *00360021
002010*     RECOMPILE FROM PRODUCTION TO PICK UP THE NEW FIELD         *00370021
002011*     AP040-SEPARATE-CHCK IN THE APRD040 COPYBOOK.               *00380021
002013*     MADE BY: KRYSTEN LEARY              WR/IR #: WR31177       *00390021
002014*                                                                *00400021
002015*  03/22/2007                                                    *00410021
002016*     RECOMPILE FROM PRODUCTION TO PICK UP THE NEW FIELDS        *00420021
002017*     AP040-WTHD-SETID, AP040-WTHD-SW, AND AP040-WTHD-CD IN THE  *00430021
002018*     APRD040 COPYBOOK.                                          *00440021
002019*     MADE BY: KRYSTEN LEARY              WR/IR #: WR32060       *00450021
002015*  03/07/2019                                                    *00460021
002016*     ADDED 3 NEW DISCOUNT FIELDS.                               *00470021
002017*     AP040-COOP-DISC-AMT,AP040-ALW-DISC-AMT,AP040-MSC-DISC-AMT  *00480021
002018*     APRD040 COPYBOOK. CHANGED LINES ARE MARKED WITH 220043.    *00490021
002019*     MADE BY: ELENA MOZNAIM              CHG#: CHG0220043       *00500021
002020******************************************************************00510021
002030                                                                  00520021
002100 ENVIRONMENT DIVISION.                                            00530021
002400 CONFIGURATION SECTION.                                           00540021
002500                                                                  00550021
002600 SOURCE-COMPUTER.        IBM-3090.                                00560021
002700 OBJECT-COMPUTER.        IBM-3090.                                00570021
002800                                                                  00580021
002900 INPUT-OUTPUT SECTION.                                            00590021
003000                                                                  00600021
003100 FILE-CONTROL.                                                    00610021
003200                                                                  00620021
003300     SELECT IMPORT-AP-FILE                                        00630021
003400         ASSIGN TO INP01.                                         00640021
003500                                                                  00650021
003600     SELECT BALANCING-REPORT-FILE                                 00660021
003700         ASSIGN TO RPT01.                                         00670021
003800                                                                  00680021
003900******************************************************************00690021
004000 DATA DIVISION.                                                   00700021
004100******************************************************************00710021
004200                                                                  00720021
004300 FILE SECTION.                                                    00730021
004400                                                                  00740021
004500 FD  IMPORT-AP-FILE                                               00750021
004600     RECORDING MODE IS F                                          00760021
004700     LABEL RECORDS ARE STANDARD                                   00770021
004800     BLOCK CONTAINS 0 RECORDS                                     00780021
004900     RECORD CONTAINS 500 CHARACTERS                               00790021
005000     DATA RECORD IS IMPORT-AP-RECORD.                             00800021
005100                                                                  00810021
005200 01  IMPORT-AP-RECORD            PIC X(500).                      00820021
005300                                                                  00830021
005400 FD  BALANCING-REPORT-FILE                                        00840021
005500     RECORDING MODE IS F                                          00850021
005600     LABEL RECORDS ARE STANDARD                                   00860021
005700     BLOCK CONTAINS 0 RECORDS                                     00870021
005800     RECORD CONTAINS 132 CHARACTERS                               00880021
005900     DATA RECORD IS CR-BALANCING-REPORT-RECORD.                   00890021
006000                                                                  00900021
006100 01  CR-BALANCING-REPORT-RECORD  PIC X(132).                      00910021
006200                                                                  00920021
006300 WORKING-STORAGE SECTION.                                         00930021
006400                                                                  00940021
006500*----------------------------------------------------------------*00950021
006600*  AP IMPORT FILE RECORD LAYOUT                                   00960021
006710*----------------------------------------------------------------*00970021
006800                                                                  00980021
006900     COPY APRD040.                                                00990021
007000                                                                  01000021
007100*----------------------------------------------------------------*01010021
007200*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 01020021
007300*----------------------------------------------------------------*01030021
007400                                                                  01040021
007500     COPY DPWS132O.                                               01050021
007600                                                                  01060021
007700 01  ABEND-CODE                  PIC S9(4)    VALUE ZERO          01070021
007800                                 COMP SYNC.                       01080021
007900 01  PS-PROGRAM-SWITCHES.                                         01090021
008000     05  PS-END-OF-INPUT-FILE-IND                                 01100021
008100                                 PIC X(1)     VALUE 'N'.          01110021
008200         88  PS-END-OF-INPUT-FILE            VALUE 'Y'.           01120021
008300                                                                  01130021
008400 01  PV-PGORRAM-VARIABLES.                                        01140021
008500     05  PV-LINE-COUNT           PIC S9(4)    VALUE ZERO          01150021
008600                                 COMP SYNC.                       01160021
008700     05  PV-PAGE-COUNT           PIC S9(5)    VALUE ZERO          01170021
008800                                 COMP-3.                          01180021
008810     05  PV-DETAIL-COUNT         PIC 9(4)    VALUE ZERO.          01190021
008900                                                                  01200021
009000 01  PC-PROGRAM-CONSTANTS.                                        01210021
009100     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +79           01220021
009200                                 COMP SYNC.                       01230021
009300                                                                  01240021
009400 01  CD-CURRENT-DATE.                                             01250021
009500     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         01260021
009600     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         01270021
009700     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         01280021
009800                                                                  01290021
009900 01  CT-CURRENT-TIME.                                             01300021
010000     05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.         01310021
010100     05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.         01320021
010200     05  FILLER                  PIC 9(4)     VALUE ZERO.         01330021
010300                                                                  01340021
010400 01  TA-TOTAL-ACCUMULATORS.                                       01350021
010500     05  TEMP-DISC-AMT           PIC S9(10)V99 VALUE ZERO         01360021
010600                                 COMP-3.                          01370021
010700     05  TOTAL-DISC-AMT          PIC S9(10)V99 VALUE ZERO         01380021
010800                                 COMP-3.                          01390021
010900     05  TOTAL-TERMS-AMT         PIC S9(10)V99 VALUE ZERO         01400021
011000                                 COMP-3.                          01410021
011100     05  TOTAL-MISC-AMT          PIC S9(10)V99 VALUE ZERO         01420021
011200                                 COMP-3.                          01430021
011300     05  TOTAL-FRGT-AMT          PIC S9(10)V99 VALUE ZERO         01440021
011400                                 COMP-3.                          01450021
011500                                                                  01460021
011600 01  HL1-HEADING-LINE-1.                                          01470021
011700     05  FILLER                   PIC X(45)   VALUE SPACE.        01480021
011800     05  FILLER                   PIC X(41)   VALUE               01490021
011900     'IMPORT DISCOUNT AND CHARGES FOR BALANCING'.                 01500021
012000     05  FILLER                   PIC X(46)   VALUE SPACE.        01510021
012100                                                                  01520021
012200 01  HL2-HEADING-LINE-2.                                          01530021
012300     05  FILLER                          PIC X(04)  VALUE SPACE.  01540021
012400     05  FILLER                          PIC X(07)  VALUE         01550021
012500     '  PO # '.                                                   01560021
012600     05  FILLER                          PIC X(07)  VALUE SPACE.  01570021
012700     05  FILLER                          PIC X(05)  VALUE         01580021
012800     'TR CD'.                                                     01590021
012900     05  FILLER                          PIC X(03)  VALUE SPACE.  01600021
013000     05  FILLER                          PIC X(17)  VALUE         01610021
013100     '    DISC AMT     '.                                         01620021
013200     05  FILLER                          PIC X(03)  VALUE SPACE.  01630021
013300     05  FILLER                          PIC X(17)  VALUE         01640021
013400     ' TERMS DISC AMT  '.                                         01650021
013500     05  FILLER                          PIC X(03)  VALUE SPACE.  01660021
013600     05  FILLER                          PIC X(17)  VALUE         01670021
013700     '    MISC AMT     '.                                         01680021
013800     05  FILLER                          PIC X(04)  VALUE SPACE.  01690021
013900     05  FILLER                          PIC X(11)  VALUE         01700021
014000     '  FRGT AMT '.                                               01710021
014100                                                                  01720021
014200 01  HL3-HEADING-LINE-3.                                          01730021
014300     05  FILLER                   PIC X(04)   VALUE SPACE.        01740021
014400     05  FILLER                          PIC X(07)  VALUE         01750021
014500     '-------'.                                                   01760021
014600     05  FILLER                          PIC X(07)  VALUE SPACE.  01770021
014700     05  FILLER                          PIC X(04)  VALUE         01780021
014800     '----'.                                                      01790021
014900     05  FILLER                          PIC X(03)  VALUE SPACE.  01800021
015000     05  FILLER                          PIC X(17)  VALUE         01810021
015100     '-----------------'.                                         01820021
015200     05  FILLER                          PIC X(03)  VALUE SPACE.  01830021
015300     05  FILLER                          PIC X(17)  VALUE         01840021
015400     '-----------------'.                                         01850021
015500     05  FILLER                          PIC X(03)  VALUE SPACE.  01860021
015600     05  FILLER                          PIC X(17)  VALUE         01870021
015700     '-----------------'.                                         01880021
015800     05  FILLER                          PIC X(03)  VALUE SPACE.  01890021
015900     05  FILLER                          PIC X(17)  VALUE         01900021
016000     '-----------------'.                                         01910021
016100                                                                  01920021
016200 01  DL-DETAIL-LINE1.                                             01930021
016300     05  FILLER                          PIC X(04)  VALUE SPACE.  01940021
016400     05  DL-PONUMB                       PIC X(09)                01950021
016500                                                    VALUE ZERO.   01960021
016600     05  FILLER                          PIC X(05)  VALUE SPACES. 01970021
016700     05  DL-TRANCODE                     PIC X(02)                01980021
016800                                                    VALUE ZERO.   01990021
016900     05  FILLER                          PIC X(05)  VALUE SPACES. 02000021
017000     05  DL-DISC-AMT                     PIC Z,ZZZ,ZZZ,ZZZ.99-    02010021
017100                                                    VALUE ZERO.   02020021
017200     05  FILLER                          PIC X(05)  VALUE SPACES. 02030021
017300     05  DL-TERMS-AMT                    PIC Z,ZZZ,ZZZ,ZZZ.99-    02040021
017400                                                    VALUE ZERO.   02050021
017500     05  FILLER                          PIC X(03)  VALUE SPACES. 02060021
017600     05  DL-MISC-AMT                     PIC Z,ZZZ,ZZZ,ZZZ.99-    02070021
017700                                                    VALUE ZERO.   02080021
017800     05  FILLER                          PIC X(03)  VALUE SPACES. 02090021
017900     05  DL-FRGT-AMT                     PIC Z,ZZZ,ZZZ,ZZZ.99-    02100021
018000                                                    VALUE ZERO.   02110021
018100                                                                  02120021
018200 01  TL-TOTAL-LINE.                                               02130021
018300     05  FILLER                          PIC X(13)  VALUE SPACE.  02140021
018400     05  FILLER                          PIC X(08)  VALUE         02150021
018500     'TOTAL***'.                                                  02160021
018600     05  FILLER                          PIC X(04)  VALUE SPACE.  02170021
018700     05  TL-DISC-AMT                     PIC Z,ZZZ,ZZZ,ZZZ.99-    02180021
018800                                                    VALUE ZERO.   02190021
018900     05  FILLER                          PIC X(05)  VALUE SPACE.  02200021
019000     05  TL-TERMS-AMT                    PIC Z,ZZZ,ZZZ,ZZZ.99-    02210021
019100                                                    VALUE ZERO.   02220021
019200     05  FILLER                          PIC X(03)  VALUE SPACE.  02230021
019300     05  TL-MISC-AMT                     PIC Z,ZZZ,ZZZ,ZZZ.99-    02240021
019400                                                    VALUE ZERO.   02250021
019500     05  FILLER                          PIC X(03)  VALUE SPACE.  02260021
019600     05  TL-FRGT-AMT                     PIC Z,ZZZ,ZZZ,ZZZ.99-    02270021
019700                                                    VALUE ZERO.   02280021
019800                                                                  02290021
019900 01  EOR-LINE.                                                    02300021
020000     05  FILLER                          PIC X(29)   VALUE SPACE. 02310021
020100     05  FILLER                          PIC X(28)   VALUE        02320021
020200     '** END OF REPORT APKRP009 **'.                              02330021
020300     05  FILLER                          PIC X(29)   VALUE SPACE. 02340021
020400                                                                  02350021
020410                                                                  02360021
020420 01  NO-DATA-LINE.                                                02370021
020430     05  FILLER                          PIC X(29)   VALUE SPACE. 02380021
020440     05  FILLER                          PIC X(37)   VALUE        02390021
020450     '****** NO DATA TO REPORT TODAY ******'.                     02400021
020460     05  FILLER                          PIC X(29)   VALUE SPACE. 02410021
020470                                                                  02420021
020500******************************************************************02430021
020600 PROCEDURE DIVISION.                                              02440021
020700******************************************************************02450021
020800                                                                  02460021
020900 A100-MAINLINE.                                                   02470021
020910                                                                  02480021
021000     PERFORM B100-INITIALIZE.                                     02490021
021010                                                                  02500021
021100     PERFORM B200-PROCESS-IMPORTS                                 02510021
021200       UNTIL PS-END-OF-INPUT-FILE.                                02520021
021210                                                                  02530021
021400     PERFORM B300-EOJ-ROUTINE.                                    02540021
021500     GOBACK.                                                      02550021
021600                                                                  02560021
021700******************************************************************02570021
021800*  SET UP FOR PROGRAM PROCESSING BY OPENING ALL FILES, FILLING   *02580021
021900*  THE STANDARD REPORT HEADER, AND READING THE FIRST INPUT       *02590021
022000*  RECORD.                                                       *02600021
022100******************************************************************02610021
022200                                                                  02620021
022300 B100-INITIALIZE.                                                 02630021
022400     OPEN INPUT  IMPORT-AP-FILE                                   02640021
022500          OUTPUT BALANCING-REPORT-FILE.                           02650021
022600                                                                  02660021
022700     MOVE 'APKRP009' TO DP132O-PROGRAM-NAME.                      02670021
022800     MOVE 1 TO DP132O-REPORT-NUMBER.                              02680021
022900                                                                  02690021
023000     ACCEPT CD-CURRENT-DATE FROM DATE.                            02700021
023100     MOVE CD-CURRENT-YEAR   TO DP132O-RUN-YEAR.                   02710021
023200     MOVE CD-CURRENT-MONTH  TO DP132O-RUN-MONTH.                  02720021
023300     MOVE CD-CURRENT-DAY    TO DP132O-RUN-DAY.                    02730021
023400                                                                  02740021
023500     ACCEPT CT-CURRENT-TIME FROM TIME.                            02750021
023600     MOVE CT-CURRENT-HOUR   TO DP132O-RUN-HOUR.                   02760021
023700     MOVE CT-CURRENT-MINUTE TO DP132O-RUN-MINUTE.                 02770021
023800                                                                  02780021
023900     PERFORM R100-READ-IMPORT-AP-FILE.                            02790021
024000                                                                  02800021
024100     PERFORM W100-PRINT-HEADING-LINES.                            02810021
024110                                                                  02820021
024120     IF PS-END-OF-INPUT-FILE                                      02830021
024130        PERFORM W300-PRINT-NO-DATA-LINE                           02840021
024140     END-IF.                                                      02850021
024200                                                                  02860021
024300******************************************************************02870021
024400*  PROCESS INPUT FILE INVOICES                                   *02880021
024500******************************************************************02890021
024600                                                                  02900021
024700 B200-PROCESS-IMPORTS.                                            02910021
024710                                                                  02920021
024800     IF AP040-AP-TRN-CDE = '74'                                   02930021
024900         PERFORM C100-PROCESS-74-INPUT-RECORDS                    02940021
025000     END-IF.                                                      02950021
025100                                                                  02960021
025200     IF AP040-AP-TRN-CDE = '48' AND                               02970021
025300        AP040-DO-NOT-POST-TO-PS-AP                                02980021
025400         PERFORM C200-PROCESS-48-INPUT-RECORDS                    02990021
025500     END-IF.                                                      03000021
025600                                                                  03010021
025700     PERFORM R100-READ-IMPORT-AP-FILE.                            03020021
025800                                                                  03030021
025810******************************************************************03040021
025820*  CLOSE ALL FILES AND PRINT FINAL REPORT LINES.                 *03050021
025830******************************************************************03060021
025840                                                                  03070021
025850 B300-EOJ-ROUTINE.                                                03080021
025890                                                                  03090021
025891     IF  PV-DETAIL-COUNT > 0                                      03100021
025892         PERFORM W400-PRINT-FINAL-TOTALS                          03110021
025893     ELSE                                                         03120021
025894         PERFORM W300-PRINT-NO-DATA-LINE                          03130021
025895     END-IF.                                                      03140021
025896                                                                  03150021
025897     CLOSE IMPORT-AP-FILE                                         03160021
025898           BALANCING-REPORT-FILE.                                 03170021
025899                                                                  03180021
025900 EJECT                                                            03190021
025910******************************************************************03200021
026000*  PROCESS EACH INVOICE ONLY IF IT IS A 74 IMPORT CODE           *03210021
026100******************************************************************03220021
026200                                                                  03230021
026300 C100-PROCESS-74-INPUT-RECORDS.                                   03240021
026400                                                                  03250021
026500     INITIALIZE DL-DETAIL-LINE1.                                  03260021
026600     IF AP040-MISC-CHRG-AMT NOT = 0 OR                            03270021
026700        AP040-TRD-DISC-AMT NOT = 0                                03280021
026800         MOVE AP040-PO-NBR TO DL-PONUMB                           03290021
026900         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03300021
027000         MOVE AP040-TRD-DISC-AMT TO DL-DISC-AMT                   03310021
027100                                   TEMP-DISC-AMT                  03320021
027200         MOVE AP040-MISC-CHRG-AMT TO DL-MISC-AMT                  03330021
027300         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      03340021
027400         ADD AP040-MISC-CHRG-AMT TO TOTAL-MISC-AMT                03350021
027500         PERFORM W200-PRINT-DETAIL-LINE                           03360021
027900     END-IF.                                                      03370021
028200                                                                  03380021
028300     IF AP040-NW-STR-DISC-AMT NOT = 0                             03390021
028400         MOVE AP040-PO-NBR TO DL-PONUMB                           03400021
028500         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03410021
028600         MOVE AP040-NW-STR-DISC-AMT TO DL-DISC-AMT                03420021
028700                                       TEMP-DISC-AMT              03430021
028800         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      03440021
028900         PERFORM W200-PRINT-DETAIL-LINE                           03450021
029300     END-IF.                                                      03460021
029400                                                                  03470021
029500     IF AP040-TERM-DISC-AMT NOT = 0                               03480021
029600         MOVE AP040-PO-NBR TO DL-PONUMB                           03490021
029700         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03500021
029800         MOVE AP040-TERM-DISC-AMT   TO DL-TERMS-AMT               03510021
029900                                       TEMP-DISC-AMT              03520021
030000         ADD TEMP-DISC-AMT TO TOTAL-TERMS-AMT                     03530021
030100         PERFORM W200-PRINT-DETAIL-LINE                           03540021
030500     END-IF.                                                      03550021
030600                                                                  03560021
030700     IF AP040-MOS-DISC-AMT NOT = 0                                03570021
030800         MOVE AP040-PO-NBR TO DL-PONUMB                           03580021
030900         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03590021
031000         MOVE AP040-MOS-DISC-AMT   TO DL-DISC-AMT                 03600021
031100                                       TEMP-DISC-AMT              03610021
031200         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      03620021
031620         PERFORM W200-PRINT-DETAIL-LINE                           03630021
031700     END-IF.                                                      03640021
031800                                                                  03650021
031900     IF AP040-ADV-DISC-AMT NOT = 0                                03660021
032000         MOVE AP040-PO-NBR TO DL-PONUMB                           03670021
032100         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03680021
032200         MOVE AP040-ADV-DISC-AMT   TO DL-DISC-AMT                 03690021
032300                                       TEMP-DISC-AMT              03700021
032400         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      03710021
032820         PERFORM W200-PRINT-DETAIL-LINE                           03720021
032900     END-IF.                                                      03730021
033000                                                                  03740021
033100     IF AP040-FRGT-AMT NOT = 0                                    03750021
033200         MOVE AP040-PO-NBR TO DL-PONUMB                           03760021
033300         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03770021
033400         MOVE AP040-FRGT-AMT   TO DL-FRGT-AMT                     03780021
033500         ADD AP040-FRGT-AMT TO TOTAL-FRGT-AMT                     03790021
033600         PERFORM W200-PRINT-DETAIL-LINE                           03800021
034000     END-IF.                                                      03810021
034100                                                                  03820021
220043     IF AP040-COOP-DISC-AMT NOT = 0                               03830021
220043         MOVE AP040-PO-NBR TO DL-PONUMB                           03840021
220043         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03850021
220043         MOVE AP040-COOP-DISC-AMT TO DL-DISC-AMT                  03860021
220043                                     TEMP-DISC-AMT                03870021
220043         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      03880021
220043         PERFORM W200-PRINT-DETAIL-LINE                           03890021
220043     END-IF.                                                      03900021
220043                                                                  03910021
220043     IF AP040-ALW-DISC-AMT NOT = 0                                03920021
220043         MOVE AP040-PO-NBR TO DL-PONUMB                           03930021
220043         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     03940021
220043         MOVE AP040-ALW-DISC-AMT TO DL-DISC-AMT                   03950021
220043                                    TEMP-DISC-AMT                 03960021
220043         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      03970021
220043         PERFORM W200-PRINT-DETAIL-LINE                           03980021
220043     END-IF.                                                      03990021
220043                                                                  04000021
220043     IF AP040-MSC-DISC-AMT NOT = 0                                04010021
220043         MOVE AP040-PO-NBR TO DL-PONUMB                           04020021
220043         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     04030021
220043         MOVE AP040-MSC-DISC-AMT TO DL-DISC-AMT                   04040021
220043                                    TEMP-DISC-AMT                 04050021
220043         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      04060021
220043         PERFORM W200-PRINT-DETAIL-LINE                           04070021
220043     END-IF.                                                      04080021
034100                                                                  04090021
034200     IF PV-LINE-COUNT > 59                                        04100021
034300       INITIALIZE PV-LINE-COUNT                                   04110021
034400       PERFORM W100-PRINT-HEADING-LINES                           04120021
034500     END-IF.                                                      04130021
034600                                                                  04140021
034700                                                                  04150021
034800******************************************************************04160021
034900*  PROCESS EACH INVOICE ONLY IF IT IS A 48 IMPORT CODE           *04170021
035000******************************************************************04180021
035100                                                                  04190021
035200 C200-PROCESS-48-INPUT-RECORDS.                                   04200021
035300                                                                  04210021
035400     IF AP040-GRO-COST-AMT NOT = 0                                04220021
035500         MOVE AP040-PO-NBR TO DL-PONUMB                           04230021
035600         MOVE AP040-AP-TRN-CDE TO DL-TRANCODE                     04240021
035700         MOVE AP040-GRO-COST-AMT TO DL-DISC-AMT                   04250021
035800                                   TEMP-DISC-AMT                  04260021
035900         MOVE AP040-MISC-CHRG-AMT TO DL-MISC-AMT                  04270021
036000         ADD TEMP-DISC-AMT TO TOTAL-DISC-AMT                      04280021
036100         ADD AP040-MISC-CHRG-AMT TO TOTAL-MISC-AMT                04290021
036200         PERFORM W200-PRINT-DETAIL-LINE                           04300021
036800     END-IF.                                                      04310021
036900                                                                  04320021
037000     IF PV-LINE-COUNT > 59                                        04330021
037100       INITIALIZE PV-LINE-COUNT                                   04340021
037200       PERFORM W100-PRINT-HEADING-LINES                           04350021
037300     END-IF.                                                      04360021
037400                                                                  04370021
037500                                                                  04380021
041630******************************************************************04390021
041700*  READ A IMPORT INPUT RECORD                                    *04400021
041800******************************************************************04410021
041900                                                                  04420021
042000 R100-READ-IMPORT-AP-FILE.                                        04430021
042100     READ IMPORT-AP-FILE                                          04440021
042200         INTO AP040-TRANSACTION-FILE                              04450021
042300             AT END                                               04460021
042400                 SET PS-END-OF-INPUT-FILE TO TRUE                 04470021
042500     END-READ.                                                    04480021
042600                                                                  04490021
042610******************************************************************04500021
042620*  PRINT REPORT HEADINGS                                         *04510021
042630******************************************************************04520021
042640 W100-PRINT-HEADING-LINES.                                        04530021
042650                                                                  04540021
042660     ADD 1 TO PV-PAGE-COUNT.                                      04550021
042670     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    04560021
042680                                                                  04570021
042690     WRITE CR-BALANCING-REPORT-RECORD                             04580021
042691         FROM DP132O-STANDRD-HEADER-132-COLS                      04590021
042692         AFTER ADVANCING PAGE.                                    04600021
042693                                                                  04610021
042694     WRITE CR-BALANCING-REPORT-RECORD                             04620021
042695         FROM HL1-HEADING-LINE-1                                  04630021
042696         AFTER ADVANCING 2 LINES.                                 04640021
042697                                                                  04650021
042698     WRITE CR-BALANCING-REPORT-RECORD                             04660021
042699         FROM HL2-HEADING-LINE-2                                  04670021
042700         AFTER ADVANCING 2 LINES.                                 04680021
042701                                                                  04690021
042702     WRITE CR-BALANCING-REPORT-RECORD                             04700021
042703         FROM HL3-HEADING-LINE-3                                  04710021
042704         AFTER ADVANCING 1 LINES.                                 04720021
042705                                                                  04730021
042706     ADD 7 TO PV-LINE-COUNT.                                      04740021
042707                                                                  04750021
042708                                                                  04760021
042709******************************************************************04770021
042710*  PRINT DETAIL LINE                                             *04780021
042711******************************************************************04790021
042712                                                                  04800021
042713 W200-PRINT-DETAIL-LINE.                                          04810021
042714                                                                  04820021
042715     WRITE CR-BALANCING-REPORT-RECORD                             04830021
042716      FROM DL-DETAIL-LINE1                                        04840021
042717      AFTER ADVANCING 1 LINE.                                     04850021
042718                                                                  04860021
042719     ADD 1 TO PV-LINE-COUNT.                                      04870021
042720     ADD 1 TO PV-DETAIL-COUNT.                                    04880021
042721                                                                  04890021
042722******************************************************************04900021
042723*  PRINT NO DATA LINE                                            *04910021
042724******************************************************************04920021
042725                                                                  04930021
042726 W300-PRINT-NO-DATA-LINE.                                         04940021
042727                                                                  04950021
042728     WRITE CR-BALANCING-REPORT-RECORD                             04960021
042729         FROM NO-DATA-LINE                                        04970021
042730         AFTER ADVANCING 3 LINES.                                 04980021
042731                                                                  04990021
042732                                                                  05000021
042733     WRITE CR-BALANCING-REPORT-RECORD                             05010021
042734         FROM EOR-LINE                                            05020021
042735         AFTER ADVANCING 4 LINES.                                 05030021
042736                                                                  05040021
042737                                                                  05050021
042738******************************************************************05060021
042739*  PRINT FINAL REPORT TOTALS                                     *05070021
042740******************************************************************05080021
042741                                                                  05090021
042742 W400-PRINT-FINAL-TOTALS.                                         05100021
042743                                                                  05110021
042744     MOVE TOTAL-DISC-AMT TO TL-DISC-AMT.                          05120021
042745     MOVE TOTAL-TERMS-AMT TO TL-TERMS-AMT.                        05130021
042746     MOVE TOTAL-MISC-AMT TO TL-MISC-AMT.                          05140021
042747     MOVE TOTAL-FRGT-AMT TO TL-FRGT-AMT.                          05150021
042748                                                                  05160021
042749     WRITE CR-BALANCING-REPORT-RECORD                             05170021
042750         FROM TL-TOTAL-LINE                                       05180021
042751         AFTER ADVANCING 3 LINES.                                 05190021
042752                                                                  05200021
042753     WRITE CR-BALANCING-REPORT-RECORD                             05210021
042754         FROM EOR-LINE                                            05220021
042755         AFTER ADVANCING 4 LINES.                                 05230021
042756                                                                  05240021
042757                                                                  05250021
