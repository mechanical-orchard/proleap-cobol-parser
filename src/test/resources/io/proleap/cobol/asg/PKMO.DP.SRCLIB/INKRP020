       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    INKRP020.                                                 
       AUTHOR.        ROLLIN KRING.                                             
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  06/10/1998.                                               
       DATE-COMPILED.                                                           
      ******************************************************************        
      *             INKRP020 - CREATE SALES BASE REPORT                         
      *                                                                         
      * THIS PROGRAM REPORTS THE CURRENT SALES BASE AND ITS ASSOCIATED          
      * SHRINK BY STORE.  IT DETERMINES THE STORES TO BE REPORTED BY            
      * LOOKING AT THE REPORT TYPE ON THE CONTROL CARD.  IF THE REPORT          
      * TYPE IS 'ALL', IT REPORTS EVERY STORE ON THE SALES BASE CONTROL         
      * FILE. IF THE REPORT TYPE IS 'INV', IT REPORTS THOSE STORES ON           
      * THE SALES BASE CONTROL FILE THAT HAVE A PLANNED INVENTORY IN            
      * THE OPEN MONTH.                                                         
      *                                                                         
      * FOR EACH STORE TO BE REPORTED, IT REPORTS THE SALES BASE BEGIN          
      * AND END DATES FROM THE SALES BASE CONTROL FILE, AND THE OPEN,           
      * CUMULATIVE, AND NEXT SALES AND SHRINK FROM THE SALES BASE CUM           
      * FILE.                                                                   
      *                                                                         
      * THE CUMULATIVE SALES AND SHRINK FOR EACH STORE SHOULD BALANCE TO        
      * THE SALES AND SHRINK FOR THAT STORE ON THE SHORTAGE REPORT              
      * (INKRP146). (THE STORE WILL ONLY APPEAR ON THE SHORTAGE REPORT          
      * IF IT HAS AN ACTUAL UNBOOKED INVENTORY.)                                
      *                                                                         
      * A GRAND TOTAL LINE IS PRODUCED AT THE END OF THE REPORT. THE            
      * THE GRAND TOTAL OF THE 'OPEN' SALES AND SHRINK PLUS THE GRAND           
      * TOTAL OF THE 'NEXT'  SALES AND SHRINK SHOULD BALANCE TO THE             
      * SALES AND SHRINK COMPANY TOTALS ON THE STORE INVENTORY REPORTS.         
      *                                                                         
      ******************************************************************        
      *    MODIFIED  01/26/1999  BY: PAUL KEBER      PROJECT: WR5701.  *        
      *  - REPLACED THE LONG RUNNING SQL IN THE B390-ACCUM-CUM ROUTINE *        
      *    WITH A SORTED PLATINUM UNLOAD FILE OF TMNSCLS TABLE INFO    *        
      *    IN ORDER TO REDUCE RUN TIME.                                *        
      *  - REPLACED THE LONG RUNNING SQL IN THE B392-ACCUM-CUM ROUTINE *        
      *    WITH A SORTED PLATINUM UNLOAD FILE OF TINSCLS TABLE INFO    *        
      *    IN ORDER TO REDUCE RUN TIME.                                *        
      *                                                                         
      *    MODIFIED  02/11/1999  BY: PAUL KEBER      PROJECT: WR5701.  *        
      *  - REPLACED THE SQL IN THE C050-GET-LAST-INV-DATE,             *        
      *    C055-CHECK-IF-INVENTORING, B380-ACCUM-OPEN, AND             *        
      *    B385-ACCUM-OPEN ROUTINE WITH CURSORS, AND REPLACED THE SQL  *        
      *    IN THE B394-ACCUM-NEXT ROUTINE WITH DATA FROM THE NEW       *        
      *    B385-ACCUM-OPEN CURSOR IN ORDER TO REDUCE RUN TIME.         *        
      *                                                                         
      ******************************************************************        
      *    MODIFIED  02/18/1999  BY: JULIE SEIDLER   PROJECT: WR9999.  *        
      *                                                                         
      *  - MODIFIED REPORT PRINTING LOGIC TO GENERATE A REPORT LISTING *        
      *    ONLY STORES INVENTORYING DURING THE OPEN FISCAL MONTH.      *        
      *    THIS INCLUDED ADDING AN INPUT CONTROL FILE INDICATING TO    *        
      *    PRINT ALL STORE DATA OR PRINT JUST INVENTORYING STORE DATA.          
      *    ALSO ADDED LOGIC TO DETERMINE WHICH STORES ARE INVENTORY             
      *    DURING THE CURRENT OPEN FISCAL MONTH.                                
      *                                                                         
      ******************************************************************        
      *    MODIFIED  03/20/2000  BY: TESS BESTE      PROJECT: WR20839           
      *                                                                         
      *    REWROTE PROGRAM TO GET THE STORES TO BE REPORTED AND THEIR           
      *    SALES BASE DATES FROM THE SALES BASE CONTROL FILE, AND TO            
      *    GET ALL SALES AND SHRINK AMOUNTS FROM THE SALES BASE CUM             
      *    FILE. REMOVED ALL LOGIC FOR DETERMINING THE SALES BASE               
      *    DATES AND CALCULATING THE SALES AND SHRINK.                          
      *                                                                         
      ******************************************************************        
      *    MODIFIED  06/08/2000  BY: RONNA BUTZ      PROJECT: WR21015           
      *                                                                         
      *    MODIFIED PROGRAM TO CREATE THREE DIFFERENT REPORTS EVERY             
      *    TIME IT IS EXECUTED.  THE FIRST REPORT IS A SALES BASE               
      *    REPORT FOR ALL STORES, THE SECOND REPORT IS A SALES BASE             
      *    REPORT FOR STORES DOING A PHYSICAL INVENTORY, AND THE                
      *    THIRD REPORT IS A SALES BASE REPORT FOR STORES THAT ARE              
      *    EITHER DOING AN ESTIMATE INVENTORY OR NO INVENTORY.                  
      *                                                                         
      ******************************************************************        
23511 * 06/13/2002          MADE BY: V. LEE YANG WR/IR #: 23511                 
  |   *  CHANGE MADE: UPDATE SALES BASE EXTRACTION PROCESS TO INCLUDE           
  |   *      FUTURE PHYSICAL INVENTORYING STORES.  THIS WILL ACCOMMODATE        
  |   *      THE CHANGES MADE TO INKRP020 TO REPORT ON ALL PHYSICAL             
  |   *      INVENTORYING AND FUTURE PHYSICAL INVENTORYING STORES               
  |   *      REPORTS.                                                           
23511 ******************************************************************        
24029 * 01/22/2003          MADE BY: S. JACKSON  WR/IR #: 24029                 
24029 *  CHANGE MADE: UPDATE REPORTING FOR SALES BASE END DATE CHECK.           
24029 *      DEFAULT DATE OF 9999-09-09 IS PASSED FROM EXTRACT PROGRAM.         
24029 ******************************************************************        
24521 * 03/31/2003          MADE BY: S. JACKSON  WR/IR #: 24521                 
24521 *  CHANGE MADE: EXPAND ALL FIVE REPORTS TO 150 BYTES.                     
W26600* W26600  04-05-2004 ROD JANSSEN INV LEDGER STORE EXPANSION               
W20445* W20445  09-01-2004 ROD JANSSEN DETAILED INVNENTORY ADJUSTMENT           
28545 * 28545   08-10-2006 B. GRAHAM STRATAGEM DEPARTMENT INVENTORY             
28545 * 28545              REMOVE TINVPAR DCLGEN, NOT BEING USED                
W33304* W33304  11-21-2008 REPORT-2 REFORMATTED TO SHOW UP ALL ACTIVE           
W33304*                    STORES FROM ALL CYCLES. CHANGES PART OF HILO         
W34557* W34557  09-13-2011 CHANGES MADE TO SHOW SPACES FOR MONTH NAME           
W34557*                    IN REPORT-2 FOR CYCLE 99999.                         
W34557*                    CHANGES MADE TO SHOW CURRENT ML OPEN MONTH           
W34557*                    FOR MONTH NAME IN REPORTS 3,4 AND 5.                 
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT SALES-BASE-CNTL-FILE                                          
               ASSIGN TO  INP01.                                                
                                                                                
           SELECT SALES-BASE-CUM-FILE                                           
               ASSIGN TO  INP02.                                                
                                                                                
           SELECT SALES-BASE-ALL-FILE                                           
               ASSIGN TO  RPT01.                                                
                                                                                
RB0600     SELECT SALES-BASE-PHY-INV-FILE                                       
RB0600         ASSIGN TO  RPT02.                                                
RB0600                                                                          
RB0600     SELECT SALES-BASE-NO-INV-FILE                                        
RB0600         ASSIGN TO  RPT03.                                                
RB0600                                                                          
23511      SELECT SALES-BASE-ALL-PHY-INV-FILE                                   
23511          ASSIGN TO  RPT04.                                                
23511                                                                           
23511      SELECT SALES-BASE-FUT-PHY-INV-FILE                                   
23511          ASSIGN TO  RPT05.                                                
23511                                                                           
       DATA DIVISION.                                                           
                                                                                
                                                                                
       FILE SECTION.                                                            
                                                                                
                                                                                
       FD  SALES-BASE-CNTL-FILE                                                 
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 CHARACTERS.                                         
                                                                                
       01  SALES-BASE-CNTL-REC             PIC X(50).                           
                                                                                
                                                                                
       FD  SALES-BASE-CUM-FILE                                                  
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 CHARACTERS.                                         
                                                                                
W20445 01  SALES-BASE-CUM-REC              PIC X(80).                           
                                                                                
                                                                                
       FD  SALES-BASE-ALL-FILE                                                  
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 CHARACTERS.                                         
                                                                                
W24521 01  SALES-BASE-ALL-LINE             PIC X(150).                          
                                                                                
                                                                                
RB0600 FD  SALES-BASE-PHY-INV-FILE                                              
RB0600     RECORDING MODE IS F                                                  
RB0600     LABEL RECORDS ARE STANDARD                                           
RB0600     BLOCK CONTAINS 0 CHARACTERS.                                         
RB0600                                                                          
W24521 01  SALES-BASE-PHY-INV-LINE         PIC X(150).                          
RB0600                                                                          
RB0600                                                                          
RB0600 FD  SALES-BASE-NO-INV-FILE                                               
RB0600     RECORDING MODE IS F                                                  
RB0600     LABEL RECORDS ARE STANDARD                                           
RB0600     BLOCK CONTAINS 0 CHARACTERS.                                         
RB0600                                                                          
W24521 01  SALES-BASE-NO-INV-LINE          PIC X(150).                          
RB0600                                                                          
RB0600                                                                          
23511  FD  SALES-BASE-ALL-PHY-INV-FILE                                          
23511      RECORDING MODE IS F                                                  
23511      LABEL RECORDS ARE STANDARD                                           
23511      BLOCK CONTAINS 0 CHARACTERS.                                         
23511                                                                           
W24521 01  SALES-BASE-ALL-PHY-INV-LINE     PIC X(150).                          
23511                                                                           
23511                                                                           
23511  FD  SALES-BASE-FUT-PHY-INV-FILE                                          
23511      RECORDING MODE IS F                                                  
23511      LABEL RECORDS ARE STANDARD                                           
23511      BLOCK CONTAINS 0 CHARACTERS.                                         
23511                                                                           
W24521 01  SALES-BASE-FUT-PHY-INV-LINE     PIC X(150).                          
23511                                                                           
23511                                                                           
       WORKING-STORAGE SECTION.                                                 
                                                                                
      ****************************************************************          
      *  ERROR MESSAGE AREA FOR DB2                                             
      ****************************************************************          
                                                                                
           COPY DPWS004.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * RECORD LAYOUT FOR SALES BASE CONTROL FILE                               
      ******************************************************************        
                                                                                
           COPY INRD022.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * RECORD LAYOUT FOR SALES BASE CUM FILE                                   
      ******************************************************************        
                                                                                
W20445     COPY INRD023.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * STANDARD 132 COL HEADER                                                 
      ******************************************************************        
                                                                                
           COPY DPWS150O.                                                       
                                                                                
                                                                                
W33304 01  H2-HEADING2.                                                         
W33304     05  FILLER                      PIC X(06)    VALUE                   
W33304     'CYCLE '.                                                            
W33304     05  PV-CYCLE-NUM                PIC 9(05)    VALUE ZEROS.            
W33304     05  FILLER                      PIC X(54)    VALUE SPACE.            
W33304     05  PV-CYCLE-NAME               PIC X(20)    VALUE SPACES.           
W33304     05  FILLER                      PIC X(65)    VALUE SPACES.           
W33304                                                                          
W33304 01  H2-HEADING2-MONTH.                                                   
W33304     05  FILLER                      PIC X(06)    VALUE                   
W33304     'MONTH '.                                                            
W33304     05  PV-MONTH-NAME-SHORT         PIC X(03)    VALUE SPACES.           
W33304     05  FILLER                      PIC X(56)    VALUE SPACE.            
W33304     05  PV-MONTH-NAME-FULL          PIC X(09)    VALUE SPACES.           
W33304     05  FILLER                      PIC X(71)    VALUE SPACES.           
W33304                                                                          
       01  H3-HEADING3.                                                         
           05  FILLER                      PIC X(50)    VALUE SPACES.           
           05  FILLER                      PIC X(50)    VALUE                   
RB0600     '       SALES BASE FOR ALL STORES        '.                          
           05  FILLER                      PIC X(50)    VALUE SPACES.           
                                                                                
       01  H3-HEADING3-II.                                                      
           05  FILLER                      PIC X(50)    VALUE SPACES.           
RB0600     05  FILLER                      PIC X(50)    VALUE                   
RB0600     ' SALES BASE FOR STORES DOING A PHYSICAL INVENTORY '.                
RB0600     05  FILLER                      PIC X(50)    VALUE SPACES.           
RB0600                                                                          
RB0600 01  H3-HEADING3-III.                                                     
RB0600     05  FILLER                      PIC X(40)    VALUE SPACES.           
RB0600     05  FILLER                      PIC X(35)    VALUE                   
RB0600     '  SALES BASE FOR STORES DOING AN ES'.                               
RB0600     05  FILLER                      PIC X(35)    VALUE                   
RB0600     'TIMATE INVENTORY OR NO INVENTORY   '.                               
RB0600     05  FILLER                      PIC X(40)    VALUE SPACES.           
RB0600                                                                          
23511  01  H3-HEADING3-IV.                                                      
23511      05  FILLER                      PIC X(50)    VALUE SPACES.           
23511      05  FILLER                      PIC X(50)    VALUE                   
23511      '   SALES BASE FOR PHYSICAL INVENTORYING STORES    '.                
23511      05  FILLER                      PIC X(50)    VALUE SPACES.           
23511                                                                           
23511  01  H3-HEADING3-V.                                                       
23511      05  FILLER                      PIC X(50)    VALUE SPACES.           
23511      05  FILLER                      PIC X(50)    VALUE                   
23511      '   SALES BASE FOR FUTURE PHYSICAL INVENTORY STORES'.                
23511      05  FILLER                      PIC X(50)    VALUE SPACES.           
23511                                                                           
       01  H4-HEADING4.                                                         
           05  FILLER                      PIC X(53)    VALUE                   
           '         SALES BASE    SALES BASE      ------------- '.             
           05  H4-MONTH-NAME               PIC X(09)    VALUE SPACE.            
           05  FILLER                      PIC X(55)    VALUE                   
           '---------         ---------- CUMULATIVE ----------'.                
           05  FILLER                      PIC X(33)    VALUE                   
           '--------- NEXT SALES BASE -------'.                                 
                                                                                
       01  H5-HEADING5.                                                         
           05  FILLER                      PIC X(47)    VALUE                   
           ' STORE   BEGIN DATE    END DATE                '.                   
           05  FILLER                      PIC X(48)    VALUE                   
           ' SALES            SHRINK                  SALES '.                  
           05  FILLER                      PIC X(55)    VALUE                   
W26600     '           SHRINK              SALES           SHRINK'.             
                                                                                
       01  DL-DETAIL-LINE.                                                      
W26600     05  FILLER                      PIC X(01)    VALUE SPACE.            
W26600     05  DL-STR-NBR                  PIC X(05)    VALUE SPACE.            
W26600     05  FILLER                      PIC X(03)    VALUE SPACE.            
           05  DL-SLS-BSE-BEG-DTE          PIC X(10)    VALUE SPACE.            
W24521     05  FILLER                      PIC X(04)    VALUE SPACE.            
           05  DL-SLS-BSE-END-DTE          PIC X(10)    VALUE SPACE.            
W26600     05  FILLER                      PIC X(03)    VALUE SPACE.            
W26600     05  DL-OPN-SLS-RTL-AMT          PIC -Z,ZZZ,ZZZ,ZZZ.99                
                                                        VALUE ZEROS.            
W26600     05  FILLER                      PIC X(01)    VALUE SPACE.            
W26600     05  DL-OPN-SHNK-RTL-AMT         PIC -Z,ZZZ,ZZZ,ZZZ.99                
                                                        VALUE ZEROS.            
W26600     05  FILLER                      PIC X(04)    VALUE SPACE.            
W26600     05  DL-CUM-SLS-RTL-AMT          PIC -ZZZ,ZZZ,ZZZ,ZZZ.99              
                                                        VALUE ZEROS.            
W26600     05  FILLER                      PIC X(01)    VALUE SPACE.            
W26600     05  DL-CUM-SHNK-RTL-AMT         PIC -Z,ZZZ,ZZZ,ZZZ.99                
                                                        VALUE ZEROS.            
W26600     05  FILLER                      PIC X(02)    VALUE SPACE.            
W26600     05  DL-NXT-SLS-RTL-AMT          PIC -Z,ZZZ,ZZZ,ZZZ.99                
                                                        VALUE ZEROS.            
W26600     05  FILLER                      PIC X(01)    VALUE SPACE.            
W26600     05  DL-NXT-SHNK-RTL-AMT         PIC -ZZZZ,ZZZ,ZZZ.99                 
                                                        VALUE ZEROS.            
       01  TL-TOTAL-LINE.                                                       
W33304     05  FILLER                      PIC X(15)    VALUE                   
W33304         '**** TOTAL ****'.                                               
W33304     05  FILLER                      PIC X(20)    VALUE SPACE.            
           05  TL-CUR-SALES                PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
                                                        VALUE ZEROS.            
           05  TL-CUR-SHRINK               PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
                                                        VALUE ZEROS.            
           05  FILLER                      PIC X(05)    VALUE SPACE.            
           05  TL-CUM-SALES                PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
                                                        VALUE ZEROS.            
           05  TL-CUM-SHRINK               PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
                                                        VALUE ZEROS.            
W26600     05  FILLER                      PIC X(01)    VALUE SPACE.            
           05  TL-NEXT-SALES               PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
                                                        VALUE ZEROS.            
           05  TL-NEXT-SHRINK              PIC -Z,ZZZ,ZZZ,ZZZ.99                
                                                        VALUE ZEROS.            
                                                                                
W33304 01  TL-COMMON-TOTAL-LINE.                                                
W33304     05  FILLER                      PIC X(05)    VALUE                   
W33304         '**** '.                                                         
W33304     05  TL-COMM-VERBIAGE            PIC X(10)    VALUE SPACE.            
W33304     05  FILLER                      PIC X(20)    VALUE                   
W33304         'TOTAL ****'.                                                    
W33304     05  TL-COMM-CUR-SALES           PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
W33304                                                  VALUE ZEROS.            
W33304     05  TL-COMM-CUR-SHRINK          PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
W33304                                                  VALUE ZEROS.            
W33304     05  FILLER                      PIC X(05)    VALUE SPACE.            
W33304     05  TL-COMM-CUM-SALES           PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
W33304                                                  VALUE ZEROS.            
W33304     05  TL-COMM-CUM-SHRINK          PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
W33304                                                  VALUE ZEROS.            
W33304     05  FILLER                      PIC X(01)    VALUE SPACE.            
W33304     05  TL-COMM-NEXT-SALES          PIC -ZZ,ZZZ,ZZZ,ZZZ.99               
W33304                                                  VALUE ZEROS.            
W33304     05  TL-COMM-NEXT-SHRINK         PIC -Z,ZZZ,ZZZ,ZZZ.99                
W33304                                                  VALUE ZEROS.            
W33304                                                                          
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-MAX-RETRIES              PIC S9(3)    VALUE +3.               
24029      05  PC-FUTURE-DATE              PIC X(10) VALUE '9999-09-09'.        
                                                                                
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
RB0600     05  PS-PROCESS-STR-SW           PIC X        VALUE 'N'.              
RB0600         88  PS-PROCESS-STR                       VALUE 'Y'.              
           05  PS-END-OF-CUM-FILE-SW       PIC X        VALUE 'N'.              
               88  PS-END-OF-CUM-FILE                   VALUE 'Y'.              
           05  PS-END-OF-CNTL-FILE-SW      PIC X        VALUE 'N'.              
               88  PS-END-OF-CNTL-FILE                  VALUE 'Y'.              
W33304     05  PS-INCOMPLETE-HEADERS-SW    PIC X        VALUE 'N'.              
W33304         88  PS-INCOMPLETE-HEADERS-YES            VALUE 'Y'.              
W33304         88  PS-INCOMPLETE-HEADERS-NO             VALUE 'N'.              
W33304         88  PS-DETAIL-LINES-WRITTEN              VALUE ' '.              
W33304     05  PS-FIRST-TIME-IN-SW         PIC X        VALUE 'Y'.              
W33304         88  PS-FIRST-TIME-IN                     VALUE 'Y'.              
23511      05  PS-REPORT-TYPE              PIC X(05)    VALUE SPACES.           
23511          88  PS-RPT01                             VALUE 'RPT01'.          
23511          88  PS-RPT02                             VALUE 'RPT02'.          
23511          88  PS-RPT03                             VALUE 'RPT03'.          
23511          88  PS-RPT04                             VALUE 'RPT04'.          
23511          88  PS-RPT05                             VALUE 'RPT05'.          
                                                                                
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-SQL-SUB                 PIC S9(4)     VALUE ZERO              
                                                        COMP SYNC.              
           05  PV-ABEND-CODE              PIC S9(04)    VALUE ZERO              
                                                        COMP SYNC.              
           05  PV-MAX-STR-NBR             PIC S9(4)     VALUE ZERO              
                                                        COMP SYNC.              
W33304     05  PV-HOLD-INV-ID             PIC S9(9)     VALUE ZERO              
W33304                                                  COMP SYNC.              
W33304     05  PV-MAX-INV-ID              PIC S9(9)     VALUE ZERO              
W33304                                                  COMP SYNC.              
W33304     05  PV-HOLD-INV-DATE           PIC X(10)     VALUE SPACES.           
W33304     05  PV-HOLD-FSCL-MN-NAME       PIC X(09)     VALUE SPACES.           
W34557     05  PV-HOLD-OPEN-MN-NAME       PIC X(09)     VALUE SPACE.            
W33304     05  PV-FSCL-MN-NAME            PIC X(09)     VALUE SPACES.           
           05  PV-PAGE-NBR                PIC S9(05)    VALUE ZEROS.            
           05  PV-LINE-MAX                PIC S9(02)    VALUE +60.              
           05  PV-LINE-CNT                PIC S9(02)    VALUE +61.              
           05  PV-DATE.                                                         
               10  PV-YEAR                PIC X(02)     VALUE SPACE.            
               10  PV-MONTH               PIC X(02)     VALUE SPACE.            
               10  PV-DAY                 PIC X(02)     VALUE SPACE.            
           05  PV-TIME.                                                         
               10  PV-HOUR                PIC X(02)     VALUE SPACE.            
               10  PV-MINUTE              PIC X(02)     VALUE SPACE.            
               10  FILLER                 PIC X(02)     VALUE SPACE.            
               10  FILLER                 PIC X(02)     VALUE SPACE.            
W26600     05  PV-STR-NBR-9               PIC 9(05)     VALUE ZERO.             
W26600     05  PV-STR-NBR-X               PIC X(05)     VALUE SPACE.            
           05  PV-OPN-FSCL-MN-BEG-DTE     PIC X(10)     VALUE SPACE.            
           05  PV-PARAGRAPH-NAME          PIC X(30)     VALUE SPACE.            
RB0600     05  PV-TOTALS.                                                       
W20445         10  PV-TOT-OPN-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS             
                                                        COMP-3.                 
               10  PV-TOT-OPN-SHNK-RTL-AMT                                      
W20445                                    PIC S9(13)V99 VALUE ZEROS             
                                                        COMP-3.                 
W20445         10  PV-TOT-CUM-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS             
                                                        COMP-3.                 
               10  PV-TOT-CUM-SHNK-RTL-AMT                                      
W20445                                    PIC S9(13)V99 VALUE ZEROS             
                                                        COMP-3.                 
W20445         10  PV-TOT-NXT-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS             
                                                        COMP-3.                 
               10  PV-TOT-NXT-SHNK-RTL-AMT                                      
W20445                                    PIC S9(13)V99 VALUE ZEROS             
                                                        COMP-3.                 
                                                                                
W33304     05  PV-GRND-TOTALS.                                                  
W33304         10  PV-GRND-TOT-OPN-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS        
W33304                                                  COMP-3.                 
W33304         10  PV-GRND-TOT-OPN-SHNK-RTL-AMT                                 
W33304                                    PIC S9(13)V99 VALUE ZEROS             
W33304                                                  COMP-3.                 
W33304         10  PV-GRND-TOT-CUM-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS        
W33304                                                  COMP-3.                 
W33304         10  PV-GRND-TOT-CUM-SHNK-RTL-AMT                                 
W33304                                    PIC S9(13)V99 VALUE ZEROS             
W33304                                                  COMP-3.                 
W33304         10  PV-GRND-TOT-NXT-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS        
W33304                                                  COMP-3.                 
W33304         10  PV-GRND-TOT-NXT-SHNK-RTL-AMT                                 
W33304                                    PIC S9(13)V99 VALUE ZEROS             
W33304                                                  COMP-3.                 
W33304     05  PV-MNTH-TOTALS.                                                  
W33304         10  PV-MNTH-TOT-OPN-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS        
W33304                                                  COMP-3.                 
W33304         10  PV-MNTH-TOT-OPN-SHNK-RTL-AMT                                 
W33304                                    PIC S9(13)V99 VALUE ZEROS             
W33304                                                  COMP-3.                 
W33304         10  PV-MNTH-TOT-CUM-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS        
W33304                                                  COMP-3.                 
W33304         10  PV-MNTH-TOT-CUM-SHNK-RTL-AMT                                 
W33304                                    PIC S9(13)V99 VALUE ZEROS             
W33304                                                  COMP-3.                 
W33304         10  PV-MNTH-TOT-NXT-SLS-RTL-AMT PIC S9(13)V99 VALUE ZEROS        
W33304                                                  COMP-3.                 
W33304         10  PV-MNTH-TOT-NXT-SHNK-RTL-AMT                                 
W33304                                    PIC S9(13)V99 VALUE ZEROS             
W33304                                                  COMP-3.                 
                                                                                
      ******************************************************************        
      *    STORE TABLE                                                          
      ******************************************************************        
                                                                                
       01  ST-SUB                           PIC S9(04)    COMP SYNC.            
W33304 01  IN-SUB                           PIC S9(04)    COMP SYNC.            
W33304 01  IN-INIT-TBL-INDX                 PIC S9(04)    COMP SYNC.            
W33304 01  ST-INV-SUB                       PIC S9(09)    COMP SYNC.            
W26600 01  ST-MAX-ENTRIES                   PIC S9(04) COMP VALUE 9999.         
       01  ST-STORE-TABLE.                                                      
W26600     05  ST-STORE-TABLE-ENTRY          OCCURS 9999 TIMES.                 
W33304         10  ST-INV-ID                 PIC 9(09) VALUE ZEROS.             
W26600         10  ST-STR-NBR                PIC 9(05) VALUE ZEROS.             
               10  ST-SLS-BSE-BEG-DTE        PIC X(10) VALUE SPACES.            
               10  ST-SLS-BSE-END-DTE        PIC X(10) VALUE SPACES.            
W26600         10  ST-OPN-SLS-RTL-AMT        PIC S9(11)V99                      
                                             COMP-3 VALUE ZEROS.                
W26600         10  ST-OPN-SHNK-RTL-AMT       PIC S9(11)V99                      
                                             COMP-3  VALUE ZEROS.               
W26600         10  ST-CUM-SLS-RTL-AMT        PIC S9(11)V99                      
                                             COMP-3 VALUE ZEROS.                
W26600         10  ST-CUM-SHNK-RTL-AMT       PIC S9(11)V99                      
                                             COMP-3 VALUE ZEROS.                
W26600         10  ST-NXT-SLS-RTL-AMT        PIC S9(11)V99                      
                                             COMP-3 VALUE ZEROS.                
W26600         10  ST-NXT-SHNK-RTL-AMT       PIC S9(11)V99                      
                                             COMP-3 VALUE ZEROS.                
W33304         10  ST-SCHEDULED-INV-TYPE-CDE PIC X(02) VALUE SPACES.            
                                                                                
W33304 01  IN-CYCLE-TABLE.                                                      
W33304     05  IN-CYCLE-TABLE-ENTRY          OCCURS 9999 TIMES.                 
W33304         10  IN-INV-ID                 PIC 9(09) VALUE ZEROS.             
W33304         10  IN-STR-NBR                PIC 9(05) VALUE ZEROS.             
W33304         10  IN-SLS-BSE-BEG-DTE        PIC X(10) VALUE SPACES.            
W33304         10  IN-SLS-BSE-END-DTE        PIC X(10) VALUE SPACES.            
W33304         10  IN-OPN-SLS-RTL-AMT        PIC S9(11)V99                      
W33304                                       COMP-3 VALUE ZEROS.                
W33304         10  IN-OPN-SHNK-RTL-AMT       PIC S9(11)V99                      
W33304                                       COMP-3 VALUE ZEROS.                
W33304         10  IN-CUM-SLS-RTL-AMT        PIC S9(11)V99                      
W33304                                       COMP-3 VALUE ZEROS.                
W33304         10  IN-CUM-SHNK-RTL-AMT       PIC S9(11)V99                      
W33304                                       COMP-3 VALUE ZEROS.                
W33304         10  IN-NXT-SLS-RTL-AMT        PIC S9(11)V99                      
W33304                                       COMP-3 VALUE ZEROS.                
W33304         10  IN-NXT-SHNK-RTL-AMT       PIC S9(11)V99                      
W33304                                       COMP-3 VALUE ZEROS.                
W33304         10  IN-SCHEDULED-INV-TYPE-CDE PIC X(02) VALUE SPACES.            
W33304         10  IN-TINCNTL-DATE           PIC X(10) VALUE SPACES.            
W33304                                                                          
W33304 01  INV-REPORTED-TABLE.                                                  
W33304     05  INV-REPORTED-TABLE-ENTRY      OCCURS 9999999 TIMES.              
W33304         10  INV-REPORTED-STATUS       PIC X VALUE SPACES.                
                                                                                
      ******************************************************************        
      * MERCHANDISE LEDGER CONTROL TABLE                                        
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TMLCNTL                                                  
           END-EXEC.                                                            
                                                                                
W33304******************************************************************        
W33304* INVENTORY LEDGER CONTROL TABLE                                          
W33304******************************************************************        
W33304                                                                          
W33304     EXEC SQL                                                             
W33304         INCLUDE TINCNTL                                                  
W33304     END-EXEC.                                                            
W33304                                                                          
      ******************************************************************        
      * MERCHANDISE LEDGER DATE ATTRIBUTE TABLE                                 
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE TDTATTR                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      * DB2 COMMUNICATION AREA                                                  
      ******************************************************************        
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      * SECOND DB2 COMMUNICATION AREA                                           
      ******************************************************************        
                                                                                
           COPY SQLCA2.                                                         
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       A100-MAIN-MODULE.                                                        
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
W33304     PERFORM 2000-LOAD-INTERNAL-TABLES.                                   
RB0600*    PROCESS RPT01 - SALES BASE ALL STORES                                
23511      SET  PS-RPT01              TO TRUE.                                  
RB0600     MOVE +61                   TO PV-LINE-CNT.                           
           MOVE 1                     TO DP150O-REPORT-NUMBER.                  
RB0600     INITIALIZE  PV-TOTALS.                                               
                                                                                
           SET PS-PROCESS-STR         TO TRUE                                   
           PERFORM 3000-PRODUCE-DETAIL-LINES                                    
               VARYING ST-SUB  FROM 1 BY 1                                      
                 UNTIL ST-SUB > PV-MAX-STR-NBR.                                 
           PERFORM 4000-PRODUCE-TOTAL-LINE.                                     
                                                                                
RB0600*    PROCESS RPT02 - SALES BASE STORES ALREADY INVENTORYED                
W33304*    THIS REPORT NOW BREAKS AND TOTALS BY INVENTORY CYCLE AND             
W33304*    FISCAL MONTH.                                                        
23511      SET  PS-RPT02              TO TRUE.                                  
RB0600     MOVE 2                     TO DP150O-REPORT-NUMBER.                  
W33304     MOVE +1                    TO ST-INV-SUB.                            
RB0600     MOVE 0                     TO PV-PAGE-NBR.                           
                                                                                
RB0600     MOVE 'N'                   TO PS-PROCESS-STR-SW.                     
RB0600                                                                          
W33304     PERFORM UNTIL ST-INV-SUB > IN-SUB                                    
W33304       IF IN-INV-ID (ST-INV-SUB) NOT = ZERO                               
W33304          MOVE IN-INV-ID (ST-INV-SUB) TO PV-HOLD-INV-ID                   
W33304          INITIALIZE  PV-TOTALS                                           
W33304          IF INV-REPORTED-STATUS(PV-HOLD-INV-ID) EQUAL SPACE              
W33304             PERFORM 8060-GET-INVENTORY-MONTH-NAME                        
W33304             IF PV-FSCL-MN-NAME NOT EQUAL PV-HOLD-FSCL-MN-NAME            
W33304                IF PS-FIRST-TIME-IN                                       
W33304                   MOVE 'N' TO PS-FIRST-TIME-IN-SW                        
W33304                ELSE                                                      
W33304                   PERFORM 4300-PRODUCE-MONTH-TOT-LINE                    
W33304                END-IF                                                    
W33304                MOVE PV-FSCL-MN-NAME TO PV-HOLD-FSCL-MN-NAME              
W33304                                        H4-MONTH-NAME                     
W33304             END-IF                                                       
W33304             MOVE +1 TO ST-SUB                                            
W33304             INITIALIZE PV-LINE-CNT                                       
W33304             MOVE PV-HOLD-INV-ID TO PV-CYCLE-NUM                          
W33304             PERFORM 8070-GET-CYCLE-NAME                                  
W33304             PERFORM UNTIL ST-SUB > PV-MAX-STR-NBR                        
W33304                 IF (ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'PI' OR          
W33304                     ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'CL' OR          
W33304                     ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'NS')            
W33304                     AND ST-SLS-BSE-END-DTE(ST-SUB) NOT = SPACES          
W33304                     AND ST-INV-ID(ST-SUB) = PV-HOLD-INV-ID               
W33304                     IF PS-INCOMPLETE-HEADERS-NO                          
W33304                        PERFORM Z200-PRODUCE-HEADINGS                     
W33304                     END-IF                                               
W33304                     SET PS-PROCESS-STR TO TRUE                           
W33304                     PERFORM 3000-PRODUCE-DETAIL-LINES                    
W33304                 END-IF                                                   
W33304                 ADD +1                 TO ST-SUB                         
W33304             END-PERFORM                                                  
W33304             PERFORM 4200-PRODUCE-CYC-TOT-LINE                            
W33304             PERFORM 3060-ACCUM-GRAND-TOTALS                              
W33304             PERFORM 3070-ACCUM-MONTH-TOTALS                              
W33304             MOVE 'Y' TO INV-REPORTED-STATUS(PV-HOLD-INV-ID)              
W33304          END-IF                                                          
W33304       END-IF                                                             
W33304       ADD +1                 TO ST-INV-SUB                               
W33304     END-PERFORM                                                          
W33304     PERFORM 4300-PRODUCE-MONTH-TOT-LINE.                                 
W33304     PERFORM 4100-PRODUCE-GRAND-TOT-LINE.                                 
RB0600                                                                          
RB0600*    PROCESS RPT03 - SALES BASE ESTIMATED/NON-PHYSICAL STORES             
23511      SET  PS-RPT03              TO TRUE.                                  
RB0600     MOVE 3                     TO DP150O-REPORT-NUMBER.                  
RB0600     INITIALIZE  PV-TOTALS.                                               
RB0600     MOVE +61                   TO PV-LINE-CNT.                           
RB0600     MOVE +1                    TO ST-SUB.                                
RB0600     MOVE 0                     TO PV-PAGE-NBR.                           
RB0600     MOVE 'N'                   TO PS-PROCESS-STR-SW.                     
W34557     MOVE PV-HOLD-OPEN-MN-NAME  TO H4-MONTH-NAME                          
23511                                                                           
23511      IF PV-LINE-CNT > PV-LINE-MAX                                         
23511          INITIALIZE PV-LINE-CNT                                           
23511          PERFORM Z200-PRODUCE-HEADINGS                                    
23511      END-IF.                                                              
23511                                                                           
RB0600     PERFORM UNTIL ST-SUB > PV-MAX-STR-NBR                                
W33304         IF ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'EI' OR                   
RB0600            ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = SPACE                     
RB0600             SET PS-PROCESS-STR TO TRUE                                   
RB0600             PERFORM 3000-PRODUCE-DETAIL-LINES                            
RB0600         END-IF                                                           
RB0600         ADD +1 TO ST-SUB                                                 
RB0600     END-PERFORM.                                                         
RB0600     PERFORM 4000-PRODUCE-TOTAL-LINE.                                     
                                                                                
23511 *    PROCESS RPT04 - SALES BASE ALL STORES PERFORMING INVENTORY           
23511      SET  PS-RPT04              TO TRUE.                                  
23511      MOVE 4                     TO DP150O-REPORT-NUMBER.                  
23511      INITIALIZE  PV-TOTALS.                                               
23511      MOVE +61                   TO PV-LINE-CNT.                           
23511      MOVE +1                    TO ST-SUB.                                
23511      MOVE 0                     TO PV-PAGE-NBR.                           
23511                                                                           
23511      MOVE 'N'                   TO PS-PROCESS-STR-SW.                     
23511                                                                           
23511      IF PV-LINE-CNT > PV-LINE-MAX                                         
23511          INITIALIZE PV-LINE-CNT                                           
23511          PERFORM Z200-PRODUCE-HEADINGS                                    
23511      END-IF.                                                              
23511                                                                           
23511      PERFORM UNTIL ST-SUB > PV-MAX-STR-NBR                                
W33304         IF (ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'PI' OR                  
W33304             ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'CL' OR                  
W33304             ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'NS')                    
23511**            AND ST-SLS-BSE-END-DTE(ST-SUB)    = SPACES                   
24029              AND ST-SLS-BSE-END-DTE(ST-SUB) NOT = PC-FUTURE-DATE          
23511              SET PS-PROCESS-STR TO TRUE                                   
23511              PERFORM 3000-PRODUCE-DETAIL-LINES                            
23511          END-IF                                                           
23511          ADD +1                 TO ST-SUB                                 
23511      END-PERFORM.                                                         
23511      PERFORM 4000-PRODUCE-TOTAL-LINE.                                     
23511                                                                           
23511 *    PROCESS RPT05 - SALES BASE FUTURE PHYSICAL STORES                    
23511      SET  PS-RPT05              TO TRUE.                                  
23511      MOVE 5                     TO DP150O-REPORT-NUMBER.                  
23511      INITIALIZE  PV-TOTALS.                                               
23511      MOVE +61                   TO PV-LINE-CNT.                           
23511      MOVE +1                    TO ST-SUB.                                
23511      MOVE 0                     TO PV-PAGE-NBR.                           
23511                                                                           
23511      MOVE 'N'                   TO PS-PROCESS-STR-SW.                     
23511                                                                           
23511      IF PV-LINE-CNT > PV-LINE-MAX                                         
23511          INITIALIZE PV-LINE-CNT                                           
23511          PERFORM Z200-PRODUCE-HEADINGS                                    
23511      END-IF.                                                              
23511                                                                           
23511      PERFORM UNTIL ST-SUB > PV-MAX-STR-NBR                                
W33304         IF (ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'PI' OR                  
W33304             ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'CL' OR                  
W33304             ST-SCHEDULED-INV-TYPE-CDE(ST-SUB) = 'NS')                    
23511**            AND ST-SLS-BSE-END-DTE(ST-SUB) = SPACES                      
24029              AND ST-SLS-BSE-END-DTE(ST-SUB) = PC-FUTURE-DATE              
23511              SET PS-PROCESS-STR TO TRUE                                   
23511              PERFORM 3000-PRODUCE-DETAIL-LINES                            
23511          END-IF                                                           
23511          ADD +1                 TO ST-SUB                                 
23511      END-PERFORM.                                                         
23511      PERFORM 4000-PRODUCE-TOTAL-LINE.                                     
23511                                                                           
           CLOSE SALES-BASE-CNTL-FILE                                           
                 SALES-BASE-CUM-FILE                                            
                 SALES-BASE-ALL-FILE                                            
RB0600           SALES-BASE-PHY-INV-FILE                                        
23511            SALES-BASE-NO-INV-FILE                                         
23511            SALES-BASE-ALL-PHY-INV-FILE                                    
23511            SALES-BASE-FUT-PHY-INV-FILE.                                   
                                                                                
           STOP RUN.                                                            
                                                                                
                                                                                
       1000-INITIALIZATION.                                                     
                                                                                
           OPEN INPUT  SALES-BASE-CNTL-FILE                                     
                       SALES-BASE-CUM-FILE.                                     
           OPEN OUTPUT SALES-BASE-ALL-FILE                                      
RB0600                 SALES-BASE-PHY-INV-FILE                                  
23511                  SALES-BASE-NO-INV-FILE                                   
23511                  SALES-BASE-ALL-PHY-INV-FILE                              
23511                  SALES-BASE-FUT-PHY-INV-FILE.                             
                                                                                
           ACCEPT PV-DATE FROM DATE.                                            
           ACCEPT PV-TIME FROM TIME.                                            
                                                                                
           PERFORM 8000-GET-OPN-FSCL-MN-DTE.                                    
           PERFORM 8050-GET-OPN-FSCL-MN-INFO.                                   
W34557     MOVE DTATTR-FSCL-MN-NM TO H4-MONTH-NAME                              
W34557                               PV-HOLD-OPEN-MN-NAME                       
           MOVE PV-MONTH    TO DP150O-RUN-MONTH.                                
           MOVE PV-DAY      TO DP150O-RUN-DAY.                                  
           MOVE PV-YEAR     TO DP150O-RUN-YEAR.                                 
           MOVE PV-HOUR     TO DP150O-RUN-HOUR.                                 
           MOVE PV-MINUTE   TO DP150O-RUN-MINUTE.                               
           MOVE 'INKRP020'  TO DP150O-PROGRAM-NAME.                             
                                                                                
      ******************************************************************        
W33304* LOAD THE ST-STORE-TABLE FROM THE SALES BASE CONTROL FILE AND            
W33304* LOAD THE IN-CYCLE-TABLE FROM THE SALES BASE CUM FILE.                   
      ******************************************************************        
W33304 2000-LOAD-INTERNAL-TABLES.                                               
                                                                                
           INITIALIZE ST-STORE-TABLE.                                           
W33304     INITIALIZE INV-REPORTED-TABLE.                                       
W33304     INITIALIZE IN-CYCLE-TABLE.                                           
                                                                                
      *    LOAD THE STORES AND THEIR SALES BASE DATES FROM THE SALES            
      *    BASE CONTROL FILE INTO THE WS STORE TABLE.                           
                                                                                
           PERFORM 7100-READ-SALES-BASE-CNTL-FILE.                              
                                                                                
           IF PS-END-OF-CNTL-FILE                                               
                DISPLAY '** ABEND **'                                           
                DISPLAY '** PGM = INKRP020 **'                                  
                DISPLAY '** SALES BASE CONTROL FILE IS EMPTY.'          INKUT119
                MOVE +4003 TO PV-ABEND-CODE                                CL**5
                CALL 'ILBOABN0'  USING PV-ABEND-CODE                    INKUT119
           END-IF.                                                              
                                                                                
W33304     PERFORM VARYING IN-SUB FROM 1 BY 1 UNTIL PS-END-OF-CNTL-FILE         
W33304         MOVE IN022-INV-ID                                                
W33304                         TO IN-INV-ID (IN-SUB)                            
W33304         IF IN022-INV-ID > PV-MAX-INV-ID                                  
W33304            MOVE IN022-INV-ID TO PV-MAX-INV-ID                            
W33304         END-IF                                                           
W33304         MOVE IN022-SLS-BSE-MN-END-DTE                                    
W33304                         TO IN-TINCNTL-DATE           (IN-SUB)            
W33304         MOVE IN022-STR-NBR                                               
W33304                         TO IN-STR-NBR                (IN-SUB)            
W33304         MOVE IN022-SLS-BSE-BEG-DTE                                       
W33304                         TO IN-SLS-BSE-BEG-DTE        (IN-SUB)            
W33304         MOVE IN022-SLS-BSE-END-DTE                                       
W33304                         TO IN-SLS-BSE-END-DTE        (IN-SUB)            
W33304         MOVE IN022-SCHEDULED-INV-TYPE-CDE                                
W33304                         TO IN-SCHEDULED-INV-TYPE-CDE (IN-SUB)            
               MOVE IN022-STR-NBR TO ST-SUB                                     
W33304         IF IN022-STR-NBR > PV-MAX-STR-NBR                                
W33304            MOVE IN022-STR-NBR TO PV-MAX-STR-NBR                          
W33304         END-IF                                                           
               IF ST-SUB > ST-MAX-ENTRIES                                       
                   DISPLAY '** ABEND **'                                        
                   DISPLAY '** PGM = INKRP020 **'                               
                   DISPLAY '** TABLE OVERFLOW ON ST-STORE-TABLE.'               
                   MOVE +4004 TO PV-ABEND-CODE                                  
                   CALL 'ILBOABN0'  USING PV-ABEND-CODE                 INKUT119
               ELSE                                                             
W33304             MOVE IN022-INV-ID                                            
W33304                             TO ST-INV-ID (ST-SUB)                        
                   MOVE IN022-STR-NBR                                           
                                   TO ST-STR-NBR                (ST-SUB)        
                   MOVE IN022-SLS-BSE-BEG-DTE                                   
                                   TO ST-SLS-BSE-BEG-DTE        (ST-SUB)        
                   MOVE IN022-SLS-BSE-END-DTE                                   
                                   TO ST-SLS-BSE-END-DTE        (ST-SUB)        
RB0600             MOVE IN022-SCHEDULED-INV-TYPE-CDE                            
RB0600                             TO ST-SCHEDULED-INV-TYPE-CDE (ST-SUB)        
                  PERFORM 7100-READ-SALES-BASE-CNTL-FILE                        
               END-IF                                                           
           END-PERFORM.                                                         
                                                                                
      *    LOAD THE SALES AND SHRINK FROM THE SALES BASE CUM FILE               
      *    INTO THE WS STORE TABLE.                                             
                                                                                
           PERFORM 7200-READ-SALES-BASE-CUM-FILE.                               
           IF PS-END-OF-CUM-FILE                                                
                DISPLAY '** ABEND **'                                           
                DISPLAY '** PGM = INKRP020 **'                                  
                DISPLAY '** SALES BASE CUM FILE IS EMPTY.'              INKUT119
                MOVE +4003 TO PV-ABEND-CODE                                CL**5
                CALL 'ILBOABN0'  USING PV-ABEND-CODE                    INKUT119
           END-IF.                                                              
                                                                                
           PERFORM UNTIL PS-END-OF-CUM-FILE                                     
               MOVE IN023-STR-NBR TO ST-SUB                                     
               IF ST-STR-NBR (ST-SUB) NOT = ZERO                                
                   MOVE IN023-OPN-SLS-RTL-AMT                                   
                        TO ST-OPN-SLS-RTL-AMT  (ST-SUB)                         
                   MOVE IN023-OPN-SHNK-RTL-AMT                                  
                        TO ST-OPN-SHNK-RTL-AMT (ST-SUB)                         
                   MOVE IN023-CUM-SLS-RTL-AMT                                   
                        TO ST-CUM-SLS-RTL-AMT  (ST-SUB)                         
                   MOVE IN023-CUM-SHNK-RTL-AMT                                  
                        TO ST-CUM-SHNK-RTL-AMT (ST-SUB)                         
                   MOVE IN023-NXT-SLS-RTL-AMT                                   
                        TO ST-NXT-SLS-RTL-AMT  (ST-SUB)                         
                   MOVE IN023-NXT-SHNK-RTL-AMT                                  
                        TO ST-NXT-SHNK-RTL-AMT (ST-SUB)                         
                   PERFORM 7200-READ-SALES-BASE-CUM-FILE                        
               END-IF                                                           
           END-PERFORM.                                                         
                                                                                
      ******************************************************************        
      * CREATE THE SALES BASE REPORT DETAIL LINES, USING THE WS STORE           
      * TABLE AS A DRIVER.                                                      
      *                                                                         
      * THERE IS A SWITCH THAT CONTROLS WHETHER THE STORE GETS PRINTED.         
      * THIS PARAGRAPH IS EXECUTED FOR FIVE  REPORTS, AND ALL REPORTS           
      * GET PRODUCED.                                                           
      *                                                                         
      ******************************************************************        
       3000-PRODUCE-DETAIL-LINES.                                               
                                                                                
RB0600     IF PS-PROCESS-STR                                                    
               IF PV-LINE-CNT > PV-LINE-MAX                                     
                   INITIALIZE PV-LINE-CNT                                       
                   PERFORM Z200-PRODUCE-HEADINGS                                
               END-IF.                                                          
                                                                                
           IF ST-STR-NBR (ST-SUB) NOT = ZERO                                    
RB0600         IF PS-PROCESS-STR                                                
                   MOVE ST-STR-NBR (ST-SUB)   TO PV-STR-NBR-9                   
                   MOVE PV-STR-NBR-9          TO DL-STR-NBR                     
                   MOVE ST-SLS-BSE-BEG-DTE  (ST-SUB)                            
                                              TO DL-SLS-BSE-BEG-DTE             
24029                                                                           
24029              IF ST-SLS-BSE-END-DTE (ST-SUB) = PC-FUTURE-DATE              
24029                  MOVE SPACES            TO DL-SLS-BSE-END-DTE             
24029              ELSE                                                         
                       MOVE ST-SLS-BSE-END-DTE  (ST-SUB)                        
                                              TO DL-SLS-BSE-END-DTE             
24029              END-IF                                                       
24029                                                                           
                   MOVE ST-OPN-SLS-RTL-AMT  (ST-SUB)                            
                                              TO DL-OPN-SLS-RTL-AMT             
                   MOVE ST-OPN-SHNK-RTL-AMT (ST-SUB)                            
                                              TO DL-OPN-SHNK-RTL-AMT            
                   MOVE ST-CUM-SLS-RTL-AMT  (ST-SUB)                            
                                              TO DL-CUM-SLS-RTL-AMT             
                   MOVE ST-CUM-SHNK-RTL-AMT (ST-SUB)                            
                                              TO DL-CUM-SHNK-RTL-AMT            
                   MOVE ST-NXT-SLS-RTL-AMT  (ST-SUB)                            
                                              TO DL-NXT-SLS-RTL-AMT             
                   MOVE ST-NXT-SHNK-RTL-AMT (ST-SUB)                            
                                              TO DL-NXT-SHNK-RTL-AMT            
RB0600             EVALUATE TRUE                                                
RB0600                 WHEN PS-RPT01                                            
RB0600                     WRITE SALES-BASE-ALL-LINE                            
                               FROM DL-DETAIL-LINE                              
                               AFTER ADVANCING 1 LINES                          
RB0600                 WHEN PS-RPT02                                            
W33304                     IF PS-INCOMPLETE-HEADERS-YES                         
W33304                        WRITE SALES-BASE-PHY-INV-LINE                     
W33304                            FROM H2-HEADING2                              
W33304                            AFTER ADVANCING 1 LINES                       
W33304                        WRITE SALES-BASE-PHY-INV-LINE                     
W33304                            FROM H4-HEADING4                              
W33304                            AFTER ADVANCING 1 LINES                       
W33304                        WRITE SALES-BASE-PHY-INV-LINE                     
W33304                            FROM H5-HEADING5                              
W33304                            AFTER ADVANCING 1 LINES                       
W33304                        SET PS-DETAIL-LINES-WRITTEN TO TRUE               
W33304                     END-IF                                               
RB0600                     WRITE SALES-BASE-PHY-INV-LINE                        
RB0600                         FROM DL-DETAIL-LINE                              
RB0600                         AFTER ADVANCING 1 LINES                          
RB0600                 WHEN PS-RPT03                                            
RB0600                     WRITE SALES-BASE-NO-INV-LINE                         
RB0600                         FROM DL-DETAIL-LINE                              
RB0600                         AFTER ADVANCING 1 LINES                          
23511                  WHEN PS-RPT04                                            
23511                      WRITE SALES-BASE-ALL-PHY-INV-LINE                    
23511                          FROM DL-DETAIL-LINE                              
23511                          AFTER ADVANCING 1 LINES                          
23511                  WHEN PS-RPT05                                            
23511                      WRITE SALES-BASE-FUT-PHY-INV-LINE                    
23511                          FROM DL-DETAIL-LINE                              
23511                          AFTER ADVANCING 1 LINES                          
RB0600             END-EVALUATE                                                 
                   ADD 1 TO PV-LINE-CNT                                         
                   PERFORM 3050-ACCUM-TOTALS                                    
               END-IF                                                           
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      * ACCUMULATE THE STORE TOTALS FOR A GRAND TOTAL AT THE END OF THE         
      * REPORT.                                                                 
      ******************************************************************        
       3050-ACCUM-TOTALS.                                                       
                                                                                
           COMPUTE PV-TOT-OPN-SLS-RTL-AMT                                       
                 = PV-TOT-OPN-SLS-RTL-AMT                                       
                 + ST-OPN-SLS-RTL-AMT (ST-SUB).                                 
           COMPUTE PV-TOT-OPN-SHNK-RTL-AMT                                      
                 = PV-TOT-OPN-SHNK-RTL-AMT                                      
                 + ST-OPN-SHNK-RTL-AMT (ST-SUB).                                
           COMPUTE PV-TOT-CUM-SLS-RTL-AMT                                       
                 = PV-TOT-CUM-SLS-RTL-AMT                                       
                 + ST-CUM-SLS-RTL-AMT (ST-SUB).                                 
           COMPUTE PV-TOT-CUM-SHNK-RTL-AMT                                      
                 = PV-TOT-CUM-SHNK-RTL-AMT                                      
                 + ST-CUM-SHNK-RTL-AMT (ST-SUB).                                
           COMPUTE PV-TOT-NXT-SLS-RTL-AMT                                       
                 = PV-TOT-NXT-SLS-RTL-AMT                                       
                 + ST-NXT-SLS-RTL-AMT (ST-SUB).                                 
           COMPUTE PV-TOT-NXT-SHNK-RTL-AMT                                      
                 = PV-TOT-NXT-SHNK-RTL-AMT                                      
                 + ST-NXT-SHNK-RTL-AMT (ST-SUB).                                
                                                                                
      ******************************************************************        
W33304* ACCUMULATE THE ALL CYCLE TOTALS FOR REPORT-2                            
W33304******************************************************************        
W33304 3060-ACCUM-GRAND-TOTALS.                                                 
W33304                                                                          
W33304     COMPUTE PV-GRND-TOT-OPN-SLS-RTL-AMT                                  
W33304           = PV-GRND-TOT-OPN-SLS-RTL-AMT                                  
W33304           + PV-TOT-OPN-SLS-RTL-AMT.                                      
W33304     COMPUTE PV-GRND-TOT-OPN-SHNK-RTL-AMT                                 
W33304           = PV-GRND-TOT-OPN-SHNK-RTL-AMT                                 
W33304           + PV-TOT-OPN-SHNK-RTL-AMT.                                     
W33304     COMPUTE PV-GRND-TOT-CUM-SLS-RTL-AMT                                  
W33304           = PV-GRND-TOT-CUM-SLS-RTL-AMT                                  
W33304           + PV-TOT-CUM-SLS-RTL-AMT.                                      
W33304     COMPUTE PV-GRND-TOT-CUM-SHNK-RTL-AMT                                 
W33304           = PV-GRND-TOT-CUM-SHNK-RTL-AMT                                 
W33304           + PV-TOT-CUM-SHNK-RTL-AMT.                                     
W33304     COMPUTE PV-GRND-TOT-NXT-SLS-RTL-AMT                                  
W33304           = PV-GRND-TOT-NXT-SLS-RTL-AMT                                  
W33304           + PV-TOT-NXT-SLS-RTL-AMT.                                      
W33304     COMPUTE PV-GRND-TOT-NXT-SHNK-RTL-AMT                                 
W33304           = PV-GRND-TOT-NXT-SHNK-RTL-AMT                                 
W33304           + PV-TOT-NXT-SHNK-RTL-AMT.                                     
W33304                                                                          
W33304******************************************************************        
W33304* ACCUMULATE THE MONTHLY TOTALS FOR REPORT-2                              
W33304******************************************************************        
W33304 3070-ACCUM-MONTH-TOTALS.                                                 
W33304                                                                          
W33304     COMPUTE PV-MNTH-TOT-OPN-SLS-RTL-AMT                                  
W33304           = PV-MNTH-TOT-OPN-SLS-RTL-AMT                                  
W33304           + PV-TOT-OPN-SLS-RTL-AMT.                                      
W33304     COMPUTE PV-MNTH-TOT-OPN-SHNK-RTL-AMT                                 
W33304           = PV-MNTH-TOT-OPN-SHNK-RTL-AMT                                 
W33304           + PV-TOT-OPN-SHNK-RTL-AMT.                                     
W33304     COMPUTE PV-MNTH-TOT-CUM-SLS-RTL-AMT                                  
W33304           = PV-MNTH-TOT-CUM-SLS-RTL-AMT                                  
W33304           + PV-TOT-CUM-SLS-RTL-AMT.                                      
W33304     COMPUTE PV-MNTH-TOT-CUM-SHNK-RTL-AMT                                 
W33304           = PV-MNTH-TOT-CUM-SHNK-RTL-AMT                                 
W33304           + PV-TOT-CUM-SHNK-RTL-AMT.                                     
W33304     COMPUTE PV-MNTH-TOT-NXT-SLS-RTL-AMT                                  
W33304           = PV-MNTH-TOT-NXT-SLS-RTL-AMT                                  
W33304           + PV-TOT-NXT-SLS-RTL-AMT.                                      
W33304     COMPUTE PV-MNTH-TOT-NXT-SHNK-RTL-AMT                                 
W33304           = PV-MNTH-TOT-NXT-SHNK-RTL-AMT                                 
W33304           + PV-TOT-NXT-SHNK-RTL-AMT.                                     
W33304                                                                          
W33304******************************************************************        
W33304* BUILD AND WRITE THE TOTAL LINE.                                         
      ******************************************************************        
       4000-PRODUCE-TOTAL-LINE.                                                 
                                                                                
           MOVE PV-TOT-OPN-SLS-RTL-AMT  TO TL-CUR-SALES.                        
           MOVE PV-TOT-OPN-SHNK-RTL-AMT TO TL-CUR-SHRINK.                       
           MOVE PV-TOT-CUM-SLS-RTL-AMT  TO TL-CUM-SALES.                        
           MOVE PV-TOT-CUM-SHNK-RTL-AMT TO TL-CUM-SHRINK.                       
           MOVE PV-TOT-NXT-SLS-RTL-AMT  TO TL-NEXT-SALES.                       
           MOVE PV-TOT-NXT-SHNK-RTL-AMT TO TL-NEXT-SHRINK.                      
                                                                                
RB0600     EVALUATE TRUE                                                        
RB0600         WHEN PS-RPT01                                                    
RB0600             WRITE SALES-BASE-ALL-LINE                                    
                       FROM TL-TOTAL-LINE                                       
                       AFTER ADVANCING 1 LINES                                  
RB0600         WHEN PS-RPT02                                                    
W33304             CONTINUE                                                     
RB0600         WHEN PS-RPT03                                                    
RB0600             WRITE SALES-BASE-NO-INV-LINE                                 
RB0600                 FROM TL-TOTAL-LINE                                       
RB0600                 AFTER ADVANCING 1 LINES                                  
23511          WHEN PS-RPT04                                                    
23511              WRITE SALES-BASE-ALL-PHY-INV-LINE                            
23511                  FROM TL-TOTAL-LINE                                       
23511                  AFTER ADVANCING 1 LINES                                  
23511          WHEN PS-RPT05                                                    
23511              WRITE SALES-BASE-FUT-PHY-INV-LINE                            
23511                  FROM TL-TOTAL-LINE                                       
23511                  AFTER ADVANCING 1 LINES                                  
RB0600     END-EVALUATE.                                                        
                                                                                
                                                                                
W33304******************************************************************        
W33304* BUILD AND WRITE THE ALL CYCLE TOTAL LINE                                
W33304******************************************************************        
W33304 4100-PRODUCE-GRAND-TOT-LINE.                                             
W33304                                                                          
W33304     PERFORM Z200-PRODUCE-HEADINGS.                                       
W33304     INITIALIZE H2-HEADING2.                                              
W33304     MOVE 99999                        TO PV-CYCLE-NUM.                   
W33304     MOVE 'ALL ACTIVE CYCLES'          TO PV-CYCLE-NAME.                  
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304         FROM H2-HEADING2                                                 
W33304         AFTER ADVANCING 1 LINES                                          
W34557     MOVE SPACES TO H4-MONTH-NAME                                         
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304         FROM H4-HEADING4                                                 
W33304         AFTER ADVANCING 1 LINES                                          
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304         FROM H5-HEADING5                                                 
W33304         AFTER ADVANCING 1 LINES                                          
W33304     INITIALIZE TL-COMMON-TOTAL-LINE.                                     
W33304     MOVE PV-GRND-TOT-OPN-SLS-RTL-AMT  TO TL-COMM-CUR-SALES.              
W33304     MOVE PV-GRND-TOT-OPN-SHNK-RTL-AMT TO TL-COMM-CUR-SHRINK.             
W33304     MOVE PV-GRND-TOT-CUM-SLS-RTL-AMT  TO TL-COMM-CUM-SALES.              
W33304     MOVE PV-GRND-TOT-CUM-SHNK-RTL-AMT TO TL-COMM-CUM-SHRINK.             
W33304     MOVE PV-GRND-TOT-NXT-SLS-RTL-AMT  TO TL-COMM-NEXT-SALES.             
W33304     MOVE PV-GRND-TOT-NXT-SHNK-RTL-AMT TO TL-COMM-NEXT-SHRINK.            
W33304     MOVE 'G R A N D' TO TL-COMM-VERBIAGE.                                
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304      FROM TL-COMMON-TOTAL-LINE AFTER ADVANCING 1 LINES.                  
W33304                                                                          
W33304******************************************************************        
W33304* BUILD AND WRITE THE CYCLE TOTAL LINE                                    
W33304******************************************************************        
W33304 4200-PRODUCE-CYC-TOT-LINE.                                               
W33304* CYC TOT LINE NEEDED ONLY IF THERE WERE DETAIL LINES.                    
W33304     IF PS-DETAIL-LINES-WRITTEN                                           
W33304        INITIALIZE TL-COMMON-TOTAL-LINE                                   
W33304        MOVE PV-TOT-OPN-SLS-RTL-AMT  TO TL-COMM-CUR-SALES                 
W33304        MOVE PV-TOT-OPN-SHNK-RTL-AMT TO TL-COMM-CUR-SHRINK                
W33304        MOVE PV-TOT-CUM-SLS-RTL-AMT  TO TL-COMM-CUM-SALES                 
W33304        MOVE PV-TOT-CUM-SHNK-RTL-AMT TO TL-COMM-CUM-SHRINK                
W33304        MOVE PV-TOT-NXT-SLS-RTL-AMT  TO TL-COMM-NEXT-SALES                
W33304        MOVE PV-TOT-NXT-SHNK-RTL-AMT TO TL-COMM-NEXT-SHRINK               
W33304        MOVE 'C Y C L E ' TO TL-COMM-VERBIAGE                             
W33304        WRITE SALES-BASE-PHY-INV-LINE                                     
W33304         FROM TL-COMMON-TOTAL-LINE AFTER ADVANCING 1 LINES                
W33304        SET PS-INCOMPLETE-HEADERS-NO TO TRUE                              
W33304     END-IF.                                                              
W33304******************************************************************        
W33304* BUILD AND WRITE THE MONTH TOTAL LINE                                    
W33304******************************************************************        
W33304 4300-PRODUCE-MONTH-TOT-LINE.                                             
W33304                                                                          
W33304     PERFORM Z200-PRODUCE-HEADINGS.                                       
W33304     INITIALIZE H2-HEADING2-MONTH.                                        
W33304     MOVE PV-HOLD-FSCL-MN-NAME         TO PV-MONTH-NAME-SHORT             
W33304                                          PV-MONTH-NAME-FULL              
W33304                                          H4-MONTH-NAME.                  
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304         FROM H2-HEADING2-MONTH                                           
W33304         AFTER ADVANCING 1 LINES                                          
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304         FROM H4-HEADING4                                                 
W33304         AFTER ADVANCING 1 LINES                                          
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304         FROM H5-HEADING5                                                 
W33304         AFTER ADVANCING 1 LINES                                          
W33304     INITIALIZE TL-COMMON-TOTAL-LINE.                                     
W33304     MOVE PV-MNTH-TOT-OPN-SLS-RTL-AMT  TO TL-COMM-CUR-SALES.              
W33304     MOVE PV-MNTH-TOT-OPN-SHNK-RTL-AMT TO TL-COMM-CUR-SHRINK.             
W33304     MOVE PV-MNTH-TOT-CUM-SLS-RTL-AMT  TO TL-COMM-CUM-SALES.              
W33304     MOVE PV-MNTH-TOT-CUM-SHNK-RTL-AMT TO TL-COMM-CUM-SHRINK.             
W33304     MOVE PV-MNTH-TOT-NXT-SLS-RTL-AMT  TO TL-COMM-NEXT-SALES.             
W33304     MOVE PV-MNTH-TOT-NXT-SHNK-RTL-AMT TO TL-COMM-NEXT-SHRINK.            
W33304     MOVE PV-HOLD-FSCL-MN-NAME         TO TL-COMM-VERBIAGE.               
W33304     WRITE SALES-BASE-PHY-INV-LINE                                        
W33304      FROM TL-COMMON-TOTAL-LINE AFTER ADVANCING 1 LINES.                  
W33304     INITIALIZE PV-MNTH-TOTALS.                                           
W33304     SET PS-INCOMPLETE-HEADERS-NO TO TRUE.                                
W33304                                                                          
       7100-READ-SALES-BASE-CNTL-FILE.                                          
                                                                                
           READ SALES-BASE-CNTL-FILE INTO IN022-SALES-BASE-CNTL-REC             
             AT END SET PS-END-OF-CNTL-FILE TO TRUE                             
           END-READ.                                                            
                                                                                
                                                                                
       7200-READ-SALES-BASE-CUM-FILE.                                           
                                                                                
           READ SALES-BASE-CUM-FILE INTO IN023-SALES-BASE-CUM-REC               
             AT END SET PS-END-OF-CUM-FILE TO TRUE                              
           END-READ.                                                            
                                                                                
                                                                                
       8000-GET-OPN-FSCL-MN-DTE.                                                
                                                                                
           EXEC SQL                                                             
               SELECT   OPN_FSCL_MN_DTE                                         
               INTO     :MLCNTL-OPN-FSCL-MN-DTE                                 
               FROM     TMLCNTL                                                 
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLWARN NOT = SPACES                                        
               WHEN SQLCODE NOT = ZERO                                          
                   DISPLAY '** READ FOR TMLCNTL'                                
                   MOVE '8000-GET-OPN-FSCL-MN-DTE' TO                           
                         PV-PARAGRAPH-NAME                                      
                   PERFORM Z900-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
           DISPLAY '** MLCNTL-OPN-FSCL-MN-DTE:' MLCNTL-OPN-FSCL-MN-DTE.         
                                                                                
                                                                                
       8050-GET-OPN-FSCL-MN-INFO.                                               
                                                                                
           EXEC SQL                                                             
               SELECT   FSCL_MN_BEG_DTE                                         
                       ,FSCL_MN_NM                                              
               INTO    :PV-OPN-FSCL-MN-BEG-DTE                                  
                      ,:DTATTR-FSCL-MN-NM                                       
               FROM     TDTATTR                                                 
               WHERE  KY_DTE = :MLCNTL-OPN-FSCL-MN-DTE                          
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLWARN NOT = SPACES                                        
               WHEN SQLCODE NOT = ZERO                                          
                   DISPLAY '** READ FOR TDTATTR'                                
                   MOVE '8050-GET-OPN-FSCL-MN-INFO    ' TO                      
                         PV-PARAGRAPH-NAME                                      
                   PERFORM Z900-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
W33304 8060-GET-INVENTORY-MONTH-NAME.                                           
W33304                                                                          
W33304     MOVE IN-TINCNTL-DATE(ST-INV-SUB) TO PV-HOLD-INV-DATE                 
W33304                                                                          
W33304     EXEC SQL                                                             
W33304         SELECT   FSCL_MN_NM                                              
W33304         INTO    :PV-FSCL-MN-NAME                                         
W33304         FROM     TDTATTR                                                 
W33304         WHERE  KY_DTE = :PV-HOLD-INV-DATE                                
W33304     END-EXEC.                                                            
W33304                                                                          
W33304     EVALUATE TRUE                                                        
W33304         WHEN SQLCODE = 0                                                 
W33304             MOVE PV-FSCL-MN-NAME TO H4-MONTH-NAME                        
W33304         WHEN SQLWARN NOT = SPACES                                        
W33304         WHEN SQLCODE NOT = ZERO                                          
W33304             DISPLAY '** READ FOR TDTATTR'                                
W33304             MOVE '8060-GET-INVENTORY-MONTH-NAME' TO                      
W33304                   PV-PARAGRAPH-NAME                                      
W33304             PERFORM Z900-SQL-ERROR                                       
W33304     END-EVALUATE.                                                        
W33304                                                                          
W33304 8070-GET-CYCLE-NAME.                                                     
W33304                                                                          
W33304     EXEC SQL                                                             
W33304         SELECT   INV_NM                                                  
W33304         INTO    :PV-CYCLE-NAME                                           
W33304         FROM     TINCNTL                                                 
W33304         WHERE  INV_ID = :PV-HOLD-INV-ID                                  
W33304     END-EXEC.                                                            
W33304                                                                          
W33304     EVALUATE TRUE                                                        
W33304         WHEN SQLCODE = 0                                                 
W33304             CONTINUE                                                     
W33304         WHEN SQLWARN NOT = SPACES                                        
W33304         WHEN SQLCODE NOT = ZERO                                          
W33304             DISPLAY '** READ FOR CYCL NAME'                              
W33304             MOVE '8070-GET-CYCLE-NAME' TO                                
W33304                   PV-PARAGRAPH-NAME                                      
W33304             PERFORM Z900-SQL-ERROR                                       
W33304     END-EVALUATE.                                                        
W33304                                                                          
W33304                                                                          
       Z200-PRODUCE-HEADINGS.                                                   
                                                                                
           ADD 1 TO PV-PAGE-NBR.                                                
           MOVE PV-PAGE-NBR TO DP150O-PAGE-NUMBER.                              
                                                                                
RB0600     EVALUATE TRUE                                                        
RB0600         WHEN PS-RPT01                                                    
                   WRITE SALES-BASE-ALL-LINE                                    
                       FROM DP150O-STANDRD-HEADER-150-COLS                      
                       AFTER ADVANCING PAGE                                     
RB0600             WRITE SALES-BASE-ALL-LINE                                    
                       FROM H3-HEADING3                                         
                       AFTER ADVANCING 1 LINES                                  
RB0600             WRITE SALES-BASE-ALL-LINE                                    
                       FROM H4-HEADING4                                         
                       AFTER ADVANCING 1 LINES                                  
RB0600             WRITE SALES-BASE-ALL-LINE                                    
                       FROM H5-HEADING5                                         
                       AFTER ADVANCING 1 LINES                                  
RB0600         WHEN PS-RPT02                                                    
RB0600             WRITE SALES-BASE-PHY-INV-LINE                                
RB0600                 FROM DP150O-STANDRD-HEADER-150-COLS                      
RB0600                 AFTER ADVANCING PAGE                                     
RB0600             WRITE SALES-BASE-PHY-INV-LINE                                
RB0600                 FROM H3-HEADING3-II                                      
RB0600                 AFTER ADVANCING 1 LINES                                  
W33304             SET PS-INCOMPLETE-HEADERS-YES TO TRUE                        
W33304*            WRITE SALES-BASE-PHY-INV-LINE                                
W33304*                FROM H4-HEADING4                                         
W33304*                AFTER ADVANCING 1 LINES                                  
W33304*            WRITE SALES-BASE-PHY-INV-LINE                                
W33304*                FROM H5-HEADING5                                         
W33304*                AFTER ADVANCING 1 LINES                                  
RB0600         WHEN PS-RPT03                                                    
RB0600             WRITE SALES-BASE-NO-INV-LINE                                 
RB0600                 FROM DP150O-STANDRD-HEADER-150-COLS                      
RB0600                 AFTER ADVANCING PAGE                                     
RB0600             WRITE SALES-BASE-NO-INV-LINE                                 
RB0600                 FROM H3-HEADING3-III                                     
RB0600                 AFTER ADVANCING 1 LINES                                  
RB0600             WRITE SALES-BASE-NO-INV-LINE                                 
RB0600                 FROM H4-HEADING4                                         
RB0600                 AFTER ADVANCING 1 LINES                                  
RB0600             WRITE SALES-BASE-NO-INV-LINE                                 
RB0600                 FROM H5-HEADING5                                         
RB0600                 AFTER ADVANCING 1 LINES                                  
23511          WHEN PS-RPT04                                                    
23511              WRITE SALES-BASE-ALL-PHY-INV-LINE                            
23511                  FROM DP150O-STANDRD-HEADER-150-COLS                      
23511                  AFTER ADVANCING PAGE                                     
23511              WRITE SALES-BASE-ALL-PHY-INV-LINE                            
23511                  FROM H3-HEADING3-IV                                      
23511                  AFTER ADVANCING 1 LINES                                  
23511              WRITE SALES-BASE-ALL-PHY-INV-LINE                            
23511                  FROM H4-HEADING4                                         
23511                  AFTER ADVANCING 1 LINES                                  
23511              WRITE SALES-BASE-ALL-PHY-INV-LINE                            
23511                  FROM H5-HEADING5                                         
23511                  AFTER ADVANCING 1 LINES                                  
23511          WHEN PS-RPT05                                                    
23511              WRITE SALES-BASE-FUT-PHY-INV-LINE                            
23511                  FROM DP150O-STANDRD-HEADER-150-COLS                      
23511                  AFTER ADVANCING PAGE                                     
23511              WRITE SALES-BASE-FUT-PHY-INV-LINE                            
23511                  FROM H3-HEADING3-V                                       
23511                  AFTER ADVANCING 1 LINES                                  
23511              WRITE SALES-BASE-FUT-PHY-INV-LINE                            
23511                  FROM H4-HEADING4                                         
23511                  AFTER ADVANCING 1 LINES                                  
23511              WRITE SALES-BASE-FUT-PHY-INV-LINE                            
23511                  FROM H5-HEADING5                                         
23511                  AFTER ADVANCING 1 LINES                                  
RB0600     END-EVALUATE.                                                        
                                                                                
           ADD  4 TO PV-LINE-CNT.                                               
                                                                                
                                                                                
      ******************************************************************        
      * Z900-SQL-ERROR - PERFORMS THE ABEND FOR THE PROGRAM IN THE     *        
      *  EVENT THAT AN SQL ERROR CODE OCCURS.                          *        
      ******************************************************************        
       Z900-SQL-ERROR.                                                          
                                                                                
           MOVE +4013 TO PV-ABEND-CODE.                                         
           MOVE SQLCODE TO SQLCODE2.                                            
           MOVE SQLERRD(3) TO SQLERRD3.                                         
           DISPLAY '** ABEND **         ** = SQLERROR'.                         
           DISPLAY '** PROGRAM          ** = INKRP020'.                         
           DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.               
           DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                        
           DISPLAY '** SQLERRM          ** = ' SQLERRM.                         
           DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                        
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
           COPY DPPD004.                                                        
                                                                                
           CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
