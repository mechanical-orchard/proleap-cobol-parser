000100******************************************************************00010076
000200 IDENTIFICATION DIVISION.                                         00020076
000300******************************************************************00030076
000400                                                                  00040076
000500 PROGRAM-ID.             SUKUT701.                                00050076
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060076
000700 INSTALLATION.           KOHLS.                                   00070076
000800 DATE-WRITTEN            JANUARY, 2003.                           00080076
000900 DATE-COMPILED.                                                   00090076
001000                                                                  00100076
001100******************************************************************00110076
001200* THIS PROGRAM WILL PROCESS THE CARTON ADJUSTMENTS FOR A CARTON   00120076
001300* THAT HAS BEEN AUDITED AND HAS DISCREPTANCIES.                   00130076
001400******************************************************************00140076
001500 ENVIRONMENT DIVISION.                                            00150076
001600 DATA DIVISION.                                                   00160076
001700******************************************************************00170076
001800******************************************************************00180076
001900 WORKING-STORAGE SECTION.                                         00190076
002000******************************************************************00200076
002100                                                                  00210076
002200*----------------------------------------------------------------*00220076
002300*    COMMAREA FOR TMKCS520.                                      *00230076
002400*----------------------------------------------------------------*00240076
002500                                                                  00250076
002600     COPY TMWS500.                                                00260076
002700                                                                  00270076
002800     COPY SUWS034.                                                00280076
002900*                                                                 00290076
003000     COPY SUWS035.                                                00300076
003100*                                                                 00310076
003800***************************************************************** 00380076
003900*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 00390076
004000*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 00400076
004100***************************************************************** 00410076
004200     COPY RCWS040.                                                00420076
004300                                                                  00430076
004400******************************************************************00440076
004500*    PREPACK VERIFICATION                                         00450076
004600******************************************************************00460076
004700     COPY RCWS806.                                                00470076
004800******************************************************************00480076
004900*  RANDOM NUMBER AREA.                                            00490076
005000******************************************************************00500076
005100     COPY DPWS902.                                                00510076
005200                                                                  00520076
005300*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 230ZZ  *00530076
005400                                                                  00540076
005500     COPY XLWS001.                                                00550076
005600                                                                  00560076
005700 01  DK-DB2-KEYS.                                                 00570076
005800     05  DK-CS-ECOMM-STORE-LOC           PIC S9(4)  COMP.         00580085
005900     05  DK-ITM-NBR                      PIC S9(15)V COMP-3.      00590076
006000     05  DK-NULL-IND                     PIC S9(04) COMP.         00600076
006100     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00610076
006200     05  DK-SHIPT-UNT-ID                 PIC S9(18) COMP-3.       00620076
006300     05  DK-OTBND-SHIPT-UNT-ID           PIC S9(18) COMP-3.       00630076
006400     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00640076
006500     05  DK-TRN-NBR                      PIC S9(09) COMP SYNC.    00650076
006600     05  DK-PO-NBR                       PIC S9(09)  COMP.        00660076
006700     05  DK-RCVR-SEQ-NBR                 PIC S9(09) COMP SYNC.    00670076
006800     05  DK-TRN-LNE-NBR                  PIC S9(09) COMP SYNC.    00680076
006900     05  DK-SHUUPC-TRN-LNE-NBR           PIC S9(09) COMP SYNC.    00690076
007000     05  DK-TRN-TYP-CDE                  PIC  X(02).              00700076
007100     05  DK-UPC-NBR                      PIC S9(15)V COMP-3.      00710076
007200     05  DK-INTR-UPC                     PIC  S9(9)  COMP.        00720076
007300     05  DK-CARTON-INTR-UPC              PIC  S9(9)  COMP.        00730076
007400     05  DK-STR-NBR                      PIC S9(04)  COMP SYNC.   00740076
007500     05  DK-PACK-ID                      PIC S9(04)  COMP SYNC.   00750076
007600     05  DK-LNE-NBR                      PIC S9(09) COMP.         00760076
007700*                                                                 00770076
007800 01  PC-PROGRAM-CONSTANTS.                                        00780076
007900     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKUT701'.   00790085
008000     05  PC-TMKCS520                PIC X(08) VALUE 'TMKCS520'.   00800085
008100     05  PC-SUKUT702                PIC X(08) VALUE 'SUKUT702'.   00810076
008200     05  PC-DEFAULT-TMST            PIC X(26) VALUE               00820085
008300                                   '9999-09-09-09.09.09.999999'.  00830076
008400     05  PC-RANDOM-NBR-GENERATOR    PIC X(08) VALUE 'DPKUT902'.   00840085
008500     05  PC-RCKCS806                PIC X(8)  VALUE 'RCKCS806'.   00850085
008600     05  PC-CONTAINER-UPD-TRAN      PIC X(04) VALUE 'I210'.       00860085
008700                                                                  00870076
008800 01  PS-PROGRAM-SWITCHES.                                         00880076
008900     05  PS-INTERFAC-TO-RDS-LOC-SW      PIC  X(01)  VALUE 'N'.    00890085
009000         88  PS-INTERFAC-TO-RDS-LOC-FND             VALUE 'Y'.    00900085
009100         88  PS-INTERFAC-TO-RDS-LOC-NOT-FND         VALUE 'N'.    00910085
009200     05  PS-EXPECTED-IN-CARTON-SW       PIC  X(01)  VALUE 'N'.    00920076
009300         88  PS-EXPECTED-IN-CARTON                  VALUE 'Y'.    00930076
009400         88  PS-NOT-EXPT-IN-CARTON                  VALUE 'N'.    00940076
009500     05  PS-DUPLICATE-UPC-FOUND-SW      PIC  X(01)  VALUE 'N'.    00950076
009600         88  PS-NO-DUPLICATE-UPC-FOUND              VALUE 'N'.    00960076
009700         88  PS-DUPLICATE-UPC-FOUND                 VALUE 'Y'.    00970076
009800     05  PS-LINKED-TO-3000-SW           PIC  X(01)  VALUE 'N'.    00980076
009900         88  PS-NOT-LINKED-TO-3000                  VALUE 'N'.    00990076
010000         88  PS-LINKED-TO-3000                      VALUE 'Y'.    01000076
010100     05  PS-ONLY-APPLY-TO-BAD-PACKS-SW  PIC  X(01)  VALUE 'N'.    01010076
010200         88  PS-APPLY-TO-ALL-PACKS                  VALUE 'N'.    01020076
010300         88  PS-ONLY-APPLY-TO-BAD-PACKS             VALUE 'Y'.    01030076
010400     05  PS-FAILED-ADJ-SW               PIC  X(01)  VALUE 'N'.    01040076
010500         88  PS-NO-FAILED-ADJ                       VALUE 'N'.    01050076
010600         88  PS-FAILED-ADJ                          VALUE 'Y'.    01060076
010700     05  PS-UPDATE-NBR-PACKS-SW         PIC  X(01)  VALUE 'N'.    01070076
010800         88  PS-DONT-UPDATE-NBR-PACKS               VALUE 'N'.    01080076
010900         88  PS-UPDATE-NBR-PACKS                    VALUE 'Y'.    01090076
011000     05  PS-ODD-UNITS-ADDED-SW          PIC  X(01)  VALUE 'N'.    01100076
011100         88  PS-NO-ODD-UNITS-ADDED                  VALUE 'N'.    01110076
011200         88  PS-ODD-UNITS-ADDED                     VALUE 'Y'.    01120076
011300     05  PS-ODD-UNITS-EXIST-SW          PIC  X(01)  VALUE 'N'.    01130076
011400         88  PS-NO-ODD-UNITS-EXIST                  VALUE 'N'.    01140076
011500         88  PS-ODD-UNITS-EXIST                     VALUE 'Y'.    01150076
011600     05  PS-ODD-UNITS-PROCESSED-SW      PIC  X(01)  VALUE 'N'.    01160076
011700         88  PS-NO-ODD-UNITS-PROCESSED              VALUE 'N'.    01170076
011800         88  PS-ODD-UNITS-PROCESSED                 VALUE 'Y'.    01180076
011900     05  PS-DONT-APPLY-CRT-UPDATES-SW   PIC  X(01)  VALUE 'N'.    01190076
012000         88  PS-APPLY-CRT-UPDATES                   VALUE 'N'.    01200076
012100         88  PS-DONT-APPLY-CRT-UPDATES              VALUE 'Y'.    01210076
012200     05  PS-OTBND-UPC-UPDATED-SW        PIC  X(01)  VALUE 'N'.    01220076
012300         88  PS-OTBND-UPC-NOT-UPDATED               VALUE 'N'.    01230076
012400         88  PS-OTBND-UPC-UPDATED                   VALUE 'Y'.    01240076
012500     05  PS-OTBND-CART-UPDATED-SW       PIC  X(01)  VALUE 'N'.    01250076
012600         88  PS-OTBND-CART-NOT-UPDATED              VALUE 'N'.    01260076
012700         88  PS-OTBND-CART-UPDATED                  VALUE 'Y'.    01270076
012800     05  PS-OTBND-PK-FOUND-SW           PIC  X(01)  VALUE 'Y'.    01280076
012900         88  PS-NO-OTBND-PK-FOUND                   VALUE 'N'.    01290076
013000         88  PS-OTBND-PK-FOUND                      VALUE 'Y'.    01300076
013100     05  PS-AUTO-VE-PO-SW               PIC  X(01)  VALUE 'Y'.    01310076
013200         88  PS-NOT-AUTO-VE-PO                      VALUE 'N'.    01320076
013300         88  PS-AUTO-VE-PO                          VALUE 'Y'.    01330076
013400     05  PS-PACK-RECS-PROCESSED-SW      PIC  X(01)  VALUE 'N'.    01340076
013500         88  PS-PACK-RECS-PROCESSED                 VALUE 'Y'.    01350076
013600         88  PS-NO-PACK-RECS-PROCESSED              VALUE 'N'.    01360076
013700     05  PS-RECITM-STATUS-FOUND-SW      PIC  X(01)  VALUE 'N'.    01370076
013800         88  PS-RECITM-STATUS-FOUND                 VALUE 'Y'.    01380076
013900         88  PS-RECITM-STATUS-NOT-FOUND             VALUE 'N'.    01390076
014000     05  PS-LINE-ON-PO-SW               PIC  X(01)  VALUE 'N'.    01400076
014100         88  PS-LINE-ON-PO                          VALUE 'Y'.    01410076
014200         88  PS-LINE-NOT-ON-PO                      VALUE 'N'.    01420076
014300     05  PS-BACK-OUT-UPDATES-SW         PIC  X(01)  VALUE 'N'.    01430076
014400         88  PS-BACK-OUT-UPDATES                    VALUE 'Y'.    01440076
014500         88  PS-DONT-BACK-OUT-UPDATES               VALUE 'N'.    01450076
014600     05  PS-DEPT-NBR-SW                 PIC  X(01)  VALUE 'N'.    01460076
014700         88  PS-DEPT-NBR                            VALUE 'Y'.    01470076
014800         88  PS-NO-DEPT-NBR                         VALUE 'N'.    01480076
014900     05  PS-RECEIVER-FOUND-SW           PIC  X(01)  VALUE 'N'.    01490076
015000         88  PS-RECEIVER-FOUND                      VALUE 'Y'.    01500076
015100         88  PS-NO-RECEIVER-FOUND                   VALUE 'N'.    01510076
015200     05  PS-RECITM-FOUND-SW             PIC  X(01)  VALUE 'N'.    01520076
015300         88  PS-RECITM-FOUND                        VALUE 'Y'.    01530076
015400         88  PS-RECITM-NOT-FOUND                    VALUE 'N'.    01540076
015500     05  PS-ODD-UNITS-ADJUSTMENT-SW     PIC  X(01)  VALUE 'N'.    01550076
015600         88  PS-ODD-UNITS-ADJUSTMENT                VALUE 'Y'.    01560076
015700         88  PS-NO-ODD-UNITS-ADJUSTMENT             VALUE 'N'.    01570076
015800     05  PS-PACK-ADJUSTMENT-SW          PIC  X(01)  VALUE 'N'.    01580076
015900         88  PS-PACK-ADJUSTMENT                     VALUE 'Y'.    01590076
016000         88  PS-NO-PACK-ADJUSTMENT                  VALUE 'N'.    01600076
016100     05  PS-PREPACK-DRIVER-SW           PIC  X(01)  VALUE 'N'.    01610076
016200         88  PS-PREPACK-DRIVER                      VALUE 'Y'.    01620076
016300         88  PS-NOT-PREPACK-DRIVER                  VALUE 'N'.    01630076
016400     05  PS-NO-PACK-MATCH-FOUND-SW      PIC  X(01)  VALUE 'N'.    01640076
016500         88  PS-NO-PACK-MATCH-FOUND                 VALUE 'N'.    01650076
016600         88  PS-PACK-MATCH-FOUND                    VALUE 'Y'.    01660076
016700     05  PS-NO-UPC-MATCH-FOUND-SW       PIC  X(01)  VALUE 'N'.    01670076
016800         88  PS-NO-UPC-MATCH-FOUND                  VALUE 'N'.    01680076
016900         88  PS-UPC-MATCH-FOUND                     VALUE 'Y'.    01690076
017000     05  PS-EOC-PAC-CSR-SW              PIC  X(01)  VALUE 'N'.    01700076
017100         88  PS-EOC-PAC-CSR                         VALUE 'Y'.    01710076
017200         88  PS-NOT-EOC-PAC-CSR                     VALUE 'N'.    01720076
017300     05  PS-UNIT-ADJUST-DC-SW           PIC  X(01)   VALUE 'N'.   01730076
017400         88  PS-UNIT-ADJUST-DC                       VALUE 'Y'.   01740076
017500         88  PS-NOT-UNIT-ADJUST-DC                   VALUE 'N'.   01750076
017600     05  PS-UNIT-ADJUST-DEPT-DC-SW      PIC  X(01)   VALUE 'N'.   01760076
017700         88  PS-UNIT-ADJUST-DEPT-DC                  VALUE 'Y'.   01770076
017800         88  PS-NOT-UNIT-ADJUST-DEPT-DC              VALUE 'N'.   01780076
017900     05  PS-FINCL-ADJ-ID-EXISTS-SW      PIC  X(01)   VALUE 'N'.   01790076
018000         88  PS-FINCL-ADJ-ID-EXISTS                  VALUE 'Y'.   01800076
018100         88  PS-FINCL-ADJ-ID-NOT-EXISTS              VALUE 'N'.   01810076
018200     05  PS-TOO-MANY-UNEXPCTD-SW        PIC  X(01)   VALUE 'N'.   01820076
018300         88  PS-TOO-MANY-UNEXPCTD                    VALUE 'Y'.   01830076
018400         88  PS-NOT-TOO-MANY-UNEXPCTD                VALUE 'N'.   01840076
018500     05  PS-MULTIPLE-RECORDS-SW         PIC  X(01)   VALUE 'N'.   01850076
018600         88  PS-MULTIPLE-RECORDS                     VALUE 'Y'.   01860076
018700         88  PS-NO-MULTIPLE-RECORDS                  VALUE 'N'.   01870076
018800     05  PS-ERROR-SW                    PIC  X(01)   VALUE 'N'.   01880076
018900         88  PS-ERROR                                VALUE 'Y'.   01890076
019000         88  PS-NO-ERROR                             VALUE 'N'.   01900076
019100     05  PS-ADD-ZERO-UPC-SW             PIC  X(01)   VALUE 'N'.   01910076
019200         88  PS-ADD-ZERO-UPC                         VALUE 'Y'.   01920076
019300         88  PS-NOT-ADD-ZERO-UPC                     VALUE 'N'.   01930076
019400     05  PS-ITM-FOUND-SW                PIC  X(01)   VALUE 'N'.   01940076
019500         88  PS-ITM-FOUND                            VALUE 'Y'.   01950076
019600         88  PS-ITM-NOT-FOUND                        VALUE 'N'.   01960076
019700     05  PS-ITM-NBR-FOUND-SW            PIC  X(01)   VALUE 'N'.   01970076
019800         88  PS-ITM-NBR-FOUND                        VALUE 'Y'.   01980076
019900         88  PS-ITM-NBR-NOT-FOUND                    VALUE 'N'.   01990076
020000     05  PS-AUDIT-EXISTS-SW             PIC X(01)    VALUE 'N'.   02000076
020100         88  PS-AUDIT-EXISTS                         VALUE 'Y'.   02010076
020200         88  PS-AUDIT-NOT-EXISTS                     VALUE 'N'.   02020076
020300     05  PS-ADJUSTMENT-USED-UP-SW          PIC X(01)    VALUE 'N'.02030076
020400         88  PS-ADJUSTMENT-USED-UP                   VALUE 'Y'.   02040076
020500         88  PS-ADJUSTMENT-NOT-USED-UP               VALUE 'N'.   02050076
020600     05  PS-AUDIT-FIRST-PASS-SW         PIC X(01)    VALUE 'N'.   02060076
020700         88  PS-AUDIT-FIRST-PASS                     VALUE 'Y'.   02070076
020800         88  PS-NOT-AUDIT-FIRST-PASS                 VALUE 'N'.   02080076
020900     05  PS-SYSTEM-AUDIT-FOUND-SW       PIC X(01)    VALUE 'N'.   02090076
021000         88  PS-SYSTEM-AUDIT-NOT-FOUND               VALUE 'N'.   02100076
021100         88  PS-SYSTEM-AUDIT-FOUND                   VALUE 'Y'.   02110076
021200     05  PS-OVER-SHORT-IND               PIC  X(01)  VALUE 'N'.   02120076
021300         88  PS-OVER-SHORT-ERROR                     VALUE 'Y'.   02130076
021400         88  PS-NO-OVER-SHORT-ERROR                  VALUE 'N'.   02140076
021500     05  PS-CARTON-UPC-CURSOR-CMPLT-IND  PIC  X(01)  VALUE 'N'.   02150076
021600         88  PS-NOT-CARTON-UPC-CURSOR-CMPLT          VALUE 'N'.   02160076
021700         88  PS-CARTON-UPC-CURSOR-CMPLT              VALUE 'Y'.   02170076
021800     05  PS-AUDIT-UPC-CURSOR-CMPLT-IND   PIC  X(01)  VALUE 'N'.   02180076
021900         88  PS-NOT-AUDIT-UPC-CURSOR-CMPLT           VALUE 'N'.   02190076
022000         88  PS-AUDIT-UPC-CURSOR-CMPLT               VALUE 'Y'.   02200076
022100     05  PS-CARTON-ITEM-CURSOR-IND       PIC  X(01)  VALUE 'N'.   02210076
022200         88  PS-NOT-EOC-CARTON-ITEM-CURSOR           VALUE 'N'.   02220076
022300         88  PS-EOC-CARTON-ITEM-CURSOR               VALUE 'Y'.   02230076
022400     05  PS-AUDIT-ITEM-CURSOR-IND        PIC  X(01)  VALUE 'N'.   02240076
022500         88  PS-NOT-EOC-AUDIT-ITEM-CURSOR            VALUE 'N'.   02250076
022600         88  PS-EOC-AUDIT-ITEM-CURSOR                VALUE 'Y'.   02260076
022700     05  PS-CARTON-UPC-CURSOR-IND        PIC  X(01)  VALUE 'N'.   02270076
022800         88  PS-NOT-EOC-CARTON-UPC-CURSOR            VALUE 'N'.   02280076
022900         88  PS-EOC-CARTON-UPC-CURSOR                VALUE 'Y'.   02290076
023000     05  PS-AUDIT-UPC-CURSOR-IND         PIC  X(01)  VALUE 'N'.   02300076
023100         88  PS-NOT-EOC-AUDIT-UPC-CURSOR             VALUE 'N'.   02310076
023200         88  PS-EOC-AUDIT-UPC-CURSOR                 VALUE 'Y'.   02320076
023300     05  PS-EOC-ZERO-CURSOR-IND          PIC  X(01)  VALUE 'N'.   02330076
023400         88  PS-NOT-EOC-ZERO-CURSOR                  VALUE 'N'.   02340076
023500         88  PS-EOC-ZERO-CURSOR                      VALUE 'Y'.   02350076
023600     05  PS-AUDIT-UPC-CHANGE-IND         PIC  X(01)  VALUE 'N'.   02360076
023700         88  PS-AUDIT-UPC-CHANGE                     VALUE 'Y'.   02370076
023800         88  PS-NO-AUDIT-UPC-CHANGE                  VALUE 'N'.   02380076
023900                                                                  02390076
024000 01  PV-PROGRAM-VARIABLES.                                        02400076
024100     05  PV-UPC-NBR                      PIC S9(15)V COMP-3.      02410076
024110     05  PV-SAVE-SKU                     PIC S9(8)V COMP-3.       02410076
024200     05  PV-SAVE-UPC-NBR                 PIC S9(15)V COMP-3       02420076
024300                                                 VALUE ZERO.      02430076
024400     05  PV-SAVE-ORD-LNE-NBR             PIC S9(09) COMP          02440076
024500                                                 VALUE ZERO.      02450076
024600     05  PV-SAVE-INTR-UPC                PIC S9(09)  COMP         02460076
024700                                                 VALUE ZERO.      02470076
024800     05  PV-SAVE-PRPPK-ID                PIC S9(04)  COMP SYNC.   02480076
024900     05  PV-PACK-ID                      PIC S9(04)  COMP SYNC.   02490076
025000     05  PV-SAVE-PACK-ID                 PIC S9(04)  COMP SYNC.   02500076
025100     05  PV-ZERO-LINE-COUNT              PIC S9(04)  COMP SYNC.   02510076
025200     05  PV-DEPT-NUMBER-X                PIC  X(03) VALUE SPACES. 02520076
025300     05  FILLER REDEFINES PV-DEPT-NUMBER-X.                       02530076
025400         10  PV-DEPT-NUMBER              PIC  9(03).              02540076
025500     05  PV-TABLE-DEPT-NBR               PIC  9(03).              02550076
025600     05  PV-INTR-UPC-11                  PIC  S9(18) COMP.        02560076
025700     05  FILLER REDEFINES PV-INTR-UPC-11.                         02570076
025800         10  FILLER                      PIC   X(4).              02580076
025900         10  PV-INTR-UPC                 PIC  S9(9)  COMP.        02590076
026000     05  PV-SHIPT-UNT-ID-20              PIC  X(20).                      
026100     05  FILLER REDEFINES PV-SHIPT-UNT-ID-20.                             
026200         10  PV-SHIPT-UNT-ID-0           PIC  X(02).                      
026201         10  PV-SHIPT-UNT-ID-18          PIC  9(18).                      
026202     05  PV-PACK-DIFF                    PIC  S9(9) COMP VALUE 0. 02600076
026203     05  PV-SAVE-PACK-DIFF               PIC  S9(9) COMP VALUE 0. 02610076
026204     05  PV-ODD-DIFF                     PIC  S9(9) COMP VALUE 0. 02620076
026300     05  PV-ADJ-MINUS-ODD                PIC  S9(9) COMP VALUE 0. 02630076
026400     05  PV-BEFORE-ODD-UNT-QTY           PIC  S9(9) COMP VALUE 0. 02640076
026500     05  PV-AFTER-ODD-UNT-QTY            PIC  S9(9) COMP VALUE 0. 02650076
026600     05  PV-SCN-QTY                      PIC S9(09)  VALUE ZERO   02660076
026700                                                     COMP SYNC.   02670076
026800     05  PV-FINCL-ADJ-ID                 PIC S9(9)   COMP SYNC.   02680076
026900     05  PV-MAX-RETAIL                   PIC S9(9)   COMP SYNC.   02690076
027000     05  PV-SUM-SHPD-QTY                 PIC S9(9)   COMP SYNC.   02700076
027100     05  PV-DIFFERENCE                   PIC S9(9)   COMP SYNC.   02710076
027200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02720076
027300                                                     COMP SYNC.   02730076
027400     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  02740076
027500                                                     COMP SYNC.   02750076
027600     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 02760076
027610     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02760076
027700     05  PV-SAVE-LAST-IDX                PIC  S9(4) COMP VALUE 0. 02770076
027800     05  PV-SAVE-PREPK-ID                PIC  S9(4) COMP VALUE 0. 02780076
027900     05  PV-SAVE-LINE-IDX                PIC  S9(4) COMP VALUE 0. 02790076
028000     05  PV-UPDATE-LINE-IDX              PIC  S9(4) COMP VALUE 0. 02800076
028100     05  PV-SAVE-NBR-OF-PACKS            PIC  S9(5) COMP-3.       02810076
028200     05  PV-NUMBER-OF-LINES              PIC  S9(5) COMP-3.       02820076
028300     05  PV-BEFORE-QTY                   PIC  S9(9) COMP.         02830076
028400     05  PV-AFTER-QTY                    PIC  S9(9) COMP.         02840076
028500     05  PV-UPDATE-QTY                   PIC  S9(9) COMP.         02850076
028600     05  PV-ADJUST-QTY                   PIC  S9(9) COMP.         02860076
028700     05  PV-RCVR-SEQ-NBR                 PIC  S9(9) COMP.         02870076
028800     05  PV-OTBND-RCVR-SEQ               PIC  S9(9) COMP.         02880076
028900     05  PV-CARTON-ITEM-COUNT            PIC S9(09)  VALUE ZERO   02890076
029000                                                     COMP SYNC.   02900076
029100     05  PV-AUDIT-ITEM-COUNT             PIC S9(09)  VALUE ZERO   02910076
029200                                                     COMP SYNC.   02920076
029300     05  PV-WORK-ITEM-COUNT              PIC S9(09)  VALUE ZERO   02930076
029400                                                     COMP SYNC.   02940076
029500     05  PV-AUDIT-REC-TYPE               PIC  X(01)  VALUE SPACE. 02950076
029600     05  PV-CARTON-REC-TYPE              PIC  X(01)  VALUE SPACE. 02960076
029700     05  PV-AUDIT-INTR-UPC               PIC  S9(9)  COMP.        02970076
029800     05  PV-CARTON-INTR-UPC              PIC  S9(9)  COMP.        02980076
029900     05  PV-AUDIT-HOLD-UPC-NBR           PIC  S9(15)V COMP-3.     02990076
030000     05  PV-CARTON-HOLD-UPC-NBR          PIC  S9(15)V COMP-3.     03000076
030100     05  PV-CARTON-LINE-NBR              PIC  S9(9)  COMP.        03010076
030200     05  PV-SCND-UNT-QTY                 PIC  S9(9)  COMP.        03020076
030300     05  PV-UNT-RTL-AMT                  PIC  S9(7)V9(2) COMP-3.  03030076
030400     05  PV-AUDIT-UPC-NBR                PIC  S9(15)V COMP-3.     03040076
030500     05  PV-AUDIT-SHPD-QTY               PIC  S9(9)V COMP-3.      03050076
030600     05  PV-CARTON-UPC-NBR               PIC  S9(15)V COMP-3.     03060076
030700     05  PV-CARTON-SHPD-QTY              PIC  S9(9)V COMP-3.      03070076
030800     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 03080076
030900     05  PV-DISPLAY-SQLCODE-2            PIC -9(05) VALUE ZEROES. 03090076
031000     05  PV-DISPLAY-UPC-NBR              PIC   9(15).             03100076
031100     05  PV-DISPLAY-INTR-UPC             PIC   9(10).             03110076
031200     05  PV-DISPLAY-AUDIT-CNTL-NBR       PIC   9(09).             03120076
031300     05  PV-DISPLAY-PO-NBR               PIC   9(09).             03130076
031400     05  PV-DISPLAY-PACK-ID              PIC   9(04).             03140076
031500     05  PV-DISP-FINCL-ADJ-ID            PIC   9(09) VALUE ZEROES.03150076
031600     05  PV-DISP-OPER-UNT-ID             PIC   9(04).             03160076
031700     05  PV-DISP-FCLTY-ID                PIC   9(04).             03170076
031800     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               03180076
031900     05  PV-DISP-ITM-NBR                 PIC 9(15).               03190076
032000     05  PV-DISP-TRN-NBR                 PIC 9(09).               03200076
032100     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(09).               03210076
032200     05  PV-DISP-TRN-LNE-NBR             PIC 9(09).               03220076
032300     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               03230076
032400     05  PV-DISP-UPC-NBR                 PIC 9(15).               03240076
032500     05  PV-DISP-STR-NBR                 PIC 9(04).               03250076
032600     05  PV-DISP-PACK-ID                 PIC 9(04).               03260076
032700     05  PV-DISP-PK-SKU                  PIC 9(09).               03270076
032800     05  PV-DISP-CICS-RESPONSE           PIC  9(09)  VALUE ZEROS. 03280076
032900                                                                  03290076
033000 01  TB-PACK-TABLE.                                               03300076
033100     05  TB-PACK-ITEM OCCURS 500 TIMES INDEXED BY LINE-IDX.       03310076
033200         10  PACK-IND                    PIC   X(01).             03320076
033300         10  PACK-EXPECTED-IN-CARTON-IND PIC   X(01).             03330076
033400         10  PACK-PRPPK-ID               PIC  S9(4) COMP.         03340076
033500         10  PACK-PREPK-DRV-LNE-CDE      PIC   X(01).             03350076
033600         10  PACK-LINE                   PIC  S9(9) COMP.         03360076
033700         10  PACK-ITM                    PIC  S9(15) COMP-3.      03370076
033800         10  PACK-RATO                   PIC  S9(4) COMP.         03380076
033900         10  PACK-AUDIT-QTY              PIC  S9(09) COMP-3.      03390076
034000         10  PACK-CRTN-QTY               PIC  S9(09) COMP-3.      03400076
034100         10  PACK-CRTN-REC-TYPE          PIC   X(01).             03410076
034200         10  PACK-CRTN-INTR-UPC          PIC  S9(9)  COMP.        03420076
034300         10  PACK-CRTN-HOLD-UPC          PIC  S9(15)V COMP-3.     03430076
034400         10  PACK-AUD-REC-TYPE           PIC   X(02).             03440076
034500         10  PACK-AUD-INTR-UPC           PIC  S9(9)  COMP.        03450076
034600         10  PACK-AUD-HOLD-UPC           PIC  S9(15)V COMP-3.     03460076
034700         10  PACK-BEST-CASE-UNITS        PIC  S9(07) COMP-3.      03470076
034800         10  PACK-ODD-UNITS              PIC  S9(05) COMP-3.      03480076
034900         10  PACK-BACKOUT-IND            PIC   X(01).             03490076
035000 01  PV-SAVE-UPC-UPDATE-AREA.                                     03500076
035100     05  PV-SAVE-SHIPT-UNT-ID            PIC S9(18) COMP-3.       03510076
035200     05  PV-SAVE-TRN-NBR                 PIC S9(09) COMP.         03520076
035300     05  PV-SAVE-RCVR-SEQ-NBR            PIC S9(09) COMP.         03530076
035400     05  PV-SAVE-TRN-LNE-NBR             PIC S9(09) COMP.         03540076
035500     05  PV-SAVE-TRN-TYP-CDE             PIC  X(02).              03550076
035600     05  PV-SAVE-UPC                     PIC S9(15)V COMP-3.      03560076
035700     05  PV-SAVE-AFTER-QTY               PIC S9(09) COMP.         03570076
035800     05  PV-SAVE-BEFORE-QTY              PIC S9(09) COMP.         03580076
035900     05  PV-SAVE-INSERT-UPDATE-IND       PIC X(06).               03590076
036000*----------------------------------------------------------------*03600076
036100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *03610076
036200*----------------------------------------------------------------*03620076
036300     EXEC SQL                                                     03630076
036400         INCLUDE TVHTRIP                                          03640076
036500     END-EXEC.                                                    03650076
036600                                                                  03660076
036700*----------------------------------------------------------------*03670076
036800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *03680076
036900*----------------------------------------------------------------*03690076
037000     EXEC SQL                                                     03700076
037100         INCLUDE TSHIPMT                                          03710076
037200     END-EXEC.                                                    03720076
037300                                                                  03730076
037400*----------------------------------------------------------------*03740076
037500*  DCLGEN LAYOUT AND COBOL DECLARATION                           *03750076
037600*----------------------------------------------------------------*03760076
037700     EXEC SQL                                                     03770076
037800         INCLUDE TSHPTPO                                          03780076
037900     END-EXEC.                                                    03790076
038000                                                                  03800076
038100*----------------------------------------------------------------*03810076
038200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI03820076
038300*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         03830076
038400*----------------------------------------------------------------*03840076
038500     EXEC SQL                                                     03850076
038600         INCLUDE TINPKSU                                          03860076
038700     END-EXEC.                                                    03870076
038800                                                                  03880076
038900*----------------------------------------------------------------*03890076
039000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03900076
039100*  TABLE                                                          03910076
039200*----------------------------------------------------------------*03920076
039300     EXEC SQL                                                     03930076
039400         INCLUDE TSHPUNT                                          03940076
039500     END-EXEC.                                                    03950076
039600                                                                  03960076
039700*----------------------------------------------------------------*03970076
039800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO TABLE           03980076
039900*----------------------------------------------------------------*03990076
040000     EXEC SQL                                                     04000076
040100         INCLUDE TPURCHS                                          04010076
040200     END-EXEC.                                                    04020076
040300                                                                  04030076
040400******************************************************************04040076
040500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      04050076
040600*  AUDIT TABLE (TSUNAUD)                                          04060076
040700******************************************************************04070076
040800     EXEC SQL                                                     04080076
040900         INCLUDE TSUNAUD                                          04090076
041000     END-EXEC.                                                    04100076
041100                                                                  04110076
041200******************************************************************04120076
041300*    PO PREPACK TABLE                                             04130076
041400******************************************************************04140076
041500     EXEC SQL                                                     04150076
041600         INCLUDE TPOPRPK                                          04160076
041700     END-EXEC.                                                    04170076
041800******************************************************************04180076
041900*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       04190076
042000******************************************************************04200076
042100     EXEC SQL                                                     04210076
042200          INCLUDE TRECITM                                         04220076
042300     END-EXEC.                                                    04230076
042400                                                                  04240076
042500     EXEC SQL                                                     04250076
042600          INCLUDE TSHUUPC                                         04260076
042700     END-EXEC.                                                    04270076
042800******************************************************************04280076
042900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVING          04290076
043000*  TABLE                                                          04300076
043100******************************************************************04310076
043200     EXEC SQL                                                     04320076
043300         INCLUDE TRECEIV                                          04330076
043400     END-EXEC.                                                    04340076
043500                                                                  04350076
043600******************************************************************04360076
043700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PACK SLIP          04370076
043800*  TABLE                                                          04380076
043900******************************************************************04390076
044000     EXEC SQL                                                     04400076
044100         INCLUDE TPKSLIP                                          04410076
044200     END-EXEC.                                                    04420076
044300                                                                  04430076
044400******************************************************************04440076
044500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ADJUSTMENTS        04450076
044600*  TABLE (SUT_FINCL_ADJ)                                          04460076
044700******************************************************************04470076
044800     EXEC SQL                                                     04480076
044900         INCLUDE SUT00030                                         04490076
045000     END-EXEC.                                                    04500076
045100                                                                  04510076
045200******************************************************************04520076
045300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ADJUSTMENTS        04530076
045400*  TABLE (SUT_OTBND_VND)                                          04540076
045500******************************************************************04550076
045600     EXEC SQL                                                     04560076
045700         INCLUDE SUT00026                                         04570076
045800     END-EXEC.                                                    04580076
045900                                                                  04590076
046000******************************************************************04600076
046100*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 04610076
046200******************************************************************04620076
046300     EXEC SQL                                                     04630076
046400          INCLUDE TKRPRPM                                         04640076
046500     END-EXEC.                                                    04650076
046600                                                                  04660076
046700******************************************************************04670076
046800*  SQL AND COBOL DECLARATIONS FOR THE PO ITEM TABLE (TPURITM)     04680076
046900******************************************************************04690076
047000     EXEC SQL                                                     04700076
047100          INCLUDE TPURITM                                         04710076
047200     END-EXEC.                                                    04720076
047300                                                                  04730076
047400******************************************************************04740076
047500* DB2 AREA FOR THE SHIPMENT UNIT QUANTITY ADJUSTMENT TABLE        04750076
047600******************************************************************04760076
047700     EXEC SQL                                                     04770076
047800          INCLUDE TSUQADJ                                         04780076
047900     END-EXEC.                                                    04790076
048000                                                                  04800076
048100******************************************************************04810076
048200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      04820076
048300*  AUDIT TRANSATIONS(CARTONS) TABLE (TSUATRN)                     04830076
048400******************************************************************04840076
048500     EXEC SQL                                                     04850076
048600         INCLUDE TSUATRN                                          04860076
048700     END-EXEC.                                                    04870076
048800                                                                  04880076
048900******************************************************************04890076
049000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      04900076
049100*  AUDIT CONTENT TABLE - UPC'S  (TSUAUPC)                         04910076
049200******************************************************************04920076
049300     EXEC SQL                                                     04930076
049400         INCLUDE TSUAUPC                                          04940076
049500     END-EXEC.                                                    04950076
049600                                                                  04960076
049700******************************************************************04970076
049800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE UPC TABLE (XLT_UPC)04980076
049900******************************************************************04990076
050000     EXEC SQL                                                     05000076
050100         INCLUDE XLT00006                                         05010076
050200     END-EXEC.                                                    05020076
050300                                                                  05030076
050400******************************************************************05040076
050500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SKU TABLE (XLT_SKU)05050076
050600******************************************************************05060076
050700     EXEC SQL                                                     05070076
050800         INCLUDE XLT00003                                         05080076
050900     END-EXEC.                                                    05090076
051000                                                                  05100076
051100******************************************************************05110076
051200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SKU_STORE TABLE    05120076
051300*  (XLV_SKU_STR)                                                  05130076
051400******************************************************************05140076
051500     EXEC SQL                                                     05150076
051600         INCLUDE XLV00002                                         05160076
051700     END-EXEC.                                                    05170076
051800                                                                  05180076
051900******************************************************************05190076
052000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      05200076
052100*  UPC TABLE (SUT_OTBND_UPC)                                      05210076
052200******************************************************************05220076
052300     EXEC SQL                                                     05230076
052400         INCLUDE SUT00028                                         05240076
052500     END-EXEC.                                                    05250076
052600                                                                  05260076
052700******************************************************************05270076
052800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      05280076
052900*  CARTON TABLE (SUT_OTBND_CART)                                  05290076
053000******************************************************************05300076
053100     EXEC SQL                                                     05310076
053200         INCLUDE SUT00024                                         05320076
053300     END-EXEC.                                                    05330076
053400                                                                  05340076
053500******************************************************************05350076
053600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      05360076
053700*  PACK TABLE (SUT_OTBND_PK)                                      05370076
053800******************************************************************05380076
053900     EXEC SQL                                                     05390076
054000         INCLUDE SUT00041                                         05400076
054100     END-EXEC.                                                    05410076
054200                                                                  05420076
054300******************************************************************05430076
054400*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 05440076
054500******************************************************************05450076
054600     EXEC SQL                                                     05460076
054700         INCLUDE SUT00015                                         05470076
054800     END-EXEC.                                                    05480076
054900                                                                  05490076
055000******************************************************************05500076
055100*  COMMUNICATIONS AREA FOR DB2                                    05510076
055200******************************************************************05520076
055300     EXEC SQL                                                     05530076
055400         INCLUDE SQLCA                                            05540076
055500     END-EXEC.                                                    05550076
055600                                                                  05560076
055700******************************************************************05570076
055800*  CURSOR DECLARATION TO SELECT ALL THE ITEMS THAT ARE SUPPOSED   05580076
055900*  TO BE ON THE CARTON ALONG WITH THE QUANTITY OF EACH            05590076
056000******************************************************************05600076
056100     EXEC SQL                                                     05610076
056200         DECLARE CARTON_ITEM_CURSOR CURSOR                        05620076
056300             FOR SELECT                                           05630076
056400                 'A'                                              05640076
056500               , C.INTR_UPC_ID                                    05650076
056600               , 0                                                05660076
056700               , SUM(B.SHPD_UNT_QTY)                              05670076
056800             FROM SUT_OTBND_CART A                                05680076
056900                , SUT_OTBND_UPC B                                 05690076
057000                , XLT_UPC C                                       05700076
057100             WHERE A.ORIG_CART_ID = :DK-SHIPT-UNT-ID              05710076
057200               AND A.ACTV_IND     = 'Y'                           05720076
057300               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                05730076
057400               AND B.UPC_NBR = C.UPC_NBR                          05740076
057500             GROUP BY C.INTR_UPC_ID                               05750076
057600         UNION                                                    05760076
057700             SELECT                                               05770076
057800                 'B'                                              05780076
057900               , 999999999                                        05790076
058000               , B.UPC_NBR                                        05800076
058100               , SUM(B.SHPD_UNT_QTY)                              05810076
058200             FROM SUT_OTBND_CART A                                05820076
058300                , SUT_OTBND_UPC B                                 05830076
058400             WHERE A.ORIG_CART_ID = :DK-SHIPT-UNT-ID              05840076
058500               AND A.ACTV_IND     = 'Y'                           05850076
058600               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                05860076
058700               AND NOT EXISTS                                     05870076
058800              (SELECT  *                                          05880076
058900                 FROM XLT_UPC C                                   05890076
059000                 WHERE B.UPC_NBR = C.UPC_NBR)                     05900076
059100             GROUP BY B.UPC_NBR                                   05910076
059200         ORDER BY 2,3,1                                           05920076
059300     END-EXEC.                                                    05930076
059400                                                                  05940076
059500     EXEC SQL                                                     05950076
059600         DECLARE CARTON_LINE_CURSOR CURSOR                        05960076
059700             FOR SELECT                                           05970076
059800                 'A'                                              05980076
059900               , C.INTR_UPC_ID                                    05990076
060000               , B.TRN_LNE_NBR                                    06000076
060100               , 0                                                06010076
060200               , SUM(B.SHPD_UNT_QTY)                              06020076
060300             FROM SUT_OTBND_CART A                                06030076
060400                , SUT_OTBND_UPC B                                 06040076
060500                , XLT_UPC C                                       06050076
060600             WHERE A.ORIG_CART_ID = :DK-SHIPT-UNT-ID              06060076
060700               AND A.ACTV_IND     = 'Y'                           06070076
060800               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                06080076
060900               AND B.UPC_NBR = C.UPC_NBR                          06090076
061000             GROUP BY C.INTR_UPC_ID                               06100076
061100               ,   B.TRN_LNE_NBR                                  06110076
061200         UNION                                                    06120076
061300             SELECT                                               06130076
061400                 'B'                                              06140076
061500               , 0                                                06150076
061600               , 0                                                06160076
061700               , B.UPC_NBR                                        06170076
061800               , SUM(B.SHPD_UNT_QTY)                              06180076
061900             FROM SUT_OTBND_CART A                                06190076
062000                , SUT_OTBND_UPC B                                 06200076
062100             WHERE A.ORIG_CART_ID = :DK-SHIPT-UNT-ID              06210076
062200               AND A.ACTV_IND     = 'Y'                           06220076
062300               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                06230076
062400               AND NOT EXISTS                                     06240076
062500              (SELECT  *                                          06250076
062600                 FROM XLT_UPC C                                   06260076
062700                 WHERE B.UPC_NBR = C.UPC_NBR)                     06270076
062800             GROUP BY B.UPC_NBR                                   06280076
062900         ORDER BY 2,3,1                                           06290076
063000     END-EXEC.                                                    06300076
063100                                                                  06310076
063200******************************************************************06320076
063300*  CURSOR DECLARATION TO SELECT ALL THE ITEMS THAT HAVE BEEN      06330076
063400*  SCANNED INTO THE AUDIT ALONG WITH THE QUANTITY OF EACH         06340076
063500******************************************************************06350076
063600     EXEC SQL                                                     06360076
063700         DECLARE AUDIT_ITEM_CURSOR CURSOR                         06370076
063800             FOR SELECT                                           06380076
063900                 'A'                                              06390076
064000               , B.INTR_UPC_ID                                    06400076
064100               , 0                                                06410076
064200               , SUM(SCND_UNT_QTY)                                06420076
064300             FROM TSUAUPC A                                       06430076
064400                , XLT_UPC B                                       06440076
064500             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              06450076
064600               AND A.AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR            06460076
064700               AND A.UPC_NBR = B.UPC_NBR                          06470076
064800               AND A.SCN_TYP_CDE <> 'E'                           06480076
064900             GROUP BY B.INTR_UPC_ID                               06490076
065000         UNION                                                    06500076
065100             SELECT                                               06510076
065200                 'B'                                              06520076
065300               , 999999999                                        06530076
065400               , A.UPC_NBR                                        06540076
065500               , SUM(SCND_UNT_QTY)                                06550076
065600             FROM TSUAUPC A                                       06560076
065700             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              06570076
065800               AND A.AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR            06580076
065900               AND A.SCN_TYP_CDE <> 'E'                           06590076
066000               AND NOT EXISTS                                     06600076
066100              (SELECT  *                                          06610076
066200                 FROM XLT_UPC B                                   06620076
066300                 WHERE A.UPC_NBR = B.UPC_NBR)                     06630076
066400             GROUP BY A.UPC_NBR                                   06640076
066500         ORDER BY 2,3,1                                           06650076
066600     END-EXEC.                                                    06660076
066700                                                                  06670076
066800     EXEC SQL                                                     06680076
066900         DECLARE CARTON_UPC_CURSOR CURSOR                         06690076
067000             FOR SELECT                                           06700076
067100                 B.TRN_NBR                                        06710076
067200               , B.RCVR_SEQ_NBR                                   06720076
067300               , B.TRN_LNE_NBR                                    06730076
067400               , B.TRN_TYP_CDE                                    06740076
067500               , B.UPC_NBR                                        06750076
067600               , B.SHPD_UNT_QTY                                   06760076
067700             FROM SUT_OTBND_CART A                                06770076
067800                , SUT_OTBND_UPC B                                 06780076
067900                , XLT_UPC C                                       06790076
068000             WHERE A.ORIG_CART_ID   = :DK-SHIPT-UNT-ID            06800076
068100               AND A.ACTV_IND     = 'Y'                           06810076
068200               AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID              06820076
068300               AND B.UPC_NBR        = C.UPC_NBR                   06830076
068400               AND C.INTR_UPC_ID    = :DK-INTR-UPC                06840076
068500          ORDER BY B.SHPD_UNT_QTY DESC                            06850076
068600     END-EXEC.                                                    06860076
068700                                                                  06870076
068800     EXEC SQL                                                     06880076
068900         DECLARE AUDIT_LINE_CURSOR CURSOR                         06890076
069000             FOR SELECT                                           06900076
069100                 'A'                                              06910076
069200               , B.INTR_UPC_ID                                    06920076
069300               , 0                                                06930076
069400               , SUM(SCND_UNT_QTY)                                06940076
069500             FROM TSUAUPC A                                       06950076
069600                , XLT_UPC B                                       06960076
069700             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              06970076
069800               AND A.AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR            06980076
069900               AND A.UPC_NBR = B.UPC_NBR                          06990076
070000               AND A.SCN_TYP_CDE <> 'E'                           07000076
070100             GROUP BY B.INTR_UPC_ID                               07010076
070200         UNION                                                    07020076
070300             SELECT                                               07030076
070400                 'B'                                              07040076
070500               , 999999999                                        07050076
070600               , A.UPC_NBR                                        07060076
070700               , SUM(SCND_UNT_QTY)                                07070076
070800             FROM TSUAUPC A                                       07080076
070900             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              07090076
071000               AND A.AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR            07100076
071100               AND A.SCN_TYP_CDE <> 'E'                           07110076
071200               AND NOT EXISTS                                     07120076
071300              (SELECT  *                                          07130076
071400                 FROM XLT_UPC B                                   07140076
071500                 WHERE A.UPC_NBR = B.UPC_NBR)                     07150076
071600             GROUP BY A.UPC_NBR                                   07160076
071700         ORDER BY 2,3,1                                           07170076
071800     END-EXEC.                                                    07180076
071900                                                                  07190076
072000     EXEC SQL                                                     07200076
072100         DECLARE PO-CSR CURSOR                                    07210076
072200             FOR SELECT                                           07220076
072300                 A.APP_PO_LNE_NBR                                 07230076
072400              ,  A.STATUS_CDE                                     07240076
072500             FROM TPURITM A                                       07250076
072600             WHERE A.PO_NBR         = :DK-PO-NBR                  07260076
072700               AND A.VER_STATUS_CDE = 'A'                         07270076
072800               AND A.ITM_NBR        = :XL001-ITM-NBR              07280076
072900          ORDER BY 2,1                                            07290076
073000     END-EXEC.                                                    07300076
073100                                                                  07310076
073200     EXEC SQL                                                     07320076
073300          DECLARE PACK-CURSOR CURSOR FOR                          07330076
073400          SELECT                                                  07340076
073500                 A.ORD_LNE_NBR                                    07350076
073600              ,  A.ITM_NBR                                        07360076
073700              ,  A.PREPK_RATO_QTY                                 07370076
073800              ,  A.PREPK_DRV_LNE_CDE                              07380076
073900          FROM                                                    07390076
074000                 TRECITM  A                                       07400076
074100          WHERE                                                   07410076
074200                A.ORD_NBR          =  :DK-PO-NBR                  07420076
074300           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            07430076
074400           AND  A.VER_STATUS_CDE   =  'A'                         07440076
074500           AND  A.PREPK_ID         = :DK-PACK-ID                  07450076
074600     END-EXEC.                                                    07460076
074700                                                                  07470076
074800     EXEC SQL                                                     07480076
074900         DECLARE ZERO-CSR CURSOR WITH HOLD FOR                    07490076
075000         SELECT  A.TRN_LNE_NBR                                    07500076
075100             ,   B.INTR_UPC_ID                                    07510076
075200             ,   A.UPC_NBR                                        07520076
075300         FROM SUT_OTBND_UPC A                                     07530076
075400            , XLT_UPC       B                                     07540076
075500         WHERE A.SHIPT_UNT_ID     = :DK-OTBND-SHIPT-UNT-ID        07550076
075600           AND A.UPC_NBR          = B.UPC_NBR                     07560076
075700         ORDER BY B.INTR_UPC_ID                                   07570076
075800               ,  A.TRN_LNE_NBR                                   07580076
075900     END-EXEC.                                                    07590076
076000******************************************************************07600076
076100 LINKAGE SECTION.                                                 07610076
076200 01  DFHCOMMAREA.                                                 07620076
076300     05  FILLER                         OCCURS  1 TO 4072 TIMES   07630076
076400                                      DEPENDING ON EIBCALEN.      07640076
076500         10  FILLER                   PIC X.                      07650076
076600******************************************************************07660076
076700 PROCEDURE DIVISION.                                              07670076
076800******************************************************************07680076
076900 0000-PROGRAM-MAINLINE.                                           07690076
077000     INITIALIZE PV-PROGRAM-VARIABLES                              07700076
077100                PS-PROGRAM-SWITCHES                               07710076
077200                SU034-COMM-AREA                                   07720076
077300                TB-PACK-TABLE.                                    07730076
077400     MOVE DFHCOMMAREA              TO  SU034-COMM-AREA.           07740076
077500     SET PS-NO-ERROR TO TRUE.                                     07750076
077600     MOVE SU034-ADJ-AUDIT-CNTL-NBR TO DK-AUDIT-CNTL-NBR.          07760076
077700     MOVE SU034-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID.                 07770076
077800     MOVE SU034-STR-NBR       TO DK-STR-NBR.                      07780076
077900     PERFORM 3650-CHECK-UNIT-ADJ-DC.                              07790076
078000     PERFORM 4400-SELECT-TSUNAUD-DATE.                            07800076
078100     PERFORM 3600-SELECT-MAX-RETAIL.                              07810076
078200     PERFORM 3500-SELECT-MAX-QUANTITY.                            07820076
078300     PERFORM 4200-GET-SCN-QTY.                                    07830076
078400     PERFORM 3700-SELECT-TSUATRN.                                 07840076
078500     PERFORM 4500-GET-DEPT.                                       07850076
078600     PERFORM 4600-CHECK-IF-SYSTEM-GEN.                            07860076
078700     PERFORM 4100-SELECT-REC-SEQ.                                 07870076
078800     PERFORM 8400-CHECK-IF-AUTO-VE.                               07880076
078900     IF PS-NOT-UNIT-ADJUST-DC OR                                  07890076
079000        (PS-UNIT-ADJUST-DC AND                                    07900076
079100         KRPRPM-FUNC-BEG-TMST > SUNAUD-AUD-STRT-TMST) OR          07910076
079200        (PS-UNIT-ADJUST-DC AND                                    07920076
079300         PS-DEPT-NBR AND                                          07930076
079400         PV-TABLE-DEPT-NBR NOT = PV-DEPT-NUMBER)                  07940076
079500         SET PS-NOT-UNIT-ADJUST-DEPT-DC TO TRUE                   07950076
079600     ELSE                                                         07960076
079700         SET PS-UNIT-ADJUST-DEPT-DC     TO TRUE                   07970076
079800     END-IF.                                                      07980076
079900     IF PV-SCN-QTY = 0                                            07990076
080000         IF PS-UNIT-ADJUST-DEPT-DC                                08000076
080100             MOVE SUATRN-TRN-NBR  TO DK-PO-NBR                    08010076
080200             MOVE 0               TO PV-FINCL-ADJ-ID              08020076
080300                                     DK-TRN-LNE-NBR               08030076
080400                                     DK-UPC-NBR                   08040076
080500                                     PV-BEFORE-QTY                08050076
080600                                     PV-AFTER-QTY                 08060076
080700                                     PV-ADJUST-QTY                08070076
080800             PERFORM 3100-SELECT-CARTON                           08080076
080900             MOVE SUT00024-SHIPT-UNT-ID                           08090076
081000                                  TO DK-OTBND-SHIPT-UNT-ID        08100076
081100             SET PS-RECEIVER-FOUND  TO TRUE                       08110076
081200             PERFORM 4100-SELECT-REC-SEQ                          08120076
081300                                                                  08130076
081400             MOVE 21 TO SUT00030-ADJ-ERR-CDE                      08140076
081500             SET PS-ADD-ZERO-UPC  TO TRUE                         08150076
081600             SET PS-FINCL-ADJ-ID-EXISTS TO TRUE                   08160076
081700                                                                  08170076
081800             PERFORM UNTIL PS-FINCL-ADJ-ID-NOT-EXISTS             08180076
081900                 PERFORM 2800-CREATE-RANDOM-NBR                   08190076
082000                                                                  08200076
082100                 MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID      08210076
082200                 PERFORM 2900-SELECT-SUT-FINCL-ADJ                08220076
082300             END-PERFORM                                          08230076
082400             PERFORM 2410-SELECT-RECEIVER                         08240076
082500             IF RECEIV-STATUS-CDE NOT EQUAL 'VE'                  08250076
082600                 PERFORM 4300-CREATE-TROUBLE                      08260076
082700             END-IF                                               08270076
082800             PERFORM 4000-INSERT-FINCL-ADJ                        08280076
082900         ELSE                                                     08290076
083000             CONTINUE                                             08300076
083100         END-IF                                                   08310076
083200     ELSE                                                         08320076
083300         MOVE 0                   TO DK-UPC-NBR                   08330076
083400         MOVE SUATRN-TRN-NBR      TO DK-PO-NBR                    08340076
083500         PERFORM 3100-SELECT-CARTON                               08350076
083600         MOVE SUT00024-SHIPT-UNT-ID                               08360076
083700                              TO DK-OTBND-SHIPT-UNT-ID            08370076
083800         SET PS-RECEIVER-FOUND  TO TRUE                           08380076
083900         PERFORM 4100-SELECT-REC-SEQ                              08390076
084000         PERFORM 2410-SELECT-RECEIVER                             08400076
084100         PERFORM 9000-PROCESS-OTBND-UPC                           08410076
084200         IF PS-NO-RECEIVER-FOUND                                  08420076
084300             IF PS-UNIT-ADJUST-DEPT-DC                            08430076
084400                 PERFORM 4300-CREATE-TROUBLE                      08440076
084500                 MOVE 15 TO SUT00030-ADJ-ERR-CDE                  08450076
084600                 PERFORM 4000-INSERT-FINCL-ADJ                    08460076
084700             END-IF                                               08470076
084800         ELSE                                                     08480076
084900             SET PS-NO-FAILED-ADJ   TO TRUE                       08490076
085000             IF RECEIV-PKGNG-CDE = 'I' OR 'M'                     08500076
085100                 SET PS-APPLY-CRT-UPDATES      TO TRUE            08510076
085200                 SET PS-APPLY-TO-ALL-PACKS     TO TRUE            08520076
085300                 PERFORM 5000-PROCESS-PREPACKS                    08530076
085400                 IF PS-APPLY-CRT-UPDATES                          08540076
085500                     IF PS-UPDATE-NBR-PACKS                       08550076
085600                         MOVE PV-SAVE-PACK-DIFF  TO PV-PACK-DIFF  08560076
085700                         PERFORM 5900-PROCESS-OTBND-PK            08570076
085800                     END-IF                                       08580076
085900                     IF PS-ODD-UNITS-ADDED OR                     08590076
086000                        PS-ODD-UNITS-EXIST                        08600076
086100                         IF SUT00024-ODD-UNT-IND = 'Y'            08610076
086200                             CONTINUE                             08620076
086300                         ELSE                                     08630076
086400                             MOVE 'Y' TO SUT00024-ODD-UNT-IND     08640076
086500                             PERFORM 6000-UPDATE-OTBND-CART       08650076
086600                         END-IF                                   08660076
086700                     ELSE                                         08670076
086800                         IF PS-ODD-UNITS-PROCESSED                08680076
086900                             IF SUT00024-ODD-UNT-IND = 'N'        08690076
087000                                 CONTINUE                         08700076
087100                             ELSE                                 08710076
087200                                 MOVE 'N' TO SUT00024-ODD-UNT-IND 08720076
087300                                 PERFORM 6000-UPDATE-OTBND-CART   08730076
087400                             END-IF                               08740076
087500                         END-IF                                   08750076
087600                     END-IF                                       08760076
087700                 ELSE                                             08770076
087800                     MOVE 1 TO PV-SAVE-LINE-IDX                   08780076
087900                     SET PS-DONT-UPDATE-NBR-PACKS   TO TRUE       08790076
088000                     SET PS-ONLY-APPLY-TO-BAD-PACKS TO TRUE       08800076
088100                     SET PS-NO-ODD-UNITS-ADDED      TO TRUE       08810076
088200                     SET PS-NO-ODD-UNITS-EXIST      TO TRUE       08820076
088300                     SET PS-NO-ODD-UNITS-PROCESSED  TO TRUE       08830076
088400                     PERFORM 5700-CALL-BEST-CASE-RTN              08840076
088500                       UNTIL PACK-IND (PV-SAVE-LINE-IDX) NOT = 'Y'08850076
088600                          OR PV-SAVE-LINE-IDX > 500               08860076
088700                     IF PS-UPDATE-NBR-PACKS                       08870076
088800                         MOVE PV-SAVE-PACK-DIFF  TO PV-PACK-DIFF  08880076
088900                         PERFORM 5900-PROCESS-OTBND-PK            08890076
089000                     END-IF                                       08900076
089100                     IF PS-ODD-UNITS-ADDED OR                     08910076
089200                        PS-ODD-UNITS-EXIST                        08920076
089300                         IF SUT00024-ODD-UNT-IND = 'Y'            08930076
089400                             CONTINUE                             08940076
089500                         ELSE                                     08950076
089600                             MOVE 'Y' TO SUT00024-ODD-UNT-IND     08960076
089700                             PERFORM 6000-UPDATE-OTBND-CART       08970076
089800                         END-IF                                   08980076
089900                     ELSE                                         08990076
090000                         IF PS-ODD-UNITS-PROCESSED                09000076
090100                             IF SUT00024-ODD-UNT-IND = 'N'        09010076
090200                                 CONTINUE                         09020076
090300                             ELSE                                 09030076
090400                                 MOVE 'N' TO SUT00024-ODD-UNT-IND 09040076
090500                                 PERFORM 6000-UPDATE-OTBND-CART   09050076
090600                             END-IF                               09060076
090700                         END-IF                                   09070076
090800                     END-IF                                       09080076
090900                 END-IF                                           09090076
091000             ELSE                                                 09100076
091100                 PERFORM 1000-CHECK-OVER-SHORT                    09110076
091200             END-IF                                               09120076
091300         END-IF                                                   09130076
091400     END-IF.                                                      09140076
091500                                                                  09150076
091600     IF PS-FAILED-ADJ AND                                         09160076
091700        SU034-SUCCESSFUL                                          09170076
091800         SET SU034-FAILED-ADJ  TO TRUE                            09180076
091900     END-IF.                                                      09190076
092000     MOVE SU034-COMM-AREA               TO DFHCOMMAREA.           09200076
092100     GOBACK.                                                      09210076
092200******************************************************************09220076
092300* 1000-CHECK-OVER-SHORT                                          *09230076
092400*  COMPARE EACH ITEM ON THE CARTON DATABASE, DO A SELECT OF THE  *09240076
092500* AUDIT DATABASE TO DETERMINE IF THE ITEM WAS ACTUALLY FOUND TO  *09250076
092600* BE IN IT, AND IF SO, WHO MUCH WAS IN IT (OVER/SHORT)           *09260076
092700******************************************************************09270076
092800 1000-CHECK-OVER-SHORT.                                           09280076
092900                                                                  09290076
093000     PERFORM 3100-SELECT-CARTON                                   09300076
093100     MOVE SUT00024-SHIPT-UNT-ID      TO DK-OTBND-SHIPT-UNT-ID.    09310076
093200                                                                  09320076
093300     PERFORM 1100-OPEN-CARTON-ITEM-CURSOR.                        09330076
093400     PERFORM 1130-FETCH-CARTON-ITEM-CURSOR.                       09340076
093500                                                                  09350076
093600     PERFORM 1200-OPEN-AUDIT-ITEM-CURSOR.                         09360076
093700     IF PS-NO-ERROR                                               09370076
093800         PERFORM 1230-FETCH-AUDIT-ITEM-CURSOR                     09380076
093900     END-IF.                                                      09390076
094000                                                                  09400076
094100                                                                  09410076
094200*    BUMP THE TWO ITEM CURSORS TOGETHER.  FOR EVERY ITEM WHERE    09420076
094300*    A UPC IS ON ONE BUT NO THE OTHER, OR IF THE QUANTITIES DO    09430076
094400*    NOT MATCH, THERE IS AN OVERAGE OR A SHORTAGE ERROR.  CHECK   09440076
094500*    EVERY ITEM AND CREATE AN EXCEPTION FOR EVERY OVERAGE OR      09450076
094600*    SHORTAGE.                                                    09460076
094700     PERFORM UNTIL PS-EOC-CARTON-ITEM-CURSOR                      09470076
094800               AND PS-EOC-AUDIT-ITEM-CURSOR                       09480076
094900                                                                  09490076
095000         INITIALIZE PV-SAVE-UPC-UPDATE-AREA                       09500076
095100         SET PS-DONT-BACK-OUT-UPDATES   TO TRUE                   09510076
095200         SET PS-OTBND-UPC-NOT-UPDATED TO TRUE                     09520076
095300         IF PV-AUDIT-INTR-UPC   =  PV-CARTON-INTR-UPC             09530076
095400         AND PV-AUDIT-HOLD-UPC-NBR = PV-CARTON-HOLD-UPC-NBR       09540076
095500         AND PV-AUDIT-ITEM-COUNT =  PV-CARTON-ITEM-COUNT          09550076
095600             PERFORM 1130-FETCH-CARTON-ITEM-CURSOR                09560076
095700             PERFORM 1230-FETCH-AUDIT-ITEM-CURSOR                 09570076
095800         ELSE                                                     09580076
095900             IF  PV-AUDIT-INTR-UPC   =  PV-CARTON-INTR-UPC        09590076
096000             AND PV-AUDIT-HOLD-UPC-NBR = PV-CARTON-HOLD-UPC-NBR   09600076
096100             AND PV-AUDIT-ITEM-COUNT NOT =  PV-CARTON-ITEM-COUNT  09610076
096200                 MOVE PV-CARTON-INTR-UPC   TO DK-INTR-UPC         09620076
096300                 MOVE PV-AUDIT-ITEM-COUNT  TO PV-AUDIT-SHPD-QTY   09630076
096400                 MOVE PV-CARTON-ITEM-COUNT TO PV-CARTON-SHPD-QTY  09640076
096500                 PERFORM 2000-UPDATE-THIS-CARTON                  09650076
096600                 SET PS-OVER-SHORT-ERROR TO TRUE                  09660076
096700                 PERFORM 1130-FETCH-CARTON-ITEM-CURSOR            09670076
096800                 PERFORM 1230-FETCH-AUDIT-ITEM-CURSOR             09680076
096900             ELSE                                                 09690076
097000               IF PS-EOC-AUDIT-ITEM-CURSOR OR                     09700076
097100                 (PV-AUDIT-INTR-UPC   >  PV-CARTON-INTR-UPC       09710076
097200                  AND PS-NOT-EOC-CARTON-ITEM-CURSOR) OR           09720076
097300                 (PV-AUDIT-INTR-UPC   =  PV-CARTON-INTR-UPC       09730076
097400                AND PV-AUDIT-HOLD-UPC-NBR > PV-CARTON-HOLD-UPC-NBR09740076
097500                  AND PS-NOT-EOC-CARTON-ITEM-CURSOR)              09750076
097600                 IF PV-CARTON-ITEM-COUNT = 0                      09760076
097700                     CONTINUE                                     09770076
097800                 ELSE                                             09780076
097900                     MOVE PV-CARTON-ITEM-COUNT                    09790076
098000                                          TO SUQADJ-ADJ-BEF-QTY   09800076
098100                                             PV-BEFORE-QTY        09810076
098200                     MOVE 0               TO SUQADJ-ADJ-AFT-QTY   09820076
098300                                             PV-AFTER-QTY         09830076
098400                     COMPUTE PV-ADJUST-QTY =                      09840076
098500                                      PV-CARTON-ITEM-COUNT * -1   09850076
098600                     IF PV-CARTON-REC-TYPE = 'A'                  09860076
098700                         MOVE PV-CARTON-INTR-UPC                  09870076
098800                                             TO DK-CARTON-INTR-UPC09880076
098900                         PERFORM 3200-SELECT-UPC                  09890076
099000                     ELSE                                         09900076
099100                         MOVE PV-CARTON-HOLD-UPC-NBR              09910076
099200                                                 TO DK-UPC-NBR    09920076
099300                         PERFORM 3300-SELECT-UPC                  09930076
099400                     END-IF                                       09940076
099500                     MOVE SU034-OPER-UNT-ID TO SUQADJ-OPER-UNT-ID 09950076
099600                     MOVE SU034-USER-ID     TO SUQADJ-ADJ-USR-ID  09960076
099700                     MOVE SU034-ADJ-AUDIT-CNTL-NBR                09970076
099800                                            TO SUQADJ-AUD-CNTL-NBR09980076
099900                     PERFORM 2500-UPDATE-OTBND-UPC                09990076
100000                     MOVE PV-CARTON-INTR-UPC  TO DK-INTR-UPC      10000076
100100                     PERFORM 2300-UPDATE-CARTON                   10010076
100200                   SET PS-OVER-SHORT-ERROR TO TRUE                10020076
100300                 END-IF                                           10030076
100400                 PERFORM 1130-FETCH-CARTON-ITEM-CURSOR            10040076
100500               ELSE                                               10050076
100600                 IF PV-AUDIT-ITEM-COUNT = 0                       10060076
100700                     CONTINUE                                     10070076
100800                 ELSE                                             10080076
100900                     MOVE PV-AUDIT-ITEM-COUNT                     10090076
101000                                          TO SUQADJ-ADJ-AFT-QTY   10100076
101100                                             PV-AFTER-QTY         10110076
101200                     MOVE PV-AUDIT-ITEM-COUNT                     10120076
101300                                          TO PV-ADJUST-QTY        10130076
101400                                             SUT00028-SHPD-UNT-QTY10140076
101500                     MOVE PV-AUDIT-HOLD-UPC-NBR TO DK-UPC-NBR     10150076
101600                     PERFORM 2400-ADD-NEW-UPC                     10160076
101700                     SET PS-OVER-SHORT-ERROR TO TRUE              10170076
101800                 END-IF                                           10180076
101900                 PERFORM 1230-FETCH-AUDIT-ITEM-CURSOR             10190076
102000               END-IF                                             10200076
102100             END-IF                                               10210076
102200         END-IF                                                   10220076
102300                                                                  10230076
102400     END-PERFORM.                                                 10240076
102500                                                                  10250076
102600*    CLOSE THE CURSORS                                            10260076
102700     PERFORM 1160-CLOSE-CARTON-ITEM-CURSOR.                       10270076
102800     PERFORM 1260-CLOSE-AUDIT-ITEM-CURSOR.                        10280076
102900                                                                  10290076
103000******************************************************************10300076
103100* 1100-OPEN-CARTON-ITEM-CURSOR                                   *10310076
103200*  OPEN THE PO LINE CURSOR                                       *10320076
103300******************************************************************10330076
103400 1100-OPEN-CARTON-ITEM-CURSOR.                                    10340076
103500                                                                  10350076
103600     EXEC SQL                                                     10360076
103700         OPEN CARTON_ITEM_CURSOR                                  10370076
103800     END-EXEC.                                                    10380076
103900                                                                  10390076
104000     EVALUATE TRUE                                                10400076
104100         WHEN SQLCODE = ZERO                                      10410076
104200             SET PS-NOT-EOC-CARTON-ITEM-CURSOR                    10420076
104300                 PS-NO-OVER-SHORT-ERROR       TO TRUE             10430076
104400                                                                  10440076
104500         WHEN SQLWARN0 NOT = SPACES                               10450076
104600         WHEN SQLCODE < ZERO                                      10460076
104700         WHEN SQLCODE > ZERO                                      10470076
104800             SET PS-ERROR                                         10480076
104900                 SU034-INVALID-SQL    TO TRUE                     10490076
105000             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     10500076
105100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       10510076
105200             STRING   ' SUKUT701-1100-'                           10520076
105300                      ' CALLED BY-'                               10530076
105400                      SU034-PROGRAM-NAME                          10540076
105500                      '  SQLCODE='                                10550076
105600                      PV-DISPLAY-SQLCODE                          10560076
105700                      ' '                                         10570076
105800                      PV-DISP-SHIPT-UNT-ID                        10580076
105900                      DELIMITED BY SIZE                           10590076
106000                                      INTO SU034-CRA-RET-MSG      10600076
106100             PERFORM 9999-WRITE-TO-CSSL                           10610076
106200             MOVE '1100-'                TO SU034-CRA-REQ-ID      10620076
106300             SET SU034-INVALID-SQL TO TRUE                        10630076
106400             PERFORM 9998-RETURN                                  10640076
106500     END-EVALUATE.                                                10650076
106600                                                                  10660076
106700******************************************************************10670076
106800* 1130-FETCH-CARTON-ITEM-CURSOR                                  *10680076
106900*  FETCH THE NEXT OCCURANCE OF THE OVER_SHORT_CUSOR              *10690076
107000******************************************************************10700076
107100 1130-FETCH-CARTON-ITEM-CURSOR.                                   10710076
107200                                                                  10720076
107300     EXEC SQL                                                     10730076
107400         FETCH CARTON_ITEM_CURSOR                                 10740076
107500         INTO    :PV-CARTON-REC-TYPE                              10750076
107600              ,  :PV-CARTON-INTR-UPC                              10760076
107700              ,  :PV-CARTON-HOLD-UPC-NBR                          10770076
107800              ,  :PV-CARTON-ITEM-COUNT                            10780076
107900     END-EXEC.                                                    10790076
108000                                                                  10800076
108100     EVALUATE TRUE                                                10810076
108200         WHEN SQLCODE = ZERO                                      10820076
108300             CONTINUE                                             10830076
108400                                                                  10840076
108500         WHEN SQLCODE = +100                                      10850076
108600             SET PS-EOC-CARTON-ITEM-CURSOR   TO TRUE              10860076
108700             MOVE 0                TO PV-CARTON-ITEM-COUNT        10870076
108800                                                                  10880076
108900         WHEN SQLWARN0 NOT = SPACES                               10890076
109000         WHEN SQLCODE < ZERO                                      10900076
109100         WHEN SQLCODE > ZERO                                      10910076
109200             SET PS-ERROR                                         10920076
109300                 SU034-INVALID-SQL    TO TRUE                     10930076
109400             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     10940076
109500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       10950076
109600             STRING   ' SUKUT701-1130-'                           10960076
109700                      ' CALLED BY-'                               10970076
109800                      SU034-PROGRAM-NAME                          10980076
109900                      '  SQLCODE='                                10990076
110000                      PV-DISPLAY-SQLCODE                          11000076
110100                      ' '                                         11010076
110200                      PV-DISP-SHIPT-UNT-ID                        11020076
110300                      DELIMITED BY SIZE                           11030076
110400                                      INTO SU034-CRA-RET-MSG      11040076
110500             PERFORM 9999-WRITE-TO-CSSL                           11050076
110600             MOVE '1130-'                TO SU034-CRA-REQ-ID      11060076
110700             SET SU034-INVALID-SQL TO TRUE                        11070076
110800             PERFORM 9998-RETURN                                  11080076
110900     END-EVALUATE.                                                11090076
111000                                                                  11100076
111100******************************************************************11110076
111200* 1160-CLOSE-CARTON-ITEM-CURSOR                                  *11120076
111300*  CLOSE THE PO LINE CURSOR                                      *11130076
111400******************************************************************11140076
111500 1160-CLOSE-CARTON-ITEM-CURSOR.                                   11150076
111600                                                                  11160076
111700     EXEC SQL                                                     11170076
111800         CLOSE CARTON_ITEM_CURSOR                                 11180076
111900     END-EXEC.                                                    11190076
112000                                                                  11200076
112100     EVALUATE TRUE                                                11210076
112200         WHEN SQLCODE = ZERO                                      11220076
112300             CONTINUE                                             11230076
112400                                                                  11240076
112500         WHEN SQLWARN0 NOT = SPACES                               11250076
112600         WHEN SQLCODE < ZERO                                      11260076
112700         WHEN SQLCODE > ZERO                                      11270076
112800             SET PS-ERROR                                         11280076
112900                 SU034-INVALID-SQL    TO TRUE                     11290076
113000             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     11300076
113100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       11310076
113200             STRING   ' SUKUT701-1160-'                           11320076
113300                      ' CALLED BY-'                               11330076
113400                      SU034-PROGRAM-NAME                          11340076
113500                      '  SQLCODE='                                11350076
113600                      PV-DISPLAY-SQLCODE                          11360076
113700                      ' '                                         11370076
113800                      PV-DISP-SHIPT-UNT-ID                        11380076
113900                      DELIMITED BY SIZE                           11390076
114000                                      INTO SU034-CRA-RET-MSG      11400076
114100             PERFORM 9999-WRITE-TO-CSSL                           11410076
114200             MOVE '1160-'                TO SU034-CRA-REQ-ID      11420076
114300             SET SU034-INVALID-SQL TO TRUE                        11430076
114400             PERFORM 9998-RETURN                                  11440076
114500     END-EVALUATE.                                                11450076
114600                                                                  11460076
114700                                                                  11470076
114800******************************************************************11480076
114900* 1200-OPEN-AUDIT-ITEM-CURSOR                                    *11490076
115000*  OPEN THE PO LINE CURSOR                                       *11500076
115100******************************************************************11510076
115200 1200-OPEN-AUDIT-ITEM-CURSOR.                                     11520076
115300                                                                  11530076
115400     EXEC SQL                                                     11540076
115500         OPEN AUDIT_ITEM_CURSOR                                   11550076
115600     END-EXEC.                                                    11560076
115700                                                                  11570076
115800     EVALUATE TRUE                                                11580076
115900         WHEN SQLCODE = ZERO                                      11590076
116000             SET PS-NOT-EOC-AUDIT-ITEM-CURSOR                     11600076
116100                 PS-NO-OVER-SHORT-ERROR       TO TRUE             11610076
116200                                                                  11620076
116300         WHEN SQLWARN0 NOT = SPACES                               11630076
116400         WHEN SQLCODE < ZERO                                      11640076
116500         WHEN SQLCODE > ZERO                                      11650076
116600             SET PS-ERROR                                         11660076
116700                 SU034-INVALID-SQL    TO TRUE                     11670076
116800             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     11680076
116900             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR11690076
117000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       11700076
117100             STRING   ' SUKUT701-1200-'                           11710076
117200                      ' CALLED BY-'                               11720076
117300                      SU034-PROGRAM-NAME                          11730076
117400                      '  SQLCODE='                                11740076
117500                      PV-DISPLAY-SQLCODE                          11750076
117600                      ' '                                         11760076
117700                      PV-DISP-SHIPT-UNT-ID                        11770076
117800                      ' '                                         11780076
117900                      PV-DISPLAY-AUDIT-CNTL-NBR                   11790076
118000                      DELIMITED BY SIZE                           11800076
118100                                      INTO SU034-CRA-RET-MSG      11810076
118200             PERFORM 9999-WRITE-TO-CSSL                           11820076
118300             MOVE '1200-'                TO SU034-CRA-REQ-ID      11830076
118400             SET SU034-INVALID-SQL TO TRUE                        11840076
118500             PERFORM 9998-RETURN                                  11850076
118600     END-EVALUATE.                                                11860076
118700                                                                  11870076
118800******************************************************************11880076
118900* 1230-FETCH-AUDIT-ITEM-CURSOR                                   *11890076
119000*  FETCH THE NEXT OCCURANCE OF THE OVER_SHORT_CUSOR              *11900076
119100******************************************************************11910076
119200 1230-FETCH-AUDIT-ITEM-CURSOR.                                    11920076
119300                                                                  11930076
119400     EXEC SQL                                                     11940076
119500         FETCH AUDIT_ITEM_CURSOR                                  11950076
119600         INTO    :PV-AUDIT-REC-TYPE                               11960076
119700              ,  :PV-AUDIT-INTR-UPC                               11970076
119800              ,  :PV-AUDIT-HOLD-UPC-NBR                           11980076
119900              ,  :PV-AUDIT-ITEM-COUNT                             11990076
120000     END-EXEC.                                                    12000076
120100                                                                  12010076
120200     EVALUATE TRUE                                                12020076
120300         WHEN SQLCODE = ZERO                                      12030076
120400             CONTINUE                                             12040076
120500                                                                  12050076
120600         WHEN SQLCODE = +100                                      12060076
120700             SET PS-EOC-AUDIT-ITEM-CURSOR    TO TRUE              12070076
120800             MOVE 0                TO PV-AUDIT-ITEM-COUNT         12080076
120900                                                                  12090076
121000         WHEN SQLWARN0 NOT = SPACES                               12100076
121100         WHEN SQLCODE < ZERO                                      12110076
121200         WHEN SQLCODE > ZERO                                      12120076
121300             SET PS-ERROR                                         12130076
121400                 SU034-INVALID-SQL    TO TRUE                     12140076
121500             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     12150076
121600             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR12160076
121700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12170076
121800             STRING   ' SUKUT701-1230-'                           12180076
121900                      ' CALLED BY-'                               12190076
122000                      SU034-PROGRAM-NAME                          12200076
122100                      '  SQLCODE='                                12210076
122200                      PV-DISPLAY-SQLCODE                          12220076
122300                      ' '                                         12230076
122400                      PV-DISP-SHIPT-UNT-ID                        12240076
122500                      ' '                                         12250076
122600                      PV-DISPLAY-AUDIT-CNTL-NBR                   12260076
122700                      DELIMITED BY SIZE                           12270076
122800                                      INTO SU034-CRA-RET-MSG      12280076
122900             PERFORM 9999-WRITE-TO-CSSL                           12290076
123000             MOVE '1230-'                TO SU034-CRA-REQ-ID      12300076
123100             SET SU034-INVALID-SQL TO TRUE                        12310076
123200             PERFORM 9998-RETURN                                  12320076
123300     END-EVALUATE.                                                12330076
123400                                                                  12340076
123500******************************************************************12350076
123600* 1260-CLOSE-AUDIT-ITEM-CURSOR                                   *12360076
123700*  CLOSE THE PO LINE CURSOR                                      *12370076
123800******************************************************************12380076
123900 1260-CLOSE-AUDIT-ITEM-CURSOR.                                    12390076
124000                                                                  12400076
124100     EXEC SQL                                                     12410076
124200         CLOSE AUDIT_ITEM_CURSOR                                  12420076
124300     END-EXEC.                                                    12430076
124400                                                                  12440076
124500     EVALUATE TRUE                                                12450076
124600         WHEN SQLCODE = ZERO                                      12460076
124700             CONTINUE                                             12470076
124800                                                                  12480076
124900         WHEN SQLWARN0 NOT = SPACES                               12490076
125000         WHEN SQLCODE < ZERO                                      12500076
125100         WHEN SQLCODE > ZERO                                      12510076
125200             SET PS-ERROR                                         12520076
125300                 SU034-INVALID-SQL    TO TRUE                     12530076
125400             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     12540076
125500             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR12550076
125600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12560076
125700             STRING   ' SUKUT701-1260-'                           12570076
125800                      ' CALLED BY-'                               12580076
125900                      SU034-PROGRAM-NAME                          12590076
126000                      '  SQLCODE='                                12600076
126100                      PV-DISPLAY-SQLCODE                          12610076
126200                      ' '                                         12620076
126300                      PV-DISP-SHIPT-UNT-ID                        12630076
126400                      ' '                                         12640076
126500                      PV-DISPLAY-AUDIT-CNTL-NBR                   12650076
126600                      DELIMITED BY SIZE                           12660076
126700                                      INTO SU034-CRA-RET-MSG      12670076
126800             PERFORM 9999-WRITE-TO-CSSL                           12680076
126900             MOVE '1260-'                TO SU034-CRA-REQ-ID      12690076
127000             SET SU034-INVALID-SQL TO TRUE                        12700076
127100             PERFORM 9998-RETURN                                  12710076
127200     END-EVALUATE.                                                12720076
127300                                                                  12730076
127400 2000-UPDATE-THIS-CARTON.                                         12740076
127500     MOVE PV-AUDIT-SHPD-QTY TO PV-AFTER-QTY.                      12750076
127600     PERFORM 2100-SELECT-UPC.                                     12760076
127700     MOVE SU034-OPER-UNT-ID   TO SUQADJ-OPER-UNT-ID.              12770076
127800     MOVE PV-CARTON-SHPD-QTY  TO SUQADJ-ADJ-BEF-QTY               12780076
127900                                 PV-BEFORE-QTY.                   12790076
128000     MOVE PV-AUDIT-SHPD-QTY   TO SUQADJ-ADJ-AFT-QTY               12800076
128100                                 PV-AFTER-QTY.                    12810076
128200     IF PS-ONLY-APPLY-TO-BAD-PACKS                                12820076
128300         CONTINUE                                                 12830076
128400     ELSE                                                         12840076
128500         IF PS-MULTIPLE-RECORDS                                   12850076
128600             PERFORM 2200-PROCESS-CURSOR                          12860076
128700         ELSE                                                     12870076
128800             MOVE SUT00028-UPC-NBR    TO DK-UPC-NBR               12880076
128900             PERFORM 2500-UPDATE-OTBND-UPC                        12890076
129000         END-IF                                                   12900076
129100     END-IF.                                                      12910076
129200     COMPUTE PV-ADJUST-QTY =                                      12920076
129300         PV-AUDIT-SHPD-QTY - PV-CARTON-SHPD-QTY.                  12930076
129400     MOVE SU034-USER-ID       TO SUQADJ-ADJ-USR-ID.               12940076
129500     MOVE SU034-ADJ-AUDIT-CNTL-NBR                                12950076
129600                              TO SUQADJ-AUD-CNTL-NBR.             12960076
129700     PERFORM 2300-UPDATE-CARTON.                                  12970076
129800                                                                  12980076
129900 2100-SELECT-UPC.                                                 12990076
130000     EXEC SQL                                                     13000076
130100         SELECT   B.TRN_NBR                                       13010076
130200             ,    B.RCVR_SEQ_NBR                                  13020076
130300             ,    B.TRN_LNE_NBR                                   13030076
130400             ,    B.TRN_TYP_CDE                                   13040076
130500             ,    B.UPC_NBR                                       13050076
130600             ,    B.SHPD_UNT_QTY                                  13060076
130700             ,    A.DEST_LOC_NBR                                  13070076
130800             ,    A.SHIPT_UNT_ID                                  13080076
130900         INTO    :SUT00028-TRN-NBR                                13090076
131000             ,   :SUT00028-RCVR-SEQ-NBR                           13100076
131100             ,   :SUT00028-TRN-LNE-NBR                            13110076
131200             ,   :SUT00028-TRN-TYP-CDE                            13120076
131300             ,   :SUT00028-UPC-NBR                                13130076
131400             ,   :SUT00028-SHPD-UNT-QTY                           13140076
131500             ,   :SUT00024-DEST-LOC-NBR                           13150076
131600             ,   :SUT00024-SHIPT-UNT-ID                           13160076
131700         FROM SUT_OTBND_CART A                                    13170076
131800            , SUT_OTBND_UPC B                                     13180076
131900            , XLT_UPC C                                           13190076
132000         WHERE A.ORIG_CART_ID   = :DK-SHIPT-UNT-ID                13200076
132100           AND A.ACTV_IND       = 'Y'                             13210076
132200           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  13220076
132300           AND B.UPC_NBR        = C.UPC_NBR                       13230076
132400           AND C.INTR_UPC_ID    = :DK-INTR-UPC                    13240076
132500     END-EXEC.                                                    13250076
132600                                                                  13260076
132700     EVALUATE TRUE                                                13270076
132800         WHEN SQLCODE = ZERO                                      13280076
132900             SET PS-NO-MULTIPLE-RECORDS TO TRUE                   13290076
133000                                                                  13300076
133100         WHEN SQLCODE = -811                                      13310076
133200             SET PS-MULTIPLE-RECORDS TO TRUE                      13320076
133300                                                                  13330076
133400         WHEN SQLWARN0 NOT = SPACES                               13340076
133500         WHEN SQLCODE < ZERO                                      13350076
133600         WHEN SQLCODE > ZERO                                      13360076
133700             SET PS-ERROR                                         13370076
133800                 SU034-INVALID-SQL    TO TRUE                     13380076
133900             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     13390076
134000             MOVE DK-INTR-UPC         TO PV-INTR-UPC              13400076
134100             MOVE PV-INTR-UPC-11      TO PV-DISPLAY-INTR-UPC      13410076
134200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       13420076
134300             STRING   ' SUKUT701-2100-'                           13430076
134400                      ' CALLED BY-'                               13440076
134500                      SU034-PROGRAM-NAME                          13450076
134600                      '  SQLCODE='                                13460076
134700                      PV-DISPLAY-SQLCODE                          13470076
134800                      ' '                                         13480076
134900                      PV-DISP-SHIPT-UNT-ID                        13490076
135000                      '  '                                        13500076
135100                      PV-DISPLAY-INTR-UPC                         13510076
135200                      DELIMITED BY SIZE                           13520076
135300                                      INTO SU034-CRA-RET-MSG      13530076
135400             PERFORM 9999-WRITE-TO-CSSL                           13540076
135500             MOVE '2100-'                TO SU034-CRA-REQ-ID      13550076
135600             SET SU034-INVALID-SQL TO TRUE                        13560076
135700             PERFORM 9998-RETURN                                  13570076
135800     END-EVALUATE.                                                13580076
135900                                                                  13590076
136000 2150-SELECT-UPC.                                                 13600076
136100     EXEC SQL                                                     13610076
136200         SELECT   B.TRN_NBR                                       13620076
136300             ,    B.RCVR_SEQ_NBR                                  13630076
136400             ,    B.TRN_LNE_NBR                                   13640076
136500             ,    B.TRN_TYP_CDE                                   13650076
136600             ,    B.UPC_NBR                                       13660076
136700             ,    B.SHPD_UNT_QTY                                  13670076
136800             ,    A.DEST_LOC_NBR                                  13680076
136900             ,    A.SHIPT_UNT_ID                                  13690076
137000         INTO    :SUT00028-TRN-NBR                                13700076
137100             ,   :SUT00028-RCVR-SEQ-NBR                           13710076
137200             ,   :SUT00028-TRN-LNE-NBR                            13720076
137300             ,   :SUT00028-TRN-TYP-CDE                            13730076
137400             ,   :SUT00028-UPC-NBR                                13740076
137500             ,   :SUT00028-SHPD-UNT-QTY                           13750076
137600             ,   :SUT00024-DEST-LOC-NBR                           13760076
137700             ,   :SUT00024-SHIPT-UNT-ID                           13770076
137800         FROM SUT_OTBND_CART A                                    13780076
137900            , SUT_OTBND_UPC B                                     13790076
138000         WHERE A.ORIG_CART_ID   = :DK-SHIPT-UNT-ID                13800076
138100           AND A.ACTV_IND       = 'Y'                             13810076
138200           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  13820076
138300           AND B.UPC_NBR        = :DK-UPC-NBR                     13830076
138400     END-EXEC.                                                    13840076
138500                                                                  13850076
138600     EVALUATE TRUE                                                13860076
138700         WHEN SQLCODE = ZERO                                      13870076
138800             SET PS-NO-MULTIPLE-RECORDS TO TRUE                   13880076
138900                                                                  13890076
139000         WHEN SQLCODE = -811                                      13900076
139100             SET PS-MULTIPLE-RECORDS TO TRUE                      13910076
139200                                                                  13920076
139300         WHEN SQLWARN0 NOT = SPACES                               13930076
139400         WHEN SQLCODE < ZERO                                      13940076
139500         WHEN SQLCODE > ZERO                                      13950076
139600             SET PS-ERROR                                         13960076
139700                 SU034-INVALID-SQL    TO TRUE                     13970076
139800             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     13980076
139900             MOVE DK-UPC-NBR          TO PV-DISPLAY-UPC-NBR       13990076
140000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       14000076
140100             STRING   ' SUKUT701-2150-'                           14010076
140200                      ' CALLED BY-'                               14020076
140300                      SU034-PROGRAM-NAME                          14030076
140400                      '  SQLCODE='                                14040076
140500                      PV-DISPLAY-SQLCODE                          14050076
140600                      ' '                                         14060076
140700                      PV-DISP-SHIPT-UNT-ID                        14070076
140800                      '  '                                        14080076
140900                      PV-DISPLAY-UPC-NBR                          14090076
141000                      DELIMITED BY SIZE                           14100076
141100                                      INTO SU034-CRA-RET-MSG      14110076
141200             PERFORM 9999-WRITE-TO-CSSL                           14120076
141300             MOVE '2150-'                TO SU034-CRA-REQ-ID      14130076
141400             SET SU034-INVALID-SQL TO TRUE                        14140076
141500             PERFORM 9998-RETURN                                  14150076
141600     END-EVALUATE.                                                14160076
141700 2200-PROCESS-CURSOR.                                             14170076
141800                                                                  14180076
141900     MOVE PV-AUDIT-SHPD-QTY   TO PV-WORK-ITEM-COUNT.              14190076
142000     PERFORM 2230-OPEN-CARTON-UPC-CURSOR.                         14200076
142100     PERFORM 2260-FETCH-CARTON-UPC-CURSOR                         14210076
142200           UNTIL PS-ADJUSTMENT-USED-UP                            14220076
142300              OR PS-EOC-CARTON-UPC-CURSOR.                        14230076
142400     PERFORM 2290-CLOSE-CARTON-UPC-CURSOR.                        14240076
142500                                                                  14250076
142600                                                                  14260076
142700 2230-OPEN-CARTON-UPC-CURSOR.                                     14270076
142800                                                                  14280076
142900     EXEC SQL                                                     14290076
143000         OPEN CARTON_UPC_CURSOR                                   14300076
143100     END-EXEC.                                                    14310076
143200                                                                  14320076
143300     EVALUATE TRUE                                                14330076
143400         WHEN SQLCODE = ZERO                                      14340076
143500             SET PS-NOT-EOC-CARTON-UPC-CURSOR                     14350076
143600                 PS-ADJUSTMENT-NOT-USED-UP                        14360076
143700                                              TO TRUE             14370076
143800                                                                  14380076
143900         WHEN SQLWARN0 NOT = SPACES                               14390076
144000         WHEN SQLCODE < ZERO                                      14400076
144100         WHEN SQLCODE > ZERO                                      14410076
144200             SET PS-ERROR                                         14420076
144300                 SU034-INVALID-SQL    TO TRUE                     14430076
144400             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     14440076
144500             MOVE PV-CARTON-INTR-UPC  TO PV-DISPLAY-INTR-UPC      14450076
144600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       14460076
144700             STRING   ' SUKUT701-2230-'                           14470076
144800                      ' CALLED BY-'                               14480076
144900                      SU034-PROGRAM-NAME                          14490076
145000                      '  SQLCODE='                                14500076
145100                      PV-DISPLAY-SQLCODE                          14510076
145200                      ' '                                         14520076
145300                      PV-DISP-SHIPT-UNT-ID                        14530076
145400                      '  '                                        14540076
145500                      PV-DISPLAY-INTR-UPC                         14550076
145600                      DELIMITED BY SIZE                           14560076
145700                                      INTO SU034-CRA-RET-MSG      14570076
145800             PERFORM 9999-WRITE-TO-CSSL                           14580076
145900             MOVE '2230-'                TO SU034-CRA-REQ-ID      14590076
146000             SET SU034-INVALID-SQL TO TRUE                        14600076
146100             PERFORM 9998-RETURN                                  14610076
146200     END-EVALUATE.                                                14620076
146300                                                                  14630076
146400 2260-FETCH-CARTON-UPC-CURSOR.                                    14640076
146500                                                                  14650076
146600     EXEC SQL                                                     14660076
146700         FETCH CARTON_UPC_CURSOR                                  14670076
146800         INTO    :SUT00028-TRN-NBR                                14680076
146900             ,   :SUT00028-RCVR-SEQ-NBR                           14690076
147000             ,   :SUT00028-TRN-LNE-NBR                            14700076
147100             ,   :SUT00028-TRN-TYP-CDE                            14710076
147200             ,   :SUT00028-UPC-NBR                                14720076
147300             ,   :SUT00028-SHPD-UNT-QTY                           14730076
147400     END-EXEC.                                                    14740076
147500                                                                  14750076
147600     EVALUATE TRUE                                                14760076
147700         WHEN SQLCODE = ZERO                                      14770076
147800             MOVE SUT00028-UPC-NBR    TO DK-UPC-NBR               14780076
147900             IF SUT00028-SHPD-UNT-QTY < PV-WORK-ITEM-COUNT        14790076
148000                 MOVE 0               TO PV-AFTER-QTY             14800076
148100                 COMPUTE PV-WORK-ITEM-COUNT =                     14810076
148200                    PV-WORK-ITEM-COUNT - SUT00028-SHPD-UNT-QTY    14820076
148300                 IF PV-WORK-ITEM-COUNT = 0                        14830076
148400                     SET PS-ADJUSTMENT-USED-UP TO TRUE            14840076
148500                 END-IF                                           14850076
148600             ELSE                                                 14860076
148700                 COMPUTE PV-WORK-ITEM-COUNT =                     14870076
148800                    SUT00028-SHPD-UNT-QTY - PV-WORK-ITEM-COUNT    14880076
148900                 MOVE PV-WORK-ITEM-COUNT TO PV-AFTER-QTY          14890076
149000                 SET PS-ADJUSTMENT-USED-UP TO TRUE                14900076
149100             END-IF                                               14910076
149200             MOVE SUT00028-SHPD-UNT-QTY TO PV-BEFORE-QTY          14920076
149300             PERFORM 2500-UPDATE-OTBND-UPC                        14930076
149400                                                                  14940076
149500         WHEN SQLCODE = +100                                      14950076
149600             SET PS-EOC-CARTON-UPC-CURSOR   TO TRUE               14960076
149700                                                                  14970076
149800         WHEN SQLWARN0 NOT = SPACES                               14980076
149900         WHEN SQLCODE < ZERO                                      14990076
150000         WHEN SQLCODE > ZERO                                      15000076
150100             SET PS-ERROR                                         15010076
150200                 SU034-INVALID-SQL    TO TRUE                     15020076
150300             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     15030076
150400             MOVE PV-CARTON-INTR-UPC  TO PV-DISPLAY-INTR-UPC      15040076
150500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       15050076
150600             STRING   ' SUKUT701-2260-'                           15060076
150700                      ' CALLED BY-'                               15070076
150800                      SU034-PROGRAM-NAME                          15080076
150900                      '  SQLCODE='                                15090076
151000                      PV-DISPLAY-SQLCODE                          15100076
151100                      ' '                                         15110076
151200                      PV-DISP-SHIPT-UNT-ID                        15120076
151300                      '  '                                        15130076
151400                      PV-DISPLAY-INTR-UPC                         15140076
151500                      DELIMITED BY SIZE                           15150076
151600                                      INTO SU034-CRA-RET-MSG      15160076
151700             PERFORM 9999-WRITE-TO-CSSL                           15170076
151800             MOVE '2260-'                TO SU034-CRA-REQ-ID      15180076
151900             SET SU034-INVALID-SQL TO TRUE                        15190076
152000             PERFORM 9998-RETURN                                  15200076
152100     END-EVALUATE.                                                15210076
152200                                                                  15220076
152300 2290-CLOSE-CARTON-UPC-CURSOR.                                    15230076
152400                                                                  15240076
152500     EXEC SQL                                                     15250076
152600         CLOSE CARTON_UPC_CURSOR                                  15260076
152700     END-EXEC.                                                    15270076
152800                                                                  15280076
152900     EVALUATE TRUE                                                15290076
153000         WHEN SQLCODE = ZERO                                      15300076
153100             CONTINUE                                             15310076
153200                                                                  15320076
153300         WHEN SQLWARN0 NOT = SPACES                               15330076
153400         WHEN SQLCODE < ZERO                                      15340076
153500         WHEN SQLCODE > ZERO                                      15350076
153600             SET PS-ERROR                                         15360076
153700                 SU034-INVALID-SQL    TO TRUE                     15370076
153800             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     15380076
153900             MOVE PV-CARTON-INTR-UPC  TO PV-DISPLAY-INTR-UPC      15390076
154000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       15400076
154100             STRING   ' SUKUT701-2290-'                           15410076
154200                      ' CALLED BY-'                               15420076
154300                      SU034-PROGRAM-NAME                          15430076
154400                      '  SQLCODE='                                15440076
154500                      PV-DISPLAY-SQLCODE                          15450076
154600                      ' '                                         15460076
154700                      PV-DISP-SHIPT-UNT-ID                        15470076
154800                      '  '                                        15480076
154900                      PV-DISPLAY-INTR-UPC                         15490076
155000                      DELIMITED BY SIZE                           15500076
155100                                      INTO SU034-CRA-RET-MSG      15510076
155200             PERFORM 9999-WRITE-TO-CSSL                           15520076
155300             MOVE '2290-'                TO SU034-CRA-REQ-ID      15530076
155400             SET SU034-INVALID-SQL TO TRUE                        15540076
155500             PERFORM 9998-RETURN                                  15550076
155600     END-EVALUATE.                                                15560076
155700                                                                  15570076
155800 2300-UPDATE-CARTON.                                              15580076
155900     PERFORM 2700-INSERT-TSUQADJ.                                 15590076
156000     MOVE SU034-ADJ-AUDIT-CNTL-NBR                                15600076
156100                              TO SUQADJ-AUD-CNTL-NBR.             15610076
156200     MOVE PV-CARTON-INTR-UPC  TO DK-INTR-UPC.                     15620076
156300     IF PV-CARTON-REC-TYPE = 'B'                                  15630076
156400         PERFORM 3800-GET-ITM-NBR                                 15640076
156500     ELSE                                                         15650076
156600         PERFORM 3850-GET-ITM-NBR                                 15660076
156700         IF XL001-UPC-SQLCODE = -811                              15670076
156800             PERFORM 2350-GET-CORRECT-UPC                         15680076
156900         ELSE                                                     15690076
157000             MOVE XL001-UPC-NBR    TO DK-UPC-NBR                  15700076
157100         END-IF                                                   15710076
157200     END-IF.                                                      15720076
157300     IF PS-ITM-NOT-FOUND                                          15730076
157400         MOVE ZERO            TO DK-TRN-LNE-NBR                   15740076
157500     ELSE                                                         15750076
157600         IF PV-SAVE-ORD-LNE-NBR > 0 AND                           15760076
157700            PV-SAVE-ORD-LNE-NBR NOT = 999999999                   15770076
157800             MOVE PV-SAVE-ORD-LNE-NBR  TO DK-TRN-LNE-NBR          15780076
157900             PERFORM 3950-SELECT-TPURITM                          15790076
158000         ELSE                                                     15800076
158100             PERFORM 3900-GET-LINE-NBR                            15810076
158200         END-IF                                                   15820076
158300     END-IF.                                                      15830076
158400     IF SUT00028-RCVR-SEQ-NBR = 0                                 15840076
158500         SET PS-RECEIVER-FOUND  TO TRUE                           15850076
158600         PERFORM 4100-SELECT-REC-SEQ                              15860076
158700     ELSE                                                         15870076
158800         MOVE SUT00028-RCVR-SEQ-NBR TO PV-RCVR-SEQ-NBR            15880076
158900     END-IF.                                                      15890076
159000                                                                  15900076
159100     PERFORM 3400-COUNT-EXPECTED-ITEMS.                           15910076
159200     IF PV-SUM-SHPD-QTY > PV-AFTER-QTY                            15920076
159300         COMPUTE PV-DIFFERENCE =                                  15930076
159400           (PV-SUM-SHPD-QTY - PV-AFTER-QTY)                       15940076
159500         MOVE 0          TO PV-UNT-RTL-AMT                        15950076
159600     ELSE                                                         15960076
159700         COMPUTE PV-DIFFERENCE =                                  15970076
159800           (PV-AFTER-QTY - PV-SUM-SHPD-QTY)                       15980076
159900         COMPUTE PV-UNT-RTL-AMT =                                 15990076
160000          XL001-UNT-RTL-AMT * PV-DIFFERENCE                       16000076
160100     END-IF                                                       16010076
160200     IF PV-DIFFERENCE > KRPRPM-FUNC-QTY                           16020076
160300         SET PS-TOO-MANY-UNEXPCTD TO TRUE                         16030076
160400     ELSE                                                         16040076
160500         SET PS-NOT-TOO-MANY-UNEXPCTD TO TRUE                     16050076
160600     END-IF.                                                      16060076
160700                                                                  16070076
160800     PERFORM 2320-INTERFACING-TO-RDS.                             16080085
161200                                                                  16120085
161300     IF PS-NOT-UNIT-ADJUST-DEPT-DC                                16130076
161400         SET PS-LINKED-TO-3000   TO TRUE                          16140076
161500     ELSE                                                         16150076
161600         SET PS-NOT-LINKED-TO-3000 TO TRUE                        16160076
161700         IF RECEIV-STATUS-CDE EQUAL 'DE'                          16170076
161800             PERFORM 4300-CREATE-TROUBLE                          16180076
161900             MOVE 14 TO SUT00030-ADJ-ERR-CDE                      16190076
162000             SET PS-FAILED-ADJ        TO TRUE                     16200076
162100             PERFORM 4000-INSERT-FINCL-ADJ                        16210076
162200         ELSE                                                     16220076
162300             IF PS-ITM-NOT-FOUND                                  16230076
162400                 IF RECEIV-STATUS-CDE NOT EQUAL 'VE'              16240076
162500                     PERFORM 4300-CREATE-TROUBLE                  16250076
162600                 END-IF                                           16260076
162700                 MOVE 6  TO SUT00030-ADJ-ERR-CDE                  16270076
162800                 SET PS-FAILED-ADJ        TO TRUE                 16280076
162900                 PERFORM 4000-INSERT-FINCL-ADJ                    16290076
163000             ELSE                                                 16300076
163100                 IF PS-LINE-NOT-ON-PO                             16310076
163200                     IF PS-TOO-MANY-UNEXPCTD                      16320076
163300                         IF RECEIV-STATUS-CDE NOT EQUAL 'VE'      16330076
163400                             PERFORM 4300-CREATE-TROUBLE          16340076
163500                         END-IF                                   16350076
163600                         MOVE 4  TO SUT00030-ADJ-ERR-CDE          16360076
163700                         SET PS-FAILED-ADJ        TO TRUE         16370076
163800                         PERFORM 4000-INSERT-FINCL-ADJ            16380076
163900                     ELSE                                         16390076
164000                         IF PV-UNT-RTL-AMT > PV-MAX-RETAIL        16400076
164100                             IF RECEIV-STATUS-CDE NOT EQUAL 'VE'  16410076
164200                                 PERFORM 4300-CREATE-TROUBLE      16420076
164300                             END-IF                               16430076
164400                             MOVE 5  TO SUT00030-ADJ-ERR-CDE      16440076
164500                             SET PS-FAILED-ADJ        TO TRUE     16450076
164600                             PERFORM 4000-INSERT-FINCL-ADJ        16460076
164700                         ELSE                                     16470076
164800                             IF RECEIV-STATUS-CDE NOT EQUAL 'VE'  16480076
164900                                 PERFORM 4300-CREATE-TROUBLE      16490076
165000                             END-IF                               16500076
165100                             MOVE 7  TO SUT00030-ADJ-ERR-CDE      16510076
165200                             SET PS-FAILED-ADJ        TO TRUE     16520076
165300                             PERFORM 4000-INSERT-FINCL-ADJ        16530076
165400                         END-IF                                   16540076
165500                     END-IF                                       16550076
165600                 ELSE                                             16560076
165700                     PERFORM 3000-LINK-UNIT-ADJ-PROGRAM           16570076
165800                     SET PS-LINKED-TO-3000 TO TRUE                16580076
165900                 END-IF                                           16590076
166000             END-IF                                               16600076
166100         END-IF                                                   16610076
166200     END-IF.                                                      16620076
166300     IF PS-NOT-LINKED-TO-3000                                     16630076
166400         IF PV-SAVE-ORD-LNE-NBR = 999999999                       16640076
166500             CONTINUE                                             16650076
166600         ELSE                                                     16660076
166700             SET PS-DONT-APPLY-CRT-UPDATES   TO TRUE              16670076
166800             SET PS-BACK-OUT-UPDATES         TO TRUE              16680076
166900         END-IF                                                   16690076
167000         PERFORM 4700-BACK-OUT-UPDATES                            16700076
167100     END-IF.                                                      16710076
167200                                                                  16720076
167300 2320-INTERFACING-TO-RDS.                                         16730085
167400                                                                  16740085
167500     MOVE SUT00024-DEST-LOC-NBR     TO DK-CS-ECOMM-STORE-LOC.     16750085
167600                                                                  16760085
167700     EXEC SQL                                                     16770085
167800          SELECT FUNC_END_TMST                                    16780085
167900          INTO  :KRPRPM-FUNC-END-TMST                             16790085
168000          FROM   TKRPRPM                                          16800085
168100          WHERE  SYS_PRC_FUNC_CDE  = 'RDMRCV'                     16810085
168200            AND  LOC_ID            = :DK-CS-ECOMM-STORE-LOC       16820085
168300            AND  INTFC_SYS_CDE     = 'RDM'                        16830085
168400            AND  FUNC_PRC_STAT_CDE = 'AC'                         16840085
168500            AND  FUNC_TXT          = 'Y'                          16850085
168600     END-EXEC.                                                    16860085
168700                                                                  16870085
168800                                                                  16880085
168900     EVALUATE TRUE                                                16890085
169000         WHEN SQLCODE = ZERO                                      16900085
169100             SET PS-INTERFAC-TO-RDS-LOC-FND TO TRUE               16910085
169200         WHEN SQLCODE = +100                                      16920085
169300             SET PS-INTERFAC-TO-RDS-LOC-NOT-FND TO TRUE           16930085
169400         WHEN SQLWARN0 NOT = SPACES                               16940085
169500         WHEN SQLCODE < ZERO                                      16950085
169600         WHEN SQLCODE > ZERO                                      16960085
169700                                                                  16970085
169800             SET PS-ERROR                                         16980085
169900                 SU034-INVALID-SQL    TO TRUE                     16990085
170000             MOVE DK-CS-ECOMM-STORE-LOC                           17000085
170100                                      TO PV-DISP-STR-NBR          17010085
170200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       17020085
170300             STRING   ' SUKUT701-2320-'                           17030085
170400                      ' CALLED BY-'                               17040085
170500                      SU034-PROGRAM-NAME                          17050085
170600                      '  SQLCODE='                                17060085
170700                      PV-DISPLAY-SQLCODE                          17070085
170800                      ' STORE = '                                 17080085
170900                      PV-DISP-STR-NBR                             17090085
171000                      DELIMITED BY SIZE                           17100085
171100                                      INTO SU034-CRA-RET-MSG      17110085
171200             PERFORM 9999-WRITE-TO-CSSL                           17120085
171300             MOVE '2320-'                TO SU034-CRA-REQ-ID      17130085
171400             SET SU034-INVALID-SQL TO TRUE                        17140085
171500             PERFORM 9998-RETURN                                  17150085
171600     END-EVALUATE.                                                17160085
171700                                                                  17170085
171710 2321-SELECT-DEST-STR.                                                  85
171720                                                                  16740085
171740                                                                  16760085
171750     EXEC SQL                                                     16770085
171760          SELECT DEST_LOC_NBR                                     16780085
171770          INTO  :SUT00024-DEST-LOC-NBR                            16790085
171780          FROM   SUT_OTBND_CART                                   16800085
171790          WHERE  ORIG_CART_ID      = :DK-SHIPT-UNT-ID             16810085
171795     END-EXEC.                                                    16860085
171796                                                                  16870085
171797                                                                  16880085
171798     EVALUATE TRUE                                                16890085
171799         WHEN SQLCODE = ZERO                                      16900085
171800             CONTINUE                                                   85
171803         WHEN SQLWARN0 NOT = SPACES                               16940085
171804         WHEN SQLCODE < ZERO                                      16950085
171805         WHEN SQLCODE > ZERO                                      16960085
171806                                                                  16970085
171807             SET PS-ERROR                                         16980085
171808                 SU034-INVALID-SQL    TO TRUE                     16990085
171809             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     17000085
171811             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       17020085
171812             STRING   ' SUKUT701-2321-'                           17030085
171813                      ' CALLED BY-'                               17040085
171814                      SU034-PROGRAM-NAME                          17050085
171815                      '  SQLCODE='                                17060085
171816                      PV-DISPLAY-SQLCODE                          17070085
171817                      ' CART  = '                                 17080085
171818                      PV-DISP-SHIPT-UNT-ID                        17090085
171819                      DELIMITED BY SIZE                           17100085
171820                                      INTO SU034-CRA-RET-MSG      17110085
171821             PERFORM 9999-WRITE-TO-CSSL                           17120085
171822             MOVE '2321-'                TO SU034-CRA-REQ-ID      17130085
171823             SET SU034-INVALID-SQL TO TRUE                        17140085
171824             PERFORM 9998-RETURN                                  17150085
171825     END-EVALUATE.                                                17160085
171826                                                                  17170085
176200 2341-GET-SKU.                                                    17620076
176300     EXEC SQL                                                     17630076
176400          SELECT SKU_NBR                                          17640076
176500            INTO :PV-SAVE-SKU                                     17650076
176600            FROM XLT_SKU                                          17660076
176700            WHERE INTR_UPC_ID  = :PV-AUDIT-INTR-UPC               17670076
176900     END-EXEC.                                                    17690076
177000                                                                  17700076
177100     EVALUATE TRUE                                                17710076
177200        WHEN SQLCODE = ZERO                                       17720076
177300        WHEN SQLCODE = +100                                       17730076
177400           CONTINUE                                               17740076
177500        WHEN OTHER                                                17750076
177600             SET PS-ERROR                                         17760076
177700                 SU034-INVALID-SQL    TO TRUE                     17770076
178000             MOVE PV-AUDIT-INTR-UPC   TO PV-DISPLAY-UPC-NBR       17800076
178100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       17810076
178200             STRING   ' SUKUT701-2341-'                           17820076
178300                      ' CALLED BY-'                               17830076
178400                      SU034-PROGRAM-NAME                          17840076
178500                      '  SQLCODE='                                17850076
178600                      PV-DISPLAY-SQLCODE                          17860076
178700                      ' '                                         17870076
178800                      PV-DISP-UPC-NBR                             17880076
178900                      ' '                                         17890076
179300                      DELIMITED BY SIZE                           17930076
179400                                      INTO SU034-CRA-RET-MSG      17940076
179500             PERFORM 9999-WRITE-TO-CSSL                           17950076
179600             MOVE '2341-'                TO SU034-CRA-REQ-ID      17960076
179700             SET SU034-INVALID-SQL TO TRUE                        17970076
179800             PERFORM 9998-RETURN                                  17980076
179900     END-EVALUATE.                                                17990076
180000                                                                  18000076
180001                                                                  17410085
180002 2350-GET-CORRECT-UPC.                                            17420085
180003     MOVE XL001-UPC-NBR       TO DK-UPC-NBR.                      17430076
180004     PERFORM 2370-SELECT-BY-UPC.                                  17440076
180005     IF SQLCODE = ZERO                                            17450076
180006         CONTINUE                                                 17460076
180007     ELSE                                                         17470076
180008         PERFORM 2390-SELECT-BY-INTR-UPC                          17480076
180009         IF SQLCODE = ZERO                                        17490076
180010             CONTINUE                                             17500076
180011         ELSE                                                     17510076
180012             MOVE XL001-UPC-NBR       TO DK-UPC-NBR               17520076
180013             PERFORM 2360-SELECT-BY-UPC                           17530076
180014             IF SQLCODE = ZERO                                    17540076
180015                 CONTINUE                                         17550076
180016             ELSE                                                 17560076
180017                 PERFORM 2380-SELECT-BY-INTR-UPC                  17570076
180018             END-IF                                               17580076
180019         END-IF                                                   17590076
180020     END-IF.                                                      17600076
180021                                                                  17610076
180022 2360-SELECT-BY-UPC.                                              17620076
180023     EXEC SQL                                                     17630076
180024          SELECT DISTINCT UPC_NBR                                 17640076
180025            INTO :SUT00028-UPC-NBR                                17650076
180026            FROM SUT_OTBND_UPC                                    17660076
180027            WHERE SHIPT_UNT_ID = :DK-OTBND-SHIPT-UNT-ID           17670076
180028              AND UPC_NBR      = :DK-UPC-NBR                      17680076
180029     END-EXEC.                                                    17690076
180030                                                                  17700076
180031     EVALUATE TRUE                                                17710076
180032        WHEN SQLCODE = ZERO                                       17720076
180033        WHEN SQLCODE = +100                                       17730076
180034           CONTINUE                                               17740076
180035        WHEN OTHER                                                17750076
180036             SET PS-ERROR                                         17760076
180037                 SU034-INVALID-SQL    TO TRUE                     17770076
180038             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     17780076
180039             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR17790076
180040             MOVE DK-UPC-NBR          TO PV-DISPLAY-UPC-NBR       17800076
180041             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       17810076
180042             STRING   ' SUKUT701-2360-'                           17820076
180043                      ' CALLED BY-'                               17830076
180044                      SU034-PROGRAM-NAME                          17840076
180045                      '  SQLCODE='                                17850076
180046                      PV-DISPLAY-SQLCODE                          17860076
180047                      ' '                                         17870076
180048                      PV-DISP-SHIPT-UNT-ID                        17880076
180049                      ' '                                         17890076
180050                      PV-DISPLAY-AUDIT-CNTL-NBR                   17900076
180051                      ' '                                         17910076
180052                      PV-DISPLAY-UPC-NBR                          17920076
180053                      DELIMITED BY SIZE                           17930076
180054                                      INTO SU034-CRA-RET-MSG      17940076
180055             PERFORM 9999-WRITE-TO-CSSL                           17950076
180056             MOVE '2360-'                TO SU034-CRA-REQ-ID      17960076
180057             SET SU034-INVALID-SQL TO TRUE                        17970076
180058             PERFORM 9998-RETURN                                  17980076
180059     END-EVALUATE.                                                17990076
180060                                                                  18000076
180100                                                                  18010076
180200 2370-SELECT-BY-UPC.                                              18020076
180300     EXEC SQL                                                     18030076
180400          SELECT DISTINCT UPC_NBR                                 18040076
180500            INTO :SUAUPC-UPC-NBR                                  18050076
180600            FROM TSUAUPC                                          18060076
180700            WHERE AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR               18070076
180800              AND SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 18080076
180900              AND UPC_NBR      = :DK-UPC-NBR                      18090076
181000     END-EXEC.                                                    18100076
181100                                                                  18110076
181200     EVALUATE TRUE                                                18120076
181300        WHEN SQLCODE = ZERO                                       18130076
181400        WHEN SQLCODE = +100                                       18140076
181500           CONTINUE                                               18150076
181600        WHEN OTHER                                                18160076
181700             SET PS-ERROR                                         18170076
181800                 SU034-INVALID-SQL    TO TRUE                     18180076
181900             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     18190076
182000             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR18200076
182100             MOVE DK-UPC-NBR          TO PV-DISPLAY-UPC-NBR       18210076
182200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       18220076
182300             STRING   ' SUKUT701-2370-'                           18230076
182400                      ' CALLED BY-'                               18240076
182500                      SU034-PROGRAM-NAME                          18250076
182600                      '  SQLCODE='                                18260076
182700                      PV-DISPLAY-SQLCODE                          18270076
182800                      ' '                                         18280076
182900                      PV-DISP-SHIPT-UNT-ID                        18290076
183000                      ' '                                         18300076
183100                      PV-DISPLAY-AUDIT-CNTL-NBR                   18310076
183200                      ' '                                         18320076
183300                      PV-DISPLAY-UPC-NBR                          18330076
183400                      DELIMITED BY SIZE                           18340076
183500                                      INTO SU034-CRA-RET-MSG      18350076
183600             PERFORM 9999-WRITE-TO-CSSL                           18360076
183700             MOVE '2370-'                TO SU034-CRA-REQ-ID      18370076
183800             SET SU034-INVALID-SQL TO TRUE                        18380076
183900             PERFORM 9998-RETURN                                  18390076
184000     END-EVALUATE.                                                18400076
184100                                                                  18410076
184200 2380-SELECT-BY-INTR-UPC.                                         18420076
184300     EXEC SQL                                                     18430076
184400          SELECT DISTINCT A.UPC_NBR                               18440076
184500            INTO :SUT00028-UPC-NBR                                18450076
184600            FROM SUT_OTBND_UPC A                                  18460076
184700               , XLT_UPC B                                        18470076
184800            WHERE A.SHIPT_UNT_ID = :DK-OTBND-SHIPT-UNT-ID         18480076
184900              AND A.UPC_NBR      = B.UPC_NBR                      18490076
185000              AND B.INTR_UPC_ID  = :DK-INTR-UPC                   18500076
185100     END-EXEC.                                                    18510076
185200                                                                  18520076
185300     EVALUATE TRUE                                                18530076
185400        WHEN SQLCODE = ZERO                                       18540076
185500           MOVE SUT00028-UPC-NBR  TO DK-UPC-NBR                   18550076
185600        WHEN SQLCODE = +100                                       18560076
185700           IF PS-DUPLICATE-UPC-FOUND AND                          18570076
185800              PV-UPC-NBR > 0                                      18580076
185900               MOVE PV-UPC-NBR    TO DK-UPC-NBR                   18590076
186000           ELSE                                                   18600076
186100             SET PS-ERROR                                         18610076
186200                 SU034-INVALID-SQL    TO TRUE                     18620076
186300             MOVE DK-OTBND-SHIPT-UNT-ID                           18630076
186400                                      TO PV-DISP-SHIPT-UNT-ID     18640076
186500             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR18650076
186600             MOVE DK-INTR-UPC         TO PV-INTR-UPC              18660076
186700             MOVE PV-INTR-UPC-11      TO PV-DISPLAY-INTR-UPC      18670076
186800             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       18680076
186900             STRING   ' SUKUT701-2380-'                           18690076
187000                      ' CALLED BY-'                               18700076
187100                      SU034-PROGRAM-NAME                          18710076
187200                      '  SQLCODE='                                18720076
187300                      PV-DISPLAY-SQLCODE                          18730076
187400                      ' '                                         18740076
187500                      PV-DISP-SHIPT-UNT-ID                        18750076
187600                      ' '                                         18760076
187700                      PV-DISPLAY-AUDIT-CNTL-NBR                   18770076
187800                      ' '                                         18780076
187900                      PV-DISPLAY-INTR-UPC                         18790076
188000                      DELIMITED BY SIZE                           18800076
188100                                      INTO SU034-CRA-RET-MSG      18810076
188200             PERFORM 9999-WRITE-TO-CSSL                           18820076
188300             MOVE '2380-'                TO SU034-CRA-REQ-ID      18830076
188400             SET SU034-INVALID-SQL TO TRUE                        18840076
188500             PERFORM 9998-RETURN                                  18850076
188600           END-IF                                                 18860076
188700        WHEN OTHER                                                18870076
188800             SET PS-ERROR                                         18880076
188900                 SU034-INVALID-SQL    TO TRUE                     18890076
189000             MOVE DK-OTBND-SHIPT-UNT-ID                           18900076
189100                                      TO PV-DISP-SHIPT-UNT-ID     18910076
189200             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR18920076
189300             MOVE DK-INTR-UPC         TO PV-INTR-UPC              18930076
189400             MOVE PV-INTR-UPC-11      TO PV-DISPLAY-INTR-UPC      18940076
189500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       18950076
189600             STRING   ' SUKUT701-2380-'                           18960076
189700                      ' CALLED BY-'                               18970076
189800                      SU034-PROGRAM-NAME                          18980076
189900                      '  SQLCODE='                                18990076
190000                      PV-DISPLAY-SQLCODE                          19000076
190100                      ' '                                         19010076
190200                      PV-DISP-SHIPT-UNT-ID                        19020076
190300                      ' '                                         19030076
190400                      PV-DISPLAY-AUDIT-CNTL-NBR                   19040076
190500                      ' '                                         19050076
190600                      PV-DISPLAY-INTR-UPC                         19060076
190700                      DELIMITED BY SIZE                           19070076
190800                                      INTO SU034-CRA-RET-MSG      19080076
190900             PERFORM 9999-WRITE-TO-CSSL                           19090076
191000             MOVE '2380-'                TO SU034-CRA-REQ-ID      19100076
191100             SET SU034-INVALID-SQL TO TRUE                        19110076
191200             PERFORM 9998-RETURN                                  19120076
191300     END-EVALUATE.                                                19130076
191400                                                                  19140076
191500                                                                  19150076
191600 2390-SELECT-BY-INTR-UPC.                                         19160076
191700     SET PS-NO-DUPLICATE-UPC-FOUND  TO TRUE.                      19170076
191800                                                                  19180076
191900     EXEC SQL                                                     19190076
192000          SELECT DISTINCT A.UPC_NBR                               19200076
192100            INTO :SUAUPC-UPC-NBR                                  19210076
192200            FROM TSUAUPC A                                        19220076
192300               , XLT_UPC B                                        19230076
192400            WHERE A.AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR             19240076
192500              AND A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID               19250076
192600              AND A.UPC_NBR      = B.UPC_NBR                      19260076
192700              AND B.INTR_UPC_ID  = :DK-INTR-UPC                   19270076
192800     END-EXEC.                                                    19280076
192900                                                                  19290076
193000     EVALUATE TRUE                                                19300076
193100        WHEN SQLCODE = ZERO                                       19310076
193200           MOVE SUAUPC-UPC-NBR    TO DK-UPC-NBR                   19320076
193300        WHEN SQLCODE = +100                                       19330076
193400           CONTINUE                                               19340076
193500        WHEN SQLCODE = -811                                       19350076
193600           SET PS-DUPLICATE-UPC-FOUND   TO TRUE                   19360076
193700           MOVE SUAUPC-UPC-NBR    TO PV-UPC-NBR                   19370076
193800        WHEN OTHER                                                19380076
193900             SET PS-ERROR                                         19390076
194000                 SU034-INVALID-SQL    TO TRUE                     19400076
194100             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     19410076
194200             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR19420076
194300             MOVE DK-INTR-UPC         TO PV-INTR-UPC              19430076
194400             MOVE PV-INTR-UPC-11      TO PV-DISPLAY-INTR-UPC      19440076
194500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       19450076
194600             STRING   ' SUKUT701-2390-'                           19460076
194700                      ' CALLED BY-'                               19470076
194800                      SU034-PROGRAM-NAME                          19480076
194900                      '  SQLCODE='                                19490076
195000                      PV-DISPLAY-SQLCODE                          19500076
195100                      ' '                                         19510076
195200                      PV-DISP-SHIPT-UNT-ID                        19520076
195300                      ' '                                         19530076
195400                      PV-DISPLAY-AUDIT-CNTL-NBR                   19540076
195500                      ' '                                         19550076
195600                      PV-DISPLAY-INTR-UPC                         19560076
195700                      DELIMITED BY SIZE                           19570076
195800                                      INTO SU034-CRA-RET-MSG      19580076
195900             PERFORM 9999-WRITE-TO-CSSL                           19590076
196000             MOVE '2390-'                TO SU034-CRA-REQ-ID      19600076
196100             SET SU034-INVALID-SQL TO TRUE                        19610076
196200             PERFORM 9998-RETURN                                  19620076
196300     END-EVALUATE.                                                19630076
196400                                                                  19640076
196500 2400-ADD-NEW-UPC.                                                19650076
196600                                                                  19660076
196700     MOVE PV-AUDIT-INTR-UPC   TO DK-INTR-UPC.                     19670076
196800     MOVE SU034-OPER-UNT-ID   TO SUQADJ-OPER-UNT-ID.              19680076
196900     MOVE 0                   TO SUQADJ-ADJ-BEF-QTY               19690076
197000                                 PV-BEFORE-QTY.                   19700076
197100     MOVE SU034-USER-ID       TO SUQADJ-ADJ-USR-ID.               19710076
197200     MOVE SU034-ADJ-AUDIT-CNTL-NBR                                19720076
197300                              TO SUQADJ-AUD-CNTL-NBR.             19730076
197400     IF PV-AUDIT-REC-TYPE = 'B'                                   19740076
197500         PERFORM 3800-GET-ITM-NBR                                 19750076
197600     ELSE                                                         19760076
197700         PERFORM 3850-GET-ITM-NBR                                 19770076
197800         IF XL001-UPC-SQLCODE = -811                              19780076
197900             PERFORM 2350-GET-CORRECT-UPC                         19790076
198000         ELSE                                                     19800076
198100             MOVE XL001-UPC-NBR    TO DK-UPC-NBR                  19810076
198200         END-IF                                                   19820076
198300     END-IF.                                                      19830076
198400     PERFORM 3700-SELECT-TSUATRN.                                 19840076
198500     MOVE SUATRN-TRN-NBR      TO DK-PO-NBR.                       19850076
198600     IF PS-ITM-NOT-FOUND                                          19860076
198700         MOVE ZERO            TO DK-TRN-LNE-NBR                   19870076
198800     ELSE                                                         19880076
198900         IF PV-SAVE-ORD-LNE-NBR > 0 AND                           19890076
199000            PV-SAVE-ORD-LNE-NBR NOT = 999999999                   19900076
199100             MOVE PV-SAVE-ORD-LNE-NBR  TO DK-TRN-LNE-NBR          19910076
199200             PERFORM 3950-SELECT-TPURITM                          19920076
199300         ELSE                                                     19930076
199400             PERFORM 3900-GET-LINE-NBR                            19940076
199500         END-IF                                                   19950076
199600     END-IF.                                                      19960076
199700     IF SUATRN-REC-SEQ-NBR = 0                                    19970076
199800         SET PS-RECEIVER-FOUND  TO TRUE                           19980076
199900         PERFORM 4100-SELECT-REC-SEQ                              19990076
200000     ELSE                                                         20000076
200100         MOVE SUATRN-REC-SEQ-NBR    TO PV-RCVR-SEQ-NBR            20010076
200200     END-IF.                                                      20020076
200300     IF PV-AUDIT-REC-TYPE = 'B' AND                               20030076
200400        PS-ITM-NOT-FOUND                                          20040076
200500         CONTINUE                                                 20050076
200600     ELSE                                                         20060076
200700         IF PS-AUTO-VE-PO                                         20070076
200800             MOVE PV-RCVR-SEQ-NBR   TO PV-OTBND-RCVR-SEQ          20080076
200900         ELSE                                                     20090076
201000             MOVE 0                 TO PV-OTBND-RCVR-SEQ          20100076
201100         END-IF                                                   20110076
201200         PERFORM 2600-INSERT-OTBND-UPC                            20120076
201300         PERFORM 2700-INSERT-TSUQADJ                              20130076
201400     END-IF.                                                      20140076
201500     COMPUTE PV-UNT-RTL-AMT =                                     20150076
201600          XL001-UNT-RTL-AMT * PV-AFTER-QTY.                       20160076
201700     IF PV-AFTER-QTY > KRPRPM-FUNC-QTY                            20170076
201800         SET PS-TOO-MANY-UNEXPCTD TO TRUE                         20180076
201900     ELSE                                                         20190076
202000         SET PS-NOT-TOO-MANY-UNEXPCTD TO TRUE                     20200076
202100     END-IF.                                                      20210076
202200     IF PS-NOT-UNIT-ADJUST-DEPT-DC                                20220076
202300         SET PS-LINKED-TO-3000   TO TRUE                          20230076
202400     ELSE                                                         20240076
202500         SET PS-NOT-LINKED-TO-3000 TO TRUE                        20250076
202600         IF PV-AUDIT-REC-TYPE = 'B' AND                           20260076
202700            PS-ITM-NOT-FOUND                                      20270076
202800                                                                  20280076
202900             SET PS-FINCL-ADJ-ID-EXISTS TO TRUE                   20290076
203000                                                                  20300076
203100             PERFORM UNTIL PS-FINCL-ADJ-ID-NOT-EXISTS             20310076
203200                 PERFORM 2800-CREATE-RANDOM-NBR                   20320076
203300                                                                  20330076
203400                 MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID      20340076
203500                 PERFORM 2900-SELECT-SUT-FINCL-ADJ                20350076
203600             END-PERFORM                                          20360076
203700                                                                  20370076
203800             IF RECEIV-STATUS-CDE NOT EQUAL 'VE'                  20380076
203900                 PERFORM 4300-CREATE-TROUBLE                      20390076
204000             END-IF                                               20400076
204100             IF DK-UPC-NBR = 0                                    20410076
204200                 MOVE 22 TO SUT00030-ADJ-ERR-CDE                  20420076
204300             ELSE                                                 20430076
204400                 MOVE  6 TO SUT00030-ADJ-ERR-CDE                  20440076
204500             END-IF                                               20450076
204600             SET PS-FAILED-ADJ        TO TRUE                     20460076
204700             PERFORM 4000-INSERT-FINCL-ADJ                        20470076
204800         ELSE                                                     20480076
204900             IF RECEIV-STATUS-CDE EQUAL 'DE'                      20490076
205000                 IF PS-UNIT-ADJUST-DEPT-DC                        20500076
205100                     PERFORM 4300-CREATE-TROUBLE                  20510076
205200                     MOVE 14 TO SUT00030-ADJ-ERR-CDE              20520076
205300                     SET PS-FAILED-ADJ        TO TRUE             20530076
205400                     PERFORM 4000-INSERT-FINCL-ADJ                20540076
205500                 END-IF                                           20550076
205600             ELSE                                                 20560076
205700               IF PS-ITM-NOT-FOUND                                20570076
205800                   IF RECEIV-STATUS-CDE NOT EQUAL 'VE'            20580076
205900                       PERFORM 4300-CREATE-TROUBLE                20590076
206000                   END-IF                                         20600076
206100                   MOVE 6  TO SUT00030-ADJ-ERR-CDE                20610076
206200                   SET PS-FAILED-ADJ        TO TRUE               20620076
206300                   PERFORM 4000-INSERT-FINCL-ADJ                  20630076
206400               ELSE                                               20640076
206500                   IF PS-LINE-NOT-ON-PO                           20650076
206600                       IF PS-TOO-MANY-UNEXPCTD                    20660076
206700                           IF RECEIV-STATUS-CDE NOT EQUAL 'VE'    20670076
206800                               PERFORM 4300-CREATE-TROUBLE        20680076
206900                           END-IF                                 20690076
207000                           MOVE 4  TO SUT00030-ADJ-ERR-CDE        20700076
207100                           SET PS-FAILED-ADJ        TO TRUE       20710076
207200                           PERFORM 4000-INSERT-FINCL-ADJ          20720076
207300                       ELSE                                       20730076
207400                           IF PV-UNT-RTL-AMT > PV-MAX-RETAIL      20740076
207500                               IF RECEIV-STATUS-CDE NOT EQUAL 'VE'20750076
207600                                   PERFORM 4300-CREATE-TROUBLE    20760076
207700                               END-IF                             20770076
207800                               MOVE 5  TO SUT00030-ADJ-ERR-CDE    20780076
207900                               SET PS-FAILED-ADJ        TO TRUE   20790076
208000                               PERFORM 4000-INSERT-FINCL-ADJ      20800076
208100                           ELSE                                   20810076
208200                               IF RECEIV-STATUS-CDE NOT EQUAL 'VE'20820076
208300                                   PERFORM 4300-CREATE-TROUBLE    20830076
208400                               END-IF                             20840076
208500                               MOVE 7  TO SUT00030-ADJ-ERR-CDE    20850076
208600                               SET PS-FAILED-ADJ        TO TRUE   20860076
208700                               PERFORM 4000-INSERT-FINCL-ADJ      20870076
208800                           END-IF                                 20880076
208900                       END-IF                                     20890076
209000                   ELSE                                           20900076
209100                       PERFORM 3000-LINK-UNIT-ADJ-PROGRAM         20910076
209200                       SET PS-LINKED-TO-3000 TO TRUE              20920076
209300                   END-IF                                         20930076
209400               END-IF                                             20940076
209500             END-IF                                               20950076
209600         END-IF                                                   20960076
209700     END-IF.                                                      20970076
209800     IF PS-NOT-LINKED-TO-3000                                     20980076
209900         IF PV-SAVE-ORD-LNE-NBR = 999999999                       20990076
210000             CONTINUE                                             21000076
210100         ELSE                                                     21010076
210200             SET PS-DONT-APPLY-CRT-UPDATES   TO TRUE              21020076
210300             SET PS-BACK-OUT-UPDATES         TO TRUE              21030076
210400         END-IF                                                   21040076
210500         PERFORM 4700-BACK-OUT-UPDATES                            21050076
210600     END-IF.                                                      21060076
210700                                                                  21070076
210800                                                                  21080076
210900 2410-SELECT-RECEIVER.                                            21090076
211000     SET PS-RECEIVER-FOUND  TO TRUE.                              21100076
211100                                                                  21110076
211200     EXEC SQL                                                     21120076
211300        SELECT  PKGNG_CDE                                         21130076
211400              , STATUS_CDE                                        21140076
211500              , ML_POST_TMST                                      21150076
211600              , PACK_BY_ST_IND                                    21160076
211700          INTO  :RECEIV-PKGNG-CDE                                 21170076
211800              , :RECEIV-STATUS-CDE                                21180076
211900              , :RECEIV-ML-POST-TMST                              21190076
212000              , :RECEIV-PACK-BY-ST-IND                            21200076
212100          FROM  TRECEIV                                           21210076
212200          WHERE ORD_NBR           = :DK-PO-NBR                    21220076
212300            AND REC_SEQ_NBR       = :PV-RCVR-SEQ-NBR              21230076
212400     END-EXEC.                                                    21240076
212500                                                                  21250076
212600                                                                  21260076
212700     EVALUATE TRUE                                                21270076
212800         WHEN SQLCODE = ZERO                                      21280076
212900             CONTINUE                                             21290076
213000         WHEN SQLCODE = +100                                      21300076
213100             SET PS-NO-RECEIVER-FOUND  TO TRUE                    21310076
213200         WHEN SQLWARN0 NOT = SPACES                               21320076
213300         WHEN SQLCODE < ZERO                                      21330076
213400         WHEN SQLCODE > ZERO                                      21340076
213500             SET PS-ERROR                                         21350076
213600                 SU034-INVALID-SQL    TO TRUE                     21360076
213700             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          21370076
213800             MOVE PV-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     21380076
213900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       21390076
214000             STRING   ' SUKUT701-2410-'                           21400076
214100                      ' CALLED BY-'                               21410076
214200                      SU034-PROGRAM-NAME                          21420076
214300                      '  SQLCODE='                                21430076
214400                      PV-DISPLAY-SQLCODE                          21440076
214500                      ' PO '                                      21450076
214600                      PV-DISP-TRN-NBR                             21460076
214700                      ' REC SEQ  '                                21470076
214800                      PV-DISP-RCVR-SEQ-NBR                        21480076
214900                      DELIMITED BY SIZE                           21490076
215000                                      INTO SU034-CRA-RET-MSG      21500076
215100             PERFORM 9999-WRITE-TO-CSSL                           21510076
215200             MOVE '2410-'                TO SU034-CRA-REQ-ID      21520076
215300             SET SU034-INVALID-SQL TO TRUE                        21530076
215400             PERFORM 9998-RETURN                                  21540076
215500     END-EVALUATE.                                                21550076
215600                                                                  21560076
215700 2415-SELECT-RECITM.                                              21570076
215800     SET PS-RECITM-STATUS-FOUND TO TRUE.                          21580076
215900                                                                  21590076
216000     EXEC SQL                                                     21600076
216100        SELECT STATUS_CDE                                         21610076
216200          INTO  :RECITM-STATUS-CDE                                21620076
216300          FROM  TRECITM                                           21630076
216400          WHERE ORD_NBR           = :DK-PO-NBR                    21640076
216500            AND REC_SEQ_NBR       = :PV-RCVR-SEQ-NBR              21650076
216600            AND ORD_LNE_NBR       = :DK-TRN-LNE-NBR               21660076
216700     END-EXEC.                                                    21670076
216800                                                                  21680076
216900                                                                  21690076
217000     EVALUATE TRUE                                                21700076
217100         WHEN SQLCODE = ZERO                                      21710076
217200             CONTINUE                                             21720076
217300         WHEN SQLCODE = +100                                      21730076
217400             SET PS-RECITM-STATUS-NOT-FOUND TO TRUE               21740076
217500         WHEN SQLWARN0 NOT = SPACES                               21750076
217600         WHEN SQLCODE < ZERO                                      21760076
217700         WHEN SQLCODE > ZERO                                      21770076
217800             SET PS-ERROR                                         21780076
217900                 SU034-INVALID-SQL    TO TRUE                     21790076
218000             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          21800076
218100             MOVE PV-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     21810076
218200             MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR      21820076
218300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       21830076
218400             STRING   ' SUKUT701-2415-'                           21840076
218500                      ' CALLED BY-'                               21850076
218600                      SU034-PROGRAM-NAME                          21860076
218700                      '  SQLCODE='                                21870076
218800                      PV-DISPLAY-SQLCODE                          21880076
218900                      ' PO '                                      21890076
219000                      PV-DISP-TRN-NBR                             21900076
219100                      ' REC SEQ  '                                21910076
219200                      PV-DISP-RCVR-SEQ-NBR                        21920076
219300                      ' LINE '                                    21930076
219400                      PV-DISP-TRN-LNE-NBR                         21940076
219500                      DELIMITED BY SIZE                           21950076
219600                                      INTO SU034-CRA-RET-MSG      21960076
219700             PERFORM 9999-WRITE-TO-CSSL                           21970076
219800             MOVE '2415-'                TO SU034-CRA-REQ-ID      21980076
219900             SET SU034-INVALID-SQL TO TRUE                        21990076
220000             PERFORM 9998-RETURN                                  22000076
220100     END-EVALUATE.                                                22010076
220200                                                                  22020076
220300 2420-CHECK-IF-ON-PO.                                             22030076
220400     EXEC SQL                                                     22040076
220500           SELECT DISTINCT                                        22050076
220600                  A.PO_NBR                                        22060076
220700           INTO   :PURITM-PO-NBR                                  22070076
220800           FROM   TPURITM A                                       22080076
220900                , TRECEIV B                                       22090076
221000           WHERE  A.PO_NBR         = :DK-PO-NBR                   22100076
221100             AND  A.ITM_NBR        = :XL001-ITM-NBR               22110076
221200             AND  A.APP_PO_LNE_NBR = :DK-TRN-LNE-NBR              22120076
221300             AND  A.PO_NBR         = B.ORD_NBR                    22130076
221400             AND  A.VER_STATUS_CDE = 'A'                          22140076
221500             AND  B.VER_STATUS_CDE = 'A'                          22150076
221600     END-EXEC                                                     22160076
221700                                                                  22170076
221800     EVALUATE TRUE                                                22180076
221900         WHEN SQLCODE = ZERO                                      22190076
222000             CONTINUE                                             22200076
222100                                                                  22210076
222200         WHEN SQLWARN0 NOT = SPACES                               22220076
222300         WHEN SQLCODE < ZERO                                      22230076
222400         WHEN SQLCODE > ZERO                                      22240076
222500             SET PS-ERROR                                         22250076
222600                 SU034-INVALID-SQL    TO TRUE                     22260076
222700             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          22270076
222800             MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR      22280076
222900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       22290076
223000             STRING   ' SUKUT701-2420-'                           22300076
223100                      ' CALLED BY-'                               22310076
223200                      SU034-PROGRAM-NAME                          22320076
223300                      '  SQLCODE='                                22330076
223400                      PV-DISPLAY-SQLCODE                          22340076
223500                      ' '                                         22350076
223600                      PV-DISP-TRN-NBR                             22360076
223700                      '  '                                        22370076
223800                      PV-DISP-TRN-LNE-NBR                         22380076
223900                      DELIMITED BY SIZE                           22390076
224000                                      INTO SU034-CRA-RET-MSG      22400076
224100             PERFORM 9999-WRITE-TO-CSSL                           22410076
224200             MOVE '2420-'                TO SU034-CRA-REQ-ID      22420076
224300             SET SU034-INVALID-SQL TO TRUE                        22430076
224400             PERFORM 9998-RETURN                                  22440076
224500     END-EVALUATE.                                                22450076
224600                                                                  22460076
224700                                                                  22470076
224800 2500-UPDATE-OTBND-UPC.                                           22480076
224900                                                                  22490076
225000     MOVE DK-OTBND-SHIPT-UNT-ID TO PV-SAVE-SHIPT-UNT-ID.          22500076
225100     MOVE SUT00028-TRN-NBR      TO DK-TRN-NBR                     22510076
225200                                   PV-SAVE-TRN-NBR.               22520076
225300     MOVE SUT00028-RCVR-SEQ-NBR TO DK-RCVR-SEQ-NBR                22530076
225400                                   PV-SAVE-RCVR-SEQ-NBR.          22540076
225500     MOVE SUT00028-TRN-LNE-NBR  TO DK-TRN-LNE-NBR                 22550076
225600                                   PV-SAVE-TRN-LNE-NBR.           22560076
225700     MOVE SUT00028-TRN-TYP-CDE  TO DK-TRN-TYP-CDE                 22570076
225800                                   PV-SAVE-TRN-TYP-CDE.           22580076
225900     MOVE DK-UPC-NBR            TO PV-SAVE-UPC.                   22590076
226000     MOVE PV-AFTER-QTY          TO PV-SAVE-AFTER-QTY.             22600076
226100     MOVE PV-BEFORE-QTY         TO PV-SAVE-BEFORE-QTY.            22610076
226200     MOVE 'UPDATE'              TO PV-SAVE-INSERT-UPDATE-IND.     22620076
226300                                                                  22630076
226400     EXEC SQL                                                     22640076
226500         UPDATE SUT_OTBND_UPC                                     22650076
226600             SET SHPD_UNT_QTY      = :PV-AFTER-QTY                22660076
226700         WHERE  SHIPT_UNT_ID       = :DK-OTBND-SHIPT-UNT-ID       22670076
226800           AND  TRN_NBR            = :DK-TRN-NBR                  22680076
226900           AND  RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR             22690076
227000           AND  TRN_LNE_NBR        = :DK-TRN-LNE-NBR              22700076
227100           AND  TRN_TYP_CDE        = :DK-TRN-TYP-CDE              22710076
227200           AND  UPC_NBR            = :DK-UPC-NBR                  22720076
227300     END-EXEC.                                                    22730076
227400                                                                  22740076
227500     EVALUATE TRUE                                                22750076
227600         WHEN SQLCODE = ZERO                                      22760076
227700             SET PS-OTBND-UPC-UPDATED   TO TRUE                   22770076
227800         WHEN SQLWARN0 NOT = SPACES                               22780076
227900         WHEN SQLCODE < ZERO                                      22790076
228000         WHEN SQLCODE > ZERO                                      22800076
228100             SET PS-ERROR                                         22810076
228200                 SU034-INVALID-SQL    TO TRUE                     22820076
228300             MOVE DK-OTBND-SHIPT-UNT-ID                           22830076
228400                                      TO PV-DISP-SHIPT-UNT-ID     22840076
228500             MOVE DK-TRN-NBR          TO PV-DISP-TRN-NBR          22850076
228600             MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     22860076
228700             MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR      22870076
228800             MOVE DK-TRN-TYP-CDE      TO PV-DISP-TRN-TYP-CDE      22880076
228900             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          22890076
229000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       22900076
229100             STRING   ' SUKUT701-2500-'                           22910076
229200                      ' CALLED BY-'                               22920076
229300                      ' TRN TYP='                                 22930076
229400                      PV-DISP-TRN-TYP-CDE                         22940076
229500                      ' UPC='                                     22950076
229600                      PV-DISP-UPC-NBR                             22960076
229700                      DELIMITED BY SIZE                           22970076
229800                                      INTO SU034-CRA-RET-MSG      22980076
229900             PERFORM 9999-WRITE-TO-CSSL                           22990076
230000             STRING   ' SUKUT701-2500-'                           23000076
230100                      ' CALLED BY-'                               23010076
230200                      SU034-PROGRAM-NAME                          23020076
230300                      '  SQLCODE='                                23030076
230400                      PV-DISPLAY-SQLCODE                          23040076
230500                      ' '                                         23050076
230600                      PV-DISP-SHIPT-UNT-ID                        23060076
230700                      ' '                                         23070076
230800                      PV-DISP-TRN-NBR                             23080076
230900                      ' '                                         23090076
231000                      PV-DISP-RCVR-SEQ-NBR                        23100076
231100                      ' '                                         23110076
231200                      PV-DISP-TRN-LNE-NBR                         23120076
231300                      DELIMITED BY SIZE                           23130076
231400                                      INTO SU034-CRA-RET-MSG      23140076
231500             PERFORM 9999-WRITE-TO-CSSL                           23150076
231600             MOVE '2500-'                TO SU034-CRA-REQ-ID      23160076
231700             SET SU034-INVALID-SQL TO TRUE                        23170076
231800             PERFORM 9998-RETURN                                  23180076
231900***          SET DP013-NO-ROLLBACK       TO TRUE                  23190076
232000     END-EVALUATE.                                                23200076
232100                                                                  23210076
232200 2600-INSERT-OTBND-UPC.                                           23220076
232300                                                                  23230076
232400     MOVE DK-OTBND-SHIPT-UNT-ID                                   23240076
232500                              TO PV-SAVE-SHIPT-UNT-ID.            23250076
232600     MOVE SUATRN-TRN-NBR      TO PV-SAVE-TRN-NBR.                 23260076
232700     MOVE PV-OTBND-RCVR-SEQ   TO PV-SAVE-RCVR-SEQ-NBR.            23270076
232800     MOVE DK-TRN-LNE-NBR      TO PV-SAVE-TRN-LNE-NBR.             23280076
232900     MOVE 'PO'                TO PV-SAVE-TRN-TYP-CDE.             23290076
233000     MOVE DK-UPC-NBR          TO PV-SAVE-UPC.                     23300076
233100     MOVE PV-AFTER-QTY        TO PV-SAVE-AFTER-QTY.               23310076
233200     MOVE 0                   TO PV-SAVE-BEFORE-QTY.              23320076
233300     MOVE 'INSERT'            TO PV-SAVE-INSERT-UPDATE-IND.       23330076
233400                                                                  23340076
233500     EXEC SQL                                                     23350076
233600         INSERT INTO SUT_OTBND_UPC                                23360076
233700             (                                                    23370076
233800                 SHIPT_UNT_ID                                     23380076
233900             ,   TRN_NBR                                          23390076
234000             ,   TRN_LNE_NBR                                      23400076
234100             ,   TRN_TYP_CDE                                      23410076
234200             ,   UPC_NBR                                          23420076
234300             ,   SHPD_UNT_QTY                                     23430076
234400             ,   RCVR_SEQ_NBR                                     23440076
234500             )                                                    23450076
234600             VALUES                                               23460076
234700             (                                                    23470076
234800                 :DK-OTBND-SHIPT-UNT-ID                           23480076
234900             ,   :SUATRN-TRN-NBR                                  23490076
235000             ,   :DK-TRN-LNE-NBR                                  23500076
235100             ,   'PO'                                             23510076
235200             ,   :DK-UPC-NBR                                      23520076
235300             ,   :PV-AFTER-QTY                                    23530076
235400             ,   :PV-OTBND-RCVR-SEQ                               23540076
235500             )                                                    23550076
235600     END-EXEC.                                                    23560076
235700                                                                  23570076
235800     EVALUATE TRUE                                                23580076
235900         WHEN SQLCODE = ZERO                                      23590076
236000             SET PS-OTBND-UPC-UPDATED   TO TRUE                   23600076
236100         WHEN SQLCODE = -803                                      23610076
236200             PERFORM 3300-SELECT-UPC                              23620076
236300             PERFORM 2500-UPDATE-OTBND-UPC                        23630076
236400         WHEN SQLWARN0 NOT = SPACES                               23640076
236500         WHEN SQLCODE NOT EQUAL ZERO                              23650076
236600             SET PS-ERROR                                         23660076
236700                 SU034-INVALID-SQL    TO TRUE                     23670076
236800             MOVE DK-OTBND-SHIPT-UNT-ID                           23680076
236900                                      TO PV-DISP-SHIPT-UNT-ID     23690076
237000             MOVE SUATRN-TRN-NBR      TO PV-DISP-TRN-NBR          23700076
237100             MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR      23710076
237200             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          23720076
237300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       23730076
237400             STRING   ' SUKUT701-2600-'                           23740076
237500                      'UPC = '                                    23750076
237600                      PV-DISP-UPC-NBR                             23760076
237700                      DELIMITED BY SIZE                           23770076
237800                                      INTO SU034-CRA-RET-MSG      23780076
237900             PERFORM 9999-WRITE-TO-CSSL                           23790076
238000             STRING   ' SUKUT701-2600-'                           23800076
238100                      ' CALLED BY-'                               23810076
238200                      SU034-PROGRAM-NAME                          23820076
238300                      '  SQLCODE='                                23830076
238400                      PV-DISPLAY-SQLCODE                          23840076
238500                      ' '                                         23850076
238600                      PV-DISP-SHIPT-UNT-ID                        23860076
238700                      ' '                                         23870076
238800                      PV-DISP-TRN-NBR                             23880076
238900                      ' '                                         23890076
239000                      PV-DISP-TRN-LNE-NBR                         23900076
239100                      DELIMITED BY SIZE                           23910076
239200                                      INTO SU034-CRA-RET-MSG      23920076
239300             PERFORM 9999-WRITE-TO-CSSL                           23930076
239400             MOVE '2600-'                TO SU034-CRA-REQ-ID      23940076
239500             SET SU034-INVALID-SQL TO TRUE                        23950076
239600             PERFORM 9998-RETURN                                  23960076
239700     END-EVALUATE.                                                23970076
239800******************************************************************23980076
239900                                                                  23990076
240000 2700-INSERT-TSUQADJ.                                             24000076
240100                                                                  24010076
240200     SET PS-FINCL-ADJ-ID-EXISTS TO TRUE.                          24020076
240300                                                                  24030076
240400     PERFORM UNTIL PS-FINCL-ADJ-ID-NOT-EXISTS                     24040076
240500         PERFORM 2800-CREATE-RANDOM-NBR                           24050076
240600                                                                  24060076
240700         MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID              24070076
240800         PERFORM 2900-SELECT-SUT-FINCL-ADJ                        24080076
240900     END-PERFORM.                                                 24090076
241000                                                                  24100076
241100     EXEC SQL                                                     24110076
241200         SET :SUQADJ-ADJ-TMST = CURRENT TIMESTAMP                 24120076
241300     END-EXEC.                                                    24130076
241400                                                                  24140076
241500     EXEC SQL                                                     24150076
241600         INSERT INTO TSUQADJ                                      24160076
241700         (                                                        24170076
241800          SHIPT_UNT_ID                                            24180076
241900         ,UPC_NBR                                                 24190076
242000         ,ADJ_TMST                                                24200076
242100         ,OPER_UNT_ID                                             24210076
242200         ,ADJ_FUNC_CDE                                            24220076
242300         ,ADJ_BEF_QTY                                             24230076
242400         ,ADJ_AFT_QTY                                             24240076
242500         ,PRC_RSN_CDE                                             24250076
242600         ,ADJ_USR_ID                                              24260076
242700         ,AUD_CNTL_NBR                                            24270076
242800         ,FINCL_ADJ_ID                                            24280076
242900         )                                                        24290076
243000         VALUES                                                   24300076
243100         (                                                        24310076
243200          :DK-OTBND-SHIPT-UNT-ID                                  24320076
243300         ,:DK-UPC-NBR                                             24330076
243400         ,:SUQADJ-ADJ-TMST                                        24340076
243500         ,:SU034-OPER-UNT-ID                                      24350076
243600         ,'U'                                                     24360076
243700         ,:SUQADJ-ADJ-BEF-QTY                                     24370076
243800         ,:SUQADJ-ADJ-AFT-QTY                                     24380076
243900         ,:SU034-PRC-RSN-CDE                                      24390076
244000         ,:SUQADJ-ADJ-USR-ID                                      24400076
244100         ,:SUQADJ-AUD-CNTL-NBR                                    24410076
244200         ,:PV-FINCL-ADJ-ID                                        24420076
244300         )                                                        24430076
244400     END-EXEC.                                                    24440076
244500     EVALUATE TRUE                                                24450076
244600         WHEN SQLCODE = +0                                        24460076
244700         WHEN SQLCODE = -904                                      24470076
244800         WHEN SQLCODE = -913                                      24480076
244900             CONTINUE                                             24490076
245000         WHEN SQLWARN0 NOT = SPACES                               24500076
245100         WHEN SQLCODE < +0                                        24510076
245200         WHEN SQLCODE > +0                                        24520076
245300             SET PS-ERROR                                         24530076
245400                 SU034-INVALID-SQL    TO TRUE                     24540076
245500             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     24550076
245600             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          24560076
245700             MOVE SU034-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID      24570076
245800             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       24580076
245900             STRING   ' SUKUT701-2700-'                           24590076
246000                      ' CALLED BY-'                               24600076
246100                      SU034-PROGRAM-NAME                          24610076
246200                      '  SQLCODE='                                24620076
246300                      PV-DISPLAY-SQLCODE                          24630076
246400                      ' '                                         24640076
246500                      PV-DISP-SHIPT-UNT-ID                        24650076
246600                      ' '                                         24660076
246700                      PV-DISP-UPC-NBR                             24670076
246800                      ' '                                         24680076
246900                      PV-DISP-OPER-UNT-ID                         24690076
247000                      DELIMITED BY SIZE                           24700076
247100                                      INTO SU034-CRA-RET-MSG      24710076
247200             PERFORM 9999-WRITE-TO-CSSL                           24720076
247300             MOVE '2700-'                TO SU034-CRA-REQ-ID      24730076
247400             SET SU034-INVALID-SQL TO TRUE                        24740076
247500             PERFORM 9998-RETURN                                  24750076
247600     END-EVALUATE.                                                24760076
247700                                                                  24770076
247800******************************************************************24780076
247900*  2800-CREATE-RANDOM-NBR                                        *24790076
248000*  THIS PARAGRAPH WILL RANDOMLY CREATE A NEW AUDIT CNTL NUMBER   *24800076
248100******************************************************************24810076
248200 2800-CREATE-RANDOM-NBR.                                          24820076
248300                                                                  24830076
248400     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     24840076
248500     CALL PC-RANDOM-NBR-GENERATOR USING                           24850076
248600                            DFHEIBLK                              24860076
248700                            DFHCOMMAREA                           24870076
248800                            DP902-RANDNBR-ROUTINE-FIELDS.         24880076
248900                                                                  24890076
249000     IF DP902-SUCCESSFUL                                          24900076
249100         CONTINUE                                                 24910076
249200     ELSE                                                         24920076
249300         SET SU034-INVALID-SQL TO TRUE                            24930076
249400         SET PS-ERROR TO TRUE                                     24940076
249500     END-IF.                                                      24950076
249600                                                                  24960076
249700 2900-SELECT-SUT-FINCL-ADJ.                                       24970076
249800                                                                  24980076
249900     EXEC SQL                                                     24990076
250000         SELECT   FINCL_ADJ_ID                                    25000076
250100         INTO     :SUT00030-FINCL-ADJ-ID                          25010076
250200         FROM     SUT_FINCL_ADJ                                   25020076
250300         WHERE    FINCL_ADJ_ID = :PV-FINCL-ADJ-ID                 25030076
250400     END-EXEC.                                                    25040076
250500                                                                  25050076
250600     EVALUATE TRUE                                                25060076
250700         WHEN SQLCODE = +0                                        25070076
250800             SET PS-FINCL-ADJ-ID-EXISTS TO TRUE                   25080076
250900         WHEN SQLCODE = +100                                      25090076
251000             SET PS-FINCL-ADJ-ID-NOT-EXISTS TO TRUE               25100076
251100         WHEN SQLWARN0 NOT = SPACES                               25110076
251200         WHEN SQLCODE < +0                                        25120076
251300         WHEN SQLCODE > +0                                        25130076
251400             SET PS-ERROR                                         25140076
251500                 SU034-INVALID-SQL    TO TRUE                     25150076
251600             MOVE PV-FINCL-ADJ-ID     TO PV-DISP-FINCL-ADJ-ID     25160076
251700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       25170076
251800             STRING   ' SUKUT701-2900-'                           25180076
251900                      ' CALLED BY-'                               25190076
252000                      SU034-PROGRAM-NAME                          25200076
252100                      '  SQLCODE='                                25210076
252200                      PV-DISPLAY-SQLCODE                          25220076
252300                      ' '                                         25230076
252400                      PV-DISP-FINCL-ADJ-ID                        25240076
252500                      DELIMITED BY SIZE                           25250076
252600                                      INTO SU034-CRA-RET-MSG      25260076
252700             PERFORM 9999-WRITE-TO-CSSL                           25270076
252800             MOVE '2900-'                TO SU034-CRA-REQ-ID      25280076
252900             SET SU034-INVALID-SQL TO TRUE                        25290076
253000             PERFORM 9998-RETURN                                  25300076
253100     END-EVALUATE.                                                25310076
253200                                                                  25320076
253300 3000-LINK-UNIT-ADJ-PROGRAM.                                      25330076
253400     INITIALIZE SU035-COMM-AREA.                                  25340076
253500     MOVE SUT00024-SHIPT-UNT-ID     TO SU035-SHIPT-UNT-ID.        25350076
253600     MOVE DK-UPC-NBR                TO SU035-UPC-NBR.             25360076
253700                                                                  25370076
253800     EXEC SQL                                                     25380076
253900         SET :SU035-CRE-TMST  = CURRENT TIMESTAMP                 25390076
254000     END-EXEC.                                                    25400076
254100                                                                  25410076
254200     MOVE SU034-PRC-RSN-CDE         TO SU035-PRC-RSN-CDE.         25420076
254300     MOVE SU034-OPER-UNT-ID         TO SU035-ORIG-OPER-UNT-ID.    25430076
254400     MOVE PV-BEFORE-QTY             TO SU035-BEFORE-QTY.          25440076
254500     MOVE PV-AFTER-QTY              TO SU035-AFTER-QTY.           25450076
254600     MOVE PV-ADJUST-QTY             TO SU035-ADJUST-QTY.          25460076
254700     MOVE SU034-USER-ID             TO SU035-CREATE-USER-ID.      25470076
254800     MOVE SUATRN-TRN-NBR            TO SU035-PO.                  25480076
254900     MOVE PV-RCVR-SEQ-NBR           TO SU035-REC-SEQ-NBR.         25490076
255000     MOVE DK-TRN-LNE-NBR            TO SU035-PO-LNE-NBR.          25500076
255100     MOVE SU034-ADJ-AUDIT-CNTL-NBR  TO SU035-ADJ-AUDIT-CNTL-NBR.  25510076
255200     MOVE SU034-PROGRAM-NAME        TO SU035-PROGRAM-NAME.        25520076
255300     MOVE SUT00024-DEST-LOC-NBR     TO SU035-DEST-LOC-NBR.        25530076
255400     MOVE ' '                       TO SU035-CASEPACK-DELETE-IND. 25540076
255500     MOVE 'Y'                     TO SU035-UPDATE-UNTS-WORKED-IND.25550076
255600     MOVE ' '                       TO SU035-CART-CREATE-SRC.     25560076
255700     MOVE PV-FINCL-ADJ-ID           TO SU035-FINCL-ADJ-ID.        25570076
255800     SET SU035-PACK-NO  TO TRUE.                                  25580076
255900     PERFORM 2415-SELECT-RECITM.                                  25590076
256000     IF PS-AUTO-VE-PO AND                                         25600076
256100        (PS-RECITM-STATUS-FOUND AND                               25610076
256200        RECITM-STATUS-CDE NOT EQUAL 'VE') OR                      25620076
256300        (PS-RECITM-STATUS-NOT-FOUND AND                           25630076
256400        RECEIV-STATUS-CDE NOT EQUAL 'VE')                         25640076
256500         SET SU035-LOG-ONLY     TO TRUE                           25650076
256600     ELSE                                                         25660076
256700         SET SU035-LOG-ONLY-NO  TO TRUE                           25670076
256800     END-IF.                                                      25680076
256900     IF PS-ODD-UNITS-ADJUSTMENT                                   25690076
257000         SET SU035-ODD-UNIT-YES TO TRUE                           25700076
257100         SET SU035-PACK-YES TO TRUE                               25710076
257200         MOVE PV-PACK-ID    TO SU035-PACK-ID                      25720076
257300         MOVE PV-BEFORE-ODD-UNT-QTY TO SU035-BEFORE-ODD-UNT-QTY   25730076
257400         MOVE PV-AFTER-ODD-UNT-QTY  TO SU035-AFTER-ODD-UNT-QTY    25740076
257500     ELSE                                                         25750076
257600         SET SU035-ODD-UNIT-NO  TO TRUE                           25760076
257700     END-IF.                                                      25770076
257800     IF PS-PACK-ADJUSTMENT                                        25780076
257900         SET SU035-PACK-YES TO TRUE                               25790076
258000         MOVE PV-PACK-ID    TO SU035-PACK-ID                      25800076
258100         MOVE PV-PACK-DIFF TO SU035-PACK-ADJUST-QTY               25810076
258200         IF PS-PREPACK-DRIVER                                     25820076
258300             MOVE 'A'      TO SU035-VRFY-ADJ-DRIVE-LNE            25830076
258400         END-IF                                                   25840076
258500     END-IF.                                                      25850076
258600     SET SU035-UPDATE-DISTDT TO TRUE.                             25860076
258700                                                                  25870076
258800     PERFORM 7000-LINK-SUKUT702.                                  25880076
258900     IF PS-BACK-OUT-UPDATES                                       25890076
259000         IF PV-SAVE-ORD-LNE-NBR = 999999999                       25900076
259100             SET PS-DONT-BACK-OUT-UPDATES  TO TRUE                25910076
259200         ELSE                                                     25920076
259300             SET PS-DONT-APPLY-CRT-UPDATES   TO TRUE              25930076
259400         END-IF                                                   25940076
259500         IF PS-OTBND-UPC-UPDATED                                  25950076
259600             PERFORM 4700-BACK-OUT-UPDATES                        25960076
259700         END-IF                                                   25970076
259800     END-IF.                                                      25980076
259900                                                                  25990076
260000 3100-SELECT-CARTON.                                              26000076
260100     EXEC SQL                                                     26010076
260200         SELECT SHIPT_UNT_ID                                      26020076
260300             ,  DEST_LOC_NBR                                      26030076
260400             ,  ODD_UNT_IND                                       26040076
260500           INTO :SUT00024-SHIPT-UNT-ID                            26050076
260600             ,  :SUT00024-DEST-LOC-NBR                            26060076
260700             ,  :SUT00024-ODD-UNT-IND                             26070076
260800           FROM SUT_OTBND_CART                                    26080076
260900          WHERE ORIG_CART_ID = :DK-SHIPT-UNT-ID                   26090076
261000            AND ACTV_IND     = 'Y'                                26100076
261100     END-EXEC.                                                    26110076
261200                                                                  26120076
261300     EVALUATE TRUE                                                26130076
261400         WHEN SQLCODE = +0                                        26140076
261500             CONTINUE                                             26150076
261600         WHEN SQLWARN0 NOT = SPACES                               26160076
261700         WHEN SQLCODE < +0                                        26170076
261800         WHEN SQLCODE > +0                                        26180076
261900             SET PS-ERROR                                         26190076
262000                 SU034-INVALID-SQL    TO TRUE                     26200076
262100             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     26210076
262200             MOVE SU034-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID      26220076
262300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       26230076
262400             STRING   ' SUKUT701-3100-'                           26240076
262500                      ' CALLED BY-'                               26250076
262600                      SU034-PROGRAM-NAME                          26260076
262700                      '  SQLCODE='                                26270076
262800                      PV-DISPLAY-SQLCODE                          26280076
262900                      ' '                                         26290076
263000                      PV-DISP-SHIPT-UNT-ID                        26300076
263100                      ' '                                         26310076
263200                      PV-DISP-OPER-UNT-ID                         26320076
263300                      DELIMITED BY SIZE                           26330076
263400                                      INTO SU034-CRA-RET-MSG      26340076
263500             PERFORM 9999-WRITE-TO-CSSL                           26350076
263600             MOVE '3100-'                TO SU034-CRA-REQ-ID      26360076
263700             SET SU034-INVALID-SQL TO TRUE                        26370076
263800             PERFORM 9998-RETURN                                  26380076
263900     END-EVALUATE.                                                26390076
264000                                                                  26400076
264100 3200-SELECT-UPC.                                                 26410076
264200     EXEC SQL                                                     26420076
264300         SELECT                                                   26430076
264400             B.TRN_NBR                                            26440076
264500           , B.RCVR_SEQ_NBR                                       26450076
264600           , B.TRN_LNE_NBR                                        26460076
264700           , B.TRN_TYP_CDE                                        26470076
264800           , B.UPC_NBR                                            26480076
264900           , B.SHPD_UNT_QTY                                       26490076
265000         INTO                                                     26500076
265100             :SUT00028-TRN-NBR                                    26510076
265200           , :SUT00028-RCVR-SEQ-NBR                               26520076
265300           , :SUT00028-TRN-LNE-NBR                                26530076
265400           , :SUT00028-TRN-TYP-CDE                                26540076
265500           , :SUT00028-UPC-NBR                                    26550076
265600           , :SUT00028-SHPD-UNT-QTY                               26560076
265700         FROM SUT_OTBND_UPC B                                     26570076
265800           ,  XLT_UPC C                                           26580076
265900         WHERE SHIPT_UNT_ID     = :DK-OTBND-SHIPT-UNT-ID          26590076
266000           AND B.UPC_NBR        = C.UPC_NBR                       26600076
266100           AND C.INTR_UPC_ID    = :DK-CARTON-INTR-UPC             26610076
266200     END-EXEC.                                                    26620076
266300                                                                  26630076
266400     EVALUATE TRUE                                                26640076
266500         WHEN SQLCODE = +0                                        26650076
266600             MOVE SUT00028-UPC-NBR  TO DK-UPC-NBR                 26660076
266700         WHEN SQLWARN0 NOT = SPACES                               26670076
266800         WHEN SQLCODE < +0                                        26680076
266900         WHEN SQLCODE > +0                                        26690076
267000             SET PS-ERROR                                         26700076
267100                 SU034-INVALID-SQL    TO TRUE                     26710076
267200             MOVE DK-OTBND-SHIPT-UNT-ID                           26720076
267300                                      TO PV-DISP-SHIPT-UNT-ID     26730076
267400             MOVE DK-CARTON-INTR-UPC  TO PV-DISP-UPC-NBR          26740076
267500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       26750076
267600             STRING   ' SUKUT701-3200-'                           26760076
267700                      ' CALLED BY-'                               26770076
267800                      SU034-PROGRAM-NAME                          26780076
267900                      '  SQLCODE='                                26790076
268000                      PV-DISPLAY-SQLCODE                          26800076
268100                      ' '                                         26810076
268200                      PV-DISP-SHIPT-UNT-ID                        26820076
268300                      ' '                                         26830076
268400                      PV-DISP-UPC-NBR                             26840076
268500                      DELIMITED BY SIZE                           26850076
268600                                      INTO SU034-CRA-RET-MSG      26860076
268700             PERFORM 9999-WRITE-TO-CSSL                           26870076
268800             MOVE '3200-'                TO SU034-CRA-REQ-ID      26880076
268900             SET SU034-INVALID-SQL TO TRUE                        26890076
269000             PERFORM 9998-RETURN                                  26900076
269100     END-EVALUATE.                                                26910076
269200                                                                  26920076
269300 3300-SELECT-UPC.                                                 26930076
269400     EXEC SQL                                                     26940076
269500         SELECT                                                   26950076
269600             B.TRN_NBR                                            26960076
269700           , B.RCVR_SEQ_NBR                                       26970076
269800           , B.TRN_LNE_NBR                                        26980076
269900           , B.TRN_TYP_CDE                                        26990076
270000           , B.SHPD_UNT_QTY                                       27000076
270100         INTO                                                     27010076
270200             :SUT00028-TRN-NBR                                    27020076
270300           , :SUT00028-RCVR-SEQ-NBR                               27030076
270400           , :SUT00028-TRN-LNE-NBR                                27040076
270500           , :SUT00028-TRN-TYP-CDE                                27050076
270600           , :SUT00028-SHPD-UNT-QTY                               27060076
270700         FROM SUT_OTBND_UPC B                                     27070076
270800         WHERE SHIPT_UNT_ID     = :DK-OTBND-SHIPT-UNT-ID          27080076
270900           AND B.UPC_NBR        = :DK-UPC-NBR                     27090076
271000     END-EXEC.                                                    27100076
271100                                                                  27110076
271200     EVALUATE TRUE                                                27120076
271300         WHEN SQLCODE = +0                                        27130076
271400             CONTINUE                                             27140076
271500         WHEN SQLWARN0 NOT = SPACES                               27150076
271600         WHEN SQLCODE < +0                                        27160076
271700         WHEN SQLCODE > +0                                        27170076
271800             SET PS-ERROR                                         27180076
271900                 SU034-INVALID-SQL    TO TRUE                     27190076
272000             MOVE DK-OTBND-SHIPT-UNT-ID                           27200076
272100                                      TO PV-DISP-SHIPT-UNT-ID     27210076
272200             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          27220076
272300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       27230076
272400             STRING   ' SUKUT701-3300-'                           27240076
272500                      ' CALLED BY-'                               27250076
272600                      SU034-PROGRAM-NAME                          27260076
272700                      '  SQLCODE='                                27270076
272800                      PV-DISPLAY-SQLCODE                          27280076
272900                      ' '                                         27290076
273000                      PV-DISP-SHIPT-UNT-ID                        27300076
273100                      ' '                                         27310076
273200                      PV-DISP-UPC-NBR                             27320076
273300                      DELIMITED BY SIZE                           27330076
273400                                      INTO SU034-CRA-RET-MSG      27340076
273500             PERFORM 9999-WRITE-TO-CSSL                           27350076
273600             MOVE '3300-'                TO SU034-CRA-REQ-ID      27360076
273700             SET SU034-INVALID-SQL TO TRUE                        27370076
273800             PERFORM 9998-RETURN                                  27380076
273900     END-EVALUATE.                                                27390076
274000                                                                  27400076
274100 3400-COUNT-EXPECTED-ITEMS.                                       27410076
274200     EXEC SQL                                                     27420076
274300         SELECT  SUM(A.SHPD_QTY)                                  27430076
274400             ,   A.UPC_NBR                                        27440076
274500             INTO :PV-SUM-SHPD-QTY                                27450076
274600             ,    :SHUUPC-UPC-NBR                                 27460076
274700             FROM TSHUUPC A                                       27470076
274800               ,  XLT_UPC B                                       27480076
274900             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              27490076
275000               AND A.UPC_NBR      = B.UPC_NBR                     27500076
275100               AND B.INTR_UPC_ID  = :DK-INTR-UPC                  27510076
275200        GROUP BY A.UPC_NBR                                        27520076
275300     END-EXEC.                                                    27530076
275400                                                                  27540076
275500     EVALUATE TRUE                                                27550076
275600         WHEN SQLCODE = ZERO                                      27560076
275700              MOVE SHUUPC-UPC-NBR    TO DK-UPC-NBR                27570076
275800                                                                  27580076
275900         WHEN SQLCODE = -305                                      27590076
276000         WHEN SQLCODE = +100                                      27600076
276100              MOVE ZERO               TO PV-SUM-SHPD-QTY          27610076
276200                                                                  27620076
276300         WHEN SQLWARN0 NOT = SPACES                               27630076
276400         WHEN SQLCODE NOT EQUAL ZERO                              27640076
276500             SET PS-ERROR                                         27650076
276600                 SU034-INVALID-SQL    TO TRUE                     27660076
276700             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     27670076
276800             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          27680076
276900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       27690076
277000             STRING   ' SUKUT701-3400-'                           27700076
277100                      ' CALLED BY-'                               27710076
277200                      SU034-PROGRAM-NAME                          27720076
277300                      '  SQLCODE='                                27730076
277400                      PV-DISPLAY-SQLCODE                          27740076
277500                      ' '                                         27750076
277600                      PV-DISP-SHIPT-UNT-ID                        27760076
277700                      ' '                                         27770076
277800                      PV-DISP-UPC-NBR                             27780076
277900                      DELIMITED BY SIZE                           27790076
278000                                      INTO SU034-CRA-RET-MSG      27800076
278100             PERFORM 9999-WRITE-TO-CSSL                           27810076
278200             MOVE '3400-'                TO SU034-CRA-REQ-ID      27820076
278300             SET SU034-INVALID-SQL TO TRUE                        27830076
278400             PERFORM 9998-RETURN                                  27840076
278500     END-EVALUATE.                                                27850076
278600                                                                  27860076
278700 3500-SELECT-MAX-QUANTITY.                                        27870076
278800                                                                  27880076
278900     EXEC SQL                                                     27890076
279000          SELECT FUNC_QTY                                         27900076
279100            INTO :KRPRPM-FUNC-QTY                                 27910076
279200            FROM TKRPRPM                                          27920076
279300           WHERE LOC_ID            = 90                           27930076
279400             AND INTFC_SYS_CDE    = 'KHL'                         27940076
279500             AND SYS_PRC_FUNC_CDE = 'MAXQTY'                      27950076
279600             AND FUNC_PRC_STAT_CDE = 'AC'                         27960076
279700     END-EXEC.                                                    27970076
279800                                                                  27980076
279900     EVALUATE TRUE                                                27990076
280000         WHEN SQLCODE = ZERO                                      28000076
280100             CONTINUE                                             28010076
280200         WHEN SQLWARN0 NOT = SPACES                               28020076
280300         WHEN SQLCODE NOT EQUAL ZERO                              28030076
280400             SET PS-ERROR                                         28040076
280500                 SU034-INVALID-SQL    TO TRUE                     28050076
280600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       28060076
280700             STRING   ' SUKUT701-3500-'                           28070076
280800                      ' CALLED BY-'                               28080076
280900                      SU034-PROGRAM-NAME                          28090076
281000                      '  SQLCODE='                                28100076
281100                      PV-DISPLAY-SQLCODE                          28110076
281200                      ' '                                         28120076
281300                      DELIMITED BY SIZE                           28130076
281400                                      INTO SU034-CRA-RET-MSG      28140076
281500             PERFORM 9999-WRITE-TO-CSSL                           28150076
281600             MOVE '3500-'                TO SU034-CRA-REQ-ID      28160076
281700             SET SU034-INVALID-SQL TO TRUE                        28170076
281800             PERFORM 9998-RETURN                                  28180076
281900     END-EVALUATE.                                                28190076
282000                                                                  28200076
282100 3600-SELECT-MAX-RETAIL.                                          28210076
282200                                                                  28220076
282300     EXEC SQL                                                     28230076
282400          SELECT FUNC_QTY                                         28240076
282500            INTO :KRPRPM-FUNC-QTY                                 28250076
282600            FROM TKRPRPM                                          28260076
282700           WHERE LOC_ID            = 90                           28270076
282800             AND INTFC_SYS_CDE    = 'KHL'                         28280076
282900             AND SYS_PRC_FUNC_CDE = 'MAXRTL'                      28290076
283000             AND FUNC_PRC_STAT_CDE = 'AC'                         28300076
283100     END-EXEC.                                                    28310076
283200                                                                  28320076
283300     EVALUATE TRUE                                                28330076
283400         WHEN SQLCODE = ZERO                                      28340076
283500             MOVE KRPRPM-FUNC-QTY    TO PV-MAX-RETAIL             28350076
283600         WHEN SQLWARN0 NOT = SPACES                               28360076
283700         WHEN SQLCODE NOT EQUAL ZERO                              28370076
283800             SET PS-ERROR                                         28380076
283900                 SU034-INVALID-SQL    TO TRUE                     28390076
284000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       28400076
284100             STRING   ' SUKUT701-3600-'                           28410076
284200                      ' CALLED BY-'                               28420076
284300                      SU034-PROGRAM-NAME                          28430076
284400                      '  SQLCODE='                                28440076
284500                      PV-DISPLAY-SQLCODE                          28450076
284600                      ' '                                         28460076
284700                      DELIMITED BY SIZE                           28470076
284800                                      INTO SU034-CRA-RET-MSG      28480076
284900             PERFORM 9999-WRITE-TO-CSSL                           28490076
285000             MOVE '3600-'                TO SU034-CRA-REQ-ID      28500076
285100             SET SU034-INVALID-SQL TO TRUE                        28510076
285200             PERFORM 9998-RETURN                                  28520076
285300     END-EVALUATE.                                                28530076
285400                                                                  28540076
285500 3650-CHECK-UNIT-ADJ-DC.                                          28550076
285600                                                                  28560076
285700     MOVE SU034-OPER-UNT-ID        TO DK-OPER-UNT-ID.             28570076
285800     SET PS-DEPT-NBR TO TRUE.                                     28580076
285900                                                                  28590076
286000     EXEC SQL                                                     28600076
286100         SELECT FUNC_TXT                                          28610076
286200            ,   FUNC_QTY                                          28620076
286300            ,   FUNC_BEG_TMST                                     28630076
286400           INTO :KRPRPM-FUNC-TXT                                  28640076
286500            ,   :KRPRPM-FUNC-QTY :DK-NULL-IND                     28650076
286600            ,   :KRPRPM-FUNC-BEG-TMST                             28660076
286700           FROM TKRPRPM                                           28670076
286800          WHERE SYS_PRC_FUNC_CDE  = 'UNTADJ'                      28680076
286900            AND LOC_ID            = :DK-OPER-UNT-ID               28690076
287000            AND INTFC_SYS_CDE     = 'KHL'                         28700076
287100            AND FUNC_PRC_STAT_CDE = 'AC'                          28710076
287200     END-EXEC.                                                    28720076
287300                                                                  28730076
287400     EVALUATE TRUE                                                28740076
287500         WHEN SQLCODE = ZERO                                      28750076
287600             IF KRPRPM-FUNC-TXT = 'Y'                             28760076
287700                 SET PS-UNIT-ADJUST-DC  TO TRUE                   28770076
287800             ELSE                                                 28780076
287900                 SET PS-NOT-UNIT-ADJUST-DC  TO TRUE               28790076
288000             END-IF                                               28800076
288100             IF DK-NULL-IND = -1                                  28810076
288200                 SET PS-NO-DEPT-NBR TO TRUE                       28820076
288300                 MOVE 0                  TO PV-TABLE-DEPT-NBR     28830076
288400             ELSE                                                 28840076
288500                 MOVE KRPRPM-FUNC-QTY    TO PV-TABLE-DEPT-NBR     28850076
288600             END-IF                                               28860076
288700                                                                  28870076
288800         WHEN SQLWARN0 NOT = SPACES                               28880076
288900         WHEN SQLCODE NOT EQUAL ZERO                              28890076
289000             SET PS-ERROR                                         28900076
289100                 SU034-INVALID-SQL    TO TRUE                     28910076
289200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      28920076
289300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       28930076
289400             STRING   ' SUKUT701-3650-'                           28940076
289500                      ' CALLED BY-'                               28950076
289600                      SU034-PROGRAM-NAME                          28960076
289700                      '  SQLCODE='                                28970076
289800                      PV-DISPLAY-SQLCODE                          28980076
289900                      ' '                                         28990076
290000                      PV-DISP-OPER-UNT-ID                         29000076
290100                      DELIMITED BY SIZE                           29010076
290200                                      INTO SU034-CRA-RET-MSG      29020076
290300             PERFORM 9999-WRITE-TO-CSSL                           29030076
290400             MOVE '3650-'                TO SU034-CRA-REQ-ID      29040076
290500             SET SU034-INVALID-SQL TO TRUE                        29050076
290600             PERFORM 9998-RETURN                                  29060076
290700     END-EVALUATE.                                                29070076
290800                                                                  29080076
290900                                                                  29090076
291000 3700-SELECT-TSUATRN.                                             29100076
291100                                                                  29110076
291200     EXEC SQL                                                     29120076
291300         SELECT DISTINCT                                          29130076
291400                A.TRN_NBR                                         29140076
291500               ,A.REC_SEQ_NBR                                     29150076
291600               ,A.DEST_OPER_UNT_ID                                29160076
291700               ,B.TRN_LNE_NBR                                     29170076
291800         INTO  :SUATRN-TRN-NBR                                    29180076
291900              ,:SUATRN-REC-SEQ-NBR                                29190076
292000              ,:SUATRN-DEST-OPER-UNT-ID                           29200076
292100              ,:SHUUPC-TRN-LNE-NBR                                29210076
292200          FROM  TSUATRN A                                         29220076
292300            ,   TSHUUPC B                                         29230076
292400          WHERE A.AUD_CNTL_NBR      = :DK-AUDIT-CNTL-NBR          29240076
292500            AND A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID            29250076
292600            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              29260076
292700     END-EXEC.                                                    29270076
292800                                                                  29280076
292900     EVALUATE TRUE                                                29290076
293000         WHEN SQLCODE = ZERO                                      29300076
293100         WHEN SQLCODE = -811                                      29310076
293200              SET PS-AUDIT-EXISTS TO TRUE                         29320076
293300                                                                  29330076
293400         WHEN SQLCODE = +100                                      29340076
293500              SET PS-AUDIT-NOT-EXISTS    TO TRUE                  29350076
293600                                                                  29360076
293700         WHEN SQLWARN0 NOT = SPACES                               29370076
293800         WHEN SQLCODE NOT EQUAL ZERO                              29380076
293900             SET PS-ERROR                                         29390076
294000                 SU034-INVALID-SQL    TO TRUE                     29400076
294100             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR29410076
294200             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     29420076
294300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       29430076
294400             STRING   ' SUKUT701-3700-'                           29440076
294500                      ' CALLED BY-'                               29450076
294600                      SU034-PROGRAM-NAME                          29460076
294700                      '  SQLCODE='                                29470076
294800                      PV-DISPLAY-SQLCODE                          29480076
294900                      ' '                                         29490076
295000                      PV-DISPLAY-AUDIT-CNTL-NBR                   29500076
295100                      ' '                                         29510076
295200                      PV-DISP-SHIPT-UNT-ID                        29520076
295300                      DELIMITED BY SIZE                           29530076
295400                                      INTO SU034-CRA-RET-MSG      29540076
295500             PERFORM 9999-WRITE-TO-CSSL                           29550076
295600             MOVE '3700-'                TO SU034-CRA-REQ-ID      29560076
295700             SET SU034-INVALID-SQL TO TRUE                        29570076
295800             PERFORM 9998-RETURN                                  29580076
295900     END-EVALUATE.                                                29590076
296000                                                                  29600076
296100 3800-GET-ITM-NBR.                                                29610076
296200     INITIALIZE XL001-ITEM-COMMAREA.                              29620076
296300                                                                  29630076
296400     SET  PS-ITM-NOT-FOUND        TO TRUE                         29640076
296500     MOVE DK-UPC-NBR              TO XL001-KEY-UPC-NBR.           29650076
296600                                                                  29660076
296700     SET  XL001-BY-UPC-NBR                                        29670076
296800          XL001-SELECT-SKU                                        29680076
296900          XL001-SELECT-SKU-STR    TO TRUE.                        29690076
297000                                                                  29700076
297100     CALL XL001-VSM-PGM  USING DFHEIBLK                           29710076
297200                              XL001-COMMAREA                      29720076
297300                              XL001-ITEM-COMMAREA.                29730076
297400                                                                  29740076
297500     EVALUATE TRUE                                                29750076
297600                                                                  29760076
297700      WHEN XL001-UPC-SQLCODE = +0 AND                             29770076
297800           XL001-SKU-SQLCODE = +0                                 29780076
297900          SET  PS-ITM-FOUND          TO TRUE                      29790076
298000                                                                  29800076
298100      WHEN XL001-UPC-SQLCODE = +100                               29810076
298200      WHEN XL001-SKU-SQLCODE = +100                               29820076
298300          SET  PS-ITM-NOT-FOUND        TO TRUE                    29830076
298400                                                                  29840076
298500      WHEN OTHER                                                  29850076
298600          SET PS-ERROR                                            29860076
298700              SU034-INVALID-SQL    TO TRUE                        29870076
298800          MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR             29880076
298900          MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE          29890076
299000          MOVE XL001-UPC-SQLCODE   TO PV-DISPLAY-SQLCODE-2        29900076
299100          STRING   ' SUKUT701-3800-'                              29910076
299200                   ' CALLED BY-'                                  29920076
299300                   SU034-PROGRAM-NAME                             29930076
299400                   '  SQLCODE='                                   29940076
299500                   PV-DISPLAY-SQLCODE                             29950076
299600                   ' '                                            29960076
299700                   PV-DISP-UPC-NBR                                29970076
299800                   ' '                                            29980076
299900                   PV-DISPLAY-SQLCODE-2                           29990076
300000                   DELIMITED BY SIZE                              30000076
300100                                   INTO SU034-CRA-RET-MSG         30010076
300200          PERFORM 9999-WRITE-TO-CSSL                              30020076
300300          MOVE '3800-'                TO SU034-CRA-REQ-ID         30030076
300400          PERFORM 9998-RETURN                                     30040076
300500                                                                  30050076
300600     END-EVALUATE.                                                30060076
300700                                                                  30070076
300800 3850-GET-ITM-NBR.                                                30080076
300900     INITIALIZE XL001-ITEM-COMMAREA.                              30090076
301000                                                                  30100076
301100     SET  PS-ITM-NOT-FOUND        TO TRUE                         30110076
301200     MOVE DK-INTR-UPC             TO XL001-KEY-INTR-UPC-ID.       30120076
301300                                                                  30130076
301400     SET  XL001-BY-INTR-UPC-ID                                    30140076
301500          XL001-SELECT-SKU                                        30150076
301600          XL001-SELECT-UPC                                        30160076
301700          XL001-SELECT-SKU-STR    TO TRUE.                        30170076
301800     MOVE 'V'                     TO XL001-KEY-UPC-TYP-CDE.       30180076
301900                                                                  30190076
302000     CALL XL001-VSM-PGM  USING DFHEIBLK                           30200076
302100                              XL001-COMMAREA                      30210076
302200                              XL001-ITEM-COMMAREA.                30220076
302300                                                                  30230076
302400     EVALUATE TRUE                                                30240076
302500                                                                  30250076
302600      WHEN (XL001-UPC-SQLCODE = -811 OR                           30260076
302700            XL001-UPC-SQLCODE = +0) AND                           30270076
302800           XL001-SKU-SQLCODE = +0                                 30280076
302900          SET  PS-ITM-FOUND          TO TRUE                      30290076
303000                                                                  30300076
303100      WHEN XL001-UPC-SQLCODE = +100                               30310076
303200      WHEN XL001-SKU-SQLCODE = +100                               30320076
303300          PERFORM 3855-GET-ITM-NBR-I                              30330076
303400                                                                  30340076
303500      WHEN OTHER                                                  30350076
303600          SET PS-ERROR                                            30360076
303700              SU034-INVALID-SQL    TO TRUE                        30370076
303800          MOVE DK-INTR-UPC         TO PV-INTR-UPC                 30380076
303900          MOVE PV-INTR-UPC-11      TO PV-DISP-UPC-NBR             30390076
304000          MOVE XL001-UPC-SQLCODE   TO PV-DISPLAY-SQLCODE          30400076
304100          MOVE XL001-SKU-SQLCODE   TO PV-DISPLAY-SQLCODE-2        30410076
304200          STRING   ' SUKUT701-3850-'                              30420076
304300                   'CALLED BY-'                                   30430076
304400                   SU034-PROGRAM-NAME                             30440076
304500                   ' UPC CD='                                     30450076
304600                   PV-DISPLAY-SQLCODE                             30460076
304700                   ' '                                            30470076
304800                   PV-DISP-UPC-NBR                                30480076
304900                   ' '                                            30490076
305000                   PV-DISPLAY-SQLCODE-2                           30500076
305100                   DELIMITED BY SIZE                              30510076
305200                                   INTO SU034-CRA-RET-MSG         30520076
305300          PERFORM 9999-WRITE-TO-CSSL                              30530076
305400          MOVE '3800-'                TO SU034-CRA-REQ-ID         30540076
305500          PERFORM 9998-RETURN                                     30550076
305600                                                                  30560076
305700     END-EVALUATE.                                                30570076
305800                                                                  30580076
305900 3855-GET-ITM-NBR-I.                                              30590076
306000     INITIALIZE XL001-ITEM-COMMAREA.                              30600076
306100                                                                  30610076
306200     SET  PS-ITM-NOT-FOUND        TO TRUE                         30620076
306300     MOVE DK-INTR-UPC             TO XL001-KEY-INTR-UPC-ID.       30630076
306400                                                                  30640076
306500     SET  XL001-BY-INTR-UPC-ID                                    30650076
306600          XL001-SELECT-SKU                                        30660076
306700          XL001-SELECT-UPC                                        30670076
306800          XL001-SELECT-SKU-STR    TO TRUE.                        30680076
306900                                                                  30690076
307000     CALL XL001-VSM-PGM  USING DFHEIBLK                           30700076
307100                              XL001-COMMAREA                      30710076
307200                              XL001-ITEM-COMMAREA.                30720076
307300                                                                  30730076
307400     EVALUATE TRUE                                                30740076
307500                                                                  30750076
307600      WHEN XL001-UPC-SQLCODE = +0 AND                             30760076
307700           XL001-SKU-SQLCODE = +0                                 30770076
307800          SET  PS-ITM-FOUND          TO TRUE                      30780076
307900                                                                  30790076
308000      WHEN XL001-UPC-SQLCODE = +100                               30800076
308100      WHEN XL001-SKU-SQLCODE = +100                               30810076
308200          SET  PS-ITM-NOT-FOUND        TO TRUE                    30820076
308300                                                                  30830076
308400      WHEN OTHER                                                  30840076
308500          SET PS-ERROR                                            30850076
308600              SU034-INVALID-SQL    TO TRUE                        30860076
308700          MOVE DK-INTR-UPC         TO PV-INTR-UPC                 30870076
308800          MOVE PV-INTR-UPC-11      TO PV-DISP-UPC-NBR             30880076
308900          MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE          30890076
309000          MOVE XL001-SKU-SQLCODE   TO PV-DISPLAY-SQLCODE-2        30900076
309100          STRING   ' SUKUT701-3855-'                              30910076
309200                   'CALLED BY-'                                   30920076
309300                   SU034-PROGRAM-NAME                             30930076
309400                   ' SQLCODE='                                    30940076
309500                   PV-DISPLAY-SQLCODE                             30950076
309600                   ' '                                            30960076
309700                   PV-DISP-UPC-NBR                                30970076
309800                   ' '                                            30980076
309900                   PV-DISPLAY-SQLCODE-2                           30990076
310000                   DELIMITED BY SIZE                              31000076
310100                                   INTO SU034-CRA-RET-MSG         31010076
310200          PERFORM 9999-WRITE-TO-CSSL                              31020076
310300          MOVE '3855-'                TO SU034-CRA-REQ-ID         31030076
310400          PERFORM 9998-RETURN                                     31040076
310500                                                                  31050076
310600     END-EVALUATE.                                                31060076
310700                                                                  31070076
310800                                                                  31080076
310900 3900-GET-LINE-NBR.                                               31090076
311000                                                                  31100076
311100     EXEC SQL                                                     31110076
311200        OPEN PO-CSR                                               31120076
311300     END-EXEC.                                                    31130076
311400                                                                  31140076
311500     EVALUATE TRUE                                                31150076
311600         WHEN SQLCODE = +0                                        31160076
311700              CONTINUE                                            31170076
311800         WHEN SQLWARN0 NOT = SPACES                               31180076
311900         WHEN SQLCODE < +0                                        31190076
312000         WHEN SQLCODE > +0                                        31200076
312100             SET PS-ERROR                                         31210076
312200                 SU034-INVALID-SQL    TO TRUE                     31220076
312300             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          31230076
312400             MOVE XL001-ITM-NBR       TO PV-DISPLAY-UPC-NBR       31240076
312500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       31250076
312600             STRING   ' SUKUT701-3900-OPEN'                       31260076
312700                      ' CALLED BY-'                               31270076
312800                      SU034-PROGRAM-NAME                          31280076
312900                      '  SQLCODE='                                31290076
313000                      PV-DISPLAY-SQLCODE                          31300076
313100                      ' '                                         31310076
313200                      PV-DISP-TRN-NBR                             31320076
313300                      ' '                                         31330076
313400                      PV-DISPLAY-UPC-NBR                          31340076
313500                      DELIMITED BY SIZE                           31350076
313600                                      INTO SU034-CRA-RET-MSG      31360076
313700             PERFORM 9999-WRITE-TO-CSSL                           31370076
313800             MOVE '3900-'                TO SU034-CRA-REQ-ID      31380076
313900             SET SU034-INVALID-SQL TO TRUE                        31390076
314000             PERFORM 9998-RETURN                                  31400076
314100     END-EVALUATE.                                                31410076
314200                                                                  31420076
314300     EXEC SQL                                                     31430076
314400      FETCH PO-CSR                                                31440076
314500         INTO  :PURITM-APP-PO-LNE-NBR                             31450076
314600              ,:PURITM-STATUS-CDE                                 31460076
314700     END-EXEC.                                                    31470076
314800                                                                  31480076
314900     EVALUATE TRUE                                                31490076
315000         WHEN SQLCODE = +0                                        31500076
315100              MOVE PURITM-APP-PO-LNE-NBR TO DK-TRN-LNE-NBR        31510076
315200              SET PS-LINE-ON-PO TO TRUE                           31520076
315300         WHEN SQLCODE = +100                                      31530076
315400              MOVE 0                     TO DK-TRN-LNE-NBR        31540076
315500              SET PS-LINE-NOT-ON-PO TO TRUE                       31550076
315600         WHEN SQLWARN0 NOT = SPACES                               31560076
315700         WHEN SQLCODE < +0                                        31570076
315800         WHEN SQLCODE > +0                                        31580076
315900             SET PS-ERROR                                         31590076
316000                 SU034-INVALID-SQL    TO TRUE                     31600076
316100             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          31610076
316200             MOVE XL001-ITM-NBR       TO PV-DISPLAY-UPC-NBR       31620076
316300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       31630076
316400             STRING   ' SUKUT701-3900-FETCH'                      31640076
316500                      ' CALLED BY-'                               31650076
316600                      SU034-PROGRAM-NAME                          31660076
316700                      '  SQLCODE='                                31670076
316800                      PV-DISPLAY-SQLCODE                          31680076
316900                      ' '                                         31690076
317000                      PV-DISP-TRN-NBR                             31700076
317100                      ' '                                         31710076
317200                      PV-DISPLAY-UPC-NBR                          31720076
317300                      DELIMITED BY SIZE                           31730076
317400                                      INTO SU034-CRA-RET-MSG      31740076
317500             PERFORM 9999-WRITE-TO-CSSL                           31750076
317600             MOVE '3900-'                TO SU034-CRA-REQ-ID      31760076
317700             SET SU034-INVALID-SQL TO TRUE                        31770076
317800             PERFORM 9998-RETURN                                  31780076
317900     END-EVALUATE.                                                31790076
318000                                                                  31800076
318100     EXEC SQL                                                     31810076
318200        CLOSE PO-CSR                                              31820076
318300     END-EXEC.                                                    31830076
318400                                                                  31840076
318500     EVALUATE TRUE                                                31850076
318600         WHEN SQLCODE = +0                                        31860076
318700              CONTINUE                                            31870076
318800         WHEN SQLWARN0 NOT = SPACES                               31880076
318900         WHEN SQLCODE < +0                                        31890076
319000         WHEN SQLCODE > +0                                        31900076
319100             SET PS-ERROR                                         31910076
319200                 SU034-INVALID-SQL    TO TRUE                     31920076
319300             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          31930076
319400             MOVE XL001-ITM-NBR       TO PV-DISPLAY-UPC-NBR       31940076
319500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       31950076
319600             STRING   ' SUKUT701-3900-CLOSE'                      31960076
319700                      ' CALLED BY-'                               31970076
319800                      SU034-PROGRAM-NAME                          31980076
319900                      '  SQLCODE='                                31990076
320000                      PV-DISPLAY-SQLCODE                          32000076
320100                      ' '                                         32010076
320200                      PV-DISP-TRN-NBR                             32020076
320300                      ' '                                         32030076
320400                      PV-DISPLAY-UPC-NBR                          32040076
320500                      DELIMITED BY SIZE                           32050076
320600                                      INTO SU034-CRA-RET-MSG      32060076
320700             PERFORM 9999-WRITE-TO-CSSL                           32070076
320800             MOVE '3900-'                TO SU034-CRA-REQ-ID      32080076
320900             SET SU034-INVALID-SQL TO TRUE                        32090076
321000             PERFORM 9998-RETURN                                  32100076
321100     END-EVALUATE.                                                32110076
321200                                                                  32120076
321300 3950-SELECT-TPURITM.                                             32130076
321400     EXEC SQL                                                     32140076
321500         SELECT  A.APP_PO_LNE_NBR                                 32150076
321600           INTO  :PURITM-APP-PO-LNE-NBR                           32160076
321700         FROM TPURITM A                                           32170076
321800         WHERE A.PO_NBR         = :DK-PO-NBR                      32180076
321900           AND A.APP_PO_LNE_NBR = :DK-TRN-LNE-NBR                 32190076
322000           AND A.VER_STATUS_CDE = 'A'                             32200076
322100     END-EXEC.                                                    32210076
322200                                                                  32220076
322300     EVALUATE TRUE                                                32230076
322400         WHEN SQLCODE = +0                                        32240076
322500              SET PS-LINE-ON-PO TO TRUE                           32250076
322600         WHEN SQLCODE = +100                                      32260076
322700              MOVE 0                     TO DK-TRN-LNE-NBR        32270076
322800              SET PS-LINE-NOT-ON-PO TO TRUE                       32280076
322900         WHEN SQLWARN0 NOT = SPACES                               32290076
323000         WHEN SQLCODE < +0                                        32300076
323100         WHEN SQLCODE > +0                                        32310076
323200             SET PS-ERROR                                         32320076
323300                 SU034-INVALID-SQL    TO TRUE                     32330076
323400             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          32340076
323500             MOVE XL001-ITM-NBR       TO PV-DISPLAY-UPC-NBR       32350076
323600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       32360076
323700             STRING   ' SUKUT701-3950-SELECT'                     32370076
323800                      ' CALLED BY-'                               32380076
323900                      SU034-PROGRAM-NAME                          32390076
324000                      '  SQLCODE='                                32400076
324100                      PV-DISPLAY-SQLCODE                          32410076
324200                      ' '                                         32420076
324300                      PV-DISP-TRN-NBR                             32430076
324400                      ' '                                         32440076
324500                      PV-DISPLAY-UPC-NBR                          32450076
324600                      DELIMITED BY SIZE                           32460076
324700                                      INTO SU034-CRA-RET-MSG      32470076
324800             PERFORM 9999-WRITE-TO-CSSL                           32480076
324900             MOVE '3950-'                TO SU034-CRA-REQ-ID      32490076
325000             SET SU034-INVALID-SQL TO TRUE                        32500076
325100             PERFORM 9998-RETURN                                  32510076
325200     END-EVALUATE.                                                32520076
325300                                                                  32530076
325400                                                                  32540076
325500 4000-INSERT-FINCL-ADJ.                                           32550076
325600                                                                  32560076
325700     IF PV-FINCL-ADJ-ID = 0                                       32570076
325800         SET PS-FINCL-ADJ-ID-EXISTS TO TRUE                       32580076
325900                                                                  32590076
326000         PERFORM UNTIL PS-FINCL-ADJ-ID-NOT-EXISTS                 32600076
326100             PERFORM 2800-CREATE-RANDOM-NBR                       32610076
326200                                                                  32620076
326300             MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID          32630076
326400             PERFORM 2900-SELECT-SUT-FINCL-ADJ                    32640076
326500         END-PERFORM                                              32650076
326600     END-IF.                                                      32660076
326700                                                                  32670076
326800     EXEC SQL                                                     32680076
326900         SET :SUT00030-CRE-TMST = CURRENT TIMESTAMP               32690076
327000     END-EXEC.                                                    32700076
327100                                                                  32710076
327200     MOVE PV-FINCL-ADJ-ID       TO SUT00030-FINCL-ADJ-ID.         32720076
327300     MOVE SUATRN-TRN-NBR        TO SUT00030-PO-NBR.               32730076
327400     MOVE DK-TRN-LNE-NBR        TO SUT00030-RCVR-LNE-NBR.         32740076
327500     MOVE PV-RCVR-SEQ-NBR       TO SUT00030-RCVR-SEQ-NBR.         32750076
327600     MOVE SUT00024-DEST-LOC-NBR                                   32760076
327700                                TO SUT00030-DEST-LOC-NBR.         32770076
327800     MOVE DK-UPC-NBR            TO SUT00030-UPC-NBR.              32780076
327900     MOVE SUT00024-SHIPT-UNT-ID TO SUT00030-SHIPT-UNT-ID.         32790076
328000     MOVE SU034-PRC-RSN-CDE     TO SUT00030-PRC-RSN-CDE.          32800076
328100     MOVE SU034-ADJ-AUDIT-CNTL-NBR                                32810076
328200                                TO SUT00030-AUD-CNTL-NBR.         32820076
328300     MOVE SU034-OPER-UNT-ID     TO SUT00030-ORGN-LOC-NBR.         32830076
328400     IF RECEIV-STATUS-CDE = 'VE'                                  32840076
328500         IF RECEIV-ML-POST-TMST = PC-DEFAULT-TMST                 32850076
328600             MOVE 'V'           TO SUT00030-AUD-ADJ-STAT-CDE      32860076
328700             SET SU035-VERIFIED TO TRUE                           32870076
328800         ELSE                                                     32880076
328900             MOVE 'P'           TO SUT00030-AUD-ADJ-STAT-CDE      32890076
329000             SET SU035-POST-VERIFIED TO TRUE                      32900076
329100         END-IF                                                   32910076
329200     ELSE                                                         32920076
329300         IF RECEIV-PACK-BY-ST-IND EQUAL 'Y'                       32930076
329400             MOVE 'V'           TO SUT00030-AUD-ADJ-STAT-CDE      32940076
329500         ELSE                                                     32950076
329600             MOVE 'C'           TO SUT00030-AUD-ADJ-STAT-CDE      32960076
329700         END-IF                                                   32970076
329800     END-IF.                                                      32980076
329900     MOVE 'N'                   TO SUT00030-AUTO-APL-IND.         32990076
330000     MOVE SU034-USER-ID         TO SUT00030-CRE-BY-USR-ID.        33000076
330100     IF SU034-PROGRAM-NAME = 'SUKRF512' OR                        33010076
330200        SU034-PROGRAM-NAME = 'SUKRF515'                           33020076
330300         IF PS-SYSTEM-AUDIT-FOUND                                 33030076
330400             IF SU034-PROGRAM-NAME = 'SUKRF512'                   33040076
330500                 MOVE 'SUKR512S'    TO SUT00030-CRE-PGM-NM        33050076
330600             ELSE                                                 33060076
330700                 MOVE 'SUKR515S'    TO SUT00030-CRE-PGM-NM        33070076
330800             END-IF                                               33080076
330900         ELSE                                                     33090076
331000             IF SUNAUD-AUD-TYP-CDE = '01'                         33100076
331100                 IF SU034-PROGRAM-NAME = 'SUKRF512'               33110076
331200                     MOVE 'SUKR512H'    TO SUT00030-CRE-PGM-NM    33120076
331300                 ELSE                                             33130076
331400                     MOVE 'SUKR515H'    TO SUT00030-CRE-PGM-NM    33140076
331500                 END-IF                                           33150076
331600             ELSE                                                 33160076
331700             IF SUNAUD-AUD-TYP-CDE = '02'                         33170076
331800                 IF SU034-PROGRAM-NAME = 'SUKRF512'               33180076
331900                     MOVE 'SUKR512P'    TO SUT00030-CRE-PGM-NM    33190076
332000                 ELSE                                             33200076
332100                     MOVE 'SUKR515P'    TO SUT00030-CRE-PGM-NM    33210076
332200                 END-IF                                           33220076
332300             ELSE                                                 33230076
332400             IF SUNAUD-AUD-TYP-CDE = '03'                         33240076
332500                 IF SU034-PROGRAM-NAME = 'SUKRF512'               33250076
332600                     MOVE 'SUKR512R'    TO SUT00030-CRE-PGM-NM    33260076
332700                 ELSE                                             33270076
332800                     MOVE 'SUKR515R'    TO SUT00030-CRE-PGM-NM    33280076
332900                 END-IF                                           33290076
333000             END-IF                                               33300076
333100             END-IF                                               33310076
333200             END-IF                                               33320076
333300         END-IF                                                   33330076
333400     ELSE                                                         33340076
333500         MOVE SU034-PROGRAM-NAME    TO SUT00030-CRE-PGM-NM        33350076
333600     END-IF.                                                      33360076
333700     MOVE PV-BEFORE-QTY         TO SUT00030-FINCL-BEF-QTY.        33370076
333800     MOVE PV-AFTER-QTY          TO SUT00030-FINCL-AFT-QTY.        33380076
333900**   IF PS-ADD-ZERO-UPC                                           33390076
334000**       MOVE SU034-USER-ID     TO SUT00030-RSLV-BY-USR-ID        33400076
334100**       MOVE SUT00030-CRE-TMST TO SUT00030-RSLV-TMST             33410076
334200**       MOVE 'ZERO UNITS AUDITED'                                33420076
334300**                              TO SUT00030-RSLV-CMNT-TXT         33430076
334400**   ELSE                                                         33440076
334500         MOVE SPACES            TO SUT00030-RSLV-BY-USR-ID        33450076
334600         MOVE PC-DEFAULT-TMST   TO SUT00030-RSLV-TMST             33460076
334700         MOVE SPACES            TO SUT00030-RSLV-CMNT-TXT         33470076
334800**   END-IF.                                                      33480076
334900     MOVE PV-ADJUST-QTY         TO SUT00030-ADJ-QTY.              33490076
335000                                                                  33500076
335100     EXEC SQL                                                     33510076
335200         SET :SUT00030-CRE-TMST = CURRENT TIMESTAMP               33520076
335300     END-EXEC.                                                    33530076
335400                                                                  33540076
335500*    MOVE PV-REMAINDER     TO DK-ADJ-TO-QTY                       33550076
335600     EXEC SQL                                                     33560076
335700         INSERT INTO SUT_FINCL_ADJ                                33570076
335800         (                                                        33580076
335900            FINCL_ADJ_ID                                          33590076
336000*        ,  PROB_RSN_CDE                                          33600076
336100         ,  ADJ_ERR_CDE                                           33610076
336200         ,  PO_NBR                                                33620076
336300         ,  RCVR_LNE_NBR                                          33630076
336400         ,  RCVR_SEQ_NBR                                          33640076
336500         ,  DEST_LOC_NBR                                          33650076
336600         ,  CRE_TMST                                              33660076
336700         ,  UPC_NBR                                               33670076
336800         ,  SHIPT_UNT_ID                                          33680076
336900         ,  PRC_RSN_CDE                                           33690076
337000         ,  AUD_CNTL_NBR                                          33700076
337100         ,  ORGN_LOC_NBR                                          33710076
337200         ,  AUD_ADJ_STAT_CDE                                      33720076
337300         ,  AUTO_APL_IND                                          33730076
337400         ,  CRE_BY_USR_ID                                         33740076
337500         ,  CRE_PGM_NM                                            33750076
337600         ,  FINCL_BEF_QTY                                         33760076
337700         ,  FINCL_AFT_QTY                                         33770076
337800         ,  RSLV_BY_USR_ID                                        33780076
337900         ,  RSLV_TMST                                             33790076
338000         ,  ADJ_QTY                                               33800076
338100         ,  RSLV_CMNT_TXT                                         33810076
338200         )                                                        33820076
338300         VALUES                                                   33830076
338400         (                                                        33840076
338500            :SUT00030-FINCL-ADJ-ID                                33850076
338600*        ,  :SUT00030-PROB-RSN-CDE                                33860076
338700         ,  :SUT00030-ADJ-ERR-CDE                                 33870076
338800         ,  :SUT00030-PO-NBR                                      33880076
338900         ,  :SUT00030-RCVR-LNE-NBR                                33890076
339000         ,  :SUT00030-RCVR-SEQ-NBR                                33900076
339100         ,  :SUT00030-DEST-LOC-NBR                                33910076
339200         ,  :SUT00030-CRE-TMST                                    33920076
339300         ,  :SUT00030-UPC-NBR                                     33930076
339400         ,  :SUT00030-SHIPT-UNT-ID                                33940076
339500         ,  :SUT00030-PRC-RSN-CDE                                 33950076
339600         ,  :SUT00030-AUD-CNTL-NBR                                33960076
339700         ,  :SUT00030-ORGN-LOC-NBR                                33970076
339800         ,  :SUT00030-AUD-ADJ-STAT-CDE                            33980076
339900         ,  :SUT00030-AUTO-APL-IND                                33990076
340000         ,  :SUT00030-CRE-BY-USR-ID                               34000076
340100         ,  :SUT00030-CRE-PGM-NM                                  34010076
340200         ,  :SUT00030-FINCL-BEF-QTY                               34020076
340300         ,  :SUT00030-FINCL-AFT-QTY                               34030076
340400         ,  :SUT00030-RSLV-BY-USR-ID                              34040076
340500         ,  :SUT00030-RSLV-TMST                                   34050076
340600         ,  :SUT00030-ADJ-QTY                                     34060076
340700         ,  :SUT00030-RSLV-CMNT-TXT                               34070076
340800         )                                                        34080076
340900     END-EXEC.                                                    34090076
341000                                                                  34100076
341100     EVALUATE TRUE                                                34110076
341200         WHEN SQLCODE = +0                                        34120076
341300         WHEN SQLCODE = -904                                      34130076
341400         WHEN SQLCODE = -913                                      34140076
341500             CONTINUE                                             34150076
341600         WHEN SQLWARN0 NOT = SPACES                               34160076
341700         WHEN SQLCODE < +0                                        34170076
341800         WHEN SQLCODE > +0                                        34180076
341900             SET PS-ERROR                                         34190076
342000                 SU034-INVALID-SQL    TO TRUE                     34200076
342100             MOVE SUT00030-FINCL-ADJ-ID                           34210076
342200                                      TO PV-DISP-FINCL-ADJ-ID     34220076
342300             MOVE SUT00030-SHIPT-UNT-ID                           34230076
342400                                      TO PV-DISP-SHIPT-UNT-ID     34240076
342500             MOVE SUT00030-AUD-CNTL-NBR                           34250076
342600                                      TO PV-DISPLAY-AUDIT-CNTL-NBR34260076
342700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       34270076
342800             STRING   ' SUKUT701-4000-'                           34280076
342900                      ' CALLED BY-'                               34290076
343000                      SU034-PROGRAM-NAME                          34300076
343100                      '  SQLCODE='                                34310076
343200                      PV-DISPLAY-SQLCODE                          34320076
343300                      ' ADJ-ID ='                                 34330076
343400                      PV-DISP-FINCL-ADJ-ID                        34340076
343500                      ' '                                         34350076
343600                      SUT00030-PRC-RSN-CDE                        34360076
343700                      ' '                                         34370076
343800                      PV-DISPLAY-AUDIT-CNTL-NBR                   34380076
343900                      ' '                                         34390076
344000                      PV-DISP-SHIPT-UNT-ID                        34400076
344100                      DELIMITED BY SIZE                           34410076
344200                                      INTO SU034-CRA-RET-MSG      34420076
344300             PERFORM 9999-WRITE-TO-CSSL                           34430076
344400             MOVE '4000-'                TO SU034-CRA-REQ-ID      34440076
344500             PERFORM 9998-RETURN                                  34450076
344600     END-EVALUATE.                                                34460076
344700                                                                  34470076
344800 4100-SELECT-REC-SEQ.                                             34480076
344900                                                                  34490076
345000     EXEC SQL                                                     34500076
345100         SELECT   B.REC_SEQ_NBR                                   34510076
345200         INTO    :PKSLIP-REC-SEQ-NBR                              34520076
345300         FROM TINPKSU A                                           34530076
345400            , TPKSLIP B                                           34540076
345500         WHERE A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                34550076
345600           AND A.PO_NBR         = B.PO_NBR                        34560076
345700           AND A.SEQ_NBR        = B.SEQ_NBR                       34570076
345800           AND B.VER_STAT_CDE   = 'A'                             34580076
345900     END-EXEC.                                                    34590076
346000                                                                  34600076
346100     EVALUATE TRUE                                                34610076
346200         WHEN SQLCODE = ZERO                                      34620076
346300             IF PKSLIP-REC-SEQ-NBR = 0                            34630076
346400                 SET PS-NO-RECEIVER-FOUND  TO TRUE                34640076
346500                 MOVE ZERO               TO PV-RCVR-SEQ-NBR       34650076
346600                                            DK-RCVR-SEQ-NBR       34660076
346700             ELSE                                                 34670076
346800                 MOVE PKSLIP-REC-SEQ-NBR TO PV-RCVR-SEQ-NBR       34680076
346900                                            DK-RCVR-SEQ-NBR       34690076
347000             END-IF                                               34700076
347100                                                                  34710076
347200         WHEN SQLCODE = +100                                      34720076
347300             SET PS-NO-RECEIVER-FOUND  TO TRUE                    34730076
347400         WHEN SQLWARN0 NOT = SPACES                               34740076
347500         WHEN SQLCODE < ZERO                                      34750076
347600         WHEN SQLCODE > ZERO                                      34760076
347700             SET PS-ERROR                                         34770076
347800                 SU034-INVALID-SQL    TO TRUE                     34780076
347900             MOVE DK-OTBND-SHIPT-UNT-ID                           34790076
348000                                      TO PV-DISP-SHIPT-UNT-ID     34800076
348100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       34810076
348200             STRING   ' SUKUT701-4100-'                           34820076
348300                      ' CALLED BY-'                               34830076
348400                      SU034-PROGRAM-NAME                          34840076
348500                      '  SQLCODE='                                34850076
348600                      PV-DISPLAY-SQLCODE                          34860076
348700                      ' '                                         34870076
348800                      PV-DISP-SHIPT-UNT-ID                        34880076
348900                      DELIMITED BY SIZE                           34890076
349000                                      INTO SU034-CRA-RET-MSG      34900076
349100             PERFORM 9999-WRITE-TO-CSSL                           34910076
349200             MOVE '4100-'                TO SU034-CRA-REQ-ID      34920076
349300             SET SU034-INVALID-SQL TO TRUE                        34930076
349400             PERFORM 9998-RETURN                                  34940076
349500     END-EVALUATE.                                                34950076
349600                                                                  34960076
349700                                                                  34970076
349800 4200-GET-SCN-QTY.                                                34980076
349900                                                                  34990076
350000     MOVE SU034-ADJ-AUDIT-CNTL-NBR TO DK-AUDIT-CNTL-NBR.          35000076
350100     MOVE SU034-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID.                 35010076
350200                                                                  35020076
350300     EXEC SQL                                                     35030076
350400          SELECT SUM(SCND_UNT_QTY)                                35040076
350500            INTO :PV-SCN-QTY                                      35050076
350600            FROM TSUAUPC                                          35060076
350700            WHERE AUD_CNTL_NBR = :DK-AUDIT-CNTL-NBR               35070076
350800              AND SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 35080076
350900              AND SCN_TYP_CDE <> 'E'                              35090076
351000     END-EXEC.                                                    35100076
351100                                                                  35110076
351200*IF THE ASSOCIATE GOES TO THE CARTON CLOSE WITHOUT SCANNING A UPC 35120076
351300*THE SQLCODE WILL BE -305                                         35130076
351400                                                                  35140076
351500     EVALUATE TRUE                                                35150076
351600        WHEN SQLCODE = ZERO                                       35160076
351700           CONTINUE                                               35170076
351800        WHEN SQLCODE = -305                                       35180076
351900        WHEN SQLCODE = +100                                       35190076
352000           MOVE ZEROES           TO PV-SCN-QTY                    35200076
352100        WHEN OTHER                                                35210076
352200             SET PS-ERROR                                         35220076
352300                 SU034-INVALID-SQL    TO TRUE                     35230076
352400             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     35240076
352500             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR35250076
352600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       35260076
352700             STRING   ' SUKUT701-4200-'                           35270076
352800                      ' CALLED BY-'                               35280076
352900                      SU034-PROGRAM-NAME                          35290076
353000                      '  SQLCODE='                                35300076
353100                      PV-DISPLAY-SQLCODE                          35310076
353200                      ' '                                         35320076
353300                      PV-DISP-SHIPT-UNT-ID                        35330076
353400                      ' '                                         35340076
353500                      PV-DISPLAY-AUDIT-CNTL-NBR                   35350076
353600                      DELIMITED BY SIZE                           35360076
353700                                      INTO SU034-CRA-RET-MSG      35370076
353800             PERFORM 9999-WRITE-TO-CSSL                           35380076
353900             MOVE '4200-'                TO SU034-CRA-REQ-ID      35390076
354000             SET SU034-INVALID-SQL TO TRUE                        35400076
354100             PERFORM 9998-RETURN                                  35410076
354200     END-EVALUATE.                                                35420076
354300*                                                                 35430076
354400 4300-CREATE-TROUBLE.                                             35440076
354500                                                                  35450076
354600     INITIALIZE TM500-FIELDS.                                     35460076
354700     SET TM500-ADD-DETAILS                                        35470076
354800         TM500-CREATE-MANUAL       TO  TRUE.                      35480076
354900                                                                  35490076
355000     MOVE 0                        TO  TM500-NOTIF-NBR.           35500076
355100     MOVE SU034-OPER-UNT-ID        TO  TM500-OPER-UNT-ID.         35510076
355200     MOVE 1                        TO  TM500-FCLTY-ID.            35520076
355300                                                                  35530076
355400     MOVE SUATRN-TRN-NBR           TO  TM500-PO-NBR.              35540076
355500                                                                  35550076
355600     SET TM500-LINE-LEVEL          TO  TRUE.                      35560076
355700     MOVE DK-TRN-LNE-NBR           TO  TM500-PO-LNE-NBR.          35570076
355800                                                                  35580076
355900     MOVE SUATRN-REC-SEQ-NBR       TO  TM500-REC-SEQ-NBR.         35590076
356000     MOVE 371                      TO  TM500-TRBL-RSN-CDE.        35600076
356100                                                                  35610076
356200     MOVE SU034-USER-ID            TO  TM500-CRE-UID              35620076
356300                                       TM500-NOTIF-UID.           35630076
356400                                                                  35640076
356500     MOVE PV-FINCL-ADJ-ID       TO PV-DISP-FINCL-ADJ-ID.          35650076
356600     STRING 'THERE IS AT LEAST ONE FAILED STORE UNIT '            35660076
356700          'ADJUSTMENT' DELIMITED BY SIZE                          35670076
356800            INTO TM500-FREEFORM-TEXT.                             35680076
356900                                                                  35690076
357000     PERFORM 8200-LINK-TO-UPDATE.                                 35700076
357100     IF TM500-CALL-SUCCESSFUL                                     35710076
357200      OR TM500-DUPLICATE-TROUBLE                                  35720076
357300***      TM500-TTRBNTF-UPDATE-NOT-FND OR                          35730076
357400***      TM500-DIDNT-ALLOC-DUE-TO-TRBL                            35740076
357500             CONTINUE                                             35750076
357600     ELSE                                                         35760076
357700         SET PS-ERROR                                             35770076
357800             SU034-INVALID-SQL    TO TRUE                         35780076
357900         MOVE SUATRN-TRN-NBR      TO PV-DISP-TRN-NBR              35790076
358000         MOVE SUATRN-REC-SEQ-NBR  TO PV-DISP-RCVR-SEQ-NBR         35800076
358100         MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR          35810076
358200         STRING   ' SUKUT701-4300-'                               35820076
358300                  ' CALLED BY-'                                   35830076
358400                  SU034-PROGRAM-NAME                              35840076
358500                  ' RET CODE='                                    35850076
358600                  TM500-RETURN-CODE                               35860076
358700                  ' PO='                                          35870076
358800                  PV-DISP-TRN-NBR                                 35880076
358900                  ' RCV='                                         35890076
359000                  PV-DISP-RCVR-SEQ-NBR                            35900076
359100                  ' LNE='                                         35910076
359200                  PV-DISP-TRN-LNE-NBR                             35920076
359300                  DELIMITED BY SIZE                               35930076
359400                                  INTO SU034-CRA-RET-MSG          35940076
359500         PERFORM 9999-WRITE-TO-CSSL                               35950076
359600         MOVE '4300-'                TO SU034-CRA-REQ-ID          35960076
359700         PERFORM 9998-RETURN                                      35970076
359800     END-IF.                                                      35980076
359900                                                                  35990076
360000 4400-SELECT-TSUNAUD-DATE.                                        36000076
360100                                                                  36010076
360200     EXEC SQL                                                     36020076
360300         SELECT  AUD_STRT_TMST                                    36030076
360400            ,    AUD_TYP_CDE                                      36040076
360500           INTO  :SUNAUD-AUD-STRT-TMST                            36050076
360600            ,    :SUNAUD-AUD-TYP-CDE                              36060076
360700           FROM  TSUNAUD                                          36070076
360800          WHERE  AUD_CNTL_NBR      =  :DK-AUDIT-CNTL-NBR          36080076
360900     END-EXEC.                                                    36090076
361000                                                                  36100076
361100     EVALUATE TRUE                                                36110076
361200        WHEN SQLCODE = ZERO                                       36120076
361300           CONTINUE                                               36130076
361400        WHEN OTHER                                                36140076
361500             SET PS-ERROR                                         36150076
361600                 SU034-INVALID-SQL    TO TRUE                     36160076
361700             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR36170076
361800             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       36180076
361900             STRING   ' SUKUT701-4400-'                           36190076
362000                      ' CALLED BY-'                               36200076
362100                      SU034-PROGRAM-NAME                          36210076
362200                      '  SQLCODE='                                36220076
362300                      PV-DISPLAY-SQLCODE                          36230076
362400                      ' '                                         36240076
362500                      PV-DISPLAY-AUDIT-CNTL-NBR                   36250076
362600                      DELIMITED BY SIZE                           36260076
362700                                      INTO SU034-CRA-RET-MSG      36270076
362800             PERFORM 9999-WRITE-TO-CSSL                           36280076
362900             MOVE '4400-'                TO SU034-CRA-REQ-ID      36290076
363000             SET SU034-INVALID-SQL TO TRUE                        36300076
363100             PERFORM 9998-RETURN                                  36310076
363200     END-EVALUATE.                                                36320076
363300                                                                  36330076
363400 4500-GET-DEPT.                                                   36340076
363500                                                                  36350076
363600     EXEC SQL                                                     36360076
363700         SELECT DEPT_NBR                                          36370076
363800           INTO :PURCHS-DEPT-NBR                                  36380076
363900           FROM TPURCHS                                           36390076
364000          WHERE PO_NBR         =  :SUATRN-TRN-NBR                 36400076
364100            AND VER_STATUS_CDE =  'A'                             36410076
364200     END-EXEC                                                     36420076
364300                                                                  36430076
364400     EVALUATE TRUE                                                36440076
364500        WHEN SQLCODE = ZERO                                       36450076
364600           MOVE PURCHS-DEPT-NBR    TO PV-DEPT-NUMBER-X            36460076
364700        WHEN OTHER                                                36470076
364800             SET PS-ERROR                                         36480076
364900                 SU034-INVALID-SQL    TO TRUE                     36490076
365000             MOVE SUATRN-TRN-NBR      TO PV-DISP-TRN-NBR          36500076
365100             MOVE SUATRN-REC-SEQ-NBR  TO PV-DISP-RCVR-SEQ-NBR     36510076
365200             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-TRN-LNE-NBR      36520076
365300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       36530076
365400             STRING   ' SUKUT701-4500-'                           36540076
365500                      ' CALLED BY-'                               36550076
365600                      SU034-PROGRAM-NAME                          36560076
365700                      '  SQLCODE='                                36570076
365800                      PV-DISPLAY-SQLCODE                          36580076
365900                      ' '                                         36590076
366000                      PV-DISP-TRN-NBR                             36600076
366100                      ' '                                         36610076
366200                      PV-DISP-RCVR-SEQ-NBR                        36620076
366300                      ' '                                         36630076
366400                      PV-DISP-TRN-LNE-NBR                         36640076
366500                      DELIMITED BY SIZE                           36650076
366600                                      INTO SU034-CRA-RET-MSG      36660076
366700             PERFORM 9999-WRITE-TO-CSSL                           36670076
366800             MOVE '4500-'                TO SU034-CRA-REQ-ID      36680076
366900             SET SU034-INVALID-SQL TO TRUE                        36690076
367000             PERFORM 9998-RETURN                                  36700076
367100     END-EVALUATE.                                                36710076
367200                                                                  36720076
367300 4600-CHECK-IF-SYSTEM-GEN.                                        36730076
367400                                                                  36740076
367500     EXEC SQL                                                     36750076
367600       SELECT AUD_CNTL_NBR                                        36760076
367700       INTO   :SUT00015-AUD-CNTL-NBR                              36770076
367800       FROM   SUT_PO_AUD_REQ                                      36780076
367900       WHERE  AUD_CNTL_NBR    =  :DK-AUDIT-CNTL-NBR               36790076
368000     END-EXEC.                                                    36800076
368100                                                                  36810076
368200     EVALUATE TRUE                                                36820076
368300         WHEN SQLCODE = ZERO                                      36830076
368400             SET PS-SYSTEM-AUDIT-FOUND TO TRUE                    36840076
368500                                                                  36850076
368600         WHEN SQLCODE = +100                                      36860076
368700             SET PS-SYSTEM-AUDIT-NOT-FOUND TO TRUE                36870076
368800                                                                  36880076
368900         WHEN OTHER                                               36890076
369000             SET PS-ERROR                                         36900076
369100                 SU034-INVALID-SQL    TO TRUE                     36910076
369200             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR36920076
369300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       36930076
369400             STRING   ' SUKUT701-4600-'                           36940076
369500                      ' CALLED BY-'                               36950076
369600                      SU034-PROGRAM-NAME                          36960076
369700                      '  SQLCODE='                                36970076
369800                      PV-DISPLAY-SQLCODE                          36980076
369900                      ' '                                         36990076
370000                      PV-DISPLAY-AUDIT-CNTL-NBR                   37000076
370100                      DELIMITED BY SIZE                           37010076
370200                                      INTO SU034-CRA-RET-MSG      37020076
370300             PERFORM 9999-WRITE-TO-CSSL                           37030076
370400             MOVE '4600-'                TO SU034-CRA-REQ-ID      37040076
370500             SET SU034-INVALID-SQL TO TRUE                        37050076
370600             PERFORM 9998-RETURN                                  37060076
370700     END-EVALUATE.                                                37070076
370800 4700-BACK-OUT-UPDATES.                                           37080076
370900      IF PS-OTBND-UPC-UPDATED                                     37090076
371000          IF PV-SAVE-INSERT-UPDATE-IND = 'UPDATE'                 37100076
371100              PERFORM 4800-UPDATE-OTBND-UPC                       37110076
371200          ELSE                                                    37120076
371300              PERFORM 4900-DELETE-OTBND-UPC                       37130076
371400          END-IF                                                  37140076
371500      END-IF.                                                     37150076
371600      MOVE PV-SAVE-BEFORE-QTY  TO SUQADJ-ADJ-AFT-QTY.             37160076
371700      MOVE PV-SAVE-AFTER-QTY   TO SUQADJ-ADJ-BEF-QTY.             37170076
371800      MOVE 'SYS REVS'          TO SUQADJ-ADJ-USR-ID.              37180076
371900      MOVE SU034-ADJ-AUDIT-CNTL-NBR                               37190076
372000                               TO SUQADJ-AUD-CNTL-NBR.            37200076
372100      PERFORM 2700-INSERT-TSUQADJ.                                37210076
372200                                                                  37220076
372300 4800-UPDATE-OTBND-UPC.                                           37230076
372400                                                                  37240076
372500     MOVE PV-SAVE-SHIPT-UNT-ID            TO DK-OTBND-SHIPT-UNT-ID37250076
372600     MOVE PV-SAVE-TRN-NBR                 TO DK-TRN-NBR.          37260076
372700     MOVE PV-SAVE-RCVR-SEQ-NBR            TO DK-RCVR-SEQ-NBR.     37270076
372800     MOVE PV-SAVE-TRN-LNE-NBR             TO DK-TRN-LNE-NBR.      37280076
372900     MOVE PV-SAVE-TRN-TYP-CDE             TO DK-TRN-TYP-CDE.      37290076
373000     MOVE PV-SAVE-UPC                     TO DK-UPC-NBR.          37300076
373100     MOVE PV-SAVE-BEFORE-QTY              TO PV-UPDATE-QTY.       37310076
373200                                                                  37320076
373300     EXEC SQL                                                     37330076
373400         UPDATE SUT_OTBND_UPC                                     37340076
373500             SET SHPD_UNT_QTY      = :PV-UPDATE-QTY               37350076
373600         WHERE  SHIPT_UNT_ID       = :DK-OTBND-SHIPT-UNT-ID       37360076
373700           AND  TRN_NBR            = :DK-TRN-NBR                  37370076
373800           AND  RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR             37380076
373900           AND  TRN_LNE_NBR        = :DK-TRN-LNE-NBR              37390076
374000           AND  TRN_TYP_CDE        = :DK-TRN-TYP-CDE              37400076
374100           AND  UPC_NBR            = :DK-UPC-NBR                  37410076
374200     END-EXEC.                                                    37420076
374300                                                                  37430076
374400     EVALUATE TRUE                                                37440076
374500         WHEN SQLCODE = ZERO                                      37450076
374600             CONTINUE                                             37460076
374700         WHEN SQLWARN0 NOT = SPACES                               37470076
374800         WHEN SQLCODE < ZERO                                      37480076
374900         WHEN SQLCODE > ZERO                                      37490076
375000             SET PS-ERROR                                         37500076
375100                 SU034-INVALID-SQL    TO TRUE                     37510076
375200             MOVE DK-OTBND-SHIPT-UNT-ID                           37520076
375300                                      TO PV-DISP-SHIPT-UNT-ID     37530076
375400             MOVE DK-TRN-NBR          TO PV-DISP-TRN-NBR          37540076
375500             MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     37550076
375600             MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR      37560076
375700             MOVE DK-TRN-TYP-CDE      TO PV-DISP-TRN-TYP-CDE      37570076
375800             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          37580076
375900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       37590076
376000             STRING   ' SUKUT701-4800-'                           37600076
376100                      ' CALLED BY-'                               37610076
376200                      ' TRN TYP='                                 37620076
376300                      PV-DISP-TRN-TYP-CDE                         37630076
376400                      ' UPC='                                     37640076
376500                      PV-DISP-UPC-NBR                             37650076
376600                      DELIMITED BY SIZE                           37660076
376700                                      INTO SU034-CRA-RET-MSG      37670076
376800             PERFORM 9999-WRITE-TO-CSSL                           37680076
376900             STRING   ' SUKUT701-4800-'                           37690076
377000                      ' CALLED BY-'                               37700076
377100                      SU034-PROGRAM-NAME                          37710076
377200                      '  SQLCODE='                                37720076
377300                      PV-DISPLAY-SQLCODE                          37730076
377400                      ' '                                         37740076
377500                      PV-DISP-SHIPT-UNT-ID                        37750076
377600                      ' '                                         37760076
377700                      PV-DISP-TRN-NBR                             37770076
377800                      ' '                                         37780076
377900                      PV-DISP-RCVR-SEQ-NBR                        37790076
378000                      ' '                                         37800076
378100                      PV-DISP-TRN-LNE-NBR                         37810076
378200                      DELIMITED BY SIZE                           37820076
378300                                      INTO SU034-CRA-RET-MSG      37830076
378400             PERFORM 9999-WRITE-TO-CSSL                           37840076
378500             MOVE '4800-'                TO SU034-CRA-REQ-ID      37850076
378600             SET SU034-INVALID-SQL TO TRUE                        37860076
378700             PERFORM 9998-RETURN                                  37870076
378800     END-EVALUATE.                                                37880076
378900                                                                  37890076
379000 4900-DELETE-OTBND-UPC.                                           37900076
379100                                                                  37910076
379200     MOVE PV-SAVE-SHIPT-UNT-ID            TO DK-OTBND-SHIPT-UNT-ID37920076
379300     MOVE PV-SAVE-TRN-NBR                 TO DK-TRN-NBR.          37930076
379400     MOVE PV-SAVE-RCVR-SEQ-NBR            TO DK-RCVR-SEQ-NBR.     37940076
379500     MOVE PV-SAVE-TRN-LNE-NBR             TO DK-TRN-LNE-NBR.      37950076
379600     MOVE PV-SAVE-TRN-TYP-CDE             TO DK-TRN-TYP-CDE.      37960076
379700     MOVE PV-SAVE-UPC                     TO DK-UPC-NBR.          37970076
379800                                                                  37980076
379900     EXEC SQL                                                     37990076
380000         DELETE                                                   38000076
380100         FROM SUT_OTBND_UPC                                       38010076
380200         WHERE  SHIPT_UNT_ID       = :DK-OTBND-SHIPT-UNT-ID       38020076
380300           AND  TRN_NBR            = :DK-TRN-NBR                  38030076
380400           AND  RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR             38040076
380500           AND  TRN_LNE_NBR        = :DK-TRN-LNE-NBR              38050076
380600           AND  TRN_TYP_CDE        = :DK-TRN-TYP-CDE              38060076
380700           AND  UPC_NBR            = :DK-UPC-NBR                  38070076
380800     END-EXEC.                                                    38080076
380900                                                                  38090076
381000     EVALUATE TRUE                                                38100076
381100         WHEN SQLCODE = ZERO                                      38110076
381200         WHEN SQLCODE = +100                                      38120076
381300             CONTINUE                                             38130076
381400         WHEN SQLWARN0 NOT = SPACES                               38140076
381500         WHEN SQLCODE < ZERO                                      38150076
381600         WHEN SQLCODE > ZERO                                      38160076
381700             SET PS-ERROR                                         38170076
381800                 SU034-INVALID-SQL    TO TRUE                     38180076
381900             MOVE DK-OTBND-SHIPT-UNT-ID                           38190076
382000                                      TO PV-DISP-SHIPT-UNT-ID     38200076
382100             MOVE DK-TRN-NBR          TO PV-DISP-TRN-NBR          38210076
382200             MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     38220076
382300             MOVE DK-TRN-LNE-NBR      TO PV-DISP-TRN-LNE-NBR      38230076
382400             MOVE DK-TRN-TYP-CDE      TO PV-DISP-TRN-TYP-CDE      38240076
382500             MOVE DK-UPC-NBR          TO PV-DISP-UPC-NBR          38250076
382600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       38260076
382700             STRING   ' SUKUT701-4900-'                           38270076
382800                      ' CALLED BY-'                               38280076
382900                      ' TRN TYP='                                 38290076
383000                      PV-DISP-TRN-TYP-CDE                         38300076
383100                      ' UPC='                                     38310076
383200                      PV-DISP-UPC-NBR                             38320076
383300                      DELIMITED BY SIZE                           38330076
383400                                      INTO SU034-CRA-RET-MSG      38340076
383500             PERFORM 9999-WRITE-TO-CSSL                           38350076
383600             STRING   ' SUKUT701-4900-'                           38360076
383700                      ' CALLED BY-'                               38370076
383800                      SU034-PROGRAM-NAME                          38380076
383900                      '  SQLCODE='                                38390076
384000                      PV-DISPLAY-SQLCODE                          38400076
384100                      ' '                                         38410076
384200                      PV-DISP-SHIPT-UNT-ID                        38420076
384300                      ' '                                         38430076
384400                      PV-DISP-TRN-NBR                             38440076
384500                      ' '                                         38450076
384600                      PV-DISP-RCVR-SEQ-NBR                        38460076
384700                      ' '                                         38470076
384800                      PV-DISP-TRN-LNE-NBR                         38480076
384900                      DELIMITED BY SIZE                           38490076
385000                                      INTO SU034-CRA-RET-MSG      38500076
385100             PERFORM 9999-WRITE-TO-CSSL                           38510076
385200             MOVE '4900-'                TO SU034-CRA-REQ-ID      38520076
385300             SET SU034-INVALID-SQL TO TRUE                        38530076
385400             PERFORM 9998-RETURN                                  38540076
385500     END-EVALUATE.                                                38550076
385600*                                                                 38560076
385700 5000-PROCESS-PREPACKS.                                           38570076
385800                                                                  38580076
385900     MOVE 0            TO PV-SAVE-LAST-IDX.                       38590076
386000     PERFORM 5250-SELECT-EXPECTED-LINE.                           38600076
386100     IF DK-SHUUPC-TRN-LNE-NBR > 0                                 38610076
386200         MOVE DK-SHUUPC-TRN-LNE-NBR TO DK-LNE-NBR                 38620076
386300         PERFORM 5500-SELECT-PACK-ID                              38630076
386400         SET PS-EXPECTED-IN-CARTON  TO TRUE                       38640076
386500         PERFORM 6100-OPEN-PACK-CURSOR                            38650076
386600         PERFORM 6200-PROCESS-PACK-CURSOR                         38660076
386700         PERFORM 6400-CLOSE-PACK-CURSOR                           38670076
386800         SET PS-NOT-EXPT-IN-CARTON  TO TRUE                       38680076
386900     END-IF.                                                      38690076
387000     PERFORM 5100-OPEN-CARTON-LINE-CURSOR.                        38700076
387100     PERFORM 5200-PROCESS-CARTON-CURSOR                           38710076
387200         UNTIL PS-EOC-CARTON-ITEM-CURSOR.                         38720076
387300     PERFORM 5400-CLOSE-CARTON-LINE-CURSOR.                       38730076
387400                                                                  38740076
387500     PERFORM 1200-OPEN-AUDIT-ITEM-CURSOR.                         38750076
387600     PERFORM 5600-PROCESS-AUDIT-CURSOR                            38760076
387700         UNTIL PS-EOC-AUDIT-ITEM-CURSOR.                          38770076
387800     PERFORM 1260-CLOSE-AUDIT-ITEM-CURSOR.                        38780076
387900***  SET PV-SAVE-LINE-IDX TO 1 TO START THE PROCESSING.  THIS     38790076
388000***  WILL INCREMENT AFTER EVERY GROUP OF LINES FOR A PACK AS      38800076
388100***  THEY ARE PROCESSED.                                          38810076
388200     MOVE 1 TO PV-SAVE-LINE-IDX.                                  38820076
388300                                                                  38830076
388400     SET PS-DONT-UPDATE-NBR-PACKS   TO TRUE.                      38840076
388500     SET PS-NO-ODD-UNITS-ADDED      TO TRUE.                      38850076
388600     SET PS-NO-ODD-UNITS-EXIST      TO TRUE.                      38860076
388700     SET PS-NO-ODD-UNITS-PROCESSED  TO TRUE.                      38870076
388800     PERFORM 5700-CALL-BEST-CASE-RTN                              38880076
388900         UNTIL PACK-IND (PV-SAVE-LINE-IDX) NOT = 'Y'              38890076
389000            OR PV-SAVE-LINE-IDX > 500.                            38900076
389100                                                                  38910076
389200 5100-OPEN-CARTON-LINE-CURSOR.                                    38920076
389300                                                                  38930076
389400     EXEC SQL                                                     38940076
389500         OPEN CARTON_LINE_CURSOR                                  38950076
389600     END-EXEC.                                                    38960076
389700                                                                  38970076
389800     EVALUATE TRUE                                                38980076
389900         WHEN SQLCODE = ZERO                                      38990076
390000             SET PS-NOT-EOC-CARTON-ITEM-CURSOR                    39000076
390100                 PS-NO-OVER-SHORT-ERROR       TO TRUE             39010076
390200                                                                  39020076
390300         WHEN SQLWARN0 NOT = SPACES                               39030076
390400         WHEN SQLCODE < ZERO                                      39040076
390500         WHEN SQLCODE > ZERO                                      39050076
390600             SET PS-ERROR                                         39060076
390700                 SU034-INVALID-SQL    TO TRUE                     39070076
390800             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     39080076
390900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       39090076
391000             STRING   ' SUKUT701-5100-'                           39100076
391100                      ' CALLED BY-'                               39110076
391200                      SU034-PROGRAM-NAME                          39120076
391300                      '  SQLCODE='                                39130076
391400                      PV-DISPLAY-SQLCODE                          39140076
391500                      ' '                                         39150076
391600                      PV-DISP-SHIPT-UNT-ID                        39160076
391700                      DELIMITED BY SIZE                           39170076
391800                                      INTO SU034-CRA-RET-MSG      39180076
391900             PERFORM 9999-WRITE-TO-CSSL                           39190076
392000             MOVE '5100-'                TO SU034-CRA-REQ-ID      39200076
392100             SET SU034-INVALID-SQL TO TRUE                        39210076
392200             PERFORM 9998-RETURN                                  39220076
392300     END-EVALUATE.                                                39230076
392400                                                                  39240076
392500 5200-PROCESS-CARTON-CURSOR.                                      39250076
392600     PERFORM 5300-FETCH-CARTON-LINE-CURSOR.                       39260076
392700     IF PS-NOT-EOC-CARTON-ITEM-CURSOR                             39270076
392800         MOVE PV-CARTON-LINE-NBR   TO DK-LNE-NBR                  39280076
392900         PERFORM 5500-SELECT-PACK-ID                              39290076
393000         MOVE PV-CARTON-INTR-UPC  TO DK-INTR-UPC                  39300076
393100         IF PV-CARTON-REC-TYPE = 'B'                              39310076
393200             MOVE PV-CARTON-HOLD-UPC-NBR                          39320076
393300                                 TO DK-UPC-NBR                    39330076
393400             PERFORM 3800-GET-ITM-NBR                             39340076
393500             COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1      39350076
393600             SET LINE-IDX TO PV-SAVE-LAST-IDX                     39360076
393700             MOVE 'Y'              TO PACK-IND (LINE-IDX)         39370076
393800             MOVE XL001-ITM-NBR    TO PACK-ITM (LINE-IDX)         39380076
393900             MOVE 999999999        TO PACK-LINE (LINE-IDX)        39390076
394000             MOVE PV-CARTON-ITEM-COUNT                            39400076
394100                               TO PACK-CRTN-QTY (LINE-IDX)        39410076
394200             MOVE PV-CARTON-REC-TYPE                              39420076
394300                               TO PACK-CRTN-REC-TYPE (LINE-IDX)   39430076
394400             MOVE PV-CARTON-INTR-UPC                              39440076
394500                               TO PACK-CRTN-INTR-UPC (LINE-IDX)   39450076
394600             MOVE PV-CARTON-HOLD-UPC-NBR                          39460076
394700                               TO PACK-CRTN-HOLD-UPC (LINE-IDX)   39470076
394800         ELSE                                                     39480076
394900             PERFORM 3850-GET-ITM-NBR                             39490076
395000             SET PS-NO-PACK-MATCH-FOUND TO TRUE                   39500076
395100             IF RECITM-PREPK-ID > 0                               39510076
395200                 PERFORM VARYING LINE-IDX FROM 1 BY 1             39520076
395300                     UNTIL PACK-LINE (LINE-IDX) = 0               39530076
395400                     OR PS-PACK-MATCH-FOUND                       39540076
395500                     OR LINE-IDX > 500                            39550076
395600                    IF RECITM-PREPK-ID = PACK-PRPPK-ID (LINE-IDX) 39560076
395700                        SET PS-PACK-MATCH-FOUND TO TRUE           39570076
395800                    END-IF                                        39580076
395900                 END-PERFORM                                      39590076
396000                 IF PS-NO-PACK-MATCH-FOUND                        39600076
396100                     PERFORM 6100-OPEN-PACK-CURSOR                39610076
396200                     PERFORM 6200-PROCESS-PACK-CURSOR             39620076
396300                     PERFORM 6400-CLOSE-PACK-CURSOR               39630076
396400                 END-IF                                           39640076
396500             END-IF                                               39650076
396600             SET PS-NO-UPC-MATCH-FOUND TO TRUE                    39660076
396700             PERFORM VARYING LINE-IDX FROM 1 BY 1                 39670076
396800                 UNTIL PACK-LINE (LINE-IDX) = 0                   39680076
396900                 OR PS-UPC-MATCH-FOUND                            39690076
397000                 OR LINE-IDX > 500                                39700076
397100                 IF PV-CARTON-LINE-NBR = PACK-LINE (LINE-IDX)     39710076
397200                     MOVE PV-CARTON-ITEM-COUNT                    39720076
397300                               TO PACK-CRTN-QTY (LINE-IDX)        39730076
397400                     MOVE PV-CARTON-REC-TYPE                      39740076
397500                               TO PACK-CRTN-REC-TYPE (LINE-IDX)   39750076
397600                     MOVE PV-CARTON-INTR-UPC                      39760076
397700                               TO PACK-CRTN-INTR-UPC (LINE-IDX)   39770076
397800                     MOVE PV-CARTON-HOLD-UPC-NBR                  39780076
397900                               TO PACK-CRTN-HOLD-UPC (LINE-IDX)   39790076
398000                     SET PS-UPC-MATCH-FOUND TO TRUE               39800076
398100                 END-IF                                           39810076
398200             END-PERFORM                                          39820076
398300             IF PS-NO-UPC-MATCH-FOUND                             39830076
398400                 COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1  39840076
398500                 SET LINE-IDX TO PV-SAVE-LAST-IDX                 39850076
398600                 MOVE 'Y'              TO PACK-IND (LINE-IDX)     39860076
398700                 MOVE XL001-ITM-NBR    TO PACK-ITM (LINE-IDX)     39870076
398800                 MOVE 999999999        TO PACK-LINE (LINE-IDX)    39880076
398900                 MOVE PV-CARTON-ITEM-COUNT                        39890076
399000                               TO PACK-CRTN-QTY (LINE-IDX)        39900076
399100                 MOVE PV-CARTON-REC-TYPE                          39910076
399200                               TO PACK-CRTN-REC-TYPE (LINE-IDX)   39920076
399300                 MOVE PV-CARTON-INTR-UPC                          39930076
399400                               TO PACK-CRTN-INTR-UPC (LINE-IDX)   39940076
399500                 MOVE PV-CARTON-HOLD-UPC-NBR                      39950076
399600                               TO PACK-CRTN-HOLD-UPC (LINE-IDX)   39960076
399700             END-IF                                               39970076
399800         END-IF                                                   39980076
399900     END-IF.                                                      39990076
400000                                                                  40000076
400100 5250-SELECT-EXPECTED-LINE.                                       40010076
400200                                                                  40020076
400300     EXEC SQL                                                     40030076
400400         SELECT  TRN_LNE_NBR                                      40040076
400500             INTO :SHUUPC-TRN-LNE-NBR                             40050076
400600             FROM TSHUUPC                                         40060076
400700             WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                40070076
400800     END-EXEC.                                                    40080076
400900                                                                  40090076
401000     EVALUATE TRUE                                                40100076
401100         WHEN SQLCODE = ZERO                                      40110076
401200         WHEN SQLCODE = -811                                      40120076
401300              MOVE SHUUPC-TRN-LNE-NBR  TO DK-SHUUPC-TRN-LNE-NBR   40130076
401400                                                                  40140076
401500         WHEN SQLCODE = +100                                      40150076
401600              MOVE ZERO               TO DK-SHUUPC-TRN-LNE-NBR    40160076
401700                                                                  40170076
401800         WHEN SQLWARN0 NOT = SPACES                               40180076
401900         WHEN SQLCODE NOT EQUAL ZERO                              40190076
402000             SET PS-ERROR                                         40200076
402100                 SU034-INVALID-SQL    TO TRUE                     40210076
402200             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     40220076
402300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       40230076
402400             STRING   ' SUKUT701-5250-'                           40240076
402500                      ' CALLED BY-'                               40250076
402600                      SU034-PROGRAM-NAME                          40260076
402700                      '  SQLCODE='                                40270076
402800                      PV-DISPLAY-SQLCODE                          40280076
402900                      ' '                                         40290076
403000                      PV-DISP-SHIPT-UNT-ID                        40300076
403100                      DELIMITED BY SIZE                           40310076
403200                                      INTO SU034-CRA-RET-MSG      40320076
403300             PERFORM 9999-WRITE-TO-CSSL                           40330076
403400             MOVE '5250-'                TO SU034-CRA-REQ-ID      40340076
403500             SET SU034-INVALID-SQL TO TRUE                        40350076
403600             PERFORM 9998-RETURN                                  40360076
403700     END-EVALUATE.                                                40370076
403800                                                                  40380076
403900                                                                  40390076
404000 5300-FETCH-CARTON-LINE-CURSOR.                                   40400076
404100                                                                  40410076
404200     EXEC SQL                                                     40420076
404300         FETCH CARTON_LINE_CURSOR                                 40430076
404400         INTO    :PV-CARTON-REC-TYPE                              40440076
404500              ,  :PV-CARTON-INTR-UPC                              40450076
404600              ,  :PV-CARTON-LINE-NBR                              40460076
404700              ,  :PV-CARTON-HOLD-UPC-NBR                          40470076
404800              ,  :PV-CARTON-ITEM-COUNT                            40480076
404900     END-EXEC.                                                    40490076
405000                                                                  40500076
405100     EVALUATE TRUE                                                40510076
405200         WHEN SQLCODE = ZERO                                      40520076
405300             CONTINUE                                             40530076
405400                                                                  40540076
405500         WHEN SQLCODE = +100                                      40550076
405600             SET PS-EOC-CARTON-ITEM-CURSOR   TO TRUE              40560076
405700             MOVE 0                TO PV-CARTON-ITEM-COUNT        40570076
405800                                                                  40580076
405900         WHEN SQLWARN0 NOT = SPACES                               40590076
406000         WHEN SQLCODE < ZERO                                      40600076
406100         WHEN SQLCODE > ZERO                                      40610076
406200             SET PS-ERROR                                         40620076
406300                 SU034-INVALID-SQL    TO TRUE                     40630076
406400             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     40640076
406500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       40650076
406600             STRING   ' SUKUT701-5300-'                           40660076
406700                      ' CALLED BY-'                               40670076
406800                      SU034-PROGRAM-NAME                          40680076
406900                      '  SQLCODE='                                40690076
407000                      PV-DISPLAY-SQLCODE                          40700076
407100                      ' '                                         40710076
407200                      PV-DISP-SHIPT-UNT-ID                        40720076
407300                      DELIMITED BY SIZE                           40730076
407400                                      INTO SU034-CRA-RET-MSG      40740076
407500             PERFORM 9999-WRITE-TO-CSSL                           40750076
407600             MOVE '5300-'                TO SU034-CRA-REQ-ID      40760076
407700             SET SU034-INVALID-SQL TO TRUE                        40770076
407800             PERFORM 9998-RETURN                                  40780076
407900     END-EVALUATE.                                                40790076
408000                                                                  40800076
408100******************************************************************40810076
408200* 5400-CLOSE-CARTON-LINE-CURSOR                                  *40820076
408300*  CLOSE THE PO LINE CURSOR                                      *40830076
408400******************************************************************40840076
408500 5400-CLOSE-CARTON-LINE-CURSOR.                                   40850076
408600                                                                  40860076
408700     EXEC SQL                                                     40870076
408800         CLOSE CARTON_LINE_CURSOR                                 40880076
408900     END-EXEC.                                                    40890076
409000                                                                  40900076
409100     EVALUATE TRUE                                                40910076
409200         WHEN SQLCODE = ZERO                                      40920076
409300             CONTINUE                                             40930076
409400                                                                  40940076
409500         WHEN SQLWARN0 NOT = SPACES                               40950076
409600         WHEN SQLCODE < ZERO                                      40960076
409700         WHEN SQLCODE > ZERO                                      40970076
409800             SET PS-ERROR                                         40980076
409900                 SU034-INVALID-SQL    TO TRUE                     40990076
410000             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     41000076
410100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       41010076
410200             STRING   ' SUKUT701-5400-'                           41020076
410300                      ' CALLED BY-'                               41030076
410400                      SU034-PROGRAM-NAME                          41040076
410500                      '  SQLCODE='                                41050076
410600                      PV-DISPLAY-SQLCODE                          41060076
410700                      ' '                                         41070076
410800                      PV-DISP-SHIPT-UNT-ID                        41080076
410900                      DELIMITED BY SIZE                           41090076
411000                                      INTO SU034-CRA-RET-MSG      41100076
411100             PERFORM 9999-WRITE-TO-CSSL                           41110076
411200             MOVE '5400-'                TO SU034-CRA-REQ-ID      41120076
411300             SET SU034-INVALID-SQL TO TRUE                        41130076
411400             PERFORM 9998-RETURN                                  41140076
411500     END-EVALUATE.                                                41150076
411600                                                                  41160076
411700                                                                  41170076
411800 5500-SELECT-PACK-ID.                                             41180076
411900                                                                  41190076
412000                                                                  41200076
412100     EXEC SQL                                                     41210076
412200          SELECT PREPK_ID                                         41220076
412300          INTO  :RECITM-PREPK-ID                                  41230076
412400          FROM   TRECITM                                          41240076
412500          WHERE ORD_NBR            =  :DK-PO-NBR                  41250076
412600           AND  REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            41260076
412700           AND  ORD_LNE_NBR        =  :DK-LNE-NBR                 41270076
412800     END-EXEC.                                                    41280076
412900                                                                  41290076
413000                                                                  41300076
413100     EVALUATE TRUE                                                41310076
413200         WHEN SQLCODE = ZERO                                      41320076
413300             MOVE RECITM-PREPK-ID   TO DK-PACK-ID                 41330076
413400                                                                  41340076
413500         WHEN SQLCODE = +100                                      41350076
413600             MOVE 0                 TO DK-PACK-ID                 41360076
413700                                       RECITM-PREPK-ID            41370076
413800                                                                  41380076
413900         WHEN SQLWARN0 NOT = SPACES                               41390076
414000         WHEN SQLCODE < ZERO                                      41400076
414100         WHEN SQLCODE > ZERO                                      41410076
414200             SET PS-ERROR                                         41420076
414300                 SU034-INVALID-SQL    TO TRUE                     41430076
414400             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          41440076
414500             MOVE PV-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     41450076
414600             MOVE DK-LNE-NBR          TO PV-DISP-TRN-LNE-NBR      41460076
414700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       41470076
414800             STRING   ' SUKUT701-5500-'                           41480076
414900                      ' CALLED BY-'                               41490076
415000                      SU034-PROGRAM-NAME                          41500076
415100                      '  SQLCODE='                                41510076
415200                      PV-DISPLAY-SQLCODE                          41520076
415300                      ' '                                         41530076
415400                      PV-DISP-TRN-NBR                             41540076
415500                      ' '                                         41550076
415600                      PV-DISP-RCVR-SEQ-NBR                        41560076
415700                      ' '                                         41570076
415800                      PV-DISP-TRN-LNE-NBR                         41580076
415900                      DELIMITED BY SIZE                           41590076
416000                                      INTO SU034-CRA-RET-MSG      41600076
416100             PERFORM 9999-WRITE-TO-CSSL                           41610076
416200             MOVE '5500-'                TO SU034-CRA-REQ-ID      41620076
416300             SET SU034-INVALID-SQL TO TRUE                        41630076
416400             PERFORM 9998-RETURN                                  41640076
416500     END-EVALUATE.                                                41650076
416600                                                                  41660076
416700 5600-PROCESS-AUDIT-CURSOR.                                       41670076
416800     PERFORM 1230-FETCH-AUDIT-ITEM-CURSOR.                        41680076
416900     IF PS-NOT-EOC-AUDIT-ITEM-CURSOR                              41690076
417000         MOVE PV-AUDIT-INTR-UPC  TO DK-INTR-UPC                   41700076
417100         PERFORM 5650-SELECT-PACK-ID                              41710076
417200         IF PV-AUDIT-REC-TYPE  = 'B'                              41720076
417300             MOVE PV-AUDIT-HOLD-UPC-NBR                           41730076
417400                                 TO DK-UPC-NBR                    41740076
417500             PERFORM 3800-GET-ITM-NBR                             41750076
417600             COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1      41760076
417700             SET LINE-IDX TO PV-SAVE-LAST-IDX                     41770076
417800             MOVE 'Y'              TO PACK-IND (LINE-IDX)         41780076
417900             MOVE XL001-ITM-NBR    TO PACK-ITM (LINE-IDX)         41790076
418000             MOVE 999999999        TO PACK-LINE (LINE-IDX)        41800076
418100             MOVE PV-AUDIT-ITEM-COUNT                             41810076
418200                               TO PACK-AUDIT-QTY (LINE-IDX)       41820076
418300             MOVE PV-AUDIT-REC-TYPE                               41830076
418400                               TO PACK-AUD-REC-TYPE (LINE-IDX)    41840076
418500             MOVE PV-AUDIT-INTR-UPC                               41850076
418600                               TO PACK-AUD-INTR-UPC (LINE-IDX)    41860076
418700             MOVE PV-AUDIT-HOLD-UPC-NBR                           41870076
418800                               TO PACK-AUD-HOLD-UPC (LINE-IDX)    41880076
418900         ELSE                                                     41890076
419000             PERFORM 3850-GET-ITM-NBR                             41900076
419100             SET PS-NO-UPC-MATCH-FOUND TO TRUE                    41910076
419200**  TRY TO INSERT THE UPC INTO THE TABLE                          41920076
419300             PERFORM VARYING LINE-IDX FROM 1 BY 1                 41930076
419400                 UNTIL PACK-LINE (LINE-IDX) = 0                   41940076
419500                 OR PS-UPC-MATCH-FOUND                            41950076
419600                 OR LINE-IDX > 500                                41960076
419700                IF XL001-ITM-NBR = PACK-ITM (LINE-IDX)            41970076
419800                    MOVE PV-AUDIT-ITEM-COUNT                      41980076
419900                                      TO PACK-AUDIT-QTY (LINE-IDX)41990076
420000                    MOVE PV-AUDIT-REC-TYPE                        42000076
420100                                  TO PACK-AUD-REC-TYPE  (LINE-IDX)42010076
420200                    MOVE PV-AUDIT-INTR-UPC                        42020076
420300                                  TO PACK-AUD-INTR-UPC  (LINE-IDX)42030076
420400                    MOVE PV-AUDIT-HOLD-UPC-NBR                    42040076
420500                                  TO PACK-AUD-HOLD-UPC  (LINE-IDX)42050076
420600                    SET PS-UPC-MATCH-FOUND TO TRUE                42060076
420700                END-IF                                            42070076
420800             END-PERFORM                                          42080076
420900             IF PS-NO-UPC-MATCH-FOUND AND                         42090076
421000                RECITM-PREPK-ID > 0                               42100076
421100**  CHECK IF THE PACK ID IS ALREADY SET UP                        42110076
421200                 SET PS-NO-PACK-MATCH-FOUND TO TRUE               42120076
421300                 PERFORM VARYING LINE-IDX FROM 1 BY 1             42130076
421400                     UNTIL PACK-LINE (LINE-IDX) = 0               42140076
421500                     OR PS-PACK-MATCH-FOUND                       42150076
421600                     OR LINE-IDX > 500                            42160076
421700                        IF RECITM-PREPK-ID =                      42170076
421800                                         PACK-PRPPK-ID (LINE-IDX) 42180076
421900                            SET PS-PACK-MATCH-FOUND TO TRUE       42190076
422000                        END-IF                                    42200076
422100                 END-PERFORM                                      42210076
422200                                                                  42220076
422300                 IF PS-NO-PACK-MATCH-FOUND                        42230076
422400***   PACK ID IS NOT SET UP - ADD IT                              42240076
422500                     PERFORM 6100-OPEN-PACK-CURSOR                42250076
422600                     PERFORM 6200-PROCESS-PACK-CURSOR             42260076
422700                     PERFORM 6400-CLOSE-PACK-CURSOR               42270076
422800                     SET PS-NO-UPC-MATCH-FOUND TO TRUE            42280076
422900**  TRY TO INSERT THE UPC INTO THE UPDATED TABLE                  42290076
423000                     PERFORM VARYING LINE-IDX FROM 1 BY 1         42300076
423100                         UNTIL PACK-LINE (LINE-IDX) = 0           42310076
423200                         OR PS-UPC-MATCH-FOUND                    42320076
423300                         OR LINE-IDX > 500                        42330076
423400                        IF XL001-ITM-NBR = PACK-ITM (LINE-IDX)    42340076
423500                            MOVE PV-AUDIT-ITEM-COUNT              42350076
423600                                      TO PACK-AUDIT-QTY (LINE-IDX)42360076
423700                            MOVE PV-AUDIT-REC-TYPE                42370076
423800                                  TO PACK-AUD-REC-TYPE  (LINE-IDX)42380076
423900                            MOVE PV-AUDIT-INTR-UPC                42390076
424000                                  TO PACK-AUD-INTR-UPC  (LINE-IDX)42400076
424100                            MOVE PV-AUDIT-HOLD-UPC-NBR            42410076
424200                                  TO PACK-AUD-HOLD-UPC  (LINE-IDX)42420076
424300                            SET PS-UPC-MATCH-FOUND TO TRUE        42430076
424400                        END-IF                                    42440076
424500                     END-PERFORM                                  42450076
424600                 END-IF                                           42460076
424700             END-IF                                               42470076
424800             IF PS-NO-UPC-MATCH-FOUND                             42480076
424900                 COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1  42490076
425000                 SET LINE-IDX TO PV-SAVE-LAST-IDX                 42500076
425100                 MOVE 'Y'              TO PACK-IND (LINE-IDX)     42510076
425200                 MOVE XL001-ITM-NBR    TO PACK-ITM (LINE-IDX)     42520076
425300                 MOVE 999999999        TO PACK-LINE (LINE-IDX)    42530076
425400                 MOVE RECITM-PREPK-ID  TO PACK-PRPPK-ID (LINE-IDX)42540076
425500                 MOVE PV-AUDIT-ITEM-COUNT                         42550076
425600                               TO PACK-AUDIT-QTY (LINE-IDX)       42560076
425700                 MOVE PV-AUDIT-REC-TYPE                           42570076
425800                               TO PACK-AUD-REC-TYPE (LINE-IDX)    42580076
425900                 MOVE PV-AUDIT-INTR-UPC                           42590076
426000                               TO PACK-AUD-INTR-UPC (LINE-IDX)    42600076
426100                 MOVE PV-AUDIT-HOLD-UPC-NBR                       42610076
426200                               TO PACK-AUD-HOLD-UPC (LINE-IDX)    42620076
426300             END-IF                                               42630076
426400         END-IF                                                   42640076
426500     END-IF.                                                      42650076
426600                                                                  42660076
426700 5650-SELECT-PACK-ID.                                             42670076
426800                                                                  42680076
426900                                                                  42690076
427000     EXEC SQL                                                     42700076
427100          SELECT A.PREPK_ID                                       42710076
427200          INTO  :RECITM-PREPK-ID                                  42720076
427300          FROM   TRECITM A                                        42730076
427400             ,   XLT_SKU B                                        42740076
427500          WHERE A.ORD_NBR            =  :DK-PO-NBR                42750076
427600           AND  A.REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR          42760076
427700           AND  A.ITM_NBR            =  B.ITM_NBR                 42770076
427800           AND  B.INTR_UPC_ID        =  :DK-INTR-UPC              42780076
427900     END-EXEC.                                                    42790076
428000                                                                  42800076
428100                                                                  42810076
428200     EVALUATE TRUE                                                42820076
428300         WHEN SQLCODE = ZERO                                      42830076
428400         WHEN SQLCODE = -811                                      42840076
428500             MOVE RECITM-PREPK-ID    TO DK-PACK-ID                42850076
428600                                                                  42860076
428700         WHEN SQLCODE = +100                                      42870076
428800             MOVE 0                  TO DK-PACK-ID                42880076
428900                                        RECITM-PREPK-ID           42890076
429000                                                                  42900076
429100         WHEN SQLWARN0 NOT = SPACES                               42910076
429200         WHEN SQLCODE < ZERO                                      42920076
429300         WHEN SQLCODE > ZERO                                      42930076
429400             SET PS-ERROR                                         42940076
429500                 SU034-INVALID-SQL    TO TRUE                     42950076
429600             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          42960076
429700             MOVE PV-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     42970076
429800             MOVE DK-INTR-UPC         TO PV-INTR-UPC              42980076
429900             MOVE PV-INTR-UPC-11      TO PV-DISPLAY-INTR-UPC      42990076
430000             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       43000076
430100             STRING   ' SUKUT701-5650-'                           43010076
430200                      ' CALLED BY-'                               43020076
430300                      SU034-PROGRAM-NAME                          43030076
430400                      '  SQLCODE='                                43040076
430500                      PV-DISPLAY-SQLCODE                          43050076
430600                      ' '                                         43060076
430700                      PV-DISP-TRN-NBR                             43070076
430800                      ' '                                         43080076
430900                      PV-DISP-RCVR-SEQ-NBR                        43090076
431000                      ' '                                         43100076
431100                      PV-DISPLAY-INTR-UPC                         43110076
431200                      DELIMITED BY SIZE                           43120076
431300                                      INTO SU034-CRA-RET-MSG      43130076
431400             PERFORM 9999-WRITE-TO-CSSL                           43140076
431500             MOVE '5650-'                TO SU034-CRA-REQ-ID      43150076
431600             SET SU034-INVALID-SQL TO TRUE                        43160076
431700             PERFORM 9998-RETURN                                  43170076
431800     END-EVALUATE.                                                43180076
431900                                                                  43190076
432000 5700-CALL-BEST-CASE-RTN.                                         43200076
432100     MOVE PACK-PRPPK-ID (PV-SAVE-LINE-IDX)                        43210076
432200                                      TO PV-SAVE-PREPK-ID.        43220076
432300     INITIALIZE RC806-PRODUCT-PACK-VALIDATION.                    43230076
432400     SET RC806-VALIDATE-AND-CALC      TO TRUE.                    43240076
432500     MOVE 1                           TO RC806-INNER-PACK-QTY.    43250076
432600                                                                  43260076
432700     MOVE 0     TO PV-NUMBER-OF-LINES.                            43270076
432800     SET RC806-LINE-IDX TO 1.                                     43280076
432900     PERFORM VARYING LINE-IDX  FROM PV-SAVE-LINE-IDX BY 1         43290076
433000             UNTIL PACK-IND (LINE-IDX) NOT = 'Y'                  43300076
433100                OR PACK-PRPPK-ID (LINE-IDX) NOT = PV-SAVE-PREPK-ID43310076
433200                OR LINE-IDX > 500                                 43320076
433300         MOVE PACK-LINE (LINE-IDX) TO RC806-PKSL-LNE-NBR          43330076
433400                                       (RC806-LINE-IDX)           43340076
433500         MOVE PACK-RATO (LINE-IDX) TO RC806-PO-RATIO              43350076
433600                                       (RC806-LINE-IDX)           43360076
433700                                      RC806-RC-RATIO              43370076
433800                                       (RC806-LINE-IDX)           43380076
433900         MOVE PACK-CRTN-QTY (LINE-IDX)                            43390076
434000                                   TO RC806-UNIT-QTY              43400076
434100                                       (RC806-LINE-IDX)           43410076
434200                                      RC806-RCVG-QTY              43420076
434300                                       (RC806-LINE-IDX)           43430076
434400         SET RC806-LINE-IDX UP BY 1                               43440076
434500         ADD 1  TO PV-NUMBER-OF-LINES                             43450076
434600     END-PERFORM.                                                 43460076
434700     MOVE PV-NUMBER-OF-LINES  TO RC806-NBR-OF-LINES.              43470076
434800                                                                  43480076
434900     PERFORM 8300-VALIDATION-MODULE.                              43490076
435000                                                                  43500076
435100     SET LINE-IDX TO PV-SAVE-LINE-IDX.                            43510076
435200     IF RC806-NO-ERRORS                                           43520076
435300         PERFORM VARYING RC806-LINE-IDX FROM 1 BY 1               43530076
435400                 UNTIL RC806-LINE-IDX > RC806-NBR-OF-LINES        43540076
435500             MOVE RC806-BEST-CASE-UNITS (RC806-LINE-IDX)          43550076
435600                                       TO PACK-BEST-CASE-UNITS    43560076
435700                                           (LINE-IDX)             43570076
435800             MOVE RC806-ODD-UNITS (RC806-LINE-IDX)                43580076
435900                                       TO PACK-ODD-UNITS          43590076
436000                                           (LINE-IDX)             43600076
436100             SET LINE-IDX UP BY 1                                 43610076
436200         END-PERFORM                                              43620076
436300         MOVE RC806-BEST-CASE-PACKS    TO PV-SAVE-NBR-OF-PACKS    43630076
436400                                                                  43640076
436500         INITIALIZE RC806-PRODUCT-PACK-VALIDATION                 43650076
436600         SET RC806-VALIDATE-AND-CALC      TO TRUE                 43660076
436700         MOVE 1                           TO RC806-INNER-PACK-QTY 43670076
436800         MOVE 0     TO PV-NUMBER-OF-LINES                         43680076
436900         SET RC806-LINE-IDX TO 1                                  43690076
437000         PERFORM VARYING LINE-IDX  FROM PV-SAVE-LINE-IDX BY 1     43700076
437100                 UNTIL PACK-IND (LINE-IDX) NOT = 'Y'              43710076
437200                    OR PACK-PRPPK-ID (LINE-IDX) NOT =             43720076
437300                                              PV-SAVE-PREPK-ID    43730076
437400                    OR LINE-IDX > 500                             43740076
437500             MOVE PACK-LINE (LINE-IDX) TO RC806-PKSL-LNE-NBR      43750076
437600                                           (RC806-LINE-IDX)       43760076
437700             MOVE PACK-RATO (LINE-IDX) TO RC806-PO-RATIO          43770076
437800                                           (RC806-LINE-IDX)       43780076
437900                                          RC806-RC-RATIO          43790076
438000                                           (RC806-LINE-IDX)       43800076
438100             MOVE PACK-AUDIT-QTY (LINE-IDX)                       43810076
438200                                       TO RC806-UNIT-QTY          43820076
438300                                           (RC806-LINE-IDX)       43830076
438400                                          RC806-RCVG-QTY          43840076
438500                                           (RC806-LINE-IDX)       43850076
438600             ADD 1  TO PV-NUMBER-OF-LINES                         43860076
438700             SET RC806-LINE-IDX UP BY 1                           43870076
438800         END-PERFORM                                              43880076
438900         MOVE PV-NUMBER-OF-LINES   TO RC806-NBR-OF-LINES          43890076
439000                                                                  43900076
439100         PERFORM 8300-VALIDATION-MODULE                           43910076
439200                                                                  43920076
439300                                                                  43930076
439400         SET LINE-IDX TO PV-SAVE-LINE-IDX                         43940076
439500         PERFORM 5800-PROCESS-LINES                               43950076
439600             VARYING RC806-LINE-IDX                               43960076
439700             FROM 1 BY 1                                          43970076
439800             UNTIL RC806-PKSL-LNE-NBR(RC806-LINE-IDX) = ZERO      43980076
439900                                                                  43990076
440000     END-IF.                                                      44000076
440100     COMPUTE PV-SAVE-LINE-IDX = PV-SAVE-LINE-IDX +                44010076
440200                                  PV-NUMBER-OF-LINES.             44020076
440300                                                                  44030076
440400 5800-PROCESS-LINES.                                              44040076
440500                                                                  44050076
440600     SET PS-DONT-BACK-OUT-UPDATES   TO TRUE.                      44060076
440700     SET PS-NO-ODD-UNITS-ADJUSTMENT TO TRUE.                      44070076
440800     SET PS-NO-PACK-ADJUSTMENT TO TRUE.                           44080076
440900     MOVE 0                    TO PV-ADJUST-QTY                   44090076
441000                                  PV-BEFORE-QTY                   44100076
441100                                  PV-AFTER-QTY                    44110076
441200                                  PV-PACK-DIFF                    44120076
441300                                  PV-ODD-DIFF                     44130076
441400                                  PV-AFTER-ODD-UNT-QTY            44140076
441500                                  PV-ADJ-MINUS-ODD.               44150076
441600     INITIALIZE PV-SAVE-UPC-UPDATE-AREA.                          44160076
441700     SET PS-OTBND-UPC-NOT-UPDATED TO TRUE.                        44170076
441800                                                                  44180076
441900     IF (PACK-CRTN-QTY (LINE-IDX) = PACK-AUDIT-QTY (LINE-IDX)     44190076
442000      AND PV-SAVE-NBR-OF-PACKS = RC806-BEST-CASE-PACKS            44200076
442100      AND PACK-ODD-UNITS (LINE-IDX) =                             44210076
442200                      RC806-ODD-UNITS (RC806-LINE-IDX)            44220076
442300      AND PS-APPLY-TO-ALL-PACKS)                                  44230076
442400       OR                                                         44240076
442500         (PS-ONLY-APPLY-TO-BAD-PACKS                              44250076
442600          AND  PACK-BACKOUT-IND (LINE-IDX) NOT = 'Y')             44260076
442700         IF (PACK-CRTN-QTY (LINE-IDX) = PACK-AUDIT-QTY (LINE-IDX) 44270077
442800          AND PV-SAVE-NBR-OF-PACKS = RC806-BEST-CASE-PACKS        44280077
442900          AND PACK-ODD-UNITS (LINE-IDX) =                         44290077
443000                          RC806-ODD-UNITS (RC806-LINE-IDX)        44300077
443100          AND PS-APPLY-TO-ALL-PACKS)                              44310077
443200          AND PACK-ODD-UNITS (LINE-IDX) > 0                       44320077
443300              SET PS-ODD-UNITS-EXIST TO TRUE                      44330077
443400         END-IF                                                   44340077
443500     ELSE                                                         44350076
443600         IF PACK-CRTN-QTY (LINE-IDX) > 0 AND                      44360076
443700            PACK-AUDIT-QTY (LINE-IDX) > 0                         44370076
443800             MOVE PACK-CRTN-INTR-UPC (LINE-IDX)                   44380076
443900                                           TO DK-INTR-UPC         44390076
444000                                              PV-CARTON-INTR-UPC  44400076
444100             MOVE PACK-AUDIT-QTY (LINE-IDX)                       44410076
444200                                           TO PV-AUDIT-SHPD-QTY   44420076
444300             MOVE PACK-CRTN-QTY (LINE-IDX)                        44430076
444400                                           TO PV-CARTON-SHPD-QTY  44440076
444500             MOVE PACK-CRTN-REC-TYPE (LINE-IDX)                   44450076
444600                                           TO PV-CARTON-REC-TYPE  44460076
444700             MOVE PACK-LINE (LINE-IDX)     TO PV-SAVE-ORD-LNE-NBR 44470076
444800             IF PV-SAVE-NBR-OF-PACKS NOT = RC806-BEST-CASE-PACKS  44480076
444900                 IF PACK-EXPECTED-IN-CARTON-IND (LINE-IDX) = 'Y'  44490076
445000                   COMPUTE PV-PACK-DIFF =                         44500076
445100                      RC806-BEST-CASE-PACKS - PV-SAVE-NBR-OF-PACKS44510076
445200                   COMPUTE PV-ADJUST-QTY =                        44520076
445300                       (PV-PACK-DIFF * PACK-RATO (LINE-IDX))      44530076
445400                   SET PS-PACK-ADJUSTMENT TO TRUE                 44540076
445500                   MOVE PACK-PRPPK-ID (LINE-IDX)                  44550076
445600                                               TO PV-PACK-ID      44560076
445700                   IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A'     44570076
445800                       SET PS-PREPACK-DRIVER TO TRUE              44580076
445900                   END-IF                                         44590076
446000                 ELSE                                             44600076
446100                   MOVE 0  TO          PV-BEFORE-ODD-UNT-QTY      44610076
446200                   COMPUTE PV-PACK-DIFF =                         44620076
446300                      RC806-BEST-CASE-PACKS - PV-SAVE-NBR-OF-PACKS44630076
446400                   COMPUTE PV-ADJUST-QTY =                        44640076
446500                       (PV-PACK-DIFF * PACK-RATO (LINE-IDX))      44650076
446600                   MOVE PV-ADJUST-QTY TO                          44660076
446700                                       PV-AFTER-ODD-UNT-QTY       44670076
446800                                       PV-ODD-DIFF                44680076
446900                   MOVE PACK-PRPPK-ID (LINE-IDX)                  44690076
447000                                               TO PV-PACK-ID      44700076
447100                   SET PS-ODD-UNITS-ADJUSTMENT TO TRUE            44710076
447200                 END-IF                                           44720076
447300             END-IF                                               44730076
447400             IF PACK-ODD-UNITS (LINE-IDX) NOT =                   44740076
447500                      RC806-ODD-UNITS (RC806-LINE-IDX)            44750076
447600                 COMPUTE PV-ODD-DIFF =                            44760076
447700                     (RC806-ODD-UNITS (RC806-LINE-IDX)            44770076
447800                        - PACK-ODD-UNITS (LINE-IDX))              44780076
447900                        + PV-ODD-DIFF                             44790076
448000                 SET PS-ODD-UNITS-ADJUSTMENT TO TRUE              44800076
448100                 MOVE PACK-PRPPK-ID (LINE-IDX)                    44810076
448200                                             TO PV-PACK-ID        44820076
448300                 MOVE PACK-ODD-UNITS (LINE-IDX) TO                44830076
448400                                     PV-BEFORE-ODD-UNT-QTY        44840076
448500                 COMPUTE PV-AFTER-ODD-UNT-QTY =                   44850076
448600                      RC806-ODD-UNITS (RC806-LINE-IDX)            44860076
448700                                   + PV-AFTER-ODD-UNT-QTY         44870076
448800                 COMPUTE PV-ADJUST-QTY = PV-ADJUST-QTY +          44880076
448900                                        PV-ODD-DIFF               44890076
449000             END-IF                                               44900076
449100             PERFORM 2000-UPDATE-THIS-CARTON                      44910076
449200             IF PS-BACK-OUT-UPDATES                               44920076
449300                 MOVE PACK-CRTN-QTY (LINE-IDX) TO                 44930076
449400                      PACK-AUDIT-QTY (LINE-IDX)                   44940076
449500                 MOVE PACK-PRPPK-ID (LINE-IDX) TO                 44950076
449600                      PV-SAVE-PRPPK-ID                            44960076
449700                 PERFORM 5980-UPDATE-PACK                         44970076
449800                      VARYING PV-UPDATE-LINE-IDX FROM 1 BY 1      44980076
449900                     UNTIL PACK-LINE (PV-UPDATE-LINE-IDX) = 0     44990076
450000                     OR PV-UPDATE-LINE-IDX > 500                  45000076
450100             END-IF                                               45010076
450200             IF (PACK-ODD-UNITS (LINE-IDX) NOT =                  45020076
450300                      RC806-ODD-UNITS (RC806-LINE-IDX)) AND       45030076
450400                PS-DONT-BACK-OUT-UPDATES AND                      45040078
450500                PACK-LINE (LINE-IDX) NOT = 999999999              45050078
450600                 SET PS-ODD-UNITS-PROCESSED TO TRUE               45060076
450700                 IF PACK-ODD-UNITS (LINE-IDX) = 0                 45070076
450800                     SET PS-ODD-UNITS-ADDED TO TRUE               45080076
450900                 END-IF                                           45090076
451000                 IF RC806-ODD-UNITS (RC806-LINE-IDX) > 0          45100076
451100                     SET PS-ODD-UNITS-EXIST TO TRUE               45110076
451200                 END-IF                                           45120076
451300             END-IF                                               45130076
451400             IF PV-SAVE-NBR-OF-PACKS NOT = RC806-BEST-CASE-PACKS  45140076
451500                AND PS-DONT-BACK-OUT-UPDATES AND                  45150078
451600                PACK-LINE (LINE-IDX) NOT = 999999999              45160078
451700                 IF PACK-EXPECTED-IN-CARTON-IND (LINE-IDX) = 'N'  45170076
451800                     SET PS-ODD-UNITS-PROCESSED TO TRUE           45180083
451900                     IF RC806-BEST-CASE-PACKS > 0                 45190083
452000                         SET PS-ODD-UNITS-ADDED      TO TRUE      45200083
452100                     END-IF                                       45210083
452200                 ELSE                                             45220083
452300                     IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A'   45230076
452400                         MOVE PV-PACK-DIFF  TO PV-SAVE-PACK-DIFF  45240076
452500                         SET PS-UPDATE-NBR-PACKS   TO TRUE        45250076
452600                         MOVE PV-PACK-ID    TO PV-SAVE-PACK-ID    45260076
452700                     END-IF                                       45270076
452800                 END-IF                                           45280076
452900             END-IF                                               45290076
453000         ELSE                                                     45300076
453100             IF (PACK-CRTN-QTY (LINE-IDX) > 0 AND                 45310076
453200                 PACK-AUDIT-QTY (LINE-IDX) = 0) OR                45320076
453300****           UPDATE THE ITEM IF IT IS ALREADY IN THE OUTBND_UPC 45330076
453400                (PACK-CRTN-QTY (LINE-IDX) = 0 AND                 45340076
453500                 PACK-CRTN-REC-TYPE (LINE-IDX) NOT = SPACES)      45350076
453600                 MOVE PACK-CRTN-QTY (LINE-IDX)                    45360076
453700                                      TO SUQADJ-ADJ-BEF-QTY       45370076
453800                                         PV-BEFORE-QTY            45380076
453900                 MOVE PACK-AUDIT-QTY (LINE-IDX)                   45390076
454000                                      TO SUQADJ-ADJ-AFT-QTY       45400076
454100                                         PV-AFTER-QTY             45410076
454200                 MOVE PACK-LINE (LINE-IDX)                        45420076
454300                                      TO PV-SAVE-ORD-LNE-NBR      45430076
454400                 COMPUTE PV-ADJUST-QTY =                          45440076
454500                         PV-AFTER-QTY - PV-BEFORE-QTY             45450076
454600                 IF PACK-CRTN-REC-TYPE (LINE-IDX) = 'A'           45460076
454700                     MOVE PACK-CRTN-INTR-UPC (LINE-IDX)           45470076
454800                                         TO DK-CARTON-INTR-UPC    45480076
454900                     PERFORM 3200-SELECT-UPC                      45490076
455000                 ELSE                                             45500076
455100                     MOVE PACK-CRTN-HOLD-UPC (LINE-IDX)           45510076
455200                                             TO DK-UPC-NBR        45520076
455300                     PERFORM 3300-SELECT-UPC                      45530076
455400                 END-IF                                           45540076
455500                 MOVE SU034-OPER-UNT-ID TO SUQADJ-OPER-UNT-ID     45550076
455600                 MOVE SU034-USER-ID     TO SUQADJ-ADJ-USR-ID      45560076
455700                 MOVE SU034-ADJ-AUDIT-CNTL-NBR                    45570076
455800                                        TO SUQADJ-AUD-CNTL-NBR    45580076
455900                 IF PS-ONLY-APPLY-TO-BAD-PACKS                    45590076
456000                     CONTINUE                                     45600076
456100                 ELSE                                             45610076
456200                     PERFORM 2500-UPDATE-OTBND-UPC                45620076
456300                 END-IF                                           45630076
456400                 MOVE PACK-CRTN-INTR-UPC (LINE-IDX)               45640076
456500                                              TO DK-INTR-UPC      45650076
456600                                                PV-CARTON-INTR-UPC45660076
456700                 MOVE PACK-CRTN-REC-TYPE (LINE-IDX)               45670076
456800                                           TO PV-CARTON-REC-TYPE  45680076
456900                 IF PACK-CRTN-REC-TYPE (LINE-IDX) = 'A'           45690076
457000                     PERFORM 2100-SELECT-UPC                      45700076
457100                 ELSE                                             45710076
457200                     PERFORM 2150-SELECT-UPC                      45720076
457300                 END-IF                                           45730076
457400                 IF PV-SAVE-NBR-OF-PACKS NOT =                    45740076
457500                                            RC806-BEST-CASE-PACKS 45750076
457600                     IF PACK-EXPECTED-IN-CARTON-IND (LINE-IDX)    45760076
457700                                         = 'Y'                    45770076
457800                       COMPUTE PV-PACK-DIFF =                     45780076
457900                          RC806-BEST-CASE-PACKS -                 45790076
458000                                            PV-SAVE-NBR-OF-PACKS  45800076
458100                       SET PS-PACK-ADJUSTMENT TO TRUE             45810076
458200                       MOVE PACK-PRPPK-ID (LINE-IDX)              45820076
458300                                               TO PV-PACK-ID      45830076
458400                       IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A' 45840076
458500                           SET PS-PREPACK-DRIVER TO TRUE          45850076
458600                       END-IF                                     45860076
458700                     ELSE                                         45870076
458800                       MOVE 0  TO          PV-BEFORE-ODD-UNT-QTY  45880076
458900                       COMPUTE PV-PACK-DIFF =                     45890076
459000                          RC806-BEST-CASE-PACKS -                 45900076
459100                                            PV-SAVE-NBR-OF-PACKS  45910076
459200                       COMPUTE PV-AFTER-ODD-UNT-QTY =             45920076
459300                           (PV-PACK-DIFF * PACK-RATO (LINE-IDX))  45930076
459400                       MOVE PV-AFTER-ODD-UNT-QTY TO               45940076
459500                                           PV-ODD-DIFF            45950076
459600                       MOVE PACK-PRPPK-ID (LINE-IDX)              45960076
459700                                                   TO PV-PACK-ID  45970076
459800                       SET PS-ODD-UNITS-ADJUSTMENT TO TRUE        45980076
459900                     END-IF                                       45990076
460000                 END-IF                                           46000076
460100                 IF PACK-ODD-UNITS (LINE-IDX) NOT =               46010076
460200                          RC806-ODD-UNITS (RC806-LINE-IDX)        46020076
460300                     MOVE PACK-ODD-UNITS (LINE-IDX) TO            46030076
460400                                             PV-BEFORE-ODD-UNT-QTY46040076
460500                     COMPUTE PV-AFTER-ODD-UNT-QTY =               46050076
460600                          RC806-ODD-UNITS (RC806-LINE-IDX)        46060076
460700                                           + PV-AFTER-ODD-UNT-QTY 46070076
460800                     COMPUTE PV-ODD-DIFF =                        46080076
460900                         (RC806-ODD-UNITS (RC806-LINE-IDX)        46090076
461000                            - PACK-ODD-UNITS (LINE-IDX))          46100076
461100                            + PV-ODD-DIFF                         46110076
461200                     SET PS-ODD-UNITS-ADJUSTMENT TO TRUE          46120076
461300                     MOVE PACK-PRPPK-ID (LINE-IDX)                46130076
461400                                             TO PV-PACK-ID        46140076
461500                 END-IF                                           46150076
461600                 PERFORM 2300-UPDATE-CARTON                       46160076
461700                 IF PS-BACK-OUT-UPDATES                           46170076
461800                     MOVE PACK-CRTN-QTY (LINE-IDX) TO             46180076
461900                          PACK-AUDIT-QTY (LINE-IDX)               46190076
462000                     MOVE PACK-PRPPK-ID (LINE-IDX) TO             46200076
462100                          PV-SAVE-PRPPK-ID                        46210076
462200                     PERFORM 5980-UPDATE-PACK                     46220076
462300                          VARYING PV-UPDATE-LINE-IDX FROM 1 BY 1  46230076
462400                         UNTIL PACK-LINE (PV-UPDATE-LINE-IDX) = 0 46240076
462500                         OR PV-UPDATE-LINE-IDX > 500              46250076
462600                 END-IF                                           46260076
462700                 IF (PACK-ODD-UNITS (LINE-IDX) NOT =              46270076
462800                          RC806-ODD-UNITS (RC806-LINE-IDX)) AND   46280076
462900                    PS-DONT-BACK-OUT-UPDATES AND                  46290078
463000                    PACK-LINE (LINE-IDX) NOT = 999999999          46300078
463100                     SET PS-ODD-UNITS-PROCESSED TO TRUE           46310076
463200                     IF PACK-ODD-UNITS (LINE-IDX) = 0             46320076
463300                         SET PS-ODD-UNITS-ADDED TO TRUE           46330076
463400                     END-IF                                       46340076
463500                     IF RC806-ODD-UNITS (RC806-LINE-IDX) > 0      46350076
463600                         SET PS-ODD-UNITS-EXIST TO TRUE           46360076
463700                     END-IF                                       46370076
463800                 END-IF                                           46380076
463900                 IF PV-SAVE-NBR-OF-PACKS                          46390076
464000                       NOT = RC806-BEST-CASE-PACKS                46400076
464100                    AND PS-DONT-BACK-OUT-UPDATES AND              46410078
464200                    PACK-LINE (LINE-IDX) NOT = 999999999          46420078
464300                     IF PACK-EXPECTED-IN-CARTON-IND (LINE-IDX)    46430076
464400                                                        = 'N'     46440076
464500                         SET PS-ODD-UNITS-PROCESSED TO TRUE       46450083
464600                         IF RC806-BEST-CASE-PACKS > 0             46460083
464700                             SET PS-ODD-UNITS-ADDED      TO TRUE  46470083
464800                         END-IF                                   46480083
464900                     ELSE                                         46490076
465000                       IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A' 46500076
465100                           MOVE PV-PACK-DIFF  TO PV-SAVE-PACK-DIFF46510076
465200                           SET PS-UPDATE-NBR-PACKS   TO TRUE      46520076
465300                           MOVE PV-PACK-ID    TO PV-SAVE-PACK-ID  46530076
465400                       END-IF                                     46540076
465500                     END-IF                                       46550076
465600                 END-IF                                           46560076
465700                 SET PS-OVER-SHORT-ERROR TO TRUE                  46570076
465800             ELSE                                                 46580076
465900***     CARTON VALUE = 0 AND AUDIT VALUE > 0                      46590076
466000                 MOVE RC806-RCVG-QTY (RC806-LINE-IDX)             46600076
466100                                      TO SUQADJ-ADJ-AFT-QTY       46610076
466200                                         PV-AFTER-QTY             46620076
466300                                         PV-ADJUST-QTY            46630076
466400                 MOVE 0               TO SUQADJ-ADJ-BEF-QTY       46640076
466500                                         PV-BEFORE-QTY            46650076
466600                 MOVE PACK-AUD-HOLD-UPC (LINE-IDX)                46660076
466700                                            TO DK-UPC-NBR         46670076
466800                                             PV-AUDIT-HOLD-UPC-NBR46680076
466900                 MOVE PACK-AUD-INTR-UPC  (LINE-IDX)               46690076
467000                                              TO DK-INTR-UPC      46700076
467100                                                 PV-AUDIT-INTR-UPC46710076
467200                 MOVE PACK-AUD-REC-TYPE (LINE-IDX)                46720076
467300                                              TO PV-AUDIT-REC-TYPE46730076
467400                 MOVE PACK-LINE (LINE-IDX)                        46740076
467500                                      TO PV-SAVE-ORD-LNE-NBR      46750076
467600***  ONLY CALCULATE PACK DIFFERENCES IF THE ITEMS WHERE EXPECTED  46760076
467700***  IN THE CARTON                                                46770076
467800                 IF  PV-SAVE-NBR-OF-PACKS NOT =                   46780076
467900                                           RC806-BEST-CASE-PACKS  46790076
468000                     IF PACK-EXPECTED-IN-CARTON-IND (LINE-IDX)    46800076
468100                                                = 'Y'             46810076
468200                       COMPUTE PV-PACK-DIFF =                     46820076
468300                          RC806-BEST-CASE-PACKS -                 46830076
468400                                          PV-SAVE-NBR-OF-PACKS    46840076
468500                       SET PS-PACK-ADJUSTMENT TO TRUE             46850076
468600                       MOVE PACK-PRPPK-ID (LINE-IDX)              46860076
468700                                               TO PV-PACK-ID      46870076
468800                       IF PACK-PREPK-DRV-LNE-CDE(LINE-IDX) = 'A'  46880076
468900                           SET PS-PREPACK-DRIVER TO TRUE          46890076
469000                       END-IF                                     46900076
469100                     ELSE                                         46910076
469200                       MOVE 0  TO          PV-BEFORE-ODD-UNT-QTY  46920076
469300                       COMPUTE PV-PACK-DIFF =                     46930076
469400                          RC806-BEST-CASE-PACKS -                 46940076
469500                                            PV-SAVE-NBR-OF-PACKS  46950076
469600                       COMPUTE PV-AFTER-ODD-UNT-QTY =             46960084
469700                           (PV-PACK-DIFF * PACK-RATO (LINE-IDX))  46970076
469800                       MOVE PV-AFTER-ODD-UNT-QTY TO               46980084
469900                                           PV-ODD-DIFF            46990076
470000                       MOVE PACK-PRPPK-ID (LINE-IDX)              47000076
470100                                                   TO PV-PACK-ID  47010076
470200                       SET PS-ODD-UNITS-ADJUSTMENT TO TRUE        47020076
470300                     END-IF                                       47030076
470400                 END-IF                                           47040076
470500                 IF PACK-ODD-UNITS (LINE-IDX) NOT =               47050076
470600                              RC806-ODD-UNITS (RC806-LINE-IDX)    47060076
470700                     MOVE PACK-ODD-UNITS (LINE-IDX) TO            47070076
470800                                             PV-BEFORE-ODD-UNT-QTY47080076
470900                     COMPUTE PV-AFTER-ODD-UNT-QTY =               47090076
471000                          RC806-ODD-UNITS (RC806-LINE-IDX)        47100076
471100                                           + PV-AFTER-ODD-UNT-QTY 47110076
471200                     COMPUTE PV-ODD-DIFF =                        47120076
471300                          RC806-ODD-UNITS (RC806-LINE-IDX)        47130076
471400                                           + PV-ODD-DIFF          47140076
471500                     SET PS-ODD-UNITS-ADJUSTMENT TO TRUE          47150076
471600                     MOVE PACK-PRPPK-ID (LINE-IDX)                47160076
471700                                             TO PV-PACK-ID        47170076
471800                 END-IF                                           47180076
471900                 PERFORM 2400-ADD-NEW-UPC                         47190076
472000                 IF PS-BACK-OUT-UPDATES                           47200076
472100                     MOVE PACK-CRTN-QTY (LINE-IDX) TO             47210076
472200                          PACK-AUDIT-QTY (LINE-IDX)               47220076
472300                     MOVE PACK-PRPPK-ID (LINE-IDX) TO             47230076
472400                          PV-SAVE-PRPPK-ID                        47240076
472500                     PERFORM 5980-UPDATE-PACK                     47250076
472600                          VARYING PV-UPDATE-LINE-IDX FROM 1 BY 1  47260076
472700                         UNTIL PACK-LINE (PV-UPDATE-LINE-IDX) = 0 47270076
472800                         OR PV-UPDATE-LINE-IDX > 500              47280076
472900                 END-IF                                           47290076
473000                 IF (PACK-ODD-UNITS (LINE-IDX) NOT =              47300076
473100                          RC806-ODD-UNITS (RC806-LINE-IDX)) AND   47310076
473200                    PS-DONT-BACK-OUT-UPDATES AND                  47320078
473300                    PACK-LINE (LINE-IDX) NOT = 999999999          47330078
473400                     SET PS-ODD-UNITS-PROCESSED TO TRUE           47340076
473500                     IF PACK-ODD-UNITS (LINE-IDX) = 0             47350076
473600                         SET PS-ODD-UNITS-ADDED TO TRUE           47360076
473700                     END-IF                                       47370076
473800                     IF RC806-ODD-UNITS (RC806-LINE-IDX) > 0      47380076
473900                         SET PS-ODD-UNITS-EXIST TO TRUE           47390076
474000                     END-IF                                       47400076
474100                 END-IF                                           47410076
474200                 IF PV-SUM-SHPD-QTY > 0 AND                       47420076
474300                    PV-SAVE-NBR-OF-PACKS                          47430076
474400                       NOT = RC806-BEST-CASE-PACKS AND            47440076
474500                    PS-DONT-BACK-OUT-UPDATES AND                  47450078
474600                    PACK-LINE (LINE-IDX) NOT = 999999999          47460078
474700                     IF PACK-EXPECTED-IN-CARTON-IND (LINE-IDX)    47470076
474800                                                        = 'N'     47480076
474900                         SET PS-ODD-UNITS-PROCESSED TO TRUE       47490083
475000                         IF RC806-BEST-CASE-PACKS > 0             47500083
475100                             SET PS-ODD-UNITS-ADDED      TO TRUE  47510083
475200                         END-IF                                   47520083
475300                     ELSE                                         47530076
475400                       IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A' 47540076
475500                           MOVE PV-PACK-DIFF  TO PV-SAVE-PACK-DIFF47550076
475600                           SET PS-UPDATE-NBR-PACKS   TO TRUE      47560076
475700                           MOVE PV-PACK-ID    TO PV-SAVE-PACK-ID  47570076
475800                       END-IF                                     47580076
475900                     END-IF                                       47590076
476000                 END-IF                                           47600076
476100                 SET PS-OVER-SHORT-ERROR TO TRUE                  47610076
476200             END-IF                                               47620076
476300         END-IF                                                   47630076
476400     END-IF.                                                      47640076
476500     SET LINE-IDX UP BY 1.                                        47650076
476600     SET PS-NOT-PREPACK-DRIVER TO TRUE.                           47660076
476700                                                                  47670076
476800 5900-PROCESS-OTBND-PK.                                           47680076
476900     MOVE PV-SAVE-PACK-ID   TO PV-PACK-ID.                        47690076
477000     PERFORM 5950-SELECT-PACK-SKU.                                47700076
477100     SET PS-NO-OTBND-PK-FOUND TO TRUE.                            47710076
477200     PERFORM 5920-SELECT-OTBND-PK.                                47720076
477300     IF PS-OTBND-PK-FOUND                                         47730076
477400         IF PV-PACK-DIFF < 0                                      47740076
477500             COMPUTE SUT00041-SHPD-PK-QTY =                       47750076
477600                       SUT00041-SHPD-PK-QTY + PV-PACK-DIFF        47760076
477700             IF SUT00041-SHPD-PK-QTY < 0                          47770076
477800                 MOVE 0    TO SUT00041-SHPD-PK-QTY                47780076
477900             END-IF                                               47790076
478000             PERFORM 5940-UPDATE-OTBND-PK                         47800076
478100         ELSE                                                     47810076
478200             COMPUTE SUT00041-SHPD-PK-QTY =                       47820076
478300                       SUT00041-SHPD-PK-QTY + PV-PACK-DIFF        47830076
478400             PERFORM 5940-UPDATE-OTBND-PK                         47840076
478500     ELSE                                                         47850076
478600         IF PV-PACK-DIFF > 0                                      47860076
478700             PERFORM 5960-INSERT-OTBND-PK                         47870076
478800         END-IF                                                   47880076
478900     END-IF.                                                      47890076
479000                                                                  47900076
479100 5920-SELECT-OTBND-PK.                                            47910076
479200                                                                  47920076
479300     EXEC SQL                                                     47930076
479400         SELECT SHPD_PK_QTY                                       47940076
479500         INTO   :SUT00041-SHPD-PK-QTY                             47950076
479600         FROM SUT_OTBND_PK                                        47960076
479700         WHERE  SHIPT_UNT_ID = :DK-OTBND-SHIPT-UNT-ID             47970076
479800           AND  TRN_NBR      = :DK-PO-NBR                         47980076
479900           AND  RCVR_SEQ_NBR = :DK-RCVR-SEQ-NBR                   47990076
480000           AND  PK_SKU_NBR   = :POPRPK-PK-SKU-NBR                 48000076
480100     END-EXEC.                                                    48010076
480200                                                                  48020076
480300     EVALUATE TRUE                                                48030076
480400        WHEN SQLCODE = ZERO                                       48040076
480500            SET PS-OTBND-PK-FOUND    TO TRUE                      48050076
480600        WHEN SQLCODE = +100                                       48060076
480700           CONTINUE                                               48070076
480800        WHEN OTHER                                                48080076
480900             SET PS-ERROR                                         48090076
481000                 SU034-INVALID-SQL    TO TRUE                     48100076
481100             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     48110076
481200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       48120076
481300             STRING   ' SUKUT701-5920-'                           48130076
481400                      ' CALLED BY-'                               48140076
481500                      SU034-PROGRAM-NAME                          48150076
481600                      '  SQLCODE='                                48160076
481700                      PV-DISPLAY-SQLCODE                          48170076
481800                      ' '                                         48180076
481900                      PV-DISP-SHIPT-UNT-ID                        48190076
482000                      DELIMITED BY SIZE                           48200076
482100                                      INTO SU034-CRA-RET-MSG      48210076
482200             PERFORM 9999-WRITE-TO-CSSL                           48220076
482300             MOVE '5920-'                TO SU034-CRA-REQ-ID      48230076
482400             SET SU034-INVALID-SQL TO TRUE                        48240076
482500             PERFORM 9998-RETURN                                  48250076
482600     END-EVALUATE.                                                48260076
482700                                                                  48270076
482800 5940-UPDATE-OTBND-PK.                                            48280076
482900                                                                  48290076
483000     EXEC SQL                                                     48300076
483100         UPDATE SUT_OTBND_PK                                      48310076
483200         SET    SHPD_PK_QTY       = :SUT00041-SHPD-PK-QTY         48320076
483300         WHERE  SHIPT_UNT_ID = :DK-OTBND-SHIPT-UNT-ID             48330076
483400     END-EXEC.                                                    48340076
483500                                                                  48350076
483600     EVALUATE TRUE                                                48360076
483700        WHEN SQLCODE = ZERO                                       48370076
483800           CONTINUE                                               48380076
483900        WHEN OTHER                                                48390076
484000             SET PS-ERROR                                         48400076
484100                 SU034-INVALID-SQL    TO TRUE                     48410076
484200             MOVE DK-OTBND-SHIPT-UNT-ID                           48420076
484300                                      TO PV-DISP-SHIPT-UNT-ID     48430076
484400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       48440076
484500             STRING   ' SUKUT701-5940-'                           48450076
484600                      ' CALLED BY-'                               48460076
484700                      SU034-PROGRAM-NAME                          48470076
484800                      '  SQLCODE='                                48480076
484900                      PV-DISPLAY-SQLCODE                          48490076
485000                      ' '                                         48500076
485100                      PV-DISP-SHIPT-UNT-ID                        48510076
485200                      DELIMITED BY SIZE                           48520076
485300                                      INTO SU034-CRA-RET-MSG      48530076
485400             PERFORM 9999-WRITE-TO-CSSL                           48540076
485500             MOVE '5940-'                TO SU034-CRA-REQ-ID      48550076
485600             SET SU034-INVALID-SQL TO TRUE                        48560076
485700             PERFORM 9998-RETURN                                  48570076
485800     END-EVALUATE.                                                48580076
485900                                                                  48590076
486000 5950-SELECT-PACK-SKU.                                            48600076
486100                                                                  48610076
486200     EXEC SQL                                                     48620076
486300         SELECT PK_SKU_NBR                                        48630076
486400         INTO   :POPRPK-PK-SKU-NBR                                48640076
486500         FROM TPOPRPK                                             48650076
486600         WHERE  PO_NBR       = :DK-PO-NBR                         48660076
486700           AND  PO_PREPK_ID  = :PV-PACK-ID                        48670076
486800     END-EXEC.                                                    48680076
486900                                                                  48690076
487000     EVALUATE TRUE                                                48700076
487100        WHEN SQLCODE = ZERO                                       48710076
487200           CONTINUE                                               48720076
487300        WHEN OTHER                                                48730076
487400             SET PS-ERROR                                         48740076
487500                 SU034-INVALID-SQL    TO TRUE                     48750076
487600             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     48760076
487700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       48770076
487800             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        48780076
487900             MOVE PV-PACK-ID          TO PV-DISPLAY-PACK-ID       48790076
488000             STRING   ' SUKUT701-5950-'                           48800076
488100                      ' CALLED BY-'                               48810076
488200                      SU034-PROGRAM-NAME                          48820076
488300                      '  SQLCODE='                                48830076
488400                      PV-DISPLAY-SQLCODE                          48840076
488500                      ' '                                         48850076
488600                      PV-DISP-SHIPT-UNT-ID                        48860076
488700                      ' '                                         48870076
488800                      PV-DISPLAY-PO-NBR                           48880076
488900                      ' '                                         48890076
489000                      PV-DISPLAY-PACK-ID                          48900076
489100                      DELIMITED BY SIZE                           48910076
489200                                      INTO SU034-CRA-RET-MSG      48920076
489300             PERFORM 9999-WRITE-TO-CSSL                           48930076
489400             MOVE '5950-'                TO SU034-CRA-REQ-ID      48940076
489500             SET SU034-INVALID-SQL TO TRUE                        48950076
489600             PERFORM 9998-RETURN                                  48960076
489700     END-EVALUATE.                                                48970076
489800                                                                  48980076
489900 5960-INSERT-OTBND-PK.                                            48990076
490000                                                                  49000076
490100     MOVE DK-OTBND-SHIPT-UNT-ID TO SUT00041-SHIPT-UNT-ID.         49010076
490200     MOVE DK-PO-NBR             TO SUT00041-TRN-NBR.              49020076
490300     MOVE DK-RCVR-SEQ-NBR       TO SUT00041-RCVR-SEQ-NBR.         49030076
490400     MOVE 'PO'                  TO SUT00041-TRN-TYP-CDE.          49040076
490500     MOVE POPRPK-PK-SKU-NBR     TO SUT00041-PK-SKU-NBR.           49050076
490600     MOVE PV-PACK-DIFF          TO SUT00041-SHPD-PK-QTY.          49060076
490700                                                                  49070076
490800     EXEC SQL                                                     49080076
490900         INSERT INTO SUT_OTBND_PK                                 49090076
491000         (                                                        49100076
491100            SHIPT_UNT_ID                                          49110076
491200         ,  TRN_NBR                                               49120076
491300         ,  RCVR_SEQ_NBR                                          49130076
491400         ,  TRN_TYP_CDE                                           49140076
491500         ,  PK_SKU_NBR                                            49150076
491600         ,  SHPD_PK_QTY                                           49160076
491700         )                                                        49170076
491800         VALUES                                                   49180076
491900         (                                                        49190076
492000            :SUT00041-SHIPT-UNT-ID                                49200076
492100         ,  :SUT00041-TRN-NBR                                     49210076
492200         ,  :SUT00041-RCVR-SEQ-NBR                                49220076
492300         ,  :SUT00041-TRN-TYP-CDE                                 49230076
492400         ,  :SUT00041-PK-SKU-NBR                                  49240076
492500         ,  :SUT00041-SHPD-PK-QTY                                 49250076
492600         )                                                        49260076
492700     END-EXEC.                                                    49270076
492800                                                                  49280076
492900     EVALUATE TRUE                                                49290076
493000        WHEN SQLCODE = ZERO                                       49300076
493100           CONTINUE                                               49310076
493200        WHEN OTHER                                                49320076
493300             SET PS-ERROR                                         49330076
493400                 SU034-INVALID-SQL    TO TRUE                     49340076
493500             MOVE SUT00041-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID   49350076
493600             MOVE SUT00041-TRN-NBR      TO PV-DISP-TRN-NBR        49360076
493700             MOVE SUT00041-RCVR-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR   49370076
493800             MOVE SUT00041-PK-SKU-NBR   TO PV-DISP-PK-SKU         49380076
493900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       49390076
494000             STRING   ' SUKUT701-5940-'                           49400076
494100                      ' CALLED BY-'                               49410076
494200                      SU034-PROGRAM-NAME                          49420076
494300                      '  SQLCODE='                                49430076
494400                      PV-DISPLAY-SQLCODE                          49440076
494500                      ' '                                         49450076
494600                      PV-DISP-SHIPT-UNT-ID                        49460076
494700                      ' '                                         49470076
494800                      PV-DISP-TRN-NBR                             49480076
494900                      ' '                                         49490076
495000                      PV-DISP-RCVR-SEQ-NBR                        49500076
495100                      ' '                                         49510076
495200                      PV-DISP-PK-SKU                              49520076
495300                      SUT00041-TRN-TYP-CDE                        49530076
495400                      DELIMITED BY SIZE                           49540076
495500                                      INTO SU034-CRA-RET-MSG      49550076
495600             PERFORM 9999-WRITE-TO-CSSL                           49560076
495700             MOVE '5940-'                TO SU034-CRA-REQ-ID      49570076
495800             SET SU034-INVALID-SQL TO TRUE                        49580076
495900             PERFORM 9998-RETURN                                  49590076
496000     END-EVALUATE.                                                49600076
496100                                                                  49610076
496200 5980-UPDATE-PACK.                                                49620076
496300     IF PACK-PRPPK-ID (PV-UPDATE-LINE-IDX) = PV-SAVE-PRPPK-ID     49630076
496400         MOVE 'Y' TO  PACK-BACKOUT-IND (PV-UPDATE-LINE-IDX)       49640076
496500     END-IF.                                                      49650076
496600                                                                  49660076
496700 6000-UPDATE-OTBND-CART.                                          49670076
496800                                                                  49680076
496900     EXEC SQL                                                     49690076
497000         UPDATE SUT_OTBND_CART                                    49700076
497100         SET    ODD_UNT_IND     = :SUT00024-ODD-UNT-IND           49710076
497200         WHERE  ORIG_CART_ID    = :DK-SHIPT-UNT-ID                49720076
497300           AND  ACTV_IND        = 'Y'                             49730076
497400     END-EXEC.                                                    49740076
497500                                                                  49750076
497600     EVALUATE TRUE                                                49760076
497700        WHEN SQLCODE = ZERO                                       49770076
497800            SET PS-OTBND-CART-UPDATED    TO TRUE                  49780076
497900        WHEN SQLCODE = +100                                       49790076
498000           CONTINUE                                               49800076
498100        WHEN OTHER                                                49810076
498200             SET PS-ERROR                                         49820076
498300                 SU034-INVALID-SQL    TO TRUE                     49830076
498400             MOVE DK-OTBND-SHIPT-UNT-ID                           49840076
498500                                      TO PV-DISP-SHIPT-UNT-ID     49850076
498600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       49860076
498700             STRING   ' SUKUT701-6000-'                           49870076
498800                      ' CALLED BY-'                               49880076
498900                      SU034-PROGRAM-NAME                          49890076
499000                      '  SQLCODE='                                49900076
499100                      PV-DISPLAY-SQLCODE                          49910076
499200                      ' '                                         49920076
499300                      PV-DISP-SHIPT-UNT-ID                        49930076
499400                      DELIMITED BY SIZE                           49940076
499500                                      INTO SU034-CRA-RET-MSG      49950076
499600             PERFORM 9999-WRITE-TO-CSSL                           49960076
499700             MOVE '6000-'                TO SU034-CRA-REQ-ID      49970076
499800             SET SU034-INVALID-SQL TO TRUE                        49980076
499900             PERFORM 9998-RETURN                                  49990076
500000     END-EVALUATE.                                                50000076
500100                                                                  50010076
500200                                                                  50020076
500300 6100-OPEN-PACK-CURSOR.                                           50030076
500400                                                                  50040076
500500     EXEC SQL                                                     50050076
500600         OPEN PACK-CURSOR                                         50060076
500700     END-EXEC.                                                    50070076
500800                                                                  50080076
500900     EVALUATE TRUE                                                50090076
501000         WHEN SQLCODE = ZERO                                      50100076
501100             SET PS-NOT-EOC-PAC-CSR           TO TRUE             50110076
501200                                                                  50120076
501300         WHEN SQLWARN0 NOT = SPACES                               50130076
501400         WHEN SQLCODE < ZERO                                      50140076
501500         WHEN SQLCODE > ZERO                                      50150076
501600             SET PS-ERROR                                         50160076
501700                 SU034-INVALID-SQL    TO TRUE                     50170076
501800             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          50180076
501900             MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     50190076
502000             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          50200076
502100             MOVE DK-PACK-ID          TO PV-DISP-PACK-ID          50210076
502200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       50220076
502300             STRING   ' SUKUT701-6100-'                           50230076
502400                      ' CALLED BY-'                               50240076
502500                      SU034-PROGRAM-NAME                          50250076
502600                      '  SQLCODE='                                50260076
502700                      PV-DISPLAY-SQLCODE                          50270076
502800                      ' '                                         50280076
502900                      PV-DISP-TRN-NBR                             50290076
503000                      ' '                                         50300076
503100                      PV-DISP-RCVR-SEQ-NBR                        50310076
503200                      ' '                                         50320076
503300                      DELIMITED BY SIZE                           50330076
503400                                      INTO SU034-CRA-RET-MSG      50340076
503500             PERFORM 9999-WRITE-TO-CSSL                           50350076
503600             STRING   ' SUKUT701-6100- '                          50360076
503700                      PV-DISP-OPER-UNT-ID                         50370076
503800                      ' '                                         50380076
503900                      PV-DISP-STR-NBR                             50390076
504000                      ' '                                         50400076
504100                      PV-DISP-PACK-ID                             50410076
504200                      DELIMITED BY SIZE                           50420076
504300                                      INTO SU034-CRA-RET-MSG      50430076
504400             PERFORM 9999-WRITE-TO-CSSL                           50440076
504500             MOVE '6100-'                TO SU034-CRA-REQ-ID      50450076
504600             SET SU034-INVALID-SQL TO TRUE                        50460076
504700             PERFORM 9998-RETURN                                  50470076
504800     END-EVALUATE.                                                50480076
504900                                                                  50490076
505000 6200-PROCESS-PACK-CURSOR.                                        50500076
505100     COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1.             50510076
505200     SET PS-NO-PACK-RECS-PROCESSED   TO TRUE.                     50520076
505300     PERFORM 6300-FETCH-PACK-CURSOR                               50530076
505400         VARYING LINE-IDX FROM PV-SAVE-LAST-IDX BY 1              50540076
505500         UNTIL  LINE-IDX > 500                                    50550076
505600            OR PS-EOC-PAC-CSR.                                    50560076
505700                                                                  50570076
505800     IF PS-NO-PACK-RECS-PROCESSED                                 50580076
505900         COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX - 1          50590076
506000     END-IF.                                                      50600076
506100                                                                  50610076
506200     IF LINE-IDX > 500                                            50620076
506300         STRING   ' SUKUT701-6200-'                               50630076
506400                  ' CALLED BY-'                                   50640076
506500                  SU034-PROGRAM-NAME                              50650076
506600                  ' MOVE THAN 500 ITEMS'                          50660076
506700                  DELIMITED BY SIZE                               50670076
506800                                  INTO SU034-CRA-RET-MSG          50680076
506900         PERFORM 9999-WRITE-TO-CSSL                               50690076
507000         MOVE '6200-'                TO SU034-CRA-REQ-ID          50700076
507100         SET SU034-ERROR       TO TRUE                            50710076
507200         PERFORM 9998-RETURN                                      50720076
507300     END-IF.                                                      50730076
507400                                                                  50740076
507500 6300-FETCH-PACK-CURSOR.                                          50750076
507600                                                                  50760076
507700     EXEC SQL                                                     50770076
507800          FETCH PACK-CURSOR                                       50780076
507900          INTO  :RECITM-ORD-LNE-NBR                               50790076
508000              , :RECITM-ITM-NBR                                   50800076
508100              , :RECITM-PREPK-RATO-QTY                            50810076
508200              , :RECITM-PREPK-DRV-LNE-CDE                         50820076
508300     END-EXEC.                                                    50830076
508400                                                                  50840076
508500     EVALUATE TRUE                                                50850076
508600         WHEN SQLCODE = ZERO                                      50860076
508700             SET PS-PACK-RECS-PROCESSED   TO TRUE                 50870076
508800             MOVE RECITM-ORD-LNE-NBR     TO PACK-LINE (LINE-IDX)  50880076
508900             MOVE RECITM-PREPK-RATO-QTY  TO PACK-RATO (LINE-IDX)  50890076
509000             MOVE 'Y'                    TO PACK-IND (LINE-IDX)   50900076
509100             MOVE RECITM-ITM-NBR         TO PACK-ITM (LINE-IDX)   50910076
509200             MOVE RECITM-PREPK-ID    TO PACK-PRPPK-ID (LINE-IDX)  50920076
509300             MOVE RECITM-PREPK-DRV-LNE-CDE                        50930076
509400                          TO PACK-PREPK-DRV-LNE-CDE (LINE-IDX)    50940076
509500             SET PV-SAVE-LAST-IDX  TO LINE-IDX                    50950076
509600             IF PS-EXPECTED-IN-CARTON                             50960076
509700                 MOVE 'Y' TO PACK-EXPECTED-IN-CARTON-IND(LINE-IDX)50970076
509800             ELSE                                                 50980076
509900                 MOVE 'N' TO PACK-EXPECTED-IN-CARTON-IND(LINE-IDX)50990076
510000             END-IF                                               51000076
510100                                                                  51010076
510200         WHEN SQLCODE = +100                                      51020076
510300             SET PS-EOC-PAC-CSR           TO TRUE                 51030076
510400                                                                  51040076
510500         WHEN SQLWARN0 NOT = SPACES                               51050076
510600         WHEN SQLCODE < ZERO                                      51060076
510700         WHEN SQLCODE > ZERO                                      51070076
510800             SET PS-ERROR                                         51080076
510900                 SU034-INVALID-SQL    TO TRUE                     51090076
511000             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          51100076
511100             MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     51110076
511200             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          51120076
511300             MOVE DK-PACK-ID          TO PV-DISP-PACK-ID          51130076
511400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       51140076
511500             STRING   ' SUKUT701-6300-'                           51150076
511600                      ' CALLED BY-'                               51160076
511700                      SU034-PROGRAM-NAME                          51170076
511800                      '  SQLCODE='                                51180076
511900                      PV-DISPLAY-SQLCODE                          51190076
512000                      ' '                                         51200076
512100                      PV-DISP-TRN-NBR                             51210076
512200                      ' '                                         51220076
512300                      PV-DISP-RCVR-SEQ-NBR                        51230076
512400                      ' '                                         51240076
512500                      DELIMITED BY SIZE                           51250076
512600                                      INTO SU034-CRA-RET-MSG      51260076
512700             PERFORM 9999-WRITE-TO-CSSL                           51270076
512800             STRING   ' SUKUT701-6300- '                          51280076
512900                      PV-DISP-OPER-UNT-ID                         51290076
513000                      ' '                                         51300076
513100                      PV-DISP-STR-NBR                             51310076
513200                      ' '                                         51320076
513300                      PV-DISP-PACK-ID                             51330076
513400                      DELIMITED BY SIZE                           51340076
513500                                      INTO SU034-CRA-RET-MSG      51350076
513600             PERFORM 9999-WRITE-TO-CSSL                           51360076
513700             MOVE '6300-'                TO SU034-CRA-REQ-ID      51370076
513800             SET SU034-INVALID-SQL TO TRUE                        51380076
513900             PERFORM 9998-RETURN                                  51390076
514000     END-EVALUATE.                                                51400076
514100                                                                  51410076
514200 6400-CLOSE-PACK-CURSOR.                                          51420076
514300                                                                  51430076
514400     EXEC SQL                                                     51440076
514500          CLOSE PACK-CURSOR                                       51450076
514600     END-EXEC.                                                    51460076
514700                                                                  51470076
514800     EVALUATE TRUE                                                51480076
514900         WHEN SQLCODE = ZERO                                      51490076
515000             CONTINUE                                             51500076
515100                                                                  51510076
515200         WHEN SQLWARN0 NOT = SPACES                               51520076
515300         WHEN SQLCODE < ZERO                                      51530076
515400         WHEN SQLCODE > ZERO                                      51540076
515500             SET PS-ERROR                                         51550076
515600                 SU034-INVALID-SQL    TO TRUE                     51560076
515700             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          51570076
515800             MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     51580076
515900             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          51590076
516000             MOVE DK-PACK-ID          TO PV-DISP-PACK-ID          51600076
516100             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       51610076
516200             STRING   ' SUKUT701-6400-'                           51620076
516300                      ' CALLED BY-'                               51630076
516400                      SU034-PROGRAM-NAME                          51640076
516500                      '  SQLCODE='                                51650076
516600                      PV-DISPLAY-SQLCODE                          51660076
516700                      ' '                                         51670076
516800                      PV-DISP-TRN-NBR                             51680076
516900                      ' '                                         51690076
517000                      PV-DISP-RCVR-SEQ-NBR                        51700076
517100                      ' '                                         51710076
517200                      DELIMITED BY SIZE                           51720076
517300                                      INTO SU034-CRA-RET-MSG      51730076
517400             PERFORM 9999-WRITE-TO-CSSL                           51740076
517500             STRING   ' SUKUT701-6400- '                          51750076
517600                      PV-DISP-OPER-UNT-ID                         51760076
517700                      ' '                                         51770076
517800                      PV-DISP-STR-NBR                             51780076
517900                      ' '                                         51790076
518000                      PV-DISP-PACK-ID                             51800076
518100                      DELIMITED BY SIZE                           51810076
518200                                      INTO SU034-CRA-RET-MSG      51820076
518300             PERFORM 9999-WRITE-TO-CSSL                           51830076
518400             MOVE '6400-'                TO SU034-CRA-REQ-ID      51840076
518500             SET SU034-INVALID-SQL TO TRUE                        51850076
518600             PERFORM 9998-RETURN                                  51860076
518700     END-EVALUATE.                                                51870076
518800                                                                  51880076
518900                                                                  51890076
519000                                                                  51900076
519100*----------------------------------------------------------------*51910076
519200*  LINK TO SUKUT702                                               51920076
519300*----------------------------------------------------------------*51930076
519400 7000-LINK-SUKUT702.                                              51940076
519500                                                                  51950076
519600     MOVE LENGTH OF SU035-COMM-AREA      TO PV-COMMAREA-LENGTH.   51960076
519700                                                                  51970076
519800     EXEC CICS                                                    51980076
519900         LINK PROGRAM  (PC-SUKUT702)                              51990076
520000              COMMAREA (SU035-COMM-AREA)                          52000076
520100              LENGTH   (PV-COMMAREA-LENGTH)                       52010076
520200              RESP     (PV-CICS-RESPONSE)                         52020076
520300     END-EXEC.                                                    52030076
520400                                                                  52040076
520500     EVALUATE TRUE                                                52050076
520600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 52060076
520700             IF  SU035-INVALID-SQL     OR                         52070076
520800                 SU035-DATABASE-BUSY                              52080076
520900                 STRING ' SUKUT701 - '        DELIMITED BY SIZE   52090076
521000                        '7000-LINK-SUKUT702 ' DELIMITED BY SIZE   52100076
521100                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   52110076
521200                        SU035-SUCCESS-IND     DELIMITED BY SIZE   52120076
521300                                         INTO SU034-CRA-RET-MSG   52130076
521400                 PERFORM 9999-WRITE-TO-CSSL                       52140076
521500                 MOVE '7000-'                TO SU034-CRA-REQ-ID  52150076
521600                 SET SU034-ERROR TO TRUE                          52160076
521700                 PERFORM 9998-RETURN                              52170076
521800                                                                  52180076
521900                                                                  52190076
522000             ELSE                                                 52200076
522100                 IF SU035-UPDATE-ERROR OR                         52210076
522200                    SU035-NO-CHANGE                               52220076
522300                     SET PS-BACK-OUT-UPDATES                      52230076
522400                         PS-FAILED-ADJ        TO TRUE             52240076
522500                 END-IF                                           52250076
522600             END-IF                                               52260076
522700         WHEN OTHER                                               52270076
522800             STRING ' SUKUT701 (OTHER) -' DELIMITED BY SIZE       52280076
522900                    '7000-LINK-SUKUT702 ' DELIMITED BY SIZE       52290076
523000                    ' RETURN MESSAGE - '  DELIMITED BY SIZE       52300076
523100                    SU035-SUCCESS-IND     DELIMITED BY SIZE       52310076
523200                                         INTO SU034-CRA-RET-MSG   52320076
523300             PERFORM 9999-WRITE-TO-CSSL                           52330076
523400             MOVE '7000-'                TO SU034-CRA-REQ-ID      52340076
523500             SET SU034-ERROR TO TRUE                              52350076
523600             PERFORM 9998-RETURN                                  52360076
523700                                                                  52370076
523800     END-EVALUATE.                                                52380076
523900                                                                  52390076
524000 8200-LINK-TO-UPDATE.                                             52400076
524100                                                                  52410076
524200     EXEC CICS LINK                                               52420076
524300          PROGRAM (PC-TMKCS520)                                   52430076
524400          COMMAREA(TM500-FIELDS)                                  52440076
524500          RESP    (PV-CICS-RESPONSE)                              52450076
524600     END-EXEC.                                                    52460076
524700                                                                  52470076
524800     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               52480076
524900         SET SU034-INVALID-SQL     TO TRUE                        52490076
525000         MOVE PV-CICS-RESPONSE     TO PV-DISP-OPER-UNT-ID         52500076
525100         STRING   ' SUKUT701-8200-'                               52510076
525200                  ' CALLED BY-'                                   52520076
525300                  SU034-PROGRAM-NAME                              52530076
525400                  ' CICS RESP='                                   52540076
525500                  PV-DISP-OPER-UNT-ID                             52550076
525600                  DELIMITED BY SIZE                               52560076
525700                                  INTO SU034-CRA-RET-MSG          52570076
525800         PERFORM 9999-WRITE-TO-CSSL                               52580076
525900         SET SU034-ERROR        TO TRUE                           52590076
526000     END-IF.                                                      52600076
526100                                                                  52610076
526200 8300-VALIDATION-MODULE.                                          52620076
526300                                                                  52630076
526400     EXEC CICS LINK                                               52640076
526500         PROGRAM  (PC-RCKCS806)                                   52650076
526600         COMMAREA (RC806-PRODUCT-PACK-VALIDATION)                 52660076
526700         RESP     (PV-CICS-RESPONSE)                              52670076
526800     END-EXEC.                                                    52680076
526900                                                                  52690076
527000     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        52700076
527100         CONTINUE                                                 52710076
527200     ELSE                                                         52720076
527300         MOVE PV-CICS-RESPONSE TO PV-DISP-CICS-RESPONSE           52730076
527400         STRING ' SUKUT701 -' DELIMITED BY SIZE                   52740076
527500                '8300- ' DELIMITED BY SIZE                        52750076
527600                ' RESPONSE = '  DELIMITED BY SIZE                 52760076
527700                PV-DISP-CICS-RESPONSE DELIMITED BY SIZE           52770076
527800                                     INTO SU034-CRA-RET-MSG       52780076
527900         PERFORM 9999-WRITE-TO-CSSL                               52790076
528000         MOVE '8300-'                TO SU034-CRA-REQ-ID          52800076
528100         SET SU034-ERROR TO TRUE                                  52810076
528200         PERFORM 9998-RETURN                                      52820076
528300                                                                  52830076
528400     END-IF.                                                      52840076
528500                                                                  52850076
528600*----------------------------------------------------------------*52860076
528700*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          52870076
528800*----------------------------------------------------------------*52880076
528900 8400-CHECK-IF-AUTO-VE.                                           52890076
529000                                                                  52900076
529100     INITIALIZE RC040-FIELDS.                                     52910076
529200     MOVE SU034-OPER-UNT-ID   TO RC040-SIGNON-LOCATION.           52920076
529300     MOVE SUATRN-TRN-NBR      TO RC040-PO-NBR.                    52930076
529400     MOVE PKSLIP-REC-SEQ-NBR  TO RC040-PO-RCVR.                   52940076
529500     MOVE SU034-USER-ID       TO RC040-USER-ID.                   52950076
529600     MOVE 'RCKCS220'          TO RC040-CALLING-PROGRAM.           52960076
529700                                                                  52970076
529800     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  52980076
529900                                        RC040-COMMAREA            52990076
530000                                        RC040-FIELDS.             53000076
530100                                                                  53010076
530200     EVALUATE TRUE                                                53020076
530300         WHEN RC040-SUCCESSFUL                                    53030076
530400                 MOVE RC040-AUTO-VE-SW TO PS-AUTO-VE-PO-SW        53040076
530500         WHEN OTHER                                               53050076
530600             SET SU034-INVALID-SQL     TO TRUE                    53060076
530700             STRING   ' SUKUT701-8400-'                           53070076
530800                      ' CALLED BY-'                               53080076
530900                      SU034-PROGRAM-NAME                          53090076
531000                      ' SUKUT127 RESP ='                          53100076
531100                      RC040-SUCCESS-IND                           53110076
531200                      DELIMITED BY SIZE                           53120076
531300                                      INTO SU034-CRA-RET-MSG      53130076
531400             PERFORM 9999-WRITE-TO-CSSL                           53140076
531500             SET SU034-ERROR        TO TRUE                       53150076
531600     END-EVALUATE.                                                53160076
531700                                                                  53170076
531800 9000-PROCESS-OTBND-UPC.                                          53180076
531900     PERFORM 9100-SELECT-ZERO-LINES.                              53190076
532000     IF PV-ZERO-LINE-COUNT > 0                                    53200076
532100         PERFORM 9200-PROCESS-ZERO-CURSOR                         53210076
532200     END-IF.                                                      53220076
532300                                                                  53230076
532400 9100-SELECT-ZERO-LINES.                                          53240076
532500                                                                  53250076
532600     EXEC SQL                                                     53260076
532700       SELECT COUNT(*)                                            53270076
532800         INTO                                                     53280076
532900             :PV-ZERO-LINE-COUNT                                  53290076
533000         FROM SUT_OTBND_UPC                                       53300076
533100         WHERE SHIPT_UNT_ID     = :DK-OTBND-SHIPT-UNT-ID          53310076
533200           AND TRN_LNE_NBR      = 0                               53320076
533300     END-EXEC.                                                    53330076
533400                                                                  53340076
533500     EVALUATE TRUE                                                53350076
533600         WHEN SQLCODE = +0                                        53360076
533700             CONTINUE                                             53370076
533800         WHEN SQLCODE = +100                                      53380076
533900         WHEN SQLCODE = -305                                      53390076
534000             MOVE 0  TO PV-ZERO-LINE-COUNT                        53400076
534100         WHEN SQLWARN0 NOT = SPACES                               53410076
534200         WHEN SQLCODE < +0                                        53420076
534300         WHEN SQLCODE > +0                                        53430076
534400             SET PS-ERROR                                         53440076
534500                 SU034-INVALID-SQL    TO TRUE                     53450076
534600             MOVE DK-OTBND-SHIPT-UNT-ID                           53460076
534700                                      TO PV-DISP-SHIPT-UNT-ID     53470076
534800             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       53480076
534900             STRING   ' SUKUT701-9100-'                           53490076
535000                      ' CALLED BY-'                               53500076
535100                      SU034-PROGRAM-NAME                          53510076
535200                      '  SQLCODE='                                53520076
535300                      PV-DISPLAY-SQLCODE                          53530076
535400                      ' '                                         53540076
535500                      PV-DISP-SHIPT-UNT-ID                        53550076
535600                      DELIMITED BY SIZE                           53560076
535700                                      INTO SU034-CRA-RET-MSG      53570076
535800             PERFORM 9999-WRITE-TO-CSSL                           53580076
535900             MOVE '9100-'                TO SU034-CRA-REQ-ID      53590076
536000             SET SU034-INVALID-SQL TO TRUE                        53600076
536100             PERFORM 9998-RETURN                                  53610076
536200     END-EVALUATE.                                                53620076
536300                                                                  53630076
536400 9200-PROCESS-ZERO-CURSOR.                                        53640076
536500     PERFORM 9300-OPEN-ZERO-CURSOR.                               53650076
536600     PERFORM 9400-PROCESS-ZERO-CURSOR                             53660076
536700         UNTIL PS-EOC-ZERO-CURSOR.                                53670076
536800     PERFORM 9600-CLOSE-ZERO-CURSOR.                              53680076
536900                                                                  53690076
537000 9300-OPEN-ZERO-CURSOR.                                           53700076
537100     EXEC SQL                                                     53710076
537200         OPEN ZERO-CSR                                            53720076
537300     END-EXEC.                                                    53730076
537400                                                                  53740076
537500     EVALUATE TRUE                                                53750076
537600         WHEN SQLCODE = ZERO                                      53760076
537700             SET PS-NOT-EOC-ZERO-CURSOR       TO TRUE             53770076
537800                                                                  53780076
537900         WHEN SQLWARN0 NOT = SPACES                               53790076
538000         WHEN SQLCODE < ZERO                                      53800076
538100         WHEN SQLCODE > ZERO                                      53810076
538200             SET PS-ERROR                                         53820076
538300                 SU034-INVALID-SQL    TO TRUE                     53830076
538400             MOVE DK-OTBND-SHIPT-UNT-ID                           53840076
538500                                      TO PV-DISP-SHIPT-UNT-ID     53850076
538600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       53860076
538700             STRING   ' SUKUT701-9300-'                           53870076
538800                      ' CALLED BY-'                               53880076
538900                      SU034-PROGRAM-NAME                          53890076
539000                      '  SQLCODE='                                53900076
539100                      PV-DISPLAY-SQLCODE                          53910076
539200                      ' '                                         53920076
539300                      PV-DISP-SHIPT-UNT-ID                        53930076
539400                      DELIMITED BY SIZE                           53940076
539500                                      INTO SU034-CRA-RET-MSG      53950076
539600             PERFORM 9999-WRITE-TO-CSSL                           53960076
539700             MOVE '9300-'                TO SU034-CRA-REQ-ID      53970076
539800             SET SU034-INVALID-SQL TO TRUE                        53980076
539900             PERFORM 9998-RETURN                                  53990076
540000     END-EVALUATE.                                                54000076
540100                                                                  54010076
540200 9400-PROCESS-ZERO-CURSOR.                                        54020076
540300     PERFORM 9500-FETCH-ZERO-CURSOR.                              54030076
540400     IF NOT PS-EOC-ZERO-CURSOR                                    54040076
540500         IF SUT00028-TRN-LNE-NBR = 0                              54050076
540600             MOVE XLT00006-INTR-UPC-ID   TO PV-SAVE-INTR-UPC      54060076
540700             MOVE SUT00028-UPC-NBR       TO PV-SAVE-UPC-NBR       54070076
540800         ELSE                                                     54080076
540900             IF XLT00006-INTR-UPC-ID = PV-SAVE-INTR-UPC AND       54090076
541000                SUT00028-TRN-LNE-NBR > 0                          54100076
541100                 PERFORM 9700-DELETE-OTBND-UPC                    54110076
541200                 MOVE 0                  TO PV-SAVE-UPC-NBR       54120076
541300             ELSE                                                 54130076
541400                 IF PV-SAVE-UPC-NBR > 0                           54140076
541500                     PERFORM 9800-SELECT-ITEM-NBR                 54150076
541600                     IF PS-ITM-NBR-FOUND                          54160076
541700                         MOVE XLT00003-ITM-NBR TO DK-ITM-NBR      54170076
541800                         PERFORM 9900-SELECT-RECITM               54180076
541900                         IF PS-RECITM-FOUND                       54190076
542000                             PERFORM 9700-DELETE-OTBND-UPC        54200076
542100                         END-IF                                   54210076
542200                         MOVE 0          TO PV-SAVE-UPC-NBR       54220076
542300                     ELSE                                         54230076
542400                         MOVE 0          TO PV-SAVE-UPC-NBR       54240076
542500                     END-IF                                       54250076
542600                 END-IF                                           54260076
542700             END-IF                                               54270076
542800         END-IF                                                   54280076
542900     END-IF.                                                      54290076
543000 9500-FETCH-ZERO-CURSOR.                                          54300076
543100                                                                  54310076
543200     EXEC SQL                                                     54320076
543300         FETCH ZERO-CSR                                           54330076
543400         INTO    :SUT00028-TRN-LNE-NBR                            54340076
543500             ,   :XLT00006-INTR-UPC-ID                            54350076
543600             ,   :SUT00028-UPC-NBR                                54360076
543700     END-EXEC.                                                    54370076
543800                                                                  54380076
543900     EVALUATE TRUE                                                54390076
544000         WHEN SQLCODE = ZERO                                      54400076
544100             CONTINUE                                             54410076
544200                                                                  54420076
544300         WHEN SQLCODE = +100                                      54430076
544400             SET PS-EOC-ZERO-CURSOR          TO TRUE              54440076
544500                                                                  54450076
544600         WHEN SQLWARN0 NOT = SPACES                               54460076
544700         WHEN SQLCODE < ZERO                                      54470076
544800         WHEN SQLCODE > ZERO                                      54480076
544900             SET PS-ERROR                                         54490076
545000                 SU034-INVALID-SQL    TO TRUE                     54500076
545100             MOVE DK-OTBND-SHIPT-UNT-ID                           54510076
545200                                      TO PV-DISP-SHIPT-UNT-ID     54520076
545300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       54530076
545400             STRING   ' SUKUT701-9500-'                           54540076
545500                      ' CALLED BY-'                               54550076
545600                      SU034-PROGRAM-NAME                          54560076
545700                      '  SQLCODE='                                54570076
545800                      PV-DISPLAY-SQLCODE                          54580076
545900                      ' '                                         54590076
546000                      PV-DISP-SHIPT-UNT-ID                        54600076
546100                      DELIMITED BY SIZE                           54610076
546200                                      INTO SU034-CRA-RET-MSG      54620076
546300             PERFORM 9999-WRITE-TO-CSSL                           54630076
546400             MOVE '9500-'                TO SU034-CRA-REQ-ID      54640076
546500             SET SU034-INVALID-SQL TO TRUE                        54650076
546600             PERFORM 9998-RETURN                                  54660076
546700     END-EVALUATE.                                                54670076
546800                                                                  54680076
546900 9600-CLOSE-ZERO-CURSOR.                                          54690076
547000                                                                  54700076
547100     EXEC SQL                                                     54710076
547200         CLOSE ZERO-CSR                                           54720076
547300     END-EXEC.                                                    54730076
547400                                                                  54740076
547500     EVALUATE TRUE                                                54750076
547600         WHEN SQLCODE = ZERO                                      54760076
547700             CONTINUE                                             54770076
547800                                                                  54780076
547900         WHEN SQLWARN0 NOT = SPACES                               54790076
548000         WHEN SQLCODE < ZERO                                      54800076
548100         WHEN SQLCODE > ZERO                                      54810076
548200             SET PS-ERROR                                         54820076
548300                 SU034-INVALID-SQL    TO TRUE                     54830076
548400             MOVE DK-OTBND-SHIPT-UNT-ID                           54840076
548500                                      TO PV-DISP-SHIPT-UNT-ID     54850076
548600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       54860076
548700             STRING   ' SUKUT701-9600-'                           54870076
548800                      ' CALLED BY-'                               54880076
548900                      SU034-PROGRAM-NAME                          54890076
549000                      '  SQLCODE='                                54900076
549100                      PV-DISPLAY-SQLCODE                          54910076
549200                      ' '                                         54920076
549300                      PV-DISP-SHIPT-UNT-ID                        54930076
549400                      DELIMITED BY SIZE                           54940076
549500                                      INTO SU034-CRA-RET-MSG      54950076
549600             PERFORM 9999-WRITE-TO-CSSL                           54960076
549700             MOVE '9600-'                TO SU034-CRA-REQ-ID      54970076
549800             SET SU034-INVALID-SQL TO TRUE                        54980076
549900             PERFORM 9998-RETURN                                  54990076
550000     END-EVALUATE.                                                55000076
550100                                                                  55010076
550200 9700-DELETE-OTBND-UPC.                                           55020076
550300                                                                  55030076
550400     EXEC SQL                                                     55040076
550500        DELETE                                                    55050076
550600         FROM SUT_OTBND_UPC                                       55060076
550700        WHERE SHIPT_UNT_ID       = :DK-OTBND-SHIPT-UNT-ID         55070076
550800          AND UPC_NBR            = :PV-SAVE-UPC-NBR               55080076
550900     END-EXEC.                                                    55090076
551000                                                                  55100076
551100     EVALUATE TRUE                                                55110076
551200         WHEN SQLCODE = ZERO                                      55120076
551300             CONTINUE                                             55130076
551400                                                                  55140076
551500         WHEN SQLWARN0 NOT = SPACES                               55150076
551600         WHEN SQLCODE < ZERO                                      55160076
551700         WHEN SQLCODE > ZERO                                      55170076
551800             SET PS-ERROR                                         55180076
551900                 SU034-INVALID-SQL    TO TRUE                     55190076
552000             MOVE DK-OTBND-SHIPT-UNT-ID                           55200076
552100                                      TO PV-DISP-SHIPT-UNT-ID     55210076
552200             MOVE PV-SAVE-UPC-NBR     TO PV-DISPLAY-UPC-NBR       55220076
552300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       55230076
552400             STRING   ' SUKUT701-9700-'                           55240076
552500                      ' CALLED BY-'                               55250076
552600                      SU034-PROGRAM-NAME                          55260076
552700                      '  SQLCODE='                                55270076
552800                      PV-DISPLAY-SQLCODE                          55280076
552900                      ' '                                         55290076
553000                      PV-DISP-SHIPT-UNT-ID                        55300076
553100                      ' '                                         55310076
553200                      PV-DISPLAY-UPC-NBR                          55320076
553300                      DELIMITED BY SIZE                           55330076
553400                                      INTO SU034-CRA-RET-MSG      55340076
553500             PERFORM 9999-WRITE-TO-CSSL                           55350076
553600             MOVE '9700-'                TO SU034-CRA-REQ-ID      55360076
553700             SET SU034-INVALID-SQL TO TRUE                        55370076
553800             PERFORM 9998-RETURN                                  55380076
553900     END-EVALUATE.                                                55390076
554000                                                                  55400076
554100 9800-SELECT-ITEM-NBR.                                            55410076
554200                                                                  55420076
554300     EXEC SQL                                                     55430076
554400        SELECT B.ITM_NBR                                          55440076
554500          INTO :XLT00003-ITM-NBR                                  55450076
554600         FROM XLT_UPC A                                           55460076
554700           ,  XLT_SKU B                                           55470076
554800        WHERE A.UPC_NBR          = :PV-SAVE-UPC-NBR               55480076
554900          AND A.INTR_UPC_ID      = B.INTR_UPC_ID                  55490076
555000     END-EXEC.                                                    55500076
555100                                                                  55510076
555200     EVALUATE TRUE                                                55520076
555300         WHEN SQLCODE = ZERO                                      55530076
555400             SET PS-ITM-NBR-FOUND TO TRUE                         55540076
555500                                                                  55550076
555600         WHEN SQLCODE = +100                                      55560076
555700             SET PS-ITM-NBR-NOT-FOUND TO TRUE                     55570076
555800                                                                  55580076
555900         WHEN SQLWARN0 NOT = SPACES                               55590076
556000         WHEN SQLCODE < ZERO                                      55600076
556100         WHEN SQLCODE > ZERO                                      55610076
556200             SET PS-ERROR                                         55620076
556300                 SU034-INVALID-SQL    TO TRUE                     55630076
556400             MOVE SUT00028-UPC-NBR    TO PV-DISPLAY-UPC-NBR       55640076
556500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       55650076
556600             STRING   ' SUKUT701-9800-'                           55660076
556700                      ' CALLED BY-'                               55670076
556800                      SU034-PROGRAM-NAME                          55680076
556900                      '  SQLCODE='                                55690076
557000                      PV-DISPLAY-SQLCODE                          55700076
557100                      ' '                                         55710076
557200                      PV-DISPLAY-UPC-NBR                          55720076
557300                      DELIMITED BY SIZE                           55730076
557400                                      INTO SU034-CRA-RET-MSG      55740076
557500             PERFORM 9999-WRITE-TO-CSSL                           55750076
557600             MOVE '9800-'                TO SU034-CRA-REQ-ID      55760076
557700             SET SU034-INVALID-SQL TO TRUE                        55770076
557800             PERFORM 9998-RETURN                                  55780076
557900     END-EVALUATE.                                                55790076
558000                                                                  55800076
558100 9900-SELECT-RECITM.                                              55810076
558200                                                                  55820076
558300     EXEC SQL                                                     55830076
558400          SELECT  DISTINCT                                        55840076
558500                  ORD_LNE_NBR                                     55850076
558600            INTO  :RECITM-ORD-LNE-NBR                             55860076
558700            FROM  TRECITM                                         55870076
558800           WHERE  ORD_NBR          =  :DK-PO-NBR                  55880076
558900             AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            55890076
559000             AND  VER_STATUS_CDE   =  'A'                         55900076
559100             AND  ITM_NBR          =  :DK-ITM-NBR                 55910076
559200     END-EXEC.                                                    55920076
559300                                                                  55930076
559400     EVALUATE TRUE                                                55940076
559500         WHEN SQLCODE = ZERO                                      55950076
559600         WHEN SQLCODE = -811                                      55960076
559700             SET PS-RECITM-FOUND TO TRUE                          55970076
559800             MOVE RECITM-ORD-LNE-NBR    TO DK-TRN-LNE-NBR         55980076
559900                                                                  55990076
560000         WHEN SQLCODE = +100                                      56000076
560100             SET PS-RECITM-NOT-FOUND  TO TRUE                     56010076
560200             MOVE 0                     TO DK-TRN-LNE-NBR         56020076
560300                                                                  56030076
560400         WHEN SQLWARN0 NOT = SPACES                               56040076
560500         WHEN SQLCODE < ZERO                                      56050076
560600         WHEN SQLCODE > ZERO                                      56060076
560700             SET PS-ERROR                                         56070076
560800                 SU034-INVALID-SQL    TO TRUE                     56080076
560900             MOVE DK-PO-NBR           TO PV-DISP-TRN-NBR          56090076
561000             MOVE PV-RCVR-SEQ-NBR     TO PV-DISP-RCVR-SEQ-NBR     56100076
561100             MOVE XLT00003-ITM-NBR    TO PV-DISP-ITM-NBR          56110076
561200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       56120076
561300             STRING   ' SUKUT701-9900-'                           56130076
561400                      ' CALLED BY-'                               56140076
561500                      SU034-PROGRAM-NAME                          56150076
561600                      '  SQLCODE='                                56160076
561700                      PV-DISPLAY-SQLCODE                          56170076
561800                      ' '                                         56180076
561900                      PV-DISP-TRN-NBR                             56190076
562000                      ' '                                         56200076
562100                      PV-DISP-RCVR-SEQ-NBR                        56210076
562200                      ' '                                         56220076
562300                      PV-DISP-ITM-NBR                             56230076
562400                      DELIMITED BY SIZE                           56240076
562500                                      INTO SU034-CRA-RET-MSG      56250076
562600             PERFORM 9999-WRITE-TO-CSSL                           56260076
562700             MOVE '9900-'                TO SU034-CRA-REQ-ID      56270076
562800             SET SU034-INVALID-SQL TO TRUE                        56280076
562900             PERFORM 9998-RETURN                                  56290076
563000     END-EVALUATE.                                                56300076
563100                                                                  56310076
563200*-----------------------------------------------------------------56320076
563300*  RETURN TO CALLING PROGRAM                                      56330076
563400*-----------------------------------------------------------------56340076
563500 9998-RETURN.                                                     56350076
563600                                                                  56360076
563700     MOVE SQLCA                         TO SU034-SQLCA            56370076
563800     MOVE SU034-COMM-AREA               TO DFHCOMMAREA.           56380076
563900                                                                  56390076
564000     EXEC CICS                                                    56400076
564100          RETURN                                                  56410076
564200     END-EXEC.                                                    56420076
564300                                                                  56430076
564400 9999-WRITE-TO-CSSL.                                              56440076
564500                                                                  56450076
564600     MOVE SU034-CRA-RET-MSG       TO PV-CICS-MSG-AREA.            56460076
564700     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      56470076
564800                                                                  56480076
564900     EXEC CICS                                                    56490076
565000          WRITEQ TD                                               56500076
565100           QUEUE   ('CSSL')                                       56510076
565200            FROM   (PV-CICS-MSG-AREA)                             56520076
565300          LENGTH   (PV-COMMAREA-LENGTH)                           56530076
565400            RESP   (PV-CICS-RESPONSE)                             56540076
565500     END-EXEC.                                                    56550076
565600                                                                  56560076
