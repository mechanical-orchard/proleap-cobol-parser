000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             TMKRP006.                                00030002
000400 AUTHOR.                 TAMARA KOLTUN.                           00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            09/25/96.                                00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900***************************************************               00090000
001000*  THIS PROGRAM CREATES A DAILY UNRESOLVED TROUBLE REPORT         00100099
001100***************************************************               00110000
001100*   XLKUT071 (LOCATION DOMAIN MODULE IS USED)     *               00111099
001100***************************************************               00112099
      ***************************************************************   00112199
      *DATE: 01/30/2017 WR/IR:CHG0161125                                00112299
      *CHANGES MADE: WHEN 6300-GET-SHIP-BEFORE-DATE PARA SQL RETURNS    00113099
      *    SQLCODE -811 THEN 6305-GET-SHIP-BEFORE-DATE PARA IS CALLED   00114099
      *    TO FETCH ACTIVE VERSION OF PO IN TPLNSHP TABLE.              00115099
      *CHANGES MADE BY: SIVA (COGNIZANT)                                00115199
      ***************************************************************   00116099
001200                                                                  00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 INPUT-OUTPUT SECTION.                                            00140000
001500                                                                  00150000
001600 FILE-CONTROL.                                                    00160000
001700                                                                  00170000
001800     SELECT TROUBLE-EXTRACT-FILE      ASSIGN TO INP01.            00180052
001810     SELECT UNRSLVD-TRBL-RPT-BUYING   ASSIGN TO RPT01.            00191099
001810     SELECT UNRSLVD-TRBL-RPT-ANALYST  ASSIGN TO RPT02.            00192099
001810     SELECT UNRSLVD-TRBL-RPT-DCAREA   ASSIGN TO RPT03.            00193099
001900                                                                  00200000
002000                                                                  00210000
002100 DATA DIVISION.                                                   00220000
002200                                                                  00230000
002300 FILE SECTION.                                                    00240000
002400 FD  TROUBLE-EXTRACT-FILE                                         00250000
002500     RECORDING MODE IS F                                          00260000
002600     LABEL RECORDS ARE STANDARD                                   00270000
002700     BLOCK CONTAINS 0 RECORDS.                                    00280000
002800                                                                  00290000
002900 01  TROUBLE-EXTRACT-RECORD         PIC X(400).                   00300009
003010                                                                  00310002
003011 FD  UNRSLVD-TRBL-RPT-BUYING                                      00320099
003012     RECORDING MODE IS F                                          00330002
003013     LABEL RECORDS ARE STANDARD                                   00340002
003014     BLOCK CONTAINS 0 RECORDS.                                    00350002
003015                                                                  00360002
003016 01  UNRSLVD-TRBL-REC-BUYING         PIC X(132).                  00370099
003017                                                                  00380002
003011 FD  UNRSLVD-TRBL-RPT-ANALYST                                     00381099
003012     RECORDING MODE IS F                                          00382099
003013     LABEL RECORDS ARE STANDARD                                   00383099
003014     BLOCK CONTAINS 0 RECORDS.                                    00384099
003015                                                                  00385099
003016 01  UNRSLVD-TRBL-REC-ANALYST        PIC X(132).                  00386099
003017                                                                  00387099
003011 FD  UNRSLVD-TRBL-RPT-DCAREA                                      00388099
003012     RECORDING MODE IS F                                          00389099
003013     LABEL RECORDS ARE STANDARD                                   00389199
003014     BLOCK CONTAINS 0 RECORDS.                                    00389299
003015                                                                  00389399
003016 01  UNRSLVD-TRBL-REC-DCAREA         PIC X(132).                  00389499
003017                                                                  00389599
003100 WORKING-STORAGE SECTION.                                         00390000
003200 01  PS-SWITCHES.                                                 00400000
003300     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00410003
003400         88  PS-EOF                                VALUE 'Y'.     00420000
003500         88  PS-NOT-EOF                            VALUE 'N'.     00430000
003510     05  PS-NO-DETAILS-SW            PIC  X(01)    VALUE ' '.     00440066
003520         88  PS-NO-DETAILS                         VALUE 'N'.     00450065
003600     05  PS-REPORT-SW                PIC  X(01)    VALUE ' '.     00460003
003700         88  PS-BUYING-REPORT                      VALUE 'B'.     00470003
003800         88  PS-ANALYST-REPORT                     VALUE 'A'.     00480003
003810         88  PS-DC-REPORT                          VALUE 'D'.     00490003
003820     05  PS-FIRST-TIME-THRU-SW       PIC  X(01)    VALUE 'F'.     00500099
003830         88  PS-FIRST-TIME-THRU                    VALUE 'F'.     00510099
003840         88  PS-NOT-FIRST-TIME-THRU                VALUE 'N'.     00520099
003841     05  PS-RPT-AREA-CHANGED-SW      PIC  X(01)    VALUE ' '.     00530052
003842         88  PS-RPT-AREA-CHANGED                   VALUE 'C'.     00540052
003843         88  PS-RPT-AREA-NOT-CHANGED               VALUE 'N'.     00550052
003844                                                                  00551099
005000 01  PC-PROGRAM-CONSTANTS.                                        00560000
005100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00570000
005200                                    'TMKRP006'.                   00580003
005500     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00590000
005600                                                   COMP SYNC.     00600000
005700     05  PC-BUYING-AREA              PIC X(24)     VALUE          00610002
005800                                    '         BUYING AREA    '.   00620046
005900     05  PC-ANALYST-AREA             PIC X(24)     VALUE          00630002
006000                                    'MERCHANDISE ANALYST AREA'.   00640003
006100     05  PC-DC-AREA                  PIC X(24)     VALUE          00650002
006110                                    'DISTRIBUTION CENTER AREA'.   00660003
006120     05  PC-SPECIAL-RUN-NOTE         PIC X(27)     VALUE          00670007
006121                                    '** SPECIAL REQUESTED RUN **'.00680003
006122     05  PC-ONE                      PIC 9(01)     VALUE  1.      00690003
006123     05  PC-TWO                      PIC 9(01)     VALUE  2.      00700091
006124     05  PC-THREE                    PIC 9(01)     VALUE  3.      00710091
006125     05  PC-NOT-FOUND                PIC X(17)     VALUE          00720059
006126                                         '*** NOT FOUND ***'.     00730059
006125     05  PC-SHIP-DTE-NOT-FND         PIC X(09)     VALUE          00740093
006126                                         'NOT FOUND'.             00750093
006127     05  PC-ENROUTE                  PIC X(19)     VALUE          00760093
006128                                         '*** ENROUTE ***    '.   00770093
006130 01  PV-PROGRAM-VARIABLES.                                        00780093
006140     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00790000
006150                                                   COMP SYNC.     00800000
006160     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  00810000
006161     05  PV-ABEND-SQLCODE            PIC  X(10)    VALUE SPACES.  00820099
006190     05  PV-BUYING-LINE-COUNT        PIC S9(04)    VALUE +80      00840099
006200                                                   COMP SYNC.     00850000
006210     05  PV-ANALYST-LINE-COUNT       PIC S9(04)    VALUE +80      00860099
006220                                                   COMP SYNC.     00870003
006230     05  PV-DC-LINE-COUNT            PIC S9(04)    VALUE +80      00880099
006200                                                   COMP SYNC.     00880199
006190     05  PV-BUYING-PAGE-COUNT        PIC S9(04)    VALUE ZERO     00881099
006200                                                   COMP SYNC.     00882099
006210     05  PV-ANALYST-PAGE-COUNT       PIC S9(04)    VALUE ZERO     00883099
006220                                                   COMP SYNC.     00884099
006230     05  PV-DC-PAGE-COUNT            PIC S9(04)    VALUE ZERO     00885099
006220                                                   COMP SYNC.     00886099
006310     05  PV-START-DATE               PIC  X(08)    VALUE SPACE.   00890007
006311     05  PV-END-DATE                 PIC  X(08)    VALUE SPACE.   00900007
006312     05  PV-START-EXTRACT.                                        00910007
006313         10 PV-START-YYYY            PIC 9(04)     VALUE 0.       00920001
006320         10 FILLER                   PIC X(01)     VALUE SPACE.   00930001
006330         10 PV-START-MM              PIC 9(02)     VALUE 0.       00940001
006340         10 FILLER                   PIC X(01)     VALUE SPACE.   00950001
006350         10 PV-START-DD              PIC 9(02)     VALUE 0.       00960001
006360         10 FILLER                   PIC X(01)     VALUE SPACE.   00970001
006361     05  PV-END-EXTRACT.                                          00980007
006362         10 PV-END-YYYY              PIC 9(04)     VALUE 0.       00990007
006363         10 FILLER                   PIC X(01)     VALUE SPACE.   01000007
006364         10 PV-END-MM                PIC 9(02)     VALUE 0.       01010007
006365         10 FILLER                   PIC X(01)     VALUE SPACE.   01020007
006366         10 PV-END-DD                PIC 9(02)     VALUE 0.       01030007
006367         10 FILLER                   PIC X(01)     VALUE SPACE.   01040007
006370     05  PV-REPORT-DATE              PIC X(10)     VALUE SPACE.   01050001
006399     05  PV-AVG-TOT-HOURS            PIC 9(10)     VALUE 0.       01060052
006400     05  PV-AVG-TOT-MINUTES          PIC 9(10)     VALUE 0.       01070052
006401     05  PV-AVG-MINUTES              PIC 9(10)     VALUE 0.       01080052
006411     05  PV-OPER-UNT-ID-HOLD         PIC 9(04)     VALUE 0.       01090036
006440     05  PV-TMST-HOLD.                                            01130039
006441         88  PV-TMST-ENROUTE                  VALUE               01140086
006442             '9999-09-09-09.09.09.999999'.                        01150086
006450         10 PV-TMST-YYYY            PIC X(04) VALUE SPACES.       01160039
006460         10 FILLER                  PIC X(01) VALUE SPACES.       01170039
006470         10 PV-TMST-MM              PIC X(02) VALUE SPACES.       01180039
006480         10 FILLER                  PIC X(01) VALUE SPACES.       01190039
006490         10 PV-TMST-DD              PIC X(02) VALUE SPACES.       01200039
006491         10 FILLER                  PIC X(01) VALUE SPACES.       01210039
006492         10 PV-TMST-HH              PIC X(02) VALUE SPACES.       01220039
006493         10 FILLER                  PIC X(01) VALUE SPACES.       01230039
006494         10 PV-TMST-MIN             PIC X(02) VALUE SPACES.       01240039
006495         10 FILLER                  PIC X(01) VALUE SPACES.       01250039
006496         10 PV-TMST-SS              PIC X(02) VALUE SPACES.       01260039
006497         10 FILLER                  PIC X(07) VALUE SPACES.       01270039
006498     05  PV-GMM-SAVE                PIC X(02) VALUE SPACES.       01280050
006499     05  PV-DMM-SAVE                PIC X(02) VALUE SPACES.       01290050
006500     05  PV-BYR-SAVE                PIC X(03) VALUE SPACES.       01300050
006520     05  PV-DPT-SAVE                PIC X(03) VALUE SPACES.       01310052
006541     05  PV-NOTIF-DATE-SAVE         PIC  X(8) VALUE SPACES.       01320050
006542     05  PV-RPT-AREA-SAVE           PIC  X(1).                    01330099
006542         88 PV-RPT-AREA-SAVE-BUYING  VALUE 'B'.                   01331099
006542         88 PV-RPT-AREA-SAVE-ANALYST VALUE 'A'.                   01332099
006542         88 PV-RPT-AREA-SAVE-VENDOR  VALUE 'V'.                   01333099
006542         88 PV-RPT-AREA-SAVE-DC      VALUE 'D'.                   01334099
006550     05  PV-REC-SEQ-NBR-SAVE        PIC S9(9) VALUE 0 COMP.       01340050
006560     05  PV-TRBL-RSN-CDE-SAVE       PIC S9(4) VALUE 0 COMP.       01350050
006570     05  PV-PO-NBR-SAVE             PIC S9(9) VALUE 0 COMP.       01360050
006580     05  PV-ANALYST-MGR-NBR-SAVE    PIC S9(7) VALUE 0 COMP-3.     01370053
006590     05  PV-ANALYST-NBR-SAVE        PIC S9(7) VALUE 0 COMP-3.     01380053
006591     05  PV-OPER-UNT-ID-SAVE        PIC S9(4) VALUE 0 COMP.       01390074
006592     05  PV-FCLTY-AREA-ID-SAVE      PIC  X(6) VALUE 'XXXXXX'.     01400074
006600                                                                  01410003
008200     COPY DPWS132O.                                               01420000
008201                                                                  01430008
008202 01  CT-CPU-TIME.                                                 01440008
008203     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    01450008
008204     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    01460008
008205     03  FILLER                      PIC  9(04)    VALUE ZERO.    01470008
008206                                                                  01480048
008207 01  CD-CPU-DATE.                                                 01490048
008208     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    01500048
008209     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    01510048
008210     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    01520048
008211                                                                  01530008
008212 01  PA-PROGRAM-ACCUMULATORS.                                     01540005
008220     05  PA-RESOLVE-HOURS            PIC  S9(10)  VALUE 0 COMP-3. 01550052
008221     05  PA-RESOLVE-MINUTES          PIC  S9(10)  VALUE 0 COMP-3. 01560052
008260     05  PA-NBR-OF-TRBLS             PIC  S9(10)  VALUE 0 COMP-3. 01570052
008292     05  PA-TOT-OF-PRBLMS            PIC  S9(10)  VALUE 0 COMP-3. 01580052
008293     05  PA-RSLVED-TRBL              PIC  S9(10)  VALUE 0 COMP-3. 01590078
008300                                                                  01600000
008400 01  HL1-HEADING-LINE-1.                                          01610000
008500     05  FILLER                      PIC  X(02)    VALUE SPACES.  01620002
008510     05  HL1-SPECIAL-RUN-NOTE        PIC  X(27)    VALUE SPACES.  01630002
008600     05  FILLER                      PIC  X(18)    VALUE SPACES.  01640007
008610     05  FILLER                      PIC  X(30)    VALUE          01650002
008700                                 'UNRESOLVED TROUBLE REPORT FOR '.01660000
008900     05  HL1-REPORT-DATE             PIC  X(10)    VALUE SPACES.  01670000
008910     05  FILLER                      PIC  X(45)    VALUE SPACES.  01680000
009000                                                                  01690000
009100 01  HL2-HEADING-LINE-2.                                          01700000
009200     05  FILLER                      PIC  X(53)    VALUE SPACES.  01710037
009300     05  HL2-REPORT-AREA             PIC  X(24)    VALUE SPACES.  01720002
009500     05  FILLER                      PIC  X(55)    VALUE SPACES.  01730037
010000                                                                  01740000
010100 01  HL3-HEADING-LINE-3.                                          01750000
010200     05  FILLER                      PIC  X(02)    VALUE SPACES.  01760000
010300     05  FILLER                      PIC  X(04)    VALUE 'GMM:'.  01770002
010500     05  FILLER                      PIC  X(01)    VALUE SPACE.   01780000
010600     05  HL3-GMM-NBR                 PIC  X(02)    VALUE SPACE.   01790000
010800     05  FILLER                      PIC  X(02)    VALUE SPACES.  01800000
010900     05  HL3-GMM-NAME                PIC  X(20)    VALUE SPACE.   01810000
011000     05  FILLER                      PIC  X(101)   VALUE SPACES.  01820000
011090                                                                  01830000
011100 01  HL4-HEADING-LINE-4.                                          01840000
011200     05  FILLER                      PIC  X(02)    VALUE SPACES.  01850000
011300     05  FILLER                      PIC  X(04)    VALUE 'DMM:'.  01860002
011400     05  FILLER                      PIC  X(01)    VALUE SPACE.   01870000
011500     05  HL4-DMM-NBR                 PIC  X(02)    VALUE SPACE.   01880000
011600     05  FILLER                      PIC  X(02)    VALUE SPACES.  01890000
011700     05  HL4-DMM-NAME                PIC  X(20)    VALUE SPACE.   01900000
011710     05  FILLER                      PIC  X(101)   VALUE SPACES.  01910000
011720                                                                  01920000
011730 01  HL5-HEADING-LINE-5.                                          01930002
011740     05  FILLER                      PIC  X(02)    VALUE SPACES.  01940000
011750     05  FILLER                      PIC  X(04)    VALUE 'BYR:'.  01950002
011760     05  FILLER                      PIC  X(01)    VALUE SPACE.   01960000
011770     05  HL5-BYR-NBR                 PIC  X(03)    VALUE SPACE.   01970002
011780     05  FILLER                      PIC  X(01)    VALUE SPACES.  01980043
011790     05  HL5-BYR-NAME                PIC  X(20)    VALUE SPACE.   01990002
011791     05  FILLER                      PIC  X(101)   VALUE SPACES.  02000043
011792                                                                  02010002
011793 01  HL6-HEADING-LINE-6.                                          02020002
011794     05  FILLER                      PIC  X(02)  VALUE SPACES.    02030002
011795     05  FILLER                      PIC  X(16)  VALUE            02040002
011796                                            'ANALYST MANAGER:'.   02050002
011797     05  FILLER                      PIC  X(02)  VALUE SPACE.     02060002
011798     05  HL6-MNGR-NAME               PIC  X(20)  VALUE SPACE.     02070002
011799     05  FILLER                      PIC  X(92)  VALUE SPACES.    02080002
011800                                                                  02090002
011801 01  HL7-HEADING-LINE-7.                                          02100002
011802     05  FILLER                      PIC  X(02)  VALUE SPACES.    02110002
011803     05  FILLER                      PIC  X(16)  VALUE            02120002
011804                                            'ANALYST        :'.   02130002
011805     05  FILLER                      PIC  X(02)  VALUE SPACE.     02140002
011806     05  HL7-ANALYST-NAME            PIC  X(20)  VALUE SPACE.     02150008
011807     05  FILLER                      PIC  X(101) VALUE SPACES.    02160002
011808                                                                  02170002
011809 01  HL8-HEADING-LINE-8.                                          02180002
011810     05  FILLER                      PIC  X(02)  VALUE SPACES.    02190002
011811     05  FILLER                      PIC  X(03)  VALUE  'DC:'.    02200002
011813     05  FILLER                      PIC  X(02)  VALUE SPACE.     02210002
011814     05  HL8-DC-NAME                 PIC  X(05)  VALUE SPACE.     02220053
011815     05  FILLER                      PIC  X(100) VALUE SPACES.    02230002
011816                                                                  02240000
011817 01  HL9-HEADING-LINE-9.                                          02250093
011818     05  FILLER                      PIC  X(02)    VALUE SPACES.  02260000
011819     05  FILLER                      PIC  X(04)    VALUE 'DPT:'.  02270007
011820     05  FILLER                      PIC  X(01)    VALUE SPACE.   02280000
011821     05  HL9-DPT-NBR                 PIC  X(03)    VALUE SPACE.   02290093
011822     05  FILLER                      PIC  X(01)    VALUE SPACES.  02300043
011823     05  HL9-DPT-NAME                PIC  X(20)    VALUE SPACE.   02310093
011824     05  FILLER                      PIC  X(101)   VALUE SPACES.  02320043
011825                                                                  02330000
011817 01  HL11-HEADING-LINE-11.                                        02340093
011818     05  FILLER                      PIC  X(99)    VALUE SPACES.  02350093
011819     05  FILLER                      PIC  X(11)    VALUE          02360093
012200                                              'DO NOT SHIP'.      02370093
011820     05  FILLER                      PIC  X(22)    VALUE SPACE.   02380093
011825                                                                  02390093
011826 01  HL12-HEADING-LINE-12.                                        02400093
011827     05  FILLER                      PIC  X(02)    VALUE SPACES.  02410093
011830     05  FILLER                      PIC  X(11)    VALUE          02420093
011831                                                  'PO/RECEIVER'.  02430093
011840     05  FILLER                      PIC  X(04)    VALUE SPACE.   02440093
011850     05  FILLER                      PIC  X(11)    VALUE          02450007
011851                                                  'VENDOR NAME'.  02460007
011852     05  FILLER                      PIC  X(21)    VALUE SPACES.  02470093
011860     05  FILLER                      PIC  X(05)    VALUE 'FCLTY'. 02480000
011880     05  FILLER                      PIC  X(02)    VALUE SPACES.  02490093
011890     05  FILLER                      PIC  X(14)    VALUE          02500000
011900                                                 'TROUBLE REASON'.02510000
012000     05  FILLER                      PIC  X(08)    VALUE SPACES.  02520093
012100     05  FILLER                      PIC  X(17)    VALUE          02530000
012200                                              'ARRIVAL DATE/TIME'.02540000
012300     05  FILLER                      PIC  X(04)    VALUE SPACE.   02550093
012300     05  FILLER                      PIC  X(11)    VALUE          02560093
012200                                              'BEFORE DATE'.      02570093
012300     05  FILLER                      PIC  X(02)    VALUE SPACE.   02580093
012400     05  FILLER                      PIC  X(16)    VALUE          02590000
012500                                              'NOTIFY DATE/TIME'. 02600000
012510     05  FILLER                      PIC  X(04)    VALUE SPACE.   02610093
012511                                                                  02620074
012520 01  HL13-HEADING-LINE-13.                                        02630074
012530     05  FILLER                      PIC  X(02)    VALUE SPACES.  02640074
012540     05  FILLER                      PIC  X(13)    VALUE          02650074
012541                                                'PROCESS AREA:'.  02660074
012550     05  FILLER                      PIC  X(02)    VALUE SPACE.   02670074
012560     05  HL13-PROC-AREA-ID           PIC  X(06)    VALUE SPACE.   02680082
012590     05  FILLER                      PIC  X(99)    VALUE SPACES.  02690082
012591                                                                  02700074
012592 01  HL14-HEADING-LINE-14.                                        02710074
012593     05  FILLER                      PIC  X(02)    VALUE SPACES.  02720074
012594     05  FILLER                      PIC  X(11)    VALUE          02730074
012595                                                  'PO/RECEIVER'.  02740074
012596     05  FILLER                      PIC  X(06)    VALUE SPACE.   02750074
012597     05  FILLER                      PIC  X(03)    VALUE 'DPT'.   02760074
012598     05  FILLER                      PIC  X(06)    VALUE SPACE.   02770074
012599     05  FILLER                      PIC  X(11)    VALUE          02780074
012600                                                  'VENDOR NAME'.  02790074
012601     05  FILLER                      PIC  X(23)    VALUE SPACES.  02800074
012604     05  FILLER                      PIC  X(14)    VALUE          02810074
012605                                                 'TROUBLE REASON'.02820074
012606     05  FILLER                      PIC  X(10)    VALUE SPACES.  02830074
012607     05  FILLER                      PIC  X(17)    VALUE          02840074
012608                                              'ARRIVAL DATE/TIME'.02850074
012609     05  FILLER                      PIC  X(06)    VALUE SPACE.   02860074
012610     05  FILLER                      PIC  X(16)    VALUE          02870074
012611                                              'NOTIFY DATE/TIME'. 02880074
012612     05  FILLER                      PIC  X(20)    VALUE SPACE.   02890074
012620                                                                  02900000
012700 01  DL1-DETAIL-LINE-1.                                           02910000
012800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02920029
012900     05  DL1-PO-NBR                  PIC  9(08)    VALUE 0.       02930000
013000     05  FILLER                      PIC  X(01)    VALUE '-'.     02940000
013100     05  DL1-RECEIVER-NBR            PIC  9(04)    VALUE 0.       02950000
013200     05  FILLER                      PIC  X(02)    VALUE SPACES.  02960093
013300     05  DL1-VENDOR-NAME             PIC  X(30)    VALUE ZERO.    02970000
013400     05  FILLER                      PIC  X(02)    VALUE SPACES.  02980093
013500     05  DL1-FCLTY-DESC              PIC  X(05)    VALUE ZERO.    02990000
013600     05  FILLER                      PIC  X(02)    VALUE SPACES.  03000093
013700     05  DL1-TROUBLE-REASON          PIC  X(20)    VALUE ZERO.    03010000
013800     05  FILLER                      PIC  X(02)    VALUE SPACES.  03020093
013810     05  DL1-ARRIVAL-DT-TM           PIC  X(19)    VALUE ZERO.    03030000
013820     05  FILLER                      PIC  X(02)    VALUE SPACES.  03040093
013820     05  DL1-SHIP-BEFORE-DT          PIC  X(10)    VALUE SPACES.  03050093
013820     05  FILLER                      PIC  X(03)    VALUE SPACES.  03060093
013830     05  DL1-NOTIFY-DT-TM            PIC  X(19)    VALUE ZERO.    03070000
013840     05  FILLER                      PIC  X(01)    VALUE SPACES.  03080093
013841                                                                  03090074
013842 01  DL2-DETAIL-LINE-2.                                           03100074
013843     05  FILLER                      PIC  X(02)    VALUE SPACES.  03110074
013844     05  DL2-PO-NBR                  PIC  9(08)    VALUE 0.       03120075
013845     05  FILLER                      PIC  X(01)    VALUE '-'.     03130074
013846     05  DL2-RECEIVER-NBR            PIC  9(04)    VALUE 0.       03140075
013847     05  FILLER                      PIC  X(04)    VALUE SPACES.  03150074
013848     05  DL2-DEPT-NBR                PIC  X(03)    VALUE SPACE.   03160076
013849     05  FILLER                      PIC  X(06)    VALUE SPACES.  03170075
013851     05  DL2-VENDOR-NAME             PIC  X(30)    VALUE ZERO.    03180075
013852     05  FILLER                      PIC  X(04)    VALUE SPACES.  03190074
013855     05  DL2-TROUBLE-REASON          PIC  X(20)    VALUE ZERO.    03200076
013856     05  FILLER                      PIC  X(04)    VALUE SPACES.  03210074
013857     05  DL2-ARRIVAL-DT-TM           PIC  X(19)    VALUE ZERO.    03220075
013858     05  FILLER                      PIC  X(04)    VALUE SPACES.  03230074
013859     05  DL2-NOTIFY-DT-TM            PIC  X(19)    VALUE ZERO.    03240075
013860     05  FILLER                      PIC  X(03)    VALUE SPACES.  03250074
013861                                                                  03260001
013862 01  TL1-TOTAL-LINE-1.                                            03270001
013863     05  FILLER                      PIC X(02)  VALUE SPACES.     03280001
013870     05  FILLER                      PIC X(26)  VALUE             03290089
013880                             'TOTAL TROUBLE CREATED FOR '.        03300089
013890     05  TL1-DATE                    PIC X(11)  VALUE SPACES.     03310069
013891     05  FILLER                      PIC X(08)  VALUE SPACES.     03320089
013892     05  FILLER                      PIC X(01)  VALUE '-'.        03330001
013893     05  FILLER                      PIC X(01)  VALUE SPACE.      03340025
013894     05  TL1-TROUBLE-TOTAL           PIC Z(02),Z(02)9.            03350001
013895     05  FILLER                      PIC X(77)  VALUE SPACE.      03360001
013896                                                                  03370001
013897 01  TL2-TOTAL-LINE-2.                                            03380070
013898     05  FILLER                      PIC X(02)  VALUE SPACES.     03390001
013899     05  FILLER                      PIC X(26)  VALUE             03400070
013900                                   'TOTAL TROUBLE RESOLVED ON '.  03410070
013901     05  TL2-DATE                    PIC X(11)  VALUE SPACES.     03420070
013904     05  FILLER                      PIC X(08)  VALUE SPACES.     03430073
013905     05  FILLER                      PIC X(01)  VALUE '-'.        03440001
013906     05  FILLER                      PIC X(01)  VALUE SPACE.      03450025
013907     05  TL2-RESOLVED-TRBL-TOT       PIC Z(02),Z(02)9.            03460070
013910     05  FILLER                      PIC X(75)  VALUE SPACES.     03470070
013911                                                                  03480070
013912 01  TL3-TOTAL-LINE-3.                                            03490070
013913     05  FILLER                      PIC X(02)  VALUE SPACES.     03500070
013914     05  FILLER                      PIC X(32)  VALUE             03510070
013915                            'AVERAGE TIME TO RESOLVE TROUBLE '.   03520070
013916     05  FILLER                      PIC X(08)  VALUE             03530070
013917                                             '(HHH:MM)'.          03540070
013918     05  FILLER                      PIC X(05)  VALUE SPACES.     03550070
013919     05  FILLER                      PIC X(01)  VALUE '-'.        03560070
013920     05  FILLER                      PIC X(01)  VALUE SPACE.      03570070
013921     05  TL3-RESOLVE-HH-AVG          PIC Z(02)9 VALUE SPACES.     03580070
013922     05  FILLER                      PIC X(01)  VALUE ':'.        03590070
013923     05  TL3-RESOLVE-MM-AVG          PIC 9(02)  VALUE 0.          03600070
013924     05  FILLER                      PIC X(75)  VALUE SPACES.     03610070
013930                                                                  03620000
014000 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  03630000
014001                                                                  03640065
014010 01  NI-NO-INFORMATION-LINE.                                      03650065
014020     05  FILLER                      PIC X(02)  VALUE SPACE.      03660065
014030     05  FILLER                      PIC X(23)  VALUE             03670065
014040                                     '** NO DATA TO REPORT **'.   03680065
014050     05  FILLER                      PIC X(108) VALUE SPACE.      03690065
014100                                                                  03700000
015701 01  ER-END-REPORT-LINE.                                          03710062
015702     05  FILLER                      PIC X(02)  VALUE SPACE.      03720062
015703     05  FILLER                      PIC X(16)  VALUE             03730062
015704                                     '** END REPORT **'.          03740062
015705     05  FILLER                      PIC X(116) VALUE SPACE.      03750062
015710                                                                  03760062
016200     COPY DPWS004.                                                03770000
016201                                                                  03780001
016210     COPY TMRD001.                                                03790001
016215                                                                  03791099
016220** COPYBOOK FOR LOCATION CALLED MODULE                            03800099
016230     COPY XLWS071.                                                03801099
016300                                                                  03804099
017000*---------------------------------------------------------------* 03870000
017100*    DB2 AREA FOR TRECEIV                                       * 03880001
017200*---------------------------------------------------------------* 03890000
017300     EXEC SQL                                                     03900000
017400          INCLUDE TRECEIV                                         03910001
017500     END-EXEC.                                                    03920000
017000*---------------------------------------------------------------* 03930093
017100*    DB2 AREA FOR TPLNSHP                                       * 03940093
017200*---------------------------------------------------------------* 03950093
017300     EXEC SQL                                                     03960093
017400          INCLUDE TPLNSHP                                         03970093
017500     END-EXEC.                                                    03980093
018794*---------------------------------------------------------------* 03990000
018795*    DB2 AREA FOR COMMUNICATIONS                                * 04000000
018796*---------------------------------------------------------------* 04010000
018797     EXEC SQL                                                     04020000
018798          INCLUDE SQLCA                                           04030000
018799     END-EXEC.                                                    04040000
022200***************************************************************** 04050000
022300 PROCEDURE DIVISION.                                              04060000
022400***************************************************************** 04070000
022500                                                                  04080000
022600 0000-MAINLINE.                                                   04090000
022700***************************************************************** 04100000
022800*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04110000
022900***************************************************************** 04120000
023000     PERFORM 1000-INITIALIZE.                                     04130000
023100                                                                  04140000
023200     PERFORM 2000-MAIN-PROCESS                                    04150000
023300           UNTIL  PS-EOF.                                         04160007
023400                                                                  04170000
023500     PERFORM 9000-END-PROCESS THRU 9000-EXIT.                     04180009
023600                                                                  04190000
023700 0000-EXIT.  STOP RUN.                                            04200000
023800                                                                  04210000
023900 1000-INITIALIZE.                                                 04220000
023901      OPEN INPUT  TROUBLE-EXTRACT-FILE.                           04230009
023903      OPEN OUTPUT UNRSLVD-TRBL-RPT-BUYING                         04240099
023903                  UNRSLVD-TRBL-RPT-ANALYST                        04241099
023903                  UNRSLVD-TRBL-RPT-DCAREA.                        04242099
023906**** READING THE HEADER RECORD.                                   04250001
023907      READ TROUBLE-EXTRACT-FILE  INTO                             04260007
023908                                  TM001-TROUBLE-EXT-RECORD        04270001
023909          AT END                                                  04280001
023910             SET PS-EOF TO TRUE                                   04290001
023911          NOT AT END                                              04300001
023912             MOVE TM001-RUN-BEGIN-DATE  TO PV-START-EXTRACT       04310001
023913             MOVE TM001-RUN-END-DATE    TO PV-END-EXTRACT         04320001
023914             STRING                                               04330001
023915                   PV-START-MM                                    04340001
023916                   '/'                                            04350001
023917                   PV-START-DD                                    04360001
023918                   '/'                                            04370001
023920                   PV-START-YYYY                                  04380001
023930                DELIMITED BY SIZE                                 04390001
023980                INTO PV-REPORT-DATE                               04400001
023990              END-STRING                                          04410007
023991             STRING                                               04420007
023992                   PV-START-YYYY                                  04430007
023993                   PV-START-MM                                    04440007
023994                   PV-START-DD                                    04450007
023997                DELIMITED BY SIZE                                 04460007
023998                INTO PV-START-DATE                                04470007
023999             END-STRING                                           04480053
024000             STRING                                               04490007
024001                   PV-END-YYYY                                    04500007
024002                   PV-END-MM                                      04510007
024003                   PV-END-DD                                      04520007
024004                DELIMITED BY SIZE                                 04530007
024005                INTO PV-END-DATE                                  04540007
024006             END-STRING                                           04550053
024007             MOVE PV-REPORT-DATE     TO HL1-REPORT-DATE           04560053
024008                                        TL1-DATE                  04570053
024009                                        TL2-DATE                  04580070
024010                                                                  04590070
024100                                                                  04600001
024200     ACCEPT CT-CPU-TIME          FROM TIME.                       04610003
024300     MOVE   CT-HOUR              TO DP132O-RUN-HOUR.              04620003
024400     MOVE   CT-MINUTE            TO DP132O-RUN-MINUTE.            04630003
024410                                                                  04640001
024420     ACCEPT CD-CPU-DATE          FROM DATE.                       04650048
024421     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              04660048
024422     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             04670048
024430     MOVE CD-DAY                 TO DP132O-RUN-DAY.               04680048
024440                                                                  04690048
024500     MOVE 'TMKRP006'             TO DP132O-PROGRAM-NAME.          04700002
024600                                                                  04710003
024620     IF TM001-RUN-SPECIAL                                         04720003
024630        MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          04730003
024640     ELSE                                                         04740003
024650        MOVE SPACE               TO HL1-SPECIAL-RUN-NOTE          04750003
024660     END-IF.                                                      04760003
024661                                                                  04770003
024700 1000-EXIT.  EXIT.                                                04780000
024800                                                                  04790000
024900 2000-MAIN-PROCESS.                                               04800003
024901      READ TROUBLE-EXTRACT-FILE  INTO                             04810007
024902                                  TM001-TROUBLE-EXT-RECORD        04820003
024903          AT END                                                  04830003
024904*** SEPERATE CHECKS NEEDED TO DETERMINE WHICH, IF ANY OR ALL      04840099
024904*** REPORTS HAD NO DETAILS TO PRINT BECAUSE OF MULTIPLE           04841099
024904*** REPORT OUTPUT FILES (RPT01, RPT02 AND RPT03)                  04842099
024904            IF PV-BUYING-PAGE-COUNT   = 0                         04850099
024910               SET PS-NO-DETAILS    TO TRUE                       04870065
024911               PERFORM 6999-PRINT-HEADINGS      THRU 6999-EXIT    04880065
024912            ELSE                                                  04890065
024912               IF PV-RPT-AREA-SAVE-BUYING                         04891099
024913                   PERFORM 6000-PRINT-TOTALS THRU 6000-EXIT       04900099
024915               END-IF                                             04910099
024915            END-IF                                                04911099
024907            IF PV-ANALYST-PAGE-COUNT  = 0                         04912099
024910               SET PS-NO-DETAILS    TO TRUE                       04914099
024911               PERFORM 6999-PRINT-HEADINGS      THRU 6999-EXIT    04915099
024912            ELSE                                                  04916099
024912               IF PV-RPT-AREA-SAVE-ANALYST                        04916199
024913                   PERFORM 6000-PRINT-TOTALS THRU 6000-EXIT       04917099
024915               END-IF                                             04918099
024915            END-IF                                                04919099
024909            IF PV-DC-PAGE-COUNT       = 0                         04919299
024910               SET PS-NO-DETAILS    TO TRUE                       04919399
024911               PERFORM 6999-PRINT-HEADINGS      THRU 6999-EXIT    04919499
024912            ELSE                                                  04919599
024912               IF PV-RPT-AREA-SAVE-DC                             04919699
024913                  PERFORM 6000-PRINT-TOTALS THRU 6000-EXIT        04919799
024915               END-IF                                             04919899
024915            END-IF                                                04919999
024916            SET PS-EOF TO TRUE                                    04920067
024917          NOT AT END                                              04930003
024918             EVALUATE TRUE                                        04940052
024919                WHEN PS-FIRST-TIME-THRU                           04950052
024920                     MOVE TM001-REPORT-AREA  TO PV-RPT-AREA-SAVE  04960052
024921                WHEN PS-NOT-FIRST-TIME-THRU                       04970052
024922                     IF TM001-REPORT-AREA NOT = PV-RPT-AREA-SAVE  04980052
024923                        PERFORM 6000-PRINT-TOTALS  THRU 6000-EXIT 04990064
024924                        MOVE TM001-REPORT-AREA TO PV-RPT-AREA-SAVE05000052
024925                        SET PS-RPT-AREA-CHANGED     TO TRUE       05010052
024926                     ELSE                                         05020052
024927                        SET PS-RPT-AREA-NOT-CHANGED TO TRUE       05030052
024928                     END-IF                                       05040052
024929             END-EVALUATE                                         05050052
024930                                                                  05060052
024931             EVALUATE TRUE                                        05070003
024932                 WHEN TM001-RPT-AREA-BUYING                       05080003
024933                      PERFORM 3000-BUYING-REPORT    THRU 3000-EXIT05090007
024934                 WHEN TM001-RPT-AREA-ANALYST                      05100003
024935                      PERFORM 4000-ANALYST-AREA-RPT THRU 4000-EXIT05110007
024936                 WHEN TM001-RPT-AREA-DC                           05120008
024937                      PERFORM 5000-DC-AREA-RPT      THRU 5000-EXIT05130007
024938             END-EVALUATE                                         05140007
024940       END-READ.                                                  05150007
025000 2000-EXIT.  EXIT.                                                05160003
026200                                                                  05170000
026210 3000-BUYING-REPORT.                                              05180008
026211      SET PS-BUYING-REPORT    TO TRUE                             05190008
026229                                                                  05200005
026230      IF TM001-GMM-NBR  NOT = PV-GMM-SAVE OR                      05210016
026231         TM001-DMM-NBR  NOT = PV-DMM-SAVE OR                      05220005
026232         TM001-BYR-NBR  NOT = PV-BYR-SAVE OR                      05230052
026233         PS-RPT-AREA-CHANGED                                      05240052
026234         IF PS-FIRST-TIME-THRU                                    05250099
026235            SET PS-NOT-FIRST-TIME-THRU      TO TRUE               05260099
026236         ELSE                                                     05270014
026237            PERFORM 6000-PRINT-TOTALS          THRU 6000-EXIT     05280052
026238         END-IF                                                   05290014
026239         PERFORM 6999-PRINT-HEADINGS           THRU 6999-EXIT     05300041
026240         MOVE TM001-GMM-NBR           TO HL3-GMM-NBR              05310005
026241                                         PV-GMM-SAVE              05320005
026242         MOVE TM001-GMM-NAME          TO HL3-GMM-NAME             05330005
026243         MOVE TM001-DMM-NBR           TO HL4-DMM-NBR              05340005
026244                                         PV-DMM-SAVE              05350005
026245         MOVE TM001-DMM-NAME          TO HL4-DMM-NAME             05360005
026246         MOVE TM001-BYR-NBR           TO HL5-BYR-NBR              05370005
026247                                         PV-BYR-SAVE              05380005
026248         MOVE TM001-BYR-NAME          TO HL5-BYR-NAME             05390099
026249         WRITE UNRSLVD-TRBL-REC-BUYING                            05400099
026251                       FROM HL3-HEADING-LINE-3                    05410053
026252                            AFTER ADVANCING 2 LINES               05420005
026254         WRITE UNRSLVD-TRBL-REC-BUYING                            05430099
026255                       FROM HL4-HEADING-LINE-4                    05440005
026256                            AFTER ADVANCING 1 LINE                05450005
026258         WRITE UNRSLVD-TRBL-REC-BUYING                            05460099
026259                       FROM HL5-HEADING-LINE-5                    05470005
026260                            AFTER ADVANCING 1 LINE                05480005
026261         ADD 4   TO PV-BUYING-LINE-COUNT                          05490099
026262      END-IF                                                      05500005
026273                                                                  05510005
026274      PERFORM 6100-ACCUMULATE-TOTALS THRU 6100-EXIT.              05520052
026275      PERFORM 6200-PRINT-DETAILS     THRU 6200-EXIT.              05530052
026277 3000-EXIT.  EXIT.                                                05540003
026279                                                                  05550052
026280 4000-ANALYST-AREA-RPT.                                           05560099
026281      SET PS-ANALYST-REPORT   TO TRUE                             05570053
026282                                                                  05580053
026283      IF TM001-ANALYST-MGR-NBR  NOT = PV-ANALYST-MGR-NBR-SAVE OR  05590053
026284         TM001-ANALYST-NBR      NOT = PV-ANALYST-NBR-SAVE     OR  05600053
026286         PS-RPT-AREA-CHANGED                                      05610053
026287         IF PS-FIRST-TIME-THRU                                    05620099
026288            SET PS-NOT-FIRST-TIME-THRU      TO TRUE               05630099
026290         ELSE                                                     05640053
026291            IF PS-RPT-AREA-CHANGED                                05650056
026292               CONTINUE                                           05660056
026293            ELSE                                                  05670056
026294               PERFORM 6000-PRINT-TOTALS       THRU 6000-EXIT     05680056
026295            END-IF                                                05690056
026296         END-IF                                                   05700053
026297         PERFORM 6999-PRINT-HEADINGS           THRU 6999-EXIT     05710053
026298         MOVE TM001-ANALYST-MGR-NBR   TO PV-ANALYST-MGR-NBR-SAVE  05720053
026299         MOVE TM001-ANALYST-NBR       TO PV-ANALYST-NBR-SAVE      05730053
026300         MOVE TM001-ANALYST-MGR-NAME  TO HL6-MNGR-NAME            05740053
026301         MOVE TM001-ANALYST-NAME      TO HL7-ANALYST-NAME         05750053
026307         WRITE UNRSLVD-TRBL-REC-ANALYST                           05760099
026308                       FROM HL6-HEADING-LINE-6                    05770053
026309                            AFTER ADVANCING 2 LINES               05780053
026310         WRITE UNRSLVD-TRBL-REC-ANALYST                           05790099
026311                       FROM HL7-HEADING-LINE-7                    05800053
026312                            AFTER ADVANCING 1 LINE                05810053
026316         ADD 3   TO PV-ANALYST-LINE-COUNT                         05820099
026317      END-IF                                                      05830053
026318                                                                  05840053
026319      PERFORM 6100-ACCUMULATE-TOTALS THRU 6100-EXIT.              05850053
026320      PERFORM 6200-PRINT-DETAILS     THRU 6200-EXIT.              05860053
026326 4000-EXIT.  EXIT.                                                05870052
026327                                                                  05880052
026328 5000-DC-AREA-RPT.                                                05890052
026329      SET PS-DC-REPORT             TO TRUE.                       05900052
026330                                                                  05910053
026331      MOVE TM001-OPER-UNT-ID   TO PV-OPER-UNT-ID-HOLD             05920054
026333      IF TM001-OPER-UNT-ID    NOT = PV-OPER-UNT-ID-SAVE     OR    05930074
026334         TM001-FCLTY-AREA-ID  NOT = PV-FCLTY-AREA-ID-SAVE   OR    05940081
026335         PS-RPT-AREA-CHANGED                                      05950074
026337         IF PS-FIRST-TIME-THRU                                    05960099
026338            SET PS-NOT-FIRST-TIME-THRU     TO TRUE                05970099
026339         ELSE                                                     05980057
026340            IF PS-RPT-AREA-CHANGED                                05990057
026341               CONTINUE                                           06000057
026342            ELSE                                                  06010057
026343               PERFORM 6000-PRINT-TOTALS       THRU 6000-EXIT     06020057
026344            END-IF                                                06030057
026345         END-IF                                                   06040057
026349         PERFORM 6999-PRINT-HEADINGS    THRU 6999-EXIT            06050053
026350         PERFORM 6210-GET-FCLTY-NAME    THRU 6210-EXIT            06060053
026351         MOVE XL071-LOC-5-ABBR-NM         TO HL8-DC-NAME          06070099
026352         WRITE UNRSLVD-TRBL-REC-DCAREA                            06080099
026353                       FROM HL8-HEADING-LINE-8                    06090068
026354                            AFTER ADVANCING 2 LINES               06100053
026359         ADD 2   TO PV-DC-LINE-COUNT                              06110099
026360         MOVE TM001-FCLTY-AREA-ID TO HL13-PROC-AREA-ID            06120083
026361         WRITE UNRSLVD-TRBL-REC-DCAREA                            06130099
026362               FROM HL13-HEADING-LINE-13                          06140083
026363                    AFTER ADVANCING 2 LINES                       06150083
026364         ADD 2      TO PV-DC-LINE-COUNT                           06160099
026365         WRITE UNRSLVD-TRBL-REC-DCAREA                            06170099
026366               FROM  HL14-HEADING-LINE-14                         06180089
026367                    AFTER ADVANCING 2 LINE                        06190089
026368         ADD 2      TO PV-DC-LINE-COUNT                           06200099
026369         WRITE UNRSLVD-TRBL-REC-DCAREA                            06210099
026370               FROM BL-BLANK-LINE                                 06220090
026371                    AFTER ADVANCING 1 LINE                        06230090
026372         ADD 1      TO PV-DC-LINE-COUNT                           06240099
026373      END-IF                                                      06250053
026374                                                                  06260053
026375      IF TM001-OPER-UNT-ID    NOT = PV-OPER-UNT-ID-SAVE           06270075
026376         MOVE TM001-OPER-UNT-ID TO PV-OPER-UNT-ID-SAVE            06280074
026377      END-IF                                                      06290074
026378                                                                  06300081
026379      IF TM001-FCLTY-AREA-ID  NOT = PV-FCLTY-AREA-ID-SAVE         06310081
026380         MOVE TM001-FCLTY-AREA-ID TO PV-FCLTY-AREA-ID-SAVE        06320081
026381      END-IF                                                      06330081
026382                                                                  06340074
026383      PERFORM 6100-ACCUMULATE-TOTALS THRU 6100-EXIT.              06350053
026384      PERFORM 6200-PRINT-DETAILS     THRU 6200-EXIT.              06360053
026385 5000-EXIT.  EXIT.                                                06370052
026386                                                                  06380052
026387 6000-PRINT-TOTALS.                                               06390070
026388       INITIALIZE TL1-TROUBLE-TOTAL                               06400024
026389                  TL2-RESOLVED-TRBL-TOT                           06410070
026390                  TL3-RESOLVE-HH-AVG                              06420070
026391                  TL3-RESOLVE-MM-AVG.                             06430070
026392                                                                  06440006
026393        IF PA-RESOLVE-HOURS          = 0 AND                      06450052
026394           PA-RESOLVE-MINUTES        = 0 AND                      06460052
026395           PA-NBR-OF-TRBLS           = 0                          06470052
026396           MOVE 0   TO PV-AVG-TOT-HOURS                           06480052
026397           MOVE 0   TO PV-AVG-TOT-MINUTES                         06490052
026398       ELSE                                                       06500028
026399         MULTIPLY 60 BY PA-RESOLVE-HOURS                          06510052
026400         ADD PA-RESOLVE-HOURS TO PA-RESOLVE-MINUTES               06520052
026401         DIVIDE PA-RESOLVE-MINUTES                                06530052
026402                      BY PA-NBR-OF-TRBLS                          06540052
026403                  GIVING PV-AVG-MINUTES ROUNDED                   06550052
026404                  ON SIZE ERROR                                   06560049
026405                       MOVE 0 TO PV-AVG-MINUTES                   06570052
026406         END-DIVIDE                                               06580032
026407                                                                  06590028
026408         DIVIDE PV-AVG-MINUTES BY 60                              06600052
026409                GIVING PV-AVG-TOT-HOURS                           06610052
026410                REMAINDER PV-AVG-TOT-MINUTES                      06620052
026411                ON SIZE ERROR                                     06630049
026412                      MOVE 0 TO PV-AVG-TOT-HOURS                  06640052
026413                                PV-AVG-TOT-MINUTES                06650052
026414         END-DIVIDE                                               06660032
026415      END-IF.                                                     06670032
026416                                                                  06680007
026417        MOVE  PA-TOT-OF-PRBLMS          TO TL1-TROUBLE-TOTAL.     06690052
026418        EVALUATE TRUE                                             06700099
026418            WHEN PV-RPT-AREA-SAVE-BUYING                          06700199
026418                WRITE UNRSLVD-TRBL-REC-BUYING                     06701099
026419                      FROM TL1-TOTAL-LINE-1                       06710024
026420                            AFTER ADVANCING 2 LINES               06720024
026421                 ADD 2   TO PV-BUYING-LINE-COUNT                  06730099
026418            WHEN PV-RPT-AREA-SAVE-ANALYST                         06731099
026418                WRITE UNRSLVD-TRBL-REC-ANALYST                    06732099
026419                      FROM TL1-TOTAL-LINE-1                       06733099
026420                            AFTER ADVANCING 2 LINES               06734099
026421                 ADD 2   TO PV-ANALYST-LINE-COUNT                 06735099
026418            WHEN PV-RPT-AREA-SAVE-DC                              06736099
026418                WRITE UNRSLVD-TRBL-REC-DCAREA                     06737099
026419                      FROM TL1-TOTAL-LINE-1                       06738099
026420                            AFTER ADVANCING 2 LINES               06739099
026421                 ADD 2   TO PV-DC-LINE-COUNT                      06739199
026418        END-EVALUATE.                                             06739299
026422                                                                  06740085
026423        MOVE  PA-RSLVED-TRBL            TO TL2-RESOLVED-TRBL-TOT  06750079
026418        EVALUATE TRUE                                             06791099
026418            WHEN PV-RPT-AREA-SAVE-BUYING                          06792099
026418                WRITE UNRSLVD-TRBL-REC-BUYING                     06793099
026419                      FROM TL2-TOTAL-LINE-2                       06794099
026420                            AFTER ADVANCING 1 LINES               06795099
026421                 ADD 1   TO PV-BUYING-LINE-COUNT                  06796099
026418            WHEN PV-RPT-AREA-SAVE-ANALYST                         06797099
026418                WRITE UNRSLVD-TRBL-REC-ANALYST                    06798099
026419                      FROM TL2-TOTAL-LINE-2                       06799099
026420                            AFTER ADVANCING 1 LINES               06799199
026421                 ADD 1   TO PV-ANALYST-LINE-COUNT                 06799299
026418            WHEN PV-RPT-AREA-SAVE-DC                              06799399
026418                WRITE UNRSLVD-TRBL-REC-DCAREA                     06799499
026419                      FROM TL2-TOTAL-LINE-2                       06799599
026420                            AFTER ADVANCING 1 LINES               06799699
026421                 ADD 1   TO PV-DC-LINE-COUNT                      06799799
026418        END-EVALUATE.                                             06799899
026428                                                                  06800085
026429                                                                  06810006
026430        MOVE PV-AVG-TOT-HOURS          TO TL3-RESOLVE-HH-AVG.     06820070
026431        MOVE PV-AVG-TOT-MINUTES TO TL3-RESOLVE-MM-AVG.            06830070
026418        EVALUATE TRUE                                             06871099
026418            WHEN PV-RPT-AREA-SAVE-BUYING                          06872099
026418                WRITE UNRSLVD-TRBL-REC-BUYING                     06873099
026419                      FROM TL3-TOTAL-LINE-3                       06874099
026420                            AFTER ADVANCING 1 LINES               06875099
026421                 ADD 1   TO PV-BUYING-LINE-COUNT                  06876099
026418            WHEN PV-RPT-AREA-SAVE-ANALYST                         06877099
026418                WRITE UNRSLVD-TRBL-REC-ANALYST                    06878099
026419                      FROM TL3-TOTAL-LINE-3                       06879099
026420                            AFTER ADVANCING 1 LINES               06879199
026421                 ADD 1   TO PV-ANALYST-LINE-COUNT                 06879299
026418            WHEN PV-RPT-AREA-SAVE-DC                              06879399
026418                WRITE UNRSLVD-TRBL-REC-DCAREA                     06879499
026419                      FROM TL3-TOTAL-LINE-3                       06879599
026420                            AFTER ADVANCING 1 LINES               06879699
026421                 ADD 1   TO PV-DC-LINE-COUNT                      06879799
026418        END-EVALUATE.                                             06879899
026436                                                                  06880024
026437        MOVE 0    TO PA-RESOLVE-HOURS                             06890052
026438                     PA-RESOLVE-MINUTES                           06900052
026439                     PV-AVG-MINUTES                               06910052
026440                     PA-NBR-OF-TRBLS                              06920052
026441                     PV-AVG-TOT-HOURS                             06930052
026442                     PV-AVG-TOT-MINUTES                           06940052
026443                     PA-RSLVED-TRBL                               06950080
026444                     PA-TOT-OF-PRBLMS.                            06960052
026445 6000-EXIT.  EXIT.                                                06970052
026446                                                                  06980005
026447 6100-ACCUMULATE-TOTALS.                                          06990052
026448     IF TM001-RPT-RESOLVED                                        07000007
026449        ADD TM001-RESOLVED-HOURS    TO PA-RESOLVE-HOURS           07010052
026450        ADD TM001-RESOLVED-MINUTES  TO PA-RESOLVE-MINUTES         07020052
026451        ADD 1      TO PA-NBR-OF-TRBLS                             07030052
026452     END-IF                                                       07040007
026453                                                                  07050007
026454     IF TM001-NOTIF-DATE       <= PV-END-DATE          AND        07060050
026455        TM001-NOTIF-DATE       >= PV-START-DATE        AND        07070050
026456       ((TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR        07080061
026457        (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR        07090061
026458        (TM001-NOTIF-DATE   NOT  = PV-NOTIF-DATE-SAVE)  OR        07100082
026459        (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE))         07110061
026460          ADD 1                   TO PA-TOT-OF-PRBLMS             07120078
026461     END-IF.                                                      07130078
026462                                                                  07140078
026463     IF TM001-RPT-RESOLVED                   AND                  07150078
026464        TM001-RESOLVED-DATE <= PV-END-DATE   AND                  07160078
026465        TM001-RESOLVED-DATE >= PV-START-DATE AND                  07170078
026466       ((TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR        07180078
026467        (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR        07190078
026468        (TM001-NOTIF-DATE   NOT  = PV-NOTIF-DATE-SAVE)  OR        07200082
026469        (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE))         07210078
026470          ADD 1                   TO PA-RSLVED-TRBL               07220078
026471     END-IF.                                                      07230078
026472 6100-EXIT.  EXIT.                                                07240052
026473                                                                  07250005
026474 6200-PRINT-DETAILS.                                              07260052
026475*** CHECK WHICH REPORT IS OVER THE LINE LIMIT AND NEEDS           07270099
026475*** HEADINGS PRINTED                                              07270199
026475     EVALUATE TRUE                                                07270299
026475         WHEN PS-BUYING-REPORT                                    07271099
026475             IF PV-BUYING-LINE-COUNT > PC-LINE-LIMIT              07272099
026476                 PERFORM 6999-PRINT-HEADINGS THRU 6999-EXIT       07280099
026477             END-IF                                               07290099
026478         WHEN PS-ANALYST-REPORT                                   07300099
026475             IF PV-ANALYST-LINE-COUNT > PC-LINE-LIMIT             07301099
026476                 PERFORM 6999-PRINT-HEADINGS THRU 6999-EXIT       07301199
026477             END-IF                                               07303099
026478         WHEN PS-DC-REPORT                                        07304099
026475             IF PV-DC-LINE-COUNT > PC-LINE-LIMIT                  07305099
026476                 PERFORM 6999-PRINT-HEADINGS THRU 6999-EXIT       07305199
026477             END-IF                                               07307099
026477     END-EVALUATE.                                                07307199
026478                                                                  07308099
026479       IF TM001-RPT-UNRESOLVED AND                                07310018
026480         (TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE       OR       07320050
026481          TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE  OR       07330050
026482          TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE OR       07340050
026483          TM001-NOTIF-DATE   NOT  = PV-NOTIF-DATE-SAVE)           07350050
026484            EVALUATE TRUE                                         07360074
026485               WHEN PS-BUYING-REPORT                              07370074
026486               WHEN PS-ANALYST-REPORT                             07380074
026487                   PERFORM 6500-BUYING-ANAL-DETAILS THRU 6500-EXIT07390074
026488               WHEN PS-DC-REPORT                                  07400074
026489                  PERFORM 6600-DC-DETAILS           THRU 6600-EXIT07410074
026490            END-EVALUATE                                          07420074
026501      END-IF.                                                     07430007
026502                                                                  07440075
026503      IF TM001-TRBL-RSN-CDE NOT =  PV-TRBL-RSN-CDE-SAVE           07450050
026504          MOVE TM001-TRBL-RSN-CDE TO PV-TRBL-RSN-CDE-SAVE         07460050
026505      END-IF.                                                     07470050
026506      IF TM001-REC-SEQ-NBR  NOT =  PV-REC-SEQ-NBR-SAVE            07480050
026507          MOVE TM001-REC-SEQ-NBR  TO PV-REC-SEQ-NBR-SAVE          07490050
026508      END-IF.                                                     07500050
026509      IF TM001-PO-NBR       NOT =  PV-PO-NBR-SAVE                 07510050
026510          MOVE TM001-PO-NBR       TO PV-PO-NBR-SAVE               07520050
026511      END-IF.                                                     07530050
026512      IF TM001-NOTIF-DATE   NOT =  PV-NOTIF-DATE-SAVE             07540050
026513          MOVE TM001-NOTIF-DATE   TO PV-NOTIF-DATE-SAVE           07550051
026514      END-IF.                                                     07560050
026515 6200-EXIT.  EXIT.                                                07570052
026516                                                                  07580029
026517 6210-GET-FCLTY-NAME.                                             07590052
026518     INITIALIZE XL071-COMMAREA-REC.                               07600099
026518     MOVE TM001-OPER-UNT-ID   TO XL071-LOCATION-NUMBER.           07601099
026519                                                                  07610099
026520     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         07620099
026527                                                                  07690099
026528     EVALUATE TRUE                                                07700029
026529         WHEN XL071-NO-ERRORS                                     07710099
026530           MOVE XL071-LOC-5-ABBR-NM  TO DL1-FCLTY-DESC            07720099
026531         WHEN XL071-LOC-NOT-FOUND                                 07730099
026532         WHEN XL071-SQLCODE-N = -904                              07740099
026533         WHEN XL071-SQLCODE-N = -913                              07750099
026534             MOVE PC-NOT-FOUND       TO DL1-FCLTY-DESC            07760099
026535         WHEN XL071-BAD-DB2-RETURN                                07770099
026536             MOVE XL071-DB2-TABLE    TO PV-ABEND-PARAGRAPH        07780099
026536             MOVE XL071-SQLCODE      TO PV-ABEND-SQLCODE          07781099
026538              DISPLAY '** ABEND ** IN TMKRP006'                   07800029
026539              DISPLAY 'PARAGRAPH:6210-GET-FCLTY-NAME'             07810052
026540              DISPLAY 'SQLCODE:  ' PV-ABEND-SQLCODE               07820099
026540              DISPLAY                                             07821099
026541             'MESSAGE:  SQL ERROR SELECTING FROM XLT-LOC'         07830099
026542              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             07840029
026543     END-EVALUATE.                                                07850029
026544 6210-EXIT.  EXIT.                                                07860052
026545                                                                  07870039
026546 6220-GET-ARRIVAL-TIME.                                           07880052
026547     EXEC SQL                                                     07890039
026548              SELECT  REC_TMST,                                   07900093
                            PO_VER_NBR                                  07910093
026549                INTO  :RECEIV-REC-TMST,                           07920093
                            :RECEIV-PO-VER-NBR                          07930093
026550                FROM  TRECEIV                                     07940039
026551               WHERE  (ORD_NBR        = :TM001-PO-NBR             07950049
026552                 AND   REC_SEQ_NBR    = :TM001-REC-SEQ-NBR        07960049
026553                 AND   VER_STATUS_CDE = 'A')                      07970049
026554     END-EXEC.                                                    07980039
026555     EVALUATE TRUE                                                07990039
026556         WHEN SQLCODE = +0                                        08000039
026546           PERFORM 6300-GET-SHIP-BEFORE-DATE                      08010096
026557           MOVE RECEIV-REC-TMST    TO  PV-TMST-HOLD               08020039
026558           IF  PV-TMST-ENROUTE                                    08030086
026559               MOVE PC-ENROUTE TO DL1-ARRIVAL-DT-TM               08040086
026560           ELSE                                                   08050086
026561               STRING PV-TMST-MM                                  08060086
026562                     '/'                                          08070086
026563                     PV-TMST-DD                                   08080086
026564                     '/'                                          08090086
026565                     PV-TMST-YYYY                                 08100086
026566                     ' '                                          08110086
026567                     PV-TMST-HH                                   08120086
026568                     ':'                                          08130086
026569                     PV-TMST-MIN                                  08140086
026570                     ':'                                          08150086
026571                     PV-TMST-SS                                   08160086
026572                  DELIMITED BY SIZE                               08170086
026573                  INTO  DL1-ARRIVAL-DT-TM                         08180086
026574              END-STRING                                          08190086
026575           END-IF                                                 08200088
026576         WHEN SQLCODE = +100                                      08210039
026577         WHEN SQLCODE = -904                                      08220039
026578         WHEN SQLCODE = -913                                      08230039
026579             MOVE PC-NOT-FOUND        TO DL1-ARRIVAL-DT-TM        08240093
026579             MOVE PC-SHIP-DTE-NOT-FND TO DL1-SHIP-BEFORE-DT       08250093
026580         WHEN SQLWARN0 NOT = SPACES                               08260093
026581         WHEN SQLCODE < +0                                        08270093
026582         WHEN SQLCODE > +0                                        08280093
026583              DISPLAY '** ABEND ** IN TMKRP006'                   08290093
026584              DISPLAY 'PARAGRAPH:6220-GET-ARRIVAL-TIME'           08300093
026585              DISPLAY                                             08310093
026586             'MESSAGE:  SQL ERROR SELECTING FROM TRECEIV'         08320093
026587              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             08330093
026588     END-EVALUATE.                                                08340093
026589 6220-EXIT.  EXIT.                                                08350093
026545                                                                  08360093
026546 6300-GET-SHIP-BEFORE-DATE.                                       08370093
026547     EXEC SQL                                                     08380093
026548              SELECT  DONT_SHIP_BEF_DTE                           08390093
026549                INTO  :PLNSHP-DONT-SHIP-BEF-DTE                   08400095
026550                FROM  TPLNSHP                                     08410093
026551               WHERE  (PO_NBR     = :TM001-PO-NBR                 08420097
                       AND   VER_NBR = :RECEIV-PO-VER-NBR)              08430099
026554     END-EXEC.                                                    08440093
026555     EVALUATE TRUE                                                08450093
026556         WHEN SQLCODE = +0                                        08460093
026557           MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-TMST-HOLD          08470095
026561               STRING PV-TMST-MM                                  08480093
026562                     '/'                                          08490093
026563                     PV-TMST-DD                                   08500093
026564                     '/'                                          08510093
026565                     PV-TMST-YYYY                                 08520093
026572                  DELIMITED BY SIZE                               08530093
026573                  INTO  DL1-SHIP-BEFORE-DT                        08540094
026574              END-STRING                                          08550093
      *CHG0161125-START                                                 08551099
026576         WHEN SQLCODE = -811                                      08560099
                 PERFORM 6305-GET-SHIP-BEFORE-DATE-AC                   08560199
      *CHG0161125-END                                                   08560299
026576         WHEN SQLCODE = +100                                      08561099
026577         WHEN SQLCODE = -904                                      08570093
026578         WHEN SQLCODE = -913                                      08580093
026579             MOVE PC-SHIP-DTE-NOT-FND TO DL1-SHIP-BEFORE-DT       08590093
026580         WHEN SQLWARN0 NOT = SPACES                               08600093
026581         WHEN SQLCODE < +0                                        08610093
026582         WHEN SQLCODE > +0                                        08620093
026583              DISPLAY '** ABEND ** IN TMKRP006'                   08630093
026584              DISPLAY 'PARAGRAPH:6300-GET-SHIP-BEFORE-DATE'       08640094
026585              DISPLAY                                             08650093
026586             'MESSAGE:  SQL ERROR SELECTING FROM TPLNSHP'         08660096
026587              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             08670093
026588     END-EVALUATE.                                                08680093
026589 6300-EXIT.  EXIT.                                                08690094
      *CHG0161125-START                                                 08691099
       6305-GET-SHIP-BEFORE-DATE-AC.                                    08692099
           EXEC SQL                                                     08693099
              SELECT  DONT_SHIP_BEF_DTE                                 08694099
                INTO  :PLNSHP-DONT-SHIP-BEF-DTE                         08695099
                FROM  TPLNSHP                                           08696099
                WHERE PO_NBR          = :TM001-PO-NBR                   08697099
                 AND  VER_NBR         = :RECEIV-PO-VER-NBR              08698099
                 AND  VER_STATUS_CDE  = 'A'                             08699099
           END-EXEC.                                                    08699199
026555     EVALUATE TRUE                                                08699299
026556         WHEN SQLCODE = +0                                        08699399
026557           MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-TMST-HOLD          08699499
026561               STRING PV-TMST-MM                                  08699599
026562                     '/'                                          08699699
026563                     PV-TMST-DD                                   08699799
026564                     '/'                                          08699899
026565                     PV-TMST-YYYY                                 08699999
026572                  DELIMITED BY SIZE                               08700099
026573                  INTO  DL1-SHIP-BEFORE-DT                        08700199
026574              END-STRING                                          08700299
026576         WHEN SQLCODE = +100                                      08700799
026577         WHEN SQLCODE = -904                                      08700899
026578         WHEN SQLCODE = -913                                      08700999
026579             MOVE PC-SHIP-DTE-NOT-FND TO DL1-SHIP-BEFORE-DT       08701099
026580         WHEN SQLWARN0 NOT = SPACES                               08701199
026581         WHEN SQLCODE < +0                                        08701299
026582         WHEN SQLCODE > +0                                        08701399
026583              DISPLAY '** ABEND ** IN TMKRP006'                   08701499
026584              DISPLAY 'PARAGRAPH:6305-GET-SHIP-BEFORE-DATE-AC'    08701599
026585              DISPLAY                                             08701699
026586             'MESSAGE:  SQL ERROR SELECTING FROM TPLNSHP'         08701799
026587              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             08701899
026588     END-EVALUATE.                                                08701999
       6305-EXIT.  EXIT.                                                08702099
      *CHG0161125-END                                                   08702199
026590                                                                  08703099
026600 6500-BUYING-ANAL-DETAILS.                                        08710093
026610     IF TM001-DEPT-NBR NOT = PV-DPT-SAVE                          08720093
026620        MOVE TM001-DEPT-NBR  TO PV-DPT-SAVE                       08730093
026630                                HL9-DPT-NBR                       08740093
026640        MOVE TM001-DEPT-DESC TO HL9-DPT-NAME                      08750093
026475*** CHECK WHICH REPORT IS BEING PRODUCED AND WRITE THE CORRECT    08751099
026475*** REPORT                                                        08752099
026650        EVALUATE TRUE                                             08760099
026650            WHEN PS-BUYING-REPORT                                 08760199
026650                WRITE UNRSLVD-TRBL-REC-BUYING                     08761099
026660                    FROM HL9-HEADING-LINE-9                       08770099
026670                        AFTER ADVANCING 2 LINES                   08780099
026680                ADD 2 TO PV-BUYING-LINE-COUNT                     08790099
026650                WRITE UNRSLVD-TRBL-REC-BUYING                     08800099
026660                    FROM HL11-HEADING-LINE-11                     08810099
026670                        AFTER ADVANCING 2 LINES                   08820099
026680                ADD 2 TO PV-BUYING-LINE-COUNT                     08830099
026690                WRITE UNRSLVD-TRBL-REC-BUYING                     08840099
026691                    FROM HL12-HEADING-LINE-12                     08850099
026692                        AFTER ADVANCING 1 LINES                   08860099
026693                ADD 1 TO PV-BUYING-LINE-COUNT                     08870099
026694                WRITE UNRSLVD-TRBL-REC-BUYING                     08880099
026695                    FROM BL-BLANK-LINE                            08890099
026696                    AFTER ADVANCING 1 LINE                        08900099
026697                ADD 1 TO PV-BUYING-LINE-COUNT                     08910099
026697                                                                  08910199
026650            WHEN PS-ANALYST-REPORT                                08911099
026650                WRITE UNRSLVD-TRBL-REC-ANALYST                    08912099
026660                    FROM HL9-HEADING-LINE-9                       08913099
026670                        AFTER ADVANCING 2 LINES                   08914099
026680                ADD 2 TO PV-ANALYST-LINE-COUNT                    08915099
026650                WRITE UNRSLVD-TRBL-REC-ANALYST                    08916099
026660                    FROM HL11-HEADING-LINE-11                     08917099
026670                        AFTER ADVANCING 2 LINES                   08918099
026680                ADD 2 TO PV-ANALYST-LINE-COUNT                    08919099
026690                WRITE UNRSLVD-TRBL-REC-ANALYST                    08919199
026691                    FROM HL12-HEADING-LINE-12                     08919299
026692                        AFTER ADVANCING 1 LINES                   08919399
026693                ADD 1 TO PV-ANALYST-LINE-COUNT                    08919499
026694                WRITE UNRSLVD-TRBL-REC-ANALYST                    08919599
026695                    FROM BL-BLANK-LINE                            08919699
026696                    AFTER ADVANCING 1 LINE                        08919799
026697                ADD 1 TO PV-ANALYST-LINE-COUNT                    08919899
026650        END-EVALUATE                                              08919999
026698     END-IF                                                       08920074
026699     MOVE TM001-PO-NBR                 TO DL1-PO-NBR              08930074
026700     MOVE TM001-REC-SEQ-NBR            TO DL1-RECEIVER-NBR        08940074
026701     MOVE TM001-ENT-NAME-DESC          TO DL1-VENDOR-NAME         08950074
026702     PERFORM 6210-GET-FCLTY-NAME    THRU 6210-EXIT                08960074
026703     MOVE TM001-TRBL-RSN-CDE-DESC     TO DL1-TROUBLE-REASON       08970074
026704     PERFORM 6220-GET-ARRIVAL-TIME  THRU 6220-EXIT                08980074
026705     STRING TM001-NOTIF-MM                                        08990074
026706            '/'                                                   09000074
026707            TM001-NOTIF-DD                                        09010074
026708            '/'                                                   09020074
026709            TM001-NOTIF-YYYY                                      09030074
026710            ' '                                                   09040074
026711            TM001-NOTIF-HH                                        09050074
026712            ':'                                                   09060074
026713            TM001-NOTIF-MN                                        09070074
026714            ':'                                                   09080074
026715            TM001-NOTIF-SS                                        09090074
026716         DELIMITED BY SIZE                                        09100074
026717         INTO  DL1-NOTIFY-DT-TM                                   09110074
026718     END-STRING                                                   09120074
026650                                                                  09121099
026650     EVALUATE TRUE                                                09121199
026650         WHEN PS-BUYING-REPORT                                    09122099
026719             WRITE UNRSLVD-TRBL-REC-BUYING                        09130099
026720                 FROM DL1-DETAIL-LINE-1                           09140074
026721                       AFTER ADVANCING 1 LINE                     09150074
026722             ADD 1 TO PV-BUYING-LINE-COUNT                        09160099
026650         WHEN PS-ANALYST-REPORT                                   09161099
026719             WRITE UNRSLVD-TRBL-REC-ANALYST                       09162099
026720                 FROM DL1-DETAIL-LINE-1                           09163099
026721                       AFTER ADVANCING 1 LINE                     09164099
026722             ADD 1 TO PV-ANALYST-LINE-COUNT                       09165099
026650     END-EVALUATE.                                                09166099
026730 6500-EXIT.  EXIT.                                                09170074
026800                                                                  09180074
026900 6600-DC-DETAILS.                                                 09190081
026920                                                                  09200074
026999     MOVE TM001-PO-NBR                 TO DL2-PO-NBR              09210075
027000     MOVE TM001-REC-SEQ-NBR            TO DL2-RECEIVER-NBR        09220075
027001     MOVE TM001-ENT-NAME-DESC          TO DL2-VENDOR-NAME         09230075
027002     MOVE TM001-TRBL-RSN-CDE-DESC      TO DL2-TROUBLE-REASON      09240076
027003     MOVE TM001-DEPT-NBR               TO DL2-DEPT-NBR            09250077
027004     PERFORM 6220-GET-ARRIVAL-TIME  THRU 6220-EXIT                09260074
027019     MOVE  DL1-ARRIVAL-DT-TM           TO DL2-ARRIVAL-DT-TM       09270075
027020     STRING TM001-NOTIF-MM                                        09280075
027021            '/'                                                   09290075
027022            TM001-NOTIF-DD                                        09300075
027023            '/'                                                   09310075
027024            TM001-NOTIF-YYYY                                      09320075
027025            ' '                                                   09330075
027026            TM001-NOTIF-HH                                        09340075
027027            ':'                                                   09350075
027028            TM001-NOTIF-MN                                        09360075
027029            ':'                                                   09370075
027030            TM001-NOTIF-SS                                        09380075
027031         DELIMITED BY SIZE                                        09390075
027032         INTO  DL2-NOTIFY-DT-TM                                   09400075
027033     END-STRING                                                   09410075
027035     WRITE UNRSLVD-TRBL-REC-DCAREA                                09420099
027036                 FROM DL2-DETAIL-LINE-2                           09430075
027037                       AFTER ADVANCING 1 LINE                     09440074
027038     ADD 1      TO PV-DC-LINE-COUNT.                              09450099
027040 6600-EXIT.  EXIT.                                                09460074
027100                                                                  09470074
046400 6999-PRINT-HEADINGS.                                             09480000
046710     EVALUATE TRUE                                                09510003
046720        WHEN PS-NO-DETAILS                                        09520099
046730            PERFORM 7000-NO-DETAILS                               09530099
046800        WHEN PS-BUYING-REPORT                                     09640003
046701                MOVE 0       TO PV-BUYING-LINE-COUNT              09642099
046803            ADD 1                     TO PV-BUYING-PAGE-COUNT     09650041
046804            MOVE PV-BUYING-PAGE-COUNT TO DP132O-PAGE-NUMBER       09660041
046805            MOVE PC-ONE          TO DP132O-REPORT-NUMBER          09670092
046806            WRITE UNRSLVD-TRBL-REC-BUYING                         09680099
046807                  FROM DP132O-STANDRD-HEADER-132-COLS             09690053
046808                       AFTER ADVANCING PAGE                       09700054
046810            MOVE PC-BUYING-AREA  TO HL2-REPORT-AREA               09710091
046811            WRITE UNRSLVD-TRBL-REC-BUYING                         09720099
046812             FROM HL1-HEADING-LINE-1                              09730003
046813                  AFTER ADVANCING 2 LINES                         09740003
046815            WRITE UNRSLVD-TRBL-REC-BUYING                         09750099
046816             FROM HL2-HEADING-LINE-2                              09760003
046820                  AFTER ADVANCING 1 LINE                          09770003
046830           ADD 4  TO PV-BUYING-LINE-COUNT                         09780099
046900        WHEN PS-ANALYST-REPORT                                    09790003
046701                MOVE 0      TO PV-ANALYST-LINE-COUNT              09792099
046901            ADD 1                      TO PV-ANALYST-PAGE-COUNT   09800055
046902            MOVE PV-ANALYST-PAGE-COUNT TO DP132O-PAGE-NUMBER      09810055
046903            MOVE PC-TWO          TO DP132O-REPORT-NUMBER          09820092
046904            WRITE UNRSLVD-TRBL-REC-ANALYST                        09830099
046905                  FROM DP132O-STANDRD-HEADER-132-COLS             09840055
046906                       AFTER ADVANCING PAGE                       09850055
046908            MOVE PC-ANALYST-AREA TO HL2-REPORT-AREA               09860091
046909            WRITE UNRSLVD-TRBL-REC-ANALYST                        09870099
046910             FROM HL1-HEADING-LINE-1                              09880055
046911                  AFTER ADVANCING 2 LINES                         09890055
046912            WRITE UNRSLVD-TRBL-REC-ANALYST                        09900099
046913             FROM HL2-HEADING-LINE-2                              09910055
046914                  AFTER ADVANCING 1 LINE                          09920055
046915           ADD 4  TO PV-ANALYST-LINE-COUNT                        09930099
046930        WHEN PS-DC-REPORT                                         09940003
046701                MOVE 0      TO PV-DC-LINE-COUNT                   09942099
046931            ADD 1                      TO PV-DC-PAGE-COUNT        09950055
046932            MOVE PV-DC-PAGE-COUNT TO DP132O-PAGE-NUMBER           09960055
046933            MOVE PC-THREE        TO DP132O-REPORT-NUMBER          09970092
046934            WRITE UNRSLVD-TRBL-REC-DCAREA                         09980099
046935                  FROM DP132O-STANDRD-HEADER-132-COLS             09990055
046936                       AFTER ADVANCING PAGE                       10000055
046938            MOVE PC-DC-AREA      TO HL2-REPORT-AREA               10010091
046939            WRITE UNRSLVD-TRBL-REC-DCAREA                         10020099
046940             FROM HL1-HEADING-LINE-1                              10030055
046941                  AFTER ADVANCING 2 LINES                         10040055
046942            WRITE UNRSLVD-TRBL-REC-DCAREA                         10050099
046943             FROM HL2-HEADING-LINE-2                              10060055
046944                  AFTER ADVANCING 1 LINE                          10070055
046945           ADD 4  TO PV-DC-LINE-COUNT                             10080099
046960     END-EVALUATE.                                                10090003
049600 6999-EXIT.   EXIT.                                               10100000
049700*                                                                 10110007
049700 7000-NO-DETAILS.                                                 10110199
049700     IF PV-BUYING-PAGE-COUNT = 0                                  10110299
046730         ADD 1               TO PV-BUYING-PAGE-COUNT              10111099
046740         MOVE PV-BUYING-PAGE-COUNT TO DP132O-PAGE-NUMBER          10112099
046750         WRITE UNRSLVD-TRBL-REC-BUYING                            10113099
046760             FROM DP132O-STANDRD-HEADER-132-COLS                  10114099
046770                   AFTER ADVANCING PAGE                           10115099
046790         WRITE UNRSLVD-TRBL-REC-BUYING                            10116099
046791             FROM HL1-HEADING-LINE-1                              10117099
046792                  AFTER ADVANCING 2 LINES                         10118099
046793         WRITE UNRSLVD-TRBL-REC-BUYING                            10119099
046794             FROM NI-NO-INFORMATION-LINE                          10119199
046795                  AFTER ADVANCING 2 LINES                         10119299
046795     END-IF.                                                      10119399
049700     IF PV-ANALYST-PAGE-COUNT = 0                                 10119499
046730         ADD 1               TO PV-ANALYST-PAGE-COUNT             10119599
046740         MOVE PV-ANALYST-PAGE-COUNT TO DP132O-PAGE-NUMBER         10119699
046750         WRITE UNRSLVD-TRBL-REC-ANALYST                           10119799
046760             FROM DP132O-STANDRD-HEADER-132-COLS                  10119899
046770                   AFTER ADVANCING PAGE                           10119999
046790         WRITE UNRSLVD-TRBL-REC-ANALYST                           10120099
046791             FROM HL1-HEADING-LINE-1                              10120199
046792                  AFTER ADVANCING 2 LINES                         10120299
046793         WRITE UNRSLVD-TRBL-REC-ANALYST                           10120399
046794             FROM NI-NO-INFORMATION-LINE                          10120499
046795                  AFTER ADVANCING 2 LINES                         10120599
046795     END-IF.                                                      10120699
049700     IF PV-DC-PAGE-COUNT = 0                                      10120799
046730         ADD 1         TO PV-DC-PAGE-COUNT                        10120899
046740         MOVE PV-DC-PAGE-COUNT TO DP132O-PAGE-NUMBER              10120999
046750         WRITE UNRSLVD-TRBL-REC-DCAREA                            10121099
046760             FROM DP132O-STANDRD-HEADER-132-COLS                  10121199
046770                   AFTER ADVANCING PAGE                           10121299
046790         WRITE UNRSLVD-TRBL-REC-DCAREA                            10121399
046791             FROM HL1-HEADING-LINE-1                              10121499
046792                  AFTER ADVANCING 2 LINES                         10121599
046793         WRITE UNRSLVD-TRBL-REC-DCAREA                            10121699
046794             FROM NI-NO-INFORMATION-LINE                          10121799
046795                  AFTER ADVANCING 2 LINES                         10121899
046795     END-IF.                                                      10121999
046795*                                                                 10122099
049800 9000-END-PROCESS.                                                10123099
049810     WRITE UNRSLVD-TRBL-REC-BUYING                                10130099
049820       FROM ER-END-REPORT-LINE                                    10140062
049830           AFTER ADVANCING 2 LINES.                               10150063
049840                                                                  10160062
049810     WRITE UNRSLVD-TRBL-REC-ANALYST                               10161099
049820       FROM ER-END-REPORT-LINE                                    10162099
049830           AFTER ADVANCING 2 LINES.                               10163099
049840                                                                  10164099
049810     WRITE UNRSLVD-TRBL-REC-DCAREA                                10165099
049820       FROM ER-END-REPORT-LINE                                    10166099
049830           AFTER ADVANCING 2 LINES.                               10167099
049840                                                                  10168099
050900     CLOSE  TROUBLE-EXTRACT-FILE                                  10170012
050920            UNRSLVD-TRBL-RPT-BUYING                               10180099
050920            UNRSLVD-TRBL-RPT-ANALYST                              10181099
050920            UNRSLVD-TRBL-RPT-DCAREA.                              10182099
051000 9000-EXIT.  EXIT.                                                10190009
051100                                                                  10200044
053100 9999-SQL-ERROR.                                                  10210029
053200                                                                  10220029
053300     COPY DPPD004.                                                10230029
053400                                                                  10240029
053500     MOVE +4013 TO PV-ABEND-CODE.                                 10250029
053600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10260029
053700 9999-EXIT.   EXIT.                                               10270029
053800                                                                  10280029
