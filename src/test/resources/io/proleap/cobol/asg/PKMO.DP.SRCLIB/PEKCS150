000100 IDENTIFICATION DIVISION.                                         00010006
000200 PROGRAM-ID.    PEKCS150.                                         00020006
000300 AUTHOR.        STU SMITH.                                        00030006
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040006
000500 DATE-WRITTEN.  09-16-91.                                         00050006
000600 DATE-COMPILED.                                                   00060006
000700***************************************************************** 00070006
000800*    THIS PROGRAM ALLOWS UPDATE OF THE PERMANENT PRICE            00080006
000900*    SYSTEM CONTROL PARMS.                                        00090006
001000*                                                                 00100006
001100*    THE SCREEN IS DISPLAYED WHEN THE USER SELECTS                00110006
001200*    A CONTROL PARM FOR UPDATE FROM THE LIST DISPLAYED            00120006
001300*    BY PROGRAM PEKCS145.                                         00130006
001400*                                                                 00140006
001500*    VALIDATION TAKES PLACE DEPENDING ON THE                      00150006
001600*    PARM NUMBER WHICH IS PASSED FROM PEKCS145.                   00160006
001700*    THE VALIDATION PARAGRAPHS BEGIN WITH THE LETTER 'H'          00170006
001800*    WHERE ADDITIONAL VALIDATION IS REQUIRED, FOR                 00180006
001900*    CROSS VALIDATION ETC, ANOTHER PARAGRAPH                      00190006
002000*    BEGINNING WITH "I' AND HAVING THE SAME NUMBER                00200006
002100*    AS THE 'H' PARAGRAPH IS INCLUDED.                            00210006
002200*                                                                 00220006
002300*    TABLES READ ARE:-                                            00230006
002400*                     TPPCCTL PERMANET PRICE CHANGE CONTROL       00240006
002500*                             TABLE.                              00250006
002600*                                                                 00260006
002700******************************************************************00270006
002800* 07/92 - TCM -  WR NO. 2011                                     *00280006
002900*    MAKE CHANGES FOR NEW ARCHITECTURE                           *00290006
003000*    - CHANGE COPYBOOK FOR DPPD002 TO DPPD022                    *00300006
003100*    - REMOVE COPYBOOK APPLICATION SPECIFIC AREA - PEWS023,      *00310006
003200*        HARD CODE IN APPLICATION SPECIFIC AREA, CHANGE THE      *00320006
003300*        PREFIX ON APPLICATION SPECIFIC FIELDS TO ASC-           *00330006
003400*    - REMOVE HARD CODED REFERENCE TO THE OPERATING COMPANY      *00340006
003500*    -   NOTE: PEKCS145/PEKCS150 STILL PROCESSES AS PEKCS365/    *00350006
003600*              PEKCS060 USED TO PROCESS.  BECAUSE OF THIS,       *00360006
003700*              COPYBOOK PEWS022 STILL USES THE                   *00370006
003800*              INTER-APPL-FORMAT-CODE AND THE                    *00380006
003900*              INTER-APPL-ACKNLG-CODE.                           *00390006
004000*                                                                *00400006
004100* 08/92 - AJR -  PERM PHASE 2                                    *00410006
004200*    ADDED EDIT CHECK FOR NUMBER OF LINES PER DOCUMENT,          *00420006
004300*    CONTROL NUMBER 25.  THE MAXIMUM NUMBER OF LINES PER         *00430006
004400*    DOCUMENT WILL BE STORED IN PEWS049.                         *00440006
004500*                                                                *00450006
004600* 09/92 - AJR -  PERM PHASE 2                                    *00460006
004700*    ADDED EDIT CHECK FOR DOCUMENT PRINT TIMEFRAME, CONTROL      *00470006
004800*    NUMBER 26. AND COUNT ENTRY UPDATE TIMEFRAME, CONTROL NUMBER *00480006
004900*    27.                                                         *00490006
005000*                                                                *00500006
005100* 01/93 - AJR -  WR 2259                                         *00510006
005200*    REMOVED THE EDIT CHECKS FOR '+' SIGNS.  THIS WILL NOW BE    *00520006
005300*    TAKEN CARE OF PROPERLY IN THE NUMERIC EDIT ROUTINE.         *00530006
005400*                                                                *00540006
005500* 08/93 - AJR -  WR 2401 - INSTORE PRICE CHANGES                 *00550006
005600*    ADDED EDIT CHECK FOR INSTORE DOCUMENT DELINQUENT TIMEFRAME  *00560006
005700*    BEFORE MONTH END (28), PAGES PER DOCUMENT (29), EXCESSIVE   *00570006
005800*    UNITS (30), DOCUMENT DELINQUENT TIMEFRAME AFTER DATE        *00580006
005900*    ISSUED (31), AND MAXIMUM PERM REALEASE AVAILABLE NUMBER (32)*00590006
006000*                                                                *00600006
006100* 11/93 - AJR -  WR 2504 - REMOVE GMM APPROVAL IND               *00610006
006200*    CHANGE THE PC-MIN-LEAD-TME-DAYS TO 0 INSTEAD OF 3           *00620006
006300*                                                                *00630006
006400* 12/93 - AJR -  WR 2195 - ADDED EDIT CHECK FOR INSTORE          *00640006
006500*    EXCESSIVE DOLLARS (33)                                      *00650006
006600*                                                                *00660006
006700* 11/24/98 - D ENGEL - WR NO 6041 (Y2K PROJ)                     *00670006
006800*    -  REPLACED "DPKUT105" CALENDAR CALL WITH DP500-KOHLS-      *00680006
006900*       CALENDAR-ROUTINE.                                        *00690006
007000*                                                                *00700006
007100* 01/19/99 - TCM - WR NO 6041 (Y2K PROJ)                         *00710006
007200*    - REPLACE ALL "++INCLUDE" REFERENCES WITH "COPY"            *00720006
007300*      REFERENCES, PER STANDARDS                                 *00730006
007400*                                                                *00740006
007500* 01/11/00 - CHRIS KUNSTMANN  IBS   - WR NO 20195                *00750006
007600*    -  ADDED EDIT CHECKS FOR NEW PARAMETERS;                    *00760006
007700*      (34) NBR OF DAYS SKUS CHGD TO CLEARANCE PROTECTED FROM    *00770006
007800*            ZERO OUT                                            *00780006
007900*      (35) ADD NEW STORE PREVIOUS RCP PRICES TO VSM             *00790006
008000*      (36) MAXIMUM NUMBER OF TIERS ALLOWED FOR AN RCP DOCUMENT  *00800006
008100*      (37) MINIMUM NBR OF DAYS BETWEEN RCP TIER EFFECTIVE DATES *00810006
008200*                                                                *00820006
008300* 11/04/04 - TODD C. MICHALEK - WR NO 27559                      *00830006
008400*    - (5) PHYSICAL INVENTORY CORPORATE PERM PRICE CHANGE LEAD   *00840006
008500*      TIME - CHANGED PC-MAX-PHYS-INV-LTIME FROM 31 TO 99 TO     *00850006
008600*      EXTEND A DOCUMENT EFFECTIVE BLOCK OUT PERIOD FARTHER INTO *00860006
008700*      THE FUTURE                                                *00870006
008710*---------------------------------------------------------------* 00871007
008720* 09/14/2021 - GERMAN BANDA - CHG0261678                          00872009
008750* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00875007
008760*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00876007
008770*              MAKING THE CALL DYNAMIC VS STATIC                  00877007
008780*---------------------------------------------------------------* 00878007
008800******************************************************************00880006
008900 ENVIRONMENT DIVISION.                                            00890006
009000 DATA DIVISION.                                                   00900006
009100 WORKING-STORAGE SECTION.                                         00910006
009200                                                                  00920006
009300 01  AM-ABEND-MESSAGES.                                           00930006
009400     05  AM-ABEND-MESSAGE-1             PIC X(78)    VALUE        00940006
009500     'UNRECOGNIZED ACTION ENCOUNTERED BY THIS PROGRAM'.           00950006
009600     05  AM-ABEND-MESSAGE-2             PIC X(78)    VALUE        00960006
009700     'ERROR TRYING TO SELECT A RECORD FROM TPPCCTL TABLE - KEY    00970006
009800-    '      '.                                                    00980006
009900     05  FILLER REDEFINES AM-ABEND-MESSAGE-2.                     00990006
010000         10  FILLER                     PIC X(57).                01000006
010100         10  AM-OP-CO-2                 PIC X(02).                01010006
010200         10  AM-PARM-NBR-2              PIC X(03).                01020006
010300         10  FILLER                     PIC X(16).                01030006
010400     05  AM-ABEND-MESSAGE-3             PIC X(78)    VALUE        01040006
010500     'ERROR TRYING TO READ TPPCCTL FOR CROSS VALID.    - KEY      01050006
010600-    '      '.                                                    01060006
010700     05  FILLER REDEFINES AM-ABEND-MESSAGE-3.                     01070006
010800         10  FILLER                     PIC X(57).                01080006
010900         10  AM-OP-CO-3                 PIC X(02).                01090006
011000         10  AM-PARM-NBR-3              PIC X(03).                01100006
011100         10  FILLER                     PIC X(16).                01110006
011200     05  AM-ABEND-MESSAGE-4             PIC X(78)    VALUE        01120006
011300     'ERROR TRYING TO UDPATE A RECORD IN TPPCCTL TABLE - KEY      01130006
011400-    '      '.                                                    01140006
011500     05  FILLER REDEFINES AM-ABEND-MESSAGE-4.                     01150006
011600         10  FILLER                     PIC X(57).                01160006
011700         10  AM-OP-CO-4                 PIC X(02).                01170006
011800         10  AM-PARM-NBR-4              PIC X(03).                01180006
011900         10  FILLER                     PIC X(16).                01190006
012000     05  AM-ABEND-MESSAGE-5             PIC X(78)    VALUE        01200006
012100     'ERROR TRYING TO CHECK A RECORD IN TPPCCTL TABLE - KEY       01210006
012200-    '     '.                                                     01220006
012300     05  FILLER REDEFINES AM-ABEND-MESSAGE-5.                     01230006
012400         10  FILLER                     PIC X(57).                01240006
012500         10  AM-OP-CO-5                 PIC X(02).                01250006
012600         10  AM-PARM-NBR-5              PIC X(03).                01260006
012700         10  FILLER                     PIC X(16).                01270006
012800                                                                  01280006
012900 01  PC-PROGRAM-CONSTANTS.                                        01290006
013000     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.01300006
013100     05  PC-STORE-LENGTH                PIC S9(04)   VALUE +3     01310006
013200                                                     COMP SYNC.   01320006
013300     05  PC-PARM-MAX-LENGTH             PIC S9(04)   VALUE +8     01330006
013400                                                     COMP SYNC.   01340006
013500     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  01350006
013600                                                     COMP SYNC.   01360006
013700     05  PC-TSYMSG-00004                PIC 9(05)    VALUE 4.     01370006
013800     05  PC-TSYMSG-00005                PIC 9(05)    VALUE 5.     01380006
013900     05  PC-TSYMSG-00007                PIC 9(05)    VALUE 7.     01390006
014000     05  PC-TSYMSG-00008                PIC 9(05)    VALUE 8.     01400006
014100     05  PC-TSYMSG-00009                PIC 9(05)    VALUE 9.     01410006
014200     05  PC-TSYMSG-00010                PIC 9(05)    VALUE 10.    01420006
014300     05  PC-TSYMSG-00016                PIC 9(05)    VALUE 16.    01430006
014400     05  PC-TSYMSG-00017                PIC 9(05)    VALUE 17.    01440006
014500     05  PC-TSYMSG-00025                PIC 9(05)    VALUE 25.    01450006
014600     05  PC-TSYMSG-00045                PIC 9(05)    VALUE 45.    01460006
014700     05  PC-TSYMSG-00046                PIC 9(05)    VALUE 46.    01470006
014800     05  PC-TSYMSG-00059                PIC 9(05)    VALUE 59.    01480006
014900     05  PC-TSYMSG-00067                PIC 9(05)    VALUE 67.    01490006
015000     05  PC-TSYMSG-00068                PIC 9(05)    VALUE 68.    01500006
015100     05  PC-TSYMSG-00099                PIC 9(05)    VALUE 99.    01510006
015200     05  PC-TSYMSG-00127                PIC 9(05)    VALUE 127.   01520006
015300     05  PC-TSYMSG-00128                PIC 9(05)    VALUE 128.   01530006
015400     05  PC-TSYMSG-00129                PIC 9(05)    VALUE 129.   01540006
015500     05  PC-TSYMSG-00130                PIC 9(05)    VALUE 130.   01550006
015600     05  PC-TSYMSG-00135                PIC 9(05)    VALUE 135.   01560006
015700     05  PC-TSYMSG-00136                PIC 9(05)    VALUE 136.   01570006
015800     05  PC-TSYMSG-00139                PIC 9(05)    VALUE 139.   01580006
015900     05  PC-TSYMSG-00140                PIC 9(05)    VALUE 140.   01590006
016000     05  PC-TSYMSG-00179                PIC 9(05)    VALUE 179.   01600006
016100     05  PC-TSYMSG-00278                PIC 9(05)    VALUE 278.   01610006
016200     05  PC-TSYMSG-99901                PIC 9(05)    VALUE 99901. 01620006
016300*                                                                 01630006
016400     05  PC-MAXIMUM-PERCENTAGE          PIC 9(05)    VALUE 99.    01640006
016500     05  PC-MINIMUM-PERCENTAGE          PIC 9(05)    VALUE 1.     01650006
016600*                                                                 01660006
016700     05  PC-MIN-INV-DATE-DAYS           PIC 9(05)    VALUE 1.     01670006
016800     05  PC-MAX-INV-DATE-DAYS           PIC 9(05)    VALUE 365.   01680006
016900*                                                                 01690006
017000     05  PC-MIN-INACT-DEL-DAYS          PIC 9(05)    VALUE 1.     01700006
017100     05  PC-MAX-INACT-DEL-DAYS          PIC 9(05)    VALUE 99.    01710006
017200*                                                                 01720006
017300     05  PC-MIN-PEND-INACT-DEL-DAYS     PIC 9(05)    VALUE 1.     01730006
017400     05  PC-MAX-PEND-INACT-DEL-DAYS     PIC 9(05)    VALUE 180.   01740006
017500*                                                                 01750006
017600     05  PC-MIN-LEAD-TME-DAYS           PIC 9(05)    VALUE 0.     01760006
017700     05  PC-MAX-LEAD-TME-DAYS           PIC 9(05)    VALUE 31.    01770006
017800*                                                                 01780006
017900     05  PC-MIN-NONCLEAR-DOC-PRT-TFRAME PIC 9(05)    VALUE 0.     01790006
018000     05  PC-MAX-NONCLEAR-DOC-PRT-TFRAME PIC 9(05)    VALUE 60.    01800006
018100*                                                                 01810006
018200     05  PC-MIN-PHYS-INV-LTIME          PIC 9(05)    VALUE 0.     01820006
018300     05  PC-MAX-PHYS-INV-LTIME          PIC 9(05)    VALUE 99.    01830006
018400*                                                                 01840006
018500     05  PC-MIN-ZERO-OUT-PROC-TFRAME    PIC 9(05)    VALUE 1.     01850006
018600     05  PC-MAX-ZERO-OUT-PROC-TFRAME    PIC 9(05)    VALUE 10.    01860006
018700*                                                                 01870006
018800     05  PC-MAX-VOL-RPT-LTIME           PIC 9(05)    VALUE 90.    01880006
018900*                                                                 01890006
019000     05  PC-MIN-ZERO-OUT-SCHD-LTIME     PIC 9(05)    VALUE 2.     01900006
019100     05  PC-MAX-ZERO-OUT-SCHD-LTIME     PIC 9(05)    VALUE 10.    01910006
019200*                                                                 01920006
019300     05  PC-MIN-DOC-PROC-TFRAME         PIC 9(05)    VALUE 1.     01930006
019400     05  PC-MAX-DOC-PROC-TFRAME         PIC 9(05)    VALUE 10.    01940006
019500*                                                                 01950006
019600     05  PC-MIN-DOC-PRT-TFRAME          PIC 9(05)    VALUE 1.     01960006
019700     05  PC-MAX-DOC-PRT-TFRAME          PIC 9(05)    VALUE 99.    01970006
019800*                                                                 01980006
019900     05  PC-MIN-COUNT-ENTRY-TFRAME      PIC 9(05)    VALUE 0.     01990006
020000*                                                                 02000006
020100     05  PC-MIN-ME-DQ-TFRAME            PIC 9(05)    VALUE 1.     02010006
020200     05  PC-MAX-ME-DQ-TFRAME            PIC 9(05)    VALUE 31.    02020006
020300*                                                                 02030006
020400     05  PC-MIN-ISS-DQ-TFRAME           PIC 9(05)    VALUE 1.     02040006
020500     05  PC-MAX-ISS-DQ-TFRAME           PIC 9(05)    VALUE 99.    02050006
020600*                                                                 02060006
020700     05  PC-MIN-PAGES-PER-DOC           PIC 9(05)    VALUE 1.     02070006
020800     05  PC-MAX-PAGES-PER-DOC           PIC 9(05)    VALUE 999.   02080006
020900*                                                                 02090006
021000     05  PC-MIN-EXCESS-UNITS            PIC 9(05)    VALUE 1.     02100006
021100     05  PC-MAX-EXCESS-UNITS            PIC 9(05)    VALUE 99999. 02110006
021200*                                                                 02120006
021300     05  PC-MIN-EXCESS-DOLLARS          PIC 9(05)    VALUE 1.     02130006
021400     05  PC-MAX-EXCESS-DOLLARS          PIC 9(05)    VALUE 99999. 02140006
021500*                                                                 02150006
021600     05  PC-MIN-RLSE-AVAIL-NBR          PIC 9(05)    VALUE 0.     02160006
021700     05  PC-MAX-RLSE-AVAIL-NBR          PIC 9(05)    VALUE 9999.  02170006
021800*                                                                 02180006
021900     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        02190006
022000     'PE150A  '.                                                  02200006
022100     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        02210006
022200     'PEKM150 '.                                                  02220006
022300     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        02230006
022400     'PEKCS150'.                                                  02240006
022500     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   02250006
022600                                                     COMP SYNC.   02260006
022700     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      02270006
022800         10  FILLER                     PIC X(01).                02280006
022900         10  PC-ERASE-EOF               PIC X(01).                02290006
023000     05  PC-QUEUE-LENGTH                PIC S9(04)   VALUE +20    02300006
023100                                                     COMP SYNC.   02310006
023200     05  PC-MAX-RETRYS                  PIC S9(04)   VALUE +3     02320006
023300                                                     COMP SYNC.   02330006
023400                                                                  02340006
023500 01  PC-PROGRAM-COUNTERS.                                         02350006
023600     05  PC-RETRY-CNTR                  PIC S9(04)   VALUE +0     02360006
023700                                                     COMP SYNC.   02370006
023800                                                                  02380006
023900 01  PS-PROGRAM-SUBSCRIPTS.                                       02390006
024000     05  PS-SUB                         PIC S9(04)   VALUE +0     02400006
024100                                                     COMP SYNC.   02410006
024200                                                                  02420006
024300 01  PS-PROGRAM-SWITCHES.                                         02430006
024400     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   02440006
024500         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   02450006
024600         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   02460006
024700         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   02470006
024800         88  PS-SEND-DATA-ONLY                       VALUE '4'.   02480006
024900         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   02490006
025000         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   02500006
025100     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   02510006
025200         88  PS-ERROR                                VALUE 'Y'.   02520006
025300         88  PS-NO-ERROR                             VALUE 'N'.   02530006
025400     05  PS-DB2-OK-SW                   PIC X(01)    VALUE 'N'.   02540006
025500         88  PS-DB2-OK                               VALUE 'Y'.   02550006
025600         88  PS-DB2-RETRY                            VALUE 'N'.   02560006
025700     05  PS-VALID-FORMAT-CODE-SW        PIC X(01)    VALUE 'N'.   02570006
025800         88  PS-VALID-FORMAT-CODE                    VALUE 'Y'.   02580006
025900         88  PS-INVALID-FORMAT-CODE                  VALUE 'N'.   02590006
026000                                                                  02600006
026100 01  PV-PROGRAM-VARIABLES.                                        02610006
026200     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     02620006
026300                                                     COMP SYNC.   02630006
026400     05  PV-DATE-CCYYMMDD.                                        02640006
026500         10  PV-DATE-CC                PIC 9(2)      VALUE ZEROS. 02650006
026600         10  PV-DATE-YY                PIC 9(2)      VALUE ZEROS. 02660006
026700         10  PV-DATE-MM                PIC 9(2)      VALUE ZEROS. 02670006
026800         10  PV-DATE-DD                PIC 9(2)      VALUE ZEROS. 02680006
026900     05  PV-DATE-MMDDYYYY-FORMAT.                                 02690006
027000         10  PV-DATE-MMDDYYYY-MM        PIC X(2)     VALUE SPACES.02700006
027100         10  PV-DATE-MMDDYYYY-DD        PIC X(2)     VALUE SPACES.02710006
027200         10  PV-DATE-MMDDYYYY-CC        PIC X(2)     VALUE SPACES.02720006
027300         10  PV-DATE-MMDDYYYY-YY        PIC X(2)     VALUE SPACES.02730006
027400     05  PV-DATE-MMYY-FORMAT.                                     02740006
027500         10  FILLER                     PIC X(2)     VALUE SPACES.02750006
027600         10  PV-DATE-MMYY-CC            PIC X(2)     VALUE SPACES.02760006
027700         10  PV-DATE-MMYY-YY            PIC X(2)     VALUE SPACES.02770006
027800         10  PV-DATE-MMYY-MM            PIC X(2)     VALUE SPACES.02780006
027900     05  PV-MSG-NUMBER                  PIC 9(05)    VALUE ZEROS. 02790006
028000     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.02800006
028100     05  PV-DISPLAY-PARM-NBR            PIC  9(8)    VALUE ZEROES.02810006
028200     05  PV-DATE-FORMAT                 PIC  9(8)    VALUE ZEROES.02820006
028300     05  PV-DISPLAY-NUMBER              PIC  ZZZZZZZ9.            02830006
028400     05  PV-CROSS-VALIDATE-PARM-NBR     PIC S999V COMP-3.         02840006
028500     05  PV-CROSS-VALIDATE-PARM-AMT     PIC S99999999V COMP-3.    02850006
028600     05  PV-SMALLEST-XVAL-PARM-AMT      PIC S99999999V COMP-3.    02860006
028700 EJECT                                                            02870006
028800***************************************************************** 02880006
028900*    PERMANENT PRICE CHANGE CONTROL NUMBERS                       02890006
029000***************************************************************** 02900006
029100     COPY PEWS048.                                                02910006
029200***************************************************************** 02920006
029300*    PERMANENT PRICE CHANGE CONSTANTS AND WORK AREAS              02930006
029400***************************************************************** 02940006
029500     COPY PEWS049.                                                02950006
029600***************************************************************** 02960006
029700*    COPYBOOK TO BE USED WITH DPPD005 (FORMATS SYSTEM MSG)        02970006
029800***************************************************************** 02980006
029900     COPY DPWS006.                                                02990006
030000***************************************************************** 03000006
030100*    STANDARD COMMAREA.                                           03010006
030200***************************************************************** 03020006
030300     COPY DPWS020.                                                03030006
030400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03040006
030500***************************************************************** 03050006
030600*    INTER-APPLICATION COMMAREA.                                  03060006
030700***************************************************************** 03070006
030800         10  INTER-APPL-COMM-AREA       PIC X(200).               03080006
030900     COPY PEWS022.                                                03090006
031000***************************************************************** 03100006
031100*    SPECIFIC COMMAREA.                                           03110006
031200***************************************************************** 03120006
031300         10  ASC-SPECIFIC-COMMAREA.                               03130006
031400             15  FILLER                               PIC X(02).  03140006
031500             15  ASC-PARM-NBR                         PIC S9(03)  03150006
031600                                                      COMP-3.     03160006
031700             15  ASC-PARM-AMT-ORIG                    PIC S9(08)  03170006
031800                                                      COMP-3.     03180006
031900             15  ASC-PARM-AMT-UPDATED                 PIC S9(08)  03190006
032000                                                      COMP-3.     03200006
032100             15  ASC-PARM-AMT-X                       PIC X(08).  03210006
032200             15  ASC-PARM-AMT-DTE-CC                  PIC X(02).  03220006
032300             15  ASC-PARM-AMT                         PIC S9(08)  03230006
032400                                                      COMP-3.     03240006
032500             15  ASC-DESC                             PIC X(60).  03250006
032600             15  ASC-TEXT-1                           PIC X(60).  03260006
032700             15  ASC-TEXT-2                           PIC X(60).  03270006
032800             15  ASC-TEXT-3                           PIC X(60).  03280006
032900             15  ASC-TEXT-4                           PIC X(60).  03290006
033000             15  ASC-PARM-IS-DTE-DDMMYY-SW            PIC X(01).  03300006
033100                 88 ASC-PARM-IS-DTE-DDMMYY            VALUE 'Y'.  03310006
033200                 88 ASC-PARM-IS-NOT-DTE-DDMMYY        VALUE 'N'.  03320006
033300             15  ASC-PARM-IS-DTE-MMYY-SW              PIC X(01).  03330006
033400                 88 ASC-PARM-IS-DTE-MMYY              VALUE 'Y'.  03340006
033500                 88 ASC-PARM-IS-NOT-DTE-MMYY          VALUE 'N'.  03350006
033600             15  ASC-UPDATE-MADE-SW                   PIC X(01).  03360006
033700                 88 ASC-UPDATE-MADE                   VALUE 'Y'.  03370006
033800                 88 ASC-NO-UPDATE-MADE                VALUE 'N'.  03380006
033900         10  FILLER                                   PIC X(2533).03390006
034000***************************************************************** 03400006
034100*    NUMERIC EDIT COPYBOOK.                                       03410006
034200***************************************************************** 03420006
034300     COPY DPWS010I.                                               03430006
034400***************************************************************** 03440006
034500*    ABEND PROCESSING COPYBOOK.                                   03450006
034600***************************************************************** 03460006
034700     COPY DPWS013.                                                03470006
034800***************************************************************** 03480006
034900*    ATTRIBUTE SETTINGS COPYBOOK.                                 03490006
035000***************************************************************** 03500006
035100     COPY DPWS015.                                                03510006
035200***************************************************************** 03520006
035300*    CURRENT DATE AND TIME COPYBOOK.                              03530006
035400***************************************************************** 03540006
035500     COPY DPWS017.                                                03550006
035600***************************************************************** 03560006
035700*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          03570006
035800***************************************************************** 03580006
035900     COPY DPWS009.                                                03590006
036000***************************************************************** 03600006
036100*    FUNCTION KEYS COPYBOOK.                                      03610006
036200***************************************************************** 03620006
036300     COPY DPWS016.                                                03630006
036400***************************************************************** 03640006
036500*    COPYBOOK FOR KOHLS CALENDAR ROUTINE                          03650006
036600***************************************************************** 03660006
036700     COPY DPWS500.                                                03670006
036800***************************************************************** 03680006
036900*    DPKUT045 COPYBOOK.                                           03690006
037000***************************************************************** 03700006
037100     COPY DPWS045.                                                03710006
037200***************************************************************** 03720006
037300*    SYSTEM MESSAGES FILE COPY                                    03730006
037400***************************************************************** 03740006
037500     COPY DPRD507I.                                               03750006
037600***************************************************************** 03760006
037700*    STANDARD ATTENTION IDENTIFIER LIST                           03770006
037800***************************************************************** 03780006
037900     COPY DFHAID.                                                 03790006
038000***************************************************************** 03800006
038100*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        03810006
038200***************************************************************** 03820006
038300     COPY DFHBMSCA.                                               03830006
038400***************************************************************** 03840006
038500*    MAP LAYOUT                                                   03850006
038600***************************************************************** 03860006
038700     COPY PEKM150.                                                03870006
038800 01  MD-MAP-DATA-AREA REDEFINES PE150AO.                          03880006
038900     05  FILLER                         PIC X(731).               03890006
039000***************************************************************** 03900006
039100*    DB2 COMMUNICATION AREA                                       03910006
039200***************************************************************** 03920006
039300     EXEC SQL                                                     03930006
039400         INCLUDE SQLCA                                            03940006
039500     END-EXEC.                                                    03950006
039600***************************************************************** 03960006
039700*    PERMANTENT PRICE CHANGE CONTROL TABLE - TPPCCTL              03970006
039800***************************************************************** 03980006
039900     EXEC SQL                                                     03990006
040000         INCLUDE TPPCCTL                                          04000006
040100     END-EXEC.                                                    04010006
040200 EJECT                                                            04020006
040300*                                                                 04030006
040400*                                                                 04040006
040500 LINKAGE SECTION.                                                 04050006
040600                                                                  04060006
040700 01  DFHCOMMAREA.                                                 04070006
040800     05  FILLER                         OCCURS 1 TO 4072 TIMES    04080006
040900                                        DEPENDING ON EIBCALEN.    04090006
041000         10  FILLER                     PIC X.                    04100006
041100*                                                                 04110006
041200*                                                                 04120006
041300*                                                                 04130006
041400 PROCEDURE DIVISION.                                              04140006
041500******************************************************************04150006
041600*    CHECK THE COMMUNICATION AREA AND START PROCESSING IF IT IS   04160006
041700*    VALID.                                                       04170006
041800******************************************************************04180006
041900 A100-MAIN-MODULE.                                                04190006
042000     PERFORM DP015-0000-CHECK-COMMAREA.                           04200006
042100                                                                  04210006
042200     IF  DP020-SRC-RETURN-W-TRAN-ID                               04220006
042300         PERFORM B100-CONTROL-PROCESSING                          04230006
042400     END-IF.                                                      04240006
042500                                                                  04250006
042600     PERFORM DP003-0000-RETURN-TO-CICS.                           04260006
042700******************************************************************04270006
042800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    04280006
042900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    04290006
043000*                                                                 04300006
043100*    PERFORMED BY A100-MAIN-MODULE.                               04310006
043200******************************************************************04320006
043300 B100-CONTROL-PROCESSING.                                         04330006
043400     EVALUATE TRUE                                                04340006
043500                                                                  04350006
043600         WHEN DP020-NEXT-ACT-INITIAL                              04360006
043700             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 04370006
043800             SET ASC-NO-UPDATE-MADE TO TRUE                       04380006
043900                                                                  04390006
044000             PERFORM C050-INITIALIZE-COMMAREA                     04400006
044100                                                                  04410006
044200             PERFORM C060-SAVE-INIT-INTER-APPL                    04420006
044300             MOVE -1         TO ANAVCMDL                          04430006
044400                                                                  04440006
044500             IF  PS-VALID-FORMAT-CODE                             04450006
044600                                                                  04460006
044700                 PERFORM E200-BUILD-INITIAL-PANEL                 04470006
044800                                                                  04480006
044900                 PERFORM F100-DISPLAY-PANEL                       04490006
045000                                                                  04500006
045100             ELSE                                                 04510006
045200                 PERFORM C300-RETURN-TO-PREV-TRAN                 04520006
045300             END-IF                                               04530006
045400                                                                  04540006
045500                                                                  04550006
045600         WHEN DP020-NEXT-ACT-READ-MAP                             04560006
045700             PERFORM C100-PROCESS-MAP                             04570006
045800                                                                  04580006
045900         WHEN DP020-NEXT-ACT-RETURN                               04590006
046000             SET ASC-NO-UPDATE-MADE TO TRUE                       04600006
046100             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 04610006
046200                                                                  04620006
046300             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        04630006
046400                                                                  04640006
046500             PERFORM E300-EDIT-DATA-IN-COMMAREA                   04650006
046600                                                                  04660006
046700             PERFORM F100-DISPLAY-PANEL                           04670006
046800                                                                  04680006
046900         WHEN DP020-NEXT-ACT-ERROR                                04690006
047000             SET ASC-NO-UPDATE-MADE TO TRUE                       04700006
047100                                                                  04710006
047200             MOVE DP020-MSG-NUMBER TO PV-MSG-NUMBER               04720006
047300                                                                  04730006
047400             IF  DP020-NAV-MNEMONIC = SPACES                      04740006
047500                 MOVE SPACES          TO ANAVCMDO                 04750006
047600                 MOVE DP015-GREEN     TO ANAVCMDC                 04760006
047700                 MOVE DP015-UNDERLINE TO ANAVCMDH                 04770006
047800             ELSE                                                 04780006
047900                 MOVE DP015-RED       TO ANAVCMDC                 04790006
048000                 MOVE DP015-REVERSE   TO ANAVCMDH                 04800006
048100             END-IF                                               04810006
048200                                                                  04820006
048300             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        04830006
048400                                                                  04840006
048500             SET PS-ERROR                TO TRUE                  04850006
048600             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  04860006
048700                                                                  04870006
048800             MOVE PV-MSG-NUMBER TO DP020-MSG-NUMBER               04880006
048900             MOVE -1            TO ANAVCMDL                       04890006
049000                                                                  04900006
049100             PERFORM F100-DISPLAY-PANEL                           04910006
049200                                                                  04920006
049300         WHEN OTHER                                               04930006
049400             SET ASC-NO-UPDATE-MADE TO TRUE                       04940006
049500                                                                  04950006
049600             PERFORM E300-EDIT-DATA-IN-COMMAREA                   04960006
049700                                                                  04970006
049800             MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER             04980006
049900                                                                  04990006
050000             SET DP020-MSG-FATAL TO TRUE                          05000006
050100                                                                  05010006
050200             PERFORM F100-DISPLAY-PANEL                           05020006
050300                                                                  05030006
050400     END-EVALUATE.                                                05040006
050500******************************************************************05050006
050600*    INITIALIZE SPECIFIC COMMAREA                                 05060006
050700*                                                                 05070006
050800*    PERFORMED BY B100-CONTROL-PROCESSING.                        05080006
050900******************************************************************05090006
051000 C050-INITIALIZE-COMMAREA.                                        05100006
051100     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05110006
051200******************************************************************05120006
051300*    SAVE THE INTER APPLICATION COMMAREA                          05130006
051400*                                                                 05140006
051500*    PERFORMED BY B100-CONTROL-PROCESSING.                        05150006
051600******************************************************************05160006
051700 C060-SAVE-INIT-INTER-APPL.                                       05170006
051800     PERFORM E100-INITIALIZE-COMMAREA.                            05180006
051900                                                                  05190006
052000     SET PS-VALID-FORMAT-CODE TO TRUE                             05200006
052100                                                                  05210006
052200     IF  PE022-INTER-APPL-FORMAT-CODE = 'Q145'                    05220006
052300         MOVE PE022-PARM-NBR                                      05230006
052400              TO ASC-PARM-NBR                                     05240006
052500         IF (ASC-PARM-NBR                                         05250006
052600             = PE048-CURR-FISCAL-ME-DATE-NBR)                     05260006
052700         OR (ASC-PARM-NBR                                         05270006
052800             = PE048-NEXT-FISCAL-ME-DATE-NBR)                     05280006
052900         OR (ASC-PARM-NBR                                         05290006
053000             = PE048-PHY-INV-DATE-NBR)                            05300006
053100                 SET ASC-PARM-IS-DTE-DDMMYY     TO TRUE           05310006
053200                 SET ASC-PARM-IS-NOT-DTE-MMYY TO TRUE             05320006
053300         ELSE                                                     05330006
053400             IF (ASC-PARM-NBR                                     05340006
053500                    =  PE048-CURR-FISCAL-YM-DATE-NBR)             05350006
053600             OR (ASC-PARM-NBR                                     05360006
053700                    =  PE048-NEXT-FISCAL-YM-DATE-NBR)             05370006
053800                 SET ASC-PARM-IS-DTE-MMYY TO TRUE                 05380006
053900                 SET ASC-PARM-IS-NOT-DTE-DDMMYY     TO TRUE       05390006
054000            ELSE                                                  05400006
054100                 SET ASC-PARM-IS-NOT-DTE-MMYY     TO TRUE         05410006
054200                 SET ASC-PARM-IS-NOT-DTE-DDMMYY TO TRUE           05420006
054300             END-IF                                               05430006
054400         END-IF                                                   05440006
054500                                                                  05450006
054600     ELSE                                                         05460006
054700         SET PS-INVALID-FORMAT-CODE TO TRUE                       05470006
054800         SET DP020-MSG-FATAL      TO TRUE                         05480006
054900         MOVE PC-TSYMSG-99901 TO DP020-MSG-NUMBER                 05490006
055000                                                                  05500006
055100     END-IF.                                                      05510006
055200                                                                  05520006
055300     MOVE LOW-VALUES TO PE022-INTER-APPL-COMMAREA.                05530006
055400******************************************************************05540006
055500*    RECEIVE THE MAP.                                             05550006
055600*    IF A FUNCTION KEY WAS HIT OTHER THAN CLEAR OR PF5 (REFRESH), 05560006
055700*    MOVE THE SCREEN FIELDS TO THE COMMAREA.                      05570006
055800*    CONTINUE PROCESSING BASED ON THE FUNCTION KEY THAT WAS HIT.  05580006
055900*                                                                 05590006
056000*    PERFORMED BY B100-CONTROL-PROCESSING.                        05600006
056100******************************************************************05610006
056200 C100-PROCESS-MAP.                                                05620006
056300     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         05630006
056400                                                                  05640006
056500     PERFORM C110-RECEIVE-MAP.                                    05650006
056600                                                                  05660006
056700     IF  (DP020-SRC-AID NOT = DP016-PF5)                          05670006
056800     AND (DP020-SRC-AID NOT = DP016-CLEAR)                        05680006
056900          PERFORM D100-MOVE-SCREEN-TO-COMMAREA                    05690006
057000     END-IF.                                                      05700006
057100                                                                  05710006
057200     PERFORM D200-CHECK-LOCAL-FKEYS.                              05720006
057300******************************************************************05730006
057400*    RECEIVE THE MAP.                                             05740006
057500*                                                                 05750006
057600*    PERFORMED BY C100-PROCESS-MAP.                               05760006
057700******************************************************************05770006
057800 C110-RECEIVE-MAP.                                                05780006
057900     PERFORM DP007-0000-GET-PANEL.                                05790006
058000******************************************************************05800006
058100*    IF THE INTER APPLICATION FORMAT CODE IS INVALID, RETURN      05810006
058200*    TO THE PREVIOUS TRANSACTION.                                 05820006
058300*                                                                 05830006
058400*    PERFORMED BY B100-CONTROL-PROCESSING.                        05840006
058500******************************************************************05850006
058600 C300-RETURN-TO-PREV-TRAN.                                        05860006
058700     MOVE DP016-PF3 TO DP020-SRC-AID.                             05870006
058800                                                                  05880006
058900     PERFORM DP015-1000-START-NAVIGATOR.                          05890006
059000******************************************************************05900006
059100*    MOVE THE FIELDS FROM THE SCREEN TO THE COMMAREA.             05910006
059200*                                                                 05920006
059300*    PERFORMED BY C100-PROCESS-MAP.                               05930006
059400******************************************************************05940006
059500 D100-MOVE-SCREEN-TO-COMMAREA.                                    05950006
059600     IF  APARML > 0                                               05960006
059700         MOVE APARMI TO ASC-PARM-AMT-X                            05970006
059800     ELSE                                                         05980006
059900                                                                  05990006
060000         IF  APARMA = PC-ERASE-EOF                                06000006
060100             MOVE SPACES TO ASC-PARM-AMT-X                        06010006
060200         END-IF                                                   06020006
060300     END-IF.                                                      06030006
060400******************************************************************06040006
060500*    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT          06050006
060600*    FUNCTION KEY THE USER HAS HIT.                               06060006
060700*                                                                 06070006
060800*    PERFORMED BY C100-PROCESS-MAP.                               06080006
060900******************************************************************06090006
061000 D200-CHECK-LOCAL-FKEYS.                                          06100006
061100     EVALUATE TRUE                                                06110006
061200                                                                  06120006
061300         WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)) OR             06130006
061400              (DP020-FK-RETURN(DP020-SRC-AID))                    06140006
061500               SET ASC-NO-UPDATE-MADE TO TRUE                     06150006
061600                                                                  06160006
061700               PERFORM E400-SETUP-INTER-APPL                      06170006
061800               PERFORM DP015-1000-START-NAVIGATOR                 06180006
061900                                                                  06190006
062000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06200006
062100              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                06210006
062200              SET ASC-NO-UPDATE-MADE TO TRUE                      06220006
062300                                                                  06230006
062400              MOVE SPACES          TO ANAVCMDO                    06240006
062500                                     ANAVKEYO                     06250006
062600              MOVE DP015-GREEN     TO ANAVCMDC                    06260006
062700                                     ANAVKEYC                     06270006
062800              MOVE DP015-UNDERLINE TO ANAVCMDH                    06280006
062900                                     ANAVKEYH                     06290006
063000                                                                  06300006
063100              PERFORM E200-BUILD-INITIAL-PANEL                    06310006
063200              PERFORM F100-DISPLAY-PANEL                          06320006
063300                                                                  06330006
063400         WHEN DP020-SRC-AID = DP016-ENTER                         06340006
063500              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                06350006
063600              SET ASC-NO-UPDATE-MADE TO TRUE                      06360006
063700                                                                  06370006
063800             IF  (DP020-NAV-MNEMONIC = SPACES)     OR             06380006
063900                 (DP020-NAV-MNEMONIC = LOW-VALUES)                06390006
064000                  PERFORM E300-EDIT-DATA-IN-COMMAREA              06400006
064100                  PERFORM F100-DISPLAY-PANEL                      06410006
064200             ELSE                                                 06420006
064300                  PERFORM E400-SETUP-INTER-APPL                   06430006
064400                  PERFORM DP015-1000-START-NAVIGATOR              06440006
064500             END-IF                                               06450006
064600                                                                  06460006
064700         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     06470006
064800              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                06480006
064900                                                                  06490006
065000              PERFORM E300-EDIT-DATA-IN-COMMAREA                  06500006
065100                                                                  06510006
065200              IF  PS-NO-ERROR                                     06520006
065300                  PERFORM E175-CHECK-UPDATED-DATA                 06530006
065400              END-IF                                              06540006
065500                                                                  06550006
065600              IF  ASC-UPDATE-MADE                                 06560006
065700              AND PS-NO-ERROR                                     06570006
065800                                                                  06580006
065900                  SET ASC-NO-UPDATE-MADE TO TRUE                  06590006
066000                                                                  06600006
066100                                                                  06610006
066200                  SET PS-DB2-RETRY TO TRUE                        06620006
066300                                                                  06630006
066400                  PERFORM Z400-UPDATE-DB-PARM                     06640006
066500                          UNTIL PS-DB2-OK                         06650006
066600                                                                  06660006
066700                  MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER        06670006
066800                  SET DP020-MSG-INFORMATIONAL TO TRUE             06680006
066900                                                                  06690006
067000              ELSE                                                06700006
067100                  IF PS-NO-ERROR                                  06710006
067200                     SET ASC-NO-UPDATE-MADE TO TRUE               06720006
067300                     MOVE PC-TSYMSG-00016 TO DP020-MSG-NUMBER     06730006
067400                     SET DP020-MSG-FATAL TO TRUE                  06740006
067500                     MOVE -1              TO APARML               06750006
067600                     SET PS-ERROR         TO TRUE                 06760006
067700                  ELSE                                            06770006
067800                     SET ASC-NO-UPDATE-MADE TO TRUE               06780006
067900                                                                  06790006
068000                  END-IF                                          06800006
068100              END-IF                                              06810006
068200                                                                  06820006
068300              PERFORM F100-DISPLAY-PANEL                          06830006
068400                                                                  06840006
068500         WHEN DP020-SRC-AID = DP016-PF15                          06850006
068600              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                06860006
068700              SET ASC-NO-UPDATE-MADE TO TRUE                      06870006
068800                                                                  06880006
068900              PERFORM E300-EDIT-DATA-IN-COMMAREA                  06890006
069000                                                                  06900006
069100              IF  PS-NO-ERROR                                     06910006
069200                                                                  06920006
069300                  PERFORM E150-CHECK-DATA-FOR-CHANGES             06930006
069400                                                                  06940006
069500                  IF  PS-NO-ERROR                                 06950006
069600                                                                  06960006
069700                      MOVE ASC-PARM-AMT                           06970006
069800                           TO ASC-PARM-AMT-UPDATED                06980006
069900                      SET ASC-UPDATE-MADE TO TRUE                 06990006
070000                      MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER    07000006
070100                      SET DP020-MSG-INFORMATIONAL TO TRUE         07010006
070200                                                                  07020006
070300                  END-IF                                          07030006
070400              END-IF                                              07040006
070500                                                                  07050006
070600              PERFORM F100-DISPLAY-PANEL                          07060006
070700                                                                  07070006
070800                                                                  07080006
070900         WHEN DP020-SRC-AID = DP016-PA2                           07090006
071000             SET ASC-NO-UPDATE-MADE TO TRUE                       07100006
071100             SET PS-SEND-DATA-ONLY TO TRUE                        07110006
071200                                                                  07120006
071300             MOVE -1 TO ANAVCMDL                                  07130006
071400                                                                  07140006
071500             PERFORM DP017-0000-GET-CURR-DATE-TIME                07150006
071600             PERFORM DP009-0000-LOAD-FK-LINES                     07160006
071700             PERFORM DP008-0000-WRITE-PANEL                       07170006
071800                                                                  07180006
071900         WHEN DP020-SRC-AID = DP016-CLEAR                         07190006
072000             SET ASC-NO-UPDATE-MADE TO TRUE                       07200006
072100             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07210006
072200                                                                  07220006
072300             PERFORM E300-EDIT-DATA-IN-COMMAREA                   07230006
072400             PERFORM F100-DISPLAY-PANEL                           07240006
072500                                                                  07250006
072600         WHEN OTHER                                               07260006
072700             SET ASC-NO-UPDATE-MADE TO TRUE                       07270006
072800             PERFORM E400-SETUP-INTER-APPL                        07280006
072900             PERFORM DP015-1000-START-NAVIGATOR                   07290006
073000                                                                  07300006
073100     END-EVALUATE.                                                07310006
073200******************************************************************07320006
073300*    INITIALIZE THE                                               07330006
073400*    APPLICATION SPECIFIC COMMAREA.                               07340006
073500*                                                                 07350006
073600*    PERFORMED BY:-                                               07360006
073700*                  C060-SAVE-INIT-INTER-APPL.                     07370006
073800******************************************************************07380006
073900 E100-INITIALIZE-COMMAREA.                                        07390006
074000     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07400006
074100******************************************************************07410006
074200*    CHECK TO SEE IF THE DATA HAS BEEN CHANGED BY                 07420006
074300*    ANOTHER USER AND TO SEE IF THIS USER HAS CHANGED THE         07430006
074400*    DATA FROM ITS ORIGINAL VALUE.                                07440006
074500*                                                                 07450006
074600*    PERFORMED BY:-                                               07460006
074700*                   D200-CHECK-LOCAL-FKEYS.                       07470006
074800******************************************************************07480006
074900 E150-CHECK-DATA-FOR-CHANGES.                                     07490006
075000     SET PS-DB2-RETRY TO TRUE.                                    07500006
075100                                                                  07510006
075200     PERFORM Z600-READ-DB-FOR-CHANGES                             07520006
075300             UNTIL PS-DB2-OK.                                     07530006
075400                                                                  07540006
075500     IF  ASC-PARM-AMT-ORIG = PPCCTL-PARM-AMT                      07550006
075600         CONTINUE                                                 07560006
075700                                                                  07570006
075800     ELSE                                                         07580006
075900         MOVE PC-TSYMSG-00068 TO DP020-MSG-NUMBER                 07590006
076000         MOVE -1              TO APARML                           07600006
076100         MOVE DP015-RED       TO APARMC                           07610006
076200         MOVE DP015-REVERSE   TO APARMH                           07620006
076300                                                                  07630006
076400         SET DP020-MSG-FATAL TO TRUE                              07640006
076500         SET PS-ERROR        TO TRUE                              07650006
076600     END-IF.                                                      07660006
076700                                                                  07670006
076800                                                                  07680006
076900     IF  ASC-PARM-AMT-ORIG = ASC-PARM-AMT                         07690006
077000     AND PS-NO-ERROR                                              07700006
077100         MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER                 07710006
077200         MOVE -1              TO APARML                           07720006
077300                                                                  07730006
077400         SET DP020-MSG-INFORMATIONAL TO TRUE                      07740006
077500         SET PS-ERROR                TO TRUE                      07750006
077600     END-IF.                                                      07760006
077700******************************************************************07770006
077800*    CHECK TO SEE IS THE DATA HAS BEEN CHANGED BY ANOTHER         07780006
077900*    USER AND TO SEE THAT IT HAS NOT BEEN CHANGED                 07790006
078000*    SINCE THE UPDATE KEY WAS PRESSED                             07800006
078100*                                                                 07810006
078200*    ALSO CHECK THAT THE DATA WAS CHANGED FROM ITS ORIGINAL       07820006
078300*    VALUE                                                        07830006
078400*                                                                 07840006
078500*    PERFORMED BY:-                                               07850006
078600*                   D200-CHECK-LOCAL-FKEYS.                       07860006
078700******************************************************************07870006
078800 E175-CHECK-UPDATED-DATA.                                         07880006
078900     SET PS-DB2-RETRY TO TRUE.                                    07890006
079000                                                                  07900006
079100     PERFORM Z600-READ-DB-FOR-CHANGES                             07910006
079200             UNTIL PS-DB2-OK.                                     07920006
079300                                                                  07930006
079400     IF  ASC-PARM-AMT-ORIG = PPCCTL-PARM-AMT                      07940006
079500         CONTINUE                                                 07950006
079600                                                                  07960006
079700     ELSE                                                         07970006
079800         MOVE PC-TSYMSG-00068 TO DP020-MSG-NUMBER                 07980006
079900         MOVE -1              TO APARML                           07990006
080000         MOVE DP015-RED       TO APARMC                           08000006
080100         MOVE DP015-REVERSE   TO APARMH                           08010006
080200                                                                  08020006
080300         SET DP020-MSG-FATAL TO TRUE                              08030006
080400         SET PS-ERROR        TO TRUE                              08040006
080500     END-IF.                                                      08050006
080600                                                                  08060006
080700     IF  ASC-PARM-AMT-UPDATED = ASC-PARM-AMT                      08070006
080800         CONTINUE                                                 08080006
080900                                                                  08090006
081000     ELSE                                                         08100006
081100         IF PS-NO-ERROR                                           08110006
081200            MOVE PC-TSYMSG-00016 TO DP020-MSG-NUMBER              08120006
081300            MOVE -1              TO APARML                        08130006
081400            MOVE DP015-RED       TO APARMC                        08140006
081500            MOVE DP015-REVERSE   TO APARMH                        08150006
081600                                                                  08160006
081700            SET DP020-MSG-FATAL TO TRUE                           08170006
081800            SET PS-ERROR        TO TRUE                           08180006
081900     END-IF.                                                      08190006
082000                                                                  08200006
082100                                                                  08210006
082200     IF  ASC-PARM-AMT-ORIG = ASC-PARM-AMT                         08220006
082300     AND PS-NO-ERROR                                              08230006
082400         MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER                 08240006
082500         MOVE -1              TO APARML                           08250006
082600         SET DP020-MSG-INFORMATIONAL TO TRUE                      08260006
082700         SET PS-ERROR        TO TRUE                              08270006
082800     END-IF.                                                      08280006
082900******************************************************************08290006
083000*    DISPLAY THE INITIAL PANEL                                    08300006
083100*                                                                 08310006
083200*    PERFORMED BY B100-CONTROL-PROCESSING.                        08320006
083300*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         08330006
083400******************************************************************08340006
083500 E200-BUILD-INITIAL-PANEL.                                        08350006
083600     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       08360006
083700                                                                  08370006
083800     SET PS-DB2-RETRY TO TRUE.                                    08380006
083900                                                                  08390006
084000     PERFORM Z300-READ-DB-FOR-PARM                                08400006
084100             UNTIL PS-DB2-OK.                                     08410006
084200******************************************************************08420006
084300*    EDIT THE STORE NUMBER FIELD.                                 08430006
084400*                                                                 08440006
084500*    PERFORMED BY B100-CONTROL-PROCESSING.                        08450006
084600*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         08460006
084700******************************************************************08470006
084800 E300-EDIT-DATA-IN-COMMAREA.                                      08480006
084900     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       08490006
085000                                                                  08500006
085100     IF  NOT DP020-NEXT-ACT-ERROR                                 08510006
085200         SET PS-NO-ERROR TO TRUE                                  08520006
085300     END-IF                                                       08530006
085400                                                                  08540006
085500                                                                  08550006
085600     IF (ASC-PARM-AMT-X = SPACES)                                 08560006
085700     OR (ASC-PARM-AMT-X = LOW-VALUES)                             08570006
085800         MOVE SPACES TO ASC-PARM-AMT-X                            08580006
085900                            APARMI                                08590006
086000         MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 08600006
086100         MOVE -1              TO APARML                           08610006
086200         MOVE DP015-RED       TO APARMC                           08620006
086300         MOVE DP015-REVERSE   TO APARMH                           08630006
086400                                                                  08640006
086500         SET DP020-MSG-FATAL TO TRUE                              08650006
086600         SET PS-ERROR        TO TRUE                              08660006
086700                                                                  08670006
086800     ELSE                                                         08680006
086900                                                                  08690006
087000         IF   ASC-PARM-IS-DTE-DDMMYY                              08700006
087100         OR   ASC-PARM-IS-DTE-MMYY                                08710006
087200         AND  PS-NO-ERROR                                         08720006
087300                                                                  08730006
087400              PERFORM E310-EDIT-DATE                              08740006
087500         ELSE                                                     08750006
087600              IF  PS-NO-ERROR                                     08760006
087700                                                                  08770006
087800                  PERFORM E330-EDIT-NUMBER                        08780006
087900              END-IF                                              08790006
088000         END-IF                                                   08800006
088100     END-IF.                                                      08810006
088200                                                                  08820006
088300     IF  PS-NO-ERROR                                              08830006
088400         PERFORM E350-SELECT-VALIDATION                           08840006
088500     END-IF.                                                      08850006
088600******************************************************************08860006
088700*    SELECT THE VALIDATION FOR A SPECIFIC PARAMETER               08870006
088800*    BASED ON THE PARMATER NUMBER                                 08880006
088900*                                                                 08890006
089000*    PERFORMED BY B100-CONTROL-PROCESSING.                        08900006
089100*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         08910006
089200******************************************************************08920006
089300 E350-SELECT-VALIDATION.                                          08930006
089400     EVALUATE TRUE                                                08940006
089500                                                                  08950006
089600         WHEN ASC-PARM-NBR                                        08960006
089700                      = PE048-PHY-INV-LEAD-TIME-NBR               08970006
089800                                                                  08980006
089900              PERFORM H100-VAL-PHYS-INV-LTIME                     08990006
090000                                                                  09000006
090100         WHEN ASC-PARM-NBR                                        09010006
090200                      = PE048-PHY-INV-DATE-NBR                    09020006
090300                                                                  09030006
090400              PERFORM H110-VAL-PHYS-INV-DATE                      09040006
090500                                                                  09050006
090600         WHEN ASC-PARM-NBR                                        09060006
090700                      = PE048-MINIMUM-LEAD-TIME-NBR               09070006
090800                                                                  09080006
090900              PERFORM H120-VAL-MIN-P-C-LEAD-TM                    09090006
091000                                                                  09100006
091100         WHEN ASC-PARM-NBR                                        09110006
091200                      = PE048-CENTRAL-PPC-MAX-DLR-NBR             09120006
091300                                                                  09130006
091400              PERFORM H130-VAL-CEN-P-C-MAX-D                      09140006
091500                                                                  09150006
091600         WHEN ASC-PARM-NBR                                        09160006
091700                      = PE048-CENTRAL-PPC-MAX-UNIT-NBR            09170006
091800                                                                  09180006
091900              PERFORM H140-VAL-CEN-P-C-MAX-U                      09190006
092000                                                                  09200006
092100         WHEN ASC-PARM-NBR                                        09210006
092200                      = PE048-STORE-PPC-MAX-DLR-NBR               09220006
092300                                                                  09230006
092400              PERFORM H150-VAL-STR-P-C-MAX-D                      09240006
092500                                                                  09250006
092600         WHEN ASC-PARM-NBR                                        09260006
092700                      = PE048-STORE-PPC-MAX-UNIT-NBR              09270006
092800                                                                  09280006
092900              PERFORM H155-VAL-STR-P-C-MAX-U                      09290006
093000                                                                  09300006
093100         WHEN ASC-PARM-NBR                                        09310006
093200                      = PE048-ZOUT-MAX-DLR-NBR                    09320006
093300                                                                  09330006
093400              PERFORM H160-VAL-ZERO-OUT-P-C-MAX-D                 09340006
093500                                                                  09350006
093600         WHEN ASC-PARM-NBR                                        09360006
093700                      = PE048-CORP-DOC-PROC-TIMEFR-NBR            09370006
093800                                                                  09380006
093900              PERFORM H170-VAL-CENT-DOC-PROC-TFRAME               09390006
094000                                                                  09400006
094100         WHEN ASC-PARM-NBR                                        09410006
094200                      = PE048-ZOUT-PROC-TIMEFR-NBR                09420006
094300                                                                  09430006
094400              PERFORM H180-VAL-ZERO-OUT-PROC-TFRAME               09440006
094500                                                                  09450006
094600         WHEN ASC-PARM-NBR                                        09460006
094700                      = PE048-MAX-HARDLN-PPC-PCT-NBR              09470006
094800                                                                  09480006
094900              PERFORM H190-VAL-MAX-HARD-LINES-P-C                 09490006
095000                                                                  09500006
095100         WHEN ASC-PARM-NBR                                        09510006
095200                      = PE048-RECOM-HL-CLEAR-PCT-NBR              09520006
095300                                                                  09530006
095400              PERFORM H200-VAL-REC-HARD-LINES-P-C                 09540006
095500                                                                  09550006
095600         WHEN ASC-PARM-NBR                                        09560006
095700                      = PE048-MAX-SOFTLN-PPC-PCT-NBR              09570006
095800                                                                  09580006
095900              PERFORM H210-VAL-MAX-SOFT-LINES-P-C                 09590006
096000                                                                  09600006
096100         WHEN ASC-PARM-NBR                                        09610006
096200                      = PE048-RECOM-SL-CLEAR-PCT-NBR              09620006
096300                                                                  09630006
096400              PERFORM H220-VAL-REC-SOFT-LINES-P-C                 09640006
096500                                                                  09650006
096600         WHEN ASC-PARM-NBR                                        09660006
096700                      = PE048-MIN-PPC-PCT-NBR                     09670006
096800                                                                  09680006
096900              PERFORM H230-VAL-MIN-ALL-LINES-P-C                  09690006
097000                                                                  09700006
097100         WHEN ASC-PARM-NBR                                        09710006
097200                      = PE048-VOL-RPT-LEAD-TIME-NBR               09720006
097300                                                                  09730006
097400              PERFORM H240-VAL-VOL-RPT-LTIME                      09740006
097500                                                                  09750006
097600         WHEN ASC-PARM-NBR                                        09760006
097700                      = PE048-ZOUT-CHG-LEAD-TIME-NBR              09770006
097800                                                                  09780006
097900              PERFORM H250-VAL-ZERO-OUT-SCHD-LTIME                09790006
098000                                                                  09800006
098100         WHEN ASC-PARM-NBR                                        09810006
098200                      = PE048-INACT-DEL-TIMEFR-NBR                09820006
098300                                                                  09830006
098400              PERFORM H260-VAL-INACT-DOC-DEL-TFRAME               09840006
098500                                                                  09850006
098600                                                                  09860006
098700         WHEN ASC-PARM-NBR                                        09870006
098800                      = PE048-INACT-PND-DEL-TIMEFR-NBR            09880006
098900                                                                  09890006
099000              PERFORM H270-VAL-PE-DOC-INACT-DEL-DAYS              09900006
099100                                                                  09910006
099200         WHEN ASC-PARM-NBR                                        09920006
099300                      = PE048-NONCLEAR-DOC-NOPRT-NBR              09930006
099400                                                                  09940006
099500              PERFORM H280-VAL-NONCLEAR-DOC-PRT-DAYS              09950006
099600                                                                  09960006
099700         WHEN ASC-PARM-NBR                                        09970006
099800                      = PE048-LINES-PER-DOC-NBR                   09980006
099900                                                                  09990006
100000              PERFORM H290-VAL-NBR-OF-LINES-PER-DOC               10000006
100100                                                                  10010006
100200         WHEN ASC-PARM-NBR                                        10020006
100300                      = PE048-CORP-DOC-PRT-TIMEFR-NBR             10030006
100400                                                                  10040006
100500              PERFORM H300-VAL-CORP-DOC-PRT-TFRAME                10050006
100600                                                                  10060006
100700         WHEN ASC-PARM-NBR                                        10070006
100800                      = PE048-COUNT-ENTRY-TIMEFR-NBR              10080006
100900                                                                  10090006
101000              PERFORM H310-VAL-COUNT-ENTRY-TFRAME                 10100006
101100                                                                  10110006
101200         WHEN ASC-PARM-NBR                                        10120006
101300                      = PE048-INSTR-ME-DQ-TIMEFR-NBR              10130006
101400                                                                  10140006
101500              PERFORM H320-VAL-INSTR-ME-DQ-TFRAME                 10150006
101600                                                                  10160006
101700         WHEN ASC-PARM-NBR                                        10170006
101800                      = PE048-INSTR-PAGES-PER-DOC-NBR             10180006
101900                                                                  10190006
102000              PERFORM H330-VAL-INSTR-PAGES-PER-DOC                10200006
102100                                                                  10210006
102200         WHEN ASC-PARM-NBR                                        10220006
102300                      = PE048-INSTR-EXCESSIVE-UNIT-NBR            10230006
102400                                                                  10240006
102500              PERFORM H340-VAL-INSTR-EXCESS-UNITS                 10250006
102600                                                                  10260006
102700         WHEN ASC-PARM-NBR                                        10270006
102800                      = PE048-INSTR-ISS-DQ-TIMEFR-NBR             10280006
102900                                                                  10290006
103000              PERFORM H350-VAL-INSTR-ISS-DQ-TIMEFR                10300006
103100                                                                  10310006
103200         WHEN ASC-PARM-NBR                                        10320006
103300                      = PE048-MAX-PERM-RLSE-AVAIL-NBR             10330006
103400                                                                  10340006
103500              PERFORM H360-VAL-MAX-PERM-RLSE-NBR                  10350006
103600                                                                  10360006
103700         WHEN ASC-PARM-NBR                                        10370006
103800                      = PE048-INSTR-EXCESSIVE-DLR-NBR             10380006
103900                                                                  10390006
104000              PERFORM H370-VAL-INSTR-EXCESS-DOLLARS               10400006
104100                                                                  10410006
104200         WHEN ASC-PARM-NBR = PE048-ZEROUT-PROTECT-DAYS-NBR        10420006
104300              PERFORM H380-VAL-ZEROUT-PROTECT-DAYS                10430006
104400                                                                  10440006
104500         WHEN ASC-PARM-NBR = PE048-ADD-NEW-STR-PREV-RCP-NBR       10450006
104600              PERFORM H390-VAL-ADD-NEW-STR-PREV-RCP               10460006
104700                                                                  10470006
104800         WHEN ASC-PARM-NBR = PE048-RCP-MAXIUM-TIERS-NBR           10480006
104900              PERFORM H400-VAL-RCP-MAXIUM-TIERS                   10490006
105000                                                                  10500006
105100         WHEN ASC-PARM-NBR = PE048-MIN-DAYS-RCP-TIERS-NBR         10510006
105200              PERFORM H410-VAL-MIN-DAYS-RCP-TIERS                 10520006
105300                                                                  10530006
105400         WHEN OTHER                                               10540006
105500                                                                  10550006
105600              PERFORM C300-RETURN-TO-PREV-TRAN                    10560006
105700                                                                  10570006
105800     END-EVALUATE.                                                10580006
105900******************************************************************10590006
106000*    EDIT THE DATE FIELD.                                         10600006
106100*                                                                 10610006
106200*PERFORMED BY:-                                                   10620006
106300*              E300-EDIT-DATA-IN-COMMAREA                         10630006
106400******************************************************************10640006
106500 E310-EDIT-DATE.                                                  10650006
106600     MOVE ASC-PARM-AMT-X                                          10660006
106700                  TO PV-DATE-MMDDYYYY-FORMAT.                     10670006
106800                                                                  10680006
106900     MOVE  PV-DATE-MMDDYYYY-MM                                    10690006
107000                        TO DP010I-UNEDITED-FIELD.                 10700006
107100                                                                  10710006
107200     PERFORM E320-NUMERIC-CHECK-ON-DATE.                          10720006
107300                                                                  10730006
107400     IF  PS-NO-ERROR                                              10740006
107500         MOVE DP010I-NUMERIC-FIELD TO PV-DATE-MM                  10750006
107600                                                                  10760006
107700         MOVE  PV-DATE-MMDDYYYY-DD                                10770006
107800                        TO DP010I-UNEDITED-FIELD                  10780006
107900                                                                  10790006
108000         PERFORM E320-NUMERIC-CHECK-ON-DATE                       10800006
108100                                                                  10810006
108200         IF  PS-NO-ERROR                                          10820006
108300             MOVE DP010I-NUMERIC-FIELD TO PV-DATE-DD              10830006
108400                                                                  10840006
108500             MOVE  PV-DATE-MMDDYYYY-YY                            10850006
108600                        TO DP010I-UNEDITED-FIELD                  10860006
108700                                                                  10870006
108800             PERFORM E320-NUMERIC-CHECK-ON-DATE                   10880006
108900                                                                  10890006
109000             IF  PS-NO-ERROR                                      10900006
109100                 MOVE DP010I-NUMERIC-FIELD TO PV-DATE-YY          10910006
109200                                                                  10920006
109300                 MOVE  PV-DATE-MMDDYYYY-CC                        10930006
109400                          TO DP010I-UNEDITED-FIELD                10940006
109500                                                                  10950006
109600                 PERFORM E320-NUMERIC-CHECK-ON-DATE               10960006
109700                                                                  10970006
109800                 IF  PS-NO-ERROR                                  10980006
109900                     MOVE DP010I-NUMERIC-FIELD TO PV-DATE-CC      10990006
110000                                                                  11000006
110100                 END-IF                                           11010006
110200             END-IF                                               11020006
110300         END-IF                                                   11030006
110400     END-IF.                                                      11040006
110500******************************************************************11050006
110600*    EDIT THE DATE FIELD.                                         11060006
110700*                                                                 11070006
110800*PERFORMED BY:-                                                   11080006
110900*              E300-EDIT-DATA-IN-COMMAREA                         11090006
111000******************************************************************11100006
111100 E320-NUMERIC-CHECK-ON-DATE.                                      11110006
111200     MOVE 2             TO DP010I-MAXIMUM-DIGITS.                 11120006
111300     MOVE +0            TO DP010I-MAXIMUM-DECIMALS.               11130006
111400                                                                  11140006
111500     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     11150006
111600                                                                  11160006
111710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             11171008
111720                         USING DP010I-NUMERIC-EDIT-AREA           11172008
111800                                                                  11180006
111900     IF  DP010I-ERROR-DETECTED                                    11190006
112000         MOVE DP015-RED     TO APARMC                             11200006
112100         MOVE DP015-REVERSE TO APARMH                             11210006
112200         MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER                 11220006
112300         MOVE -1 TO APARML                                        11230006
112400                                                                  11240006
112500         SET DP020-MSG-FATAL TO TRUE                              11250006
112600         SET PS-ERROR        TO TRUE                              11260006
112700     END-IF.                                                      11270006
112800******************************************************************11280006
112900*    EDIT THE PARM NUMBER FIELD.                                  11290006
113000*                                                                 11300006
113100*PERFORMED BY:-                                                   11310006
113200*              E300-EDIT-DATA-IN-COMMAREA                         11320006
113300******************************************************************11330006
113400 E330-EDIT-NUMBER.                                                11340006
113500     MOVE ASC-PARM-AMT-X       TO DP010I-UNEDITED-FIELD.          11350006
113600     MOVE PC-PARM-MAX-LENGTH   TO DP010I-MAXIMUM-DIGITS.          11360006
113700     MOVE +0                   TO DP010I-MAXIMUM-DECIMALS.        11370006
113800                                                                  11380006
113900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     11390006
114000                                                                  11400006
114110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             11411008
114120                         USING DP010I-NUMERIC-EDIT-AREA           11412008
114200                                                                  11420006
114300     IF  DP010I-ERROR-DETECTED                                    11430006
114400         MOVE DP015-RED     TO APARMC                             11440006
114500         MOVE DP015-REVERSE TO APARMH                             11450006
114600         MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER                 11460006
114700         MOVE -1 TO APARML                                        11470006
114800                                                                  11480006
114900         SET DP020-MSG-FATAL TO TRUE                              11490006
115000         SET PS-ERROR        TO TRUE                              11500006
115100                                                                  11510006
115200     ELSE                                                         11520006
115300         IF (ASC-PARM-NBR NOT = PE048-NONCLEAR-DOC-NOPRT-NBR      11530006
115400         AND ASC-PARM-NBR NOT = PE048-COUNT-ENTRY-TIMEFR-NBR      11540006
115500         AND ASC-PARM-NBR NOT = PE048-MINIMUM-LEAD-TIME-NBR)      11550006
115600             IF  (DP010I-NUMERIC-FIELD = +0)                      11560006
115700             OR  (DP010I-NUMERIC-FIELD =  ZEROS)                  11570006
115800                                                                  11580006
115900                  MOVE DP015-RED     TO APARMC                    11590006
116000                  MOVE DP015-REVERSE TO APARMH                    11600006
116100                  MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER        11610006
116200                  MOVE -1 TO APARML                               11620006
116300                                                                  11630006
116400                  SET DP020-MSG-FATAL TO TRUE                     11640006
116500                  SET PS-ERROR        TO TRUE                     11650006
116600             ELSE                                                 11660006
116700                  MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT       11670006
116800             END-IF                                               11680006
116900         ELSE                                                     11690006
117000             MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT            11700006
117100         END-IF                                                   11710006
117200     END-IF.                                                      11720006
117300******************************************************************11730006
117400*    SETUP THE INTER APPLICATION COMMAREA WITH DATA FROM THE      11740006
117500*    SPECIFIC COMMARE AND SET THE INTER APPLICATION FORMAT CODE.  11750006
117600*                                                                 11760006
117700*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         11770006
117800******************************************************************11780006
117900 E400-SETUP-INTER-APPL.                                           11790006
118000     MOVE ASC-PARM-NBR TO                                         11800006
118100          PE022-PARM-NBR.                                         11810006
118200                                                                  11820006
118300     MOVE 'Q150' TO PE022-INTER-APPL-FORMAT-CODE.                 11830006
118400******************************************************************11840006
118500*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       11850006
118600*                                                                 11860006
118700*    PERFORMED BY B100-CONTROL-PROCESSING.                        11870006
118800******************************************************************11880006
118900 F100-DISPLAY-PANEL.                                              11890006
119000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       11900006
119100                                                                  11910006
119200     IF  PS-SEND-MAP-N-DATA-FRSET                                 11920006
119300         PERFORM DP002-0000-FORMAT-TITLE-LINES                    11930006
119400         PERFORM G100-MOVE-COMMAREA-TO-SCREEN                     11940006
119500     END-IF.                                                      11950006
119600                                                                  11960006
119700     PERFORM DP005-0000-FORMAT-MSG-LINES.                         11970006
119800                                                                  11980006
119900     IF  (DP020-SRC-AID = DP016-PA2) OR                           11990006
120000         (PS-SEND-MAP-N-DATA-FRSET)                               12000006
120100          PERFORM DP009-0000-LOAD-FK-LINES                        12010006
120200     END-IF.                                                      12020006
120300                                                                  12030006
120400     IF PS-NO-ERROR                                               12040006
120500        MOVE -1 TO APARML                                         12050006
120600        MOVE DP015-GREEN                                          12060006
120700                TO APARMC                                         12070006
120800        MOVE DP015-UNDERLINE                                      12080006
120900                TO APARMH                                         12090006
121000                                                                  12100006
121100     END-IF.                                                      12110006
121200                                                                  12120006
121300                                                                  12130006
121400     MOVE DP015-UNP-ALP-NOR-MDT TO APARMA.                        12140006
121500                                                                  12150006
121600     PERFORM DP008-0000-WRITE-PANEL.                              12160006
121700******************************************************************12170006
121800*    MOVE THE FIELDS FROM THE COMMAREA TO THE SCREEN.             12180006
121900*                                                                 12190006
122000*    PERFORMED BY F100-DISPLAY-PANEL.                             12200006
122100******************************************************************12210006
122200 G100-MOVE-COMMAREA-TO-SCREEN.                                    12220006
122300     IF  ASC-PARM-IS-DTE-DDMMYY                                   12230006
122400     OR  ASC-PARM-IS-DTE-MMYY                                     12240006
122500         IF  PS-NO-ERROR                                          12250006
122600             MOVE ASC-PARM-AMT-X TO APARMO                        12260006
122700         END-IF                                                   12270006
122800                                                                  12280006
122900     ELSE                                                         12290006
123000        IF  PS-NO-ERROR                                           12300006
123100            MOVE ASC-PARM-AMT                                     12310006
123200                TO PV-DISPLAY-PARM-NBR                            12320006
123300            MOVE PV-DISPLAY-PARM-NBR                              12330006
123400                  TO PV-DISPLAY-NUMBER                            12340006
123500            MOVE PV-DISPLAY-NUMBER                                12350006
123600                            TO APARMO                             12360006
123700        END-IF                                                    12370006
123800     END-IF.                                                      12380006
123900                                                                  12390006
124000     MOVE ASC-DESC     TO ADESC01O.                               12400006
124100     MOVE ASC-TEXT-1 TO ATEXT01O.                                 12410006
124200     MOVE ASC-TEXT-2 TO ATEXT02O.                                 12420006
124300     MOVE ASC-TEXT-3 TO ATEXT03O.                                 12430006
124400     MOVE ASC-TEXT-4 TO ATEXT04O.                                 12440006
124500******************************************************************12450006
124600*    VALIDATE THE PHYSICAL INVENTORY LEAD TIME      .             12460006
124700*                                                                 12470006
124800*    PERFORMED  E350-SELECT-VALIDATION.                           12480006
124900******************************************************************12490006
125000 H100-VAL-PHYS-INV-LTIME.                                         12500006
125100     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 12510006
125200     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 12520006
125300     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               12530006
125400                                                                  12540006
125500     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      12550006
125600                                                                  12560006
125710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12571008
125720                         USING DP010I-NUMERIC-EDIT-AREA           12572008
125800                                                                  12580006
125900     IF  DP010I-ERROR-DETECTED                                    12590006
126000         MOVE DP015-RED     TO APARMC                             12600006
126100         MOVE DP015-REVERSE TO APARMH                             12610006
126200         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 12620006
126300         MOVE -1 TO APARML                                        12630006
126400                                                                  12640006
126500         SET DP020-MSG-FATAL TO TRUE                              12650006
126600         SET PS-ERROR        TO TRUE                              12660006
126700                                                                  12670006
126800     ELSE                                                         12680006
126900         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                12690006
127000                                                                  12700006
127100         IF (ASC-PARM-AMT >    PC-MIN-PHYS-INV-LTIME              12710006
127200         AND ASC-PARM-AMT <= PC-MAX-PHYS-INV-LTIME)               12720006
127300                                                                  12730006
127400             PERFORM I100-XVAL-PHYS-INV-LTIME                     12740006
127500                                                                  12750006
127600         ELSE                                                     12760006
127700             MOVE DP015-RED     TO APARMC                         12770006
127800             MOVE DP015-REVERSE TO APARMH                         12780006
127900             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             12790006
128000             MOVE -1 TO APARML                                    12800006
128100                                                                  12810006
128200             SET DP020-MSG-FATAL TO TRUE                          12820006
128300             SET PS-ERROR        TO TRUE                          12830006
128400                                                                  12840006
128500     END-IF.                                                      12850006
128600******************************************************************12860006
128700*    CROSS VALIDATE THE PHYSICAL INVENTORY LEAD TIME.             12870006
128800*                                                                 12880006
128900*    PERFORMED BY:-                                               12890006
129000*                   H100-VAL-PHYS-INV-LTIME.                      12900006
129100******************************************************************12910006
129200 I100-XVAL-PHYS-INV-LTIME.                                        12920006
129300     MOVE PE048-CORP-DOC-PROC-TIMEFR-NBR                          12930006
129400                             TO PV-CROSS-VALIDATE-PARM-NBR.       12940006
129500     SET PS-DB2-RETRY TO TRUE.                                    12950006
129600                                                                  12960006
129700     PERFORM Z500-READ-DB-CROSS-VALIDATE                          12970006
129800             UNTIL PS-DB2-OK.                                     12980006
129900                                                                  12990006
130000     IF  (ASC-PARM-AMT >=                                         13000006
130100                PV-CROSS-VALIDATE-PARM-AMT)                       13010006
130200         CONTINUE                                                 13020006
130300                                                                  13030006
130400     ELSE                                                         13040006
130500         MOVE DP015-RED     TO APARMC                             13050006
130600         MOVE DP015-REVERSE TO APARMH                             13060006
130700         MOVE PC-TSYMSG-00127 TO DP020-MSG-NUMBER                 13070006
130800         MOVE -1 TO APARML                                        13080006
130900                                                                  13090006
131000         SET DP020-MSG-FATAL TO TRUE                              13100006
131100         SET PS-ERROR        TO TRUE                              13110006
131200     END-IF.                                                      13120006
131300******************************************************************13130006
131400*    VALIDATE THE PHYSICAL INVENTORY DATE.                        13140006
131500*    PERFORMED  E350-SELECT-VALIDATION.                           13150006
131600******************************************************************13160006
131700 H110-VAL-PHYS-INV-DATE.                                          13170006
131800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13180006
131900     MOVE 'H110-VAL-PHYS-INV-DATE' TO DP013-PARAGRAPH.            13190006
132000                                                                  13200006
132100     MOVE PV-DATE-CCYYMMDD TO DPG52-LK-DATE-INPUT.                13210006
132200     SET DPG51-ACTUAL-CALENDAR-ONLY                               13220006
132300         DPG52-LK-DTE-ISO TO TRUE.                                13230006
132400                                                                  13240006
132500     PERFORM Z100-CALENDAR-CALL.                                  13250006
132600                                                                  13260006
132700     EVALUATE TRUE                                                13270006
132800        WHEN DPG54-NO-ERROR                                       13280006
132900             MOVE DPG55-DB2-ISO-DATE-N TO ASC-PARM-AMT            13290006
133000             PERFORM I110-XVAL-PHYS-INV-DATE                      13300006
133100        WHEN DPG54-WARNING-ERROR                                  13310006
133200             MOVE DP015-RED TO APARMC                             13320006
133300             MOVE DP015-REVERSE TO APARMH                         13330006
133400             MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER             13340006
133500             MOVE -1 TO APARML                                    13350006
133600             SET DP020-MSG-FATAL TO TRUE                          13360006
133700             SET PS-ERROR TO TRUE                                 13370006
133800     END-EVALUATE.                                                13380006
133900******************************************************************13390006
134000*    CARRYOUT EXTRACT VALIDATION ON THE PHYSICAL INVENTORY        13400006
134100*    DATE                                                         13410006
134200*                                                                 13420006
134300*    PERFORMED BY:-                                               13430006
134400*                 H110-VAL-PHYS-INV-DATE.                         13440006
134500******************************************************************13450006
134600 I110-XVAL-PHYS-INV-DATE.                                         13460006
134700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13470006
134800     MOVE 'I110-XVAL-PHYS-INV-DATE' TO DP013-PARAGRAPH.           13480006
134900                                                                  13490006
135000     MOVE PV-DATE-MMDDYYYY-FORMAT TO                              13500006
135100          DPG52-LK-DATE-INPUT.                                    13510006
135200     MOVE DP017-EDITED-DATE-YYYYMMDD TO                           13520006
135300          DPG53-LK-CMPR-DATE-INPUT.                               13530006
135400                                                                  13540006
135500     SET DPG51-ACTUAL-CALENDAR-ONLY                               13550006
135600         DPG52-LK-DTE-GREG-CC                                     13560006
135700         DPG53-LK-CMPR-DTE-ISO-FMT TO TRUE.                       13570006
135800                                                                  13580006
135900     PERFORM Z100-CALENDAR-CALL.                                  13590006
136000                                                                  13600006
136100     EVALUATE TRUE                                                13610006
136200        WHEN DPG54-NO-ERROR                                       13620006
136300            PERFORM                                               13630006
136400               IF (DPG55-DAYS-DIFFERENCE <                        13640006
136500                   PC-MIN-INV-DATE-DAYS)                          13650006
136600                 OR                                               13660006
136700                  (DPG55-DAYS-DIFFERENCE >                        13670006
136800                   PC-MAX-INV-DATE-DAYS)                          13680006
136900                    MOVE DP015-RED TO APARMC                      13690006
137000                    MOVE DP015-REVERSE TO APARMH                  13700006
137100                    MOVE -1 TO APARML                             13710006
137200                    SET DP020-MSG-FATAL TO TRUE                   13720006
137300                    SET PS-ERROR TO TRUE                          13730006
137400                    IF (DPG55-DAYS-DIFFERENCE >                   13740006
137500                        PC-MAX-INV-DATE-DAYS)                     13750006
137600                         MOVE PC-TSYMSG-00025 TO                  13760006
137700                              DP020-MSG-NUMBER                    13770006
137800                    ELSE                                          13780006
137900                         MOVE PC-TSYMSG-00067 TO                  13790006
138000                              DP020-MSG-NUMBER                    13800006
138100                   END-IF                                         13810006
138200               END-IF                                             13820006
138300            END-PERFORM                                           13830006
138400        WHEN DPG54-WARNING-ERROR                                  13840006
138500            MOVE DP015-RED TO APARMC                              13850006
138600            MOVE DP015-REVERSE TO APARMH                          13860006
138700            MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER              13870006
138800            MOVE -1 TO APARML                                     13880006
138900            SET DP020-MSG-FATAL TO TRUE                           13890006
139000            SET PS-ERROR TO TRUE                                  13900006
139100     END-EVALUATE.                                                13910006
139200******************************************************************13920006
139300*    VALIDATE THE PRICE CHANGE LEAD TIME.                         13930006
139400*                                                                 13940006
139500*    PERFORMED  E350-SELECT-VALIDATION.                           13950006
139600******************************************************************13960006
139700 H120-VAL-MIN-P-C-LEAD-TM.                                        13970006
139800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 13980006
139900     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 13990006
140000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               14000006
140100                                                                  14010006
140200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      14020006
140300                                                                  14030006
140410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14041008
140420                         USING DP010I-NUMERIC-EDIT-AREA           14042008
140500                                                                  14050006
140600     IF  DP010I-ERROR-DETECTED                                    14060006
140700         MOVE DP015-RED     TO APARMC                             14070006
140800         MOVE DP015-REVERSE TO APARMH                             14080006
140900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 14090006
141000         MOVE -1 TO APARML                                        14100006
141100                                                                  14110006
141200         SET DP020-MSG-FATAL TO TRUE                              14120006
141300         SET PS-ERROR        TO TRUE                              14130006
141400                                                                  14140006
141500     ELSE                                                         14150006
141600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                14160006
141700                                                                  14170006
141800         IF  (ASC-PARM-AMT >=                                     14180006
141900                   PC-MIN-LEAD-TME-DAYS)                          14190006
142000         AND (ASC-PARM-AMT <=                                     14200006
142100                    PC-MAX-LEAD-TME-DAYS)                         14210006
142200             CONTINUE                                             14220006
142300         ELSE                                                     14230006
142400             MOVE DP015-RED     TO APARMC                         14240006
142500             MOVE DP015-REVERSE TO APARMH                         14250006
142600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             14260006
142700             MOVE -1 TO APARML                                    14270006
142800                                                                  14280006
142900             SET DP020-MSG-FATAL TO TRUE                          14290006
143000             SET PS-ERROR        TO TRUE                          14300006
143100                                                                  14310006
143200     END-IF.                                                      14320006
143300******************************************************************14330006
143400*    VALIDATE THE PERMANENT PRICE CHANGE MAXIMUM DOLLARS.         14340006
143500*                                                                 14350006
143600*    PERFORMED  E350-SELECT-VALIDATION.                           14360006
143700******************************************************************14370006
143800 H130-VAL-CEN-P-C-MAX-D.                                          14380006
143900     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 14390006
144000     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 14400006
144100     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               14410006
144200                                                                  14420006
144300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      14430006
144400                                                                  14440006
144510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14451008
144520                         USING DP010I-NUMERIC-EDIT-AREA           14452008
144600                                                                  14460006
144700     IF  DP010I-ERROR-DETECTED                                    14470006
144800         MOVE DP015-RED     TO APARMC                             14480006
144900         MOVE DP015-REVERSE TO APARMH                             14490006
145000         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 14500006
145100         MOVE -1 TO APARML                                        14510006
145200                                                                  14520006
145300         SET DP020-MSG-FATAL TO TRUE                              14530006
145400         SET PS-ERROR        TO TRUE                              14540006
145500                                                                  14550006
145600     ELSE                                                         14560006
145700         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                14570006
145800     END-IF.                                                      14580006
145900******************************************************************14590006
146000*    VALIDATE THE PREMENANT PRICE CHANGE MAXIMUM UNITS.           14600006
146100*                                                                 14610006
146200*    PERFORMED  E350-SELECT-VALIDATION.                           14620006
146300******************************************************************14630006
146400 H140-VAL-CEN-P-C-MAX-U.                                          14640006
146500     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 14650006
146600     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 14660006
146700     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               14670006
146800                                                                  14680006
146900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      14690006
147000                                                                  14700006
147110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14711008
147120                         USING DP010I-NUMERIC-EDIT-AREA           14712008
147200                                                                  14720006
147300     IF  DP010I-ERROR-DETECTED                                    14730006
147400         MOVE DP015-RED     TO APARMC                             14740006
147500         MOVE DP015-REVERSE TO APARMH                             14750006
147600         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 14760006
147700         MOVE -1 TO APARML                                        14770006
147800                                                                  14780006
147900         SET DP020-MSG-FATAL TO TRUE                              14790006
148000         SET PS-ERROR        TO TRUE                              14800006
148100                                                                  14810006
148200     ELSE                                                         14820006
148300         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                14830006
148400     END-IF.                                                      14840006
148500******************************************************************14850006
148600*    VALIDATE THE STORE PERMANENT PRICE CHANGE MAXIMUM            14860006
148700*    DOLLARS                                                      14870006
148800*                                                                 14880006
148900*    PERFORMED  E350-SELECT-VALIDATION.                           14890006
149000******************************************************************14900006
149100 H150-VAL-STR-P-C-MAX-D.                                          14910006
149200     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 14920006
149300     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 14930006
149400     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               14940006
149500                                                                  14950006
149600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      14960006
149700                                                                  14970006
149810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14981008
149820                         USING DP010I-NUMERIC-EDIT-AREA           14982008
149900                                                                  14990006
150000     IF  DP010I-ERROR-DETECTED                                    15000006
150100         MOVE DP015-RED     TO APARMC                             15010006
150200         MOVE DP015-REVERSE TO APARMH                             15020006
150300         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 15030006
150400         MOVE -1 TO APARML                                        15040006
150500                                                                  15050006
150600         SET DP020-MSG-FATAL TO TRUE                              15060006
150700         SET PS-ERROR        TO TRUE                              15070006
150800                                                                  15080006
150900     ELSE                                                         15090006
151000         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                15100006
151100     END-IF.                                                      15110006
151200******************************************************************15120006
151300*    VALIDATE THE STORE PERMANENT PRICE CHANGE MAXIMUM            15130006
151400*    DOLLARS                                                      15140006
151500*                                                                 15150006
151600*    PERFORMED  E350-SELECT-VALIDATION.                           15160006
151700******************************************************************15170006
151800 H155-VAL-STR-P-C-MAX-U.                                          15180006
151900     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 15190006
152000     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 15200006
152100     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               15210006
152200                                                                  15220006
152300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      15230006
152400                                                                  15240006
152510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             15251008
152520                         USING DP010I-NUMERIC-EDIT-AREA           15252008
152600                                                                  15260006
152700     IF  DP010I-ERROR-DETECTED                                    15270006
152800         MOVE DP015-RED     TO APARMC                             15280006
152900         MOVE DP015-REVERSE TO APARMH                             15290006
153000         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 15300006
153100         MOVE -1 TO APARML                                        15310006
153200                                                                  15320006
153300         SET DP020-MSG-FATAL TO TRUE                              15330006
153400         SET PS-ERROR        TO TRUE                              15340006
153500                                                                  15350006
153600     ELSE                                                         15360006
153700         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                15370006
153800     END-IF.                                                      15380006
153900******************************************************************15390006
154000*    VALIDATE THE ZERO OUT  PERMANENT PRICE CHANGE MAXIMUM        15400006
154100*    DOLLARS                                                      15410006
154200*                                                                 15420006
154300*    PERFORMED  E350-SELECT-VALIDATION.                           15430006
154400******************************************************************15440006
154500 H160-VAL-ZERO-OUT-P-C-MAX-D.                                     15450006
154600     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 15460006
154700     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 15470006
154800     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               15480006
154900                                                                  15490006
155000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      15500006
155100                                                                  15510006
155210     CALL DP010I-NUMERIC-EDIT-ROUTINE                             15521008
155220                         USING DP010I-NUMERIC-EDIT-AREA           15522008
155300                                                                  15530006
155400     IF  DP010I-ERROR-DETECTED                                    15540006
155500         MOVE DP015-RED     TO APARMC                             15550006
155600         MOVE DP015-REVERSE TO APARMH                             15560006
155700         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 15570006
155800         MOVE -1 TO APARML                                        15580006
155900                                                                  15590006
156000         SET DP020-MSG-FATAL TO TRUE                              15600006
156100         SET PS-ERROR        TO TRUE                              15610006
156200                                                                  15620006
156300     ELSE                                                         15630006
156400         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                15640006
156500     END-IF.                                                      15650006
156600******************************************************************15660006
156700*    VALIDATE THE  PERMANENT PRICE CHANGE DOCUMENT                15670006
156800*    PROCESSING TIME FRAME.                                       15680006
156900*                                                                 15690006
157000*    PERFORMED  E350-SELECT-VALIDATION.                           15700006
157100******************************************************************15710006
157200 H170-VAL-CENT-DOC-PROC-TFRAME.                                   15720006
157300     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 15730006
157400     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 15740006
157500     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               15750006
157600                                                                  15760006
157700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      15770006
157800                                                                  15780006
157910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             15791008
157920                         USING DP010I-NUMERIC-EDIT-AREA           15792008
158000                                                                  15800006
158100     IF  DP010I-ERROR-DETECTED                                    15810006
158200         MOVE DP015-RED     TO APARMC                             15820006
158300         MOVE DP015-REVERSE TO APARMH                             15830006
158400         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 15840006
158500         MOVE -1 TO APARML                                        15850006
158600                                                                  15860006
158700         SET DP020-MSG-FATAL TO TRUE                              15870006
158800         SET PS-ERROR        TO TRUE                              15880006
158900                                                                  15890006
159000     ELSE                                                         15900006
159100         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                15910006
159200                                                                  15920006
159300         IF (ASC-PARM-AMT >= PC-MIN-DOC-PROC-TFRAME               15930006
159400         AND ASC-PARM-AMT <= PC-MAX-DOC-PROC-TFRAME)              15940006
159500                                                                  15950006
159600             PERFORM I170-XVAL-CENT-DOC-PROC-TFRAME               15960006
159700                                                                  15970006
159800         ELSE                                                     15980006
159900             MOVE DP015-RED     TO APARMC                         15990006
160000             MOVE DP015-REVERSE TO APARMH                         16000006
160100             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             16010006
160200             MOVE -1 TO APARML                                    16020006
160300                                                                  16030006
160400             SET DP020-MSG-FATAL TO TRUE                          16040006
160500             SET PS-ERROR        TO TRUE                          16050006
160600     END-IF.                                                      16060006
160700******************************************************************16070006
160800*    VALIDATE THE  PERMANENT PRICE CHANGE DOCUMENT                16080006
160900*    PROCESSING TIME FRAME.                                       16090006
161000*                                                                 16100006
161100*    PERFORMED                                                    16110006
161200*               H170-VAL-CENT-DOC-PROC-TFRAME.                    16120006
161300******************************************************************16130006
161400 I170-XVAL-CENT-DOC-PROC-TFRAME.                                  16140006
161500     MOVE PE048-PHY-INV-LEAD-TIME-NBR                             16150006
161600                             TO PV-CROSS-VALIDATE-PARM-NBR.       16160006
161700     SET PS-DB2-RETRY TO TRUE.                                    16170006
161800                                                                  16180006
161900     PERFORM Z500-READ-DB-CROSS-VALIDATE                          16190006
162000             UNTIL PS-DB2-OK.                                     16200006
162100                                                                  16210006
162200     IF  (ASC-PARM-AMT <=                                         16220006
162300                PV-CROSS-VALIDATE-PARM-AMT)                       16230006
162400         CONTINUE                                                 16240006
162500                                                                  16250006
162600     ELSE                                                         16260006
162700         MOVE DP015-RED     TO APARMC                             16270006
162800         MOVE DP015-REVERSE TO APARMH                             16280006
162900         MOVE PC-TSYMSG-00139 TO DP020-MSG-NUMBER                 16290006
163000         MOVE -1 TO APARML                                        16300006
163100                                                                  16310006
163200         SET DP020-MSG-FATAL TO TRUE                              16320006
163300         SET PS-ERROR        TO TRUE                              16330006
163400     END-IF.                                                      16340006
163500******************************************************************16350006
163600*    VALIDATE THE  PERMANENT PRICE ZERO OUT                       16360006
163700*    PROCESSING TIME FRAME.                                       16370006
163800*                                                                 16380006
163900*    PERFORMED  E350-SELECT-VALIDATION.                           16390006
164000******************************************************************16400006
164100 H180-VAL-ZERO-OUT-PROC-TFRAME.                                   16410006
164200     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 16420006
164300     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 16430006
164400     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               16440006
164500                                                                  16450006
164600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      16460006
164700                                                                  16470006
164810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             16481008
164820                         USING DP010I-NUMERIC-EDIT-AREA           16482008
164900                                                                  16490006
165000     IF  DP010I-ERROR-DETECTED                                    16500006
165100         MOVE DP015-RED     TO APARMC                             16510006
165200         MOVE DP015-REVERSE TO APARMH                             16520006
165300         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 16530006
165400         MOVE -1 TO APARML                                        16540006
165500                                                                  16550006
165600         SET DP020-MSG-FATAL TO TRUE                              16560006
165700         SET PS-ERROR        TO TRUE                              16570006
165800                                                                  16580006
165900     ELSE                                                         16590006
166000         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                16600006
166100                                                                  16610006
166200         IF (ASC-PARM-AMT >=    PC-MIN-ZERO-OUT-PROC-TFRAME       16620006
166300         AND ASC-PARM-AMT <=    PC-MAX-ZERO-OUT-PROC-TFRAME)      16630006
166400             PERFORM I180-XVAL-ZERO-OUT-PROC-TFRAME               16640006
166500         ELSE                                                     16650006
166600             MOVE DP015-RED     TO APARMC                         16660006
166700             MOVE DP015-REVERSE TO APARMH                         16670006
166800             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             16680006
166900             MOVE -1 TO APARML                                    16690006
167000                                                                  16700006
167100             SET DP020-MSG-FATAL TO TRUE                          16710006
167200             SET PS-ERROR        TO TRUE                          16720006
167300     END-IF.                                                      16730006
167400******************************************************************16740006
167500*    CROSS VALIDATE THE  PERMANENT PRICE ZERO OUT                 16750006
167600*    PROCESSING TIME FRAME.                                       16760006
167700*                                                                 16770006
167800*    PERFORMED BY                                                 16780006
167900*                 H180-VAL-ZERO-OUT-PROC-TFRAME.                  16790006
168000******************************************************************16800006
168100 I180-XVAL-ZERO-OUT-PROC-TFRAME.                                  16810006
168200     MOVE PE048-ZOUT-CHG-LEAD-TIME-NBR                            16820006
168300                             TO PV-CROSS-VALIDATE-PARM-NBR.       16830006
168400     SET PS-DB2-RETRY TO TRUE.                                    16840006
168500                                                                  16850006
168600     PERFORM Z500-READ-DB-CROSS-VALIDATE                          16860006
168700             UNTIL PS-DB2-OK.                                     16870006
168800                                                                  16880006
168900     IF  ((ASC-PARM-AMT +                                         16890006
169000                PV-CROSS-VALIDATE-PARM-AMT) <= 12)                16900006
169100         CONTINUE                                                 16910006
169200                                                                  16920006
169300     ELSE                                                         16930006
169400         MOVE DP015-RED     TO APARMC                             16940006
169500         MOVE DP015-REVERSE TO APARMH                             16950006
169600         MOVE PC-TSYMSG-00179 TO DP020-MSG-NUMBER                 16960006
169700         MOVE -1 TO APARML                                        16970006
169800                                                                  16980006
169900         SET DP020-MSG-FATAL TO TRUE                              16990006
170000         SET PS-ERROR        TO TRUE                              17000006
170100     END-IF.                                                      17010006
170200******************************************************************17020006
170300*    VALIDATE THE MAXIMUM PERMANENT PRICE CHANGE                  17030006
170400*    PERCENTAGE FOR HARD LINES                                    17040006
170500*                                                                 17050006
170600*    PERFORMED  E350-SELECT-VALIDATION.                           17060006
170700******************************************************************17070006
170800 H190-VAL-MAX-HARD-LINES-P-C.                                     17080006
170900     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 17090006
171000     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 17100006
171100     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               17110006
171200                                                                  17120006
171300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      17130006
171400                                                                  17140006
171510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             17151008
171520                         USING DP010I-NUMERIC-EDIT-AREA           17152008
171600                                                                  17160006
171700     IF  DP010I-ERROR-DETECTED                                    17170006
171800         MOVE DP015-RED     TO APARMC                             17180006
171900         MOVE DP015-REVERSE TO APARMH                             17190006
172000         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 17200006
172100         MOVE -1 TO APARML                                        17210006
172200                                                                  17220006
172300         SET DP020-MSG-FATAL TO TRUE                              17230006
172400         SET PS-ERROR        TO TRUE                              17240006
172500                                                                  17250006
172600     ELSE                                                         17260006
172700         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                17270006
172800                                                                  17280006
172900         IF  ASC-PARM-AMT >=                                      17290006
173000                         PC-MINIMUM-PERCENTAGE                    17300006
173100         AND ASC-PARM-AMT <=                                      17310006
173200                         PC-MAXIMUM-PERCENTAGE                    17320006
173300                                                                  17330006
173400             PERFORM I190-XVAL-MAX-HARD-LINES-P-C                 17340006
173500         ELSE                                                     17350006
173600             MOVE DP015-RED     TO APARMC                         17360006
173700             MOVE DP015-REVERSE TO APARMH                         17370006
173800             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             17380006
173900             MOVE -1 TO APARML                                    17390006
174000                                                                  17400006
174100             SET DP020-MSG-FATAL TO TRUE                          17410006
174200             SET PS-ERROR        TO TRUE                          17420006
174300     END-IF.                                                      17430006
174400******************************************************************17440006
174500*    CROSS VALIDATE THE MAXIMUM HARD LINES PERCENTAGE.            17450006
174600*                                                                 17460006
174700*    PERFORMED BY:-                                               17470006
174800*                 I190-XVAL-MAX-HARD-LINES-P-C.                   17480006
174900******************************************************************17490006
175000 I190-XVAL-MAX-HARD-LINES-P-C.                                    17500006
175100     MOVE PE048-RECOM-HL-CLEAR-PCT-NBR                            17510006
175200                             TO PV-CROSS-VALIDATE-PARM-NBR.       17520006
175300     SET PS-DB2-RETRY TO TRUE.                                    17530006
175400                                                                  17540006
175500     PERFORM Z500-READ-DB-CROSS-VALIDATE                          17550006
175600             UNTIL PS-DB2-OK.                                     17560006
175700                                                                  17570006
175800     IF  (ASC-PARM-AMT >=                                         17580006
175900                PV-CROSS-VALIDATE-PARM-AMT)                       17590006
176000         CONTINUE                                                 17600006
176100                                                                  17610006
176200     ELSE                                                         17620006
176300         MOVE DP015-RED     TO APARMC                             17630006
176400         MOVE DP015-REVERSE TO APARMH                             17640006
176500         MOVE PC-TSYMSG-00135 TO DP020-MSG-NUMBER                 17650006
176600         MOVE -1 TO APARML                                        17660006
176700                                                                  17670006
176800         SET DP020-MSG-FATAL TO TRUE                              17680006
176900         SET PS-ERROR        TO TRUE                              17690006
177000     END-IF.                                                      17700006
177100******************************************************************17710006
177200*    VALIDATE THE RECOMMENDED PERMANENT PRICE CHANGE              17720006
177300*    PERCENTAGE FOR HARD LINES                                    17730006
177400*                                                                 17740006
177500*    PERFORMED  E350-SELECT-VALIDATION.                           17750006
177600******************************************************************17760006
177700 H200-VAL-REC-HARD-LINES-P-C.                                     17770006
177800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 17780006
177900     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 17790006
178000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               17800006
178100                                                                  17810006
178200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      17820006
178300                                                                  17830006
178410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             17841008
178420                         USING DP010I-NUMERIC-EDIT-AREA           17842008
178500                                                                  17850006
178600     IF  DP010I-ERROR-DETECTED                                    17860006
178700         MOVE DP015-RED     TO APARMC                             17870006
178800         MOVE DP015-REVERSE TO APARMH                             17880006
178900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 17890006
179000         MOVE -1 TO APARML                                        17900006
179100                                                                  17910006
179200         SET DP020-MSG-FATAL TO TRUE                              17920006
179300         SET PS-ERROR        TO TRUE                              17930006
179400                                                                  17940006
179500     ELSE                                                         17950006
179600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                17960006
179700                                                                  17970006
179800         IF  ASC-PARM-AMT >=                                      17980006
179900                         PC-MINIMUM-PERCENTAGE                    17990006
180000         AND ASC-PARM-AMT <=                                      18000006
180100                         PC-MAXIMUM-PERCENTAGE                    18010006
180200                                                                  18020006
180300             PERFORM I200-XVAL-REC-HARD-LINES-P-C                 18030006
180400         ELSE                                                     18040006
180500             MOVE DP015-RED     TO APARMC                         18050006
180600             MOVE DP015-REVERSE TO APARMH                         18060006
180700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             18070006
180800             MOVE -1 TO APARML                                    18080006
180900                                                                  18090006
181000             SET DP020-MSG-FATAL TO TRUE                          18100006
181100             SET PS-ERROR        TO TRUE                          18110006
181200     END-IF.                                                      18120006
181300******************************************************************18130006
181400*    MOVE THE FIELDS FROM THE COMMAREA TO THE SCREEN.             18140006
181500*                                                                 18150006
181600*    PERFORMED BY:-                                               18160006
181700*                 H200-VAL-REC-HARD-LINES-P-C.                    18170006
181800******************************************************************18180006
181900 I200-XVAL-REC-HARD-LINES-P-C.                                    18190006
182000     MOVE PE048-MAX-HARDLN-PPC-PCT-NBR                            18200006
182100                             TO PV-CROSS-VALIDATE-PARM-NBR.       18210006
182200     SET PS-DB2-RETRY TO TRUE.                                    18220006
182300                                                                  18230006
182400     PERFORM Z500-READ-DB-CROSS-VALIDATE                          18240006
182500             UNTIL PS-DB2-OK.                                     18250006
182600                                                                  18260006
182700     IF  (ASC-PARM-AMT <=                                         18270006
182800                PV-CROSS-VALIDATE-PARM-AMT)                       18280006
182900         CONTINUE                                                 18290006
183000                                                                  18300006
183100     ELSE                                                         18310006
183200         MOVE DP015-RED     TO APARMC                             18320006
183300         MOVE DP015-REVERSE TO APARMH                             18330006
183400         MOVE PC-TSYMSG-00128 TO DP020-MSG-NUMBER                 18340006
183500         MOVE -1 TO APARML                                        18350006
183600                                                                  18360006
183700         SET DP020-MSG-FATAL TO TRUE                              18370006
183800         SET PS-ERROR        TO TRUE                              18380006
183900     END-IF.                                                      18390006
184000                                                                  18400006
184100     MOVE PE048-MIN-PPC-PCT-NBR                                   18410006
184200                             TO PV-CROSS-VALIDATE-PARM-NBR.       18420006
184300     SET PS-DB2-RETRY TO TRUE.                                    18430006
184400                                                                  18440006
184500     PERFORM Z500-READ-DB-CROSS-VALIDATE                          18450006
184600             UNTIL PS-DB2-OK.                                     18460006
184700                                                                  18470006
184800     IF  (ASC-PARM-AMT >=                                         18480006
184900                PV-CROSS-VALIDATE-PARM-AMT)                       18490006
185000         CONTINUE                                                 18500006
185100                                                                  18510006
185200     ELSE                                                         18520006
185300         MOVE DP015-RED     TO APARMC                             18530006
185400         MOVE DP015-REVERSE TO APARMH                             18540006
185500         MOVE PC-TSYMSG-00140 TO DP020-MSG-NUMBER                 18550006
185600         MOVE -1 TO APARML                                        18560006
185700                                                                  18570006
185800         SET DP020-MSG-FATAL TO TRUE                              18580006
185900         SET PS-ERROR        TO TRUE                              18590006
186000     END-IF.                                                      18600006
186100******************************************************************18610006
186200*    VALIDATE THE MAXIMUM PERMANENT PRICE CHANGE                  18620006
186300*    PERCENTAGE FOR SOFT LINES                                    18630006
186400*                                                                 18640006
186500*    PERFORMED  E350-SELECT-VALIDATION.                           18650006
186600******************************************************************18660006
186700 H210-VAL-MAX-SOFT-LINES-P-C.                                     18670006
186800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 18680006
186900     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 18690006
187000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               18700006
187100                                                                  18710006
187200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      18720006
187300                                                                  18730006
187410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             18741008
187420                         USING DP010I-NUMERIC-EDIT-AREA           18742008
187500                                                                  18750006
187600     IF  DP010I-ERROR-DETECTED                                    18760006
187700         MOVE DP015-RED     TO APARMC                             18770006
187800         MOVE DP015-REVERSE TO APARMH                             18780006
187900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 18790006
188000         MOVE -1 TO APARML                                        18800006
188100                                                                  18810006
188200         SET DP020-MSG-FATAL TO TRUE                              18820006
188300         SET PS-ERROR        TO TRUE                              18830006
188400                                                                  18840006
188500     ELSE                                                         18850006
188600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                18860006
188700                                                                  18870006
188800         IF  ASC-PARM-AMT >=                                      18880006
188900                         PC-MINIMUM-PERCENTAGE                    18890006
189000         AND ASC-PARM-AMT <=                                      18900006
189100                         PC-MAXIMUM-PERCENTAGE                    18910006
189200             PERFORM I210-XVAL-MAX-SOFT-LINES-P-C                 18920006
189300                                                                  18930006
189400         ELSE                                                     18940006
189500             MOVE DP015-RED     TO APARMC                         18950006
189600             MOVE DP015-REVERSE TO APARMH                         18960006
189700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             18970006
189800             MOVE -1 TO APARML                                    18980006
189900                                                                  18990006
190000             SET DP020-MSG-FATAL TO TRUE                          19000006
190100             SET PS-ERROR        TO TRUE                          19010006
190200     END-IF.                                                      19020006
190300******************************************************************19030006
190400*    CROSS VALIDATE THE MAX SOFT LINES PERCENTAGE.                19040006
190500*                                                                 19050006
190600*    PERFORMED BY:-                                               19060006
190700*                 H210-VAL-MAX-SOFT-LINES-P-C.                    19070006
190800******************************************************************19080006
190900 I210-XVAL-MAX-SOFT-LINES-P-C.                                    19090006
191000     MOVE PE048-RECOM-SL-CLEAR-PCT-NBR                            19100006
191100                             TO PV-CROSS-VALIDATE-PARM-NBR.       19110006
191200     SET PS-DB2-RETRY TO TRUE.                                    19120006
191300                                                                  19130006
191400     PERFORM Z500-READ-DB-CROSS-VALIDATE                          19140006
191500             UNTIL PS-DB2-OK.                                     19150006
191600                                                                  19160006
191700     IF  (ASC-PARM-AMT >=                                         19170006
191800                PV-CROSS-VALIDATE-PARM-AMT)                       19180006
191900         CONTINUE                                                 19190006
192000                                                                  19200006
192100     ELSE                                                         19210006
192200         MOVE DP015-RED     TO APARMC                             19220006
192300         MOVE DP015-REVERSE TO APARMH                             19230006
192400         MOVE PC-TSYMSG-00136 TO DP020-MSG-NUMBER                 19240006
192500         MOVE -1 TO APARML                                        19250006
192600                                                                  19260006
192700         SET DP020-MSG-FATAL TO TRUE                              19270006
192800         SET PS-ERROR        TO TRUE                              19280006
192900     END-IF.                                                      19290006
193000******************************************************************19300006
193100*    VALIDATE THE RECOMENDED PERMANENT PRICE CHANGE               19310006
193200*    PERCENTAGE FOR SOFT LINES                                    19320006
193300*                                                                 19330006
193400*    PERFORMED  E350-SELECT-VALIDATION.                           19340006
193500******************************************************************19350006
193600 H220-VAL-REC-SOFT-LINES-P-C.                                     19360006
193700     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 19370006
193800     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 19380006
193900     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               19390006
194000                                                                  19400006
194100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      19410006
194200                                                                  19420006
194310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19431008
194320                         USING DP010I-NUMERIC-EDIT-AREA           19432008
194400                                                                  19440006
194500     IF  DP010I-ERROR-DETECTED                                    19450006
194600         MOVE DP015-RED     TO APARMC                             19460006
194700         MOVE DP015-REVERSE TO APARMH                             19470006
194800         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 19480006
194900         MOVE -1 TO APARML                                        19490006
195000                                                                  19500006
195100         SET DP020-MSG-FATAL TO TRUE                              19510006
195200         SET PS-ERROR        TO TRUE                              19520006
195300                                                                  19530006
195400     ELSE                                                         19540006
195500         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                19550006
195600                                                                  19560006
195700         IF  ASC-PARM-AMT >=                                      19570006
195800                         PC-MINIMUM-PERCENTAGE                    19580006
195900         AND ASC-PARM-AMT <=                                      19590006
196000                         PC-MAXIMUM-PERCENTAGE                    19600006
196100             PERFORM I220-XVAL-REC-SOFT-LINES-P-C                 19610006
196200                                                                  19620006
196300         ELSE                                                     19630006
196400             MOVE DP015-RED     TO APARMC                         19640006
196500             MOVE DP015-REVERSE TO APARMH                         19650006
196600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             19660006
196700             MOVE -1 TO APARML                                    19670006
196800                                                                  19680006
196900             SET DP020-MSG-FATAL TO TRUE                          19690006
197000             SET PS-ERROR        TO TRUE                          19700006
197100     END-IF.                                                      19710006
197200******************************************************************19720006
197300*    CROSS VALIDATE THE RECOMMEND SOFT LINE PERMANMENT            19730006
197400*    PRICE CHANGED PERCENTAGE                                     19740006
197500*                                                                 19750006
197600*    PERFORMED BY:-                                               19760006
197700*                 I220-XVAL-REC-SOFT-LINES-P-C.                   19770006
197800******************************************************************19780006
197900 I220-XVAL-REC-SOFT-LINES-P-C.                                    19790006
198000     MOVE PE048-MAX-SOFTLN-PPC-PCT-NBR                            19800006
198100                             TO PV-CROSS-VALIDATE-PARM-NBR.       19810006
198200     SET PS-DB2-RETRY TO TRUE.                                    19820006
198300                                                                  19830006
198400     PERFORM Z500-READ-DB-CROSS-VALIDATE                          19840006
198500             UNTIL PS-DB2-OK.                                     19850006
198600                                                                  19860006
198700     IF  (ASC-PARM-AMT <=                                         19870006
198800                PV-CROSS-VALIDATE-PARM-AMT)                       19880006
198900         CONTINUE                                                 19890006
199000                                                                  19900006
199100     ELSE                                                         19910006
199200         MOVE DP015-RED     TO APARMC                             19920006
199300         MOVE DP015-REVERSE TO APARMH                             19930006
199400         MOVE PC-TSYMSG-00129 TO DP020-MSG-NUMBER                 19940006
199500         MOVE -1 TO APARML                                        19950006
199600                                                                  19960006
199700         SET DP020-MSG-FATAL TO TRUE                              19970006
199800         SET PS-ERROR        TO TRUE                              19980006
199900     END-IF.                                                      19990006
200000                                                                  20000006
200100     MOVE PE048-MIN-PPC-PCT-NBR                                   20010006
200200                             TO PV-CROSS-VALIDATE-PARM-NBR.       20020006
200300     SET PS-DB2-RETRY TO TRUE.                                    20030006
200400                                                                  20040006
200500     PERFORM Z500-READ-DB-CROSS-VALIDATE                          20050006
200600             UNTIL PS-DB2-OK.                                     20060006
200700                                                                  20070006
200800     IF  (ASC-PARM-AMT >=                                         20080006
200900                PV-CROSS-VALIDATE-PARM-AMT)                       20090006
201000         CONTINUE                                                 20100006
201100                                                                  20110006
201200     ELSE                                                         20120006
201300         MOVE DP015-RED     TO APARMC                             20130006
201400         MOVE DP015-REVERSE TO APARMH                             20140006
201500         MOVE PC-TSYMSG-00140 TO DP020-MSG-NUMBER                 20150006
201600         MOVE -1 TO APARML                                        20160006
201700                                                                  20170006
201800         SET DP020-MSG-FATAL TO TRUE                              20180006
201900         SET PS-ERROR        TO TRUE                              20190006
202000     END-IF.                                                      20200006
202100******************************************************************20210006
202200*    VALIDATE THE MINIMUM PERMANENT PRICE CHANGE                  20220006
202300*    PERCENTAGE FOR ALL LINES                                     20230006
202400*                                                                 20240006
202500*    PERFORMED  E350-SELECT-VALIDATION.                           20250006
202600******************************************************************20260006
202700 H230-VAL-MIN-ALL-LINES-P-C.                                      20270006
202800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 20280006
202900     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 20290006
203000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               20300006
203100                                                                  20310006
203200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      20320006
203300                                                                  20330006
203410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             20341008
203420                         USING DP010I-NUMERIC-EDIT-AREA           20342008
203500                                                                  20350006
203600     IF  DP010I-ERROR-DETECTED                                    20360006
203700         MOVE DP015-RED     TO APARMC                             20370006
203800         MOVE DP015-REVERSE TO APARMH                             20380006
203900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 20390006
204000         MOVE -1 TO APARML                                        20400006
204100                                                                  20410006
204200         SET DP020-MSG-FATAL TO TRUE                              20420006
204300         SET PS-ERROR        TO TRUE                              20430006
204400                                                                  20440006
204500     ELSE                                                         20450006
204600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                20460006
204700                                                                  20470006
204800         IF  ASC-PARM-AMT >=                                      20480006
204900                         PC-MINIMUM-PERCENTAGE                    20490006
205000         AND ASC-PARM-AMT <=                                      20500006
205100                         PC-MAXIMUM-PERCENTAGE                    20510006
205200             PERFORM I230-XVAL-MIN-ALL-LINES-P-C                  20520006
205300                                                                  20530006
205400         ELSE                                                     20540006
205500             MOVE DP015-RED     TO APARMC                         20550006
205600             MOVE DP015-REVERSE TO APARMH                         20560006
205700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             20570006
205800             MOVE -1 TO APARML                                    20580006
205900                                                                  20590006
206000             SET DP020-MSG-FATAL TO TRUE                          20600006
206100             SET PS-ERROR        TO TRUE                          20610006
206200     END-IF.                                                      20620006
206300******************************************************************20630006
206400*    MOVE THE FIELDS FROM THE COMMAREA TO THE SCREEN.             20640006
206500*                                                                 20650006
206600*    PERFORMED BY:-                                               20660006
206700*                 H230-VAL-MIN-ALL-LINES-P-C.                     20670006
206800******************************************************************20680006
206900 I230-XVAL-MIN-ALL-LINES-P-C.                                     20690006
207000     MOVE PE048-RECOM-HL-CLEAR-PCT-NBR                            20700006
207100                      TO PV-CROSS-VALIDATE-PARM-NBR.              20710006
207200     SET PS-DB2-RETRY TO TRUE.                                    20720006
207300                                                                  20730006
207400     PERFORM Z500-READ-DB-CROSS-VALIDATE                          20740006
207500             UNTIL PS-DB2-OK.                                     20750006
207600                                                                  20760006
207700     MOVE PV-CROSS-VALIDATE-PARM-AMT                              20770006
207800           TO PV-SMALLEST-XVAL-PARM-AMT.                          20780006
207900                                                                  20790006
208000     MOVE PE048-RECOM-SL-CLEAR-PCT-NBR                            20800006
208100                      TO PV-CROSS-VALIDATE-PARM-NBR.              20810006
208200     SET PS-DB2-RETRY TO TRUE.                                    20820006
208300                                                                  20830006
208400     PERFORM Z500-READ-DB-CROSS-VALIDATE                          20840006
208500             UNTIL PS-DB2-OK.                                     20850006
208600                                                                  20860006
208700     IF  PV-CROSS-VALIDATE-PARM-AMT                               20870006
208800           < PV-SMALLEST-XVAL-PARM-AMT                            20880006
208900             MOVE PV-CROSS-VALIDATE-PARM-AMT                      20890006
209000                  TO PV-SMALLEST-XVAL-PARM-AMT                    20900006
209100     END-IF.                                                      20910006
209200                                                                  20920006
209300     IF  (ASC-PARM-AMT <=                                         20930006
209400              PV-SMALLEST-XVAL-PARM-AMT)                          20940006
209500          CONTINUE                                                20950006
209600                                                                  20960006
209700     ELSE                                                         20970006
209800         MOVE DP015-RED     TO APARMC                             20980006
209900         MOVE DP015-REVERSE TO APARMH                             20990006
210000         MOVE PC-TSYMSG-00130 TO DP020-MSG-NUMBER                 21000006
210100         MOVE -1 TO APARML                                        21010006
210200                                                                  21020006
210300         SET DP020-MSG-FATAL TO TRUE                              21030006
210400         SET PS-ERROR        TO TRUE                              21040006
210500     END-IF.                                                      21050006
210600******************************************************************21060006
210700*    VALIDATE THE PERMANENT PRICE CHANGE VOLUME                   21070006
210800*    REPORTING LEAD TIME.                                         21080006
210900*                                                                 21090006
211000*    PERFORMED  E350-SELECT-VALIDATION.                           21100006
211100******************************************************************21110006
211200 H240-VAL-VOL-RPT-LTIME.                                          21120006
211300     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 21130006
211400     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 21140006
211500     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               21150006
211600                                                                  21160006
211700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      21170006
211800                                                                  21180006
211910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21191008
211920                         USING DP010I-NUMERIC-EDIT-AREA           21192008
212000                                                                  21200006
212100     IF  DP010I-ERROR-DETECTED                                    21210006
212200         MOVE DP015-RED     TO APARMC                             21220006
212300         MOVE DP015-REVERSE TO APARMH                             21230006
212400         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 21240006
212500         MOVE -1 TO APARML                                        21250006
212600                                                                  21260006
212700         SET DP020-MSG-FATAL TO TRUE                              21270006
212800         SET PS-ERROR        TO TRUE                              21280006
212900                                                                  21290006
213000     ELSE                                                         21300006
213100         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                21310006
213200                                                                  21320006
213300         IF  ASC-PARM-AMT > PC-MAX-VOL-RPT-LTIME                  21330006
213400             MOVE DP015-RED     TO APARMC                         21340006
213500             MOVE DP015-REVERSE TO APARMH                         21350006
213600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             21360006
213700             MOVE -1 TO APARML                                    21370006
213800                                                                  21380006
213900             SET DP020-MSG-FATAL TO TRUE                          21390006
214000             SET PS-ERROR        TO TRUE                          21400006
214100         END-IF                                                   21410006
214200     END-IF.                                                      21420006
214300******************************************************************21430006
214400*    VALIDATE THE PERMANENT PRICE CHANGE VOLUME                   21440006
214500*    ZERO OUT SCHEDULE LEAD TIME.                                 21450006
214600*                                                                 21460006
214700*    PERFORMED  E350-SELECT-VALIDATION.                           21470006
214800******************************************************************21480006
214900 H250-VAL-ZERO-OUT-SCHD-LTIME.                                    21490006
215000     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 21500006
215100     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 21510006
215200     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               21520006
215300                                                                  21530006
215400     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      21540006
215500                                                                  21550006
215610     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21561008
215620                         USING DP010I-NUMERIC-EDIT-AREA           21562008
215700                                                                  21570006
215800     IF  DP010I-ERROR-DETECTED                                    21580006
215900         MOVE DP015-RED     TO APARMC                             21590006
216000         MOVE DP015-REVERSE TO APARMH                             21600006
216100         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 21610006
216200         MOVE -1 TO APARML                                        21620006
216300                                                                  21630006
216400         SET DP020-MSG-FATAL TO TRUE                              21640006
216500         SET PS-ERROR        TO TRUE                              21650006
216600                                                                  21660006
216700     ELSE                                                         21670006
216800         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                21680006
216900                                                                  21690006
217000         IF (ASC-PARM-AMT >=    PC-MIN-ZERO-OUT-SCHD-LTIME        21700006
217100         AND ASC-PARM-AMT <=    PC-MAX-ZERO-OUT-SCHD-LTIME)       21710006
217200             PERFORM I250-XVAL-ZERO-OUT-SCHD-LTIME                21720006
217300         ELSE                                                     21730006
217400             MOVE DP015-RED     TO APARMC                         21740006
217500             MOVE DP015-REVERSE TO APARMH                         21750006
217600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             21760006
217700             MOVE -1 TO APARML                                    21770006
217800                                                                  21780006
217900             SET DP020-MSG-FATAL TO TRUE                          21790006
218000             SET PS-ERROR        TO TRUE                          21800006
218100     END-IF.                                                      21810006
218200******************************************************************21820006
218300*    CROSS VALIDATE THE PERMANENT PRICE CHANGE VOLUME             21830006
218400*    ZERO OUT SCHEDULE LEAD TIME.                                 21840006
218500*                                                                 21850006
218600*    PERFORMED BY:-                                               21860006
218700*                  H250-VAL-ZERO-OUT-SCHD-LTIME.                  21870006
218800******************************************************************21880006
218900 I250-XVAL-ZERO-OUT-SCHD-LTIME.                                   21890006
219000     MOVE PE048-ZOUT-PROC-TIMEFR-NBR                              21900006
219100                             TO PV-CROSS-VALIDATE-PARM-NBR.       21910006
219200     SET PS-DB2-RETRY TO TRUE.                                    21920006
219300                                                                  21930006
219400     PERFORM Z500-READ-DB-CROSS-VALIDATE                          21940006
219500             UNTIL PS-DB2-OK.                                     21950006
219600                                                                  21960006
219700     IF  ((ASC-PARM-AMT +                                         21970006
219800                PV-CROSS-VALIDATE-PARM-AMT) <= 12)                21980006
219900         CONTINUE                                                 21990006
220000                                                                  22000006
220100     ELSE                                                         22010006
220200         MOVE DP015-RED     TO APARMC                             22020006
220300         MOVE DP015-REVERSE TO APARMH                             22030006
220400         MOVE PC-TSYMSG-00179 TO DP020-MSG-NUMBER                 22040006
220500         MOVE -1 TO APARML                                        22050006
220600                                                                  22060006
220700         SET DP020-MSG-FATAL TO TRUE                              22070006
220800         SET PS-ERROR        TO TRUE                              22080006
220900     END-IF.                                                      22090006
221000******************************************************************22100006
221100*    VALIDATE THE PERMANENT PRICE CHANGE INACTIVITY DOCUMENT      22110006
221200*    DELETE TIMEFRAME.                                            22120006
221300*                                                                 22130006
221400*    PERFORMED  E350-SELECT-VALIDATION.                           22140006
221500******************************************************************22150006
221600 H260-VAL-INACT-DOC-DEL-TFRAME.                                   22160006
221700     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 22170006
221800     MOVE +2             TO DP010I-MAXIMUM-DIGITS                 22180006
221900     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               22190006
222000                                                                  22200006
222100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      22210006
222200                                                                  22220006
222310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             22231008
222320                         USING DP010I-NUMERIC-EDIT-AREA           22232008
222400                                                                  22240006
222500     IF  DP010I-ERROR-DETECTED                                    22250006
222600         MOVE DP015-RED     TO APARMC                             22260006
222700         MOVE DP015-REVERSE TO APARMH                             22270006
222800         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 22280006
222900         MOVE -1 TO APARML                                        22290006
223000                                                                  22300006
223100         SET DP020-MSG-FATAL TO TRUE                              22310006
223200         SET PS-ERROR        TO TRUE                              22320006
223300                                                                  22330006
223400     ELSE                                                         22340006
223500         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                22350006
223600                                                                  22360006
223700         IF  ASC-PARM-AMT >=                                      22370006
223800                    PC-MIN-INACT-DEL-DAYS                         22380006
223900         AND ASC-PARM-AMT <=                                      22390006
224000                    PC-MAX-INACT-DEL-DAYS                         22400006
224100             CONTINUE                                             22410006
224200         ELSE                                                     22420006
224300             MOVE DP015-RED     TO APARMC                         22430006
224400             MOVE DP015-REVERSE TO APARMH                         22440006
224500             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             22450006
224600             MOVE -1 TO APARML                                    22460006
224700                                                                  22470006
224800             SET DP020-MSG-FATAL TO TRUE                          22480006
224900             SET PS-ERROR        TO TRUE                          22490006
225000     END-IF.                                                      22500006
225100******************************************************************22510006
225200*    VALIDATE THE PERMANENT PRICE CHANGE DOCUMENT INACTIVITY      22520006
225300*    DELETE DAYS.                                                 22530006
225400*                                                                 22540006
225500*    PERFORMED  E350-SELECT-VALIDATION.                           22550006
225600******************************************************************22560006
225700 H270-VAL-PE-DOC-INACT-DEL-DAYS.                                  22570006
225800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 22580006
225900     MOVE +3             TO DP010I-MAXIMUM-DIGITS                 22590006
226000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               22600006
226100                                                                  22610006
226200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      22620006
226300                                                                  22630006
226410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             22641008
226420                         USING DP010I-NUMERIC-EDIT-AREA           22642008
226500                                                                  22650006
226600     IF  DP010I-ERROR-DETECTED                                    22660006
226700         MOVE DP015-RED     TO APARMC                             22670006
226800         MOVE DP015-REVERSE TO APARMH                             22680006
226900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 22690006
227000         MOVE -1 TO APARML                                        22700006
227100                                                                  22710006
227200         SET DP020-MSG-FATAL TO TRUE                              22720006
227300         SET PS-ERROR        TO TRUE                              22730006
227400                                                                  22740006
227500     ELSE                                                         22750006
227600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                22760006
227700                                                                  22770006
227800         IF  ASC-PARM-AMT >=                                      22780006
227900                    PC-MIN-PEND-INACT-DEL-DAYS                    22790006
228000         AND ASC-PARM-AMT <=                                      22800006
228100                    PC-MAX-PEND-INACT-DEL-DAYS                    22810006
228200             CONTINUE                                             22820006
228300         ELSE                                                     22830006
228400             MOVE DP015-RED     TO APARMC                         22840006
228500             MOVE DP015-REVERSE TO APARMH                         22850006
228600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             22860006
228700             MOVE -1 TO APARML                                    22870006
228800                                                                  22880006
228900             SET DP020-MSG-FATAL TO TRUE                          22890006
229000             SET PS-ERROR        TO TRUE                          22900006
229100     END-IF.                                                      22910006
229200******************************************************************22920006
229300*    VALIDATE THE NON CLEARANCE DOCUMENT PRINT TIMEFRAME.         22930006
229400*                                                                 22940006
229500*    PERFORMED  E350-SELECT-VALIDATION.                           22950006
229600******************************************************************22960006
229700 H280-VAL-NONCLEAR-DOC-PRT-DAYS.                                  22970006
229800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 22980006
229900     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 22990006
230000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               23000006
230100                                                                  23010006
230200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      23020006
230300                                                                  23030006
230410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             23041008
230420                         USING DP010I-NUMERIC-EDIT-AREA           23042008
230500                                                                  23050006
230600     IF  DP010I-ERROR-DETECTED                                    23060006
230700         MOVE DP015-RED     TO APARMC                             23070006
230800         MOVE DP015-REVERSE TO APARMH                             23080006
230900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 23090006
231000         MOVE -1 TO APARML                                        23100006
231100                                                                  23110006
231200         SET DP020-MSG-FATAL TO TRUE                              23120006
231300         SET PS-ERROR        TO TRUE                              23130006
231400                                                                  23140006
231500     ELSE                                                         23150006
231600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                23160006
231700                                                                  23170006
231800         IF (ASC-PARM-AMT >=                                      23180006
231900                    PC-MIN-NONCLEAR-DOC-PRT-TFRAME                23190006
232000         AND ASC-PARM-AMT <=                                      23200006
232100                    PC-MAX-NONCLEAR-DOC-PRT-TFRAME)               23210006
232200             CONTINUE                                             23220006
232300         ELSE                                                     23230006
232400             MOVE DP015-RED     TO APARMC                         23240006
232500             MOVE DP015-REVERSE TO APARMH                         23250006
232600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             23260006
232700             MOVE -1 TO APARML                                    23270006
232800                                                                  23280006
232900             SET DP020-MSG-FATAL TO TRUE                          23290006
233000             SET PS-ERROR        TO TRUE                          23300006
233100         END-IF                                                   23310006
233200     END-IF.                                                      23320006
233300******************************************************************23330006
233400*    VALIDATE THE VALUE OF THE NUMBER OF LINES PER DOCUMENT.      23340006
233500*                                                                 23350006
233600*    PERFORMED  E350-SELECT-VALIDATION.                           23360006
233700******************************************************************23370006
233800 H290-VAL-NBR-OF-LINES-PER-DOC.                                   23380006
233900     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 23390006
234000     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 23400006
234100     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               23410006
234200                                                                  23420006
234300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      23430006
234400                                                                  23440006
234510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             23451008
234520                         USING DP010I-NUMERIC-EDIT-AREA           23452008
234600                                                                  23460006
234700     IF  DP010I-ERROR-DETECTED                                    23470006
234800         MOVE DP015-RED     TO APARMC                             23480006
234900         MOVE DP015-REVERSE TO APARMH                             23490006
235000         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 23500006
235100         MOVE -1 TO APARML                                        23510006
235200                                                                  23520006
235300         SET DP020-MSG-FATAL TO TRUE                              23530006
235400         SET PS-ERROR        TO TRUE                              23540006
235500                                                                  23550006
235600     ELSE                                                         23560006
235700         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                23570006
235800                                                                  23580006
235900         IF (ASC-PARM-AMT <=                                      23590006
236000                    PE049-MAX-LINES-PER-DOCUMENT)                 23600006
236100             CONTINUE                                             23610006
236200         ELSE                                                     23620006
236300             MOVE DP015-RED     TO APARMC                         23630006
236400             MOVE DP015-REVERSE TO APARMH                         23640006
236500             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             23650006
236600             MOVE -1 TO APARML                                    23660006
236700                                                                  23670006
236800             SET DP020-MSG-FATAL TO TRUE                          23680006
236900             SET PS-ERROR        TO TRUE                          23690006
237000         END-IF                                                   23700006
237100     END-IF.                                                      23710006
237200******************************************************************23720006
237300*    VALIDATE THE VALUE OF THE CORPORATE DOCUMENT PRINT TIMEFRAME.23730006
237400*                                                                 23740006
237500*    PERFORMED  E350-SELECT-VALIDATION.                           23750006
237600******************************************************************23760006
237700 H300-VAL-CORP-DOC-PRT-TFRAME.                                    23770006
237800     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 23780006
237900     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 23790006
238000     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               23800006
238100                                                                  23810006
238200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      23820006
238300                                                                  23830006
238410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             23841008
238420                         USING DP010I-NUMERIC-EDIT-AREA           23842008
238500                                                                  23850006
238600     IF  DP010I-ERROR-DETECTED                                    23860006
238700         MOVE DP015-RED     TO APARMC                             23870006
238800         MOVE DP015-REVERSE TO APARMH                             23880006
238900         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 23890006
239000         MOVE -1 TO APARML                                        23900006
239100                                                                  23910006
239200         SET DP020-MSG-FATAL TO TRUE                              23920006
239300         SET PS-ERROR        TO TRUE                              23930006
239400                                                                  23940006
239500     ELSE                                                         23950006
239600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                23960006
239700                                                                  23970006
239800         IF (ASC-PARM-AMT >= PC-MIN-DOC-PRT-TFRAME                23980006
239900         AND ASC-PARM-AMT <= PC-MAX-DOC-PRT-TFRAME)               23990006
240000             CONTINUE                                             24000006
240100         ELSE                                                     24010006
240200             MOVE DP015-RED     TO APARMC                         24020006
240300             MOVE DP015-REVERSE TO APARMH                         24030006
240400             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             24040006
240500             MOVE -1 TO APARML                                    24050006
240600                                                                  24060006
240700             SET DP020-MSG-FATAL TO TRUE                          24070006
240800             SET PS-ERROR        TO TRUE                          24080006
240900         END-IF                                                   24090006
241000     END-IF.                                                      24100006
241100******************************************************************24110006
241200*    VALIDATE THE VALUE OF THE COUNT ENTRY TIMEFRAME.             24120006
241300*                                                                 24130006
241400*    PERFORMED  E350-SELECT-VALIDATION.                           24140006
241500******************************************************************24150006
241600 H310-VAL-COUNT-ENTRY-TFRAME.                                     24160006
241700     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 24170006
241800     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 24180006
241900     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               24190006
242000                                                                  24200006
242100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      24210006
242200                                                                  24220006
242310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             24231008
242320                         USING DP010I-NUMERIC-EDIT-AREA           24232008
242400                                                                  24240006
242500     IF  DP010I-ERROR-DETECTED                                    24250006
242600         MOVE DP015-RED     TO APARMC                             24260006
242700         MOVE DP015-REVERSE TO APARMH                             24270006
242800         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 24280006
242900         MOVE -1 TO APARML                                        24290006
243000                                                                  24300006
243100         SET DP020-MSG-FATAL TO TRUE                              24310006
243200         SET PS-ERROR        TO TRUE                              24320006
243300                                                                  24330006
243400     ELSE                                                         24340006
243500         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                24350006
243600                                                                  24360006
243700         IF (ASC-PARM-AMT >= PC-MIN-COUNT-ENTRY-TFRAME)           24370006
243800             PERFORM I310-XVAL-COUNT-ENTRY-TFRAME                 24380006
243900         ELSE                                                     24390006
244000             MOVE DP015-RED     TO APARMC                         24400006
244100             MOVE DP015-REVERSE TO APARMH                         24410006
244200             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             24420006
244300             MOVE -1 TO APARML                                    24430006
244400                                                                  24440006
244500             SET DP020-MSG-FATAL TO TRUE                          24450006
244600             SET PS-ERROR        TO TRUE                          24460006
244700     END-IF.                                                      24470006
244800******************************************************************24480006
244900*    CROSS VALIDATE THE COUNT ENTRY TIMEFRAME AGAINST THE         24490006
245000*    DOCUMENT PROCESSING TIMEFRAME.                               24500006
245100*                                                                 24510006
245200*    PERFORMED BY:-                                               24520006
245300*                  H310-VAL-COUNT-ENTRY-TIMEFRAME.                24530006
245400******************************************************************24540006
245500 I310-XVAL-COUNT-ENTRY-TFRAME.                                    24550006
245600     MOVE PE048-CORP-DOC-PROC-TIMEFR-NBR                          24560006
245700                             TO PV-CROSS-VALIDATE-PARM-NBR.       24570006
245800     SET PS-DB2-RETRY TO TRUE.                                    24580006
245900                                                                  24590006
246000     PERFORM Z500-READ-DB-CROSS-VALIDATE                          24600006
246100             UNTIL PS-DB2-OK.                                     24610006
246200                                                                  24620006
246300     IF ASC-PARM-AMT <= PV-CROSS-VALIDATE-PARM-AMT                24630006
246400         CONTINUE                                                 24640006
246500                                                                  24650006
246600     ELSE                                                         24660006
246700         MOVE DP015-RED     TO APARMC                             24670006
246800         MOVE DP015-REVERSE TO APARMH                             24680006
246900         MOVE PC-TSYMSG-00278 TO DP020-MSG-NUMBER                 24690006
247000         MOVE -1 TO APARML                                        24700006
247100                                                                  24710006
247200         SET DP020-MSG-FATAL TO TRUE                              24720006
247300         SET PS-ERROR        TO TRUE                              24730006
247400     END-IF.                                                      24740006
247500******************************************************************24750006
247600*    VALIDATE THE VALUE OF THE IN-STORE MONTH END DELINQUENT      24760006
247700*    TIME FRAME NUMBER.                                           24770006
247800*                                                                 24780006
247900*    PERFORMED  E350-SELECT-VALIDATION.                           24790006
248000******************************************************************24800006
248100 H320-VAL-INSTR-ME-DQ-TFRAME.                                     24810006
248200     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 24820006
248300     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 24830006
248400     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               24840006
248500                                                                  24850006
248600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      24860006
248700                                                                  24870006
248810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             24881008
248820                         USING DP010I-NUMERIC-EDIT-AREA           24882008
248900                                                                  24890006
249000     IF  DP010I-ERROR-DETECTED                                    24900006
249100         MOVE DP015-RED     TO APARMC                             24910006
249200         MOVE DP015-REVERSE TO APARMH                             24920006
249300         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 24930006
249400         MOVE -1 TO APARML                                        24940006
249500                                                                  24950006
249600         SET DP020-MSG-FATAL TO TRUE                              24960006
249700         SET PS-ERROR        TO TRUE                              24970006
249800                                                                  24980006
249900     ELSE                                                         24990006
250000         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                25000006
250100                                                                  25010006
250200         IF (ASC-PARM-AMT < PC-MIN-ME-DQ-TFRAME                   25020006
250300          OR ASC-PARM-AMT > PC-MAX-ME-DQ-TFRAME)                  25030006
250400             MOVE DP015-RED     TO APARMC                         25040006
250500             MOVE DP015-REVERSE TO APARMH                         25050006
250600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             25060006
250700             MOVE -1 TO APARML                                    25070006
250800                                                                  25080006
250900             SET DP020-MSG-FATAL TO TRUE                          25090006
251000             SET PS-ERROR        TO TRUE                          25100006
251100         END-IF                                                   25110006
251200     END-IF.                                                      25120006
251300******************************************************************25130006
251400*    VALIDATE THE VALUE OF THE IN-STORE PAGES PER DOCUMENT.       25140006
251500*                                                                 25150006
251600*    PERFORMED  E350-SELECT-VALIDATION.                           25160006
251700******************************************************************25170006
251800 H330-VAL-INSTR-PAGES-PER-DOC.                                    25180006
251900     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 25190006
252000     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 25200006
252100     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               25210006
252200                                                                  25220006
252300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      25230006
252400                                                                  25240006
252510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             25251008
252520                         USING DP010I-NUMERIC-EDIT-AREA           25252008
252600                                                                  25260006
252700     IF  DP010I-ERROR-DETECTED                                    25270006
252800         MOVE DP015-RED     TO APARMC                             25280006
252900         MOVE DP015-REVERSE TO APARMH                             25290006
253000         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 25300006
253100         MOVE -1 TO APARML                                        25310006
253200                                                                  25320006
253300         SET DP020-MSG-FATAL TO TRUE                              25330006
253400         SET PS-ERROR        TO TRUE                              25340006
253500                                                                  25350006
253600     ELSE                                                         25360006
253700         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                25370006
253800                                                                  25380006
253900         IF (ASC-PARM-AMT < PC-MIN-PAGES-PER-DOC                  25390006
254000          OR ASC-PARM-AMT > PC-MAX-PAGES-PER-DOC)                 25400006
254100             MOVE DP015-RED     TO APARMC                         25410006
254200             MOVE DP015-REVERSE TO APARMH                         25420006
254300             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             25430006
254400             MOVE -1 TO APARML                                    25440006
254500                                                                  25450006
254600             SET DP020-MSG-FATAL TO TRUE                          25460006
254700             SET PS-ERROR        TO TRUE                          25470006
254800         END-IF                                                   25480006
254900     END-IF.                                                      25490006
255000******************************************************************25500006
255100*    VALIDATE THE VALUE OF THE IN-STORE EXCESSIVE UNITS.          25510006
255200*                                                                 25520006
255300*    PERFORMED  E350-SELECT-VALIDATION.                           25530006
255400******************************************************************25540006
255500 H340-VAL-INSTR-EXCESS-UNITS.                                     25550006
255600     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 25560006
255700     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 25570006
255800     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               25580006
255900                                                                  25590006
256000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      25600006
256100                                                                  25610006
256210     CALL DP010I-NUMERIC-EDIT-ROUTINE                             25621008
256220                         USING DP010I-NUMERIC-EDIT-AREA           25622008
256300                                                                  25630006
256400     IF  DP010I-ERROR-DETECTED                                    25640006
256500         MOVE DP015-RED     TO APARMC                             25650006
256600         MOVE DP015-REVERSE TO APARMH                             25660006
256700         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 25670006
256800         MOVE -1 TO APARML                                        25680006
256900                                                                  25690006
257000         SET DP020-MSG-FATAL TO TRUE                              25700006
257100         SET PS-ERROR        TO TRUE                              25710006
257200                                                                  25720006
257300     ELSE                                                         25730006
257400         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                25740006
257500                                                                  25750006
257600         IF (ASC-PARM-AMT < PC-MIN-EXCESS-UNITS                   25760006
257700          OR ASC-PARM-AMT > PC-MAX-EXCESS-UNITS)                  25770006
257800             MOVE DP015-RED     TO APARMC                         25780006
257900             MOVE DP015-REVERSE TO APARMH                         25790006
258000             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             25800006
258100             MOVE -1 TO APARML                                    25810006
258200                                                                  25820006
258300             SET DP020-MSG-FATAL TO TRUE                          25830006
258400             SET PS-ERROR        TO TRUE                          25840006
258500         END-IF                                                   25850006
258600     END-IF.                                                      25860006
258700******************************************************************25870006
258800*    VALIDATE THE VALUE OF THE IN-STORE ISSUE DATE DELINQUENT     25880006
258900*    TIMEFRAME NUMBER                                             25890006
259000*                                                                 25900006
259100*    PERFORMED  E350-SELECT-VALIDATION.                           25910006
259200******************************************************************25920006
259300 H350-VAL-INSTR-ISS-DQ-TIMEFR.                                    25930006
259400     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 25940006
259500     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 25950006
259600     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               25960006
259700                                                                  25970006
259800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      25980006
259900                                                                  25990006
260010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             26001008
260020                         USING DP010I-NUMERIC-EDIT-AREA           26002008
260100                                                                  26010006
260200     IF  DP010I-ERROR-DETECTED                                    26020006
260300         MOVE DP015-RED     TO APARMC                             26030006
260400         MOVE DP015-REVERSE TO APARMH                             26040006
260500         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 26050006
260600         MOVE -1 TO APARML                                        26060006
260700                                                                  26070006
260800         SET DP020-MSG-FATAL TO TRUE                              26080006
260900         SET PS-ERROR        TO TRUE                              26090006
261000                                                                  26100006
261100     ELSE                                                         26110006
261200         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                26120006
261300                                                                  26130006
261400         IF (ASC-PARM-AMT < PC-MIN-ISS-DQ-TFRAME                  26140006
261500          OR ASC-PARM-AMT > PC-MAX-ISS-DQ-TFRAME)                 26150006
261600             MOVE DP015-RED     TO APARMC                         26160006
261700             MOVE DP015-REVERSE TO APARMH                         26170006
261800             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             26180006
261900             MOVE -1 TO APARML                                    26190006
262000                                                                  26200006
262100             SET DP020-MSG-FATAL TO TRUE                          26210006
262200             SET PS-ERROR        TO TRUE                          26220006
262300         END-IF                                                   26230006
262400     END-IF.                                                      26240006
262500******************************************************************26250006
262600*    VALIDATE THE VALUE OF THE MAXIMUM PERM RELEASE AVAILABLE     26260006
262700*    NUMBER.                                                      26270006
262800*                                                                 26280006
262900*    PERFORMED  E350-SELECT-VALIDATION.                           26290006
263000******************************************************************26300006
263100 H360-VAL-MAX-PERM-RLSE-NBR.                                      26310006
263200     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 26320006
263300     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 26330006
263400     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               26340006
263500                                                                  26350006
263600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      26360006
263700                                                                  26370006
263810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             26381008
263820                         USING DP010I-NUMERIC-EDIT-AREA           26382008
263900                                                                  26390006
264000     IF  DP010I-ERROR-DETECTED                                    26400006
264100         MOVE DP015-RED     TO APARMC                             26410006
264200         MOVE DP015-REVERSE TO APARMH                             26420006
264300         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 26430006
264400         MOVE -1 TO APARML                                        26440006
264500                                                                  26450006
264600         SET DP020-MSG-FATAL TO TRUE                              26460006
264700         SET PS-ERROR        TO TRUE                              26470006
264800                                                                  26480006
264900     ELSE                                                         26490006
265000         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                26500006
265100                                                                  26510006
265200         IF (ASC-PARM-AMT < PC-MIN-RLSE-AVAIL-NBR                 26520006
265300          OR ASC-PARM-AMT > PC-MAX-RLSE-AVAIL-NBR)                26530006
265400             MOVE DP015-RED     TO APARMC                         26540006
265500             MOVE DP015-REVERSE TO APARMH                         26550006
265600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             26560006
265700             MOVE -1 TO APARML                                    26570006
265800                                                                  26580006
265900             SET DP020-MSG-FATAL TO TRUE                          26590006
266000             SET PS-ERROR        TO TRUE                          26600006
266100         END-IF                                                   26610006
266200     END-IF.                                                      26620006
266300******************************************************************26630006
266400*    VALIDATE THE VALUE OF THE IN-STORE EXCESSIVE DOLLARS.        26640006
266500*                                                                 26650006
266600*    PERFORMED  E350-SELECT-VALIDATION.                           26660006
266700******************************************************************26670006
266800 H370-VAL-INSTR-EXCESS-DOLLARS.                                   26680006
266900     MOVE ASC-PARM-AMT-X TO DP010I-UNEDITED-FIELD                 26690006
267000     MOVE +8             TO DP010I-MAXIMUM-DIGITS                 26700006
267100     MOVE +0             TO DP010I-MAXIMUM-DECIMALS               26710006
267200                                                                  26720006
267300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      26730006
267400                                                                  26740006
267500     CALL DP010I-NUMERIC-EDIT-ROUTINE                             26750008
267510                         USING DP010I-NUMERIC-EDIT-AREA           26751008
267600                                                                  26760006
267700     IF  DP010I-ERROR-DETECTED                                    26770006
267800         MOVE DP015-RED     TO APARMC                             26780006
267900         MOVE DP015-REVERSE TO APARMH                             26790006
268000         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                 26800006
268100         MOVE -1 TO APARML                                        26810006
268200                                                                  26820006
268300         SET DP020-MSG-FATAL TO TRUE                              26830006
268400         SET PS-ERROR        TO TRUE                              26840006
268500                                                                  26850006
268600     ELSE                                                         26860006
268700         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                26870006
268800                                                                  26880006
268900         IF (ASC-PARM-AMT < PC-MIN-EXCESS-DOLLARS                 26890006
269000          OR ASC-PARM-AMT > PC-MAX-EXCESS-DOLLARS)                26900006
269100             MOVE DP015-RED     TO APARMC                         26910006
269200             MOVE DP015-REVERSE TO APARMH                         26920006
269300             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             26930006
269400             MOVE -1 TO APARML                                    26940006
269500                                                                  26950006
269600             SET DP020-MSG-FATAL TO TRUE                          26960006
269700             SET PS-ERROR        TO TRUE                          26970006
269800         END-IF                                                   26980006
269900     END-IF.                                                      26990006
270000                                                                  27000006
270100******************************************************************27010006
270200*    VALIDATE THE VALUE OF THE NUMBER OF DAYS SKUS CHANGED TO     27020006
270300*     CLEARANCE ARE PROTECTED FROM ZERO OUT PROCESS.              27030006
270400*                                                                 27040006
270500*    PERFORMED  E350-SELECT-VALIDATION.                           27050006
270600******************************************************************27060006
270700 H380-VAL-ZEROUT-PROTECT-DAYS.                                    27070006
270800                                                                  27080006
270900     PERFORM J100-NUMERIC-EDIT.                                   27090006
271000     IF PS-NO-ERROR                                               27100006
271100         IF (ASC-PARM-AMT < ZERO                                  27110006
271200          OR ASC-PARM-AMT > 60)                                   27120006
271300             MOVE DP015-RED      TO APARMC                        27130006
271400             MOVE DP015-REVERSE  TO APARMH                        27140006
271500             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             27150006
271600             MOVE -1 TO APARML                                    27160006
271700                                                                  27170006
271800             SET DP020-MSG-FATAL TO TRUE                          27180006
271900             SET PS-ERROR        TO TRUE                          27190006
272000         END-IF                                                   27200006
272100     END-IF.                                                      27210006
272200                                                                  27220006
272300******************************************************************27230006
272400*    VALIDATE THE VALUE OF THE NUMBER OF DAYS BEFORE A NEW STORE  27240006
272500*    OPENS THAT PREVIOUS RCP CHANGES ARE ADDED TO A VSM TABLE.    27250006
272600*                                                                 27260006
272700*    PERFORMED  E350-SELECT-VALIDATION.                           27270006
272800******************************************************************27280006
272900 H390-VAL-ADD-NEW-STR-PREV-RCP.                                   27290006
273000                                                                  27300006
273100     PERFORM J100-NUMERIC-EDIT.                                   27310006
273200     IF PS-NO-ERROR                                               27320006
273300         IF (ASC-PARM-AMT < 1                                     27330006
273400          OR ASC-PARM-AMT > 30)                                   27340006
273500             MOVE DP015-RED      TO APARMC                        27350006
273600             MOVE DP015-REVERSE  TO APARMH                        27360006
273700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             27370006
273800             MOVE -1 TO APARML                                    27380006
273900                                                                  27390006
274000             SET DP020-MSG-FATAL TO TRUE                          27400006
274100             SET PS-ERROR        TO TRUE                          27410006
274200         END-IF                                                   27420006
274300     END-IF.                                                      27430006
274400                                                                  27440006
274500******************************************************************27450006
274600*    VALIDATE THE VALUE OF THE MAXIMUM NUMBER OF TIERS ALLOWED    27460006
274700*    FOR AN RCP DOCUMENTS.                                        27470006
274800*                                                                 27480006
274900*    PERFORMED  E350-SELECT-VALIDATION.                           27490006
275000******************************************************************27500006
275100 H400-VAL-RCP-MAXIUM-TIERS.                                       27510006
275200                                                                  27520006
275300     PERFORM J100-NUMERIC-EDIT.                                   27530006
275400     IF PS-NO-ERROR                                               27540006
275500         IF (ASC-PARM-AMT < 1                                     27550006
275600          OR ASC-PARM-AMT > 3)                                    27560006
275700             MOVE DP015-RED      TO APARMC                        27570006
275800             MOVE DP015-REVERSE  TO APARMH                        27580006
275900             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             27590006
276000             MOVE -1 TO APARML                                    27600006
276100                                                                  27610006
276200             SET DP020-MSG-FATAL TO TRUE                          27620006
276300             SET PS-ERROR        TO TRUE                          27630006
276400         END-IF                                                   27640006
276500     END-IF.                                                      27650006
276600                                                                  27660006
276700******************************************************************27670006
276800*    VALIDATE THE VALUE OF THE MINIMUM NBR OF DAYS BETWEEN RCP    27680006
276900*    TIER EFFECTIVE DATES.                                        27690006
277000*                                                                 27700006
277100*    PERFORMED  E350-SELECT-VALIDATION.                           27710006
277200******************************************************************27720006
277300 H410-VAL-MIN-DAYS-RCP-TIERS.                                     27730006
277400                                                                  27740006
277500     PERFORM J100-NUMERIC-EDIT.                                   27750006
277600     IF PS-NO-ERROR                                               27760006
277700         IF (ASC-PARM-AMT < 1                                     27770006
277800          OR ASC-PARM-AMT > 60)                                   27780006
277900             MOVE DP015-RED      TO APARMC                        27790006
278000             MOVE DP015-REVERSE  TO APARMH                        27800006
278100             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             27810006
278200             MOVE -1 TO APARML                                    27820006
278300                                                                  27830006
278400             SET DP020-MSG-FATAL TO TRUE                          27840006
278500             SET PS-ERROR        TO TRUE                          27850006
278600         END-IF                                                   27860006
278700     END-IF.                                                      27870006
278800                                                                  27880006
278900******************************************************************27890006
279000*    GENERIC NUMERIC EDIT ROUTINE ADDED FOR NEW PARAGRAPHS.       27900006
279100*     THIS SHOULD EVENTUALLY BE USED BY MOST OF THE H999- PARA.   27910006
279200*                                                                 27920006
279300*    PERFORMED  H380-VAL-ZEROUT-PROTECT-DAYS                      27930006
279400*               H390-VAL-ADD-NEW-STR-PREV-RCP                     27940006
279500*               H400-VAL-RCP-MAXIUM-TIERS                         27950006
279600*               H410-VAL-MIN-DAYS-RCP-TIERS                       27960006
279700******************************************************************27970006
279800 J100-NUMERIC-EDIT.                                               27980006
279900     MOVE ASC-PARM-AMT-X         TO DP010I-UNEDITED-FIELD.        27990006
280000     MOVE +8                     TO DP010I-MAXIMUM-DIGITS.        28000006
280100     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      28010006
280200                                                                  28020006
280300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     28030006
280400                                                                  28040006
280500     CALL DP010I-NUMERIC-EDIT-ROUTINE                             28050008
280510                         USING DP010I-NUMERIC-EDIT-AREA           28051008
280600                                                                  28060006
280700     IF  DP010I-ERROR-DETECTED                                    28070006
280800         MOVE DP015-RED          TO APARMC                        28080006
280900         MOVE DP015-REVERSE      TO APARMH                        28090006
281000         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              28100006
281100         MOVE -1                 TO APARML                        28110006
281200                                                                  28120006
281300         SET DP020-MSG-FATAL                                      28130006
281400             PS-ERROR            TO TRUE                          28140006
281500     ELSE                                                         28150006
281600         MOVE DP010I-NUMERIC-FIELD TO ASC-PARM-AMT                28160006
281700     END-IF.                                                      28170006
281800                                                                  28180006
281900******************************************************************28190006
282000*    CALLS CALENDAR ROUTINE.                                      28200006
282100******************************************************************28210006
282200 Z100-CALENDAR-CALL.                                              28220006
282300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                28230006
282400                                             DPG52                28240006
282500                                             DPG53                28250006
282600                                             DPG54                28260006
282700                                             DPG55                28270006
282800                                             DPG56.               28280006
282900                                                                  28290006
283000     EVALUATE TRUE                                                28300006
283100        WHEN DPG54-NO-ERROR                                       28310006
283200        WHEN DPG54-WARNING-ERROR                                  28320006
283300             CONTINUE                                             28330006
283400        WHEN DPG54-SEVERE-ERROR                                   28340006
283500             SET DP013-XCTL-DISPLAY-RESTART                       28350006
283600                 DP013-LOGIC-ABEND TO TRUE                        28360006
283700             MOVE 'BAD DP500 CALL STATUS '                        28370006
283800                        TO DP013-MESSAGE-TEXT (1)                 28380006
283900             MOVE DPG54-ERROR-MESSAGE                             28390006
284000                        TO DP013-MESSAGE-TEXT (2)                 28400006
284100             MOVE DPG51                                           28410006
284200                        TO DP013-MESSAGE-TEXT (3)                 28420006
284300             MOVE DPG52                                           28430006
284400                        TO DP013-MESSAGE-TEXT (4)                 28440006
284500             PERFORM DP013-0000-PROCESS-ABEND                     28450006
284600     END-EVALUATE.                                                28460006
284700******************************************************************28470006
284800*    READ THE PARM USING THE PARM NUMBER                          28480006
284900*                                                                 28490006
285000*    PERFORMED BY E300-EDIT-DATA-IN-COMMAREA.                     28500006
285100******************************************************************28510006
285200 Z300-READ-DB-FOR-PARM.                                           28520006
285300     EXEC SQL                                                     28530006
285400       SELECT PPCCTL_NBR,                                         28540006
285500              PARM_AMT,                                           28550006
285600              PPCCTL_DESC,                                        28560006
285700              TXT_1,                                              28570006
285800              TXT_2,                                              28580006
285900              TXT_3,                                              28590006
286000              TXT_4                                               28600006
286100         INTO :PPCCTL-NBR,                                        28610006
286200              :PPCCTL-PARM-AMT,                                   28620006
286300              :PPCCTL-DESC,                                       28630006
286400              :PPCCTL-TXT-1,                                      28640006
286500              :PPCCTL-TXT-2,                                      28650006
286600              :PPCCTL-TXT-3,                                      28660006
286700              :PPCCTL-TXT-4                                       28670006
286800         FROM TPPCCTL                                             28680006
286900         WHERE PPCCTL_NBR = :ASC-PARM-NBR                         28690006
287000         AND   OPERCO_NBR = :DP020-OPERATING-COMPANY              28700006
287100     END-EXEC.                                                    28710006
287200                                                                  28720006
287300     SET PS-DB2-OK TO TRUE.                                       28730006
287400                                                                  28740006
287500     IF  (SQLCODE = -904) OR                                      28750006
287600         (SQLCODE = -913)                                         28760006
287700          SET PS-DB2-RETRY TO TRUE                                28770006
287800                                                                  28780006
287900          ADD 1 TO PC-RETRY-CNTR                                  28790006
288000                                                                  28800006
288100          IF  PC-RETRY-CNTR > PC-MAX-RETRYS                       28810006
288200              SET PS-DB2-OK TO TRUE                               28820006
288300          END-IF                                                  28830006
288400                                                                  28840006
288500     END-IF.                                                      28850006
288600                                                                  28860006
288700     IF PS-DB2-OK                                                 28870006
288800                                                                  28880006
288900         IF  (SQLCODE = +0)                                       28890006
289000              MOVE  PPCCTL-PARM-AMT TO ASC-PARM-AMT               28900006
289100                                       ASC-PARM-AMT-ORIG          28910006
289200                                       PV-DISPLAY-PARM-NBR        28920006
289300              MOVE  PV-DISPLAY-PARM-NBR                           28930006
289400                                    TO ASC-PARM-AMT-X             28940006
289500              MOVE  PPCCTL-DESC     TO ASC-DESC                   28950006
289600              MOVE  PPCCTL-TXT-1    TO ASC-TEXT-1                 28960006
289700              MOVE  PPCCTL-TXT-2    TO ASC-TEXT-2                 28970006
289800              MOVE  PPCCTL-TXT-3    TO ASC-TEXT-3                 28980006
289900              MOVE  PPCCTL-TXT-4    TO ASC-TEXT-4                 28990006
290000                                                                  29000006
290100              IF   ASC-PARM-IS-DTE-DDMMYY                         29010006
290200              OR   ASC-PARM-IS-DTE-MMYY                           29020006
290300                                                                  29030006
290400                   PERFORM Z310-REFORMAT-DATE                     29040006
290500              END-IF                                              29050006
290600         ELSE                                                     29060006
290700              SET DP013-DB2-ABEND   TO TRUE                       29070006
290800              SET DP013-NO-ROLLBACK TO TRUE                       29080006
290900                                                                  29090006
291000              MOVE 'Z300-READ-DB-FOR-PARM'  TO                    29100006
291100                  DP013-PARAGRAPH                                 29110006
291200                                                                  29120006
291300              MOVE ASC-PARM-NBR             TO                    29130006
291400                  AM-PARM-NBR-2                                   29140006
291500                                                                  29150006
291600              MOVE DP020-OPERATING-COMPANY  TO                    29160006
291700                  AM-OP-CO-2                                      29170006
291800                                                                  29180006
291900              MOVE AM-ABEND-MESSAGE-2       TO                    29190006
292000                  DP013-MESSAGE-TEXT(1)                           29200006
292100                                                                  29210006
292200              MOVE SQLCA                    TO                    29220006
292300                  DP013-SQLCA                                     29230006
292400                                                                  29240006
292500              PERFORM DP013-0000-PROCESS-ABEND                    29250006
292600         END-IF                                                   29260006
292700                                                                  29270006
292800     END-IF.                                                      29280006
292900******************************************************************29290006
293000*    REFORMAT THE PARM AMT WHEN IT IS A DATE                      29300006
293100*                                                                 29310006
293200*    PERFORMED BY Z300-READ-DB-FOR-PARM.                          29320006
293300******************************************************************29330006
293400 Z310-REFORMAT-DATE.                                              29340006
293500         IF  ASC-PARM-IS-DTE-DDMMYY                               29350006
293600                                                                  29360006
293700             MOVE ASC-PARM-AMT                                    29370006
293800                    TO PV-DISPLAY-PARM-NBR                        29380006
293900             MOVE  PV-DISPLAY-PARM-NBR                            29390006
294000                    TO  PV-DATE-CCYYMMDD                          29400006
294100             MOVE PV-DATE-CC TO PV-DATE-MMDDYYYY-CC               29410006
294200             MOVE PV-DATE-YY TO PV-DATE-MMDDYYYY-YY               29420006
294300             MOVE PV-DATE-MM TO PV-DATE-MMDDYYYY-MM               29430006
294400             MOVE PV-DATE-DD TO PV-DATE-MMDDYYYY-DD               29440006
294500             MOVE  PV-DATE-MMDDYYYY-FORMAT                        29450006
294600                   TO ASC-PARM-AMT-X                              29460006
294700                                                                  29470006
294800         ELSE                                                     29480006
294900             IF ASC-PARM-IS-DTE-MMYY                              29490006
295000                MOVE ASC-PARM-AMT                                 29500006
295100                    TO PV-DISPLAY-PARM-NBR                        29510006
295200                MOVE  PV-DISPLAY-PARM-NBR                         29520006
295300                          TO PV-DATE-MMYY-FORMAT                  29530006
295400                MOVE PV-DATE-MMYY-FORMAT                          29540006
295500                      TO ASC-PARM-AMT-X                           29550006
295600             END-IF                                               29560006
295700         END-IF.                                                  29570006
295800******************************************************************29580006
295900*    UPDATE THE PARM TABLE                                        29590006
296000*                                                                 29600006
296100*    PERFORMED BY E300-EDIT-DATA-IN-COMMAREA.                     29610006
296200******************************************************************29620006
296300 Z400-UPDATE-DB-PARM.                                             29630006
296400     MOVE ASC-PARM-AMT TO PPCCTL-PARM-AMT.                        29640006
296500                                                                  29650006
296600     EXEC SQL                                                     29660006
296700       UPDATE TPPCCTL                                             29670006
296800         SET PARM_AMT = :PPCCTL-PARM-AMT                          29680006
296900             WHERE (PPCCTL_NBR = :ASC-PARM-NBR)                   29690006
297000             AND   (OPERCO_NBR = :DP020-OPERATING-COMPANY)        29700006
297100     END-EXEC.                                                    29710006
297200                                                                  29720006
297300     SET PS-DB2-OK TO TRUE.                                       29730006
297400                                                                  29740006
297500     IF  (SQLCODE = -904) OR                                      29750006
297600         (SQLCODE = -913)                                         29760006
297700          SET PS-DB2-RETRY TO TRUE                                29770006
297800                                                                  29780006
297900          ADD 1 TO PC-RETRY-CNTR                                  29790006
298000                                                                  29800006
298100          IF  PC-RETRY-CNTR > PC-MAX-RETRYS                       29810006
298200              SET PS-DB2-OK TO TRUE                               29820006
298300          END-IF                                                  29830006
298400                                                                  29840006
298500     END-IF.                                                      29850006
298600                                                                  29860006
298700     IF PS-DB2-OK                                                 29870006
298800                                                                  29880006
298900         IF  (SQLCODE = +0)                                       29890006
299000             MOVE PPCCTL-PARM-AMT TO ASC-PARM-AMT-ORIG            29900006
299100         ELSE                                                     29910006
299200              SET DP013-DB2-ABEND   TO TRUE                       29920006
299300              SET DP013-NO-ROLLBACK TO TRUE                       29930006
299400                                                                  29940006
299500              MOVE 'Z400-UPDATE-DB-PARM'  TO                      29950006
299600                  DP013-PARAGRAPH                                 29960006
299700                                                                  29970006
299800              MOVE ASC-PARM-NBR             TO                    29980006
299900                  AM-PARM-NBR-3                                   29990006
300000                                                                  30000006
300100              MOVE DP020-OPERATING-COMPANY  TO                    30010006
300200                  AM-OP-CO-3                                      30020006
300300                                                                  30030006
300400              MOVE AM-ABEND-MESSAGE-3       TO                    30040006
300500                  DP013-MESSAGE-TEXT(1)                           30050006
300600                                                                  30060006
300700              MOVE SQLCA                    TO                    30070006
300800                  DP013-SQLCA                                     30080006
300900                                                                  30090006
301000              PERFORM DP013-0000-PROCESS-ABEND                    30100006
301100         END-IF                                                   30110006
301200                                                                  30120006
301300     END-IF.                                                      30130006
301400******************************************************************30140006
301500*    READ THE PARM USING THE PARM NUMBER                          30150006
301600*    TO CROSS VALIDATE THE PARM AMT THAT IS INPUT                 30160006
301700*                                                                 30170006
301800*    PERFORMED BY E300-EDIT-DATA-IN-COMMAREA.                     30180006
301900******************************************************************30190006
302000 Z500-READ-DB-CROSS-VALIDATE.                                     30200006
302100     EXEC SQL                                                     30210006
302200       SELECT PPCCTL_NBR,                                         30220006
302300              PARM_AMT                                            30230006
302400         INTO :PPCCTL-NBR,                                        30240006
302500              :PPCCTL-PARM-AMT                                    30250006
302600         FROM TPPCCTL                                             30260006
302700         WHERE PPCCTL_NBR = :PV-CROSS-VALIDATE-PARM-NBR           30270006
302800         AND   OPERCO_NBR = :DP020-OPERATING-COMPANY              30280006
302900     END-EXEC.                                                    30290006
303000                                                                  30300006
303100     SET PS-DB2-OK TO TRUE.                                       30310006
303200                                                                  30320006
303300     IF  (SQLCODE = -904) OR                                      30330006
303400         (SQLCODE = -913)                                         30340006
303500          SET PS-DB2-RETRY TO TRUE                                30350006
303600                                                                  30360006
303700          ADD 1 TO PC-RETRY-CNTR                                  30370006
303800                                                                  30380006
303900          IF  PC-RETRY-CNTR > PC-MAX-RETRYS                       30390006
304000              SET PS-DB2-OK TO TRUE                               30400006
304100          END-IF                                                  30410006
304200                                                                  30420006
304300     END-IF.                                                      30430006
304400                                                                  30440006
304500     IF PS-DB2-OK                                                 30450006
304600                                                                  30460006
304700         IF  (SQLCODE = +0)                                       30470006
304800              MOVE PPCCTL-PARM-AMT TO PV-CROSS-VALIDATE-PARM-AMT  30480006
304900         ELSE                                                     30490006
305000              SET DP013-DB2-ABEND   TO TRUE                       30500006
305100              SET DP013-NO-ROLLBACK TO TRUE                       30510006
305200                                                                  30520006
305300              MOVE 'Z300-READ-DB-FOR-PARM'  TO                    30530006
305400                  DP013-PARAGRAPH                                 30540006
305500                                                                  30550006
305600              MOVE PV-CROSS-VALIDATE-PARM-NBR TO                  30560006
305700                  AM-PARM-NBR-4                                   30570006
305800                                                                  30580006
305900              MOVE DP020-OPERATING-COMPANY  TO                    30590006
306000                  AM-OP-CO-4                                      30600006
306100                                                                  30610006
306200              MOVE AM-ABEND-MESSAGE-4       TO                    30620006
306300                  DP013-MESSAGE-TEXT(1)                           30630006
306400                                                                  30640006
306500              MOVE SQLCA                    TO                    30650006
306600                  DP013-SQLCA                                     30660006
306700                                                                  30670006
306800              PERFORM DP013-0000-PROCESS-ABEND                    30680006
306900         END-IF                                                   30690006
307000                                                                  30700006
307100     END-IF.                                                      30710006
307200******************************************************************30720006
307300*    READ THE PARM USING THE PARM NUMBER                          30730006
307400*    TO CHECK FOR CHAGES MADE TO THE PARM AMOUT BY                30740006
307500*    OTHER USERS.                                                 30750006
307600*                                                                 30760006
307700*    PERFORMED BY E300-EDIT-DATA-IN-COMMAREA.                     30770006
307800******************************************************************30780006
307900 Z600-READ-DB-FOR-CHANGES.                                        30790006
308000     EXEC SQL                                                     30800006
308100       SELECT PPCCTL_NBR,                                         30810006
308200              PARM_AMT                                            30820006
308300         INTO :PPCCTL-NBR,                                        30830006
308400              :PPCCTL-PARM-AMT                                    30840006
308500         FROM TPPCCTL                                             30850006
308600         WHERE PPCCTL_NBR = :ASC-PARM-NBR                         30860006
308700         AND   OPERCO_NBR = :DP020-OPERATING-COMPANY              30870006
308800     END-EXEC.                                                    30880006
308900                                                                  30890006
309000     SET PS-DB2-OK TO TRUE.                                       30900006
309100                                                                  30910006
309200     IF  (SQLCODE = -904) OR                                      30920006
309300         (SQLCODE = -913)                                         30930006
309400          SET PS-DB2-RETRY TO TRUE                                30940006
309500                                                                  30950006
309600          ADD 1 TO PC-RETRY-CNTR                                  30960006
309700                                                                  30970006
309800          IF  PC-RETRY-CNTR > PC-MAX-RETRYS                       30980006
309900              SET PS-DB2-OK TO TRUE                               30990006
310000          END-IF                                                  31000006
310100                                                                  31010006
310200     END-IF.                                                      31020006
310300                                                                  31030006
310400     IF PS-DB2-OK                                                 31040006
310500                                                                  31050006
310600         IF  (SQLCODE = +0)                                       31060006
310700              CONTINUE                                            31070006
310800         ELSE                                                     31080006
310900              SET DP013-DB2-ABEND   TO TRUE                       31090006
311000              SET DP013-NO-ROLLBACK TO TRUE                       31100006
311100                                                                  31110006
311200              MOVE 'Z300-READ-DB-FOR-PARM'  TO                    31120006
311300                  DP013-PARAGRAPH                                 31130006
311400                                                                  31140006
311500              MOVE PV-CROSS-VALIDATE-PARM-NBR TO                  31150006
311600                  AM-PARM-NBR-5                                   31160006
311700                                                                  31170006
311800              MOVE DP020-OPERATING-COMPANY  TO                    31180006
311900                  AM-OP-CO-5                                      31190006
312000                                                                  31200006
312100              MOVE AM-ABEND-MESSAGE-5       TO                    31210006
312200                  DP013-MESSAGE-TEXT(1)                           31220006
312300                                                                  31230006
312400              MOVE SQLCA                    TO                    31240006
312500                  DP013-SQLCA                                     31250006
312600                                                                  31260006
312700              PERFORM DP013-0000-PROCESS-ABEND                    31270006
312800         END-IF                                                   31280006
312900                                                                  31290006
313000     END-IF.                                                      31300006
313100******************************************************************31310006
313200*    FILL IN SCREEN HEADER MODULE                                 31320006
313300******************************************************************31330006
313400     COPY DPPD022.                                                31340006
313500******************************************************************31350006
313600*    RETURN TO CICS MODULE                                        31360006
313700******************************************************************31370006
313800     COPY DPPD003.                                                31380006
313900******************************************************************31390006
314000*    FORMAT MESSAGE LINES MODULE                                  31400006
314100******************************************************************31410006
314200     COPY DPPD005.                                                31420006
314300******************************************************************31430006
314400*    GET PANEL MODULE                                             31440006
314500******************************************************************31450006
314600     COPY DPPD007.                                                31460006
314700******************************************************************31470006
314800*    WRITE PANEL MODULE                                           31480006
314900******************************************************************31490006
315000     COPY DPPD008.                                                31500006
315100******************************************************************31510006
315200*    TOGGLE THE FUNCTION KEY LINE MODULE                          31520006
315300******************************************************************31530006
315400     COPY DPPD009.                                                31540006
315500******************************************************************31550006
315600*    ABEND PROCESSOR MODULE                                       31560006
315700******************************************************************31570006
315800     COPY DPPD013.                                                31580006
315900******************************************************************31590006
316000*    CHECK COMMUNICATION AREA MODULE                              31600006
316100******************************************************************31610006
316200     COPY DPPD015.                                                31620006
316300******************************************************************31630006
316400*    UPDATE TIME AND DATE MODULE                                  31640006
316500******************************************************************31650006
316600     COPY DPPD017.                                                31660006
