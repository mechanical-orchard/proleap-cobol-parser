       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    INKUT167                                                  
       AUTHOR.        DORSEY JACKSON                                            
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  07-02-2002.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * INKUT167 - REFORMAT SHORTAGE EXTRACT TO INRD003I FORMAT                 
      *                                                                         
      *CHANGE HISTORY:                                                          
      * WR/PROJ DATE       PROGRAMMER   DESCRIPTION OF CHANGES                  
      * ------- ---------- ------------ --------------------------------        
24029 * 24029   10-14-2002 ROD JANSSEN  SHORTAGE TO THE DATA WAREHOUSE.         
W26600* W26600  05-01-2004 M JOHNSON    STORE EXPANSION                         
W20445* W20445  09-01-2004 ROD JANSSEN  DETAILED INVNENTORY ADJUSTMENT          
W33304* W33304  11-28-2008 INFOSYS/     HILO CHANGES TO MOVE NEW FIELDS         
W33304*                    JIMMY        IN INPUT INRD014 TO OUTPUT              
W33304*                                 INRD003I.                               
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT INPUT-FILE                                                    
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT OUTPUT-FILE                                                   
               ASSIGN TO OUT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  INPUT-FILE                                                           
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS 0 RECORDS                                            
           DATA RECORD IS INPUT-RECORD.                                         
W33304 01  INPUT-RECORD                   PIC X(170).                           
                                                                                
       FD  OUTPUT-FILE                                                          
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS 0 RECORDS                                            
           DATA RECORD IS OUTPUT-RECORD.                                        
W33304 01  OUTPUT-RECORD                  PIC X(126).                           
                                                                                
      ****************************************************************          
       WORKING-STORAGE SECTION.                                                 
      ****************************************************************          
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** WORKING STORAGE AREA BEGIN ***'.                                
                                                                                
24029 /****************************************************************         
24029 * COPYBOOK - INVENTORY SHORTAGE EXTRACT FILE                              
24029 *****************************************************************         
W20445     COPY INRD014.                                                        
24029                                                                           
  |   /****************************************************************         
  |   * COPYBOOK - INVENTORY STORE SHORTAGE RECORD                              
  |   *****************************************************************         
  |        COPY INRD003I.                                                       
  |                                                                             
  |   ******************************************************************        
  |   *  INRD014 - SHORTAGE EXTRACT FILE                                        
  |   ******************************************************************        
  |   *01  IN014-SHORTAGE-EXTR-REC.                                             
  |   *    05  IN014-GMA-NBR                PIC X(02)      VALUE SPACES.        
  |   *    05  IN014-BYR-NBR                PIC X(03)      VALUE SPACES.        
  |   *    05  IN014-BYR-NAME               PIC X(20)      VALUE SPACES.        
  |   *    05  IN014-DEPT-NBR               PIC X(03)      VALUE SPACES.        
  |   *    05  IN014-DEPT-MDSEAR-DESC       PIC X(20)      VALUE SPACES.        
  |   *    05  IN014-MAJ-CL-NBR             PIC X(02)      VALUE SPACES.        
  |   *    05  IN014-SUB-CL-NBR             PIC X(02)      VALUE SPACES.        
  |   *    05  IN014-RPT-CL-NBR             PIC X(02)      VALUE ZERO.          
  |   *    05  IN014-RPT-LVL                PIC X(03)      VALUE ZERO.          
  |   *    05  IN014-STR-NBR                PIC S9(4) COMP VALUE ZERO.          
  |   *    05  IN014-STR-NAME               PIC X(10)      VALUE SPACES.        
  |   *    05  IN014-BOOK-INV-RTL-AMT       PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *    05  IN014-SLS-BSE-RTL-AMT        PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *    05  IN014-SHNK-RTL-AMT           PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *    05  IN014-TOTAL-BOOK-RTL-AMT     PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *    05  IN014-PHY-INV-RTL-AMT        PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *    05  IN014-SHORTAGE-RTL-AMT       PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *    05  IN014-EST-INV-ADJ-AMT        PIC S9(11)V99  COMP-3               
  |   *                                                    VALUE ZERO.          
  |   *01  IN003I-STORE-SHORTAGE-REC.                                   12/23/93
  |   *    05  IN003I-STORE-NUMB          PIC  9(03)     VALUE ZERO.    INRD003I
  |   *    05  IN003I-DIVISION-NUMB       PIC  9(02)     VALUE ZERO.       LV001
  |   *    05  IN003I-DEPARTMENT-NUMB     PIC  9(03)     VALUE ZERO.    INRD003I
  |   *    05  IN003I-CLASS-NUMB          PIC  9(02)     VALUE ZERO.    INRD003I
  |   *    05  IN003I-BUYER-NUMB          PIC  9(02)     VALUE ZERO.    INRD003I
  |   *    05  IN003I-STORE-NAME          PIC  X(10)     VALUE SPACES.  INRD003I
  |   *    05  IN003I-DEPARTMENT-NAME     PIC  X(20)     VALUE SPACES.  INRD003I
  |   *    05  IN003I-FINANCE-CORP-NMBR   PIC  X(02)     VALUE SPACES.  INRD003I
  |   *    05  IN003I-BOOK-INV            PIC S9(11)V99  COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-SHRINK-ALLOWANCE    PIC S9(9)V99   COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-TOTAL-RETAIL        PIC S9(9)V99   COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-TOTAL-COST          PIC S9(9)V99   COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-PHY-INV-RETAIL      PIC S9(9)V99   COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-SHORT-RETAIL        PIC S9(9)V99   COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-SHORT-COST          PIC S9(9)V99   COMP-3         INRD003I
  |   *                                                  VALUE ZERO.    INRD003I
  |   *    05  IN003I-TOTAL-SALES         PIC S9(11)V99  COMP-3         INRD003I
24029 *                                                  VALUE ZERO.    INRD003I
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'INKUT167'.        
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-HOLD-STR                   PIC 9(04) VALUE ZEROES.            
           05  PV-HOLD-STRX                  PIC X(04) VALUE SPACES.            
           05  PV-HOLD-JOB                   PIC X(02) VALUE SPACES.            
           05  PV-RECCNT                     PIC 9(09) VALUE ZEROES.    00130000
           05  PV-WRITECNT                   PIC 9(09) VALUE ZEROES.    00140000
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.            
               88  PS-INPUT-EOF                           VALUE 'Y'.            
                                                                                
      ****************************************************************          
      ****************************************************************          
       PROCEDURE DIVISION.                                                      
      ****************************************************************          
                                                                                
       0000-INKUT167.                                                           
                                                                                
      ****************************************************************          
      *    OPEN ALL FILES.                                                      
      *    PROCESS CONTROL RECORDS                                              
      *    CLOSE ALL FILES.                                                     
      ****************************************************************          
           OPEN INPUT  INPUT-FILE                                               
                OUTPUT OUTPUT-FILE.                                             
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-PROCESS                                                 
               UNTIL PS-INPUT-EOF.                                              
                                                                                
           CLOSE INPUT-FILE                                                     
                 OUTPUT-FILE.                                                   
                                                                                
           STOP RUN.                                                            
                                                                                
       1000-INITIALIZE.                                                         
      ****************************************************************          
      *    READ FIRST RECORD                                                    
      *    PERFORMED BY 0000-INKUT167.                                          
      ****************************************************************          
                                                                                
           PERFORM 3000-READ-STORE-SHORTAGE-REC.                                
                                                                                
       EJECT                                                                    
                                                                                
       2000-PROCESS.                                                            
                                                                                
      ****************************************************************          
      *    CREATE OUTPUT RECORDS                                                
      *    READ THE NEXT CONTROL RECORD                                         
      *                                                                         
      *    PERFORMED BY 0000-INKUT167.                                          
      ****************************************************************          
           MOVE IN014-STR-NBR          TO PV-HOLD-STR                           
           MOVE PV-HOLD-STR            TO PV-HOLD-STRX                          
           MOVE PV-HOLD-STRX           TO IN003I-STORE-NUMB                     
           MOVE IN014-GMA-NBR          TO IN003I-DIVISION-NUMB                  
           MOVE IN014-DEPT-NBR         TO IN003I-DEPARTMENT-NUMB                
           IF IN014-RPT-LVL = 'MCL'                                             
               MOVE IN014-MAJ-CL-NBR   TO IN003I-CLASS-NUMB                     
           ELSE                                                                 
               MOVE IN014-SUB-CL-NBR   TO IN003I-CLASS-NUMB                     
           END-IF                                                               
           MOVE IN014-BYR-NBR          TO IN003I-BUYER-NUMB.                    
           MOVE IN014-STR-NAME         TO IN003I-STORE-NAME.                    
           MOVE IN014-DEPT-MDSEAR-DESC TO IN003I-DEPARTMENT-NAME.               
           MOVE '01'                   TO IN003I-FINANCE-CORP-NMBR.             
           MOVE IN014-BOOK-INV-RTL-AMT TO IN003I-BOOK-INV.                      
           COMPUTE IN003I-SHRINK-ALLOWANCE =                                    
24029              IN014-ESTIMATED-INV-ADJ-AMT +                                
24029 ********     IN014-EST-INV-ADJ-AMT +                                      
                   IN014-SHNK-RTL-AMT.                                          
           MOVE IN014-TOTAL-BOOK-RTL-AMT TO IN003I-TOTAL-RETAIL                 
           MOVE 0                        TO IN003I-TOTAL-COST                   
           MOVE IN014-PHY-INV-RTL-AMT    TO IN003I-PHY-INV-RETAIL               
           MOVE IN014-SHORTAGE-RTL-AMT   TO IN003I-SHORT-RETAIL                 
           MOVE 0                        TO IN003I-SHORT-COST                   
           MOVE IN014-SLS-BSE-RTL-AMT    TO IN003I-TOTAL-SALES                  
W33304     MOVE IN014-OPN-FSCL-MN-DTE    TO IN003I-OPN-FSCL-MN-DTE              
W33304     MOVE IN014-INV-ID             TO IN003I-INV-ID                       
W33304     MOVE IN014-FINCL-INV-STAT-CDE TO IN003I-FINCL-INV-STAT-CDE           
                                                                                
           PERFORM 4000-WRITE-OUTPUT-RECORD.                                    
                                                                                
           PERFORM 3000-READ-STORE-SHORTAGE-REC.                                
                                                                                
       3000-READ-STORE-SHORTAGE-REC.                                            
      ****************************************************************          
      *    READ CONTROL FILE ONE                                                
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE.                                        
      ****************************************************************          
           READ INPUT-FILE INTO IN014-SHORTAGE-EXTR-REC                         
               AT END                                                           
                   SET PS-INPUT-EOF TO TRUE.                                    
                                                                                
           EJECT                                                                
                                                                                
       4000-WRITE-OUTPUT-RECORD.                                                
      ****************************************************************          
      *    WRITE OUTPUT RECORD                                                  
      *                                                                         
      *    PERFORMED BY 2000-PROCESS                                            
      ****************************************************************          
           WRITE OUTPUT-RECORD FROM IN003I-STORE-SHORTAGE-REC.                  
                                                                                
           EJECT                                                                
