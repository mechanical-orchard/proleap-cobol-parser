000200 IDENTIFICATION DIVISION.                                         RCKUT038
000300 PROGRAM-ID.             RCKUT038.                                RCKUT038
000400 AUTHOR.                 JOHN SELWITSCHKA.                        RCKUT038
000500 INSTALLATION.           KOHLS.                                   RCKUT038
000600 DATE-WRITTEN            DECEMBER 2013.                           RCKUT038
000700 DATE-COMPILED.                                                   RCKUT038
000800                                                                  RCKUT038
000900******************************************************************RCKUT038
001000*   THIS PROGRAM WILL TAKE IN THE WEEKLY RCRD010 FILES AND           CL*40
001100*   UPDATE THE BUYER INFORMATION.                                    CL*34
001200*   THE MBS SUBROUTINE IS CALLED TO OBTAIN THE DMM NUMBER, NAME &    CL*40
001300*   THE BUYER NUMBER AND NAME.                                       CL*40
001500******************************************************************RCKUT038
001600                                                                          
002800*                                                               *         
002900*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              *         
003000*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX *         
003100*                                                               *         
003200*                                                               *         
003300*****************************************************************         
003400 ENVIRONMENT DIVISION.                                            RCKUT038
003500                                                                  RCKUT038
003600 CONFIGURATION SECTION.                                           RCKUT038
003700                                                                  RCKUT038
003800 SOURCE-COMPUTER.        IBM-3090.                                RCKUT038
003900 OBJECT-COMPUTER.        IBM-3090.                                RCKUT038
004000                                                                  RCKUT038
004100 INPUT-OUTPUT SECTION.                                            RCKUT038
004200                                                                  RCKUT038
004300 FILE-CONTROL.                                                    RCKUT038
004400                                                                  RCKUT038
004500     SELECT RC010-IN-FILE                                         RCKUT038
004600         ASSIGN TO IN01.                                          RCKUT038
004700                                                                  RCKUT038
004800     SELECT RC010-OUT-FILE                                        RCKUT038
004900         ASSIGN TO OUT01.                                         RCKUT038
005000                                                                  RCKUT038
005100******************************************************************RCKUT038
005200 DATA DIVISION.                                                   RCKUT038
005300******************************************************************RCKUT038
005400                                                                  RCKUT038
005500 FILE SECTION.                                                    RCKUT038
005600                                                                  RCKUT038
005700 FD  RC010-IN-FILE                                                RCKUT038
005800     RECORDING MODE IS F                                          RCKUT038
005900     BLOCK CONTAINS 0 RECORDS                                     RCKUT038
006000     LABEL RECORDS ARE STANDARD.                                  RCKUT038
006100                                                                  RCKUT038
006200 01  RC010-IN-RECORD                        PIC X(150).           RCKUT038
006300                                                                  RCKUT038
006400 FD  RC010-OUT-FILE                                               RCKUT038
006500     RECORDING MODE IS F                                          RCKUT038
006600     BLOCK CONTAINS 0 RECORDS                                     RCKUT038
006700     LABEL RECORDS ARE STANDARD.                                  RCKUT038
006800                                                                  RCKUT038
006900 01  RC010-OUT-RECORD                       PIC X(150).           RCKUT038
007000                                                                  RCKUT038
007100******************************************************************RCKUT038
007200 WORKING-STORAGE SECTION.                                         RCKUT038
007300******************************************************************RCKUT038
007400                                                                  RCKUT038
007500 01  ABEND-CODE                          PIC S9(04)  VALUE +0     RCKUT038
007600                                                     COMP SYNC.   RCKUT038
007900*                                                                 RCKUT038
008000     COPY RCRD010.                                                RCKUT038
008100*                                                                 RCKUT038
008200*                                                                 RCKUT038
008300 EJECT                                                            RCKUT038
008400                                                                  RCKUT038
008500 01  PV-PROGRAM-VARIABLES.                                        RCKUT038
008600     05  PV-PARA                         PIC X(30)   VALUE SPACES.RCKUT038
008700                                                                  RCKUT038
008800     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE.    CL**6
008900     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE.    CL**6
009000     05  SAVE-DEPT-NBR                   PIC  X(03)  VALUE SPACE.    CL*14
009600     05  PV-INPUT-CNT                    PIC S9(09)  COMP-3          CL*24
009700                                                     VALUE ZEROES.   CL*24
009800     05  PV-OUTPUT-CNT                   PIC S9(09)  COMP-3          CL*24
009900                                                     VALUE ZEROES.   CL*24
010400                                                                     CL**3
010500 01  PROGRAM-SWITCHES.                                            RCKUT038
010600     05  END-OF-INPUT-SW                 PIC X(01)   VALUE 'N'.   RCKUT038
010700         88  END-OF-INPUT                            VALUE 'Y'.   RCKUT038
010800                                                                  RCKUT038
011900                                                                     CL**3
012000 01  PC-CONSTANTS.                                                RCKUT038
012100     05  PC-SYSTEM-DATE.                                          RCKUT038
012200         10  PC-SYSTEM-YEAR              PIC  9(02)  VALUE ZEROS. RCKUT038
012300         10  PC-SYSTEM-MONTH             PIC  9(02)  VALUE ZEROS. RCKUT038
012400         10  PC-SYSTEM-DAY               PIC  9(02)  VALUE ZEROS. RCKUT038
012500     05 PC-PGM-DPKUT039                  PIC  X(08)                  CL**6
012600                                         VALUE 'DPKUT039'.           CL**6
012800                                                                  RCKUT038
013300*                                                                    CL**3
013400******************************************************************   CL**3
013500*  WORK FIELDS FOR THE MBS SUBROUTINE                                CL**3
013600******************************************************************   CL**3
013700     COPY DPWS003.                                                   CL**3
013800*                                                                    CL**3
013900     COPY DPWS004.                                                   CL**6
014000*                                                                    CL**6
018900                                                                  RCKUT038
019000 PROCEDURE DIVISION.                                              RCKUT038
019100******************************************************************RCKUT038
019200*  0000-INITIAL-ROUTINE  -  MAIN LINE OF THE PROGRAM PERFORMS THE RCKUT038
019300*  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM. RCKUT038
019400******************************************************************RCKUT038
019500 0000-MAINLINE.                                                   RCKUT038
019600                                                                  RCKUT038
019700     PERFORM 0100-HOUSEKEEPING.                                   RCKUT038
019800                                                                  RCKUT038
019900     PERFORM 1000-PROCESS-INPUT-RECORDS                           RCKUT038
020000         UNTIL END-OF-INPUT.                                      RCKUT038
020100                                                                  RCKUT038
020400     CLOSE RC010-IN-FILE                                          RCKUT038
020500           RC010-OUT-FILE                                         RCKUT038
020600                                                                  RCKUT038
020700     DISPLAY 'RECORDS READ     -  ' PV-INPUT-CNT.                    CL*25
020800     DISPLAY 'RECORDS WRITTEN  -  ' PV-OUTPUT-CNT.                   CL*24
021000                                                                     CL*24
021100     STOP RUN.                                                    RCKUT038
021200/                                                                 RCKUT038
021300 0100-HOUSEKEEPING.                                               RCKUT038
021400                                                                  RCKUT038
021500     OPEN INPUT  RC010-IN-FILE                                    RCKUT038
021600          OUTPUT RC010-OUT-FILE                                   RCKUT038
021700                                                                  RCKUT038
021800     ACCEPT PC-SYSTEM-DATE FROM DATE.                             RCKUT038
021900                                                                     CL*13
022600     PERFORM 7000-READ-RC010-IN-FILE.                                CL*13
029000                                                                     CL*19
029100                                                                  RCKUT038
029200 1000-PROCESS-INPUT-RECORDS.                                      RCKUT038
029300     MOVE '*1000-PROCESS-INPUT-RECORDS.     *' TO PV-PARA.        RCKUT038
029400                                                                  RCKUT038
030900     PERFORM 1100-GET-BYR-INFO.                                      CL*29
030000     PERFORM 8000-WRITE-RC010-OUT-FILE.                              CL*13
                                                                                
029800     PERFORM 7000-READ-RC010-IN-FILE.                                CL*13
                                                                                
031100/                                                                 RCKUT038
031200 1100-GET-BYR-INFO.                                                  CL*29
031300                                                                     CL*29
031400     IF RC010-DEPT-NBR = SAVE-DEPT-NBR                               CL*37
031500        CONTINUE                                                     CL*29
031600     ELSE                                                            CL*29
031700        MOVE RC010-DEPT-NBR         TO SAVE-DEPT-NBR                 CL*37
031800        INITIALIZE DP003-MBS-SUBROUTINE-FIELDS                       CL*29
031900        SET DP003-BYR-LOOKUP-NAME       TO TRUE                      CL*29
032000        SET DP003-DMM-LOOKUP-NAME       TO TRUE                      CL*29
032100        SET DP003-GMM-LOOKUP-NAME       TO TRUE                      CL*29
032200        MOVE 'MP'                       TO DP003-SYSTEM-CODE         CL*29
032300        MOVE '03'                       TO DP003-OP-CO-NMBR          CL*29
032400        MOVE PC-SYSTEM-DATE             TO DP003-CURRENT-DATE        CL*29
032500                                           DP003-EFF-DATE            CL*29
032600        MOVE RC010-DEPT-NBR             TO DP003-DPT-INPUT           CL*37
032700                                                                     CL*29
032800        CALL PC-PGM-DPKUT039 USING DP003-MBS-SUBROUTINE-FIELDS       CL*29
032900                                                                     CL*29
033000        EVALUATE TRUE                                                CL*29
033100            WHEN DP003-SUCCESSFUL                                    CL*29
033200                CONTINUE                                             CL*29
033300            WHEN DP003-BYR-NAME-NOT-FOUND                            CL*29
033400                MOVE 'BUYER NOT FOUND'  TO  DP003-BYR-NAME           CL*29
033500                MOVE '999'              TO  DP003-BYR-NMBR           CL*29
033600            WHEN DP003-DMM-NAME-NOT-FOUND                            CL*30
033700                MOVE 'DMM NOT FOUND  '  TO  DP003-DMM-NAME           CL*39
033800                MOVE '999'              TO  DP003-DMM-NMBR           CL*39
033900            WHEN DP003-DMM-NMBR-NOT-FOUND                            CL*31
034000                MOVE 'DMM NOT FOUND  '  TO  DP003-DMM-NAME           CL*33
034100                MOVE '999'              TO  DP003-DMM-NMBR           CL*33
034200            WHEN DP003-GMM-NAME-NOT-FOUND                            CL*31
034300                MOVE 'GMM NOT FOUND  '  TO  DP003-GMM-NAME           CL*33
034400                MOVE '999'              TO  DP003-GMM-NMBR           CL*33
034500            WHEN DP003-GMM-NMBR-NOT-FOUND                            CL*31
034600                MOVE 'GMM NOT FOUND FOR DEPT.'                       CL*33
034700                                        TO  DP003-GMM-NAME (1:27)    CL*33
034800                MOVE RC010-DEPT-NBR     TO  DP003-GMM-NAME (29:3)    CL*33
034900                MOVE '999'              TO  DP003-GMM-NMBR           CL*33
035000            WHEN OTHER                                               CL*29
035100                DISPLAY '** ABEND **'                                CL*29
035200                DISPLAY '** PROGRAM = RCKUT038 **'                   CL*29
035300                DISPLAY '** PARAGRAPH = 1100-GET-BYR-INFO **'        CL*29
035400                DISPLAY                                              CL*29
035500                '** INVALID RETURN CODE FROM DPKUT039 **'            CL*29
035600                DISPLAY '** INPUT FIELDS: ' DP003-INPUT-FIELDS       CL*29
035700                DISPLAY '**  RETURN DATA: ' DP003-RETURN-DATA        CL*29
035800*               IF DP003-BYR-NAME-DB2-ERROR                          CL*29
035900                    DISPLAY '** SQLCA: ' DP003-SQLCA                 CL*29
036000                    DISPLAY '** SQLCODE: ' DP003-SQLCODE             CL*29
036100*               END-IF                                               CL*29
036200                MOVE +4008 TO ABEND-CODE                             CL*29
036300                CALL 'ILBOABN0' USING ABEND-CODE                     CL*29
036400        END-EVALUATE                                                 CL*29
036500     END-IF.                                                         CL*29
036600                                                                     CL*29
046900                                                                     CL**2
047000 7000-READ-RC010-IN-FILE.                                            CL**2
                                                                                
047100     READ RC010-IN-FILE INTO RC010-REC                               CL*38
047200        AT END                                                    RCKUT038
047300           SET END-OF-INPUT    TO TRUE.                           RCKUT038
047400                                                                  RCKUT038
047500     IF END-OF-INPUT                                                 CL*24
047600        CONTINUE                                                     CL*24
047700     ELSE                                                            CL*24
047800        ADD +1 TO PV-INPUT-CNT                                       CL*24
047900     END-IF.                                                         CL*24
048000                                                                  RCKUT038
048000                                                                  RCKUT038
048100 8000-WRITE-RC010-OUT-FILE.                                          CL**3
048200                                                                     CL*13
049600     MOVE DP003-BYR-NMBR             TO RC010-BUYER-NBR.             CL*13
049700     MOVE DP003-DMM-NMBR             TO RC010-DMM-NBR.               CL*13
049800     MOVE DP003-GMM-NMBR             TO RC010-GMM-NBR.               CL*13
049900     MOVE DP003-BYR-NAME             TO RC010-BUYER-NAME.            CL*13
050000     MOVE DP003-DMM-NAME             TO RC010-DMM-NAME.              CL*13
050100     MOVE DP003-GMM-NAME             TO RC010-GMM-NAME.              CL*13
050200                                                                     CL*13
051400     WRITE RC010-OUT-RECORD                                          CL*19
051500         FROM RC010-REC.                                             CL*19
051600     ADD +1 TO PV-OUTPUT-CNT.                                        CL*24
051700                                                                  RCKUT038
051800                                                                  RCKUT038
