000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.      SAKRP042.                                       00050000
000600 AUTHOR.          GAYLE HAUPT.                                    00060006
000700 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00070000
000800 DATE-WRITTEN     NOVEMBER 2000.                                  00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THE E-STORE IS INTRODUCING NEW CATEGORIES OF REVENUE THAT NEED 00120000
001300*  TO BE TRACKED IN THE GENERAL LEDGER.  FOR LAUNCH, WE WILL BE   00130000
001400*  PRODUCING A REPORT SO THAT THESE AMOUNTS CAN BE MANUALLY       00140000
001500*  ENTERED INTO THE GENERAL LEDGER.  THE REPORT WILL BE RUN ON A  00150006
001600*  WEEKLY BASIS.                                                  00160006
001700*                                                                 00170006
001800*  SAKRP042 WILL BE RUN AS PART OF THE GL PRE-EDIT AND POSTING    00180006
001900*  PROCESS.  THESE PROCESSES ARE KICKED OFF BY CICS SCREENS.  THE 00190006
002000*  PRE-EDIT IS SAKCS427 AND THE POSTING PROGRAM IS SAKCS420.      00200006
002100*                                                                 00210006
002200*   INPUT: INP01 - CONTAINS WEEK-END DATE, WHICH IS USED TO       00220006
002300*                  CALCULATE BEGINNING DATE FOR THE WEEK.         00230006
002400*  OUTPUT: RPT01 - REPORT SHOWING DAILY SUMMARIES OF SHIPPING     00240006
002500*                  SALES & RETURNS, GIFT WRAPPING SALES &         00250006
002600*                  RETURNS AND E-STORE RETURNS AT BRICK & MORTAR  00260006
002700*                  STORES.  EACH WEEK DAY IS SUMMED TO SHOW       00270006
002800*                  WEEKLY TOTALS IN THE INDIVIDUAL CATEGORIES     00280006
002900*                  STATED ABOVE.  THE REPORT HAS A PAGE BREAK     00290006
003000*                  BY STORE.  THE LAST PAGE WILL HAVE CORPORATE   00300006
003100*                  TOTALS LISTED.                                 00310006
003200*                                                                 00320006
003300***************************************************************** 00330016
003700***************************************************************** 00340006
003800*       **               2/28/01                          **      00350006
003900*       **  PLEASE NOTE:  THE TSAADSU TABLE IS NO LONGER  **      00360006
004000*       **  USED IN THIS PROGRAM--THE ORIGINAL SPECS      **      00370006
004100*       **  WERE MODIFIED TO HAVE THE PROGRAM USE TSASUM  **      00380006
004200*       **  IN ORDER TO GATHER INFORMATION FROM THE       **      00390006
004300*       **  BRICK AND MORTAR STORES.  IN ADDITION, THE    **      00400006
004400*       **  TEPPART TABLE IS NEEDED TO SELECT THE         **      00410006
004500*       **  PARTITIONS CORRESPONDING TO THE DAYS OF THE   **      00420006
004600*       **  WEEK BEING PROCESSED (THE TSASUM TABLE DOES   **      00430006
004700*       **  NOT USE SLS-DTE; IT USES PARTN-NBR).          **      00440006
004800*                                                                 00450006
004900*  THE PROGRAM READS A CONTROL CARD FILE TO GET THE WEEK-END DATE.00460006
005000*  THIS DATE IS PASSED TO THE KOHLS CALENDAR ROUTINE.  THE DATE   00470006
005100*  IS VALIDATED AND RETURNED IN DB2 DATE FORMAT.  THE WEEK        00480006
005200*  BEGINNING AND ENDING DATES WILL BE USED IN THE CURSOR FOR THE  00490006
005300*  TSAADSU TABLE TO RETURN INFORMATION FOR THE WEEK.              00500006
005400*                                                                 00510006
005500*  THE CURSOR AGAINST THE TSAADSU TABLE WILL FIND ANY STORE THAT  00520006
005600*  HAD ACTIVITY FOR ANY OF THE FIVE SPECIAL CATEGORIES (SHIPPING- 00530006
005700*  SHS, SHIPPING RETURNS-SHR, GIFT WRAPPING-GWS, GIFT WRAPPING    00540006
005800*  RETURNS-GWR AND E-COMMERCE RETURNS AT BRICK AND MORTAR STORES- 00550006
005900*  ECR) FOR THE WEEK BEING PROCESSED.                             00560006
006000*                                                                 00570006
006100*  THE REPORT WILL DETAIL THE SEVEN DAYS OF THE WEEK EVEN IF A    00580006
006200*  STORE ONLY HAD ACTIVITY IN ONE CATEGORY ON ONE DAY.            00590006
006300*                                                                 00600006
006400*  AFTER THE STORE HAS BEEN PROCESSED, A TOTAL LINE WILL PRINT    00610006
006500*  FOR EACH COLUMN ON THE REPORT.  THIS TOTAL LINE IS WHAT THE    00620006
006600*  SALES AUDIT DEPARTMENT WILL ULTIMATELY ENTER INTO THE          00630006
006700*  GENERAL LEDGER.  AFTER THE TOTAL LINE, THE REPORT WILL DO      00640006
006800*  A PAGE BREAK BEFORE STARTING ON THE NEXT STORE.  THE LAST      00650006
006900*  PAGE OF THE REPORT IS A CORPORATE TOTAL PAGE.                  00660006
007000*                                                                 00670006
007100*  THE REPORT WILL NOT PRINT IF THERE IS NO E-COMMERCE ACTIVITY   00680006
007200*  FOR THE WEEK AT ANY OF THE STORES.                             00690006
007300*                                                                 00700006
007400***************************************************************** 00710006
007500****************************************************************  00720006
007600*                                                                 00730006
007700*  CHANGED 02/28/01 BY GAYLE HAUPT                                00740006
007800*   WR# 21711  BECAUSE THE CASH OFFICE DOES NOT POPULATE TSAADSU  00750006
007900*              WITH ANY E-COMMERCE ACTIVITY FOR BRICK AND MORTAR  00760006
008000*              STORES, IT WAS DECIDED TO ACCESS E-STORE ACTIVITY  00770006
008100*              THROUGH THE TSASUM TABLE.                          00780006
008200****************************************************************  00790006
008300*  CHANGED 05/02/2001 BY MATT STIFF                               00800006
008400*                                                                 00810006
008500*  THE PROGRAM WAS NOT PICKING UP DATA FOR THE SEVENTH DAY OF THE 00820006
008600*  WEEK.  A PERFORM WAS BEIND DONE UNTIL THE INDEX EQUALED 7      00830006
008700*  INSTEAD OF IT BEING GREATER THAN 7.                            00840006
008800******************************************************************00850006
008900*  CHANGED 09/04/2001 BY GAYLE HAUPT    WR# 21811                 00860006
009000*  AUTO POST GL PROJECT--REPORT WILL NOW INCLUDE NON-MERCHANDISE  00870006
009100*  CATEGORIES, SUCH AS MANIFESTO RETURNS, POSTAGE SALES, KCK      00880006
009200*  CARDS TENDERED, SCANNING PENALTIES, ETC.  THE NAME OF THE      00890006
009300*  REPORT HAS BEEN CHANGED FROM 'SUMMARY OF E-STORE SPECIFIC      00900006
009400*  SERVICES FOR WEEK ENDING MM/DD/CCYY' TO 'SUMMARY OF SPECIAL    00910006
009500*  GL CATEGORIES FOR WEEK ENDING MM/DD/CCYY' TO MORE ACCURATELY   00920006
009600*  REFLECT THE REPORT'S NEW FUNCTIONALITY.                        00930006
009700*  A SUM OF THE CATEGORIES IS STILL NEEDED EVEN THOUGH SAKUT002   00940006
009800*  INSERTS A TOTAL REGISTER 00 ROW FOR EACH CATEGORY FOR EACH DAY,00950006
009900*  BECAUSE THERE MAY BE A ROW FOR SALES CORRECTIONS IN ADDITION   00960006
010000*  TO THE DAILY TOTALS 00 ROW.                                    00970006
010100******************************************************************00980006
010200*  CHANGED 09/29/04 BY THOMAS HANSON   WR# 27107                  00990006
010300*  XS DOMAIN CONSTRAINTS PROJECT - REPLACE TSTR000 REFERENCE      01000006
010400*  WITH XST_LOC TABLE REFERENCE WHEN RETRIEVING STORE NAME.       01010006
003400*                                                                 01020017
010500******************************************************************01030017
N2I201*  CHANGED 04/15/08 BY LYNN MCADAMS                               01040017
N2I201*  BLACK HAWK CHANGES (THIRD PARTY GIFT CARD) FOR NEXT GEN 2      01050017
003400*                                                                 01060017
010500******************************************************************01061018
082410*  CHANGED 08/24/10 BY CHERI PARMLEY                              01062018
082410*  ADDED 'BRC' TO REPORT BREAST CANCER AWARENESS SALES            01063018
003400*                                                                 01064018
P8612 ******************************************************************01070025
P8612 *  CHANGED 08/26/14 BY COGNIZANT            CHG0092405            01072033
P8612 *  ADDED 'WFC' WAYFAIR COMMISSIONS AND 'WRC' WAYFAIR RETURN       01073032
P8612 *  COMMISSIONS TO THE REPORT.                                     01074032
010500******************************************************************01075025
P8612 *  CHANGED 06/28/16 BY COGNIZANT            CHG0145354            01076040
P8612 *  ADDED A CONDITION TO THE QUERY IN 3600-GET-STORE-NAME WHERE    01077040
P8612 *  THE STORE CLOSING DATE SHOULD BE GREATER THAN OR EQUAL TO THE  01078040
P8612 *  BEGIN DATE OF THE WEEK. THIS WAS DONE TO PREVENT JOBS SAK110   01078140
P8612 *  AND SAK310 FROM ABENDING.                                      01078240
010500******************************************************************01079040
266040*  CHANGED 01/18/22 BY JIM HUNTER      CHG0266040                 01079142
266040*  BREAKING THE SHS, SHR AND ECR CATEGORIES OUT IN THE            01079242
266040*  ESTORE-ACTVTY CURSOR TO LOOK AT THE NON REGISTER ZERO NUMBERS  01079342
266040*  TO KEEP THE REPORT IN SYNC WITH GL WHEN TRANSACTIONS COME IN   01079442
266040*  LATE AFTER SAK051 SUMS THEM INTO REGISTER ZERO AND THEY DO NOT 01079542
266040*  GET INCLUDED IN THIS REPORT.                                   01079642
266040******************************************************************01079742
010600 ENVIRONMENT DIVISION.                                            01080000
010700******************************************************************01090000
010800                                                                  01100000
010900 CONFIGURATION SECTION.                                           01110000
011000                                                                  01120000
011100 SOURCE-COMPUTER.        IBM-3090.                                01130000
011200 OBJECT-COMPUTER.        IBM-3090.                                01140000
011300                                                                  01150000
011400 INPUT-OUTPUT SECTION.                                            01160000
011500                                                                  01170000
011600 FILE-CONTROL.                                                    01180000
011700                                                                  01190000
011800     SELECT WEEK-END-DATE-CARD-FILE                               01200006
011900         ASSIGN TO INP01.                                         01210000
012000                                                                  01220000
012100     SELECT KOHLS-REPORT-FILE                                     01230006
012200         ASSIGN TO RPT01.                                         01240006
012300                                                                  01250006
012400******************************************************************01260000
012500 DATA DIVISION.                                                   01270000
012600******************************************************************01280000
012700                                                                  01290000
012800 FILE SECTION.                                                    01300000
012900                                                                  01310000
013000 FD  WEEK-END-DATE-CARD-FILE                                      01320000
013100     RECORDING MODE IS F                                          01330000
013200     LABEL RECORDS ARE STANDARD                                   01340000
013300     BLOCK CONTAINS 0 RECORDS.                                    01350000
013400                                                                  01360000
013500 01  WEEK-END-DATE-CARD-RECORD   PIC X(80).                       01370006
013600                                                                  01380000
013700 FD  KOHLS-REPORT-FILE                                            01390006
013800     RECORDING MODE IS F                                          01400006
013900     BLOCK CONTAINS 0  RECORDS.                                   01410006
014000                                                                  01420006
014100 01  KOHLS-REPORT-RECORD         PIC  X(200).                     01430006
014200                                                                  01440006
014300***************************************************************** 01450000
014400 WORKING-STORAGE SECTION.                                         01460000
014500***************************************************************** 01470000
014600 01  FILLER                      PIC X(50) VALUE                  01480006
014700     ' *** WORKING STORAGE STARTS HERE FOR SAKRP042 *** '.        01490006
014800                                                                  01500000
014900******************************************************************01510006
015000* RECORD LAYOUT FOR INPUT DATE CARD (END OF WEEK DATE)            01520006
015100******************************************************************01530006
015200                                                                  01540006
015300 01  CC-CONTROL-CARD.                                             01550006
015400     05  CC-CONTROL-CARD-DISPLAY.                                 01560006
015500         10  CC-WEEK-END-DATE-ISO      PIC  X(10)  VALUE ZERO.    01570006
015600     05  FILLER                        PIC  X(70)  VALUE SPACE.   01580006
015700                                                                  01590006
015800***************************************************************** 01600006
015900*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01610006
016000***************************************************************** 01620006
016100     COPY DPWS500.                                                01630006
016200                                                                  01640006
016300 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01650006
016400                                                  COMP SYNC.      01660006
016500     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01670006
016600     88  AC-DB2-ERROR                             VALUE +4013.    01680006
016700     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    01690006
016800                                                                  01700006
016900 01  PS-PROGRAM-SWITCHES.                                         01710006
017000     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      01720006
017100         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01730006
017200     05  PS-FIRST-TIME-THRU-SW         PIC X(01)  VALUE 'N'.      01740006
017300         88  PS-FIRST-TIME-THRU                   VALUE 'Y'.      01750006
017400     05  PS-PRINT-CORP-TOTALS-SW       PIC X(01)  VALUE 'N'.      01760006
017500         88  PS-PRINT-CORP-TOTALS                 VALUE 'Y'.      01770006
017600     05  PS-END-OF-ESTORE-ACT-CUR-SW   PIC X(01)  VALUE 'N'.      01780006
017700         88  PS-END-OF-ESTORE-ACT-CUR             VALUE 'Y'.      01790006
017800                                                                  01800006
017900                                                                  01810006
018000 01  PROGRAM-CONSTANTS.                                           01820000
018100     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +62.     01830006
018200     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01840006
018300                                                   COMP SYNC.     01850006
018400     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01860006
018500                                                   'SAKRP042'.    01870006
018600     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       01880006
018700     05  PC-SUM-CTG-CDE              PIC  X(03).                  01890006
018800         88  PC-SUM-CTG-CDE-SHS                    VALUE 'SHS'.   01900006
018900         88  PC-SUM-CTG-CDE-SHR                    VALUE 'SHR'.   01910006
019000         88  PC-SUM-CTG-CDE-GWS                    VALUE 'GWS'.   01920006
019100         88  PC-SUM-CTG-CDE-GWR                    VALUE 'GWR'.   01930006
019200         88  PC-SUM-CTG-CDE-ECR                    VALUE 'ECR'.   01940006
019300         88  PC-SUM-CTG-CDE-KKB                    VALUE 'KKB'.   01950006
082410         88  PC-SUM-CTG-CDE-BRC                    VALUE 'BRC'.   01951018
019400         88  PC-SUM-CTG-CDE-KKH                    VALUE 'KKH'.   01960006
019500         88  PC-SUM-CTG-CDE-KKU                    VALUE 'KKU'.   01970006
019600         88  PC-SUM-CTG-CDE-KKS                    VALUE 'KKS'.   01980006
019700         88  PC-SUM-CTG-CDE-KKT                    VALUE 'KKT'.   01990006
019800         88  PC-SUM-CTG-CDE-MAN                    VALUE 'MAN'.   02000006
019900         88  PC-SUM-CTG-CDE-PTG                    VALUE 'PTG'.   02010006
020000         88  PC-SUM-CTG-CDE-SPN                    VALUE 'SPN'.   02020006
N2I201         88  PC-SUM-CTG-CDE-TCC                    VALUE 'TCC'.   02030017
P8612          88  PC-SUM-CTG-CDE-WFC                    VALUE 'WFC'.   02031021
P8612          88  PC-SUM-CTG-CDE-WRC                    VALUE 'WRC'.   02032021
020200                                                                  02040000
020300 01  PV-MISC-COUNT-FIELDS            COMP-3.                      02050006
020400     05  PV-PAGE-CNT                 PIC S9(05)    VALUE ZERO.    02060006
020500     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO.    02070006
020600     05  PV-LINE-CNT-AHEAD           PIC S9(03)    VALUE ZERO.    02080006
020700     05  PV-ESTORE-ACT-CUR-CNT       PIC S9(07)    VALUE ZERO.    02090006
020800                                                                  02100006
020900 01  PV-DB2-VARIABLES.                                            02110006
021000     05  PV-DB2-PARTN-NBR            PIC S9(04)    COMP           02120006
021100                                                   VALUE ZERO.    02130006
021200     05  PV-DB2-STR-NBR              PIC S9(04)    COMP           02140006
021300                                                   VALUE ZERO.    02150006
021400                                                                  02160006
021500 01  PV-ABEND-DISPLAYS.                                           02170006
021600     05  PV-ABEND-PARTN-NBR          PIC  X(04)    VALUE SPACE.   02180006
021700     05  PV-ABEND-STR-NBR            PIC  X(04)    VALUE SPACE.   02190006
021800     05  PV-ABEND-SLS-DTE-ISO        PIC  X(10)    VALUE SPACE.   02200006
021900                                                                  02210006
022000 01  PV-MISC-FIELDS.                                              02220006
022100     05  PV-PRINT-RECORD             PIC  X(200)  VALUE SPACE.    02230006
022200     05  PV-LINE-SPACING             PIC S9(04)   VALUE ZERO      02240006
022300                                                  COMP SYNC.      02250006
022400     05  PV-PARAGRAPH-NAME           PIC  X(30)   VALUE SPACE.    02260006
022500     05  PV-OPERATION-MSG-1          PIC  X(40)   VALUE SPACE.    02270006
022600     05  PV-OPERATION-MSG-2          PIC  X(40)   VALUE SPACE.    02280006
022700     05  PV-DB2-OPERATION            PIC  X(30)   VALUE SPACE.    02290006
022800     05  PV-EDIT-MASK                PIC  Z,ZZZ,ZZ9.              02300006
022900     05  PV-HOLD-STORE               PIC S9(04)   COMP            02310006
023000                                                  VALUE ZERO.     02320006
023100     05  PV-HOLD-PARTN-NBR-1         PIC S9(04)   COMP            02330006
023200                                                  VALUE ZERO.     02340006
023300     05  PV-HOLD-PARTN-NBR-2         PIC S9(04)   COMP            02350006
023400                                                  VALUE ZERO.     02360006
023500     05  PV-HOLD-PARTN-NBR-3         PIC S9(04)   COMP            02370006
023600                                                  VALUE ZERO.     02380006
023700     05  PV-HOLD-PARTN-NBR-4         PIC S9(04)   COMP            02390006
023800                                                  VALUE ZERO.     02400006
023900     05  PV-HOLD-PARTN-NBR-5         PIC S9(04)   COMP            02410006
024000                                                  VALUE ZERO.     02420006
024100     05  PV-HOLD-PARTN-NBR-6         PIC S9(04)   COMP            02430006
024200                                                  VALUE ZERO.     02440006
024300     05  PV-HOLD-PARTN-NBR-7         PIC S9(04)   COMP            02450006
024400                                                  VALUE ZERO.     02460006
024500     05  PV-CTG-AMT-TOTAL            PIC S9(9)V99 COMP-3          02470006
024600                                                  VALUE ZERO.     02480006
024700     05  PV-HOLD-DATE-ISO            PIC  X(10)   VALUE SPACE.    02490006
024800** DATE TABLE SUB - 7 OCCURS                                      02500006
024900     05  PV-DTBL-SUB                 PIC S9(04)   COMP            02510006
025000                                                  VALUE ZERO.     02520006
025100     05  PV-STR-WKLY-SHIP-SLS        PIC S9(8)V99 COMP            02530006
025200                                                  VALUE ZERO.     02540006
025300     05  PV-STR-WKLY-SHIP-RET        PIC S9(8)V99 COMP            02550006
025400                                                  VALUE ZERO.     02560006
025500     05  PV-STR-WKLY-WRAP-SLS        PIC S9(8)V99 COMP            02570006
025600                                                  VALUE ZERO.     02580006
025700     05  PV-STR-WKLY-WRAP-RET        PIC S9(8)V99 COMP            02590006
025800                                                  VALUE ZERO.     02600006
025900     05  PV-STR-WKLY-ESTORE-RET      PIC S9(8)V99 COMP            02610006
026000                                                  VALUE ZERO.     02620006
026100     05  PV-STR-WKLY-NON-MDSE-SLS    PIC S9(8)V99 COMP            02630006
026200                                                  VALUE ZERO.     02640006
026300     05  PV-STR-WKLY-SCAN-PENALTY    PIC S9(8)V99 COMP            02650006
026400                                                  VALUE ZERO.     02660006
026500     05  PV-STR-WKLY-MANFSTO-PMTS    PIC S9(8)V99 COMP            02670006
026600                                                  VALUE ZERO.     02680006
026700     05  PV-STR-WKLY-KCK-CRDS-TEND   PIC S9(8)V99 COMP            02690006
026800                                                  VALUE ZERO.     02700006
026900     05  PV-STR-WKLY-099-80-MDSE     PIC S9(8)V99 COMP            02710006
027000                                                  VALUE ZERO.     02720006
N2I201     05  PV-STR-WKLY-TPC-COMMISSIONS PIC S9(8)V99 COMP            02730017
N2I201                                                  VALUE ZERO.     02740017
P8612      05  PV-STR-WKLY-WFC-COMMISSIONS PIC S9(8)V99 COMP            02741021
P8612                                                   VALUE ZERO.     02742021
P8612      05  PV-STR-WKLY-WRC-COMMISSIONS PIC S9(8)V99 COMP            02743021
P8612                                                   VALUE ZERO.     02744021
027300     05  PV-CORP-WKLY-SHIP-SLS       PIC S9(8)V99 COMP            02750006
027400                                                  VALUE ZERO.     02760006
027500     05  PV-CORP-WKLY-SHIP-RET       PIC S9(8)V99 COMP            02770006
027600                                                  VALUE ZERO.     02780006
027700     05  PV-CORP-WKLY-WRAP-SLS       PIC S9(8)V99 COMP            02790006
027800                                                  VALUE ZERO.     02800006
027900     05  PV-CORP-WKLY-WRAP-RET       PIC S9(8)V99 COMP            02810006
028000                                                  VALUE ZERO.     02820006
028100     05  PV-CORP-WKLY-ESTORE-RET     PIC S9(8)V99 COMP            02830006
028200                                                  VALUE ZERO.     02840006
028300     05  PV-CORP-WKLY-NON-MDSE-SLS   PIC S9(8)V99 COMP            02850006
028400                                                  VALUE ZERO.     02860006
028500     05  PV-CORP-WKLY-SCAN-PENALTY   PIC S9(8)V99 COMP            02870006
028600                                                  VALUE ZERO.     02880006
028700     05  PV-CORP-WKLY-MANFSTO-PMTS   PIC S9(8)V99 COMP            02890006
028800                                                  VALUE ZERO.     02900006
028900     05  PV-CORP-WKLY-KCK-CRDS-TEND  PIC S9(8)V99 COMP            02910006
029000                                                  VALUE ZERO.     02920006
029100     05  PV-CORP-WKLY-099-80-MDSE    PIC S9(8)V99 COMP            02930006
029200                                                  VALUE ZERO.     02940006
N2I201     05  PV-CORP-WKLY-TPC-COMMISSIONS                             02950017
N2I201                                     PIC S9(8)V99 COMP            02960017
029500                                                  VALUE ZERO.     02970010
P8612      05  PV-CORP-WKLY-WFC-COMMISSIONS                             02971021
P8612                                      PIC S9(8)V99 COMP            02972021
P8612                                                   VALUE ZERO.     02973021
P8612      05  PV-CORP-WKLY-WRC-COMMISSIONS                             02974021
P8612                                      PIC S9(8)V99 COMP            02975021
P8612                                                   VALUE ZERO.     02976021
029600                                                                  02980006
029700 01  PV-STR-NBR-HEADER.                                           02990006
029800     05  FILLER                      PIC  9(01)   VALUE 1.        03000006
029900     05  PV-STR-NBR-HEADER-STR       PIC  9(04)   VALUE ZERO.     03010006
030000                                                                  03020006
030100 01  PV-DATE-AND-TIME-FIELDS.                                     03030006
030200     05  PV-SLS-DTE-CCYY-MM-DD       PIC X(10)     VALUE SPACE.   03040006
030300     05  FILLER REDEFINES PV-SLS-DTE-CCYY-MM-DD.                  03050006
030400         10  PV-SLS-DTE-CCYY         PIC 9(04).                   03060006
030500         10  FILLER                  PIC X(01).                   03070006
030600         10  PV-SLS-DTE-MM           PIC 9(02).                   03080006
030700         10  FILLER                  PIC X(01).                   03090006
030800         10  PV-SLS-DTE-DD           PIC 9(02).                   03100006
030900     05  PV-CURR-DATE-CCYYMMDD.                                   03110006
031000         10  PV-CURR-DATE-CCYY       PIC  9(04).                  03120006
031100         10  PV-CURR-DATE-MM         PIC  9(02).                  03130006
031200         10  PV-CURR-DATE-DD         PIC  9(02).                  03140006
031300     05  PV-CURR-TIME.                                            03150006
031400         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    03160006
031500         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    03170006
031600         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    03180006
031700     05  PV-WEEK-END-DATE-FMTD       PIC  X(10)    VALUE SPACE.   03190006
031800     05  PV-BEGIN-DTE                PIC  X(10)    VALUE SPACE.   03200006
031900     05  PV-END-DTE                  PIC  X(10)    VALUE SPACE.   03210006
032000     05  PV-SLS-DTE-MM-DD-CCYY.                                   03220006
032100         10  PV-SLS-DTE-MM-FMTD      PIC  X(02)    VALUE SPACE.   03230006
032200         10  FILLER                  PIC  X(01)    VALUE '/'.     03240006
032300         10  PV-SLS-DTE-DD-FMTD      PIC  X(02)    VALUE SPACE.   03250006
032400         10  FILLER                  PIC  X(01)    VALUE '/'.     03260006
032500         10  PV-SLS-DTE-CCYY-FMTD    PIC  X(04)    VALUE SPACE.   03270006
032600                                                                  03280006
032700**  THE DAILY DATE TABLE HAS 7 DATES.  THE DATES ARE FILLED       03290006
032800**  IN BASED ON THE PROCESSING WEEK.  THIS HAPPENS IN THE         03300006
032900**  1120-FILL-DATE-TABLE ROUTINE.  PV-DAILY-DATE-ISO(1) IS        03310006
033000**  THE BEGINNING WEEK DATE, PV-DAILY-DATE-ISO(7) IS THE          03320006
033100**  ENDING WEEK DATE.                                             03330006
033200**  EACH TOTALS TABLE OCCURS 7 TIMES FOR THE 7 DAYS IN THE        03340006
033300**  WEEK.                                                         03350006
033400**  2/28/01  IN ORDER TO ACCESS THE INFORMATION FROM TSASUM,      03360006
033500**  A PARTITION NUMBER IS NEEDED FOR EACH DATE.  THE PARTITION    03370006
033600**  NUMBER HAS BEEN ADDED TO THIS TABLE.                          03380006
033700 01  PV-DAILY-TABLES.                                             03390006
033800     05  PV-DAILY-DATE-TABLE.                                     03400006
033900         10  PV-DAILY-DATE-AND-PARTN OCCURS 7.                    03410006
034000             15  PV-DAILY-DATE-ISO        PIC  X(10).             03420006
034100             15  PV-DAILY-PARTN-NBR       PIC  9(04).             03430006
034200     05  PV-DAILY-STR-TOTALS-TABLE.                               03440006
034300         10  PV-DAILY-STR-TOTALS OCCURS 7.                        03450006
034400             15  PV-STR-DAILY-SHIP-SLS    PIC S9(09)V99.          03460006
034500             15  PV-STR-DAILY-SHIP-RET    PIC S9(09)V99.          03470006
034600             15  PV-STR-DAILY-WRAP-SLS    PIC S9(09)V99.          03480006
034700             15  PV-STR-DAILY-WRAP-RET    PIC S9(09)V99.          03490006
034800             15  PV-STR-DAILY-ESTORE-RET  PIC S9(09)V99.          03500006
034900             15  PV-STR-DAILY-NON-MDSE-SLS                        03510006
035000                                          PIC S9(09)V99.          03520006
035100             15  PV-STR-DAILY-SCAN-PENALTY                        03530006
035200                                          PIC S9(09)V99.          03540006
035300             15  PV-STR-DAILY-MANFSTO-PMTS                        03550006
035400                                          PIC S9(09)V99.          03560006
035500             15  PV-STR-DAILY-KCK-CRDS-TEND                       03570006
035600                                          PIC S9(09)V99.          03580006
035700             15  PV-STR-DAILY-099-80-MDSE PIC S9(09)V99.          03590006
N2I201             15  PV-STR-DAILY-TPC-COMMISSIONS                     03600017
N2I201                                          PIC S9(09)V99.          03610017
P8612              15  PV-STR-DAILY-WFC-COMMISSIONS                     03611021
P8612                                           PIC S9(09)V99.          03612021
P8612              15  PV-STR-DAILY-WRC-COMMISSIONS                     03613021
P8612                                           PIC S9(09)V99.          03614021
036000     05  PV-DAILY-CORP-TOTALS-TABLE.                              03620006
036100         10  PV-DAILY-CORP-TOTALS OCCURS 7.                       03630006
036200             15  PV-CORP-DAILY-SHIP-SLS   PIC S9(09)V99.          03640006
036300             15  PV-CORP-DAILY-SHIP-RET   PIC S9(09)V99.          03650006
036400             15  PV-CORP-DAILY-WRAP-SLS   PIC S9(09)V99.          03660006
036500             15  PV-CORP-DAILY-WRAP-RET   PIC S9(09)V99.          03670006
036600             15  PV-CORP-DAILY-ESTORE-RET PIC S9(09)V99.          03680006
036700             15  PV-CORP-DAILY-NON-MDSE-SLS                       03690006
036800                                          PIC S9(09)V99.          03700006
036900             15  PV-CORP-DAILY-SCAN-PENALTY                       03710006
037000                                          PIC S9(09)V99.          03720006
037100             15  PV-CORP-DAILY-MANFSTO-PMTS                       03730006
037200                                          PIC S9(09)V99.          03740006
037300             15  PV-CORP-DAILY-KCK-CRDS-TEND                      03750006
037400                                          PIC S9(09)V99.          03760006
037500             15  PV-CORP-DAILY-099-80-MDSE                        03770006
037600                                          PIC S9(09)V99.          03780006
N2I201             15  PV-CORP-DAILY-TPC-COMMISSIONS                    03790017
N2I201                                          PIC S9(09)V99.          03800017
P8612              15  PV-CORP-DAILY-WFC-COMMISSIONS                    03801021
P8612                                           PIC S9(09)V99.          03802021
P8612              15  PV-CORP-DAILY-WRC-COMMISSIONS                    03803021
P8612                                           PIC S9(09)V99.          03804021
037900                                                                  03810006
038000***************************************************************** 03820006
038100*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  03830006
038200***************************************************************** 03840006
038300     COPY DPWS200.                                                03850006
038400                                                                  03860006
038500******************************************************************03870006
038600*  HEADING LINES FOR WEEKLY SUMMARY OF RETURN TOLERANCE EXCEPTIONS03880006
038700******************************************************************03890006
038800 01  HL2-HEADING-LINE-2.                                          03900006
038900     05  FILLER                      PIC  X(71)    VALUE SPACE.   03910006
039000     05  FILLER                      PIC  X(32)    VALUE          03920006
039100         'SUMMARY OF SPECIAL GL CATEGORIES'.                      03930006
039200     05  FILLER                      PIC  X(17)    VALUE          03940006
039300         ' FOR WEEK ENDING '.                                     03950006
039400     05  HL2-DATE                    PIC  X(10)    VALUE SPACE.   03960006
039500     05  FILLER                      PIC  X(70)    VALUE SPACE.   03970006
039600                                                                  03980006
039700 01  HL3-HEADING-LINE-3.                                          03990006
039800     05  FILLER                      PIC  X(06)    VALUE          04000006
039900         'STORE '.                                                04010006
040000     05  HL3-STR-NBR                 PIC  X(05)    VALUE SPACE.   04020006
040100     05  FILLER                      PIC  X(03)    VALUE          04030006
040200         ' - '.                                                   04040006
040300     05  HL3-STR-NAME                PIC  X(25)    VALUE SPACE.   04050006
040400     05  FILLER                      PIC  X(93)    VALUE SPACE.   04060006
040500                                                                  04070006
040600 01  HL4-HEADING-LINE-4.                                          04080006
040700     05  FILLER                      PIC  X(09)    VALUE SPACE.   04090006
040800     05  FILLER                      PIC  X(04)    VALUE          04100006
040900         'DATE'.                                                  04110006
041000     05  FILLER                      PIC  X(11)    VALUE SPACE.   04120006
041100     05  FILLER                      PIC  X(14)    VALUE          04130006
041200         'SHIPPING SALES'.                                        04140006
041300     05  FILLER                      PIC  X(05)    VALUE SPACE.   04150006
041400     05  FILLER                      PIC  X(16)    VALUE          04160006
041500         'SHIPPING RETURNS'.                                      04170006
041600     05  FILLER                      PIC  X(05)    VALUE SPACE.   04180006
041700     05  FILLER                      PIC  X(19)    VALUE          04190006
041800         'GIFT WRAPPING SALES'.                                   04200006
041900     05  FILLER                      PIC  X(05)    VALUE SPACE.   04210006
042000     05  FILLER                      PIC  X(21)    VALUE          04220006
042100         'GIFT WRAPPING RETURNS'.                                 04230006
042200     05  FILLER                      PIC  X(04)    VALUE SPACE.   04240006
042300     05  FILLER                      PIC  X(15)    VALUE          04250006
042400         'E-STORE RETURNS'.                                       04260006
042500     05  FILLER                      PIC  X(05)    VALUE SPACE.   04270006
042600     05  FILLER                      PIC  X(14)    VALUE          04280006
042700         'NON-MDSE SALES'.                                        04290006
042800     05  FILLER                      PIC  X(05)    VALUE SPACE.   04300006
042900     05  FILLER                      PIC  X(16)    VALUE          04310006
043000         'SCANNING PENALTY'.                                      04320006
043100     05  FILLER                      PIC  X(05)    VALUE SPACE.   04330006
043200     05  FILLER                      PIC  X(18)    VALUE          04340006
043300         'MANIFESTO PAYMENTS'.                                    04350006
043400                                                                  04360006
043500 01  HL5-HEADING-LINE-5.                                          04370006
043600     05  FILLER                      PIC  X(09)    VALUE SPACE.   04380006
043700     05  FILLER                      PIC  X(04)    VALUE          04390006
043800         'DATE'.                                                  04400006
043900     05  FILLER                      PIC  X(11)    VALUE SPACE.   04410006
044000     05  FILLER                      PIC  X(14)    VALUE          04420006
044100         'KCK CARDS TEND'.                                        04430006
044200     05  FILLER                      PIC  X(07)    VALUE SPACE.   04440006
044300     05  FILLER                      PIC  X(14)    VALUE          04450006
044400         '   099/80 MDSE'.                                        04460006
044500     05  FILLER                      PIC  X(08)    VALUE SPACE.   04470013
N2I201     05  FILLER                      PIC  X(15)    VALUE          04480017
N2I201         'TPC COMMISSIONS'.                                       04490017
P8612      05  FILLER                      PIC  X(03)    VALUE SPACE.   04491023
P8612      05  FILLER                      PIC  X(23)    VALUE          04492023
P8612          'WAYFAIR COMMISSION(WFC)'.                               04493023
P8612      05  FILLER                      PIC  X(02)    VALUE SPACE.   04494023
P8612      05  FILLER                      PIC  X(20)    VALUE          04495023
P8612          'WAYFAIR RETURNS(WRC)'.                                  04496023
P8612      05  FILLER                      PIC  X(70)    VALUE SPACE.   04500026
044900                                                                  04510006
045000                                                                  04520006
045100***************************************************************** 04530006
045200*  DETAIL/TOTAL LINES PRINTED ON THE REPORT.                      04540006
045300***************************************************************** 04550006
045400 01  DL1-DETAIL-LINE-1.                                           04560006
045500     05  FILLER                      PIC  X(09)    VALUE SPACE.   04570006
045600     05  DL1-SLS-DTE                 PIC  X(10)    VALUE SPACE.   04580006
045700     05  FILLER                      PIC  X(05)    VALUE SPACE.   04590006
045800     05  DL1-SHIPPING-SLS            PIC  ZZ,ZZZ,ZZ9.99-          04600006
045900                                                   VALUE ZERO.    04610006
046000     05  FILLER                      PIC  X(07)    VALUE SPACE.   04620006
046100     05  DL1-SHIPPING-RET            PIC  ZZ,ZZZ,ZZ9.99-          04630006
046200                                                   VALUE ZERO.    04640006
046300     05  FILLER                      PIC  X(10)    VALUE SPACE.   04650006
046400     05  DL1-GIFT-WRAPPING-SLS       PIC  ZZ,ZZZ,ZZ9.99-          04660006
046500                                                   VALUE ZERO.    04670006
046600     05  FILLER                      PIC  X(12)    VALUE SPACE.   04680006
046700     05  DL1-GIFT-WRAPPING-RET       PIC  ZZ,ZZZ,ZZ9.99-          04690006
046800                                                   VALUE ZERO.    04700006
046900     05  FILLER                      PIC  X(05)    VALUE SPACE.   04710006
047000     05  DL1-ESTORE-RET              PIC  ZZ,ZZZ,ZZ9.99-          04720006
047100                                                   VALUE ZERO.    04730006
047200     05  FILLER                      PIC  X(05)    VALUE SPACE.   04740006
047300     05  DL1-NON-MDSE-SLS            PIC  ZZ,ZZZ,ZZ9.99-          04750006
047400                                                   VALUE ZERO.    04760006
047500     05  FILLER                      PIC  X(07)    VALUE SPACE.   04770006
047600     05  DL1-SCAN-PENALTY            PIC  ZZ,ZZZ,ZZ9.99-          04780006
047700                                                   VALUE ZERO.    04790006
047800     05  FILLER                      PIC  X(09)    VALUE SPACE.   04800006
047900     05  DL1-MANIFESTO-PMTS          PIC  ZZ,ZZZ,ZZ9.99-          04810006
048000                                                   VALUE ZERO.    04820006
048100     05  FILLER                      PIC  X(09)    VALUE SPACE.   04830006
048200                                                                  04840006
048300 01  DL2-DETAIL-LINE-2.                                           04850006
048400     05  FILLER                      PIC  X(09)    VALUE SPACE.   04860006
048500     05  DL2-SLS-DTE                 PIC  X(10)    VALUE SPACE.   04870006
048600     05  FILLER                      PIC  X(05)    VALUE SPACE.   04880006
048700     05  DL2-KCK-CARDS-TEND          PIC  ZZ,ZZZ,ZZ9.99-          04890006
048800                                                   VALUE ZERO.    04900006
048900     05  FILLER                      PIC  X(07)    VALUE SPACE.   04910006
049000     05  DL2-099-80-MDSE             PIC  ZZ,ZZZ,ZZ9.99-          04920006
049100                                                   VALUE ZERO.    04930006
049200     05  FILLER                      PIC  X(10)    VALUE SPACE.   04940013
N2I201     05  DL2-TPC-COMMISSIONS         PIC  ZZ,ZZZ,ZZ9.99-          04950017
N2I201                                                   VALUE ZERO.    04960017
P8612      05  FILLER                      PIC  X(12)    VALUE SPACE.   04961023
P8612      05  DL2-WFC-COMMISSIONS         PIC  ZZ,ZZZ,ZZ9.99-          04962021
P8612                                                    VALUE ZERO.    04963021
P8612      05  FILLER                      PIC  X(05)    VALUE SPACE.   04964023
P8612      05  DL2-WRC-COMMISSIONS         PIC  ZZ,ZZZ,ZZ9.99-          04965021
P8612                                                    VALUE ZERO.    04966021
P8612      05  FILLER                      PIC  X(72)    VALUE SPACE.   04970025
049600                                                                  04980010
049700                                                                  04990010
049800 01  TL1-TOTAL-LINE-1.                                            05000010
049900     05  FILLER                      PIC  X(24)    VALUE SPACE.   05010010
050000     05  FILLER                      PIC  X(14)    VALUE          05020010
050100         '--------------'.                                        05030010
050200     05  FILLER                      PIC  X(07)    VALUE SPACE.   05040010
050300     05  FILLER                      PIC  X(14)    VALUE          05050010
050400         '--------------'.                                        05060010
050500     05  FILLER                      PIC  X(10)    VALUE SPACE.   05070010
050600     05  FILLER                      PIC  X(14)    VALUE          05080010
050700         '--------------'.                                        05090010
050800     05  FILLER                      PIC  X(12)    VALUE SPACE.   05100010
050900     05  FILLER                      PIC  X(14)    VALUE          05110010
051000         '--------------'.                                        05120010
051100     05  FILLER                      PIC  X(05)    VALUE SPACE.   05130010
051200     05  FILLER                      PIC  X(14)    VALUE          05140010
051300         '--------------'.                                        05150010
051400     05  FILLER                      PIC  X(05)    VALUE SPACE.   05160010
051500     05  FILLER                      PIC  X(14)    VALUE          05170010
051600         '--------------'.                                        05180010
051700     05  FILLER                      PIC  X(07)    VALUE SPACE.   05190010
051800     05  FILLER                      PIC  X(14)    VALUE          05200010
051900         '--------------'.                                        05210010
052000     05  FILLER                      PIC  X(09)    VALUE SPACE.   05220010
052100     05  FILLER                      PIC  X(14)    VALUE          05230010
052200         '--------------'.                                        05240010
052300     05  FILLER                      PIC  X(09)    VALUE SPACE.   05250010
052400                                                                  05260010
052500 01  TL2-TOTAL-LINE-2.                                            05270010
052600     05  FILLER                      PIC  X(05)    VALUE SPACE.   05280010
052700     05  FILLER                      PIC  X(14)    VALUE          05290010
052800         'TOTAL FOR WEEK'.                                        05300010
052900     05  FILLER                      PIC  X(05)    VALUE SPACE.   05310010
053000     05  TL2-TOT-SHIP-SLS            PIC  ZZ,ZZZ,ZZ9.99-          05320010
053100                                                   VALUE ZERO.    05330010
053200     05  FILLER                      PIC  X(07)    VALUE SPACE.   05340010
053300     05  TL2-TOT-SHIP-RET            PIC  ZZ,ZZZ,ZZ9.99-          05350010
053400                                                   VALUE ZERO.    05360010
053500     05  FILLER                      PIC  X(10)    VALUE SPACE.   05370010
053600     05  TL2-TOT-GIFT-WRAP-SLS       PIC  ZZ,ZZZ,ZZ9.99-          05380010
053700                                                   VALUE ZERO.    05390010
053800     05  FILLER                      PIC  X(12)    VALUE SPACE.   05400010
053900     05  TL2-TOT-GIFT-WRAP-RET       PIC  ZZ,ZZZ,ZZ9.99-          05410010
054000                                                   VALUE ZERO.    05420010
054100     05  FILLER                      PIC  X(05)    VALUE SPACE.   05430010
054200     05  TL2-TOT-ESTORE-RET          PIC  ZZ,ZZZ,ZZ9.99-          05440010
054300                                                   VALUE ZERO.    05450010
054400     05  FILLER                      PIC  X(05)    VALUE SPACE.   05460010
054500     05  TL2-TOT-NON-MDSE-SLS        PIC  ZZ,ZZZ,ZZ9.99-          05470010
054600                                                   VALUE ZERO.    05480010
054700     05  FILLER                      PIC  X(07)    VALUE SPACE.   05490010
054800     05  TL2-TOT-SCAN-PENALTY        PIC  ZZ,ZZZ,ZZ9.99-          05500010
054900                                                   VALUE ZERO.    05510010
055000     05  FILLER                      PIC  X(09)    VALUE SPACE.   05520010
055100     05  TL2-TOT-MANIFESTO-PMTS      PIC  ZZ,ZZZ,ZZ9.99-          05530010
055200                                                   VALUE ZERO.    05540010
055300     05  FILLER                      PIC  X(09)    VALUE SPACE.   05550010
055400                                                                  05560010
055500 01  TL3-TOTAL-LINE-3.                                            05570010
055600     05  FILLER                      PIC  X(24)    VALUE SPACE.   05580010
055700     05  FILLER                      PIC  X(14)    VALUE          05590010
055800         '--------------'.                                        05600010
055900     05  FILLER                      PIC  X(07)    VALUE SPACE.   05610010
056000     05  FILLER                      PIC  X(14)    VALUE          05620010
056100         '--------------'.                                        05630010
056200     05  FILLER                      PIC  X(10)    VALUE SPACE.   05640013
056300     05  FILLER                      PIC  X(14)    VALUE          05650011
056400         '--------------'.                                        05660011
P8612      05  FILLER                      PIC  X(11)    VALUE SPACE.   05661024
P8612      05  FILLER                      PIC  X(14)    VALUE          05662021
P8612          '--------------'.                                        05663021
P8612      05  FILLER                      PIC  X(05)    VALUE SPACE.   05664024
P8612      05  FILLER                      PIC  X(14)    VALUE          05665021
P8612          '--------------'.                                        05666021
P8612      05  FILLER                      PIC  X(73)    VALUE SPACE.   05670025
056600                                                                  05680010
056700 01  TL4-TOTAL-LINE-4.                                            05690010
056800     05  FILLER                      PIC  X(05)    VALUE SPACE.   05700010
056900     05  FILLER                      PIC  X(14)    VALUE          05710010
057000         'TOTAL FOR WEEK'.                                        05720010
057100     05  FILLER                      PIC  X(05)    VALUE SPACE.   05730010
057200     05  TL4-TOT-KCK-CARDS-TEND      PIC  ZZ,ZZZ,ZZ9.99-          05740010
057300                                                   VALUE ZERO.    05750010
057400     05  FILLER                      PIC  X(07)    VALUE SPACE.   05760010
057500     05  TL4-TOT-099-80-MDSE         PIC  ZZ,ZZZ,ZZ9.99-          05770010
057600                                                   VALUE ZERO.    05780010
057700     05  FILLER                      PIC  X(10)    VALUE SPACE.   05790013
N2I201     05  TL4-TOT-TPC-COMMISSIONS     PIC  ZZ,ZZZ,ZZ9.99-          05800017
N2I201                                                   VALUE ZERO.    05810017
P8612      05  FILLER                      PIC  X(12)    VALUE SPACE.   05811024
P8612      05  TL4-TOT-WFC-COMMISSIONS     PIC  ZZ,ZZZ,ZZ9.99-          05812021
P8612                                                    VALUE ZERO.    05813021
P8612      05  FILLER                      PIC  X(05)    VALUE SPACE.   05814024
P8612      05  TL4-TOT-WRC-COMMISSIONS     PIC  ZZ,ZZZ,ZZ9.99-          05815021
P8612                                                    VALUE ZERO.    05816021
P8612      05  FILLER                      PIC  X(72)    VALUE SPACE.   05820025
058100                                                                  05830010
058200                                                                  05840010
058300***************************************************************** 05850010
058400*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            05860010
058500***************************************************************** 05870010
058600     COPY DPWS004.                                                05880010
058700                                                                  05890010
058800***************************************************************** 05900010
058900*  DB2 COMMUNICATION AREA.                                        05910010
059000***************************************************************** 05920010
059100     EXEC SQL                                                     05930010
059200          INCLUDE SQLCA                                           05940010
059300     END-EXEC.                                                    05950010
059400                                                                  05960010
059500***************************************************************** 05970010
059600*  DB2 TABLE TSASUM  - STORE SALES SUMMARY TABLE                  05980010
059700***************************************************************** 05990010
059800     EXEC SQL                                                     06000010
059900          INCLUDE TSASUM                                          06010010
060000     END-EXEC.                                                    06020010
060100                                                                  06030010
060200***************************************************************** 06040010
060300*  DB2 TABLE XST_LOC - STORE LOCATION TABLE                       06050010
060400***************************************************************** 06060010
060500     EXEC SQL                                                     06070010
060600          INCLUDE XST00001                                        06080010
060700     END-EXEC.                                                    06090010
060800                                                                  06100010
060900***************************************************************** 06110010
061000*  DB2 TABLE TEPPART - PARTITION TABLE                            06120010
061100***************************************************************** 06130010
061200     EXEC SQL                                                     06140010
061300          INCLUDE TEPPART                                         06150010
061400     END-EXEC.                                                    06160010
061500                                                                  06170010
061600***************************************************************** 06180010
061700*  ESTORE-ACTVTY CURSOR -- CURSOR TO RETRIEVE ESTORE              06190010
061800*  ACTIVITY AT BRICK AND MORTAR STORES.                           06200010
061900***************************************************************** 06210010
062000     EXEC SQL                                                     06220010
062100       DECLARE ESTORE-ACTVTY CURSOR FOR                           06230010
062200            SELECT   PARTN_NBR                                    06240010
062300                    ,STR_NBR                                      06250010
062400                    ,SUM_CTG_CDE                                  06260010
062500                    ,SUM(CTG_AMT)                                 06270010
062600              FROM   TSASUM                                       06280010
062700             WHERE   PARTN_NBR      IN (:PV-HOLD-PARTN-NBR-1,     06290010
062800                                        :PV-HOLD-PARTN-NBR-2,     06300010
062900                                        :PV-HOLD-PARTN-NBR-3,     06310010
063000                                        :PV-HOLD-PARTN-NBR-4,     06320010
063100                                        :PV-HOLD-PARTN-NBR-5,     06330010
063200                                        :PV-HOLD-PARTN-NBR-6,     06340010
063300                                        :PV-HOLD-PARTN-NBR-7)     06350010
063900              AND    SUM_TYP_CDE    IN ('D', 'S')                 06351041
266040              AND  ((SUM_CTG_CDE    IN ('GWR', 'GWS', 'KKB',      06360042
063600                                        'KKH', 'KKS', 'SPN',      06380010
063700                                        'MAN', 'KKT', 'PTG',      06390010
P8612                                         'KKU', 'TCC', 'BRC',      06400021
P8612                                         'WFC', 'WRC')             06401021
064000                     AND   RGST_ID   = 0)                         06420041
266040               OR   (SUM_CTG_CDE    IN ('SHS', 'SHR', 'ECR')      06421042
266040                     AND   RGST_ID  <> 0))                        06427042
064100          GROUP BY  STR_NBR, PARTN_NBR, SUM_CTG_CDE               06430010
064200          WITH UR                                                 06440010
064300       END-EXEC.                                                  06450010
064400                                                                  06460010
064500                                                                  06470010
064600***************************************************************** 06480010
064700* PROCEDURE DIVISION.                                           * 06490010
064800***************************************************************** 06500010
064900 PROCEDURE DIVISION.                                              06510010
065000                                                                  06520010
065100***************************************************************** 06530010
065200* 0000-MAINLINE-PARAGRAPH                                         06540010
065300*      PRODUCE DAILY OPEN TO RETURN EXCEPTION REPORT              06550010
065400***************************************************************** 06560010
065500 0000-MAINLINE-PARAGRAPH.                                         06570010
065600                                                                  06580010
065700     PERFORM 1000-INITIALIZE-PROGRAM.                             06590010
065800                                                                  06600010
065900     PERFORM 2000-OPEN-ESTORE-ACT-CURSOR.                         06610010
066000                                                                  06620010
066100     PERFORM 3000-PRODUCE-REPORT-LINES                            06630010
066200         UNTIL PS-END-OF-ESTORE-ACT-CUR.                          06640010
066300                                                                  06650010
066400     PERFORM  2200-CLOSE-ESTORE-ACT-CURSOR.                       06660010
066500                                                                  06670010
066600     IF ((PV-DAILY-STR-TOTALS-TABLE > ZERO)   OR                  06680010
066700        (PV-DAILY-STR-TOTALS-TABLE < ZERO))                       06690010
066800         PERFORM 3300-PRINT-REPORT-LINES.                         06700010
066900                                                                  06710010
067000     IF PS-PRINT-CORP-TOTALS                                      06720010
067100         PERFORM 4000-CORPORATE-TOTALS                            06730010
067200     END-IF.                                                      06740010
067300                                                                  06750010
067400                                                                  06760010
067500     DISPLAY '****************************************'           06770010
067600     DISPLAY '*************** SAKRP042 ***************'           06780010
067700     DISPLAY '****************************************'           06790010
067800     MOVE PV-ESTORE-ACT-CUR-CNT    TO PV-EDIT-MASK.               06800010
067900     INSPECT PV-EDIT-MASK REPLACING LEADING SPACE BY '.'.         06810010
068000     DISPLAY 'ESTORE ACTIVITY CURSOR ROWS FETCHED...'             06820010
068100         PV-EDIT-MASK.                                            06830010
068200     DISPLAY '****************************************'           06840010
068300     DISPLAY '****************************************'           06850010
068400     DISPLAY '****************************************'           06860010
068500                                                                  06870010
068600     STOP RUN.                                                    06880010
068700                                                                  06890010
068800                                                                  06900010
068900***************************************************************** 06910010
069000* 1000-INITIALIZE-PROGRAM                                         06920010
069100*     OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS,   06930010
069200*     INITIALIZE FIRST-TIME-THRU SWITCH, INITIALIZE TABLES.       06940010
069300***************************************************************** 06950010
069400 1000-INITIALIZE-PROGRAM.                                         06960010
069500                                                                  06970010
069600     OPEN INPUT  WEEK-END-DATE-CARD-FILE                          06980010
069700          OUTPUT KOHLS-REPORT-FILE.                               06990010
069800                                                                  07000010
069900     PERFORM 1100-PROCESS-CONTROL-CARD.                           07010010
070000                                                                  07020010
070100     PERFORM 1200-FORMAT-HEADINGS.                                07030010
070200                                                                  07040010
070300     MOVE 'Y'                      TO PS-FIRST-TIME-THRU-SW.      07050010
070400     MOVE ZERO                     TO PV-DAILY-STR-TOTALS-TABLE   07060010
070500                                      PV-DAILY-CORP-TOTALS-TABLE. 07070010
070600                                                                  07080010
070700                                                                  07090010
070800***************************************************************** 07100010
070900* 1100-PROCESS-CONTROL-CARD                                       07110010
071000*     READ CONTROL CARD TO GET POS DATE IN MMDDYY FORMAT.  CALL   07120010
071100*     DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD PROCESS DATE.  07130010
071200***************************************************************** 07140010
071300 1100-PROCESS-CONTROL-CARD.                                       07150010
071400                                                                  07160010
071500     PERFORM 1110-READ-DATE-CARD-FILE.                            07170010
071600     CLOSE WEEK-END-DATE-CARD-FILE.                               07180010
071700     IF PS-END-OF-CARD-FILE                                       07190010
071800         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   07200010
071900         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  07210010
072000         SET AC-CONTROL-CARD-ERROR TO TRUE                        07220010
072100         PERFORM 9999-ABEND                                       07230010
072200     END-IF.                                                      07240010
072300     DISPLAY PC-CURRENT-PROGRAM-NAME                              07250010
072400             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY  ')'.  07260010
072500     PERFORM 1115-CONVERT-INPUT-DATE.                             07270010
072600                                                                  07280010
072700                                                                  07290010
072800***************************************************************** 07300010
072900* 1110-READ-DATE-CARD-FILE                                        07310010
073000*     READ DATE CONTROL CARD.                                     07320010
073100***************************************************************** 07330010
073200 1110-READ-DATE-CARD-FILE.                                        07340010
073300     READ WEEK-END-DATE-CARD-FILE INTO CC-CONTROL-CARD            07350010
073400        AT END                                                    07360010
073500           SET PS-END-OF-CARD-FILE TO TRUE.                       07370010
073600                                                                  07380010
073700***************************************************************** 07390010
073800* 1115-CONVERT-INPUT-DATE                                         07400010
073900*     CALL KOHLS CALENDAR ROUTINE:                                07410010
074000*         PASS: CONTROL CARD DATE (CCYYMMDD FORMAT).              07420010
074100*       RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT). 07430010
074200***************************************************************** 07440010
074300                                                                  07450010
074400 1115-CONVERT-INPUT-DATE.                                         07460010
074500                                                                  07470010
074600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              07480010
074700                                                                  07490010
074800     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   07500010
074900     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   07510010
075000     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   07520010
075100     MOVE CC-WEEK-END-DATE-ISO         TO DPG52-LK-DATE-INPUT.    07530010
075200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07540010
075300                                             DPG54 DPG55 DPG56.   07550010
075400     EVALUATE TRUE                                                07560010
075500         WHEN DPG54-SEVERE-ERROR                                  07570010
075600         WHEN DPG54-DATE-INVALID                                  07580010
075700             MOVE '1115-CONVERT-INPUT-DATE'                       07590010
075800                                     TO PV-PARAGRAPH-NAME         07600010
075900             MOVE 'ERROR CONVERTING INPUT CARD DATE'              07610010
076000                                     TO PV-OPERATION-MSG-1        07620010
076100             SET AC-CALENDAR-ROUTINE-ERROR                        07630010
076200                                     TO TRUE                      07640010
076300             MOVE DPG54-ERROR-MESSAGE                             07650010
076400                                     TO PV-OPERATION-MSG-2        07660010
076500             PERFORM 9999-ABEND                                   07670010
076600     END-EVALUATE.                                                07680010
076700                                                                  07690010
076800     MOVE DPG55-GREG-CC-DATE-FMT     TO PV-WEEK-END-DATE-FMTD.    07700010
076900     MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO PV-BEGIN-DTE.             07710010
077000     MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PV-END-DTE.               07720010
077100                                                                  07730010
077200**  FILL THE DATE TABLE SO WE HAVE THE CORRECT DATES / PARTITIONS 07740010
077300**  FOR THE WEEK BEING PROCESSED.                                 07750010
077400     MOVE 1                          TO PV-DTBL-SUB.              07760010
077500     MOVE PV-BEGIN-DTE               TO PV-DAILY-DATE-ISO         07770010
077600                                                    (PV-DTBL-SUB).07780010
077700     PERFORM 1120-FILL-DATES-TABLE                                07790010
077800       UNTIL PV-DTBL-SUB > 7.                                     07800010
077900     MOVE PV-END-DTE                TO PV-DAILY-DATE-ISO          07810010
078000                                                   (PV-DTBL-SUB)  07820010
078100                                       PV-HOLD-DATE-ISO.          07830010
078200                                                                  07840010
078300***************************************************************** 07850010
078400*  1120-FILL-DATES-TABLE                                          07860010
078500*      FILL THE DATES TABLE WITH THE APPROPRIATE DATES FOR THE    07870010
078600*      WEEK BEING PROCESSED.                                      07880010
078700***************************************************************** 07890010
078800 1120-FILL-DATES-TABLE.                                           07900010
078900                                                                  07910010
079000**  FIND THE PARTITIONS FOR THE PREVIOUS PV-DAILY-DATE-ISO        07920010
079100**  AND STORE IT IN THE PV-DAILY-DATE-TABLE.                      07930010
079200     MOVE PV-DAILY-DATE-ISO (PV-DTBL-SUB)                         07940010
079300                                    TO PV-HOLD-DATE-ISO.          07950010
079400     PERFORM 1130-FIND-PARTITIONS.                                07960010
079500     MOVE PV-DB2-PARTN-NBR          TO PV-DAILY-PARTN-NBR         07970010
079600                                                   (PV-DTBL-SUB). 07980010
079700**  MOVE THE PARTITION NUMBER FROM THE TABLE TO PV-HOLD VARIABLES 07990010
079800**  SO THAT WE CAN USE THEM IN THE TSASUM SQL SELECT CONDITIONS.  08000010
079900     EVALUATE TRUE                                                08010010
080000         WHEN PV-DTBL-SUB           = 1                           08020010
080100             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08030010
080200                                   TO PV-HOLD-PARTN-NBR-1         08040010
080300         WHEN PV-DTBL-SUB           = 2                           08050010
080400             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08060010
080500                                   TO PV-HOLD-PARTN-NBR-2         08070010
080600         WHEN PV-DTBL-SUB           = 3                           08080010
080700             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08090010
080800                                   TO PV-HOLD-PARTN-NBR-3         08100010
080900         WHEN PV-DTBL-SUB           = 4                           08110010
081000             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08120010
081100                                   TO PV-HOLD-PARTN-NBR-4         08130010
081200         WHEN PV-DTBL-SUB           = 5                           08140010
081300             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08150010
081400                                   TO PV-HOLD-PARTN-NBR-5         08160010
081500         WHEN PV-DTBL-SUB           = 6                           08170010
081600             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08180010
081700                                   TO PV-HOLD-PARTN-NBR-6         08190010
081800         WHEN PV-DTBL-SUB           = 7                           08200010
081900             MOVE PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                08210010
082000                                   TO PV-HOLD-PARTN-NBR-7         08220010
082100     END-EVALUATE.                                                08230010
082200     ADD 1                          TO PV-DTBL-SUB.               08240010
082300     PERFORM 1125-NEXT-DAY-DATE.                                  08250010
082400                                                                  08260010
082500                                                                  08270010
082600***************************************************************** 08280010
082700*  1125-NEXT-DAY-DATE.                                            08290010
082800*      FIND THE NEXT DAY'S DATE BY USING THE KOHL'S CALENDAR      08300010
082900*      ROUTINE.                                                   08310010
083000***************************************************************** 08320010
083100 1125-NEXT-DAY-DATE.                                              08330010
083200                                                                  08340010
083300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              08350010
083400                                                                  08360010
083500     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   08370010
083600     SET  DPG51-INCREMENT-DATE         TO TRUE.                   08380010
083700     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   08390010
083800     MOVE 1                            TO DPG51-INCR-DECR-DAYS-9. 08400010
083900     MOVE PV-HOLD-DATE-ISO             TO DPG52-LK-DATE-INPUT.    08410010
084000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    08420010
084100                                             DPG54 DPG55 DPG56.   08430010
084200     EVALUATE TRUE                                                08440010
084300         WHEN DPG54-SEVERE-ERROR                                  08450010
084400         WHEN DPG54-DATE-INVALID                                  08460010
084500             MOVE '1125-NEXT-DAY-DATE'                            08470010
084600                                     TO PV-PARAGRAPH-NAME         08480010
084700             MOVE 'ERROR INCREMENTING DATE FOR NEXT DAY'          08490010
084800                                     TO PV-OPERATION-MSG-1        08500010
084900             SET AC-CALENDAR-ROUTINE-ERROR                        08510010
085000                                     TO TRUE                      08520010
085100             MOVE DPG54-ERROR-MESSAGE                             08530010
085200                                     TO PV-OPERATION-MSG-2        08540010
085300             PERFORM 9999-ABEND                                   08550010
085400     END-EVALUATE.                                                08560010
085500                                                                  08570010
085600     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-DAILY-DATE-ISO         08580010
085700                                                (PV-DTBL-SUB).    08590010
085800                                                                  08600010
085900***************************************************************** 08610010
086000*  1130-FIND-PARTITITONS                                          08620010
086100*      FIND THE PARTITIONS THAT CORRESPOND TO THE DATES IN THE    08630010
086200*      DATES TABLE.                                               08640010
086300***************************************************************** 08650010
086400 1130-FIND-PARTITIONS.                                            08660010
086500                                                                  08670010
086600     EXEC SQL                                                     08680010
086700          SELECT  PARTN_NBR                                       08690010
086800            INTO :PV-DB2-PARTN-NBR                                08700010
086900            FROM  TEPPART                                         08710010
087000           WHERE  SLS_DTE           = :PV-HOLD-DATE-ISO           08720010
087100            AND   DB_STRUC_CDE      = 'O'                         08730010
087200            AND   STR_GP_CDE        = 'A'                         08740010
087300            WITH UR                                               08750010
087400     END-EXEC.                                                    08760010
087500                                                                  08770010
087600     EVALUATE TRUE                                                08780010
087700         WHEN SQLCODE = ZERO                                      08790010
087800             CONTINUE                                             08800010
087900         WHEN SQLWARN0 NOT EQUAL SPACE                            08810010
088000         WHEN SQLCODE NOT EQUAL ZERO                              08820010
088100             MOVE '1130-GET-PARTITIONS'                           08830010
088200                                   TO PV-PARAGRAPH-NAME           08840010
088300             MOVE 'ERROR ON OPEN OF TEPPART TABLE'                08850010
088400                                   TO PV-DB2-OPERATION            08860010
088500**  MOVE CURSOR INFORMATION TO ABEND DISPLAYS                     08870010
088600             MOVE PV-DB2-PARTN-NBR  TO PV-ABEND-PARTN-NBR         08880010
088700             MOVE PV-DAILY-DATE-ISO (PV-DTBL-SUB)                 08890010
088800                                    TO PV-ABEND-SLS-DTE-ISO       08900010
088900             PERFORM 9100-SQL-ABEND                               08910010
089000     END-EVALUATE.                                                08920010
089100                                                                  08930010
089200                                                                  08940010
089300***************************************************************** 08950010
089400* 1200-FORMAT-HEADINGS                                            08960010
089500*     - GET CURRENT DATE AND TIME FROM SYSTEM.                    08970010
089600*     - FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.        08980010
089700*     - FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.            08990010
089800***************************************************************** 09000010
089900 1200-FORMAT-HEADINGS.                                            09010010
090000                                                                  09020010
090100     MOVE FUNCTION CURRENT-DATE (1:8)                             09030010
090200                                   TO PV-CURR-DATE-CCYYMMDD.      09040010
090300     ACCEPT PV-CURR-TIME FROM TIME.                               09050010
090400                                                                  09060010
090500     MOVE PV-CURR-DATE-MM          TO DP200-RUN-MONTH.            09070010
090600     MOVE PV-CURR-DATE-DD          TO DP200-RUN-DAY.              09080010
090700     MOVE PV-CURR-DATE-CCYY        TO DP200-RUN-YEAR.             09090010
090800                                                                  09100010
090900     MOVE PV-CURR-TIME-HH          TO DP200-RUN-HOUR.             09110010
091000     MOVE PV-CURR-TIME-MM          TO DP200-RUN-MINUTE.           09120010
091100     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200-PROGRAM-NAME.         09130010
091200     MOVE PC-REPORT-NBR-1          TO DP200-REPORT-NUMBER.        09140010
091300                                                                  09150010
091400     MOVE PV-WEEK-END-DATE-FMTD    TO HL2-DATE.                   09160010
091500                                                                  09170010
091600                                                                  09180010
091700***************************************************************** 09190010
091800* 2000-OPEN-ESTORE-ACT-CURSOR                                     09200010
091900*     OPEN THE ESTORE CURSOR                                      09210010
092000***************************************************************** 09220010
092100 2000-OPEN-ESTORE-ACT-CURSOR.                                     09230010
092200                                                                  09240010
092300     EXEC SQL                                                     09250010
092400         OPEN ESTORE-ACTVTY                                       09260010
092500     END-EXEC.                                                    09270010
092600                                                                  09280010
092700     EVALUATE TRUE                                                09290010
092800         WHEN SQLCODE = ZERO                                      09300010
092900             CONTINUE                                             09310010
093000         WHEN SQLWARN0 NOT EQUAL SPACE                            09320010
093100         WHEN SQLCODE NOT EQUAL ZERO                              09330010
093200             MOVE '2000-OPEN-ESTORE-ACT-CURSOR'                   09340010
093300                                   TO PV-PARAGRAPH-NAME           09350010
093400             MOVE 'ERROR ON OPEN OF ESTORE-ACTVTY CURSOR'         09360010
093500                                   TO PV-DB2-OPERATION            09370010
093600             PERFORM 9100-SQL-ABEND                               09380010
093700     END-EVALUATE.                                                09390010
093800                                                                  09400010
093900                                                                  09410010
094000***************************************************************** 09420010
094100* 2100-FETCH-ESTORE-ACT-CURSOR                                    09430010
094200*     FETCH ESTORE CURSOR                                         09440010
094300***************************************************************** 09450010
094400 2100-FETCH-ESTORE-ACT-CURSOR.                                    09460010
094500                                                                  09470010
094600     EXEC SQL                                                     09480010
094700          FETCH ESTORE-ACTVTY                                     09490010
094800           INTO  :SASUM-PARTN-NBR                                 09500010
094900                ,:SASUM-STR-NBR                                   09510010
095000                ,:SASUM-SUM-CTG-CDE                               09520010
095100                ,:PV-CTG-AMT-TOTAL                                09530010
095200     END-EXEC.                                                    09540010
095300                                                                  09550010
095400     EVALUATE TRUE                                                09560010
095500         WHEN SQLCODE = ZERO                                      09570010
095600             ADD +1                 TO PV-ESTORE-ACT-CUR-CNT      09580010
095700             MOVE SASUM-SUM-CTG-CDE TO PC-SUM-CTG-CDE             09590010
095800         WHEN SQLCODE = -305                                      09600010
095900             CONTINUE                                             09610010
096000         WHEN SQLCODE = PC-ROW-NOT-FOUND                          09620010
096100             SET PS-END-OF-ESTORE-ACT-CUR TO TRUE                 09630010
096200         WHEN SQLWARN0 NOT EQUAL SPACE                            09640010
096300         WHEN SQLCODE NOT EQUAL ZERO                              09650010
096400             MOVE '2100-FETCH-ESTORE-ACT-CURSOR'                  09660010
096500                                    TO PV-PARAGRAPH-NAME          09670010
096600             MOVE 'ERROR ON FETCH OF ESTORE-ACTVTY CURSOR'        09680010
096700                                    TO PV-DB2-OPERATION           09690010
096800**  MOVE CURSOR INFORMATION TO ABEND DISPLAYS                     09700010
096900             MOVE SASUM-STR-NBR     TO PV-ABEND-STR-NBR           09710010
097000             MOVE SASUM-PARTN-NBR   TO PV-ABEND-PARTN-NBR         09720010
097100             PERFORM 9100-SQL-ABEND                               09730010
097200     END-EVALUATE.                                                09740010
097300                                                                  09750010
097400                                                                  09760010
097500***************************************************************** 09770010
097600* 2200-CLOSE-ESTORE-ACT-CURSOR                                    09780010
097700*     CLOSE ESTORE CURSOR                                         09790010
097800***************************************************************** 09800010
097900 2200-CLOSE-ESTORE-ACT-CURSOR.                                    09810010
098000                                                                  09820010
098100     EXEC SQL                                                     09830010
098200          CLOSE ESTORE-ACTVTY                                     09840010
098300     END-EXEC.                                                    09850010
098400                                                                  09860010
098500     EVALUATE TRUE                                                09870010
098600         WHEN SQLCODE = ZERO                                      09880010
098700             CONTINUE                                             09890010
098800         WHEN SQLWARN0 NOT EQUAL SPACE                            09900010
098900         WHEN SQLCODE NOT EQUAL ZERO                              09910010
099000             MOVE '2200-CLOSE-ESTORE-ACT-CURSOR'                  09920010
099100                                    TO PV-PARAGRAPH-NAME          09930010
099200             MOVE 'ERROR ON CLOSE OF ESTORE-ACTVTY CURSOR'        09940010
099300                                    TO PV-DB2-OPERATION           09950010
099400             PERFORM 9100-SQL-ABEND                               09960010
099500     END-EVALUATE.                                                09970010
099600                                                                  09980010
099700                                                                  09990010
099800***************************************************************** 10000010
099900* 3000-PRODUCE-REPORT-LINES                                       10010010
100000*     - FETCH ESTORE CURSOR                                       10020010
100100*     - PRINT STORE DETAIL LINES                                  10030010
100200***************************************************************** 10040010
100300 3000-PRODUCE-REPORT-LINES.                                       10050010
100400                                                                  10060010
100500     PERFORM 2100-FETCH-ESTORE-ACT-CURSOR.                        10070010
100600                                                                  10080010
100700     IF PS-FIRST-TIME-THRU                                        10090010
100800         MOVE SASUM-STR-NBR          TO PV-HOLD-STORE             10100010
100900         MOVE 1                      TO PV-DTBL-SUB               10110010
101000         MOVE 'N'                    TO PS-FIRST-TIME-THRU-SW     10120010
101100     ELSE                                                         10130010
101200         IF ((SASUM-STR-NBR        NOT = PV-HOLD-STORE) AND       10140010
101300            (PV-DAILY-STR-TOTALS-TABLE > ZERO)           OR       10150010
101400            (PV-DAILY-STR-TOTALS-TABLE < ZERO))                   10160010
101500            PERFORM 3300-PRINT-REPORT-LINES                       10170010
101600         END-IF                                                   10180010
101700         MOVE SASUM-STR-NBR          TO PV-HOLD-STORE             10190010
101800         MOVE 1                      TO PV-DTBL-SUB               10200010
101900     END-IF.                                                      10210010
102000                                                                  10220010
102100**  FIND THE PARTITION IN THE TEPPART TABLE THAT MATCHES THE      10230010
102200**  SASUM-PARTN-NBR.  CONTINUE PROCESSING ONLY IF THE PARTITIONS  10240010
102300**  MATCH.                                                        10250010
102400     IF NOT PS-END-OF-ESTORE-ACT-CUR                              10260010
102500         IF (PV-CTG-AMT-TOTAL          > ZERO)   OR               10270010
102600            (PV-CTG-AMT-TOTAL          < ZERO)                    10280010
102700             MOVE 1                  TO PV-DTBL-SUB               10290010
102800             PERFORM 3200-FIND-THE-PARTITION                      10300010
102900               UNTIL PV-DAILY-PARTN-NBR (PV-DTBL-SUB)             10310010
103000                                      = SASUM-PARTN-NBR           10320010
103100                  OR PV-DTBL-SUB > 7                              10330010
103200            IF SASUM-PARTN-NBR = PV-DAILY-PARTN-NBR (PV-DTBL-SUB) 10340010
103300                EVALUATE TRUE                                     10350010
103400                   WHEN PC-SUM-CTG-CDE-SHS                        10360010
103500                         MOVE PV-CTG-AMT-TOTAL                    10370010
103600                            TO PV-STR-DAILY-SHIP-SLS (PV-DTBL-SUB)10380010
103700                   WHEN PC-SUM-CTG-CDE-SHR                        10390010
103800                         MOVE PV-CTG-AMT-TOTAL                    10400010
103900                            TO PV-STR-DAILY-SHIP-RET (PV-DTBL-SUB)10410010
104000                   WHEN PC-SUM-CTG-CDE-GWS                        10420010
104100                         MOVE PV-CTG-AMT-TOTAL                    10430010
104200                            TO PV-STR-DAILY-WRAP-SLS (PV-DTBL-SUB)10440010
104300                   WHEN PC-SUM-CTG-CDE-GWR                        10450010
104400                         MOVE PV-CTG-AMT-TOTAL                    10460010
104500                            TO PV-STR-DAILY-WRAP-RET (PV-DTBL-SUB)10470010
104600                   WHEN PC-SUM-CTG-CDE-ECR                        10480010
104700                         MOVE PV-CTG-AMT-TOTAL                    10490010
104800                          TO PV-STR-DAILY-ESTORE-RET (PV-DTBL-SUB)10500010
104900                   WHEN PC-SUM-CTG-CDE-KKB                        10510010
082410                   WHEN PC-SUM-CTG-CDE-BRC                        10511018
105000                   WHEN PC-SUM-CTG-CDE-KKH                        10520010
105100                   WHEN PC-SUM-CTG-CDE-KKU                        10530010
105200                   WHEN PC-SUM-CTG-CDE-KKS                        10540010
105300                       ADD PV-CTG-AMT-TOTAL                       10550010
105400                        TO PV-STR-DAILY-NON-MDSE-SLS (PV-DTBL-SUB)10560010
105500                   WHEN PC-SUM-CTG-CDE-SPN                        10570010
105600                       ADD PV-CTG-AMT-TOTAL                       10580010
105700                        TO PV-STR-DAILY-SCAN-PENALTY (PV-DTBL-SUB)10590010
105800                   WHEN PC-SUM-CTG-CDE-MAN                        10600010
105900                       ADD PV-CTG-AMT-TOTAL                       10610010
106000                        TO PV-STR-DAILY-MANFSTO-PMTS (PV-DTBL-SUB)10620010
106100                   WHEN PC-SUM-CTG-CDE-KKT                        10630010
106200                      ADD PV-CTG-AMT-TOTAL                        10640010
106300                       TO PV-STR-DAILY-KCK-CRDS-TEND (PV-DTBL-SUB)10650010
106400                   WHEN PC-SUM-CTG-CDE-PTG                        10660010
106500                       ADD PV-CTG-AMT-TOTAL                       10670010
106600                        TO PV-STR-DAILY-099-80-MDSE (PV-DTBL-SUB) 10680010
N2I201                   WHEN PC-SUM-CTG-CDE-TCC                        10690017
N2I201                       ADD PV-CTG-AMT-TOTAL                       10700017
N2I201                        TO PV-STR-DAILY-TPC-COMMISSIONS           10710017
N2I201                                                    (PV-DTBL-SUB) 10720017
P8612                    WHEN PC-SUM-CTG-CDE-WFC                        10721021
P8612                        ADD PV-CTG-AMT-TOTAL                       10722021
P8612                         TO PV-STR-DAILY-WFC-COMMISSIONS           10723021
P8612                                                     (PV-DTBL-SUB) 10724021
P8612                    WHEN PC-SUM-CTG-CDE-WRC                        10725021
P8612                        ADD PV-CTG-AMT-TOTAL                       10726021
P8612                         TO PV-STR-DAILY-WRC-COMMISSIONS           10727021
P8612                                                     (PV-DTBL-SUB) 10728021
107100                 END-EVALUATE                                     10730010
107200             END-IF                                               10740010
107300         END-IF                                                   10750010
107400     END-IF.                                                      10760010
107500                                                                  10770010
107600                                                                  10780010
107700***************************************************************** 10790010
107800* 3200-FIND-THE-PARTITION                                         10800010
107900*     FIND THE PARTITION IN THE PV-DAILY-DATE-TABLE THAT          10810010
108000*     MATCHES THE SASUM-PARTN-NBR.                                10820010
108100***************************************************************** 10830010
108200 3200-FIND-THE-PARTITION.                                         10840010
108300                                                                  10850010
108400     IF PV-DAILY-PARTN-NBR (PV-DTBL-SUB)                          10860010
108500                                 NOT = SASUM-PARTN-NBR            10870010
108600         ADD 1                      TO PV-DTBL-SUB                10880010
108700     END-IF.                                                      10890010
108800                                                                  10900010
108900                                                                  10910010
109000***************************************************************** 10920010
109100* 3300-PRINT-REPORT-LINES                                         10930010
109200*     PRINT THE REPORT LINES                                      10940010
109300***************************************************************** 10950010
109400 3300-PRINT-REPORT-LINES.                                         10960010
109500                                                                  10970010
109600     SET PS-PRINT-CORP-TOTALS TO TRUE.                            10980010
109700     MOVE PV-HOLD-STORE       TO PV-STR-NBR-HEADER-STR.           10990010
109800     MOVE PV-STR-NBR-HEADER   TO HL3-STR-NBR.                     11000010
109900     PERFORM 3600-GET-STORE-NAME.                                 11010010
110000     MOVE XST00001-LOC-NM     TO HL3-STR-NAME.                    11020010
110100     PERFORM 8000-PRINT-HEADINGS.                                 11030010
110200     MOVE 1                   TO PV-DTBL-SUB.                     11040010
110300     PERFORM 3700-WRITE-STORE-DAILIES                             11050010
110400       UNTIL PV-DTBL-SUB > 7.                                     11060010
110500     PERFORM 3800-WRITE-STORE-TOTALS.                             11070010
110600     PERFORM 8010-PRINT-HEADING-5.                                11080010
110700     MOVE 1                   TO PV-DTBL-SUB.                     11090010
110800     PERFORM 3710-WRITE-STORE-DAILIES-2                           11100010
110900       UNTIL PV-DTBL-SUB > 7.                                     11110010
111000     PERFORM 3810-WRITE-STORE-TOTALS-2.                           11120010
111100     MOVE ZERO                TO PV-DAILY-STR-TOTALS-TABLE.       11130010
111200     INITIALIZE                  PV-STR-WKLY-SHIP-SLS             11140010
111300                                 PV-STR-WKLY-SHIP-RET             11150010
111400                                 PV-STR-WKLY-WRAP-SLS             11160010
111500                                 PV-STR-WKLY-WRAP-RET             11170010
111600                                 PV-STR-WKLY-ESTORE-RET           11180010
111700                                 PV-STR-WKLY-NON-MDSE-SLS         11190010
111800                                 PV-STR-WKLY-SCAN-PENALTY         11200010
111900                                 PV-STR-WKLY-MANFSTO-PMTS         11210010
112000                                 PV-STR-WKLY-KCK-CRDS-TEND        11220010
112100                                 PV-STR-WKLY-099-80-MDSE          11230010
N2I201                                 PV-STR-WKLY-TPC-COMMISSIONS      11240022
P8612                                  PV-STR-WKLY-WFC-COMMISSIONS      11241022
P8612                                  PV-STR-WKLY-WRC-COMMISSIONS.     11242021
112300                                                                  11250010
112400                                                                  11260010
112500***************************************************************** 11270010
112600* 3600-GET-STORE-NAME                                             11280010
112700*     GET STORE NAME FROM THE XST_LOC TABLE                       11290010
112800***************************************************************** 11300010
112900 3600-GET-STORE-NAME.                                             11310010
113000                                                                  11320010
113100     MOVE PV-HOLD-STORE TO XST00001-LOC-NBR.                      11330010
113200                                                                  11340010
113300     EXEC SQL                                                     11350010
113400          SELECT  LOC.LOC_NM                                      11360010
113500            INTO :XST00001-LOC-NM                                 11370010
113600            FROM  XST_LOC LOC                                     11380010
113700           WHERE LOC.LOC_NBR = :XST00001-LOC-NBR                  11390010
113800             AND OPN_DTE <= :PV-WEEK-END-DATE-FMTD                11400010
INC374             AND CLO_DTE >= :PV-BEGIN-DTE                         11410037
114000          WITH UR                                                 11420010
114100     END-EXEC.                                                    11430010
114200                                                                  11440010
114300     EVALUATE TRUE                                                11450010
114400        WHEN SQLCODE = ZERO                                       11460010
114500            CONTINUE                                              11470010
114600        WHEN SQLCODE NOT EQUAL ZERO                               11480010
114700            MOVE '3600-GET-STORE-NAME'                            11490010
114800                                       TO PV-PARAGRAPH-NAME       11500010
114900            MOVE SQLCODE               TO PV-DB2-OPERATION        11510010
115000**  MOVE STORE NUMBER TO ABEND DISPLAY                            11520010
115100            MOVE PV-HOLD-STORE         TO PV-ABEND-STR-NBR        11530010
115200            PERFORM 9100-SQL-ABEND                                11540010
115300     END-EVALUATE.                                                11550010
115400                                                                  11560010
115500                                                                  11570010
115600***************************************************************** 11580010
115700* 3700-WRITE-STORE-DAILIES                                        11590010
115800*   NOTE:  WITH THE ADDITION OF NEW CATEGORIES, THIS ROUTINE      11600010
115900*          WILL PRINT THE FIRST SET OF CATEGORIES ACROSS THE      11610010
116000*          TOP OF THE REPORT PAGE.  ROUTINE 3710-WRITE-STORE-     11620010
116100*          DAILIES-2 WILL PRINT THE 2ND SET OF CATEGORIES         11630010
116200*          AFTER PRINTING WEEKLY TOTALS FOR THE 1ST SET OF        11640010
116300*          CATEGORIES.                                            11650010
116400*     MOVE AND PRINT THE INDIVIDUAL STORE TOTALS FOR EACH DAY     11660010
116500*     OF THE REPORT.  ADD DAILY TOTALS TO STORE WEEKLY TOTALS.    11670010
116600*     ADD DAILY TOTALS TO CORPORATE DAILY TOTALS.                 11680010
116700***************************************************************** 11690010
116800 3700-WRITE-STORE-DAILIES.                                        11700010
116900                                                                  11710010
117000     MOVE PV-DAILY-DATE-ISO (PV-DTBL-SUB)                         11720010
117100                                       TO PV-SLS-DTE-CCYY-MM-DD.  11730010
117200     MOVE PV-SLS-DTE-CCYY              TO PV-SLS-DTE-CCYY-FMTD.   11740010
117300     MOVE PV-SLS-DTE-MM                TO PV-SLS-DTE-MM-FMTD.     11750010
117400     MOVE PV-SLS-DTE-DD                TO PV-SLS-DTE-DD-FMTD.     11760010
117500     MOVE PV-SLS-DTE-MM-DD-CCYY        TO DL1-SLS-DTE.            11770010
117600     MOVE PV-STR-DAILY-SHIP-SLS (PV-DTBL-SUB)                     11780010
117700                                       TO DL1-SHIPPING-SLS.       11790010
117800     MOVE PV-STR-DAILY-SHIP-RET (PV-DTBL-SUB)                     11800010
117900                                       TO DL1-SHIPPING-RET.       11810010
118000     MOVE PV-STR-DAILY-WRAP-SLS (PV-DTBL-SUB)                     11820010
118100                                       TO DL1-GIFT-WRAPPING-SLS.  11830010
118200     MOVE PV-STR-DAILY-WRAP-RET (PV-DTBL-SUB)                     11840010
118300                                       TO DL1-GIFT-WRAPPING-RET.  11850010
118400     MOVE PV-STR-DAILY-ESTORE-RET (PV-DTBL-SUB)                   11860010
118500                                       TO DL1-ESTORE-RET.         11870010
118600     MOVE PV-STR-DAILY-NON-MDSE-SLS (PV-DTBL-SUB)                 11880010
118700                                       TO DL1-NON-MDSE-SLS.       11890010
118800     MOVE PV-STR-DAILY-SCAN-PENALTY (PV-DTBL-SUB)                 11900010
118900                                       TO DL1-SCAN-PENALTY.       11910010
119000     MOVE PV-STR-DAILY-MANFSTO-PMTS (PV-DTBL-SUB)                 11920010
119100                                       TO DL1-MANIFESTO-PMTS.     11930010
119200     MOVE DL1-DETAIL-LINE-1            TO PV-PRINT-RECORD.        11940010
119300     MOVE +2                           TO PV-LINE-SPACING.        11950010
119400     PERFORM 8200-WRITE-REPORT-LINE.                              11960010
119500                                                                  11970010
119600     ADD PV-STR-DAILY-SHIP-SLS (PV-DTBL-SUB)                      11980010
119700                                       TO PV-STR-WKLY-SHIP-SLS    11990010
119800                                          PV-CORP-DAILY-SHIP-SLS  12000010
119900                                                    (PV-DTBL-SUB).12010010
120000     ADD PV-STR-DAILY-SHIP-RET (PV-DTBL-SUB)                      12020010
120100                                       TO PV-STR-WKLY-SHIP-RET    12030010
120200                                          PV-CORP-DAILY-SHIP-RET  12040010
120300                                                    (PV-DTBL-SUB).12050010
120400     ADD PV-STR-DAILY-WRAP-SLS (PV-DTBL-SUB)                      12060010
120500                                       TO PV-STR-WKLY-WRAP-SLS    12070010
120600                                          PV-CORP-DAILY-WRAP-SLS  12080010
120700                                                    (PV-DTBL-SUB).12090010
120800     ADD PV-STR-DAILY-WRAP-RET (PV-DTBL-SUB)                      12100010
120900                                       TO PV-STR-WKLY-WRAP-RET    12110010
121000                                          PV-CORP-DAILY-WRAP-RET  12120010
121100                                                    (PV-DTBL-SUB).12130010
121200     ADD PV-STR-DAILY-ESTORE-RET (PV-DTBL-SUB)                    12140010
121300                                       TO PV-STR-WKLY-ESTORE-RET  12150010
121400                                          PV-CORP-DAILY-ESTORE-RET12160010
121500                                                    (PV-DTBL-SUB).12170010
121600     ADD PV-STR-DAILY-NON-MDSE-SLS (PV-DTBL-SUB)                  12180010
121700                                     TO PV-STR-WKLY-NON-MDSE-SLS  12190010
121800                                        PV-CORP-DAILY-NON-MDSE-SLS12200010
121900                                                    (PV-DTBL-SUB).12210010
122000     ADD PV-STR-DAILY-SCAN-PENALTY (PV-DTBL-SUB)                  12220010
122100                                     TO PV-STR-WKLY-SCAN-PENALTY  12230010
122200                                        PV-CORP-DAILY-SCAN-PENALTY12240010
122300                                                    (PV-DTBL-SUB).12250010
122400     ADD PV-STR-DAILY-MANFSTO-PMTS (PV-DTBL-SUB)                  12260010
122500                                     TO PV-STR-WKLY-MANFSTO-PMTS  12270010
122600                                        PV-CORP-DAILY-MANFSTO-PMTS12280010
122700                                                    (PV-DTBL-SUB).12290010
122800                                                                  12300010
122900     ADD 1                             TO PV-DTBL-SUB.            12310010
123000                                                                  12320010
123100                                                                  12330010
123200***************************************************************** 12340010
123300* 3710-WRITE-STORE-DAILIES-2                                      12350010
123400*     THIS ROUTINE WILL PRINT THE 2ND SET OF CATEGORIES AFTER     12360010
123500*     THE WEEKLY TOTALS FOR THE 1ST SET OF CATEGORIES HAVE BEEN   12370010
123600*     PRINTED.                                                    12380010
123700*     MOVE AND PRINT THE INDIVIDUAL STORE TOTALS FOR EACH DAY     12390010
123800*     OF THE REPORT.  ADD DAILY TOTALS TO STORE WEEKLY TOTALS.    12400010
123900*     ADD DAILY TOTALS TO CORPORATE DAILY TOTALS.                 12410010
124000***************************************************************** 12420010
124100 3710-WRITE-STORE-DAILIES-2.                                      12430010
124200                                                                  12440010
124300     MOVE PV-DAILY-DATE-ISO (PV-DTBL-SUB)                         12450010
124400                                       TO PV-SLS-DTE-CCYY-MM-DD.  12460010
124500     MOVE PV-SLS-DTE-CCYY              TO PV-SLS-DTE-CCYY-FMTD.   12470010
124600     MOVE PV-SLS-DTE-MM                TO PV-SLS-DTE-MM-FMTD.     12480010
124700     MOVE PV-SLS-DTE-DD                TO PV-SLS-DTE-DD-FMTD.     12490010
124800     MOVE PV-SLS-DTE-MM-DD-CCYY        TO DL2-SLS-DTE.            12500010
124900     MOVE PV-STR-DAILY-KCK-CRDS-TEND (PV-DTBL-SUB)                12510010
125000                                       TO DL2-KCK-CARDS-TEND.     12520010
125100     MOVE PV-STR-DAILY-099-80-MDSE (PV-DTBL-SUB)                  12530010
125200                                       TO DL2-099-80-MDSE.        12540010
N2I201     MOVE PV-STR-DAILY-TPC-COMMISSIONS (PV-DTBL-SUB)              12550017
N2I201                                       TO DL2-TPC-COMMISSIONS.    12560017
P8612      MOVE PV-STR-DAILY-WFC-COMMISSIONS (PV-DTBL-SUB)              12561021
P8612                                        TO DL2-WFC-COMMISSIONS.    12562021
P8612      MOVE PV-STR-DAILY-WRC-COMMISSIONS (PV-DTBL-SUB)              12563021
P8612                                        TO DL2-WRC-COMMISSIONS.    12564021
125500     MOVE DL2-DETAIL-LINE-2            TO PV-PRINT-RECORD.        12570010
125600     MOVE +2                           TO PV-LINE-SPACING.        12580010
125700     PERFORM 8200-WRITE-REPORT-LINE.                              12590010
125800                                                                  12600010
125900     ADD PV-STR-DAILY-KCK-CRDS-TEND (PV-DTBL-SUB)                 12610010
126000                                    TO PV-STR-WKLY-KCK-CRDS-TEND  12620010
126100                                       PV-CORP-DAILY-KCK-CRDS-TEND12630010
126200                                                    (PV-DTBL-SUB).12640010
126300     ADD PV-STR-DAILY-099-80-MDSE (PV-DTBL-SUB)                   12650010
126400                                    TO PV-STR-WKLY-099-80-MDSE    12660010
126500                                       PV-CORP-DAILY-099-80-MDSE  12670010
126600                                                    (PV-DTBL-SUB).12680010
N2I201     ADD PV-STR-DAILY-TPC-COMMISSIONS (PV-DTBL-SUB)               12690017
N2I201                                  TO PV-STR-WKLY-TPC-COMMISSIONS  12700017
N2I201                                     PV-CORP-DAILY-TPC-COMMISSIONS12710017
N2I201                                                    (PV-DTBL-SUB).12720017
P8612      ADD PV-STR-DAILY-WFC-COMMISSIONS (PV-DTBL-SUB)               12721021
P8612                                   TO PV-STR-WKLY-WFC-COMMISSIONS  12722021
P8612                                      PV-CORP-DAILY-WFC-COMMISSIONS12723021
P8612                                                     (PV-DTBL-SUB).12724021
P8612      ADD PV-STR-DAILY-WRC-COMMISSIONS (PV-DTBL-SUB)               12725021
P8612                                   TO PV-STR-WKLY-WRC-COMMISSIONS  12726021
P8612                                      PV-CORP-DAILY-WRC-COMMISSIONS12727021
P8612                                                     (PV-DTBL-SUB).12728021
127100                                                                  12730010
127200     ADD 1                             TO PV-DTBL-SUB.            12740010
127300                                                                  12750010
127400                                                                  12760010
127500***************************************************************** 12770010
127600* 3800-WRITE-STORE-TOTALS                                         12780010
127700*  NOTE:  WITH THE ADDITION OF NEW CATEGORIES, THIS ROUTINE       12790010
127800*         WILL PRINT THE FIRST SET OF CATEGORY TOTALS ON THE      12800010
127900*         REPORT PAGE.  ROUTINE 3810-WRITE-STORE-TOTALS-2 WILL    12810010
128000*         PRINT THE 2ND SET OF CATEGORY TOTALS AFTER PRINTING     12820010
128100*         DAILY STORE TOTALS.                                     12830010
128200*     MOVE AND PRINT THE WEEKLY STORE TOTALS.  ADD THE WEEKLY     12840010
128300*     STORE TOTALS TO THE WEEKLY CORPORATE TOTALS.                12850010
128400***************************************************************** 12860010
128500 3800-WRITE-STORE-TOTALS.                                         12870010
128600                                                                  12880010
128700     MOVE TL1-TOTAL-LINE-1             TO PV-PRINT-RECORD.        12890010
128800     MOVE +1                           TO PV-LINE-SPACING.        12900010
128900     PERFORM 8200-WRITE-REPORT-LINE.                              12910010
129000     MOVE PV-STR-WKLY-SHIP-SLS         TO TL2-TOT-SHIP-SLS.       12920010
129100     MOVE PV-STR-WKLY-SHIP-RET         TO TL2-TOT-SHIP-RET.       12930010
129200     MOVE PV-STR-WKLY-WRAP-SLS         TO TL2-TOT-GIFT-WRAP-SLS.  12940010
129300     MOVE PV-STR-WKLY-WRAP-RET         TO TL2-TOT-GIFT-WRAP-RET.  12950010
129400     MOVE PV-STR-WKLY-ESTORE-RET       TO TL2-TOT-ESTORE-RET.     12960010
129500     MOVE PV-STR-WKLY-NON-MDSE-SLS     TO TL2-TOT-NON-MDSE-SLS.   12970010
129600     MOVE PV-STR-WKLY-SCAN-PENALTY     TO TL2-TOT-SCAN-PENALTY.   12980010
129700     MOVE PV-STR-WKLY-MANFSTO-PMTS     TO TL2-TOT-MANIFESTO-PMTS. 12990010
129800     MOVE TL2-TOTAL-LINE-2             TO PV-PRINT-RECORD.        13000010
129900     MOVE +1                           TO PV-LINE-SPACING.        13010010
130000     PERFORM 8200-WRITE-REPORT-LINE.                              13020010
130100                                                                  13030010
130200     ADD PV-STR-WKLY-SHIP-SLS          TO PV-CORP-WKLY-SHIP-SLS.  13040010
130300     ADD PV-STR-WKLY-SHIP-RET          TO PV-CORP-WKLY-SHIP-RET.  13050010
130400     ADD PV-STR-WKLY-WRAP-SLS          TO PV-CORP-WKLY-WRAP-SLS.  13060010
130500     ADD PV-STR-WKLY-WRAP-RET          TO PV-CORP-WKLY-WRAP-RET.  13070010
130600     ADD PV-STR-WKLY-ESTORE-RET        TO PV-CORP-WKLY-ESTORE-RET.13080010
130700     ADD PV-STR-WKLY-NON-MDSE-SLS    TO PV-CORP-WKLY-NON-MDSE-SLS.13090010
130800     ADD PV-STR-WKLY-SCAN-PENALTY    TO PV-CORP-WKLY-SCAN-PENALTY.13100010
130900     ADD PV-STR-WKLY-MANFSTO-PMTS    TO PV-CORP-WKLY-MANFSTO-PMTS.13110010
131000                                                                  13120010
131100                                                                  13130010
131200***************************************************************** 13140010
131300* 3810-WRITE-STORE-TOTALS-2                                       13150010
131400*     THIS ROUTINE WILL PRINT THE 2ND SET OF CATEGORY TOTALS      13160010
131500*     AFTER THE DAILY TOTALS FOR THE 2ND SET OF CATEGORIES HAVE   13170010
131600*     BEEN PRINTED.                                               13180010
131700*     MOVE AND PRINT THE WEEKLY STORE TOTALS.  ADD THE WEEKLY     13190010
131800*     STORE TOTALS TO THE WEEKLY CORPORATE TOTALS.                13200010
131900***************************************************************** 13210010
132000 3810-WRITE-STORE-TOTALS-2.                                       13220010
132100                                                                  13230010
132200     MOVE TL3-TOTAL-LINE-3             TO PV-PRINT-RECORD.        13240010
132300     MOVE +1                           TO PV-LINE-SPACING.        13250010
132400     PERFORM 8200-WRITE-REPORT-LINE.                              13260010
132500     MOVE PV-STR-WKLY-KCK-CRDS-TEND    TO TL4-TOT-KCK-CARDS-TEND. 13270010
132600     MOVE PV-STR-WKLY-099-80-MDSE      TO TL4-TOT-099-80-MDSE.    13280010
N2I201     MOVE PV-STR-WKLY-TPC-COMMISSIONS  TO TL4-TOT-TPC-COMMISSIONS.13290017
P8612      MOVE PV-STR-WKLY-WFC-COMMISSIONS  TO TL4-TOT-WFC-COMMISSIONS.13291021
P8612      MOVE PV-STR-WKLY-WRC-COMMISSIONS  TO TL4-TOT-WRC-COMMISSIONS.13292021
132800     MOVE TL4-TOTAL-LINE-4             TO PV-PRINT-RECORD.        13300010
132900     MOVE +1                           TO PV-LINE-SPACING.        13310010
133000     PERFORM 8200-WRITE-REPORT-LINE.                              13320010
133100                                                                  13330010
133200     ADD PV-STR-WKLY-KCK-CRDS-TEND  TO PV-CORP-WKLY-KCK-CRDS-TEND.13340010
133300     ADD PV-STR-WKLY-099-80-MDSE    TO PV-CORP-WKLY-099-80-MDSE.  13350010
N2I201     ADD PV-STR-WKLY-TPC-COMMISSIONS                              13360017
N2I201                                 TO PV-CORP-WKLY-TPC-COMMISSIONS. 13370017
P8612      ADD PV-STR-WKLY-WFC-COMMISSIONS                              13371021
P8612                                  TO PV-CORP-WKLY-WFC-COMMISSIONS. 13372021
P8612      ADD PV-STR-WKLY-WRC-COMMISSIONS                              13373021
P8612                                  TO PV-CORP-WKLY-WRC-COMMISSIONS. 13374021
133600                                                                  13380010
133700                                                                  13390010
133800***************************************************************** 13400010
133900* 4000-CORPORATE-TOTALS                                           13410010
134000*     MOVE AND PRINT THE CORPORATE TOTALS FOR EACH DAY OF THE     13420010
134100*     REPORT.  MOVE AND PRINT THE CORPORATE TOTALS FOR THE WEEK.  13430010
134200***************************************************************** 13440010
134300 4000-CORPORATE-TOTALS.                                           13450010
134400                                                                  13460010
134500         MOVE ' ALL'                   TO HL3-STR-NBR.            13470010
134600         MOVE 'CORPORATE TOTALS'       TO HL3-STR-NAME.           13480010
134700         PERFORM 8000-PRINT-HEADINGS.                             13490010
134800         MOVE 1                        TO PV-DTBL-SUB.            13500010
134900                                                                  13510010
135000         PERFORM 4100-CORP-DAILY-TOTALS                           13520010
135100           UNTIL PV-DTBL-SUB > 7.                                 13530010
135200                                                                  13540010
135300         PERFORM 4200-CORP-WEEKLY-TOTALS.                         13550010
135400                                                                  13560010
135500         PERFORM 8010-PRINT-HEADING-5.                            13570010
135600         MOVE 1                        TO PV-DTBL-SUB.            13580010
135700                                                                  13590010
135800         PERFORM 4110-CORP-DAILY-TOTALS-2                         13600010
135900           UNTIL PV-DTBL-SUB > 7.                                 13610010
136000                                                                  13620010
136100         PERFORM 4210-CORP-WEEKLY-TOTALS-2.                       13630010
136200                                                                  13640010
136300                                                                  13650010
136400***************************************************************** 13660010
136500* 4100-CORP-DAILY-TOTALS                                          13670010
136600*     MOVE AND PRINT 1ST SET OF CORPORATE TOTAL CATEGORIES.       13680010
136700***************************************************************** 13690010
136800 4100-CORP-DAILY-TOTALS.                                          13700010
136900                                                                  13710010
137000     MOVE PV-DAILY-DATE-ISO (PV-DTBL-SUB)                         13720010
137100                                       TO PV-SLS-DTE-CCYY-MM-DD.  13730010
137200     MOVE PV-SLS-DTE-CCYY              TO PV-SLS-DTE-CCYY-FMTD.   13740010
137300     MOVE PV-SLS-DTE-MM                TO PV-SLS-DTE-MM-FMTD.     13750010
137400     MOVE PV-SLS-DTE-DD                TO PV-SLS-DTE-DD-FMTD.     13760010
137500     MOVE PV-SLS-DTE-MM-DD-CCYY        TO DL1-SLS-DTE.            13770010
137600     MOVE PV-CORP-DAILY-SHIP-SLS (PV-DTBL-SUB)                    13780010
137700                                       TO DL1-SHIPPING-SLS.       13790010
137800     MOVE PV-CORP-DAILY-SHIP-RET (PV-DTBL-SUB)                    13800010
137900                                       TO DL1-SHIPPING-RET.       13810010
138000     MOVE PV-CORP-DAILY-WRAP-SLS (PV-DTBL-SUB)                    13820010
138100                                       TO DL1-GIFT-WRAPPING-SLS.  13830010
138200     MOVE PV-CORP-DAILY-WRAP-RET (PV-DTBL-SUB)                    13840010
138300                                       TO DL1-GIFT-WRAPPING-RET.  13850010
138400     MOVE PV-CORP-DAILY-ESTORE-RET (PV-DTBL-SUB)                  13860010
138500                                       TO DL1-ESTORE-RET.         13870010
138600     MOVE PV-CORP-DAILY-NON-MDSE-SLS (PV-DTBL-SUB)                13880010
138700                                       TO DL1-NON-MDSE-SLS.       13890010
138800     MOVE PV-CORP-DAILY-SCAN-PENALTY (PV-DTBL-SUB)                13900010
138900                                       TO DL1-SCAN-PENALTY.       13910010
139000     MOVE PV-CORP-DAILY-MANFSTO-PMTS (PV-DTBL-SUB)                13920010
139100                                       TO DL1-MANIFESTO-PMTS.     13930010
139200     MOVE DL1-DETAIL-LINE-1            TO PV-PRINT-RECORD.        13940010
139300     MOVE +2                           TO PV-LINE-SPACING.        13950010
139400     PERFORM 8200-WRITE-REPORT-LINE.                              13960010
139500                                                                  13970010
139600     ADD 1                             TO PV-DTBL-SUB.            13980010
139700                                                                  13990010
139800                                                                  14000010
139900***************************************************************** 14010010
140000* 4110-CORP-DAILY-TOTALS                                          14020010
140100*     MOVE AND PRINT 2ND SET OF CORPORATE TOTAL CATEGORIES.       14030010
140200***************************************************************** 14040010
140300 4110-CORP-DAILY-TOTALS-2.                                        14050010
140400                                                                  14060010
140500     MOVE PV-DAILY-DATE-ISO (PV-DTBL-SUB)                         14070010
140600                                       TO PV-SLS-DTE-CCYY-MM-DD.  14080010
140700     MOVE PV-SLS-DTE-CCYY              TO PV-SLS-DTE-CCYY-FMTD.   14090010
140800     MOVE PV-SLS-DTE-MM                TO PV-SLS-DTE-MM-FMTD.     14100010
140900     MOVE PV-SLS-DTE-DD                TO PV-SLS-DTE-DD-FMTD.     14110010
141000     MOVE PV-SLS-DTE-MM-DD-CCYY        TO DL2-SLS-DTE.            14120010
141100     MOVE PV-CORP-DAILY-KCK-CRDS-TEND (PV-DTBL-SUB)               14130010
141200                                       TO DL2-KCK-CARDS-TEND.     14140010
141300     MOVE PV-CORP-DAILY-099-80-MDSE (PV-DTBL-SUB)                 14150010
141400                                       TO DL2-099-80-MDSE.        14160010
N2I201     MOVE PV-CORP-DAILY-TPC-COMMISSIONS (PV-DTBL-SUB)             14170017
N2I201                                       TO DL2-TPC-COMMISSIONS.    14180017
P8612      MOVE PV-CORP-DAILY-WFC-COMMISSIONS (PV-DTBL-SUB)             14181021
P8612                                        TO DL2-WFC-COMMISSIONS.    14182021
P8612      MOVE PV-CORP-DAILY-WRC-COMMISSIONS (PV-DTBL-SUB)             14183021
P8612                                        TO DL2-WRC-COMMISSIONS.    14184021
141700     MOVE DL2-DETAIL-LINE-2            TO PV-PRINT-RECORD.        14190010
141800     MOVE +2                           TO PV-LINE-SPACING.        14200010
141900     PERFORM 8200-WRITE-REPORT-LINE.                              14210010
142000                                                                  14220010
142100     ADD 1                             TO PV-DTBL-SUB.            14230010
142200                                                                  14240010
142300                                                                  14250010
142400***************************************************************** 14260010
142500* 4200-CORP-WEEKLY-TOTALS                                         14270010
142600*     MOVE AND WRITE 1ST SET OF CORPORATE TOTAL CATEGORIES.       14280010
142700***************************************************************** 14290010
142800 4200-CORP-WEEKLY-TOTALS.                                         14300010
142900                                                                  14310010
143000     MOVE TL1-TOTAL-LINE-1             TO PV-PRINT-RECORD.        14320010
143100     MOVE +1                           TO PV-LINE-SPACING.        14330010
143200     PERFORM 8200-WRITE-REPORT-LINE.                              14340010
143300     MOVE PV-CORP-WKLY-SHIP-SLS        TO TL2-TOT-SHIP-SLS.       14350010
143400     MOVE PV-CORP-WKLY-SHIP-RET        TO TL2-TOT-SHIP-RET.       14360010
143500     MOVE PV-CORP-WKLY-WRAP-SLS        TO TL2-TOT-GIFT-WRAP-SLS.  14370010
143600     MOVE PV-CORP-WKLY-WRAP-RET        TO TL2-TOT-GIFT-WRAP-RET.  14380010
143700     MOVE PV-CORP-WKLY-ESTORE-RET      TO TL2-TOT-ESTORE-RET.     14390010
143800     MOVE PV-CORP-WKLY-NON-MDSE-SLS    TO TL2-TOT-NON-MDSE-SLS.   14400010
143900     MOVE PV-CORP-WKLY-SCAN-PENALTY    TO TL2-TOT-SCAN-PENALTY.   14410010
144000     MOVE PV-CORP-WKLY-MANFSTO-PMTS    TO TL2-TOT-MANIFESTO-PMTS. 14420010
144100     MOVE TL2-TOTAL-LINE-2             TO PV-PRINT-RECORD.        14430010
144200     MOVE +1                           TO PV-LINE-SPACING.        14440010
144300     PERFORM 8200-WRITE-REPORT-LINE.                              14450010
144400                                                                  14460010
144500                                                                  14470010
144600***************************************************************** 14480010
144700* 4210-CORP-WEEKLY-TOTALS-2                                       14490010
144800*     MOVE AND WRITE 2ND SET OF CORPORATE TOTAL CATEGORIES.       14500010
144900***************************************************************** 14510010
145000 4210-CORP-WEEKLY-TOTALS-2.                                       14520010
145100                                                                  14530010
145200     MOVE TL3-TOTAL-LINE-3             TO PV-PRINT-RECORD.        14540010
145300     MOVE +1                           TO PV-LINE-SPACING.        14550010
145400     PERFORM 8200-WRITE-REPORT-LINE.                              14560010
145500     MOVE PV-CORP-WKLY-KCK-CRDS-TEND   TO TL4-TOT-KCK-CARDS-TEND. 14570010
145600     MOVE PV-CORP-WKLY-099-80-MDSE     TO TL4-TOT-099-80-MDSE.    14580010
N2I201     MOVE PV-CORP-WKLY-TPC-COMMISSIONS TO TL4-TOT-TPC-COMMISSIONS.14590017
P8612      MOVE PV-CORP-WKLY-WFC-COMMISSIONS TO TL4-TOT-WFC-COMMISSIONS.14591021
P8612      MOVE PV-CORP-WKLY-WRC-COMMISSIONS TO TL4-TOT-WRC-COMMISSIONS.14592021
145800     MOVE TL4-TOTAL-LINE-4             TO PV-PRINT-RECORD.        14600010
145900     MOVE +1                           TO PV-LINE-SPACING.        14610010
146000     PERFORM 8200-WRITE-REPORT-LINE.                              14620010
146100                                                                  14630010
146200                                                                  14640010
146300***************************************************************** 14650010
146400* 8000-PRINT-HEADINGS                                             14660010
146500*     PRINT THE HEADINGS FOR THE REPORT                           14670010
146600***************************************************************** 14680010
146700 8000-PRINT-HEADINGS.                                             14690010
146800                                                                  14700010
146900     ADD +1                        TO PV-PAGE-CNT.                14710010
147000     MOVE PV-PAGE-CNT TO DP200-PAGE-NUMBER.                       14720010
147100     MOVE DP200-STANDRD-HEADER-200-COLS                           14730010
147200                                   TO PV-PRINT-RECORD.            14740010
147300     PERFORM 8100-WRITE-RPT-TOP-OF-PAGE.                          14750010
147400                                                                  14760010
147500     MOVE HL2-HEADING-LINE-2       TO PV-PRINT-RECORD.            14770010
147600     MOVE +1                       TO PV-LINE-SPACING.            14780010
147700     PERFORM 8200-WRITE-REPORT-LINE.                              14790010
147800                                                                  14800010
147900     MOVE +2                       TO PV-LINE-SPACING.            14810010
148000     MOVE HL3-HEADING-LINE-3       TO PV-PRINT-RECORD.            14820010
148100     PERFORM 8200-WRITE-REPORT-LINE.                              14830010
148200                                                                  14840010
148300     MOVE +2                       TO PV-LINE-SPACING.            14850010
148400     MOVE HL4-HEADING-LINE-4       TO PV-PRINT-RECORD.            14860010
148500     PERFORM 8200-WRITE-REPORT-LINE.                              14870010
148600                                                                  14880010
148700                                                                  14890010
148800***************************************************************** 14900010
148900* 8010-PRINT-HEADING-5                                            14910010
149000*     PRINT HEADING LINE 5 FOR THE REPORT.                        14920010
149100***************************************************************** 14930010
149200 8010-PRINT-HEADING-5.                                            14940010
149300                                                                  14950010
149400     MOVE +3                       TO PV-LINE-SPACING.            14960010
149500     MOVE HL5-HEADING-LINE-5       TO PV-PRINT-RECORD.            14970010
149600     PERFORM 8200-WRITE-REPORT-LINE.                              14980010
149700                                                                  14990010
149800                                                                  15000010
149900***************************************************************** 15010010
150000* 8100-WRITE-RPT-TOP-OF-PAGE                                      15020010
150100*     WRITE FIRST REPORT LINE AFTER PAGE BREAK                    15030010
150200***************************************************************** 15040010
150300 8100-WRITE-RPT-TOP-OF-PAGE.                                      15050010
150400                                                                  15060010
150500     WRITE KOHLS-REPORT-RECORD                                    15070010
150600       FROM PV-PRINT-RECORD                                       15080010
150700         AFTER ADVANCING PAGE.                                    15090010
150800     MOVE +1                       TO PV-LINE-CNT.                15100010
150900                                                                  15110010
151000                                                                  15120010
151100***************************************************************** 15130010
151200* 8200-WRITE-REPORT-LINE                                          15140010
151300*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             15150010
151400***************************************************************** 15160010
151500 8200-WRITE-REPORT-LINE.                                          15170010
151600                                                                  15180010
151700     WRITE KOHLS-REPORT-RECORD                                    15190010
151800       FROM PV-PRINT-RECORD                                       15200010
151900        AFTER ADVANCING PV-LINE-SPACING.                          15210010
152000                                                                  15220010
152100     ADD PV-LINE-SPACING            TO PV-LINE-CNT.               15230010
152200                                                                  15240010
152300                                                                  15250010
152400***************************************************************** 15260010
152500* 9100-SQL-ABEND                                                  15270010
152600*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.15280010
152700***************************************************************** 15290010
152800 9100-SQL-ABEND.                                                  15300010
152900     DISPLAY '** ABEND     **'.                                   15310010
153000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        15320010
153100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              15330010
153200     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               15340010
153300     DISPLAY '** SALES DTE ** = ' PV-ABEND-SLS-DTE-ISO.           15350010
153400     DISPLAY '** STORE NBR ** = ' PV-ABEND-STR-NBR.               15360010
153500     DISPLAY '** PARTN NBR ** = ' PV-ABEND-PARTN-NBR.             15370010
153600                                                                  15380010
153700***************************************************************** 15390010
153800* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     15400010
153900* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      15410010
154000***************************************************************** 15420010
154100     COPY DPPD004.                                                15430010
154200                                                                  15440010
154300     SET AC-DB2-ERROR TO TRUE.                                    15450010
154400     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         15460010
154500                                                                  15470010
154600                                                                  15480010
154700***************************************************************** 15490010
154800* 9999-ABEND                                                      15500010
154900*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  15510010
155000***************************************************************** 15520010
155100 9999-ABEND.                                                      15530010
155200     DISPLAY '** ABEND           **'.                             15540010
155300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  15550010
155400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        15560010
155500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       15570010
155600     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       15580010
155700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         15590010
