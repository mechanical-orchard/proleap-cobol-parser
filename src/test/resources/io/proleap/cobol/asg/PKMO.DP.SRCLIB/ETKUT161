000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    ETKUT161.                                         00020000
000300 AUTHOR.        JEAN KURK.                                        00030000
000400 DATE-WRITTEN.  JUNE 2023.                                        00040000
000500 DATE-COMPILED.                                                   00050000
000600***************************************************************** 00060000
000700*     SPLIT OFF THE DATA FOR VENDOR CLAIRES FROM THE EDI 850    * 00070000
000800***************************************************************** 00080000
001100*                                                               * 00090000
001200*    THE PURPOSE OF THIS PROGRAM IS TO CREATE AN INVOICE FILE   * 00100000
001300*    FOR CLAIRES, FROM THE EDI 852 - SALES BY STORE             * 00110000
001400*                                                               * 00120000
001500*    INPUT:  EDI 852                       LRECL 150   ETRD019  * 00130000
001600*    OUTPUT: EDI 852 (CLAIRES ONLY)        LRECL 150   ETRD019  * 00140000
001700***************************************************************** 00150000
001800* CHANGE RECORD:                                                * 00160000
001900*                                                               * 00170000
002000* 06/21/2023                                                    * 00180000
002100*      INITIAL VERSION                                          * 00190000
002500* MADE BY: JEAN KURK                             CHG0289911     * 00200000
002600*                                                               * 00210000
004900***************************************************************** 00220000
005000 ENVIRONMENT DIVISION.                                            00230000
005100                                                                  00240000
005200 INPUT-OUTPUT SECTION.                                            00250000
005300 FILE-CONTROL.                                                    00260000
005400                                                                  00270000
005500     SELECT INPUT-EDI-852        ASSIGN TO UT-S-INP01.            00280000
005600     SELECT OUTPUT-EDI-852       ASSIGN TO UT-S-OUT01.            00290000
005700                                                                  00300000
005800 DATA DIVISION.                                                   00310000
005900                                                                  00320000
006000 FILE SECTION.                                                    00330000
006100                                                                  00340000
006200 FD  INPUT-EDI-852                                                00350000
006300     LABEL RECORDS ARE OMITTED                                    00360000
006400     RECORDING MODE IS F                                          00370000
006500     RECORD CONTAINS 150 CHARACTERS                               00380000
006600     BLOCK CONTAINS 0 RECORDS.                                    00390000
006700 01  EDI852-IN-RECORD               PIC X(150).                   00400000
006800                                                                  00410000
006900 FD  OUTPUT-EDI-852                                               00420000
007000     LABEL RECORDS ARE STANDARD                                   00430000
007100     RECORDING MODE IS F                                          00440000
007200     BLOCK CONTAINS 0 RECORDS.                                    00450000
007300 01  EDI852-OUT-RECORD              PIC X(150).                   00460000
007500                                                                  00470000
007600                                                                  00480000
007700 WORKING-STORAGE SECTION.                                         00490000
007800                                                                  00500000
007900 01  PROGRAM-COUNTERS.                                            00510000
008000     05  PC-RECORDS-IN              PIC S9(09) COMP-3 VALUE +0.   00520000
008100     05  PC-RECORDS-OUT             PIC S9(09) COMP-3 VALUE +0.   00530000
008300     05  PC-COUNT-PRT               PIC  Z(8)9 VALUE ZERO.        00540001
008600                                                                  00550000
008700 01  PROGRAM-SWITCHES.                                            00560000
008800     05  PS-INPUT-EOF-SW            PIC X  VALUE 'N'.             00570000
008900         88  PS-INPUT-EOF-N                VALUE 'N'.             00580000
009000         88  PS-INPUT-E0F-Y                VALUE 'Y'.             00590000
008800     05  PS-CLAIRES-REC-SW          PIC X  VALUE 'N'.             00600000
008900         88  PS-CLAIRES-REC-N              VALUE 'N'.             00610000
009000         88  PS-CLAIRES-REC-Y              VALUE 'Y'.             00620000
009100                                                                  00630000
009200 01  PROGRAM-CONSTANTS.                                           00640000
009300     05  PC-PROGRAM-NAME            PIC X(08) VALUE 'ETKUT161'.   00650000
009300     05  PC-CLAIRES-ENTID           PIC  S9(9) COMP               00660000
009300                                              VALUE 232413.       00670000
009400                                                                  00680000
009500*--------------------------------------------------------------*  00690000
009600*  RECORD LAYOUT FOR EDI 852 - INPUT AND OUTPUT RECORD         *  00700000
009700*--------------------------------------------------------------*  00710000
009800     COPY ETRD019.                                                00720000
010000                                                                  00730000
010000                                                                  00740000
010700************************                                          00750000
010800 PROCEDURE DIVISION.                                              00760000
010900************************                                          00770000
011000 A100-MAINLINE-ROUTINE.                                           00780000
011100                                                                  00790000
011200     PERFORM B100-INITIALIZATION.                                 00800000
011300                                                                  00810000
011400     PERFORM B200-CREATE-FILE                                     00820000
011500         UNTIL PS-INPUT-E0F-Y.                                    00830000
011600                                                                  00840000
011700     PERFORM B300-TERMINATION.                                    00850000
011800     GOBACK.                                                      00860000
011900                                                                  00870000
012000                                                                  00880000
012100*--------------------------------------------------------------*  00890000
012200*    INITIALIZATION PROCESSING                                 *  00900000
012300*--------------------------------------------------------------*  00910000
012400 B100-INITIALIZATION.                                             00920000
012500                                                                  00930000
012600     DISPLAY '*------------ PROGRAM:  ETKUT161 ------------*'     00940000
012700     DISPLAY '  RUN DATE = ' FUNCTION CURRENT-DATE(1:8)           00950000
012900                                                                  00960000
013000     OPEN INPUT INPUT-EDI-852                                     00970000
013100         OUTPUT OUTPUT-EDI-852.                                   00980000
013200                                                                  00990000
013300     INITIALIZE ET019-PRODUCT-ACTIVITY-RECORD.                    01000000
014700                                                                  01010000
014800     PERFORM R100-READ-INPUT-FILE.                                01020000
014900                                                                  01030000
015000                                                                  01040000
015100*--------------------------------------------------------------*  01050000
015200*  THIS ROUTINE WILL DETERMINE IF THE RECORD IS FOR CLAIRES    *  01060000
015300*--------------------------------------------------------------*  01070000
015400 B200-CREATE-FILE.                                                01080000
015500                                                                  01090000
015600     IF PS-CLAIRES-REC-Y                                          01100000
022500         PERFORM W100-WRITE-OUTPUT-RECORD                         01110000
022600     END-IF.                                                      01120000
022700                                                                  01130000
022800     PERFORM R100-READ-INPUT-FILE.                                01140000
022900                                                                  01150000
023000                                                                  01160000
023100*---------------------------------------------------------------* 01170000
023200*  END OF PROGRAM PROCESSING:                                   * 01180000
023300*---------------------------------------------------------------* 01190000
023400 B300-TERMINATION.                                                01200000
023500                                                                  01210000
023900     DISPLAY '************************************************'.  01220000
024000     DISPLAY '****              ETKUT161                  ****'.  01230000
024100     DISPLAY '************************************************'.  01240000
023600     MOVE PC-RECORDS-IN           TO PC-COUNT-PRT.                01250000
024200     DISPLAY 'EDI 852 RECORDS IN   = ' PC-COUNT-PRT.              01260000
023600     MOVE PC-RECORDS-OUT          TO PC-COUNT-PRT.                01270000
024300     DISPLAY 'EDI 852 RECORDS OUT  = ' PC-COUNT-PRT.              01280000
024500     DISPLAY '************************************************'.  01290000
024600     DISPLAY '************************************************'.  01300000
024700                                                                  01310000
013000     CLOSE INPUT-EDI-852                                          01320000
013100           OUTPUT-EDI-852.                                        01330000
025200                                                                  01340000
025300*--------------------------------------------------------------*  01350000
025400*  READS THE TRANS INTERNATIONAL FILE                          *  01360000
025500*--------------------------------------------------------------*  01370000
025600 R100-READ-INPUT-FILE.                                            01380000
025700                                                                  01390000
025800     READ INPUT-EDI-852 INTO ET019-PRODUCT-ACTIVITY-RECORD        01400000
025900        AT END                                                    01410000
026000            SET PS-INPUT-E0F-Y TO TRUE                            01420000
026100        NOT AT END                                                01430000
026200            ADD 1              TO PC-RECORDS-IN                   01440000
026200            IF ET019-HEADER-RECORD                                01450000
026200                IF ET019-ENT-ID = PC-CLAIRES-ENTID                01460000
026200                    SET PS-CLAIRES-REC-Y TO TRUE                  01470000
026200                ELSE                                              01480000
026200                    SET PS-CLAIRES-REC-N TO TRUE                  01490000
026200                END-IF                                            01500000
026200            END-IF                                                01510000
026300     END-READ.                                                    01520000
026400                                                                  01530000
026500                                                                  01540000
026600*--------------------------------------------------------------*  01550000
026700*  WRITES THE OUTPUT RECORD                                    *  01560000
026800*--------------------------------------------------------------*  01570000
026900 W100-WRITE-OUTPUT-RECORD.                                        01580000
027000                                                                  01590000
027100     ADD 1 TO PC-RECORDS-OUT.                                     01600000
027200                                                                  01610000
027300     WRITE EDI852-OUT-RECORD FROM ET019-PRODUCT-ACTIVITY-RECORD.  01620000
027400                                                                  01630000
027600                                                                  01640000
