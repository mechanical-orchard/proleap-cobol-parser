000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400 PROGRAM-ID.    XLKUT018.                                         00040001
000500 AUTHOR.        AL PETERS.                                        00050001
000600 INSTALLATION.  KOHLS.                                            00060001
000700 DATE-WRITTEN   JANUARY 2003.                                     00070001
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  THIS PROGRAM WILL REFORMAT THE LOGISTICS VENDOR UPC DOMAIN   * 00100001
001100*  TABLE DATA INTO LOGISTICS DOMAIN UPC LAYOUT (XLRD010)        *       01
001400***************************************************************** 00140001
001500 ENVIRONMENT DIVISION.                                            00150001
001600 INPUT-OUTPUT SECTION.                                            00160001
001700                                                                  00170001
001800 FILE-CONTROL.                                                    00180001
001900                                                                  00190001
002000     SELECT LOGUNLD-UPC-FILE                                      00200001
002010         ASSIGN TO INP01.                                         00201001
002100                                                                  00210001
002110     SELECT LOGISTIC-UPC-FILE                                     00200001
002120         ASSIGN TO OUT01.                                               01
002130                                                                  00210001
002200***************************************************************** 00220001
002300 DATA DIVISION.                                                   00230001
002400***************************************************************** 00240001
002500 FILE SECTION.                                                    00250001
002600                                                                  00260001
002700 FD  LOGUNLD-UPC-FILE                                             00270001
002800     RECORDING MODE IS F                                          00280001
002810     BLOCK CONTAINS 0 RECORDS                                     00281001
002900     LABEL RECORDS ARE STANDARD.                                  00290001
003000                                                                  00300001
003300 01  LOGUNLD-UPC-RECORD           PIC X(030).                     00330001
003700                                                                  00370001
003710 FD  LOGISTIC-UPC-FILE                                            00270001
003720     RECORDING MODE IS F                                          00280001
003730     BLOCK CONTAINS 0 RECORDS                                     00281001
003740     LABEL RECORDS ARE STANDARD.                                  00290001
003750                                                                  00300001
003760 01  LOGISTIC-UPC-RECORD          PIC X(150).                     00330001
003770                                                                  00370001
003800                                                                  00380001
003900***************************************************************** 00390001
004000 WORKING-STORAGE SECTION.                                         00400001
004100                                                                  00410001
004200 01  PS-PROGRAM-SWITCHES.                                         00420001
004300     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00430001
004400         88  PS-EOF-INPUT-YES                    VALUE 'Y'.       00440001
004500         88  PS-EOF-INPUT-NO                     VALUE 'N'.       00450001
004600                                                                  00460001
004700 01  PC-PROGRAM-CONSTANTS.                                        00470001
004800     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT018'.00480001
005000                                                                  00500001
005100 01  PV-PROGRAM-VARIABLES.                                        00510001
005900     05  PV-RECORDS-READ              PIC  9(09) VALUE  0.        00590001
006000     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        00600001
006900                                                                  00690001
007000                                                                  00700001
007100 01  PV-ABEND-FIELDS.                                             00710001
007200     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         00720001
007300                                                 COMP SYNC.       00730001
007400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT018'.00740001
007500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00750001
007600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00760001
008200                                                                  00820001
       01  PV-INPUT-RECORD.                                                     
           05 PV-UPC-ID                     PIC  S9(9) COMP.                    
           05 PV-INTR-UPC-ID                PIC  S9(9) COMP.                    
           05 PV-UPC-TYP-CDE                PIC  X(01).                         
           05 PV-EDI-ORD-IND                PIC  X(01).                         
           05 PV-CERTD-IND                  PIC  X(01).                         
           05 PV-CERTD-DTE                  PIC  X(10).                         
           05 PV-UPC-NBR                    PIC  S9(15)V COMP-3.                
           05 PV-PREPK-IND                  PIC  X(01).                         
008300                                                                  00830001
008900***********************************************************       00840001
009000*  COPYBOOK USED FOR THE LOGISTIC UPC OUTPUT FILE         *       00850003
009100***********************************************************       00860001
       01  PC-LOGISTIC-UPC-OUTPUT.                                              
009200     COPY XLRD010.                                                00870001
009300                                                                  00880001
010800***************************************************************** 01080001
010900 PROCEDURE DIVISION.                                              01090001
011000***************************************************************** 01100001
011100     DISPLAY '**** BEGINNING XLKUT018 ****'.                      01110001
011200     DISPLAY ' '.                                                 01120001
011300                                                                  01130001
011400     OPEN INPUT  LOGUNLD-UPC-FILE                                 01140001
011410          OUTPUT LOGISTIC-UPC-FILE.                               01140001
011500                                                                  01150001
011600     PERFORM 1000-READ-INPUT-FILE.                                01160001
011700                                                                  01170001
012100     PERFORM 2000-PROCESS-INPUT-FILE                              01210001
012200       UNTIL PS-EOF-INPUT-YES.                                    01220001
012300                                                                  01230001
012310     CLOSE LOGUNLD-UPC-FILE                                             01
012320           LOGISTIC-UPC-FILE.                                           01
012500                                                                  01250001
012600     DISPLAY '  INPUT DOMAIN UPC RECS  = ' PV-RECORDS-READ.       01260001
012700     DISPLAY ' OUTPUT DOMAIN UPC RECS  = ' PV-RECORDS-WRITTEN.          01
012800     DISPLAY ' '.                                                 01280001
012900     DISPLAY '****  END OF  XLKUT018  ****'.                      01290001
013000                                                                  01300001
013100     GOBACK.                                                      01310001
013200                                                                  01320001
013300                                                                  01330001
013400***************************************************************** 01340001
013500*  READ A LOGISTICS DOMAIN UPC RECORD                             01350003
013600***************************************************************** 01360001
013700 1000-READ-INPUT-FILE.                                            01370001
013800                                                                  01380001
013900     MOVE '1000-READ-INPUT-FILE    ' TO PV-ABEND-PARAGRAPH.       01390001
014000                                                                  01400001
014010     INITIALIZE PV-INPUT-RECORD.                                  01401003
014020                                                                  01402003
014100     READ LOGUNLD-UPC-FILE                                        01410004
014200          INTO PV-INPUT-RECORD                                    01420001
014300            AT END                                                01430001
014400               SET PS-EOF-INPUT-YES TO TRUE                       01440001
014900     END-READ.                                                    01490001
015000                                                                  01500001
015010     IF PS-EOF-INPUT-YES                                                  
015020        CONTINUE                                                          
015030     ELSE                                                                 
015040        ADD +1 TO PV-RECORDS-READ                                         
015050     END-IF.                                                              
015100                                                                  01510001
015200***************************************************************** 01520001
015300*  REFORMAT THE LOGISTICS DOMAIN UPC EXTRACT FILE                 01530003
015400***************************************************************** 01540001
015500 2000-PROCESS-INPUT-FILE.                                         01550001
015600                                                                  01560001
015700     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       01570001
015800                                                                  01580001
015900     MOVE PV-UPC-ID                  TO XL010-UPC-ID.                   03
016000     MOVE PV-INTR-UPC-ID             TO XL010-INTR-UPC-ID.              03
016100     MOVE PV-UPC-TYP-CDE             TO XL010-UPC-TYP-CDE.              03
016200     MOVE PV-EDI-ORD-IND             TO XL010-EDI-ORD-IND.              03
016300     MOVE PV-CERTD-IND               TO XL010-CERTD-IND.                03
016310     MOVE PV-CERTD-DTE               TO XL010-CERTD-DTE.                03
016320     MOVE PV-UPC-NBR                 TO XL010-UPC-NBR.                  03
016320     MOVE PV-PREPK-IND               TO XL010-PREPK-IND.                03
016370                                                                  01637003
016400     PERFORM 2100-WRITE-OUTPUT.                                         03
017700                                                                  01770001
017800     PERFORM 1000-READ-INPUT-FILE.                                01780001
018500                                                                  01850001
018600                                                                  01860001
021600***************************************************************** 02160001
021700*  WRITE A RECORDS TO THE LOGISTICS UPC OUTPUT FILE             * 02170003
021800***************************************************************** 02180001
021900 2100-WRITE-OUTPUT.                                               02190003
022000                                                                  02200001
022001     MOVE 'B'    TO XL010-FILE-INDICATOR.                                 
022010     WRITE LOGISTIC-UPC-RECORD FROM                                     07
022020         XL010-UPC-RECORD                                               07
022030     END-WRITE.                                                   03940007
024400     ADD +1                 TO PV-RECORDS-WRITTEN.                        
027200                                                                  02720001
