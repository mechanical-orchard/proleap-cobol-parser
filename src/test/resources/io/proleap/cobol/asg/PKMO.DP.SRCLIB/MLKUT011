       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.    MLKUT011                                                  
       AUTHOR.        DORSEY JACKSON                                            
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  06-10-2002.                                               
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      * MLKUT011 - M/L SELECTS MARKDOWNS AND MARKDOWN CANCELS          *        
      ******************************************************************        
      *  THIS PROGRAM SELECTS MARKDOWNS AND MARKDOWN CANCELS FROM THE  *        
      *  THE MTD PURCHASE FILE AND WILL SPLIT THEM INTO TWO DIFFERENT  *        
      *  FILES FOR REPORTING PURPOSES.                                 *        
      ******************************************************************        
      ******************************************************************        
      *                        CHANGE LOG                              *        
      * CHANGE ID   CHANGE DATE  PROGRAMMER  REASON FOR CHANGE         *        
207210* CHG0207210  08-22-2018   JIM HUNTER  RENAME KDM2810 TO MLWS051 *        
      ******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.    IBM-3090.                                            
       OBJECT-COMPUTER.    IBM-3090.                                            
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
           SELECT INP-MARKDOWN-FILE                                             
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT OUT-MARKDOWN-FILE                                             
               ASSIGN TO OUT01.                                                 
                                                                                
           SELECT OUT-MARKDOWN-CANCELS-FILE                                     
               ASSIGN TO OUT02.                                                 
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  INP-MARKDOWN-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK  CONTAINS   0 RECORDS                                          
           RECORD CONTAINS 100 CHARACTERS                                       
           DATA RECORD IS INPUT-MARKDOWN-RECORD.                                
                                                                                
       01  INPUT-MARKDOWN-RECORD            PIC X(100).                         
                                                                                
       FD  OUT-MARKDOWN-FILE                                                    
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 100 CHARACTERS                                       
           DATA RECORD IS OUT-MARKDOWN-RECORD.                                  
                                                                                
       01  OUT-MARKDOWN-RECORD     PIC X(100).                                  
                                                                                
       FD  OUT-MARKDOWN-CANCELS-FILE                                            
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 100 CHARACTERS                                       
           DATA RECORD IS OUT-MARKDOWN-CANCEL-RECORD.                           
                                                                                
       01  OUT-MARKDOWN-CANCELS-RECORD    PIC X(100).                           
                                                                                
       EJECT                                                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  FILLER                          PIC X(40)       VALUE                
           '*** WORKING STORAGE AREA BEGIN ***'.                                
                                                                                
      *****************************************************************         
      *  MD MARKDOWN INPUT RECORD                                               
      *****************************************************************         
207210     COPY MLWS051.                                                        
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05 PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.             
               88 PS-INPUT-EOF                           VALUE 'Y'.             
                                                                                
       EJECT                                                                    
      *                                                                         
       PROCEDURE DIVISION.                                                      
                                                                                
       0000-MLKUT011.                                                           
                                                                                
      ****************************************************************          
      *    OPEN ALL FILES.                                                      
      *    PROCESS INPUT RECORDS                                                
      *    AT END-OF-JOB.                                                       
      *    CLOSE ALL FILES.                                                     
      ****************************************************************          
                                                                                
           OPEN INPUT  INP-MARKDOWN-FILE                                        
                OUTPUT OUT-MARKDOWN-FILE                                        
                       OUT-MARKDOWN-CANCELS-FILE.                               
                                                                                
           PERFORM 1000-INITIALIZE-HEADER.                                      
                                                                                
           PERFORM 2000-PROCESS                                                 
               UNTIL PS-INPUT-EOF.                                              
                                                                                
           CLOSE INP-MARKDOWN-FILE                                              
                 OUT-MARKDOWN-FILE                                              
                 OUT-MARKDOWN-CANCELS-FILE.                                     
                                                                                
           STOP RUN.                                                            
                                                                                
       EJECT                                                                    
                                                                                
       1000-INITIALIZE-HEADER.                                                  
                                                                                
      ****************************************************************          
      *    PERFORM READ OF READ FIRST MARKDOWN RECORD                           
      *                                                                         
      *    PERFORMED BY 0000-MLKUT011                                           
      ****************************************************************          
           PERFORM 3000-READ-MARKDOWN-DATA.                                     
                                                                                
       EJECT                                                                    
                                                                                
       2000-PROCESS.                                                            
                                                                                
      ****************************************************************          
      *    PROCESS MARKDOWN RECORD                                              
      *                                                                         
      *    PERFORMED BY 0000-MLKUT011.                                          
      ****************************************************************          
           IF D090-CODE-40 = '40'                                               
               IF D090-MKDWN-OPRICE > D090-MKDWN-NPRICE                         
                   WRITE OUT-MARKDOWN-RECORD FROM D090-MKDWN-REC                
               ELSE                                                             
                   WRITE OUT-MARKDOWN-CANCELS-RECORD                            
                   FROM  D090-MKDWN-REC                                         
               END-IF                                                           
           END-IF.                                                              
                                                                                
           PERFORM 3000-READ-MARKDOWN-DATA.                                     
                                                                                
       EJECT                                                                    
                                                                                
       3000-READ-MARKDOWN-DATA.                                                 
                                                                                
      ****************************************************************          
      *    READ THE MARKET REPORT DATA FILE.                                    
      *                                                                         
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                                 
      *    PERFORMED BY 2000-PROCESS.                                           
      ****************************************************************          
           READ INP-MARKDOWN-FILE INTO D090-MKDWN-REC                           
               AT END                                                           
                   SET PS-INPUT-EOF TO TRUE.                                    
                                                                                
           EJECT                                                                
