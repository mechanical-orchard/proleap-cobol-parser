000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300 PROGRAM-ID.             PCKRF887.                                00030000
000400 AUTHOR.                 LARRY SCHLEICHER.                        00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN.           MAY 2002.                                00060000
000700 DATE-COMPILED.                                                   00070000
000800******************************************************************00080000
000900* THIS PROGRAM ALLOWS AN ASSOCIATE TO SCAN/KEY A KOHLS SML BARCODE00090000
001000* AND DISPLAYS THE CARTON DIVERT STATUS FOR THE CONTAINER.        00100000
001100******************************************************************00110000
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400******************************************************************00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600******************************************************************00160000
001700 01  DK-DB2-KEYS.                                                 00170000
001800     05  DK-LNE-NBR               PIC  S9(9) COMP VALUE ZEROES.   00180000
001900     05  DK-LNE-NBR-N             PIC   9(9) VALUE ZEROES.        00190000
002000     05  DK-LINE-NBR-X  REDEFINES DK-LNE-NBR-N.                   00200000
002100         10  FILLER               PIC   X(6).                     00210000
002200         10  DK-LINE-NBR          PIC   X(3).                     00220000
002300     05  DK-PO-NBR                PIC  S9(9) COMP.                00230000
002400     05  DK-PO-RCVR               PIC  S9(9) COMP.                00240000
002500     05  DK-PURCHASE-ORDER        PIC  S9(9) COMP VALUE ZEROES.   00250000
002600     05  DK-PURCHASE-ORDER-N      PIC   9(9) VALUE ZEROES.        00260000
002700     05  DK-PURCHASE-ORDER-X REDEFINES DK-PURCHASE-ORDER-N.       00270000
002800         10  DK-PURCHS-ORD        PIC   X(9).                     00280000
002900     05  DK-RCVR-NBR              PIC  S9(9) COMP VALUE ZEROES.   00290000
003000     05  DK-RCVR-NBR-N            PIC   9(9) VALUE ZEROES.        00300000
003100     05  DK-RCVR-NBR-X  REDEFINES DK-RCVR-NBR-N.                  00310000
003200         10  FILLER               PIC   9(6).                     00320000
003300         10  DK-RECVR-NBR         PIC   X(3).                     00330000
003400     05  DK-PREPK-ID              PIC  S9(4) COMP VALUE ZEROES.   00340000
003500     05  DK-STORE-NUMBER          PIC S9(4)   COMP-3.             00350000
003600     05  DK-OPER-UNT-ID           PIC S9(4)   COMP.               00360000
003700     05  DK-STR-NBR               PIC S9(4) COMP.                 00370000
003710     05  DK-DC                    PIC  ZZZ9    VALUE ZEROES.      00371044
003800     05  DK-FR-STR-NBR              PIC S9(04) COMP               00380000
003900                                               VALUE ZERO.        00390000
004000     05  DK-XFER-SEQ-NBR            PIC S9(08) COMP               00400000
004100                                               VALUE ZERO.        00410000
004200     05  DK-TRN-NBR                 PIC S9(08) COMP               00420000
004300                                               VALUE ZERO.        00430000
004400     05  DK-CARTON-ID               PIC S9(18) COMP-3             00440000
004500                                               VALUE ZERO.        00450000
004600     05  DK-CARTON-ID-XREF          PIC S9(18) COMP-3             00460000
004700                                               VALUE ZERO.        00470000
004800     05  DK-SHIPT-UNT-ID            PIC S9(18)V COMP-3            00480000
004900                                               VALUE ZERO.        00490000
005000     05  DK-CARTON-ID-2             PIC  X(22) VALUE SPACES.      00500000
005100     05  DK-CARTON-ID-2-R  REDEFINES  DK-CARTON-ID-2.             00510000
005200         10  DK-CRTNID2-01-02       PIC  9(02).                   00520000
005300         10  DK-CRTNID2-03-20       PIC  9(18).                   00530000
005400         10  DK-CRTNID2-21-22       PIC  X(02).                   00540000
005500                                                                  00550000
005600 01  PC-PROGRAM-CONSTANTS.                                        00560000
005700     05  PC-TRANID                  PIC X(04)  VALUE 'E887'.      00570000
005800     05  PC-LOGON-TRAN-ID           PIC X(04)  VALUE 'Z028'.      00580000
005900                                                                  00590000
006000     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'PCKRF887'.  00600000
006100     05  PC-MANIFEST-NBR-MODULE     PIC X(08)  VALUE 'PCKCS721'.  00610000
006200     05  PC-SHIPPING-MENU-PGM       PIC X(08)  VALUE 'PCKRF868'.  00620000
006300     05  PC-CARTON-FUNCTN-PGM       PIC X(08)  VALUE 'PCKRF884'.  00630000
006400     05  PC-HELP-SCREEN             PIC X(08)  VALUE 'PCKRF278'.  00640000
006500     05  PC-CARTONS-LAST-ACTIVITY   PIC X(08)  VALUE 'PCKRF881'.  00650000
006600     05  PC-LABEL-INFO-PGM          PIC X(08)  VALUE 'PCKRF888'.  00660000
006700                                                                  00670000
006800     05  PC-DEFAULT-TIMESTAMP       PIC  X(26)                    00680000
006900                          VALUE  '9999-09-09-09.09.09.999999'.    00690000
007000                                                                  00700000
007100     05  PC-0                            PIC  X(01)  VALUE '0'.   00710000
007200     05  PC-4                            PIC  X(01)  VALUE '4'.   00720000
007300     05  PC-18                           PIC S9(04)  VALUE 18.    00730000
007400     05  PC-20                           PIC S9(04)  VALUE 20     00740000
007500                                                     COMP SYNC.   00750000
007600     05  PC-A                       PIC X(01)   VALUE 'A'.        00760000
007700     05  PC-P                       PIC X(01)   VALUE 'P'.        00770000
007800     05  PC-G                       PIC X(01)   VALUE 'G'.        00780000
007900     05  PC-S                       PIC X(01)   VALUE 'S'.        00790000
008000     05  PC-Y                       PIC X(01)   VALUE 'Y'.        00800000
008100     05  PC-VENDOR-ASN              PIC X(10) VALUE 'VENDOR ASN'. 00810000
008200     05  PC-CHECK-IN                PIC X(10) VALUE 'CHECK IN  '. 00820000
008300     05  PC-CSEPK-SPLT              PIC X(10) VALUE 'CSEPK SPLT'. 00830000
008400     05  PC-MANUAL                  PIC X(10) VALUE 'MANUAL    '. 00840000
008500     05  PC-PCK-2-LIT               PIC X(10) VALUE 'PCK-2-LITE'. 00850000
008600     05  PC-RECEIVING               PIC X(10) VALUE 'RECEIVING '. 00860000
008700     05  PC-RDM                     PIC X(10) VALUE 'RDM       '. 00870000
008800     05  PC-SMOOTHING               PIC X(10) VALUE 'SMOOTHING '. 00880000
008900     05  PC-FAST-XFER               PIC X(10) VALUE 'FAST XFER '. 00890000
009000     05  PC-MSTR-CNTR               PIC X(10) VALUE 'MSTR CONTR'. 00900000
009100     05  PC-CRTN-BULD               PIC X(10) VALUE 'CRTN BUILD'. 00910000
009200     05  PC-JEWELRY                 PIC X(10) VALUE 'P2L-JEWLRY'. 00920012
009300     05  PC-DAMAGED                 PIC X(10) VALUE 'DAMAGED   '. 00930010
009400     05  PC-UNKNOWN                 PIC X(10) VALUE 'UNKNOWN   '. 00940000
009410     05  PC-3WD                     PIC X(10) VALUE '3RD PARTY '. 00941050
009500                                                                  00950000
009600* ERROR MESSAGES                                                 *00960000
009700 01  PM-PROGRAM-MESSAGES.                                         00970000
009800     05  PM-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00980000
009900                                           'UNRECOGNIZED PF KEY'. 00990000
010000     05  PM-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               01000000
010100                                           'ENTER THROUGH MENU '. 01010000
010200     05  PM-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               01020000
010300                                           'TRANS NOT AVAILABLE'. 01030000
010400     05  PM-CICS-ABEND-MSG          PIC X(19)  VALUE              01040000
010500                                           'CICS ABEND -CALL DP'. 01050000
010600     05  PM-DATABASE-ERROR          PIC  X(19)  VALUE             01060000
010700                                           'DATABASE ER-CALL DP'. 01070000
010800     05  PM-DATABASE-BUSY           PIC  X(19)  VALUE             01080000
010900                                           'DB BUSY - TRY AGAIN'. 01090000
011000     05  PM-CARTON-STATUS-ERROR     PIC  X(19)  VALUE             01100000
011100                                           'CARTON STATUS ERROR'. 01110000
011200                                                                  01120000
011300 01  PS-PROGRAM-SWITCHES.                                         01130000
011400     05  PS-NO-REC-FOUND-SW           PIC  X(01)  VALUE 'Y'.      01140000
011500         88  PS-NO-REC-FOUND                      VALUE 'N'.      01150000
011600         88  PS-REC-FOUND                         VALUE 'Y'.      01160000
011700     05  PS-PREPK-SAME-MULTIPLE       PIC  X(01)  VALUE 'N'.      01170000
011800         88  PS-PREPK-SAME-MULTIPLE-NO            VALUE 'N'.      01180000
011900         88  PS-PREPK-SAME-MULTIPLE-YES           VALUE 'Y'.      01190000
012000     05  PS-ERROR-SW                  PIC  X(01)  VALUE 'N'.      01200000
012100         88  PS-ERRORS-YES                        VALUE 'Y'.      01210000
012200         88  PS-ERRORS-NO                         VALUE 'N'.      01220000
012300     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'Y'.      01230000
012400         88  PS-VALID-INPUT                       VALUE 'Y'.      01240000
012500         88  PS-INVALID-INPUT                     VALUE 'N'.      01250000
012600     05  PS-INITIALIZE-SCREEN-SW      PIC  X(01)  VALUE 'N'.      01260000
012700         88  PS-INITIALIZE-SCREEN                 VALUE 'Y'.      01270000
012800         88  PS-PROCESS-SCREEN                    VALUE 'N'.      01280000
012900     05  PS-KOHLS-BARCODE-SW          PIC X(01)   VALUE 'N'.      01290000
013000         88  PS-KOHLS-BARCODE                     VALUE 'Y'.      01300000
013100         88  PS-NOT-KOHLS-BARCODE                 VALUE 'N'.      01310000
013200     05  PS-CHECK-DIGIT-IND           PIC  X(01)  VALUE 'N'.      01320000
013300         88  PS-VALID-CHECK-DIGIT                 VALUE 'Y'.      01330000
013400         88  PS-INVALID-CHECK-DIGIT               VALUE 'N'.      01340000
013500     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   01350000
013600         88  PS-XCTL-E881                         VALUE 'E881'.   01360000
013700     05  PS-FOUND-ON-TLBVRDA-SW       PIC X(01)   VALUE  'N'.     01370000
013800         88  PS-FOUND-ON-TLBVRDA                  VALUE  'Y'.     01380000
013900         88  PS-NOT-FOUND-TLBVRDA                 VALUE  'N'.     01390000
014000     05  PS-ADJUSTMENT-SW             PIC  X(01)  VALUE  'N'.     01400009
014100         88  PS-ADJ-NO                            VALUE  'N'.     01410009
014200         88  PS-ADJ-YES                           VALUE  'Y'.     01420009
014300     05 PS-ZERO-RCVR-SEQ-SW           PIC  X(01)  VALUE  'Y'.     01430013
014400         88  PS-ZERO-RCVR-SEQ-YES                 VALUE  'Y'.     01440013
014500         88  PS-ZERO-RCVR-SEQ-NO                  VALUE  'N'.     01450009
014600                                                                  01460009
014700                                                                  01470000
014800  01 PT-INDEXES.                                                  01480000
014900     05  PT-TABLE-ENTRIES           PIC 9(5)  VALUE ZEROES.       01490000
015000     05  PT-PREPK-TABLE-ENTRIES     PIC 9(5)  VALUE ZEROES.       01500000
015100                                                                  01510000
015200 01  PT-PURCHASE-ORDER-TABLE.                                     01520000
015300     05  PT-PURCHASE-ORDER-INFO OCCURS 500 TIMES                  01530000
015400                      INDEXED BY PT-PO-IDX.                       01540000
015500         10  PT-PURCHASE-ORDER      PIC  S9(9) COMP VALUE ZEROES. 01550000
015600         10  PT-RCVR-NBR            PIC  S9(9) COMP VALUE ZEROES. 01560000
015700         10  PT-DEPT                PIC   X(3) VALUE SPACE.       01570000
015800         10  PT-PKGNG-CDE           PIC   X(1) VALUE SPACE.       01580000
015900             88  PT-PREPK-PO              VALUE 'M', 'I'.         01590000
016000         10  PT-UPC-NBR            PIC  S9(15)V COMP-3 VALUE ZERO.01600000
016100         10  PT-LNE-NBR             PIC  S9(9) COMP  VALUE ZEROES.01610000
016200         10  PT-LNE-SW              PIC   X(1)       VALUE SPACE. 01620000
016300             88  PT-SINGLE-LINE             VALUE 'S'.            01630000
016400             88  PT-MULTI-LINE              VALUE 'M'.            01640000
016500             88  PT-NO-LINE                 VALUE ' '.            01650000
016600         10  PT-PREPK-ID            PIC  S9(4) COMP VALUE ZEROES. 01660000
016700         10  PT-PREPK-SW            PIC   X(1) VALUE SPACE.       01670000
016800             88  PT-SINGLE-PREPK           VALUE 'S'.             01680000
016900             88  PT-MULTI-PREPK            VALUE 'M'.             01690000
017000             88  PT-NO-PREPK               VALUE ' '.             01700000
017100         10  PT-NBR-UNITS           PIC   9(09)  VALUE ZEROES.    01710000
017200         10  PT-NBR-PACKS           PIC   9(09)  VALUE ZEROES.    01720000
017300                                                                  01730000
017400 01  PT-PREPK-LINE-TABLE.                                         01740000
017500     05  PT-PREPK-LINE-INFO    OCCURS 1000 TIMES                  01750000
017600                      INDEXED BY PT-PREPK-IDX.                    01760000
017700         10  PT-PREPK-LNE-NBR         PIC  9(9) VALUE ZEROES.     01770000
017800         10  PT-PREPK-LNE-RATIO       PIC  9(4) VALUE ZEROES.     01780000
017900         10  PT-PREPK-NBR-UNITS       PIC  9(9) VALUE ZEROES.     01790000
018000         10  PT-PREPK-MULTIPLE        PIC  9(4) VALUE ZEROES.     01800000
018100         10  PT-PREPK-REMAINDER       PIC  9(9) VALUE ZEROES.     01810000
018200                                                                  01820000
018300                                                                  01830000
018400*----------------------------------------------------------------*01840000
018500*  PROGRAM VARIABLES                                             *01850000
018600*----------------------------------------------------------------*01860000
018700 01  PV-PROGRAM-VARIABLES.                                        01870000
018800     05  PV-BARCODE                   PIC X(20).                  01880000
018900     05  PV-BARCODE-R REDEFINES PV-BARCODE.                       01890000
019000         10  PV-BARCODE-1-2           PIC 9(02).                  01900000
019100         10  PV-BARCODE-3-20          PIC 9(18).                  01910000
019200     05  PV-BARCODE-22                PIC X(22).                  01920000
019300     05  PV-BARCODE-R22 REDEFINES PV-BARCODE-22.                  01930000
019400         10  PV-BARCODE-22-1-2        PIC 9(02).                  01940000
019500         10  PV-BARCODE-22-3-20       PIC 9(18).                  01950000
019600         10  PV-BARCODE-22-22-2       PIC 9(02).                  01960000
019700     05  PV-DIVERT-COUNT           PIC S9(4) COMP.                01970000
019800     05  PV-DIVERTS-Z              PIC ZZZ9.                      01980000
019900     05  PV-STR-NBR                PIC 9(04).                     01990000
020000     05  PV-STORE                  PIC ZZZ9.                      02000000
020100     05  PV-CREATE                 PIC X(10).                     02010000
020200     05  PV-OPER-UNT-ID            PIC 9(04).                     02020000
020300     05  PV-DISP-SHIPT-UNT-ID      PIC 9(18).                     02030002
020400     05  PV-PREPK-TOT-UNITS              PIC  9(09) VALUE ZEROES. 02040000
020500     05  PV-PREPK-MULTIPLE               PIC  9(09) VALUE ZEROES. 02050000
020600     05  PV-SYSID                     PIC  X(04)  VALUE SPACE.    02060041
020700     05  PV-DB2-TIMESTAMP                PIC  X(26).              02070041
020800     05  PV-DB2-TIMESTAMP-R REDEFINES PV-DB2-TIMESTAMP.           02080041
020900         10  PV-DB2-TMST-DATE            PIC  X(10).              02090041
021000         10  FILLER                      PIC X(16).               02100041
021100     05  PV-DB2-TIMESTAMP1               PIC  X(26).              02110041
021200     05  PV-DB2-TIMESTAMP2.                                       02120041
021300         20  PV-CENTURY            PIC  X(02).                    02130041
021400         20  PV-YEAR               PIC  X(02).                    02140041
021500         20  FILLER                PIC  X(01).                    02150041
021600         20  PV-MONTH              PIC  X(02).                    02160041
021700         20  FILLER                PIC  X(01).                    02170041
021800         20  PV-DAY                PIC  X(02).                    02180041
021900         20  FILLER                PIC  X(01).                    02190041
022000         20  PV-HOUR               PIC  X(02).                    02200041
022100         20  FILLER                PIC  X(01).                    02210041
022200         20  PV-MINUTE             PIC  X(02).                    02220041
022300         20  FILLER                PIC  X(01).                    02230041
022400         20  PV-SECONDS            PIC  X(02).                    02240041
022500         20  PV-REST               PIC  X(07).                    02250041
022600     05  PV-DB2-REFORMAT-DATE-TIME.                               02260041
022700         10  PV-DB2-DATE-MM              PIC  X(02).              02270041
022800         10  FILLER                      PIC  X(01) VALUE '/'.    02280041
022900         10  PV-DB2-DATE-DD              PIC  X(02).              02290041
023000         10  FILLER                      PIC  X(01) VALUE '/'.    02300041
023100         10  PV-DB2-DATE-YY              PIC  X(02).              02310041
023200         10  FILLER                      PIC  X(01) VALUE ' '.    02320041
023300         10  PV-DB2-TIME-HH              PIC  X(02).              02330041
023400         10  FILLER                      PIC  X(01)  VALUE ':'.   02340041
023500         10  PV-DB2-TIME-MM              PIC  X(02).              02350041
023600         10  FILLER                      PIC  X(01)  VALUE ':'.   02360041
023700         10  PV-DB2-TIME-SS              PIC  X(02).              02370041
023800     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   02380041
023900                                                     COMP.        02390041
024000     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   02400041
024100                                                     COMP SYNC.   02410041
024200     05  PV-LINE-SHPD-UNITS              PIC S9(9)V COMP-3.       02420041
024300                                                                  02430049
024400     05  PV-CHILDRN-IN-MASTER            PIC S9(09) VALUE +0 COMP.02440041
024500     05  PV-CHLDN-IN-MSTR                PIC  9(09) VALUE ZEROES. 02450041
024600     05  PV-CHLD-IN-MSTR-N  REDEFINES PV-CHLDN-IN-MSTR.           02460041
024700         10  FILLER                      PIC  9(05).              02470041
024800         10  PV-CHLD-IN-MSTR             PIC  9(04).              02480041
024900     05  PV-CARTON-ID                 PIC X(22).                  02490041
025000     05  PV-CARTON-ID-ENTERED         PIC S9(18)V  COMP-3.        02500041
025100     05  PV-SOURCE-ID                 PIC X(03).                  02510041
025200     05  PV-STATUS                    PIC X(02).                  02520041
025300                                                                  02530041
025400     05  PV-TMST                      PIC X(26).                  02540041
025500     05  PV-CHAR-COUNT                PIC S9(04)  VALUE ZEROS     02550041
025600                                                 COMP SYNC.       02560041
025700     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  02570041
025800                                                     COMP SYNC.   02580041
025900     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 02590041
026000     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 02600041
026100     05  PV-TOTAL                        PIC  9(04).              02610041
026200     05  FILLER REDEFINES PV-TOTAL.                               02620041
026300         10  FILLER                      PIC  9(03).              02630041
026400         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              02640041
026500     05  PV-CHECK-DIGIT                  PIC  9(01).              02650041
026600     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    02660041
026700                                                     COMP SYNC.   02670041
026800     05  PV-RBA                          PIC S9(08)  VALUE +0     02680041
026900                                                     COMP SYNC.   02690041
027000     05  PV-9999-9                       PIC  9(04)  VALUE 0000.  02700041
027100     05  PV-9999-X REDEFINES PV-9999-9.                           02710041
027200         10  PV-9999-1-2                 PIC  X(02).              02720041
027300         10  PV-9999-3-4                 PIC  X(02).              02730041
027400     05  PV-CTN-X                        PIC  X(18).              02740041
027500     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              02750041
027600     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          02760041
027700         10  PV-CTN-9-1                  PIC  9(01).              02770041
027800         10  PV-CTN-9-2                  PIC  9(01).              02780041
027900         10  PV-CTN-9-3                  PIC  9(01).              02790041
028000         10  PV-CTN-9-4                  PIC  9(01).              02800041
028100         10  PV-CTN-9-5                  PIC  9(01).              02810041
028200         10  PV-CTN-9-6                  PIC  9(01).              02820041
028300         10  PV-CTN-9-7                  PIC  9(01).              02830041
028400         10  PV-CTN-9-8                  PIC  9(01).              02840041
028500         10  PV-CTN-9-9                  PIC  9(01).              02850041
028600         10  PV-CTN-9-10                 PIC  9(01).              02860041
028700         10  PV-CTN-9-11                 PIC  9(01).              02870041
028800         10  PV-CTN-9-12                 PIC  9(01).              02880041
028900         10  PV-CTN-9-13                 PIC  9(01).              02890041
029000         10  PV-CTN-9-14                 PIC  9(01).              02900041
029100         10  PV-CTN-9-15                 PIC  9(01).              02910041
029200         10  PV-CTN-9-16                 PIC  9(01).              02920041
029300         10  PV-CTN-9-17                 PIC  9(01).              02930041
029400         10  PV-CTN-9-18                 PIC  9(01).              02940041
029500     05  PV-128-CARTON.                                           02950041
029600         10  PV-128-CARTON-13            PIC  9(13).              02960041
029700         10  PV-128-CARTON-5             PIC  9(05).              02970041
029800         10  PV-CTN.                                              02980041
029900             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              02990041
030000             15  PV-CTN-LAST-17          PIC  X(17).              03000041
030100             15  PV-CTN-FILLER           PIC  X(02).              03010041
030200         10  FILLER REDEFINES PV-CTN.                             03020041
030300             15  PV-CTN-SCAN-00          PIC  X(02).              03030041
030400             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              03040041
030500             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              03050041
030600         10  FILLER REDEFINES PV-CTN.                             03060041
030700             15  PV-CTN-SCAN-00          PIC  X(02).              03070041
030800             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              03080041
030900                                                                  03090041
031000     05  PV-SUB                       PIC S9(4) COMP              03100041
031100                                                VALUE ZERO.       03110041
031200     05  PV-CRTN-TOTAL-PACKS             PIC  9(09) VALUE ZEROES. 03120041
031300     05  PV-CRTN-TOTAL-PACKS-N REDEFINES PV-CRTN-TOTAL-PACKS.     03130041
031400         10  FILLER                      PIC  9(05).              03140041
031500         10  PV-CRTN-TOTAL-PAKS          PIC  9(04).              03150041
031600     05  PV-CRTN-TOTAL-UNITS             PIC  9(09) VALUE ZEROES. 03160041
031700     05  PV-CRTN-TOTAL-UNITS-N REDEFINES PV-CRTN-TOTAL-UNITS.     03170041
031800         10  FILLER                      PIC  9(05).              03180041
031900         10  PV-CRTN-TOTAL-UNTS          PIC  9(04).              03190041
032000                                                                  03200041
032100     05  PV-NULL-IND                  PIC S9(4)   VALUE ZERO      03210041
032200                                                     COMP SYNC.   03220041
032300     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        03230041
032400                                                     COMP SYNC.   03240041
032500     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    03250041
032600     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     03260041
032700                                                     COMP SYNC.   03270041
032800     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    03280041
032900     05  PV-MANIFEST-START            PIC S9(9) COMP-3.           03290041
033000     05  PV-MANIFEST-END              PIC S9(9) COMP-3.           03300041
033100 01  PV-LOG-MSG.                                                  03310041
033200     05  FILLER                       PIC X(12) VALUE             03320041
033300         ' E887 ERROR '.                                          03330041
033400     05  FILLER                       PIC X(09) VALUE             03340041
033500         'SQLCODE= '.                                             03350041
033600     05  PV-SQLCODE                   PIC -9(03).                 03360041
033700     05  FILLER                       PIC X(06) VALUE             03370041
033800         ' ERR= '.                                                03380041
033900     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       03390041
034000     05  FILLER                       PIC X(07) VALUE             03400041
034100         ' FAST= '.                                               03410041
034200     05  PV-DISPLAY-FAST              PIC X(12) VALUE ZEROES.     03420041
034300     05  FILLER                       PIC X(05) VALUE             03430041
034400         ' PO= '.                                                 03440041
034500     05  PV-DISPLAY-PO                PIC 9(09) VALUE ZEROES.     03450041
034600     05  FILLER                       PIC X(07) VALUE             03460041
034700         ' RCVR= '.                                               03470041
034800     05  PV-DISPLAY-RCVR              PIC 9(04) VALUE ZEROES.     03480041
034900     05  FILLER                       PIC X(07) VALUE             03490041
035000         ' LINE= '.                                               03500041
035100     05  PV-DISPLAY-PO-LNE-NBR        PIC 9(04) VALUE ZEROES.     03510041
035200     05  FILLER                       PIC X(06) VALUE             03520041
035300         ' STR= '.                                                03530041
035400     05  PV-DISPLAY-STORE             PIC 9(04) VALUE ZEROES.     03540041
035500                                                                  03550041
035600     05  PV-CARTON-MSG.                                           03560041
035700         10  FILLER                   PIC X(01) VALUE SPACE.      03570041
035800         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 03580041
035900         10  FILLER                   PIC X(01) VALUE '-'.        03590041
036000         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     03600041
036100         10  FILLER                   PIC X(05) VALUE ' REC='.    03610041
036200         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     03620041
036300         10  FILLER                   PIC X(10)                   03630041
036400                             VALUE ' CTN STAT='.                  03640041
036500         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     03650041
036600         10  FILLER                   PIC X(01) VALUE '/'.        03660041
036700         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     03670041
036800         10  FILLER                   PIC X(05) VALUE ' SER='.    03680041
036900         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     03690041
037000         10  FILLER                   PIC X(06) VALUE ' TRIP='.   03700041
037100         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     03710041
037200         10  FILLER                   PIC X(06) VALUE ' STAT='.   03720041
037300         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     03730041
037400         10  FILLER                   PIC X(06) VALUE ' USER='.   03740041
037401         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     03740141
037402                                                                  03740234
037403 01  PV-EDITING-FIELDS.                                           03740341
037404     05  PV-PROGRAM-DATA.                                         03740441
037450                                                                  03745041
037460         10  PV-PO-LINE-N                  PIC 9(09).             03746041
037470         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 03747041
037480             15 FILLER                     PIC X(05).             03748041
037490             15 PV-PO-LINE-OUT             PIC X(04).             03749041
037500                                                                  03750041
037600         10  PV-PO-LINE-LBL.                                      03760041
037700             15  PV-LINE-LBL-1           PIC 9(01).               03770041
037800             15  PV-LINE-LBL-3           PIC 9(03).               03780041
037900                                                                  03790041
038100 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  03810041
038200     05  TS-INFO-QUEUE-NAME.                                      03820041
038300         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 03830041
038400         10  FILLER                      PIC  X(04)  VALUE 'INFO'.03840041
038500                                                                  03850041
038600* COMMAREA FOR PCRF88X SCREENS                                    03860049
038700 01  CA-COMMAREA.                                                 03870041
038800     COPY PCWS038.                                                03880041
038900   02 CA-PC233.                                                   03890041
039000     COPY PCWS233.                                                03900041
039100                                                                  03910041
039200******************************************************************03920041
039300* COMMAREA FOR PCKRF888                                           03930041
039400******************************************************************03940041
039500     COPY PCWS039.                                                03950041
039600                                                                  03960041
039700*  RF SCREEN ERROR MESSAGES                                       03970041
039800     COPY PCWS034.                                                03980041
039900                                                                  03990041
040000******************************************************************04000041
040100* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    04010041
040200******************************************************************04020041
040300     COPY PCWS046.                                                04030041
040400                                                                  04040041
040500*  TEMPORARY STORAGE QUEUE LAYOUT FOR LOGON/UNIT RELATED          04050041
040600*  INFORMATION CAPTURED BY THE NAVIGATOR AT LOGON TIME            04060041
040700     COPY DPWS026.                                                04070041
040800                                                                  04080041
040900*  MAP LAYOUT                                                     04090041
041000     COPY PCKM887.                                                04100041
041100                                                                  04110041
041200* HELP SCREEN WORK AREA                                           04120041
041300     COPY PCWS188.                                                04130041
041400                                                                  04140041
041500* HELP SCREEN COMMAREA                                            04150041
041600     COPY PCWS192.                                                04160041
041700                                                                  04170041
041800* NUMERIC EDIT LAYOUT                                             04180041
041900     COPY DPWS010I.                                               04190041
042000                                                                  04200041
042100*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   04210041
042200     COPY DPWS015.                                                04220041
042300                                                                  04230041
042400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      04240041
042500     COPY DFHAID.                                                 04250041
042600                                                                  04260041
042700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               04270041
042800     COPY DPWS013.                                                04280041
042900                                                                  04290049
043000                                                                  04300041
043100******************************************************************04310041
043200*  SHIPPING UNIT TABLE                                            04320041
043300******************************************************************04330041
043400     EXEC SQL                                                     04340041
043500         INCLUDE SUT00024                                         04350041
043600     END-EXEC.                                                    04360041
043700                                                                  04370049
043800******************************************************************04380041
043900*  SHIPMENT UNIT/UPC ASSOCIATION TABLE.                           04390041
044000******************************************************************04400041
044100     EXEC SQL                                                     04410041
044200         INCLUDE SUT00028                                         04420041
044300     END-EXEC.                                                    04430041
044400                                                                  04440049
044500******************************************************************04450041
044600*  CARTON DIVERT TABLE.                                           04460041
044700******************************************************************04470041
044800     EXEC SQL                                                     04480041
044900         INCLUDE TSUCRDV                                          04490041
045000     END-EXEC.                                                    04500041
045100                                                                  04510041
045200     EXEC SQL                                                     04520041
045300         INCLUDE SUT00026                                         04530041
045400     END-EXEC.                                                    04540041
045500                                                                  04550041
045600     EXEC SQL                                                     04560041
045700         INCLUDE TPKSLIP                                          04570041
045800     END-EXEC.                                                    04580041
045900                                                                  04590041
046000     EXEC SQL                                                     04600041
046100         INCLUDE TRECEIV                                          04610041
046200     END-EXEC.                                                    04620041
046300                                                                  04630041
046400     EXEC SQL                                                     04640041
046500         INCLUDE TPURCHS                                          04650041
046600     END-EXEC.                                                    04660041
046700                                                                  04670041
046800*-----------------------------------------------------------------04680041
046900*  DB2 TABLE FOR VIRTUAL LABEL DATA                               04690041
047000*-----------------------------------------------------------------04700041
047100     EXEC SQL                                                     04710041
047200          INCLUDE TLBVRDA                                         04720041
047300     END-EXEC.                                                    04730041
047400                                                                  04740041
047500     EXEC SQL                                                     04750041
047600         INCLUDE TSUOBTR                                          04760041
047700     END-EXEC.                                                    04770041
047800                                                                  04780041
047900     EXEC SQL                                                     04790041
048000         INCLUDE TSUOBTS                                          04800041
048100     END-EXEC.                                                    04810041
048200                                                                  04820041
048300*-----------------------------------------------------------------04830041
048400     EXEC SQL                                                     04840041
048500         INCLUDE TSUOBSC                                          04850041
048600     END-EXEC.                                                    04860041
048700                                                                  04870041
048800*-----------------------------------------------------------------04880041
048900     EXEC SQL                                                     04890041
049000         INCLUDE TCNTRID                                          04900041
049100     END-EXEC.                                                    04910041
049200                                                                  04920041
049300*-----------------------------------------------------------------04930041
049400     EXEC SQL                                                     04940041
049500         INCLUDE TCNDRST                                          04950041
049600     END-EXEC.                                                    04960041
049700                                                                  04970041
049800*-----------------------------------------------------------------04980041
049900     EXEC SQL                                                     04990041
050000         INCLUDE TCNDCDR                                          05000041
050100     END-EXEC.                                                    05010041
050200                                                                  05020041
050300*-----------------------------------------------------------------05030041
050400     EXEC SQL                                                     05040041
050500         INCLUDE TCNDRTY                                          05050041
050600     END-EXEC.                                                    05060041
050700                                                                  05070049
050800******************************************************************05080041
050900*  CROSS REFERENCE TABLE                                          05090041
051000******************************************************************05100041
051100     EXEC SQL                                                     05110041
051200         INCLUDE TSULBXF                                          05120041
051300     END-EXEC.                                                    05130041
051400                                                                  05140041
051410******************************************************************05141045
051420*  XLT_DC_LOC_ASGMT                                               05142045
051430******************************************************************05143045
051440     EXEC SQL                                                     05144045
051450         INCLUDE XLT00014                                         05145045
051460     END-EXEC.                                                    05146045
051470                                                                  05147045
051500******************************************************************05150041
051600*  CROSS REFERENCE CURSOR                                         05160041
051700******************************************************************05170041
051800                                                                  05180041
051900     EXEC SQL                                                     05190041
052000          DECLARE DUP-ACTIVE-CSR CURSOR FOR                       05200041
052100          SELECT  BRCDE_NBR                                       05210041
052200             ,    LAST_STAT_CHG_TMST                              05220041
052300            FROM  TSULBXF                                         05230041
052400            WHERE SHIPT_UNT_ID = :DK-CARTON-ID                    05240041
052500           ORDER BY LAST_STAT_CHG_TMST DESC                       05250041
052600     END-EXEC.                                                    05260041
052700                                                                  05270041
052800                                                                  05280049
052900******************************************************************05290041
053000*  DB2 AREA FOR COMMUNICATIONS.                                   05300041
053100******************************************************************05310041
053200     EXEC SQL                                                     05320041
053300         INCLUDE SQLCA                                            05330041
053400     END-EXEC.                                                    05340041
053500                                                                  05350041
053600*-----------------------------------------------------------------05360041
053700*  DB2 TABLE FOR DISTRIBUTION HEADER                              05370041
053800*-----------------------------------------------------------------05380041
053900     EXEC SQL                                                     05390041
054000          INCLUDE TDISTHD                                         05400041
054100     END-EXEC.                                                    05410041
054200                                                                  05420041
054300*-----------------------------------------------------------------05430041
054400*  DB2 TABLE FOR DISTRIBUTION DETAIL                              05440041
054500*-----------------------------------------------------------------05450041
054600     EXEC SQL                                                     05460041
054700          INCLUDE TDISTDT                                         05470041
054800     END-EXEC.                                                    05480041
054900                                                                  05490041
055000     EXEC SQL                                                     05500041
055100         INCLUDE TRECITM                                          05510041
055200     END-EXEC.                                                    05520041
055300                                                                  05530041
055400*-----------------------------------------------------------------05540041
055500*  THE PURCHASING ITEM TABLE                                      05550041
055600*-----------------------------------------------------------------05560041
055700     EXEC SQL                                                     05570041
055800         INCLUDE TPURITM                                          05580041
055900     END-EXEC.                                                    05590041
056000                                                                  05600041
056100*-----------------------------------------------------------------05610041
056200*  THE XLT_SKU TABLE                                              05620041
056300*-----------------------------------------------------------------05630041
056400     EXEC SQL                                                     05640041
056500         INCLUDE XLT00003                                         05650041
056600     END-EXEC.                                                    05660041
056700                                                                  05670041
056800     EXEC SQL                                                     05680041
056900         INCLUDE TSUQADJ                                          05690041
057000     END-EXEC.                                                    05700041
057100                                                                  05710041
057200     EXEC SQL                                                     05720041
057300          DECLARE TPKSLIP-PO-CSR CURSOR FOR                       05730041
057400          SELECT  DISTINCT B.PO_NBR                               05740041
057500                 ,C.REC_SEQ_NBR                                   05750041
057600            FROM  SUT_OTBND_CART A                                05760041
057700                 ,SUT_OTBND_VND B                                 05770041
057800                 ,TPKSLIP C                                       05780041
057900            WHERE A.SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID             05790041
058000              AND A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               05800041
058100              AND B.PO_NBR        =  C.PO_NBR                     05810041
058200              AND B.PKSL_SEQ_NBR  =  C.SEQ_NBR                    05820041
058300              AND C.VER_STAT_CDE  =  :PC-A                        05830041
058400     END-EXEC.                                                    05840041
058500                                                                  05850041
058600     EXEC SQL                                                     05860041
058700          DECLARE OTBND-UPC-PO-CSR CURSOR FOR                     05870041
058800          SELECT  DISTINCT TRN_NBR                                05880041
058900                 ,RCVR_SEQ_NBR                                    05890041
059000            FROM  SUT_OTBND_UPC                                   05900041
059100            WHERE SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID               05910041
059200     END-EXEC.                                                    05920041
059300                                                                  05930041
059400     EXEC SQL                                                     05940041
059500          DECLARE PREPKID-CSR CURSOR FOR                          05950041
059600          SELECT  DISTINCT B.PREPK_ID                             05960041
059700            FROM  TRECITM B                                       05970041
059800            WHERE B.ORD_NBR     =  :DK-PURCHASE-ORDER             05980041
059900              AND B.REC_SEQ_NBR =  :DK-RCVR-NBR                   05990041
060000              AND B.VER_STATUS_CDE = 'A'                          06000041
060100              AND B.ORD_LNE_NBR  IN                               06010041
060200                (SELECT A.TRN_LNE_NBR                             06020041
060300                 FROM  SUT_OTBND_UPC A                            06030041
060400            WHERE A.SHIPT_UNT_ID =  :DK-SHIPT-UNT-ID              06040041
060500              AND A.TRN_NBR = B.ORD_NBR                           06050041
060600              AND A.RCVR_SEQ_NBR = B.REC_SEQ_NBR)                 06060041
060700     END-EXEC.                                                    06070041
060800                                                                  06080041
060900     EXEC SQL                                                     06090041
061000          DECLARE PREPK-LNE-CSR CURSOR FOR                        06100041
061100          SELECT  ORD_LNE_NBR                                     06110041
061200                 ,PREPK_RATO_QTY                                  06120041
061300            FROM  TRECITM                                         06130041
061400            WHERE ORD_NBR     =  :DK-PURCHASE-ORDER               06140041
061500              AND REC_SEQ_NBR =  :DK-RCVR-NBR                     06150041
061600              AND PREPK_ID    =  :DK-PREPK-ID                     06160041
061700              AND VER_STATUS_CDE = 'A'                            06170041
061800     END-EXEC.                                                    06180041
061900                                                                  06190041
062000     EXEC SQL                                                     06200041
062100          DECLARE OTBND-CART-CSR CURSOR FOR                       06210041
062200          SELECT  B.SHIPT_UNT_ID                                  06220041
062300            FROM  SUT_OTBND_CART A                                06230041
062400                 ,SUT_OTBND_CART B                                06240041
062500            WHERE A.PRNT_CART_ID = :DK-SHIPT-UNT-ID               06250041
062600              AND B.PRNT_CART_ID = A.SHIPT_UNT_ID                 06260041
062700              AND B.MSTR_CART_IND     = 'N'                       06270041
062800     END-EXEC.                                                    06280041
062900                                                                  06290041
063000     EXEC SQL                                                     06300041
063100          DECLARE OTBND-CART-CSR2 CURSOR FOR                      06310041
063200          SELECT  SHIPT_UNT_ID                                    06320041
063300            FROM  SUT_OTBND_CART                                  06330041
063400            WHERE PRNT_CART_ID = :DK-SHIPT-UNT-ID                 06340041
063500              AND MSTR_CART_IND     = 'N'                         06350041
063600     END-EXEC.                                                    06360041
063700                                                                  06370041
063800                                                                  06380049
063900******************************************************************06390041
064000 LINKAGE SECTION.                                                 06400041
064100 01  DFHCOMMAREA.                                                 06410041
064200     05  FILLER                         OCCURS  1 TO 4072 TIMES   06420041
064300                                      DEPENDING ON EIBCALEN.      06430041
064400         10  FILLER                   PIC X.                      06440041
064500                                                                  06450049
064600******************************************************************06460041
064700 PROCEDURE DIVISION.                                              06470041
064800******************************************************************06480041
064900 0000-PROGRAM-MAINLINE.                                           06490041
065000                                                                  06500041
065100     INITIALIZE CA-COMMAREA.                                      06510041
065200     MOVE DFHCOMMAREA   TO CA-COMMAREA.                           06520041
065300                                                                  06530041
065400     EVALUATE TRUE                                                06540041
065500         WHEN EIBCALEN = ZERO                                     06550041
065600             MOVE PM-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    06560041
065700             PERFORM 8110-RETURN                                  06570041
065800                                                                  06580041
065900****************************************************************  06590041
066000* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        06600041
066100****************************************************************  06610041
066200         WHEN EIBTRNID = 'Z278'                                   06620041
066300             MOVE DFHCOMMAREA          TO PC192-COMMAREA          06630041
066400             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             06640041
066500             SET PS-PROCESS-SCREEN TO TRUE                        06650041
066600             MOVE PC192-HOST-SAVE-MAP  TO PC887AO                 06660041
066700             MOVE -1                   TO ACARTNIDL               06670041
066800             PERFORM 8000-SEND-MAP                                06680041
066900             PERFORM 8100-RETURN-TRANID                           06690041
067000                                                                  06700041
067100         WHEN PC038-INITIALIZE-SCREEN                             06710041
067200         WHEN EIBAID = DFHCLEAR                                   06720041
067300             INITIALIZE PC038-SHPUNT-FIELDS                       06730041
067400                        PC038-SULBXF-FIELDS                       06740041
067500             SET PC038-PROCESS-SCREEN TO TRUE                     06750041
067600             PERFORM 1000-INITIALIZE                              06760041
067700             PERFORM 1300-FIND-SYSTEM-ID                          06770041
067800             PERFORM 1400-FIND-LOGON-INFO                         06780041
067900             MOVE -1                  TO ACARTNIDL                06790041
068000             PERFORM 8000-SEND-MAP                                06800041
068100             PERFORM 8100-RETURN-TRANID                           06810041
068200                                                                  06820041
068300         WHEN EIBAID = DFHPF8                                     06830041
068400             MOVE 'PCKRF880'          TO PV-TRANSFER-PROGRAM      06840041
068500             PERFORM 8200-XCTL                                    06850041
068600                                                                  06860041
068700         WHEN EIBAID = DFHPF3                                     06870041
068800             MOVE PC-SHIPPING-MENU-PGM TO PV-TRANSFER-PROGRAM     06880041
068900             PERFORM 8200-XCTL                                    06890041
069000                                                                  06900041
069100         WHEN EIBAID = DFHENTER                                   06910041
069200             INITIALIZE PC038-SHPUNT-FIELDS                       06920041
069300                        PC038-SULBXF-FIELDS                       06930041
069400             MOVE SPACES   TO PC038-SOURCE-ID                     06940041
069500             PERFORM 2000-PROCESS-SCREEN-FIELDS                   06950041
069600             PERFORM 3000-DETERMINE-LAST-ACTIVITY                 06960041
069700             PERFORM 3900-DETERMINE-PC039-DATA                    06970041
069800             PERFORM 4000-DETERMINE-PO-RECEIVER                   06980041
069900             IF PC038-OTBND-TRIP IS > +0                          06990041
070000                 PERFORM 6000-GET-REST-OF-DATA                    07000041
070100             ELSE                                                 07010041
070200                 PERFORM 7000-GET-REST-OF-DATA                    07020043
070300             END-IF                                               07030041
070310                                                                  07031044
070320             PERFORM 7010-GET-DC-SERVICE-STORE                    07032044
070330                                                                  07033044
070400             IF CNDCDR-DOOR-TYP-CDE = 'DS'                        07040041
070500                 MOVE 'SHUT'     TO ADOORO                        07050041
070600             ELSE                                                 07060041
070700                 IF CNDCDR-DOOR-TYP-CDE = 'ST'                    07070041
070800                     MOVE 'STRG'     TO ADOORO                    07080041
070900                 END-IF                                           07090041
071000             END-IF                                               07100041
071100                                                                  07110041
071200             PERFORM 8010-SEND-DATA-ONLY                          07120041
071300             PERFORM 8100-RETURN-TRANID                           07130041
071400                                                                  07140041
071500         WHEN EIBAID = DFHPF1                                     07150041
071600             PERFORM 8020-RECEIVE-MAP                             07160041
071700             MOVE PC887AO  TO PC192-HOST-SAVE-MAP                 07170041
071800             PERFORM 1200-HELP-SCREEN                             07180041
071900                                                                  07190041
072000         WHEN OTHER                                               07200041
072100             MOVE -1  TO ACARTNIDL                                07210041
072200             MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO AMSGLNO          07220041
072300             PERFORM 8000-SEND-MAP                                07230041
072400             PERFORM 8100-RETURN-TRANID                           07240041
072500     END-EVALUATE.                                                07250041
072600                                                                  07260041
072700     GOBACK.                                                      07270041
072800                                                                  07280041
072900 1000-INITIALIZE.                                                 07290041
073000                                                                  07300041
073100     EXEC CICS                                                    07310041
073200         ASSIGN USERID  (PC038-USER-ID)                           07320041
073300                RESP    (PV-CICS-RESPONSE)                        07330041
073400     END-EXEC.                                                    07340041
073500                                                                  07350041
073600     EVALUATE TRUE                                                07360041
073700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07370041
073800             CONTINUE                                             07380041
073900         WHEN OTHER                                               07390041
074000             MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH      07400041
074100             MOVE 'PCKRF887 - UNABLE TO ASSIGN USER-ID'           07410041
074200                                      TO DP013-MESSAGE-TEXT (1)   07420041
074300             SET DP013-LOGIC-ABEND                                07430041
074400                 DP013-ROLLBACK       TO TRUE                     07440041
074500            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                07450041
074600     END-EVALUATE.                                                07460041
074700                                                                  07470041
074800 1200-HELP-SCREEN.                                                07480041
074900     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      07490041
075000     MOVE 'PCKRF887'                  TO PC192-PROGRAM-NAME       07500041
075100     COPY PCPD188.                                                07510041
075200     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      07520041
075300     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     07530041
075400     PERFORM 8220-XCTL-TO-HELP.                                   07540041
075500                                                                  07550041
075600******************************************************************07560041
075700* DETERMINE IF WE ARE RUNNING IN A SINGLE CICS REGION (CICST1),   07570041
075800* OR IF WE ARE RUNNING IN A SPLIT CICS REGION (CICSP1 AND CICSP4).07580041
075900* PV-SYSID WILL BE SPACES IF WE ARE RUNNING IN A SINGLE REGION.   07590041
076000******************************************************************07600041
076100 1300-FIND-SYSTEM-ID.                                             07610041
076200     EXEC CICS                                                    07620041
076300         INQUIRE                                                  07630041
076400             TRANSACTION   (PC-LOGON-TRAN-ID)                     07640041
076500             REMOTESYSTEM  (PV-SYSID)                             07650041
076600             RESP          (PV-CICS-RESPONSE)                     07660041
076700     END-EXEC.                                                    07670041
076800                                                                  07680041
076900     EVALUATE TRUE                                                07690041
077000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07700041
077100             CONTINUE                                             07710041
077200         WHEN OTHER                                               07720041
077300             MOVE '1300-FIND-SYSTEM-ID'                           07730041
077400                 TO DP013-PARAGRAPH                               07740041
077500             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 07750041
077600                 TO DP013-MESSAGE-TEXT (1)                        07760041
077700             SET DP013-CICS-ABEND      TO  TRUE                   07770041
077800             SET DP013-NO-ROLLBACK     TO  TRUE                   07780041
077900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07790041
078000             MOVE 'CICS ERR/HELP DESK ' TO AMSGLNO                07800041
078100             PERFORM 8010-SEND-DATA-ONLY                          07810041
078200             PERFORM 8110-RETURN                                  07820041
078300     END-EVALUATE.                                                07830041
078400                                                                  07840041
078500******************************************************************07850041
078600*  FIND THE LOCATION OF THE TERMINAL OR PC AND THE USERID OF THE  07860041
078700*  PERSON THAT IS CURRENTLY LOGGED ON.  IF WE ARE RUNNING IN      07870041
078800*  CICST1, PV-SYSID WILL BE SPACES BECAUSE THE TERMINAL AND       07880041
078900*  APPLICATION REGIONS ARE BOTH CICST1.  IF WE ARE IN PRODUCTION, 07890041
079000*  PV-SYSID WILL NOT BE SPACES BECAUSE OF THE SPLIT REGION        07900041
079100*  PROCESSING.  IN PRODUCTION, THE APPLICATION REGION IS CICSP4,  07910041
079200*  WHILE THE TERMINAL REGION (WHERE WE NEED TO GET OUR REQUESTED  07920041
079300*  INFORMATION) IS CICSP1.                                        07930041
079400******************************************************************07940041
079500 1400-FIND-LOGON-INFO.                                            07950041
079600     MOVE LENGTH OF DP026-SIGN-ON-INFO                            07960041
079700                    TO  PV-SIGN-ON-INFO-LENGTH.                   07970041
079800     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   07980041
079900     MOVE +1        TO  PV-TS-ITEM.                               07990041
080000                                                                  08000041
080100     IF PV-SYSID = SPACES                                         08010041
080200         EXEC CICS                                                08020041
080300             READQ TS                                             08030041
080400                 QUEUE  (TS-INFO-QUEUE-NAME)                      08040041
080500                 ITEM   (PV-TS-ITEM)                              08050041
080600                 INTO   (DP026-SIGN-ON-INFO)                      08060041
080700                 RESP   (PV-CICS-RESPONSE)                        08070041
080800         END-EXEC                                                 08080041
080900     ELSE                                                         08090041
081000         EXEC CICS                                                08100041
081100             READQ TS                                             08110041
081200                 QUEUE   (TS-INFO-QUEUE-NAME)                     08120041
081300                 SYSID   (PV-SYSID)                               08130041
081400                 ITEM    (PV-TS-ITEM)                             08140041
081500                 INTO    (DP026-SIGN-ON-INFO)                     08150041
081600                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 08160041
081700                 RESP    (PV-CICS-RESPONSE)                       08170041
081800         END-EXEC                                                 08180041
081900     END-IF.                                                      08190041
082000                                                                  08200041
082100     EVALUATE TRUE                                                08210041
082200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08220041
082300             MOVE DP026-LOCATION-NBR  TO  PC038-CURR-OPER-UNT     08230041
082400         WHEN OTHER                                               08240041
082500             MOVE '1400-FIND-LOGON-INFO'                          08250041
082600                 TO DP013-PARAGRAPH                               08260041
082700             MOVE 'UNABLE TO READ LOGON TSQ'                      08270041
082800                 TO DP013-MESSAGE-TEXT (1)                        08280041
082900             SET DP013-CICS-ABEND     TO TRUE                     08290041
083000             SET DP013-NO-ROLLBACK    TO TRUE                     08300041
083100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08310041
083200             MOVE 'SYSTEM ERR/HELP DES' TO AMSGLNO                08320041
083300             PERFORM 8010-SEND-DATA-ONLY                          08330041
083400             PERFORM 8110-RETURN                                  08340041
083500     END-EVALUATE.                                                08350041
083600                                                                  08360041
083700                                                                  08370049
083800 2000-PROCESS-SCREEN-FIELDS.                                      08380041
083900                                                                  08390041
084000     PERFORM 8020-RECEIVE-MAP                                     08400041
084100     PERFORM 2100-EDIT-INPUT.                                     08410041
084200                                                                  08420041
084300     IF PS-VALID-INPUT                                            08430041
084400         SET PS-ERRORS-NO TO TRUE                                 08440041
084500     ELSE                                                         08450041
084600         PERFORM 8010-SEND-DATA-ONLY                              08460041
084700         PERFORM 8100-RETURN-TRANID                               08470041
084800     END-IF.                                                      08480041
084900                                                                  08490041
085000 2100-EDIT-INPUT.                                                 08500041
085100                                                                  08510041
085200     MOVE ACARTNIDI TO PV-CTN                                     08520041
085300     PERFORM 2230-EDIT-CTN                                        08530041
085400     IF  PS-ERRORS-NO                                             08540041
085500         PERFORM 3100-SELECT-OTBND-CART                           08550041
085600         PERFORM 3600-SELECT-TSUCRDV                              08560041
085700         PERFORM 3800-DETERMINE-CREATED                           08570041
085800     END-IF.                                                      08580041
085900                                                                  08590041
086000******************************************************************08600041
086100* EDIT THE CARTON ID ENTERED.                                     08610041
086200******************************************************************08620041
086300 2230-EDIT-CTN.                                                   08630041
086400     MOVE 0 TO PV-CHAR-COUNT.                                     08640041
086600     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         08660041
086700                 BEFORE INITIAL SPACE.                            08670041
086800     EVALUATE TRUE                                                08680041
086900         WHEN PV-CTN = SPACES                                     08690041
087000             SET PS-ERRORS-YES                                    08700041
087100                 PS-INVALID-INPUT        TO TRUE                  08710041
087200             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNIDA             08720041
087300             MOVE -1                     TO ACARTNIDL             08730041
087400             MOVE PC034-PLS-ENT-FLD-MSG  TO AMSGLNO               08740041
087500         WHEN PV-CHAR-COUNT = PC-18 AND                           08750041
087600            ((PV-CTN-FIRST-DIGIT NOT =  PC-0) AND                 08760041
087700             (PV-CTN-FIRST-DIGIT NOT =  PC-4))                    08770041
087800             SET PS-ERRORS-YES                                    08780041
087900                 PS-INVALID-INPUT        TO TRUE                  08790041
088000             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNIDA             08800041
088100             MOVE -1                     TO ACARTNIDL             08810041
088200             MOVE PC034-FIRST-1-NOT-0-MSG TO AMSGLNO              08820041
088300         WHEN PV-CHAR-COUNT < PC-18                               08830041
088400             SET PS-ERRORS-YES                                    08840041
088500                 PS-INVALID-INPUT        TO TRUE                  08850041
088600             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNIDA             08860041
088700             MOVE -1                     TO ACARTNIDL             08870041
088800             MOVE PC034-MORE-DIGITS-REQD TO AMSGLNO               08880041
088900         WHEN OTHER                                               08890041
089000             IF PV-CHAR-COUNT = PC-18                             08900041
089100                 MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD08910041
089200             ELSE                                                 08920041
089300                 IF PV-CHAR-COUNT < PC-18                         08930041
089400                     MOVE PV-CTN          TO DP010I-UNEDITED-FIELD08940041
089500                 ELSE                                             08950041
089600                     MOVE PV-CTN-SCAN-LAST-17                     08960041
089700                                          TO DP010I-UNEDITED-FIELD08970041
089800                 END-IF                                           08980041
089900             END-IF                                               08990041
090000             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 09000041
090100             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               09010041
090200                                                                  09020041
090310             CALL DP010I-NUMERIC-EDIT-ROUTINE                     09031048
090320                         USING DP010I-NUMERIC-EDIT-AREA           09032048
090400                                                                  09040041
090500             IF  DP010I-ERROR-DETECTED                            09050041
090600                 SET PS-ERRORS-YES                                09060041
090700                     PS-INVALID-INPUT        TO TRUE              09070041
090800                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNIDA         09080041
090900                 MOVE -1                     TO ACARTNIDL         09090041
091000                 MOVE PC034-NUMERIC-VALUE-REQ-MSG TO AMSGLNO      09100041
091100             ELSE                                                 09110041
091200                 IF DP010I-NUMERIC-FIELD = ZEROES                 09120041
091300                     SET PS-ERRORS-YES                            09130041
091400                         PS-INVALID-INPUT        TO TRUE          09140041
091500                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNIDA     09150041
091600                     MOVE -1                     TO ACARTNIDL     09160041
091700                     MOVE PC034-MUST-BE-GT-0-MSG  TO AMSGLNO      09170041
091800                 ELSE                                             09180041
091900                      COMPUTE PC038-CARTON-ID-ENTERED  ROUNDED =  09190041
092000                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         09200041
092100                      COMPUTE PV-CTN-N          ROUNDED =         09210041
092200                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         09220041
092300                      SET PS-NOT-KOHLS-BARCODE  TO TRUE           09230041
092400                      EVALUATE TRUE                               09240041
092500                          WHEN PV-CHAR-COUNT = PC-20              09250041
092600                             IF PV-CTN-SCAN-THIRD-DGT  = PC-4     09260041
092700                                SET PS-KOHLS-BARCODE TO TRUE      09270041
092800                                MOVE PV-CTN-SCAN-LAST-18 TO       09280041
092900                                                    PV-CTN-N      09290041
093000                             END-IF                               09300041
093100                          WHEN PV-CHAR-COUNT = PC-18              09310041
093200                             IF PV-CTN-FIRST-DIGIT  = PC-4        09320041
093300                                SET PS-KOHLS-BARCODE TO TRUE      09330041
093400                                MOVE PV-CTN  TO PV-CTN-N          09340041
093500                             END-IF                               09350041
093600                          END-EVALUATE                            09360041
093700                     MOVE PV-CTN-N      TO ACARTNIDO              09370041
093800                                           DK-CARTON-ID           09380041
093900                                           DK-CRTNID2-03-20       09390041
094000                                           PC038-CARTON-ID-ENTERED09400041
094100                     MOVE ZEROES        TO DK-CRTNID2-01-02       09410041
094200                     MOVE SPACES        TO DK-CRTNID2-21-22       09420041
094300                 END-IF                                           09430041
094400             END-IF                                               09440041
094500     END-EVALUATE.                                                09450041
094600     IF PS-KOHLS-BARCODE AND PC038-SULBXF-BARCODE = SPACES        09460041
094700         MOVE DK-CARTON-ID-2 TO PC038-SULBXF-BARCODE              09470041
094800     END-IF.                                                      09480041
094900                                                                  09490041
095000*-----------------------------------------------------------------09500041
095100* DETERMINE LAST ACTIVITY FOR CARTON (CHECK IN REVERSE ORDER)     09510041
095200*-----------------------------------------------------------------09520041
095300 3000-DETERMINE-LAST-ACTIVITY.                                    09530041
095400                                                                  09540041
095500                                                                  09550041
095600     INITIALIZE  PC046-COMMAREA-REC.                              09560041
095700     SET   PC046-FROM-CRTN-STAT  TO  TRUE.                        09570041
095800     MOVE  DK-CARTON-ID          TO  PC046-CARTON-ID.             09580041
095900                                                                  09590041
096000                                                                  09600041
096100     CALL PC046-CARTON-STATUS-MODULE                              09610041
096200             USING DFHEIBLK                                       09620041
096300             PC046-COMMAREA                                       09630041
096400             PC046-COMMAREA-REC                                   09640041
096500     END-CALL                                                     09650041
096600                                                                  09660041
096700     PERFORM 3050-VALIDATE-STATUS-CALL.                           09670041
096800                                                                  09680041
096900*----------------------------------------------------------------*09690041
097000* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*09700041
097100*----------------------------------------------------------------*09710041
097200 3050-VALIDATE-STATUS-CALL.                                       09720041
097300                                                                  09730041
097400     EVALUATE TRUE                                                09740041
097500         WHEN PC046-ERROR                                         09750041
097600             SET  PS-ERRORS-YES          TO  TRUE                 09760041
097700             MOVE PM-CICS-ABEND-MSG      TO  AMSGLNO              09770041
097800             PERFORM 9904-WRITE-CRTN-MODULE-MSG                   09780041
097900                                                                  09790041
098000         WHEN PC046-INVALID-SQL                                   09800041
098100             SET  PS-ERRORS-YES          TO  TRUE                 09810041
098200             MOVE PM-DATABASE-ERROR      TO  AMSGLNO              09820041
098300             PERFORM 9904-WRITE-CRTN-MODULE-MSG                   09830041
098400                                                                  09840041
098500         WHEN PC046-DATABASE-BUSY                                 09850041
098600             SET  PS-ERRORS-YES          TO  TRUE                 09860041
098700             MOVE PM-DATABASE-BUSY       TO  AMSGLNO              09870041
098800             PERFORM 9904-WRITE-CRTN-MODULE-MSG                   09880041
098900                                                                  09890041
099000         WHEN PC046-CRTN-STAT-ERROR                               09900041
099100             SET  PS-ERRORS-YES          TO  TRUE                 09910041
099200             MOVE PM-CARTON-STATUS-ERROR TO  AMSGLNO              09920041
099300                                                                  09930041
099400         WHEN PC046-SUCCESSFUL                                    09940041
099500             MOVE  PC046-CRTN-STATUS     TO  PC038-STATUS         09950041
099600             MOVE  PC046-CRTN-STAT-TMST  TO  PV-DB2-TIMESTAMP     09960041
099700             MOVE  PV-DB2-TMST-DATE      TO  PC038-STATUS-DATE    09970041
099800             MOVE  PC046-STATUS-USERID   TO  PC038-STATUS-USERID  09980041
099900             MOVE  PC046-OTBD-TRIP-ID    TO  PC038-OTBND-TRIP     09990041
100000             MOVE  PC046-CRTN-STAT-DESC  TO  PC038-CRTN-STAT-DESC 10000041
100100                                             ALSTACTO             10010041
100200                                                                  10020041
100300         WHEN OTHER                                               10030041
100400             SET  PS-ERRORS-YES          TO  TRUE                 10040041
100500             MOVE  PM-CICS-ABEND-MSG     TO  AMSGLNO              10050041
100600     END-EVALUATE.                                                10060041
100700                                                                  10070041
100800                                                                  10080041
100900*----------------------------------------------------------------*10090041
101000*  CHECK THE SHIPPING UNIT TABLE TO VERIFY THE CARTON ID/BARCODE *10100041
101100*  ENTERED IS VALID.                                              10110041
101200*----------------------------------------------------------------*10120041
101300 3100-SELECT-OTBND-CART.                                          10130041
101400                                                                  10140041
101500     EXEC SQL                                                     10150041
101600        SELECT   SHIPT_UNT_ID                                     10160041
101700                ,ORGN_LOC_NBR                                     10170041
101800                ,DEST_LOC_NBR                                     10180041
101900                ,CART_SRC_CDE                                     10190041
102000                ,MSTR_CART_IND                                    10200041
102100                ,PRNT_CART_ID                                     10210041
102200                ,ORIG_CART_ID                                     10220041
102300                ,ACTV_IND                                         10230041
102400                ,CRE_DTE                                          10240041
102500                ,CRE_TM                                           10250041
102600                ,CRE_USR_ID                                       10260041
102700                ,CART_TYP_CDE                                     10270041
102800           INTO :SUT00024-SHIPT-UNT-ID,                           10280041
102900                :SUT00024-ORGN-LOC-NBR,                           10290041
103000                :SUT00024-DEST-LOC-NBR,                           10300041
103100                :SUT00024-CART-SRC-CDE,                           10310041
103200                :SUT00024-MSTR-CART-IND,                          10320041
103300                :SUT00024-PRNT-CART-ID,                           10330041
103400                :SUT00024-ORIG-CART-ID,                           10340041
103500                :SUT00024-ACTV-IND,                               10350041
103600                :SUT00024-CRE-DTE,                                10360041
103700                :SUT00024-CRE-TM,                                 10370041
103800                :SUT00024-CRE-USR-ID,                             10380041
103900                :SUT00024-CART-TYP-CDE                            10390041
104000          FROM  SUT_OTBND_CART                                    10400041
104100         WHERE  SHIPT_UNT_ID   = :DK-CARTON-ID                    10410041
104200           AND  ACTV_IND       = 'Y'                              10420041
104300                                                                  10430041
104400     END-EXEC.                                                    10440041
104500                                                                  10450041
104600     EVALUATE TRUE                                                10460041
104700         WHEN SQLCODE = +0                                        10470041
104800              SET PC038-ON-TSHPUNT      TO TRUE                   10480041
104900              MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID       10490041
105000              MOVE SUT00024-SHIPT-UNT-ID TO                       10500041
105100                                  PC038-SHPUNT-SHIPT-UNT-ID       10510041
105200              IF  SUT00024-CART-SRC-CDE  =  'ASN'                 10520041
105300                  MOVE 'CKN'                                      10530041
105400                    TO  SUT00024-CART-SRC-CDE                     10540041
105500              END-IF                                              10550041
105600              PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038              10560041
105700         WHEN SQLCODE = +100                                      10570041
105800              PERFORM 3300-SELECT-OTBND-CART                      10580041
105900                                                                  10590041
106000         WHEN SQLWARN0 NOT = SPACES                               10600041
106100         WHEN SQLCODE < +0                                        10610041
106200         WHEN SQLCODE > +0                                        10620041
106300             MOVE '3100-SELECT-OTBND-CART' TO DP013-PARAGRAPH     10630041
106400             MOVE 'VALIDATE CARTON ID/BARCODE'                    10640041
106500                                        TO DP013-MESSAGE-TEXT (1) 10650041
106600             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          10660041
106700             MOVE SQLCA      TO DP013-SQLCA                       10670041
106800             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          10680041
106900             SET DP013-DB2-ABEND                                  10690041
107000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10700041
107100     END-EVALUATE.                                                10710041
107200                                                                  10720041
107300*----------------------------------------------------------------*10730041
107400*  MOVE DATA FROM SUT_OTBND_CART TO PC038-SHPUNT-FIELDS.         *10740041
107500*----------------------------------------------------------------*10750041
107600 3200-MOVE-OTBD-CART-TO-PCWS038.                                  10760041
107700                                                                  10770041
107800     MOVE SUT00024-ORGN-LOC-NBR TO PC038-SHPUNT-ORGN-OPER.        10780041
107900     MOVE SUT00024-DEST-LOC-NBR TO PC038-SHPUNT-DEST-OPER.        10790041
108000     MOVE SUT00024-CART-SRC-CDE TO PC038-SOURCE-ID                10800041
108100                                     PC038-SHPUNT-SOURCE-ID.      10810041
108200     MOVE SUT00024-MSTR-CART-IND  TO PC038-SHPUNT-HIER-LVL-CDE.   10820041
108300     MOVE SUT00024-PRNT-CART-ID TO PC038-NEXT-SHIPT-UNT-ID.       10830041
108400     MOVE SUT00024-ORIG-CART-ID TO PC038-ORIG-SHIPT-UNT-ID.       10840041
108500     MOVE SUT00024-ACTV-IND        TO PC038-SHPUNT-ACTV-IND.      10850041
108600     MOVE SUT00024-CRE-DTE         TO PC038-SHPUNT-CRE-DATE.      10860041
108700     MOVE SUT00024-CRE-TM          TO PC038-SHPUNT-CRE-TIME.      10870041
108800     MOVE SUT00024-CRE-USR-ID      TO PC038-SHPUNT-CRE-USR-ID.    10880041
108900     MOVE SUT00024-CART-TYP-CDE    TO PC038-SHPUNT-CART-TYP-CDE.  10890041
109000                                                                  10900041
109100                                                                  10910041
109200*----------------------------------------------------------------*10920041
109300*  CHECK THE SHIPPING UNIT CROSS REFERENCE TABLE TO CHECK IF THE  10930041
109400*  CARTON ID/BARCODE ENTERED IS THERE                             10940041
109500*----------------------------------------------------------------*10950041
109600 3300-SELECT-OTBND-CART.                                          10960041
109700                                                                  10970041
109800     EXEC SQL                                                     10980041
109900        SELECT   SHIPT_UNT_ID                                     10990041
110000                ,ORGN_LOC_NBR                                     11000041
110100                ,DEST_LOC_NBR                                     11010041
110200                ,CART_SRC_CDE                                     11020041
110300                ,MSTR_CART_IND                                    11030041
110400                ,PRNT_CART_ID                                     11040041
110500                ,ORIG_CART_ID                                     11050041
110600                ,ACTV_IND                                         11060041
110700                ,CRE_DTE                                          11070041
110800                ,CRE_TM                                           11080041
110900                ,CRE_USR_ID                                       11090041
111000                ,CART_TYP_CDE                                     11100041
111100           INTO :SUT00024-SHIPT-UNT-ID,                           11110041
111200                :SUT00024-ORGN-LOC-NBR,                           11120041
111300                :SUT00024-DEST-LOC-NBR,                           11130041
111400                :SUT00024-CART-SRC-CDE,                           11140041
111500                :SUT00024-MSTR-CART-IND,                          11150041
111600                :SUT00024-PRNT-CART-ID,                           11160041
111700                :SUT00024-ORIG-CART-ID,                           11170041
111800                :SUT00024-ACTV-IND,                               11180041
111900                :SUT00024-CRE-DTE,                                11190041
112000                :SUT00024-CRE-TM,                                 11200041
112100                :SUT00024-CRE-USR-ID,                             11210041
112200                :SUT00024-CART-TYP-CDE                            11220041
112300          FROM  SUT_OTBND_CART                                    11230041
112400         WHERE  ORIG_CART_ID   = :DK-CARTON-ID                    11240041
112500           AND  ACTV_IND       = 'Y'                              11250041
112600                                                                  11260041
112700     END-EXEC.                                                    11270041
112800                                                                  11280041
112900     EVALUATE TRUE                                                11290041
113000         WHEN SQLCODE = +0                                        11300041
113100              SET PC038-ON-TSHPUNT      TO TRUE                   11310041
113200              MOVE SUT00024-ORIG-CART-ID TO DK-SHIPT-UNT-ID       11320041
113300              MOVE SUT00024-ORIG-CART-ID TO                       11330041
113400                                  PC038-SHPUNT-SHIPT-UNT-ID       11340041
113500              MOVE  ZEROES                                        11350041
113600                TO  PV-BARCODE-1-2                                11360041
113700              MOVE  SUT00024-SHIPT-UNT-ID                         11370041
113800                TO  PV-BARCODE-3-20                               11380041
113900              MOVE  PV-BARCODE                                    11390041
114000                TO  PC038-SULBXF-BARCODE                          11400041
114100              PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038              11410041
114200         WHEN SQLCODE = -811                                      11420041
114300              SET PS-REC-FOUND TO TRUE                            11430041
114400              PERFORM 3310-PROCESS-DUPLICATE                      11440041
114500              MOVE DK-CARTON-ID    TO PC038-SHPUNT-SHIPT-UNT-ID   11450041
114600              IF PS-NO-REC-FOUND                                  11460041
114700                  PERFORM 3350-SELECT-TSULBXF                     11470041
114800              END-IF                                              11480041
114900         WHEN SQLCODE = +100                                      11490041
115000              MOVE DK-CARTON-ID    TO PC038-SHPUNT-SHIPT-UNT-ID   11500041
115100              PERFORM 3350-SELECT-TSULBXF                         11510041
115200                                                                  11520041
115300         WHEN SQLWARN0 NOT = SPACES                               11530041
115400         WHEN SQLCODE < +0                                        11540041
115500         WHEN SQLCODE > +0                                        11550041
115600             MOVE '3300-SELECT-OTBND-CART' TO DP013-PARAGRAPH     11560041
115700             MOVE 'VALIDATE CARTON ID/BARCODE'                    11570041
115800                                        TO DP013-MESSAGE-TEXT (1) 11580041
115900             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          11590041
116000             MOVE SQLCA      TO DP013-SQLCA                       11600041
116100             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          11610041
116200             SET DP013-DB2-ABEND                                  11620041
116300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11630041
116400     END-EVALUATE.                                                11640041
116500                                                                  11650041
116600                                                                  11660041
116700 3310-PROCESS-DUPLICATE.                                          11670041
116800     PERFORM 3320-OPEN-DUPLICATE-CURSOR.                          11680041
116900     PERFORM 3325-FETCH-DUPLICATE-CURSOR.                         11690041
117000     PERFORM 3340-CLOSE-DUPLICATE-CURSOR.                         11700041
117010                                                                  11701049
117100 3320-OPEN-DUPLICATE-CURSOR.                                      11710041
117200     EXEC SQL                                                     11720041
117300         OPEN DUP-ACTIVE-CSR                                      11730041
117400     END-EXEC.                                                    11740041
117500                                                                  11750041
117600     EVALUATE TRUE                                                11760041
117700          WHEN SQLCODE = +0                                       11770041
117800                 CONTINUE                                         11780041
117900          WHEN SQLCODE NOT EQUAL +0                               11790041
118000               MOVE '3320-OPEN-DUPLICATE-CURSOR'                  11800041
118100                                               TO DP013-PARAGRAPH 11810041
118200               MOVE 'ERROR OPENING THE CURSOR'                    11820041
118300                                        TO DP013-MESSAGE-TEXT (1) 11830041
118400               MOVE SQLCA        TO DP013-SQLCA                   11840041
118500               MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)      11850041
118600               SET DP013-DB2-ABEND                                11860041
118700                   DP013-ROLLBACK   TO TRUE                       11870041
118800               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             11880041
118900     END-EVALUATE.                                                11890041
119000                                                                  11900041
119100 3325-FETCH-DUPLICATE-CURSOR.                                     11910041
119200                                                                  11920041
119300     EXEC SQL                                                     11930041
119400         FETCH DUP-ACTIVE-CSR                                     11940041
119500         INTO :SULBXF-BRCDE-NBR                                   11950041
119600         ,    :SULBXF-LAST-STAT-CHG-TMST                          11960041
119700     END-EXEC.                                                    11970041
119800                                                                  11980041
119900     EVALUATE TRUE                                                11990041
120000         WHEN SQLCODE = +0                                        12000041
120100             MOVE SULBXF-BRCDE-NBR   TO PV-BARCODE-22             12010041
120200             MOVE PV-BARCODE-22-3-20    TO DK-CARTON-ID-XREF      12020041
120300             PERFORM 3330-SELECT-WITH-TSULBXF                     12030041
120400         WHEN SQLCODE = +100                                      12040041
120500             SET PS-NO-REC-FOUND TO TRUE                          12050041
120600         WHEN OTHER                                               12060041
120700           MOVE '3325-FETCH-DUPLICATE-CURSOR'                     12070041
120800                                           TO DP013-PARAGRAPH     12080041
120900           MOVE 'ERROR FETCHING THE CURSOR'                       12090041
121000                                    TO DP013-MESSAGE-TEXT (1)     12100041
121100           MOVE SQLCA        TO DP013-SQLCA                       12110041
121200           MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)          12120041
121300           SET DP013-DB2-ABEND                                    12130041
121400               DP013-ROLLBACK   TO TRUE                           12140041
121500           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 12150041
121600             CONTINUE                                             12160041
121700     END-EVALUATE.                                                12170041
121800                                                                  12180041
121900*----------------------------------------------------------------*12190041
122000*  CHECK THE SHIPPING UNIT CROSS REFERENCE TABLE TO CHECK IF THE  12200041
122100*  CARTON ID/BARCODE ENTERED IS THERE                             12210041
122200*----------------------------------------------------------------*12220041
122300 3330-SELECT-WITH-TSULBXF.                                        12230041
122400                                                                  12240041
122500     EXEC SQL                                                     12250041
122600        SELECT   A.SHIPT_UNT_ID                                   12260041
122700                ,A.ORGN_LOC_NBR                                   12270041
122800                ,A.DEST_LOC_NBR                                   12280041
122900                ,A.CART_SRC_CDE                                   12290041
123000                ,A.MSTR_CART_IND                                  12300041
123100                ,A.PRNT_CART_ID                                   12310041
123200                ,A.ORIG_CART_ID                                   12320041
123300                ,A.ACTV_IND                                       12330041
123400                ,A.CRE_DTE                                        12340041
123500                ,A.CRE_TM                                         12350041
123600                ,A.CRE_USR_ID                                     12360041
123700                ,A.CART_TYP_CDE                                   12370041
123800           INTO :SUT00024-SHIPT-UNT-ID,                           12380041
123900                :SUT00024-ORGN-LOC-NBR,                           12390041
124000                :SUT00024-DEST-LOC-NBR,                           12400041
124100                :SUT00024-CART-SRC-CDE,                           12410041
124200                :SUT00024-MSTR-CART-IND,                          12420041
124300                :SUT00024-PRNT-CART-ID,                           12430041
124400                :SUT00024-ORIG-CART-ID,                           12440041
124500                :SUT00024-ACTV-IND,                               12450041
124600                :SUT00024-CRE-DTE,                                12460041
124700                :SUT00024-CRE-TM,                                 12470041
124800                :SUT00024-CRE-USR-ID,                             12480041
124900                :SUT00024-CART-TYP-CDE                            12490041
125000          FROM  SUT_OTBND_CART A                                  12500041
125100         WHERE  A.SHIPT_UNT_ID   = :DK-CARTON-ID-XREF             12510041
125200           AND  A.ACTV_IND       = 'Y'                            12520041
125300                                                                  12530041
125400     END-EXEC.                                                    12540041
125500                                                                  12550041
125600     EVALUATE TRUE                                                12560041
125700         WHEN SQLCODE = +0                                        12570041
125800              MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID       12580041
125900              MOVE SUT00024-SHIPT-UNT-ID TO                       12590041
126000                                  PC038-SHPUNT-SHIPT-UNT-ID       12600041
126100              MOVE  ZEROES                                        12610041
126200                TO  PV-BARCODE-1-2                                12620041
126300              MOVE  SUT00024-SHIPT-UNT-ID                         12630041
126400                TO  PV-BARCODE-3-20                               12640041
126500              MOVE  PV-BARCODE                                    12650041
126600                TO  PC038-SULBXF-BARCODE                          12660041
126700              PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038              12670041
126800         WHEN SQLCODE = +100                                      12680041
126900              PERFORM 3350-SELECT-TSULBXF                         12690041
127000                                                                  12700041
127100         WHEN SQLWARN0 NOT = SPACES                               12710041
127200         WHEN SQLCODE < +0                                        12720041
127300         WHEN SQLCODE > +0                                        12730041
127400             MOVE '3330-SELECT-WITH-TSULBXF' TO DP013-PARAGRAPH   12740041
127500             MOVE 'VALIDATE CARTON ID'                            12750041
127600                                        TO DP013-MESSAGE-TEXT (1) 12760041
127700             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          12770041
127800             MOVE SQLCA      TO DP013-SQLCA                       12780041
127900             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          12790041
128000             SET DP013-DB2-ABEND                                  12800041
128100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12810041
128200     END-EVALUATE.                                                12820041
128300                                                                  12830041
128400 3340-CLOSE-DUPLICATE-CURSOR.                                     12840041
128500                                                                  12850041
128600     EXEC SQL                                                     12860041
128700         CLOSE DUP-ACTIVE-CSR                                     12870041
128800     END-EXEC                                                     12880041
128900                                                                  12890041
129000     EVALUATE TRUE                                                12900041
129100          WHEN SQLCODE = +0                                       12910041
129200                 CONTINUE                                         12920041
129300          WHEN SQLCODE NOT EQUAL +0                               12930041
129400               MOVE '3340-CLOSE-DUPLICATE-CURSOR'                 12940041
129500                                               TO DP013-PARAGRAPH 12950041
129600               MOVE 'ERROR CLOSING THE CURSOR'                    12960041
129700                                        TO DP013-MESSAGE-TEXT (1) 12970041
129800               MOVE SQLCA        TO DP013-SQLCA                   12980041
129900               MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)      12990041
130000               SET DP013-DB2-ABEND                                13000041
130100                   DP013-ROLLBACK   TO TRUE                       13010041
130200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             13020041
130300     END-EVALUATE.                                                13030041
130400                                                                  13040041
130500*----------------------------------------------------------------*13050041
130600*  CHECK IF VENDOR CARTON CHECKED IN AND CREATED P2L LABEL        13060041
130700*----------------------------------------------------------------*13070041
130800 3350-SELECT-TSULBXF.                                             13080041
130900                                                                  13090041
131000     EXEC SQL                                                     13100041
131100        SELECT BRCDE_NBR                                          13110041
131200              ,CRE_TMST                                           13120041
131300              ,CART_LBL_TYP_CDE                                   13130041
131400              ,DEST_OPER_UNT_ID                                   13140041
131500              ,STAT_CDE                                           13150041
131600          INTO :SULBXF-BRCDE-NBR                                  13160041
131700              ,:SULBXF-CRE-TMST                                   13170041
131800              ,:SULBXF-CART-LBL-TYP-CDE                           13180041
131900              ,:SULBXF-DEST-OPER-UNT-ID                           13190041
132000              ,:SULBXF-STAT-CDE                                   13200041
132100          FROM  TSULBXF                                           13210041
132200         WHERE  SHIPT_UNT_ID     = :DK-CARTON-ID                  13220041
132300     END-EXEC.                                                    13230041
132400                                                                  13240041
132500     EVALUATE TRUE                                                13250041
132600         WHEN SQLCODE = +0                                        13260041
132700              MOVE SULBXF-BRCDE-NBR                               13270041
132800                TO PC038-SULBXF-BARCODE                           13280041
132900              SET  PC038-CHECKED-IN                               13290041
133000                TO  TRUE                                          13300041
133100              MOVE 'ASN'                                          13310041
133200                TO  SUT00024-CART-SRC-CDE                         13320041
133300                    PC038-SOURCE-ID                               13330041
133400              MOVE  DK-CARTON-ID                                  13340041
133500                TO  PC038-SHPUNT-SHIPT-UNT-ID                     13350041
133600              MOVE  SULBXF-CRE-TMST                               13360041
133700                TO  PC038-SHPUNT-CRE-DATE                         13370041
133800              MOVE  SULBXF-CART-LBL-TYP-CDE                       13380041
133900                TO  PC038-SULBXF-CART-TYP-CDE                     13390041
134000              MOVE  SULBXF-DEST-OPER-UNT-ID                       13400041
134100                TO  PC038-SULBXF-DEST-OPER-UNT                    13410041
134200                    PC038-SHPUNT-DEST-OPER                        13420041
134300              MOVE  SULBXF-STAT-CDE                               13430041
134400                TO  PC038-SULBXF-ACTV-IND                         13440041
134500                                                                  13450041
134600         WHEN SQLCODE = +100                                      13460041
134700              PERFORM 3600-SELECT-TSUCRDV                         13470041
134800                                                                  13480041
134900         WHEN SQLWARN0 NOT = SPACES                               13490041
135000         WHEN SQLCODE < +0                                        13500041
135100         WHEN SQLCODE > +0                                        13510041
135200             MOVE '3600-SELECT-TSUCRDV' TO DP013-PARAGRAPH        13520041
135300             MOVE 'SELECT DIVERT TABLE'                           13530041
135400                             TO DP013-MESSAGE-TEXT (1)            13540041
135500             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          13550041
135600             MOVE SQLCA      TO DP013-SQLCA                       13560041
135700             MOVE 'TSUCRDV'  TO DP013-DB2-TABLE-NAME (1)          13570041
135800             SET DP013-DB2-ABEND                                  13580041
135900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13590041
136000     END-EVALUATE.                                                13600041
136100                                                                  13610041
136200                                                                  13620049
136300*----------------------------------------------------------------*13630041
136400*  SELECT SHIPUNT DATA WHEN BARCODE ENTERED FOUND ON CROSS       *13640041
136500*  REFERENCE.                                                     13650041
136600*----------------------------------------------------------------*13660041
136700 3500-SELECT-OTBND-CART.                                          13670041
136800                                                                  13680041
136900     EXEC SQL                                                     13690041
137000        SELECT   SHIPT_UNT_ID                                     13700041
137100                ,ORGN_LOC_NBR                                     13710041
137200                ,DEST_LOC_NBR                                     13720041
137300                ,CART_SRC_CDE                                     13730041
137400                ,MSTR_CART_IND                                    13740041
137500                ,PRNT_CART_ID                                     13750041
137600                ,ORIG_CART_ID                                     13760041
137700                ,ACTV_IND                                         13770041
137800                ,CRE_DTE                                          13780041
137900                ,CRE_TM                                           13790041
138000                ,CRE_USR_ID                                       13800041
138100                ,CART_TYP_CDE                                     13810041
138200           INTO :SUT00024-SHIPT-UNT-ID,                           13820041
138300                :SUT00024-ORGN-LOC-NBR,                           13830041
138400                :SUT00024-DEST-LOC-NBR,                           13840041
138500                :SUT00024-CART-SRC-CDE,                           13850041
138600                :SUT00024-MSTR-CART-IND,                          13860041
138700                :SUT00024-PRNT-CART-ID,                           13870041
138800                :SUT00024-ORIG-CART-ID,                           13880041
138900                :SUT00024-ACTV-IND,                               13890041
139000                :SUT00024-CRE-DTE,                                13900041
139100                :SUT00024-CRE-TM,                                 13910041
139200                :SUT00024-CRE-USR-ID,                             13920041
139300                :SUT00024-CART-TYP-CDE                            13930041
139400          FROM  SUT_OTBND_CART                                    13940041
139500         WHERE  SHIPT_UNT_ID   = :DK-CARTON-ID                    13950041
139600     END-EXEC.                                                    13960041
139700                                                                  13970041
139800     EVALUATE TRUE                                                13980041
139900         WHEN SQLCODE = +0                                        13990041
140000                 PERFORM 3200-MOVE-OTBD-CART-TO-PCWS038           14000041
140100         WHEN SQLCODE = +100                                      14010041
140200              CONTINUE                                            14020041
140300                                                                  14030041
140400         WHEN SQLWARN0 NOT = SPACES                               14040041
140500         WHEN SQLCODE < +0                                        14050041
140600         WHEN SQLCODE > +0                                        14060041
140700             MOVE '3500-SELECT-OTBND-CART' TO DP013-PARAGRAPH     14070041
140800             MOVE 'VALIDATE CARTON ID/BARCODE'                    14080041
140900                             TO DP013-MESSAGE-TEXT (1)            14090041
141000             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          14100041
141100             MOVE SQLCA      TO DP013-SQLCA                       14110041
141200             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)          14120041
141300             SET DP013-DB2-ABEND                                  14130041
141400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14140041
141500     END-EVALUATE.                                                14150041
141600                                                                  14160041
141700*----------------------------------------------------------------*14170041
141800*  CHECK THE CARTON DIVERT TABLE TO SEE IF THE CARTON WAS DIVERTED14180041
141900*----------------------------------------------------------------*14190041
142000 3600-SELECT-TSUCRDV.                                             14200041
142100                                                                  14210041
142200     EXEC SQL                                                     14220041
142300        SELECT   COUNT(*)                                         14230041
142400          INTO :PV-DIVERT-COUNT                                   14240041
142500          FROM  TSUCRDV A                                         14250041
142600            ,   TCNDCDR B                                         14260041
142700            ,   TCNDRTY C                                         14270041
142800         WHERE  A.BRCDE_NBR      = :DK-CARTON-ID-2                14280041
142900           AND  A.ACTV_CDE       = 'A'                            14290041
143000           AND  A.OPER_UNT_ID    = B.OPER_UNT_ID                  14300041
143100           AND  A.DOOR_ID        = B.DOOR_ID                      14310041
143200           AND  B.DOOR_TYP_CDE   = C.DOOR_TYP_CDE                 14320041
143300           AND  C.DIVERT_TYP_CDE = 'D'                            14330041
143400     END-EXEC.                                                    14340041
143500                                                                  14350041
143600     EVALUATE TRUE                                                14360041
143700         WHEN SQLCODE = +0                                        14370041
143800              IF PV-DIVERT-COUNT > 0                              14380041
143900                  MOVE 'CARTON DIVERTED'      TO ADVRTMSGO        14390041
144000                  MOVE PV-DIVERT-COUNT        TO PV-DIVERTS-Z     14400041
144100                  MOVE PV-DIVERTS-Z           TO ADIVERTSO        14410041
144200                  PERFORM 3700-SELECT-TSUCRDV-LATEST              14420041
144300                  PERFORM 3750-SELECT-TSUCRDV-DEST                14430041
144400              ELSE                                                14440041
144500                  MOVE 'NO ACTIVE DIVERT'     TO ADVRTMSGO        14450041
144600                  MOVE 0                      TO PV-DIVERTS-Z     14460041
144700                  MOVE PV-DIVERTS-Z           TO ADIVERTSO        14470041
144800                  MOVE SPACES                 TO ADTETIMO         14480041
144900                  MOVE SPACES                 TO ADSTOREO         14490044
145000                  MOVE SUT00024-DEST-LOC-NBR  TO ASTOREO          14500041
145010                  MOVE SPACES                 TO ADCO             14501044
145100              END-IF                                              14510041
145200         WHEN SQLCODE = -305                                      14520041
145300              MOVE 'NO ACTIVE DIVERT'     TO ADVRTMSGO            14530041
145400              MOVE 0                      TO PV-DIVERTS-Z         14540041
145500              MOVE PV-DIVERTS-Z           TO ADIVERTSO            14550041
145600              MOVE SUT00024-DEST-LOC-NBR  TO ASTOREO              14560041
145610              MOVE SPACES                 TO ADCO                 14561044
145700         WHEN SQLWARN0 NOT = SPACES                               14570041
145800         WHEN SQLCODE < +0                                        14580041
145900         WHEN SQLCODE > +0                                        14590041
146000             MOVE '3600-SELECT-TSUCRDV' TO DP013-PARAGRAPH        14600041
146100             MOVE 'SELECT DIVERT TABLE'                           14610041
146200                             TO DP013-MESSAGE-TEXT (1)            14620041
146300             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          14630041
146400             MOVE SQLCA      TO DP013-SQLCA                       14640041
146500             MOVE 'TSUCRDV'  TO DP013-DB2-TABLE-NAME (1)          14650041
146600             SET DP013-DB2-ABEND                                  14660041
146700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14670041
146800     END-EVALUATE.                                                14680041
146900                                                                  14690041
147000*----------------------------------------------------------------*14700041
147100*  DETERMINE THE DATE AND TIME FROM THE MOST CURRENT DIVERT       14710041
147200*----------------------------------------------------------------*14720041
147300 3700-SELECT-TSUCRDV-LATEST.                                      14730041
147400                                                                  14740041
147500     EXEC SQL                                                     14750041
147600        SELECT  MAX(DIVERT_TMST)                                  14760041
147700          INTO :SUCRDV-DIVERT-TMST                                14770041
147800          FROM  TSUCRDV                                           14780041
147900         WHERE  BRCDE_NBR        = :DK-CARTON-ID-2                14790041
148000     END-EXEC.                                                    14800041
148100                                                                  14810041
148200     EVALUATE TRUE                                                14820041
148300         WHEN SQLCODE = +0                                        14830041
148400              MOVE SUCRDV-DIVERT-TMST        TO  PV-DB2-TIMESTAMP214840041
148500              MOVE PV-MONTH                  TO  PV-DB2-DATE-MM   14850041
148600              MOVE PV-DAY                    TO  PV-DB2-DATE-DD   14860041
148700              MOVE PV-YEAR                   TO  PV-DB2-DATE-YY   14870041
148800              MOVE PV-HOUR                   TO  PV-DB2-TIME-HH   14880041
148900              MOVE PV-MINUTE                 TO  PV-DB2-TIME-MM   14890041
149000              MOVE PV-SECONDS                TO  PV-DB2-TIME-SS   14900041
149100              MOVE PV-DB2-REFORMAT-DATE-TIME TO  ADTETIMO         14910041
149200         WHEN SQLWARN0 NOT = SPACES                               14920041
149300         WHEN SQLCODE < +0                                        14930041
149400         WHEN SQLCODE > +0                                        14940041
149500             MOVE '3700-SELECT-TSUCRDV-LATEST'                    14950041
149600                                        TO DP013-PARAGRAPH        14960041
149700             MOVE 'SELECT DIVERT TABLE'                           14970041
149800                             TO DP013-MESSAGE-TEXT (1)            14980041
149900             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          14990041
150000             MOVE SQLCA      TO DP013-SQLCA                       15000041
150100             MOVE 'TSUCRDV'  TO DP013-DB2-TABLE-NAME (1)          15010041
150200             SET DP013-DB2-ABEND                                  15020041
150300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15030041
150400     END-EVALUATE.                                                15040041
150500                                                                  15050041
150600*----------------------------------------------------------------*15060041
150700*  DETERMINE THE DEST OPER UNIT FROM THE MOST CURRENT DIVERT      15070041
150800*----------------------------------------------------------------*15080041
150900 3750-SELECT-TSUCRDV-DEST.                                        15090041
151000                                                                  15100041
151100     EXEC SQL                                                     15110041
151200        SELECT  A.DEST_OPER_UNT_ID                                15120041
151300           ,    B.DOOR_TYP_CDE                                    15130041
151400          INTO :SUCRDV-DEST-OPER-UNT-ID                           15140041
151500           ,   :CNDCDR-DOOR-TYP-CDE                               15150041
151600          FROM  TSUCRDV A                                         15160041
151700            ,   TCNDCDR B                                         15170041
151800         WHERE  A.BRCDE_NBR      = :DK-CARTON-ID-2                15180041
151900          AND   A.DIVERT_TMST    = :SUCRDV-DIVERT-TMST            15190041
152000          AND   A.DOOR_ID        = B.DOOR_ID                      15200041
152100          AND   A.OPER_UNT_ID    = B.OPER_UNT_ID                  15210041
152200     END-EXEC.                                                    15220041
152300                                                                  15230041
152400     EVALUATE TRUE                                                15240041
152500         WHEN SQLCODE = +0                                        15250041
152600              MOVE SUCRDV-DEST-OPER-UNT-ID   TO  PV-STORE         15260041
152800              MOVE PV-STORE                  TO  ASTOREO          15280041
152900         WHEN SQLWARN0 NOT = SPACES                               15290041
153000         WHEN SQLCODE < +0                                        15300041
153100         WHEN SQLCODE > +0                                        15310041
153200             MOVE '3750-SELECT-TSUCRDV-DEST'                      15320041
153300                                        TO DP013-PARAGRAPH        15330041
153400             MOVE 'SELECT DIVERT TABLE'                           15340041
153500                             TO DP013-MESSAGE-TEXT (1)            15350041
153600             MOVE DK-CARTON-ID TO DP013-MESSAGE-TEXT (2)          15360041
153700             MOVE SQLCA      TO DP013-SQLCA                       15370041
153800             MOVE 'TSUCRDV'  TO DP013-DB2-TABLE-NAME (1)          15380041
153900             SET DP013-DB2-ABEND                                  15390041
154000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15400041
154100     END-EVALUATE.                                                15410041
154200                                                                  15420041
154300 3800-DETERMINE-CREATED.                                          15430041
154400     EVALUATE TRUE                                                15440041
154500         WHEN PC038-SRC-ASN                                       15450041
154600              MOVE PC-VENDOR-ASN TO PV-CREATE                     15460041
154700         WHEN PC038-SRC-CHECK-IN                                  15470041
154800              MOVE PC-CHECK-IN   TO PV-CREATE                     15480041
154900         WHEN PC038-SRC-CSEPK-SPLT                                15490041
155000              MOVE PC-CSEPK-SPLT TO PV-CREATE                     15500041
155100         WHEN PC038-SRC-MANUAL                                    15510041
155200              MOVE PC-MANUAL     TO PV-CREATE                     15520041
155300         WHEN PC038-SRC-P2L                                       15530041
155400              MOVE PC-PCK-2-LIT  TO PV-CREATE                     15540041
155500         WHEN PC038-SRC-RECEIVING                                 15550041
155600              MOVE PC-RECEIVING  TO PV-CREATE                     15560041
155700         WHEN PC038-SRC-RDM                                       15570041
155800              MOVE PC-RDM        TO PV-CREATE                     15580041
155900         WHEN PC038-SRC-SMOOTHING                                 15590041
156000              MOVE PC-SMOOTHING  TO PV-CREATE                     15600041
156100         WHEN PC038-SRC-FAST-XFER                                 15610041
156200              MOVE PC-FAST-XFER  TO PV-CREATE                     15620041
156300         WHEN PC038-SRC-MSTR-CNTR                                 15630041
156400              MOVE PC-MSTR-CNTR  TO PV-CREATE                     15640041
156500         WHEN PC038-SRC-CRTN-BULD                                 15650041
156600              MOVE PC-CRTN-BULD  TO PV-CREATE                     15660041
156700         WHEN PC038-SRC-JWL                                       15670041
156800              MOVE PC-JEWELRY    TO PV-CREATE                     15680041
156900         WHEN PC038-SRC-DMG                                       15690041
157000              MOVE PC-DAMAGED    TO PV-CREATE                     15700041
157010         WHEN PC038-SRC-3WD                                       15701050
157020              MOVE PC-3WD        TO PV-CREATE                     15702050
157100         WHEN OTHER                                               15710041
157200              MOVE PC-UNKNOWN    TO PV-CREATE                     15720041
157300     END-EVALUATE.                                                15730041
157400     STRING 'CREATE: ' DELIMITED BY SIZE                          15740041
157500            PV-CREATE  DELIMITED BY SIZE                          15750041
157600                       INTO AMSGLNO.                              15760041
157700                                                                  15770041
157800 3900-DETERMINE-PC039-DATA.                                       15780041
157900     INITIALIZE PC039-COMMAREA-REC.                               15790041
158000     SET PC039-CALLED-FROM-STAT-ACT TO TRUE.                      15800041
158100     MOVE PC038-CALLED-PGM-NME   TO PC039-CALLED-PGM-NME.         15810041
158200     MOVE PC038-USER-ID          TO PC039-CRA-REQ-ID.             15820041
158300     MOVE PC038-PRINTER-ID-1-3   TO PC039-PRINTER-ID.             15830041
158400     MOVE PC038-SULBXF-BARCODE   TO PC039-KOHLS-BARCODE.          15840041
158500     MOVE PC038-CARTON-ID-ENTERED                                 15850041
158600                                 TO PC039-CARTON-ID-ENTERED.      15860041
158700     MOVE PC038-CARTON-ON-TABLE  TO                               15870041
158800                                    PC039-CARTON-ON-TABLE.        15880041
158900     MOVE PC038-SOURCE-ID        TO PC039-SOURCE-ID.              15890041
159000     MOVE PC038-LABEL-CREATED    TO PC039-LBL-TYPE.               15900041
159100     MOVE PC038-SHPUNT-SHIPT-UNT-ID                               15910041
159200                                 TO DK-SHIPT-UNT-ID               15920041
159300     PERFORM 5900-SELECT-VENDOR-BARCODE                           15930041
159400     MOVE DK-SHIPT-UNT-ID        TO PC039-SHIPT-UNT-ID.           15940041
159500     IF PC038-ON-TSHPUNT                                          15950041
159600         MOVE PC038-SHPUNT-DEST-OPER                              15960041
159700                                 TO PC039-STR-NBR                 15970041
159800     END-IF.                                                      15980041
159900     IF PC038-SRC-ASN                                             15990041
160000         MOVE PC038-SHPUNT-DEST-OPER                              16000041
160100                                 TO PC039-STR-NBR                 16010041
160200     END-IF.                                                      16020041
160300     MOVE PC038-SHPUNT-CART-TYP-CDE                               16030041
160400                                 TO PC039-LBL-FORMAT.             16040041
160500     MOVE PC038-CURR-OPER-UNT    TO PC039-CURR-OPER-UNT.          16050041
160600     MOVE PC-LABEL-INFO-PGM      TO PV-TRANSFER-PROGRAM.          16060041
160700     MOVE SPACES                 TO  EIBAID.                      16070041
160800     PERFORM 3950-LINK-TO-888-PROGRAM.                            16080041
160900                                                                  16090041
161000*-----------------------------------------------------------------16100041
161100 3950-LINK-TO-888-PROGRAM.                                        16110041
161200*-----------------------------------------------------------------16120041
161300                                                                  16130041
161400     MOVE LENGTH OF PC039-COMMAREA-REC   TO PV-COMMAREA-LENGTH.   16140041
161500                                                                  16150041
161600     EXEC CICS                                                    16160041
161700         LINK                                                     16170041
161800             PROGRAM   (PV-TRANSFER-PROGRAM)                      16180041
161900             COMMAREA  (PC039-COMMAREA-REC)                       16190041
162000             LENGTH    (PV-COMMAREA-LENGTH)                       16200041
162100             RESP      (PV-CICS-RESPONSE)                         16210041
162200     END-EXEC.                                                    16220041
162300                                                                  16230041
162400                                                                  16240041
162500     EVALUATE TRUE                                                16250041
162600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16260041
162700              EVALUATE TRUE                                       16270041
162800                  WHEN PC039-SUCCESSFUL                           16280041
162900                       MOVE PC039-PRINTER-ID                      16290041
163000                                          TO PC038-PRINTER-ID-1-3 16300041
163100                 WHEN PC039-ERROR                                 16310041
163200                 WHEN PC039-INVALID-SQL                           16320041
163300                      MOVE PM-CICS-ABEND-MSG      TO AFKMSGO      16330041
163400                      SET  PS-ERRORS-YES          TO TRUE         16340041
163500              END-EVALUATE                                        16350041
163600                                                                  16360041
163700         WHEN OTHER                                               16370041
163800              MOVE '3950-LINK-TO-888-PROGRAM'  TO DP013-PARAGRAPH 16380041
163900              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       16390041
164000                                        TO DP013-MESSAGE-TEXT (1) 16400041
164100              MOVE 'PCKRF888'           TO DP013-MESSAGE-TEXT (2) 16410041
164200              SET DP013-CICS-ABEND   TO TRUE                      16420041
164300              SET DP013-ROLLBACK     TO TRUE                      16430041
164400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              16440041
164500              MOVE PM-TRANS-UNAVAILABLE-MSG TO AFKMSGO            16450041
164600              SET PC038-PROCESS-SCREEN TO TRUE                    16460041
164700              PERFORM 8010-SEND-DATA-ONLY                         16470041
164800              PERFORM 8100-RETURN-TRANID                          16480041
164900     END-EVALUATE.                                                16490041
165000                                                                  16500041
165100 4000-DETERMINE-PO-RECEIVER.                                      16510041
165200                                                                  16520041
165300     SET PT-PREPK-IDX TO +1.                                      16530041
165400                                                                  16540041
165500     EVALUATE TRUE                                                16550041
165600         WHEN PC038-SRC-ASN                                       16560041
165700         WHEN PC038-SRC-CHECK-IN                                  16570041
165800              PERFORM 4100-TRY-LBVRDA-FOR-DATA                    16580041
165900              IF PS-NOT-FOUND-TLBVRDA                             16590041
166000                  MOVE ZEROES  TO  PT-TABLE-ENTRIES               16600041
166100                  PERFORM 4300-OTBND-UPC-CURSOR-DRIVER            16610041
166200              END-IF                                              16620041
166300              IF PS-ZERO-RCVR-SEQ-YES AND                         16630041
166400                 PS-NOT-FOUND-TLBVRDA                             16640041
166500                 PERFORM 4200-TPKSLIP-CURSOR-DRIVER               16650041
166600              END-IF                                              16660041
166700         WHEN PC038-SRC-CSEPK-SPLT                                16670041
166800         WHEN PC038-SRC-P2L                                       16680041
166900         WHEN PC038-SRC-RECEIVING                                 16690041
167000         WHEN PC038-SRC-SMOOTHING                                 16700041
167100         WHEN PC038-SRC-FAST-XFER                                 16710041
167200         WHEN PC038-SRC-CRTN-BULD                                 16720041
167300         WHEN PC038-SRC-RDM                                       16730041
167400         WHEN PC038-SRC-JWL                                       16740041
167500         WHEN PC038-SRC-DMG                                       16750041
167510         WHEN PC038-SRC-3WD                                       16751050
167600              PERFORM 4300-OTBND-UPC-CURSOR-DRIVER                16760041
167700         WHEN PC038-SRC-MSTR-CNTR                                 16770041
167800              CONTINUE                                            16780041
167900         WHEN PC038-SRC-MANUAL                                    16790041
168100              PERFORM 4200-TPKSLIP-CURSOR-DRIVER                  16810041
168200         WHEN OTHER                                               16820041
168300              PERFORM 4200-TPKSLIP-CURSOR-DRIVER                  16830041
168400     END-EVALUATE.                                                16840041
168500                                                                  16850041
168600     IF PT-TABLE-ENTRIES > +1                                     16860041
168700         MOVE 'MULTIPLE' TO APORCVRO                              16870041
168800         SET PC038-MULTI-PO  TO TRUE                              16880041
168900     ELSE                                                         16890041
170600             MOVE PT-PURCHASE-ORDER (+1) TO PC038-PO-NBR          17060041
170700                                            DK-PURCHASE-ORDER-N   17070041
170800             MOVE PT-RCVR-NBR       (+1) TO PC038-RCVR-SEQ-NBR    17080041
170900                                            DK-RCVR-NBR-N         17090041
171000             STRING DK-PURCHS-ORD DELIMITED BY SIZE               17100041
171100                    '-'           DELIMITED BY SIZE               17110041
171200                    DK-RECVR-NBR  DELIMITED BY SIZE               17120041
171300                                     INTO  APORCVRO               17130041
171500     END-IF.                                                      17150041
171600                                                                  17160041
171700     IF PS-NOT-FOUND-TLBVRDA                                      17170041
171800         PERFORM VARYING PT-PO-IDX                                17180041
171900             FROM 1 BY 1                                          17190041
172000                 UNTIL PT-PO-IDX > PT-TABLE-ENTRIES               17200041
172100                     PERFORM 4010-GET-LINE-INFO                   17210041
172200                     PERFORM 4020-NBR-UNTS-PCKS                   17220041
172300         END-PERFORM                                              17230041
172400                                                                  17240041
172500         PERFORM VARYING PT-PO-IDX                                17250041
172600             FROM 1 BY 1                                          17260041
172700                 UNTIL PT-PO-IDX > 1                              17270041
172800                    PERFORM 4070-DETERMIN-UNTS                    17280041
172900                    SET PS-ADJ-NO   TO  TRUE                      17290041
173000                    PERFORM 4080-DETERMIN-ADJS                    17300041
173100         END-PERFORM                                              17310041
173200         IF PT-TABLE-ENTRIES = 0                                  17320041
173300             MOVE +1 TO PT-TABLE-ENTRIES                          17330041
173400         END-IF                                                   17340041
173500                                                                  17350041
173600         IF PT-SINGLE-LINE (+1)                                   17360041
173700                 MOVE '0000'         TO ATEXTO                    17370041
173800                 MOVE 'LNE:'         TO ALNEPCKO                  17380041
173900                 PERFORM 4090-GET-DEPT-CL-SKU                     17390041
174000         ELSE                                                     17400041
174100             IF PT-PREPK-PO (+1)                                  17410041
174200                     SET PC038-PREPK       TO TRUE                17420041
174300                     MOVE PT-PREPK-ID (+1) TO PC038-PREPK-ID      17430041
174400                     MOVE 'PAK:'           TO ALNEPCKO            17440041
174500                     IF PT-MULTI-PREPK (+1)                       17450041
174600                         SET PC038-MULTI-PREPK TO TRUE            17460041
174700                         MOVE 'MULTIPLE'       TO ATEXTO          17470041
174800                     ELSE                                         17480041
174900                         MOVE PC038-PREPK-ID   TO ATEXTO          17490041
175000                     END-IF                                       17500041
175100             ELSE                                                 17510041
175200                 IF PT-MULTI-LINE (+1)                            17520041
175300                     SET PC038-MULTI-LNE TO TRUE                  17530041
175400                     MOVE 'MULTIPLE'     TO ATEXTO                17540041
175500                     MOVE 'LNE:'         TO ALNEPCKO              17550041
175600                 ELSE                                             17560041
175700                     MOVE 'UNKN'         TO ATEXTO                17570041
175800                     MOVE 'LNE:'         TO ALNEPCKO              17580041
175900                 END-IF                                           17590041
176000             END-IF                                               17600041
176100         END-IF                                                   17610041
176200     ELSE                                                         17620041
176300         IF  PC039-PREPK                                          17630041
176400                 MOVE 'PAK:'           TO ALNEPCKO                17640041
176500                 MOVE PC039-PREPK-ID   TO ATEXTO                  17650041
176600        ELSE                                                      17660041
176700                 MOVE 'LNE:'           TO ALNEPCKO                17670041
176800                 MOVE PC039-LNE-NBR    TO ATEXTO                  17680041
176900        END-IF                                                    17690041
177000     END-IF.                                                      17700041
177100                                                                  17710041
177200     IF PS-NOT-FOUND-TLBVRDA                                      17720041
177300         INITIALIZE PC038-LNE-SHPD-QTY                            17730041
177400                    PC038-PREPK-PAK-QTY                           17740041
177500                                                                  17750041
177600         PERFORM VARYING PT-PO-IDX                                17760041
177700             FROM 1 BY 1                                          17770041
177800             UNTIL PT-PO-IDX > PT-TABLE-ENTRIES                   17780041
177900                 ADD PT-NBR-UNITS (PT-PO-IDX)  TO                 17790041
178000                                             PV-CRTN-TOTAL-UNITS  17800041
178100                                             PC038-LNE-SHPD-QTY   17810041
178200                 ADD PT-NBR-PACKS (PT-PO-IDX)  TO                 17820041
178300                                             PV-CRTN-TOTAL-PACKS  17830041
178400                                             PC038-PREPK-PAK-QTY  17840041
178500         END-PERFORM                                              17850041
178600         IF  PC038-PREPK                                          17860041
178700             MOVE  PC038-PREPK-PAK-QTY TO PC039-PACKS-IN-CRTN     17870041
178800         END-IF                                                   17880041
178900     ELSE                                                         17890041
179000         MOVE LBVRDA-OTPK-UNT-QTY     TO PV-CRTN-TOTAL-UNITS      17900041
179100         MOVE LBVRDA-PREPK-UNT-QTY    TO PV-CRTN-TOTAL-PACKS      17910041
179200         IF  LBVRDA-PREPK-UNT-QTY  >  0                           17920041
179300             COMPUTE PV-CRTN-TOTAL-PAKS   =                       17930041
179400                     LBVRDA-PREPK-UNT-QTY / LBVRDA-PREPK-UNT-QTY  17940041
179500         ELSE                                                     17950041
179600             MOVE  ZEROES             TO PV-CRTN-TOTAL-PAKS       17960041
179700         END-IF                                                   17970041
179800     END-IF                                                       17980041
179900                                                                  17990041
180000                                                                  18000041
180100     STRING 'UNT:'                       DELIMITED BY SIZE        18010041
180200            PV-CRTN-TOTAL-UNTS           DELIMITED BY SIZE        18020041
180300            ' '                          DELIMITED BY SIZE        18030041
180400            'PCK:'                       DELIMITED BY SIZE        18040041
180500             PV-CRTN-TOTAL-PAKS          DELIMITED BY SIZE        18050041
180600                                    INTO AUNTPCKO                 18060041
180700                                                                  18070041
180800     IF PC038-SRC-MSTR-CNTR                                       18080041
180900         MOVE 'MULTIPLE'     TO APORCVRO                          18090041
181000         MOVE 'MULTIPLE'     TO ATEXTO                            18100041
181100         MOVE 'LNE:'         TO ALNEPCKO                          18110041
181200         IF PC038-SHPUNT-SHIPT-UNT-ID = PC038-NEXT-SHIPT-UNT-ID   18120041
181300             PERFORM 5000-COUNT-CHILDREN-OF-MASTER                18130041
181400             PERFORM 5100-COUNT-UNIT-OF-CHILDREN                  18140041
181500         ELSE                                                     18150041
181600             PERFORM 5050-COUNT-CHILDREN-OF-MASTER                18160041
181700             PERFORM 5500-COUNT-UNIT-OF-CHILDREN                  18170041
181800         END-IF                                                   18180041
181900         INITIALIZE PV-CRTN-TOTAL-UNITS                           18190041
182000         PERFORM VARYING PT-PO-IDX                                18200041
182100             FROM 1 BY 1                                          18210041
182200                 UNTIL PT-PO-IDX > PT-TABLE-ENTRIES               18220041
182300                     ADD PT-NBR-UNITS (PT-PO-IDX)  TO             18230041
182400                                             PV-CRTN-TOTAL-UNITS  18240041
182500                                             PC038-LNE-SHPD-QTY   18250041
182600         END-PERFORM                                              18260041
182700         MOVE PV-CHILDRN-IN-MASTER TO PV-CHLDN-IN-MSTR            18270041
182800         MOVE SPACES               TO  AUNTPCKO                   18280041
182900         STRING 'UNT '        DELIMITED BY SIZE                   18290041
183000          PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE                   18300041
183100                ' CHLD '      DELIMITED BY SIZE                   18310041
183200              PV-CHLD-IN-MSTR DELIMITED BY SIZE                   18320041
183300                  ' '         DELIMITED BY SIZE                   18330041
183400                          INTO   AUNTPCKO                         18340041
183500                                                                  18350049
184500     ELSE                                                         18450041
184600         IF NOT PC038-PREPK                                       18460041
184900             PERFORM 4070-DETERMIN-UNTS                           18490041
185000             INITIALIZE PV-CRTN-TOTAL-UNITS                       18500041
185100             PERFORM VARYING PT-PO-IDX                            18510041
185200                FROM 1 BY 1                                       18520041
185300                   UNTIL PT-PO-IDX > 1                            18530041
185400                       ADD PT-NBR-UNITS (PT-PO-IDX) TO            18540041
185500                                             PV-CRTN-TOTAL-UNITS  18550041
185600                                             PC038-LNE-SHPD-QTY   18560041
185700             END-PERFORM                                          18570041
185800             MOVE SPACES   TO  AUNTPCKO                           18580041
185900             STRING 'UNTS: '      DELIMITED BY SIZE               18590041
186000              PV-CRTN-TOTAL-UNTS  DELIMITED BY SIZE               18600041
186100                              INTO   AUNTPCKO                     18610041
187700         END-IF                                                   18770041
187800     END-IF.                                                      18780041
187900                                                                  18790041
188000*-----------------------------------------------------------------18800041
188100 4010-GET-LINE-INFO.                                              18810041
188200                                                                  18820041
188300     EXEC SQL                                                     18830041
188400         SELECT DISTINCT TRN_LNE_NBR                              18840041
188500               ,UPC_NBR                                           18850041
188600          INTO :SUT00028-TRN-LNE-NBR                              18860041
188700              ,:SUT00028-UPC-NBR                                  18870041
188800           FROM SUT_OTBND_UPC                                     18880041
188900          WHERE SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID                 18890041
189000     END-EXEC.                                                    18900041
189100                                                                  18910041
189200     EVALUATE TRUE                                                18920041
189300         WHEN SQLCODE = +0                                        18930041
189400             MOVE SUT00028-TRN-LNE-NBR TO PT-LNE-NBR (PT-PO-IDX)  18940041
189500                                        PC038-PO-LNE-NBR          18950041
189600             MOVE SUT00028-UPC-NBR   TO PT-UPC-NBR (PT-PO-IDX)    18960041
189700                                        PC038-UPC-NBR             18970041
189800             SET PC038-LINE                                       18980041
189900                 PT-SINGLE-LINE (PT-PO-IDX) TO TRUE               18990041
190000         WHEN SQLCODE = -811                                      19000041
190100             SET PC038-MULTI-LNE                                  19010041
190200                 PT-MULTI-LINE (PT-PO-IDX)  TO TRUE               19020041
190300             IF PT-PREPK-PO  (PT-PO-IDX)                          19030041
190400                 PERFORM 4015-GET-PREPK-PO                        19040041
190500             END-IF                                               19050041
190600         WHEN SQLCODE NOT EQUAL +0                                19060041
190700             MOVE ZEROES             TO PT-LNE-NBR (PT-PO-IDX)    19070041
190800                                        PT-UPC-NBR (PT-PO-IDX)    19080041
190900     END-EVALUATE.                                                19090041
191000                                                                  19100041
191100*-----------------------------------------------------------------19110041
191200 4015-GET-PREPK-PO.                                               19120041
191300                                                                  19130041
191400     MOVE PT-PURCHASE-ORDER (PT-PO-IDX) TO DK-PURCHASE-ORDER.     19140041
191500     MOVE PT-RCVR-NBR (PT-PO-IDX)       TO DK-RCVR-NBR.           19150041
191600     EXEC SQL                                                     19160041
191700         SELECT DISTINCT B.PREPK_ID                               19170041
191800          INTO :RECITM-PREPK-ID                                   19180041
191900           FROM TRECITM B                                         19190041
192000          WHERE B.ORD_NBR      =  :DK-PURCHASE-ORDER              19200041
192100            AND B.REC_SEQ_NBR  =  :DK-RCVR-NBR                    19210041
192200            AND B.VER_STATUS_CDE = 'A'                            19220041
192300            AND B.ORD_LNE_NBR  IN                                 19230041
192400              (SELECT A.TRN_LNE_NBR                               19240041
192500               FROM SUT_OTBND_UPC A                               19250041
192600               WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID            19260041
192700                 AND A.TRN_NBR = B.ORD_NBR                        19270041
192800                 AND A.RCVR_SEQ_NBR = B.REC_SEQ_NBR)              19280041
192900     END-EXEC.                                                    19290041
193000                                                                  19300041
193100     EVALUATE TRUE                                                19310041
193200         WHEN SQLCODE = +0                                        19320041
193300             MOVE RECITM-PREPK-ID  TO PT-PREPK-ID (PT-PO-IDX)     19330041
193400             SET PT-SINGLE-PREPK (PT-PO-IDX) TO TRUE              19340041
193500         WHEN SQLCODE = -811                                      19350041
193600             SET PT-MULTI-PREPK (PT-PO-IDX) TO TRUE               19360041
193700         WHEN SQLCODE NOT EQUAL +0                                19370041
193800             MOVE ZEROES             TO PT-PREPK-ID (PT-PO-IDX)   19380041
193900     END-EVALUATE.                                                19390041
194000                                                                  19400041
194100*-----------------------------------------------------------------19410041
194200 4020-NBR-UNTS-PCKS.                                              19420041
194300                                                                  19430041
194500     IF PT-PREPK-PO (PT-PO-IDX)                                   19450041
194600         PERFORM 4030-PREPKID-CURSOR-DRIVER                       19460041
194700     END-IF.                                                      19470041
194800                                                                  19480041
194900*--------------------------------------------------------------   19490041
195000 4030-PREPKID-CURSOR-DRIVER.                                      19500041
195100                                                                  19510041
195200     PERFORM 4033-OPEN-PREPKID-CURSOR.                            19520041
195300     PERFORM 4036-FETCH-PREPKID-CURSOR.                           19530041
195400     PERFORM 4039-CLOSE-PREPKID-CURSOR.                           19540041
195500                                                                  19550041
195600*--------------------------------------------------------------   19560041
195700 4033-OPEN-PREPKID-CURSOR.                                        19570041
195800                                                                  19580041
196000     MOVE PT-PURCHASE-ORDER (PT-PO-IDX)TO DK-PURCHASE-ORDER.      19600041
196200     MOVE PT-RCVR-NBR (PT-PO-IDX)      TO DK-RCVR-NBR.            19620041
196300     EXEC SQL                                                     19630041
196400         OPEN PREPKID-CSR                                         19640041
196500     END-EXEC                                                     19650041
196600                                                                  19660041
196700     EVALUATE TRUE                                                19670041
196800          WHEN SQLCODE = +0                                       19680041
196900                 CONTINUE                                         19690041
197000          WHEN SQLCODE NOT EQUAL +0                               19700041
197100               MOVE '4033-OPEN-PREPKID-CURSOR' TO DP013-PARAGRAPH 19710041
197200               MOVE 'ERROR OPENING THE CURSOR'                    19720041
197300                                        TO DP013-MESSAGE-TEXT (1) 19730041
197400               MOVE SQLCA        TO DP013-SQLCA                   19740041
197500               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      19750041
197600               SET DP013-DB2-ABEND                                19760041
197700                   DP013-ROLLBACK   TO TRUE                       19770041
197800               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             19780041
197900     END-EVALUATE.                                                19790041
198000                                                                  19800041
198100*---------------------------------------------------------------  19810041
198200 4036-FETCH-PREPKID-CURSOR.                                       19820041
198300                                                                  19830041
198600     PERFORM                                                      19860041
198700         UNTIL  SQLCODE NOT = +0                                  19870041
198800                                                                  19880041
198900         EXEC SQL                                                 19890041
199000             FETCH PREPKID-CSR                                    19900041
199100             INTO :RECITM-PREPK-ID                                19910041
199200         END-EXEC                                                 19920041
199300                                                                  19930041
199400         EVALUATE TRUE                                            19940041
199500             WHEN SQLCODE = +0                                    19950041
199600                 MOVE RECITM-PREPK-ID TO PT-PREPK-ID (PT-PO-IDX)  19960041
199700                                         DK-PREPK-ID              19970041
199800                 PERFORM 4040-PREPK-LNE-CURSOR-DRIVER             19980041
199900             WHEN SQLCODE NOT EQUAL +0                            19990041
200000                 CONTINUE                                         20000041
200100         END-EVALUATE                                             20010041
200200     END-PERFORM.                                                 20020041
200300                                                                  20030041
200400*--------------------------------------------------------------   20040041
200500 4039-CLOSE-PREPKID-CURSOR.                                       20050041
200600                                                                  20060041
200700     EXEC SQL                                                     20070041
200800         CLOSE PREPKID-CSR                                        20080041
200900     END-EXEC.                                                    20090041
201000                                                                  20100041
201100     EVALUATE TRUE                                                20110041
201200          WHEN SQLCODE = +0                                       20120041
201300              CONTINUE                                            20130041
201400          WHEN SQLCODE NOT EQUAL +0                               20140041
201500               MOVE '4039-CLOSE-PREPKID-CURSOR' TO DP013-PARAGRAPH20150041
201600               MOVE 'ERROR CLOSING THE CURSOR'                    20160041
201700                                        TO DP013-MESSAGE-TEXT (1) 20170041
201800               MOVE SQLCA        TO DP013-SQLCA                   20180041
201900               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      20190041
202000               SET DP013-DB2-ABEND                                20200041
202100                   DP013-ROLLBACK   TO TRUE                       20210041
202200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             20220041
202300     END-EVALUATE.                                                20230041
202400                                                                  20240041
202500*--------------------------------------------------------------   20250041
202600 4040-PREPK-LNE-CURSOR-DRIVER.                                    20260041
202700                                                                  20270041
202800     PERFORM 4043-OPEN-PREPK-LNE-CURSOR.                          20280041
202900     PERFORM 4046-FETCH-PREPK-LNE-CURSOR.                         20290041
203000     PERFORM 4049-CLOSE-PREPK-LNE-CURSOR.                         20300041
203100                                                                  20310041
203200*--------------------------------------------------------------   20320041
203300 4043-OPEN-PREPK-LNE-CURSOR.                                      20330041
203400                                                                  20340041
203700     EXEC SQL                                                     20370041
203800         OPEN PREPK-LNE-CSR                                       20380041
203900     END-EXEC                                                     20390041
204000                                                                  20400041
204100     EVALUATE TRUE                                                20410041
204200          WHEN SQLCODE = +0                                       20420041
204300                 CONTINUE                                         20430041
204400          WHEN SQLCODE NOT EQUAL +0                               20440041
204500               MOVE '4043-OPEN-PREPKLN-CURSOR' TO DP013-PARAGRAPH 20450041
204600               MOVE 'ERROR OPENING THE CURSOR'                    20460041
204700                                        TO DP013-MESSAGE-TEXT (1) 20470041
204800               MOVE SQLCA        TO DP013-SQLCA                   20480041
204900               MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)      20490041
205000               SET DP013-DB2-ABEND                                20500041
205100                   DP013-ROLLBACK   TO TRUE                       20510041
205200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             20520041
205300     END-EVALUATE.                                                20530041
205400                                                                  20540041
205500*---------------------------------------------------------------  20550041
205600 4046-FETCH-PREPK-LNE-CURSOR.                                     20560041
205700                                                                  20570041
205800     PERFORM VARYING PT-PREPK-IDX                                 20580041
206000         FROM PT-PREPK-IDX BY 1                                   20600041
206100         UNTIL  SQLCODE NOT = +0                                  20610041
206200                                                                  20620041
206300         EXEC SQL                                                 20630041
206400             FETCH PREPK-LNE-CSR                                  20640041
206500             INTO :RECITM-ORD-LNE-NBR                             20650041
206600                 ,:RECITM-PREPK-RATO-QTY                          20660041
206700         END-EXEC                                                 20670041
206800                                                                  20680041
206900         EVALUATE TRUE                                            20690041
207000             WHEN SQLCODE = +0                                    20700041
207100                 MOVE RECITM-ORD-LNE-NBR  TO  PT-PREPK-LNE-NBR    20710041
207200                                                    (PT-PREPK-IDX)20720041
207300                 MOVE RECITM-PREPK-RATO-QTY TO PT-PREPK-LNE-RATIO 20730041
207400                                                    (PT-PREPK-IDX)20740041
207500                 ADD 1 TO PT-PREPK-TABLE-ENTRIES                  20750041
207600                 PERFORM 4050-SUM-SHPD-QTY                        20760041
207700                 IF PS-PREPK-SAME-MULTIPLE-YES                    20770041
207800                     ADD PV-PREPK-MULTIPLE TO PT-NBR-PACKS        20780041
207900                                                       (PT-PO-IDX)20790041
208000                 ELSE                                             20800041
208100                     ADD PV-PREPK-TOT-UNITS  TO PT-NBR-UNITS      20810041
208200                                                       (PT-PO-IDX)20820041
208300                 END-IF                                           20830041
208400             WHEN SQLCODE NOT EQUAL +0                            20840041
208500                 CONTINUE                                         20850041
208600         END-EVALUATE                                             20860041
208700     END-PERFORM.                                                 20870041
208800                                                                  20880041
208900*--------------------------------------------------------------   20890041
209000 4049-CLOSE-PREPK-LNE-CURSOR.                                     20900041
209100                                                                  20910041
209200     EXEC SQL                                                     20920041
209300         CLOSE PREPK-LNE-CSR                                      20930041
209400     END-EXEC.                                                    20940041
209500                                                                  20950041
209600     EVALUATE TRUE                                                20960041
209700          WHEN SQLCODE = +0                                       20970041
209800                 CONTINUE                                         20980041
209900          WHEN SQLCODE NOT EQUAL +0                               20990041
210000               MOVE '4049-CLOSE-PREPKLN-CURSOR' TO DP013-PARAGRAPH21000041
210100               MOVE 'ERROR CLOSING THE CURSOR'                    21010041
210200                                        TO DP013-MESSAGE-TEXT (1) 21020041
210300               MOVE SQLCA        TO DP013-SQLCA                   21030041
210400               MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)      21040041
210500               SET DP013-DB2-ABEND                                21050041
210600                   DP013-ROLLBACK   TO TRUE                       21060041
210700               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             21070041
210800     END-EVALUATE.                                                21080041
210900                                                                  21090041
211000*-----------------------------------------------------------------21100041
211100 4050-SUM-SHPD-QTY.                                               21110041
211200                                                                  21120041
211300     MOVE PT-PREPK-LNE-NBR (PT-PREPK-IDX) TO DK-LNE-NBR.          21130041
211400     EXEC SQL                                                     21140041
211500         SELECT SUM(SHPD_UNT_QTY)                                 21150041
211600           INTO :PV-LINE-SHPD-UNITS                               21160041
211700           FROM SUT_OTBND_UPC                                     21170041
211800          WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID              21180041
211900            AND TRN_LNE_NBR      =  :DK-LNE-NBR                   21190041
212000            AND TRN_NBR          =  :DK-PURCHASE-ORDER            21200041
212100            AND RCVR_SEQ_NBR     =  :DK-RCVR-NBR                  21210041
212200     END-EXEC.                                                    21220041
212300                                                                  21230041
212400     EVALUATE TRUE                                                21240041
212500         WHEN SQLCODE = +0                                        21250041
212600            MOVE PV-LINE-SHPD-UNITS TO PT-PREPK-NBR-UNITS         21260041
212800                                                  (PT-PREPK-IDX)  21280041
215200            ADD PV-LINE-SHPD-UNITS TO PV-PREPK-TOT-UNITS          21520000
215300            IF PT-PREPK-NBR-UNITS (PT-PREPK-IDX) > +0 AND         21530000
215400               PT-PREPK-LNE-RATIO (PT-PREPK-IDX) > +0             21540000
215500                  DIVIDE PT-PREPK-NBR-UNITS (PT-PREPK-IDX)        21550000
215600                    BY   PT-PREPK-LNE-RATIO (PT-PREPK-IDX)        21560000
215700                  GIVING PT-PREPK-MULTIPLE  (PT-PREPK-IDX)        21570000
215800               REMAINDER PT-PREPK-REMAINDER (PT-PREPK-IDX)        21580000
215900            END-IF                                                21590000
216000            IF PT-PREPK-REMAINDER (PT-PREPK-IDX) > +0             21600000
216100                MOVE ZEROES TO PT-PREPK-MULTIPLE (PT-PREPK-IDX)   21610000
216200                               PT-PREPK-REMAINDER (PT-PREPK-IDX)  21620000
216300            END-IF                                                21630000
216400            IF PT-PREPK-TABLE-ENTRIES = 1                         21640000
216500                MOVE PT-PREPK-MULTIPLE (PT-PREPK-IDX) TO          21650000
216600                                                PV-PREPK-MULTIPLE 21660000
216700                SET PS-PREPK-SAME-MULTIPLE-YES TO TRUE            21670000
216800            ELSE                                                  21680000
216900                IF PT-PREPK-MULTIPLE (PT-PREPK-IDX) NOT =         21690000
217000                                                PV-PREPK-MULTIPLE 21700000
217100                  SET PS-PREPK-SAME-MULTIPLE-NO TO TRUE           21710000
217200                  MOVE ZEROES TO PT-PREPK-MULTIPLE (PT-PREPK-IDX) 21720000
217300                                PT-PREPK-REMAINDER (PT-PREPK-IDX) 21730000
217400                END-IF                                            21740000
217500            END-IF                                                21750000
217600         WHEN SQLCODE NOT EQUAL +0                                21760000
217700            MOVE ZEROES  TO PT-PREPK-NBR-UNITS (PT-PREPK-IDX)     21770000
217800     END-EVALUATE.                                                21780000
217900                                                                  21790000
218000                                                                  21800000
218100*-----------------------------------------------------------------21810000
218200 4070-DETERMIN-UNTS.                                              21820000
218300*-----------------------------------------------------------------21830000
218400                                                                  21840000
218500     EXEC SQL                                                     21850000
218600         SELECT SUM(SHPD_UNT_QTY)                                 21860000
218700          INTO :PV-LINE-SHPD-UNITS                                21870000
218800          FROM SUT_OTBND_UPC                                      21880000
218900         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID               21890000
219000     END-EXEC                                                     21900000
219100                                                                  21910000
219200     EVALUATE TRUE                                                21920000
219300         WHEN SQLCODE = +0                                        21930000
219400             MOVE PV-LINE-SHPD-UNITS TO  PT-NBR-UNITS(PT-PO-IDX)  21940000
219500         WHEN SQLCODE NOT EQUAL +0                                21950000
219600             MOVE ZEROES             TO  PT-NBR-UNITS(PT-PO-IDX)  21960000
219700                                         SQLCODE                  21970000
219800     END-EVALUATE.                                                21980000
219900                                                                  21990000
220000*-----------------------------------------------------------------22000000
220100 4080-DETERMIN-ADJS.                                              22010000
220200*-----------------------------------------------------------------22020000
220300                                                                  22030000
220400     EXEC SQL                                                     22040000
220500         SELECT UPC_NBR                                           22050000
220600          INTO :SUQADJ-UPC-NBR                                    22060000
220700          FROM TSUQADJ                                            22070000
220800         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID               22080000
220900     END-EXEC                                                     22090000
221000                                                                  22100000
221100     EVALUATE TRUE                                                22110000
221200         WHEN SQLCODE = +0                                        22120000
221300         WHEN SQLCODE = -811                                      22130000
221400             SET PS-ADJ-YES                                       22140000
221500                 PC038-ADJ  TO  TRUE                              22150000
221600         WHEN SQLCODE NOT EQUAL +0                                22160000
221700             SET PS-ADJ-NO   TO  TRUE                             22170000
221800     END-EVALUATE.                                                22180000
221900                                                                  22190000
222000*-----------------------------------------------------------------22200000
222100 4090-GET-DEPT-CL-SKU.                                            22210000
222200                                                                  22220000
222300     MOVE PT-PURCHASE-ORDER (+1)  TO DK-PURCHASE-ORDER.           22230000
222400     MOVE PT-RCVR-NBR (+1)        TO DK-RCVR-NBR.                 22240000
222500     MOVE PT-LNE-NBR (+1)         TO DK-LNE-NBR.                  22250000
222600     EXEC SQL                                                     22260000
222700         SELECT SKU_NBR                                           22270019
223000          INTO :XLT00003-SKU-NBR                                  22300019
223300           FROM TRECITM A                                         22330000
223500               ,XLT_SKU C                                         22350019
223600          WHERE A.ORD_NBR        =  :DK-PURCHASE-ORDER            22360000
223700            AND A.REC_SEQ_NBR    =  :DK-RCVR-NBR                  22370000
223900            AND A.ORD_LNE_NBR    =  :DK-LNE-NBR                   22390000
224100            AND A.VER_STATUS_CDE =  :PC-A                         22410000
224110            AND A.ITM_NBR        =  C.ITM_NBR                     22411019
224400     END-EXEC                                                     22440000
224500                                                                  22450000
224600     EVALUATE TRUE                                                22460000
224700         WHEN SQLCODE = +0                                        22470000
224800             MOVE XLT00003-SKU-NBR TO  PC038-SKU-NBR              22480041
225300             MOVE 'LNE:'     TO ALNEPCKO                          22530000
225400             MOVE PT-LNE-NBR(+1)  TO DK-LNE-NBR                   22540000
225500             MOVE DK-LNE-NBR      TO DK-LNE-NBR-N                 22550000
225600             STRING DK-LINE-NBR        DELIMITED BY SIZE          22560000
225700                       ' '             DELIMITED BY SIZE          22570000
225800                       '('             DELIMITED BY SIZE          22580000
225900                    PC038-SKU-NBR      DELIMITED BY SIZE          22590005
226000                       ')'             DELIMITED BY SIZE          22600000
226100                                   INTO ATEXTO                    22610000
226200         WHEN SQLCODE NOT EQUAL +0                                22620000
226300             MOVE ZEROES             TO PC038-SKU-NBR             22630005
226400     END-EVALUATE.                                                22640000
226500                                                                  22650000
226600*-----------------------------------------------------------------22660000
226700 4100-TRY-LBVRDA-FOR-DATA.                                        22670000
226800*-----------------------------------------------------------------22680000
226900                                                                  22690000
227000     MOVE PC038-SHPUNT-DEST-OPER TO DK-STORE-NUMBER.              22700000
227100                                                                  22710000
227200     EXEC SQL                                                     22720000
227300          SELECT  PO_NBR                                          22730014
227400                 ,RCVR_SEQ_NBR                                    22740014
227500                 ,PREPK_ID                                        22750014
227600                 ,PO_LNE_NBR                                      22760014
227700                 ,PREPK_PRCG_LNE_NBR                              22770014
227800                 ,PREPK_ID                                        22780014
227900                 ,OTPK_UNT_QTY                                    22790014
228000                 ,INPK_UNT_QTY                                    22800014
228100                 ,DEPT_DESC                                       22810014
228200                 ,MAJ_CL_DESC                                     22820014
228300                 ,SEASET_NM                                       22830014
228400                 ,FIXT_ID                                         22840014
228500                 ,STR_ZN_ID                                       22850014
228600                 ,DEST_OPER_UNT_ID                                22860014
228700                 ,PREPK_RATO_QTY                                  22870014
228800                 ,PREPK_UNT_QTY                                   22880014
228900                 ,INPK_CNVYB_IND                                  22890014
229200            INTO :LBVRDA-PO-NBR                                   22920000
229300                ,:LBVRDA-RCVR-SEQ-NBR                             22930000
229400                ,:LBVRDA-PREPK-ID                                 22940000
229500                ,:LBVRDA-PO-LNE-NBR                               22950000
229600                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       22960000
229700                ,:LBVRDA-PREPK-ID                                 22970000
229800                ,:LBVRDA-OTPK-UNT-QTY                             22980000
229900                ,:LBVRDA-INPK-UNT-QTY                             22990000
230000                ,:LBVRDA-DEPT-DESC                                23000000
230100                ,:LBVRDA-MAJ-CL-DESC                              23010000
230200                ,:LBVRDA-SEASET-NM                                23020000
230300                ,:LBVRDA-FIXT-ID                                  23030000
230400                ,:LBVRDA-STR-ZN-ID                                23040000
230500                ,:LBVRDA-DEST-OPER-UNT-ID                         23050000
230600                ,:LBVRDA-PREPK-RATO-QTY                           23060000
230700                ,:LBVRDA-PREPK-UNT-QTY                            23070000
230800                ,:LBVRDA-INPK-CNVYB-IND                           23080000
231100            FROM  TLBVRDA                                         23110014
231300           WHERE  BRCDE_NBR         =  :PC038-SULBXF-BARCODE      23130014
231400             AND  DEST_OPER_UNT_ID  =  :DK-STORE-NUMBER           23140014
231600     END-EXEC.                                                    23160000
231700                                                                  23170000
231800     EVALUATE TRUE                                                23180000
231900         WHEN SQLCODE = ZERO                                      23190000
232000             IF PC039-LBL-FORMAT = PC-P                           23200000
232100                 MOVE PC-G TO PC039-LBL-FORMAT                    23210000
232200             ELSE                                                 23220000
232300                 MOVE PC-S TO PC039-LBL-FORMAT                    23230000
232400             END-IF                                               23240000
232500             ADD 1 TO PT-TABLE-ENTRIES                            23250000
232600             SET PC039-4-BY-4-LBL           TO TRUE               23260000
232700             SET PT-SINGLE-LINE (PT-PO-IDX) TO TRUE               23270000
232800             SET PT-SINGLE-PREPK (PT-PO-IDX) TO TRUE              23280000
232900             MOVE LBVRDA-PO-NBR  TO PT-PURCHASE-ORDER (PT-PO-IDX) 23290000
233000             MOVE LBVRDA-RCVR-SEQ-NBR  TO PT-RCVR-NBR (PT-PO-IDX) 23300000
233100             MOVE LBVRDA-PREPK-ID      TO PT-PREPK-ID (PT-PO-IDX) 23310000
233300             MOVE LBVRDA-OTPK-UNT-QTY       TO PC039-OTPK-UNITS   23330000
233400             MOVE LBVRDA-INPK-UNT-QTY       TO PC039-INPK-UNITS   23340000
233500             MOVE LBVRDA-DEPT-DESC          TO PC039-DEPT-NAME    23350000
233600             MOVE LBVRDA-MAJ-CL-DESC        TO PC039-MAJOR-CLASS  23360000
233700             MOVE LBVRDA-SEASET-NM          TO PC039-SEASONAL-SET 23370000
233800             MOVE LBVRDA-FIXT-ID            TO PC039-FIXTURE      23380000
233900             MOVE LBVRDA-STR-ZN-ID          TO PC039-ZONE         23390000
234000             MOVE LBVRDA-PREPK-RATO-QTY     TO PC039-PREPK-RATIO  23400000
234100             MOVE LBVRDA-PREPK-UNT-QTY      TO PC039-PREPK-UNT-QTY23410000
234200             IF LBVRDA-PREPK-ID > ZEROES                          23420000
234300                 MOVE LBVRDA-PREPK-PRCG-LNE-NBR TO                23430000
234400                                           PT-LNE-NBR (PT-PO-IDX) 23440000
234500                 SET  PC039-PREPK          TO TRUE                23450000
234600                 PERFORM 4130-GET-PREPK-OTPK-QTY                  23460000
234700             ELSE                                                 23470000
234800                 MOVE LBVRDA-PO-LNE-NBR TO PT-LNE-NBR (PT-PO-IDX) 23480000
234900             END-IF                                               23490000
235000             IF LBVRDA-INPK-CNVYB-IND   = PC-Y                    23500000
235100                 SET PC039-INPK   TO TRUE                         23510000
235200             ELSE                                                 23520000
235300                 SET PC039-FCSE   TO TRUE                         23530000
235400             END-IF                                               23540000
235500             SET PS-FOUND-ON-TLBVRDA TO TRUE                      23550000
235600         WHEN SQLCODE = +100                                      23560000
235700             SET PS-NOT-FOUND-TLBVRDA TO TRUE                     23570000
235800         WHEN OTHER                                               23580000
235900               MOVE '4100-TRY-LBVRDA-FOR-DATA' TO DP013-PARAGRAPH 23590000
236000               MOVE SQLCA        TO DP013-SQLCA                   23600000
236100               MOVE 'TLBVRDA'    TO DP013-DB2-TABLE-NAME (1)      23610000
236200               SET DP013-DB2-ABEND                                23620000
236300                   DP013-ROLLBACK   TO TRUE                       23630000
236400               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             23640000
236500     END-EVALUATE.                                                23650000
236700                                                                  23670000
236800*-----------------------------------------------------------------23680000
236900 4130-GET-PREPK-OTPK-QTY.                                         23690000
237000*-----------------------------------------------------------------23700000
237100     MOVE LBVRDA-PO-NBR        TO  DK-PO-NBR                      23710000
237200     MOVE LBVRDA-RCVR-SEQ-NBR  TO  DK-PO-RCVR                     23720000
237300     MOVE LBVRDA-PREPK-ID      TO  DK-PREPK-ID                    23730000
237400                                                                  23740000
237500     EXEC SQL                                                     23750000
237600          SELECT  SUM(B.FCSE_SPLT_UNT_QTY)                        23760000
237700                 ,SUM(B.INPK_SPLT_UNT_QTY)                        23770000
237800            INTO :DISTDT-FCSE-SPLT-UNT-QTY                        23780000
237900                ,:DISTDT-INPK-SPLT-UNT-QTY                        23790000
238000            FROM  TDISTHD A                                       23800000
238100                 ,TDISTDT B                                       23810000
238200                 ,TRECITM C                                       23820000
238300           WHERE  A.ORD_NBR            =  :DK-PO-NBR              23830000
238400             AND  A.RCVR_SEQ_NBR       =  :DK-PO-RCVR             23840000
238500             AND  A.ORD_NBR            =  B.ORD_NBR               23850000
238600             AND  A.ORD_LNE_NBR        =  B.ORD_LNE_NBR           23860000
238700             AND  A.RCVR_SEQ_NBR       =  B.RCVR_SEQ_NBR          23870000
238800             AND  B.STR_NBR            =  :DK-STORE-NUMBER        23880000
238900             AND  A.ORD_NBR            =  C.ORD_NBR               23890000
239000             AND  A.ORD_LNE_NBR        =  C.ORD_LNE_NBR           23900000
239100             AND  A.RCVR_SEQ_NBR       =  C.REC_SEQ_NBR           23910000
239200             AND  A.ORD_LNE_NBR  IN                               23920000
239300                  (SELECT D.ORD_LNE_NBR                           23930000
239400                     FROM TRECITM D                               23940000
239500                    WHERE D.ORD_NBR     = :DK-PO-NBR              23950000
239600                      AND D.REC_SEQ_NBR = :DK-PO-RCVR             23960000
239700                      AND D.PREPK_ID    = :DK-PREPK-ID)           23970000
239800     END-EXEC.                                                    23980000
239900                                                                  23990000
240000     EVALUATE TRUE                                                24000000
240100         WHEN SQLCODE = ZERO                                      24010000
240200             MOVE DISTDT-FCSE-SPLT-UNT-QTY TO PC039-PREPK-UNT-QTY 24020000
240300                                              PC039-OTPK-UNITS    24030000
240400                                              LBVRDA-OTPK-UNT-QTY 24040000
240500         WHEN SQLCODE = +100                                      24050000
240600         WHEN SQLCODE = -305                                      24060000
240700             CONTINUE                                             24070000
240800         WHEN OTHER                                               24080000
240900               MOVE '4130-GET-PREPK-OTPK-QTY ' TO DP013-PARAGRAPH 24090000
241000               MOVE SQLCA        TO DP013-SQLCA                   24100000
241100               MOVE 'TDISTDT'    TO DP013-DB2-TABLE-NAME (1)      24110000
241200               SET DP013-DB2-ABEND                                24120000
241300                   DP013-ROLLBACK   TO TRUE                       24130000
241400               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             24140000
241500     END-EVALUATE.                                                24150000
241600                                                                  24160000
241700*--------------------------------------------------------------   24170000
241800 4200-TPKSLIP-CURSOR-DRIVER.                                      24180000
241900                                                                  24190000
242000     PERFORM 4230-OPEN-TPKSLIP-CURSOR.                            24200000
242100     PERFORM 4260-FETCH-TPKSLIP-CURSOR.                           24210000
242200     PERFORM 4290-CLOSE-TPKSLIP-CURSOR.                           24220000
242300                                                                  24230000
242400*--------------------------------------------------------------   24240000
242500 4230-OPEN-TPKSLIP-CURSOR.                                        24250000
242600                                                                  24260000
242700     EXEC SQL                                                     24270000
242800         OPEN TPKSLIP-PO-CSR                                      24280000
242900     END-EXEC                                                     24290000
243000                                                                  24300000
243100     EVALUATE TRUE                                                24310000
243200          WHEN SQLCODE = +0                                       24320000
243300                 CONTINUE                                         24330000
243400          WHEN SQLCODE NOT EQUAL +0                               24340000
243500               MOVE '4230-OPEN-TPKSLIP-CURSOR' TO DP013-PARAGRAPH 24350000
243600               MOVE 'ERROR OPENING THE CURSOR'                    24360000
243700                                        TO DP013-MESSAGE-TEXT (1) 24370000
243800               MOVE SQLCA        TO DP013-SQLCA                   24380000
243900               MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)      24390000
244000               SET DP013-DB2-ABEND                                24400000
244100                   DP013-ROLLBACK   TO TRUE                       24410000
244200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             24420000
244300     END-EVALUATE.                                                24430000
244400                                                                  24440000
244500*---------------------------------------------------------------  24450000
244600 4260-FETCH-TPKSLIP-CURSOR.                                       24460000
244700                                                                  24470000
244800     PERFORM VARYING PT-PO-IDX                                    24480000
244900         FROM 1 BY 1                                              24490000
245000         UNTIL  SQLCODE NOT = +0                                  24500000
245100                                                                  24510000
245200         EXEC SQL                                                 24520000
245300             FETCH TPKSLIP-PO-CSR                                 24530000
245400             INTO :SUT00026-PO-NBR                                24540000
245500                 ,:PKSLIP-REC-SEQ-NBR                             24550000
245600         END-EXEC                                                 24560000
245700                                                                  24570000
245800         EVALUATE TRUE                                            24580000
245900             WHEN SQLCODE = +0                                    24590000
246000                 MOVE SUT00026-PO-NBR TO                          24600000
246100                                    PT-PURCHASE-ORDER (PT-PO-IDX) 24610000
246200                 MOVE PKSLIP-REC-SEQ-NBR  TO                      24620000
246300                                          PT-RCVR-NBR (PT-PO-IDX) 24630000
246400                 ADD 1 TO PT-TABLE-ENTRIES                        24640000
246500                 PERFORM 4270-SELECT-PCKG-CDE                     24650000
246600             WHEN SQLCODE NOT EQUAL +0                            24660000
246700                 CONTINUE                                         24670000
246800         END-EVALUATE                                             24680000
246900     END-PERFORM.                                                 24690000
247000                                                                  24700000
247100*---------------------------------------------------------------  24710000
247200 4270-SELECT-PCKG-CDE.                                            24720000
247300                                                                  24730000
247400     EXEC SQL                                                     24740000
247500         SELECT PKGNG_CDE                                         24750000
247600          INTO :RECEIV-PKGNG-CDE                                  24760000
247700           FROM TRECEIV                                           24770000
247800          WHERE ORD_NBR     = :SUT00026-PO-NBR                    24780000
247900            AND REC_SEQ_NBR = :PKSLIP-REC-SEQ-NBR                 24790000
248000     END-EXEC.                                                    24800000
248100                                                                  24810000
248200     EVALUATE TRUE                                                24820000
248300         WHEN SQLCODE = +0                                        24830000
248400             MOVE RECEIV-PKGNG-CDE  TO  PT-PKGNG-CDE (PT-PO-IDX)  24840000
248500         WHEN SQLCODE NOT EQUAL +0                                24850000
248600             MOVE SPACES            TO  PT-PKGNG-CDE (PT-PO-IDX)  24860000
248700             MOVE ZEROES            TO  SQLCODE                   24870000
248800     END-EVALUATE.                                                24880000
248900                                                                  24890000
249000*--------------------------------------------------------------   24900000
249100 4290-CLOSE-TPKSLIP-CURSOR.                                       24910000
249200                                                                  24920000
249300     EXEC SQL                                                     24930000
249400         CLOSE TPKSLIP-PO-CSR                                     24940000
249500     END-EXEC.                                                    24950000
249600                                                                  24960000
249700     EVALUATE TRUE                                                24970000
249800          WHEN SQLCODE = +0                                       24980000
249900                 CONTINUE                                         24990000
250000          WHEN SQLCODE NOT EQUAL +0                               25000000
250100               MOVE '4290-CLOSE-TPKSLIP-CURSOR' TO DP013-PARAGRAPH25010000
250200               MOVE 'ERROR CLOSING THE CURSOR'                    25020000
250300                                        TO DP013-MESSAGE-TEXT (1) 25030000
250400               MOVE SQLCA        TO DP013-SQLCA                   25040000
250500               MOVE 'TPKSLIP'    TO DP013-DB2-TABLE-NAME (1)      25050000
250600               SET DP013-DB2-ABEND                                25060000
250700                   DP013-ROLLBACK   TO TRUE                       25070000
250800               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             25080000
250900     END-EVALUATE.                                                25090000
251000                                                                  25100000
251100*-----------------------------------------------------------------25110000
251200 4300-OTBND-UPC-CURSOR-DRIVER.                                    25120000
251300                                                                  25130000
251400     PERFORM 4330-OPEN-OTBND-UPC-CURSOR.                          25140000
251500     PERFORM 4360-FETCH-OTBND-UPC-CURSOR.                         25150000
251600     PERFORM 4390-CLOSE-OTBND-UPC-CURSOR.                         25160000
251700                                                                  25170000
251800*--------------------------------------------------------------   25180000
251900 4330-OPEN-OTBND-UPC-CURSOR.                                      25190000
252000                                                                  25200000
252100     EXEC SQL                                                     25210000
252200         OPEN OTBND-UPC-PO-CSR                                    25220000
252300     END-EXEC.                                                    25230000
252400                                                                  25240000
252500     EVALUATE TRUE                                                25250000
252600          WHEN SQLCODE = +0                                       25260000
252700                 CONTINUE                                         25270000
252800          WHEN SQLCODE NOT EQUAL +0                               25280000
252900               MOVE '4330-OPEN-OTBND-UPC-CURSOR'                  25290000
253000                                               TO DP013-PARAGRAPH 25300000
253100               MOVE 'ERROR OPENING THE CURSOR'                    25310000
253200                                        TO DP013-MESSAGE-TEXT (1) 25320000
253300               MOVE SQLCA        TO DP013-SQLCA                   25330000
253400               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      25340000
253500               SET DP013-DB2-ABEND                                25350000
253600                   DP013-ROLLBACK   TO TRUE                       25360000
253700               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             25370000
253800     END-EVALUATE.                                                25380000
253900                                                                  25390000
254000*---------------------------------------------------------------  25400000
254100 4360-FETCH-OTBND-UPC-CURSOR.                                     25410000
254200                                                                  25420000
254300     PERFORM VARYING PT-PO-IDX                                    25430000
254400         FROM 1 BY 1                                              25440000
254500         UNTIL  SQLCODE NOT = +0                                  25450000
254600                                                                  25460000
254700         EXEC SQL                                                 25470000
254800             FETCH OTBND-UPC-PO-CSR                               25480000
254900             INTO :SUT00028-TRN-NBR                               25490000
255000                 ,:SUT00028-RCVR-SEQ-NBR                          25500000
255100         END-EXEC                                                 25510000
255200                                                                  25520000
255300         EVALUATE TRUE                                            25530000
255400             WHEN SQLCODE = +0                                    25540000
255500                 MOVE SUT00028-TRN-NBR TO                         25550000
255600                                    PT-PURCHASE-ORDER (PT-PO-IDX) 25560000
255700                 MOVE SUT00028-RCVR-SEQ-NBR TO                    25570000
255800                                          PT-RCVR-NBR (PT-PO-IDX) 25580000
255900                 ADD 1 TO PT-TABLE-ENTRIES                        25590000
256000                 IF SUT00028-RCVR-SEQ-NBR = 0                     25600009
256100                    SET PS-ZERO-RCVR-SEQ-YES TO TRUE              25610009
256200                 ELSE                                             25620013
256300                    SET PS-ZERO-RCVR-SEQ-NO  TO TRUE              25630013
256400                 END-IF                                           25640009
256500                 PERFORM 4370-SELECT-PCKG-CDE                     25650000
256600             WHEN SQLCODE NOT EQUAL +0                            25660000
256700                 CONTINUE                                         25670000
256800         END-EVALUATE                                             25680000
256900     END-PERFORM.                                                 25690000
257000                                                                  25700000
257100*---------------------------------------------------------------  25710000
257200 4370-SELECT-PCKG-CDE.                                            25720000
257300                                                                  25730000
257400     EXEC SQL                                                     25740000
257500         SELECT PKGNG_CDE                                         25750000
257600          INTO :RECEIV-PKGNG-CDE                                  25760000
257700           FROM TRECEIV                                           25770000
257800          WHERE ORD_NBR     = :SUT00028-TRN-NBR                   25780000
257900            AND REC_SEQ_NBR = :SUT00028-RCVR-SEQ-NBR              25790000
258000     END-EXEC                                                     25800000
258100                                                                  25810000
258200     EVALUATE TRUE                                                25820000
258300         WHEN SQLCODE = +0                                        25830000
258400             MOVE RECEIV-PKGNG-CDE  TO  PT-PKGNG-CDE (PT-PO-IDX)  25840000
258500             PERFORM 4380-SELECT-DEPT-NBR                         25850000
258600         WHEN SQLCODE NOT EQUAL +0                                25860000
258700             MOVE ZERO              TO  SQLCODE                   25870000
258800             MOVE SPACES            TO  PT-PKGNG-CDE (PT-PO-IDX)  25880000
258900     END-EVALUATE.                                                25890000
259000                                                                  25900000
259100*---------------------------------------------------------------  25910000
259200 4380-SELECT-DEPT-NBR.                                            25920000
259300                                                                  25930000
259400     EXEC SQL                                                     25940000
259500         SELECT DEPT_NBR                                          25950000
259600          INTO :PURCHS-DEPT-NBR                                   25960000
259700           FROM TPURCHS                                           25970000
259800          WHERE PO_NBR     = :SUT00028-TRN-NBR                    25980000
259900     END-EXEC                                                     25990000
260000                                                                  26000000
260100     EVALUATE TRUE                                                26010000
260200         WHEN SQLCODE = +0                                        26020000
260300             MOVE PURCHS-DEPT-NBR   TO  PT-DEPT (PT-PO-IDX)       26030000
260400         WHEN SQLCODE NOT EQUAL +0                                26040000
260500             MOVE SPACES            TO  PT-DEPT (PT-PO-IDX)       26050000
260600             MOVE ZEROES            TO  SQLCODE                   26060000
260700     END-EVALUATE.                                                26070000
260800                                                                  26080000
260900*--------------------------------------------------------------   26090000
261000 4390-CLOSE-OTBND-UPC-CURSOR.                                     26100000
261100                                                                  26110000
261200     EXEC SQL                                                     26120000
261300         CLOSE OTBND-UPC-PO-CSR                                   26130000
261400     END-EXEC                                                     26140000
261500                                                                  26150000
261600     EVALUATE TRUE                                                26160000
261700          WHEN SQLCODE = +0                                       26170000
261800                 CONTINUE                                         26180000
261900          WHEN SQLCODE NOT EQUAL +0                               26190000
262000               MOVE '4390-CLOSE-OTBND-UPC-CURSOR'                 26200000
262100                                                TO DP013-PARAGRAPH26210000
262200               MOVE 'ERROR CLOSING THE CURSOR'                    26220000
262300                                        TO DP013-MESSAGE-TEXT (1) 26230000
262400               MOVE SQLCA        TO DP013-SQLCA                   26240000
262500               MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)      26250000
262600               SET DP013-DB2-ABEND                                26260000
262700                   DP013-ROLLBACK   TO TRUE                       26270000
262800               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             26280000
262900     END-EVALUATE.                                                26290000
263000                                                                  26300000
263100*-----------------------------------------------------------------26310000
263200 5000-COUNT-CHILDREN-OF-MASTER.                                   26320000
263300*-----------------------------------------------------------------26330000
263400                                                                  26340000
263500     EXEC SQL                                                     26350000
263600         SELECT COUNT(*)                                          26360000
263700         INTO   :PV-CHILDRN-IN-MASTER                             26370000
263800         FROM   SUT_OTBND_CART A                                  26380000
263900               ,SUT_OTBND_CART B                                  26390000
264000         WHERE  A.PRNT_CART_ID = :DK-SHIPT-UNT-ID                 26400000
264100           AND  B.PRNT_CART_ID = A.SHIPT_UNT_ID                   26410000
264200           AND  B.MSTR_CART_IND = 'N'                             26420000
264300     END-EXEC.                                                    26430000
264400                                                                  26440000
264500     EVALUATE TRUE                                                26450000
264600         WHEN SQLCODE = +0                                        26460000
264700             MOVE PV-CHILDRN-IN-MASTER TO PC038-CHLDRN-IN-MSTR    26470000
264800         WHEN SQLCODE NOT EQUAL +0                                26480000
264900             CONTINUE                                             26490000
265000     END-EVALUATE.                                                26500000
265100                                                                  26510000
265200*-----------------------------------------------------------------26520000
265300 5050-COUNT-CHILDREN-OF-MASTER.                                   26530000
265400*-----------------------------------------------------------------26540000
265500                                                                  26550000
265600     EXEC SQL                                                     26560000
265700         SELECT COUNT(*)                                          26570000
265800         INTO   :PV-CHILDRN-IN-MASTER                             26580000
265900         FROM   SUT_OTBND_CART                                    26590000
266000         WHERE  PRNT_CART_ID = :DK-SHIPT-UNT-ID                   26600000
266100           AND  MSTR_CART_IND = 'N'                               26610000
266200     END-EXEC.                                                    26620000
266300                                                                  26630000
266400     EVALUATE TRUE                                                26640000
266500         WHEN SQLCODE = +0                                        26650000
266600             MOVE PV-CHILDRN-IN-MASTER TO PC038-CHLDRN-IN-MSTR    26660000
266700         WHEN SQLCODE NOT EQUAL +0                                26670000
266800             CONTINUE                                             26680000
266900     END-EVALUATE.                                                26690000
267000                                                                  26700000
267100                                                                  26710000
267200*--------------------------------------------------------------   26720000
267300 5100-COUNT-UNIT-OF-CHILDREN.                                     26730000
267400*--------------------------------------------------------------   26740000
267500                                                                  26750000
267600     PERFORM 5200-OPEN-OTBND-CART-CURSOR.                         26760000
267700     PERFORM 5300-FETCH-OTBND-CART-CURSOR.                        26770000
267800     PERFORM 5400-CLOSE-OTBND-CART-CURSOR.                        26780000
267900                                                                  26790000
268000*--------------------------------------------------------------   26800000
268100 5200-OPEN-OTBND-CART-CURSOR.                                     26810000
268200                                                                  26820000
268300     EXEC SQL                                                     26830000
268400         OPEN OTBND-CART-CSR                                      26840000
268500     END-EXEC                                                     26850000
268600                                                                  26860000
268700     EVALUATE TRUE                                                26870000
268800          WHEN SQLCODE = +0                                       26880000
268900                 CONTINUE                                         26890000
269000          WHEN SQLCODE NOT EQUAL +0                               26900000
269100               MOVE '5200-OPEN-OTBND-CART-CURSOR'                 26910000
269200                                           TO DP013-PARAGRAPH     26920000
269300               MOVE 'ERROR OPENING THE CURSOR'                    26930000
269400                                        TO DP013-MESSAGE-TEXT (1) 26940000
269500               MOVE SQLCA        TO DP013-SQLCA                   26950000
269600               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      26960000
269700               SET DP013-DB2-ABEND                                26970000
269800                   DP013-ROLLBACK   TO TRUE                       26980000
269900               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             26990000
270000     END-EVALUATE.                                                27000000
270100                                                                  27010000
270200*---------------------------------------------------------------  27020000
270300 5300-FETCH-OTBND-CART-CURSOR.                                    27030000
270400                                                                  27040000
270500     PERFORM VARYING PT-PO-IDX                                    27050000
270600         FROM 1 BY 1                                              27060000
270700         UNTIL  SQLCODE = +100                                    27070000
270800                                                                  27080000
270900         EXEC SQL                                                 27090000
271000             FETCH OTBND-CART-CSR                                 27100000
271100             INTO :SUT00024-SHIPT-UNT-ID                          27110000
271200         END-EXEC                                                 27120000
271300                                                                  27130000
271400         EVALUATE TRUE                                            27140000
271500             WHEN SQLCODE = +0                                    27150000
271600                 ADD +1 TO PT-TABLE-ENTRIES                       27160000
271700                 MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID    27170000
271800                 PERFORM 4070-DETERMIN-UNTS                       27180000
271900             WHEN SQLCODE NOT EQUAL +0                            27190000
272000                 CONTINUE                                         27200000
272100         END-EVALUATE                                             27210000
272200     END-PERFORM.                                                 27220000
272300                                                                  27230000
272400*--------------------------------------------------------------   27240000
272500 5400-CLOSE-OTBND-CART-CURSOR.                                    27250000
272600                                                                  27260000
272700     EXEC SQL                                                     27270000
272800         CLOSE OTBND-CART-CSR                                     27280000
272900     END-EXEC.                                                    27290000
273000                                                                  27300000
273100     EVALUATE TRUE                                                27310000
273200          WHEN SQLCODE = +0                                       27320000
273300                 CONTINUE                                         27330000
273400          WHEN SQLCODE NOT EQUAL +0                               27340000
273500               MOVE '5400-CLOS-OTBND-CART-CURSOR'                 27350000
273600                                             TO DP013-PARAGRAPH   27360000
273700               MOVE 'ERROR CLOSING THE CURSOR'                    27370000
273800                                        TO DP013-MESSAGE-TEXT (1) 27380000
273900               MOVE SQLCA        TO DP013-SQLCA                   27390000
274000               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      27400000
274100               SET DP013-DB2-ABEND                                27410000
274200                   DP013-ROLLBACK   TO TRUE                       27420000
274300               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             27430000
274400     END-EVALUATE.                                                27440000
274500                                                                  27450000
274600*--------------------------------------------------------------   27460000
274700 5500-COUNT-UNIT-OF-CHILDREN.                                     27470000
274800                                                                  27480000
274900*--------------------------------------------------------------   27490000
275000     PERFORM 5600-OPEN-OTBND-CART-CURSOR.                         27500000
275100     PERFORM 5700-FETCH-OTBND-CART-CURSOR.                        27510000
275200     PERFORM 5800-CLOSE-OTBND-CART-CURSOR.                        27520000
275300                                                                  27530000
275400*--------------------------------------------------------------   27540000
275500 5600-OPEN-OTBND-CART-CURSOR.                                     27550000
275600                                                                  27560000
275700     EXEC SQL                                                     27570000
275800         OPEN OTBND-CART-CSR2                                     27580000
275900     END-EXEC                                                     27590000
276000                                                                  27600000
276100     EVALUATE TRUE                                                27610000
276200          WHEN SQLCODE = +0                                       27620000
276300                 CONTINUE                                         27630000
276400          WHEN SQLCODE NOT EQUAL +0                               27640000
276500               MOVE '5600-OPEN-OTBND-CART-CURSOR'                 27650000
276600                                               TO DP013-PARAGRAPH 27660000
276700               MOVE 'ERROR OPENING THE CURSOR'                    27670000
276800                                        TO DP013-MESSAGE-TEXT (1) 27680000
276900               MOVE SQLCA        TO DP013-SQLCA                   27690000
277000               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      27700000
277100               SET DP013-DB2-ABEND                                27710000
277200                   DP013-ROLLBACK   TO TRUE                       27720000
277300               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             27730000
277400     END-EVALUATE.                                                27740000
277500                                                                  27750000
277600*---------------------------------------------------------------  27760000
277700 5700-FETCH-OTBND-CART-CURSOR.                                    27770000
277800                                                                  27780000
277900     PERFORM VARYING PT-PO-IDX                                    27790000
278000         FROM 1 BY 1                                              27800000
278100         UNTIL  SQLCODE = +100                                    27810000
278200                                                                  27820000
278300         EXEC SQL                                                 27830000
278400             FETCH OTBND-CART-CSR2                                27840000
278500             INTO :SUT00024-SHIPT-UNT-ID                          27850000
278600         END-EXEC                                                 27860000
278700                                                                  27870000
278800         EVALUATE TRUE                                            27880000
278900             WHEN SQLCODE = +0                                    27890000
279000                 ADD +1 TO PT-TABLE-ENTRIES                       27900000
279100                 MOVE SUT00024-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID    27910000
279200                 PERFORM 4070-DETERMIN-UNTS                       27920000
279300             WHEN SQLCODE NOT EQUAL +0                            27930000
279400                 CONTINUE                                         27940000
279500         END-EVALUATE                                             27950000
279600     END-PERFORM.                                                 27960000
279700                                                                  27970000
279800*--------------------------------------------------------------   27980000
279900 5800-CLOSE-OTBND-CART-CURSOR.                                    27990000
280000                                                                  28000000
280100     EXEC SQL                                                     28010000
280200         CLOSE OTBND-CART-CSR2                                    28020000
280300     END-EXEC.                                                    28030000
280400                                                                  28040000
280500     EVALUATE TRUE                                                28050000
280600          WHEN SQLCODE = +0                                       28060000
280700                 CONTINUE                                         28070000
280800          WHEN SQLCODE NOT EQUAL +0                               28080000
280900               MOVE '5800-CLOS-OTBND-CART-CURSOR'                 28090000
281000                                               TO DP013-PARAGRAPH 28100000
281100               MOVE 'ERROR CLOSING THE CURSOR'                    28110000
281200                                        TO DP013-MESSAGE-TEXT (1) 28120000
281300               MOVE SQLCA        TO DP013-SQLCA                   28130000
281400               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      28140000
281500               SET DP013-DB2-ABEND                                28150000
281600                   DP013-ROLLBACK   TO TRUE                       28160000
281700               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             28170000
281800     END-EVALUATE.                                                28180000
281900                                                                  28190000
282000*-----------------------------------------------------------------28200000
282100 5900-SELECT-VENDOR-BARCODE.                                      28210000
282200*-----------------------------------------------------------------28220000
282300*   THIS PARA WILL REPLACE THE DK-SHIPT-UNT-ID WITH THE           28230000
282400*   SUT024-SHIPT-UNT-ID FIELD WHEN THE DK-SHIPT-UNT-ID CONTAINS   28240000
282500*   A VENDOR BAR CODE                                             28250000
282600                                                                  28260000
282700     EXEC SQL                                                     28270000
282800         SELECT SHIPT_UNT_ID                                      28280000
282900         INTO   :SUT00024-SHIPT-UNT-ID                            28290000
283000         FROM   SUT_OTBND_CART                                    28300000
283100         WHERE  ORIG_CART_ID = :DK-SHIPT-UNT-ID                   28310000
283200           AND  ACTV_IND     = 'Y'                                28320000
283300     END-EXEC.                                                    28330000
283400                                                                  28340000
283500     EVALUATE TRUE                                                28350000
283600         WHEN SQLCODE = +0                                        28360000
283700         WHEN SQLCODE = -811                                      28370001
283800             MOVE SUT00024-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID       28380001
283900         WHEN SQLCODE = +100                                      28390001
284000             CONTINUE                                             28400001
284100         WHEN SQLCODE NOT EQUAL +0                                28410001
284200               MOVE '5900-SELECT-VENDOR-BARCODE'                  28420001
284300                                               TO DP013-PARAGRAPH 28430001
284400               MOVE 'ERROR SELECTING SUT_OTBND_CART'              28440001
284500                                        TO DP013-MESSAGE-TEXT (1) 28450001
284600               MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID   28460002
284700               MOVE PV-DISP-SHIPT-UNT-ID                          28470002
284800                                        TO DP013-MESSAGE-TEXT (2) 28480002
284900               MOVE SQLCA        TO DP013-SQLCA                   28490002
285000               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      28500002
285100               SET DP013-DB2-ABEND                                28510002
285200                   DP013-ROLLBACK   TO TRUE                       28520002
285300               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             28530002
285400     END-EVALUATE.                                                28540002
285500                                                                  28550002
285600*-----------------------------------------------------------------28560002
285700 6000-GET-REST-OF-DATA.                                           28570002
285800*-----------------------------------------------------------------28580002
285900     EXEC SQL                                                     28590002
286000          SELECT A.DEST_OPER_UNT_ID                               28600002
286100                ,A.TRLR_SRL_NBR                                   28610000
286200                ,B.DOOR_ID                                        28620000
286300                ,B.OTBND_STAT_TMST                                28630000
286400                ,B.TRIP_STAT_CDE                                  28640000
286500                ,C.TRIP_STAT_DESC                                 28650000
286600                ,D.SCAC_CDE                                       28660000
286700           INTO :SUOBTR-DEST-OPER-UNT-ID                          28670000
286800               ,:SUOBTR-TRLR-SRL-NBR                              28680000
286900               ,:SUOBTS-DOOR-ID                                   28690000
287000               ,:PV-DB2-TIMESTAMP1                                28700000
287100               ,:SUOBTS-TRIP-STAT-CDE                             28710000
287200               ,:SUOBSC-TRIP-STAT-DESC                            28720000
287300               ,:CNTRID-SCAC-CDE                                  28730000
287400           FROM  TSUOBTR A                                        28740000
287500                ,TSUOBTS B                                        28750000
287600                ,TSUOBSC C                                        28760000
287700                ,TCNTRID D                                        28770000
287800           WHERE A.OTBND_TRIP_ID = :PC038-OTBND-TRIP              28780000
287900             AND A.OTBND_TRIP_ID = B.OTBND_TRIP_ID                28790000
288000             AND B.TRIP_STAT_CDE = C.TRIP_STAT_CDE                28800000
288100             AND A.TRLR_SRL_NBR  = D.TRLR_SRL_NBR                 28810000
288200             AND B.OTBND_STAT_TMST IN                             28820000
288300                     (SELECT MAX(Y.OTBND_STAT_TMST)               28830000
288400                        FROM TSUOBTR X                            28840000
288500                            ,TSUOBTS Y                            28850000
288600                       WHERE X.OTBND_TRIP_ID = :PC038-OTBND-TRIP  28860000
288700                         AND X.OTBND_TRIP_ID = Y.OTBND_TRIP_ID)   28870000
288800     END-EXEC.                                                    28880000
288900                                                                  28890000
289000     EVALUATE TRUE                                                28900000
289100         WHEN SQLCODE = ZERO                                      28910000
289200             MOVE CNTRID-SCAC-CDE           TO  ASCACO            28920000
289300                                                PC038-SCAC        28930000
289400             MOVE SUOBTR-TRLR-SRL-NBR       TO  ANBRO             28940000
289500                                                PC038-TRLR-NBR    28950000
289600             MOVE PV-DB2-TIMESTAMP1         TO  PV-DB2-TIMESTAMP2 28960000
289700             MOVE PV-DB2-TIMESTAMP2         TO  PC038-OTBND-TMST  28970000
289900             MOVE SUOBTR-DEST-OPER-UNT-ID   TO  ADSTOREO          28990007
290000                                                PC038-DEST-OPR-ID 29000000
290100             MOVE SUOBTS-DOOR-ID             TO  ADOORO           29010000
290200                                                PC038-DOOR-ID     29020000
290400                                                PC038-TRLR-STATUS 29040000
290500         WHEN SQLCODE = +100                                      29050000
290600                 MOVE SPACES                 TO  ASCACO           29060000
290700                                                 ANBRO            29070000
291000                                                 ADSTOREO         29100007
291100                                                 ADOORO           29110000
291200         WHEN SQLWARN0 NOT = SPACES                               29120000
291300         WHEN SQLCODE NOT EQUAL ZERO                              29130000
291400             MOVE '6000-GET-REST-OF-DATA' TO DP013-PARAGRAPH      29140000
291500             MOVE SQLCA                TO DP013-SQLCA             29150000
291600             MOVE 'TSUOBTR'            TO DP013-DB2-TABLE-NAME(1) 29160000
291700             SET DP013-DB2-ABEND                                  29170000
291800                 DP013-ROLLBACK                                   29180000
291900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29190000
292000             PERFORM DP014-0000-PROCESS-ABEND                     29200000
292100     END-EVALUATE.                                                29210000
292200                                                                  29220000
292300*-----------------------------------------------------------------29230000
292400 7000-GET-REST-OF-DATA.                                           29240000
292500*-----------------------------------------------------------------29250000
292600     MOVE PC038-SHPUNT-ORGN-OPER         TO DK-OPER-UNT-ID.       29260000
292700     MOVE PC038-SHPUNT-DEST-OPER         TO DK-STR-NBR.           29270000
292800                                                                  29280000
292900     EXEC SQL                                                     29290000
293000         SELECT A.DOOR_ID                                         29300042
293100          INTO :CNDRST-DOOR-ID                                    29310000
293200          FROM TCNDRST A                                          29320042
293210             , TCNDCDR B                                          29321042
293300         WHERE A.OPER_UNT_ID    =  :DK-OPER-UNT-ID                29330042
293400           AND A.STR_NBR        =  :DK-STR-NBR                    29340042
293500           AND A.END_TMST       =  :PC-DEFAULT-TIMESTAMP          29350042
293510           AND A.OPER_UNT_ID    =  B.OPER_UNT_ID                  29351042
293520           AND A.DOOR_ID        =  B.DOOR_ID                      29352042
293530           AND B.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%'               29353042
293540           AND B.DOOR_LOC_DESC NOT LIKE '%UPS%'                   29354042
293550           AND B.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%'               29355042
293600     END-EXEC.                                                    29360000
293700                                                                  29370000
293800     EVALUATE TRUE                                                29380000
293900         WHEN SQLCODE = ZERO                                      29390000
294000             MOVE SPACES                  TO  ASCACO              29400000
294100                                              ANBRO               29410000
294400             MOVE DK-STR-NBR              TO  ADSTOREO            29440007
294410             MOVE DK-DC                   TO  ADCO                29441044
294500             MOVE CNDRST-DOOR-ID          TO  ADOORO              29450000
294600         WHEN SQLCODE = +100                                      29460000
294700             MOVE SPACES                  TO  ASCACO              29470000
294800                                              ANBRO               29480000
295100                                              ADSTOREO            29510007
295200                                              ADOORO              29520000
295300         WHEN SQLCODE = -811                                      29530000
295400             MOVE SPACES                  TO  ASCACO              29540000
295500                                              ANBRO               29550000
295800             MOVE DK-STR-NBR              TO  ADSTOREO            29580007
295810             MOVE DK-DC                   TO  ADCO                29581044
295900             MOVE 'MULT'                  TO  ADOORO              29590000
296000         WHEN SQLWARN0 NOT = SPACES                               29600000
296100         WHEN SQLCODE NOT EQUAL ZERO                              29610044
296200             MOVE '7000-GET-REST-OF-DATA'  TO DP013-PARAGRAPH     29620044
296300             MOVE SQLCA                    TO DP013-SQLCA         29630000
296400             MOVE 'TCNDRST'            TO DP013-DB2-TABLE-NAME(1) 29640000
296500             MOVE DK-OPER-UNT-ID       TO PV-OPER-UNT-ID          29650000
296600             MOVE DK-STR-NBR           TO PV-STR-NBR              29660000
296700             MOVE PV-OPER-UNT-ID       TO DP013-MESSAGE-TEXT(1)   29670000
296800             MOVE PV-STR-NBR           TO DP013-MESSAGE-TEXT(2)   29680000
296900             SET DP013-DB2-ABEND                                  29690000
297000                 DP013-ROLLBACK                                   29700000
297100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29710000
297200             PERFORM DP014-0000-PROCESS-ABEND                     29720000
297300     END-EVALUATE.                                                29730000
297400                                                                  29740000
297410                                                                  29741044
297411*-----------------------------------------------------------------29741144
297412* SELECT THE DC THAT IS CURRENTLY SERVICING THE STORE            -29741244
297413*-----------------------------------------------------------------29741344
297414 7010-GET-DC-SERVICE-STORE.                                       29741444
297415                                                                  29741544
297417     MOVE PC038-SHPUNT-DEST-OPER         TO DK-STR-NBR.           29741744
297418                                                                  29741844
297419     EXEC SQL                                                     29741944
297420         SELECT A.DC_NBR                                          29742046
297421          INTO :XLT00014-DC-NBR                                   29742144
297422          FROM XLT_DC_LOC_ASGMT A                                 29742244
297424         WHERE A.LOC_NBR        =  :DK-STR-NBR                    29742445
297425           AND A.EFF_BEG_DTE IN                                   29742544
297426                (SELECT MAX(B.EFF_BEG_DTE)                        29742644
297427                   FROM XLT_DC_LOC_ASGMT B                        29742744
297428                  WHERE A.LOC_NBR  =  B.LOC_NBR                   29742844
297429                    AND B.EFF_BEG_DTE <= CURRENT DATE)            29742944
297431          WITH UR                                                 29743144
297432     END-EXEC.                                                    29743244
297433                                                                  29743344
297434     EVALUATE TRUE                                                29743444
297435         WHEN SQLCODE = ZERO                                      29743544
297436         WHEN SQLCODE = -811                                      29743644
297437             MOVE XLT00014-DC-NBR         TO  DK-DC               29743744
297438             MOVE DK-DC                   TO  ADCO                29743844
297443         WHEN SQLCODE = +100                                      29744344
297444             MOVE SPACES                  TO  ADCO                29744444
297445             MOVE ZEROES                  TO  DK-DC               29744547
297453                                                                  29745344
297458         WHEN SQLWARN0 NOT = SPACES                               29745844
297459         WHEN SQLCODE NOT EQUAL ZERO                              29745944
297460             MOVE '7010-GET-DC-SERVICE-STORE'                     29746045
297461                                           TO DP013-PARAGRAPH     29746145
297462             MOVE SQLCA                    TO DP013-SQLCA         29746245
297463             MOVE 'XLT00014'           TO DP013-DB2-TABLE-NAME(1) 29746345
297464             MOVE DK-OPER-UNT-ID       TO PV-OPER-UNT-ID          29746445
297465             MOVE DK-STR-NBR           TO PV-STR-NBR              29746545
297466             MOVE PV-OPER-UNT-ID       TO DP013-MESSAGE-TEXT(1)   29746645
297467             MOVE PV-STR-NBR           TO DP013-MESSAGE-TEXT(2)   29746745
297468             SET DP013-DB2-ABEND                                  29746845
297469                 DP013-ROLLBACK                                   29746945
297470                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29747045
297471             PERFORM DP014-0000-PROCESS-ABEND                     29747145
297472     END-EVALUATE.                                                29747245
297473                                                                  29747345
297474                                                                  29747445
297500*----------------------------------------------------------------*29750000
297600 8000-SEND-MAP.                                                   29760000
297700                                                                  29770000
297800     EXEC CICS                                                    29780000
297900         SEND MAP       ('PC887A')                                29790000
298000              MAPSET    ('PCKM887')                               29800000
298100              ERASE                                               29810000
298200              CURSOR                                              29820000
298300              RESP      (PV-CICS-RESPONSE)                        29830000
298400     END-EXEC.                                                    29840000
298500                                                                  29850000
298600     EVALUATE TRUE                                                29860000
298700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29870000
298800             CONTINUE                                             29880000
298900         WHEN OTHER                                               29890000
299000             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          29900000
299100             MOVE 'PCKRF887 - UNABLE TO SEND MAP'                 29910000
299200                                      TO DP013-MESSAGE-TEXT (1)   29920000
299300             SET DP013-CICS-ABEND                                 29930000
299400                 DP013-ROLLBACK       TO TRUE                     29940000
299500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               29950000
299600     END-EVALUATE.                                                29960000
299700                                                                  29970000
299800 8010-SEND-DATA-ONLY.                                             29980000
299900                                                                  29990000
300000     MOVE -1                          TO ACARTNIDL                30000000
300100     EXEC CICS                                                    30010000
300200         SEND MAP       ('PC887A')                                30020000
300300              MAPSET    ('PCKM887')                               30030000
300400              CURSOR                                              30040000
300500              DATAONLY                                            30050000
300600              RESP      (PV-CICS-RESPONSE)                        30060000
300700     END-EXEC.                                                    30070000
300800                                                                  30080000
300900     EVALUATE TRUE                                                30090000
301000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30100000
301100             CONTINUE                                             30110000
301200         WHEN OTHER                                               30120000
301300             MOVE '8010-SEND-DATA-ONLY'                           30130000
301400                                      TO DP013-PARAGRAPH          30140000
301500             MOVE 'PCKRF887 - UNABLE TO SEND DATA'                30150000
301600                                      TO DP013-MESSAGE-TEXT (1)   30160000
301700             SET DP013-CICS-ABEND                                 30170000
301800                 DP013-ROLLBACK       TO TRUE                     30180000
301900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30190000
302000     END-EVALUATE.                                                30200000
302100                                                                  30210000
302200 8020-RECEIVE-MAP.                                                30220000
302300                                                                  30230000
302400     EXEC CICS                                                    30240000
302500         RECEIVE MAP    ('PC887A')                                30250000
302600                 MAPSET ('PCKM887')                               30260000
302700                 RESP   (PV-CICS-RESPONSE)                        30270000
302800     END-EXEC.                                                    30280000
302900                                                                  30290000
303000     EVALUATE TRUE                                                30300000
303100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30310000
303200             CONTINUE                                             30320000
303300         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                30330000
303400             CONTINUE                                             30340000
303500         WHEN OTHER                                               30350000
303600            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       30360000
303700            MOVE 'PCKRF887 - UNABLE TO RECEIVE MAP'               30370000
303800                                         TO DP013-MESSAGE-TEXT (1)30380000
303900            SET DP013-LOGIC-ABEND        TO TRUE                  30390000
304000            SET DP013-ROLLBACK           TO TRUE                  30400000
304100            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                30410000
304200     END-EVALUATE.                                                30420000
304300                                                                  30430000
304400 8100-RETURN-TRANID.                                              30440000
304500                                                                  30450000
304600     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       30460000
304700     EXEC CICS                                                    30470000
304800         RETURN TRANSID  (PC-TRANID)                              30480000
304900                COMMAREA (CA-COMMAREA)                            30490000
305000                LENGTH   (PV-COMMAREA-LENGTH)                     30500000
305100                RESP     (PV-CICS-RESPONSE)                       30510000
305200     END-EXEC.                                                    30520000
305300                                                                  30530000
305400     EVALUATE TRUE                                                30540000
305500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30550000
305600             CONTINUE                                             30560000
305700         WHEN OTHER                                               30570000
305800             MOVE '8100-RETURN-TRANIND' TO DP013-PARAGRAPH        30580000
305900             MOVE 'PCKRF887 - UNABLE TO RETURN TO TRANID'         30590000
306000                 TO DP013-MESSAGE-TEXT (1)                        30600000
306100             SET DP013-CICS-ABEND       TO TRUE                   30610000
306200             SET DP013-ROLLBACK         TO TRUE                   30620000
306300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30630000
306400     END-EVALUATE.                                                30640000
306500                                                                  30650000
306600 8110-RETURN.                                                     30660000
306700                                                                  30670000
306800     EXEC CICS                                                    30680000
306900         SEND FROM (PV-MESSAGE-AREA)                              30690000
307000              LENGTH (19)                                         30700000
307100              ERASE                                               30710000
307200     END-EXEC.                                                    30720000
307300                                                                  30730000
307400     EXEC CICS                                                    30740000
307500         RETURN                                                   30750000
307600     END-EXEC.                                                    30760000
307700                                                                  30770000
307800 8200-XCTL.                                                       30780000
307900     SET PC038-INITIALIZE-SCREEN      TO TRUE.                    30790000
308000     MOVE PC-CURRENT-PROGRAM-NAME     TO PC038-LAST-PROGRAM       30800000
308100                                         PC038-CALLED-PGM-NME.    30810000
308200     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      30820000
308300                                                                  30830000
308400     EXEC CICS                                                    30840000
308500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    30850000
308600               COMMAREA  (CA-COMMAREA)                            30860000
308700               LENGTH    (PV-COMMAREA-LENGTH)                     30870000
308800               RESP      (PV-CICS-RESPONSE)                       30880000
308900     END-EXEC.                                                    30890000
309000                                                                  30900000
309100     EVALUATE TRUE                                                30910000
309200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 30920000
309300             CONTINUE                                             30930000
309400         WHEN OTHER                                               30940000
309500             MOVE '8200-XCTL'                                     30950000
309600                                      TO DP013-PARAGRAPH          30960000
309700             MOVE 'PCKRF887 - UNABLE TO XCTL TO PROGRAM: '        30970000
309800                                      TO DP013-MESSAGE-TEXT (1)   30980000
309900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   30990000
310000             SET DP013-CICS-ABEND                                 31000000
310100                 DP013-ROLLBACK       TO TRUE                     31010000
310200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               31020000
310300             MOVE PM-TRANS-UNAVAILABLE-MSG                        31030000
310400                                      TO AMSGLNO                  31040000
310500             MOVE -1                  TO ACARTNIDL                31050000
310600             SET PC038-PROCESS-SCREEN TO TRUE                     31060000
310700             MOVE -1                  TO ACARTNIDL                31070000
310800             PERFORM 8000-SEND-MAP                                31080000
310900             PERFORM 8100-RETURN-TRANID                           31090000
311000     END-EVALUATE.                                                31100000
311100                                                                  31110000
311200 8220-XCTL-TO-HELP.                                               31120000
311300                                                                  31130000
311400     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       31140000
311500                                                                  31150000
311600     EXEC CICS                                                    31160000
311700         XCTL                                                     31170000
311800             PROGRAM   (PV-TRANSFER-PROGRAM)                      31180000
311900             COMMAREA  (PC192-COMMAREA)                           31190000
312000             LENGTH    (PV-COMMAREA-LENGTH)                       31200000
312100             RESP      (PV-CICS-RESPONSE)                         31210000
312200     END-EXEC.                                                    31220000
312300                                                                  31230000
312400     EVALUATE TRUE                                                31240000
312500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 31250000
312600              CONTINUE                                            31260000
312700         WHEN OTHER                                               31270000
312800             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          31280000
312900             MOVE 'PCKRF887 - UNABLE TO XCTL TO PROGRAM: '        31290000
313000                                      TO DP013-MESSAGE-TEXT (1)   31300000
313100             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   31310000
313200             SET DP013-CICS-ABEND                                 31320000
313300                 DP013-ROLLBACK       TO TRUE                     31330000
313400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               31340000
313500             MOVE PM-TRANS-UNAVAILABLE-MSG                        31350000
313600                                      TO AMSGLNO                  31360000
313700             SET PC038-PROCESS-SCREEN TO TRUE                     31370000
313800             MOVE -1                  TO ACARTNIDL                31380000
313900             PERFORM 8000-SEND-MAP                                31390000
314000             PERFORM 8100-RETURN-TRANID                           31400000
314100     END-EVALUATE.                                                31410000
314200                                                                  31420049
314300                                                                  31430049
314400 9903-WRITE-CICS-LOG.                                             31440000
314500                                                                  31450000
314700     STRING PC038-SOURCE-ID '-'                                   31470000
314800            PC038-STATUS DELIMITED BY SIZE                        31480000
314900                                      INTO PV-DISPLAY-FAST        31490000
315000     MOVE PC038-CARTON-ID-ENTERED     TO PV-CARTON-ID-ENTERED     31500000
315100     MOVE PC038-SOURCE-ID             TO PV-SOURCE-ID             31510000
315200     MOVE PC038-STATUS                TO PV-STATUS                31520000
315300                                                                  31530000
315400     EXEC CICS                                                    31540000
315500         WRITEQ TD                                                31550000
315600             QUEUE  ('CSSL')                                      31560000
315700             FROM   (PV-LOG-MSG)                                  31570000
315800             RESP   (PV-CICS-RESPONSE)                            31580000
315900     END-EXEC.                                                    31590000
316000                                                                  31600000
316100                                                                  31610000
316200 9904-WRITE-CRTN-MODULE-MSG.                                      31620000
316300                                                                  31630000
316301     MOVE '3000'                      TO  PV-CTN-PARA             31630141
316302     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          31630200
316303     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           31630300
316304     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        31630400
316305     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      31630500
316306     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             31630600
316307     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        31630700
316308     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      31630800
316309                                                                  31630900
316310     EXEC CICS                                                    31631000
316311         WRITEQ TD                                                31631100
316312             QUEUE  ('CSSL')                                      31631200
316313             FROM   (PV-CARTON-MSG)                               31631300
316314             RESP   (PV-CICS-RESPONSE)                            31631400
316315     END-EXEC.                                                    31631500
316316                                                                  31631600
316400     EXEC CICS                                                    31640000
316500         WRITEQ TD                                                31650000
316600             QUEUE  ('CSSL')                                      31660000
316700             FROM   (PC046-CRA-RET-MSG)                           31670000
316800             RESP   (PV-CICS-RESPONSE)                            31680000
316900     END-EXEC.                                                    31690000
317000                                                                  31700000
317100                                                                  31710000
317200                                                                  31720000
317300 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  31730000
317400                                                                  31740000
317500     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           31750000
317600     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          31760000
317700     INITIALIZE DP013-SRC-TASK-NUMBER                             31770000
317800                DP013-STACK.                                      31780000
317900     SET DP013-LINK-RETURN            TO TRUE.                    31790000
318000                                                                  31800000
318100     EXEC CICS                                                    31810000
318200         LINK                                                     31820000
318300             PROGRAM   (DP013-NAME)                               31830000
318400             COMMAREA  (DP013-PARAMETERS)                         31840000
318500             LENGTH    (DP013-LENGTH)                             31850000
318600     END-EXEC.                                                    31860000
318700                                                                  31870000
318800*----------------------------------------------------------------*31880000
318900*    ABEND PROCESSOR MODULE                                      *31890000
319000*----------------------------------------------------------------*31900000
319100                                                                  31910000
319200     COPY DPPD014.                                                31920000
319300                                                                  31930000
