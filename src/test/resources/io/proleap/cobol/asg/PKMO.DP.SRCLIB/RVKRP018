000100 IDENTIFICATION DIVISION.                                         00010001
000200                                                                  00020001
000300 PROGRAM-ID.             RVKRP018.                                00030017
000400 AUTHOR.                 ALAN PETERS.                             00040017
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050001
000600 DATE-WRITTEN            APRIL, 2004.                             00060017
000700                                                                  00070001
000800******************************************************************00080001
000900*                                                                 00090001
001000*  THIS PROGRAM CREATES THE RETURN TO VENDOR AGED LISTING REQUEST 00100017
001100*  30 DAYS OR OLDER REPORT.                                       00110017
001200*                                                                 00111019
001300*  THE INPUT TO THIS PROGRAM IS AN OUTPUT FILE FROM RVKUT014.     00112019
001400*  THE INPUT FILE SHOULD BE SORTED IN THE FOLLOWING SEQUENCE:     00120001
001500*     (SORTED BY OPERATING UNIT ID, DMM LAST NAME AND BUYER)      00130017
001600******************************************************************00140001
001700                                                                  00150001
001800                                                                  00160001
001900 ENVIRONMENT DIVISION.                                            00170001
002000 INPUT-OUTPUT SECTION.                                            00180001
002100                                                                  00190001
002200 FILE-CONTROL.                                                    00200001
002300                                                                  00210001
002400     SELECT INPUT-FILE        ASSIGN TO INP01.                    00220003
002500                                                                  00230001
002600     SELECT REPORT-FILE       ASSIGN TO RPT01.                    00240001
002700                                                                  00250001
002800                                                                  00260001
002900 DATA DIVISION.                                                   00270001
003000                                                                  00280001
003100 FILE SECTION.                                                    00290001
003200 FD  INPUT-FILE                                                   00300001
003300     RECORDING MODE IS F                                          00310001
003400     LABEL RECORDS ARE STANDARD                                   00320001
003500     BLOCK CONTAINS 0 RECORDS.                                    00330001
003600 01  INPUT-RECORD                     PIC X(200).                 00340017
003700                                                                  00350001
003800                                                                  00360001
003900 FD  REPORT-FILE                                                  00370001
004000     RECORDING MODE IS F                                          00380001
004100     BLOCK CONTAINS 0 RECORDS                                     00390001
004200     LABEL RECORDS ARE OMITTED.                                   00400001
004300 01  REPORT-RECORD                    PIC  X(132).                00410001
004400                                                                  00420001
004500                                                                  00430001
004600                                                                  00440001
004700 WORKING-STORAGE SECTION.                                         00450001
004800 01  PS-SWITCHES.                                                 00460001
004900     05  PS-END-OF-INPUT-FILE-SW       PIC  X(03)    VALUE 'N'.   00470021
005000         88  PS-END-OF-INPUT                         VALUE 'Y'.   00480021
005100         88  PS-NOT-END-OF-INPUT                     VALUE 'N'.   00490021
005200     05  PS-NEW-PAGE-SW                PIC  X(03)    VALUE 'N'.   00500001
005300         88  PS-NEW-PAGE                             VALUE 'Y'.   00510001
005400         88  PS-NOT-NEW-PAGE                         VALUE 'N'.   00520001
005500     05  PS-NO-DETAIL-SW               PIC  X(03)    VALUE 'N'.   00530001
005600         88  PS-NO-DETAIL                            VALUE 'Y'.   00531001
005700                                                                  00532001
005800 01  CD-CPU-DATE.                                                 00533001
005900     03  CD-YEAR                       PIC  9(02)    VALUE ZERO.  00534001
006000     03  CD-MONTH                      PIC  9(02)    VALUE ZERO.  00535001
006100     03  CD-DAY                        PIC  9(02)    VALUE ZERO.  00536001
006200                                                                  00537001
006300 01  CT-CPU-TIME.                                                 00538001
006400     03  CT-HOUR                       PIC  9(02)    VALUE ZERO.  00539001
006500     03  CT-MINUTE                     PIC  9(02)    VALUE ZERO.  00540001
006600     03  FILLER                        PIC  9(04)    VALUE ZERO.  00550001
006700                                                                  00560001
006800 01  PV-ABEND-FIELDS.                                             00570001
006900     05  PV-RECORD-COUNT              PIC  9(9)  VALUE ZERO.      00580001
007000                                                                  00590001
007100                                                                  00649101
007200 01  PC-PROGRAM-CONSTANTS.                                        00649201
007300     05  PC-DESCRIPTION-1             PIC  X(30)    VALUE         00649720
007400             'TOTAL 810 - FINDLAY           '.                    00649820
007500     05  PC-DESCRIPTION-2             PIC  X(30)    VALUE         00649920
007600             'TOTAL 085 - MENOMONEE FALLS   '.                    00650020
007700     05  PC-DESCRIPTION-3             PIC  X(30)    VALUE         00650120
007800             'TOTAL 830 - WINCHESTER        '.                    00650220
007900     05  PC-DESCRIPTION-4             PIC  X(30)    VALUE         00650320
008000             'TOTAL 840 - BLUE SPRINGS      '.                    00650420
008100     05  PC-DESCRIPTION-5             PIC  X(30)    VALUE         00650520
008200             'TOTAL 865 - MAMAKATING        '.                    00650620
008300     05  PC-DESCRIPTION-6             PIC  X(30)    VALUE         00650720
                   'TOTAL 860 - CORSICANA         '.                    00650820
008500     05  PC-DESCRIPTION-7             PIC  X(30)    VALUE         00650920
008600             'TOTAL 855 - SAN BERNADINO     '.                    00651020
008500     05  PC-DESCRIPTION-8             PIC  X(30)    VALUE         00650920
008600             'TOTAL 090 - CORPORATE OFFICE  '.                    00651020
008700     05  PC-DESCRIPTION-T             PIC  X(30)    VALUE         00652020
008800             'TOTAL               '.                              00660018
008700     05  PC-DESCRIPTION-G             PIC  X(30)    VALUE         00652020
008800             'GRAND TOTAL         '.                              00660018
008900     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)    VALUE         00662001
009000                                          'RVKRP018'.             00663018
009100                                                                  00663106
009200     05  PC-1                         PIC 9(01)     VALUE 1.      00666004
009300     05  PC-LINE-LIMIT                PIC S9(04)    VALUE +60     00667004
009400                                                    COMP SYNC.    00668004
009500                                                                  00669001
009600 01  PV-PROGRAM-VARIABLES.                                        00670001
009700     05  PV-LINE-COUNT                PIC S9(04)    VALUE +0      00680001
009800                                                    COMP SYNC.    00690001
009900     05  PV-PAGE-COUNT                PIC S9(04)    VALUE ZERO.   00700001
010000                                                                  00720001
010100  01  PV-HOLD-FIELDS.                                             02170001
010200     05  PV-HOLD-DMM-LAST-NAME       PIC  X(20)     VALUE SPACES. 02190018
010300     05  PV-HOLD-BUYER-LAST-NAME     PIC  X(20)     VALUE SPACES. 02200018
010400     05  PV-HOLD-MONTH-YEAR          PIC  X(16)     VALUE SPACES. 02241003
           05  PV-HOLD-OPER-UNT-ID         PIC  9(04)     VALUE ZERO.           
                                                                        02260001
       01  PV-SAVE-FIELDS.                                                      
           05  PV-SAVE-DMM-LAST-NAME       PIC  X(32)     VALUE SPACES.         
           05  PV-SAVE-BUYER-LAST-NAME     PIC  X(32)     VALUE SPACES.         
           05  PV-SAVE-VENDOR-NAME         PIC  X(25)     VALUE SPACES.         
                                                                                
010510 01  PV-TOTAL-FIELDS.                                                     
010520     05  PV-TOTAL-UNITS              PIC  9(06)     VALUE ZERO.           
010530     05  PV-TOTAL-COST               PIC  S9(06)V99 VALUE ZERO.           
010540     05  PV-TOTAL-RETAIL             PIC  S9(06)V99 VALUE ZERO.           
010550                                                                          
010510 01  PV-GRAND-FIELDS.                                                     
010520     05  PV-GRAND-UNITS              PIC  9(06)     VALUE ZERO.           
010530     05  PV-GRAND-COST               PIC  S9(06)V99 VALUE ZERO.           
010540     05  PV-GRAND-RETAIL             PIC  S9(06)V99 VALUE ZERO.           
010600                                                                  02270001
010700 01  HL1-HEADING-LINE-1.                                          02280001
010800     05  FILLER                      PIC  X(45)    VALUE SPACES.  02290018
010900     05  FILLER                      PIC  X(43)    VALUE          02300018
011000     'RETURN-TO-VENDOR - AGED LIST REQUEST REPORT'.               02310018
011100     05  FILLER                      PIC  X(44)    VALUE SPACES.  02330018
011200                                                                  02340001
011300 01  HL2-HEADING-LINE-2.                                          02350001
011400     05  FILLER                      PIC  X(51)    VALUE SPACES.  02360018
011500     05  FILLER                      PIC  X(23)    VALUE          02370018
011600         '30 DAYS OR OLDER AS OF '.                               02380018
011700     05  HL2-MONTH                   PIC  X(02)    VALUE SPACES.  02390018
011800     05  FILLER                      PIC  X(01)    VALUE          02391018
011900         '/'.                                                     02391118
012000     05  HL2-DAY                     PIC  X(02)    VALUE SPACES.  02392018
012100     05  FILLER                      PIC  X(01)    VALUE          02400018
012200         '/'.                                                     02401018
012300     05  HL2-YEAR                    PIC  X(04)    VALUE SPACES.  02402018
012400     05  FILLER                      PIC  X(48)    VALUE SPACES.  02403018
012500                                                                  02410001
012600 01  HL3-HEADING-LINE-3.                                          02420001
012700     05  FILLER                      PIC  X(09)    VALUE SPACES.  02430003
012800     05  HL3-DC-ID                   PIC  9(03)    VALUE ZERO.    02460018
012900     05  FILLER                      PIC  X(01)    VALUE SPACES.  02461016
013000     05  HL3-DC-NAME                 PIC  X(20)    VALUE SPACES.  02462020
013100                                                                  02480001
       01  HL4-HEADING-LINE-4.                                                  
           05  FILLER                      PIC  X(23)    VALUE SPACE.           
           05  HL4-DEPT                    PIC  X(04)    VALUE                  
               'DEPT'.                                                          
           05  FILLER                      PIC  X(04)    VALUE SPACE.           
           05  HL4-LISTING                 PIC  X(07)    VALUE                  
               'LISTING'.                                                       
           05  FILLER                      PIC  X(50)    VALUE SPACE.           
           05  HL4-TOT-COST                PIC  X(05)    VALUE                  
               'TOTAL'.                                                         
           05  FILLER                      PIC  X(07)    VALUE SPACE.           
           05  HL4-TOT-RETAIL              PIC  X(05)    VALUE                  
               'TOTAL'.                                                         
           05  FILLER                      PIC  X(10)    VALUE SPACE.           
           05  HL4-FIRST                   PIC  X(03)    VALUE                  
               '1ST'.                                                           
           05  FILLER                      PIC  X(08)    VALUE SPACE.           
           05  HL4-DAYS                    PIC  X(04)    VALUE                  
               'DAYS'.                                                          
                                                                                
       01  HL5-HEADING-LINE-5.                                                  
           05  FILLER                      PIC  X        VALUE SPACE.           
           05  HL5-DMM                     PIC  X(03)    VALUE                  
               'DMM'.                                                           
           05  FILLER                      PIC  X(06)    VALUE SPACE.           
           05  HL5-BUYER                   PIC  X(05)    VALUE                  
               'BUYER'.                                                         
           05  FILLER                      PIC  X(09)    VALUE SPACE.           
           05  HL5-DEPT-NO                 PIC  X(02)    VALUE                  
               'NO'.                                                            
           05  FILLER                      PIC  X(05)    VALUE SPACE.           
           05  HL5-LIST-NO                 PIC  X(02)    VALUE                  
               'NO'.                                                            
           05  FILLER                      PIC  X(11)    VALUE SPACE.           
           05  HL5-VENDOR                  PIC  X(06)    VALUE                  
               'VENDOR'.                                                        
           05  FILLER                      PIC  X(14)    VALUE SPACE.           
           05  HL5-AUTH-ID                 PIC  X(07)    VALUE                  
               'AUTH ID'.                                                       
           05  FILLER                      PIC  X(06)    VALUE SPACE.           
           05  HL5-UNITS                   PIC  X(05)    VALUE                  
               'UNITS'.                                                         
           05  FILLER                      PIC  X(07)    VALUE SPACE.           
           05  HL5-COST                    PIC  X(04)    VALUE                  
               'COST'.                                                          
           05  FILLER                      PIC  X(06)    VALUE SPACE.           
           05  HL5-RETAIL                  PIC  X(06)    VALUE                  
               'RETAIL'.                                                        
           05  FILLER                      PIC  X(09)    VALUE SPACE.           
           05  HL5-DATE                    PIC  X(04)    VALUE                  
               'DATE'.                                                          
           05  FILLER                      PIC  X(08)    VALUE SPACE.           
           05  HL5-OLD                     PIC  X(03)    VALUE                  
               'OLD'.                                                           
013200                                                                  02850001
013300 01  DL1-DETAIL-LINE-1.                                           02950003
013400     05  FILLER                     PIC  X(1)      VALUE SPACES.  02960018
013500     05  DL1-DMM-NAME               PIC  X(08)     VALUE SPACES.  02961018
013600     05  FILLER                     PIC  X(01)     VALUE SPACES.  02962003
013700     05  DL1-BUYER-NAME             PIC  X(12)     VALUE SPACES.  02970018
013800     05  FILLER                     PIC  X(01)     VALUE SPACES.  02980018
013900     05  DL1-DEPT-NBR               PIC  ZZZ       VALUE ZERO.    02990018
014000     05  FILLER                     PIC  X(04)     VALUE SPACES.  03000018
014100     05  DL1-LIST-NBR               PIC  Z(06)     VALUE ZERO.    03001018
014200     05  FILLER                     PIC  X(02)     VALUE SPACES.  03002018
014300     05  DL1-VENDOR-NAME            PIC  X(20)     VALUE SPACE.   03010018
014400     05  FILLER                     PIC  X(03)     VALUE SPACES.  03020013
           05  DL1-VEND-AUTH-ID           PIC  X(10)     VALUE SPACES.          
           05  FILLER                     PIC  X(04)     VALUE SPACES.          
014500     05  DL1-UNITS                  PIC  ZZ,ZZ9    VALUE ZERO.    03030018
014600     05  FILLER                     PIC  X(03)     VALUE SPACES.  03040018
014700     05  DL1-TOTAL-COST             PIC  ZZ,ZZZ.99 VALUE ZERO.    03050018
014800     05  FILLER                     PIC  X(03)     VALUE SPACES.  03060018
014900     05  DL1-TOTAL-RETAIL           PIC  ZZ,ZZZ.99 VALUE ZERO.    03070018
015000     05  FILLER                     PIC  X(06)     VALUE SPACES.  03080018
015100     05  DL1-1ST-DATE               PIC  X(10)     VALUE SPACES.  03090018
015200     05  FILLER                     PIC  X(04)     VALUE SPACES.  03100018
015300     05  DL1-DAYS-OLD               PIC  Z(04)     VALUE ZERO.    03101018
015400                                                                  03110001
015500                                                                  03290001
015600 01  TL1-TOTAL-LINE.                                              03300018
015700     05  FILLER                     PIC  X(21)     VALUE SPACES.  03310018
           05  TL1-TOT-AST                PIC  X(03)     VALUE SPACES.          
           05  FILLER                     PIC  X(01)     VALUE SPACES.          
015800     05  TL1-TOT-DESCRIPTION        PIC  X(30)     VALUE SPACES.  03320018
015900     05  FILLER                     PIC  X(20)     VALUE SPACES.  03321018
016000     05  TL1-TOT-UNITS              PIC  ZZ,ZZ9    VALUE ZERO.    03322018
016100     05  FILLER                     PIC  X(02)     VALUE SPACES.  03330018
016200     05  TL1-TOT-COST               PIC  ZZZ,ZZZ.99  VALUE ZERO.  03340018
016300     05  FILLER                     PIC  X(02)     VALUE SPACES.  03350018
016400     05  TL1-TOT-RETAIL             PIC  ZZZ,ZZZ.99  VALUE ZERO.  03360018
016500                                                                  03440001
016600                                                                  03620001
016700 01  PR-PRINT-FINAL.                                              03710001
016800     05  FILLER                      PIC X(53)  VALUE SPACES.     03720001
016900     05  FILLER                      PIC X(21)  VALUE             03730001
017000         '*** END OF REPORT ***'.                                 03740001
017100                                                                  03750001
017200                                                                  03760001
017300 01  PR-PRINT-NO-DETAIL.                                          03770001
017400     05  FILLER                      PIC X(53)  VALUE SPACES.     03780001
017500     05  FILLER                      PIC X(29)  VALUE             03790001
017600         '*** NO DETAILS TO REPORT ***'.                          03800001
017700                                                                  03810006
017800*---------------------------------------------------------------* 04010001
017900*  COPYBOOK USED FOR INPUT FILE                                 * 04020001
018000*---------------------------------------------------------------* 04030001
018100     COPY RVWS014.                                                04040020
018200                                                                  04050001
018300*---------------------------------------------------------------* 04060001
018400*  COPYBOOK USED FOR OUTPUT REPORT (132 POS)                    * 04070001
018500*---------------------------------------------------------------* 04080001
018600     COPY DPWS132O.                                               04090001
018700                                                                  04100001
018800***************************************************************** 04110001
018900 PROCEDURE DIVISION.                                              04120001
019000     DISPLAY '**** START OF RVKRP018 ****'.                       04121021
019100                                                                  04122021
019200*OPEN FILES.                                                      04140021
019300     OPEN  INPUT INPUT-FILE                                       04161021
019400           OUTPUT REPORT-FILE.                                    04162021
019500                                                                  04163021
019600*READ FIRST INPUT RECORD.                                         04164021
019700     SET PS-NOT-END-OF-INPUT TO TRUE.                             04165021
019800     PERFORM 7000-READ-INPUT-FILE.                                04166121
019900                                                                  04167021
020000*SET/PRINT REPORT HEADINGS.                                       04168021
020100     PERFORM 1000-INITIALIZE.                                     04170001
020200                                                                  04180001
020300*PROCESS INPUT FILE.                                              04181021
020400     IF  PS-END-OF-INPUT                                          04190021
020500         PERFORM 6800-NO-REPORT-DETAIL                            04200001
020600         SET PS-NO-DETAIL  TO  TRUE                               04210001
020700     ELSE                                                         04220001
020800         PERFORM 2000-MAIN-PROCESS                                04230001
020900           UNTIL  PS-END-OF-INPUT.                                04240021
021000                                                                  04250001
021100     IF  PS-NO-DETAIL                                             04260001
021200         NEXT SENTENCE                                            04270001
021300     ELSE                                                         04280001
               PERFORM 4600-STORE-TOTALS                                        
               PERFORM 4700-GET-DC-NAME                                         
027704         PERFORM 6200-PRINT-TOTALS                                        
               PERFORM 4650-GRAND-TOTALS                                        
               PERFORM 4750-GET-GRD-NAME                                        
               PERFORM 6250-PRINT-GRAND                                         
021400         PERFORM 6600-PRINT-END-OF-REPORT.                        04340001
021500                                                                  04350001
021600     PERFORM 9000-END-PROCESS.                                    04360001
021700                                                                  04370001
021800     GOBACK.                                                      04380001
021900                                                                  04390001
022000                                                                  04390103
022100*---------------------------------------------------------------* 04391003
022200*  PROGRAM INITIALIZATION                                       * 04392003
022300*    -- OPEN INPUT AND OUTPUT FILES.                            * 04393003
022400*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 04394003
022500*       THE REPORT HEADINGS.                                    * 04395003
022600*---------------------------------------------------------------* 04396003
022700 1000-INITIALIZE.                                                 04400001
022800                                                                  04490001
022900     ACCEPT CD-CPU-DATE FROM DATE.                                04500001
023000     ACCEPT CT-CPU-TIME FROM TIME.                                04510001
023200                                                                  04511121
023300     IF PS-NOT-END-OF-INPUT                                       04512021
023310         MOVE RV014-OPER-UNT-ID     TO PV-HOLD-OPER-UNT-ID                
                                             HL3-DC-ID                          
023400         MOVE RV014-DMM-LAST-NAME   TO PV-HOLD-DMM-LAST-NAME      04520021
023500         MOVE RV014-BUYER-LAST-NAME TO PV-HOLD-BUYER-LAST-NAME    04560021
023600     ELSE                                                         04561021
023610         MOVE ZEROS                 TO PV-HOLD-OPER-UNT-ID                
023700         MOVE SPACES                TO PV-HOLD-DMM-LAST-NAME      04562021
023800                                       PV-HOLD-BUYER-LAST-NAME    04563021
023900     END-IF                                                       04564021
024000                                                                  04610001
024100     PERFORM 1100-INITIALIZE-HEADINGS.                            04680003
024200     PERFORM 6000-PRINT-RPT-HEADING.                              04690001
024300                                                                  04700001
024400                                                                  04710001
024500*---------------------------------------------------------------* 04720003
024600*  INITIALIZE REPORT HEADINGS                                   * 04721003
024700*---------------------------------------------------------------* 04730003
024800 1100-INITIALIZE-HEADINGS.                                        05090003
024900     MOVE CD-YEAR                TO DP132O-RUN-YEAR               05130001
                                          HL2-YEAR.                             
025000     MOVE CD-MONTH               TO DP132O-RUN-MONTH              05140001
                                          HL2-MONTH.                            
025100     MOVE CD-DAY                 TO DP132O-RUN-DAY                05150001
                                          HL2-DAY.                              
025200     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              05160001
025300     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            05170001
025400     MOVE 'RVKRP018'             TO DP132O-PROGRAM-NAME.          05180002
025500     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         05190001
025600                                                                  05220001
025700                                                                  05261003
025800 2000-MAIN-PROCESS.                                               05830001
025900                                                                  05840001
026000     ADD  1  TO  PV-RECORD-COUNT.                                 05850001
026100                                                                  05860001
026200     IF  RV014-DMM-LAST-NAME  NOT = PV-HOLD-DMM-LAST-NAME AND     05860120
026300         RV014-BUYER-LAST-NAME  NOT = PV-HOLD-BUYER-LAST-NAME AND 05860220
               RV014-OPER-UNT-ID NOT = PV-HOLD-OPER-UNT-ID                      
026400         MOVE RV014-DMM-LAST-NAME    TO PV-HOLD-DMM-LAST-NAME     05860320
026500         MOVE RV014-BUYER-LAST-NAME  TO PV-HOLD-BUYER-LAST-NAME   05860420
026600         PERFORM 6000-PRINT-RPT-HEADING                           05861115
026700     ELSE                                                         05861215
026800     IF  RV014-DMM-LAST-NAME  NOT = PV-HOLD-DMM-LAST-NAME         05861320
026900         MOVE RV014-DMM-LAST-NAME    TO PV-HOLD-DMM-LAST-NAME     05861420
027000         MOVE RV014-BUYER-LAST-NAME  TO PV-HOLD-BUYER-LAST-NAME   05861520
027100         PERFORM 6000-PRINT-RPT-HEADING                           05861815
027200     ELSE                                                         05861915
027300     IF  RV014-BUYER-LAST-NAME NOT = PV-HOLD-BUYER-LAST-NAME      05862020
027400         MOVE RV014-DMM-LAST-NAME    TO PV-HOLD-DMM-LAST-NAME     05862120
027500         MOVE RV014-BUYER-LAST-NAME  TO PV-HOLD-BUYER-LAST-NAME   05862220
027700         PERFORM 6000-PRINT-RPT-HEADING                           05862515
           ELSE                                                                 
027702     IF  RV014-OPER-UNT-ID NOT = PV-HOLD-OPER-UNT-ID                      
027400         MOVE RV014-DMM-LAST-NAME    TO PV-HOLD-DMM-LAST-NAME     05862120
027500         MOVE RV014-BUYER-LAST-NAME  TO PV-HOLD-BUYER-LAST-NAME   05862220
                                                                                
               PERFORM 4700-GET-DC-NAME                                         
               PERFORM 4600-STORE-TOTALS                                        
027704         PERFORM 6200-PRINT-TOTALS                                        
027703         MOVE RV014-OPER-UNT-ID      TO PV-HOLD-OPER-UNT-ID               
                                              HL3-DC-ID                         
027700         PERFORM 6000-PRINT-RPT-HEADING.                          05862515
027710                                                                          
027800*BUILD DETAIL LINE.                                               05862621
           IF RV014-DMM-LAST-NAME = PV-SAVE-DMM-LAST-NAME                       
               MOVE SPACE                  TO DL1-DMM-NAME                      
           ELSE                                                                 
               MOVE RV014-DMM-LAST-NAME    TO DL1-DMM-NAME                      
               MOVE RV014-DMM-LAST-NAME    TO PV-SAVE-DMM-LAST-NAME             
           END-IF.                                                              
                                                                                
           IF RV014-BUYER-LAST-NAME = PV-SAVE-BUYER-LAST-NAME                   
               MOVE SPACE                  TO DL1-BUYER-NAME                    
           ELSE                                                                 
               MOVE RV014-BUYER-LAST-NAME  TO DL1-BUYER-NAME                    
               MOVE RV014-BUYER-LAST-NAME  TO PV-SAVE-BUYER-LAST-NAME           
           END-IF.                                                              
                                                                                
           IF RV014-VENDOR-NAME = PV-SAVE-VENDOR-NAME                           
               MOVE SPACE                  TO DL1-VENDOR-NAME                   
           ELSE                                                                 
               MOVE RV014-VENDOR-NAME      TO DL1-VENDOR-NAME                   
               MOVE RV014-VENDOR-NAME      TO PV-SAVE-VENDOR-NAME               
           END-IF.                                                              
027820                                                                          
027830     MOVE RV014-DEPT-NBR             TO DL1-DEPT-NBR.                     
027840     MOVE RV014-DFCT-ORD-ID          TO DL1-LIST-NBR.                     
           MOVE RV014-VEND-AUTH-ID         TO DL1-VEND-AUTH-ID.                 
027860     MOVE RV014-UNITS                TO DL1-UNITS.                        
027870     MOVE RV014-TOTAL-COST           TO DL1-TOTAL-COST.                   
027880     MOVE RV014-TOTAL-RETAIL         TO DL1-TOTAL-RETAIL.                 
027890     MOVE RV014-FIRST-DATE           TO DL1-1ST-DATE.                     
027891     MOVE RV014-DAYS-OLD             TO DL1-DAYS-OLD.                     
027892                                                                          
027893*ADD TO TOTALS                                                            
027894     ADD RV014-UNITS                 TO PV-TOTAL-UNITS.                   
027895     ADD RV014-TOTAL-COST            TO PV-TOTAL-COST.                    
027896     ADD RV014-TOTAL-RETAIL          TO PV-TOTAL-RETAIL.                  
027897                                                                          
027893*ADD TO GRAND TOTALS                                                      
027894     ADD RV014-UNITS                 TO PV-GRAND-UNITS.                   
027895     ADD RV014-TOTAL-COST            TO PV-GRAND-COST.                    
027896     ADD RV014-TOTAL-RETAIL          TO PV-GRAND-RETAIL.                  
                                                                                
027899*PRINT DETAIL LINE.                                                       
027900     PERFORM 6100-PRINT-DETAIL.                                           
027910                                                                          
028000*READ ANOTHER INPUT RECORD.                                               
030400     PERFORM 7000-READ-INPUT-FILE.                                06840001
030500                                                                  06850001
030600                                                                  06860001
033000                                                                  09030001
037600                                                                  09215503
037700 4600-STORE-TOTALS.                                               09218503
037800*---------------------------------------------------------------* 09218601
037900*  BUILD/PRINT STORE TOTAL LINE                                 * 09218701
038000*---------------------------------------------------------------* 09218801
038200         MOVE  PV-TOTAL-UNITS        TO TL1-TOT-UNITS.            09219003
038300         MOVE  PV-TOTAL-COST         TO TL1-TOT-COST.             09219103
038500         MOVE  PV-TOTAL-RETAIL       TO TL1-TOT-RETAIL.           09219305
039600                                                                  09220403
037700 4650-GRAND-TOTALS.                                               09218503
037800*---------------------------------------------------------------* 09218601
037900*  BUILD/PRINT STORE GRAND TOTAL LINE                           * 09218701
038000*---------------------------------------------------------------* 09218801
038200         MOVE  PV-GRAND-UNITS        TO TL1-TOT-UNITS.            09219003
038300         MOVE  PV-GRAND-COST         TO TL1-TOT-COST.             09219103
038500         MOVE  PV-GRAND-RETAIL       TO TL1-TOT-RETAIL.           09219305
039600                                                                  09220403
040000*---------------------------------------------------------------* 09220803
040100*  GET DC NAME                                                  * 09220903
040200*---------------------------------------------------------------* 09221003
037700 4700-GET-DC-NAME.                                                09218503
           MOVE '***' TO TL1-TOT-AST.                                           
           IF PV-HOLD-OPER-UNT-ID = 0090                                        
               MOVE PC-DESCRIPTION-8   TO  TL1-TOT-DESCRIPTION                  
           ELSE                                                                 
             IF PV-HOLD-OPER-UNT-ID = 0085                                      
               MOVE PC-DESCRIPTION-2   TO  TL1-TOT-DESCRIPTION                  
             ELSE                                                               
               IF PV-HOLD-OPER-UNT-ID = 0810                                    
                 MOVE PC-DESCRIPTION-1   TO  TL1-TOT-DESCRIPTION                
               ELSE                                                             
                 IF PV-HOLD-OPER-UNT-ID = 0830                                  
                   MOVE PC-DESCRIPTION-3   TO  TL1-TOT-DESCRIPTION              
                 ELSE                                                           
                   IF PV-HOLD-OPER-UNT-ID = 0840                                
                     MOVE PC-DESCRIPTION-4  TO  TL1-TOT-DESCRIPTION             
                   ELSE                                                         
                     IF PV-HOLD-OPER-UNT-ID = 0865                              
                       MOVE PC-DESCRIPTION-5 TO TL1-TOT-DESCRIPTION             
                     ELSE                                                       
                       IF PV-HOLD-OPER-UNT-ID = 0860                            
                         MOVE PC-DESCRIPTION-6 TO TL1-TOT-DESCRIPTION           
                       ELSE                                                     
                         IF PV-HOLD-OPER-UNT-ID = 0855                          
                           MOVE PC-DESCRIPTION-7                                
                                                TO TL1-TOT-DESCRIPTION          
                         ELSE                                                   
                           MOVE PC-DESCRIPTION-T                                
                                                TO TL1-TOT-DESCRIPTION          
                         END-IF                                                 
                       END-IF                                                   
                     END-IF                                                     
                   END-IF                                                       
                 END-IF                                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
040000*---------------------------------------------------------------* 09220803
040100*  GET GRAND TOTAL NAME                                         * 09220903
040200*---------------------------------------------------------------* 09221003
037700 4750-GET-GRD-NAME.                                               09218503
           MOVE '***' TO TL1-TOT-AST.                                           
           MOVE PC-DESCRIPTION-G   TO  TL1-TOT-DESCRIPTION.                     
                                                                                
 40000*---------------------------------------------------------------* 09220803
040100*  HEADING ROUTINE.                                             * 09220903
040200*---------------------------------------------------------------* 09221003
040300 6000-PRINT-RPT-HEADING.                                          09337001
040400                                                                  09338003
           ADD 1                       TO PV-PAGE-COUNT.                        
                                                                                
040600     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           09360001
040700                                                                  09370001
040800     MOVE 8                      TO PV-LINE-COUNT.                09380001
040900                                                                  09390001
041000     WRITE REPORT-RECORD                                          09400001
041100       FROM DP132O-STANDRD-HEADER-132-COLS                        09410001
041200         AFTER ADVANCING PAGE.                                    09420001
041300                                                                  09430001
041400     WRITE REPORT-RECORD                                          09440001
041500       FROM HL1-HEADING-LINE-1                                    09450001
041600         AFTER ADVANCING 1 LINES.                                 09460001
041700                                                                  09470001
041800     WRITE REPORT-RECORD                                          09480001
041900       FROM HL2-HEADING-LINE-2                                    09490001
042000         AFTER ADVANCING 1 LINES.                                 09500001
042100                                                                  09510001
042200     WRITE REPORT-RECORD                                          09520001
042300       FROM HL3-HEADING-LINE-3                                    09530001
042400         AFTER ADVANCING 1 LINES.                                 09540001
042500                                                                  09550001
042200     WRITE REPORT-RECORD                                          09520001
042300       FROM HL4-HEADING-LINE-4                                    09530001
042400         AFTER ADVANCING 2 LINES.                                 09540001
042500                                                                  09550001
042200     WRITE REPORT-RECORD                                          09520001
042300       FROM HL5-HEADING-LINE-5                                    09530001
042400         AFTER ADVANCING 1 LINES.                                 09540001
042500                                                                  09550001
043400     MOVE  SPACES TO  REPORT-RECORD.                              09651011
043500     WRITE REPORT-RECORD                                          09651111
043600         AFTER ADVANCING 2 LINES.                                 09653011
043700                                                                  09654011
           SET PS-NEW-PAGE   TO TRUE.                                           
043800                                                                  09660001
043900*---------------------------------------------------------------* 09661003
044000*  PRINT DETAIL LINES                                           * 09662003
044100*---------------------------------------------------------------* 09663003
044200 6100-PRINT-DETAIL.                                               09664003
044300                                                                  09665003
044400     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            09666003
044500         PERFORM 6000-PRINT-RPT-HEADING                           09667003
044600     END-IF.                                                      09668003
044700                                                                  09669003
           IF PS-NEW-PAGE                                                       
               MOVE RV014-DMM-LAST-NAME    TO DL1-DMM-NAME                      
               MOVE RV014-BUYER-LAST-NAME  TO DL1-BUYER-NAME                    
               MOVE RV014-VENDOR-NAME      TO DL1-VENDOR-NAME                   
               SET PS-NOT-NEW-PAGE         TO TRUE                              
           END-IF.                                                              
                                                                                
044800     WRITE REPORT-RECORD                                          09669103
044900       FROM DL1-DETAIL-LINE-1                                     09669203
045000         AFTER ADVANCING 1 LINES.                                 09669303
045100     ADD 1                       TO PV-LINE-COUNT.                09669403
046100                                                                  09670403
046900                                                                  09671803
047000                                                                  09672303
047100*---------------------------------------------------------------* 09673003
047200*  PRINT STORE TOTALS                                           * 09680003
047300*---------------------------------------------------------------* 09690003
047400 6200-PRINT-TOTALS.                                               10180003
047500                                                                  10220001
047600     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10230001
047700         PERFORM 6000-PRINT-RPT-HEADING                           10240001
047800     END-IF.                                                      10241001
047900                                                                  10242001
048000     WRITE REPORT-RECORD                                          10243001
048100       FROM TL1-TOTAL-LINE                                        10244001
048200         AFTER ADVANCING 2 LINES.                                 10245001
048300     ADD 2                       TO PV-LINE-COUNT.                10246001
048400                                                                  10247001
049800     MOVE SPACES  TO  REPORT-RECORD.                              10250804
049900     WRITE REPORT-RECORD                                          10250904
050000         AFTER ADVANCING 1 LINES.                                 10251004
050100     ADD 1                       TO PV-LINE-COUNT.                10251104
050200                                                                  10251204
050300     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10251304
050400         PERFORM 6000-PRINT-RPT-HEADING                           10251404
050500     END-IF.                                                      10251504
050600                                                                  10251604
                                                                                
047100*---------------------------------------------------------------* 09673003
047200*  PRINT STORE GRAND TOTAL                                      * 09680003
047300*---------------------------------------------------------------* 09690003
047400 6250-PRINT-GRAND.                                                10180003
047500                                                                  10220001
047700     PERFORM 6000-PRINT-RPT-HEADING.                              10240001
047900                                                                  10242001
048000     WRITE REPORT-RECORD                                          10243001
048100       FROM TL1-TOTAL-LINE                                        10244001
048200         AFTER ADVANCING 2 LINES.                                 10245001
048300     ADD 2                       TO PV-LINE-COUNT.                10246001
048400                                                                  10247001
049800     MOVE SPACES  TO  REPORT-RECORD.                              10250804
049900     WRITE REPORT-RECORD                                          10250904
050000         AFTER ADVANCING 1 LINES.                                 10251004
050100     ADD 1                       TO PV-LINE-COUNT.                10251104
                                                                                
050800 6600-PRINT-END-OF-REPORT.                                        10251804
050900*---------------------------------------------------------------* 10251904
051000*  PRINT END OF REPORT BANNER                                   * 10252004
051100*---------------------------------------------------------------* 10252104
051200                                                                  10253001
051300     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10254001
051400         PERFORM 6000-PRINT-RPT-HEADING                           10255001
051500     END-IF.                                                      10256001
051600                                                                  10257001
051700     WRITE REPORT-RECORD                                          10258001
051800       FROM PR-PRINT-FINAL                                        10259001
051900         AFTER ADVANCING 2 LINES.                                 10260001
052000     ADD 2                       TO PV-LINE-COUNT.                10270001
052100                                                                  10280001
052200                                                                  10290001
052300 6800-NO-REPORT-DETAIL.                                           10300001
052400*---------------------------------------------------------------* 10310001
052500*  PRINT "NO DETAIL REPORT' BANNER                              * 10320001
052600*---------------------------------------------------------------* 10330001
052700                                                                  10340001
052800     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10350001
052900         PERFORM 6000-PRINT-RPT-HEADING                           10360001
053000     END-IF.                                                      10370001
053100                                                                  10380001
053200     WRITE REPORT-RECORD                                          10390001
053300       FROM PR-PRINT-NO-DETAIL                                    10400001
053400         AFTER ADVANCING 2 LINES.                                 10410001
053500     ADD 2                       TO PV-LINE-COUNT.                10420001
053600                                                                  10430001
053700                                                                  10440001
053800 7000-READ-INPUT-FILE.                                            10450001
053900*---------------------------------------------------------------* 10460001
054000*  READ INPUT FILE                                              * 10470001
054100*---------------------------------------------------------------* 10480001
054200                                                                  10490001
054300      READ INPUT-FILE INTO RV014-EXTRACT-RECORD                   10500020
054400          AT END                                                  10510001
054500             SET PS-END-OF-INPUT TO TRUE.                         10520021
054600                                                                  10530001
054700                                                                  10540001
054800 9000-END-PROCESS.                                                10550001
054900*---------------------------------------------------------------* 10560001
055000*  CLOSE FILES.                                                   10570001
055100*---------------------------------------------------------------* 10580001
055200                                                                  10590001
055300                                                                  10600001
055400     CLOSE INPUT-FILE                                             10610001
055500           REPORT-FILE.                                           10620001
055600                                                                  10630001
055700*                                                                 10640001
055800*9900-DB2-ABEND.                                                  10650003
055900*---------------------------------------------------------------* 10660001
056000*  DB2-ABEND-PROCESSING                                           10670001
056100*---------------------------------------------------------------* 10680001
056200*                                                                 10690003
056300*    DISPLAY '*** DB2 ERROR '.                                    10700003
056400*    DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       10710003
056500*    DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10720003
056600*    DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10730003
056700*    DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10740003
056800*    DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MSG-1.           10750003
056900*    DISPLAY '***           = ' PV-DB2-OPERATION-MSG-2.           10760003
057000*    DISPLAY '***           = ' PV-DB2-OPERATION-MSG-3.           10770003
057100*    DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             10780003
057200*                                                                 10790003
057300*COPY DPPD004                                                     10800003
057400*                                                                 10810003
057500*    MOVE +4013                  TO PV-ABEND-CODE.                10820003
057600*    CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10830003
057700*                                                                 10840003
057800****************************************************************  10850001
