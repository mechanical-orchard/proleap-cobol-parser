       ID  DIVISION.                                                    00020000
00002  PROGRAM-ID.         INKUT102.                                    00030000
00003  AUTHOR.             TROY BIRK.                                   00040000
00004  INSTALLATION.       KOHLS DEPARTMENT STORES.                     00050000
00005  DATE-WRITTEN.       08/93.                                       00060000
00006  DATE-COMPILED.                                                   00070000
00007                                                                   00080000
00008 ******************************************************************00090000
00009 *    INVENTORY EDIT PROGRAM                                       00100000
00010 ******************************************************************00110000
00011 *                   CHANGE LOG                                   *00120000
00012 ******************************************************************00130000
00013 *  03/94  MARC BLAZICH                                           *00140000
00014 *  ADDED  MOVE STATEMENT FOR SCAN_LINE_NBR, CHANGED IN AND       *00150000
00015 *  OUT COPYBOOKS TO REFLECT SCAN-LINE-NBR                        *00160000
00016 ******************************************************************00170000
00017 *  KIM WRIGHT                                   9/16/94         * 00180000
00018 *  CHANGED THE SELECTION OF CUTOFF PRICE ON THE TSKST TABLE TO  * 00190000
00019 *  SELECT FROM STORE '000' INSTEAD OF THE SPECIFIC STORE        * 00200000
00020 ******************************************************************00210000
00021 *  MICHELLE WEBB                                1/17/95         * 00220000
00022 *  CHANGED THE PROGRAM TO JUST DISPLAY ANY SKUS IT CAN'T RENUMBER 00230000
00020 ******************************************************************00240000
00021 *  TOM MEDREK                                   1/01/97         * 00250000
00022 *  PULLED CODE WHICH MADE NON-CLEARANCE ITEMS WITH PRICE OF     * 00260000
00022 *  ZERO INVALID.  GIFT-WITH-PURCHASE ITEMS CAN NOW BE VALID.    * 00270000
00023 ******************************************************************00280000
00021 *  JULIE SEIDLER                                4/07/98         * 00290000
00022 *  MADE CHANGES FOR Y2K SUPPORT.  NEEDED TO MODIFY              * 00300000
 0022 *  DATE COMPARISON LOGIC AGAINST TSK-STAT-CHNGD-DATE.           * 00310000
00023 ******************************************************************00320000
00021 *  JULIE SEIDLER                                5/08/98         * 00330000
00022 *  ADD LOGIC TO FORMAT IN009-QUANTITY AS A COMP FIELD           * 00340000
 0022 *  INSTEAD OF AS A DECIMAL FIELD.                               * 00350000
00023 ******************************************************************00360000
00021 *  JULIE SEIDLER                                5/26/98         * 00370000
00022 *  ADD LOGIC TO ONLY SET THE MISSED MARKDOWN FLAG FOR           * 00380000
 0022 *  CONTINUING CLEARANCE ITEMS.                                  * 00390000
00023 ******************************************************************00400000
00021 *  JULIE SEIDLER                                1/21/99         * 00410000
00022 *  CORRECTED PROBLEM WHEN STAT-CHG-PRICE WAS NOT SELECTED       * 00420000
 0022 *  WHEN THE UPC WAS ZERO.                                       * 00430000
00023 ******************************************************************00440000
00021 *  JULIE SEIDLER                                1/22/99         * 00450000
00022 *  ADDED Y2K LOGIC INTO MISSED-MARKDOWN PROCESS                 * 00460000
00023 ******************************************************************00470000
00021 *  MARIA KLAMIK                                 2/03/99         * 00480000
      *  EXPAND COPYBOOKS INWS008, INWS009 AND INWS010 TO ACCOMMODATE * 00490000
      *  THE NEW DATE AND TIMESTAMP FIELDS.                           * 00500000
00023 ******************************************************************00510000
JUNE99*  SCOTT JACKSON                                3/25/99          *00520000
JUNE99*  ITEM STATUS CODE NOW RETRIEVED FROM TSKST(INV-CTOFF-STAT-CODE)*00530000
JUNE99*  THIS RETRIEVES INDIVIDUAL STORE ITEM STATUS AND CUTOFF RETAIL.*00540000
JUNE99*  ALSO CHGS FOR MISSED MARKDOWNS ('RED'STAT=31/'YELLOW'STAT=32).*00550000
JUNE99*  FLAG MMKDWN ON ALL RED TICKETS-OR-YELLOW TICKT IN AREAS < 7000*00560000
00023 ******************************************************************00570000
00021 *  TESS BESTE  WR20362                         09/10/99         * 00580000
00021 *                                                               * 00590000
      *  PROGRAM WAS NOT FLAGGING SKU 000 RECORDS OUTSIDE OF AREAS    * 00600000
      *  9000-9999 AS INVALID. ADDED LINES TO B300-EDIT-INVENTORY TO  * 00610000
      *  CHECK THE SKU SEQ NBR FOR ZERO IN AREAS OUTSIDE OF THE       * 00620000
      *  9000-9999 RANGE.  THE CHECK WAS ALREADY LOOKING FOR INTERNAL * 00630000
      *  UPCS WITH SEQ NBR 000 OR 999 AND SKUS WITH SEQ NBR 999.      * 00640000
      *  CHANGED IT TO ALSO LOOK FOR SKUS WITH SEQ NBR 000.           * 00650000
00021 *                                                               * 00660000
00021 *  MADE AN ADDITIONAL CHANGE IN B300-EDIT-INVENTORY TO CORRECT  * 00670000
00021 *  A PROBLEM IN WHICH INCORRECT PRICES WERE BEING PUT ON        * 00680000
00021 *  INVALID RECORDS.  PV-LOOKUP-PRICE WAS BEING MOVED TO THE     * 00690000
00021 *  RECORD REGARDLESS OF WHETHER THE RECORD WAS VALID. CHANGED   * 00700000
00021 *  LOGIC TO ONLY MOVE IT TO THE RECORD IF THE RECORD WAS VALID. * 00710000
00023 ******************************************************************00720000
00021 *  AMY LAWSON                                  11/23/99         * 00730000
00021 *                                                               * 00740000
00021 *  CHANGED PROGRAM TO GET UNIT PRICE AND STATUS FROM TUPCPLS    * 00750000
00021 *  INSTEAD OF TSKST.                                            * 00760000
00023 ******************************************************************00770000
00021 *  JULIE SEIDLER                               03/03/00         * 00780000
00021 *                                                               * 00790000
      *  REMOVED LOGIC THAT SETS MISSED MARKDOWN INDICATOR TO 'T'     * 00800000
      *  FOR YELLOW TICKET CLEARANCE ITEMS.                           * 00810000
00021 *                                                               * 00820000
00021 *  ALSO ADDED LOGIC FOR RCP PROJECT.  THE INPUT FILE IS SORTED  * 00830000
00021 *  IN UPC/SKU THEN STORE SEQUENCE.  THE PROGRAM ORIGINALLY GETS * 00840000
00021 *  TUPCPLS PRICE AND STATUS INFO WHEN THE UPC/SKU CHANGES.      * 00850000
00021 *  WITH REGIONAL PRICES ITEMS, THE PRICE AND STATUS MAY BE      * 00860000
00021 *  DIFFERENT FOR THE SAME ITEM BETWEEN STORES.  THEREFORE       * 00870000
00021 *  THE PROGRAM WAS CHANGED TO GET THE TUPCPLS PRICE AND STATUS    00880000
00021 *  FOR EACH REGIONAL CLEARANCED ITEM.                           * 00890000
00023 ******************************************************************00900000
00021 *  SCOTT JACKSON                               05/08/00         * 00910000
00023 *  CHANGED PARA B300-  TO USE UPCPLS-STAT-CDE INSTEAD           * 00920000
00023 *  OF TSK-STATUS-CODE                                           * 00930000
IN2001******************************************************************00940000
IN2001*  SCOTT JACKSON       CHANGE ID: IN2001        9/21/2000        *00950000
IN2001*  RETIRE TSK.REGN_PRIC_IND IN DETERMINING RCP STATUS OF AN ITEM.*00960000
IN2001*  TSK,TUPCSKU ARE USED TO RETRIEVE ITEM_NMBR. TUPCPLS USES ITEM *00970000
IN2001*  NUMBER TO SELECT STATUS OF STR000 ROW. A STR000 STATUS OF '25'*00980000
IN2001*  IDENTIFIES THE ITEM AS AN RCP ITEM. IF STR000 IS AN RCP, THEN *00990000
IN2001*  THE INDIVIDUAL STORE-SPECIFIC ROW IS SEARCHED FOR ON TUPCPLS. *01000000
IN2001*  IF A STORE-SPECIFIC ROW IS FOUND, LOOK FOR AN 'ACTIVE' ROW    *01010000
IN2001*  THAT WAS IN EXISTENCE BASED ON THE PLND_INV_DTE TIMESTAMP.    *01020000
IN2001*  IF A STORE-SPECIFIC ROW CANNOT BE FOUND TO FIT THE TIMESTAMP  *01030000
IN2001*  CRITERIA, THEN THIS ROW WILL BE PROCESSED AS AN 'ACTIVE' SKU  *01040000
IN2001*  USING THE PRICING FROM THE STR0000 ROW. STORE-SPECIFIC ROWS   *01050000
IN2001*  THAT ARE FOUND WILL CARRY A STATUS OF '30' (CLEARANCE) .      *01060000
IN2001**********                                              **********01070000
IN2001*  ADDED ADDITIONAL OUTPUT FILE THAT WILL BE ROUTED AS EMAIL.    *01080000
IN2001*  INCLUDE UPC / SKU FOR ITEMS WHICH HAD NO STR000 ROW (TUPCPLS) *01090000
INK001**********                                              **********01100000
IN2001*  SCOTT JACKSON       CHANGE ID: INK001        1/12/2001        *01110000
INK001*  POSSIBLE MISSED MARKDOWNS - GET STORE-SPECIFIC PRICING TO      01120000
INK001*  ENSURE ACCURATE PRICING RETRIEVED FOR PREVIOUS STR000 STAT '25'01130000
INK001*  NOW STR000 '30' WITH STORE ROWS AT MULTIPLE PRICES.            01140000
INK001*  PULLED C400-LOOKUP LOGIC FROM B300-PROCESS SINCE PRICE HAS     01150000
INK001*  ALREADY BEEN RESOLVED WHILE VALIDATING SKU/UPC.                01160000
W03072**********                                              **********01170000
W03072*  ROD JANSSEN         CHANGE ID: 99999         3/07/2002        *01180000
W03072*  BUILD IN EFFICIENCIES TO TUPCPLS (PER BRAD DORN)               01190000
INK001******************************************************************01200000
IN0501*                                                                 01210000
IN0501*  SCOTT JACKSON       CHANGE ID: IN0501        5/25/2001         01220000
IN0501*  RCP ITEMS SORTED TOGETHER WITH MULTIPLE STORES WAS CHECKING FOR01230000
IN0501*  SAME SKU-STORE AND SETTING FLAG BUT NOT EXECUTING RETRIEVAL OF 01240000
IN0501*  PRICING FOR THE NEW STORE. IF NOT SAME SKU/SAME STORE, EXECUTE 01250000
IN0501*  PRICING LOGIC MODULES WILL TO FORCE EXTRACT OF STORE-SPECIFIC  01260000
IN0501*  LOGIC.                                                         01270000
IN0501*                                                                 01280000
IN0501******************************************************************01290000
W21732*  IGSI                CHANGE ID: W21732        11/25/2002        01300000
W21732*  3 DIGIT SKU SEQUENCE NUMBER HAS BEEN REPLACED WITH 8 DIGIT     01310000
W21732*  NON-INTELLIGENT SKU IN CHECKING/VALIDATING SKU. AND ADDED      01320000
W21732*  4 DIGIT DEPT/CLASS IN PLACE OF DEPT/CLASS IN THE EXISTING      01330000
W21732*  LOGIC. RECORD LENGTH OF PHYSICAL-INVENTORY-FILE HAS BEEN       01340000
W21732*  INCREASED TO 100. RECORD LENGTH OF EDITED-INVENTORY-FILE       01350000
W21732*  INCREASED TO 70. RECORD LENGTH OF VALID-INV-REPORT-FILE        01360000
W21732*  INCREASED TO 100.                                              01370000
W21732******************************************************************01380000
C21732*  KOHLS               CHANGE ID: C21732        04/21/2002        01390000
C21732*  FIX ISSUES RELATED TO NIS CHANGES. DUMMY SKU / RENUMBERS       01400000
S21732******************************************************************01410000
S21732*  SCOTT JACKSON       CHANGE ID: S21732        06/25/2002        01420000
S21732*  FIX MESSAGING FOR EMAIL FILE. PROVIDE MORE MEANINGFUL INFO.    01430000
      ******************************************************************01440000
25248 * 25248    10-06-2003  UPC CAPABILITIES & STORE NUMBER EXPANSION  01450000
25248 *                      -ROD JANSSEN                               01460000
S21732******************************************************************01470000
W26600* W26600  06-  -2004  PHYSICAL INVENTORY STORE EXPANSION          01480000
W26600*                     M JOHNSON                                   01490000
P28545*W28545  03-24-2006 ROD JANSSEN CYCLE INVENTORY PRICE MODULE SETUP01500000
Z28545*W28545  08-07-2006 ROD JANSSEN   IN400-***-SKU-OUT LOGIC NEEDS TO01510000
Z28545*                               USE THE RESULTANT SKU RATHER THAN 01520000
Z28545*                               CREATE A SKU BASED ON UPC_NBR.    01530000
Z28545*                                 IN400-***-UPC-OUT LOGIC NEEDS TO01540000
Z28545*                               RETAIN THE PASSED IN UPC_NBR IF   01550000
Z28545*                               PRESENT; OTHERWISE, PASS BACK THE 01560000
Z28545*                               KOHLS UPC_NBR.                    01570000
W26600*                                                                 01580000
W26600******************************************************************01590000
W33304*  PATTY JAEGER        CHANGE ID: W33304        06/06/2008        01591000
W33304*  HILO CHANGES TINVPAR AND TINCNTL CHANGES.                      01592000
      ******************************************************************01593000
SR3403*  CHANDAN RACHH       CHANGE ID: SR3403        04/02/2012        01594002
SR3403*  EXPAND PRICE FIELDS AND LRECL OF EDITED INVENTORY FILE FOR     01595003
SR3403*  LARGE RETAIL PROJECT                                           01595103
SR3403******************************************************************01596002
00024                                                                   01600000
00025  ENVIRONMENT DIVISION.                                            01610000
00027  CONFIGURATION SECTION.                                           01620000
00029  SOURCE-COMPUTER.        IBM-3090.                                01630000
00030  OBJECT-COMPUTER.        IBM-3090.                                01640000
00032  INPUT-OUTPUT SECTION.                                            01650000
00033  FILE-CONTROL.                                                    01660000
                                                                        01670000
00034      SELECT  PHYSICAL-INVENTORY-FILE                              01680000
00035          ASSIGN TO INP01.                                         01690000
00036      SELECT  EDITED-INVENTORY-FILE                                01700000
00037          ASSIGN TO OUT01.                                         01710000
00038      SELECT  INVALID-DETAIL-FILE                                  01720000
00039          ASSIGN TO OUT02.                                         01730000
00040      SELECT  VALID-INV-REPORT-FILE                                01740000
00041          ASSIGN TO OUT03.                                         01750000
00040      SELECT  MISSING-TABLE-ENTRY-FILE                             01760000
00041          ASSIGN TO OUT04.                                         01770000
00042                                                                   01780000
00043  DATA DIVISION.                                                   01790000
00044  FILE SECTION.                                                    01800000
                                                                        01810000
00045  FD  PHYSICAL-INVENTORY-FILE                                      01820000
00046      LABEL RECORDS ARE STANDARD                                   01830000
00047      RECORDING MODE IS F                                          01840000
00048      BLOCK CONTAINS 0 RECORDS.                                    01850000
W21732 01  PHYSICAL-INVENTORY-RECORD  PIC X(100).                       01860000
00050                                                                   01870000
00051  FD  EDITED-INVENTORY-FILE                                        01880000
00052      LABEL RECORDS ARE STANDARD                                   01890000
00053      RECORDING MODE IS F                                          01900000
00054      BLOCK CONTAINS 0 RECORDS.                                    01910000
SR3403 01  EDITED-INVENTORY-RECORD    PIC X(100).                       01921003
00056                                                                   01930000
00057  FD  INVALID-DETAIL-FILE                                          01940000
00058      LABEL RECORDS ARE STANDARD                                   01950000
00059      RECORDING MODE IS F                                          01960000
00060      BLOCK CONTAINS 0 RECORDS.                                    01970000
00061  01  INVALID-DETAIL-RECORD      PIC X(88).                        01980000
00062                                                                   01990000
00063  FD  VALID-INV-REPORT-FILE                                        02000000
00064      LABEL RECORDS ARE STANDARD                                   02010000
00065      RECORDING MODE IS F                                          02020000
00066      BLOCK CONTAINS 0 RECORDS.                                    02030000
W21732 01  VALID-INV-REPORT-RECORD    PIC X(100).                       02040000
IN2001                                                                  02050000
IN2001 FD  MISSING-TABLE-ENTRY-FILE                                     02060000
IN2001     LABEL RECORDS ARE STANDARD                                   02070000
IN2001     RECORDING MODE IS F                                          02080000
IN2001     BLOCK CONTAINS 0 RECORDS.                                    02090000
IN2001 01  MISSING-TABLE-ENTRY-RECORD PIC X(70).                        02100000
00068                                                                   02110000
00069  WORKING-STORAGE SECTION.                                         02120000
00070 *                                                                 02130000
00071  01  DK-DATABASE-KEYS.                                            02140000
W26600     05  DK-STORE                PIC X(04)    VALUE SPACES.       02150000
00077      05  DK-UPC-CODE             PIC S9(15)V  COMP-3 VALUE 0.     02160000
00079 *                                                                 02170000
00080  01  PC-PROGRAM-CONSTANTS.                                        02180000
00081      05  PC-999                  PIC 9(03)    VALUE 999.          02190000
00082      05  PC-LINE-MAX             PIC 9(02)    VALUE 25.           02200000
00083      05  PC-RENUMBERED-SKU-STAT98 PIC  X(02)  VALUE '98'.         02210000
00085      05  PC-CLEARANCE-STATUS-30  PIC  X(02)   VALUE '30'.         02220000
IN2001     05  PC-RCP-STATUS           PIC  X(02)   VALUE '25'.         02230000
00087      05  PC-SUB-CL-CDE           PIC X(03)    VALUE '000'.        02240000
00088      05  PC-APLSYS-CDE           PIC X(02)    VALUE 'IN'.         02250000
00089      05  PC-OPERCO-NBR           PIC X(02)    VALUE '03'.         02260000
00090      05  PC-MDSELV-CDE           PIC X(03)    VALUE 'SCL'.        02270000
00091      05  PC-MAX-RETRIES          PIC S9(03)   VALUE +03           02280000
00092                                               COMP-3.             02290000
00093 *    05  PC-STORE-000            PIC X(03)    VALUE '000'.        02300000
00094 *                                                                 02310000
00095 *                                                                 02320000
00096  01  PV-PROGRAM-VARIABLES.                                        02330000
W21732     05  PV-CONVERT-SKU             PIC 9(08) VALUE ZERO.         02340000
W21732     05  PV-SKU                     PIC 9(08) VALUE ZERO.         02350000
00101      05  PV-HOLD-MAJ-CL-DESC        PIC X(25) VALUE SPACES.       02360000
00102      05  PV-HOLD-BYR-NBR            PIC X(03) VALUE SPACES.       02370000
00103      05  PV-HOLD-GMA-NBR            PIC X(02) VALUE SPACES.       02380000
00104      05  PV-HOLD-DMA-NBR            PIC X(02) VALUE SPACES.       02390000
00105      05  PV-HOLD-SKU.                                             02400000
W21732         10  PV-HOLD-DEPT           PIC 9(04) VALUE ZERO.         02410000
W21732         10  PV-HOLD-MAJ-CLASS      PIC 9(04) VALUE ZERO.         02420000
W21732         10  PV-HOLD-SUB-CLASS      PIC 9(04) VALUE ZERO.         02430000
W21732         10  PV-HOLD-SEQ            PIC 9(08) VALUE ZERO.         02440000
25248          10  PV-HOLD-UPC-CODE       PIC 9(13) VALUE ZERO.         02450000
00114      05  PV-SQL-SUB              PIC 9(03)  VALUE ZERO.           02460000
00115      05  PV-MAJ-CL-NBR.                                           02470000
00116          10 PV-MAJ-CL-NBR-1      PIC X        VALUE SPACES.       02480000
00117          10 PV-MAJ-CL-NBR-2      PIC X        VALUE SPACES.       02490000
W21732     05  PV-MAJ-CL-NBR-9 REDEFINES PV-MAJ-CL-NBR PIC 9(2).        02500000
00118      05  PV-SUB-CL-NBR.                                           02510000
00119          10 PV-SUB-CL-NBR-1      PIC X        VALUE SPACES.       02520000
00120          10 PV-SUB-CL-NBR-2-3    PIC X(02)    VALUE SPACES.       02530000
00121      05  PV-UPC-CODE             PIC S9(15)V                      02540000
00122                                  COMP-3       VALUE +0.           02550000
W21732     05  PV-RENUMBERED-SKU.                                       02560000
W21732       10  PV-RENUMBERED-DEPT      PIC X(04)    VALUE SPACES.     02570000
W21732       10  PV-RENUMBERED-MAJ-CLASS PIC X(04)    VALUE SPACES.     02580000
W21732       10  PV-RENUMBERED-SUB-CLASS PIC X(04)    VALUE SPACES.     02590000
W21732       10  PV-RENUMBERED-SEQ       PIC X(08)    VALUE SPACES.     02600000
SR3403     05  PV-LOOKUP-PRICE           PIC 9(05)V99 VALUE ZERO.       02611003
00125      05  PV-PARAGRAPH-NAME         PIC X(30)    VALUE SPACES.     02620000
00126      05  PV-DB2-OPER-ATTEMPTED     PIC X(30)    VALUE SPACES.     02630000
00127      05  PV-RETRY-COUNT            PIC S9(03)   VALUE ZERO        02640000
00128                                                 COMP-3.           02650000
00135      05  PV-ITEM-NBR             PIC S9(15)V  VALUE ZERO          02660000
00136                                               COMP-3.             02670000
00137      05  PV-WORK-UPC              PIC 9(13).                      02680000
00138      05  PV-WORK-UPC-X  REDEFINES  PV-WORK-UPC.                   02690000
00139          10  FILLER               PIC X(4).                       02700000
00140              88  PV-KOHLS-UPC                 VALUE '0400'.       02710000
W21732         10  PV-UPC-SKU.                                          02720000
W21732           15  PV-UPC-SKU-DEPT-CL PIC X(5).                       02730000
W21732           15  PV-UPC-SKU-SEQ     PIC X(3).                       02740000
00144          10  PV-UPC-CHK-DIG       PIC 9.                          02750000
W21732     05  PV-TEMP-UPC-MIN.                                         02760000
W21732         10  PV-TEMP-UPC-DIGIT-MIN       PIC 9(12) VALUE ZERO.    02770000
W21732         10  PV-TEMP-UPC-CHECK-DIGIT-MIN PIC 9(01) VALUE ZERO.    02780000
W21732     05  PV-TEMP-UPC-MAX.                                         02790000
W21732         10  PV-TEMP-UPC-DIGIT-MAX       PIC 9(12) VALUE ZERO.    02800000
W21732         10  PV-TEMP-UPC-CHECK-DIGIT-MAX PIC 9(01) VALUE ZERO.    02810000
00109      05  PV-TEMP-DATE               PIC 9(08) VALUE ZERO.         02820000
00110      05  PV-TEMP-DATE-CCYYMMDD REDEFINES PV-TEMP-DATE.            02830000
00111          10  PV-CC                  PIC 9(02).                    02840000
00111          10  PV-YY                  PIC 9(02).                    02850000
00112          10  PV-MM                  PIC 9(02).                    02860000
00113          10  PV-DD                  PIC 9(02).                    02870000
           05 PV-UNT-RTL-AMT              PIC S9(7)V9(2) COMP-3.        02880000
           05 PV-GROUP-UNIT-RTL           PIC S9(7)V9(2) COMP-3.        02890000
           05  PV-TMST.                                                 02900000
               10  PV-PLND-INV-DTE        PIC  X(10) VALUE SPACES.      02910000
               10  FILLER                 PIC  X(16) VALUE              02920000
                                                 '-23.59.59.999999'.    02930000
                                                                        02940000
           05  PV-PLND-INV-TMST           PIC  X(26) VALUE SPACES.      02950000
W26600     05  PV-STR-NBR                 PIC X(04).                    02960000
W03072     05  PV-STORE-NBR               PIC S9(04) COMP.              02970000
                                                                        02980000
IN2001     05  PV-STR000-ROW.                                           02990000
IN2001         10  PV-STR000-UPC-STAT-CDE  PIC X(02)    VALUE SPACES.   03000000
IN2001         10  PV-STR000-UNT-RTL-AMT   PIC S9(7)V99 VALUE +0 COMP-3.03010000
IN2001         10  PV-STR000-MEITGP-NBR    PIC S9(9)    VALUE +0 COMP-3.03020000
IN2001         10  PV-STR000-UPC-STAT-CHG-DTE  PIC X(10) VALUE SPACES.  03030000
IN2001         10  PV-STR000-UNT-RTL-CHG-DTE   PIC X(10) VALUE SPACES.  03040000
000000*                                                                 03050000
W21732     05  PV-KOHLS-UPC-LOW.                                        03060000
W21732         10  FILLER              PIC 9(04)    VALUE 0400.         03070000
W21732         10  PV-KOHLS-SKU-MIN    PIC 9(08)    VALUE ZEROS.        03080000
W21732         10  FILLER              PIC 9(01)    VALUE 0.            03090000
W21732     05  PV-KOHLS-UPC-HIGH.                                       03100000
W21732         10  FILLER              PIC 9(04)    VALUE 0400.         03110000
W21732         10  PV-KOHLS-SKU-MAX    PIC 9(08)    VALUE ZEROS.        03120000
W21732         10  FILLER              PIC 9(01)    VALUE 9.            03130000
W21732     05  PV-KOHLS-SIGN-UPC.                                       03140000
W21732         10  PV-KOHLS-UPC-MIN-SIGNONLY                            03150000
W21732                                 PIC S9(13).                      03160000
W21732         10  PV-KOHLS-UPC-MAX-SIGNONLY                            03170000
W21732                                 PIC S9(13).                      03180000
W21732     05  PV-KOHLS-MDSEAR-UPC.                                     03190000
W21732         10  PV-KOHLS-UPC-MIN    PIC S9(13)V  COMP-3.             03200000
W21732         10  PV-KOHLS-UPC-MAX    PIC S9(13)V  COMP-3.             03210000
P28545     05  PV-EDIT-UPC-CODE     PIC 9(15).                          03220000
P28545     05  PV-EDIT-UPC-CODE-ALPH REDEFINES                          03230000
P28545         PV-EDIT-UPC-CODE     PIC X(15).                          03240000
                                                                        03250000
W21732 01  PV-UPC-ERROR-FILE-RECORD.                                    03260000
S21732     05  PV-UPC-ERROR-STORE-TEXT PIC X(07)  VALUE 'STORE: '.      03270000
W26600     05  PV-UPC-ERROR-STORE      PIC X(04).                       03280000
S21732     05  FILLER                  PIC X(03)  VALUE SPACES.         03290000
S21732     05  PV-UPC-ERROR-AREA-TEXT  PIC X(06)  VALUE 'AREA: '.       03300000
S21732     05  PV-UPC-ERROR-AREA       PIC X(06).                       03310000
W21732     05  FILLER                  PIC X(03)  VALUE SPACES.         03320000
S21732     05  PV-UPC-ERROR-SKU-TEXT   PIC X(05)  VALUE 'SKU: '.        03330000
W21732     05  PV-UPC-ERROR-SKU        PIC X(08).                       03340000
S21732     05  FILLER                  PIC X(03)  VALUE SPACES.         03350000
S21732     05  PV-UPC-ERROR-UPC-TEXT   PIC X(05)  VALUE 'UPC: '.        03360000
S21732     05  PV-UPC-ERROR-UPC        PIC X(15).                       03370000
W21732     05  FILLER                  PIC X(05)  VALUE SPACES.         03380000
00145 *                                                                 03390000
00146  01  SA-SAVE-AREAS.                                               03400000
W26600     05  SA-STORE-NUMBER         PIC X(04)    VALUE SPACES.       03410000
00148      05  SA-SKU                  PIC 9(08)    VALUE ZERO.         03420000
00149 *    05  SA-LOOKUP-STORE         PIC X(03)    VALUE SPACES.       03430000
00150      05  SA-LOOKUP-SKU           PIC 9(08)    VALUE ZERO.         03440000
W21732     05  SA-DEPT-CL              PIC 9(12)    VALUE ZERO.         03450000
00152      05  SA-UPC                  PIC 9(12)    VALUE 999999999999. 03460000
00153 *                                                                 03470000
00154  01  PS-PROGRAM-SWITCHES.                                         03480000
00155      05  PS-END-OF-INVENTORY     PIC X        VALUE 'N'.          03490000
00156          88  PS-EOF-INVENTORY                 VALUE 'Y'.          03500000
00157      05  PS-INVALID-RECORD-SW    PIC X        VALUE 'Y'.          03510000
00158          88  PS-VALID-RECORD                  VALUE 'N'.          03520000
00159          88  PS-INVALID-RECORD                VALUE 'Y'.          03530000
00160      05  PS-INVALID-ITEM-SW      PIC X        VALUE 'Y'.          03540000
00161          88  PS-VALID-ITEM                    VALUE 'N'.          03550000
00162          88  PS-INVALID-ITEM                  VALUE 'Y'.          03560000
00163      05  PS-VALID-UPC-SW         PIC X        VALUE 'N'.          03570000
00164          88  PS-VALID-UPC                     VALUE 'Y'.          03580000
00165          88  PS-INVALID-UPC                   VALUE 'N'.          03590000
00166      05  PS-UPC-FOUND-SW         PIC X        VALUE 'N'.          03600000
00167          88  PS-UPC-FOUND                     VALUE 'Y'.          03610000
00168          88  PS-UPC-NOT-FOUND                 VALUE 'N'.          03620000
00169      05  PS-PRICE-FOUND-SW       PIC X        VALUE 'N'.          03630000
00170          88  PS-PRICE-FOUND                   VALUE 'Y'.          03640000
00171          88  PS-PRICE-NOT-FOUND               VALUE 'N'.          03650000
00172      05  PS-ITEM-FOUND-SW        PIC X        VALUE 'N'.          03660000
00173          88  PS-ITEM-FOUND                    VALUE 'Y'.          03670000
00174          88  PS-ITEM-NOT-FOUND                VALUE 'N'.          03680000
00175      05  PS-VALID-SKU-SW         PIC X        VALUE 'N'.          03690000
00176          88  PS-VALID-SKU                     VALUE 'Y'.          03700000
00177          88  PS-INVALID-SKU                   VALUE 'N'.          03710000
00178      05  PS-VALID-DEPT-CLASS-SW  PIC X        VALUE 'N'.          03720000
00179          88  PS-VALID-DEPT-CLASS              VALUE 'Y'.          03730000
00180          88  PS-INVALID-DEPT-CLASS            VALUE 'N'.          03740000
00181      05  PS-VALID-RENUMBER-SW    PIC X        VALUE 'N'.          03750000
00182          88  PS-VALID-RENUMBER                VALUE 'Y'.          03760000
00183          88  PS-INVALID-RENUMBER              VALUE 'N'.          03770000
00184      05  PS-SAME-SKU-STORE-SW    PIC X        VALUE 'N'.          03780000
00185          88  PS-SAME-SKU-STORE                VALUE 'Y'.          03790000
00186          88  PS-NOT-SAME-SKU-STORE            VALUE 'N'.          03800000
JS0300*    05  PS-HOLD-REGN-PRIC-ITM-SW  PIC X(01) VALUE SPACES.        03810000
      *        88 PS-HOLD-REGN-PRIC-ITM             VALUE 'Y'.          03820000
      *        88 PS-HOLD-NOT-REGN-PRIC-ITM         VALUE 'N'.          03830000
IN2001     05  PS-EMAIL-MESSAGE-UPCPLS-SW   PIC X   VALUE 'N'.          03840000
IN2001         88 PS-EMAIL-MESSAGE-UPCPLS           VALUE 'Y'.          03850000
IN2001         88 PS-EMAIL-NO-MESSAGE               VALUE 'N'.          03860000
IN2001*                                                                 03870000
IN2001 01  H1-HEADING.                                                  03880000
IN2001     05  FILLER              PIC X(07)   VALUE 'STORE: '.         03890000
W26600     05  H1-STORE            PIC X(04)   VALUE SPACES.            03900000
IN2001     05  FILLER              PIC X(06)   VALUE SPACES.            03910000
IN2001     05  FILLER              PIC X(17)   VALUE 'INVENTORY DATE :'.03920000
IN2001     05  FILLER              PIC X(01)   VALUE SPACES.            03930000
IN2001     05  H1-INV-DTE          PIC X(10)   VALUE SPACES.            03940000
IN2001     05  FILLER              PIC X(26)   VALUE SPACES.            03950000
IN2001*                                                                 03960000
IN2001 01  H2-HEADING.                                                  03970000
IN2001     05  FILLER              PIC X(13)   VALUE '         SCAN'.   03980000
IN2001     05  FILLER              PIC X(57)   VALUE SPACES.            03990000
IN2001*                                                                 04000000
IN2001 01  H3-HEADING.                                                  04010000
IN2001     05  H3-AREA             PIC X(08)   VALUE ' AREA   '.        04020000
IN2001     05  H3-LINE             PIC X(11)   VALUE ' LINE      '.     04030000
IN2001     05  H3-UPC              PIC X(13)   VALUE '   UPC       '.   04040000
IN2001     05  H3-SKU              PIC X(12)   VALUE '     SKU    '.    04050000
IN2001     05  H3-ITEM-NBR         PIC X(15)   VALUE '   ITEM NUMBER '. 04060000
IN2001     05  FILLER              PIC X(12)   VALUE SPACES.            04070000
IN2001*                                                                 04080000
IN2001 01  H4-HEADING.                                                  04090000
IN2001     05  H4-AREA             PIC X(06)   VALUE '------'.          04100000
IN2001     05  FILLER              PIC X(02)   VALUE SPACES.            04110000
IN2001     05  H4-LINE             PIC X(06)   VALUE '------'.          04120000
IN2001     05  FILLER              PIC X(03)   VALUE SPACES.            04130000
IN2001     05  H4-UPC              PIC X(15)   VALUE '---------------'. 04140000
IN2001     05  FILLER              PIC X(02)   VALUE SPACES.            04150000
IN2001     05  H4-SKU              PIC X(10)   VALUE '----------'.      04160000
IN2001     05  FILLER              PIC X(03)   VALUE SPACES.            04170000
IN2001     05  H4-ITEM-NBR         PIC X(15)   VALUE '---------------'. 04180000
IN2001     05  FILLER              PIC X(02)   VALUE SPACES.            04190000
IN2001     05  FILLER              PIC X(04)   VALUE SPACES.            04200000
IN2001*                                                                 04210000
IN2001 01  D1-DETAIL-LINE.                                              04220000
W26600     05  D1-STORE            PIC X(04)   VALUE SPACES.            04230000
IN2001     05  FILLER              PIC X(01)   VALUE SPACES.            04240000
IN2001     05  D1-AREA-NBR         PIC X(06)   VALUE SPACES.            04250000
IN2001     05  FILLER              PIC X(02)   VALUE SPACES.            04260000
IN2001     05  D1-LINE-NBR         PIC X(06)   VALUE SPACES.            04270000
IN2001     05  FILLER              PIC X(03)   VALUE SPACES.            04280000
IN2001     05  D1-UPC              PIC X(15)   VALUE SPACES.            04290000
IN2001     05  FILLER              PIC X(02)   VALUE SPACES.            04300000
W21732     05  D1-SKU              PIC X(08)   VALUE SPACES.            04310000
W21732     05  FILLER              PIC X(05)   VALUE SPACES.            04320000
W21732     05  D1-ITEM-NBR         PIC 9(15)   VALUE ZEROS.             04330000
IN2001     05  FILLER              PIC X(02)   VALUE SPACES.            04340000
00188 *                                                                 04350000
00189      COPY INWS010.                                                04360000
00193 *                                                                 04370000
25248      COPY INWS009.                                                04380000
00196 *                                                                 04390000
00199      COPY INWS008.                                                04400000
W26600*01  PV-SPECIAL-IN008-LAYOUT        REDEFINES                     04410000
W26600*    IN008-INVENTORY-COUNT-RECORD.                                04420000
W26600*    05  PV-OUTPUT-RECORD.                                        04430000
W26600*        10  FILLER                 PIC X(86).                    04440000
W26600*        10  PV-OUTPUT-INVALID-REC  PIC X(01).                    04450000
W26600*        10  PV-OUTPUT-INVALID-ITEM PIC X(01).                    04460000
00206 *                                                                 04470000
25248      COPY INWS014.                                                04480000
00209 *                                                                 04490000
00210 *****  WORKING STORAGE COPYBOOK FOR UPC CHECK DIGIT ROUTINE       04500000
00212      COPY DPWS040I.                                               04510000
00214 *                                                                 04520000
W21732     COPY ISWS006.                                                04530000
00215 *****  SQL ABEND ROUTINE WORKING STORAGE                          04540000
00217      COPY DPWS004.                                                04550000
00218      EJECT                                                        04560000
00219 *                                                                 04570000
P28545*****  DB2 UPC SKU TABLE DCLGEN                                   04580000
P28545*    EXEC SQL                                                     04590000
P28545*        INCLUDE TUPCSKU                                          04600000
P28545*    END-EXEC.                                                    04610000
P28545*                                                                 04620000
P28545*****  DB2 MERCHANDISE AREA TABLE DCLGEN                          04630000
P28545*    EXEC SQL                                                     04640000
P28545*        INCLUDE TMDSEAR                                          04650000
P28545*    END-EXEC.                                                    04660000
P28545*                                                                 04670000
P28545*****  DB2 APPLICATION AVAILABILITY TABLE DCLGEN                  04680000
P28545*    EXEC SQL                                                     04690000
P28545*        INCLUDE TAPLAVL                                          04700000
P28545*    END-EXEC.                                                    04710000
P28545*                                                                 04720000
P28545*****  TUPCPLS                                                    04730000
P28545*    EXEC SQL                                                     04740000
P28545*        INCLUDE TUPCPLS                                          04750000
P28545*    END-EXEC.                                                    04760000
P28545*                                                                 04770000
P28545*****  TMITGPL                                                    04780000
P28545*    EXEC SQL                                                     04790000
P28545*        INCLUDE TMITGPL                                          04800000
P28545*    END-EXEC.                                                    04810000
P28545*                                                                 04820000
P28545*****  TINCNTL                                                    04830000
P28545     EXEC SQL                                                     04840000
P28545         INCLUDE TINCNTL                                          04850000
P28545     END-EXEC.                                                    04860000
P28545                                                                  04870000
      *****  TINVPAR                                                    04880000
           EXEC SQL                                                     04890000
               INCLUDE TINVPAR                                          04900000
           END-EXEC.                                                    04910000
                                                                        04920000
P28545*    EXEC SQL                                                     04930000
P28545*        INCLUDE TSKXREF                                          04940000
P28545*    END-EXEC.                                                    04950000
P28545*                                                                 04960000
P28545*    EXEC SQL                                                     04970000
P28545*        INCLUDE TUPC                                             04980000
P28545*    END-EXEC.                                                    04990000
W21732                                                                  05000000
00252      EXEC SQL                                                     05010000
00253          INCLUDE SQLCA                                            05020000
00254      END-EXEC.                                                    05030000
00255      EJECT                                                        05040000
00256                                                                   05050000
00257      COPY SQLCA2.                                                 05060000
00258                                                                   05070000
00259  01  ABEND-CODE               PIC S9(04)  VALUE ZERO              05080000
00260                                           COMP SYNC.              05090000
                                                                        05100000
P28545******************************************************************05110000
P28545* COPYBOOK - PRICING MODULE                                       05120000
P28545******************************************************************05130000
P28545     COPY INWS400.                                                05140000
P28545                                                                  05150000
00262  LINKAGE SECTION.                                                 05160000
00264  PROCEDURE DIVISION.                                              05170000
00266 ******************************************************************05180000
00268 ******************************************************************05190000
00269  A100-MAIN-MODULE.                                                05200000
00270                                                                   05210000
00271      PERFORM B100-OPEN-FILES.                                     05220000
00272                                                                   05230000
00273      PERFORM Z100-READ-INVENTORY-FILE.                            05240000
00274                                                                   05250000
00275      PERFORM B300-EDIT-INVENTORY UNTIL                            05260000
00276          PS-EOF-INVENTORY.                                        05270000
00277                                                                   05280000
00278      PERFORM B400-CLOSE-FILES.                                    05290000
00279                                                                   05300000
00280      STOP RUN.                                                    05310000
00281                                                                   05320000
00282 ******************************************************************05330000
00283 *                                                                 05340000
00284 ******************************************************************05350000
00285  B100-OPEN-FILES.                                                 05360000
00286 *                                                                 05370000
00287      OPEN INPUT  PHYSICAL-INVENTORY-FILE                          05380000
00288           OUTPUT INVALID-DETAIL-FILE                              05390000
00289                  VALID-INV-REPORT-FILE                            05400000
00290                  EDITED-INVENTORY-FILE                            05410000
IN2001                 MISSING-TABLE-ENTRY-FILE.                        05420000
00291 *                                                                 05430000
00292 ******************************************************************05440000
00293 *                                                                 05450000
00294 ******************************************************************05460000
00295  B300-EDIT-INVENTORY.                                             05470000
00296                                                                   05480000
00297      SET PS-VALID-ITEM                                            05490000
00299          PS-VALID-RECORD  TO TRUE.                                05500000
                                                                        05510000
P28545*    MOVE SPACES TO TUPCSKU-PLU-DWNLD-IND.                        05520000
00300                                                                   05530000
00301      INITIALIZE IN009-EDITED-INVENTORY-RECORD.                    05540000
JS0598     MOVE ZEROES             TO IN009-QUANTITY-COMP.              05550000
00302      MOVE IN010-STORE-NUMBER TO IN009-STORE-NUMBER                05560000
                                      PV-STORE-NBR.                     05570000
00303      MOVE IN010-AREA-NUMBER       TO IN009-AREA-NUMBER.           05580000
00304      MOVE IN010-LINE-NUMBER       TO IN009-LINE-NUMBER.           05590000
00305      MOVE IN010-SCAN-LINE-NUMBER  TO IN009-SCAN-LINE-NUMBER.      05600000
00305      MOVE IN010-SCAN-DTE          TO IN009-SCAN-DTE.              05610000
00305      MOVE IN010-SCAN-TIMESTAMP    TO IN009-SCAN-TIMESTAMP.        05620000
00306                                                                   05630000
           IF IN010-STORE-NUMBER = PV-STR-NBR                           05640000
               NEXT SENTENCE                                            05650000
           ELSE                                                         05660000
W26600         MOVE IN010-STORE-NUMBER TO PV-STR-NBR                    05670000
               PERFORM Z875-SELECT-TINVPAR                              05680000
           END-IF.                                                      05690000
00306                                                                   05700000
00307      IF IN010-UPC-CODE = ZERO                                     05710000
00308          IF IN010-SKU = ZERO                                      05720000
00309              CONTINUE                                             05730000
00310          ELSE                                                     05740000
00311              INITIALIZE PV-WORK-UPC                               05750000
00312              IF (SA-SKU = IN010-SKU)                              05760000
IN2001                 IF ( PS-INVALID-SKU OR                           05770000
IN2001                      PS-PRICE-NOT-FOUND )                        05780000
40314                      SET PS-INVALID-ITEM                          05790000
00315                          PS-INVALID-RECORD   TO TRUE              05800000
00316                  ELSE                                             05810000
00317                      IF IN010-STORE-NUMBER = SA-STORE-NUMBER      05820000
00318                        SET PS-SAME-SKU-STORE TO TRUE              05830000
Z28545                                                                  05840000
Z28545                       MOVE IN010-SKU   TO IN009-SKU              05850000
Z28545                       MOVE IN010-DEPT  TO IN009-DEPT             05860000
Z28545                       MOVE IN400-ATT-MCL-OUT                     05870000
Z28545                                        TO IN009-MAJ-CLASS        05880000
Z28545                       MOVE IN010-CLASS TO IN009-SUB-CLASS        05890000
Z28545                       MOVE ZEROS       TO IN009-UPC-CODE         05900000
Z28545                                                                  05910000
IN0501                     ELSE                                         05920000
IN0501*                 *********************************************** 05930000
IN0501*                 LOGIC VALIDATES SKUS AND RETRIEVES TSK.ITEM_NBR.05940000
IN0501*                 USE ITEM TO GET STATUS/PRICING FROM UPCPLS      05950000
IN0501*                 *********************************************** 05960000
P28545                       INITIALIZE IN400-PV-INPUT-AREA             05970000
P28545                       SET IN400-PV-SKU-LOOKUP TO TRUE            05980000
P28545                       MOVE IN010-STORE-NUMBER                    05990000
P28545                                            TO IN400-CONVERT-LOC  06000000
P28545                       MOVE IN400-CONVERT-LOC                     06010000
P28545                                            TO IN400-PV-LOC-IN    06020000
P28545                       MOVE PV-PLND-INV-DTE                       06030000
P28545                                            TO IN400-PV-EFF-DTE-IN06040000
P28545                       MOVE IN010-SKU       TO IN400-PV-SKU-IN    06050000
P28545                                                                  06060000
P28545                       PERFORM IN400-LOOKUP-RETAIL                06070000
P28545                                                                  06080000
P28545                       IF IN400-PV-INVALID-KEY-INPUT              06090000
P28545                         IF IN400-PS-DUMMY-SKU                    06100000
P28545                           SET PS-INVALID-SKU                     06110000
P28545                               PS-INVALID-ITEM                    06120000
P28545                               PS-INVALID-RECORD TO TRUE          06130000
P28545                         ELSE                                     06140000
P28545                           SET PS-INVALID-ITEM                    06150000
P28545                               PS-INVALID-RECORD TO TRUE          06160000
P28545                         END-IF                                   06170000
D28545                         DISPLAY 'INVALID - ', IN010-SKU,         06180000
D28545                             ' LOC - ', IN010-STORE-NUMBER,       06190000
D28545                             ' PRC RTN - ', IN400-PV-RETURN-CDE,  06200000
D28545                             ' ATT RTN - ', IN400-PV-ATT-RTNCDE,  06210000
D28545                             ' PRC SQL - ', IN400-PV-PRC-SQLCDE,  06220000
D28545                             ' ATT SQL - ', IN400-PV-ATT-SQLCDE,  06230000
D28545                         DISPLAY IN400-PV-RETURN-RSN              06240000
D28545                         DISPLAY IN400-PV-PARAGRAPH               06250000
P28545                       ELSE                                       06260000
P28545                       IF IN400-PS-RTL-FOUND OR                   06270000
P28545                          IN400-PS-ATTR-FOUND                     06280000
P28545                         SET PS-PRICE-FOUND      TO TRUE          06290000
P28545                         IF IN400-ATT-PLU-DWNLD-IND EQUAL 'N'     06300000
P28545                           SET PS-PRICE-NOT-FOUND                 06310000
P28545                               PS-INVALID-ITEM                    06320000
P28545                               PS-INVALID-RECORD TO TRUE          06330000
P28545                         ELSE                                     06340000
P28545                         SET PS-VALID-SKU TO TRUE                 06350000
P28545                         IF IN400-PS-DUMMY-SKU                    06360000
P28545                           MOVE IN010-SKU   TO IN009-SKU          06370000
P28545                           MOVE IN010-DEPT  TO IN009-DEPT         06380000
P28545                           MOVE IN400-ATT-MCL-OUT                 06390000
P28545                                            TO IN009-MAJ-CLASS    06400000
P28545                           MOVE IN010-CLASS TO IN009-SUB-CLASS    06410000
P28545                           MOVE ZEROS       TO IN009-UPC-CODE     06420000
P28545                         ELSE                                     06430000
P28545                         IF IN400-PS-RENUMBER-SKU                 06440000
P28545                           MOVE IN400-ATT-SKU-OUT TO IN009-SKU    06450000
P28545                           MOVE IN400-ATT-DEPT-OUT TO IN009-DEPT  06460000
P28545                           MOVE IN400-ATT-MCL-OUT                 06470000
P28545                                            TO IN009-MAJ-CLASS    06480000
P28545                           MOVE IN400-ATT-SCL-OUT                 06490000
P28545                                            TO IN009-SUB-CLASS    06500000
P28545                           MOVE ZEROS       TO IN009-UPC-CODE     06510000
P28545                         ELSE                                     06520000
P28545                           MOVE IN010-SKU   TO IN009-SKU          06530000
P28545                           MOVE IN010-DEPT  TO IN009-DEPT         06540000
P28545                           MOVE IN400-ATT-MCL-OUT                 06550000
P28545                                            TO IN009-MAJ-CLASS    06560000
P28545                           MOVE IN010-CLASS TO IN009-SUB-CLASS    06570000
P28545                           MOVE ZEROS       TO IN009-UPC-CODE     06580000
P28545                         END-IF                                   06590000
P28545                       ELSE                                       06600000
P28545                         SET PS-INVALID-ITEM                      06610000
P28545                             PS-INVALID-RECORD   TO TRUE          06620000
P28545                       END-IF                                     06630000
P28545                       MOVE IN010-SKU TO SA-SKU                   06640000
P28545                     END-IF                                       06650000
00321                  END-IF                                           06660000
00322              ELSE                                                 06670000
IN2001*                ***********************************************  06680000
IN2001*                LOGIC VALIDATES SKUS AND RETRIEVES TSK.ITEM_NBR. 06690000
IN2001*                USE ITEM TO GET STATUS/PRICING FROM UPCPLS       06700000
IN2001*                ***********************************************  06710000
P28545                 INITIALIZE IN400-PV-INPUT-AREA                   06720000
P28545                 SET IN400-PV-SKU-LOOKUP TO TRUE                  06730000
P28545                 MOVE IN010-STORE-NUMBER TO IN400-CONVERT-LOC     06740000
P28545                 MOVE IN400-CONVERT-LOC  TO IN400-PV-LOC-IN       06750000
P28545                 MOVE PV-PLND-INV-DTE    TO IN400-PV-EFF-DTE-IN   06760000
P28545                 MOVE IN010-SKU          TO IN400-PV-SKU-IN       06770000
P28545                                                                  06780000
P28545                 PERFORM IN400-LOOKUP-RETAIL                      06790000
P28545                                                                  06800000
P28545                 IF IN400-PV-INVALID-KEY-INPUT                    06810000
P28545                   IF IN400-PS-DUMMY-SKU                          06820000
P28545                     SET PS-INVALID-SKU                           06830000
P28545                         PS-INVALID-ITEM                          06840000
P28545                         PS-INVALID-RECORD TO TRUE                06850000
P28545                   ELSE                                           06860000
P28545                     SET PS-INVALID-ITEM                          06870000
P28545                         PS-INVALID-RECORD TO TRUE                06880000
P28545                   END-IF                                         06890000
D28545                   DISPLAY 'INVALID - ', IN010-SKU,               06900000
D28545                           ' LOC - ', IN010-STORE-NUMBER,         06910000
D28545                           ' PRC RTN - ', IN400-PV-RETURN-CDE,    06920000
D28545                           ' ATT RTN - ', IN400-PV-ATT-RTNCDE,    06930000
D28545                           ' PRC SQL - ', IN400-PV-PRC-SQLCDE,    06940000
D28545                           ' ATT SQL - ', IN400-PV-ATT-SQLCDE,    06950000
D28545                   DISPLAY IN400-PV-RETURN-RSN                    06960000
D28545                   DISPLAY IN400-PV-PARAGRAPH                     06970000
P28545                 ELSE                                             06980000
P28545                     IF IN400-PS-RTL-FOUND OR                     06990000
P28545                        IN400-PS-ATTR-FOUND                       07000000
P28545                       SET PS-PRICE-FOUND      TO TRUE            07010000
P28545                       IF IN400-ATT-PLU-DWNLD-IND EQUAL 'N'       07020000
P28545                         SET PS-PRICE-NOT-FOUND                   07030000
P28545                             PS-INVALID-ITEM                      07040000
P28545                             PS-INVALID-RECORD TO TRUE            07050000
P28545                       ELSE                                       07060000
P28545                       SET PS-VALID-SKU TO TRUE                   07070000
P28545                       IF IN400-PS-DUMMY-SKU                      07080000
P28545                           MOVE IN010-SKU   TO IN009-SKU          07090000
P28545                           MOVE IN010-DEPT  TO IN009-DEPT         07100000
P28545                           MOVE IN400-ATT-MCL-OUT                 07110000
P28545                                            TO IN009-MAJ-CLASS    07120000
P28545                           MOVE IN010-CLASS TO IN009-SUB-CLASS    07130000
P28545                           MOVE ZEROS       TO IN009-UPC-CODE     07140000
P28545                       ELSE                                       07150000
P28545                       IF IN400-PS-RENUMBER-SKU                   07160000
P28545                           MOVE IN400-ATT-SKU-OUT TO IN009-SKU    07170000
P28545                           MOVE IN400-ATT-DEPT-OUT TO IN009-DEPT  07180000
P28545                           MOVE IN400-ATT-MCL-OUT                 07190000
P28545                                            TO IN009-MAJ-CLASS    07200000
P28545                           MOVE IN400-ATT-SCL-OUT                 07210000
P28545                                            TO IN009-SUB-CLASS    07220000
P28545                           MOVE ZEROS       TO IN009-UPC-CODE     07230000
P28545                       ELSE                                       07240000
P28545                           MOVE IN010-SKU   TO IN009-SKU          07250000
P28545                           MOVE IN010-DEPT  TO IN009-DEPT         07260000
P28545                           MOVE IN400-ATT-MCL-OUT                 07270000
P28545                                            TO IN009-MAJ-CLASS    07280000
P28545                           MOVE IN010-CLASS TO IN009-SUB-CLASS    07290000
P28545                           MOVE ZEROS       TO IN009-UPC-CODE     07300000
P28545                       END-IF                                     07310000
P28545                     ELSE                                         07320000
P28545                       SET PS-INVALID-ITEM                        07330000
P28545                           PS-INVALID-RECORD   TO TRUE            07340000
P28545                     END-IF                                       07350000
P28545                 END-IF                                           07360000
P28545                 MOVE IN010-SKU TO SA-SKU                         07370000
00326              END-IF                                               07380000
00327          END-IF                                                   07390000
00328      ELSE                                                         07400000
00329          MOVE IN010-UPC-CODE TO PV-WORK-UPC                       07410000
00330          IF (SA-UPC = IN010-UPC-CODE)                             07420000
IN2001             IF ( PS-INVALID-UPC   OR                             07430000
IN2001                  PS-PRICE-NOT-FOUND )                            07440000
00332                  SET PS-INVALID-ITEM                              07450000
00333                      PS-INVALID-RECORD   TO TRUE                  07460000
00334              ELSE                                                 07470000
00335                  MOVE PV-HOLD-DEPT         TO IN009-DEPT          07480000
W21732                 MOVE PV-HOLD-MAJ-CLASS    TO IN009-MAJ-CLASS     07490000
W21732                 MOVE PV-HOLD-SUB-CLASS    TO IN009-SUB-CLASS     07500000
W21732                 MOVE PV-HOLD-SEQ          TO IN009-SKU           07510000
25248                  MOVE PV-HOLD-UPC-CODE     TO IN009-UPC-CODE      07520000
00338                  IF IN010-STORE-NUMBER = SA-STORE-NUMBER          07530000
00339                      SET PS-SAME-SKU-STORE TO TRUE                07540000
Z28545                                                                  07550000
Z28545                     MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT      07560000
Z28545                     MOVE PV-HOLD-DEPT    TO IN009-DEPT           07570000
Z28545                     MOVE IN400-ATT-MCL-OUT                       07580000
Z28545                                          TO PV-HOLD-MAJ-CLASS    07590000
Z28545                     MOVE PV-HOLD-MAJ-CLASS                       07600000
Z28545                                          TO IN009-MAJ-CLASS      07610000
Z28545                     MOVE IN400-ATT-SCL-OUT                       07620000
Z28545                                          TO PV-HOLD-SUB-CLASS    07630000
Z28545                     MOVE PV-HOLD-SUB-CLASS                       07640000
Z28545                                          TO IN009-SUB-CLASS      07650000
Z28545                     MOVE IN400-ATT-SKU-OUT TO PV-HOLD-SEQ        07660000
Z28545                     MOVE PV-HOLD-SEQ       TO IN009-SKU          07670000
Z28545                     MOVE PV-WORK-UPC       TO PV-HOLD-UPC-CODE   07680000
Z28545                     MOVE PV-HOLD-UPC-CODE  TO IN009-UPC-CODE     07690000
Z28545                                                                  07700000
IN0501                 ELSE                                             07710000
P28545                   INITIALIZE IN400-PV-INPUT-AREA                 07720000
P28545                   SET IN400-PV-UPC-NBR-LOOKUP TO TRUE            07730000
P28545                   MOVE IN010-STORE-NUMBER TO IN400-CONVERT-LOC   07740000
P28545                   MOVE IN400-CONVERT-LOC  TO IN400-PV-LOC-IN     07750000
P28545                   MOVE PV-PLND-INV-DTE    TO IN400-PV-EFF-DTE-IN 07760000
P28545                   MOVE IN010-UPC-CODE     TO PV-EDIT-UPC-CODE    07770000
P28545                   MOVE PV-EDIT-UPC-CODE-ALPH                     07780000
P28545                                           TO IN400-PV-UPC-NBR-IN 07790000
P28545                                                                  07800000
P28545                   PERFORM IN400-LOOKUP-RETAIL                    07810000
P28545                                                                  07820000
P28545                   IF IN400-PV-INVALID-KEY-INPUT                  07830000
P28545                     IF (IN400-PS-DUMMY-SKU)                      07840000
P28545                       SET PS-INVALID-ITEM                        07850000
P28545                           PS-INVALID-RECORD                      07860000
P28545                           PS-INVALID-UPC    TO TRUE              07870000
P28545                     ELSE                                         07880000
P28545                        SET PS-INVALID-ITEM                       07890000
P28545                            PS-INVALID-RECORD TO TRUE             07900000
P28545                     END-IF                                       07910000
D28545                     DISPLAY 'INVALID - ', IN010-UPC-CODE,        07920000
D28545                             ' LOC - ', IN010-STORE-NUMBER,       07930000
D28545                             ' PRC RTN - ', IN400-PV-RETURN-CDE,  07940000
D28545                             ' ATT RTN - ', IN400-PV-ATT-RTNCDE,  07950000
D28545                             ' PRC SQL - ', IN400-PV-PRC-SQLCDE,  07960000
D28545                             ' ATT SQL - ', IN400-PV-ATT-SQLCDE,  07970000
D28545                     DISPLAY IN400-PV-RETURN-RSN                  07980000
D28545                     DISPLAY IN400-PV-PARAGRAPH                   07990000
P28545                   ELSE                                           08000000
P28545                   IF IN400-PS-RTL-FOUND OR                       08010000
P28545                      IN400-PS-ATTR-FOUND                         08020000
P28545                     SET PS-PRICE-FOUND      TO TRUE              08030000
P28545                     IF IN400-ATT-PLU-DWNLD-IND EQUAL 'N'         08040000
P28545                       SET PS-PRICE-NOT-FOUND                     08050000
P28545                           PS-INVALID-ITEM                        08060000
P28545                           PS-INVALID-RECORD TO TRUE              08070000
P28545                     ELSE                                         08080000
P28545                     SET PS-VALID-UPC       TO TRUE               08090000
P28545                     IF IN400-PS-DUMMY-SKU                        08100000
P28545                       MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT    08110000
P28545                       MOVE PV-HOLD-DEPT    TO IN009-DEPT         08120000
P28545                       MOVE IN400-ATT-MCL-OUT                     08130000
P28545                                            TO PV-HOLD-MAJ-CLASS  08140000
P28545                       MOVE PV-HOLD-MAJ-CLASS                     08150000
P28545                                            TO IN009-MAJ-CLASS    08160000
P28545                       MOVE IN400-ATT-SCL-OUT                     08170000
P28545                                            TO PV-HOLD-SUB-CLASS  08180000
P28545                       MOVE PV-HOLD-SUB-CLASS                     08190000
P28545                                            TO IN009-SUB-CLASS    08200000
P28545                       MOVE IN400-ATT-SKU-OUT TO PV-HOLD-SEQ      08210000
P28545                       MOVE PV-HOLD-SEQ       TO IN009-SKU        08220000
P28545                       MOVE PV-WORK-UPC       TO PV-HOLD-UPC-CODE 08230000
P28545                       MOVE PV-HOLD-UPC-CODE  TO IN009-UPC-CODE   08240000
P28545                     ELSE                                         08250000
P28545                     IF IN400-PS-RENUMBER-SKU                     08260000
P28545                       MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT    08270000
P28545                       MOVE PV-HOLD-DEPT    TO IN009-DEPT         08280000
P28545                       MOVE IN400-ATT-MCL-OUT                     08290000
P28545                                            TO PV-HOLD-MAJ-CLASS  08300000
P28545                       MOVE PV-HOLD-MAJ-CLASS                     08310000
P28545                                            TO IN009-MAJ-CLASS    08320000
P28545                       MOVE IN400-ATT-SCL-OUT                     08330000
P28545                                            TO PV-HOLD-SUB-CLASS  08340000
P28545                       MOVE PV-HOLD-SUB-CLASS                     08350000
P28545                                            TO IN009-SUB-CLASS    08360000
P28545                       MOVE IN400-ATT-SKU-OUT TO PV-HOLD-SEQ      08370000
P28545                       MOVE PV-HOLD-SEQ       TO IN009-SKU        08380000
P28545                       MOVE PV-WORK-UPC       TO PV-HOLD-UPC-CODE 08390000
P28545                       MOVE PV-HOLD-UPC-CODE  TO IN009-UPC-CODE   08400000
P28545                     ELSE                                         08410000
P28545                       MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT    08420000
P28545                       MOVE PV-HOLD-DEPT    TO IN009-DEPT         08430000
P28545                       MOVE IN400-ATT-MCL-OUT                     08440000
P28545                                            TO PV-HOLD-MAJ-CLASS  08450000
P28545                       MOVE PV-HOLD-MAJ-CLASS                     08460000
P28545                                            TO IN009-MAJ-CLASS    08470000
P28545                       MOVE IN400-ATT-SCL-OUT                     08480000
P28545                                            TO PV-HOLD-SUB-CLASS  08490000
P28545                       MOVE PV-HOLD-SUB-CLASS                     08500000
P28545                                            TO IN009-SUB-CLASS    08510000
P28545                       MOVE IN400-ATT-SKU-OUT TO PV-HOLD-SEQ      08520000
P28545                       MOVE PV-HOLD-SEQ       TO IN009-SKU        08530000
P28545                       MOVE PV-WORK-UPC       TO PV-HOLD-UPC-CODE 08540000
P28545                       MOVE PV-HOLD-UPC-CODE  TO IN009-UPC-CODE   08550000
P28545                     END-IF                                       08560000
P28545                   ELSE                                           08570000
P28545                     SET PS-INVALID-ITEM                          08580000
P28545                         PS-INVALID-RECORD   TO TRUE              08590000
P28545                   END-IF                                         08600000
P28545               MOVE IN010-UPC-CODE TO SA-UPC                      08610000
00340                END-IF                                             08620000
00341            END-IF                                                 08630000
00342          ELSE                                                     08640000
P28545             INITIALIZE IN400-PV-INPUT-AREA                       08650000
P28545             SET IN400-PV-UPC-NBR-LOOKUP TO TRUE                  08660000
P28545             MOVE IN010-STORE-NUMBER TO IN400-CONVERT-LOC         08670000
P28545             MOVE IN400-CONVERT-LOC  TO IN400-PV-LOC-IN           08680000
P28545             MOVE PV-PLND-INV-DTE    TO IN400-PV-EFF-DTE-IN       08690000
P28545             MOVE IN010-UPC-CODE     TO PV-EDIT-UPC-CODE          08700000
P28545             MOVE PV-EDIT-UPC-CODE-ALPH TO IN400-PV-UPC-NBR-IN    08710000
P28545                                                                  08720000
P28545             PERFORM IN400-LOOKUP-RETAIL                          08730000
P28545                                                                  08740000
P28545             IF IN400-PV-INVALID-KEY-INPUT                        08750000
P28545               IF (IN400-PS-DUMMY-SKU)                            08760000
P28545                 SET PS-INVALID-ITEM                              08770000
P28545                     PS-INVALID-RECORD                            08780000
P28545                     PS-INVALID-UPC    TO TRUE                    08790000
P28545               ELSE                                               08800000
P28545                 SET PS-INVALID-ITEM                              08810000
P28545                     PS-INVALID-RECORD TO TRUE                    08820000
P28545               END-IF                                             08830000
D28545               DISPLAY 'INVALID - ', IN010-UPC-CODE,              08840000
D28545                   ' LOC - ', IN010-STORE-NUMBER,                 08850000
D28545                   ' PRC RTN - ', IN400-PV-RETURN-CDE,            08860000
D28545                   ' ATT RTN - ', IN400-PV-ATT-RTNCDE,            08870000
D28545                   ' PRC SQL - ', IN400-PV-PRC-SQLCDE,            08880000
D28545                   ' ATT SQL - ', IN400-PV-ATT-SQLCDE,            08890000
D28545               DISPLAY IN400-PV-RETURN-RSN                        08900000
D28545               DISPLAY IN400-PV-PARAGRAPH                         08910000
P28545             ELSE                                                 08920000
P28545             IF IN400-PS-RTL-FOUND OR                             08930000
P28545                IN400-PS-ATTR-FOUND                               08940000
P28545               SET PS-PRICE-FOUND      TO TRUE                    08950000
P28545               IF IN400-ATT-PLU-DWNLD-IND EQUAL 'N'               08960000
P28545                 SET PS-PRICE-NOT-FOUND                           08970000
P28545                     PS-INVALID-ITEM                              08980000
P28545                     PS-INVALID-RECORD TO TRUE                    08990000
P28545               ELSE                                               09000000
P28545                 SET PS-VALID-UPC       TO TRUE                   09010000
P28545                 IF IN400-PS-DUMMY-SKU                            09020000
P28545                   MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT        09030000
P28545                   MOVE PV-HOLD-DEPT    TO IN009-DEPT             09040000
P28545                   MOVE IN400-ATT-MCL-OUT                         09050000
P28545                                        TO PV-HOLD-MAJ-CLASS      09060000
P28545                   MOVE PV-HOLD-MAJ-CLASS                         09070000
P28545                                        TO IN009-MAJ-CLASS        09080000
P28545                   MOVE IN400-ATT-SCL-OUT                         09090000
P28545                                        TO PV-HOLD-SUB-CLASS      09100000
P28545                   MOVE PV-HOLD-SUB-CLASS                         09110000
P28545                                        TO IN009-SUB-CLASS        09120000
P28545                   MOVE IN400-ATT-SKU-OUT TO IN009-SKU            09130000
P28545                                             PV-HOLD-SEQ          09140000
Z28545                   MOVE PV-WORK-UPC     TO IN009-UPC-CODE         09150000
P28545                                           PV-HOLD-UPC-CODE       09160000
P28545                 ELSE                                             09170000
P28545                 IF IN400-PS-RENUMBER-SKU                         09180000
P28545                   MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT        09190000
P28545                   MOVE PV-HOLD-DEPT    TO IN009-DEPT             09200000
P28545                   MOVE IN400-ATT-MCL-OUT                         09210000
P28545                                        TO PV-HOLD-MAJ-CLASS      09220000
P28545                   MOVE PV-HOLD-MAJ-CLASS                         09230000
P28545                                        TO IN009-MAJ-CLASS        09240000
P28545                   MOVE IN400-ATT-SCL-OUT                         09250000
P28545                                        TO PV-HOLD-SUB-CLASS      09260000
P28545                   MOVE PV-HOLD-SUB-CLASS                         09270000
P28545                                        TO IN009-SUB-CLASS        09280000
P28545                   MOVE IN400-ATT-SKU-OUT TO IN009-SKU            09290000
P28545                                             PV-HOLD-SEQ          09300000
Z28545                   MOVE PV-WORK-UPC       TO IN009-UPC-CODE       09310000
P28545                                           PV-HOLD-UPC-CODE       09320000
P28545               ELSE                                               09330000
P28545                   MOVE IN400-ATT-DEPT-OUT TO PV-HOLD-DEPT        09340000
P28545                   MOVE PV-HOLD-DEPT    TO IN009-DEPT             09350000
P28545                   MOVE IN400-ATT-MCL-OUT                         09360000
P28545                                        TO PV-HOLD-MAJ-CLASS      09370000
P28545                   MOVE PV-HOLD-MAJ-CLASS                         09380000
P28545                                        TO IN009-MAJ-CLASS        09390000
P28545                   MOVE IN400-ATT-SCL-OUT                         09400000
P28545                                        TO PV-HOLD-SUB-CLASS      09410000
P28545                   MOVE PV-HOLD-SUB-CLASS                         09420000
P28545                                        TO IN009-SUB-CLASS        09430000
P28545                   MOVE IN400-ATT-SKU-OUT TO IN009-SKU            09440000
P28545                                             PV-HOLD-SEQ          09450000
Z28545                   MOVE PV-WORK-UPC       TO IN009-UPC-CODE       09460000
P28545                                           PV-HOLD-UPC-CODE       09470000
P28545               END-IF                                             09480000
P28545             ELSE                                                 09490000
P28545               SET PS-INVALID-ITEM                                09500000
P28545                   PS-INVALID-RECORD   TO TRUE                    09510000
P28545             END-IF                                               09520000
P28545         MOVE IN010-UPC-CODE TO SA-UPC                            09530000
00351          END-IF                                                   09540000
00352      END-IF.                                                      09550000
00353                                                                   09560000
00355      IF PS-VALID-ITEM  AND                                        09570000
00356         PS-VALID-RECORD                                           09580000
00357                                                                   09590000
00370          IF IN010-SCANNING-STORE                                  09600000
00354 *            CLEARANCE AREAS                                      09610000
00371              IF IN010-AREA-NUMBER >= 9000  AND                    09620000
00372                 IN010-AREA-NUMBER <= 9999                         09630000
00373                                                                   09640000
00374                  IF IN010-PRICE = ZERO                            09650000
00375                      SET PS-INVALID-RECORD TO TRUE                09660000
00376                  ELSE                                             09670000
00377                       MOVE IN010-PRICE TO IN009-PRICE             09680000
C21732                      SET PS-PRICE-FOUND TO TRUE                  09690000
00378                  END-IF                                           09700000
00379              ELSE                                                 09710000
W21732                 IF ((PV-KOHLS-UPC) AND                           09720000
P28545                       (IN400-PS-DUMMY-SKU))                      09730000
W21732                         OR (IN010-SKU-X (6:3) = PC-999)          09740000
W21732                         OR (IN010-SKU NOT = ZERO                 09750000
W21732                         AND IN010-SKU (6:3) = ZERO)              09760000
00383                      SET PS-INVALID-RECORD TO TRUE                09770000
00384                  END-IF                                           09780000
      *             *----------------------------                       09790000
      *             REFORMAT INPUT IN010 INV DATE                       09800000
      *             *----------------------------                       09810000
                       MOVE IN010-INV-YY TO PV-YY                       09820000
                       MOVE IN010-INV-MM TO PV-MM                       09830000
                       MOVE IN010-INV-DD TO PV-DD                       09840000
                       IF PV-TEMP-DATE EQUAL ZERO                       09850000
                           MOVE 00 TO PV-CC                             09860000
                       ELSE                                             09870000
                           IF PV-YY < 80                                09880000
                               MOVE 20 TO PV-CC                         09890000
                           ELSE                                         09900000
                               MOVE 19 TO PV-CC                         09910000
                           END-IF                                       09920000
                       END-IF                                           09930000
      *  -------------------------------------------------------------- 09940000
JS0300** ALL RED TICKET ITEMS NOT IN AREAS 9000 - 9999                  09950000
JS0300** ARE FLAGGED AS MISSED MARKDOWNS                                09960000
      *  -------------------------------------------------------------- 09970000
P25545                 IF IN400-PRC-STATUS-OUT = PC-CLEARANCE-STATUS-30 09980000
P28545* --------------------------------------------------------------- 09990000
P28545********  RCP PRICING ISSUE (POSSIBLE MISSED MARKDOWNS)  *********10000000
P28545* CLEARANCE SKUS IN A NON-9000 WILL NOT HAVE PRICE INPUT          10010000
P28545* LOOK UP STORE-SPECIFIC STORE ROW PRICING AND USE IF FOUND       10020000
P28545* --------------------------------------------------------------- 10030000
P28545*                     PERFORM Z700-GET-CUTOFF-PRICE               10040000
P28545*                                                                 10050000
P28545*                     IF UPCPLS-MEITGP-NBR NOT EQUAL 0            10060000
P28545*                         PERFORM Z760-CHECK-GRP-PRC              10070000
P28545*                         COMPUTE PV-GROUP-UNIT-RTL ROUNDED =     10080000
P28545*                               (MITGPL-GP-AMT /                  10090000
P28545*                                MITGPL-MITGPL-QTY )              10100000
P28545*                         MOVE PV-GROUP-UNIT-RTL TO PV-UNT-RTL-AMT10110000
P28545*                     END-IF                                      10120000
P28545*                                                                 10130000
P28545                      IF IN400-PRC-UPC-CHG-DTE-OUT                10140000
P28545                           GREATER IN400-PRC-STAT-CHG-DTE-OUT     10150000
                               MOVE 'Y' TO IN009-MISSED-MARKDOWN-IND    10160000
JS0300                      ELSE                                        10170000
JS0300                         MOVE SPACE TO IN009-MISSED-MARKDOWN-IND  10180000
JS0300                      END-IF                                      10190000
JS0300                 ELSE                                             10200000
JS0300                    MOVE SPACE TO IN009-MISSED-MARKDOWN-IND       10210000
00393                  END-IF                                           10220000
00394                                                                   10230000
INK001* MOVE UNIT RETAIL ALREADY RETRIEVED DURING SKU/UPC VALIDATION    10240000
INK001* TO VALID OUTPUT FILE.                                           10250000
INK001                 IF PS-VALID-RECORD                               10260000
P28545                     MOVE IN400-PRC-UNIT-RTL-OUT TO IN009-PRICE   10270000
INK001                                                    IN010-PRICE   10280000
INK001                 END-IF                                           10290000
                                                                        10300000
INK001* PERFORMING C400-LOOKUP-PRICE WILL PERFORM LOGIC TO RETRIEVE STR 10310000
INK001* PRICING AGAIN. THIS IS REDUNDANT SINCE RETAIL/STATUS IS ALREADY 10320000
INK001* OBTAINED IN SKU/UPC VALIDATION. THIS WOULD ALSO OVERLAY PMMD    10330000
INK001* PRICING AT THE STORE-SPECIFIC ROW WITH STR000 RETAIL            10340000
00394 *    |                                                            10350000
00395 *    |           IF PS-VALID-RECORD                               10360000
00396 *    |               IF (IN009-SKU = SA-LOOKUP-SKU) AND           10370000
00397 *    |                  (IN009-STORE-NUMBER = SA-LOOKUP-STORE)    10380000
00398 *    |                   CONTINUE                                 10390000
00399 *    |               ELSE                                         10400000
00400 *    |                   PERFORM C400-LOOKUP-PRICE                10410000
00401 *    |                   MOVE IN009-SKU TO SA-LOOKUP-SKU          10420000
00402 *    |                   MOVE IN009-STORE-NUMBER                  10430000
00403 *    |                                  TO SA-LOOKUP-STORE        10440000
00404 *    |               END-IF                                       10450000
00410 *    |               MOVE PV-LOOKUP-PRICE TO IN009-PRICE          10460000
00411 *    |                                       IN010-PRICE          10470000
00405 *    |           END-IF                                           10480000
INK001*    |                                                            10490000
00413              END-IF                                               10500000
00414          ELSE                                                     10510000
00414 *            NON-SCAN-STORE                                       10520000
00415              IF IN010-PRICE = ZERO                                10530000
00416                  SET PS-INVALID-RECORD TO TRUE                    10540000
00417              ELSE                                                 10550000
00418                  MOVE IN010-PRICE TO IN009-PRICE                  10560000
00419              END-IF                                               10570000
00420          END-IF                                                   10580000
00421                                                                   10590000
00422          IF IN010-QUANTITY = 0                                    10600000
00423              SET PS-INVALID-RECORD TO TRUE                        10610000
00424          ELSE                                                     10620000
JS0598             MOVE IN010-QUANTITY TO IN009-QUANTITY-COMP           10630000
00426          END-IF                                                   10640000
00427      ELSE                                                         10650000
00428          IF (IN010-AREA-NUMBER < 9000  OR                         10660000
00429             IN010-AREA-NUMBER > 9999)  AND                        10670000
00430             IN010-SCANNING-STORE                                  10680000
00431              INITIALIZE IN010-PRICE                               10690000
00432          END-IF                                                   10700000
00433      END-IF.                                                      10710000
00434                                                                   10720000
00435      IF PS-VALID-ITEM  AND                                        10730000
00436         PS-VALID-RECORD                                           10740000
00437          PERFORM Z500-WRITE-EDITED-RECORD                         10750000
JS0598         MOVE IN010-QUANTITY TO IN009-QUANTITY                    10760000
00438          PERFORM C600-WRITE-VALID-RPT-RECORD                      10770000
00439      ELSE                                                         10780000
W26600*        MOVE IN010-INVENTORY-COUNT-RECORD TO                     10790000
W26600*             IN008-INVENTORY-COUNT-RECORD                        10800000
W26600         INITIALIZE              IN008-INVENTORY-COUNT-RECORD     10810000
W26600         MOVE IN010-STORE-NUMBER TO IN008-STORE-NUMBER            10820000
W26600         MOVE IN010-AREA-NUMBER  TO IN008-AREA-NUMBER             10830000
W26600         MOVE IN010-LINE-NUMBER  TO IN008-LINE-NUMBER             10840000
W26600         MOVE IN010-SCAN-LINE-NUMBER                              10850000
W26600                                 TO IN008-SCAN-LINE-NUMBER        10860000
W26600         MOVE IN010-SKU          TO IN008-SKU                     10870000
W26600         MOVE IN010-QUANTITY     TO IN008-QUANTITY                10880000
W26600         MOVE IN010-PRICE        TO IN008-PRICE                   10890000
W26600         MOVE IN010-UPC-CODE     TO IN008-UPC-CODE                10900000
W26600         MOVE IN010-INVALID-INDICATOR                             10910000
W26600                                 TO IN008-INVALID-INDICATOR       10920000
W26600         MOVE IN010-SCAN-DTE     TO IN008-SCAN-DTE                10930000
W26600         MOVE IN010-SCAN-TIMESTAMP                                10940000
W26600                                 TO IN008-SCAN-TIMESTAMP          10950000
W26600         MOVE PS-INVALID-RECORD-SW                                10960000
W26600                                 TO IN008-INVALID-RCD             10970000
W26600         MOVE PS-INVALID-ITEM-SW TO IN008-INVALID-ITEM            10980000
00444          PERFORM Z550-WRITE-INVALID-DETAIL                        10990000
00445      END-IF.                                                      11000000
00446                                                                   11010000
IN2001     IF PS-EMAIL-MESSAGE-UPCPLS                                   11020000
IN2001         PERFORM Z580-WRITE-MISSING-ITEM                          11030000
IN2001     END-IF.                                                      11040000
IN2001                                                                  11050000
00447      MOVE IN010-STORE-NUMBER TO SA-STORE-NUMBER.                  11060000
00448      PERFORM Z100-READ-INVENTORY-FILE.                            11070000
00449 *                                                                 11080000
00450 ******************************************************************11090000
00451 *  CLOSE ALL FILES USED BY THIS PROGRAM.                          11100000
00452 ******************************************************************11110000
00453  B400-CLOSE-FILES.                                                11120000
00454 *                                                                 11130000
00455      CLOSE       PHYSICAL-INVENTORY-FILE                          11140000
00456                  INVALID-DETAIL-FILE                              11150000
00457                  VALID-INV-REPORT-FILE                            11160000
00458                  EDITED-INVENTORY-FILE                            11170000
IN2001                 MISSING-TABLE-ENTRY-FILE.                        11180000
00459                                                                   11190000
P28545******************************************************************11200000
P28545*C100-CHECK-SKU.                                                  11210000
P28545******************************************************************11220000
P28545*C100-CHECK-SKU.                                                  11230000
P28545*                                                                 11240000
P28545*                                                                 11250000
P28545*    MOVE IN010-DEPT (2:3)       TO MDSEAR-DEPT-NBR               11260000
P28545*    MOVE IN010-CLASS (3:2)      TO PV-MAJ-CL-NBR                 11270000
P28545*                                   PV-SUB-CL-NBR-2-3.            11280000
P28545*    MOVE '0'                    TO PV-SUB-CL-NBR-1               11290000
P28545*                                   PV-MAJ-CL-NBR-2.              11300000
P28545*    MOVE PV-SUB-CL-NBR          TO MDSEAR-SUB-CL-NBR.            11310000
P28545*    MOVE PV-MAJ-CL-NBR          TO MDSEAR-MAJ-CL-NBR.            11320000
P28545*    MOVE IN010-SKU              TO SKXREF-SKU.                   11330000
P28545*    IF IN010-SKU-X (6:3) = PC-999 OR ZEROES                      11340000
P28545*         MOVE IN010-SKU (1:3)   TO MDSEAR-DEPT-NBR               11350000
P28545*         MOVE IN010-SKU (4:2)   TO PV-MAJ-CL-NBR                 11360000
P28545*                                   PV-SUB-CL-NBR-2-3             11370000
P28545*         MOVE '0'               TO PV-MAJ-CL-NBR-2               11380000
P28545*                                   PV-SUB-CL-NBR-1               11390000
P28545*         MOVE PV-SUB-CL-NBR     TO MDSEAR-SUB-CL-NBR             11400000
P28545*         MOVE PV-MAJ-CL-NBR     TO MDSEAR-MAJ-CL-NBR             11410000
P28545*         PERFORM Z800-READ-MBS                                   11420000
P28545*         IF PS-VALID-DEPT-CLASS                                  11430000
P28545*             SET PS-VALID-SKU TO TRUE                            11440000
P28545*             MOVE PV-MAJ-CL-NBR-9 TO SKXREF-CLASS                11450000
P28545*             MOVE IN010-SKU     TO IN009-SKU                     11460000
P28545*             MOVE IN010-DEPT    TO IN009-DEPT                    11470000
P28545*             MOVE IN010-CLASS   TO IN009-SUB-CLASS               11480000
P28545*             MOVE SKXREF-CLASS  TO IN009-MAJ-CLASS               11490000
P28545*             MOVE ZEROS         TO IN009-UPC-CODE                11500000
P28545*         ELSE                                                    11510000
P28545*             SET PS-INVALID-SKU                                  11520000
P28545*                 PS-INVALID-ITEM                                 11530000
P28545*                 PS-INVALID-RECORD TO TRUE                       11540000
P28545*         END-IF                                                  11550000
P28545*                                                                 11560000
P28545*         INITIALIZE UPCPLS-UPC-STAT-CDE                          11570000
P28545*     ELSE                                                        11580000
P28545*         PERFORM Z850-READ-SKU-TABLE                             11590000
P28545*                                                                 11600000
P28545*         IF PS-VALID-SKU                                         11610000
P28545*             MOVE IN010-SKU     TO IN009-SKU                     11620000
P28545*             MOVE IN010-DEPT    TO IN009-DEPT                    11630000
P28545*             MOVE IN010-CLASS   TO IN009-SUB-CLASS               11640000
P28545*             MOVE SKXREF-CLASS  TO IN009-MAJ-CLASS               11650000
P28545*             MOVE ZEROS         TO IN009-UPC-CODE                11660000
P28545*             PERFORM Z600-READ-TUPCPLS-TABLE                     11670000
P28545*         ELSE                                                    11680000
P28545*             SET PS-INVALID-ITEM                                 11690000
P28545*                 PS-INVALID-RECORD TO TRUE                       11700000
P28545*         END-IF                                                  11710000
P28545*     END-IF.                                                     11720000
P28545*                                                                 11730000
P28545******************************************************************11740000
P28545* THIS ROUTINE VALIDATES UPC AND, IF VALID, CONVERTS IT TO A SKU. 11750000
P28545* AND PERFORMS SELECTION OF RETAIL PRICING IN D200-CONVERT-UPC    11760000
P28545******************************************************************11770000
P28545*C200-CHECK-UPC-CODE.                                             11780000
P28545*                                                                 11790000
P28545*    IF (IN010-SCAN-IND NOT = 'Y') AND                            11800000
P28545*       (PV-UPC-CHK-DIG = ZERO)                                   11810000
P28545*        PERFORM D400-RECALC-CHECK-DIGIT                          11820000
P28545*    END-IF.                                                      11830000
P28545*    MOVE PV-WORK-UPC    TO DK-UPC-CODE.                          11840000
P28545*    MOVE IN009-STORE-NUMBER   TO DK-STORE.                       11850000
P28545*    PERFORM D200-CONVERT-UPC-CODE.                               11860000
P28545*    IF PS-VALID-UPC                                              11870000
P28545*    AND PS-PRICE-FOUND                                           11880000
P28545*         MOVE SKXREF-DEPT      TO   IN009-DEPT                   11890000
P28545*                                    PV-HOLD-DEPT                 11900000
P28545*         MOVE SKXREF-CLASS     TO   IN009-MAJ-CLASS              11910000
P28545*                                    PV-HOLD-MAJ-CLASS            11920000
P28545*         MOVE SKXREF-SUBCLASS  TO   IN009-SUB-CLASS              11930000
P28545*                                    PV-HOLD-SUB-CLASS            11940000
P28545*         MOVE SKXREF-SKU       TO   IN009-SKU                    11950000
P28545*                                    PV-HOLD-SEQ                  11960000
P28545*         MOVE PV-WORK-UPC      TO   IN009-UPC-CODE               11970000
P28545*                                    PV-HOLD-UPC-CODE             11980000
P28545*    ELSE                                                         11990000
P28545*        PERFORM D400-RECALC-CHECK-DIGIT                          12000000
P28545*        IF SQLCODE = 0                                           12010000
P28545*            MOVE PV-WORK-UPC    TO DK-UPC-CODE                   12020000
P28545*            MOVE IN009-STORE-NUMBER   TO DK-STORE                12030000
P28545*            PERFORM D200-CONVERT-UPC-CODE                        12040000
P28545*            IF PS-VALID-UPC                                      12050000
P28545*            AND PS-PRICE-FOUND                                   12060000
P28545*                 MOVE SKXREF-DEPT     TO  IN009-DEPT             12070000
P28545*                                          PV-HOLD-DEPT           12080000
P28545*                 MOVE SKXREF-CLASS    TO  IN009-MAJ-CLASS        12090000
P28545*                                          PV-HOLD-MAJ-CLASS      12100000
P28545*                 MOVE SKXREF-SUBCLASS TO  IN009-SUB-CLASS        12110000
P28545*                                          PV-HOLD-SUB-CLASS      12120000
P28545*                 MOVE SKXREF-SKU      TO  IN009-SKU              12130000
P28545*                                          PV-HOLD-SEQ            12140000
P28545*                 MOVE PV-WORK-UPC     TO  IN009-UPC-CODE         12150000
P28545*                                          PV-HOLD-UPC-CODE       12160000
P28545*            ELSE                                                 12170000
P28545*                SET PS-INVALID-ITEM                              12180000
P28545*                    PS-INVALID-RECORD   TO TRUE                  12190000
P28545*            END-IF                                               12200000
P28545*        ELSE                                                     12210000
P28545*            SET PS-INVALID-ITEM                                  12220000
P28545*                PS-INVALID-RECORD   TO TRUE                      12230000
P28545*       END-IF                                                    12240000
P28545*    END-IF.                                                      12250000
P28545*                                                                 12260000
P28545****************************************************************  12270000
P28545* C300-RENUMBER-SKU.                                              12280000
P28545****************************************************************  12290000
P28545*C300-RENUMBER-SKU.                                               12300000
P28545*                                                                 12310000
P28545*    SET PS-VALID-RENUMBER TO TRUE.                               12320000
P28545*    PERFORM D100-FIND-RENUMBERED-SKU.                            12330000
P28545*                                                                 12340000
P28545*    IF PS-INVALID-RENUMBER                                       12350000
P28545*        DISPLAY 'SKU COULD NOT BE RENUMBERED'                    12360000
P28545*        DISPLAY 'STORE NUMBER: ' IN010-STORE-NUMBER              12370000
P28545*        DISPLAY 'AREA NUMBER: ' IN010-AREA-NUMBER                12380000
P28545*        DISPLAY 'LINE NUMBER: ' IN010-LINE-NUMBER                12390000
P28545*        DISPLAY 'SKU: ' IN010-SKU                                12400000
P28545*        SET PS-INVALID-ITEM                                      12410000
P28545*            PS-INVALID-RECORD TO TRUE                            12420000
P28545*        INITIALIZE UPCPLS-UPC-STAT-CDE                           12430000
P28545*    END-IF.                                                      12440000
P28545*                                                                 12450000
      ******************************************************************12460000
00561 *                                                                 12470000
00562 ******************************************************************12480000
00563 *C400-LOOKUP-PRICE.                                               12490000
00564 *                                                                 12500000
00565 *    MOVE IN009-STORE-NUMBER   TO DK-STORE.                       12510000
00566 *    MOVE IN009-DEPT           TO DK-DEPT-NBR.                    12520000
00567 *    MOVE IN009-CLASS          TO DK-MAJ-CL-NBR.                  12530000
00568 *    MOVE IN009-SEQUENCE       TO DK-SEQ.                         12540000
00569 *    PERFORM Z600-READ-TUPCPLS-TABLE.                             12550000
00570 *    IF PS-PRICE-FOUND                                            12560000
00571 *        MOVE PV-UNT-RTL-AMT TO PV-LOOKUP-PRICE                   12570000
00572 *    ELSE                                                         12580000
00573 *        INITIALIZE PV-LOOKUP-PRICE                               12590000
00574 *        DISPLAY '*** SKU / STORE NOT FOUND *** ',                12600000
00575 *        ' STORE: ' IN009-STORE-NUMBER, '  SKU: '                 12610000
00575 *         IN009-SKU, '   UPC : ' IN010-UPC-CODE                   12620000
00576 *    END-IF.                                                      12630000
00577 *                                                                 12640000
00579 ******************************************************************12650000
P28545*                                                                 12660000
P28545******************************************************************12670000
P28545*C500-VALIDATE-KOHLS-UPC.                                         12680000
P28545*                                                                 12690000
P28545*    SET DP040I-GEN-INTERNAL-UPC-OPTION TO TRUE.                  12700000
P28545*    MOVE  PV-UPC-SKU      TO DP040I-SKU-NUMBER.                  12710000
P28545*                                                                 12720000
P28545*    CALL 'DPKUT041' USING DP040I-UPC-CHECK-DIGIT-PARMS.          12730000
P28545*                                                                 12740000
P28545*    IF (DP040I-NO-ERROR-DETECTED)                                12750000
P28545*        PERFORM D300-VALIDATE-UPC-WITH-MBS                       12760000
P28545*    ELSE                                                         12770000
P28545*        SET PS-INVALID-ITEM                                      12780000
P28545*            PS-INVALID-RECORD                                    12790000
P28545*            PS-INVALID-UPC     TO TRUE                           12800000
P28545*    END-IF.                                                      12810000
                                                                        12820000
      ****************************************************************  12830000
P28545*C600-WRITE-VALID-RPT-RECORD.                                     12840000
00601 ****************************************************************  12850000
00602  C600-WRITE-VALID-RPT-RECORD.                                     12860000
00603                                                                   12870000
P28545     MOVE IN400-ATT-MDSEAR-DESC     TO PV-HOLD-MAJ-CL-DESC.       12880000
P28545     MOVE IN400-ATT-BYR-NBR         TO PV-HOLD-BYR-NBR.           12890000
P28545     MOVE IN400-ATT-GMA-NBR         TO PV-HOLD-GMA-NBR.           12900000
P28545     MOVE IN400-ATT-DMA-NBR         TO PV-HOLD-DMA-NBR.           12910000
P28545                                                                  12920000
P28545*    IF IN009-DEPT-CLASS NOT EQUAL SA-DEPT-CL                     12930000
P28545*        MOVE IN009-DEPT-CLASS  TO SA-DEPT-CL                     12940000
P28545*                                                                 12950000
P28545*        MOVE IN009-DEPT (2:3)      TO MDSEAR-DEPT-NBR            12960000
P28545*        MOVE IN009-SUB-CLASS (3:2) TO PV-SUB-CL-NBR-2-3          12970000
P28545*        MOVE '0'                   TO PV-SUB-CL-NBR-1            12980000
P28545*        MOVE PV-SUB-CL-NBR         TO MDSEAR-SUB-CL-NBR          12990000
P28545*                                                                 13000000
P28545*        MOVE IN009-MAJ-CLASS (3:2) TO MDSEAR-MAJ-CL-NBR          13010000
P28545*        MOVE IN009-SKU             TO SKXREF-SKU                 13020000
P28545*        PERFORM Z800-READ-MBS                                    13030000
P28545*        IF PS-VALID-DEPT-CLASS                                   13040000
P28545*            MOVE MDSEAR-DESC      TO PV-HOLD-MAJ-CL-DESC         13050000
P28545*            MOVE MDSEAR-BYR-NBR   TO PV-HOLD-BYR-NBR             13060000
P28545*            MOVE MDSEAR-GMA-NBR   TO PV-HOLD-GMA-NBR             13070000
P28545*            MOVE MDSEAR-DMA-NBR   TO PV-HOLD-DMA-NBR             13080000
P28545*        ELSE                                                     13090000
P28545*            MOVE +4008                 TO ABEND-CODE             13100000
P28545*            DISPLAY '**  ABEND     **'                           13110000
P28545*            DISPLAY '**  PROGRAM   **  =  INKUT102'              13120000
P28545*            DISPLAY 'INVALID DEPT CLASS: ' IN009-SKU             13130000
P28545*            CALL 'ILBOABN0'  USING ABEND-CODE                    13140000
P28545*        END-IF                                                   13150000
P28545*    END-IF.                                                      13160000
P28545                                                                  13170000
00630      MOVE IN010-INV-DATE                TO IN014-INV-DATE.        13180000
W21732     MOVE IN009-EDITED-INVENTORY-RECORD                           13190000
W21732                                  TO IN014-VALID-RPT-KEY-AREA.    13200000
W21732     MOVE IN009-DEPT                    TO IN014-DEPT.            13210000
W21732     MOVE IN009-SUB-CLASS               TO IN014-CLASS.           13220000
00632      MOVE PV-HOLD-MAJ-CL-DESC           TO IN014-CLASS-DESC.      13230000
00633      MOVE PV-HOLD-BYR-NBR               TO IN014-BYR.             13240000
00634      MOVE PV-HOLD-GMA-NBR               TO IN014-GMA.             13250000
00635      MOVE PV-HOLD-DMA-NBR               TO IN014-DMA.             13260000
25248      MOVE IN009-UPC-CODE                TO IN014-UPC-CODE.        13270000
00636      PERFORM Z575-WRITE-VALID-RPT-REC.                            13280000
00637                                                                   13290000
P28545****************************************************************  13300000
P28545*                                                                 13310000
P28545****************************************************************  13320000
P28545*D100-FIND-RENUMBERED-SKU.                                        13330000
P28545*                                                                 13340000
P28545*    IF PV-CONVERT-SKU(6:3)  = 000                                13350000
P28545*       SET DP040I-GEN-INTERNAL-UPC-OPTION TO TRUE                13360000
P28545*       MOVE PV-CONVERT-SKU       TO DP040I-SKU-NUMBER            13370000
P28545*                                                                 13380000
P28545*       CALL 'DPKUT041' USING DP040I-UPC-CHECK-DIGIT-PARMS        13390000
P28545*                                                                 13400000
P28545*       IF DP040I-NO-ERROR-DETECTED                               13410000
P28545*           MOVE DP040I-UPC-CODE  TO PV-UPC-CODE                  13420000
P28545*       ELSE                                                      13430000
P28545*           INITIALIZE               PV-UPC-CODE                  13440000
P28545*       END-IF                                                    13450000
P28545*    ELSE                                                         13460000
P28545*        MOVE PV-CONVERT-SKU  TO SKXREF-SKU                       13470000
P28545*                                                                 13480000
P28545*        EXEC SQL                                                 13490000
P28545*             SELECT U.UPC_NBR                                    13500000
P28545*               INTO :UPC-UPC-NBR                                 13510000
P28545*               FROM TUPC    U                                    13520000
P28545*                  , TSKXREF X                                    13530000
P28545*              WHERE (X.INTR_UPC_ID = U.UPC_ID)                   13540000
P28545*                AND (X.SKU         = :SKXREF-SKU)                13550000
P28545*                AND U.EFF_BEG_DTE <= :PV-PLND-INV-DTE            13560000
P28545*                AND (U.EFF_END_DTE IS NULL                       13570000
P28545*                 OR  U.EFF_END_DTE >= :PV-PLND-INV-DTE)          13580000
P28545*        END-EXEC                                                 13590000
P28545*                                                                 13600000
P28545*        EVALUATE TRUE                                            13610000
P28545*            WHEN SQLCODE = 0                                     13620000
P28545*                MOVE UPC-UPC-NBR TO PV-UPC-CODE                  13630000
P28545*            WHEN SQLCODE = +100                                  13640000
P28545**                                                                13650000
P28545*                MOVE IN009-STORE-NUMBER                          13660000
P28545*                                 TO  PV-UPC-ERROR-STORE          13670000
P28545*                MOVE IN009-AREA-NUMBER                           13680000
P28545*                                 TO  PV-UPC-ERROR-AREA           13690000
P28545*                MOVE IN009-SKU                                   13700000
P28545*                                 TO  PV-UPC-ERROR-SKU            13710000
P28545*                MOVE IN010-UPC-CODE-X                            13720000
P28545*                                 TO  PV-UPC-ERROR-UPC            13730000
P28545*                PERFORM D150-WRITE-UPC-ERROR-RECORD              13740000
P28545*            WHEN OTHER                                           13750000
P28545*                INITIALIZE          PV-UPC-CODE                  13760000
P28545*        END-EVALUATE                                             13770000
P28545*    END-IF                                                       13780000
P28545*                                                                 13790000
P28545*    PERFORM E100-READ-UPC-SKU-TABLE.                             13800000
P28545*                                                                 13810000
P28545*    IF PS-UPC-FOUND                                              13820000
P28545*       MOVE TUPCSKU-ITEM-NBR TO PV-ITEM-NBR                      13830000
P28545*                                SKXREF-ITM-NBR                   13840000
P28545*    ELSE                                                         13850000
P28545*       SET PS-INVALID-RENUMBER  TO TRUE                          13860000
P28545*    END-IF.                                                      13870000
P28545*                                                                 13880000
P28545*    IF  PS-VALID-RENUMBER                                        13890000
P28545*        PERFORM E200-READ-SKU-BY-ITEM                            13900000
P28545*        IF  PS-ITEM-NOT-FOUND                                    13910000
P28545*            SET PS-INVALID-RENUMBER  TO TRUE                     13920000
P28545*        ELSE                                                     13930000
P28545*  IF VALID SKU FROM TSK - GET THE STATUS AND RETAIL FROM TUPCPLS 13940000
P28545*            PERFORM Z600-READ-TUPCPLS-TABLE                      13950000
P28545*            MOVE SKXREF-DEPT      TO  NI-DEPT-9                  13960000
P28545*            MOVE NI-DEPT          TO  PV-RENUMBERED-DEPT         13970000
P28545*            MOVE SKXREF-CLASS     TO  NI-CLASS-9                 13980000
P28545*            MOVE NI-CLASS         TO  PV-RENUMBERED-MAJ-CLASS    13990000
P28545*            MOVE SKXREF-SUBCLASS  TO  NI-SUB-CLASS-9             14000000
P28545*            MOVE NI-SUB-CLASS     TO  PV-RENUMBERED-SUB-CLASS    14010000
P28545*            MOVE SKXREF-SKU       TO  NI-SKU-9                   14020000
P28545*            MOVE NI-SKU           TO  PV-RENUMBERED-SEQ          14030000
P28545*                                      PV-CONVERT-SKU             14040000
P28545*        END-IF                                                   14050000
P28545*    END-IF.                                                      14060000
P28545*                                                                 14070000
P28545******************************************************************14080000
P28545* D150-WRITE-UPC-ERROR-RECORD    WRITES INTO UPC ERROR FILE       14090000
P28545******************************************************************14100000
P28545*D150-WRITE-UPC-ERROR-RECORD.                                     14110000
P28545*                                                                 14120000
P28545*    WRITE MISSING-TABLE-ENTRY-RECORD FROM                        14130000
P28545*          PV-UPC-ERROR-FILE-RECORD       BEFORE ADVANCING 1 LINE.14140000
P28545*                                                                 14150000
P28545******************************************************************14160000
P28545* D200-CONVERT-UPC-CODE    READS TUPCSKU, CONVERTS UPC CODE TO SKU14170000
P28545******************************************************************14180000
P28545*D200-CONVERT-UPC-CODE.                                           14190000
P28545*                                                                 14200000
P28545*    PERFORM                                                      14210000
P28545*        WITH TEST AFTER                                          14220000
P28545*        VARYING PV-RETRY-COUNT FROM 1 BY 1                       14230000
P28545*        UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  14240000
P28545*            OR (SQLCODE = 0)                                     14250000
P28545*            OR (SQLCODE = +100)                                  14260000
P28545*                                                                 14270000
P28545*        MOVE DK-UPC-CODE TO TUPCSKU-UPC-NBR                      14280000
P28545*                                                                 14290000
P28545*        EXEC SQL                                                 14300000
P28545*             SELECT X.ITM_NBR                                    14310000
P28545*                  , X.SKU                                        14320000
P28545*                  , X.DEPT                                       14330000
P28545*                  , X.CLASS                                      14340000
P28545*                  , X.SUBCLASS                                   14350000
P28545*                  , PLU_DWNLD_IND                                14360000
P28545*               INTO :SKXREF-ITM-NBR                              14370000
P28545*                  , :SKXREF-SKU                                  14380000
P28545*                  , :SKXREF-DEPT                                 14390000
P28545*                  , :SKXREF-CLASS                                14400000
P28545*                  , :SKXREF-SUBCLASS                             14410000
P28545*                  , :TUPCSKU-PLU-DWNLD-IND                       14420000
P28545*               FROM TUPCSKU A                                    14430000
P28545*                  , TSKXREF X                                    14440000
P28545*              WHERE (A.ITEM_NBR  = X.ITM_NBR                     14450000
P28545*                AND UPC_NBR      = :TUPCSKU-UPC-NBR)             14460000
P28545*        END-EXEC                                                 14470000
P28545*                                                                 14480000
P28545*                                                                 14490000
P28545*        EVALUATE TRUE                                            14500000
P28545*            WHEN SQLCODE = 0                                     14510000
P28545*                SET PS-VALID-UPC TO TRUE                         14520000
P28545*                PERFORM Z600-READ-TUPCPLS-TABLE                  14530000
P28545*            WHEN SQLCODE = -904                                  14540000
P28545*            WHEN SQLCODE = -911                                  14550000
P28545*            WHEN SQLCODE = +100                                  14560000
P28545*                SET PS-INVALID-UPC  TO TRUE                      14570000
P28545*            WHEN OTHER                                           14580000
P28545*                MOVE 'D200-CONVERT-UPC-CODE' TO                  14590000
P28545*                                        PV-PARAGRAPH-NAME        14600000
P28545*                PERFORM Z900-SQL-ABEND                           14610000
P28545*        END-EVALUATE                                             14620000
P28545*    END-PERFORM.                                                 14630000
P28545*                                                                 14640000
P28545*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          14650000
P28545*        MOVE 'D200-CONVERT-UPC-CODE' TO                          14660000
P28545*                                PV-PARAGRAPH-NAME                14670000
P28545*        PERFORM Z900-SQL-ABEND                                   14680000
P28545*    END-IF.                                                      14690000
P28545*                                                                 14700000
P28545******************************************************************14710000
P28545*                                                                 14720000
P28545******************************************************************14730000
P28545*D300-VALIDATE-UPC-WITH-MBS.                                      14740000
P28545*                                                                 14750000
P28545*    MOVE PV-UPC-SKU-DEPT-CL (1:3)  TO MDSEAR-DEPT-NBR.           14760000
P28545*    MOVE PV-UPC-SKU-DEPT-CL (4:2)  TO PV-MAJ-CL-NBR              14770000
P28545*                                      PV-SUB-CL-NBR-2-3.         14780000
P28545*    MOVE '0'            TO PV-SUB-CL-NBR-1                       14790000
P28545*                           PV-MAJ-CL-NBR-2.                      14800000
P28545*    MOVE PV-MAJ-CL-NBR  TO MDSEAR-MAJ-CL-NBR.                    14810000
P28545*    MOVE PV-SUB-CL-NBR  TO MDSEAR-SUB-CL-NBR.                    14820000
P28545*                                                                 14830000
P28545*    PERFORM Z800-READ-MBS.                                       14840000
P28545*                                                                 14850000
P28545*    IF PS-VALID-DEPT-CLASS                                       14860000
P28545*        SET PS-VALID-UPC       TO TRUE                           14870000
P28545*        MOVE MDSEAR-DEPT-NBR   TO PV-HOLD-DEPT                   14880000
P28545*        MOVE PV-HOLD-DEPT      TO IN009-DEPT                     14890000
P28545*        MOVE MDSEAR-MAJ-CL-NBR TO PV-HOLD-MAJ-CLASS              14900000
P28545*        MOVE PV-HOLD-MAJ-CLASS TO IN009-MAJ-CLASS                14910000
P28545*        MOVE MDSEAR-SUB-CL-NBR TO PV-HOLD-SUB-CLASS              14920000
P28545*        MOVE PV-HOLD-SUB-CLASS TO IN009-SUB-CLASS                14930000
P28545*        MOVE PV-UPC-SKU        TO IN009-SKU                      14940000
P28545*                                  PV-HOLD-SEQ                    14950000
P28545*        MOVE PV-WORK-UPC       TO IN009-UPC-CODE                 14960000
P28545*                                  PV-HOLD-UPC-CODE               14970000
P28545*    ELSE                                                         14980000
P28545*        SET PS-INVALID-ITEM                                      14990000
P28545*            PS-INVALID-RECORD                                    15000000
P28545*            PS-INVALID-UPC      TO TRUE                          15010000
P28545*    END-IF.                                                      15020000
P28545*                                                                 15030000
P28545*    INITIALIZE UPCPLS-UPC-STAT-CDE.                              15040000
P28545*                                                                 15050000
00755 ******************************************************************15060000
00756 *                                                                 15070000
00757 ******************************************************************15080000
00758 *D400-RECALC-CHECK-DIGIT.                                         15090000
P28545*                                                                 15100000
P28545*     MOVE PV-WORK-UPC     TO PV-TEMP-UPC-MIN                     15110000
P28545*                             PV-TEMP-UPC-MAX                     15120000
P28545*     MOVE 0     TO PV-TEMP-UPC-CHECK-DIGIT-MIN                   15130000
P28545*     MOVE 9     TO PV-TEMP-UPC-CHECK-DIGIT-MAX                   15140000
P28545*     MOVE PV-TEMP-UPC-MIN TO  PV-KOHLS-UPC-MIN-SIGNONLY          15150000
P28545*     MOVE PV-TEMP-UPC-MAX TO  PV-KOHLS-UPC-MAX-SIGNONLY          15160000
P28545*     MOVE PV-KOHLS-UPC-MIN-SIGNONLY TO PV-KOHLS-UPC-MIN          15170000
P28545*     MOVE PV-KOHLS-UPC-MAX-SIGNONLY TO PV-KOHLS-UPC-MAX          15180000
P28545*                                                                 15190000
P28545*     EXEC SQL                                                    15200000
P28545*          SELECT UPC_NBR                                         15210000
P28545*            INTO :UPC-UPC-NBR                                    15220000
P28545*            FROM TUPC                                            15230000
P28545*           WHERE (UPC_NBR      >= :PV-KOHLS-UPC-MIN              15240000
P28545*             AND  UPC_NBR      <= :PV-KOHLS-UPC-MAX)             15250000
P28545*     END-EXEC                                                    15260000
P28545*                                                                 15270000
P28545*     EVALUATE TRUE                                               15280000
P28545*         WHEN SQLCODE = 0                                        15290000
P28545*             MOVE UPC-UPC-NBR TO PV-WORK-UPC                     15300000
P28545*         WHEN SQLCODE = +100                                     15310000
P28545*                MOVE IN009-STORE-NUMBER                          15320000
P28545*                                 TO  PV-UPC-ERROR-STORE          15330000
P28545*                MOVE IN009-AREA-NUMBER                           15340000
P28545*                                 TO  PV-UPC-ERROR-AREA           15350000
P28545*                MOVE IN009-SKU                                   15360000
P28545*                                 TO  PV-UPC-ERROR-SKU            15370000
P28545*                MOVE IN010-UPC-CODE-X                            15380000
P28545*                                 TO  PV-UPC-ERROR-UPC            15390000
P28545*             PERFORM D150-WRITE-UPC-ERROR-RECORD                 15400000
P28545*         WHEN OTHER                                              15410000
P28545*             CONTINUE                                            15420000
P28545*     END-EVALUATE.                                               15430000
P28545*                                                                 15440000
P28545*E100-READ-UPC-SKU-TABLE.                                         15450000
P28545**************************************************************    15460000
P28545*  READ THE UPCSKU TABLE                                          15470000
P28545**************************************************************    15480000
P28545*    PERFORM                                                      15490000
P28545*        WITH TEST AFTER                                          15500000
P28545*        VARYING PV-RETRY-COUNT FROM 1 BY 1                       15510000
P28545*        UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  15520000
P28545*            OR (SQLCODE = 0)                                     15530000
P28545*            OR (SQLCODE = +100)                                  15540000
P28545*                                                                 15550000
P28545*        EXEC SQL                                                 15560000
P28545*            SELECT        UPC_NBR                                15570000
P28545*            ,             ITEM_NBR                               15580000
P28545*            INTO         :TUPCSKU-UPC-NBR                        15590000
P28545*            ,            :TUPCSKU-ITEM-NBR                       15600000
P28545*            FROM          TUPCSKU                                15610000
P28545*            WHERE        (UPC_NBR   =  :PV-UPC-CODE)             15620000
P28545*        END-EXEC                                                 15630000
P28545*                                                                 15640000
P28545*        EVALUATE TRUE                                            15650000
P28545*            WHEN SQLCODE = 0                                     15660000
P28545*                SET PS-UPC-FOUND TO TRUE                         15670000
P28545*            WHEN SQLCODE = -904                                  15680000
P28545*            WHEN SQLCODE = -911                                  15690000
P28545*                CONTINUE                                         15700000
P28545*            WHEN SQLCODE = +100                                  15710000
P28545*                SET PS-UPC-NOT-FOUND TO TRUE                     15720000
P28545*            WHEN OTHER                                           15730000
P28545*                MOVE 'Z650-READ-UPC-SKU-TABLE' TO                15740000
P28545*                                        PV-PARAGRAPH-NAME        15750000
P28545*                PERFORM Z900-SQL-ABEND                           15760000
P28545*        END-EVALUATE                                             15770000
P28545*    END-PERFORM.                                                 15780000
P28545*                                                                 15790000
P28545*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          15800000
P28545*        MOVE 'Z650-READ-UPC-SKU-TABLE' TO                        15810000
P28545*                                PV-PARAGRAPH-NAME                15820000
P28545*        MOVE 'MAX NUMBER OF RETRIES EXCEEDED' TO                 15830000
P28545*              PV-DB2-OPER-ATTEMPTED                              15840000
P28545*        PERFORM Z900-SQL-ABEND                                   15850000
P28545*    END-IF.                                                      15860000
P28545*                                                                 15870000
P28545*                                                                 15880000
P28545******************************************************************15890000
P28545* E200-READ-SKU-BY-ITEM                                           15900000
P28545******************************************************************15910000
P28545*E200-READ-SKU-BY-ITEM.                                           15920000
P28545*                                                                 15930000
P28545*    PERFORM                                                      15940000
P28545*        WITH TEST AFTER                                          15950000
P28545*        VARYING PV-SQL-SUB FROM 1 BY 1                           15960000
P28545*        UNTIL (PV-SQL-SUB > PC-MAX-RETRIES)                      15970000
P28545*            OR (SQLCODE = 0)                                     15980000
P28545*            OR (SQLCODE = +100)                                  15990000
P28545*                                                                 16000000
P28545*        MOVE PV-ITEM-NBR TO SKXREF-ITM-NBR                       16010000
P28545*                                                                 16020000
P28545*        EXEC SQL                                                 16030000
P28545*            SELECT  DEPT                                         16040000
P28545*                  , CLASS                                        16050000
P28545*                  , SUBCLASS                                     16060000
P28545*                  , SKU                                          16070000
P28545*              INTO  :SKXREF-DEPT                                 16080000
P28545*                  , :SKXREF-CLASS                                16090000
P28545*                  , :SKXREF-SUBCLASS                             16100000
P28545*                  , :SKXREF-SKU                                  16110000
P28545*              FROM  TSKXREF                                      16120000
P28545*             WHERE  ITM_NBR = :SKXREF-ITM-NBR                    16130000
P28545*        END-EXEC                                                 16140000
P28545*                                                                 16150000
P28545*        EVALUATE TRUE                                            16160000
P28545*            WHEN SQLCODE = 0                                     16170000
P28545*                SET PS-ITEM-FOUND TO TRUE                        16180000
P28545*            WHEN SQLCODE = -904                                  16190000
P28545*            WHEN SQLCODE = -911                                  16200000
P28545*                CONTINUE                                         16210000
P28545*            WHEN SQLCODE = +100                                  16220000
P28545*                SET PS-ITEM-NOT-FOUND TO TRUE                    16230000
P28545*            WHEN OTHER                                           16240000
P28545*                MOVE 'E200-READ-SKU-BY-ITEM' TO PV-PARAGRAPH-NAME16250000
P28545*                MOVE 'READING TSK TABLES BY ITEM'                16260000
P28545*                                   TO  PV-DB2-OPER-ATTEMPTED     16270000
P28545*                PERFORM Z900-SQL-ABEND                           16280000
P28545*        END-EVALUATE                                             16290000
P28545*    END-PERFORM.                                                 16300000
P28545*                                                                 16310000
P28545*    IF  PV-SQL-SUB > PC-MAX-RETRIES                              16320000
P28545*        MOVE 'E200-READ-SKU-BY-ITEM' TO PV-PARAGRAPH-NAME        16330000
P28545*        MOVE 'MAX RETRIES EXCEEDED'  TO PV-DB2-OPER-ATTEMPTED    16340000
P28545*        PERFORM Z900-SQL-ABEND                                   16350000
P28545*    END-IF.                                                      16360000
P28545*                                                                 16370000
00867 ******************************************************************16380000
00868 * Z100-READ-INVENTORY-FILE  READS UNEDITTED PHYSICAL COUNTS FILE  16390000
00869 ******************************************************************16400000
00870  Z100-READ-INVENTORY-FILE.                                        16410000
00871                                                                   16420000
00872      READ PHYSICAL-INVENTORY-FILE                                 16430000
00873          INTO IN010-INVENTORY-COUNT-RECORD                        16440000
00874              AT END                                               16450000
00875                  MOVE 'Y' TO PS-END-OF-INVENTORY.                 16460000
00876 *                                                                 16470000
00877 ******************************************************************16480000
00878 * RECORDS WHICH SURVIVED THE EDITS ARE WRITTEN TO THE OUTPUT FILE.16490000
00879 ******************************************************************16500000
00880  Z500-WRITE-EDITED-RECORD.                                        16510000
00881      WRITE EDITED-INVENTORY-RECORD                                16520000
00882          FROM IN009-EDITED-INVENTORY-RECORD.                      16530000
00883                                                                   16540000
00885 ******************************************************************16550000
00886 *                                                                 16560000
00887 ******************************************************************16570000
00888  Z550-WRITE-INVALID-DETAIL.                                       16580000
00889      WRITE INVALID-DETAIL-RECORD                                  16590000
00890          FROM IN008-INVENTORY-COUNT-RECORD.                       16600000
00891                                                                   16610000
00892 ******************************************************************16620000
00893 *                                                                 16630000
00894 ******************************************************************16640000
00895  Z575-WRITE-VALID-RPT-REC.                                        16650000
00896      WRITE VALID-INV-REPORT-RECORD                                16660000
00897          FROM IN014-VALID-REPORT-RECORD.                          16670000
00898                                                                   16680000
IN2001******************************************************************16690000
IN2001* EMAIL MESSAGE - ITEM NOT FOUND ON TUPCPLS FOR STR000            16700000
IN2001******************************************************************16710000
IN2001 Z580-WRITE-MISSING-ITEM.                                         16720000
IN2001*                                                                 16730000
IN2001     IF IN010-UPC-CODE NOT EQUAL ZEROES                           16740000
IN2001         MOVE IN010-UPC-CODE-X TO D1-UPC                          16750000
W21732         MOVE SKXREF-SKU             TO NI-SKU-9                  16760000
W21732         MOVE NI-SKU                 TO D1-SKU                    16770000
IN2001     ELSE                                                         16780000
W21732         MOVE IN010-SKU-X      TO D1-SKU                          16790000
IN2001         MOVE SPACES           TO D1-UPC                          16800000
IN2001     END-IF.                                                      16810000
IN2001*                                                                 16820000
IN2001     MOVE IN010-STORE-NUMBER         TO D1-STORE.                 16830000
IN2001     MOVE IN010-AREA-NUMBER-X        TO D1-AREA-NBR.              16840000
IN2001     MOVE IN010-SCAN-LINE-NUMBER-X   TO D1-LINE-NBR.              16850000
W21732     MOVE SKXREF-ITM-NBR             TO D1-ITEM-NBR.              16860000
IN2001*                                                                 16870000
IN2001     WRITE MISSING-TABLE-ENTRY-RECORD FROM D1-DETAIL-LINE         16880000
IN2001                                      BEFORE ADVANCING 1 LINE.    16890000
IN2001                                                                  16900000
P28545******************************************************************16910000
P28545* READ TUPCPLS AND GET PRICING AND STATUS FOR STORE 000.          16920000
P28545* IF STATUS = '25' THEN USE STORE-SPECIFIC PRICING (IF FOUND).    16930000
P28545* IF ANY OTHER STATUS IS FOUND, USE PRICING FROM STR000 ROW.      16940000
00902 ******************************************************************16950000
P28545*Z600-READ-TUPCPLS-TABLE.                                         16960000
P28545*                                                                 16970000
P28545*     IF TUPCSKU-PLU-DWNLD-IND = 'N'                              16980000
P28545*         SET PS-PRICE-NOT-FOUND                                  16990000
P28545*             PS-INVALID-ITEM                                     17000000
P28545*             PS-INVALID-RECORD TO TRUE                           17010000
P28545*     ELSE                                                        17020000
P28545*         PERFORM Z750-GET-CUTOFF-PRICE-STR000                    17030000
P28545*         IF PS-PRICE-FOUND                                       17040000
P28545*            IF UPCPLS-UPC-STAT-CDE = PC-RCP-STATUS               17050000
P28545*               PERFORM Z700-GET-CUTOFF-PRICE                     17060000
P28545*            END-IF                                               17070000
P28545*            IF UPCPLS-MEITGP-NBR NOT EQUAL 0                     17080000
P28545*                PERFORM Z760-CHECK-GRP-PRC                       17090000
P28545*                COMPUTE PV-GROUP-UNIT-RTL ROUNDED =              17100000
P28545*                      (MITGPL-GP-AMT /                           17110000
P28545*                       MITGPL-MITGPL-QTY )                       17120000
P28545*                MOVE PV-GROUP-UNIT-RTL TO PV-UNT-RTL-AMT         17130000
P28545*            END-IF                                               17140000
P28545*            SET PS-EMAIL-NO-MESSAGE TO TRUE                      17150000
P28545*         ELSE                                                    17160000
P28545*             SET PS-EMAIL-MESSAGE-UPCPLS TO TRUE                 17170000
P28545*             SET PS-PRICE-NOT-FOUND                              17180000
P28545*                 PS-INVALID-ITEM                                 17190000
P28545*                 PS-INVALID-RECORD TO TRUE                       17200000
P28545*         END-IF                                                  17210000
P28545*     END-IF.                                                     17220000
P28545*                                                                 17230000
P28545******************************************************************17240000
P28545* USE ITEM NUMBER RETRIEVED FROM TSK AND FIND CORRESPONDING ITEM  17250000
P28545* ON TUPCPLS. FIND INDIVIDUAL STORE 'STATUS CODE' AND 'UNIT RTL'  17260000
P28545******************************************************************17270000
P28545*Z700-GET-CUTOFF-PRICE.                                           17280000
P28545*                                                                 17290000
P28545*    MOVE SKXREF-ITM-NBR   TO UPCPLS-ITM-NBR.                     17300000
P28545*    MOVE PV-STORE-NBR     TO UPCPLS-STR-NBR.                     17310000
P28545*    MOVE PV-PLND-INV-TMST TO UPCPLS-EFF-BEG-TMST                 17320000
P28545*                             UPCPLS-EFF-END-TMST.                17330000
P28545*                                                                 17340000
P28545*    PERFORM                                                      17350000
P28545*        WITH TEST AFTER                                          17360000
P28545*        VARYING PV-SQL-SUB FROM 1 BY 1                           17370000
P28545*        UNTIL (PV-SQL-SUB > PC-MAX-RETRIES)                      17380000
P28545*            OR (SQLCODE = 0)                                     17390000
P28545*            OR (SQLCODE = +100)                                  17400000
P28545*                                                                 17410000
P28545*                                                                 17420000
P28545*        EXEC SQL                                                 17430000
P28545*             SELECT UNT_RTL_AMT                                  17440000
P28545*                   ,MEITGP_NBR                                   17450000
P28545*                   ,UPC_STAT_CDE                                 17460000
P28545*                   ,UPC_STAT_CHG_DTE                             17470000
P28545*                   ,UNT_RTL_CHG_DTE                              17480000
P28545*             INTO   :UPCPLS-UNT-RTL-AMT                          17490000
P28545*                   ,:UPCPLS-MEITGP-NBR                           17500000
P28545*                   ,:UPCPLS-UPC-STAT-CDE                         17510000
P28545*                   ,:UPCPLS-UPC-STAT-CHG-DTE                     17520000
P28545*                   ,:UPCPLS-UNT-RTL-CHG-DTE                      17530000
P28545*             FROM  TUPCPLS                                       17540000
P28545*          WHERE  ITM_NBR       = :UPCPLS-ITM-NBR                 17550000
P28545*          AND    OPERCO_NBR    =  '03'                           17560000
P28545*          AND    STR_NBR       = :UPCPLS-STR-NBR                 17570000
P28545*          AND    EFF_BEG_TMST <= :UPCPLS-EFF-BEG-TMST            17580000
P28545*          AND   (EFF_END_TMST >= :UPCPLS-EFF-END-TMST            17590000
P28545*          OR     EFF_END_TMST IS NULL)                           17600000
P28545*        END-EXEC                                                 17610000
P28545*                                                                 17620000
P28545*        EVALUATE TRUE                                            17630000
P28545*            WHEN SQLCODE = 0                                     17640000
P28545*                MOVE  UPCPLS-UNT-RTL-AMT TO PV-UNT-RTL-AMT       17650000
P28545*            WHEN SQLCODE = -904                                  17660000
P28545*            WHEN SQLCODE = -911                                  17670000
P28545*                CONTINUE                                         17680000
P28545*            WHEN SQLCODE = +100                                  17690000
P28545*               MOVE PV-STR000-UPC-STAT-CDE TO UPCPLS-UPC-STAT-CDE17700000
P28545*               MOVE PV-STR000-UNT-RTL-AMT  TO PV-UNT-RTL-AMT     17710000
P28545*               MOVE PV-STR000-MEITGP-NBR   TO UPCPLS-MEITGP-NBR  17720000
P28545*               MOVE PV-STR000-UPC-STAT-CHG-DTE TO                17730000
P28545*                                          UPCPLS-UPC-STAT-CHG-DTE17740000
P28545*               MOVE PV-STR000-UNT-RTL-CHG-DTE  TO                17750000
P28545*                                          UPCPLS-UNT-RTL-CHG-DTE 17760000
P28545*            WHEN OTHER                                           17770000
P28545*                MOVE 'Z700-GET-CUTOFF-PRICE '                    17780000
P28545*                                   TO PV-PARAGRAPH-NAME          17790000
P28545*                MOVE 'READING UPCPLS TABLE'                      17800000
P28545*                                   TO  PV-DB2-OPER-ATTEMPTED     17810000
P28545*                PERFORM Z900-SQL-ABEND                           17820000
P28545*        END-EVALUATE                                             17830000
P28545*    END-PERFORM.                                                 17840000
P28545*                                                                 17850000
P28545*    IF  PV-SQL-SUB > PC-MAX-RETRIES                              17860000
P28545*        MOVE 'Z700-GET-CUTOFF-PRICE '                            17870000
P28545*                                     TO PV-PARAGRAPH-NAME        17880000
P28545*        MOVE 'MAX RETRIES EXCEEDED'  TO PV-DB2-OPER-ATTEMPTED    17890000
P28545*        PERFORM Z900-SQL-ABEND                                   17900000
P28545*    END-IF.                                                      17910000
P28545*                                                                 17920000
P28545******************************************************************17930000
P28545* USE ITEM NUMBER RETRIEVED FROM TSK AND FIND CORRESPONDING ITEM  17940000
P28545* ON TUPCPLS. FIND INDIVIDUAL STORE 'STATUS CODE' AND 'RETAIL'    17950000
P28545******************************************************************17960000
P28545*Z750-GET-CUTOFF-PRICE-STR000.                                    17970000
P28545*                                                                 17980000
P28545*    IF SKXREF-ITM-NBR IS NUMERIC                                 17990000
P28545*       MOVE SKXREF-ITM-NBR   TO UPCPLS-ITM-NBR                   18000000
P28545*    ELSE                                                         18010000
P28545*       MOVE ZEROS            TO UPCPLS-ITM-NBR                   18020000
P28545*    END-IF.                                                      18030000
P28545*    MOVE PV-PLND-INV-TMST TO UPCPLS-EFF-BEG-TMST                 18040000
P28545*                             UPCPLS-EFF-END-TMST.                18050000
P28545*                                                                 18060000
P28545*    PERFORM                                                      18070000
P28545*        WITH TEST AFTER                                          18080000
P28545*        VARYING PV-SQL-SUB FROM 1 BY 1                           18090000
P28545*        UNTIL (PV-SQL-SUB > PC-MAX-RETRIES)                      18100000
P28545*            OR (SQLCODE = 0)                                     18110000
P28545*            OR (SQLCODE = +100)                                  18120000
P28545*                                                                 18130000
P28545*                                                                 18140000
P28545*        EXEC SQL                                                 18150000
P28545*             SELECT UNT_RTL_AMT                                  18160000
P28545*                   ,MEITGP_NBR                                   18170000
P28545*                   ,UPC_STAT_CDE                                 18180000
P28545*                   ,UPC_STAT_CHG_DTE                             18190000
P28545*                   ,UNT_RTL_CHG_DTE                              18200000
P28545*             INTO   :UPCPLS-UNT-RTL-AMT                          18210000
P28545*                   ,:UPCPLS-MEITGP-NBR                           18220000
P28545*                   ,:UPCPLS-UPC-STAT-CDE                         18230000
P28545*                   ,:UPCPLS-UPC-STAT-CHG-DTE                     18240000
P28545*                   ,:UPCPLS-UNT-RTL-CHG-DTE                      18250000
P28545*             FROM  TUPCPLS                                       18260000
P28545*          WHERE  ITM_NBR       = :UPCPLS-ITM-NBR                 18270000
P28545*          AND    OPERCO_NBR    =  '03'                           18280000
P28545*          AND    STR_NBR       =  000                            18290000
P28545*          AND    EFF_BEG_TMST <= :UPCPLS-EFF-BEG-TMST            18300000
P28545*          AND   (EFF_END_TMST >= :UPCPLS-EFF-END-TMST            18310000
P28545*          OR     EFF_END_TMST IS NULL)                           18320000
P28545*        END-EXEC                                                 18330000
P28545*                                                                 18340000
P28545*        EVALUATE TRUE                                            18350000
P28545*            WHEN SQLCODE = 0                                     18360000
P28545*               SET PS-PRICE-FOUND TO TRUE                        18370000
P28545*               MOVE UPCPLS-UNT-RTL-AMT  TO PV-UNT-RTL-AMT        18380000
P28545*               MOVE UPCPLS-UPC-STAT-CDE TO PV-STR000-UPC-STAT-CDE18390000
P28545*               MOVE PV-UNT-RTL-AMT      TO PV-STR000-UNT-RTL-AMT 18400000
P28545*               MOVE UPCPLS-MEITGP-NBR   TO PV-STR000-MEITGP-NBR  18410000
P28545*               MOVE UPCPLS-UPC-STAT-CHG-DTE TO                   18420000
P28545*                                       PV-STR000-UPC-STAT-CHG-DTE18430000
P28545*               MOVE UPCPLS-UNT-RTL-CHG-DTE  TO                   18440000
P28545*                                       PV-STR000-UNT-RTL-CHG-DTE 18450000
P28545*            WHEN SQLCODE = -904                                  18460000
P28545*            WHEN SQLCODE = -911                                  18470000
P28545*               CONTINUE                                          18480000
P28545*            WHEN SQLCODE = +100                                  18490000
P28545*               SET PS-PRICE-NOT-FOUND TO TRUE                    18500000
P28545*            WHEN OTHER                                           18510000
P28545*               MOVE 'Z750-GET-CUTOFF-PRICE-STR000'               18520000
P28545*                                   TO PV-PARAGRAPH-NAME          18530000
P28545*               MOVE 'READING UPCPLS TABLE'                       18540000
P28545*                                   TO  PV-DB2-OPER-ATTEMPTED     18550000
P28545*               DISPLAY 'ITEM: ', UPCPLS-ITM-NBR                  18560000
P28545*               DISPLAY 'INV STORE: ', PV-STORE-NBR               18570000
P28545*               DISPLAY 'PLANNED INV DATE TIMESTAMP: ',           18580000
P28545*                               PV-PLND-INV-TMST                  18590000
P28545*               PERFORM Z900-SQL-ABEND                            18600000
P28545*        END-EVALUATE                                             18610000
P28545*    END-PERFORM.                                                 18620000
P28545*                                                                 18630000
P28545*    IF  PV-SQL-SUB > PC-MAX-RETRIES                              18640000
P28545*        MOVE 'Z750-GET-CUTOFF-PRICE-STR000'                      18650000
P28545*                                     TO PV-PARAGRAPH-NAME        18660000
P28545*        MOVE 'MAX RETRIES EXCEEDED'  TO PV-DB2-OPER-ATTEMPTED    18670000
P28545*        DISPLAY 'ITEM: ', UPCPLS-ITM-NBR                         18680000
P28545*        DISPLAY 'INV STORE: ', PV-STORE-NBR                      18690000
P28545*        DISPLAY 'PLANNED INV DATE TIMESTAMP: ', PV-PLND-INV-TMST 18700000
P28545*        PERFORM Z900-SQL-ABEND                                   18710000
P28545*    END-IF.                                                      18720000
P28545*                                                                 18730000
P28545******************************************************************18740000
P28545* USE ITEM NUMBER RETRIEVED FROM TSK AND FIND CORRESPONDING ITEM  18750000
P28545* ON TSKST. FIND INDIVIDUAL STORE 'STATUS CODE' AND 'CUTOFF PRICE'18760000
P28545******************************************************************18770000
P28545*Z760-CHECK-GRP-PRC.                                              18780000
P28545*                                                                 18790000
P28545*    EXEC SQL                                                     18800000
P28545*        SELECT  MITGPL_QTY                                       18810000
P28545*               ,GP_AMT                                           18820000
P28545*        INTO    :MITGPL-MITGPL-QTY                               18830000
P28545*               ,:MITGPL-GP-AMT                                   18840000
P28545*        FROM   TMITGPL                                           18850000
P28545*        WHERE  OPERCO_NBR    = '03'                              18860000
P28545*          AND  MEITGP_NBR    = :UPCPLS-MEITGP-NBR                18870000
P28545*          AND  ADLOC_ID      = '   '                             18880000
P28545*          AND  (CURRENT DATE BETWEEN                             18890000
P28545*                BEG_DTE AND END_DTE)                             18900000
P28545*    END-EXEC.                                                    18910000
P28545*                                                                 18920000
P28545*    EVALUATE TRUE                                                18930000
P28545*        WHEN SQLCODE = ZERO                                      18940000
P28545*        WHEN SQLCODE = +100                                      18950000
P28545*            CONTINUE                                             18960000
P28545*        WHEN SQLCODE = -904                                      18970000
P28545*        WHEN SQLCODE = -913                                      18980000
P28545*        WHEN SQLWARN0 NOT = SPACES                               18990000
P28545*        WHEN SQLCODE  NOT = ZERO                                 19000000
P28545*            DISPLAY 'INKUT102 - UPCPLS-MEITGRP-NBR '             19010000
P28545*               UPCPLS-MEITGP-NBR                                 19020000
P28545*            MOVE 'Z760-CHECK-GRP-PRC'                            19030000
P28545*                               TO PV-PARAGRAPH-NAME              19040000
P28545*            MOVE 'GET GROUP PRICING'                             19050000
P28545*                               TO  PV-DB2-OPER-ATTEMPTED         19060000
P28545*            PERFORM Z900-SQL-ABEND                               19070000
P28545*    END-EVALUATE.                                                19080000
P28545*                                                                 19090000
P28545******************************************************************19100000
P28545* Z800-READ-MBS.                                                  19110000
P28545******************************************************************19120000
P28545*Z800-READ-MBS.                                                   19130000
P28545*                                                                 19140000
P28545*    PERFORM                                                      19150000
P28545*        WITH TEST AFTER                                          19160000
P28545*        VARYING PV-RETRY-COUNT FROM 1 BY 1                       19170000
P28545*        UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  19180000
P28545*            OR (SQLCODE = 0)                                     19190000
P28545*            OR (SQLCODE = +100)                                  19200000
P28545*                                                                 19210000
P28545*        MOVE PC-OPERCO-NBR TO MDSEAR-OPERCO-NBR                  19220000
P28545*        MOVE PC-MDSELV-CDE TO MDSEAR-MDSELV-CDE                  19230000
P28545*        MOVE PC-APLSYS-CDE TO APLAVL-APLSYS-CDE                  19240000
P28545*                                                                 19250000
P28545*        EXEC SQL                                                 19260000
P28545*             SELECT GMA_NBR,                                     19270000
P28545*                    DMA_NBR,                                     19280000
P28545*                    MDSEAR_DESC,                                 19290000
P28545*                    BYR_NBR                                      19300000
P28545*             INTO   :MDSEAR-GMA-NBR,                             19310000
P28545*                    :MDSEAR-DMA-NBR,                             19320000
P28545*                    :MDSEAR-DESC,                                19330000
P28545*                    :MDSEAR-BYR-NBR                              19340000
P28545*             FROM   TMDSEAR A,                                   19350000
P28545*                    TAPLAVL B                                    19360000
P28545*             WHERE  (A.OPERCO_NBR  = :MDSEAR-OPERCO-NBR)   AND   19370000
P28545*                    (A.DEPT_NBR    = :MDSEAR-DEPT-NBR)     AND   19380000
P28545*                    (A.MAJ_CL_NBR  = :MDSEAR-MAJ-CL-NBR)   AND   19390000
P28545*                    (A.SUB_CL_NBR  = :MDSEAR-SUB-CL-NBR)   AND   19400000
P28545*                    (A.MDSEAR_DKEY = B.MDSEAR_DKEY)        AND   19410000
P28545*                    (MDSELV_CDE    = :MDSEAR-MDSELV-CDE)   AND   19420000
P28545*                    (APLSYS_CDE    = :APLAVL-APLSYS-CDE)   AND   19430000
P28545*                    (DATE (CURRENT TIMESTAMP) BETWEEN            19440000
P28545*                                     STRT_DTE AND END_DTE) AND   19450000
P28545*                    (DATE (CURRENT TIMESTAMP) BETWEEN            19460000
P28545*                      MDSEAR_STRT_DTE AND MDSEAR_END_DTE)        19470000
P28545*                                                                 19480000
P28545*        END-EXEC                                                 19490000
P28545*                                                                 19500000
P28545*        EVALUATE TRUE                                            19510000
P28545*            WHEN SQLCODE = 0                                     19520000
P28545*                SET PS-VALID-DEPT-CLASS TO TRUE                  19530000
P28545*            WHEN SQLCODE = +100                                  19540000
P28545*                SET PS-INVALID-DEPT-CLASS TO TRUE                19550000
P28545*            WHEN SQLCODE = -904                                  19560000
P28545*            WHEN SQLCODE = -911                                  19570000
P28545*                CONTINUE                                         19580000
P28545*            WHEN OTHER                                           19590000
P28545*                MOVE 'Z800-READ-MBS' TO PV-PARAGRAPH-NAME        19600000
P28545*                PERFORM Z900-SQL-ABEND                           19610000
P28545*        END-EVALUATE                                             19620000
P28545*                                                                 19630000
P28545*    END-PERFORM.                                                 19640000
P28545*                                                                 19650000
P28545*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          19660000
P28545*        MOVE 'Z800-READ-MBS' TO PV-PARAGRAPH-NAME                19670000
P28545*        MOVE 'EXCEEDED MAX NUMBER OF RETRIES'                    19680000
P28545*                       TO PV-DB2-OPER-ATTEMPTED                  19690000
P28545*        PERFORM Z900-SQL-ABEND                                   19700000
P28545*    END-IF.                                                      19710000
P28545*                                                                 19720000
P28545*Z850-READ-SKU-TABLE.                                             19730000
P28545*******************************************************           19740000
P28545*  READ THE SKU TABLE RECORDS                                     19750000
P28545*******************************************************           19760000
P28545*                                                                 19770000
P28545*    PERFORM                                                      19780000
P28545*        WITH TEST AFTER                                          19790000
P28545*        VARYING PV-RETRY-COUNT FROM 1 BY 1                       19800000
P28545*        UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  19810000
P28545*            OR (SQLCODE = 0)                                     19820000
P28545*            OR (SQLCODE = +100)                                  19830000
P28545*                                                                 19840000
P28545*                                                                 19850000
P28545*        EXEC SQL                                                 19860000
P28545*               SELECT ITM_NBR                                    19870000
P28545*                    , DEPT                                       19880000
P28545*                    , CLASS                                      19890000
P28545*                    , SUBCLASS                                   19900000
P28545*                    , SKU                                        19910000
P28545*                 INTO :SKXREF-ITM-NBR                            19920000
P28545*                    , :SKXREF-DEPT                               19930000
P28545*                    , :SKXREF-CLASS                              19940000
P28545*                    , :SKXREF-SUBCLASS                           19950000
P28545*                    , :SKXREF-SKU                                19960000
P28545*                 FROM TSKXREF                                    19970000
P28545*                WHERE SKU = :SKXREF-SKU                          19980000
P28545*        END-EXEC                                                 19990000
P28545*                                                                 20000000
P28545*                                                                 20010000
P28545*        EVALUATE TRUE                                            20020000
P28545*            WHEN SQLCODE = 0                                     20030000
P28545*                SET PS-VALID-SKU TO TRUE                         20040000
P28545*            WHEN SQLCODE = -904                                  20050000
P28545*            WHEN SQLCODE = -911                                  20060000
P28545*            WHEN SQLCODE = +100                                  20070000
P28545*                SET PS-INVALID-SKU TO TRUE                       20080000
P28545*            WHEN OTHER                                           20090000
P28545*                DISPLAY 'SKU NUMBER :', SKXREF-SKU               20100000
P28545*                MOVE 'Z850-READ-SKU-TABLE' TO                    20110000
P28545*                                        PV-PARAGRAPH-NAME        20120000
P28545*                MOVE 'ERROR READING SKU TABLE' TO                20130000
P28545*                                        PV-DB2-OPER-ATTEMPTED    20140000
P28545*                PERFORM Z900-SQL-ABEND                           20150000
P28545*        END-EVALUATE                                             20160000
P28545*    END-PERFORM.                                                 20170000
P28545*                                                                 20180000
P28545*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          20190000
P28545*         MOVE 'Z850-READ-SKU-TABLE' TO  PV-PARAGRAPH-NAME        20200000
P28545*         MOVE 'EXCEEDED MAX RETRIES' TO PV-DB2-OPER-ATTEMPTED    20210000
P28545*         PERFORM Z900-SQL-ABEND                                  20220000
P28545*    END-IF.                                                      20230000
P28545*                                                                 20240000
080500******************************************************************20250000
080600* Z875-SELECT-TINVPAR                                             20260000
080800******************************************************************20270000
080900 Z875-SELECT-TINVPAR.                                             20280000
081000*                                                                 20290000
081100     EXEC SQL                                                     20300000
081200         SELECT MAX(PLND_INV_DTE)                                 20310000
081400         INTO :INVPAR-PLND-INV-DTE                                20320000
P28545         FROM TINVPAR A,                                          20330000
P28545              TINCNTL B                                           20340000
P28545         WHERE B.ACTV_IND = 'Y'                                   20350000
P28545           AND B.INV_ID = A.INV_ID                                20360000
P28545           AND LOC_NBR = :PV-STORE-NBR                            20370000
W33304           AND A.LOC_INV_STAT_CDE = 'IN'                          20371000
W33304           AND A.ACTL_FIN_BK_DTE = '9999-09-09'                   20372001
P28545         WITH UR                                                  20380000
074600      END-EXEC.                                                   20390000
                                                                        20400000
148800     EVALUATE TRUE                                                20410000
148900         WHEN SQLCODE = ZERO                                      20420000
149000             MOVE IN010-STORE-NUMBER  TO PV-STR-NBR               20430000
                   MOVE INVPAR-PLND-INV-DTE TO PV-PLND-INV-DTE          20440000
                   MOVE PV-TMST             TO PV-PLND-INV-TMST         20450000
149100         WHEN OTHER                                               20460000
149300             MOVE    'Z875-SELECT-TINVPAR'                        20470000
149400                                          TO PV-PARAGRAPH-NAME    20480000
149700             PERFORM Z900-SQL-ABEND                               20490000
149800     END-EVALUATE.                                                20500000
149900                                                                  20510000
077300*                                                                 20520000
01059 ******************************************************************20530000
01060 *  STANDARD DB2 ERROR ABEND ROUTINE                               20540000
01061 *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             20550000
01062 ******************************************************************20560000
01063  Z900-SQL-ABEND.                                                  20570000
01064                                                                   20580000
01065      MOVE +4013                 TO ABEND-CODE.                    20590000
01066      DISPLAY '**  ABEND     **'.                                  20600000
01067      DISPLAY '**  PROGRAM   **  =  INKUT102'.                     20610000
01068      DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            20620000
01069      DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        20630000
01070                                                                   20640000
01071 *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         20650000
01072 *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        20660000
01073                                                                   20670000
01074      COPY DPPD004.                                                20680000
01075                                                                   20690000
01076      CALL 'ILBOABN0'  USING ABEND-CODE.                           20700000
P28545                                                                  20710000
P28545******************************************************************20720000
P28545*  PRICING MODULE.                                                20730000
P28545******************************************************************20740000
P28545     COPY INPD400.                                                20750000
P28545                                                                  20760000
