000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID. TRKUP205.                                            00050099
000600 AUTHOR.     ALICE EBERT * MARGARET MORRISON * THERESE RAMSEYER.  00060099
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070099
000800 DATE-WRITTEN. MAY 1998.                                          00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*                         TRKUP205                               *00120099
001300*                                                                *00130099
001400* THE PRIMARY FUNCTION OF THIS PROGRAM IS TO PROCESS EDITED DATA *00140099
001500* RECEIVED FROM PROGRAM TRKUT200. KOHL'S RECEIVES SEVERAL        *00150099
001600* PROPRIETARY FILES THROUGH EDI. JOB DSK005 SEPARATES THE FILES  *00160099
001700* AND CREATES INDIVIDUAL DATA SETS. PROGRAM TRKUT200 EDITS ONE   *00170099
001800* OF THESE DATA SETS (BOOKING DATA FROM THE CONSOLIDATOR) AND    *00180099
001900* PASSES ADDS, DELETES AND CHANGES TO AN EXTRACT FILE WHICH IS   *00190099
002000* THEN PROCESSED BY THIS PROGRAM. PROGRAM TRKUP205 WILL UPDATE   *00200099
002100* (ADD, CHANGE, DELETE) AND LOAD THE BOOKING DB2 TABLES WHICH    *00210099
002200* CONTAIN DATA FROM THE CONSOLIDATOR. THIS DATA INCLUDES AN      *00220099
002300* ESTIMATE OF WHEN AND WHAT FREIGHT WILL BE DROPPED OFF AT THE   *00230099
002400* OVERSEAS CONSOLIDATOR OR SHIPPING DOCK, AND WHEN AND FROM      *00240099
002500* WHERE THE FREIGHT WILL BE SHIPPED. THE PROGRAM ALSO CREATES AN *00250099
002600* ERROR AND DETAIL REPORT EXTRACT TABLE (TOUTTR6). REPORT PROGRAM*00260099
002700* TRKRP201 WILL GENERATE AN ERROR REPORT WITH (E)-ERROR RECORDS  *00270099
002800* AND REPORT PROGRAM TRKRP202 WILL GENERATE A DETAIL REPORT WITH *00280099
002900* (D)-DETAIL RECORDS FROM THE WORK TABLE CREATED BY TRKUP205     *00290099
003000* AND ERROR FILE CREATED BY TRKUT200 (THE HEADING LINES ARE      *00300099
003100* CREATED AND STORED ON THE ERROR FILE FOR THE DETAIL REPORT)    *00310099
003200* THIS PROGRAM STILL DOES SOME EDITING, INCLUDING THREE FIELD    *00320099
003300* EDITS:                                                         *00330099
003400*                                                                *00340099
003500*  -- FOB CODE -- ACTIVE, AIR/OCEAN  ON TIMFOB                   *00350099
003600*  -- POE CODE -- ACTIVE, AIR/OCEAN  ON TIMPOE                   *00360099
003700*  -- CNTRY CODE -- VALID (ACTIVE) COUNTRY ON TIMCNTRY           *00370099
003800*                                                                *00380099
003900*  ALL EDITS PRODUCE ERROR-TYPE MESSAGES: 'ERR' OR 'WRN'.        *00390099
004000*  -- 'ERR' -- MEANS THE ADD, DELETE OR CHANGE WAS NOT PROCESSED *00400099
004100*  -- 'WRN' -- MEANS THE ADD, DELETE OR CHANGE WAS PROCESSED AND *00410099
004200*              IS AN INFORMATIONAL MESSAGE.                      *00420099
004300*                                                                *00430099
004400* TRANSACTION TYPES:                                             *00440099
004500* BEFORE ANY PROCESSING IS DONE ON ANY TRANSACTION TYPES, A      *00450099
004600* SELECT IS DONE ON THE APPROPRIATE TABLE TO MAKE SURE A         *00460099
004700* PO, VS OR UPC EXISTS. BECAUSE THERE ARE FUTURE PLANS FOR CICS  *00470099
004800* PROGRAMS THAT CAN ADD, DELETE OR UPDATE THE TABLES, THE SELECT *00480099
004900* ENSURES THAT AN ADD, DELETE OR UPDATE HAS NOT TAKEN PLACE IN   *00490099
005000* THE TIME BETWEEN THE RUNNING OF TRKUT200 AND TRKUP205.         *00500099
005100*                                                                *00510099
005200*                                                                *00520099
005300* THIS PROGRAM USES CHECKPOINT RESTART.                          *00530099
005400*                                                                *00540099
005500******************************************************************00550099
005501* 10/31/03  TKMA643                                               00560099
005502*              CHANGED TO GET IMPRT VENDOR NAME AND IMPRT FCTRY   00570099
005503*              NAME FROM 'TENTNME' INSTEAD OF 'TPURCHS'.          00580099
005501* 08/15/22  JEAN KURK                      CHG0272895             00581099
005502*              REMOVE TABLES TIMBKVS, TIMBKUP, TAUBKVS, TAUBKUP,  00582099
005502*                            TENTNME, XLT_SKU, XLT_VND_STYL       00583099
005600******************************************************************00590099
005700 ENVIRONMENT DIVISION.                                            00600099
005800******************************************************************00610099
005900                                                                  00620099
006000 CONFIGURATION SECTION.                                           00630099
006100                                                                  00640099
006200 SOURCE-COMPUTER.        IBM-3090.                                00650099
006300 OBJECT-COMPUTER.        IBM-3090.                                00660099
006400                                                                  00670099
006500 INPUT-OUTPUT SECTION.                                            00680099
006600                                                                  00690099
006700 FILE-CONTROL.                                                    00700099
006800                                                                  00710099
006900     SELECT TR024-BOOKING-FILE                                    00720099
007000         ASSIGN TO INP01.                                         00730099
007100                                                                  00740099
007200******************************************************************00750099
007300 DATA DIVISION.                                                   00760099
007400******************************************************************00770099
007500                                                                  00780099
007600 FILE SECTION.                                                    00790099
007700                                                                  00800099
007800 FD  TR024-BOOKING-FILE                                           00810099
007900     RECORDING MODE IS F                                          00820099
008000     LABEL RECORDS ARE STANDARD                                   00830099
008100     BLOCK CONTAINS 0 RECORDS.                                    00840099
008200                                                                  00850099
008300 01  TR024-BOOKING-RECORD            PIC X(300).                  00860099
008400                                                                  00870099
008500******************************************************************00880099
008600 WORKING-STORAGE SECTION.                                         00890099
008700******************************************************************00900099
008800                                                                  00910099
008900******************************************************************00920099
009000*  DB2 FORMATTED MESSAGE AREA                                     00930099
009100******************************************************************00940099
009200     COPY DPWS004.                                                00950099
009300                                                                  00960099
009400******************************************************************00970099
009500*  COMMUNICATIONS AREA FOR DB2                                    00980099
009600******************************************************************00990099
009700     EXEC SQL                                                     01000099
009800          INCLUDE SQLCA                                           01010099
009900     END-EXEC.                                                    01020099
010000                                                                  01030099
010001******************************************************************01040099
010002*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN ITEM TABLE            01050099
010003*      (XLT00003)                                                 01060099
010004******************************************************************01070099
010005*    EXEC SQL                                                     01080099
010006*         INCLUDE XLT00003                                        01090099
010007*    END-EXEC.                                                    01100099
010008                                                                  01110099
010009******************************************************************01120099
010010*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN ITEM TABLE            01130099
010011*      (XLT00004)                                                 01140099
010012******************************************************************01150099
010013*    EXEC SQL                                                     01160099
010014*         INCLUDE XLT00004                                        01170099
010015*    END-EXEC.                                                    01180099
010016                                                                  01190099
010100******************************************************************01200099
010200*  DB2 TABLE DECLARATION - IMPORT PURCHASE ORDER BOOKING ORIGIN   01210099
010300*                          TABLE.                                 01220099
010400*      (TIMBKPO)                                                  01230099
010500******************************************************************01240099
010600     EXEC SQL                                                     01250099
010700          INCLUDE TIMBKPO                                         01260099
010800     END-EXEC.                                                    01270099
010900                                                                  01280099
011000******************************************************************01290099
011100*  DB2 TABLE DECLARATION - IMPORT VENDOR STYLE BOOKING ORIGIN     01300099
011200*                          TABLE.                                 01310099
011300*      (TIMBKVS)                                                  01320099
011400******************************************************************01330099
011500*    EXEC SQL                                                     01340099
011600*         INCLUDE TIMBKVS                                         01350099
011700*    END-EXEC.                                                    01360099
011800                                                                  01370099
011900******************************************************************01380099
012000*  DB2 TABLE DECLARATION - IMPORT UPC BOOKING ORIGIN TABLE.       01390099
012100*      (TIMBKUP)                                                  01400099
012200******************************************************************01410099
012300*    EXEC SQL                                                     01420099
012400*         INCLUDE TIMBKUP                                         01430099
012500*    END-EXEC.                                                    01440099
012600                                                                  01450099
012700******************************************************************01460099
012800*  DB2 TABLE DECLARATION - IMPORT PURCHASE ORDER BOOKING ORIGIN   01470099
012900*                          AUDIT TABLE.                           01480099
013000*      (TAUBKPO)                                                  01490099
013100******************************************************************01500099
013200     EXEC SQL                                                     01510099
013300          INCLUDE TAUBKPO                                         01520099
013400     END-EXEC.                                                    01530099
013500                                                                  01540099
013600******************************************************************01550099
013700*  DB2 TABLE DECLARATION - IMPORT VENDOR STYLE BOOKING ORIGIN     01560099
013800*                          AUDIT TABLE.                           01570099
013900*      (TAUBKVS)                                                  01580099
014000******************************************************************01590099
014100*    EXEC SQL                                                     01600099
014200*         INCLUDE TAUBKVS                                         01610099
014300*    END-EXEC.                                                    01620099
014400                                                                  01630099
014500******************************************************************01640099
014600*  DB2 TABLE DECLARATION - IMPORT UPC BOOKING ORIGIN AUDIT TABLE. 01650099
014700*      (TAUBKUP)                                                  01660099
014800******************************************************************01670099
014900*    EXEC SQL                                                     01680099
015000*         INCLUDE TAUBKUP                                         01690099
015100*    END-EXEC.                                                    01700099
015200                                                                  01710099
015300******************************************************************01720099
015400*  DB2 TABLE DECLARATION - PURCHASE ORDER TABLE.                  01730099
015500*      (TPURCHS)                                                  01740099
015600******************************************************************01750099
015700     EXEC SQL                                                     01760099
015800          INCLUDE TPURCHS                                         01770099
015900     END-EXEC.                                                    01780099
016000                                                                  01790099
016100******************************************************************01800099
016200*  DB2 TABLE DECLARATION - PURCHASE ORDER LINE TABLE.             01810099
016300*      (TPURITM)                                                  01820099
016400******************************************************************01830099
016500*    EXEC SQL                                                     01840099
016600*         INCLUDE TPURITM                                         01850099
016700*    END-EXEC.                                                    01860099
016800                                                                  01870099
016900******************************************************************01880099
017000*  DB2 TABLE DECLARATION - IMPORT PORT OF ENTRY TABLE.            01890099
017100*      (TIMPOE)                                                   01900099
017200******************************************************************01910099
017300     EXEC SQL                                                     01920099
017400          INCLUDE TIMPOE                                          01930099
017500     END-EXEC.                                                    01940099
017600                                                                  01950099
017700******************************************************************01960099
017800*  DB2 TABLE DECLARATION - IMPORT FREE ON BOARD TABLE.            01970099
017900*      (TIMFOB)                                                   01980099
018000******************************************************************01990099
018100     EXEC SQL                                                     02000099
018200          INCLUDE TIMFOB                                          02010099
018300     END-EXEC.                                                    02020099
018400                                                                  02030099
018500******************************************************************02040099
018600*  DB2 TABLE DECLARATION - COUNTRY TABLE.                         02050099
018700*      (TCNTRY)                                                   02060099
018800******************************************************************02070099
018900*    EXEC SQL                                                     02080099
019000*         INCLUDE TCNTRY                                          02090099
019100*    END-EXEC.                                                    02100099
019200                                                                  02110099
019300******************************************************************02120099
019400*  DB2 TABLE DECLARATION - UPC SKU TABLE.                         02130099
019500*      (TUPCSKU)                                                  02140099
019600******************************************************************02150099
019700*    EXEC SQL                                                     02160099
019800*         INCLUDE TUPCSKU                                         02170099
019900*    END-EXEC.                                                    02180099
020000                                                                  02190099
020100******************************************************************02200099
020200*  DB2 TABLE DECLARATION - DETAIL AND ERROR REPORT WORK TABLE.    02210099
020300*      (TOUTTR6)                                                  02220099
020400******************************************************************02230099
020500     EXEC SQL                                                     02240099
020600          INCLUDE TOUTTR6                                         02250099
020700     END-EXEC.                                                    02260099
020800                                                                  02270099
020801******************************************************************02280099
020802*  DB2 TABLE DECLARATION - TRUOBLE NOTIFICATION WORK TABLE.       02290099
020803*      (TOUTTM1)                                                  02300099
020804******************************************************************02310099
020805     EXEC SQL                                                     02320099
020806          INCLUDE TOUTTM1                                         02330099
020807     END-EXEC.                                                    02340099
020808                                                                  02350099
020809******************************************************************02360099
020810*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE NAME.              02370099
020811*      (TENTNME)                                                  02380099
020812******************************************************************02390099
020813*    EXEC SQL                                                     02400099
020814*         INCLUDE TENTNME                                         02410099
020815*    END-EXEC.                                                    02420099
020816                                                                  02430099
020900******************************************************************02440099
021000*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)02450099
021100*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT     02460099
021200*  INTERVALS.                                                     02470099
021300******************************************************************02480099
021400     EXEC SQL                                                     02490099
021500         INCLUDE TCKRSTCN                                         02500099
021600     END-EXEC.                                                    02510099
021700                                                                  02520099
021800******************************************************************02530099
021900*  DB2 TABLE DECLARATION - CHECKPOINT RESTART         (TCKRSTINF) 02540099
022000*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT     02550099
022100*  INTERVALS.                                                     02560099
022200******************************************************************02570099
022300     EXEC SQL                                                     02580099
022400         INCLUDE TCKRSTIN                                         02590099
022500     END-EXEC.                                                    02600099
022600                                                                  02610099
022700******************************************************************02620099
022800*    IMPORT ORIGIN BOOKING RECORD LAYOUT.                         02630099
022900******************************************************************02640099
023000     COPY TRRD024.                                                02650099
023100 EJECT                                                            02660099
023200                                                                  02670099
023300******************************************************************02680099
023400*        ORIGIN BOOKING DETAIL/ERROR REPORT RECORD LAYOUT        *02690099
023500*            (EXTRACT FOR THE DETAIL AND ERROR REPORTS)          *02700099
023600*  IT IS USED TO FORMAT THE DETAIL AND ERROR RECORDS. THEY ARE   *02710099
023700*  THEN INSERTED TO TOUTTR6, A DB2 WORK TABLE.                   *02720099
023800*  LATER IT IS USED IN OTHER PROGRAMS TO CREATE A DETAIL REPORT  *02730099
023900*  AND AN ERROR REPORT OF BOOKING RECORDS.                       *02740099
024000******************************************************************02750099
024100     COPY TRRD201.                                                02760099
024200 EJECT                                                            02770099
024300                                                                  02780099
024400******************************************************************02790099
024500* COPYBOOK FOR TOUTTM1 WORK TABLE - TROUBLE NOTIFICATION EXTRACT  02800099
024600******************************************************************02810099
024700     COPY TMRD606.                                                02820099
024701 EJECT                                                            02830099
024702***************************************************************** 02840099
024703*    SUPPLY CHAIN MANAGEMENT MQ MESSAGE RECORD                    02850099
024704***************************************************************** 02860099
024705     COPY TRRD405.                                                02870099
024706 EJECT                                                            02880099
024707 01  WORK-AREA-TIMBKPO.                                           02890099
024708      10 W-IMBKPO-PO-NBR              PIC  S9(9) COMP.            02900099
024709      10 W-IMBKPO-PO-BKG-SEQ-NBR      PIC  S9(4) COMP.            02910099
024710      10 W-IMBKPO-PO-BKG-DELY-TMST    PIC  X(26).                 02920099
024720      10 FILLER      REDEFINES W-IMBKPO-PO-BKG-DELY-TMST.         02930099
024730         15 W-IMBKPO-PO-BKG-DELY-DTE     PIC   X(10).             02940099
024740         15 FILLER                       PIC   X(16).             02950099
024750      10 W-IMBKPO-EXTL-REF-NBR        PIC   X(15).                02960099
024760      10 W-IMBKPO-ORGN-SHPD-FR-CDE    PIC   X(3).                 02970099
024770******************************************************************02980099
024780*  DB2 TABLE DECLARATION - SCM MQ SERIES MSG WORK TABLE           02990099
024790*      (TRTW_BKG_CKPR)                                            03000099
024800******************************************************************03010099
024900     EXEC SQL                                                     03020099
025000          INCLUDE TRT00038                                        03030099
025100     END-EXEC.                                                    03040099
025101 EJECT                                                            03050099
025102                                                                  03060099
025103     COPY DPWS500.                                                03070099
025104 EJECT                                                            03080099
025105                                                                  03090099
025106 01  ABEND-CODE                      PIC S9(04)    VALUE +0       03100099
025107                                                   COMP SYNC.     03110099
025108 01  PA-PROGRAM-ACCUMULATORS.                                     03120099
025109     05  PA-TOTALS.                                               03130099
025110         10 PA-TOTAL-COMMITS          PIC  S9(13)  VALUE +0       03140099
025200                                                     COMP-3.      03150099
025300         10 PA-TOTAL-ISA-RECS-READ    PIC  S9(13)  VALUE +0       03160099
025400                                                     COMP-3.      03170099
025500         10 PA-TOTAL-RECS-LOADED      PIC  S9(13)  VALUE +0       03180099
025600                                                     COMP-3.      03190099
025700         10 PA-TOT-EDD-RECS-READ      PIC  S9(13)  VALUE +0       03200099
025800                                                     COMP-3.      03210099
025900         10 PA-TOT-EDDRSN-RECS-READ   PIC  S9(13)  VALUE +0       03220099
026000                                                     COMP-3.      03230099
026100         10 PA-TOT-EDL-RECS-READ      PIC  S9(13)  VALUE +0       03240099
026200                                                     COMP-3.      03250099
026300         10 PA-TOT-EDLVS-RECS-READ    PIC  S9(13)  VALUE +0       03260099
026400                                                     COMP-3.      03270099
026500         10 PA-TOT-EDLUPC-RECS-READ   PIC  S9(13)  VALUE +0       03280099
026600                                                     COMP-3.      03290099
026700         10 PA-TOT-BAD-REC-TYP        PIC  S9(13)  VALUE +0       03300099
026800                                                     COMP-3.      03310099
026900         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0       03320099
027000                                                     COMP-3.      03330099
027100         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0       03340099
027200                                                     COMP-3.      03350099
027300         10 PA-TOT-TRN-TYP-A          PIC  S9(13)  VALUE +0       03360099
027400                                                     COMP-3.      03370099
027500         10 PA-TOT-TRN-TYP-B          PIC  S9(13)  VALUE +0       03380099
027600                                                     COMP-3.      03390099
027700         10 PA-TOT-TRN-TYP-C          PIC  S9(13)  VALUE +0       03400099
027800                                                     COMP-3.      03410099
027900         10 PA-TOT-TRN-TYP-D          PIC  S9(13)  VALUE +0       03420099
028000                                                     COMP-3.      03430099
028100         10 PA-TOT-BAD-TRN-TYP        PIC  S9(13)  VALUE +0       03440099
028200                                                     COMP-3.      03450099
028300         10 PA-TOT-RECS-INSERTED      PIC  S9(13)  VALUE +0       03460099
028400                                                     COMP-3.      03470099
028500         10 PA-TOT-BKPO-INSERTS       PIC  S9(13)  VALUE +0       03480099
028600                                                     COMP-3.      03490099
028601         10 PA-TOT-TOUTTM1-INSERTS    PIC  S9(13)  VALUE +0       03500099
028602                                                     COMP-3.      03510099
028700*        10 PA-TOT-BKVS-INSERTS       PIC  S9(13)  VALUE +0       03520099
028800*                                                    COMP-3.      03530099
028900*        10 PA-TOT-BKUPC-INSERTS      PIC  S9(13)  VALUE +0       03540099
029000*                                                    COMP-3.      03550099
029100         10 PA-TOT-RECS-AUDITED       PIC  S9(13)  VALUE +0       03560099
029200                                                     COMP-3.      03570099
029300         10 PA-TOT-BKPO-AUDITS        PIC  S9(13)  VALUE +0       03580099
029400                                                     COMP-3.      03590099
029500*        10 PA-TOT-BKVS-AUDITS        PIC  S9(13)  VALUE +0       03600099
029600*                                                    COMP-3.      03610099
029700*        10 PA-TOT-BKUPC-AUDITS       PIC  S9(13)  VALUE +0       03620099
029800*                                                    COMP-3.      03630099
029900         10 PA-TOT-RECS-DELETED       PIC  S9(13)  VALUE +0       03640099
030000                                                     COMP-3.      03650099
030100         10 PA-TOT-BKPO-DELETES       PIC  S9(13)  VALUE +0       03660099
030200                                                     COMP-3.      03670099
030300*        10 PA-TOT-BKVS-DELETES       PIC  S9(13)  VALUE +0       03680099
030400*                                                    COMP-3.      03690099
030500*        10 PA-TOT-BKUPC-DELETES      PIC  S9(13)  VALUE +0       03700099
030600*                                                    COMP-3.      03710099
030700         10 PA-TOT-RECS-CHANGED       PIC  S9(13)  VALUE +0       03720099
030800                                                     COMP-3.      03730099
030900         10 PA-TOT-BKPO-CHANGES       PIC  S9(13)  VALUE +0       03740099
031000                                                     COMP-3.      03750099
031100*        10 PA-TOT-BKVS-CHANGES       PIC  S9(13)  VALUE +0       03760099
031200*                                                    COMP-3.      03770099
031300*        10 PA-TOT-BKUP-CHANGES       PIC  S9(13)  VALUE +0       03780099
031400*                                                    COMP-3.      03790099
031500         10 PA-TOT-RECS-CHANGED-B     PIC  S9(13)  VALUE +0       03800099
031600                                                     COMP-3.      03810099
031700         10 PA-TOT-BKPO-CHANGES-B     PIC  S9(13)  VALUE +0       03820099
031800                                                     COMP-3.      03830099
031900*        10 PA-TOT-BKVS-CHANGES-B     PIC  S9(13)  VALUE +0       03840099
032000*                                                    COMP-3.      03850099
032100*        10 PA-TOT-BKUP-CHANGES-B     PIC  S9(13)  VALUE +0       03860099
032200*                                                    COMP-3.      03870099
032300*        10 PA-TOT-RECS-CHANGED-Z     PIC  S9(13)  VALUE +0       03880099
032400*                                                    COMP-3.      03890099
032500*        10 PA-TOT-BKVS-CHANGES-Z     PIC  S9(13)  VALUE +0       03900099
032600*                                                    COMP-3.      03910099
032700*        10 PA-TOT-BKUP-CHANGES-Z     PIC  S9(13)  VALUE +0       03920099
032800*                                                    COMP-3.      03930099
032900*        10 PA-TOT-RECS-DELETED-E     PIC  S9(13)  VALUE +0       03940099
033000*                                                    COMP-3.      03950099
033100*        10 PA-TOT-BKVS-DELETES-E     PIC  S9(13)  VALUE +0       03960099
033200*                                                    COMP-3.      03970099
033300*        10 PA-TOT-BKUP-DELETES-E     PIC  S9(13)  VALUE +0       03980099
033400*                                                    COMP-3.      03990099
033500                                                                  04000099
033600 01  PS-PROGRAM-SWITCHES.                                         04010099
033700     05  PS-END-OF-INPUT-SW            PIC  X(01)    VALUE 'N'.   04020099
033800         88  PS-END-OF-INPUT                         VALUE 'Y'.   04030099
033900         88  PS-END-OF-INPUT-NO                      VALUE 'N'.   04040099
034000     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.   04050099
034100         88  PS-EDIT-ERROR                           VALUE 'Y'.   04060099
034200         88  PS-EDIT-ERROR-NO                        VALUE 'N'.   04070099
034300     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   04080099
034400         88  NORMAL-RUN                              VALUE '0'.   04090099
034500         88  RESTART-RUN                             VALUE '9'.   04100099
034600     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   04110099
034700         88  COMMITS-TAKEN                           VALUE 'T'.   04120099
034800         88  NO-COMMITS-TAKEN                        VALUE 'N'.   04130099
034900     05  PS-SAME-COMMIT-FIELDS-SW      PIC  X(01)    VALUE 'N'.   04140099
035000         88  PS-SAME-COMMIT-FIELDS                   VALUE 'Y'.   04150099
035100         88  PS-NOT-SAME-COMMIT-FIELDS               VALUE 'N'.   04160099
035200     05  PS-GOOD-BKPO-INSERT-SW        PIC  X(01)    VALUE 'N'.   04170099
035300         88  PS-GOOD-BKPO-INSERT                     VALUE 'Y'.   04180099
035400         88  PS-GOOD-BKPO-INSERT-NO                  VALUE 'N'.   04190099
035500*    05  PS-GOOD-BKUPC-INSERT-SW       PIC  X(01)    VALUE 'N'.   04200099
035600*        88  PS-GOOD-BKUPC-INSERT                    VALUE 'Y'.   04210099
035700*        88  PS-GOOD-BKUPC-INSERT-NO                 VALUE 'N'.   04220099
035800     05  PS-GOOD-BKG-INSERT-SW         PIC  X(01)    VALUE 'N'.   04230099
035900         88  PS-GOOD-BKG-INSERT                      VALUE 'Y'.   04240099
036000         88  PS-GOOD-BKG-INSERT-NO                   VALUE 'N'.   04250099
036100     05  PS-GOOD-BKPO-DELETE-SW        PIC  X(01)    VALUE 'N'.   04260099
036200         88  PS-GOOD-BKPO-DELETE                     VALUE 'Y'.   04270099
036300         88  PS-GOOD-BKPO-DELETE-NO                  VALUE 'N'.   04280099
036400*    05  PS-GOOD-BKVS-DELETE-SW        PIC  X(01)    VALUE 'N'.   04290099
036500*        88  PS-GOOD-BKVS-DELETE                     VALUE 'Y'.   04300099
036600*        88  PS-GOOD-BKVS-DELETE-NO                  VALUE 'N'.   04310099
036700*    05  PS-GOOD-BKUPC-DELETE-SW       PIC  X(01)    VALUE 'N'.   04320099
036800*        88  PS-GOOD-BKUPC-DELETE                    VALUE 'Y'.   04330099
036900*        88  PS-GOOD-BKUPC-DELETE-NO                 VALUE 'N'.   04340099
037000*    05  PS-EOC-BKUPC-CURSOR-SW        PIC  X(01)    VALUE 'N'.   04350099
037100*        88  PS-EOC-BKUPC-CURSOR                     VALUE 'Y'.   04360099
037200*        88  PS-EOC-BKUPC-CURSOR-NO                  VALUE 'N'.   04370099
037300*    05  PS-EOC-BKVS-CURSOR-SW         PIC  X(01)    VALUE 'N'.   04380099
037400*        88  PS-EOC-BKVS-CURSOR                      VALUE 'Y'.   04390099
037500*        88  PS-EOC-BKVS-CURSOR-NO                   VALUE 'N'.   04400099
037600     05  PS-PO-EXISTS-SW               PIC  X(01)    VALUE 'N'.   04410099
037700         88  PS-PO-EXISTS                            VALUE 'Y'.   04420099
037800         88  PS-PO-EXISTS-NO                         VALUE 'N'.   04430099
037900     05  PS-VS-EXISTS-SW               PIC  X(01)    VALUE 'N'.   04440099
038000         88  PS-VS-EXISTS                            VALUE 'Y'.   04450099
038100         88  PS-VS-EXISTS-NO                         VALUE 'N'.   04460099
038200     05  PS-UPC-EXISTS-SW              PIC  X(01)    VALUE 'N'.   04470099
038300         88  PS-UPC-EXISTS                           VALUE 'Y'.   04480099
038400         88  PS-UPC-EXISTS-NO                        VALUE 'N'.   04490099
038500     05  PS-NEW-PO-SW                  PIC  X(01)    VALUE 'N'.   04500099
038600         88  PS-NEW-PO                               VALUE 'Y'.   04510099
038700         88  PS-NEW-PO-NO                            VALUE 'N'.   04520099
038800     05  PS-NEW-VS-SW                  PIC  X(01)    VALUE 'N'.   04530099
038900         88  PS-NEW-VS                               VALUE 'Y'.   04540099
039000         88  PS-NEW-VS-NO                            VALUE 'N'.   04550099
039100     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   04560099
039200         88  PS-NEW-UPC                              VALUE 'Y'.   04570099
039300         88  PS-NEW-UPC-NO                           VALUE 'N'.   04580099
039400     05  PS-FIELD-NUMERIC-SW           PIC  X(01)    VALUE 'N'.   04590099
039500         88  PS-FIELD-NUMERIC                        VALUE 'Y'.   04600099
039600         88  PS-FIELD-NUMERIC-NO                     VALUE 'N'.   04610099
039700     05  PS-TRN-TYP-ADD-SW             PIC  X(01)    VALUE 'N'.   04620099
039800         88  PS-TRN-TYP-ADD                          VALUE 'Y'.   04630099
039900         88  PS-TRN-TYP-ADD-NO                       VALUE 'N'.   04640099
040000     05  PS-WARNING-TIME-SW            PIC  X(01)    VALUE 'N'.   04650099
040100         88  PS-WARNING-TIME                         VALUE 'Y'.   04660099
040200         88  PS-WARNING-TIME-NO                      VALUE 'N'.   04670099
040300     05  PS-WARNING-DATE-SW            PIC  X(01)    VALUE 'N'.   04680099
040400         88  PS-WARNING-DATE                         VALUE 'Y'.   04690099
040500         88  PS-WARNING-DATE-NO                      VALUE 'N'.   04700099
040600     05  PS-GOOD-REC-TYP-CDE-SW        PIC  X(01)    VALUE 'N'.   04710099
040700         88  PS-GOOD-REC-TYP-CDE                     VALUE 'Y'.   04720099
040800         88  PS-GOOD-REC-TYP-CDE-NO                  VALUE 'N'.   04730099
040900     05  PS-TIMBKPO-ROW-IS-THERE-SW    PIC X(01)     VALUE 'U'.   04740099
041000         88  PS-TIMBKPO-ROW-IS-THERE-UNSURE          VALUE 'U'.   04750099
041100         88  PS-TIMBKPO-ROW-IS-THERE                 VALUE 'Y'.   04760099
041200         88  PS-TIMBKPO-ROW-IS-THERE-NO              VALUE 'N'.   04770099
041300     05  PS-BKPO-7003-ROW-FOUND-SW     PIC X(01)     VALUE 'U'.   04780099
041400         88  PS-BKPO-7003-ROW-FOUND-UNSURE           VALUE 'U'.   04790099
041500         88  PS-BKPO-7003-ROW-FOUND                  VALUE 'Y'.   04800099
041600         88  PS-BKPO-7003-ROW-NOT-FOUND              VALUE 'N'.   04810099
041700     05  PS-BKPO-7006-ROW-FOUND-SW     PIC X(01)     VALUE 'U'.   04820099
041800         88  PS-BKPO-7006-ROW-FOUND-UNSURE           VALUE 'U'.   04830099
041900         88  PS-BKPO-7006-ROW-FOUND                  VALUE 'Y'.   04840099
041901         88  PS-BKPO-7006-ROW-NOT-FOUND              VALUE 'N'.   04850099
041902*    05  PS-TIMBKVS-ROW-IS-THERE-SW    PIC X(01)     VALUE 'U'.   04860099
041903*        88  PS-TIMBKVS-ROW-IS-THERE-UNSURE          VALUE 'U'.   04870099
041904*        88  PS-TIMBKVS-ROW-IS-THERE                 VALUE 'Y'.   04880099
041905*        88  PS-TIMBKVS-ROW-IS-THERE-NO              VALUE 'N'.   04890099
041906*    05  PS-TIMBKUP-ROW-IS-THERE-SW    PIC X(01)     VALUE 'U'.   04900099
041907*        88  PS-TIMBKUP-ROW-IS-THERE-UNSURE          VALUE 'U'.   04910099
041908*        88  PS-TIMBKUP-ROW-IS-THERE                 VALUE 'Y'.   04920099
042000*        88  PS-TIMBKUP-ROW-IS-THERE-NO              VALUE 'N'.   04930099
042100     05  PS-TIMBKPO-ADDED-SW           PIC X(01)     VALUE 'N'.   04940099
042200         88  PS-TIMBKPO-ADDED                        VALUE 'Y'.   04950099
042300         88  PS-TIMBKPO-ADDED-NO                     VALUE 'N'.   04960099
042400*    05  PS-TIMBKVS-ADDED-SW           PIC X(01)     VALUE 'N'.   04970099
042500*        88  PS-TIMBKVS-ADDED                        VALUE 'Y'.   04980099
042600*        88  PS-TIMBKVS-ADDED-NO                     VALUE 'N'.   04990099
042700     05  PS-KEY-FIELDS-CHANGED-SW      PIC X(01)     VALUE 'N'.   05000099
042800         88  PS-KEY-FIELDS-CHANGED                   VALUE 'Y'.   05010099
042900         88  PS-KEY-FIELDS-CHANGED-NO                VALUE 'N'.   05020099
043000     05  PS-INVALID-POE-CDE-SW         PIC X(01)     VALUE 'N'.   05030099
043100         88  PS-VALID-POE-CDE                        VALUE 'Y'.   05040099
043200         88  PS-INVALID-POE-CDE                      VALUE 'N'.   05050099
043300     05  PS-INVALID-FOB-CDE-SW         PIC X(01)     VALUE 'N'.   05060099
043400         88  PS-VALID-FOB-CDE                        VALUE 'Y'.   05070099
043500         88  PS-INVALID-FOB-CDE                      VALUE 'N'.   05080099
043600*    05  PS-INVALID-CNTRY-CDE-SW       PIC X(01)     VALUE 'N'.   05090099
043700*        88  PS-VALID-CNTRY-CDE                      VALUE 'Y'.   05100099
043800*        88  PS-INVALID-CNTRY-CDE                    VALUE 'N'.   05110099
043900     05  PS-TPURCHS-ACTIVE-SW          PIC X(01)     VALUE 'N'.   05120099
044000         88  PS-TPURCHS-ACTIVE                       VALUE 'Y'.   05130099
044001         88  PS-TPURCHS-ACTIVE-NO                    VALUE 'N'.   05140099
044002*    05  PS-VS-ON-TPURITM-SW           PIC X(01)     VALUE 'N'.   05150099
044003*        88  PS-VS-ON-TPURITM                        VALUE 'Y'.   05160099
044100*        88  PS-VS-ON-TPURITM-NO                     VALUE 'N'.   05170099
044200*    05  PS-UPC-ON-TPURITM-SW          PIC X(01)     VALUE 'N'.   05180099
044300*        88  PS-UPC-ON-TPURITM                       VALUE 'Y'.   05190099
044400*        88  PS-UPC-ON-TPURITM-NO                    VALUE 'N'.   05200099
044500     05  PS-BKPO-FOUND-SW              PIC X(01)     VALUE 'N'.   05210099
044600         88  PS-BKPO-FOUND                           VALUE 'Y'.   05220099
044700         88  PS-BKPO-FOUND-NO                        VALUE 'N'.   05230099
044800     05  PS-BKUP-FOUND-SW              PIC X(01)     VALUE 'N'.   05240099
044900         88  PS-BKUP-FOUND                           VALUE 'Y'.   05250099
045000         88  PS-BKUP-FOUND-NO                        VALUE 'N'.   05260099
045100     05  PS-GOOD-RECORD-SW             PIC X(01)     VALUE 'N'.   05270099
045200         88  PS-GOOD-RECORD                          VALUE 'Y'.   05280099
045300         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   05290099
045400*    05  PS-EOC-BKVS-UPC-CURSOR-SW     PIC  X(01)    VALUE 'N'.   05300099
045500*        88  PS-EOC-BKVS-UPC-CURSOR                  VALUE 'Y'.   05310099
045600*        88  PS-EOC-BKVS-UPC-CURSOR-NO               VALUE 'N'.   05320099
045700*    05  PS-EOC-UPC-CURSOR-SW          PIC  X(01)    VALUE 'N'.   05330099
045800*        88  PS-EOC-UPC-CURSOR                       VALUE 'Y'.   05340099
045900*        88  PS-EOC-UPC-CURSOR-NO                    VALUE 'N'.   05350099
046000*    05  PS-TABLE-VS-UPC-FOUND-SW      PIC  X(01)    VALUE 'N'.   05360099
046100*        88  PS-TABLE-VS-UPC-FOUND                   VALUE 'Y'.   05370099
046200*        88  PS-TABLE-VS-UPC-NOT-FOUND               VALUE 'N'.   05380099
046300     05  PS-CHANGE-FOUND-PO-SW         PIC  X(01)    VALUE 'N'.   05390099
046400         88  PS-CHANGE-FOUND-PO                      VALUE 'Y'.   05400099
046500         88  PS-CHANGE-FOUND-PO-NO                   VALUE 'N'.   05410099
046600*    05  PS-CHANGE-FOUND-VS-SW         PIC  X(01)    VALUE 'N'.   05420099
046700*        88  PS-CHANGE-FOUND-VS                      VALUE 'Y'.   05430099
046800*        88  PS-CHANGE-FOUND-VS-NO                   VALUE 'N'.   05440099
046900*    05  PS-CHANGE-FOUND-UPC-SW        PIC  X(01)    VALUE 'N'.   05450099
047000*        88  PS-CHANGE-FOUND-UPC                     VALUE 'Y'.   05460099
047100*        88  PS-CHANGE-FOUND-UPC-NO                  VALUE 'N'.   05470099
047200     05  PS-CHANGE-FOUND-SW            PIC  X(01)    VALUE 'N'.   05480099
047300         88  PS-CHANGE-FOUND                         VALUE 'Y'.   05490099
047400         88  PS-CHANGE-FOUND-NO                      VALUE 'N'.   05500099
047500     05  PS-CHANGE-ADD-SW              PIC  X(01)    VALUE 'N'.   05510099
047600         88  PS-CHANGE-ADD                           VALUE 'Y'.   05520099
047700         88  PS-CHANGE-ADD-NO                        VALUE 'N'.   05530099
047800     05  PS-CHANGE-ADD-B-SW            PIC  X(01)    VALUE 'N'.   05540099
047900         88  PS-CHANGE-ADD-B                         VALUE 'Y'.   05550099
048000         88  PS-CHANGE-ADD-B-NO                      VALUE 'N'.   05560099
048100*    05  PS-DELETE-E-VS-SW             PIC  X(01)    VALUE 'N'.   05570099
048200*        88  PS-DELETE-E-VS                          VALUE 'Y'.   05580099
048300*        88  PS-DELETE-E-VS-NO                       VALUE 'N'.   05590099
048400*    05  PS-DELETE-E-UPC-SW            PIC  X(01)    VALUE 'N'.   05600099
048500*        88  PS-DELETE-E-UPC                         VALUE 'Y'.   05610099
048600*        88  PS-DELETE-E-UPC-NO                      VALUE 'N'.   05620099
048700     05  PS-EDD-EDDRSN-EDL-LOOP-SW     PIC  X(01)    VALUE 'N'.   05630099
048800         88  PS-EDD-EDDRSN-EDL-LOOP                  VALUE 'Y'.   05640099
048900         88  PS-EDD-EDDRSN-EDL-LOOP-NO               VALUE 'N'.   05650099
049000     05  PS-ADD-FOR-CHANGES-SW         PIC  X(01)    VALUE 'N'.   05660099
049100         88  PS-ADD-FOR-CHANGES-DONE                 VALUE 'Y'.   05670099
049200         88  PS-ADD-FOR-CHANGES-DONE-NO              VALUE 'N'.   05680099
049300*    05  PS-CHANGE-ADD-VS-OR-UPC-SW    PIC  X(01)    VALUE 'N'.   05690099
049400*        88  PS-CHANGE-ADD-VS-OR-UPC                 VALUE 'Y'.   05700099
049500*        88  PS-CHANGE-ADD-VS-OR-UPC-NO              VALUE 'N'.   05710099
049600*    05  PS-CHANGE-C-VS-SW             PIC  X(01)    VALUE 'N'.   05720099
049700*        88  PS-CHANGE-C-VS                          VALUE 'Y'.   05730099
049800*        88  PS-CHANGE-C-VS-NO                       VALUE 'N'.   05740099
049900*    05  PS-CHANGE-C-UPC-SW            PIC  X(01)    VALUE 'N'.   05750099
050000*        88  PS-CHANGE-C-UPC                         VALUE 'Y'.   05760099
050100*        88  PS-CHANGE-C-UPC-NO                      VALUE 'N'.   05770099
050200     05  PS-POE-LBD-SW                 PIC  X(01)    VALUE 'N'.   05780099
050300         88  PS-POE-LBD                              VALUE 'Y'.   05790099
050400         88  PS-POE-LBD-NO                           VALUE 'N'.   05800099
050500                                                                  05810099
050600 01  PC-PROGRAM-CONSTANTS.                                        05820099
050700     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          05830099
050800         'TRKUP205'.                                              05840099
050900     05  PC-99                       PIC X(02)     VALUE '99'.    05850099
051000     05  PC-1                        PIC X(01)     VALUE '1'.     05860099
051100     05  PC-2                        PIC X(01)     VALUE '2'.     05870099
051200     05  PC-3                        PIC X(01)     VALUE '3'.     05880099
051300     05  PC-10                       PIC X(02)     VALUE '10'.    05890099
051400     05  PC-21                       PIC X(02)     VALUE '21'.    05900099
051500     05  PC-A                        PIC X(01)     VALUE 'A'.     05910099
051600     05  PC-B                        PIC X(01)     VALUE 'B'.     05920099
051700     05  PC-C                        PIC X(01)     VALUE 'C'.     05930099
051800     05  PC-D                        PIC X(01)     VALUE 'D'.     05940099
051900     05  PC-E                        PIC X(01)     VALUE 'E'.     05950099
052000     05  PC-O                        PIC X(01)     VALUE 'O'.     05960099
052100     05  PC-U                        PIC X(01)     VALUE 'U'.     05970099
052200     05  PC-Z                        PIC X(01)     VALUE 'Z'.     05980099
052300     05  PC-AP                       PIC X(02)     VALUE 'AP'.    05990099
052400     05  PC-AC                       PIC X(02)     VALUE 'AC'.    06000099
052401     05  PC-BD                       PIC X(02)     VALUE 'BD'.    06010099
052402     05  PC-BK                       PIC X(02)     VALUE 'BK'.    06020099
052500     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   06030099
052600     05  PC-EDD                      PIC X(06)     VALUE 'EDD   '.06040099
052700     05  PC-EDDRSN                   PIC X(06)     VALUE 'EDDRSN'.06050099
052800     05  PC-EDL                      PIC X(06)     VALUE 'EDL   '.06060099
052900     05  PC-EDLVS                    PIC X(06)     VALUE 'EDLVS '.06070099
053000     05  PC-EDLUPC                   PIC X(06)     VALUE 'EDLUPC'.06080099
053100     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   06090099
053200     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   06100099
053300     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.06110099
053400     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.   06120099
053500     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.   06130099
053600     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   06140099
053700     05  PC-DASH                     PIC X(01)     VALUE '-'.     06150099
053800     05  PC-DECIMAL                  PIC X(01)     VALUE '.'.     06160099
053900     05  PC-DEFAULT-SECONDS          PIC X(10)     VALUE          06170099
054000                                     '.00.000000'.                06180099
054100     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          06190099
054200                                     '0001-01-01-00.00.00.000000'.06200099
054300     05  PC-DEFAULT-DTE              PIC X(10)     VALUE          06210099
054400                                     '0001-01-01'.                06220099
054500     05  PC-DEFAULT-DTE-NO-DASHES    PIC X(08)     VALUE          06230099
054600                                     '00010101'.                  06240099
054700     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       06250099
054800                                                     COMP-3.      06260099
054900     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     06270099
055000     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     06280099
055100                                                                  06290099
055200 01  PV-PROGRAM-VARIABLES.                                        06300099
055300     05  PV-RECORD-TYP               PIC X(06).                   06310099
055400         88  PV-RECORD-TYP-EDD                     VALUE 'EDD   '.06320099
055500         88  PV-RECORD-TYP-EDDRSN                  VALUE 'EDDRSN'.06330099
055600         88  PV-RECORD-TYP-EDL                     VALUE 'EDL   '.06340099
055700         88  PV-RECORD-TYP-EDLVS                   VALUE 'EDLVS '.06350099
055800         88  PV-RECORD-TYP-EDLUPC                  VALUE 'EDLUPC'.06360099
055900         88  PV-RECORD-TYP-ISA                     VALUE 'ISA   '.06370099
056000                                                                  06380099
056100     05  PV-ISA-CHECK                PIC X(03).                   06390099
056200         88  PV-ISA-RECORD                         VALUE 'ISA'.   06400099
056300                                                                  06410099
056400     05  PV-IMPRT-FCTRY-NAME.                                     06420099
056500         10  PV-IMPRT-FCTRY-NAME-10  PIC X(10)     VALUE SPACES.  06430099
056600         10  FILLER                  PIC X(25)     VALUE SPACES.  06440099
056700                                                                  06450099
056800     05  PV-BKG-SEQ-NBR-MAX          PIC S9(04)    VALUE +0 COMP. 06460099
056900                                                                  06470099
057000     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  06480099
057100                                                                  06490099
057200*    05  PV-HOLD-CURSOR-VS-NBR       PIC X(20)     VALUE SPACES.  06500099
057300*    05  PV-UPC-CURSOR-VS-NBR        PIC X(15)     VALUE SPACES.  06510099
057400*    05  PV-UPC-CURSOR-UPC-NBR       PIC S9(15)V   VALUE ZEROES   06520099
057500*                                                  COMP-3.        06530099
057501     05  PV-ENT-ID-SIGNED            PIC S9(09)    VALUE +0       06540099
057510                                                   COMP.          06550099
057600                                                                  06560099
057700******************************************************************06570099
057800*          HOLD RECORD FIELDS START HERE                          06580099
057900******************************************************************06590099
058000     05  SAVE1-DATA-VALUE                PIC X(06)  VALUE SPACES. 06600099
058100     05  PV-HOLD-TR024-TRN-TYP           PIC X(01)  VALUE SPACES. 06610099
058200     05  PV-HOLD-TR024-REC-TYP-CDE       PIC X(06)  VALUE SPACES. 06620099
058300     05  PV-HOLD-TR024-PO-NBR            PIC 9(09)  VALUE ZEROES. 06630099
058400     05  PV-HOLD-TR024-EXTL-REF-NBR      PIC X(15)  VALUE SPACES. 06640099
058500     05  PV-HOLD-TR024-PO-BKG-DELY-DTE   PIC X(08)  VALUE SPACES. 06650099
058600     05  PV-HOLD-TR024-PO-BKG-DELY-TM    PIC X(04)  VALUE SPACES. 06660099
058700     05  PV-HOLD-ORGN-SHPD-FR-CDE        PIC X(03)  VALUE SPACES. 06670099
058800     05  PV-HOLD-TR024-VS-NBR            PIC X(20)  VALUE SPACES. 06680099
058900     05  PV-HOLD-TR024-UPC-NBR           PIC 9(15)  VALUE ZEROES. 06690099
059000     05  PV-HOLD-DAT-SRC-ENT-ID          PIC 9(09)  VALUE ZEROES. 06700099
059010     05  PV-HOLD-TR024-PROCESS-SEQ-NBR   PIC 9(06)  VALUE ZEROES. 06710099
059100     05  PV-HOLD-PROCESS-SEQ-NBR-EDD                              06720099
059200                                  PIC 9(06)  VALUE ZEROES.        06730099
059300     05  PV-HOLD-PROCESS-SEQ-NBR-EDDRSN                           06740099
059400                                  PIC 9(06)  VALUE ZEROES.        06750099
059500     05  PV-HOLD-PROCESS-SEQ-NBR-EDL                              06760099
059600                                  PIC 9(06)  VALUE ZEROES.        06770099
059700     05  PV-SEQ-NBR-EDD                                           06780099
059800                                  PIC 9(06)  VALUE ZEROES.        06790099
059900     05  PV-SEQ-NBR-EDDRSN                                        06800099
060000                                  PIC 9(06)  VALUE ZEROES.        06810099
060100     05  PV-SEQ-NBR-EDL                                           06820099
060200                                  PIC 9(06)  VALUE ZEROES.        06830099
060300                                                                  06840099
060400     05  PV-HOLD-STR201-ERROR-TYPE    PIC X(03)     VALUE SPACES. 06850099
060500     05  PV-HOLD-TR201-ERROR-MSG     PIC X(50)     VALUE SPACES.  06860099
060600                                                                  06870099
060700     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.  06880099
060800                                                                  06890099
060900     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                   06900099
061000         88  TRN-TYP-ADD-A                         VALUE 'A'.     06910099
061100         88  TRN-TYP-ADD-B                         VALUE 'B'.     06920099
061200         88  TRN-TYP-ADD-Z                         VALUE 'Z'.     06930099
061300         88  TRN-TYP-CHG                           VALUE 'C'.     06940099
061400         88  TRN-TYP-DEL-D                         VALUE 'D'.     06950099
061500         88  TRN-TYP-DEL-E                         VALUE 'E'.     06960099
061600                                                                  06970099
061700                                                                  06980099
061800     05  PV-REC-TYP-EDD              PIC X(06)     VALUE 'EDD   '.06990099
061900     05  PV-REC-TYP-EDDRSN           PIC X(06)     VALUE 'EDDRSN'.07000099
062000     05  PV-REC-TYP-EDL              PIC X(06)     VALUE 'EDL   '.07010099
062100                                                                  07020099
062200     05  PV-CHECK-REC-TYP-CDE        PIC X(06).                   07030099
062300         88  VALID-REC-TYP-CDE                     VALUE 'ISA   ',07040099
062400                                                         'EDD   ',07050099
062500                                                         'EDDRSN',07060099
062600                                                         'EDL   ',07070099
062700                                                         'EDLVS ',07080099
062800                                                         'EDLUPC',07090099
062900                                                         'CTT   ',07100099
063000                                                         'IEA   '.07110099
063100     05  PV-EDI-RECORDS              PIC  X(03).                  07120099
063200         88  EDI-RECORD                            VALUE 'CTT',   07130099
063300                                                         'IEA',   07140099
063400                                                         'ISA'.   07150099
063500         88  EDI-IEA-RECORD                        VALUE 'IEA'.   07160099
063600                                                                  07170099
063700     05  PV-TMST                     PIC X(26)     VALUE SPACES.  07180099
063800     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  07190099
063900     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.  07200099
064000     05  PA-TOTAL-RECS-READ          PIC 9(09)     VALUE ZERO     07210099
064100                                                    COMP-3.       07220099
064200     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       07230099
064300                                                    COMP SYNC.    07240099
064400                                                                  07250099
064500     05  PV-FORMAT-TMST.                                          07260099
064600         10  PV-FORMAT-TMST-DTE.                                  07270099
064700             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  07280099
064800             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     07290099
064900             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  07300099
065000             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     07310099
065100             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  07320099
065200             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     07330099
065300         10  PV-FORMAT-TMST-TM.                                   07340099
065400             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  07350099
065500             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     07360099
065600             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  07370099
065700             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          07380099
065800                                                     '.00.000000'.07390099
065900     05  PV-REFORMAT-TMST.                                        07400099
066000         10  PV-REFORMAT-TMST-DTE.                                07410099
066100             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.07420099
066200             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.07430099
066300             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.07440099
066400         10  PV-REFORMAT-TMST-TM.                                 07450099
066500             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.07460099
066600             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.07470099
066700                                                                  07480099
066800     05  PV-REFORMAT-TO-DB2-DTE.                                  07490099
066900         10  PV-REFORMAT-TO-DB2-CY    PIC X(04)  VALUE SPACES.    07500099
067000         10  PV-REFORMAT-TODB2-DASH1  PIC X(01)  VALUE '-'.       07510099
067100         10  PV-REFORMAT-TO-DB2-MM    PIC X(02)  VALUE SPACES.    07520099
067200         10  PV-REFORMAT-TODB2-DASH2  PIC X(01)  VALUE '-'.       07530099
067300         10  PV-REFORMAT-TO-DB2-DD    PIC X(02)  VALUE SPACES.    07540099
067400                                                                  07550099
067500     05  PV-REFORMAT-10BYTE-FIELD     PIC X(10)  VALUE SPACES.    07560099
067600                                                                  07570099
067700     05  PV-HDR-CONSOL-TRNS-DTE.                                  07580099
067800         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.07590099
067900         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.07600099
068000                                                                  07610099
068100     05  PV-WORK-DATE                     PIC 9999B99B99.         07620099
068200     05  PV-WORK-DATE-R REDEFINES PV-WORK-DATE  PIC X(10).        07630099
068300     05  PV-WORK-DATE-G REDEFINES PV-WORK-DATE-R.                 07640099
068400         10  FILLER                       PIC 9(4).               07650099
068500         10  PV-WORK-DASH1                PIC X.                  07660099
068600         10  FILLER                       PIC 9(2).               07670099
068700         10  PV-WORK-DASH2                PIC X.                  07680099
068800         10  FILLER                       PIC 9(2).               07690099
068801                                                                  07700099
068802*01  PV-VENDOR-STYLE-UPC-TABLE.                                   07710099
068803*    05  PV-VS-UPC-TABLE OCCURS 2000 TIMES                        07720099
068804*                                INDEXED BY VS-INDX.              07730099
068805*        10  PV-TABLE-VS-NBR       PIC X(20).                     07740099
068806*        10  PV-TABLE-UPC-NBR      PIC 9(15).                     07750099
068807                                                                  07760099
068808 01  CKPT-RESTART-INFO.                                           07770099
068809     05  CR-INPUT-FILE-SW            PIC X(01)     VALUE 'I'.     07780099
068900         88  INPUT-BOOKING-FILE                    VALUE 'I'.     07790099
069000     05  CR-BOOKING-RECS-WORKED      PIC 9(09)     VALUE ZERO.    07800099
069100                                                                  07810099
069200*                                                                 07820099
069300*  CURSOR DECLARATION TO OBTAIN BOOKING UPC INFORMATION FOR       07830099
069400*  PO LEVEL DELETES                                               07840099
069500*                                                                 07850099
069600*    EXEC SQL                                                     07860099
069700*         DECLARE BKUPC_CSR CURSOR WITH HOLD FOR                  07870099
069800*            SELECT PO_NBR,                                       07880099
069900*                   PO_BKG_SEQ_NBR,                               07890099
070000*                   VS_NBR,                                       07900099
070100*                   UPC_NBR,                                      07910099
070200*                   UPC_CART_CNT,                                 07920099
070300*                   UPC_CBMT_QTY,                                 07930099
070400*                   UPC_WT_KGRM_QTY,                              07940099
070500*                   UPC_UNT_QTY,                                  07950099
070600*                   CRE_BY_USR_ID,                                07960099
070700*                   CRE_TMST,                                     07970099
070800*                   LAST_UPD_BY_USR_ID,                           07980099
070900*                   LAST_UPD_TMST                                 07990099
071000*              FROM TIMBKUP                                       08000099
071100*             WHERE PO_NBR           = :IMBKUP-PO-NBR             08010099
071200*               AND PO_BKG_SEQ_NBR   = :IMBKUP-PO-BKG-SEQ-NBR     08020099
071300*    END-EXEC.                                                    08030099
071400                                                                  08040099
071500*                                                                 08050099
071600*  CURSOR DECLARATION TO OBTAIN BOOKING VENDOR STYLE INFORMATION  08060099
071700*  FOR PO LEVEL DELETES                                           08070099
071800*                                                                 08080099
071900*    EXEC SQL                                                     08090099
072000*         DECLARE BKVS_CSR CURSOR WITH HOLD FOR                   08100099
072100*            SELECT PO_NBR,                                       08110099
072200*                   PO_BKG_SEQ_NBR,                               08120099
072300*                   VS_NBR,                                       08130099
072400*                   HTS_ID,                                       08140099
072500*                   VS_CART_CNT,                                  08150099
072600*                   VS_CBMT_QTY,                                  08160099
072700*                   VS_WT_KGRM_QTY,                               08170099
072800*                   VS_UNT_QTY,                                   08180099
072900*                   QTA_CTG_IND,                                  08190099
073000*                   CRE_BY_USR_ID,                                08200099
073100*                   CRE_TMST,                                     08210099
073200*                   LAST_UPD_BY_USR_ID,                           08220099
073300*                   LAST_UPD_TMST                                 08230099
073400*              FROM TIMBKVS                                       08240099
073500*             WHERE PO_NBR           = :IMBKVS-PO-NBR             08250099
073600*               AND PO_BKG_SEQ_NBR   = :IMBKVS-PO-BKG-SEQ-NBR     08260099
073700*     END-EXEC.                                                   08270099
073800                                                                  08280099
073900*                                                                 08290099
074000*  CURSOR DECLARATION TO OBTAIN VENDOR STYLE AND UPC INFORMATION  08300099
074100*  FOR THE INTERNAL VS/UPC TABLE.                                 08310099
074200*                                                                 08320099
074300*    EXEC SQL                                                     08330099
074400*         DECLARE BKVS_UPC_CUR CURSOR WITH HOLD FOR               08340099
074500*            SELECT DISTINCT                                      08350099
074600*                   B.VS_NBR,                                     08360099
074700*                   B.UPC_NBR                                     08370099
074800*              FROM TIMBKVS  A                                    08380099
074900*                  ,TIMBKUP  B                                    08390099
075000*             WHERE A.PO_NBR         = :IMBKPO-PO-NBR             08400099
075100*               AND A.PO_NBR         =  B.PO_NBR                  08410099
075200*               AND A.PO_BKG_SEQ_NBR = :IMBKPO-PO-BKG-SEQ-NBR     08420099
075300*               AND A.PO_BKG_SEQ_NBR =  B.PO_BKG_SEQ_NBR          08430099
075400*          ORDER BY B.VS_NBR,                                     08440099
075500*                   B.UPC_NBR                                     08450099
075600*    END-EXEC.                                                    08460099
075700                                                                  08470099
075800*                                                                 08480099
075900*  CURSOR DECLARATION TO OBTAIN UPC INFORMATION FOR THE INTERNAL  08490099
076000*  VS/UPC TABLE.                                                  08500099
076100*                                                                 08510099
076200*    EXEC SQL                                                     08520099
076300*         DECLARE UPC_CUR CURSOR WITH HOLD FOR                    08530099
076400*            SELECT DISTINCT                                      08540099
076500*                   A.PO_NBR,                                     08550099
076600*                   A.PO_BKG_SEQ_NBR,                             08560099
076700*                   A.VS_NBR,                                     08570099
076800*                   A.UPC_NBR,                                    08580099
076900*                   A.UPC_CART_CNT,                               08590099
077000*                   A.UPC_CBMT_QTY,                               08600099
077100*                   A.UPC_WT_KGRM_QTY,                            08610099
077200*                   A.UPC_UNT_QTY,                                08620099
077300*                   A.CRE_BY_USR_ID,                              08630099
077400*                   A.CRE_TMST,                                   08640099
077500*                   A.LAST_UPD_BY_USR_ID,                         08650099
077600*                   A.LAST_UPD_TMST                               08660099
077700*              FROM TIMBKUP  A                                    08670099
077800*             WHERE A.PO_NBR         = :IMBKPO-PO-NBR             08680099
077900*               AND A.PO_BKG_SEQ_NBR = :IMBKPO-PO-BKG-SEQ-NBR     08690099
078000*               AND A.VS_NBR         = :PV-UPC-CURSOR-VS-NBR      08700099
078100*          ORDER BY A.VS_NBR,                                     08710099
078200*                   A.UPC_NBR                                     08720099
078300*    END-EXEC.                                                    08730099
078400                                                                  08740099
078500*---------------------------------------------------------------* 08750099
078600*    CURSOR DECLARATION FOR SELECTING POE CODE AIR              * 08760099
078700*---------------------------------------------------------------* 08770099
078800                                                                  08780099
078900     EXEC SQL                                                     08790099
079000          DECLARE  POE-CSR-AIR CURSOR                             08800099
079100              FOR  SELECT DISTINCT                                08810099
079200                   A.POE_CDE                                      08820099
079300             FROM  TIMPOE  A                                      08830099
079400            WHERE  A.STD_IATA_CDE  =  :TR024-EDD-DEST-POE-CDE     08840099
079500              AND  A.STAT_CDE      =  'A'                         08850099
079600         ORDER BY  POE_CDE                                        08860099
079700     END-EXEC.                                                    08870099
079701                                                                  08880099
079702 EJECT                                                            08890099
079703*---------------------------------------------------------------* 08900099
079704*    CURSOR DECLARATION FOR SELECTING POE CODE OCEAN            * 08910099
079705*---------------------------------------------------------------* 08920099
079706                                                                  08930099
079707     EXEC SQL                                                     08940099
079708          DECLARE  POE-CSR-OCEAN CURSOR                           08950099
079709              FOR  SELECT DISTINCT                                08960099
079710                   A.POE_CDE                                      08970099
079720             FROM  TIMPOE  A                                      08980099
079730            WHERE  A.POE_STD_EDI_CDE  = :TR024-EDD-DEST-POE-CDE   08990099
079740              AND  A.STAT_CDE         = 'A'                       09000099
079750         ORDER BY  POE_CDE                                        09010099
079760     END-EXEC.                                                    09020099
079761                                                                  09030099
079762*---------------------------------------------------------------* 09040099
079763*    CURSOR DECLARATION FOR SELECTING ON ORGN-SHPD-FR-CDE         09050099
079764*---------------------------------------------------------------* 09060099
079765     EXEC SQL                                                     09070099
079766        DECLARE ORGN_CUR CURSOR FOR                               09080099
079767          SELECT PO_NBR                                           09090099
079768                ,PO_BKG_SEQ_NBR                                   09100099
079769                ,EXTL_REF_NBR                                     09110099
079770                ,PO_BKG_DELY_TMST                                 09120099
079780                ,ORGN_SHPD_FR_CDE                                 09130099
079790         FROM TIMBKPO                                             09140099
079800          WHERE PO_NBR      = :W-IMBKPO-PO-NBR                    09150099
079900          AND EXTL_REF_NBR  = :TR024-EDL-EXTL-REF-NBR             09160099
080000          AND ORGN_SHPD_FR_CDE = :TR024-EDL-ORGN-SHPD-FR-CDE      09170099
080100        ORDER BY  PO_BKG_SEQ_NBR DESC                             09180099
080200     END-EXEC.                                                    09190099
080300                                                                  09200099
080400*---------------------------------------------------------------* 09210099
080500*    CURSOR DECLARATION FOR SELECTING ON DELIVERY TIMESTAMP       09220099
080600*---------------------------------------------------------------* 09230099
080700     EXEC SQL                                                     09240099
080800        DECLARE TMST_CUR CURSOR FOR                               09250099
080900          SELECT PO_NBR                                           09260099
081000                ,PO_BKG_SEQ_NBR                                   09270099
081100                ,EXTL_REF_NBR                                     09280099
081200                ,PO_BKG_DELY_TMST                                 09290099
081300                ,ORGN_SHPD_FR_CDE                                 09300099
081400           FROM TIMBKPO                                           09310099
081500          WHERE PO_NBR           = :W-IMBKPO-PO-NBR               09320099
081600            AND EXTL_REF_NBR     = :TR024-EDL-EXTL-REF-NBR        09330099
081700            AND DATE(PO_BKG_DELY_TMST)                            09340099
081800                              = :PV-WORK-DATE-R                   09350099
081900          ORDER BY PO_BKG_SEQ_NBR DESC                            09360099
082000     END-EXEC.                                                    09370099
082001                                                                  09380099
082002 EJECT                                                            09390099
082003******************************************************************09400099
082004 LINKAGE SECTION.                                                 09410099
082005******************************************************************09420099
082006                                                                  09430099
082007******************************************************************09440099
082008 PROCEDURE DIVISION.                                              09450099
082009******************************************************************09460099
082010                                                                  09470099
082011******************************************************************09480099
082012*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *09490099
082013******************************************************************09500099
082014 0000-PROGRAM-MAINLINE.                                           09510099
082015                                                                  09520099
082016     PERFORM 1000-INITIALIZE.                                     09530099
082017                                                                  09540099
082018     PERFORM 2000-PROCESS-BKG-RECORDS                             09550099
082019         UNTIL PS-END-OF-INPUT.                                   09560099
082020                                                                  09570099
082021     PERFORM 8000-EOJ-ROUTINE.                                    09580099
082022     STOP RUN.                                                    09590099
082023                                                                  09600099
082024******************************************************************09610099
082025*  1000-INITIALIZE -  OPENS FILES, INITIALIZES FIELDS,     AND   *09620099
082026*  OTHER BEGINNING OF JOB PROCESSES.                             *09630099
082027******************************************************************09640099
082028 1000-INITIALIZE.                                                 09650099
082029                                                                  09660099
082030     OPEN INPUT  TR024-BOOKING-FILE                               09670099
082031                                                                  09680099
082032     PERFORM 4000-GET-CHECKPOINT-CNTL.                            09690099
082033     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                  09700099
082034                                                                  09710099
082035     IF RESTART-RUN                                               09720099
082036         PERFORM 4110-CHECKPOINT-RESTART                          09730099
082037     ELSE                                                         09740099
082038         PERFORM 1010-CONTINUE-INITIALIZE                         09750099
082100     END-IF.                                                      09760099
082200                                                                  09770099
082300     PERFORM 4020-SET-COMMIT-TIME.                                09780099
082400                                                                  09790099
082500                                                                  09800099
082600 1010-CONTINUE-INITIALIZE.                                        09810099
082700                                                                  09820099
082800     INITIALIZE  TR024-REC-TYP-EDD.                               09830099
082900                                                                  09840099
083000     SET PS-GOOD-RECORD-NO TO TRUE.                               09850099
083100                                                                  09860099
083200     PERFORM 6000-READ-BKG-FILE                                   09870099
083300         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                 09880099
083400                                                                  09890099
083500     IF PS-END-OF-INPUT                                           09900099
083600         CONTINUE                                                 09910099
083700     ELSE                                                         09920099
083800         MOVE TR024-EDD-TRN-TYP             TO                    09930099
083900                PV-HOLD-TR024-TRN-TYP                             09940099
084000         MOVE TR024-EDD-PO-NBR              TO                    09950099
084100                PV-HOLD-TR024-PO-NBR                              09960099
084200         MOVE TR024-EDD-EXTL-REF-NBR        TO                    09970099
084300                PV-HOLD-TR024-EXTL-REF-NBR                        09980099
084400         MOVE TR024-EDD-PO-BKG-DELY-DTE     TO                    09990099
084500                PV-HOLD-TR024-PO-BKG-DELY-DTE                     10000099
084600         MOVE TR024-EDD-PO-BKG-DELY-TM      TO                    10010099
084700                PV-HOLD-TR024-PO-BKG-DELY-TM                      10020099
084800         MOVE TR024-EDD-PROCESS-SEQ-NBR     TO                    10030099
084900                PV-HOLD-TR024-PROCESS-SEQ-NBR                     10040099
085000         MOVE TR024-EDD-REC-TYP-CDE         TO                    10050099
085100                PV-HOLD-TR024-REC-TYP-CDE                         10060099
085200         MOVE TR024-EDD-ORGN-SHPD-FR-CDE    TO                    10070099
085300                PV-HOLD-ORGN-SHPD-FR-CDE                          10080099
085400                                                                  10090099
085500         EVALUATE TR024-EDD-REC-TYP-CDE                           10100099
085600                                                                  10110099
085700             WHEN PC-EDLVS                                        10120099
085800                 MOVE TR024-EDLVS-VS-NBR   TO                     10130099
085900                        TR201-EDLVS-VS-NBR                        10140099
086000             WHEN PC-EDLUPC                                       10150099
086100                 MOVE TR024-EDLVS-VS-NBR   TO                     10160099
086200                        TR201-EDLVS-VS-NBR                        10170099
086300                 MOVE TR024-EDLUPC-UPC-NBR   TO                   10180099
086400                        TR201-EDLUPC-UPC-NBR                      10190099
086500         END-EVALUATE                                             10200099
086600                                                                  10210099
086700     END-IF.                                                      10220099
086800                                                                  10230099
086900 EJECT                                                            10240099
087000                                                                  10250099
087100******************************************************************10260099
087200* MAIN PROCESSING PARAGRAPH.                                     *10270099
087300******************************************************************10280099
087400 2000-PROCESS-BKG-RECORDS.                                        10290099
087500                                                                  10300099
087600     SET PS-KEY-FIELDS-CHANGED-NO   TO TRUE                       10310099
087700                                                                  10320099
087800     EVALUATE TR024-EDD-TRN-TYP                                   10330099
087900         WHEN 'A'                                                 10340099
088000             ADD +1     TO PA-TOT-TRN-TYP-A                       10350099
088100                                                                  10360099
088200             PERFORM 2100-GROUP-ADD UNTIL                         10370099
088300                 PS-KEY-FIELDS-CHANGED OR PS-END-OF-INPUT         10380099
088400         WHEN 'C'                                                 10390099
088500             PERFORM 2300-CHANGE UNTIL                            10400099
088600                 PS-KEY-FIELDS-CHANGED OR PS-END-OF-INPUT         10410099
088700             ADD +1     TO PA-TOT-TRN-TYP-C                       10420099
088800             IF TR024-EDD-REC-TYP-CDE = PC-EDD OR                 10430099
088900                PS-END-OF-INPUT                                   10440099
089000               IF PS-CHANGE-FOUND-NO                              10450099
089100                   PERFORM 2399-NO-CHG-WRN-MSG                    10460099
089200               ELSE                                               10470099
089300                   SET PS-CHANGE-FOUND-NO TO TRUE                 10480099
089400               END-IF                                             10490099
089500             END-IF                                               10500099
089600                                                                  10510099
089700         WHEN 'D'                                                 10520099
089800             PERFORM 2400-GROUP-DELETE UNTIL                      10530099
089900                 PS-KEY-FIELDS-CHANGED OR PS-END-OF-INPUT         10540099
090000             ADD +1     TO PA-TOT-TRN-TYP-D                       10550099
090100         WHEN OTHER                                               10560099
090200             MOVE PC-E                TO TR201-RPT-TYP            10570099
090300             MOVE 'TRN TYP'           TO TR201-DATA-IN-ERROR      10580099
090400             MOVE TR024-EDD-TRN-TYP   TO TR201-DATA-VALUE         10590099
090500             MOVE PC-ERROR            TO TR201-ERROR-TYPE         10600099
090600             MOVE 'INVALID TRN TYP'   TO TR201-ERROR-MSG          10610099
090700             ADD +1     TO PA-TOT-BAD-TRN-TYP                     10620099
090800             ADD +1     TO PA-TOTAL-ERROR-COUNT                   10630099
090900             PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    10640099
091000             PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  10650099
091100             PERFORM 7300-INSERT-TOUTTR6-RPT                      10660099
091200             PERFORM 2600-CHECK-HOLD-FIELDS                       10670099
091300                                                                  10680099
091400             SET PS-GOOD-RECORD-NO TO TRUE                        10690099
091500             PERFORM 6000-READ-BKG-FILE                           10700099
091600                UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT           10710099
091700                                                                  10720099
091800             PERFORM 2610-RESET-SWITCHES                          10730099
091900                                                                  10740099
092000     END-EVALUATE.                                                10750099
092100                                                                  10760099
092200     PERFORM 2615-CHECK-COMMIT-FIELDS.                            10770099
092300                                                                  10780099
092400     IF PS-NOT-SAME-COMMIT-FIELDS                                 10790099
092500         PERFORM 4100-COMMIT-CHECK                                10800099
092600     END-IF.                                                      10810099
092700                                                                  10820099
092800 EJECT                                                            10830099
092900                                                                  10840099
093000******************************************************************10850099
093100* AN ADD WHERE BOTH EDD AND EDL RECORD TYPES ARE PRESENT AND     *10860099
093200* EDDRSN, EDLVS, AND EDLUPC MAY OR MAY NOT BE PRESENT.           *10870099
093300******************************************************************10880099
093400 2100-GROUP-ADD.                                                  10890099
093500                                                                  10900099
093600     EVALUATE TR024-EDD-REC-TYP-CDE                               10910099
093700         WHEN PC-EDD                                              10920099
093800             ADD +1 TO PA-TOT-EDD-RECS-READ                       10930099
093900             MOVE TR024-EDD-PO-NBR      TO IMBKPO-PO-NBR          10940099
094000             MOVE TR024-EDD-PO-BKG-DELY-DTE (1:4)  TO             10950099
094100                 PV-REFORMAT-TO-DB2-CY                            10960099
094200             MOVE TR024-EDD-PO-BKG-DELY-DTE (5:2)  TO             10970099
094300                 PV-REFORMAT-TO-DB2-MM                            10980099
094400             MOVE TR024-EDD-PO-BKG-DELY-DTE (7:2)  TO             10990099
094500                 PV-REFORMAT-TO-DB2-DD                            11000099
094600             MOVE PV-REFORMAT-TO-DB2-DTE           TO             11010099
094700                 PV-REFORMAT-10BYTE-FIELD                         11020099
094800             PERFORM 7000-SELECT-TIMBKPO                          11030099
094900             IF PS-TIMBKPO-ROW-IS-THERE                           11040099
095000                 INITIALIZE TR201-RECORD                          11050099
095100                 INITIALIZE TR201-REC-TYP-EDD                     11060099
095200                 PERFORM 6300-PO-THERE-ON-ADD-ERROR               11070099
095300                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                11080099
095400                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              11090099
095500                 PERFORM 7300-INSERT-TOUTTR6-RPT                  11100099
095600             ELSE                                                 11110099
095700                 MOVE SPACES TO IMBKPO-VOY-CHG-RSN-DESC           11120099
095800                 MOVE TR024-EDD-PROCESS-SEQ-NBR                   11130099
095900                         TO PV-HOLD-PROCESS-SEQ-NBR-EDD           11140099
096000                 PERFORM 3000-EDD-EDITS                           11150099
096100                 PERFORM 7010-SELECT-BKG-SEQ-NBR-MAX              11160099
096200                 PERFORM 6425-LIKE-MOVES-INSERT-TIMBKPO           11170099
096300                 PERFORM 6450-MOVES-INSERT-TIMBKPO                11180099
096400             END-IF                                               11190099
096500                                                                  11200099
096600         WHEN PC-EDDRSN                                           11210099
096700             ADD +1                  TO PA-TOT-EDDRSN-RECS-READ   11220099
096800             IF PS-TIMBKPO-ROW-IS-THERE                           11230099
096900                 INITIALIZE TR201-RECORD                          11240099
097000                 INITIALIZE TR201-REC-TYP-EDDRSN                  11250099
097100                 PERFORM 6300-PO-THERE-ON-ADD-ERROR               11260099
097200                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                11270099
097300                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              11280099
097400                 PERFORM 7300-INSERT-TOUTTR6-RPT                  11290099
097500             ELSE                                                 11300099
097600                 MOVE TR024-EDD-PROCESS-SEQ-NBR   TO              11310099
097700                            PV-HOLD-PROCESS-SEQ-NBR-EDDRSN        11320099
097800                 PERFORM 6450-MOVES-INSERT-TIMBKPO                11330099
097900             END-IF                                               11340099
098000         WHEN PC-EDL                                              11350099
098100             ADD +1                  TO PA-TOT-EDL-RECS-READ      11360099
098200             IF PS-TIMBKPO-ROW-IS-THERE                           11370099
098300                 INITIALIZE TR201-RECORD                          11380099
098400                 INITIALIZE TR201-REC-TYP-EDL                     11390099
098500                 PERFORM 6300-PO-THERE-ON-ADD-ERROR               11400099
098600                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                11410099
098700                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              11420099
098800                 PERFORM 7300-INSERT-TOUTTR6-RPT                  11430099
098900             ELSE                                                 11440099
099000                 MOVE TR024-EDD-PROCESS-SEQ-NBR   TO              11450099
099100                            PV-HOLD-PROCESS-SEQ-NBR-EDL           11460099
099200*                PERFORM 3030-EDIT-CNTRY                          11470099
099300***              PERFORM 3035-EDIT-FCTRY-NAME                     11480099
099400                 PERFORM 6450-MOVES-INSERT-TIMBKPO                11490099
099500                 PERFORM 7020-INSERT-TIMBKPO                      11500099
099600                 IF PS-TIMBKPO-ADDED                              11510099
099700                     PERFORM 6700-SCM-PO-BOOKING-ADD              11520099
099701                 END-IF                                           11530099
099702                 IF PS-TIMBKPO-ADDED                              11540099
099703                   AND PS-TPURCHS-ACTIVE                          11550099
099800                    INITIALIZE TM606-RECORD                       11560099
099900                    MOVE PC-BK TO TM606-EXTR-PRCG-APPL-CDE        11570099
100000                    PERFORM A000-INSERT-TOUTTM1                   11580099
100001                 END-IF                                           11590099
100002                 PERFORM 7280-EDD-EDDRSN-EDL-DETAIL               11600099
100003*                SET PS-POE-LBD-NO TO TRUE                        11610099
100004             END-IF                                               11620099
100005         WHEN PC-EDLVS                                            11630099
100006             ADD +1                  TO PA-TOT-EDLVS-RECS-READ    11640099
100100             IF PS-TIMBKPO-ADDED                                  11650099
100200                 CONTINUE                                         11660099
100200*                MOVE TR024-EDLVS-PO-NBR  TO IMBKVS-PO-NBR        11661099
100300*                PERFORM 7100-SELECT-TIMBKVS                      11670099
100400*                IF PS-TIMBKVS-ROW-IS-THERE                       11680099
100500*                   INITIALIZE TR201-RECORD                       11690099
100600*                   INITIALIZE TR201-REC-TYP-EDLVS                11700099
100700*                   PERFORM 6310-VS-THERE-ON-ADD-ERROR            11710099
100800*                   PERFORM 6250-MOVE-LIKE-RPT-FIELDS             11720099
100900*                   PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS           11730099
101000*                   PERFORM 7300-INSERT-TOUTTR6-RPT               11740099
101100*                ELSE                                             11750099
101200*                   PERFORM 3200-EDIT-EDLVS                       11760099
101300*                   PERFORM 6460-MOVES-INSERT-TIMBKVS             11770099
101400*                   PERFORM 7110-INSERT-TIMBKVS                   11780099
101500*                   PERFORM 7285-PREP-DETAIL-TOUTTR6-VS           11790099
101600*                END-IF                                           11800099
101700             ELSE                                                 11810099
101800                 INITIALIZE TR201-RECORD                          11820099
101900                 INITIALIZE TR201-REC-TYP-EDLVS                   11830099
102000                 PERFORM 6300-PO-THERE-ON-ADD-ERROR               11840099
102100                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                11850099
102200                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              11860099
102300                 PERFORM 7300-INSERT-TOUTTR6-RPT                  11870099
102400             END-IF                                               11880099
102500                                                                  11890099
102600         WHEN PC-EDLUPC                                           11900099
102700             ADD +1                  TO PA-TOT-EDLUPC-RECS-READ   11910099
102800*            IF (PS-TIMBKPO-ADDED  AND                            11920099
102900*                PS-TIMBKVS-ADDED)                                11930099
103000*                PERFORM 3300-EDIT-EDLUPC                         11940099
103100*                PERFORM 6470-MOVES-INSERT-TIMBKUP                11950099
103200*                PERFORM 7210-INSERT-TIMBKUP                      11960099
103300*                IF SQLCODE = +0                                  11970099
103400*                    INITIALIZE TR201-RECORD                      11980099
103500*                    INITIALIZE TR201-REC-TYP-EDLUPC              11990099
103600*                    PERFORM 7290-PREP-DETAIL-TOUTTR6-UPC         12000099
103700*                    PERFORM 7300-INSERT-TOUTTR6-RPT              12010099
103800*                ELSE                                             12020099
103900*                  INITIALIZE TR201-RECORD                        12030099
104000*                  INITIALIZE TR201-REC-TYP-EDLUPC                12040099
104100*                  MOVE PC-E                          TO          12050099
104200*                      TR201-RPT-TYP                              12060099
104300*                  MOVE 'UPC NUMBER'                  TO          12070099
104400*                      TR201-DATA-IN-ERROR                        12080099
104500*                  MOVE TR024-EDLUPC-UPC-NBR          TO          12090099
104600*                      TR201-DATA-VALUE                           12100099
104700*                  MOVE PC-ERROR                      TO          12110099
104800*                      TR201-ERROR-TYPE                           12120099
104900*            MOVE 'ADD SENT, UPC PREVIOUSLY SENT-NOT PROCESSED'   12130099
105000*                   TO TR201-ERROR-MSG                            12140099
105100*                  PERFORM 6250-MOVE-LIKE-RPT-FIELDS              12150099
105200*                  PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS            12160099
105300*                  PERFORM 7300-INSERT-TOUTTR6-RPT                12170099
105400*                END-IF                                           12180099
105500*            ELSE                                                 12190099
105600                 IF PS-TIMBKPO-ROW-IS-THERE                       12200099
105700                     INITIALIZE TR201-RECORD                      12210099
105800                     INITIALIZE TR201-REC-TYP-EDLUPC              12220099
105900                     PERFORM 6300-PO-THERE-ON-ADD-ERROR           12230099
106000                     PERFORM 6250-MOVE-LIKE-RPT-FIELDS            12240099
106100                     PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS          12250099
106200                     PERFORM 7300-INSERT-TOUTTR6-RPT              12260099
106300*                ELSE                                             12270099
106400*                    IF PS-TIMBKVS-ROW-IS-THERE                   12280099
106500*                        INITIALIZE TR201-RECORD                  12290099
106600*                        INITIALIZE TR201-REC-TYP-EDLUPC          12300099
106700*                        PERFORM 6310-VS-THERE-ON-ADD-ERROR       12310099
106800*                        PERFORM 6250-MOVE-LIKE-RPT-FIELDS        12320099
106900*                        PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS      12330099
107000*                        PERFORM 7300-INSERT-TOUTTR6-RPT          12340099
107100*                    END-IF                                       12350099
107200                 END-IF                                           12360099
107300*            END-IF                                               12370099
107400                                                                  12380099
107500         WHEN OTHER                                               12390099
107600             INITIALIZE TR201-RECORD                              12400099
107700             PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    12410099
107800                 MOVE PC-E                          TO            12420099
107900                    TR201-RPT-TYP                                 12430099
108000                 MOVE 'RECORD TYPE'                 TO            12440099
108100                    TR201-DATA-IN-ERROR                           12450099
108200                 MOVE TR024-EDD-REC-TYP-CDE         TO            12460099
108300                    SAVE1-DATA-VALUE                              12470099
108400                 MOVE PC-ERROR                      TO            12480099
108500                    TR201-ERROR-TYPE                              12490099
108600             MOVE 'INVALID RECORD TYPE--NOT PROCESSED'            12500099
108700                                       TO TR201-ERROR-MSG         12510099
108800             PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  12520099
108900             PERFORM 7300-INSERT-TOUTTR6-RPT                      12530099
109000     END-EVALUATE.                                                12540099
109100                                                                  12550099
109200     PERFORM 2600-CHECK-HOLD-FIELDS.                              12560099
109300                                                                  12570099
109400     SET PS-GOOD-RECORD-NO TO TRUE.                               12580099
109500     PERFORM 6000-READ-BKG-FILE                                   12590099
109600         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                 12600099
109700                                                                  12610099
109800     PERFORM 2610-RESET-SWITCHES.                                 12620099
109900                                                                  12630099
110000 EJECT                                                            12640099
110100                                                                  12650099
110200******************************************************************12660099
110300* PROCESS CHANGE TRANSACTIONS.                                   *12670099
110400******************************************************************12680099
110500 2300-CHANGE.                                                     12690099
110600                                                                  12700099
110700     EVALUATE TR024-EDD-REC-TYP-CDE                               12710099
110800         WHEN PC-EDD                                              12720099
110900         WHEN PC-EDDRSN                                           12730099
111000         WHEN PC-EDL                                              12740099
111100             PERFORM 2305-PROCESS-EDD-EDL-CHG                     12750099
111200                                                                  12760099
111300         WHEN PC-EDLVS                                            12770099
111400*            PERFORM 2335-PROCESS-EDLVS-CHG                       12781099
111500*            PERFORM 2600-CHECK-HOLD-FIELDS                       12790099
111600*            SET PS-GOOD-RECORD-NO TO TRUE                        12800099
111700*            PERFORM 6000-READ-BKG-FILE                           12810099
111800*                UNTIL PS-GOOD-RECORD OR                          12820099
111900*                      PS-END-OF-INPUT                            12830099
112000             PERFORM 2610-RESET-SWITCHES                          12840099
112100                                                                  12850099
112200         WHEN PC-EDLUPC                                           12860099
112300*            PERFORM 2355-PROCESS-EDLUPC-CHG                      12870099
112400*            PERFORM 2600-CHECK-HOLD-FIELDS                       12880099
112500*            SET PS-GOOD-RECORD-NO TO TRUE                        12890099
112600*            PERFORM 6000-READ-BKG-FILE                           12900099
112700*                UNTIL PS-GOOD-RECORD OR                          12910099
112800*                      PS-END-OF-INPUT                            12920099
112900             PERFORM 2610-RESET-SWITCHES                          12930099
113000                                                                  12940099
113100     END-EVALUATE.                                                12950099
113200                                                                  12960099
113300******************************************************************12970099
113400* PROCESS CHANGE TRANSACTIONS FOR EDD, EDDRSN, AND EDL RECORDS.  *12980099
113500******************************************************************12990099
113600 2305-PROCESS-EDD-EDL-CHG.                                        13000099
113700                                                                  13010099
113800*    INITIALIZE PV-VENDOR-STYLE-UPC-TABLE.                        13020099
113900*    SET VS-INDX TO +1.                                           13030099
114000                                                                  13040099
114100     MOVE TR024-EDD-PO-NBR                   TO                   13050099
114200           IMBKPO-PO-NBR.                                         13060099
114300     MOVE TR024-EDD-PO-BKG-DELY-DTE (1:4)    TO                   13070099
114400           PV-REFORMAT-TO-DB2-CY.                                 13080099
114500     MOVE TR024-EDD-PO-BKG-DELY-DTE (5:2)    TO                   13090099
114600           PV-REFORMAT-TO-DB2-MM.                                 13100099
114700     MOVE TR024-EDD-PO-BKG-DELY-DTE (7:2)    TO                   13110099
114800           PV-REFORMAT-TO-DB2-DD.                                 13120099
114900     MOVE PV-REFORMAT-TO-DB2-DTE             TO                   13130099
115000           PV-REFORMAT-10BYTE-FIELD.                              13140099
115100     PERFORM 7000-SELECT-TIMBKPO.                                 13150099
115200                                                                  13160099
115300     IF PS-TIMBKPO-ROW-IS-THERE                                   13170099
115400         PERFORM 2310-PROCESS-EDD-EDL-LOOP                        13180099
115500     ELSE                                                         13190099
115600         INITIALIZE TR201-RECORD                                  13200099
115700         INITIALIZE TR201-REC-TYP-EDD                             13210099
115800         SET PS-CHANGE-FOUND      TO TRUE                         13220099
115900         SET PS-CHANGE-ADD        TO TRUE                         13230099
116000         MOVE PC-E                TO TR201-RPT-TYP                13240099
116100         MOVE 'PO NUMBER'         TO TR201-DATA-IN-ERROR          13250099
116200         MOVE TR024-EDD-PO-NBR    TO TR201-DATA-VALUE             13260099
116300         MOVE PC-WARNING          TO TR201-ERROR-TYPE             13270099
116400         MOVE 'CHANGE SENT & PO NOT FOUND, PO ADDED'  TO          13280099
116500               TR201-ERROR-MSG                                    13290099
116600         PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        13300099
116700         PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      13310099
116800         PERFORM 7300-INSERT-TOUTTR6-RPT                          13320099
116900         SET PS-ADD-FOR-CHANGES-DONE-NO TO TRUE                   13330099
117000         PERFORM 2325-ADD-FOR-CHANGES                             13340099
117100             UNTIL PS-ADD-FOR-CHANGES-DONE  OR                    13350099
117200                   PS-END-OF-INPUT                                13360099
117300     END-IF.                                                      13370099
117400                                                                  13380099
117500******************************************************************13390099
117600* PROCESS EDD, EDDRSN, & EDL RECORD CHANGE TRANSACTIONS.  THIS   *13400099
117700* PARAGRAPH PERFORMS PARA 2315- WHICH MOVES TR024 INPUT FIELDS   *13410099
117800* INTO THE TIMBKPO DCLGEN FIELDS.                                *13420099
117900******************************************************************13430099
118000 2310-PROCESS-EDD-EDL-LOOP.                                       13440099
118100                                                                  13450099
118200     PERFORM 7630-MOVES-AUDIT-TAUBKPO.                            13460099
118300                                                                  13470099
118400     SET PS-CHANGE-FOUND-PO-NO  TO TRUE.                          13480099
118500     SET PS-EDD-EDDRSN-EDL-LOOP TO TRUE.                          13490099
118600     MOVE SPACES  TO IMBKPO-VOY-CHG-RSN-DESC.                     13500099
118700     MOVE ZEROES  TO PV-SEQ-NBR-EDD                               13510099
118800                     PV-SEQ-NBR-EDDRSN                            13520099
118900                     PV-SEQ-NBR-EDL.                              13530099
119000                                                                  13540099
119100     PERFORM 2315-PROCESS-EDD-EDL-SENT                            13550099
119200         UNTIL (TR024-EDD-REC-TYP-CDE           NOT =             13560099
119300                PC-EDD AND PC-EDDRSN AND PC-EDL)        OR        13570099
119400                PS-EDD-EDDRSN-EDL-LOOP-NO               OR        13580099
119500                PS-END-OF-INPUT.                                  13590099
119600                                                                  13600099
119700     PERFORM 2320-COMPARE-FOR-CHANGES                             13610099
119800     IF PS-CHANGE-FOUND-PO                                        13620099
119900         PERFORM 7635-DELETE-TIMBKPO                              13630099
120000         PERFORM 7645-INSERT-TAUBKPO                              13640099
120100         PERFORM 7999-SET-CURRENT-TMST                            13650099
120200         MOVE PC-CURRENT-PROGRAM-NAME TO IMBKPO-LAST-UPD-BY-USR-ID13660099
120300         MOVE PV-CURRENT-TMST         TO IMBKPO-LAST-UPD-TMST     13670099
120400         PERFORM 7020-INSERT-TIMBKPO                              13680099
120500         PERFORM 7282-TIMBKPO-DCLGEN-TO-DETAIL                    13690099
120600         ADD +1 TO PA-TOT-BKPO-CHANGES                            13700099
120700         ADD +1 TO PA-TOT-RECS-CHANGED                            13710099
120800     END-IF.                                                      13720099
120900                                                                  13730099
121000******************************************************************13740099
121100* MOVE INPUT FIELDS TO TIMBKPO DCLGEN FIELDS.                    *13750099
121200******************************************************************13760099
121300 2315-PROCESS-EDD-EDL-SENT.                                       13770099
121400                                                                  13780099
121500     EVALUATE TR024-EDD-REC-TYP-CDE                               13790099
121600         WHEN PC-EDD                                              13800099
121700             PERFORM 3000-EDD-EDITS                               13810099
121800             MOVE TR024-EDD-PROCESS-SEQ-NBR      TO               13820099
121900                   PV-SEQ-NBR-EDD                                 13830099
122000         WHEN PC-EDDRSN                                           13840099
122100             MOVE TR024-EDDRSN-PROCESS-SEQ-NBR   TO               13850099
122200                   PV-SEQ-NBR-EDDRSN                              13860099
122300         WHEN PC-EDL                                              13870099
122400*            PERFORM 3030-EDIT-CNTRY                              13880099
122500***          PERFORM 3035-EDIT-FCTRY-NAME                         13890099
122600             MOVE TR024-EDL-PROCESS-SEQ-NBR      TO               13900099
122700                   PV-SEQ-NBR-EDL                                 13910099
122800     END-EVALUATE.                                                13920099
122900                                                                  13930099
123000     PERFORM 6450-MOVES-INSERT-TIMBKPO.                           13940099
123100                                                                  13950099
123200*    IF TR024-EDD-REC-TYP-CDE = PC-EDL                            13960099
123300*        SET PS-POE-LBD-NO TO TRUE                                13970099
123400*    END-IF.                                                      13980099
123500                                                                  13990099
123600     PERFORM 2600-CHECK-HOLD-FIELDS.                              14000099
123700                                                                  14010099
123800     SET PS-GOOD-RECORD-NO TO TRUE.                               14020099
123900     PERFORM 6000-READ-BKG-FILE                                   14030099
124000         UNTIL PS-GOOD-RECORD OR                                  14040099
124100               PS-END-OF-INPUT.                                   14050099
124200                                                                  14060099
124300     PERFORM 2610-RESET-SWITCHES.                                 14070099
124400                                                                  14080099
124500******************************************************************14090099
124600* COMPARE THE INPUT FIELDS THAT WERE LOADED INTO THE TIMBKPO     *14100099
124700* DCLGEN FIELDS AGAINST THE TIMBKPO FIELDS THAT WERE LOADED INTO *14110099
124800* THE TAUBKPO FIELDS TO SEE IF A CHANGE HAS OCCURRED.            *14120099
124900******************************************************************14130099
125000 2320-COMPARE-FOR-CHANGES.                                        14140099
125100                                                                  14150099
125200     IF (AUBKPO-IMPRT-TRIP-ID      NOT EQUAL                      14160099
125300                                  IMBKPO-IMPRT-TRIP-ID)       OR  14170099
125400        (AUBKPO-CARR-SCAC-ID       NOT EQUAL                      14180099
125500                                  IMBKPO-CARR-SCAC-ID)        OR  14190099
125600        (AUBKPO-IMPRT-VEH-NM       NOT EQUAL                      14200099
125700                                  IMBKPO-IMPRT-VEH-NM)        OR  14210099
125800        (AUBKPO-FOB-CDE            NOT EQUAL                      14220099
125900                                  IMBKPO-FOB-CDE)             OR  14230099
126000        (AUBKPO-DEST-POE-CDE       NOT EQUAL                      14240099
126100                                  IMBKPO-DEST-POE-CDE)        OR  14250099
126200        (AUBKPO-TRIP-TYP-CDE       NOT EQUAL                      14260099
126300                                  IMBKPO-TRIP-TYP-CDE)        OR  14270099
126400        (AUBKPO-POE-DELY-TMST      NOT EQUAL                      14280099
126500                                  IMBKPO-POE-DELY-TMST)       OR  14290099
126600        (AUBKPO-DPRTR-TMST         NOT EQUAL                      14300099
126700                                  IMBKPO-DPRTR-TMST)          OR  14310099
126800        (AUBKPO-VOY-CHG-RSN-DESC   NOT EQUAL                      14320099
126900                                  IMBKPO-VOY-CHG-RSN-DESC)    OR  14330099
127000        (AUBKPO-PO-CART-CNT        NOT EQUAL                      14340099
127100                                  IMBKPO-PO-CART-CNT)         OR  14350099
127200        (AUBKPO-PO-UNT-QTY         NOT EQUAL                      14360099
127300                                  IMBKPO-PO-UNT-QTY)          OR  14370099
127400        (AUBKPO-PROD-FCTRY-NM      NOT EQUAL                      14380099
127500                                  IMBKPO-PROD-FCTRY-NM)       OR  14390099
127600        (AUBKPO-C-O-PROD-CDE       NOT EQUAL                      14400099
127700                                  IMBKPO-C-O-PROD-CDE)        OR  14410099
127800        (AUBKPO-PO-CBMT-QTY        NOT EQUAL                      14420099
127900                                  IMBKPO-PO-CBMT-QTY)         OR  14430099
128000        (AUBKPO-PO-WT-KGRM-QTY     NOT EQUAL                      14440099
128100                                  IMBKPO-PO-WT-KGRM-QTY)      OR  14450099
128200        (AUBKPO-ORGN-SHPD-FR-CDE   NOT EQUAL                      14460099
128300                                  IMBKPO-ORGN-SHPD-FR-CDE)    OR  14470099
128400        (AUBKPO-CONSLR-SCAC-ID     NOT EQUAL                      14480099
128500                                  IMBKPO-CONSLR-SCAC-ID)      OR  14490099
128600        (AUBKPO-EST-LBD-NM         NOT EQUAL                      14500099
128700                                  IMBKPO-EST-LBD-NM)          OR  14510099
128800        (AUBKPO-EST-LBD-TMST       NOT EQUAL                      14520099
128900                                  IMBKPO-EST-LBD-TMST)            14530099
129000        SET PS-CHANGE-FOUND-PO  TO TRUE                           14540099
129100        SET PS-CHANGE-FOUND     TO TRUE                           14550099
129200     END-IF.                                                      14560099
129300                                                                  14570099
129400******************************************************************14580099
129500* PROCESS EDD, EDDRSN, AND EDL ADDS FOR CHANGE TRANSACTIONS.     *14590099
129600* THESE TRANSACTIONS ARE REFERED TO AS 'B' CHANGE ADDS.          *14600099
129700******************************************************************14610099
129800 2325-ADD-FOR-CHANGES.                                            14620099
129900                                                                  14630099
130000     EVALUATE TR024-EDD-REC-TYP-CDE                               14640099
130100         WHEN PC-EDD                                              14650099
130200             MOVE SPACES TO IMBKPO-VOY-CHG-RSN-DESC               14660099
130300             ADD +1 TO PA-TOT-EDD-RECS-READ                       14670099
130400             MOVE TR024-EDD-PROCESS-SEQ-NBR TO                    14680099
130500                   PV-HOLD-PROCESS-SEQ-NBR-EDD                    14690099
130600             PERFORM 3000-EDD-EDITS                               14700099
130700             PERFORM 7010-SELECT-BKG-SEQ-NBR-MAX                  14710099
130800             PERFORM 6425-LIKE-MOVES-INSERT-TIMBKPO               14720099
130900             PERFORM 6450-MOVES-INSERT-TIMBKPO                    14730099
131000                                                                  14740099
131100         WHEN PC-EDDRSN                                           14750099
131200             ADD +1                  TO PA-TOT-EDDRSN-RECS-READ   14760099
131300             MOVE TR024-EDD-PROCESS-SEQ-NBR      TO               14770099
131400                   PV-HOLD-PROCESS-SEQ-NBR-EDDRSN                 14780099
131500             PERFORM 6450-MOVES-INSERT-TIMBKPO                    14790099
131600                                                                  14800099
131700         WHEN PC-EDL                                              14810099
131800             ADD +1                  TO PA-TOT-EDL-RECS-READ      14820099
131900             MOVE TR024-EDD-PROCESS-SEQ-NBR      TO               14830099
132000                   PV-HOLD-PROCESS-SEQ-NBR-EDL                    14840099
132100*            PERFORM 3030-EDIT-CNTRY                              14850099
132200***          PERFORM 3035-EDIT-FCTRY-NAME                         14860099
132300             PERFORM 6450-MOVES-INSERT-TIMBKPO                    14870099
132310             PERFORM 6600-SCM-NAIL-DOWN-CHANGE                    14880099
132400             PERFORM 7020-INSERT-TIMBKPO                          14890099
132500             IF PS-TIMBKPO-ADDED                                  14900099
132600               AND PS-TPURCHS-ACTIVE                              14910099
132700                INITIALIZE TM606-RECORD                           14920099
132800                MOVE PC-BK TO TM606-EXTR-PRCG-APPL-CDE            14930099
132900                PERFORM A000-INSERT-TOUTTM1                       14940099
132901             END-IF                                               14950099
132902             ADD +1                  TO PA-TOT-BKPO-CHANGES-B     14960099
132903             ADD +1                  TO PA-TOT-RECS-CHANGED-B     14970099
132904             SET PS-CHANGE-ADD       TO TRUE                      14980099
132905             PERFORM 7280-EDD-EDDRSN-EDL-DETAIL                   14990099
132906             SET PS-CHANGE-ADD-NO    TO TRUE                      15000099
133000             SET PS-CHANGE-ADD-B     TO TRUE                      15010099
133100*            SET PS-POE-LBD-NO       TO TRUE                      15020099
133200                                                                  15030099
133300         WHEN PC-EDLVS                                            15040099
133400             CONTINUE                                             15050099
133400*            SET PS-CHANGE-ADD       TO TRUE                      15051099
133500*            PERFORM 2347-CHANGE-ADD-VS-ERROR                     15060099
133600*            ADD +1                  TO PA-TOT-EDLVS-RECS-READ    15070099
133700*            PERFORM 3200-EDIT-EDLVS                              15080099
133800*            PERFORM 6460-MOVES-INSERT-TIMBKVS                    15090099
133900*            PERFORM 7110-INSERT-TIMBKVS                          15100099
134000*            PERFORM 7285-PREP-DETAIL-TOUTTR6-VS                  15110099
134100*            SET PS-CHANGE-ADD-NO    TO TRUE                      15120099
134200*            ADD +1                  TO PA-TOT-BKVS-CHANGES-B     15130099
134300*            ADD +1                  TO PA-TOT-RECS-CHANGED-B     15140099
134400                                                                  15150099
134500         WHEN PC-EDLUPC                                           15160099
133400             CONTINUE                                             15161099
134600*            SET PS-CHANGE-ADD       TO TRUE                      15170099
134700*            PERFORM 2357-CHANGE-ADD-UPC-ERROR                    15180099
134800*            ADD +1                  TO PA-TOT-EDLUPC-RECS-READ   15190099
134900*            PERFORM 3300-EDIT-EDLUPC                             15200099
135000*            PERFORM 6470-MOVES-INSERT-TIMBKUP                    15210099
135100*            PERFORM 7210-INSERT-TIMBKUP                          15220099
135200*            IF SQLCODE = +0                                      15230099
135300*                PERFORM 7290-PREP-DETAIL-TOUTTR6-UPC             15240099
135400*                PERFORM 7300-INSERT-TOUTTR6-RPT                  15250099
135500*                SET PS-CHANGE-ADD-NO    TO TRUE                  15260099
135600*                ADD +1              TO PA-TOT-BKUP-CHANGES-B     15270099
135700*                ADD +1              TO PA-TOT-RECS-CHANGED-B     15280099
135800*            ELSE                                                 15290099
135900*                INITIALIZE TR201-RECORD                          15300099
136000*                INITIALIZE TR201-REC-TYP-EDLUPC                  15310099
136100*                MOVE PC-E                  TO TR201-RPT-TYP      15320099
136200*                MOVE 'UPC NUMBER'          TO TR201-DATA-IN-ERROR15330099
136300*                MOVE TR024-EDLUPC-UPC-NBR  TO TR201-DATA-VALUE   15340099
136400*                MOVE PC-ERROR              TO TR201-ERROR-TYPE   15350099
136500*                MOVE 'UPC FOUND SO UPC NOT ADDED'  TO            15360099
136600*                      TR201-ERROR-MSG                            15370099
136700*                PERFORM 6250-MOVE-LIKE-RPT-FIELDS                15380099
136800*                PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              15390099
136900*                PERFORM 7300-INSERT-TOUTTR6-RPT                  15400099
137000*                SET PS-CHANGE-ADD-NO       TO TRUE               15410099
137100*            END-IF                                               15420099
137200                                                                  15430099
137300     END-EVALUATE.                                                15440099
137400                                                                  15450099
137500     PERFORM 2600-CHECK-HOLD-FIELDS.                              15460099
137600                                                                  15470099
137700     SET PS-GOOD-RECORD-NO TO TRUE.                               15480099
137800     PERFORM 6000-READ-BKG-FILE                                   15490099
137900         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                 15500099
138000                                                                  15510099
138100     PERFORM 2610-RESET-SWITCHES.                                 15520099
138200                                                                  15530099
138300******************************************************************15540099
138400* PROCESS EDLVS AND EDLUPC ADDS FOR CHANGE TRANSACTIONS.         *15550099
138500* THESE TRANSACTIONS ARE REFERED TO AS 'Z' CHANGE ADDS.          *15560099
138600******************************************************************15570099
138700*2330-ADD-FOR-CHANGES-VS-UPC.                                     15580099
138800                                                                  15590099
138900*    EVALUATE TR024-EDD-REC-TYP-CDE                               15600099
139000*        WHEN PC-EDLVS                                            15610099
139100*            ADD +1                  TO PA-TOT-EDLVS-RECS-READ    15620099
139200*            SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                  15630099
139300*            PERFORM 3200-EDIT-EDLVS                              15640099
139400*            PERFORM 6460-MOVES-INSERT-TIMBKVS                    15650099
139500*            PERFORM 7110-INSERT-TIMBKVS                          15660099
139600*            PERFORM 7285-PREP-DETAIL-TOUTTR6-VS                  15670099
139700*            SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE               15680099
139800*            IF PS-CHANGE-ADD-B                                   15690099
139900*                CONTINUE                                         15700099
140000*            ELSE                                                 15710099
140100*                ADD +1 TO PA-TOT-BKVS-CHANGES-Z                  15720099
140200*                ADD +1 TO PA-TOT-RECS-CHANGED-Z                  15730099
140300*                PERFORM 2350-LOAD-VS-UPC-TABLE-VS                15740099
140400*            END-IF                                               15750099
140500                                                                  15760099
140600*        WHEN PC-EDLUPC                                           15770099
140700*            ADD +1                  TO PA-TOT-EDLUPC-RECS-READ   15780099
140800*            SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                  15790099
140900*            PERFORM 3300-EDIT-EDLUPC                             15800099
141000*            PERFORM 6470-MOVES-INSERT-TIMBKUP                    15810099
141100*            PERFORM 7210-INSERT-TIMBKUP                          15820099
141200*            PERFORM 7290-PREP-DETAIL-TOUTTR6-UPC                 15830099
141300*            PERFORM 7300-INSERT-TOUTTR6-RPT                      15840099
141400*            SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE               15850099
141500*            IF PS-CHANGE-ADD-B                                   15860099
141600*                CONTINUE                                         15870099
141700*            ELSE                                                 15880099
141800*                ADD +1 TO PA-TOT-BKUP-CHANGES-Z                  15890099
141900*                ADD +1 TO PA-TOT-RECS-CHANGED-Z                  15900099
142000*                PERFORM 2370-LOAD-VS-UPC-TABLE-UPC               15910099
142100*            END-IF                                               15920099
142200                                                                  15930099
142300*    END-EVALUATE.                                                15940099
142400                                                                  15950099
142500******************************************************************15960099
142600* PROCESS VENDOR STYLE RECORD CHANGE TRANSACTIONS.               *15970099
142700******************************************************************15980099
142800*2335-PROCESS-EDLVS-CHG.                                          15990099
142900                                                                  16000099
143000*    SET PS-CHANGE-FOUND-VS-NO TO TRUE.                           16010099
143100                                                                  16020099
143200*    MOVE TR024-EDLVS-PO-NBR TO IMBKVS-PO-NBR.                    16030099
143300*    PERFORM 7100-SELECT-TIMBKVS.                                 16040099
143400*    IF PS-TIMBKVS-ROW-IS-THERE                                   16050099
143500*        PERFORM 2340-PROCESS-EDLVS-CHG-EDLVS                     16060099
143600*    ELSE                                                         16070099
143700*        SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                      16080099
143800*        PERFORM 2347-CHANGE-ADD-VS-ERROR                         16090099
143900*        SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE                   16100099
144000*        PERFORM 2330-ADD-FOR-CHANGES-VS-UPC                      16110099
144100*        SET PS-CHANGE-FOUND TO TRUE                              16120099
144200*    END-IF.                                                      16130099
144300                                                                  16140099
144400******************************************************************16150099
144500* PROCESS VENDOR STYLE RECORD CHANGE TRANSACTIONS.               *16160099
144600******************************************************************16170099
144700*2340-PROCESS-EDLVS-CHG-EDLVS.                                    16180099
144800                                                                  16190099
144900*    SET PS-CHANGE-C-VS  TO TRUE.                                 16200099
145000                                                                  16210099
145100*    PERFORM 7530-MOVES-AUDIT-TAUBKVS.                            16220099
145200                                                                  16230099
145300*    PERFORM 3200-EDIT-EDLVS.                                     16240099
145400                                                                  16250099
145500*    PERFORM 6460-MOVES-INSERT-TIMBKVS.                           16260099
145600                                                                  16270099
145700*    PERFORM 2345-COMPARE-EDLVS-CHG.                              16280099
145800*    IF PS-CHANGE-FOUND-VS                                        16290099
145900*        PERFORM 7540-DELETE-TIMBKVS-CHG                          16300099
146000*        PERFORM 7545-INSERT-TAUBKVS                              16310099
146100*        PERFORM 7110-INSERT-TIMBKVS                              16320099
146200*        PERFORM 7285-PREP-DETAIL-TOUTTR6-VS                      16330099
146300*        ADD +1 TO PA-TOT-BKVS-CHANGES                            16340099
146400*        ADD +1 TO PA-TOT-RECS-CHANGED                            16350099
146500*    END-IF.                                                      16360099
146600                                                                  16370099
146700*    SET PS-CHANGE-C-VS-NO  TO TRUE.                              16380099
146800                                                                  16390099
146900*    PERFORM 2350-LOAD-VS-UPC-TABLE-VS.                           16400099
147000                                                                  16410099
147100******************************************************************16420099
147200* COMPARE TAUBKVS DCLGEN FIELDS AGAINST TIMBKVS DCLGEN FIELDS TO *16430099
147300* SEE IF A CHANGE HAS OCCURRED.                                  *16440099
147400******************************************************************16450099
147500*2345-COMPARE-EDLVS-CHG.                                          16460099
147600*                                                                 16470099
147700*    IF (AUBKVS-VS-CART-CNT          NOT EQUAL                    16480099
147800*                                 IMBKVS-VS-CART-CNT)         OR  16490099
147900*       (AUBKVS-VS-UNT-QTY           NOT EQUAL                    16500099
148000*                                 IMBKVS-VS-UNT-QTY)          OR  16510099
148100*       (AUBKVS-VS-CBMT-QTY          NOT EQUAL                    16520099
148200*                                 IMBKVS-VS-CBMT-QTY)         OR  16530099
148300*       (AUBKVS-VS-WT-KGRM-QTY       NOT EQUAL                    16540099
148400*                                 IMBKVS-VS-WT-KGRM-QTY)          16550099
148500*       SET PS-CHANGE-FOUND-VS TO TRUE                            16560099
148600*       SET PS-CHANGE-FOUND    TO TRUE                            16570099
148700*    END-IF.                                                      16580099
148800                                                                  16590099
148900******************************************************************16600099
149000* ERROR FOR CONDITION WHERE A VS CHANGE IS SENT AND NO VS EXISTS.*16610099
149100******************************************************************16620099
149200*2347-CHANGE-ADD-VS-ERROR.                                        16630099
149300                                                                  16640099
149400*    INITIALIZE TR201-RECORD.                                     16650099
149500*    INITIALIZE TR201-REC-TYP-EDLVS.                              16660099
149600*    MOVE PC-E                TO TR201-RPT-TYP.                   16670099
149700*    MOVE 'VS NUMBER'         TO TR201-DATA-IN-ERROR.             16680099
149800*    MOVE TR024-EDLVS-VS-NBR  TO TR201-DATA-VALUE.                16690099
149900*    MOVE PC-WARNING          TO TR201-ERROR-TYPE.                16700099
150000*    MOVE 'CHANGE SENT & VS NOT FOUND, VS ADDED'  TO              16710099
150100*          TR201-ERROR-MSG.                                       16720099
150200*    PERFORM 6250-MOVE-LIKE-RPT-FIELDS.                           16730099
150300*    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS.                         16740099
150400*    PERFORM 7300-INSERT-TOUTTR6-RPT.                             16750099
150500                                                                  16760099
150600******************************************************************16770099
150700* LOAD THE VENDOR STYLE / UPC TABLE WITH THE VENDOR STYLE NBR.   *16780099
150800******************************************************************16790099
150900*2350-LOAD-VS-UPC-TABLE-VS.                                       16800099
151000                                                                  16810099
151100*    MOVE TR024-EDLVS-VS-NBR TO PV-TABLE-VS-NBR (VS-INDX).        16820099
151200*    SET VS-INDX UP BY +1.                                        16830099
151300                                                                  16840099
151400******************************************************************16850099
151500* PROCESS UPC RECORD CHANGE TRANSACTIONS.                        *16860099
151600******************************************************************16870099
151700*2355-PROCESS-EDLUPC-CHG.                                         16880099
151800                                                                  16890099
151900*    SET PS-CHANGE-FOUND-UPC-NO TO TRUE.                          16900099
152000                                                                  16910099
152100*    MOVE TR024-EDLUPC-PO-NBR  TO IMBKUP-PO-NBR.                  16920099
152200*    MOVE TR024-EDLUPC-VS-NBR  TO IMBKUP-VS-NBR.                  16930099
152300*    MOVE TR024-EDLUPC-UPC-NBR TO IMBKUP-UPC-NBR.                 16940099
152400*    PERFORM 7200-SELECT-TIMBKUP.                                 16950099
152500*    IF PS-TIMBKUP-ROW-IS-THERE                                   16960099
152600*        PERFORM 2360-PROCESS-EDLUPC-CHG-EDLUPC                   16970099
152700*    ELSE                                                         16980099
152800*        SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                      16990099
152900*        PERFORM 2357-CHANGE-ADD-UPC-ERROR                        17000099
153000*        SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE                   17010099
153100*        PERFORM 2330-ADD-FOR-CHANGES-VS-UPC                      17020099
153200*        SET PS-CHANGE-FOUND TO TRUE                              17030099
153300*    END-IF.                                                      17040099
153400                                                                  17050099
153500******************************************************************17060099
153600* ERROR FOR CONDITION WHERE UPC CHANGE IS SENT AND NO UPC EXISTS.*17070099
153700******************************************************************17080099
153800*2357-CHANGE-ADD-UPC-ERROR.                                       17090099
153900                                                                  17100099
154000*    INITIALIZE TR201-RECORD.                                     17110099
154100*    INITIALIZE TR201-REC-TYP-EDLUPC.                             17120099
154200*    MOVE PC-E                  TO TR201-RPT-TYP.                 17130099
154300*    MOVE 'UPC NUMBER'          TO TR201-DATA-IN-ERROR.           17140099
154400*    MOVE TR024-EDLUPC-UPC-NBR  TO TR201-DATA-VALUE.              17150099
154500*    MOVE PC-WARNING            TO TR201-ERROR-TYPE.              17160099
154600*    MOVE 'CHANGE SENT & UPC NOT FOUND, UPC ADDED'  TO            17170099
154700*          TR201-ERROR-MSG.                                       17180099
154800*    PERFORM 6250-MOVE-LIKE-RPT-FIELDS.                           17190099
154900*    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS.                         17200099
155000*    PERFORM 7300-INSERT-TOUTTR6-RPT.                             17210099
155100                                                                  17220099
155200******************************************************************17230099
155300* PROCESS UPC RECORD CHANGE TRANSACTIONS.                        *17240099
155400******************************************************************17250099
155500*2360-PROCESS-EDLUPC-CHG-EDLUPC.                                  17260099
155600                                                                  17270099
155700*    SET PS-CHANGE-C-UPC  TO TRUE.                                17280099
155800                                                                  17290099
155900*    PERFORM 7430-MOVES-AUDIT-TAUBKUP.                            17300099
156000                                                                  17310099
156100*    PERFORM 3300-EDIT-EDLUPC.                                    17320099
156200                                                                  17330099
156300*    PERFORM 6470-MOVES-INSERT-TIMBKUP.                           17340099
156400                                                                  17350099
156500*    PERFORM 2365-COMPARE-EDLUPC-CHG                              17360099
156600*    IF PS-CHANGE-FOUND-UPC                                       17370099
156700*        PERFORM 7440-DELETE-TIMBKUP-CHG                          17380099
156800*        PERFORM 7445-INSERT-TAUBKUP                              17390099
156900*        PERFORM 7210-INSERT-TIMBKUP                              17400099
157000*        PERFORM 7290-PREP-DETAIL-TOUTTR6-UPC                     17410099
157100*        PERFORM 7300-INSERT-TOUTTR6-RPT                          17420099
157200*        ADD +1 TO PA-TOT-BKUP-CHANGES                            17430099
157300*        ADD +1 TO PA-TOT-RECS-CHANGED                            17440099
157400*    END-IF.                                                      17450099
157500                                                                  17460099
157600*    SET PS-CHANGE-C-UPC-NO  TO TRUE.                             17470099
157700                                                                  17480099
157800*    PERFORM 2370-LOAD-VS-UPC-TABLE-UPC.                          17490099
157900                                                                  17500099
158000******************************************************************17510099
158100* COMPARE TAUBKUP DCLGEN FIELDS WITH TIMBKUP DCLGEN FIELDS TO    *17520099
158200* SEE IF A CHANGE HAS OCCURRED.                                  *17530099
158300******************************************************************17540099
158400*2365-COMPARE-EDLUPC-CHG.                                         17550099
158500*                                                                 17560099
158600*    IF (AUBKUP-UPC-CART-CNT       NOT EQUAL                      17570099
158700*                                 IMBKUP-UPC-CART-CNT)        OR  17580099
158800*       (AUBKUP-UPC-UNT-QTY        NOT EQUAL                      17590099
158900*                                 IMBKUP-UPC-UNT-QTY)         OR  17600099
159000*       (AUBKUP-UPC-CBMT-QTY       NOT EQUAL                      17610099
159100*                                 IMBKUP-UPC-CBMT-QTY)        OR  17620099
159200*       (AUBKUP-UPC-WT-KGRM-QTY    NOT EQUAL                      17630099
159300*                                 IMBKUP-UPC-WT-KGRM-QTY)         17640099
159400*       SET PS-CHANGE-FOUND-UPC TO TRUE                           17650099
159500*       SET PS-CHANGE-FOUND     TO TRUE                           17660099
159600*    END-IF.                                                      17670099
159700                                                                  17680099
159800******************************************************************17690099
159900* LOAD THE VENDOR STYLE / UPC TABLE WITH THE UPC NUMBER.         *17700099
160000******************************************************************17710099
160100*2370-LOAD-VS-UPC-TABLE-UPC.                                      17720099
160200                                                                  17730099
160300*    SET VS-INDX TO +1.                                           17740099
160400                                                                  17750099
160500*    SEARCH PV-VS-UPC-TABLE VARYING VS-INDX                       17760099
160600                                                                  17770099
160700*       AT END                                                    17780099
160800*              CONTINUE                                           17790099
160900*       WHEN TR024-EDLUPC-VS-NBR EQUAL PV-TABLE-VS-NBR (VS-INDX)  17800099
161000*           IF PV-TABLE-UPC-NBR (VS-INDX) EQUAL ZEROES            17810099
161100*               MOVE TR024-EDLUPC-UPC-NBR       TO                17820099
161200*                         PV-TABLE-UPC-NBR (VS-INDX)              17830099
161300*           ELSE                                                  17840099
161400*               PERFORM UNTIL PV-TABLE-VS-NBR (VS-INDX)           17850099
161500*                              EQUAL SPACES OR                    17860099
161600*                              VS-INDX > 2000                     17870099
161700*                   SET VS-INDX UP BY +1                          17880099
161800*               END-PERFORM                                       17890099
161900*               MOVE TR024-EDLUPC-VS-NBR        TO                17900099
162000*                         PV-TABLE-VS-NBR (VS-INDX)               17910099
162100*               MOVE TR024-EDLUPC-UPC-NBR       TO                17920099
162200*                         PV-TABLE-UPC-NBR (VS-INDX)              17930099
162300*           END-IF                                                17940099
162400*    END-SEARCH.                                                  17950099
162500                                                                  17960099
162600*    SET VS-INDX UP BY +1.                                        17970099
162700                                                                  17980099
162800******************************************************************17990099
162900* DETERMINE IF IT'S TIME TO PROCESS THE VS/UPC INTERNAL TABLE.   *18000099
163000******************************************************************18010099
163100*2375-TABLE-COMPARE-CHECK.                                        18020099
163200                                                                  18030099
163300*    PERFORM 7350-OPEN-BKVS-UPC-CURSOR.                           18040099
163400*    PERFORM 7360-FETCH-BKVS-UPC-CURSOR.                          18050099
163500                                                                  18060099
163600*    IF PS-EOC-BKVS-UPC-CURSOR                                    18070099
163700*        PERFORM 7355-CLOSE-BKVS-UPC-CURSOR                       18080099
163800*    ELSE                                                         18090099
163900*        MOVE PV-UPC-CURSOR-VS-NBR TO PV-HOLD-CURSOR-VS-NBR       18100099
164000*        PERFORM 2380-TABLE-CURSOR-COMPARE                        18110099
164100*            UNTIL PS-EOC-BKVS-UPC-CURSOR                         18120099
164200*        SET PS-EOC-BKVS-UPC-CURSOR-NO TO TRUE                    18130099
164300*    END-IF.                                                      18140099
164400                                                                  18150099
164500******************************************************************18160099
164600* COMPARE THE VENDOR STYLES / UPCS ON THE INTERNAL TABLE (WHICH  *18170099
164700* WAS LOADED WITH INPUT DATA) WITH THE ONES IN THE CURSOR FROM   *18180099
164800* THE TIMBKVS AND TIMBKUP TABLES.  THE OBJECTIVE OF THIS COMPARE *18190099
164900* IS TO IDENTIFY THE VENDOR STYLES AND/OR UPC'S ON THE DB2       *18200099
165000* TABLES (THESE ROWS WOULD BE IN THE CURSOR) THAT WERE NOT SENT  *18210099
165100* WITH THE INPUT CHANGE TRANSACTION ( THESE RECORDS WOULD BE IN  *18220099
165200* THE INTERNAL TABLE) AND DELETE THESE ROWS FROM THE TIMBKVS AND *18230099
165300* TIMBKUP TABLES.  THESE RECORDS ARE REFERED TO AS 'E' DELETES.  *18240099
165400******************************************************************18250099
165500*2380-TABLE-CURSOR-COMPARE.                                       18260099
165600                                                                  18270099
165700*    SET VS-INDX       TO +1.                                     18280099
165800*    SEARCH PV-VS-UPC-TABLE VARYING VS-INDX                       18290099
165900                                                                  18300099
166000*          AT END                                                 18310099
166100*            PERFORM 2385-PROCESS-SEARCH-AT-END-ERR               18320099
166200*            PERFORM 7355-CLOSE-BKVS-UPC-CURSOR                   18330099
166300                                                                  18340099
166400*          WHEN PV-TABLE-VS-NBR (VS-INDX) EQUAL SPACES            18350099
166500*              PERFORM 2390-PROCESS-VS-E-DELETE-REC               18360099
166600*              IF PV-UPC-CURSOR-VS-NBR NOT EQUAL                  18370099
166700*                 PV-HOLD-CURSOR-VS-NBR                           18380099
166800*                  MOVE PV-UPC-CURSOR-VS-NBR TO                   18390099
166900*                        PV-HOLD-CURSOR-VS-NBR                    18400099
167000*                  PERFORM 7360-FETCH-BKVS-UPC-CURSOR             18410099
167100*                      UNTIL (PV-UPC-CURSOR-VS-NBR NOT =          18420099
167200*                            PV-HOLD-CURSOR-VS-NBR)    OR         18430099
167300*                            PS-EOC-BKVS-UPC-CURSOR               18440099
167400*                  IF PS-EOC-BKVS-UPC-CURSOR                      18450099
167500*                      PERFORM 7355-CLOSE-BKVS-UPC-CURSOR         18460099
167600*                  END-IF                                         18470099
167700*              ELSE                                               18480099
167800*              PERFORM UNTIL (PV-UPC-CURSOR-VS-NBR NOT EQUAL      18490099
167900*                             PV-HOLD-CURSOR-VS-NBR)    OR        18500099
168000*                             PS-EOC-BKVS-UPC-CURSOR              18510099
168100*                 MOVE PV-UPC-CURSOR-VS-NBR TO                    18520099
168200*                       PV-HOLD-CURSOR-VS-NBR                     18530099
168300*                 PERFORM 7360-FETCH-BKVS-UPC-CURSOR              18540099
168400*                 IF PS-EOC-BKVS-UPC-CURSOR                       18550099
168500*                     PERFORM 7355-CLOSE-BKVS-UPC-CURSOR          18560099
168600*                 END-IF                                          18570099
168700*              END-PERFORM                                        18580099
168800*              END-IF                                             18590099
168900                                                                  18600099
169000*          WHEN PV-TABLE-VS-NBR (VS-INDX) EQUAL                   18610099
169100*                PV-UPC-CURSOR-VS-NBR                             18620099
169200*              MOVE PV-UPC-CURSOR-VS-NBR  TO                      18630099
169300*                    PV-HOLD-CURSOR-VS-NBR                        18640099
169400*              PERFORM UNTIL (PV-UPC-CURSOR-VS-NBR NOT EQUAL      18650099
169500*                       PV-HOLD-CURSOR-VS-NBR)     OR             18660099
169600*                       PS-EOC-BKVS-UPC-CURSOR                    18670099
169700*                                                                 18680099
169800*                  SEARCH PV-VS-UPC-TABLE VARYING VS-INDX         18690099
169900*                        AT END                                   18700099
170000*                          PERFORM 2385-PROCESS-SEARCH-AT-END-ERR 18710099
170100*                          PERFORM 7355-CLOSE-BKVS-UPC-CURSOR     18720099
170200*                                                                 18730099
170300*                        WHEN PV-TABLE-UPC-NBR (VS-INDX) = ZEROES 18740099
170400*                            PERFORM 2395-PROCESS-UPC-E-DELETE-REC18750099
170500*                            MOVE PV-UPC-CURSOR-VS-NBR TO         18760099
170600*                                  PV-HOLD-CURSOR-VS-NBR          18770099
170700*                            PERFORM 7360-FETCH-BKVS-UPC-CURSOR   18780099
170800*                            SET VS-INDX TO +1                    18790099
170900*                            IF PS-EOC-BKVS-UPC-CURSOR            18800099
171000*                                PERFORM                          18810099
171100*                                  7355-CLOSE-BKVS-UPC-CURSOR     18820099
171200*                            END-IF                               18830099
171300*                                                                 18840099
171400*                        WHEN (PV-UPC-CURSOR-UPC-NBR EQUAL        18850099
171500*                              PV-TABLE-UPC-NBR (VS-INDX))        18860099
171600*                             AND                                 18870099
171700*                             (PV-UPC-CURSOR-VS-NBR EQUAL         18880099
171800*                              PV-TABLE-VS-NBR (VS-INDX))         18890099
171900*                             MOVE PV-UPC-CURSOR-VS-NBR TO        18900099
172000*                                   PV-HOLD-CURSOR-VS-NBR         18910099
172100*                             PERFORM 7360-FETCH-BKVS-UPC-CURSOR  18920099
172200*                             SET VS-INDX TO +1                   18930099
172300*                             IF PS-EOC-BKVS-UPC-CURSOR           18940099
172400*                                 PERFORM                         18950099
172500*                                   7355-CLOSE-BKVS-UPC-CURSOR    18960099
172600*                             END-IF                              18970099
172700*                  END-SEARCH                                     18980099
172800*              END-PERFORM                                        18990099
172900*    END-SEARCH.                                                  19000099
173000                                                                  19010099
173100******************************************************************19020099
173200* THE INTERNAL VS/UPC TABLE HAS EXCEEDED ITS SIZE LIMIT.         *19030099
173300* NOTE:  SOME VS AND/OR UPC'S THAT SHOULD HAVE BEEN DELETED MAY  *19040099
173400* NOT HAVE BEEN DELETED.                                         *19050099
173500******************************************************************19060099
173600*2385-PROCESS-SEARCH-AT-END-ERR.                                  19070099
173700                                                                  19080099
173800*    INITIALIZE TR201-RECORD.                                     19090099
173900*    INITIALIZE TR201-REC-TYP-EDD.                                19100099
174000*    MOVE PC-E                          TO TR201-RPT-TYP.         19110099
174100*    MOVE PV-HOLD-TR024-PO-NBR          TO TR201-PO-NBR.          19120099
174200*    MOVE PV-HOLD-TR024-EXTL-REF-NBR    TO TR201-EXTL-REF-NBR.    19130099
174300*    MOVE PV-HOLD-TR024-PO-BKG-DELY-DTE TO TR201-PO-BKG-DELY-DTE. 19140099
174400*    MOVE PV-HOLD-ORGN-SHPD-FR-CDE                                19150099
174500*                                      TO TR201-ORGN-SHPD-FR-CDE. 19160099
174600*    MOVE TR024-EDD-PROCESS-SEQ-NBR     TO TR201-PROCESS-SEQ-NBR. 19170099
174700*    MOVE SPACES                        TO TR201-REC-TYP-EDD      19180099
174800*                                          TR201-DATA-IN-ERROR    19190099
174900*                                          TR201-DATA-VALUE       19200099
175000*                                          TR201-TRN-TYP          19210099
175100*                                          TR201-PO-BKG-DELY-TM.  19220099
175200*    MOVE PC-ERROR                      TO TR201-ERROR-TYPE.      19230099
175300*    MOVE 'CALL PROGRAMMING- INTERNAL TABLE SIZE EXCEEDED'        19240099
175400*                                       TO TR201-ERROR-MSG.       19250099
175500*    PERFORM 7300-INSERT-TOUTTR6-RPT.                             19260099
175600                                                                  19270099
175700******************************************************************19280099
175800* THE VENDOR STYLE ROW ON THE TIMBKVS TABLE WAS NOT SENT ON THE  *19290099
175900* CHANGE TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE    *19300099
176000* DB2 TABLE.                                                     *19310099
176100******************************************************************19320099
176200*2390-PROCESS-VS-E-DELETE-REC.                                    19330099
176300                                                                  19340099
176400*    MOVE PV-UPC-CURSOR-VS-NBR  TO IMBKVS-VS-NBR.                 19350099
176500*    PERFORM 7105-SELECT-TIMBKVS-CHG.                             19360099
176600*    PERFORM 7530-MOVES-AUDIT-TAUBKVS.                            19370099
176700*    PERFORM 7540-DELETE-TIMBKVS-CHG.                             19380099
176800*    PERFORM 7545-INSERT-TAUBKVS.                                 19390099
176900*    PERFORM 2397-DISPLAY-E-VS.                                   19400099
177000*    ADD +1 TO PA-TOT-BKVS-DELETES-E.                             19410099
177100*    ADD +1 TO PA-TOT-RECS-DELETED-E.                             19420099
177200                                                                  19430099
177300*    PERFORM 7365-OPEN-UPC-CURSOR.                                19440099
177400*    PERFORM 7375-FETCH-UPC-CURSOR.                               19450099
177500*    IF PS-EOC-UPC-CURSOR                                         19460099
177600*        PERFORM 7370-CLOSE-UPC-CURSOR                            19470099
177700*    ELSE                                                         19480099
177800*        PERFORM UNTIL PS-EOC-UPC-CURSOR                          19490099
177900*           PERFORM 7430-MOVES-AUDIT-TAUBKUP                      19500099
178000*           PERFORM 7440-DELETE-TIMBKUP-CHG                       19510099
178100*           PERFORM 7445-INSERT-TAUBKUP                           19520099
178200*           PERFORM 2398-DISPLAY-E-UPC                            19530099
178300*           PERFORM 7375-FETCH-UPC-CURSOR                         19540099
178400*           ADD +1 TO PA-TOT-BKUP-DELETES-E                       19550099
178500*           ADD +1 TO PA-TOT-RECS-DELETED-E                       19560099
178600*           IF PS-EOC-UPC-CURSOR                                  19570099
178700*               PERFORM 7370-CLOSE-UPC-CURSOR                     19580099
178800*           END-IF                                                19590099
178900*        END-PERFORM                                              19600099
179000*    END-IF.                                                      19610099
179100                                                                  19620099
179200******************************************************************19630099
179300* THE UPC ROW ON THE TIMBKUP TABLE WAS NOT SENT ON THE CHANGE    *19640099
179400* TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE DB2       *19650099
179500* TABLE.                                                         *19660099
179600******************************************************************19670099
179700*2395-PROCESS-UPC-E-DELETE-REC.                                   19680099
179800                                                                  19690099
179900*    PERFORM 7205-SELECT-TIMBKUP-CHG.                             19700099
180000*    PERFORM 7430-MOVES-AUDIT-TAUBKUP.                            19710099
180100*    MOVE PV-UPC-CURSOR-VS-NBR  TO IMBKUP-VS-NBR.                 19720099
180200*    MOVE PV-UPC-CURSOR-UPC-NBR TO IMBKUP-UPC-NBR.                19730099
180300*    PERFORM 7440-DELETE-TIMBKUP-CHG.                             19740099
180400*    PERFORM 7445-INSERT-TAUBKUP.                                 19750099
180500*    PERFORM 2398-DISPLAY-E-UPC.                                  19760099
180600*    ADD +1 TO PA-TOT-BKUP-DELETES-E.                             19770099
180700*    ADD +1 TO PA-TOT-RECS-DELETED-E.                             19780099
180800                                                                  19790099
180900******************************************************************19800099
181000* DISPLAY THE VENDOR STYLE 'E' DELETE INFORMATION.               *19810099
181100******************************************************************19820099
181200*2397-DISPLAY-E-VS.                                               19830099
181300                                                                  19840099
181400*    DISPLAY '**********************************'.                19850099
181500*    DISPLAY '** TIMBKVS  E RECORD DELETE     **'.                19860099
181600*    DISPLAY '** TIMBKVS PO NBR      = ' IMBKVS-PO-NBR.           19870099
181700*    DISPLAY '** TIMBKVS VS NBR      = ' IMBKVS-VS-NBR.           19880099
181800*    DISPLAY '**********************************'.                19890099
181900                                                                  19900099
182000******************************************************************19910099
182100* DISPLAY THE UPC 'E' DELETE INFORMATION.                        *19920099
182200******************************************************************19930099
182300*2398-DISPLAY-E-UPC.                                              19940099
182400                                                                  19950099
182500*    DISPLAY '**********************************'.                19960099
182600*    DISPLAY '** TIMBKUP  E  RECORD DELETE    **'.                19970099
182700*    DISPLAY '** TIMBKUP PO NBR      = ' IMBKUP-PO-NBR.           19980099
182800*    DISPLAY '** TIMBKUP VS NBR      = ' IMBKUP-VS-NBR.           19990099
182900*    DISPLAY '** TIMBKUP UPC NBR     = ' IMBKUP-UPC-NBR.          20000099
183000*    DISPLAY '**********************************'.                20010099
183100                                                                  20020099
183200******************************************************************20030099
183300* CHECK TO SEE IF ANYTHING REALLY CHANGED ON THE BOOKING RECORDS.*20040099
183400* IF NO CHANGES, WRITE WARNING MESSAGE TO ERROR REPORT.          *20050099
183500******************************************************************20060099
183600 2399-NO-CHG-WRN-MSG.                                             20070099
183700                                                                  20080099
183800     INITIALIZE TR201-RECORD.                                     20090099
183900     INITIALIZE TR201-REC-TYP-EDD.                                20100099
184000     MOVE PC-E                 TO TR201-RPT-TYP.                  20110099
184100     MOVE 'PO NUMBER'          TO TR201-DATA-IN-ERROR.            20120099
184200     MOVE PV-HOLD-TR024-PO-NBR TO TR201-DATA-VALUE.               20130099
184300     MOVE PC-WARNING           TO TR201-ERROR-TYPE.               20140099
184400     MOVE 'CHANGE SENT & NOTHING CHANGED - NOT PROCESSED' TO      20150099
184500           TR201-ERROR-MSG.                                       20160099
184600     MOVE PV-SEQ-NBR-EDD        TO TR201-PROCESS-SEQ-NBR.         20170099
184700     MOVE PV-HOLD-TR024-TRN-TYP TO TR201-TRN-TYP.                 20180099
184800     MOVE PV-REC-TYP-EDD        TO TR201-REC-TYP-EDD-CDE.         20190099
184900     MOVE PC-10                 TO TR201-EDD-SEQ-NBR.             20200099
185000     MOVE PV-HOLD-TR024-PO-NBR  TO TR201-PO-NBR.                  20210099
185100     MOVE PV-HOLD-TR024-EXTL-REF-NBR TO TR201-EXTL-REF-NBR.       20220099
185200     MOVE PV-HOLD-TR024-PO-BKG-DELY-DTE TO                        20230099
185300           TR201-PO-BKG-DELY-DTE.                                 20240099
185400     MOVE PV-HOLD-TR024-PO-BKG-DELY-TM  TO                        20250099
185500           TR201-PO-BKG-DELY-TM.                                  20260099
185600     MOVE PV-HOLD-ORGN-SHPD-FR-CDE TO                             20270099
185700           TR201-ORGN-SHPD-FR-CDE.                                20280099
185800     MOVE IMBKPO-IMPRT-TRIP-ID   TO TR201-EDD-IMPRT-TRIP-ID.      20290099
185900     MOVE IMBKPO-CARR-SCAC-ID    TO TR201-EDD-CARR-SCAC-ID.       20300099
186000     MOVE IMBKPO-IMPRT-VEH-NM    TO TR201-EDD-IMPRT-VEH-NM.       20310099
186100     MOVE IMBKPO-POE-DELY-TMST (1:4)   TO                         20320099
186200           TR201-EDD-POE-DELY-DTE (1:4).                          20330099
186300     MOVE IMBKPO-POE-DELY-TMST (6:2)   TO                         20340099
186400           TR201-EDD-POE-DELY-DTE (5:2).                          20350099
186500     MOVE IMBKPO-POE-DELY-TMST (9:2)   TO                         20360099
186600           TR201-EDD-POE-DELY-DTE (7:2).                          20370099
186700     MOVE IMBKPO-POE-DELY-TMST (12:2)  TO                         20380099
186800           TR201-EDD-POE-DELY-TM (1:2).                           20390099
186900     MOVE IMBKPO-POE-DELY-TMST (15:2)  TO                         20400099
187000           TR201-EDD-POE-DELY-TM (3:2).                           20410099
187100                                                                  20420099
187200     MOVE IMBKPO-FOB-CDE         TO TR201-EDD-FOB-CDE.            20430099
187300     MOVE IMBKPO-DEST-POE-CDE    TO TR201-EDD-DEST-POE-CDE.       20440099
187400     MOVE IMBKPO-TRIP-TYP-CDE    TO TR201-EDD-TRIP-TYP-CDE.       20450099
187500     MOVE IMBKPO-EST-LBD-NM      TO TR201-EDD-EST-LBD-NM.         20460099
187600     MOVE IMBKPO-DPRTR-TMST (1:4)      TO                         20470099
187700           TR201-EDD-DPRTR-DTE (1:4).                             20480099
187800     MOVE IMBKPO-DPRTR-TMST (6:2)      TO                         20490099
187900           TR201-EDD-DPRTR-DTE (5:2).                             20500099
188000     MOVE IMBKPO-DPRTR-TMST (9:2)      TO                         20510099
188100           TR201-EDD-DPRTR-DTE (7:2).                             20520099
188200     MOVE IMBKPO-DPRTR-TMST (12:2)     TO                         20530099
188300           TR201-EDD-DPRTR-TM (1:2).                              20540099
188400     MOVE IMBKPO-DPRTR-TMST (15:2)     TO                         20550099
188500           TR201-EDD-DPRTR-TM (3:2).                              20560099
188600                                                                  20570099
188700     PERFORM 7300-INSERT-TOUTTR6-RPT.                             20580099
188800                                                                  20590099
188900******************************************************************20600099
189000* THIS IS A DELETE FOR ALL LEVELS (PO, VS, UPC). A 'D' DELETE    *20610099
189100* WILL INCLUDE THE EDL REC-TYP ONLY. THESE RECORDS COME FROM THE *20620099
189200* CONSOLIDATOR AND INCLUDE: PO, EXTL-REF-NBR, PO-BKG-DELY-DTE.   *20630099
189300* THE DELETE IS DONE ON ALL (PO, VS, UPC  LEVELS).               *20640099
189400******************************************************************20650099
189500 2400-GROUP-DELETE.                                               20660099
189600                                                                  20670099
189700     EVALUATE TR024-EDL-REC-TYP-CDE                               20680099
189800                                                                  20690099
189900      WHEN PC-EDL                                                 20700099
190000        MOVE TR024-EDD-PO-NBR      TO IMBKPO-PO-NBR               20710099
190100        MOVE TR024-EDD-PO-BKG-DELY-DTE (1:4)  TO                  20720099
190200            PV-REFORMAT-TO-DB2-CY                                 20730099
190300        MOVE TR024-EDD-PO-BKG-DELY-DTE (5:2)  TO                  20740099
190400            PV-REFORMAT-TO-DB2-MM                                 20750099
190500        MOVE TR024-EDD-PO-BKG-DELY-DTE (7:2)  TO                  20760099
190600            PV-REFORMAT-TO-DB2-DD                                 20770099
190700        MOVE PV-REFORMAT-TO-DB2-DTE           TO                  20780099
190800            PV-REFORMAT-10BYTE-FIELD                              20790099
190900        PERFORM 7000-SELECT-TIMBKPO                               20800099
191000           IF PS-TIMBKPO-ROW-IS-THERE                             20810099
191100*            MOVE IMBKPO-PO-NBR          TO IMBKUP-PO-NBR         20820099
191200*                                           IMBKVS-PO-NBR         20830099
191300*            MOVE IMBKPO-PO-BKG-SEQ-NBR  TO IMBKUP-PO-BKG-SEQ-NBR 20840099
191400*                                           IMBKVS-PO-BKG-SEQ-NBR 20850099
191500*            SET PS-EOC-BKUPC-CURSOR-NO  TO TRUE                  20860099
191600*            PERFORM 7400-OPEN-BKUPC-CURSOR                       20870099
191700*            PERFORM 7410-PROCESS-BKUPC-DELETE                    20880099
191800*                    UNTIL PS-EOC-BKUPC-CURSOR                    20890099
191900*            SET PS-EOC-BKVS-CURSOR-NO   TO TRUE                  20900099
192000*            PERFORM 7500-OPEN-BKVS-CURSOR                        20910099
192100*            PERFORM 7510-PROCESS-BKVS-DELETE                     20920099
192200*                    UNTIL PS-EOC-BKVS-CURSOR                     20930099
192300             PERFORM 7610-PROCESS-BKPO-DELETE                     20940099
192400                 IF PS-GOOD-BKPO-DELETE                           20950099
192400*                IF (PS-GOOD-BKUPC-DELETE OR                      20951099
192500*                    PS-GOOD-BKVS-DELETE  OR                      20960099
192600*                    PS-GOOD-BKPO-DELETE)                         20970099
192700                     INITIALIZE TR201-RECORD                      20980099
192800                     INITIALIZE TR201-REC-TYP-EDLUPC              20990099
192900                     MOVE PC-D              TO TR201-RPT-TYP      21000099
193000                     PERFORM 6250-MOVE-LIKE-RPT-FIELDS            21010099
193100                     PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS          21020099
193200                     PERFORM 7300-INSERT-TOUTTR6-RPT              21030099
193300                 ELSE                                             21040099
193400                     CONTINUE                                     21050099
193500                 END-IF                                           21060099
193600           ELSE                                                   21070099
193700             MOVE PC-E                   TO TR201-RPT-TYP         21080099
193800             MOVE 'PO NBR'               TO TR201-DATA-IN-ERROR   21090099
193900             MOVE TR024-EDL-PO-NBR       TO TR201-DATA-VALUE      21100099
194000             MOVE PC-ERROR               TO TR201-ERROR-TYPE      21110099
194100             MOVE 'DELETE SENT, PO NOT FOUND, PO NOT DELETED'     21120099
194200                                         TO TR201-ERROR-MSG       21130099
194300             PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    21140099
194400             PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  21150099
194500             PERFORM 7300-INSERT-TOUTTR6-RPT                      21160099
194600           END-IF                                                 21170099
194700                                                                  21180099
194800     END-EVALUATE.                                                21190099
194900                                                                  21200099
195000     PERFORM 2600-CHECK-HOLD-FIELDS.                              21210099
195100                                                                  21220099
195200     SET PS-GOOD-RECORD-NO TO TRUE.                               21230099
195300     PERFORM 6000-READ-BKG-FILE                                   21240099
195400         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                 21250099
195500                                                                  21260099
195600     PERFORM 2610-RESET-SWITCHES.                                 21270099
195700                                                                  21280099
195800 EJECT                                                            21290099
195900                                                                  21300099
196000******************************************************************21310099
196100* BEFORE NEXT READ CHECK IF THE KEY FIELDS HAVE CHANGED. IF THEY *21320099
196200* HAVE, MOVE NEW FIELDS TO HOLD.                                 *21330099
196300******************************************************************21340099
196400 2600-CHECK-HOLD-FIELDS.                                          21350099
196500                                                                  21360099
196600     IF TR024-EDD-TRN-TYP       = PV-HOLD-TR024-TRN-TYP AND       21370099
196700        TR024-EDD-PO-NBR        = PV-HOLD-TR024-PO-NBR   AND      21380099
196800        TR024-EDD-EXTL-REF-NBR  = PV-HOLD-TR024-EXTL-REF-NBR AND  21390099
196900        TR024-EDD-PO-BKG-DELY-DTE =                               21400099
197000                     PV-HOLD-TR024-PO-BKG-DELY-DTE       AND      21410099
197100        TR024-EDD-PO-BKG-DELY-TM  =                               21420099
197200                     PV-HOLD-TR024-PO-BKG-DELY-TM       AND       21430099
197300        TR024-EDD-ORGN-SHPD-FR-CDE =                              21440099
197400                           PV-HOLD-ORGN-SHPD-FR-CDE               21450099
197500        CONTINUE                                                  21460099
197600     ELSE                                                         21470099
197700        MOVE TR024-EDD-TRN-TYP       TO PV-HOLD-TR024-TRN-TYP     21480099
197800        MOVE TR024-EDD-PO-NBR        TO PV-HOLD-TR024-PO-NBR      21490099
197900        MOVE TR024-EDD-EXTL-REF-NBR  TO PV-HOLD-TR024-EXTL-REF-NBR21500099
198000        MOVE TR024-EDD-REC-TYP-CDE   TO PV-HOLD-TR024-REC-TYP-CDE 21510099
198100        MOVE TR024-EDD-PO-BKG-DELY-DTE TO                         21520099
198200            PV-HOLD-TR024-PO-BKG-DELY-DTE                         21530099
198300        MOVE TR024-EDD-PO-BKG-DELY-TM  TO                         21540099
198400            PV-HOLD-TR024-PO-BKG-DELY-TM                          21550099
198500        MOVE TR024-EDD-ORGN-SHPD-FR-CDE TO                        21560099
198600            PV-HOLD-ORGN-SHPD-FR-CDE                              21570099
198700        INITIALIZE PV-HOLD-TR024-VS-NBR                           21580099
198800                   PV-HOLD-TR024-UPC-NBR                          21590099
198900     END-IF.                                                      21600099
199000                                                                  21610099
199100     EVALUATE TR024-EDD-REC-TYP-CDE                               21620099
199200         WHEN PC-EDLVS                                            21630099
199300             IF TR024-EDLVS-VS-NBR   = PV-HOLD-TR024-VS-NBR       21640099
199400                 CONTINUE                                         21650099
199500             ELSE                                                 21660099
199600                MOVE TR024-EDLVS-VS-NBR TO PV-HOLD-TR024-VS-NBR   21670099
199700                MOVE TR024-EDLVS-REC-TYP-CDE  TO                  21680099
199800                      PV-HOLD-TR024-REC-TYP-CDE                   21690099
199900             END-IF                                               21700099
200000         WHEN PC-EDLUPC                                           21710099
200100             IF TR024-EDLVS-VS-NBR   = PV-HOLD-TR024-VS-NBR AND   21720099
200200                TR024-EDLUPC-UPC-NBR = PV-HOLD-TR024-UPC-NBR      21730099
200300                CONTINUE                                          21740099
200400             ELSE                                                 21750099
200500               MOVE TR024-EDLVS-VS-NBR  TO PV-HOLD-TR024-VS-NBR   21760099
200600               MOVE TR024-EDLUPC-UPC-NBR TO PV-HOLD-TR024-UPC-NBR 21770099
200700               MOVE TR024-EDLUPC-REC-TYP-CDE  TO                  21780099
200800                      PV-HOLD-TR024-REC-TYP-CDE                   21790099
200900             END-IF                                               21800099
201000                                                                  21810099
201100     END-EVALUATE.                                                21820099
201200                                                                  21830099
201300******************************************************************21840099
201400* AFTER READ CHECK IF THE KEY FIELDS HAVE CHANGED. IF THEY HAVE  *21850099
201500* RESET THOSE SWITCHES THAT DEPEND ON THE KEY BEING THE SAME.    *21860099
201600******************************************************************21870099
201700 2610-RESET-SWITCHES.                                             21880099
201800                                                                  21890099
201900     IF (TR024-EDD-TRN-TYP       = PV-HOLD-TR024-TRN-TYP      AND 21900099
202000        TR024-EDD-PO-NBR         = PV-HOLD-TR024-PO-NBR       AND 21910099
202100        TR024-EDD-EXTL-REF-NBR   = PV-HOLD-TR024-EXTL-REF-NBR AND 21920099
202200        TR024-EDD-PO-BKG-DELY-DTE =                               21930099
202300                    PV-HOLD-TR024-PO-BKG-DELY-DTE             AND 21940099
202400        TR024-EDD-PO-BKG-DELY-TM  =                               21950099
202500                    PV-HOLD-TR024-PO-BKG-DELY-TM          AND     21960099
202600        TR024-EDD-ORGN-SHPD-FR-CDE =                              21970099
202700                    PV-HOLD-ORGN-SHPD-FR-CDE)          AND        21980099
202800        PS-END-OF-INPUT-NO                                        21990099
202900         CONTINUE                                                 22000099
203000     ELSE                                                         22010099
203100        INITIALIZE PV-HOLD-PROCESS-SEQ-NBR-EDD                    22020099
203200                   PV-HOLD-PROCESS-SEQ-NBR-EDDRSN                 22030099
203300                   PV-HOLD-PROCESS-SEQ-NBR-EDL                    22040099
203400        SET PS-TIMBKPO-ROW-IS-THERE-UNSURE    TO TRUE             22050099
203500        SET PS-TIMBKPO-ADDED-NO               TO TRUE             22060099
203600        SET PS-KEY-FIELDS-CHANGED             TO TRUE             22070099
203700        SET PS-EDD-EDDRSN-EDL-LOOP-NO         TO TRUE             22080099
203800        SET PS-ADD-FOR-CHANGES-DONE           TO TRUE             22090099
203900                                                                  22100099
204000        IF PV-HOLD-TR024-TRN-TYP = PC-C                           22110099
204100          IF PS-CHANGE-ADD-B                                      22120099
204200              SET PS-CHANGE-ADD-B-NO TO TRUE                      22130099
204300*         ELSE                                                    22140099
204400*             PERFORM 2375-TABLE-COMPARE-CHECK                    22150099
204500          END-IF                                                  22160099
204600        END-IF                                                    22170099
204700     END-IF.                                                      22180099
204800                                                                  22190099
204900     EVALUATE TR024-EDD-REC-TYP-CDE                               22200099
205000         WHEN PC-EDLVS                                            22210099
205100         WHEN PC-EDLUPC                                           22220099
205200             IF TR024-EDLVS-VS-NBR = PV-HOLD-TR024-VS-NBR         22230099
205300                 CONTINUE                                         22240099
205400*            ELSE                                                 22250099
205500*                SET PS-TIMBKVS-ROW-IS-THERE-UNSURE TO TRUE       22260099
205600*                SET PS-TIMBKVS-ADDED-NO         TO TRUE          22270099
205700             END-IF                                               22280099
205800     END-EVALUATE.                                                22290099
205900                                                                  22300099
206000******************************************************************22310099
206100* CHECK HOLD FIELDS TO SEE IF A COMMIT NEEDS TO BE TAKEN.        *22320099
206200******************************************************************22330099
206300 2615-CHECK-COMMIT-FIELDS.                                        22340099
206400                                                                  22350099
206500     IF TR024-EDD-PO-NBR         = PV-HOLD-TR024-PO-NBR        OR 22360099
206600        TR024-EDD-EXTL-REF-NBR   = PV-HOLD-TR024-EXTL-REF-NBR     22370099
206700         SET PS-SAME-COMMIT-FIELDS TO TRUE                        22380099
206800     ELSE                                                         22390099
206900         SET PS-NOT-SAME-COMMIT-FIELDS TO TRUE                    22400099
207000     END-IF.                                                      22410099
207100                                                                  22420099
207200******************************************************************22430099
207300* EDITS PERTAINING TO FIELDS COMING FROM THE EDD RECORD TYPE.    *22440099
207400* ALSO INCLUDES EDITS THAT PERTAIN TO MULTIPLE RECORD TYPES.     *22450099
207500******************************************************************22460099
207600 3000-EDD-EDITS.                                                  22470099
207700                                                                  22480099
207800     MOVE TR024-EDD-PO-NBR         TO  IMBKPO-PO-NBR.             22490099
207900     PERFORM 7310-SELECT-TPURCHS.                                 22500099
207910     SET PS-TPURCHS-ACTIVE-NO      TO  TRUE.                      22510099
208000                                                                  22520099
208100     EVALUATE TRUE                                                22530099
208200         WHEN  SQLCODE = +0                                       22540099
208300              IF PURCHS-STATUS-CDE = (PC-AC OR PC-AP)             22550099
208400                 SET PS-TPURCHS-ACTIVE TO  TRUE                   22560099
208500              ELSE                                                22570099
208600                 INITIALIZE TR201-RECORD                          22580099
208700                 INITIALIZE TR201-REC-TYP-EDD                     22590099
208800                 MOVE PC-E                          TO            22600099
208900                    TR201-RPT-TYP                                 22610099
209000                 MOVE 'PO NUMBER'                   TO            22620099
209100                    TR201-DATA-IN-ERROR                           22630099
209200                 MOVE TR024-EDD-PO-NBR              TO            22640099
209300                    TR201-DATA-VALUE                              22650099
209400                 MOVE PC-WARNING                    TO            22660099
209500                    TR201-ERROR-TYPE                              22670099
209600                 MOVE 'PO NOT ACTIVE OR APPROVED ON MAINFRAME'    22680099
209700                                       TO TR201-ERROR-MSG         22690099
209800                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                22700099
209900                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              22710099
210000                 PERFORM 7300-INSERT-TOUTTR6-RPT                  22720099
210100              END-IF                                              22730099
210200                                                                  22740099
210300         WHEN SQLCODE = +100                                      22750099
210400                 INITIALIZE TR201-RECORD                          22760099
210500                 INITIALIZE TR201-REC-TYP-EDD                     22770099
210600                 MOVE PC-E                              TO        22780099
210700                         TR201-RPT-TYP                            22790099
210800                 MOVE 'PO NBR'                          TO        22800099
210900                         TR201-DATA-IN-ERROR                      22810099
211000                 MOVE PC-WARNING                        TO        22820099
211100                         TR201-ERROR-TYPE                         22830099
211200                 MOVE TR024-EDD-PO-NBR              TO            22840099
211300                    TR201-DATA-VALUE                              22850099
211400                 MOVE 'PO NOT ON MAINFRAME'             TO        22860099
211500                         TR201-ERROR-MSG                          22870099
211600                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                22880099
211700                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              22890099
211800                 PERFORM 7300-INSERT-TOUTTR6-RPT                  22900099
211900       END-EVALUATE                                               22910099
212000                                                                  22920099
212100       PERFORM 3010-EDIT-POE-LBD.                                 22930099
212200                                                                  22940099
212300       PERFORM 3020-EDIT-FOB.                                     22950099
212400                                                                  22960099
212500 EJECT                                                            22970099
212600                                                                  22980099
212700******************************************************************22990099
212800* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *23000099
212810* ALSO, CHECKS THE LANDBRIGDE NAME.  AS OF MARCH 1999, EITHER    *23010099
212900* LANDBRIDGE NAME OR THE POE CODE IS BEING SENT.  MOVE THE       *23020099
212901* POE DATE/TIME STAMP TO EITHER THE POE OR LANDBRIDGE DATE/TIME  *23030099
212902* STAMP ON THE BOOKING PO TABLE DEPENDING ON WHICH IS SENT.      *23040099
212903* (AS OF MARCH 1999 ONLY THE DEFAULT DATE/TIME IS AVAILABLE      *23050099
212904* BECAUSE CONSOLIDATOR NOT SENDING IT.)                          *23060099
213000******************************************************************23070099
213100 3010-EDIT-POE-LBD.                                               23080099
213200                                                                  23090099
213300     IF TR024-EDD-DEST-POE-CDE = SPACES  AND                      23100099
213400        TR024-EDD-EST-LBD-NM   = SPACES                           23110099
213500         INITIALIZE TR201-RECORD                                  23120099
213600         INITIALIZE TR201-REC-TYP-EDD                             23130099
213700         MOVE PC-E              TO TR201-RPT-TYP                  23140099
213800         MOVE PC-WARNING        TO TR201-ERROR-TYPE               23150099
213900         MOVE 'DEST-POE-CDE'    TO TR201-DATA-IN-ERROR            23160099
214000         MOVE TR024-EDD-DEST-POE-CDE  TO TR201-DATA-VALUE         23170099
214100         MOVE 'POE CDE AND/OR LANDBRIDGE NAME NOT SENT' TO        23180099
214200               TR201-ERROR-MSG                                    23190099
214300         MOVE SPACES          TO IMBKPO-DEST-POE-CDE              23200099
214400                                 IMBKPO-EST-LBD-NM                23210099
214500         MOVE PC-DEFAULT-TMST TO IMBKPO-POE-DELY-TMST             23220099
214600                                 IMBKPO-EST-LBD-TMST              23230099
214700         SET PS-POE-LBD       TO TRUE                             23240099
214800         PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        23250099
214900         PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      23260099
215000         PERFORM 7300-INSERT-TOUTTR6-RPT                          23270099
215100     ELSE                                                         23280099
215101******************************************************************23290099
215102*      * IF YOU GET TO HERE, YOU KNOW THAT AT LEAST ONE          *23300099
215103*      * OF THE FIELDS HAS A VALUE OTHER THAN SPACES.            *23310099
215104******************************************************************23320099
215200         IF TR024-EDD-EST-LBD-NM = SPACES                         23330099
215300             MOVE SPACES          TO IMBKPO-EST-LBD-NM            23340099
215400             MOVE PC-DEFAULT-TMST TO IMBKPO-EST-LBD-TMST          23350099
215500             SET PS-POE-LBD       TO TRUE                         23360099
215600             PERFORM 3015-POE-CHECK                               23370099
215700         ELSE                                                     23380099
215701******************************************************************23390099
215702*          * IF YOU GET HERE, YOU KNOW THAT                      *23400099
215703*          * LAND BRIDGE HAS A VALUE OTHER THAN SPACES.          *23410099
215704******************************************************************23420099
215800             IF TR024-EDD-DEST-POE-CDE = SPACES                   23430099
215900                 MOVE TR024-EDD-EST-LBD-NM TO IMBKPO-EST-LBD-NM   23440099
216000                 MOVE TR024-EDD-POE-DELY-DTE (1:4)  TO            23450099
216100                       IMBKPO-EST-LBD-TMST (1:4)                  23460099
216200                 MOVE PC-DASH                       TO            23470099
216300                       IMBKPO-EST-LBD-TMST (5:1)                  23480099
216400                 MOVE TR024-EDD-POE-DELY-DTE (5:2)  TO            23490099
216500                       IMBKPO-EST-LBD-TMST (6:2)                  23500099
216600                 MOVE PC-DASH                       TO            23510099
216700                       IMBKPO-EST-LBD-TMST (8:1)                  23520099
216800                 MOVE TR024-EDD-POE-DELY-DTE (7:2)  TO            23530099
216900                       IMBKPO-EST-LBD-TMST (9:2)                  23540099
217000                 MOVE PC-DASH                       TO            23550099
217100                       IMBKPO-EST-LBD-TMST (11:1)                 23560099
217200                 MOVE TR024-EDD-POE-DELY-TM (1:2)   TO            23570099
217300                       IMBKPO-EST-LBD-TMST  (12:2)                23580099
217400                 MOVE PC-DECIMAL                    TO            23590099
217500                       IMBKPO-EST-LBD-TMST (14:1)                 23600099
217600                 MOVE TR024-EDD-POE-DELY-TM (3:2)   TO            23610099
217700                       IMBKPO-EST-LBD-TMST (15:2)                 23620099
217800                 MOVE PC-DECIMAL                    TO            23630099
217900                       IMBKPO-EST-LBD-TMST (17:1)                 23640099
218000                 MOVE ZEROES                        TO            23650099
218100                       IMBKPO-EST-LBD-TMST (18:2)                 23660099
218200                 MOVE PC-DECIMAL                    TO            23670099
218300                       IMBKPO-EST-LBD-TMST (20:1)                 23680099
218400                 MOVE ZEROES                        TO            23690099
218500                       IMBKPO-EST-LBD-TMST (21:6)                 23700099
218600                 MOVE SPACES              TO IMBKPO-DEST-POE-CDE  23710099
218700                 MOVE PC-DEFAULT-TMST     TO IMBKPO-POE-DELY-TMST 23720099
218800                 SET PS-POE-LBD           TO TRUE                 23730099
218900             ELSE                                                 23740099
218901******************************************************************23750099
218902*              * IF YOU GET HERE, YOU KNOW THAT PROGRAM TRKUT200 *23760099
218903*              * HAS BEEN CHANGED AND THAT BOTH FIELDS HAVE      *23770099
218904*              * VALUES OTHER THAN SPACES.                       *23780099
218905******************************************************************23790099
219000                 MOVE TR024-EDD-EST-LBD-NM TO IMBKPO-EST-LBD-NM   23800099
219100                 MOVE TR024-EDD-POE-DELY-DTE (1:4)  TO            23810099
219200                       IMBKPO-EST-LBD-TMST (1:4)                  23820099
219300                 MOVE PC-DASH                       TO            23830099
219400                       IMBKPO-EST-LBD-TMST (5:1)                  23840099
219500                 MOVE TR024-EDD-POE-DELY-DTE (5:2)  TO            23850099
219600                       IMBKPO-EST-LBD-TMST (6:2)                  23860099
219700                 MOVE PC-DASH                       TO            23870099
219800                       IMBKPO-EST-LBD-TMST (8:1)                  23880099
219900                 MOVE TR024-EDD-POE-DELY-DTE (7:2)  TO            23890099
220000                       IMBKPO-EST-LBD-TMST (9:2)                  23900099
220100                 MOVE PC-DASH                       TO            23910099
220200                       IMBKPO-EST-LBD-TMST (11:1)                 23920099
220300                 MOVE TR024-EDD-POE-DELY-TM (1:2)   TO            23930099
220400                       IMBKPO-EST-LBD-TMST  (12:2)                23940099
220500                 MOVE PC-DECIMAL                    TO            23950099
220600                       IMBKPO-EST-LBD-TMST (14:1)                 23960099
220700                 MOVE TR024-EDD-POE-DELY-TM (3:2)   TO            23970099
220800                       IMBKPO-EST-LBD-TMST (15:2)                 23980099
220900                 MOVE PC-DECIMAL                    TO            23990099
221000                       IMBKPO-EST-LBD-TMST (17:1)                 24000099
221100                 MOVE ZEROES                        TO            24010099
221200                       IMBKPO-EST-LBD-TMST (18:2)                 24020099
221300                 MOVE PC-DECIMAL                    TO            24030099
221400                       IMBKPO-EST-LBD-TMST (20:1)                 24040099
221500                 MOVE ZEROES                        TO            24050099
221600                       IMBKPO-EST-LBD-TMST (21:6)                 24060099
221700                 SET PS-POE-LBD            TO TRUE                24070099
221800                 PERFORM 3015-POE-CHECK                           24080099
221900             END-IF                                               24090099
222000         END-IF                                                   24100099
222100     END-IF.                                                      24110099
222200                                                                  24120099
222300******************************************************************24130099
222400* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *24140099
222500* ALSO, CHECKS THE LANDBRIGDE NAME.                              *24150099
222600******************************************************************24160099
222700 3015-POE-CHECK.                                                  24170099
222800                                                                  24180099
222900     EVALUATE TRUE                                                24190099
223000         WHEN TR024-EDD-TRIP-TYP-CDE = PC-A                       24200099
223100             PERFORM 7040-OPEN-POE-CURSOR-AIR                     24210099
223200             PERFORM 7044-FETCH-POE-CURSOR-AIR                    24220099
223201             PERFORM 7042-CLOSE-POE-CURSOR-AIR                    24230099
223202                                                                  24240099
223300         WHEN TR024-EDD-TRIP-TYP-CDE = PC-O                       24250099
223400             PERFORM 7050-OPEN-POE-CURSOR-OCEAN                   24260099
223500             PERFORM 7054-FETCH-POE-CURSOR-OCEAN                  24270099
223501             PERFORM 7052-CLOSE-POE-CURSOR-OCEAN                  24280099
223502     END-EVALUATE.                                                24290099
223600                                                                  24300099
223700     IF PS-VALID-POE-CDE                                          24310099
223800         MOVE TR024-EDD-DEST-POE-CDE  TO IMBKPO-DEST-POE-CDE      24320099
223900         MOVE TR024-EDD-POE-DELY-DTE (1:4)  TO                    24330099
224000               IMBKPO-POE-DELY-TMST (1:4)                         24340099
224100         MOVE PC-DASH                       TO                    24350099
224200               IMBKPO-POE-DELY-TMST (5:1)                         24360099
224300         MOVE TR024-EDD-POE-DELY-DTE (5:2)  TO                    24370099
224400               IMBKPO-POE-DELY-TMST (6:2)                         24380099
224500         MOVE PC-DASH                       TO                    24390099
224600               IMBKPO-POE-DELY-TMST (8:1)                         24400099
224700         MOVE TR024-EDD-POE-DELY-DTE (7:2)  TO                    24410099
224800               IMBKPO-POE-DELY-TMST (9:2)                         24420099
224900         MOVE PC-DASH                       TO                    24430099
225000               IMBKPO-POE-DELY-TMST (11:1)                        24440099
225100         MOVE TR024-EDD-POE-DELY-TM (1:2)   TO                    24450099
225200               IMBKPO-POE-DELY-TMST (12:2)                        24460099
225300         MOVE PC-DECIMAL                    TO                    24470099
225400               IMBKPO-POE-DELY-TMST (14:1)                        24480099
225500         MOVE TR024-EDD-POE-DELY-TM (3:2)   TO                    24490099
225600               IMBKPO-POE-DELY-TMST (15:2)                        24500099
225700         MOVE PC-DECIMAL                    TO                    24510099
225800               IMBKPO-POE-DELY-TMST (17:1)                        24520099
225900         MOVE ZEROES                        TO                    24530099
226000               IMBKPO-POE-DELY-TMST (18:2)                        24540099
226100         MOVE PC-DECIMAL                    TO                    24550099
226200               IMBKPO-POE-DELY-TMST (20:1)                        24560099
226300         MOVE ZEROES                        TO                    24570099
226400               IMBKPO-POE-DELY-TMST (21:6)                        24580099
226500         SET PS-POE-LBD TO TRUE                                   24590099
226600     ELSE                                                         24600099
226700         MOVE SPACES                  TO IMBKPO-DEST-POE-CDE      24610099
226800         MOVE TR024-EDD-POE-DELY-DTE (1:4)  TO                    24620099
226900               IMBKPO-POE-DELY-TMST (1:4)                         24630099
227000         MOVE PC-DASH                       TO                    24640099
227100               IMBKPO-POE-DELY-TMST (5:1)                         24650099
227200         MOVE TR024-EDD-POE-DELY-DTE (5:2)  TO                    24660099
227300               IMBKPO-POE-DELY-TMST (6:2)                         24670099
227400         MOVE PC-DASH                       TO                    24680099
227500               IMBKPO-POE-DELY-TMST (8:1)                         24690099
227600         MOVE TR024-EDD-POE-DELY-DTE (7:2)  TO                    24700099
227700               IMBKPO-POE-DELY-TMST (9:2)                         24710099
227800         MOVE PC-DASH                       TO                    24720099
227900               IMBKPO-POE-DELY-TMST (11:1)                        24730099
228000         MOVE TR024-EDD-POE-DELY-TM (1:2)   TO                    24740099
228100               IMBKPO-POE-DELY-TMST (12:2)                        24750099
228200         MOVE PC-DECIMAL                    TO                    24760099
228300               IMBKPO-POE-DELY-TMST (14:1)                        24770099
228400         MOVE TR024-EDD-POE-DELY-TM (3:2)   TO                    24780099
228500               IMBKPO-POE-DELY-TMST (15:2)                        24790099
228600         MOVE PC-DECIMAL                    TO                    24800099
228700               IMBKPO-POE-DELY-TMST (17:1)                        24810099
228800         MOVE ZEROES                        TO                    24820099
228900               IMBKPO-POE-DELY-TMST (18:2)                        24830099
229000         MOVE PC-DECIMAL                    TO                    24840099
229100               IMBKPO-POE-DELY-TMST (20:1)                        24850099
229200         MOVE ZEROES                        TO                    24860099
229300               IMBKPO-POE-DELY-TMST (21:6)                        24870099
229400         SET PS-POE-LBD TO TRUE                                   24880099
229500         INITIALIZE TR201-RECORD                                  24890099
229600         INITIALIZE TR201-REC-TYP-EDD                             24900099
229700         MOVE PC-E                   TO TR201-RPT-TYP             24910099
229800         MOVE PC-WARNING             TO TR201-ERROR-TYPE          24920099
229900         MOVE 'DEST-POE-CDE'         TO TR201-DATA-IN-ERROR       24930099
230000         MOVE TR024-EDD-DEST-POE-CDE TO TR201-DATA-VALUE          24940099
230100         MOVE 'INVALID POE CODE ON MAINFRAME' TO TR201-ERROR-MSG  24950099
230200         PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        24960099
230300         PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      24970099
230400         PERFORM 7300-INSERT-TOUTTR6-RPT                          24980099
230500     END-IF.                                                      24990099
230600                                                                  25000099
230700******************************************************************25010099
230800* CHECKS TO SEE IF THE FOB-CDE ON MAINFRAME IS VALID (ACTIVE).   *25020099
230900******************************************************************25030099
231000 3020-EDIT-FOB.                                                   25040099
231100                                                                  25050099
231200     IF TR024-EDD-FOB-CDE       = SPACES                          25060099
231300         INITIALIZE TR201-RECORD                                  25070099
231400         INITIALIZE TR201-REC-TYP-EDD                             25080099
231500         MOVE PC-E              TO TR201-RPT-TYP                  25090099
231600         MOVE PC-WARNING        TO TR201-ERROR-TYPE               25100099
231700         MOVE 'FOB-CDE'         TO TR201-DATA-IN-ERROR            25110099
231800         MOVE TR024-EDD-FOB-CDE           TO                      25120099
231900               TR201-DATA-VALUE                                   25130099
232000         MOVE 'DATA NOT SENT'             TO                      25140099
232100               TR201-ERROR-MSG                                    25150099
232200               PERFORM 6250-MOVE-LIKE-RPT-FIELDS                  25160099
232300               PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                25170099
232400               PERFORM 7300-INSERT-TOUTTR6-RPT                    25180099
232500     ELSE                                                         25190099
232600         EVALUATE TRUE                                            25200099
232700             WHEN TR024-EDD-TRIP-TYP-CDE = PC-A                   25210099
232800                 PERFORM 7055-SELECT-FOB-AIR                      25220099
232900                                                                  25230099
233000             WHEN TR024-EDD-TRIP-TYP-CDE = PC-O                   25240099
233100                 PERFORM 7060-SELECT-FOB-OCEAN                    25250099
233200         END-EVALUATE                                             25260099
233300                                                                  25270099
233400         IF (TR024-EDD-TRIP-TYP-CDE = PC-A OR PC-O) AND           25280099
233500             PS-INVALID-FOB-CDE                                   25290099
233600             INITIALIZE TR201-RECORD                              25300099
233700             INITIALIZE TR201-REC-TYP-EDD                         25310099
233800             MOVE PC-E              TO TR201-RPT-TYP              25320099
233900             MOVE PC-WARNING        TO TR201-ERROR-TYPE           25330099
234000             MOVE 'FOB-CDE'         TO TR201-DATA-IN-ERROR        25340099
234100             MOVE TR024-EDD-FOB-CDE               TO              25350099
234200                   TR201-DATA-VALUE                               25360099
234300             MOVE 'INVALID FOB CODE ON MAINFRAME' TO              25370099
234400                   TR201-ERROR-MSG                                25380099
234500                   PERFORM 6250-MOVE-LIKE-RPT-FIELDS              25390099
234600                   PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS            25400099
234700                   PERFORM 7300-INSERT-TOUTTR6-RPT                25410099
234800         END-IF                                                   25420099
234900     END-IF.                                                      25430099
235000                                                                  25440099
235100 EJECT                                                            25450099
235200                                                                  25460099
235300******************************************************************25470099
235400* CHECKS TO SEE IF THE CNTRY-CDE IS VALID ON TCNTRY (ACTIVE).    *25480099
235500******************************************************************25490099
235600*3030-EDIT-CNTRY.                                                 25500099
235700*                                                                 25510099
235800*        IF TR024-EDL-C-O-PROD-CDE = SPACES                       25520099
235900*            INITIALIZE TR201-RECORD                              25530099
236000*            INITIALIZE TR201-REC-TYP-EDL                         25540099
236100*            MOVE PC-E              TO TR201-RPT-TYP              25550099
236200*            MOVE PC-WARNING        TO TR201-ERROR-TYPE           25560099
236300*            MOVE 'PRD CNTRY'       TO TR201-DATA-IN-ERROR        25570099
236400*            MOVE TR024-EDL-C-O-PROD-CDE           TO             25580099
236500*                  TR201-DATA-VALUE                               25590099
236600*            MOVE 'DATA NOT SENT'                   TO            25600099
236700*                  TR201-ERROR-MSG                                25610099
236800*                  PERFORM 6250-MOVE-LIKE-RPT-FIELDS              25620099
236900*                  PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS            25630099
237000*                  PERFORM 7300-INSERT-TOUTTR6-RPT                25640099
237100*        ELSE                                                     25650099
237200*            PERFORM 7035-SELECT-CNTRY-CDE                        25660099
237300*        END-IF.                                                  25670099
237400*                                                                 25680099
237500*        IF PS-INVALID-CNTRY-CDE                                  25690099
237600*               INITIALIZE TR201-RECORD                           25700099
237700*               INITIALIZE TR201-REC-TYP-EDL                      25710099
237800*               MOVE PC-E              TO TR201-RPT-TYP           25720099
237900*               MOVE PC-WARNING        TO TR201-ERROR-TYPE        25730099
238000*               MOVE 'CNTRY-CDE'       TO TR201-DATA-IN-ERROR     25740099
238100*               MOVE TR024-EDL-C-O-PROD-CDE           TO          25750099
238200*                     TR201-DATA-VALUE                            25760099
238300*               MOVE 'INVALID CNTRY-CDE ON MAINFRAME' TO          25770099
238400*                     TR201-ERROR-MSG                             25780099
238500*               PERFORM 6250-MOVE-LIKE-RPT-FIELDS                 25790099
238600*               PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS               25800099
238700*               PERFORM 7300-INSERT-TOUTTR6-RPT                   25810099
238800*        END-IF.                                                  25820099
238900*                                                                 25830099
239000*EJECT                                                            25840099
239100                                                                  25850099
239200******************************************************************25860099
239300* EDIT EDL FCTRY NAME AGAINST THE IMPRT FCTRY NAME ON TPURCHS.   *25870099
239400******************************************************************25880099
239500*3035-EDIT-FCTRY-NAME.                                            25890099
239600                                                                  25900099
239610*    PERFORM 7340-GET-IMPRT-FCTRY-NAME.                           25910099
239700*    MOVE ENTNME-ENT-NAME-DESC    TO PV-IMPRT-FCTRY-NAME.         25920099
239800                                                                  25930099
239900*    IF TR024-EDL-PROD-FCTRY-NM (1:10) = PV-IMPRT-FCTRY-NAME-10   25940099
240000*        CONTINUE                                                 25950099
240100*    ELSE                                                         25960099
240110*        PERFORM 7345-GET-IMPRT-VEND-NAME                         25970099
240200*        MOVE ENTNME-ENT-NAME-DESC   TO PV-IMPRT-FCTRY-NAME       25980099
240300*        IF TR024-EDL-PROD-FCTRY-NM (1:10) =                      25990099
240400*             PV-IMPRT-FCTRY-NAME-10                              26000099
240500*            INITIALIZE TR201-RECORD                              26010099
240600*            INITIALIZE TR201-REC-TYP-EDL                         26020099
240700*            MOVE PC-E                    TO TR201-RPT-TYP        26030099
240800*            MOVE 'FCTRY NAME'            TO TR201-DATA-IN-ERROR  26040099
240900*            MOVE PC-WARNING              TO TR201-ERROR-TYPE     26050099
241000*            MOVE TR024-EDL-PROD-FCTRY-NM TO TR201-DATA-VALUE     26060099
241100*            MOVE 'FACTORY NAME MATCHES MAKER ON MAINFRAME'       26070099
241200*                  TO TR201-ERROR-MSG                             26080099
241300*            PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    26090099
241400*            PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  26100099
241500*            PERFORM 7300-INSERT-TOUTTR6-RPT                      26110099
241600*        ELSE                                                     26120099
241700*            INITIALIZE TR201-RECORD                              26130099
241800*            INITIALIZE TR201-REC-TYP-EDL                         26140099
241900*            MOVE PC-E                    TO TR201-RPT-TYP        26150099
242000*            MOVE 'FCTRY NAME'            TO TR201-DATA-IN-ERROR  26160099
242100*            MOVE PC-WARNING              TO TR201-ERROR-TYPE     26170099
242200*            MOVE TR024-EDL-PROD-FCTRY-NM TO TR201-DATA-VALUE     26180099
242300*            MOVE 'FACTORY NAME DOES NOT MATCH MAINFRAME'  TO     26190099
242400*                  TR201-ERROR-MSG                                26200099
242500*            PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    26210099
242600*            PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  26220099
242700*            PERFORM 7300-INSERT-TOUTTR6-RPT                      26230099
242800*        END-IF                                                   26240099
242900*    END-IF.                                                      26250099
243000                                                                  26260099
243100******************************************************************26270099
243200* CHECKS TO SEE IF THE PO LINE(S) ARE ACTIVE OR APPROVED ON MAINF*26280099
243300* ON MAINFRAME, AND IF THE VS IS ON THE MAINFRAME.               *26290099
243400******************************************************************26300099
243500*3200-EDIT-EDLVS.                                                 26310099
243600                                                                  26320099
243700*    SET PS-VS-ON-TPURITM-NO                        TO TRUE       26330099
243800*    MOVE TR024-EDLVS-PO-NBR                     TO PURITM-PO-NBR 26340099
243900*    PERFORM 7315-SELECT-TPURITM-FOR-PO                           26350099
244000                                                                  26360099
244100*        IF PS-VS-ON-TPURITM                                      26370099
244200*           MOVE TR024-EDLVS-PO-NBR           TO PURITM-PO-NBR    26380099
244300*           PERFORM 7320-SELECT-TPURITM-FOR-VS                    26390099
244400*           IF SQLCODE = +0                                       26400099
244500*                INITIALIZE TR201-RECORD                          26410099
244600*                INITIALIZE TR201-REC-TYP-EDLVS                   26420099
244700*                MOVE PC-E                          TO            26430099
244800*                   TR201-RPT-TYP                                 26440099
244900*                MOVE 'VS NUMBER'                   TO            26450099
245000*                   TR201-DATA-IN-ERROR                           26460099
245100*                MOVE TR024-EDLVS-VS-NBR            TO            26470099
245200*                   TR201-DATA-VALUE                              26480099
245300*                MOVE PC-WARNING                    TO            26490099
245400*                   TR201-ERROR-TYPE                              26500099
245500*            MOVE 'PO LINE(S) NOT ACTIVE OR APPROVED ON MAINFRAME'26510099
245600*                   TO TR201-ERROR-MSG                            26520099
245700*                PERFORM 6250-MOVE-LIKE-RPT-FIELDS                26530099
245800*                PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              26540099
245900*                PERFORM 7300-INSERT-TOUTTR6-RPT                  26550099
246000*           END-IF                                                26560099
246100*        ELSE                                                     26570099
246200*            INITIALIZE TR201-RECORD                              26580099
246300*            INITIALIZE TR201-REC-TYP-EDLVS                       26590099
246400*            MOVE PC-E                TO TR201-RPT-TYP            26600099
246500*            MOVE 'VS NUMBER'         TO TR201-DATA-IN-ERROR      26610099
246600*            MOVE TR024-EDLVS-VS-NBR  TO TR201-DATA-VALUE         26620099
246700*            MOVE PC-WARNING          TO TR201-ERROR-TYPE         26630099
246800*            MOVE 'VS NOT FOUND ON MAINFRAME PO' TO               26640099
246900*                                        TR201-ERROR-MSG          26650099
247000*            PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    26660099
247100*            PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  26670099
247200*            PERFORM 7300-INSERT-TOUTTR6-RPT                      26680099
247300*        END-IF.                                                  26690099
247400                                                                  26700099
247500 EJECT                                                            26710099
247600                                                                  26720099
247700******************************************************************26730099
247800* CHECKS TO SEE IF THE UPC IS ON MULTIPLE LINES ON THE MAINFRAME,*26740099
247900* IF THE UPC IS ACTIVE OR APPROVED ON THE MAINFRAME, AND IF THE  *26750099
248000* UPC IS ON THE MAINFRAME.                                       *26760099
248100******************************************************************26770099
248200*3300-EDIT-EDLUPC.                                                26780099
248300                                                                  26790099
248400*    SET PS-UPC-ON-TPURITM-NO                   TO TRUE           26800099
248500*    MOVE TR024-EDLUPC-UPC-NBR                 TO TUPCSKU-UPC-NBR 26810099
248600*    MOVE TR024-EDD-PO-NBR                      TO PURITM-PO-NBR  26820099
248700*    PERFORM 7325-SELECT-TPURITM-MULT-UPC                         26830099
248800*        IF PS-UPC-ON-TPURITM                                     26840099
248900*           IF  SQLCODE = -811                                    26850099
249000*                INITIALIZE TR201-RECORD                          26860099
249100*                INITIALIZE TR201-REC-TYP-EDLUPC                  26870099
249200*                MOVE PC-E                    TO TR201-RPT-TYP    26880099
249300*                MOVE PC-WARNING              TO TR201-ERROR-TYPE 26890099
249400*                MOVE TR201-EDLUPC-UPC-NBR    TO TR201-DATA-VALUE 26900099
249500*                MOVE 'UPC NUMBER'         TO TR201-DATA-IN-ERROR 26910099
249600*                MOVE 'UPC ON MULTIPLE PO LINES ON MAINFRAME'     26920099
249700*                                             TO TR201-ERROR-MSG  26930099
249800*                PERFORM 6250-MOVE-LIKE-RPT-FIELDS                26940099
249900*                PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              26950099
250000*                PERFORM 7300-INSERT-TOUTTR6-RPT                  26960099
250100*            END-IF                                               26970099
250200*        ELSE                                                     26980099
250300*            MOVE TR024-EDLUPC-UPC-NBR TO TUPCSKU-UPC-NBR         26990099
250400*            MOVE TR024-EDLUPC-PO-NBR  TO PURITM-PO-NBR           27000099
250500*            PERFORM 7330-SELECT-TPURITM-ACT-UPC                  27010099
250600*                EVALUATE TRUE                                    27020099
250700*                   WHEN SQLCODE = +0                             27030099
250800*                   WHEN SQLCODE = -811                           27040099
250900*                      INITIALIZE TR201-RECORD                    27050099
251000*                      INITIALIZE TR201-REC-TYP-EDLUPC            27060099
251100*                      MOVE PC-E              TO TR201-RPT-TYP    27070099
251200*                      MOVE PC-WARNING        TO TR201-ERROR-TYPE 27080099
251300*                   MOVE TR024-EDLUPC-UPC-NBR TO TR201-DATA-VALUE 27090099
251400*                      MOVE 'UPC NUMBER'   TO TR201-DATA-IN-ERROR 27100099
251500*                   MOVE 'UPC NOT ACTIVE OR APPROVED ON MAINFRAME'27110099
251600*                                             TO TR201-ERROR-MSG  27120099
251700*                      PERFORM 6250-MOVE-LIKE-RPT-FIELDS          27130099
251800*                      PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS        27140099
251900*                      PERFORM 7300-INSERT-TOUTTR6-RPT            27150099
252000*                   WHEN  SQLCODE = +100                          27160099
252100*                          INITIALIZE TR201-RECORD                27170099
252200*                          INITIALIZE TR201-REC-TYP-EDLUPC        27180099
252300*                          MOVE PC-E         TO TR201-RPT-TYP     27190099
252400*                          MOVE PC-WARNING   TO TR201-ERROR-TYPE  27200099
252500*                          MOVE TR024-EDLUPC-UPC-NBR TO           27210099
252600*                                TR201-DATA-VALUE                 27220099
252700*                          MOVE 'UPC NUMBER' TO                   27230099
252800*                                TR201-DATA-IN-ERROR              27240099
252900*                          MOVE 'UPC NOT ON MAINFRAME PO' TO      27250099
253000*                                TR201-ERROR-MSG                  27260099
253100*                          PERFORM 6250-MOVE-LIKE-RPT-FIELDS      27270099
253200*                          PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS    27280099
253300*                          PERFORM 7300-INSERT-TOUTTR6-RPT        27290099
253400*                END-EVALUATE                                     27300099
253500*        END-IF.                                                  27310099
253600                                                                  27320099
253700 EJECT                                                            27330099
253800                                                                  27340099
253900******************************************************************27350099
254000*    SELECT CHECKPOINT RESTART CONTROL INFORMATION.              *27360099
254100******************************************************************27370099
254200 4000-GET-CHECKPOINT-CNTL.                                        27380099
254300                                                                  27390099
254400     PERFORM WITH TEST AFTER                                      27400099
254500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27410099
254600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             27420099
254700                 SQLCODE = ZERO                                   27430099
254800                                                                  27440099
254900         EXEC SQL                                                 27450099
255000           SELECT  CKPT_STAT_CODE                                 27460099
255100             INTO :PV-CKPT-STAT-CODE                              27470099
255200             FROM  TCKRSTCNTL                                     27480099
255300            WHERE  PLAN_NAME = :PC-CURRENT-PROGRAM-NAME           27490099
255400         END-EXEC                                                 27500099
255500                                                                  27510099
255600         EVALUATE TRUE                                            27520099
255700             WHEN SQLCODE = ZERO                                  27530099
255800             WHEN SQLCODE = -904                                  27540099
255900             WHEN SQLCODE = -911                                  27550099
255900             WHEN SQLCODE = -913                                  27560099
256000                  CONTINUE                                        27570099
256100                                                                  27580099
256200             WHEN SQLWARN0 NOT EQUAL SPACE                        27590099
256300             WHEN SQLCODE NOT EQUAL ZERO                          27600099
256400                 DISPLAY '**************************************' 27610099
256500                 DISPLAY '** ABEND                            **' 27620099
256600                 DISPLAY '** PROGRAM = TRKUP205               **' 27630099
256700                 DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT- **' 27640099
256800                 DISPLAY '**                  CNTL            **' 27650099
256900                 DISPLAY '** SELECT FROM TCKRSTCNTL           **' 27660099
257000                 DISPLAY '**CKPT-STAT-CODE ='                     27670099
257100                 DISPLAY              TCKRSTCNTL-CKPT-STAT-CODE   27680099
257200                 DISPLAY '**************************************' 27690099
257300                 PERFORM 9100-SQL-ABEND                           27700099
257400         END-EVALUATE                                             27710099
257500     END-PERFORM.                                                 27720099
257600                                                                  27730099
257700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    27740099
257800         SQLCODE NOT = ZERO                                       27750099
257900         DISPLAY '****************************************'       27760099
258000         DISPLAY '** MAX RETRIES EXCEEDED ON SELECT     **'       27770099
258100         DISPLAY '** FROM TCKRSTCNTL                    **'       27780099
258200         DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT-CNTL*'       27790099
258300         DISPLAY '****************************************'       27800099
258400         PERFORM 9100-SQL-ABEND                                   27810099
258500     END-IF.                                                      27820099
258600                                                                  27830099
258700 EJECT                                                            27840099
258800                                                                  27850099
258900******************************************************************27860099
259000*    SELECT CHECKPOINT RESTART WORKING STORAGE DESCRIPTION INFO  *27870099
259100******************************************************************27880099
259200 4010-GET-CHECKPOINT-INFO.                                        27890099
259300                                                                  27900099
259400     PERFORM                                                      27910099
259500         WITH TEST AFTER                                          27920099
259600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     27930099
259700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            27940099
259800                 SQLCODE = ZERO                                   27950099
259900                                                                  27960099
260000         EXEC SQL                                                 27970099
260100           SELECT WORK_STRG_DESC                                  27980099
260200           INTO :TCKRSTINF-WORK-STRG-DESC                         27990099
260300           FROM TCKRSTINF                                         28000099
260400           WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME             28010099
260500         END-EXEC                                                 28020099
260600                                                                  28030099
260700         EVALUATE TRUE                                            28040099
260800             WHEN SQLCODE = ZERO                                  28050099
260900             WHEN SQLCODE = -904                                  28060099
261000             WHEN SQLCODE = -911                                  28070099
261000             WHEN SQLCODE = -913                                  28080099
261100                  CONTINUE                                        28090099
261200                                                                  28100099
261300             WHEN SQLWARN0 NOT EQUAL SPACE                        28110099
261400             WHEN SQLCODE NOT EQUAL ZERO                          28120099
261500                 DISPLAY '**************************************' 28130099
261600                 DISPLAY '** ABEND                            **' 28140099
261700                 DISPLAY '** PROGRAM = TRKUP205               **' 28150099
261800                 DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT- **' 28160099
261900                 DISPLAY '**                  INFO            **' 28170099
262000                 DISPLAY '** SELECT FROM TCKRSTINF            **' 28180099
262100                 DISPLAY '**************************************' 28190099
262200                 PERFORM 9100-SQL-ABEND                           28200099
262300         END-EVALUATE                                             28210099
262400     END-PERFORM.                                                 28220099
262500                                                                  28230099
262600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28240099
262700         SQLCODE NOT = ZERO                                       28250099
262800         DISPLAY '****************************************'       28260099
262900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       28270099
263000         DISPLAY '** SELECT FROM TCKRSTINF              **'       28280099
263100         DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT-INFO*'       28290099
263200         DISPLAY '****************************************'       28300099
263300         PERFORM 9100-SQL-ABEND                                   28310099
263400     END-IF.                                                      28320099
263500                                                                  28330099
263600 EJECT                                                            28340099
263700******************************************************************28350099
263800*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *28360099
263900******************************************************************28370099
264000 4020-SET-COMMIT-TIME.                                            28380099
264100                                                                  28390099
264200      EXEC SQL                                                    28400099
264300          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    28410099
264400          INTO :PV-HOLD-TMST                                      28420099
264500          FROM TCKRSTCNTL                                         28430099
264600          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              28440099
264700      END-EXEC.                                                   28450099
264800                                                                  28460099
264900     EVALUATE TRUE                                                28470099
265000         WHEN SQLWARN0 NOT EQUAL SPACE                            28480099
265100         WHEN SQLCODE NOT EQUAL ZERO                              28490099
265200     DISPLAY '**********************************'                 28500099
265300     DISPLAY '** ABEND **'                                        28510099
265400     DISPLAY '** PROGRAM = TRKUP205 **'                           28520099
265500     DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME**'              28530099
265600     DISPLAY '**UNSUCESSFUL SET OF COMMIT INTERVAL**'             28540099
265700     DISPLAY 'IMBKPO PO NUMBER       = ' IMBKPO-PO-NBR            28550099
265800     DISPLAY 'IMBKPO EXTL REF NBR    = ' IMBKPO-EXTL-REF-NBR      28560099
265900     DISPLAY 'IMBKPO PO BKG DELY DTE = '                          28570099
266000                IMBKPO-PO-BKG-DELY-TMST (1:4)                     28580099
266100                IMBKPO-PO-BKG-DELY-TMST (6:2)                     28590099
266200                IMBKPO-PO-BKG-DELY-TMST (9:2)                     28600099
266300     DISPLAY 'IMBKPO PO BKG DELY TM  = '                          28610099
266400                IMBKPO-PO-BKG-DELY-TMST (12:2)                    28620099
266500                IMBKPO-PO-BKG-DELY-TMST (15:2)                    28630099
266600     DISPLAY 'IMBKPO ORGN SHPD FR CDE = ' IMBKPO-ORGN-SHPD-FR-CDE 28640099
266700     DISPLAY 'BOOKING INPUT COUNT    = ' PA-TOTAL-RECS-READ       28650099
266800     DISPLAY 'BKPO RECS INSERT COUNT = ' PA-TOT-BKPO-INSERTS      28660099
266810     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS   28670099
266900*    DISPLAY 'BKVS RECS INSERT COUNT = ' PA-TOT-BKVS-INSERTS      28680099
267000*    DISPLAY 'BKUP RECS INSERT COUNT = ' PA-TOT-BKUPC-INSERTS     28690099
267100     DISPLAY 'ABKPO REC INSERT COUNT = ' PA-TOT-BKPO-AUDITS       28700099
267200*    DISPLAY 'ABKVS REC INSERT COUNT = ' PA-TOT-BKVS-AUDITS       28710099
267300*    DISPLAY 'ABKUP REC INSERT COUNT = ' PA-TOT-BKUPC-AUDITS      28720099
267400     DISPLAY 'BKPO RECS DELETE COUNT = ' PA-TOT-BKPO-DELETES      28730099
267500*    DISPLAY 'BKVS RECS DELETE COUNT = ' PA-TOT-BKVS-DELETES      28740099
267600*    DISPLAY 'BKUP RECS DELETE COUNT = ' PA-TOT-BKUPC-DELETES     28750099
267700     DISPLAY 'BKPO RECS CHANGE COUNT = ' PA-TOT-BKPO-CHANGES      28760099
267800*    DISPLAY 'BKVS RECS CHANGE COUNT = ' PA-TOT-BKVS-CHANGES      28770099
867900*    DISPLAY 'BKUP RECS CHANGE COUNT = ' PA-TOT-BKUP-CHANGES      28780099
268000     DISPLAY 'BKPO CHANGE ADDS - B   = ' PA-TOT-BKPO-CHANGES-B    28790099
268100*    DISPLAY 'BKVS CHANGE ADDS - B   = ' PA-TOT-BKVS-CHANGES-B    28800099
268200*    DISPLAY 'BKUP CHANGE ADDS - B   = ' PA-TOT-BKUP-CHANGES-B    28810099
268300*    DISPLAY 'BKVS CHANGE ADDS - Z   = ' PA-TOT-BKVS-CHANGES-Z    28820099
268400*    DISPLAY 'BKUP CHANGE ADDS - Z   = ' PA-TOT-BKUP-CHANGES-Z    28830099
268500*    DISPLAY 'BKVS DELETES     - E   = ' PA-TOT-BKVS-DELETES-E    28840099
268600*    DISPLAY 'BKUP DELETES     - E   = ' PA-TOT-BKUP-DELETES-E    28850099
268700     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         28860099
268800     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED     28870099
268900     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     28880099
269000     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    28890099
269100     DISPLAY '**********************************'                 28900099
269200                                                                  28910099
269300             PERFORM 9100-SQL-ABEND                               28920099
269400     END-EVALUATE.                                                28930099
269500                                                                  28940099
269600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    28950099
269700         SQLCODE NOT = ZERO                                       28960099
269800         DISPLAY '****************************************'       28970099
269900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       28980099
270000         DISPLAY '** SELECT FROM TCKRSTCNTL             **'       28990099
270100         DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME   **'       29000099
270200         DISPLAY '****************************************'       29010099
270300         PERFORM 9100-SQL-ABEND                                   29020099
270400     END-IF.                                                      29030099
270500                                                                  29040099
270600 EJECT                                                            29050099
270700                                                                  29060099
270800******************************************************************29070099
270900*    CHECK TO SEE IF A COMMIT SHOULD BE TAKEN.                   *29080099
271000******************************************************************29090099
271100 4100-COMMIT-CHECK.                                               29100099
271200                                                                  29110099
271300     EXEC SQL                                                     29120099
271400       SET :PV-TMST = CURRENT TIMESTAMP                           29130099
271500     END-EXEC.                                                    29140099
271600                                                                  29150099
271700     EVALUATE TRUE                                                29160099
271800         WHEN SQLWARN0 NOT EQUAL SPACE                            29170099
271900         WHEN SQLCODE NOT EQUAL ZERO                              29180099
272000     DISPLAY '**********************************'                 29190099
272100     DISPLAY '** ABEND **'                                        29200099
272200     DISPLAY '** PROGRAM = TRKUP205***'                           29210099
272300     DISPLAY '** PARAGRAPH = 4100-COMMIT-CHECK**'                 29220099
272400     DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'                  29230099
272500     DISPLAY 'IMBKPO PO NUMBER       = ' IMBKPO-PO-NBR            29240099
272600     DISPLAY 'IMBKPO EXTL REF NBR    = ' IMBKPO-EXTL-REF-NBR      29250099
272700     DISPLAY 'IMBKPO PO BKG DELY DTE = '                          29260099
272800                IMBKPO-PO-BKG-DELY-TMST (1:4)                     29270099
272900                IMBKPO-PO-BKG-DELY-TMST (6:2)                     29280099
273000                IMBKPO-PO-BKG-DELY-TMST (9:2)                     29290099
273100     DISPLAY 'IMBKPO PO BKG DELY TM  = '                          29300099
273200                IMBKPO-PO-BKG-DELY-TMST (12:2)                    29310099
273300                IMBKPO-PO-BKG-DELY-TMST (15:2)                    29320099
273400     DISPLAY 'IMBKPO ORGN SHPD FR CDE = ' IMBKPO-ORGN-SHPD-FR-CDE 29330099
273500     DISPLAY 'BOOKING INPUT COUNT    = ' PA-TOTAL-RECS-READ       29340099
273600     DISPLAY 'BKPO RECS INSERT COUNT = ' PA-TOT-BKPO-INSERTS      29350099
273610     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS   29360099
273700*    DISPLAY 'BKVS RECS INSERT COUNT = ' PA-TOT-BKVS-INSERTS      29370099
273800*    DISPLAY 'BKUP RECS INSERT COUNT = ' PA-TOT-BKUPC-INSERTS     29380099
273900     DISPLAY 'ABKPO REC INSERT COUNT = ' PA-TOT-BKPO-AUDITS       29390099
274000*    DISPLAY 'ABKVS REC INSERT COUNT = ' PA-TOT-BKVS-AUDITS       29400099
274100*    DISPLAY 'ABKUP REC INSERT COUNT = ' PA-TOT-BKUPC-AUDITS      29410099
274200     DISPLAY 'BKPO RECS DELETE COUNT = ' PA-TOT-BKPO-DELETES      29420099
274300*    DISPLAY 'BKVS RECS DELETE COUNT = ' PA-TOT-BKVS-DELETES      29430099
274400*    DISPLAY 'BKUP RECS DELETE COUNT = ' PA-TOT-BKUPC-DELETES     29440099
274500     DISPLAY 'BKPO RECS CHANGE COUNT = ' PA-TOT-BKPO-CHANGES      29450099
274600*    DISPLAY 'BKVS RECS CHANGE COUNT = ' PA-TOT-BKVS-CHANGES      29460099
274700*    DISPLAY 'BKUP RECS CHANGE COUNT = ' PA-TOT-BKUP-CHANGES      29470099
274800     DISPLAY 'BKPO CHANGE ADDS - B   = ' PA-TOT-BKPO-CHANGES-B    29480099
274900*    DISPLAY 'BKVS CHANGE ADDS - B   = ' PA-TOT-BKVS-CHANGES-B    29490099
275000*    DISPLAY 'BKUP CHANGE ADDS - B   = ' PA-TOT-BKUP-CHANGES-B    29500099
275100*    DISPLAY 'BKVS CHANGE ADDS - Z   = ' PA-TOT-BKVS-CHANGES-Z    29510099
275200*    DISPLAY 'BKUP CHANGE ADDS - Z   = ' PA-TOT-BKUP-CHANGES-Z    29520099
275300*    DISPLAY 'BKVS DELETES     - E   = ' PA-TOT-BKVS-DELETES-E    29530099
275400*    DISPLAY 'BKUP DELETES     - E   = ' PA-TOT-BKUP-DELETES-E    29540099
275500     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         29550099
275600     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED     29560099
275700     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     29570099
275800     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    29580099
275900     DISPLAY '**********************************'                 29590099
276000                                                                  29600099
276100             PERFORM 9100-SQL-ABEND                               29610099
276200     END-EVALUATE.                                                29620099
276300                                                                  29630099
276400     IF PV-TMST > PV-HOLD-TMST                                    29640099
276500         IF NO-COMMITS-TAKEN                                      29650099
276600             MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE         29660099
276700             PERFORM 4200-UPDATE-TCKRSTCNTL                       29670099
276800             SET COMMITS-TAKEN TO TRUE                            29680099
276900         END-IF                                                   29690099
277000        PERFORM 4210-UPDATE-TCKRSTINF                             29700099
277100        PERFORM 4300-COMMIT                                       29710099
277200        DISPLAY 'COMMIT TAKEN AT '                                29720099
277300        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)29730099
277400         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)29740099
277500        DISPLAY 'IMBKPO PO NUMBER       = ' IMBKPO-PO-NBR         29750099
277600        DISPLAY 'IMBKPO EXTL REF NBR    = ' IMBKPO-EXTL-REF-NBR   29760099
277700        DISPLAY 'IMBKPO PO BKG DELY DTE = '                       29770099
277800                   IMBKPO-PO-BKG-DELY-TMST (1:4)                  29780099
277900                   IMBKPO-PO-BKG-DELY-TMST (6:2)                  29790099
278000                   IMBKPO-PO-BKG-DELY-TMST (9:2)                  29800099
278100        DISPLAY 'IMBKPO PO BKG DELY TM  = '                       29810099
278200                   IMBKPO-PO-BKG-DELY-TMST (12:2)                 29820099
278300                   IMBKPO-PO-BKG-DELY-TMST (15:2)                 29830099
278400        DISPLAY 'IMBKPO ORGN SHPD FR CDE = '                      29840099
278500                   IMBKPO-ORGN-SHPD-FR-CDE                        29850099
278600        DISPLAY 'BOOKING INPUT COUNT    = ' PA-TOTAL-RECS-READ    29860099
278700        DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS      29870099
278800        DISPLAY 'TOTAL LOADED COUNT     = ' PA-TOTAL-RECS-LOADED  29880099
278900        DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT  29890099
279000        DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT 29900099
279100        PERFORM 4020-SET-COMMIT-TIME                              29910099
279200     END-IF.                                                      29920099
279300                                                                  29930099
279400 EJECT                                                            29940099
279500                                                                  29950099
279600******************************************************************29960099
279700*    CHECK TO SEE IF A CHECKPOINT RESTART SHOULD BE DONE.        *29970099
279800******************************************************************29980099
279900 4110-CHECKPOINT-RESTART.                                         29990099
280000                                                                  30000099
280100     PERFORM 4010-GET-CHECKPOINT-INFO.                            30010099
280200     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.     30020099
280300                                                                  30030099
280400     DISPLAY '***********************************************'.   30040099
280500     DISPLAY '** TRKUP205 CHECKPOINT RESTART **'.                 30050099
280600     DISPLAY '** BOOKING RECS BYPASSED ON RESTART = '.            30060099
280700     DISPLAY  CR-BOOKING-RECS-WORKED.                             30070099
280800     DISPLAY '***********************************************'.   30080099
280900                                                                  30090099
281000     IF INPUT-BOOKING-FILE                                        30100099
281100         PERFORM 6000-READ-BKG-FILE                               30110099
281200             CR-BOOKING-RECS-WORKED TIMES                         30120099
281300*        PERFORM 6000-READ-BKG-FILE                               30130099
281400     ELSE                                                         30140099
281500         MOVE CR-BOOKING-RECS-WORKED TO PA-TOTAL-RECS-READ        30150099
281600         SET PS-END-OF-INPUT TO TRUE                              30160099
281700     END-IF.                                                      30170099
281800 EJECT                                                            30180099
281900                                                                  30190099
282000******************************************************************30200099
282100*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *30210099
282200*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *30220099
282300******************************************************************30230099
282400 4200-UPDATE-TCKRSTCNTL.                                          30240099
282500                                                                  30250099
282600     PERFORM WITH TEST AFTER                                      30260099
282700             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 30270099
282800             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         30280099
282900                     SQLCODE = ZERO                               30290099
283000                                                                  30300099
283100         EXEC SQL                                                 30310099
283200             UPDATE TCKRSTCNTL                                    30320099
283300             SET CKPT_STAT_CODE = :PV-CKPT-STAT-CODE              30330099
283400             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME      30340099
283500         END-EXEC                                                 30350099
283600                                                                  30360099
283700         EVALUATE TRUE                                            30370099
283800             WHEN SQLCODE = ZERO                                  30380099
283900             WHEN SQLCODE = -904                                  30390099
284000             WHEN SQLCODE = -911                                  30400099
284000             WHEN SQLCODE = -913                                  30410099
284100                  CONTINUE                                        30420099
284200                                                                  30430099
284300             WHEN SQLWARN0 NOT EQUAL SPACE                        30440099
284400             WHEN SQLCODE NOT EQUAL ZERO                          30450099
284500                 DISPLAY '**************************************' 30460099
284600                 DISPLAY '** ABEND                            **' 30470099
284700                 DISPLAY '** PROGRAM = TRKUP205               **' 30480099
284800                 DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL*' 30490099
284900                 DISPLAY '** UPDATE TCKRSTCNTL                **' 30500099
285000                 DISPLAY '**' PV-CKPT-STAT-CODE                   30510099
285100                 DISPLAY '**************************************' 30520099
285200                 PERFORM 9100-SQL-ABEND                           30530099
285300         END-EVALUATE                                             30540099
285400     END-PERFORM.                                                 30550099
285500                                                                  30560099
285600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    30570099
285700         SQLCODE NOT = ZERO                                       30580099
285800         DISPLAY '****************************************'       30590099
285900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       30600099
286000         DISPLAY '** UPDATE TO TCKRSTCNTL               **'       30610099
286100         DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL **'       30620099
286200         DISPLAY '**' PV-CKPT-STAT-CODE                           30630099
286300         DISPLAY '****************************************'       30640099
286400         PERFORM 9100-SQL-ABEND                                   30650099
286500     END-IF.                                                      30660099
286600                                                                  30670099
286700 EJECT                                                            30680099
286800                                                                  30690099
286900******************************************************************30700099
287000*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING     *30710099
287100*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE CURRENT INPUT *30720099
287200*    FILE RECORD COUNTS AND THE FILE PROCESSOR INDICATOR.        *30730099
287300******************************************************************30740099
287400 4210-UPDATE-TCKRSTINF.                                           30750099
287500                                                                  30760099
287600     MOVE PA-TOTAL-RECS-READ  TO CR-BOOKING-RECS-WORKED.          30770099
287700     MOVE CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.   30780099
287800     MOVE 4022                TO TCKRSTINF-WORK-STRG-DESC-LEN.    30790099
287900                                                                  30800099
288000     PERFORM WITH TEST AFTER                                      30810099
288100             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 30820099
288200             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         30830099
288300                     SQLCODE = ZERO                               30840099
288400                                                                  30850099
288500         EXEC SQL                                                 30860099
288600             UPDATE TCKRSTINF                                     30870099
288700             SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC     30880099
288800             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME      30890099
288900         END-EXEC                                                 30900099
289000                                                                  30910099
289100         EVALUATE TRUE                                            30920099
289200             WHEN SQLCODE = ZERO                                  30930099
289300             WHEN SQLCODE = -904                                  30940099
289400             WHEN SQLCODE = -911                                  30950099
289400             WHEN SQLCODE = -913                                  30960099
289500                  CONTINUE                                        30970099
289600                                                                  30980099
289700             WHEN SQLWARN0 NOT EQUAL SPACE                        30990099
289800             WHEN SQLCODE NOT EQUAL ZERO                          31000099
289900                 DISPLAY '**************************************' 31010099
290000                 DISPLAY '** ABEND                            **' 31020099
290100                 DISPLAY '** PROGRAM = TRKUP205               **' 31030099
290200                 DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF**' 31040099
290300                 DISPLAY '** UPDATE TCKRSTINF                 **' 31050099
290400                 DISPLAY '**' TCKRSTINF-WORK-STRG-DESC            31060099
290500                 DISPLAY '**************************************' 31070099
290600                 PERFORM 9100-SQL-ABEND                           31080099
290700         END-EVALUATE                                             31090099
290800     END-PERFORM.                                                 31100099
290900                                                                  31110099
291000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    31120099
291100         SQLCODE NOT = ZERO                                       31130099
291200         DISPLAY '****************************************'       31140099
291300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       31150099
291400         DISPLAY '** UPDATE TCKRSTINF                   **'       31160099
291500         DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF  **'       31170099
291600         DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                    31180099
291700         DISPLAY '****************************************'       31190099
291800         PERFORM 9100-SQL-ABEND                                   31200099
291900     END-IF.                                                      31210099
292000                                                                  31220099
292100 EJECT                                                            31230099
292200                                                                  31240099
292300******************************************************************31250099
292400*  ISSUES AN SQL COMMIT AFTER A LOGICAL UNIT OF WORK HAS BEEN    *31260099
292500*  COMPLETED.                                                    *31270099
292600******************************************************************31280099
292700 4300-COMMIT.                                                     31290099
292800                                                                  31300099
292900     EXEC SQL                                                     31310099
293000         COMMIT                                                   31320099
293100     END-EXEC.                                                    31330099
293200                                                                  31340099
293300     EVALUATE TRUE                                                31350099
293400         WHEN SQLWARN0 NOT EQUAL SPACE                            31360099
293500         WHEN SQLCODE NOT EQUAL ZERO                              31370099
293600     DISPLAY '**********************************'                 31380099
293700     DISPLAY 'IMBKPO PO NUMBER       = ' IMBKPO-PO-NBR            31390099
293800     DISPLAY 'IMBKPO EXTL REF NBR    = ' IMBKPO-EXTL-REF-NBR      31400099
293900     DISPLAY 'IMBKPO PO BKG DELY DTE = '                          31410099
294000                IMBKPO-PO-BKG-DELY-TMST (1:4)                     31420099
294100                IMBKPO-PO-BKG-DELY-TMST (6:2)                     31430099
294200                IMBKPO-PO-BKG-DELY-TMST (9:2)                     31440099
294300     DISPLAY 'IMBKPO PO BKG DELY TM  = '                          31450099
294400                IMBKPO-PO-BKG-DELY-TMST (12:2)                    31460099
294500                IMBKPO-PO-BKG-DELY-TMST (15:2)                    31470099
294600     DISPLAY 'IMBKPO ORGN SHPD FR CDE = ' IMBKPO-ORGN-SHPD-FR-CDE 31480099
294700     DISPLAY 'BOOKING INPUT COUNT    = ' PA-TOTAL-RECS-READ       31490099
294800     DISPLAY 'BKPO RECS INSERT COUNT = ' PA-TOT-BKPO-INSERTS      31500099
294810     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS   31510099
294900*    DISPLAY 'BKVS RECS INSERT COUNT = ' PA-TOT-BKVS-INSERTS      31520099
295000*    DISPLAY 'BKUP RECS INSERT COUNT = ' PA-TOT-BKUPC-INSERTS     31530099
295100     DISPLAY 'ABKPO REC INSERT COUNT = ' PA-TOT-BKPO-AUDITS       31540099
295200*    DISPLAY 'ABKVS REC INSERT COUNT = ' PA-TOT-BKVS-AUDITS       31550099
295300*    DISPLAY 'ABKUP REC INSERT COUNT = ' PA-TOT-BKUPC-AUDITS      31560099
295400     DISPLAY 'BKPO RECS DELETE COUNT = ' PA-TOT-BKPO-DELETES      31570099
295500*    DISPLAY 'BKVS RECS DELETE COUNT = ' PA-TOT-BKVS-DELETES      31580099
295600*    DISPLAY 'BKUP RECS DELETE COUNT = ' PA-TOT-BKUPC-DELETES     31590099
295700     DISPLAY 'BKPO RECS CHANGE COUNT = ' PA-TOT-BKPO-CHANGES      31600099
295800*    DISPLAY 'BKVS RECS CHANGE COUNT = ' PA-TOT-BKVS-CHANGES      31610099
295900*    DISPLAY 'BKUP RECS CHANGE COUNT = ' PA-TOT-BKUP-CHANGES      31620099
296000     DISPLAY 'BKPO CHANGE ADDS - B   = ' PA-TOT-BKPO-CHANGES-B    31630099
296100*    DISPLAY 'BKVS CHANGE ADDS - B   = ' PA-TOT-BKVS-CHANGES-B    31640099
296200*    DISPLAY 'BKUP CHANGE ADDS - B   = ' PA-TOT-BKUP-CHANGES-B    31650099
296300*    DISPLAY 'BKVS CHANGE ADDS - Z   = ' PA-TOT-BKVS-CHANGES-Z    31660099
296400*    DISPLAY 'BKUP CHANGE ADDS - Z   = ' PA-TOT-BKUP-CHANGES-Z    31670099
296500*    DISPLAY 'BKVS DELETES     - E   = ' PA-TOT-BKVS-DELETES-E    31680099
296600*    DISPLAY 'BKUP DELETES     - E   = ' PA-TOT-BKUP-DELETES-E    31690099
296700     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS         31700099
296800     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED     31710099
296900     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT     31720099
297000     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT    31730099
297100     DISPLAY '**********************************'                 31740099
297200     DISPLAY '** ABEND **'                                        31750099
297300     DISPLAY '** PROGRAM = TRKUP205 **'                           31760099
297400     DISPLAY '** PARAGRAPH = 4300-COMMIT**'                       31770099
297500     DISPLAY '**UNSUCCESSFUL COMMIT**'                            31780099
297600     DISPLAY '**********************************'                 31790099
297700             PERFORM 9100-SQL-ABEND                               31800099
297800         WHEN SQLCODE EQUAL ZERO                                  31810099
297900             ADD +1 TO PA-TOTAL-COMMITS                           31820099
298000     END-EVALUATE.                                                31830099
298100 EJECT                                                            31840099
298200                                                                  31850099
298300******************************************************************31860099
298400* READ THE BOOKING FILE                                          *31870099
298500******************************************************************31880099
298600 6000-READ-BKG-FILE.                                              31890099
298700                                                                  31900099
298800     READ TR024-BOOKING-FILE                                      31910099
298900         INTO TR024-REC-TYP-EDD                                   31920099
299000         AT END                                                   31930099
299100           SET PS-END-OF-INPUT TO TRUE.                           31940099
299200                                                                  31950099
299300     IF PS-END-OF-INPUT                                           31960099
299400         CONTINUE                                                 31970099
299500     ELSE                                                         31980099
299600         MOVE TR024-BOOKING-RECORD (1:3) TO PV-EDI-RECORDS        31990099
299700         IF EDI-RECORD                                            32000099
299800             ADD +1 TO PA-TOTAL-RECS-READ                         32010099
299900         ELSE                                                     32020099
300000             SET PS-GOOD-RECORD TO TRUE                           32030099
300100             ADD +1 TO PA-TOTAL-RECS-READ                         32040099
300200             IF (TR024-EDD-REC-TYP-CDE-EDD) OR                    32050099
300210                (TR024-EDD-REC-TYP-CDE = PC-EDL AND               32060099
300220                 TR024-EDD-TRN-TYP = PC-D)                        32070099
300300                 MOVE TR024-EDD-ENT-ID                            32080099
300400                             TO PV-HOLD-DAT-SRC-ENT-ID            32090099
300401             END-IF                                               32100099
300402         END-IF                                                   32110099
300403     END-IF.                                                      32120099
300404                                                                  32130099
300500                                                                  32140099
300600***************************************************************** 32150099
300700* SETUP THE TR201 RECORD BY MOVING FIELDS THAT ARE INCLUDED IN  * 32160099
300800* BOTH DETAIL AND ERROR RECORDS REGARDLESS OF WHETHER THE       * 32170099
300900* RECORD TYPES ARE EDD, EDDRSN, EDL, EDLVS, EDLUPC.             * 32180099
301000* THESE FIELDS INCLUDE THE HOLD AND KEY FIELDS FOR THE RECORD.  * 32190099
301100***************************************************************** 32200099
301200 6250-MOVE-LIKE-RPT-FIELDS.                                       32210099
301300                                                                  32220099
301400     IF PS-CHANGE-ADD                                             32230099
301500         MOVE PC-B                     TO TR201-TRN-TYP           32240099
301600     ELSE                                                         32250099
301700*        IF PS-CHANGE-ADD-VS-OR-UPC                               32260099
301800*            MOVE PC-Z                 TO TR201-TRN-TYP           32270099
301900*        ELSE                                                     32280099
302000             MOVE TR024-EDD-TRN-TYP    TO TR201-TRN-TYP           32290099
302100*        END-IF                                                   32300099
302200     END-IF.                                                      32310099
302300                                                                  32320099
302400     MOVE TR024-EDD-REC-TYP-CDE        TO TR201-REC-TYP-EDD-CDE   32330099
302500     MOVE TR024-EDD-SEQ-NBR            TO TR201-EDD-SEQ-NBR       32340099
302600     MOVE TR024-EDD-PO-NBR             TO TR201-PO-NBR.           32350099
302700     MOVE TR024-EDD-EXTL-REF-NBR       TO TR201-EXTL-REF-NBR.     32360099
302800     MOVE TR024-EDD-PO-BKG-DELY-DTE    TO TR201-PO-BKG-DELY-DTE.  32370099
302900     MOVE TR024-EDD-PO-BKG-DELY-TM     TO TR201-PO-BKG-DELY-TM.   32380099
303000     MOVE TR024-EDD-ORGN-SHPD-FR-CDE   TO TR201-ORGN-SHPD-FR-CDE. 32390099
303100                                                                  32400099
303200     MOVE TR024-EDD-PROCESS-SEQ-NBR TO TR201-PROCESS-SEQ-NBR.     32410099
303300                                                                  32420099
303400 EJECT                                                            32430099
303500                                                                  32440099
303600***************************************************************** 32450099
303700* LOAD THE ERROR FIELDS WHEN PO IS ALREADY ON TIMBKPO AND THE   * 32460099
303800* CONSOLIDATOR HAS SENT AN ADD.                                 * 32470099
303900***************************************************************** 32480099
304000 6300-PO-THERE-ON-ADD-ERROR.                                      32490099
304100                                                                  32500099
304200     MOVE PC-E                          TO                        32510099
304300        TR201-RPT-TYP.                                            32520099
304400     MOVE 'PO NUMBER'                   TO                        32530099
304500        TR201-DATA-IN-ERROR.                                      32540099
304600     MOVE TR024-EDD-PO-NBR              TO                        32550099
304700        TR201-DATA-VALUE.                                         32560099
304800     MOVE PC-ERROR                      TO                        32570099
304900        TR201-ERROR-TYPE.                                         32580099
305000     MOVE 'ADD SENT, PO PREVIOUSLY SENT-NOT PROCESSED' TO         32590099
305100        TR201-ERROR-MSG.                                          32600099
305200                                                                  32610099
305300***************************************************************** 32620099
305400* LOAD THE ERROR FIELDS WHEN VS IS ALREADY ON TIMBKVS AND THE   * 32630099
305500* CONSOLIDATOR HAS SENT AN ADD.                                 * 32640099
305600***************************************************************** 32650099
305700*6310-VS-THERE-ON-ADD-ERROR.                                      32660099
305800                                                                  32670099
305900*    MOVE PC-E                          TO                        32680099
306000*       TR201-RPT-TYP.                                            32690099
306100*    MOVE 'VS NUMBER'                   TO                        32700099
306200*       TR201-DATA-IN-ERROR.                                      32710099
306300*    MOVE TR024-EDLVS-VS-NBR            TO                        32720099
306400*       TR201-DATA-VALUE.                                         32730099
306500*    MOVE PC-ERROR                      TO                        32740099
306600*       TR201-ERROR-TYPE.                                         32750099
306700*    MOVE 'ADD SENT, VS PREVIOUSLY SENT-NOT PROCESSED' TO         32760099
306800*       TR201-ERROR-MSG.                                          32770099
306900                                                                  32780099
307000***************************************************************** 32790099
307100* MOVE THE FIELDS THAT ARE UNIQUE TO EACH RECORD TYPE (EDD,       32800099
307200* EDDRSN, EDL, EDLVS, EDLUPC). THIS COMPLETES THE RECORD SETUP    32810099
307300* PRIOR TO INSERTING TO THE DB2 WORKTABLE (TOUTTR6).              32820099
307400***************************************************************** 32830099
307500 6400-MOVE-UNIQUE-RPT-FIELDS.                                     32840099
307600                                                                  32850099
307700         EVALUATE TR024-EDD-REC-TYP-CDE                           32860099
307800             WHEN PC-EDD                                          32870099
307900                 MOVE TR024-EDD-IMPRT-TRIP-ID        TO           32880099
308000                       TR201-EDD-IMPRT-TRIP-ID                    32890099
308100                 MOVE TR024-EDD-CARR-SCAC-ID         TO           32900099
308200                       TR201-EDD-CARR-SCAC-ID                     32910099
308300                 MOVE TR024-EDD-IMPRT-VEH-NM         TO           32920099
308400                       TR201-EDD-IMPRT-VEH-NM                     32930099
308500                 MOVE TR024-EDD-POE-DELY-DTE         TO           32940099
308600                       TR201-EDD-POE-DELY-DTE                     32950099
308700                 MOVE TR024-EDD-POE-DELY-TM          TO           32960099
308800                       TR201-EDD-POE-DELY-TM                      32970099
308900                 MOVE TR024-EDD-DPRTR-DTE            TO           32980099
309000                       TR201-EDD-DPRTR-DTE                        32990099
309100                 MOVE TR024-EDD-DPRTR-TM             TO           33000099
309200                       TR201-EDD-DPRTR-TM                         33010099
309300                 MOVE TR024-EDD-FOB-CDE              TO           33020099
309400                       TR201-EDD-FOB-CDE                          33030099
309500                 MOVE TR024-EDD-DEST-POE-CDE         TO           33040099
309600                       TR201-EDD-DEST-POE-CDE                     33050099
309700                 MOVE TR024-EDD-TRIP-TYP-CDE         TO           33060099
309800                       TR201-EDD-TRIP-TYP-CDE                     33070099
309900                 MOVE TR024-EDD-EST-LBD-NM           TO           33080099
310000                       TR201-EDD-EST-LBD-NM                       33090099
310100             WHEN PC-EDDRSN                                       33100099
310200                 MOVE TR024-EDDRSN-VOY-CHG-RSN-DESC  TO           33110099
310300                       TR201-EDDRSN-VOY-CHG-RSN-DESC              33120099
310400             WHEN PC-EDL                                          33130099
310500                 MOVE TR024-EDL-PROD-FCTRY-NM        TO           33140099
310600                       TR201-EDL-PROD-FCTRY-NM                    33150099
310700                 MOVE TR024-EDL-C-O-PROD-CDE         TO           33160099
310800                       TR201-EDL-C-O-PROD-CDE                     33170099
310900                 IF TR024-EDL-PO-CART-CNT NUMERIC                 33180099
311000                     MOVE TR024-EDL-PO-CART-CNT      TO           33190099
311100                           TR201-EDL-PO-CART-CNT                  33200099
311200                 ELSE                                             33210099
311300                     MOVE TR024-EDL-PO-CART-CNT-X    TO           33220099
311400                           TR201-EDL-PO-CART-CNT-X                33230099
311500                 END-IF                                           33240099
311600                 IF TR024-EDL-PO-UNT-QTY NUMERIC                  33250099
311700                     MOVE TR024-EDL-PO-UNT-QTY       TO           33260099
311800                           TR201-EDL-PO-UNT-QTY                   33270099
311900                 ELSE                                             33280099
312000                     MOVE TR024-EDL-PO-UNT-QTY-X     TO           33290099
312100                           TR201-EDL-PO-UNT-QTY-X                 33300099
312200                 END-IF                                           33310099
312300                 IF TR024-EDL-PO-CBMT-QTY NUMERIC                 33320099
312400                     MOVE TR024-EDL-PO-CBMT-QTY      TO           33330099
312500                           TR201-EDL-PO-CBMT-QTY                  33340099
312600                 ELSE                                             33350099
312700                     MOVE TR024-EDL-PO-CBMT-QTY-X    TO           33360099
312800                           TR201-EDL-PO-CBMT-QTY-X                33370099
312900                 END-IF                                           33380099
313000                 IF TR024-EDL-PO-WT-KGRM-QTY NUMERIC              33390099
313100                     MOVE TR024-EDL-PO-WT-KGRM-QTY   TO           33400099
313200                           TR201-EDL-PO-WT-KGRM-QTY               33410099
313300                 ELSE                                             33420099
313400                     MOVE TR024-EDL-PO-WT-KGRM-QTY-X TO           33430099
313500                           TR201-EDL-PO-WT-KGRM-QTY-X             33440099
313600                 END-IF                                           33450099
313700                 MOVE TR024-EDL-CONSOL-SCAC-ID       TO           33460099
313800                       TR201-EDL-CONSOL-SCAC-ID                   33470099
313900             WHEN PC-EDLVS                                        33480099
314000                 MOVE TR024-EDLVS-VS-NBR             TO           33490099
314100                       TR201-EDLVS-VS-NBR                         33500099
314200                 IF TR024-EDLVS-VS-CART-CNT NUMERIC               33510099
314300                     MOVE TR024-EDLVS-VS-CART-CNT    TO           33520099
314400                           TR201-EDLVS-VS-CART-CNT                33530099
314500                 ELSE                                             33540099
314600                     MOVE TR024-EDLVS-VS-CART-CNT-X  TO           33550099
314700                           TR201-EDLVS-VS-CART-CNT-X              33560099
314800                 END-IF                                           33570099
314900                 IF TR024-EDLVS-VS-UNT-QTY NUMERIC                33580099
315000                     MOVE TR024-EDLVS-VS-UNT-QTY     TO           33590099
315100                           TR201-EDLVS-VS-UNT-QTY                 33600099
315200                 ELSE                                             33610099
315300                     MOVE TR024-EDLVS-VS-UNT-QTY-X   TO           33620099
315400                           TR201-EDLVS-VS-UNT-QTY-X               33630099
315500                 END-IF                                           33640099
315600                 IF TR024-EDLVS-VS-CBMT-QTY NUMERIC               33650099
315700                     MOVE TR024-EDLVS-VS-CBMT-QTY    TO           33660099
315800                           TR201-EDLVS-VS-CBMT-QTY                33670099
315900                 ELSE                                             33680099
316000                     MOVE TR024-EDLVS-VS-CBMT-QTY-X  TO           33690099
316100                           TR201-EDLVS-VS-CBMT-QTY-X              33700099
316200                 END-IF                                           33710099
316300                 IF TR024-EDLVS-VS-WT-KGRM-QTY NUMERIC            33720099
316400                     MOVE TR024-EDLVS-VS-WT-KGRM-QTY   TO         33730099
316500                           TR201-EDLVS-VS-WT-KGRM-QTY             33740099
316600                 ELSE                                             33750099
316700                     MOVE TR024-EDLVS-VS-WT-KGRM-QTY-X TO         33760099
316800                           TR201-EDLVS-VS-WT-KGRM-QTY-X           33770099
316900                 END-IF                                           33780099
317000             WHEN PC-EDLUPC                                       33790099
317100                 MOVE TR024-EDLUPC-VS-NBR              TO         33800099
317200                       TR201-EDLUPC-VS-NBR                        33810099
317300                 IF TR024-EDLUPC-UPC-NBR NUMERIC                  33820099
317400                     MOVE TR024-EDLUPC-UPC-NBR         TO         33830099
317500                           TR201-EDLUPC-UPC-NBR                   33840099
317600                 ELSE                                             33850099
317700                     MOVE TR024-EDLUPC-UPC-NBR-X       TO         33860099
317800                           TR201-EDLUPC-UPC-NBR-X                 33870099
317900                 END-IF                                           33880099
318000                 IF TR024-EDLUPC-UPC-CART-CNT NUMERIC             33890099
318100                     MOVE TR024-EDLUPC-UPC-CART-CNT    TO         33900099
318200                           TR201-EDLUPC-UPC-CART-CNT              33910099
318300                 ELSE                                             33920099
318400                     MOVE TR024-EDLUPC-UPC-CART-CNT-X  TO         33930099
318500                           TR201-EDLUPC-UPC-CART-CNT-X            33940099
318600                 END-IF                                           33950099
318700                 IF TR024-EDLUPC-UPC-UNT-QTY NUMERIC              33960099
318800                     MOVE TR024-EDLUPC-UPC-UNT-QTY     TO         33970099
318900                           TR201-EDLUPC-UPC-UNT-QTY               33980099
319000                 ELSE                                             33990099
319100                     MOVE TR024-EDLUPC-UPC-UNT-QTY-X   TO         34000099
319200                           TR201-EDLUPC-UPC-UNT-QTY-X             34010099
319300                 END-IF                                           34020099
319400                 IF TR024-EDLUPC-UPC-CBMT-QTY NUMERIC             34030099
319500                     MOVE TR024-EDLUPC-UPC-CBMT-QTY    TO         34040099
319600                           TR201-EDLUPC-UPC-CBMT-QTY              34050099
319700                 ELSE                                             34060099
319800                     MOVE TR024-EDLUPC-UPC-CBMT-QTY-X  TO         34070099
319900                           TR201-EDLUPC-UPC-CBMT-QTY-X            34080099
320000                 END-IF                                           34090099
320100                 IF TR024-EDLUPC-UPC-WT-KGRM-QTY NUMERIC          34100099
320200                     MOVE TR024-EDLUPC-UPC-WT-KGRM-QTY   TO       34110099
320300                           TR201-EDLUPC-UPC-WT-KGRM-QTY           34120099
320400                 ELSE                                             34130099
320500                     MOVE TR024-EDLUPC-UPC-WT-KGRM-QTY-X TO       34140099
320600                           TR201-EDLUPC-UPC-WT-KGRM-QTY-X         34150099
320700                 END-IF                                           34160099
320800         END-EVALUATE.                                            34170099
320900                                                                  34180099
321000 EJECT                                                            34190099
321100                                                                  34200099
321200***************************************************************** 34210099
321300* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  * 34220099
321400* THAT ARE ON EACH RECORD REGARDLESS OF WHETHER THE             * 34230099
321500* RECORD TYPES ARE EDD, EDDRSN, EDL, EDLVS, EDLUPC.             * 34240099
321600* THESE FIELDS INCLUDE THE HOLD AND KEY FIELDS FOR THE RECORD.  * 34250099
321700***************************************************************** 34260099
321800 6425-LIKE-MOVES-INSERT-TIMBKPO.                                  34270099
321900                                                                  34280099
322000     MOVE TR024-EDD-PO-NBR                        TO              34290099
322100              IMBKPO-PO-NBR.                                      34300099
322200     MOVE PV-BKG-SEQ-NBR-MAX                      TO              34310099
322300              IMBKPO-PO-BKG-SEQ-NBR.                              34320099
322400     MOVE TR024-EDD-PO-BKG-DELY-DTE (1:4)         TO              34330099
322500              IMBKPO-PO-BKG-DELY-TMST (1:4)                       34340099
322600     MOVE PC-DASH                                 TO              34350099
322700              IMBKPO-PO-BKG-DELY-TMST (5:1)                       34360099
322800     MOVE TR024-EDD-PO-BKG-DELY-DTE (5:2)         TO              34370099
322900              IMBKPO-PO-BKG-DELY-TMST (6:2)                       34380099
323000     MOVE PC-DASH                                 TO              34390099
323100              IMBKPO-PO-BKG-DELY-TMST (8:1)                       34400099
323200     MOVE TR024-EDD-PO-BKG-DELY-DTE (7:2)         TO              34410099
323300              IMBKPO-PO-BKG-DELY-TMST (9:2)                       34420099
323400     MOVE PC-DASH                                 TO              34430099
323500              IMBKPO-PO-BKG-DELY-TMST (11:1)                      34440099
323600     MOVE TR024-EDD-PO-BKG-DELY-TM (1:2)          TO              34450099
323700              IMBKPO-PO-BKG-DELY-TMST (12:2)                      34460099
323800     MOVE PC-DECIMAL                              TO              34470099
323900              IMBKPO-PO-BKG-DELY-TMST (14:1)                      34480099
324000     MOVE TR024-EDD-PO-BKG-DELY-TM (3:2)          TO              34490099
324100              IMBKPO-PO-BKG-DELY-TMST (15:2)                      34500099
324200     MOVE PC-DECIMAL                              TO              34510099
324300              IMBKPO-PO-BKG-DELY-TMST (17:1)                      34520099
324400     MOVE ZEROES                                  TO              34530099
324500              IMBKPO-PO-BKG-DELY-TMST (18:2)                      34540099
324600     MOVE PC-DECIMAL                              TO              34550099
324700              IMBKPO-PO-BKG-DELY-TMST (20:1)                      34560099
324800     MOVE ZEROES                                  TO              34570099
324900              IMBKPO-PO-BKG-DELY-TMST (21:6)                      34580099
325000     MOVE TR024-EDD-EXTL-REF-NBR                  TO              34590099
325100              IMBKPO-EXTL-REF-NBR.                                34600099
325200     MOVE TR024-EDD-ORGN-SHPD-FR-CDE              TO              34610099
325300              IMBKPO-ORGN-SHPD-FR-CDE.                            34620099
325400     MOVE SPACES                                  TO              34630099
325500              IMBKPO-PO-EXC-APVL-CDE.                             34640099
325600     MOVE SPACES                                  TO              34650099
325700              IMBKPO-PO-EXC-APVL-USR-ID.                          34660099
325800     MOVE PC-DEFAULT-TMST                         TO              34670099
325900              IMBKPO-PO-EXC-APVL-TMST.                            34680099
326000     MOVE SPACES                                  TO              34690099
326100              IMBKPO-PO-EXC-RSN-DESC.                             34700099
326200     MOVE PC-DEFAULT-TMST                         TO              34710099
326300              IMBKPO-SHIPT-BKG-TMST.                              34720099
326400     MOVE TR024-EDD-ENT-ID                        TO              34730099
326500              PV-ENT-ID-SIGNED.                                   34740099
326510     MOVE PV-ENT-ID-SIGNED                        TO              34750099
326520              IMBKPO-DAT-SRC-ENT-ID.                              34760099
326600     MOVE PC-CURRENT-PROGRAM-NAME                 TO              34770099
326700              IMBKPO-CRE-BY-USR-ID.                               34780099
326800     PERFORM 7999-SET-CURRENT-TMST.                               34790099
326900     MOVE PV-CURRENT-TMST                         TO              34800099
327000              IMBKPO-CRE-TMST.                                    34810099
327100     MOVE PC-CURRENT-PROGRAM-NAME                 TO              34820099
327200              IMBKPO-LAST-UPD-BY-USR-ID.                          34830099
327300     MOVE PV-CURRENT-TMST                         TO              34840099
327400              IMBKPO-LAST-UPD-TMST.                               34850099
327500                                                                  34860099
327600 EJECT                                                            34870099
327700                                                                  34880099
327800***************************************************************** 34890099
327900* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  * 34900099
328000* THAT ARE UNIQUE TO EACH RECORD TYPE.                          * 34910099
328100* RECORD TYPES ARE EDD, EDDRSN, EDL.                            * 34920099
328200***************************************************************** 34930099
328300 6450-MOVES-INSERT-TIMBKPO.                                       34940099
328400                                                                  34950099
328500         EVALUATE TR024-EDD-REC-TYP-CDE                           34960099
328600             WHEN PC-EDD                                          34970099
328700                                                                  34980099
328800                 IF PS-EDD-EDDRSN-EDL-LOOP-NO                     34990099
328900                     MOVE PV-BKG-SEQ-NBR-MAX        TO            35000099
329000                          IMBKPO-PO-BKG-SEQ-NBR                   35010099
329100                 END-IF                                           35020099
329200                 MOVE TR024-EDD-IMPRT-TRIP-ID       TO            35030099
329300                          IMBKPO-IMPRT-TRIP-ID                    35040099
329400                 MOVE TR024-EDD-DPRTR-DTE (1:4)     TO            35050099
329500                          IMBKPO-DPRTR-TMST (1:4)                 35060099
329600                 MOVE PC-DASH                       TO            35070099
329700                          IMBKPO-DPRTR-TMST (5:1)                 35080099
329800                 MOVE TR024-EDD-DPRTR-DTE (5:2)     TO            35090099
329900                          IMBKPO-DPRTR-TMST (6:2)                 35100099
330000                 MOVE PC-DASH                       TO            35110099
330100                          IMBKPO-DPRTR-TMST (8:1)                 35120099
330200                 MOVE TR024-EDD-DPRTR-DTE (7:2)     TO            35130099
330300                          IMBKPO-DPRTR-TMST (9:2)                 35140099
330400                 MOVE PC-DASH                       TO            35150099
330500                          IMBKPO-DPRTR-TMST (11:1)                35160099
330600                 MOVE TR024-EDD-DPRTR-TM (1:2)      TO            35170099
330700                          IMBKPO-DPRTR-TMST (12:2)                35180099
330800                 MOVE PC-DECIMAL                    TO            35190099
330900                          IMBKPO-DPRTR-TMST (14:1)                35200099
331000                 MOVE TR024-EDD-DPRTR-TM (3:2)      TO            35210099
331100                          IMBKPO-DPRTR-TMST (15:2)                35220099
331200                 MOVE PC-DECIMAL                    TO            35230099
331300                          IMBKPO-DPRTR-TMST (17:1)                35240099
331400                 MOVE ZEROES                        TO            35250099
331500                          IMBKPO-DPRTR-TMST (18:2)                35260099
331600                 MOVE PC-DECIMAL                    TO            35270099
331700                          IMBKPO-DPRTR-TMST (20:1)                35280099
331800                 MOVE ZEROES                        TO            35290099
331900                          IMBKPO-DPRTR-TMST (21:6)                35300099
332000                                                                  35310099
332100*                IF PS-POE-LBD-NO                                 35320099
332200                     MOVE TR024-EDD-POE-DELY-DTE (1:4)  TO        35330099
332300                           IMBKPO-POE-DELY-TMST (1:4)             35340099
332400                     MOVE PC-DASH                       TO        35350099
332500                           IMBKPO-POE-DELY-TMST (5:1)             35360099
332600                     MOVE TR024-EDD-POE-DELY-DTE (5:2)  TO        35370099
332700                           IMBKPO-POE-DELY-TMST (6:2)             35380099
332800                     MOVE PC-DASH                       TO        35390099
332900                           IMBKPO-POE-DELY-TMST (8:1)             35400099
333000                     MOVE TR024-EDD-POE-DELY-DTE (7:2)  TO        35410099
333100                           IMBKPO-POE-DELY-TMST (9:2)             35420099
333200                     MOVE PC-DASH                       TO        35430099
333300                           IMBKPO-POE-DELY-TMST (11:1)            35440099
333400                     MOVE TR024-EDD-POE-DELY-TM (1:2)   TO        35450099
333500                           IMBKPO-POE-DELY-TMST (12:2)            35460099
333600                     MOVE PC-DECIMAL                    TO        35470099
333700                           IMBKPO-POE-DELY-TMST (14:1)            35480099
333800                     MOVE TR024-EDD-POE-DELY-TM (3:2)   TO        35490099
333900                           IMBKPO-POE-DELY-TMST (15:2)            35500099
334000                     MOVE PC-DECIMAL                    TO        35510099
334100                           IMBKPO-POE-DELY-TMST (17:1)            35520099
334200                     MOVE ZEROES                        TO        35530099
334300                           IMBKPO-POE-DELY-TMST (18:2)            35540099
334400                     MOVE PC-DECIMAL                    TO        35550099
334500                           IMBKPO-POE-DELY-TMST (20:1)            35560099
334600                     MOVE ZEROES                        TO        35570099
334700                           IMBKPO-POE-DELY-TMST (21:6)            35580099
334800                     MOVE TR024-EDD-DEST-POE-CDE        TO        35590099
334900                           IMBKPO-DEST-POE-CDE                    35600099
335000                     MOVE TR024-EDD-EST-LBD-NM          TO        35610099
335100                           IMBKPO-EST-LBD-NM                      35620099
335200*                END-IF                                           35630099
335300                                                                  35640099
335400                 MOVE TR024-EDD-CARR-SCAC-ID        TO            35650099
335500                          IMBKPO-CARR-SCAC-ID                     35660099
335600                 MOVE TR024-EDD-FOB-CDE             TO            35670099
335700                          IMBKPO-FOB-CDE                          35680099
335800                 MOVE TR024-EDD-IMPRT-VEH-NM        TO            35690099
335900                          IMBKPO-IMPRT-VEH-NM                     35700099
336000                 MOVE TR024-EDD-TRIP-TYP-CDE        TO            35710099
336100                          IMBKPO-TRIP-TYP-CDE                     35720099
336200                                                                  35730099
336300             WHEN PC-EDDRSN                                       35740099
336400                 MOVE TR024-EDDRSN-VOY-CHG-RSN-DESC TO            35750099
336500                          IMBKPO-VOY-CHG-RSN-DESC                 35760099
336600                 MOVE TR024-EDDRSN-DPRTR-DTE (1:4)  TO            35770099
336700                          IMBKPO-DPRTR-TMST (1:4)                 35780099
336800                 MOVE PC-DASH                       TO            35790099
336900                          IMBKPO-DPRTR-TMST (5:1)                 35800099
337000                 MOVE TR024-EDDRSN-DPRTR-DTE (5:2)  TO            35810099
337100                          IMBKPO-DPRTR-TMST (6:2)                 35820099
337200                 MOVE PC-DASH                       TO            35830099
337300                          IMBKPO-DPRTR-TMST (8:1)                 35840099
337400                 MOVE TR024-EDDRSN-DPRTR-DTE (7:2)  TO            35850099
337500                          IMBKPO-DPRTR-TMST (9:2)                 35860099
337600                 MOVE PC-DASH                       TO            35870099
337700                          IMBKPO-DPRTR-TMST (11:1)                35880099
337800                 MOVE TR024-EDDRSN-DPRTR-TM (1:2)   TO            35890099
337900                          IMBKPO-DPRTR-TMST (12:2)                35900099
338000                 MOVE PC-DECIMAL                    TO            35910099
338100                          IMBKPO-DPRTR-TMST (14:1)                35920099
338200                 MOVE TR024-EDDRSN-DPRTR-TM (3:2)   TO            35930099
338300                          IMBKPO-DPRTR-TMST (15:2)                35940099
338400                 MOVE PC-DECIMAL                    TO            35950099
338500                          IMBKPO-DPRTR-TMST (17:1)                35960099
338600                 MOVE ZEROES                        TO            35970099
338700                          IMBKPO-DPRTR-TMST (18:2)                35980099
338800                 MOVE PC-DECIMAL                    TO            35990099
338900                          IMBKPO-DPRTR-TMST (20:1)                36000099
339000                 MOVE ZEROES                        TO            36010099
339100                          IMBKPO-DPRTR-TMST (21:6)                36020099
339200*                IF PS-POE-LBD-NO                                 36030099
339300                     MOVE TR024-EDDRSN-POE-DELY-DTE (1:4) TO      36040099
339400                           IMBKPO-POE-DELY-TMST (1:4)             36050099
339500                     MOVE PC-DASH                       TO        36060099
339600                           IMBKPO-POE-DELY-TMST (5:1)             36070099
339700                     MOVE TR024-EDDRSN-POE-DELY-DTE (5:2) TO      36080099
339800                           IMBKPO-POE-DELY-TMST (6:2)             36090099
339900                     MOVE PC-DASH                       TO        36100099
340000                           IMBKPO-POE-DELY-TMST (8:1)             36110099
340100                     MOVE TR024-EDDRSN-POE-DELY-DTE (7:2) TO      36120099
340200                           IMBKPO-POE-DELY-TMST (9:2)             36130099
340300                     MOVE PC-DASH                       TO        36140099
340400                           IMBKPO-POE-DELY-TMST (11:1)            36150099
340500                     MOVE TR024-EDDRSN-POE-DELY-TM (1:2) TO       36160099
340600                           IMBKPO-POE-DELY-TMST (12:2)            36170099
340700                     MOVE PC-DECIMAL                    TO        36180099
340800                           IMBKPO-POE-DELY-TMST (14:1)            36190099
340900                     MOVE TR024-EDDRSN-POE-DELY-TM (3:2) TO       36200099
341000                           IMBKPO-POE-DELY-TMST (15:2)            36210099
341100                     MOVE PC-DECIMAL                    TO        36220099
341200                           IMBKPO-POE-DELY-TMST (17:1)            36230099
341300                     MOVE ZEROES                        TO        36240099
341400                           IMBKPO-POE-DELY-TMST (18:2)            36250099
341500                     MOVE PC-DECIMAL                    TO        36260099
341600                           IMBKPO-POE-DELY-TMST (20:1)            36270099
341700                     MOVE ZEROES                        TO        36280099
341800                           IMBKPO-POE-DELY-TMST (21:6)            36290099
341900*                END-IF                                           36300099
342000                                                                  36310099
342100             WHEN PC-EDL                                          36320099
342200                 MOVE TR024-EDL-CONSOL-SCAC-ID      TO            36330099
342300                          IMBKPO-CONSLR-SCAC-ID                   36340099
342400                 MOVE TR024-EDL-ORGN-SHPD-FR-CDE    TO            36350099
342500                          IMBKPO-ORGN-SHPD-FR-CDE                 36360099
342600                 MOVE TR024-EDL-C-O-PROD-CDE        TO            36370099
342700                          IMBKPO-C-O-PROD-CDE                     36380099
342800                 MOVE TR024-EDL-PROD-FCTRY-NM       TO            36390099
342900                          IMBKPO-PROD-FCTRY-NM                    36400099
343000                 MOVE TR024-EDL-PO-CART-CNT         TO            36410099
343100                          IMBKPO-PO-CART-CNT                      36420099
343200                 MOVE TR024-EDL-PO-CBMT-QTY         TO            36430099
343300                          IMBKPO-PO-CBMT-QTY                      36440099
343400                 MOVE TR024-EDL-PO-WT-KGRM-QTY      TO            36450099
343500                          IMBKPO-PO-WT-KGRM-QTY                   36460099
343600                 MOVE TR024-EDL-PO-UNT-QTY          TO            36470099
343700                          IMBKPO-PO-UNT-QTY                       36480099
343800         END-EVALUATE.                                            36490099
343900                                                                  36500099
344000 EJECT                                                            36510099
344100                                                                  36520099
344200***************************************************************** 36530099
344300* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  * 36540099
344400* THAT ARE ON THE VS TABLE, AND THE PO-BKG-SEQ-NBR WHICH COMES  * 36550099
344500* FROM THE PO TABLE.                                            * 36560099
344600***************************************************************** 36570099
344700*6460-MOVES-INSERT-TIMBKVS.                                       36580099
344800                                                                  36590099
344900*    MOVE TR024-EDD-PO-NBR               TO IMBKVS-PO-NBR.        36600099
345000                                                                  36610099
345100*    IF PS-CHANGE-ADD-VS-OR-UPC OR                                36620099
345200*       PS-CHANGE-C-VS                                            36630099
345300*        MOVE IMBKPO-PO-BKG-SEQ-NBR  TO IMBKVS-PO-BKG-SEQ-NBR     36640099
345400*    ELSE                                                         36650099
345500*        MOVE PV-BKG-SEQ-NBR-MAX     TO IMBKVS-PO-BKG-SEQ-NBR     36660099
345600*    END-IF.                                                      36670099
345700                                                                  36680099
345800*    MOVE TR024-EDLVS-VS-NBR         TO IMBKVS-VS-NBR.            36690099
345900*    MOVE SPACES                     TO IMBKVS-HTS-ID.            36700099
346000*    MOVE TR024-EDLVS-VS-CART-CNT    TO IMBKVS-VS-CART-CNT.       36710099
346100*    MOVE TR024-EDLVS-VS-CBMT-QTY    TO IMBKVS-VS-CBMT-QTY.       36720099
346200*    MOVE TR024-EDLVS-VS-WT-KGRM-QTY TO IMBKVS-VS-WT-KGRM-QTY.    36730099
346300*    MOVE TR024-EDLVS-VS-UNT-QTY     TO IMBKVS-VS-UNT-QTY.        36740099
346400                                                                  36750099
346500*    MOVE SPACE                      TO IMBKVS-QTA-CTG-IND.       36760099
346600*    MOVE PC-CURRENT-PROGRAM-NAME    TO IMBKVS-CRE-BY-USR-ID.     36770099
346700*    PERFORM 7999-SET-CURRENT-TMST.                               36780099
346800                                                                  36790099
346900*    IF PS-CHANGE-C-VS                                            36800099
347000*       CONTINUE                                                  36810099
347100*    ELSE                                                         36820099
347200*       MOVE PV-CURRENT-TMST         TO IMBKVS-CRE-TMST           36830099
347300*    END-IF.                                                      36840099
347400*                                                                 36850099
347500*    MOVE PC-CURRENT-PROGRAM-NAME    TO                           36860099
347600*                            IMBKVS-LAST-UPD-BY-USR-ID.           36870099
347700*    MOVE PV-CURRENT-TMST            TO IMBKVS-LAST-UPD-TMST.     36880099
347800                                                                  36890099
347900 EJECT                                                            36900099
348000                                                                  36910099
348100***************************************************************** 36920099
348200* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  * 36930099
348300* THAT ARE ON THE UPC TABLE, AND THE PO-BKG-SEQ-NBR WHICH COMES * 36940099
348400* FROM THE PO TABLE.                                            * 36950099
348500***************************************************************** 36960099
348600*6470-MOVES-INSERT-TIMBKUP.                                       36970099
348700                                                                  36980099
348800*    MOVE TR024-EDLUPC-PO-NBR        TO IMBKUP-PO-NBR.            36990099
348900                                                                  37000099
349000*    IF PS-CHANGE-ADD-VS-OR-UPC   OR                              37010099
349100*       PS-CHANGE-C-UPC                                           37020099
349200*        MOVE IMBKPO-PO-BKG-SEQ-NBR  TO IMBKUP-PO-BKG-SEQ-NBR     37030099
349300*    ELSE                                                         37040099
349400*        MOVE PV-BKG-SEQ-NBR-MAX     TO IMBKUP-PO-BKG-SEQ-NBR     37050099
349500*    END-IF.                                                      37060099
349600                                                                  37070099
349700*    MOVE TR024-EDLUPC-VS-NBR        TO IMBKUP-VS-NBR.            37080099
349800*    MOVE TR024-EDLUPC-UPC-NBR       TO IMBKUP-UPC-NBR.           37090099
349900*    MOVE TR024-EDLUPC-UPC-CART-CNT  TO IMBKUP-UPC-CART-CNT.      37100099
350000*    MOVE TR024-EDLUPC-UPC-CBMT-QTY  TO IMBKUP-UPC-CBMT-QTY.      37110099
350100*    MOVE TR024-EDLUPC-UPC-WT-KGRM-QTY TO IMBKUP-UPC-WT-KGRM-QTY. 37120099
350200*    MOVE TR024-EDLUPC-UPC-UNT-QTY   TO IMBKUP-UPC-UNT-QTY.       37130099
350300*    MOVE PC-CURRENT-PROGRAM-NAME    TO IMBKUP-CRE-BY-USR-ID.     37140099
350400*    PERFORM 7999-SET-CURRENT-TMST.                               37150099
350500                                                                  37160099
350600*    IF PS-CHANGE-C-UPC                                           37170099
350700*       CONTINUE                                                  37180099
350800*    ELSE                                                         37190099
350900*       MOVE PV-CURRENT-TMST         TO IMBKUP-CRE-TMST           37200099
351000*    END-IF.                                                      37210099
351100                                                                  37220099
351200*    MOVE PC-CURRENT-PROGRAM-NAME    TO                           37230099
351300*                            IMBKUP-LAST-UPD-BY-USR-ID.           37240099
351400*    MOVE PV-CURRENT-TMST            TO IMBKUP-LAST-UPD-TMST.     37250099
351500*                                                                 37260099
351600 EJECT                                                            37270099
351700                                                                  37280099
351800***************************************************************** 37290099
351900*  MAKE SELECTION BASED ON PO, EXTERNAL REF, AND ORIGIN           37300099
352000*     IF FOUND AND DATES MATCH, DO NOTHING                        37310099
352100*     IF FOUND AND DATES DO NOT MATCH, SEND SCM A 'CHANGE' MESSAGE37320099
352200*     IF NOT FOUND                                                37330099
352300*          MAKE SELECTION BASED ON PO, EXTERNAL REF, AND DATE     37340099
352400*            IF FOUND AND ORIGINS DO NOT MATCH, SEND SCM AN       37350099
352500*                ADD MESSAGE (MATCHING ORIGINS DEALT WITH IN      37360099
352600*                             FIRST SELECTION)                    37370099
352700*            IF NOT FOUND, SEND SCM AND ADD MESSAGE               37380099
352800***************************************************************** 37390099
352900 6600-SCM-NAIL-DOWN-CHANGE.                                       37400099
353000     MOVE TR024-EDL-PO-NBR           TO W-IMBKPO-PO-NBR.          37410099
353100     MOVE TR024-EDL-PO-BKG-DELY-DTE  TO PV-WORK-DATE.             37420099
353200     MOVE '-'                        TO PV-WORK-DASH1             37430099
353300                                        PV-WORK-DASH2.            37440099
353400     INITIALIZE TR405-MESSAGE-LAYOUT                              37450099
353500     PERFORM 7003-SCM-FETCH-ON-ORGN-TIMBKPO                       37460099
353600                                                                  37470099
353700     IF PS-BKPO-7003-ROW-FOUND                                    37480099
353800         IF W-IMBKPO-PO-BKG-DELY-DTE                              37490099
353900                 = PV-WORK-DATE-R                                 37500099
354000             NEXT SENTENCE                                        37510099
354100         ELSE                                                     37520099
354200             INITIALIZE TR405-MESSAGE-LAYOUT                      37530099
354300             MOVE 'C'                 TO TR405-ACTN-CDE           37540099
354400             PERFORM 6900-SCM-PO-BKG-ADD-CHG                      37550099
354500         END-IF                                                   37560099
354600     ELSE                                                         37570099
354700         MOVE TR024-EDL-PO-NBR TO W-IMBKPO-PO-NBR                 37580099
354800         PERFORM 7006-SCM-FETCH-ON-DATE-TIMBKPO                   37590099
354900         IF PS-BKPO-7006-ROW-FOUND                                37600099
355000             IF W-IMBKPO-ORGN-SHPD-FR-CDE                         37610099
355100                     = TR024-EDL-ORGN-SHPD-FR-CDE                 37620099
355200                 NEXT SENTENCE                                    37630099
355300             ELSE                                                 37640099
355400                 INITIALIZE TR405-MESSAGE-LAYOUT                  37650099
355500                 MOVE 'A'             TO TR405-ACTN-CDE           37660099
355600                 PERFORM 6900-SCM-PO-BKG-ADD-CHG                  37670099
355700             END-IF                                               37680099
355800         ELSE                                                     37690099
355900           INITIALIZE TR405-MESSAGE-LAYOUT                        37700099
356000           MOVE 'A'                   TO TR405-ACTN-CDE           37710099
356100           PERFORM 6900-SCM-PO-BKG-ADD-CHG                        37720099
356200         END-IF                                                   37730099
356300     END-IF.                                                      37740099
356400 EJECT                                                            37750099
356500***************************************************************** 37760099
356600* INSERT BOOKING PO MESSAGE TO DB2 WORKTABLE TRTW-BKG-CKPR FOR    37770099
356700* AN ADD OF PO BOOKING DATE EVENT. THIS MESSAGE WILL EVENTUALLY   37780099
356800* BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES.                37790099
356900***************************************************************** 37800099
357000 6700-SCM-PO-BOOKING-ADD.                                         37810099
357100     IF IMBKPO-PO-BKG-DELY-TMST (1:4) > '0001'                    37820099
357200         INITIALIZE TR405-MESSAGE-LAYOUT                          37830099
357300         MOVE 'A'                      TO TR405-ACTN-CDE          37840099
357400         MOVE 'BOOKED'                 TO TR405-EVENT-TYP         37850099
357500         MOVE IMBKPO-PO-NBR            TO TR405-PO-NBR            37860099
357600         MOVE IMBKPO-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR      37870099
357700         MOVE TR024-EDL-PO-BKG-DELY-DTE                           37880099
357800                                   TO TR405-EVENT-DTE             37890099
357900         MOVE TR024-EDL-ORGN-SHPD-FR-CDE                          37900099
358000                                   TO TR405-ORGN-SHPD-FR-CDE      37910099
358100         MOVE TR405-MESSAGE-LAYOUT TO                             37920099
358200                                   TRT00038-CKPR-REC-1-TXT        37930099
358300         PERFORM 7700-INSERT-SCM-MESSAGE                          37940099
358400     END-IF.                                                      37950099
358500 EJECT                                                            37960099
358600***************************************************************** 37970099
358700* INSERT A BOOKING PO MESSAGE TO WORKTABLE TRTW_BKG_CKPR          37980099
358800* WHEN THE DEL EVENT OCCURS. THIS MESSAGE WILL EVENTUALLY         37990099
358900* BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES.                38000099
359000***************************************************************** 38010099
359100 6800-SCM-PO-BKG-DEL.                                             38020099
359200     INITIALIZE TR405-MESSAGE-LAYOUT                              38030099
359300     MOVE 'D'                          TO TR405-ACTN-CDE          38040099
359400     MOVE 'BOOKED'                     TO TR405-EVENT-TYP         38050099
359500     MOVE TR024-EDL-PO-NBR             TO TR405-PO-NBR            38060099
359600     MOVE TR024-EDL-EXTL-REF-NBR       TO TR405-EXTL-REF-NBR      38070099
359700     MOVE TR024-EDL-ORGN-SHPD-FR-CDE                              38080099
359800                               TO TR405-ORGN-SHPD-FR-CDE          38090099
359900     MOVE TR405-MESSAGE-LAYOUT TO TRT00038-CKPR-REC-1-TXT         38100099
360000     PERFORM 7700-INSERT-SCM-MESSAGE.                             38110099
360100                                                                  38120099
360200 EJECT                                                            38130099
360300***************************************************************** 38140099
360400* INSERT A BOOKING PO MESSAGE TO WORKTABLE TRTW_BKG_CKPR          38150099
360500* WHEN AN ADD OR CHANGE EVENT OCCURS. THIS MESSAGE WILL EVENTUALLY38160099
360600* BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES.                38170099
360700***************************************************************** 38180099
360800 6900-SCM-PO-BKG-ADD-CHG.                                         38190099
360900     MOVE 'BOOKED'                 TO TR405-EVENT-TYP             38200099
361000     MOVE TR024-EDL-PO-NBR         TO TR405-PO-NBR                38210099
361100     MOVE TR024-EDL-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR          38220099
361200     MOVE TR024-EDL-PO-BKG-DELY-DTE                               38230099
361300                                   TO TR405-EVENT-DTE             38240099
361400     MOVE TR024-EDL-ORGN-SHPD-FR-CDE                              38250099
361500                                   TO TR405-ORGN-SHPD-FR-CDE      38260099
361600     MOVE TR405-MESSAGE-LAYOUT TO TRT00038-CKPR-REC-1-TXT         38270099
361700     PERFORM 7700-INSERT-SCM-MESSAGE.                             38280099
361800                                                                  38290099
361801 EJECT                                                            38300099
361802******************************************************************38310099
361803* SELECT A ROW FROM THE IMPORT BOOKING PURCHASE ORDER TABLE       38320099
361804* (TIMBKPO).                                                      38330099
361805******************************************************************38340099
361806 7000-SELECT-TIMBKPO.                                             38350099
361807                                                                  38360099
361808     PERFORM                                                      38370099
361809         WITH TEST AFTER                                          38380099
361810         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     38390099
361811         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            38400099
361812                 SQLCODE = ZERO                     OR            38410099
361813                 SQLCODE = +100                                   38420099
361814                                                                  38430099
361815                                                                  38440099
361816         EXEC SQL                                                 38450099
361817             SELECT PO_NBR,                                       38460099
361818                    PO_BKG_SEQ_NBR,                               38470099
361819                    PO_BKG_DELY_TMST,                             38480099
361820                    EXTL_REF_NBR,                                 38490099
361821                    CONSLR_SCAC_ID,                               38500099
361822                    IMPRT_TRIP_ID,                                38510099
361823                    DPRTR_TMST,                                   38520099
361824                    POE_DELY_TMST,                                38530099
361825                    CARR_SCAC_ID,                                 38540099
361826                    FOB_CDE,                                      38550099
361827                    IMPRT_VEH_NM,                                 38560099
361828                    TRIP_TYP_CDE,                                 38570099
361829                    DEST_POE_CDE,                                 38580099
361830                    EST_LBD_NM,                                   38590099
361831                    ORGN_SHPD_FR_CDE,                             38600099
361832                    C_O_PROD_CDE,                                 38610099
361833                    PROD_FCTRY_NM,                                38620099
361834                    PO_CART_CNT,                                  38630099
361835                    PO_CBMT_QTY,                                  38640099
361836                    PO_WT_KGRM_QTY,                               38650099
361837                    PO_UNT_QTY,                                   38660099
361838                    PO_EXC_APVL_CDE,                              38670099
361839                    PO_EXC_APVL_USR_ID,                           38680099
361840                    PO_EXC_APVL_TMST,                             38690099
361841                    PO_EXC_RSN_DESC,                              38700099
361842                    EST_LBD_TMST,                                 38710099
361843                    SHIPT_BKG_TMST,                               38720099
361844                    VOY_CHG_RSN_DESC,                             38730099
361845                    DAT_SRC_ENT_ID,                               38740099
361846                    CRE_BY_USR_ID,                                38750099
361847                    CRE_TMST,                                     38760099
361848                    LAST_UPD_BY_USR_ID,                           38770099
361849                    LAST_UPD_TMST                                 38780099
361850              INTO :IMBKPO-PO-NBR,                                38790099
361851                   :IMBKPO-PO-BKG-SEQ-NBR,                        38800099
361852                   :IMBKPO-PO-BKG-DELY-TMST,                      38810099
361853                   :IMBKPO-EXTL-REF-NBR,                          38820099
361854                   :IMBKPO-CONSLR-SCAC-ID,                        38830099
361855                   :IMBKPO-IMPRT-TRIP-ID,                         38840099
361856                   :IMBKPO-DPRTR-TMST,                            38850099
361857                   :IMBKPO-POE-DELY-TMST,                         38860099
361858                   :IMBKPO-CARR-SCAC-ID,                          38870099
361859                   :IMBKPO-FOB-CDE,                               38880099
361860                   :IMBKPO-IMPRT-VEH-NM,                          38890099
361861                   :IMBKPO-TRIP-TYP-CDE,                          38900099
361862                   :IMBKPO-DEST-POE-CDE,                          38910099
361863                   :IMBKPO-EST-LBD-NM,                            38920099
361864                   :IMBKPO-ORGN-SHPD-FR-CDE,                      38930099
361865                   :IMBKPO-C-O-PROD-CDE,                          38940099
361866                   :IMBKPO-PROD-FCTRY-NM,                         38950099
361867                   :IMBKPO-PO-CART-CNT,                           38960099
361868                   :IMBKPO-PO-CBMT-QTY,                           38970099
361869                   :IMBKPO-PO-WT-KGRM-QTY,                        38980099
361870                   :IMBKPO-PO-UNT-QTY,                            38990099
361871                   :IMBKPO-PO-EXC-APVL-CDE,                       39000099
361872                   :IMBKPO-PO-EXC-APVL-USR-ID,                    39010099
361873                   :IMBKPO-PO-EXC-APVL-TMST,                      39020099
361874                   :IMBKPO-PO-EXC-RSN-DESC,                       39030099
361875                   :IMBKPO-EST-LBD-TMST,                          39040099
361876                   :IMBKPO-SHIPT-BKG-TMST,                        39050099
361877                   :IMBKPO-VOY-CHG-RSN-DESC,                      39060099
361878                   :IMBKPO-DAT-SRC-ENT-ID,                        39070099
361879                   :IMBKPO-CRE-BY-USR-ID,                         39080099
361880                   :IMBKPO-CRE-TMST,                              39090099
361881                   :IMBKPO-LAST-UPD-BY-USR-ID,                    39100099
361882                   :IMBKPO-LAST-UPD-TMST                          39110099
361883                                                                  39120099
361884               FROM TIMBKPO                                       39130099
361885              WHERE PO_NBR           = :IMBKPO-PO-NBR             39140099
361886                AND DATE(PO_BKG_DELY_TMST) =                      39150099
361887                                    :PV-REFORMAT-10BYTE-FIELD     39160099
361888                AND EXTL_REF_NBR     = :TR024-EDD-EXTL-REF-NBR    39170099
361889                AND ORGN_SHPD_FR_CDE = :TR024-EDD-ORGN-SHPD-FR-CDE39180099
361890         END-EXEC                                                 39190099
361891                                                                  39200099
361892         EVALUATE TRUE                                            39210099
361893             WHEN SQLCODE = ZERO                                  39220099
361894                 SET PS-TIMBKPO-ROW-IS-THERE TO TRUE              39230099
361895                                                                  39240099
361896             WHEN SQLCODE = +100                                  39250099
361897                 SET PS-TIMBKPO-ROW-IS-THERE-NO TO TRUE           39260099
361898                                                                  39270099
361899             WHEN SQLWARN0 NOT EQUAL SPACE                        39280099
361900             WHEN SQLCODE NOT EQUAL ZERO                          39290099
361901                 DISPLAY '**************************************' 39300099
361902                 DISPLAY '** ABEND                            **' 39310099
361903                 DISPLAY '** PROGRAM = TRKUP205               **' 39320099
362000                 DISPLAY '** PARAGRAPH = 7000-SELECT-TIMBKPO  **' 39330099
362100                 DISPLAY '** SELECT TIMBKPO                   **' 39340099
362200                 DISPLAY '** PO NUMBER    = '                     39350099
362300                 DISPLAY            TR024-EDD-PO-NBR              39360099
362400                 DISPLAY '** HOLD PO NBR  = '                     39370099
362500                 DISPLAY            PV-HOLD-TR024-PO-NBR          39380099
362600                 DISPLAY '** EXTL REF NBR = '                     39390099
362700                 DISPLAY            TR024-EDD-EXTL-REF-NBR        39400099
362800                 DISPLAY '** PO BKG DELY DTE = '                  39410099
362900                 DISPLAY            TR024-EDD-PO-BKG-DELY-DTE     39420099
363000                 DISPLAY '** PO BKG DELY TM = '                   39430099
363100                 DISPLAY            TR024-EDD-PO-BKG-DELY-TM      39440099
363200                 DISPLAY '** ORGN SHPD FR CDE = '                 39450099
363300                 DISPLAY            TR024-EDD-ORGN-SHPD-FR-CDE    39460099
363400                 DISPLAY '**************************************' 39470099
363500                 PERFORM 9100-SQL-ABEND                           39480099
363600         END-EVALUATE                                             39490099
363700     END-PERFORM.                                                 39500099
363800                                                                  39510099
363900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39520099
364000         (SQLCODE NOT = ZERO AND                                  39530099
364100             SQLCODE NOT = +100)                                  39540099
364200         DISPLAY '****************************************'       39550099
364300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       39560099
364400         DISPLAY '** SELECT FROM TIMBKPO                **'       39570099
364500         DISPLAY '** PARAGRAPH = 7000-SELECT-TIMBKPO    **'       39580099
364600         DISPLAY '** PO NUMBER    = ' TR024-EDD-PO-NBR            39590099
364700         DISPLAY '** HOLD PO NBR  = ' PV-HOLD-TR024-PO-NBR        39600099
364800         DISPLAY '** EXTL REF NBR = ' TR024-EDD-EXTL-REF-NBR      39610099
364900         DISPLAY '** HOLD EXTL REF NBR ='                         39620099
365000                                 PV-HOLD-TR024-EXTL-REF-NBR       39630099
365100         DISPLAY '** PO BKG DELY DTE   ='                         39640099
365200                                 TR024-EDD-PO-BKG-DELY-DTE        39650099
365300         DISPLAY '** HOLD PO BKG DELY DTE ='                      39660099
365400                                 PV-HOLD-ORGN-SHPD-FR-CDE         39670099
365500         DISPLAY '** ORGN SHPD FR CDE = '                         39680099
365600                                 TR024-EDD-ORGN-SHPD-FR-CDE       39690099
365700         DISPLAY '** HOLD ORGN SHPD FROM CDE = '                  39700099
365800                          PV-HOLD-ORGN-SHPD-FR-CDE                39710099
365900         DISPLAY '****************************************'       39720099
366000         PERFORM 9100-SQL-ABEND                                   39730099
366100     END-IF.                                                      39740099
366200                                                                  39750099
366300 EJECT                                                            39760099
366400                                                                  39770099
366500*---------------------------------------------------------------* 39780099
366600*   SELECT BOOKING PO NUMBERS USING ONLY THE PO NUMBER,           39790099
366700*   EXTERNAL REFERENCE AND THE ORGN_SHPD_FR_CDE TO GET THE        39800099
366800*   PO_BKG_DELY_TMST.                                             39810099
366900*---------------------------------------------------------------* 39820099
367000 7003-SCM-FETCH-ON-ORGN-TIMBKPO.                                  39830099
367100     SET PS-BKPO-7003-ROW-FOUND-UNSURE  TO TRUE                   39840099
367200     PERFORM 7850-SCM-OPEN-ORGN-CURSOR.                           39850099
367300                                                                  39860099
367400                                                                  39870099
367500                                                                  39880099
367600** GET THE FIRST ROW ONLY.  (THE HIGHEST SEQUENCE NUMBER)         39890099
367700                                                                  39900099
367800     EXEC SQL                                                     39910099
367900        FETCH ORGN_CUR                                            39920099
368000         INTO :W-IMBKPO-PO-NBR                                    39930099
368100             ,:W-IMBKPO-PO-BKG-SEQ-NBR                            39940099
368200             ,:W-IMBKPO-EXTL-REF-NBR                              39950099
368300             ,:W-IMBKPO-PO-BKG-DELY-TMST                          39960099
368400             ,:W-IMBKPO-ORGN-SHPD-FR-CDE                          39970099
368500     END-EXEC.                                                    39980099
368600                                                                  39990099
368700     EVALUATE TRUE                                                40000099
368800         WHEN SQLCODE = ZERO                                      40010099
368900             SET PS-BKPO-7003-ROW-FOUND  TO TRUE                  40020099
369000                                                                  40030099
369100         WHEN SQLCODE = +100                                      40040099
369200             SET PS-BKPO-7003-ROW-NOT-FOUND TO TRUE               40050099
369300                                                                  40060099
369400         WHEN SQLWARN0 NOT EQUAL SPACE                            40070099
369500         WHEN SQLCODE NOT EQUAL ZERO                              40080099
369600             DISPLAY '***************************************'    40090099
369700             DISPLAY '** ABEND                             **'    40100099
369800             DISPLAY '** PROGRAM = TRKUP205                **'    40110099
369900             DISPLAY '** PARAGRAPH = 7003-SCM-FETCH-ORGN-'        40120099
370000                     'TIMBKPO  **'                                40130099
370100             DISPLAY '** SELECT TIMBKPO                    **'    40140099
370200             DISPLAY '** PO NUMBER    = '                         40150099
370300             DISPLAY            TR024-EDL-PO-NBR                  40160099
370400             DISPLAY '** HOLD PO NBR  = '                         40170099
370500             DISPLAY            PV-HOLD-TR024-PO-NBR              40180099
370600             DISPLAY '** EXTL REF NBR = '                         40190099
370700             DISPLAY            TR024-EDL-EXTL-REF-NBR            40200099
370800             DISPLAY '** PO BKG DELY DTE = '                      40210099
370900             DISPLAY            TR024-EDL-PO-BKG-DELY-DTE         40220099
371000             DISPLAY '** PO BKG DELY TM = '                       40230099
371100             DISPLAY            TR024-EDL-PO-BKG-DELY-TM          40240099
371200             DISPLAY '** ORGN SHPD FR CDE = '                     40250099
371300             DISPLAY            TR024-EDL-ORGN-SHPD-FR-CDE        40260099
371400             DISPLAY '**************************************'     40270099
371500             PERFORM 9100-SQL-ABEND                               40280099
371600     END-EVALUATE.                                                40290099
371700                                                                  40300099
371800     PERFORM 7860-SCM-CLOS-ORGN-CURSOR.                           40310099
371900 EJECT                                                            40320099
372000                                                                  40330099
372100*---------------------------------------------------------------* 40340099
372200*   SELECT BOOKING PO NUMBERS USING ONLY THE PO NUMBER,           40350099
372300*   EXTERNAL REFERENCE AND THE PO_BKG_DELY-TMST TO GET THE        40360099
372400*   ORGN_SHPD_FR_CDE.                                             40370099
372500*---------------------------------------------------------------* 40380099
372600 7006-SCM-FETCH-ON-DATE-TIMBKPO.                                  40390099
372700     SET PS-BKPO-7006-ROW-FOUND-UNSURE  TO TRUE                   40400099
372800     PERFORM 7800-SCM-OPEN-TMST-CURSOR.                           40410099
372900                                                                  40420099
373000** GET THE FIRST ROW ONLY.  (THE HIGHEST SEQUENCE NUMBER)         40430099
373100     EXEC SQL                                                     40440099
373200        FETCH TMST_CUR                                            40450099
373300         INTO :W-IMBKPO-PO-NBR                                    40460099
373400             ,:W-IMBKPO-PO-BKG-SEQ-NBR                            40470099
373500             ,:W-IMBKPO-EXTL-REF-NBR                              40480099
373600             ,:W-IMBKPO-PO-BKG-DELY-TMST                          40490099
373700             ,:W-IMBKPO-ORGN-SHPD-FR-CDE                          40500099
373800     END-EXEC.                                                    40510099
373900                                                                  40520099
374000     EVALUATE TRUE                                                40530099
374100         WHEN SQLCODE = ZERO                                      40540099
374200             SET PS-BKPO-7006-ROW-FOUND  TO TRUE                  40550099
374300                                                                  40560099
374400         WHEN SQLCODE = +100                                      40570099
374500             SET PS-BKPO-7006-ROW-NOT-FOUND  TO TRUE              40580099
374600                                                                  40590099
374700         WHEN SQLWARN0 NOT EQUAL SPACE                            40600099
374800         WHEN SQLCODE NOT EQUAL ZERO                              40610099
374900             DISPLAY '***************************************'    40620099
375000             DISPLAY '** ABEND                             **'    40630099
375100             DISPLAY '** PROGRAM = TRKUP205                **'    40640099
375200             DISPLAY '** PARAGRAPH = 7006-SCM-FETCH-DATE-'        40650099
375300                     'TIMBKPO  **'                                40660099
375400             DISPLAY '** SELECT TIMBKPO                    **'    40670099
375500             DISPLAY '** PO NUMBER    = '                         40680099
375600             DISPLAY            TR024-EDL-PO-NBR                  40690099
375700             DISPLAY '** HOLD PO NBR  = '                         40700099
375800             DISPLAY            PV-HOLD-TR024-PO-NBR              40710099
375900             DISPLAY '** EXTL REF NBR = '                         40720099
376000             DISPLAY            TR024-EDL-EXTL-REF-NBR            40730099
376100             DISPLAY '** PO BKG DELY DTE = '                      40740099
376200             DISPLAY            TR024-EDL-PO-BKG-DELY-DTE         40750099
376300             DISPLAY '** PO BKG DELY TM = '                       40760099
376400             DISPLAY            TR024-EDL-PO-BKG-DELY-TM          40770099
376500             DISPLAY '** ORGN SHPD FR CDE = '                     40780099
376600             DISPLAY            TR024-EDL-ORGN-SHPD-FR-CDE        40790099
376700             DISPLAY '**************************************'     40800099
376800             PERFORM 9100-SQL-ABEND                               40810099
376900     END-EVALUATE.                                                40820099
377000                                                                  40830099
377100     PERFORM 7810-SCM-CLOS-TMST-CURSOR.                           40840099
377200                                                                  40850099
377201 EJECT                                                            40860099
377202******************************************************************40870099
377203* FIND THE MAX BKG-SEQ-NBR SO IT CAN BE INCREMENTED WITH ADD TRAN 40880099
377204******************************************************************40890099
377205 7010-SELECT-BKG-SEQ-NBR-MAX.                                     40900099
377206                                                                  40910099
377207     PERFORM                                                      40920099
377208         WITH TEST AFTER                                          40930099
377209         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     40940099
377210         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            40950099
377211                 SQLCODE = ZERO                     OR            40960099
377212                 SQLCODE = -305                     OR            40970099
377213                 SQLCODE = +100                                   40980099
377214                                                                  40990099
377215         EXEC SQL                                                 41000099
377216          SELECT                                                  41010099
377217               (CASE                                              41020099
377218                 WHEN MAX(COALESCE(B.PO_BKG_SEQ_NBR,0)) >         41030099
377219                      MAX(COALESCE(A.PO_BKG_SEQ_NBR,0))           41040099
377220                  THEN  MAX(COALESCE(B.PO_BKG_SEQ_NBR,0))         41050099
377221                 WHEN MAX(COALESCE(A.PO_BKG_SEQ_NBR,0)) >         41060099
377222                      MAX(COALESCE(B.PO_BKG_SEQ_NBR,0))           41070099
377223                  THEN  MAX(COALESCE(A.PO_BKG_SEQ_NBR,0))         41080099
377224                 WHEN MAX(COALESCE(A.PO_BKG_SEQ_NBR,0)) =         41090099
377225                      MAX(COALESCE(B.PO_BKG_SEQ_NBR,0))           41100099
377226                  THEN  MAX(COALESCE(A.PO_BKG_SEQ_NBR,0))         41110099
377227                END)                                              41120099
377228            INTO :PV-BKG-SEQ-NBR-MAX                              41130099
377229            FROM TIMBKPO B                                        41140099
377230            FULL OUTER JOIN TAUBKPO A                             41150099
377231              ON  A.PO_NBR         = B.PO_NBR                     41160099
377232            WHERE A.PO_NBR         = :IMBKPO-PO-NBR               41170099
377233               OR B.PO_NBR         = :IMBKPO-PO-NBR               41180099
377234         END-EXEC                                                 41190099
377235                                                                  41200099
377236         EVALUATE TRUE                                            41210099
377237             WHEN SQLCODE = ZERO                                  41220099
377238                 ADD +1 TO PV-BKG-SEQ-NBR-MAX                     41230099
377239                                                                  41240099
377240             WHEN SQLCODE  = +100                                 41250099
377241             WHEN SQLCODE  = -305                                 41260099
377242                 MOVE +1 TO PV-BKG-SEQ-NBR-MAX                    41270099
377243                                                                  41280099
377244             WHEN SQLWARN0 NOT EQUAL SPACE                        41290099
377245             WHEN SQLCODE NOT EQUAL ZERO                          41300099
377246                 DISPLAY '**************************************' 41310099
377247                 DISPLAY '** ABEND                            **' 41320099
377248                 DISPLAY '** PROGRAM = TRKUP205               **' 41330099
377249                 DISPLAY '** PARAGRAPH = 7010-SELECT-BKG-     **' 41340099
377250                 DISPLAY '**                  SEQ-NBR-MAX     **' 41350099
377251                 DISPLAY '** SELECT TIMBKPO                   **' 41360099
377252                 DISPLAY '** PO NBR    = ' IMBKPO-PO-NBR          41370099
377253                 DISPLAY '** EXTL REF NBR = '                     41380099
377254                 DISPLAY              IMBKPO-EXTL-REF-NBR         41390099
377255                 DISPLAY '**************************************' 41400099
377256                 PERFORM 9100-SQL-ABEND                           41410099
377257         END-EVALUATE                                             41420099
377258     END-PERFORM.                                                 41430099
377259                                                                  41440099
377260     IF  PV-RETRY-COUNTER < PC-MAX-RETRIES AND                    41450099
377261         (SQLCODE NOT = ZERO               OR                     41460099
377262             SQLCODE NOT = -305            OR                     41470099
377263             SQLCODE NOT = +100)                                  41480099
377264         CONTINUE                                                 41490099
377265     ELSE                                                         41500099
377266         DISPLAY '****************************************'       41510099
377267         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       41520099
377268         DISPLAY '** SELECT FROM TIMBKPO                **'       41530099
377269         DISPLAY '** PARAGRAPH = 7010-SELECT-BKG-SEQ-   **'       41540099
377270         DISPLAY '**                  NBR-MAX           **'       41550099
377271         DISPLAY '** PO NBR       = ' IMBKPO-PO-NBR               41560099
377272         DISPLAY '** EXTL REF NBR = ' IMBKPO-EXTL-REF-NBR         41570099
377273         DISPLAY '****************************************'       41580099
377274         PERFORM 9100-SQL-ABEND                                   41590099
377275     END-IF.                                                      41600099
377276                                                                  41610099
377277 EJECT                                                            41620099
377278                                                                  41630099
377279******************************************************************41640099
377280* INSERT A ROW TO THE BOOKINGS TABLE  (TIMBKPO).                 *41650099
377281******************************************************************41660099
377282 7020-INSERT-TIMBKPO.                                             41670099
377283                                                                  41680099
377284     PERFORM                                                      41690099
377285         WITH TEST AFTER                                          41700099
377286         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     41710099
377287         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            41720099
377288                 SQLCODE = ZERO                     OR            41730099
377289                 SQLCODE = -803                                   41740099
377290                                                                  41750099
377291         EXEC SQL                                                 41760099
377292             INSERT INTO TIMBKPO                                  41770099
377293                   (PO_NBR,                                       41780099
377294                    PO_BKG_SEQ_NBR,                               41790099
377295                    PO_BKG_DELY_TMST,                             41800099
377296                    EXTL_REF_NBR,                                 41810099
377297                    ORGN_SHPD_FR_CDE,                             41820099
377298                    CONSLR_SCAC_ID,                               41830099
377299                    IMPRT_TRIP_ID,                                41840099
377300                    DPRTR_TMST,                                   41850099
377301                    POE_DELY_TMST,                                41860099
377302                    CARR_SCAC_ID,                                 41870099
377303                    FOB_CDE,                                      41880099
377304                    IMPRT_VEH_NM,                                 41890099
377305                    TRIP_TYP_CDE,                                 41900099
377306                    DEST_POE_CDE,                                 41910099
377307                    C_O_PROD_CDE,                                 41920099
377308                    PROD_FCTRY_NM,                                41930099
377309                    PO_CART_CNT,                                  41940099
377310                    PO_CBMT_QTY,                                  41950099
377311                    PO_WT_KGRM_QTY,                               41960099
377312                    PO_UNT_QTY,                                   41970099
377313                    PO_EXC_APVL_CDE,                              41980099
377314                    PO_EXC_APVL_USR_ID,                           41990099
377315                    PO_EXC_APVL_TMST,                             42000099
377316                    PO_EXC_RSN_DESC,                              42010099
377317                    EST_LBD_NM,                                   42020099
377318                    EST_LBD_TMST,                                 42030099
377319                    SHIPT_BKG_TMST,                               42040099
377320                    VOY_CHG_RSN_DESC,                             42050099
377321                    DAT_SRC_ENT_ID,                               42060099
377322                    CRE_BY_USR_ID,                                42070099
377323                    CRE_TMST,                                     42080099
377324                    LAST_UPD_BY_USR_ID,                           42090099
377400                    LAST_UPD_TMST)                                42100099
377500           VALUES (:IMBKPO-PO-NBR,                                42110099
377600                   :IMBKPO-PO-BKG-SEQ-NBR,                        42120099
377700                   :IMBKPO-PO-BKG-DELY-TMST,                      42130099
377800                   :IMBKPO-EXTL-REF-NBR,                          42140099
377900                   :IMBKPO-ORGN-SHPD-FR-CDE,                      42150099
378000                   :IMBKPO-CONSLR-SCAC-ID,                        42160099
378100                   :IMBKPO-IMPRT-TRIP-ID,                         42170099
378200                   :IMBKPO-DPRTR-TMST,                            42180099
378300                   :IMBKPO-POE-DELY-TMST,                         42190099
378400                   :IMBKPO-CARR-SCAC-ID,                          42200099
378500                   :IMBKPO-FOB-CDE,                               42210099
378600                   :IMBKPO-IMPRT-VEH-NM,                          42220099
378700                   :IMBKPO-TRIP-TYP-CDE,                          42230099
378800                   :IMBKPO-DEST-POE-CDE,                          42240099
378900                   :IMBKPO-C-O-PROD-CDE,                          42250099
379000                   :IMBKPO-PROD-FCTRY-NM,                         42260099
379100                   :IMBKPO-PO-CART-CNT,                           42270099
379200                   :IMBKPO-PO-CBMT-QTY,                           42280099
379300                   :IMBKPO-PO-WT-KGRM-QTY,                        42290099
379400                   :IMBKPO-PO-UNT-QTY,                            42300099
379500                   :IMBKPO-PO-EXC-APVL-CDE,                       42310099
379600                   :IMBKPO-PO-EXC-APVL-USR-ID,                    42320099
379700                   :IMBKPO-PO-EXC-APVL-TMST,                      42330099
379800                   :IMBKPO-PO-EXC-RSN-DESC,                       42340099
379900                   :IMBKPO-EST-LBD-NM,                            42350099
380000                   :IMBKPO-EST-LBD-TMST,                          42360099
380100                   :IMBKPO-SHIPT-BKG-TMST,                        42370099
380200                   :IMBKPO-VOY-CHG-RSN-DESC,                      42380099
380300                   :IMBKPO-DAT-SRC-ENT-ID,                        42390099
380400                   :IMBKPO-CRE-BY-USR-ID,                         42400099
380500                   :IMBKPO-CRE-TMST,                              42410099
380600                   :IMBKPO-LAST-UPD-BY-USR-ID,                    42420099
380700                   :IMBKPO-LAST-UPD-TMST)                         42430099
380800                                                                  42440099
380900         END-EXEC                                                 42450099
381000                                                                  42460099
381100         EVALUATE TRUE                                            42470099
381200             WHEN SQLCODE = ZERO                                  42480099
381300                 ADD +1 TO PA-TOT-BKPO-INSERTS                    42490099
381400                 ADD +1 TO PA-TOT-RECS-INSERTED                   42500099
381500                 SET PS-TIMBKPO-ADDED       TO TRUE               42510099
381600                                                                  42520099
381700             WHEN SQLCODE = -803                                  42530099
381800                 SET PS-TIMBKPO-ADDED-NO    TO TRUE               42540099
381900             WHEN SQLWARN0 NOT EQUAL SPACE                        42550099
382000             WHEN SQLCODE NOT EQUAL ZERO                          42560099
382100                 DISPLAY '**************************************' 42570099
382200                 DISPLAY '** ABEND                            **' 42580099
382300                 DISPLAY '** PROGRAM = TRKUP205               **' 42590099
382400                 DISPLAY '** PARAGRAPH = 7020-INSERT-TIMBKPO  **' 42600099
382500                 DISPLAY '** INSERT TIMBKPO                   **' 42610099
382600                 DISPLAY '** PO NUMBER    = '                     42620099
382700                 DISPLAY            TR024-EDD-PO-NBR              42630099
382800                 DISPLAY '** EXTL REF NBR = '                     42640099
382900                 DISPLAY            TR024-EDD-EXTL-REF-NBR        42650099
383000                 DISPLAY '** PO BKG DELY DTE = '                  42660099
383100                 DISPLAY            TR024-EDD-PO-BKG-DELY-DTE     42670099
383200                 DISPLAY '** ORGN SHPD FR CDE = '                 42680099
383300                 DISPLAY            TR024-EDD-ORGN-SHPD-FR-CDE    42690099
383400                 DISPLAY '**************************************' 42700099
383500                 PERFORM 9100-SQL-ABEND                           42710099
383600         END-EVALUATE                                             42720099
383700     END-PERFORM.                                                 42730099
383800                                                                  42740099
383900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42750099
384000         (SQLCODE NOT = ZERO AND                                  42760099
384100             SQLCODE NOT = -803)                                  42770099
384200         DISPLAY '****************************************'       42780099
384300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       42790099
384400         DISPLAY '** INSERT TO TIMBKPO                  **'       42800099
384500         DISPLAY '** PARAGRAPH = 7020-INSERT-TIMBKPO    **'       42810099
384600         DISPLAY '** PO NUMBER    = ' TR024-EDD-PO-NBR            42820099
384700         DISPLAY '** EXTL REF NBR = ' TR024-EDD-EXTL-REF-NBR      42830099
384800         DISPLAY '****************************************'       42840099
384900         PERFORM 9100-SQL-ABEND                                   42850099
385000     END-IF.                                                      42860099
385100                                                                  42870099
385200 EJECT                                                            42880099
385300                                                                  42890099
385400******************************************************************42900099
385500* SELECT COUNTRY CODE.                                           *42910099
385600******************************************************************42920099
385700*7035-SELECT-CNTRY-CDE.                                           42930099
385800*                                                                 42940099
385900*    PERFORM                                                      42950099
386000*        WITH TEST AFTER                                          42960099
386100*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     42970099
386200*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            42980099
386300*                SQLCODE = ZERO                     OR            42990099
386400*                SQLCODE = +100                                   43000099
386500*                                                                 43010099
386600*        EXEC SQL                                                 43020099
386700*            SELECT A.CNTRY_CDE                                   43030099
386800*             INTO :CNTRY-CNTRY-CDE                               43040099
386900*              FROM TCNTRY  A                                     43050099
387000*             WHERE A.CNTRY_CDE   =  :TR024-EDL-C-O-PROD-CDE      43060099
387100*               AND A.STAT_CDE    =   'A'                         43070099
387200*        END-EXEC                                                 43080099
387300*                                                                 43090099
387400*        EVALUATE TRUE                                            43100099
387500*            WHEN SQLCODE = ZERO                                  43110099
387600*                SET PS-VALID-CNTRY-CDE    TO TRUE                43120099
387700*                                                                 43130099
387800*            WHEN SQLCODE = +100                                  43140099
387900*                SET PS-INVALID-CNTRY-CDE  TO TRUE                43150099
388000*                                                                 43160099
388100*            WHEN SQLWARN0 NOT EQUAL SPACE                        43170099
388200*            WHEN SQLCODE NOT EQUAL ZERO                          43180099
388300*                DISPLAY '**************************************' 43190099
388400*                DISPLAY '** ABEND                            **' 43200099
388500*                DISPLAY '** PROGRAM = TRKUP205               **' 43210099
388600*                DISPLAY '** PARAGRAPH = 7335-SELECT-CNTRY-CDE**' 43220099
388700*                DISPLAY '** SELECT TCNTRY CNTRY CDE          **' 43230099
388800*                DISPLAY '** PO NBR       = ' TR024-EDL-PO-NBR    43240099
388900*              DISPLAY '** EXTL REF NBR = ' TR024-EDL-EXTL-REF-NBR43250099
389000*              DISPLAY '** CNTRY CODE   = ' TR024-EDL-C-O-PROD-CDE43260099
389100*                DISPLAY '**************************************' 43270099
389200*                PERFORM 9100-SQL-ABEND                           43280099
389300*        END-EVALUATE                                             43290099
389400*    END-PERFORM.                                                 43300099
389500*                                                                 43310099
389600*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43320099
389700*        (SQLCODE NOT = ZERO    AND                               43330099
389800*            SQLCODE NOT = +100)                                  43340099
389900*        DISPLAY '****************************************'       43350099
390000*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       43360099
390100*        DISPLAY '** SELECT FROM TCNTRY                 **'       43370099
390200*        DISPLAY '** PARAGRAPH = 7335-SELECT-CNTRY-CDE  **'       43380099
390300*        DISPLAY '** PO-NBR       = ' TR024-EDL-PO-NBR            43390099
390400*        DISPLAY '** EXTL REF NBR = ' TR024-EDL-EXTL-REF-NBR      43400099
390500*        DISPLAY '** CNTRY CODE   = ' TR024-EDL-C-O-PROD-CDE      43410099
390600*        DISPLAY '****************************************'       43420099
390700*        PERFORM 9100-SQL-ABEND                                   43430099
390800*    END-IF.                                                      43440099
390900*                                                                 43450099
391000*EJECT                                                            43460099
391100*                                                                 43470099
391200******************************************************************43480099
391300*   OPEN THE POE CODE AIR CURSOR                                 *43490099
391400******************************************************************43500099
391500 7040-OPEN-POE-CURSOR-AIR.                                        43510099
391600                                                                  43520099
391700     PERFORM                                                      43530099
391800         WITH TEST AFTER                                          43540099
391900         VARYING PV-RETRY-COUNTER                                 43550099
392000         FROM 1 BY 1                                              43560099
392100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43570099
392200                   OR (SQLCODE = ZERO))                           43580099
392300                                                                  43590099
392400         EXEC SQL                                                 43600099
392500              OPEN POE-CSR-AIR                                    43610099
392600         END-EXEC                                                 43620099
392700                                                                  43630099
392800         EVALUATE TRUE                                            43640099
392900             WHEN SQLCODE = ZERO                                  43650099
393000                 CONTINUE                                         43660099
393100             WHEN SQLWARN0 NOT EQUAL SPACE                        43670099
393200             WHEN SQLCODE NOT EQUAL ZERO                          43680099
393300                 DISPLAY '**************************************' 43690099
393400                 DISPLAY '** ABEND                            **' 43700099
393500                 DISPLAY '** PROGRAM = TRKUP205               **' 43710099
393600                 DISPLAY '** PARAGRAPH = 7040-OPEN-POE-CSR-AIR *' 43720099
393700                 DISPLAY '** OPEN POE CODE AIR CURSOR         **' 43730099
393800                 DISPLAY '**************************************' 43740099
393900                 PERFORM 9100-SQL-ABEND                           43750099
394000         END-EVALUATE                                             43760099
394100     END-PERFORM.                                                 43770099
394200                                                                  43780099
394300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43790099
394400         (SQLCODE NOT = ZERO)                                     43800099
394500         DISPLAY '****************************************'       43810099
394600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       43820099
394700         DISPLAY '** OPEN POE CODE AIR CURSOR           **'       43830099
394800         DISPLAY '** PARAGRAPH = 7040-OPEN-POE-CURSOR-AIR*'       43840099
394900         DISPLAY '****************************************'       43850099
395000         PERFORM 9100-SQL-ABEND                                   43860099
395100     END-IF.                                                      43870099
395200                                                                  43880099
395300 EJECT                                                            43890099
395400******************************************************************43900099
395500*   CLOSE THE POE CODE AIR CURSOR                                *43910099
395600******************************************************************43920099
395700 7042-CLOSE-POE-CURSOR-AIR.                                       43930099
395800                                                                  43940099
395900     PERFORM                                                      43950099
396000         WITH TEST AFTER                                          43960099
396100         VARYING PV-RETRY-COUNTER                                 43970099
396200         FROM 1 BY 1                                              43980099
396300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43990099
396400                   OR (SQLCODE = ZERO))                           44000099
396500                                                                  44010099
396600         EXEC SQL                                                 44020099
396700             CLOSE POE-CSR-AIR                                    44030099
396800         END-EXEC                                                 44040099
396900                                                                  44050099
397000         EVALUATE TRUE                                            44060099
397100             WHEN SQLCODE = ZERO                                  44070099
397200                 CONTINUE                                         44080099
397300             WHEN SQLWARN0 NOT EQUAL SPACE                        44090099
397400             WHEN SQLCODE NOT EQUAL ZERO                          44100099
397500                 DISPLAY '**************************************' 44110099
397600                 DISPLAY '** ABEND                            **' 44120099
397700                 DISPLAY '** PROGRAM = TRKUP205               **' 44130099
397800                 DISPLAY '** PARAGRAPH = 7042-CLOSE-POE-CSR-AIR*' 44140099
397900                 DISPLAY '** CLOSE POE CODE AIR CURSOR        **' 44150099
398000                 DISPLAY '**************************************' 44160099
398100                 PERFORM 9100-SQL-ABEND                           44170099
398200         END-EVALUATE                                             44180099
398300     END-PERFORM.                                                 44190099
398400                                                                  44200099
398500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44210099
398600         (SQLCODE NOT = ZERO)                                     44220099
398700         DISPLAY '****************************************'       44230099
398800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       44240099
398900         DISPLAY '** CLOSE POE CODE AIR CURSOR          **'       44250099
399000         DISPLAY '** PARAGRAPH = 7042-CLOSE-POE-CSR-AIR **'       44260099
399100         DISPLAY '****************************************'       44270099
399200         PERFORM 9100-SQL-ABEND                                   44280099
399300     END-IF.                                                      44290099
399400                                                                  44300099
399500 EJECT                                                            44310099
399501******************************************************************44320099
399502*    FETCH THE POE CODE AIR CURSOR                               *44330099
399503******************************************************************44340099
399504 7044-FETCH-POE-CURSOR-AIR.                                       44350099
399505                                                                  44360099
399506     EXEC SQL                                                     44370099
399507          FETCH POE-CSR-AIR                                       44380099
399508          INTO  :IMPOE-POE-CDE                                    44390099
399509     END-EXEC.                                                    44400099
399510                                                                  44410099
399520     EVALUATE TRUE                                                44420099
399530         WHEN SQLCODE = ZERO                                      44430099
399540         WHEN SQLCODE = -811                                      44440099
399550             SET PS-VALID-POE-CDE    TO TRUE                      44450099
399560                                                                  44460099
399570         WHEN SQLCODE = +100                                      44470099
399580             SET PS-INVALID-POE-CDE  TO TRUE                      44480099
399590                                                                  44490099
399600         WHEN SQLWARN0 NOT EQUAL SPACE                            44500099
399700         WHEN SQLCODE NOT EQUAL ZERO                              44510099
399800             DISPLAY '**************************************'     44520099
399900             DISPLAY '** ABEND                            **'     44530099
400000             DISPLAY '** PROGRAM = TRKUP205               **'     44540099
400100             DISPLAY '** PARAGRAPH = 7044-FETCH-POE-CSR-AIR*'     44550099
400200             DISPLAY '** FETCH TIMPOE POE CODE AIR        **'     44560099
400300             DISPLAY '** POE CDE AIR = ' TR024-EDD-DEST-POE-CDE   44570099
400400             DISPLAY '**************************************'     44580099
400500             PERFORM 9100-SQL-ABEND                               44590099
400600     END-EVALUATE.                                                44600099
400700                                                                  44610099
400800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44620099
400900         (SQLCODE NOT = ZERO    AND                               44630099
401000          SQLCODE NOT = -811    AND                               44640099
401100          SQLCODE NOT = +100)                                     44650099
401200         DISPLAY '****************************************'       44660099
401300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       44670099
401400         DISPLAY '** FETCH FROM TIMPOE                  **'       44680099
401500         DISPLAY '** PARAGRAPH = 7044-FETCH-POE-CSR-AIR **'       44690099
401600         DISPLAY '** POE CDE AIR = ' TR024-EDD-DEST-POE-CDE       44700099
401700         DISPLAY '****************************************'       44710099
401800         PERFORM 9100-SQL-ABEND                                   44720099
401900     END-IF.                                                      44730099
402000                                                                  44740099
402100 EJECT                                                            44750099
402200******************************************************************44760099
402300*   OPEN THE POE CODE OCEAN CURSOR                               *44770099
402400******************************************************************44780099
402500 7050-OPEN-POE-CURSOR-OCEAN.                                      44790099
402600                                                                  44800099
402700     PERFORM                                                      44810099
402800         WITH TEST AFTER                                          44820099
402900         VARYING PV-RETRY-COUNTER                                 44830099
403000         FROM 1 BY 1                                              44840099
403100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44850099
403200                   OR (SQLCODE = ZERO))                           44860099
403300                                                                  44870099
403400         EXEC SQL                                                 44880099
403500              OPEN POE-CSR-OCEAN                                  44890099
403600         END-EXEC                                                 44900099
403700                                                                  44910099
403800         EVALUATE TRUE                                            44920099
403900             WHEN SQLCODE = ZERO                                  44930099
404000                 CONTINUE                                         44940099
404100             WHEN SQLWARN0 NOT EQUAL SPACE                        44950099
404200             WHEN SQLCODE NOT EQUAL ZERO                          44960099
404300                 DISPLAY '**************************************' 44970099
404400                 DISPLAY '** ABEND                            **' 44980099
404500                 DISPLAY '** PROGRAM = TRKUP205               **' 44990099
404600                 DISPLAY '** PARAGRAPH = 7050-OPEN-POE-CSR-OCN**' 45000099
404700                 DISPLAY '** OPEN POE CODE OCEAN CURSOR       **' 45010099
404800                 DISPLAY '**************************************' 45020099
404900                 PERFORM 9100-SQL-ABEND                           45030099
405000         END-EVALUATE                                             45040099
405100     END-PERFORM.                                                 45050099
405200                                                                  45060099
405300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45070099
405400         (SQLCODE NOT = ZERO)                                     45080099
405500         DISPLAY '****************************************'       45090099
405600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       45100099
405700         DISPLAY '** OPEN POE CODE OCEAN CURSOR         **'       45110099
405800         DISPLAY '** PARAGRAPH = 7050-OPEN-POE-CURSOR-OCN*'       45120099
405900         DISPLAY '****************************************'       45130099
406000         PERFORM 9100-SQL-ABEND                                   45140099
406100     END-IF.                                                      45150099
406200                                                                  45160099
406300 EJECT                                                            45170099
406400******************************************************************45180099
406500*   CLOSE THE POE CODE OCEAN CURSOR                              *45190099
406600******************************************************************45200099
406700 7052-CLOSE-POE-CURSOR-OCEAN.                                     45210099
406800                                                                  45220099
406900     PERFORM                                                      45230099
407000         WITH TEST AFTER                                          45240099
407100         VARYING PV-RETRY-COUNTER                                 45250099
407200         FROM 1 BY 1                                              45260099
407300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45270099
407400                   OR (SQLCODE = ZERO))                           45280099
407500                                                                  45290099
407600         EXEC SQL                                                 45300099
407700             CLOSE POE-CSR-OCEAN                                  45310099
407800         END-EXEC                                                 45320099
407900                                                                  45330099
408000         EVALUATE TRUE                                            45340099
408100             WHEN SQLCODE = ZERO                                  45350099
408200                 CONTINUE                                         45360099
408300             WHEN SQLWARN0 NOT EQUAL SPACE                        45370099
408400             WHEN SQLCODE NOT EQUAL ZERO                          45380099
408500                 DISPLAY '**************************************' 45390099
408600                 DISPLAY '** ABEND                            **' 45400099
408700                 DISPLAY '** PROGRAM = TRKUP205               **' 45410099
408800                 DISPLAY '** PARAGRAPH = 7052-CLOSE-POE-CSR-OCN*' 45420099
408900                 DISPLAY '** CLOSE POE CODE OCEAN CURSOR      **' 45430099
409000                 DISPLAY '**************************************' 45440099
409100                 PERFORM 9100-SQL-ABEND                           45450099
409200         END-EVALUATE                                             45460099
409300     END-PERFORM.                                                 45470099
409400                                                                  45480099
409500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45490099
409600         (SQLCODE NOT = ZERO)                                     45500099
409700         DISPLAY '****************************************'       45510099
409800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       45520099
409900         DISPLAY '** CLOSE POE CODE OCEAN CURSOR        **'       45530099
410000         DISPLAY '** PARAGRAPH = 7052-CLOSE-POE-CSR-OCN **'       45540099
410100         DISPLAY '****************************************'       45550099
410200         PERFORM 9100-SQL-ABEND                                   45560099
410300     END-IF.                                                      45570099
410400                                                                  45580099
410500 EJECT                                                            45590099
410501******************************************************************45600099
410502*    FETCH THE POE CODE OCEAN CURSOR                             *45610099
410503******************************************************************45620099
410504 7054-FETCH-POE-CURSOR-OCEAN.                                     45630099
410505                                                                  45640099
410506     EXEC SQL                                                     45650099
410507          FETCH POE-CSR-OCEAN                                     45660099
410508          INTO  :IMPOE-POE-CDE                                    45670099
410509     END-EXEC.                                                    45680099
410510                                                                  45690099
410520     EVALUATE TRUE                                                45700099
410530         WHEN SQLCODE = ZERO                                      45710099
410540         WHEN SQLCODE = -811                                      45720099
410550             SET PS-VALID-POE-CDE    TO TRUE                      45730099
410560                                                                  45740099
410570         WHEN SQLCODE = +100                                      45750099
410580             SET PS-INVALID-POE-CDE  TO TRUE                      45760099
410590                                                                  45770099
410600         WHEN SQLWARN0 NOT EQUAL SPACE                            45780099
410700         WHEN SQLCODE NOT EQUAL ZERO                              45790099
410800             DISPLAY '**************************************'     45800099
410900             DISPLAY '** ABEND                            **'     45810099
411000             DISPLAY '** PROGRAM = TRKUP205               **'     45820099
411100             DISPLAY '** PARAGRAPH = 7054-FETCH-POE-CSR-OCN*'     45830099
411200             DISPLAY '** FETCH TIMPOE POE CODE OCEAN      **'     45840099
411300             DISPLAY '** POE CDE AIR = ' TR024-EDD-DEST-POE-CDE   45850099
411400             DISPLAY '**************************************'     45860099
411500             PERFORM 9100-SQL-ABEND                               45870099
411600     END-EVALUATE.                                                45880099
411700                                                                  45890099
411800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45900099
411900         (SQLCODE NOT = ZERO    AND                               45910099
412000          SQLCODE NOT = -811    AND                               45920099
412100          SQLCODE NOT = +100)                                     45930099
412200         DISPLAY '****************************************'       45940099
412300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       45950099
412400         DISPLAY '** FETCH FROM TIMPOE                  **'       45960099
412500         DISPLAY '** PARAGRAPH = 7054-FETCH-POE-CSR-OCN **'       45970099
412600         DISPLAY '** POE CDE AIR = ' TR024-EDD-DEST-POE-CDE       45980099
412700         DISPLAY '****************************************'       45990099
412800         PERFORM 9100-SQL-ABEND                                   46000099
412900     END-IF.                                                      46010099
413000                                                                  46020099
413001 EJECT                                                            46030099
413002******************************************************************46040099
413003* SELECT FOB CODE FOR AIR.                                       *46050099
413004******************************************************************46060099
413005 7055-SELECT-FOB-AIR.                                             46070099
413006                                                                  46080099
413007     PERFORM                                                      46090099
413008         WITH TEST AFTER                                          46100099
413009         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     46110099
413010         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            46120099
413011                 SQLCODE = ZERO                     OR            46130099
413012                 SQLCODE = -811                     OR            46140099
413013                 SQLCODE = +100                                   46150099
413014                                                                  46160099
413015         EXEC SQL                                                 46170099
413016             SELECT A.FOB_CDE                                     46180099
413017              INTO :IMFOB-FOB-CDE                                 46190099
413018               FROM TIMFOB  A                                     46200099
413019              WHERE A.FOB_CDE     =   :TR024-EDD-FOB-CDE          46210099
413020                AND A.STAT_CDE    =   'A'                         46220099
413021         END-EXEC                                                 46230099
413022                                                                  46240099
413023         EVALUATE TRUE                                            46250099
413024             WHEN SQLCODE = ZERO                                  46260099
413025             WHEN SQLCODE = -811                                  46270099
413026                 SET PS-VALID-FOB-CDE    TO TRUE                  46280099
413027                                                                  46290099
413028             WHEN SQLCODE = +100                                  46300099
413029                 SET PS-INVALID-FOB-CDE  TO TRUE                  46310099
413030                                                                  46320099
413031             WHEN SQLWARN0 NOT EQUAL SPACE                        46330099
413032             WHEN SQLCODE NOT EQUAL ZERO                          46340099
413033                 DISPLAY '**************************************' 46350099
413034                 DISPLAY '** ABEND                            **' 46360099
413035                 DISPLAY '** PROGRAM = TRKUP205               **' 46370099
413036                 DISPLAY '** PARAGRAPH = 7055-SELECT-FOB-AIR  **' 46380099
413037                 DISPLAY '** SELECT TIMFOB FOB CODE           **' 46390099
413038                 DISPLAY '** PO NBR       = ' TR024-EDD-PO-NBR    46400099
413039              DISPLAY '** EXTL REF NBR = ' TR024-EDD-EXTL-REF-NBR 46410099
413040                 DISPLAY '** FOB CODE     = ' TR024-EDD-FOB-CDE   46420099
413041                 DISPLAY '**************************************' 46430099
413042                 PERFORM 9100-SQL-ABEND                           46440099
413043         END-EVALUATE                                             46450099
413044     END-PERFORM.                                                 46460099
413045                                                                  46470099
413046     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    46480099
413047         (SQLCODE NOT = ZERO    AND                               46490099
413048          SQLCODE NOT = -811    AND                               46500099
413049          SQLCODE NOT = +100)                                     46510099
413050         DISPLAY '****************************************'       46520099
413051         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       46530099
413052         DISPLAY '** SELECT FROM TIMFOB                 **'       46540099
413053         DISPLAY '** PARAGRAPH = 7055-SELECT-FOB-AIR    **'       46550099
413054         DISPLAY '** PO NBR       = ' TR024-EDD-PO-NBR            46560099
413055         DISPLAY '** EXTL REF NBR = ' TR024-EDD-EXTL-REF-NBR      46570099
413056         DISPLAY '** FOB CODE     = ' TR024-EDD-FOB-CDE           46580099
413057         DISPLAY '****************************************'       46590099
413058         PERFORM 9100-SQL-ABEND                                   46600099
413059     END-IF.                                                      46610099
413060                                                                  46620099
413061 EJECT                                                            46630099
413062                                                                  46640099
413063******************************************************************46650099
413064* SELECT FOB CODE FOR OCEAN.                                     *46660099
413065******************************************************************46670099
413066 7060-SELECT-FOB-OCEAN.                                           46680099
413067                                                                  46690099
413068     PERFORM                                                      46700099
413069         WITH TEST AFTER                                          46710099
413070         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     46720099
413071         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            46730099
413072                 SQLCODE = ZERO                     OR            46740099
413073                 SQLCODE = -811                     OR            46750099
413074                 SQLCODE = +100                                   46760099
413075                                                                  46770099
413076         EXEC SQL                                                 46780099
413077             SELECT A.FOB_CDE                                     46790099
413078              INTO :IMFOB-FOB-CDE                                 46800099
413079               FROM TIMFOB  A                                     46810099
413080              WHERE A.FOB_STD_EDI_CDE  = :TR024-EDD-FOB-CDE       46820099
413081                AND A.STAT_CDE         = 'A'                      46830099
413082         END-EXEC                                                 46840099
413083                                                                  46850099
413084         EVALUATE TRUE                                            46860099
413085             WHEN SQLCODE = ZERO                                  46870099
413086             WHEN SQLCODE = -811                                  46880099
413087                 SET PS-VALID-FOB-CDE    TO TRUE                  46890099
413088                                                                  46900099
413089             WHEN SQLCODE = +100                                  46910099
413090                 SET PS-INVALID-FOB-CDE  TO TRUE                  46920099
413091                                                                  46930099
413092             WHEN SQLWARN0 NOT EQUAL SPACE                        46940099
413093             WHEN SQLCODE NOT EQUAL ZERO                          46950099
413094                 DISPLAY '**************************************' 46960099
413095                 DISPLAY '** ABEND                            **' 46970099
413096                 DISPLAY '** PROGRAM = TRKUP205               **' 46980099
413100                 DISPLAY '** PARAGRAPH = 7060-SELECT-FOB-OCEAN**' 46990099
413200                 DISPLAY '** SELECT TIMFOB FOB CODE           **' 47000099
413300                 DISPLAY '** PO NBR       = ' TR024-EDD-PO-NBR    47010099
413400               DISPLAY '** EXTL REF NBR = ' TR024-EDD-EXTL-REF-NBR47020099
413500                 DISPLAY '** FOB CODE     = ' TR024-EDD-FOB-CDE   47030099
413600                 DISPLAY '**************************************' 47040099
413700                 PERFORM 9100-SQL-ABEND                           47050099
413800         END-EVALUATE                                             47060099
413900     END-PERFORM.                                                 47070099
414000                                                                  47080099
414100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47090099
414200         (SQLCODE NOT = ZERO    AND                               47100099
414300          SQLCODE NOT = -811 AND                                  47110099
414400          SQLCODE NOT = +100)                                     47120099
414500         DISPLAY '****************************************'       47130099
414600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       47140099
414700         DISPLAY '** SELECT FROM TIMFOB                 **'       47150099
414800         DISPLAY '** PARAGRAPH = 7060-SELECT-FOB-OCEAN  **'       47160099
414900         DISPLAY '** PO NBR       = ' TR024-EDD-PO-NBR            47170099
415000         DISPLAY '** EXTL REF NBR = ' TR024-EDD-EXTL-REF-NBR      47180099
415100         DISPLAY '** FOB CODE     = ' TR024-EDD-FOB-CDE           47190099
415200         DISPLAY '****************************************'       47200099
415300         PERFORM 9100-SQL-ABEND                                   47210099
415400     END-IF.                                                      47220099
415500                                                                  47230099
415600 EJECT                                                            47240099
415700                                                                  47250099
415800******************************************************************47260099
415900* SELECT A ROW FROM THE BOOKINGS VENDOR STYLE TABLE  (TIMBKVS).  *47270099
416000******************************************************************47280099
416100*7100-SELECT-TIMBKVS.                                             47290099
416200                                                                  47300099
416300*    PERFORM                                                      47310099
416400*        WITH TEST AFTER                                          47320099
416500*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     47330099
416600*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            47340099
416700*                SQLCODE = ZERO                     OR            47350099
416800*                SQLCODE = +100                                   47360099
416900*                                                                 47370099
417000*        EXEC SQL                                                 47380099
417100*            SELECT PO_NBR,                                       47390099
417200*                   PO_BKG_SEQ_NBR,                               47400099
417300*                   VS_NBR,                                       47410099
417400*                   HTS_ID,                                       47420099
417500*                   VS_CART_CNT,                                  47430099
417600*                   VS_CBMT_QTY,                                  47440099
417700*                   VS_WT_KGRM_QTY,                               47450099
417800*                   VS_UNT_QTY,                                   47460099
417900*                   QTA_CTG_IND,                                  47470099
418000*                   CRE_BY_USR_ID,                                47480099
418100*                   CRE_TMST,                                     47490099
418200*                   LAST_UPD_BY_USR_ID,                           47500099
418300*                   LAST_UPD_TMST                                 47510099
418400*             INTO :IMBKVS-PO-NBR,                                47520099
418500*                  :IMBKVS-PO-BKG-SEQ-NBR,                        47530099
418600*                  :IMBKVS-VS-NBR,                                47540099
418700*                  :IMBKVS-HTS-ID,                                47550099
418800*                  :IMBKVS-VS-CART-CNT,                           47560099
418900*                  :IMBKVS-VS-CBMT-QTY,                           47570099
419000*                  :IMBKVS-VS-WT-KGRM-QTY,                        47580099
419100*                  :IMBKVS-VS-UNT-QTY,                            47590099
419200*                  :IMBKVS-QTA-CTG-IND,                           47600099
419300*                  :IMBKVS-CRE-BY-USR-ID,                         47610099
419400*                  :IMBKVS-CRE-TMST,                              47620099
419500*                  :IMBKVS-LAST-UPD-BY-USR-ID,                    47630099
419600*                  :IMBKVS-LAST-UPD-TMST                          47640099
419700*                                                                 47650099
419800*              FROM TIMBKVS                                       47660099
419900*             WHERE PO_NBR           = :IMBKVS-PO-NBR             47670099
420000*               AND VS_NBR           = :TR024-EDLVS-VS-NBR        47680099
420100*               AND PO_BKG_SEQ_NBR   = :IMBKPO-PO-BKG-SEQ-NBR     47690099
420200*        END-EXEC                                                 47700099
420300*                                                                 47710099
420400*        EVALUATE TRUE                                            47720099
420500*            WHEN SQLCODE = ZERO                                  47730099
420600*                SET PS-TIMBKVS-ROW-IS-THERE TO TRUE              47740099
420700*                                                                 47750099
420800*            WHEN SQLCODE = +100                                  47760099
420900*                SET PS-TIMBKVS-ROW-IS-THERE-NO TO TRUE           47770099
421000*                                                                 47780099
421100*            WHEN SQLWARN0 NOT EQUAL SPACE                        47790099
421200*            WHEN SQLCODE NOT EQUAL ZERO                          47800099
421300*                DISPLAY '**************************************' 47810099
421400*                DISPLAY '** ABEND                            **' 47820099
421500*                DISPLAY '** PROGRAM = TRKUP205               **' 47830099
421600*                DISPLAY '** PARAGRAPH = 7100-SELECT-TIMBKVS  **' 47840099
421700*                DISPLAY '** SELECT TIMBKVS                   **' 47850099
421800*                DISPLAY '** PO NUMBER    = '                     47860099
421900*                DISPLAY            TR024-EDLVS-PO-NBR            47870099
422000*                DISPLAY '** VENDOR STYLE = '                     47880099
422100*                DISPLAY            TR024-EDLVS-VS-NBR            47890099
422200*                DISPLAY '** EXTL REF NBR = '                     47900099
422300*                DISPLAY            TR024-EDLVS-EXTL-REF-NBR      47910099
422400*                DISPLAY '**************************************' 47920099
422500*                PERFORM 9100-SQL-ABEND                           47930099
422600*        END-EVALUATE                                             47940099
422700*    END-PERFORM.                                                 47950099
422800*                                                                 47960099
422900*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    47970099
423000*        (SQLCODE NOT = ZERO AND                                  47980099
423100*            SQLCODE NOT = +100)                                  47990099
423200*        DISPLAY '****************************************'       48000099
423300*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       48010099
423400*        DISPLAY '** SELECT FROM TIMBKVS                **'       48020099
423500*        DISPLAY '** PARAGRAPH = 7100-SELECT-TIMBKVS    **'       48030099
423600*        DISPLAY '** PO NUMBER    = ' TR024-EDLVS-PO-NBR          48040099
423700*        DISPLAY '** VENDOR STYLE = ' TR024-EDLVS-VS-NBR          48050099
423800*        DISPLAY '** EXTL REF NBR = ' TR024-EDLVS-EXTL-REF-NBR    48060099
423900*        DISPLAY '****************************************'       48070099
424000*        PERFORM 9100-SQL-ABEND                                   48080099
424100*    END-IF.                                                      48090099
424200                                                                  48100099
424300 EJECT                                                            48110099
424400                                                                  48120099
424500******************************************************************48130099
424600* SELECT A ROW FROM THE BOOKINGS VENDOR STYLE TABLE  (TIMBKVS).  *48140099
424700******************************************************************48150099
424800*7105-SELECT-TIMBKVS-CHG.                                         48160099
424900                                                                  48170099
425000*    PERFORM                                                      48180099
425100*        WITH TEST AFTER                                          48190099
425200*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     48200099
425300*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            48210099
425400*                SQLCODE = ZERO                     OR            48220099
425500*                SQLCODE = +100                                   48230099
425600*                                                                 48240099
425700*        EXEC SQL                                                 48250099
425800*            SELECT PO_NBR,                                       48260099
425900*                   PO_BKG_SEQ_NBR,                               48270099
426000*                   VS_NBR,                                       48280099
426100*                   HTS_ID,                                       48290099
426200*                   VS_CART_CNT,                                  48300099
426300*                   VS_CBMT_QTY,                                  48310099
426400*                   VS_WT_KGRM_QTY,                               48320099
426500*                   VS_UNT_QTY,                                   48330099
426600*                   QTA_CTG_IND,                                  48340099
426700*                   CRE_BY_USR_ID,                                48350099
426800*                   CRE_TMST,                                     48360099
426900*                   LAST_UPD_BY_USR_ID,                           48370099
427000*                   LAST_UPD_TMST                                 48380099
427100*             INTO :IMBKVS-PO-NBR,                                48390099
427200*                  :IMBKVS-PO-BKG-SEQ-NBR,                        48400099
427300*                  :IMBKVS-VS-NBR,                                48410099
427400*                  :IMBKVS-HTS-ID,                                48420099
427500*                  :IMBKVS-VS-CART-CNT,                           48430099
427600*                  :IMBKVS-VS-CBMT-QTY,                           48440099
427700*                  :IMBKVS-VS-WT-KGRM-QTY,                        48450099
427800*                  :IMBKVS-VS-UNT-QTY,                            48460099
427900*                  :IMBKVS-QTA-CTG-IND,                           48470099
428000*                  :IMBKVS-CRE-BY-USR-ID,                         48480099
428100*                  :IMBKVS-CRE-TMST,                              48490099
428200*                  :IMBKVS-LAST-UPD-BY-USR-ID,                    48500099
428300*                  :IMBKVS-LAST-UPD-TMST                          48510099
428400*                                                                 48520099
428500*              FROM TIMBKVS                                       48530099
428600*             WHERE PO_NBR           = :IMBKPO-PO-NBR             48540099
428700*               AND PO_BKG_SEQ_NBR   = :IMBKPO-PO-BKG-SEQ-NBR     48550099
428800*               AND VS_NBR           = :IMBKVS-VS-NBR             48560099
428900*        END-EXEC                                                 48570099
429000*                                                                 48580099
429100*        EVALUATE TRUE                                            48590099
429200*            WHEN SQLCODE = ZERO                                  48600099
429300*                CONTINUE                                         48610099
429400*                                                                 48620099
429500*            WHEN SQLCODE = +100                                  48630099
429600*                PERFORM 7107-TIMBKVS-SELECT-ERROR                48640099
429700*                                                                 48650099
429800*            WHEN SQLWARN0 NOT EQUAL SPACE                        48660099
429900*            WHEN SQLCODE NOT EQUAL ZERO                          48670099
430000*                DISPLAY '**************************************' 48680099
430100*                DISPLAY '** ABEND                            **' 48690099
430200*                DISPLAY '** PROGRAM = TRKUP205               **' 48700099
430300*                DISPLAY '** PARAGRAPH = 7105-SELECT-TIMBKVS-CHG' 48710099
430400*                DISPLAY '** SELECT TIMBKVS                   **' 48720099
430500*                DISPLAY '** PO NUMBER   = ' IMBKPO-PO-NBR        48730099
430600*                DISPLAY '** BKG SEQ NBR= ' IMBKPO-PO-BKG-SEQ-NBR 48740099
430700*                DISPLAY '** VENDOR STYLE = ' IMBKVS-VS-NBR       48750099
430800*                DISPLAY '**************************************' 48760099
430900*                PERFORM 9100-SQL-ABEND                           48770099
431000*        END-EVALUATE                                             48780099
431100*    END-PERFORM.                                                 48790099
431200*                                                                 48800099
431300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    48810099
431400*        (SQLCODE NOT = ZERO AND                                  48820099
431500*            SQLCODE NOT = +100)                                  48830099
431600*        DISPLAY '****************************************'       48840099
431700*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       48850099
431800*        DISPLAY '** SELECT FROM TIMBKVS                **'       48860099
431900*        DISPLAY '** PARAGRAPH = 7105-SELECT-TIMBKVS-CHG**'       48870099
432000*        DISPLAY '** PO NUMBER    = ' IMBKPO-PO-NBR               48880099
432100*        DISPLAY '** BKG SEQ NBR  = ' IMBKPO-PO-BKG-SEQ-NBR       48890099
432200*        DISPLAY '** VENDOR STYLE = ' IMBKVS-VS-NBR               48900099
432300*        DISPLAY '****************************************'       48910099
432400*        PERFORM 9100-SQL-ABEND                                   48920099
432500*    END-IF.                                                      48930099
432600                                                                  48940099
432700 EJECT                                                            48950099
432800                                                                  48960099
432900******************************************************************48970099
433000* INSERT A ROW TO THE BOOKINGS VENDOR STYLE TABLE  (TIMBKVS).    *48980099
433100******************************************************************48990099
433200*7107-TIMBKVS-SELECT-ERROR.                                       49000099
433300*                                                                 49010099
433400*    INITIALIZE TR201-RECORD.                                     49020099
433500*    INITIALIZE TR201-REC-TYP-EDLVS.                              49030099
433600*                                                                 49040099
433700*    MOVE PC-E                  TO TR201-RPT-TYP.                 49050099
433800*    MOVE 'VS NUMBER'           TO TR201-DATA-IN-ERROR.           49060099
433900*    MOVE PV-UPC-CURSOR-VS-NBR  TO TR201-DATA-VALUE               49070099
434000*                                  TR201-EDLVS-VS-NBR.            49080099
434100*    MOVE PC-ERROR              TO TR201-ERROR-TYPE.              49090099
434200*    MOVE 'CONTACT PROGRAMMING - SEE PARAGRAPH 2390' TO           49100099
434300*          TR201-ERROR-MSG.                                       49110099
434400*    MOVE PC-E                  TO TR201-TRN-TYP.                 49120099
434500*    MOVE PC-EDLVS              TO TR201-REC-TYP-EDLVS-CDE.       49130099
434600*    MOVE PC-21                 TO TR201-EDLVS-SEQ-NBR.           49140099
434700*    MOVE IMBKPO-PO-NBR         TO TR201-PO-NBR.                  49150099
434800*    MOVE IMBKPO-EXTL-REF-NBR   TO TR201-EXTL-REF-NBR.            49160099
434900*    MOVE IMBKPO-PO-BKG-DELY-TMST (1:4)  TO                       49170099
435000*          TR201-PO-BKG-DELY-DTE (1:4).                           49180099
435100*    MOVE IMBKPO-PO-BKG-DELY-TMST (6:2)  TO                       49190099
435200*          TR201-PO-BKG-DELY-DTE (5:2).                           49200099
435300*    MOVE IMBKPO-PO-BKG-DELY-TMST (9:2)  TO                       49210099
435400*          TR201-PO-BKG-DELY-DTE (7:2).                           49220099
435500*    MOVE IMBKPO-PO-BKG-DELY-TMST (12:2) TO                       49230099
435600*          TR201-PO-BKG-DELY-TM  (1:2).                           49240099
435700*    MOVE IMBKPO-PO-BKG-DELY-TMST (15:2) TO                       49250099
435800*          TR201-PO-BKG-DELY-TM  (3:2).                           49260099
435900*    MOVE IMBKPO-ORGN-SHPD-FR-CDE        TO                       49270099
436000*          TR201-ORGN-SHPD-FR-CDE.                                49280099
436100                                                                  49290099
436200*    COMPUTE TR201-PROCESS-SEQ-NBR =                              49300099
436300*             (TR024-EDD-PROCESS-SEQ-NBR - 1).                    49310099
436400                                                                  49320099
436500*    PERFORM 7300-INSERT-TOUTTR6-RPT.                             49330099
436600                                                                  49340099
436700******************************************************************49350099
436800* INSERT A ROW TO THE BOOKINGS VENDOR STYLE TABLE  (TIMBKVS).    *49360099
436900******************************************************************49370099
437000*7110-INSERT-TIMBKVS.                                             49380099
437100                                                                  49390099
437200*    PERFORM                                                      49400099
437300*        WITH TEST AFTER                                          49410099
437400*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     49420099
437500*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            49430099
437600*                SQLCODE = ZERO                     OR            49440099
437700*                SQLCODE = -803                                   49450099
437800                                                                  49460099
437900*        EXEC SQL                                                 49470099
438000*            INSERT INTO TIMBKVS                                  49480099
438100*                  (PO_NBR,                                       49490099
438200*                   PO_BKG_SEQ_NBR,                               49500099
438300*                   VS_NBR,                                       49510099
438400*                   HTS_ID,                                       49520099
438500*                   VS_CART_CNT,                                  49530099
438600*                   VS_CBMT_QTY,                                  49540099
438700*                   VS_WT_KGRM_QTY,                               49550099
438800*                   VS_UNT_QTY,                                   49560099
438900*                   QTA_CTG_IND,                                  49570099
439000*                   CRE_BY_USR_ID,                                49580099
439100*                   CRE_TMST,                                     49590099
439200*                   LAST_UPD_BY_USR_ID,                           49600099
439300*                   LAST_UPD_TMST)                                49610099
439400*           VALUES                                                49620099
439500*                 (:IMBKVS-PO-NBR,                                49630099
439600*                  :IMBKVS-PO-BKG-SEQ-NBR,                        49640099
439700*                  :IMBKVS-VS-NBR,                                49650099
439800*                  :IMBKVS-HTS-ID,                                49660099
439900*                  :IMBKVS-VS-CART-CNT,                           49670099
440000*                  :IMBKVS-VS-CBMT-QTY,                           49680099
440100*                  :IMBKVS-VS-WT-KGRM-QTY,                        49690099
440200*                  :IMBKVS-VS-UNT-QTY,                            49700099
440300*                  :IMBKVS-QTA-CTG-IND,                           49710099
440400*                  :IMBKVS-CRE-BY-USR-ID,                         49720099
440500*                  :IMBKVS-CRE-TMST,                              49730099
440600*                  :IMBKVS-LAST-UPD-BY-USR-ID,                    49740099
440700*                  :IMBKVS-LAST-UPD-TMST)                         49750099
440800*                                                                 49760099
440900*        END-EXEC                                                 49770099
441000*                                                                 49780099
441100*        EVALUATE TRUE                                            49790099
441200*            WHEN SQLCODE = ZERO                                  49800099
441300*                MOVE PC-D            TO TR201-RPT-TYP            49810099
441400*                ADD +1               TO PA-TOT-BKVS-INSERTS      49820099
441500*                ADD +1               TO PA-TOT-RECS-INSERTED     49830099
441600*                SET PS-TIMBKVS-ADDED       TO TRUE               49840099
441700*                                                                 49850099
441800*            WHEN SQLCODE = -803                                  49860099
441900*                SET PS-TIMBKVS-ADDED-NO    TO TRUE               49870099
442000*                                                                 49880099
442100*            WHEN SQLWARN0 NOT EQUAL SPACE                        49890099
442200*            WHEN SQLCODE NOT EQUAL ZERO                          49900099
442300*                DISPLAY '**************************************' 49910099
442400*                DISPLAY '** ABEND                            **' 49920099
442500*                DISPLAY '** PROGRAM = TRKUP205               **' 49930099
442600*                DISPLAY '** PARAGRAPH = 7110-INSERT-TIMBKVS  **' 49940099
442700*                DISPLAY '** INSERT TIMBKVS                   **' 49950099
442800*                DISPLAY '** PO NUMBER    = '                     49960099
442900*                DISPLAY            TR024-EDLVS-PO-NBR            49970099
443000*                DISPLAY '** VENDOR STYLE = '                     49980099
443100*                DISPLAY            TR024-EDLVS-VS-NBR            49990099
443200*                DISPLAY '** EXTL REF NBR = '                     50000099
443300*                DISPLAY            TR024-EDLVS-EXTL-REF-NBR      50010099
443400*                DISPLAY '** PO BKG DELY DTE = '                  50020099
443500*                DISPLAY            TR024-EDLVS-PO-BKG-DELY-DTE   50030099
443600*                DISPLAY '** ORGN SHPD FR CDE = '                 50040099
443700*                DISPLAY            TR024-EDLVS-ORGN-SHPD-FR-CDE  50050099
443800*                DISPLAY '**************************************' 50060099
443900*                PERFORM 9100-SQL-ABEND                           50070099
444000*        END-EVALUATE                                             50080099
444100*    END-PERFORM.                                                 50090099
444200                                                                  50100099
444300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    50110099
444400*        (SQLCODE NOT = ZERO AND                                  50120099
444500*            SQLCODE NOT = -803)                                  50130099
444600*        DISPLAY '****************************************'       50140099
444700*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       50150099
444800*        DISPLAY '** INSERT INTO TIMBKVS                **'       50160099
444900*        DISPLAY '** PARAGRAPH = 7110-INSERT-TIMBKVS    **'       50170099
445000*        DISPLAY '** PO NUMBER    = ' TR024-EDLVS-PO-NBR          50180099
445100*        DISPLAY '** VENDOR STYLE = ' TR024-EDLVS-VS-NBR          50190099
445200*        DISPLAY '** EXTL REF NBR = ' TR024-EDLVS-EXTL-REF-NBR    50200099
445300*        DISPLAY '****************************************'       50210099
445400*        PERFORM 9100-SQL-ABEND                                   50220099
445500*    END-IF.                                                      50230099
445600                                                                  50240099
445700 EJECT                                                            50250099
445800                                                                  50260099
445900******************************************************************50270099
446000* SELECT A ROW FROM THE BOOKINGS UPC TABLE  (TIMBKUP).           *50280099
446100******************************************************************50290099
446200*7200-SELECT-TIMBKUP.                                             50300099
446300                                                                  50310099
446400*    PERFORM                                                      50320099
446500*        WITH TEST AFTER                                          50330099
446600*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     50340099
446700*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            50350099
446800*                SQLCODE = ZERO                     OR            50360099
446900*                SQLCODE = +100                                   50370099
447000*                                                                 50380099
447100*        EXEC SQL                                                 50390099
447200*            SELECT PO_NBR,                                       50400099
447300*                   PO_BKG_SEQ_NBR,                               50410099
447400*                   VS_NBR,                                       50420099
447500*                   UPC_NBR,                                      50430099
447600*                   UPC_CART_CNT,                                 50440099
447700*                   UPC_CBMT_QTY,                                 50450099
447800*                   UPC_WT_KGRM_QTY,                              50460099
447900*                   UPC_UNT_QTY,                                  50470099
448000*                   CRE_BY_USR_ID,                                50480099
448100*                   CRE_TMST,                                     50490099
448200*                   LAST_UPD_BY_USR_ID,                           50500099
448300*                   LAST_UPD_TMST                                 50510099
448400*             INTO :IMBKUP-PO-NBR,                                50520099
448500*                  :IMBKUP-PO-BKG-SEQ-NBR,                        50530099
448600*                  :IMBKUP-VS-NBR,                                50540099
448700*                  :IMBKUP-UPC-NBR,                               50550099
448800*                  :IMBKUP-UPC-CART-CNT,                          50560099
448900*                  :IMBKUP-UPC-CBMT-QTY,                          50570099
449000*                  :IMBKUP-UPC-WT-KGRM-QTY,                       50580099
449100*                  :IMBKUP-UPC-UNT-QTY,                           50590099
449200*                  :IMBKUP-CRE-BY-USR-ID,                         50600099
449300*                  :IMBKUP-CRE-TMST,                              50610099
449400*                  :IMBKUP-LAST-UPD-BY-USR-ID,                    50620099
449500*                  :IMBKUP-LAST-UPD-TMST                          50630099
449600*                                                                 50640099
449700*              FROM TIMBKUP                                       50650099
449800*             WHERE PO_NBR           = :IMBKUP-PO-NBR             50660099
449900*               AND VS_NBR           = :IMBKUP-VS-NBR             50670099
450000*               AND UPC_NBR          = :IMBKUP-UPC-NBR            50680099
450100*               AND PO_BKG_SEQ_NBR   = :IMBKPO-PO-BKG-SEQ-NBR     50690099
450200*        END-EXEC                                                 50700099
450300                                                                  50710099
450400*        EVALUATE TRUE                                            50720099
450500*            WHEN SQLCODE = ZERO                                  50730099
450600*                SET PS-TIMBKUP-ROW-IS-THERE            TO TRUE   50740099
450700*                                                                 50750099
450800*            WHEN SQLCODE = +100                                  50760099
450900*                SET PS-TIMBKUP-ROW-IS-THERE-NO         TO TRUE   50770099
451000*                                                                 50780099
451100*            WHEN SQLWARN0 NOT EQUAL SPACE                        50790099
451200*            WHEN SQLCODE NOT EQUAL ZERO                          50800099
451300*                DISPLAY '**************************************' 50810099
451400*                DISPLAY '** ABEND                            **' 50820099
451500*                DISPLAY '** PROGRAM = TRKUP205               **' 50830099
451600*                DISPLAY '** PARAGRAPH = 7200-SELECT-TIMBKUP  **' 50840099
451700*                DISPLAY '** SELECT TIMBKUP                   **' 50850099
451800*                DISPLAY '** PO NUMBER    = '                     50860099
451900*                DISPLAY            TR024-EDLUPC-PO-NBR           50870099
452000*                DISPLAY '** VENDOR STYLE = '                     50880099
452100*                DISPLAY            TR024-EDLUPC-VS-NBR           50890099
452200*                DISPLAY '** UPC NUMBER   = '                     50900099
452300*                DISPLAY            TR024-EDLUPC-UPC-NBR          50910099
452400*                DISPLAY '** EXTL REF NBR = '                     50920099
452500*                DISPLAY            TR024-EDLUPC-EXTL-REF-NBR     50930099
452600*                DISPLAY '**************************************' 50940099
452700*                PERFORM 9100-SQL-ABEND                           50950099
452800*        END-EVALUATE                                             50960099
452900*    END-PERFORM.                                                 50970099
453000                                                                  50980099
453100*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    50990099
453200*        (SQLCODE NOT = ZERO AND                                  51000099
453300*            SQLCODE NOT = +100)                                  51010099
453400*        DISPLAY '****************************************'       51020099
453500*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       51030099
453600*        DISPLAY '** SELECT FROM TIMBKUP                **'       51040099
453700*        DISPLAY '** PARAGRAPH = 7200-SELECT-TIMBKUP    **'       51050099
453800*        DISPLAY '** PO NUMBER    = ' TR024-EDLUPC-PO-NBR         51060099
453900*        DISPLAY '** VENDOR STYLE = ' TR024-EDLUPC-VS-NBR         51070099
454000*        DISPLAY '** UPC NUMBER   = ' TR024-EDLUPC-UPC-NBR        51080099
454100*        DISPLAY '** EXTL REF NBR = ' TR024-EDLUPC-EXTL-REF-NBR   51090099
454200*        DISPLAY '****************************************'       51100099
454300*        PERFORM 9100-SQL-ABEND                                   51110099
454400*    END-IF.                                                      51120099
454500                                                                  51130099
454600 EJECT                                                            51140099
454700                                                                  51150099
454800******************************************************************51160099
454900* SELECT A ROW FROM THE BOOKINGS UPC TABLE  (TIMBKUP).           *51170099
455000******************************************************************51180099
455100*7205-SELECT-TIMBKUP-CHG.                                         51190099
455200                                                                  51200099
455300*    PERFORM                                                      51210099
455400*        WITH TEST AFTER                                          51220099
455500*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     51230099
455600*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            51240099
455700*                SQLCODE = ZERO                     OR            51250099
455800*                SQLCODE = +100                                   51260099
455900*                                                                 51270099
456000*        EXEC SQL                                                 51280099
456100*            SELECT PO_NBR,                                       51290099
456200*                   PO_BKG_SEQ_NBR,                               51300099
456300*                   VS_NBR,                                       51310099
456400*                   UPC_NBR,                                      51320099
456500*                   UPC_CART_CNT,                                 51330099
456600*                   UPC_CBMT_QTY,                                 51340099
456700*                   UPC_WT_KGRM_QTY,                              51350099
456800*                   UPC_UNT_QTY,                                  51360099
456900*                   CRE_BY_USR_ID,                                51370099
457000*                   CRE_TMST,                                     51380099
457100*                   LAST_UPD_BY_USR_ID,                           51390099
457200*                   LAST_UPD_TMST                                 51400099
457300*             INTO :IMBKUP-PO-NBR,                                51410099
457400*                  :IMBKUP-PO-BKG-SEQ-NBR,                        51420099
457500*                  :IMBKUP-VS-NBR,                                51430099
457600*                  :IMBKUP-UPC-NBR,                               51440099
457700*                  :IMBKUP-UPC-CART-CNT,                          51450099
457800*                  :IMBKUP-UPC-CBMT-QTY,                          51460099
457900*                  :IMBKUP-UPC-WT-KGRM-QTY,                       51470099
458000*                  :IMBKUP-UPC-UNT-QTY,                           51480099
458100*                  :IMBKUP-CRE-BY-USR-ID,                         51490099
458200*                  :IMBKUP-CRE-TMST,                              51500099
458300*                  :IMBKUP-LAST-UPD-BY-USR-ID,                    51510099
458400*                  :IMBKUP-LAST-UPD-TMST                          51520099
458500*                                                                 51530099
458600*              FROM TIMBKUP                                       51540099
458700*             WHERE PO_NBR           = :IMBKPO-PO-NBR             51550099
458800*               AND PO_BKG_SEQ_NBR   = :IMBKPO-PO-BKG-SEQ-NBR     51560099
458900*               AND VS_NBR           = :PV-UPC-CURSOR-VS-NBR      51570099
459000*               AND UPC_NBR          = :PV-UPC-CURSOR-UPC-NBR     51580099
459100*        END-EXEC                                                 51590099
459200*                                                                 51600099
459300*        EVALUATE TRUE                                            51610099
459400*            WHEN SQLCODE = ZERO                                  51620099
459500*                CONTINUE                                         51630099
459600*                                                                 51640099
459700*            WHEN SQLCODE = +100                                  51650099
459800*                CONTINUE                                         51660099
459900*                                                                 51670099
460000*            WHEN SQLWARN0 NOT EQUAL SPACE                        51680099
460100*            WHEN SQLCODE NOT EQUAL ZERO                          51690099
460200*                DISPLAY '**************************************' 51700099
460300*                DISPLAY '** ABEND                            **' 51710099
460400*                DISPLAY '** PROGRAM = TRKUP205               **' 51720099
460500*                DISPLAY '** PARAGRAPH = 7205-SELECT-TIMBKUP-CHG' 51730099
460600*                DISPLAY '** SELECT TIMBKUP                   **' 51740099
460700*                DISPLAY '** PO NUMBER   = ' IMBKPO-PO-NBR        51750099
460800*                DISPLAY '** BKG SEQ NBR = ' IMBKPO-PO-BKG-SEQ-NBR51760099
460900*                DISPLAY '** VENDOR STYLE= ' PV-UPC-CURSOR-VS-NBR 51770099
461000*                DISPLAY '** UPC NUMBER  = ' PV-UPC-CURSOR-UPC-NBR51780099
461100*                DISPLAY '**************************************' 51790099
461200*                PERFORM 9100-SQL-ABEND                           51800099
461300*        END-EVALUATE                                             51810099
461400*    END-PERFORM.                                                 51820099
461500                                                                  51830099
461600*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    51840099
461700*        (SQLCODE NOT = ZERO AND                                  51850099
461800*            SQLCODE NOT = +100)                                  51860099
461900*        DISPLAY '****************************************'       51870099
462000*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       51880099
462100*        DISPLAY '** SELECT FROM TIMBKUP                **'       51890099
462200*        DISPLAY '** PARAGRAPH = 7205-SELECT-TIMBKUP-CHG**'       51900099
462300*        DISPLAY '** PO NUMBER   = ' IMBKPO-PO-NBR                51910099
462400*        DISPLAY '** BKG SEQ NBR = ' IMBKPO-PO-BKG-SEQ-NBR        51920099
462500*        DISPLAY '** VENDOR STYLE= ' PV-UPC-CURSOR-VS-NBR         51930099
462600*        DISPLAY '** UPC NUMBER  = ' PV-UPC-CURSOR-UPC-NBR        51940099
462700*        DISPLAY '****************************************'       51950099
462800*        PERFORM 9100-SQL-ABEND                                   51960099
462900*    END-IF.                                                      51970099
463000                                                                  51980099
463100 EJECT                                                            51990099
463200                                                                  52000099
463300******************************************************************52010099
463400* INSERT A ROW INTO THE BOOKINGS UPC TABLE  (TIMBKUP).           *52020099
463500******************************************************************52030099
463600*7210-INSERT-TIMBKUP.                                             52040099
463700                                                                  52050099
463800*    PERFORM                                                      52060099
463900*        WITH TEST AFTER                                          52070099
464000*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     52080099
464100*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            52090099
464200*                SQLCODE = ZERO                     OR            52100099
464300*                SQLCODE = -803                                   52110099
464400*                                                                 52120099
464500*        EXEC SQL                                                 52130099
464600*            INSERT INTO TIMBKUP                                  52140099
464700*                  (PO_NBR,                                       52150099
464800*                   PO_BKG_SEQ_NBR,                               52160099
464900*                   VS_NBR,                                       52170099
465000*                   UPC_NBR,                                      52180099
465100*                   UPC_CART_CNT,                                 52190099
465200*                   UPC_CBMT_QTY,                                 52200099
465300*                   UPC_WT_KGRM_QTY,                              52210099
465400*                   UPC_UNT_QTY,                                  52220099
465500*                   CRE_BY_USR_ID,                                52230099
465600*                   CRE_TMST,                                     52240099
465700*                   LAST_UPD_BY_USR_ID,                           52250099
465800*                   LAST_UPD_TMST)                                52260099
465900*          VALUES (:IMBKUP-PO-NBR,                                52270099
466000*                  :IMBKUP-PO-BKG-SEQ-NBR,                        52280099
466100*                  :IMBKUP-VS-NBR,                                52290099
466200*                  :IMBKUP-UPC-NBR,                               52300099
466300*                  :IMBKUP-UPC-CART-CNT,                          52310099
466400*                  :IMBKUP-UPC-CBMT-QTY,                          52320099
466500*                  :IMBKUP-UPC-WT-KGRM-QTY,                       52330099
466600*                  :IMBKUP-UPC-UNT-QTY,                           52340099
466700*                  :IMBKUP-CRE-BY-USR-ID,                         52350099
466800*                  :IMBKUP-CRE-TMST,                              52360099
466900*                  :IMBKUP-LAST-UPD-BY-USR-ID,                    52370099
467000*                  :IMBKUP-LAST-UPD-TMST)                         52380099
467100*                                                                 52390099
467200*        END-EXEC                                                 52400099
467300*                                                                 52410099
467400*        EVALUATE TRUE                                            52420099
467500*            WHEN SQLCODE = ZERO                                  52430099
467600*                ADD +1                 TO PA-TOT-BKUPC-INSERTS   52440099
467700*                ADD +1                 TO PA-TOT-RECS-INSERTED   52450099
467800*                MOVE PC-D              TO TR201-RPT-TYP          52460099
467900*                SET PS-GOOD-BKUPC-INSERT TO TRUE                 52470099
468000*                                                                 52480099
468100*            WHEN SQLCODE = -803                                  52490099
468200*                SET PS-UPC-EXISTS          TO TRUE               52500099
468300*                SET PS-GOOD-BKUPC-INSERT-NO TO TRUE              52510099
468400*                                                                 52520099
468500*            WHEN SQLWARN0 NOT EQUAL SPACE                        52530099
468600*            WHEN SQLCODE NOT EQUAL ZERO                          52540099
468700*                DISPLAY '**************************************' 52550099
468800*                DISPLAY '** ABEND                            **' 52560099
468900*                DISPLAY '** PROGRAM = TRKUP205               **' 52570099
469000*                DISPLAY '** PARAGRAPH = 7210-INSERT-TIMBKUP  **' 52580099
469100*                DISPLAY '** INSERT TIMBKUP                   **' 52590099
469200*                DISPLAY '** PO NUMBER    = '                     52600099
469300*                DISPLAY            TR024-EDLUPC-PO-NBR           52610099
469400*                DISPLAY '** VENDOR STYLE = '                     52620099
469500*                DISPLAY            TR024-EDLUPC-VS-NBR           52630099
469600*                DISPLAY '** UPC NUMBER   = '                     52640099
469700*                DISPLAY            TR024-EDLUPC-UPC-NBR          52650099
469800*                DISPLAY '** EXTL REF NBR = '                     52660099
469900*                DISPLAY            TR024-EDLUPC-EXTL-REF-NBR     52670099
470000*                DISPLAY '**************************************' 52680099
470100*                PERFORM 9100-SQL-ABEND                           52690099
470200*        END-EVALUATE                                             52700099
470300*    END-PERFORM.                                                 52710099
470400                                                                  52720099
470500*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    52730099
470600*        (SQLCODE NOT = ZERO AND                                  52740099
470700*            SQLCODE NOT = -803)                                  52750099
470800*        DISPLAY '****************************************'       52760099
470900*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       52770099
471000*        DISPLAY '** INSERT INTO TIMBKUP                **'       52780099
471100*        DISPLAY '** PARAGRAPH = 7210-SELECT-TIMBKUP    **'       52790099
471200*        DISPLAY '** PO NUMBER    = ' TR024-EDLUPC-PO-NBR         52800099
471300*        DISPLAY '** VENDOR STYLE = ' TR024-EDLUPC-VS-NBR         52810099
471400*        DISPLAY '** UPC NUMBER   = ' TR024-EDLUPC-UPC-NBR        52820099
471500*        DISPLAY '** EXTL REF NBR = ' TR024-EDLUPC-EXTL-REF-NBR   52830099
471600*        DISPLAY '****************************************'       52840099
471700*        PERFORM 9100-SQL-ABEND                                   52850099
471800*    END-IF.                                                      52860099
471900                                                                  52870099
472000 EJECT                                                            52880099
472100                                                                  52890099
472200******************************************************************52900099
472300* DETERMINE THE RECORD TYPE PRIOR TO INSERTING THE DETAIL LINE   *52910099
472400* INTO THE WORKTABLE (TOUTTR6).                                  *52920099
472500* THE RECORD TYPES ARE EDD (1), EDDRSN (2), EDL (3)              *52930099
472600* THE PV-HOLD-EDD-ADD-SEQ-NBR AND PV-HOLD-EDDRSN-ADD-SEQ-NBR AND *52940099
472700* THE PV-HOLD-EDL-ADD-SEQ-NBR FIELDS ARE INITIALIZED IN P. 2000- *52950099
472800* FIELD MOVES UNIQUE TO EACH RECORD TYPE ARE PERFORMED,          *52960099
472900* 7300-INSERT-TOUTTR6-RPT IS PERFORMED TO PRODUCE A DETAIL LINE  *52970099
473000* FOR EACH RECORD TYPE.                                          *52980099
473100* FIELD: TR201-RPT-TYP ALREADY CONTAINS A 'D'.                   *52990099
473200******************************************************************53000099
473300 7280-EDD-EDDRSN-EDL-DETAIL.                                      53010099
473400                                                                  53020099
473500     INITIALIZE TR201-RECORD.                                     53030099
473600     INITIALIZE TR201-REC-TYP-EDD.                                53040099
473700                                                                  53050099
473800     MOVE PV-HOLD-PROCESS-SEQ-NBR-EDD          TO                 53060099
473900           TR201-PROCESS-SEQ-NBR.                                 53070099
474000                                                                  53080099
474100     IF PS-CHANGE-ADD                                             53090099
474200         MOVE PC-B               TO TR201-TRN-TYP                 53100099
474300     ELSE                                                         53110099
474400         MOVE TR024-EDD-TRN-TYP  TO TR201-TRN-TYP                 53120099
474500     END-IF.                                                      53130099
474600                                                                  53140099
474700     MOVE PV-REC-TYP-EDD                       TO                 53150099
474800           TR201-REC-TYP-EDD-CDE.                                 53160099
474900                                                                  53170099
475000     IF TR024-EDL-PO-NBR NUMERIC                                  53180099
475100         MOVE TR024-EDL-PO-NBR    TO TR201-PO-NBR                 53190099
475200     ELSE                                                         53200099
475300         MOVE TR024-EDL-PO-NBR-X  TO TR201-PO-NBR-X               53210099
475400     END-IF.                                                      53220099
475500                                                                  53230099
475600     MOVE TR024-EDL-EXTL-REF-NBR               TO                 53240099
475700           TR201-EXTL-REF-NBR.                                    53250099
475800     MOVE TR024-EDL-PO-BKG-DELY-DTE            TO                 53260099
475900           TR201-PO-BKG-DELY-DTE.                                 53270099
476000     MOVE TR024-EDL-PO-BKG-DELY-TM             TO                 53280099
476100           TR201-PO-BKG-DELY-TM.                                  53290099
476200     MOVE TR024-EDL-ORGN-SHPD-FR-CDE           TO                 53300099
476300           TR201-ORGN-SHPD-FR-CDE.                                53310099
476400     MOVE IMBKPO-IMPRT-TRIP-ID                 TO                 53320099
476500           TR201-EDD-IMPRT-TRIP-ID.                               53330099
476600     MOVE IMBKPO-CARR-SCAC-ID                  TO                 53340099
476700           TR201-EDD-CARR-SCAC-ID.                                53350099
476800     MOVE IMBKPO-IMPRT-VEH-NM                  TO                 53360099
476900           TR201-EDD-IMPRT-VEH-NM.                                53370099
477000     MOVE IMBKPO-POE-DELY-TMST (1:4)           TO                 53380099
477100           TR201-EDD-POE-DELY-DTE (1:4).                          53390099
477200     MOVE IMBKPO-POE-DELY-TMST (6:2)           TO                 53400099
477300           TR201-EDD-POE-DELY-DTE (5:2).                          53410099
477400     MOVE IMBKPO-POE-DELY-TMST (9:2)           TO                 53420099
477500           TR201-EDD-POE-DELY-DTE (7:2).                          53430099
477600     MOVE IMBKPO-POE-DELY-TMST (12:2)          TO                 53440099
477700           TR201-EDD-POE-DELY-TM (1:2).                           53450099
477800     MOVE IMBKPO-POE-DELY-TMST (15:2)          TO                 53460099
477900           TR201-EDD-POE-DELY-TM (3:2).                           53470099
478000     MOVE IMBKPO-FOB-CDE                       TO                 53480099
478100           TR201-EDD-FOB-CDE.                                     53490099
478200     MOVE IMBKPO-DEST-POE-CDE                  TO                 53500099
478300           TR201-EDD-DEST-POE-CDE.                                53510099
478400     MOVE IMBKPO-EST-LBD-NM                    TO                 53520099
478500           TR201-EDD-EST-LBD-NM.                                  53530099
478600     MOVE IMBKPO-TRIP-TYP-CDE                  TO                 53540099
478700           TR201-EDD-TRIP-TYP-CDE.                                53550099
478800     MOVE IMBKPO-DPRTR-TMST (1:4)              TO                 53560099
478900           TR201-EDD-DPRTR-DTE (1:4).                             53570099
479000     MOVE IMBKPO-DPRTR-TMST (6:2)              TO                 53580099
479100           TR201-EDD-DPRTR-DTE (5:2).                             53590099
479200     MOVE IMBKPO-DPRTR-TMST (9:2)              TO                 53600099
479300           TR201-EDD-DPRTR-DTE (7:2).                             53610099
479400     MOVE IMBKPO-DPRTR-TMST (12:2)             TO                 53620099
479500           TR201-EDD-DPRTR-TM (1:2).                              53630099
479600     MOVE IMBKPO-DPRTR-TMST (15:2)             TO                 53640099
479700           TR201-EDD-DPRTR-TM (3:2).                              53650099
479800     MOVE PC-D                                 TO                 53660099
479900         TR201-RPT-TYP.                                           53670099
480000                                                                  53680099
480100     PERFORM 7300-INSERT-TOUTTR6-RPT.                             53690099
480200                                                                  53700099
480300     IF PV-HOLD-PROCESS-SEQ-NBR-EDDRSN = ZERO                     53710099
480400          CONTINUE                                                53720099
480500     ELSE                                                         53730099
480600          INITIALIZE TR201-RECORD                                 53740099
480700          INITIALIZE TR201-REC-TYP-EDDRSN                         53750099
480800          MOVE PV-HOLD-PROCESS-SEQ-NBR-EDDRSN TO                  53760099
480900                TR201-PROCESS-SEQ-NBR                             53770099
481000                                                                  53780099
481100          IF PS-CHANGE-ADD                                        53790099
481200              MOVE PC-B               TO TR201-TRN-TYP            53800099
481300          ELSE                                                    53810099
481400              MOVE TR024-EDL-TRN-TYP  TO TR201-TRN-TYP            53820099
481500          END-IF                                                  53830099
481600                                                                  53840099
481700          MOVE PV-REC-TYP-EDDRSN                    TO            53850099
481800                TR201-REC-TYP-EDDRSN-CDE                          53860099
481900                                                                  53870099
482000          IF TR024-EDL-PO-NBR NUMERIC                             53880099
482100              MOVE TR024-EDL-PO-NBR    TO TR201-PO-NBR            53890099
482200          ELSE                                                    53900099
482300              MOVE TR024-EDL-PO-NBR-X  TO TR201-PO-NBR-X          53910099
482400          END-IF                                                  53920099
482500                                                                  53930099
482600          MOVE TR024-EDL-EXTL-REF-NBR               TO            53940099
482700                TR201-EXTL-REF-NBR                                53950099
482800          MOVE TR024-EDL-PO-BKG-DELY-DTE            TO            53960099
482900                TR201-PO-BKG-DELY-DTE                             53970099
483000          MOVE TR024-EDL-PO-BKG-DELY-TM             TO            53980099
483100                TR201-PO-BKG-DELY-TM                              53990099
483200          MOVE TR024-EDL-ORGN-SHPD-FR-CDE           TO            54000099
483300                TR201-ORGN-SHPD-FR-CDE                            54010099
483400          MOVE IMBKPO-IMPRT-TRIP-ID                 TO            54020099
483500                TR201-EDDRSN-IMPRT-TRIP-ID                        54030099
483600          MOVE IMBKPO-CARR-SCAC-ID                  TO            54040099
483700                TR201-EDDRSN-CARR-SCAC-ID                         54050099
483800          MOVE IMBKPO-POE-DELY-TMST (1:4)           TO            54060099
483900                TR201-EDDRSN-POE-DELY-DTE (1:4)                   54070099
484000          MOVE IMBKPO-POE-DELY-TMST (6:2)           TO            54080099
484100                TR201-EDDRSN-POE-DELY-DTE (5:2)                   54090099
484200          MOVE IMBKPO-POE-DELY-TMST (9:2)           TO            54100099
484300                TR201-EDDRSN-POE-DELY-DTE (7:2)                   54110099
484400          MOVE IMBKPO-POE-DELY-TMST (12:2)          TO            54120099
484500                TR201-EDDRSN-POE-DELY-TM (1:2)                    54130099
484600          MOVE IMBKPO-POE-DELY-TMST (15:2)          TO            54140099
484700                TR201-EDDRSN-POE-DELY-TM (3:2)                    54150099
484800          MOVE IMBKPO-VOY-CHG-RSN-DESC              TO            54160099
484900                TR201-EDDRSN-VOY-CHG-RSN-DESC                     54170099
485000          MOVE IMBKPO-DPRTR-TMST (1:4)              TO            54180099
485100                TR201-EDDRSN-DPRTR-DTE (1:4)                      54190099
485200          MOVE IMBKPO-DPRTR-TMST (6:2)              TO            54200099
485300                TR201-EDDRSN-DPRTR-DTE (5:2)                      54210099
485400          MOVE IMBKPO-DPRTR-TMST (9:2)              TO            54220099
485500                TR201-EDDRSN-DPRTR-DTE (7:2)                      54230099
485600          MOVE IMBKPO-DPRTR-TMST (12:2)             TO            54240099
485700                TR201-EDDRSN-DPRTR-TM (1:2)                       54250099
485800          MOVE IMBKPO-DPRTR-TMST (15:2)             TO            54260099
485900                TR201-EDDRSN-DPRTR-TM (3:2)                       54270099
486000          MOVE PC-D                                 TO            54280099
486100             TR201-RPT-TYP                                        54290099
486200          PERFORM 7300-INSERT-TOUTTR6-RPT                         54300099
486300     END-IF.                                                      54310099
486400                                                                  54320099
486500                                                                  54330099
486600     INITIALIZE TR201-RECORD.                                     54340099
486700     INITIALIZE TR201-REC-TYP-EDL.                                54350099
486800                                                                  54360099
486900     MOVE PV-HOLD-PROCESS-SEQ-NBR-EDL          TO                 54370099
487000           TR201-PROCESS-SEQ-NBR.                                 54380099
487100                                                                  54390099
487200     IF PS-CHANGE-ADD                                             54400099
487300         MOVE PC-B               TO TR201-TRN-TYP                 54410099
487400     ELSE                                                         54420099
487500         MOVE TR024-EDL-TRN-TYP  TO TR201-TRN-TYP                 54430099
487600     END-IF.                                                      54440099
487700                                                                  54450099
487800     MOVE TR024-EDL-REC-TYP-CDE                TO                 54460099
487900           TR201-REC-TYP-EDL-CDE.                                 54470099
488000                                                                  54480099
488100     IF TR024-EDL-PO-NBR NUMERIC                                  54490099
488200         MOVE TR024-EDL-PO-NBR    TO TR201-PO-NBR                 54500099
488300     ELSE                                                         54510099
488400         MOVE TR024-EDL-PO-NBR-X  TO TR201-PO-NBR-X               54520099
488500     END-IF.                                                      54530099
488600                                                                  54540099
488700     MOVE TR024-EDL-EXTL-REF-NBR               TO                 54550099
488800           TR201-EXTL-REF-NBR.                                    54560099
488900     MOVE TR024-EDL-PO-BKG-DELY-DTE            TO                 54570099
489000           TR201-PO-BKG-DELY-DTE.                                 54580099
489100     MOVE TR024-EDL-PO-BKG-DELY-TM             TO                 54590099
489200           TR201-PO-BKG-DELY-TM.                                  54600099
489300     MOVE TR024-EDL-ORGN-SHPD-FR-CDE           TO                 54610099
489400           TR201-ORGN-SHPD-FR-CDE.                                54620099
489500                                                                  54630099
489600     IF TR024-EDL-PO-CART-CNT NUMERIC                             54640099
489700         MOVE TR024-EDL-PO-CART-CNT   TO TR201-EDL-PO-CART-CNT    54650099
489800     ELSE                                                         54660099
489900         MOVE TR024-EDL-PO-CART-CNT-X TO TR201-EDL-PO-CART-CNT-X  54670099
490000     END-IF.                                                      54680099
490100                                                                  54690099
490200     IF TR024-EDL-PO-UNT-QTY NUMERIC                              54700099
490300         MOVE TR024-EDL-PO-UNT-QTY    TO TR201-EDL-PO-UNT-QTY     54710099
490400     ELSE                                                         54720099
490500         MOVE TR024-EDL-PO-UNT-QTY-X  TO TR201-EDL-PO-UNT-QTY-X   54730099
490600     END-IF.                                                      54740099
490700                                                                  54750099
490800     IF TR024-EDL-PO-CBMT-QTY NUMERIC                             54760099
490900         MOVE TR024-EDL-PO-CBMT-QTY   TO TR201-EDL-PO-CBMT-QTY    54770099
491000     ELSE                                                         54780099
491100         MOVE TR024-EDL-PO-CBMT-QTY-X TO TR201-EDL-PO-CBMT-QTY-X  54790099
491200     END-IF.                                                      54800099
491300                                                                  54810099
491400     IF TR024-EDL-PO-WT-KGRM-QTY NUMERIC                          54820099
491500         MOVE TR024-EDL-PO-WT-KGRM-QTY    TO                      54830099
491600               TR201-EDL-PO-WT-KGRM-QTY                           54840099
491700     ELSE                                                         54850099
491800         MOVE TR024-EDL-PO-WT-KGRM-QTY-X  TO                      54860099
491900               TR201-EDL-PO-WT-KGRM-QTY-X                         54870099
492000     END-IF.                                                      54880099
492100                                                                  54890099
492200     MOVE TR024-EDL-PROD-FCTRY-NM              TO                 54900099
492300           TR201-EDL-PROD-FCTRY-NM.                               54910099
492400     MOVE TR024-EDL-C-O-PROD-CDE               TO                 54920099
492500           TR201-EDL-C-O-PROD-CDE.                                54930099
492600     MOVE TR024-EDL-CONSOL-SCAC-ID             TO                 54940099
492700           TR201-EDL-CONSOL-SCAC-ID.                              54950099
492800     MOVE PC-D                                 TO                 54960099
492900         TR201-RPT-TYP.                                           54970099
493000                                                                  54980099
493100     PERFORM 7300-INSERT-TOUTTR6-RPT.                             54990099
493200                                                                  55000099
493300 EJECT                                                            55010099
493400                                                                  55020099
493500******************************************************************55030099
493600* MOVE TIMBKPO DCLGEN FIELDS TO DETAIL LINE PRIOR TO INSERTING   *55040099
493700* INTO THE WORKTABLE (TOUTTR6).                                  *55050099
493800******************************************************************55060099
493900 7282-TIMBKPO-DCLGEN-TO-DETAIL.                                   55070099
494000                                                                  55080099
494100     INITIALIZE TR201-RECORD.                                     55090099
494200     INITIALIZE TR201-REC-TYP-EDD.                                55100099
494300                                                                  55110099
494400     MOVE PV-SEQ-NBR-EDD                TO TR201-PROCESS-SEQ-NBR. 55120099
494500     MOVE PV-HOLD-TR024-TRN-TYP         TO TR201-TRN-TYP.         55130099
494600     MOVE PV-REC-TYP-EDD                TO TR201-REC-TYP-EDD-CDE. 55140099
494700     MOVE PV-HOLD-TR024-PO-NBR          TO TR201-PO-NBR.          55150099
494800     MOVE PV-HOLD-TR024-EXTL-REF-NBR    TO TR201-EXTL-REF-NBR.    55160099
494900     MOVE PV-HOLD-TR024-PO-BKG-DELY-DTE TO TR201-PO-BKG-DELY-DTE. 55170099
495000     MOVE PV-HOLD-TR024-PO-BKG-DELY-TM  TO TR201-PO-BKG-DELY-TM.  55180099
495100     MOVE PV-HOLD-ORGN-SHPD-FR-CDE      TO                        55190099
495200                                        TR201-ORGN-SHPD-FR-CDE.   55200099
495300     MOVE PC-D                          TO TR201-RPT-TYP.         55210099
495400                                                                  55220099
495500     MOVE IMBKPO-IMPRT-TRIP-ID        TO TR201-EDD-IMPRT-TRIP-ID. 55230099
495600     MOVE IMBKPO-CARR-SCAC-ID         TO TR201-EDD-CARR-SCAC-ID.  55240099
495700     MOVE IMBKPO-IMPRT-VEH-NM         TO TR201-EDD-IMPRT-VEH-NM.  55250099
495800                                                                  55260099
495900     MOVE IMBKPO-POE-DELY-TMST (1:4)    TO                        55270099
496000           TR201-EDD-POE-DELY-DTE (1:4).                          55280099
496100     MOVE IMBKPO-POE-DELY-TMST (6:2)    TO                        55290099
496200           TR201-EDD-POE-DELY-DTE (5:2).                          55300099
496300     MOVE IMBKPO-POE-DELY-TMST (9:2)    TO                        55310099
496400           TR201-EDD-POE-DELY-DTE (7:2).                          55320099
496500     MOVE IMBKPO-POE-DELY-TMST (12:2)   TO                        55330099
496600           TR201-EDD-POE-DELY-TM (1:2).                           55340099
496700     MOVE IMBKPO-POE-DELY-TMST (15:2)   TO                        55350099
496800           TR201-EDD-POE-DELY-TM (3:2).                           55360099
496900                                                                  55370099
497000     MOVE IMBKPO-FOB-CDE                TO TR201-EDD-FOB-CDE.     55380099
497100     MOVE IMBKPO-DEST-POE-CDE           TO TR201-EDD-DEST-POE-CDE.55390099
497200     MOVE IMBKPO-EST-LBD-NM             TO TR201-EDD-EST-LBD-NM.  55400099
497300     MOVE IMBKPO-TRIP-TYP-CDE           TO TR201-EDD-TRIP-TYP-CDE.55410099
497400                                                                  55420099
497500     MOVE IMBKPO-DPRTR-TMST (1:4)       TO                        55430099
497600           TR201-EDD-DPRTR-DTE (1:4).                             55440099
497700     MOVE IMBKPO-DPRTR-TMST (6:2)       TO                        55450099
497800           TR201-EDD-DPRTR-DTE (5:2).                             55460099
497900     MOVE IMBKPO-DPRTR-TMST (9:2)       TO                        55470099
498000           TR201-EDD-DPRTR-DTE (7:2).                             55480099
498100     MOVE IMBKPO-DPRTR-TMST (12:2)      TO                        55490099
498200           TR201-EDD-DPRTR-TM (1:2).                              55500099
498300     MOVE IMBKPO-DPRTR-TMST (15:2)      TO                        55510099
498400           TR201-EDD-DPRTR-TM (3:2).                              55520099
498500                                                                  55530099
498600     PERFORM 7300-INSERT-TOUTTR6-RPT.                             55540099
498700                                                                  55550099
498800     IF PV-SEQ-NBR-EDDRSN = ZERO                                  55560099
498900          CONTINUE                                                55570099
499000     ELSE                                                         55580099
499100          INITIALIZE TR201-RECORD                                 55590099
499200          INITIALIZE TR201-REC-TYP-EDDRSN                         55600099
499300          MOVE PV-SEQ-NBR-EDDRSN     TO TR201-PROCESS-SEQ-NBR     55610099
499400          MOVE PV-HOLD-TR024-TRN-TYP TO TR201-TRN-TYP             55620099
499500          MOVE PV-REC-TYP-EDDRSN     TO TR201-REC-TYP-EDDRSN-CDE  55630099
499600          MOVE PV-HOLD-TR024-PO-NBR  TO TR201-PO-NBR              55640099
499700          MOVE PV-HOLD-TR024-EXTL-REF-NBR TO TR201-EXTL-REF-NBR   55650099
499800          MOVE PV-HOLD-TR024-PO-BKG-DELY-DTE TO                   55660099
499900                              TR201-PO-BKG-DELY-DTE               55670099
500000          MOVE PV-HOLD-TR024-PO-BKG-DELY-TM  TO                   55680099
500100                              TR201-PO-BKG-DELY-TM                55690099
500200          MOVE PV-HOLD-ORGN-SHPD-FR-CDE             TO            55700099
500300                              TR201-ORGN-SHPD-FR-CDE              55710099
500400          MOVE PC-D                  TO TR201-RPT-TYP             55720099
500500                                                                  55730099
500600          MOVE IMBKPO-IMPRT-TRIP-ID TO TR201-EDDRSN-IMPRT-TRIP-ID 55740099
500700          MOVE IMBKPO-CARR-SCAC-ID  TO TR201-EDDRSN-CARR-SCAC-ID  55750099
500800                                                                  55760099
500900          MOVE IMBKPO-POE-DELY-TMST (1:4)           TO            55770099
501000                TR201-EDDRSN-POE-DELY-DTE (1:4)                   55780099
501100          MOVE IMBKPO-POE-DELY-TMST (6:2)           TO            55790099
501200                TR201-EDDRSN-POE-DELY-DTE (5:2)                   55800099
501300          MOVE IMBKPO-POE-DELY-TMST (9:2)           TO            55810099
501400                TR201-EDDRSN-POE-DELY-DTE (7:2)                   55820099
501500          MOVE IMBKPO-POE-DELY-TMST (12:2)           TO           55830099
501600                TR201-EDDRSN-POE-DELY-TM (1:2)                    55840099
501700          MOVE IMBKPO-POE-DELY-TMST (15:2)           TO           55850099
501800                TR201-EDDRSN-POE-DELY-TM (3:2)                    55860099
501900          MOVE IMBKPO-VOY-CHG-RSN-DESC              TO            55870099
502000                TR201-EDDRSN-VOY-CHG-RSN-DESC                     55880099
502100          MOVE IMBKPO-DPRTR-TMST (1:4)              TO            55890099
502200                TR201-EDDRSN-DPRTR-DTE (1:4)                      55900099
502300          MOVE IMBKPO-DPRTR-TMST (6:2)              TO            55910099
502400                TR201-EDDRSN-DPRTR-DTE (5:2)                      55920099
502500          MOVE IMBKPO-DPRTR-TMST (9:2)              TO            55930099
502600                TR201-EDDRSN-DPRTR-DTE (7:2)                      55940099
502700          MOVE IMBKPO-DPRTR-TMST (12:2)             TO            55950099
502800                TR201-EDDRSN-DPRTR-TM (1:2)                       55960099
502900          MOVE IMBKPO-DPRTR-TMST (15:2)             TO            55970099
503000                TR201-EDDRSN-DPRTR-TM (3:2)                       55980099
503100          PERFORM 7300-INSERT-TOUTTR6-RPT                         55990099
503200     END-IF.                                                      56000099
503300                                                                  56010099
503400                                                                  56020099
503500     INITIALIZE TR201-RECORD.                                     56030099
503600     INITIALIZE TR201-REC-TYP-EDL.                                56040099
503700                                                                  56050099
503800     MOVE PV-SEQ-NBR-EDL              TO TR201-PROCESS-SEQ-NBR.   56060099
503900     MOVE PV-HOLD-TR024-TRN-TYP       TO TR201-TRN-TYP.           56070099
504000     MOVE PV-REC-TYP-EDL              TO TR201-REC-TYP-EDL-CDE.   56080099
504100     MOVE PV-HOLD-TR024-PO-NBR        TO TR201-PO-NBR.            56090099
504200     MOVE PV-HOLD-TR024-EXTL-REF-NBR  TO TR201-EXTL-REF-NBR.      56100099
504300     MOVE PV-HOLD-TR024-PO-BKG-DELY-DTE TO                        56110099
504400                              TR201-PO-BKG-DELY-DTE.              56120099
504500     MOVE PV-HOLD-TR024-PO-BKG-DELY-TM  TO                        56130099
504600                           TR201-PO-BKG-DELY-TM.                  56140099
504700     MOVE PV-HOLD-ORGN-SHPD-FR-CDE    TO                          56150099
504800                           TR201-ORGN-SHPD-FR-CDE.                56160099
504900     MOVE PC-D                        TO TR201-RPT-TYP.           56170099
505000                                                                  56180099
505100     MOVE IMBKPO-PO-CART-CNT          TO TR201-EDL-PO-CART-CNT.   56190099
505200     MOVE IMBKPO-PO-UNT-QTY           TO TR201-EDL-PO-UNT-QTY.    56200099
505300     MOVE IMBKPO-PROD-FCTRY-NM        TO TR201-EDL-PROD-FCTRY-NM. 56210099
505400     MOVE IMBKPO-C-O-PROD-CDE         TO TR201-EDL-C-O-PROD-CDE.  56220099
505500     MOVE IMBKPO-PO-CBMT-QTY          TO TR201-EDL-PO-CBMT-QTY.   56230099
505600     MOVE IMBKPO-PO-WT-KGRM-QTY       TO TR201-EDL-PO-WT-KGRM-QTY.56240099
505700     MOVE IMBKPO-ORGN-SHPD-FR-CDE     TO                          56250099
505800                                      TR201-ORGN-SHPD-FR-CDE.     56260099
505900     MOVE IMBKPO-CONSLR-SCAC-ID       TO TR201-EDL-CONSOL-SCAC-ID.56270099
506000                                                                  56280099
506100     PERFORM 7300-INSERT-TOUTTR6-RPT.                             56290099
506200                                                                  56300099
506300 EJECT                                                            56310099
506400                                                                  56320099
506500******************************************************************56330099
506600* MAKE FIELD MOVES PRIOR TO INSERTING TO THE WORK TABLE (TOUTTR6).56340099
506700******************************************************************56350099
506800*7285-PREP-DETAIL-TOUTTR6-VS.                                     56360099
506900                                                                  56370099
507000*    INITIALIZE TR201-RECORD                                      56380099
507100*    INITIALIZE TR201-REC-TYP-EDLVS                               56390099
507200                                                                  56400099
507300*    MOVE TR024-EDD-PROCESS-SEQ-NBR    TO                         56410099
507400*               TR201-PROCESS-SEQ-NBR.                            56420099
507500                                                                  56430099
507600*    IF PS-CHANGE-ADD                                             56440099
507700*        MOVE PC-B                   TO TR201-TRN-TYP             56450099
507800*    ELSE                                                         56460099
507900*        IF PS-CHANGE-ADD-VS-OR-UPC                               56470099
508000*            MOVE PC-Z               TO TR201-TRN-TYP             56480099
508100*        ELSE                                                     56490099
508200*            MOVE TR024-EDD-TRN-TYP  TO TR201-TRN-TYP             56500099
508300*        END-IF                                                   56510099
508400*    END-IF.                                                      56520099
508500                                                                  56530099
508600*    MOVE TR024-EDD-REC-TYP-CDE   TO TR201-REC-TYP-EDLVS-CDE.     56540099
508700                                                                  56550099
508800*    IF TR024-EDD-PO-NBR NUMERIC                                  56560099
508900*        MOVE TR024-EDD-PO-NBR    TO TR201-PO-NBR                 56570099
509000*    ELSE                                                         56580099
509100*        MOVE TR024-EDD-PO-NBR-X  TO TR201-PO-NBR-X               56590099
509200*    END-IF.                                                      56600099
509300                                                                  56610099
509400*    MOVE TR024-EDD-EXTL-REF-NBR       TO                         56620099
509500*          TR201-EXTL-REF-NBR.                                    56630099
509600*    MOVE TR024-EDD-PO-BKG-DELY-DTE    TO                         56640099
509700*          TR201-PO-BKG-DELY-DTE.                                 56650099
509800*    MOVE TR024-EDD-PO-BKG-DELY-TM     TO                         56660099
509900*          TR201-PO-BKG-DELY-TM.                                  56670099
510000*    MOVE TR024-EDD-ORGN-SHPD-FR-CDE   TO                         56680099
510100*          TR201-ORGN-SHPD-FR-CDE.                                56690099
510200*    MOVE IMBKVS-VS-NBR                TO                         56700099
510300*          TR201-EDLVS-VS-NBR.                                    56710099
510400*                                                                 56720099
510500*    IF TR024-EDLVS-VS-CART-CNT NUMERIC                           56730099
510600*        MOVE TR024-EDLVS-VS-CART-CNT    TO                       56740099
510700*              TR201-EDLVS-VS-CART-CNT                            56750099
510800*    ELSE                                                         56760099
510900*        MOVE TR024-EDLVS-VS-CART-CNT-X  TO                       56770099
511000*              TR201-EDLVS-VS-CART-CNT-X                          56780099
511100*    END-IF.                                                      56790099
511200*                                                                 56800099
511300*    IF TR024-EDLVS-VS-UNT-QTY NUMERIC                            56810099
511400*        MOVE TR024-EDLVS-VS-UNT-QTY  TO TR201-EDLVS-VS-UNT-QTY   56820099
511500*    ELSE                                                         56830099
511600*        MOVE TR024-EDLVS-VS-UNT-QTY-X  TO                        56840099
511700*              TR201-EDLVS-VS-UNT-QTY-X                           56850099
511800*    END-IF.                                                      56860099
511900*                                                                 56870099
512000*    IF TR024-EDLVS-VS-CBMT-QTY NUMERIC                           56880099
512100*        MOVE TR024-EDLVS-VS-CBMT-QTY   TO                        56890099
512200*              TR201-EDLVS-VS-CBMT-QTY                            56900099
512300*    ELSE                                                         56910099
512400*        MOVE TR024-EDLVS-VS-CBMT-QTY-X TO                        56920099
512500*              TR201-EDLVS-VS-CBMT-QTY-X                          56930099
512600*    END-IF.                                                      56940099
512700*                                                                 56950099
512800*    IF TR024-EDLVS-VS-WT-KGRM-QTY NUMERIC                        56960099
512900*        MOVE TR024-EDLVS-VS-WT-KGRM-QTY    TO                    56970099
513000*              TR201-EDLVS-VS-WT-KGRM-QTY                         56980099
513100*    ELSE                                                         56990099
513200*        MOVE TR024-EDLVS-VS-WT-KGRM-QTY-X  TO                    57000099
513300*              TR201-EDLVS-VS-WT-KGRM-QTY-X                       57010099
513400*    END-IF.                                                      57020099
513500*                                                                 57030099
513600*    MOVE PC-D       TO TR201-RPT-TYP.                            57040099
513700*                                                                 57050099
513800*    PERFORM 7300-INSERT-TOUTTR6-RPT.                             57060099
513900                                                                  57070099
514000******************************************************************57080099
514100* MAKE FIELD MOVES PRIOR TO INSERTING TO THE WORK TABLE (TOUTTR6).57090099
514200******************************************************************57100099
514300*7290-PREP-DETAIL-TOUTTR6-UPC.                                    57110099
514400*                                                                 57120099
514500*         INITIALIZE TR201-RECORD.                                57130099
514600*         INITIALIZE TR201-REC-TYP-EDLUPC.                        57140099
514700*                                                                 57150099
514800*         MOVE TR024-EDD-PROCESS-SEQ-NBR            TO            57160099
514900*               TR201-PROCESS-SEQ-NBR.                            57170099
515000*                                                                 57180099
515100*         IF PS-CHANGE-ADD                                        57190099
515200*             MOVE PC-B                   TO TR201-TRN-TYP        57200099
515300*         ELSE                                                    57210099
515400*             IF PS-CHANGE-ADD-VS-OR-UPC                          57220099
515500*                 MOVE PC-Z               TO TR201-TRN-TYP        57230099
515600*             ELSE                                                57240099
515700*                 MOVE TR024-EDD-TRN-TYP  TO TR201-TRN-TYP        57250099
515800*             END-IF                                              57260099
515900*         END-IF.                                                 57270099
516000*                                                                 57280099
516100*         MOVE TR024-EDD-REC-TYP-CDE                TO            57290099
516200*               TR201-REC-TYP-EDD-CDE.                            57300099
516300*                                                                 57310099
516400*         IF TR024-EDD-PO-NBR NUMERIC                             57320099
516500*             MOVE TR024-EDD-PO-NBR                 TO            57330099
516600*                   TR201-PO-NBR                                  57340099
516700*         ELSE                                                    57350099
516800*             MOVE TR024-EDD-PO-NBR-X               TO            57360099
516900*                   TR201-PO-NBR-X                                57370099
517000*         END-IF.                                                 57380099
517100*                                                                 57390099
517200*         MOVE TR024-EDD-EXTL-REF-NBR               TO            57400099
517300*               TR201-EXTL-REF-NBR.                               57410099
517400*         MOVE TR024-EDD-PO-BKG-DELY-DTE            TO            57420099
517500*               TR201-PO-BKG-DELY-DTE.                            57430099
517600*         MOVE TR024-EDD-PO-BKG-DELY-TM             TO            57440099
517700*               TR201-PO-BKG-DELY-TM.                             57450099
517800*         MOVE TR024-EDD-ORGN-SHPD-FR-CDE           TO            57460099
517900*               TR201-ORGN-SHPD-FR-CDE.                           57470099
518000*                                                                 57480099
518100*         MOVE IMBKUP-VS-NBR                        TO            57490099
518200*               TR201-EDLUPC-VS-NBR.                              57500099
518300*         MOVE IMBKUP-UPC-NBR                       TO            57510099
518400*               TR201-EDLUPC-UPC-NBR.                             57520099
518500*                                                                 57530099
518600*         IF TR024-EDLUPC-UPC-CART-CNT NUMERIC                    57540099
518700*             MOVE TR024-EDLUPC-UPC-CART-CNT   TO                 57550099
518800*                   TR201-EDLUPC-UPC-CART-CNT                     57560099
518900*         ELSE                                                    57570099
519000*             MOVE TR024-EDLUPC-UPC-CART-CNT-X TO                 57580099
519100*                   TR201-EDLUPC-UPC-CART-CNT-X                   57590099
519200*         END-IF.                                                 57600099
519300*                                                                 57610099
519400*         IF TR024-EDLUPC-UPC-UNT-QTY NUMERIC                     57620099
519500*             MOVE TR024-EDLUPC-UPC-UNT-QTY    TO                 57630099
519600*                   TR201-EDLUPC-UPC-UNT-QTY                      57640099
519700*         ELSE                                                    57650099
519800*             MOVE TR024-EDLUPC-UPC-UNT-QTY-X  TO                 57660099
519900*                   TR201-EDLUPC-UPC-UNT-QTY-X                    57670099
520000*         END-IF.                                                 57680099
520100*                                                                 57690099
520200*         IF TR024-EDLUPC-UPC-CBMT-QTY NUMERIC                    57700099
520300*             MOVE TR024-EDLUPC-UPC-CBMT-QTY   TO                 57710099
520400*                   TR201-EDLUPC-UPC-CBMT-QTY                     57720099
520500*         ELSE                                                    57730099
520600*             MOVE TR024-EDLUPC-UPC-CBMT-QTY-X TO                 57740099
520700*                   TR201-EDLUPC-UPC-CBMT-QTY-X                   57750099
520800*         END-IF.                                                 57760099
520900*                                                                 57770099
521000*         IF TR024-EDLUPC-UPC-WT-KGRM-QTY NUMERIC                 57780099
521100*             MOVE TR024-EDLUPC-UPC-WT-KGRM-QTY   TO              57790099
521200*                   TR201-EDLUPC-UPC-WT-KGRM-QTY                  57800099
521300*         ELSE                                                    57810099
521400*             MOVE TR024-EDLUPC-UPC-WT-KGRM-QTY-X TO              57820099
521500*                   TR201-EDLUPC-UPC-WT-KGRM-QTY-X                57830099
521600*         END-IF.                                                 57840099
521700*                                                                 57850099
521800*         MOVE PC-D                                 TO            57860099
521900*             TR201-RPT-TYP.                                      57870099
522000                                                                  57880099
522100******************************************************************57890099
522200* INSERT A ROW INTO THE DB2 WORK TABLE (TOUTTR6).                *57900099
522300******************************************************************57910099
522400 7300-INSERT-TOUTTR6-RPT.                                         57920099
522500                                                                  57930099
522600     MOVE PV-HOLD-DAT-SRC-ENT-ID                                  57940099
522601                                TO TR201-DAT-SRC-ENT-ID.          57950099
522602     MOVE TR201-RECORD          TO OUTTR6-BKG-RPTS-ODR.           57960099
522700                                                                  57970099
522800     IF TR201-RPT-TYP = PC-D                                      57980099
522900        ADD +1                  TO PA-TOTAL-DETAIL-COUNT          57990099
523000        ADD +1                  TO PA-TOTAL-RECS-LOADED           58000099
523100     ELSE                                                         58010099
523200        ADD +1                  TO PA-TOTAL-ERROR-COUNT           58020099
523300        ADD +1                  TO PA-TOTAL-RECS-LOADED           58030099
523400     END-IF                                                       58040099
523500                                                                  58050099
523600       PERFORM                                                    58060099
523700         WITH TEST AFTER                                          58070099
523800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     58080099
523900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            58090099
524000                 SQLCODE = ZERO                                   58100099
524100                                                                  58110099
524200     EXEC SQL                                                     58120099
524300         INSERT INTO TOUTTR6                                      58130099
524400             (BKG_RPTS_ODR)                                       58140099
524500            VALUES  (:OUTTR6-BKG-RPTS-ODR)                        58150099
524600     END-EXEC                                                     58160099
524700                                                                  58170099
524800         EVALUATE TRUE                                            58180099
524900             WHEN SQLCODE = ZERO                                  58190099
525000                 CONTINUE                                         58200099
525100                                                                  58210099
525200             WHEN SQLWARN0 NOT EQUAL SPACE                        58220099
525300             WHEN SQLCODE NOT EQUAL ZERO                          58230099
525400                 DISPLAY '**************************************' 58240099
525500                 DISPLAY '** ABEND                            **' 58250099
525600                 DISPLAY '** PROGRAM = TRKUP205               **' 58260099
525700              DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR6-RPT **' 58270099
525800                 DISPLAY '** INSERT INTO TOUTTR6              **' 58280099
525900                 DISPLAY '*TR201-PO-NBR = '     TR024-EDD-PO-NBR  58290099
526000                 DISPLAY '*TR201-PROCESS-SEQ-NBR = '              58300099
526100                                             TR201-PROCESS-SEQ-NBR58310099
526200                 DISPLAY '**************************************' 58320099
526300                 PERFORM 9100-SQL-ABEND                           58330099
526400         END-EVALUATE                                             58340099
526500     END-PERFORM.                                                 58350099
526600                                                                  58360099
526700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58370099
526800         (SQLCODE NOT = ZERO)                                     58380099
526900        DISPLAY '****************************************'        58390099
527000        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    58400099
527100        DISPLAY '** INSERT TO TOUTTR6                      **'    58410099
527200        DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR6-RPT    **'    58420099
527300        DISPLAY '* TR024-PO-NBR     = ' TR024-EDD-PO-NBR          58430099
527400        DISPLAY '* TR024-EXTL-REF-NBR=' TR024-EDD-EXTL-REF-NBR    58440099
527500        DISPLAY '****************************************'        58450099
527600      PERFORM 9100-SQL-ABEND                                      58460099
527700     END-IF.                                                      58470099
527800                                                                  58480099
527900 EJECT                                                            58490099
528000                                                                  58500099
528100******************************************************************58510099
528200* SELECT A ROW FROM THE PURCHASE ORDER TABLE  (TPURCHS).         *58520099
528300* THIS IS A CHECK TO SEE IF A PO IS ACTIVE OR APPROVED, OR       *58530099
528400* IF A PO IS ON THE MAINFRAME SYSTEM.                            *58540099
528500******************************************************************58550099
528600 7310-SELECT-TPURCHS.                                             58560099
528700                                                                  58570099
528800     PERFORM                                                      58580099
528900         WITH TEST AFTER                                          58590099
529000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     58600099
529100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            58610099
529200                 SQLCODE = ZERO                     OR            58620099
529300                 SQLCODE = +100                                   58630099
529400                                                                  58640099
529500         EXEC SQL                                                 58650099
529600             SELECT PO_NBR,                                       58660099
529700                    STATUS_CDE,                                   58670099
529800                    IMPRT_FCTRY_ID,                               58680099
529900                    IMPRT_VND_ID                                  58690099
530000              INTO :PURCHS-PO-NBR,                                58700099
530100                   :PURCHS-STATUS-CDE,                            58710099
530200                   :PURCHS-IMPRT-FCTRY-ID,                        58720099
530300                   :PURCHS-IMPRT-VND-ID                           58730099
530400                                                                  58740099
530500               FROM TPURCHS                                       58750099
530600              WHERE PO_NBR           = :IMBKPO-PO-NBR             58760099
530700                AND VER_STATUS_CDE   = 'A'                        58770099
530800         END-EXEC                                                 58780099
530900                                                                  58790099
531000         EVALUATE TRUE                                            58800099
531100             WHEN SQLCODE = ZERO                                  58810099
531200             WHEN SQLCODE = +100                                  58820099
531300                 CONTINUE                                         58830099
531400                                                                  58840099
531500             WHEN SQLWARN0 NOT EQUAL SPACE                        58850099
531600             WHEN SQLCODE NOT EQUAL ZERO                          58860099
531700                 DISPLAY '**************************************' 58870099
531800                 DISPLAY '** ABEND                            **' 58880099
531900                 DISPLAY '** PROGRAM = TRKUP205               **' 58890099
532000                 DISPLAY '** PARAGRAPH = 7310-CHECK-PO-ON-TPURCHS'58900099
532100                 DISPLAY '** SELECT FROM TPURCHS              **' 58910099
532200                 DISPLAY '*PURCHS-PO-NUMBER = ' IMBKPO-PO-NBR     58920099
532300                 DISPLAY '*PURCHS-STATUS-CDE= ' PURCHS-STATUS-CDE 58930099
532400                 DISPLAY '**************************************' 58940099
532500                 PERFORM 9100-SQL-ABEND                           58950099
532600         END-EVALUATE                                             58960099
532700     END-PERFORM.                                                 58970099
532800                                                                  58980099
532900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58990099
533000         (SQLCODE NOT = ZERO AND                                  59000099
533100             SQLCODE NOT = +100)                                  59010099
533200         DISPLAY '****************************************'       59020099
533300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       59030099
533400         DISPLAY '** SELECT FROM TPURCHS                **'       59040099
533500         DISPLAY '** PARAGRAPH = 7310-CHECK-PO-ON-TPURCHS '       59050099
533600         DISPLAY '*PURCHS-PO-NUMBER = ' IMBKPO-PO-NBR             59060099
533700         DISPLAY '*PURCHS-STATUS-CDE= ' PURCHS-STATUS-CDE         59070099
533800         DISPLAY '****************************************'       59080099
533900         PERFORM 9100-SQL-ABEND                                   59090099
534000     END-IF.                                                      59100099
534100                                                                  59110099
534200 EJECT                                                            59120099
534300                                                                  59130099
534400******************************************************************59140099
534500* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *59150099
534600******************************************************************59160099
534700*7315-SELECT-TPURITM-FOR-PO.                                      59170099
534800                                                                  59180099
534900*    PERFORM                                                      59190099
535000*        WITH TEST AFTER                                          59200099
535100*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     59210099
535200*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            59220099
535300*                SQLCODE = ZERO                     OR            59230099
535400*                SQLCODE = +100                     OR            59240099
535500*                SQLCODE = -811                                   59250099
535600                                                                  59260099
535700*        EXEC SQL                                                 59270099
814000*            SELECT C.VS_NBR                                      59280099
814100*              INTO :XLT00004-VS-NBR                              59290099
814200*              FROM TPURITM      A                                59300099
814300*                 , XLT_SKU      B                                59310099
814301*                 , XLT_VND_STYL C                                59320099
814302*             WHERE A.PO_NBR         = :PURITM-PO-NBR             59330099
814500*               AND A.VER_STATUS_CDE = 'A'                        59340099
814600*               AND A.STATUS_CDE    IN ('AC', 'AP', 'RV')         59350099
814601*               AND A.ITM_NBR        = B.ITM_NBR                  59360099
814602*               AND B.STYL_ID        = C.STYL_ID                  59370099
814603*               AND C.VS_NBR         = :TR024-EDLVS-VS-NBR        59380099
814604*        END-EXEC                                                 59390099
814605                                                                  59400099
814606*        EVALUATE TRUE                                            59410099
814607*            WHEN SQLCODE = +0                                    59420099
814608*            WHEN SQLCODE = -811                                  59430099
814609*                SET PS-VS-ON-TPURITM        TO TRUE              59440099
814610*            WHEN SQLCODE = +100                                  59450099
814611*                SET PS-VS-ON-TPURITM-NO     TO TRUE              59460099
814612*            WHEN SQLWARN0 NOT EQUAL SPACE                        59470099
814613*            WHEN SQLCODE NOT EQUAL ZERO                          59480099
814614*                DISPLAY '**************************************' 59490099
814615*                DISPLAY '** ABEND                            **' 59500099
814616*                DISPLAY '** PROGRAM = TRKUP205               **' 59510099
814617*                DISPLAY '** PARAGRAPH = 7315-SELECT-TPURITM  **' 59520099
814618*                DISPLAY '** SELECT FROM TPURITM              **' 59530099
814619*                DISPLAY '** PO NUMBER   = ' TR024-EDLVS-PO-NBR   59540099
814620*                DISPLAY '** VS NUMBER   = ' TR024-EDLVS-VS-NBR   59550099
814621*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE    59560099
814622*                DISPLAY '**************************************' 59570099
814623*                PERFORM 9100-SQL-ABEND                           59580099
814624*        END-EVALUATE                                             59590099
814625*    END-PERFORM.                                                 59600099
814626                                                                  59610099
814627*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    59620099
814628*        (SQLCODE NOT = ZERO    AND                               59630099
814629*            SQLCODE NOT = +100 AND                               59640099
814630*            SQLCODE NOT = -811)                                  59650099
814631*        DISPLAY '****************************************'       59660099
814632*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       59670099
814633*        DISPLAY '** SELECT FROM TPURITM                **'       59680099
814634*        DISPLAY '** PARAGRAPH = 7315-SELECT-TPURITM    **'       59690099
814635*        DISPLAY '** PO NUMBER   = ' TR024-EDLVS-PO-NBR           59700099
814636*        DISPLAY '** VS NUMBER   = ' TR024-EDLVS-VS-NBR           59710099
814637*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            59720099
814638*        DISPLAY '****************************************'       59730099
814639*        PERFORM 9100-SQL-ABEND                                   59740099
814640*    END-IF.                                                      59750099
814641                                                                  59760099
814642 EJECT                                                            59770099
814643                                                                  59780099
814644******************************************************************59790099
814645* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *59800099
814646******************************************************************59810099
814647*7320-SELECT-TPURITM-FOR-VS.                                      59820099
814648                                                                  59830099
814649*    PERFORM                                                      59840099
814650*        WITH TEST AFTER                                          59850099
814651*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     59860099
814652*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            59870099
814653*                SQLCODE = ZERO                     OR            59880099
814654*                SQLCODE = +100                     OR            59890099
814655*                SQLCODE = -811                                   59900099
814656                                                                  59910099
814657*        EXEC SQL                                                 59920099
814658*            SELECT C.VS_NBR                                      59930099
814659*              INTO :XLT00004-VS-NBR                              59940099
814660*              FROM TPURITM      A                                59950099
814670*                 , XLT_SKU      B                                59960099
814671*                 , XLT_VND_STYL C                                59970099
814672*             WHERE A.PO_NBR         = :PURITM-PO-NBR             59980099
814673*               AND A.VER_STATUS_CDE = 'A'                        59990099
814674*               AND A.STATUS_CDE NOT IN ('AC', 'AP', 'RV')        60000099
814675*               AND A.ITM_NBR        = B.ITM_NBR                  60010099
814676*               AND B.STYL_ID        = C.STYL_ID                  60020099
814677*               AND C.VS_NBR         = :TR024-EDLVS-VS-NBR        60030099
814678*        END-EXEC                                                 60040099
814679                                                                  60050099
814680*        EVALUATE TRUE                                            60060099
814681*            WHEN SQLCODE = +0                                    60070099
814682*            WHEN SQLCODE = +100                                  60080099
814683*            WHEN SQLCODE = -811                                  60090099
814684*                CONTINUE                                         60100099
814685*            WHEN SQLWARN0 NOT EQUAL SPACE                        60110099
814686*            WHEN SQLCODE NOT EQUAL ZERO                          60120099
814687*                DISPLAY '**************************************' 60130099
814688*                DISPLAY '** ABEND                            **' 60140099
814689*                DISPLAY '** PROGRAM = TRKUP205               **' 60150099
814690*                DISPLAY '** PARAGRAPH = 7320-SELECT-TPURITM  **' 60160099
814691*                DISPLAY '** SELECT FROM TPURITM              **' 60170099
814692*                DISPLAY '** PO NUMBER   = ' TR024-EDLVS-PO-NBR   60180099
814693*                DISPLAY '** VS NUMBER   = ' TR024-EDLVS-VS-NBR   60190099
814694*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE    60200099
814695*                DISPLAY '**************************************' 60210099
814696*                PERFORM 9100-SQL-ABEND                           60220099
814697*        END-EVALUATE                                             60230099
814698*    END-PERFORM.                                                 60240099
814699                                                                  60250099
814700*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60260099
814701*        (SQLCODE NOT = ZERO    AND                               60270099
814702*            SQLCODE NOT = +100 AND                               60280099
814703*            SQLCODE NOT = -811)                                  60290099
814704*        DISPLAY '****************************************'       60300099
814705*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       60310099
814706*        DISPLAY '** SELECT FROM TPURITM                **'       60320099
814707*        DISPLAY '** PARAGRAPH = 7320-SELECT-TPURITM    **'       60330099
814708*        DISPLAY '** PO NUMBER   = ' TR024-EDLVS-PO-NBR           60340099
814709*        DISPLAY '** VS NUMBER   = ' TR024-EDLVS-VS-NBR           60350099
814710*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            60360099
814711*        DISPLAY '****************************************'       60370099
814712*        PERFORM 9100-SQL-ABEND                                   60380099
814713*    END-IF.                                                      60390099
814714                                                                  60400099
814715 EJECT                                                            60410099
814716                                                                  60420099
814717******************************************************************60430099
814718* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *60440099
814719* CHECK IF UPC IS ON MULTIPLE LINES ON THE MAINFRAME.            *60450099
814720******************************************************************60460099
814721*7325-SELECT-TPURITM-MULT-UPC.                                    60470099
814722                                                                  60480099
814723*    PERFORM                                                      60490099
814724*        WITH TEST AFTER                                          60500099
814725*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     60510099
814726*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            60520099
814727*                SQLCODE = ZERO                     OR            60530099
814728*                SQLCODE = +100                     OR            60540099
814729*                SQLCODE = -811                                   60550099
814730                                                                  60560099
814731*        EXEC SQL                                                 60570099
814732*            SELECT A.STATUS_CDE                                  60580099
814733*                  ,A.APP_PO_LNE_NBR                              60590099
814734*              INTO :PURITM-STATUS-CDE                            60600099
814735*                  ,:PURITM-APP-PO-LNE-NBR                        60610099
814736*              FROM TPURITM  A                                    60620099
814737*                  ,TUPCSKU  B                                    60630099
814738*             WHERE B.UPC_NBR        = :TUPCSKU-UPC-NBR           60640099
814739*               AND B.ITEM_NBR       = A.ITM_NBR                  60650099
814740*               AND A.PO_NBR         = :PURITM-PO-NBR             60660099
814741*               AND A.VER_STATUS_CDE = 'A'                        60670099
814742*               AND A.STATUS_CDE       IN  ('AC', 'AP', 'RV')     60680099
814743*        END-EXEC                                                 60690099
814744                                                                  60700099
814745*        EVALUATE TRUE                                            60710099
814746                                                                  60720099
814747*            WHEN SQLCODE = +0                                    60730099
814748*            WHEN SQLCODE = -811                                  60740099
814749*               SET PS-UPC-ON-TPURITM     TO TRUE                 60750099
814750*                                                                 60760099
814751*            WHEN SQLCODE = +100                                  60770099
814752*               SET PS-UPC-ON-TPURITM-NO  TO TRUE                 60780099
814753*                                                                 60790099
814754*            WHEN SQLWARN0 NOT EQUAL SPACE                        60800099
814755*            WHEN SQLCODE  NOT EQUAL ZERO                         60810099
814756*                DISPLAY '**************************************' 60820099
814757*                DISPLAY '** ABEND                            **' 60830099
814758*                DISPLAY '** PROGRAM = TRKUP205               **' 60840099
814759*                DISPLAY '** PARAGRAPH = 7325-SELECT-TPURITM  **' 60850099
814760*                DISPLAY '** SELECT FROM TPURITM              **' 60860099
814761*                DISPLAY '** PO NUMBER   = ' TR024-EDLUPC-PO-NBR  60870099
814762*                DISPLAY '** UPC NUMBER  = ' TR024-EDLUPC-UPC-NBR 60880099
814763*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE    60890099
814764*                DISPLAY '**************************************' 60900099
814765*                PERFORM 9100-SQL-ABEND                           60910099
814766*        END-EVALUATE                                             60920099
814767*    END-PERFORM.                                                 60930099
814768                                                                  60940099
814769*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60950099
814770*        (SQLCODE NOT = ZERO    AND                               60960099
814771*            SQLCODE NOT = +100 AND                               60970099
814772*            SQLCODE NOT = -811)                                  60980099
814773*        DISPLAY '****************************************'       60990099
814774*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       61000099
814775*        DISPLAY '** SELECT FROM TPURITM                **'       61010099
814776*        DISPLAY '** PARAGRAPH = 7325-SELECT-TPURITM'             61020099
814777*        DISPLAY '** PO NUMBER   = ' TR024-EDLUPC-PO-NBR          61030099
814778*        DISPLAY '** UPC NUMBER  = ' TR024-EDLUPC-UPC-NBR         61040099
814779*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            61050099
814780*        DISPLAY '****************************************'       61060099
814781*        PERFORM 9100-SQL-ABEND                                   61070099
814782*    END-IF.                                                      61080099
814783                                                                  61090099
814784 EJECT                                                            61100099
814785                                                                  61110099
814786******************************************************************61120099
814787* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *61130099
814788* CHECK TO SEE IF THE UPC IS VALID (ACTIVE) AND APPROVED, ALSO   *61140099
814789* IF THE UPC IS ON THE MAINFRAME.                                *61150099
814790******************************************************************61160099
814791*7330-SELECT-TPURITM-ACT-UPC.                                     61170099
814792                                                                  61180099
814793*    PERFORM                                                      61190099
814794*        WITH TEST AFTER                                          61200099
814795*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     61210099
814796*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            61220099
814797*                SQLCODE = ZERO                     OR            61230099
814798*                SQLCODE = +100                     OR            61240099
814799*                SQLCODE = -811                                   61250099
814800                                                                  61260099
814801*        EXEC SQL                                                 61270099
814802*            SELECT A.STATUS_CDE                                  61280099
814803*                 , A.APP_PO_LNE_NBR                              61290099
814804*              INTO :PURITM-STATUS-CDE                            61300099
814805*                 , :PURITM-APP-PO-LNE-NBR                        61310099
814806*              FROM TPURITM  A                                    61320099
814807*                  ,TUPCSKU  B                                    61330099
814808*             WHERE B.UPC_NBR        = :TUPCSKU-UPC-NBR           61340099
814809*               AND B.ITEM_NBR       = A.ITM_NBR                  61350099
814810*               AND A.PO_NBR         = :PURITM-PO-NBR             61360099
814811*               AND A.VER_STATUS_CDE = 'A'                        61370099
814812*               AND A.STATUS_CDE    NOT IN ('AC', 'AP', 'RV')     61380099
814813*        END-EXEC                                                 61390099
814814                                                                  61400099
814815*        EVALUATE TRUE                                            61410099
814816*            WHEN SQLCODE = +0                                    61420099
814817*            WHEN SQLCODE = -811                                  61430099
814818*            WHEN SQLCODE = +100                                  61440099
814819*                CONTINUE                                         61450099
814820*            WHEN SQLWARN0 NOT EQUAL SPACE                        61460099
814821*            WHEN SQLCODE NOT EQUAL ZERO                          61470099
814822*                DISPLAY '**************************************' 61480099
814823*                DISPLAY '** ABEND                            **' 61490099
814824*                DISPLAY '** PROGRAM = TRKUP205               **' 61500099
814825*                DISPLAY '** PARAGRAPH = 7330-SELECT-TPURITM  **' 61510099
814826*                DISPLAY '** SELECT FROM TPURITM              **' 61520099
814827*                DISPLAY '** PO NUMBER   = ' TR024-EDLUPC-PO-NBR  61530099
814828*                DISPLAY '** UPC NUMBER  = ' TR024-EDLUPC-UPC-NBR 61540099
814829*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE    61550099
814830*                DISPLAY '**************************************' 61560099
814831*                PERFORM 9100-SQL-ABEND                           61570099
814832*        END-EVALUATE                                             61580099
814833*    END-PERFORM.                                                 61590099
814834                                                                  61600099
814835*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    61610099
814836*        (SQLCODE NOT = ZERO    AND                               61620099
814837*            SQLCODE NOT = +100 AND                               61630099
814838*            SQLCODE NOT = -811)                                  61640099
814839*        DISPLAY '****************************************'       61650099
814840*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       61660099
814841*        DISPLAY '** SELECT FROM TPURITM                **'       61670099
814842*        DISPLAY '** PARAGRAPH = 7330-SELECT-TPURITM    **'       61680099
814843*        DISPLAY '** PO NUMBER   = ' TR024-EDLUPC-PO-NBR          61690099
814844*        DISPLAY '** UPC NUMBER  = ' TR024-EDLUPC-UPC-NBR         61700099
814845*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            61710099
814846*        DISPLAY '****************************************'       61720099
814847*        PERFORM 9100-SQL-ABEND                                   61730099
814848*    END-IF.                                                      61740099
814849                                                                  61750099
814850 EJECT                                                            61760099
814851                                                                  61770099
814852******************************************************************61780099
814853* SELECT IMPRT FCTRY NAME FROM TENTNME TABLE.                    *61790099
814854******************************************************************61800099
814855*7340-GET-IMPRT-FCTRY-NAME.                                       61810099
814856                                                                  61820099
814857*    INITIALIZE ENTNME-ENT-NAME-DESC.                             61830099
814858                                                                  61840099
814859*    PERFORM                                                      61850099
814860*        WITH TEST AFTER                                          61860099
814861*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     61870099
814862*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            61880099
814863*                SQLCODE = ZERO                     OR            61890099
814864*                SQLCODE = +100                                   61900099
814865                                                                  61910099
814866*        EXEC SQL                                                 61920099
814867*            SELECT ENT_NAME_DESC                                 61930099
814868*            INTO  :ENTNME-ENT-NAME-DESC                          61940099
814869*            FROM   TENTNME                                       61950099
814870*            WHERE  ENT_ID = :PURCHS-IMPRT-FCTRY-ID               61960099
814871*            AND    TYPE_CDE = '01'                               61970099
814872*        END-EXEC                                                 61980099
814873                                                                  61990099
814874*        EVALUATE TRUE                                            62000099
814875*            WHEN SQLCODE = ZERO                                  62010099
814876*            WHEN SQLCODE = +100                                  62020099
814877*                CONTINUE                                         62030099
814878*                                                                 62040099
814879*            WHEN SQLWARN0 NOT EQUAL SPACE                        62050099
814880*            WHEN SQLCODE NOT EQUAL ZERO                          62060099
814881*                DISPLAY '**************************************' 62070099
814882*                DISPLAY '** ABEND                            **' 62080099
814883*                DISPLAY '** PROGRAM = TRKUP205               **' 62090099
814884*              DISPLAY '** PARAGRAPH = 7340-GET-IMPRT-FCTRY-NAME' 62100099
814885*                DISPLAY '** SELECT FROM TENTNME              **' 62110099
814886*                DISPLAY '**************************************' 62120099
814887*                PERFORM 9100-SQL-ABEND                           62130099
814888*        END-EVALUATE                                             62140099
814889*    END-PERFORM.                                                 62150099
814890                                                                  62160099
814891*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    62170099
814892*        (SQLCODE NOT = ZERO AND                                  62180099
814893*            SQLCODE NOT = +100)                                  62190099
814894*        DISPLAY '****************************************'       62200099
814895*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       62210099
814896*        DISPLAY '** SELECT FROM TENTNME                **'       62220099
814897*        DISPLAY '** PARAGRAPH = 7340-GET-IMPRT-FCTRY-NAME'       62230099
814898*        DISPLAY '****************************************'       62240099
814899*        PERFORM 9100-SQL-ABEND                                   62250099
814900*    END-IF.                                                      62260099
814901                                                                  62270099
814902 EJECT                                                            62280099
814903                                                                  62290099
814904******************************************************************62300099
814905* SELECT IMPRT VENDOR NAME FROM TENTNME TABLE.                   *62310099
814906******************************************************************62320099
814907*7345-GET-IMPRT-VEND-NAME.                                        62330099
814908                                                                  62340099
814909*    INITIALIZE ENTNME-ENT-NAME-DESC.                             62350099
814910                                                                  62360099
814911*    PERFORM                                                      62370099
814912*        WITH TEST AFTER                                          62380099
814913*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     62390099
814914*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            62400099
814915*                SQLCODE = ZERO                     OR            62410099
814916*                SQLCODE = +100                                   62420099
814917                                                                  62430099
814918*        EXEC SQL                                                 62440099
814919*            SELECT ENT_NAME_DESC                                 62450099
814920*            INTO  :ENTNME-ENT-NAME-DESC                          62460099
814921*            FROM   TENTNME                                       62470099
814922*            WHERE  ENT_ID = :PURCHS-IMPRT-VND-ID                 62480099
814923*            AND    TYPE_CDE = '01'                               62490099
814924*        END-EXEC                                                 62500099
814925                                                                  62510099
814926*        EVALUATE TRUE                                            62520099
814927*            WHEN SQLCODE = ZERO                                  62530099
814928*            WHEN SQLCODE = +100                                  62540099
814929*                CONTINUE                                         62550099
814930*                                                                 62560099
814931*            WHEN SQLWARN0 NOT EQUAL SPACE                        62570099
814932*            WHEN SQLCODE NOT EQUAL ZERO                          62580099
814933*                DISPLAY '**************************************' 62590099
814934*                DISPLAY '** ABEND                            **' 62600099
814935*                DISPLAY '** PROGRAM = TRKUP205               **' 62610099
814936*              DISPLAY '** PARAGRAPH = 7345-GET-IMPRT-VEND-NAME ' 62620099
814937*                DISPLAY '** SELECT FROM TENTNME              **' 62630099
814938*                DISPLAY '**************************************' 62640099
814939*                PERFORM 9100-SQL-ABEND                           62650099
814940*        END-EVALUATE                                             62660099
814941*    END-PERFORM.                                                 62670099
814942                                                                  62680099
814943*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    62690099
814944*        (SQLCODE NOT = ZERO AND                                  62700099
814945*            SQLCODE NOT = +100)                                  62710099
814946*        DISPLAY '****************************************'       62720099
814947*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       62730099
814948*        DISPLAY '** SELECT FROM TENTNME                **'       62740099
814949*        DISPLAY '** PARAGRAPH = 7345-GET-IMPRT-VEND-NAME '       62750099
814950*        DISPLAY '****************************************'       62760099
814951*        PERFORM 9100-SQL-ABEND                                   62770099
814952*    END-IF.                                                      62780099
814953                                                                  62790099
814954 EJECT                                                            62800099
814955                                                                  62810099
814956******************************************************************62820099
814957* OPEN THE VENDOR STYLE / UPC CURSOR.                            *62830099
814958******************************************************************62840099
814959*7350-OPEN-BKVS-UPC-CURSOR.                                       62850099
814960                                                                  62860099
814961*    EXEC SQL                                                     62870099
814962*         OPEN BKVS_UPC_CUR                                       62880099
814963*    END-EXEC.                                                    62890099
814964                                                                  62900099
814965*    EVALUATE TRUE                                                62910099
814966*        WHEN SQLWARN0 NOT EQUAL SPACE                            62920099
814967*        WHEN SQLCODE NOT EQUAL ZERO                              62930099
814968*            DISPLAY '** ABEND **'                                62940099
814969*            DISPLAY '** PROGRAM = TRKUP205 **'                   62950099
814970*            DISPLAY '** PARAGRAPH = 7350-OPEN-BKVS-UPC-CURSOR**' 62960099
814971*            PERFORM 9100-SQL-ABEND                               62970099
814972*    END-EVALUATE.                                                62980099
814973                                                                  62990099
814974******************************************************************63000099
814975* CLOSE THE VENDOR STYLE / UPC CURSOR.                           *63010099
814976******************************************************************63020099
814977*7355-CLOSE-BKVS-UPC-CURSOR.                                      63030099
814978                                                                  63040099
814979*    EXEC SQL                                                     63050099
814980*        CLOSE BKVS_UPC_CUR                                       63060099
814981*    END-EXEC.                                                    63070099
814982                                                                  63080099
814983*    EVALUATE TRUE                                                63090099
814984*        WHEN SQLWARN0 NOT EQUAL SPACE                            63100099
814985*        WHEN SQLCODE NOT EQUAL ZERO                              63110099
814986*            DISPLAY '** ABEND **'                                63120099
814987*            DISPLAY '** PROGRAM = TRKUP205 **'                   63130099
814988*            DISPLAY '** PARAGRAPH = 7355-CLOSE-BKVS-UPC-CURSOR**'63140099
814989*            PERFORM 9100-SQL-ABEND                               63150099
814990*    END-EVALUATE.                                                63160099
814991                                                                  63170099
814992******************************************************************63180099
814993* FETCH THE VENDOR STYLE / UPC CURSOR.                           *63190099
814994******************************************************************63200099
814995*7360-FETCH-BKVS-UPC-CURSOR.                                      63210099
814996                                                                  63220099
814997*    EXEC SQL                                                     63230099
814998*         FETCH BKVS_UPC_CUR                                      63240099
814999*             INTO :PV-UPC-CURSOR-VS-NBR,                         63250099
815000*                  :PV-UPC-CURSOR-UPC-NBR                         63260099
815001*    END-EXEC.                                                    63270099
815002                                                                  63280099
815003*    EVALUATE TRUE                                                63290099
815004*        WHEN SQLCODE = ZERO                                      63300099
815005*             SET PS-EOC-BKVS-UPC-CURSOR-NO    TO TRUE            63310099
815006                                                                  63320099
815007*        WHEN SQLCODE = +100                                      63330099
815008*             SET PS-EOC-BKVS-UPC-CURSOR       TO TRUE            63340099
815009                                                                  63350099
815010*        WHEN SQLWARN0 NOT EQUAL SPACE                            63360099
815011*        WHEN SQLCODE NOT EQUAL ZERO                              63370099
815012*            DISPLAY '** ABEND **'                                63380099
815013*            DISPLAY '** PROGRAM = TRKUP205 **'                   63390099
815014*            DISPLAY '** PARAGRAPH = 7360-FETCH-BKVS-UPC-CURSOR**'63400099
815015*            PERFORM 9100-SQL-ABEND                               63410099
815016*    END-EVALUATE.                                                63420099
815017                                                                  63430099
815018 EJECT                                                            63440099
815019                                                                  63450099
815020******************************************************************63460099
815021* OPEN THE UPC CURSOR.                                           *63470099
815022******************************************************************63480099
815023*7365-OPEN-UPC-CURSOR.                                            63490099
815024                                                                  63500099
815025*    EXEC SQL                                                     63510099
815026*         OPEN UPC_CUR                                            63520099
815027*    END-EXEC.                                                    63530099
815028                                                                  63540099
815029*    EVALUATE TRUE                                                63550099
815030*        WHEN SQLWARN0 NOT EQUAL SPACE                            63560099
815031*        WHEN SQLCODE NOT EQUAL ZERO                              63570099
815032*            DISPLAY '** ABEND **'                                63580099
815033*            DISPLAY '** PROGRAM = TRKUP205 **'                   63590099
815034*            DISPLAY '** PARAGRAPH = 7365-OPEN-UPC-CURSOR**'      63600099
815035*            PERFORM 9100-SQL-ABEND                               63610099
815036*    END-EVALUATE.                                                63620099
815037                                                                  63630099
815038******************************************************************63640099
815039* CLOSE THE UPC CUROSR.                                          *63650099
815040******************************************************************63660099
815041*7370-CLOSE-UPC-CURSOR.                                           63670099
815042                                                                  63680099
815043*    EXEC SQL                                                     63690099
815044*        CLOSE UPC_CUR                                            63700099
815045*    END-EXEC.                                                    63710099
815046                                                                  63720099
815047*    EVALUATE TRUE                                                63730099
815048*        WHEN SQLWARN0 NOT EQUAL SPACE                            63740099
815049*        WHEN SQLCODE NOT EQUAL ZERO                              63750099
815050*            DISPLAY '** ABEND **'                                63760099
815051*            DISPLAY '** PROGRAM = TRKUP205 **'                   63770099
815052*            DISPLAY '** PARAGRAPH = 7370-CLOSE-UPC-CURSOR**'     63780099
815053*            PERFORM 9100-SQL-ABEND                               63790099
815054*    END-EVALUATE.                                                63800099
815055                                                                  63810099
815056******************************************************************63820099
815057* FETCH THE UPC CURSOR.                                          *63830099
815058******************************************************************63840099
815059*7375-FETCH-UPC-CURSOR.                                           63850099
815060                                                                  63860099
815061*    EXEC SQL                                                     63870099
815062*         FETCH UPC_CUR                                           63880099
815063*             INTO :IMBKUP-PO-NBR,                                63890099
815064*                  :IMBKUP-PO-BKG-SEQ-NBR,                        63900099
815065*                  :IMBKUP-VS-NBR,                                63910099
815066*                  :IMBKUP-UPC-NBR,                               63920099
815067*                  :IMBKUP-UPC-CART-CNT,                          63930099
815068*                  :IMBKUP-UPC-CBMT-QTY,                          63940099
815069*                  :IMBKUP-UPC-WT-KGRM-QTY,                       63950099
815070*                  :IMBKUP-UPC-UNT-QTY,                           63960099
815071*                  :IMBKUP-CRE-BY-USR-ID,                         63970099
815072*                  :IMBKUP-CRE-TMST,                              63980099
815073*                  :IMBKUP-LAST-UPD-BY-USR-ID,                    63990099
815074*                  :IMBKUP-LAST-UPD-TMST                          64000099
815075*    END-EXEC.                                                    64010099
815076                                                                  64020099
815077*    EVALUATE TRUE                                                64030099
815078*        WHEN SQLCODE = ZERO                                      64040099
815079*             SET PS-EOC-UPC-CURSOR-NO    TO TRUE                 64050099
815080*                                                                 64060099
815081*        WHEN SQLCODE = +100                                      64070099
815082*             SET PS-EOC-UPC-CURSOR       TO TRUE                 64080099
815083*                                                                 64090099
815084*        WHEN SQLWARN0 NOT EQUAL SPACE                            64100099
815085*        WHEN SQLCODE NOT EQUAL ZERO                              64110099
815086*            DISPLAY '** ABEND **'                                64120099
815087*            DISPLAY '** PROGRAM = TRKUP205 **'                   64130099
815088*            DISPLAY '** PARAGRAPH = 7375-FETCH-UPC-CURSOR**'     64140099
815089*            PERFORM 9100-SQL-ABEND                               64150099
815090*    END-EVALUATE.                                                64160099
815091                                                                  64170099
815092 EJECT                                                            64180099
815093                                                                  64190099
815094******************************************************************64200099
815095* OPEN THE UPC CURSOR                                            *64210099
815096******************************************************************64220099
815097*7400-OPEN-BKUPC-CURSOR.                                          64230099
815098                                                                  64240099
815099*    EXEC SQL                                                     64250099
815100*         OPEN BKUPC_CSR                                          64260099
815101*    END-EXEC.                                                    64270099
815102                                                                  64280099
815103*    EVALUATE TRUE                                                64290099
815104*        WHEN SQLWARN0 NOT EQUAL SPACE                            64300099
815105*        WHEN SQLCODE NOT EQUAL ZERO                              64310099
815106*            DISPLAY '** ABEND **'                                64320099
815107*            DISPLAY '** PROGRAM = TRKUP205 **'                   64330099
815108*            DISPLAY '** PARAGRAPH = 7400-OPEN-BKUPC-CURSOR **'   64340099
815109*            DISPLAY '*PO NBR           = ' TR024-EDL-PO-NBR      64350099
815110*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       64360099
815111*            DISPLAY '*UPC NBR          = ' TR024-EDLUPC-UPC-NBR  64370099
815112*            PERFORM 9100-SQL-ABEND                               64380099
815113*    END-EVALUATE.                                                64390099
815114                                                                  64400099
815115 EJECT                                                            64410099
815116                                                                  64420099
815117******************************************************************64430099
815118* DELETE ALL OF THE UPC'S FOR EACH VENDOR STYLE                  *64440099
815119******************************************************************64450099
815120*7410-PROCESS-BKUPC-DELETE.                                       64460099
815121                                                                  64470099
815122*    PERFORM 7415-FETCH-BKUPC-CURSOR                              64480099
815123*       IF PS-EOC-BKUPC-CURSOR                                    64490099
815124*          PERFORM 7420-CLOSE-BKUPC-CURSOR                        64500099
815125*       ELSE                                                      64510099
815126*          PERFORM 7430-MOVES-AUDIT-TAUBKUP                       64520099
815127*          SET PS-GOOD-BKUPC-DELETE-NO  TO TRUE                   64530099
815128*          PERFORM 7435-DELETE-TIMBKUP                            64540099
815129*             IF PS-GOOD-BKUPC-DELETE                             64550099
815130*                PERFORM 7445-INSERT-TAUBKUP                      64560099
815131*       END-IF.                                                   64570099
815132                                                                  64580099
815133 EJECT                                                            64590099
815134                                                                  64600099
815135******************************************************************64610099
815136* CURSOR FOR TIMBKUP       RETRIEVE MULTIPLE UPC ROWS            *64620099
815137******************************************************************64630099
815138*7415-FETCH-BKUPC-CURSOR.                                         64640099
815139                                                                  64650099
815140*    EXEC SQL                                                     64660099
815141*         FETCH BKUPC_CSR                                         64670099
815142*             INTO :IMBKUP-PO-NBR,                                64680099
815143*                  :IMBKUP-PO-BKG-SEQ-NBR,                        64690099
815144*                  :IMBKUP-VS-NBR,                                64700099
815145*                  :IMBKUP-UPC-NBR,                               64710099
815146*                  :IMBKUP-UPC-CART-CNT,                          64720099
815147*                  :IMBKUP-UPC-CBMT-QTY,                          64730099
815148*                  :IMBKUP-UPC-WT-KGRM-QTY,                       64740099
815149*                  :IMBKUP-UPC-UNT-QTY,                           64750099
815150*                  :IMBKUP-CRE-BY-USR-ID,                         64760099
815151*                  :IMBKUP-CRE-TMST,                              64770099
815152*                  :IMBKUP-LAST-UPD-BY-USR-ID,                    64780099
815153*                  :IMBKUP-LAST-UPD-TMST                          64790099
815154*    END-EXEC.                                                    64800099
815155                                                                  64810099
815156*    EVALUATE TRUE                                                64820099
815157*        WHEN SQLCODE = ZERO                                      64830099
815158*             CONTINUE                                            64840099
815159*        WHEN SQLCODE = +100                                      64850099
815160*             SET PS-EOC-BKUPC-CURSOR          TO TRUE            64860099
815161                                                                  64870099
815162*        WHEN SQLWARN0 NOT EQUAL SPACE                            64880099
815163*        WHEN SQLCODE NOT EQUAL ZERO                              64890099
815164*            DISPLAY '** ABEND **'                                64900099
815165*            DISPLAY '** PROGRAM = TRKUP205 **'                   64910099
815166*            DISPLAY '** PARAGRAPH = 7415-FETCH-BKUPC-CURSOR**'   64920099
815167*            DISPLAY '*PO NBR           = ' TR024-EDL-PO-NBR      64930099
815168*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       64940099
815169*            DISPLAY '*UPC NBR          = ' TR024-EDLUPC-UPC-NBR  64950099
815170*            PERFORM 9100-SQL-ABEND                               64960099
815171*    END-EVALUATE.                                                64970099
815172                                                                  64980099
815173 EJECT                                                            64990099
815174                                                                  65000099
815175******************************************************************65010099
815176* CLOSE THE TIMBKUP UPC CURSOR.                                  *65020099
815177******************************************************************65030099
815178*7420-CLOSE-BKUPC-CURSOR.                                         65040099
815179                                                                  65050099
815180*    EXEC SQL                                                     65060099
815181*        CLOSE BKUPC_CSR                                          65070099
815182*    END-EXEC.                                                    65080099
815183                                                                  65090099
815184*    EVALUATE TRUE                                                65100099
815185*        WHEN SQLWARN0 NOT EQUAL SPACE                            65110099
815186*        WHEN SQLCODE NOT EQUAL ZERO                              65120099
815187*            DISPLAY '** ABEND **'                                65130099
815188*            DISPLAY '** PROGRAM = TRKUP205 **'                   65140099
815189*            DISPLAY '** PARAGRAPH = 7420-CLOSE-BKUPC-CURSOR**'   65150099
815190*            DISPLAY '*PO NBR           = ' TR024-EDL-PO-NBR      65160099
815191*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       65170099
815192*            DISPLAY '*UPC NBR          = ' TR024-EDLUPC-UPC-NBR  65180099
815193*            PERFORM 9100-SQL-ABEND                               65190099
815194*    END-EVALUATE.                                                65200099
815195                                                                  65210099
815196 EJECT                                                            65220099
815197                                                                  65230099
815198                                                                  65240099
815199******************************************************************65250099
815200* SETUP DCLGEN FIELDS FOR AUDIT PRIOR TO DELETING A ROW          *65260099
815201******************************************************************65270099
815202*7430-MOVES-AUDIT-TAUBKUP.                                        65280099
815203                                                                  65290099
815204*    INITIALIZE DCLTAUBKUP.                                       65300099
815205                                                                  65310099
815206*    MOVE IMBKUP-PO-NBR              TO AUBKUP-PO-NBR.            65320099
815207*    MOVE IMBKUP-PO-BKG-SEQ-NBR      TO AUBKUP-PO-BKG-SEQ-NBR.    65330099
815208*    MOVE IMBKUP-VS-NBR              TO AUBKUP-VS-NBR.            65340099
815209*    MOVE IMBKUP-UPC-NBR             TO AUBKUP-UPC-NBR.           65350099
815210*    MOVE IMBKUP-UPC-CART-CNT        TO AUBKUP-UPC-CART-CNT.      65360099
815211*    MOVE IMBKUP-UPC-CBMT-QTY        TO AUBKUP-UPC-CBMT-QTY.      65370099
815212*    MOVE IMBKUP-UPC-WT-KGRM-QTY     TO AUBKUP-UPC-WT-KGRM-QTY.   65380099
815213*    MOVE IMBKUP-UPC-UNT-QTY         TO AUBKUP-UPC-UNT-QTY.       65390099
815214*    MOVE IMBKUP-LAST-UPD-BY-USR-ID  TO AUBKUP-LAST-UPD-BY-USR-ID.65400099
815215*    MOVE IMBKUP-LAST-UPD-TMST       TO AUBKUP-LAST-UPD-TMST.     65410099
815216                                                                  65420099
815217*    IF TR024-EDD-TRN-TYP = PC-D                                  65430099
815218*        MOVE PC-D               TO AUBKUP-AUD-FUNC-CDE           65440099
815219*    ELSE                                                         65450099
815220*        MOVE PC-U               TO AUBKUP-AUD-FUNC-CDE           65460099
815221*    END-IF.                                                      65470099
815222                                                                  65480099
815223*    PERFORM 7999-SET-CURRENT-TMST.                               65490099
815224*    MOVE PV-CURRENT-TMST            TO AUBKUP-AUD-TMST.          65500099
815225                                                                  65510099
815226 EJECT                                                            65520099
815227                                                                  65530099
815228******************************************************************65540099
815229* DELETE A ROW FROM THE BOOKING UPC TABLE  (TIMBKUP).            *65550099
815230******************************************************************65560099
815231*7435-DELETE-TIMBKUP.                                             65570099
815232                                                                  65580099
815233*    PERFORM                                                      65590099
815234*        WITH TEST AFTER                                          65600099
815235*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     65610099
815236*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            65620099
815237*                SQLCODE = ZERO                                   65630099
815238                                                                  65640099
815239*        EXEC SQL                                                 65650099
815240*             DELETE                                              65660099
815241*               FROM TIMBKUP                                      65670099
815242*              WHERE CURRENT OF BKUPC_CSR                         65680099
815243*        END-EXEC                                                 65690099
815244                                                                  65700099
815245*        EVALUATE TRUE                                            65710099
815246*            WHEN SQLCODE = ZERO                                  65720099
815247*                ADD +1 TO PA-TOT-BKUPC-DELETES                   65730099
815248*                ADD +1 TO PA-TOT-RECS-DELETED                    65740099
815249*                SET PS-GOOD-BKUPC-DELETE   TO TRUE               65750099
815250*            WHEN SQLCODE = +100                                  65760099
815251*                CONTINUE                                         65770099
815252*            WHEN SQLWARN0 NOT EQUAL SPACE                        65780099
815253*            WHEN SQLCODE NOT EQUAL ZERO                          65790099
815254*                DISPLAY '**************************************' 65800099
815255*                DISPLAY '** ABEND                            **' 65810099
815256*                DISPLAY '** PROGRAM = TRKUP205               **' 65820099
815257*                DISPLAY '** PARAGRAPH = 7435-DELETE-TIMBKUP  **' 65830099
815258*                DISPLAY '** DELETE TIMBKUP                   **' 65840099
815259*                DISPLAY '** PO NBR         = ' TR024-EDL-PO-NBR  65850099
815260*                DISPLAY '** PO EXTL REF NBR= '                   65860099
815261*                                       TR024-EDL-EXTL-REF-NBR    65870099
815262*                DISPLAY '** PO BKG DELY DTE= '                   65880099
815263*                                      TR024-EDL-PO-BKG-DELY-DTE  65890099
815264*                DISPLAY '**************************************' 65900099
815265*                PERFORM 9100-SQL-ABEND                           65910099
815266*        END-EVALUATE                                             65920099
815267*    END-PERFORM.                                                 65930099
815268                                                                  65940099
815269*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    65950099
815270*        (SQLCODE NOT = ZERO AND                                  65960099
815271*         SQLCODE NOT = +100)                                     65970099
815272*        DISPLAY '****************************************'       65980099
815273*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       65990099
815274*        DISPLAY '** DELETE FROM TIMBKUP                **'       66000099
815275*        DISPLAY '** PARAGRAPH = 7435-DELETE-TIMBKVS    **'       66010099
815276*        DISPLAY '** PO NBR         = ' TR024-EDD-PO-NBR          66020099
815277*        DISPLAY '** EXTL REF NBR   = ' TR024-EDD-EXTL-REF-NBR    66030099
815278*        DISPLAY '** PO BKG DELY DTE= '                           66040099
815279*                                 TR024-EDL-PO-BKG-DELY-DTE       66050099
815280*        DISPLAY '****************************************'       66060099
815281*        PERFORM 9100-SQL-ABEND                                   66070099
815282*    END-IF.                                                      66080099
815283                                                                  66090099
815284 EJECT                                                            66100099
815285                                                                  66110099
815286******************************************************************66120099
815287* DELETE A ROW FROM THE BOOKING UPC TABLE (TIMBKUP) FOR CHANGE   *66130099
815288* TRANSACTIONS.                                                  *66140099
815289******************************************************************66150099
815290*7440-DELETE-TIMBKUP-CHG.                                         66160099
815291                                                                  66170099
815292*    PERFORM                                                      66180099
815293*        WITH TEST AFTER                                          66190099
815294*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     66200099
815295*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            66210099
815296*                SQLCODE = ZERO                                   66220099
815297*                                                                 66230099
815298*        EXEC SQL                                                 66240099
815299*             DELETE                                              66250099
815300*               FROM TIMBKUP                                      66260099
815301*              WHERE PO_NBR         =  :IMBKPO-PO-NBR             66270099
815302*                AND PO_BKG_SEQ_NBR =  :IMBKPO-PO-BKG-SEQ-NBR     66280099
815303*                AND VS_NBR         =  :IMBKUP-VS-NBR             66290099
815304*                AND UPC_NBR        =  :IMBKUP-UPC-NBR            66300099
815305*        END-EXEC                                                 66310099
815306                                                                  66320099
815307*        EVALUATE TRUE                                            66330099
815308*            WHEN SQLCODE = ZERO                                  66340099
815309*                ADD +1 TO PA-TOT-BKUPC-DELETES                   66350099
815310*                ADD +1 TO PA-TOT-RECS-DELETED                    66360099
815311*            WHEN SQLCODE = +100                                  66370099
815312*                CONTINUE                                         66380099
815313*            WHEN SQLWARN0 NOT EQUAL SPACE                        66390099
815314*            WHEN SQLCODE NOT EQUAL ZERO                          66400099
815315*                DISPLAY '**************************************' 66410099
815316*                DISPLAY '** ABEND                            **' 66420099
815317*                DISPLAY '** PROGRAM = TRKUP205               **' 66430099
815318*                DISPLAY '** PARAGRAPH =                      **' 66440099
815319*                DISPLAY '**        7440-DELETE-TIMBKUP-CHG   **' 66450099
815320*                DISPLAY '** DELETE TIMBKUP                   **' 66460099
815321*                DISPLAY '** PO NBR       =' IMBKPO-PO-NBR        66470099
815322*                DISPLAY '** BKG SEQ NBR  =' IMBKPO-PO-BKG-SEQ-NBR66480099
815323*                DISPLAY '** VENDOR STYLE =' IMBKUP-VS-NBR        66490099
815324*                DISPLAY '** UPC NUMBER   =' IMBKUP-UPC-NBR       66500099
815325*                DISPLAY '**************************************' 66510099
815326*                PERFORM 9100-SQL-ABEND                           66520099
815327*        END-EVALUATE                                             66530099
815328*    END-PERFORM.                                                 66540099
815329                                                                  66550099
815330*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    66560099
815331*        (SQLCODE NOT = ZERO AND                                  66570099
815332*         SQLCODE NOT = +100)                                     66580099
815333*        DISPLAY '****************************************'       66590099
815334*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       66600099
815335*        DISPLAY '** DELETE FROM TIMBKUP                **'       66610099
815336*        DISPLAY '** PARAGRAPH = 7440-DELETE-TIMBKUP-CHG**'       66620099
815337*        DISPLAY '** PO NBR       = ' IMBKPO-PO-NBR               66630099
815338*        DISPLAY '** BKG SEQ NBR  = ' IMBKPO-PO-BKG-SEQ-NBR       66640099
815339*        DISPLAY '** VENDOR STYLE = ' IMBKUP-VS-NBR               66650099
815340*        DISPLAY '** UPC NUMBER   = ' IMBKUP-UPC-NBR              66660099
815341*        DISPLAY '****************************************'       66670099
815342*        PERFORM 9100-SQL-ABEND                                   66680099
815343*    END-IF.                                                      66690099
815344                                                                  66700099
815345 EJECT                                                            66710099
815346                                                                  66720099
815347******************************************************************66730099
815348* AUDIT THE UPC ROW AFTER A SUCCESSFUL DELETE                    *66740099
815349******************************************************************66750099
815350*7445-INSERT-TAUBKUP.                                             66760099
815351                                                                  66770099
815352*    PERFORM                                                      66780099
815353*        WITH TEST AFTER                                          66790099
815354*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     66800099
815355*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            66810099
815356*                SQLCODE = ZERO                                   66820099
815357                                                                  66830099
815358*        EXEC SQL                                                 66840099
815359*            INSERT INTO TAUBKUP                                  66850099
815360*                  (PO_NBR,                                       66860099
815361*                   PO_BKG_SEQ_NBR,                               66870099
815362*                   VS_NBR,                                       66880099
815363*                   UPC_NBR,                                      66890099
815364*                   UPC_CART_CNT,                                 66900099
815365*                   UPC_CBMT_QTY,                                 66910099
815366*                   UPC_WT_KGRM_QTY,                              66920099
815367*                   UPC_UNT_QTY,                                  66930099
815368*                   LAST_UPD_BY_USR_ID,                           66940099
815369*                   LAST_UPD_TMST,                                66950099
815370*                   AUD_FUNC_CDE,                                 66960099
815371*                   AUD_TMST)                                     66970099
815372*            VALUES                                               66980099
815373*                 (:AUBKUP-PO-NBR,                                66990099
815374*                  :AUBKUP-PO-BKG-SEQ-NBR,                        67000099
815375*                  :AUBKUP-VS-NBR,                                67010099
815376*                  :AUBKUP-UPC-NBR,                               67020099
815377*                  :AUBKUP-UPC-CART-CNT,                          67030099
815378*                  :AUBKUP-UPC-CBMT-QTY,                          67040099
815379*                  :AUBKUP-UPC-WT-KGRM-QTY,                       67050099
815380*                  :AUBKUP-UPC-UNT-QTY,                           67060099
815381*                  :AUBKUP-LAST-UPD-BY-USR-ID,                    67070099
815382*                  :AUBKUP-LAST-UPD-TMST,                         67080099
815383*                  :AUBKUP-AUD-FUNC-CDE,                          67090099
815384*                   CURRENT TIMESTAMP)                            67100099
815385*        END-EXEC                                                 67110099
815386                                                                  67120099
815387*        EVALUATE TRUE                                            67130099
815388*            WHEN SQLCODE = ZERO                                  67140099
815389*                ADD +1 TO PA-TOT-BKUPC-AUDITS                    67150099
815390*                ADD +1 TO PA-TOT-RECS-AUDITED                    67160099
815391                                                                  67170099
815392*            WHEN SQLCODE = -904                                  67180099
815393*            WHEN SQLCODE = -911                                  67190099
815393*            WHEN SQLCODE = -913                                  67200099
815394*                CONTINUE                                         67210099
815395                                                                  67220099
815396*            WHEN SQLWARN0 NOT EQUAL SPACE                        67230099
815397*            WHEN SQLCODE NOT EQUAL ZERO                          67240099
815398*                DISPLAY '**************************************' 67250099
815399*                DISPLAY '** ABEND                            **' 67260099
815400*                DISPLAY '** PROGRAM = TRKUP205               **' 67270099
815401*                DISPLAY '** PARAGRAPH = 7445-INSERT-TAUBKUP  **' 67280099
815402*                DISPLAY '** INSERT INTO TAUBKUP              **' 67290099
815403*                DISPLAY '*PO NBR           = ' TR024-EDL-PO-NBR  67300099
815404*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       67310099
815405*                DISPLAY '*UPC NBR    = ' TR024-EDLUPC-UPC-NBR    67320099
815406*                DISPLAY '**************************************' 67330099
815407*                PERFORM 9100-SQL-ABEND                           67340099
815408*        END-EVALUATE                                             67350099
815409*    END-PERFORM.                                                 67360099
815410                                                                  67370099
815411*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    67380099
815412*        (SQLCODE NOT = ZERO AND                                  67390099
815413*         SQLCODE NOT = -803)                                     67400099
815414*        DISPLAY '****************************************'       67410099
815415*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       67420099
815416*        DISPLAY '** INSERT TO TAUBKUP                  **'       67430099
815417*        DISPLAY '** PARAGRAPH = 7445-INSERT-TAUBKUP    **'       67440099
815418*        DISPLAY '*PO NBR           = ' IMBKUP-PO-NBR             67450099
815419*        DISPLAY '*PO BKG SEQ NBR = ' IMBKUP-PO-BKG-SEQ-NBR       67460099
815420*        DISPLAY '*UPC NBR          = ' IMBKUP-UPC-NBR            67470099
815421*        DISPLAY '****************************************'       67480099
815422*        PERFORM 9100-SQL-ABEND                                   67490099
815423*    END-IF.                                                      67500099
815424                                                                  67510099
815425 EJECT                                                            67520099
815426                                                                  67530099
815427******************************************************************67540099
815428* OPEN THE VENDOR STYLE CURSOR                                   *67550099
815429******************************************************************67560099
815430*7500-OPEN-BKVS-CURSOR.                                           67570099
815431                                                                  67580099
815432*    EXEC SQL                                                     67590099
815433*         OPEN BKVS_CSR                                           67600099
815434*    END-EXEC.                                                    67610099
815435                                                                  67620099
815436*    EVALUATE TRUE                                                67630099
815437*        WHEN SQLWARN0 NOT EQUAL SPACE                            67640099
815438*        WHEN SQLCODE NOT EQUAL ZERO                              67650099
815439*            DISPLAY '** ABEND **'                                67660099
815440*            DISPLAY '** PROGRAM = TRKUP205 **'                   67670099
815441*            DISPLAY '** PARAGRAPH = 7500-OPEN-BKVS-CURSOR **'    67680099
815442*            DISPLAY '*PO NBR           = ' TR024-EDL-PO-NBR      67690099
815443*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       67700099
815444*            DISPLAY '*VS NBR           = ' TR024-EDLVS-VS-NBR    67710099
815445*            PERFORM 9100-SQL-ABEND                               67720099
815446*    END-EVALUATE.                                                67730099
815447                                                                  67740099
815448 EJECT                                                            67750099
815449                                                                  67760099
815450******************************************************************67770099
815451* DELETE ALL OF THE VENDOR STYLES FOR EACH PO                    *67780099
815452******************************************************************67790099
815453*7510-PROCESS-BKVS-DELETE.                                        67800099
815454                                                                  67810099
815455*    PERFORM 7515-FETCH-BKVS-CURSOR                               67820099
815456*       IF PS-EOC-BKVS-CURSOR                                     67830099
815457*          PERFORM 7520-CLOSE-BKVS-CURSOR                         67840099
815458*       ELSE                                                      67850099
815459*             PERFORM 7530-MOVES-AUDIT-TAUBKVS                    67860099
815460*             SET PS-GOOD-BKVS-DELETE-NO    TO TRUE               67870099
815461*             PERFORM 7535-DELETE-TIMBKVS                         67880099
815462*                IF PS-GOOD-BKVS-DELETE                           67890099
815463*                   PERFORM 7545-INSERT-TAUBKVS                   67900099
815464*                END-IF                                           67910099
815465*       END-IF.                                                   67920099
815466                                                                  67930099
815467 EJECT                                                            67940099
815468                                                                  67950099
815469******************************************************************67960099
815470* CURSOR FOR TIMBKVS       RETRIEVE MULTIPLE VS ROWS             *67970099
815471******************************************************************67980099
815472*7515-FETCH-BKVS-CURSOR.                                          67990099
815473                                                                  68000099
815474*    EXEC SQL                                                     68010099
815475*         FETCH BKVS_CSR                                          68020099
815476*             INTO :IMBKVS-PO-NBR,                                68030099
815477*                  :IMBKVS-PO-BKG-SEQ-NBR,                        68040099
815478*                  :IMBKVS-VS-NBR,                                68050099
815479*                  :IMBKVS-HTS-ID,                                68060099
815480*                  :IMBKVS-VS-CART-CNT,                           68070099
815481*                  :IMBKVS-VS-CBMT-QTY,                           68080099
815482*                  :IMBKVS-VS-WT-KGRM-QTY,                        68090099
815483*                  :IMBKVS-VS-UNT-QTY,                            68100099
815484*                  :IMBKVS-QTA-CTG-IND,                           68110099
815485*                  :IMBKVS-CRE-BY-USR-ID,                         68120099
815486*                  :IMBKVS-CRE-TMST,                              68130099
815487*                  :IMBKVS-LAST-UPD-BY-USR-ID,                    68140099
815488*                  :IMBKVS-LAST-UPD-TMST                          68150099
815489*    END-EXEC.                                                    68160099
815490                                                                  68170099
815491*    EVALUATE TRUE                                                68180099
815492*        WHEN SQLCODE = ZERO                                      68190099
815493*             CONTINUE                                            68200099
815494*        WHEN SQLCODE = +100                                      68210099
815495*             SET PS-EOC-BKVS-CURSOR           TO TRUE            68220099
815496                                                                  68230099
815497*        WHEN SQLWARN0 NOT EQUAL SPACE                            68240099
815498*        WHEN SQLCODE NOT EQUAL ZERO                              68250099
815499*            DISPLAY '** ABEND **'                                68260099
815500*            DISPLAY '** PROGRAM = TRKUP205 **'                   68270099
815501*            DISPLAY '** PARAGRAPH = 7515-FETCH-BKVS-CURSOR**'    68280099
815502*            DISPLAY '*PO NBR         = ' TR024-EDL-PO-NBR        68290099
815503*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       68300099
815504*            DISPLAY '*VS NBR         = ' TR024-EDLVS-VS-NBR      68310099
815505*            PERFORM 9100-SQL-ABEND                               68320099
815506*    END-EVALUATE.                                                68330099
815507                                                                  68340099
815508 EJECT                                                            68350099
815509                                                                  68360099
815510******************************************************************68370099
815511* CLOSE THE TIMBKVS VS CURSOR.                                   *68380099
815512******************************************************************68390099
815513*7520-CLOSE-BKVS-CURSOR.                                          68400099
815514                                                                  68410099
815515*    EXEC SQL                                                     68420099
815516*        CLOSE BKVS_CSR                                           68430099
815517*    END-EXEC.                                                    68440099
815518                                                                  68450099
815519*    EVALUATE TRUE                                                68460099
815520*        WHEN SQLWARN0 NOT EQUAL SPACE                            68470099
815521*        WHEN SQLCODE NOT EQUAL ZERO                              68480099
815522*            DISPLAY '** ABEND **'                                68490099
815523*            DISPLAY '** PROGRAM = TRKUP205 **'                   68500099
815524*            DISPLAY '** PARAGRAPH = 7520-CLOSE-BKVS-CURSOR**'    68510099
815525*            DISPLAY '*PO NBR         = ' TR024-EDL-PO-NBR        68520099
815526*            DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR       68530099
815527*            DISPLAY '*VS NBR         = ' TR024-EDLVS-VS-NBR      68540099
815528*            PERFORM 9100-SQL-ABEND                               68550099
815529*    END-EVALUATE.                                                68560099
815530                                                                  68570099
815531 EJECT                                                            68580099
815532                                                                  68590099
815533                                                                  68600099
815534******************************************************************68610099
815535* SETUP DCLGEN FIELDS FOR AUDIT PRIOR TO DELETING A ROW          *68620099
815536******************************************************************68630099
815537*7530-MOVES-AUDIT-TAUBKVS.                                        68640099
815538                                                                  68650099
815539*    INITIALIZE DCLTAUBKVS.                                       68660099
815540                                                                  68670099
815541*    MOVE IMBKVS-PO-NBR              TO AUBKVS-PO-NBR.            68680099
815542*    MOVE IMBKVS-PO-BKG-SEQ-NBR      TO AUBKVS-PO-BKG-SEQ-NBR.    68690099
815543*    MOVE IMBKVS-VS-NBR              TO AUBKVS-VS-NBR.            68700099
815544*    MOVE IMBKVS-HTS-ID              TO AUBKVS-HTS-ID.            68710099
815545*    MOVE IMBKVS-VS-CART-CNT         TO AUBKVS-VS-CART-CNT.       68720099
815546*    MOVE IMBKVS-VS-CBMT-QTY         TO AUBKVS-VS-CBMT-QTY.       68730099
815547*    MOVE IMBKVS-VS-WT-KGRM-QTY      TO AUBKVS-VS-WT-KGRM-QTY.    68740099
815548*    MOVE IMBKVS-VS-UNT-QTY          TO AUBKVS-VS-UNT-QTY.        68750099
815549*    MOVE IMBKVS-QTA-CTG-IND         TO AUBKVS-QTA-CTG-IND.       68760099
815550*    MOVE IMBKVS-LAST-UPD-BY-USR-ID  TO AUBKVS-LAST-UPD-BY-USR-ID.68770099
815551*    MOVE IMBKVS-LAST-UPD-TMST       TO AUBKVS-LAST-UPD-TMST.     68780099
815552                                                                  68790099
815553*    IF TR024-EDD-TRN-TYP = PC-D                                  68800099
815554*        MOVE PC-D               TO AUBKVS-AUD-FUNC-CDE           68810099
815555*    ELSE                                                         68820099
815556*        MOVE PC-U               TO AUBKVS-AUD-FUNC-CDE           68830099
815557*    END-IF.                                                      68840099
815558                                                                  68850099
815559*    PERFORM 7999-SET-CURRENT-TMST.                               68860099
815560*    MOVE PV-CURRENT-TMST            TO AUBKVS-AUD-TMST.          68870099
815561                                                                  68880099
815562 EJECT                                                            68890099
815563                                                                  68900099
815564******************************************************************68910099
815565* DELETE A ROW FROM THE BOOKING VS TABLE  (TIMBKVS).             *68920099
815566******************************************************************68930099
815567*7535-DELETE-TIMBKVS.                                             68940099
815568                                                                  68950099
815569*    PERFORM                                                      68960099
815570*        WITH TEST AFTER                                          68970099
815571*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     68980099
815572*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            68990099
815573*                SQLCODE = ZERO                                   69000099
815574                                                                  69010099
815575*        EXEC SQL                                                 69020099
815576*             DELETE                                              69030099
815577*               FROM TIMBKVS                                      69040099
815578*              WHERE CURRENT OF BKVS_CSR                          69050099
815579*        END-EXEC                                                 69060099
815580                                                                  69070099
815581*        EVALUATE TRUE                                            69080099
815582*            WHEN SQLCODE = ZERO                                  69090099
815583*                ADD +1 TO PA-TOT-BKVS-DELETES                    69100099
815584*                ADD +1 TO PA-TOT-RECS-DELETED                    69110099
815585*                SET PS-GOOD-BKVS-DELETE    TO TRUE               69120099
815586*            WHEN SQLCODE = +100                                  69130099
815587*                CONTINUE                                         69140099
815588*            WHEN SQLWARN0 NOT EQUAL SPACE                        69150099
815589*            WHEN SQLCODE NOT EQUAL ZERO                          69160099
815590*                DISPLAY '**************************************' 69170099
815591*                DISPLAY '** ABEND                            **' 69180099
815592*                DISPLAY '** PROGRAM = TRKUP205               **' 69190099
815593*                DISPLAY '** PARAGRAPH = 7535-DELETE-TIMBKVS  **' 69200099
815594*                DISPLAY '** DELETE TIMBKVS                   **' 69210099
815595*                DISPLAY '** PO NBR         = ' TR024-EDL-PO-NBR  69220099
815596*                DISPLAY '** PO EXTL REF NBR= '                   69230099
815597*                                       TR024-EDL-EXTL-REF-NBR    69240099
815598*                DISPLAY '** PO BKG DELY DTE= '                   69250099
815599*                                      TR024-EDL-PO-BKG-DELY-DTE  69260099
815600*                DISPLAY '**************************************' 69270099
815601*                PERFORM 9100-SQL-ABEND                           69280099
815602*        END-EVALUATE                                             69290099
815603*    END-PERFORM.                                                 69300099
815604                                                                  69310099
815605*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    69320099
815606*        (SQLCODE NOT = ZERO AND                                  69330099
815607*         SQLCODE NOT = +100)                                     69340099
815608*        DISPLAY '****************************************'       69350099
815609*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       69360099
815610*        DISPLAY '** DELETE FROM TIMBKVS                **'       69370099
815611*        DISPLAY '** PARAGRAPH = 7535-DELETE-TIMBKVS    **'       69380099
815612*        DISPLAY '** PO NBR         = ' TR024-EDL-PO-NBR          69390099
815613*        DISPLAY '** EXTL REF NBR   = ' TR024-EDL-EXTL-REF-NBR    69400099
815614*        DISPLAY '** PO BKG DELY DTE= '                           69410099
815615*                                 TR024-EDL-PO-BKG-DELY-DTE       69420099
815616*        DISPLAY '****************************************'       69430099
815617*        PERFORM 9100-SQL-ABEND                                   69440099
815618*    END-IF.                                                      69450099
815619                                                                  69460099
815620 EJECT                                                            69470099
815621                                                                  69480099
815622******************************************************************69490099
815623* DELETE A ROW FROM THE BOOKING VS  TABLE (TIMBKVS) FOR CHANGE   *69500099
815624* TRANSACTIONS.                                                  *69510099
815625******************************************************************69520099
815626*7540-DELETE-TIMBKVS-CHG.                                         69530099
815627                                                                  69540099
815628*    PERFORM                                                      69550099
815629*        WITH TEST AFTER                                          69560099
815630*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     69570099
815631*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            69580099
815632*                SQLCODE = ZERO                                   69590099
815633                                                                  69600099
815634*        EXEC SQL                                                 69610099
815635*             DELETE                                              69620099
815636*               FROM TIMBKVS                                      69630099
815637*              WHERE PO_NBR         =  :IMBKPO-PO-NBR             69640099
815638*                AND PO_BKG_SEQ_NBR =  :IMBKPO-PO-BKG-SEQ-NBR     69650099
815639*                AND VS_NBR         =  :IMBKVS-VS-NBR             69660099
815640*        END-EXEC                                                 69670099
815641                                                                  69680099
815642*        EVALUATE TRUE                                            69690099
815643*            WHEN SQLCODE = ZERO                                  69700099
815644*                ADD +1 TO PA-TOT-BKVS-DELETES                    69710099
815645*                ADD +1 TO PA-TOT-RECS-DELETED                    69720099
815646*            WHEN SQLCODE = +100                                  69730099
815647*                CONTINUE                                         69740099
815648*            WHEN SQLWARN0 NOT EQUAL SPACE                        69750099
815649*            WHEN SQLCODE NOT EQUAL ZERO                          69760099
815650*                DISPLAY '**************************************' 69770099
815651*                DISPLAY '** ABEND                            **' 69780099
815652*                DISPLAY '** PROGRAM = TRKUP205               **' 69790099
815653*                DISPLAY '** PARAGRAPH =                      **' 69800099
815654*                DISPLAY '**        7540-DELETE-TIMBKVS-CHG   **' 69810099
815655*                DISPLAY '** DELETE TIMBKVS                   **' 69820099
815656*                DISPLAY '** PO NUMBER   = ' IMBKVS-PO-NBR        69830099
815657*                DISPLAY '** BKG SEQ NBR = '                      69840099
815658*                                          IMBKVS-PO-BKG-SEQ-NBR  69850099
815659*                DISPLAY '** VENDOR STYLE = ' IMBKVS-VS-NBR       69860099
815660*                DISPLAY '**************************************' 69870099
815661*                PERFORM 9100-SQL-ABEND                           69880099
815662*        END-EVALUATE                                             69890099
815663*    END-PERFORM.                                                 69900099
815664                                                                  69910099
815665*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    69920099
815666*        (SQLCODE NOT = ZERO AND                                  69930099
815667*         SQLCODE NOT = +100)                                     69940099
815668*        DISPLAY '****************************************'       69950099
815669*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       69960099
815670*        DISPLAY '** DELETE FROM TIMBKVS                **'       69970099
815671*        DISPLAY '** PARAGRAPH = 7540-DELETE-TIMBKVS-CHG**'       69980099
815672*        DISPLAY '** PO NUMBER    = ' IMBKVS-PO-NBR               69990099
815673*        DISPLAY '** BKG SEQ NBR  = ' IMBKVS-PO-BKG-SEQ-NBR       70000099
815674*        DISPLAY '** VENDOR STYLE = ' IMBKVS-VS-NBR               70010099
815675*        DISPLAY '****************************************'       70020099
815676*        PERFORM 9100-SQL-ABEND                                   70030099
815677*    END-IF.                                                      70040099
815678                                                                  70050099
815679 EJECT                                                            70060099
815680                                                                  70070099
815681******************************************************************70080099
815682* AUDIT THE VS ROW AFTER A SUCCESSFUL DELETE                     *70090099
815683******************************************************************70100099
815684*7545-INSERT-TAUBKVS.                                             70110099
815685                                                                  70120099
815686*    PERFORM                                                      70130099
815687*        WITH TEST AFTER                                          70140099
815688*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                     70150099
815689*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            70160099
815690*                SQLCODE = ZERO                                   70170099
815691                                                                  70180099
815692*        EXEC SQL                                                 70190099
815693*            INSERT INTO TAUBKVS                                  70200099
815694*                  (PO_NBR,                                       70210099
815695*                   PO_BKG_SEQ_NBR,                               70220099
815696*                   VS_NBR,                                       70230099
815697*                   HTS_ID,                                       70240099
815698*                   VS_CART_CNT,                                  70250099
815699*                   VS_CBMT_QTY,                                  70260099
815700*                   VS_WT_KGRM_QTY,                               70270099
815701*                   VS_UNT_QTY,                                   70280099
815702*                   QTA_CTG_IND,                                  70290099
815703*                   LAST_UPD_BY_USR_ID,                           70300099
815704*                   LAST_UPD_TMST,                                70310099
815705*                   AUD_FUNC_CDE,                                 70320099
815706*                   AUD_TMST)                                     70330099
815707*            VALUES                                               70340099
815708*                 (:AUBKVS-PO-NBR,                                70350099
815709*                  :AUBKVS-PO-BKG-SEQ-NBR,                        70360099
815710*                  :AUBKVS-VS-NBR,                                70370099
815711*                  :AUBKVS-HTS-ID,                                70380099
815712*                  :AUBKVS-VS-CART-CNT,                           70390099
815713*                  :AUBKVS-VS-CBMT-QTY,                           70400099
815714*                  :AUBKVS-VS-WT-KGRM-QTY,                        70410099
815715*                  :AUBKVS-VS-UNT-QTY,                            70420099
815716*                  :AUBKVS-QTA-CTG-IND,                           70430099
815717*                  :AUBKVS-LAST-UPD-BY-USR-ID,                    70440099
815718*                  :AUBKVS-LAST-UPD-TMST,                         70450099
815719*                  :AUBKVS-AUD-FUNC-CDE,                          70460099
815720*                   CURRENT TIMESTAMP)                            70470099
815721*        END-EXEC                                                 70480099
815722                                                                  70490099
815723*        EVALUATE TRUE                                            70500099
815724*            WHEN SQLCODE = ZERO                                  70510099
815725*                ADD +1 TO PA-TOT-BKVS-AUDITS                     70520099
815726*                ADD +1 TO PA-TOT-RECS-AUDITED                    70530099
815727                                                                  70540099
815728*            WHEN SQLCODE = -904                                  70550099
815729*            WHEN SQLCODE = -911                                  70560099
815729*            WHEN SQLCODE = -913                                  70570099
815730*                CONTINUE                                         70580099
815731                                                                  70590099
815732*            WHEN SQLWARN0 NOT EQUAL SPACE                        70600099
815733*            WHEN SQLCODE NOT EQUAL ZERO                          70610099
815734*                DISPLAY '**************************************' 70620099
815735*                DISPLAY '** ABEND                            **' 70630099
815736*                DISPLAY '** PROGRAM = TRKUP205               **' 70640099
815737*                DISPLAY '** PARAGRAPH = 7545-INSERT-TAUBKVS  **' 70650099
815738*                DISPLAY '** INSERT INTO TAUBKVS              **' 70660099
815739*                DISPLAY '*PO NBR           = ' TR024-EDL-PO-NBR  70670099
815740*             DISPLAY '*PO BKG SEQ NBR = ' TR024-EDL-SEQ-NBR      70680099
815741*                DISPLAY '*VS          = ' TR024-EDLVS-VS-NBR     70690099
815742*                DISPLAY '**************************************' 70700099
815743*                PERFORM 9100-SQL-ABEND                           70710099
815744*        END-EVALUATE                                             70720099
815745*    END-PERFORM.                                                 70730099
815746                                                                  70740099
815747*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    70750099
815748*        (SQLCODE NOT = ZERO AND                                  70760099
815749*         SQLCODE NOT = -803)                                     70770099
815750*        DISPLAY '****************************************'       70780099
815751*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       70790099
815752*        DISPLAY '** INSERT TO TAUBKVS                  **'       70800099
815753*        DISPLAY '** PARAGRAPH = 7545-INSERT-TAUBKUP    **'       70810099
815754*        DISPLAY '*PO NBR           = ' IMBKUP-PO-NBR             70820099
815755*        DISPLAY '*PO BKG SEQ NBR = ' IMBKUP-PO-BKG-SEQ-NBR       70830099
815756*        DISPLAY '*UPC NBR          = ' IMBKUP-UPC-NBR            70840099
815757*        DISPLAY '****************************************'       70850099
815758*        PERFORM 9100-SQL-ABEND                                   70860099
815759*    END-IF.                                                      70870099
815760                                                                  70880099
815761 EJECT                                                            70890099
815762                                                                  70900099
815763******************************************************************70910099
815764* DELETE THE PO NBR AFTER DELETING VENDOR STYLES AND UPC'S       *70920099
815765******************************************************************70930099
815766 7610-PROCESS-BKPO-DELETE.                                        70940099
815767                                                                  70950099
815768     PERFORM 7630-MOVES-AUDIT-TAUBKPO.                            70960099
815769     SET PS-GOOD-BKPO-DELETE-NO  TO TRUE.                         70970099
815770     PERFORM 7635-DELETE-TIMBKPO.                                 70980099
815780     IF PS-GOOD-BKPO-DELETE                                       70990099
815781        PERFORM 6800-SCM-PO-BKG-DEL                               71000099
815782        INITIALIZE TM606-RECORD                                   71010099
815783        MOVE PC-BD TO TM606-EXTR-PRCG-APPL-CDE                    71020099
815784        PERFORM A000-INSERT-TOUTTM1                               71030099
815785     END-IF.                                                      71040099
815786     PERFORM 7645-INSERT-TAUBKPO.                                 71050099
815787                                                                  71060099
815788 EJECT                                                            71070099
815789                                                                  71080099
815790******************************************************************71090099
815791* SETUP THE TAUBKPO DCLGEN FIELDS PRIOR TO INSERT                *71100099
815792******************************************************************71110099
815793 7630-MOVES-AUDIT-TAUBKPO.                                        71120099
815794                                                                  71130099
815795     INITIALIZE DCLTAUBKPO.                                       71140099
815796                                                                  71150099
815797     MOVE IMBKPO-PO-NBR                        TO                 71160099
815798              AUBKPO-PO-NBR.                                      71170099
815799     MOVE IMBKPO-PO-BKG-SEQ-NBR                TO                 71180099
815800              AUBKPO-PO-BKG-SEQ-NBR.                              71190099
815801     MOVE IMBKPO-PO-BKG-DELY-TMST              TO                 71200099
815802              AUBKPO-PO-BKG-DELY-TMST                             71210099
815803     MOVE IMBKPO-EXTL-REF-NBR                  TO                 71220099
815804              AUBKPO-EXTL-REF-NBR.                                71230099
815805     MOVE IMBKPO-CONSLR-SCAC-ID                TO                 71240099
815806              AUBKPO-CONSLR-SCAC-ID.                              71250099
815807     MOVE IMBKPO-IMPRT-TRIP-ID                 TO                 71260099
815808              AUBKPO-IMPRT-TRIP-ID                                71270099
815809     MOVE IMBKPO-DPRTR-TMST                    TO                 71280099
815810              AUBKPO-DPRTR-TMST                                   71290099
815811     MOVE IMBKPO-POE-DELY-TMST                 TO                 71300099
815812              AUBKPO-POE-DELY-TMST                                71310099
815813     MOVE IMBKPO-CARR-SCAC-ID                  TO                 71320099
815814              AUBKPO-CARR-SCAC-ID                                 71330099
815815     MOVE IMBKPO-FOB-CDE                       TO                 71340099
815816              AUBKPO-FOB-CDE                                      71350099
815817     MOVE IMBKPO-IMPRT-VEH-NM                  TO                 71360099
815818              AUBKPO-IMPRT-VEH-NM                                 71370099
815819     MOVE IMBKPO-TRIP-TYP-CDE                  TO                 71380099
815820              AUBKPO-TRIP-TYP-CDE                                 71390099
815821     MOVE IMBKPO-DEST-POE-CDE                  TO                 71400099
815822              AUBKPO-DEST-POE-CDE                                 71410099
815823     MOVE IMBKPO-EST-LBD-NM                    TO                 71420099
815824              AUBKPO-EST-LBD-NM                                   71430099
815825     MOVE IMBKPO-EST-LBD-TMST                  TO                 71440099
815826              AUBKPO-EST-LBD-TMST                                 71450099
815827     MOVE IMBKPO-ORGN-SHPD-FR-CDE              TO                 71460099
815828              AUBKPO-ORGN-SHPD-FR-CDE                             71470099
815829     MOVE IMBKPO-C-O-PROD-CDE                  TO                 71480099
815830              AUBKPO-C-O-PROD-CDE                                 71490099
815831     MOVE IMBKPO-PROD-FCTRY-NM                 TO                 71500099
815832              AUBKPO-PROD-FCTRY-NM                                71510099
815833     MOVE IMBKPO-PO-CART-CNT                   TO                 71520099
815834              AUBKPO-PO-CART-CNT                                  71530099
815835     MOVE IMBKPO-PO-CBMT-QTY                   TO                 71540099
815836              AUBKPO-PO-CBMT-QTY                                  71550099
815837     MOVE IMBKPO-PO-WT-KGRM-QTY                TO                 71560099
815838              AUBKPO-PO-WT-KGRM-QTY.                              71570099
815839     MOVE IMBKPO-PO-UNT-QTY                    TO                 71580099
815840              AUBKPO-PO-UNT-QTY                                   71590099
815841     MOVE IMBKPO-PO-EXC-APVL-CDE               TO                 71600099
815842              AUBKPO-PO-EXC-APVL-CDE.                             71610099
815843     MOVE IMBKPO-PO-EXC-APVL-USR-ID            TO                 71620099
815844              AUBKPO-PO-EXC-APVL-USR-ID.                          71630099
815845     MOVE IMBKPO-PO-EXC-APVL-TMST              TO                 71640099
815846              AUBKPO-PO-EXC-APVL-TMST.                            71650099
815847     MOVE IMBKPO-PO-EXC-RSN-DESC               TO                 71660099
815848              AUBKPO-PO-EXC-RSN-DESC.                             71670099
815849     MOVE IMBKPO-SHIPT-BKG-TMST                TO                 71680099
815850              AUBKPO-SHIPT-BKG-TMST.                              71690099
815851     MOVE IMBKPO-VOY-CHG-RSN-DESC              TO                 71700099
815852              AUBKPO-VOY-CHG-RSN-DESC.                            71710099
815853     MOVE IMBKPO-DAT-SRC-ENT-ID                TO                 71720099
815854              AUBKPO-DAT-SRC-ENT-ID.                              71730099
815855     MOVE IMBKPO-LAST-UPD-BY-USR-ID            TO                 71740099
815856              AUBKPO-LAST-UPD-BY-USR-ID.                          71750099
815857     MOVE IMBKPO-LAST-UPD-TMST                 TO                 71760099
815858              AUBKPO-LAST-UPD-TMST.                               71770099
815859                                                                  71780099
815860     IF TR024-EDD-TRN-TYP = PC-D                                  71790099
815861         MOVE PC-D               TO AUBKPO-AUD-FUNC-CDE           71800099
815862     ELSE                                                         71810099
815863         MOVE PC-U               TO AUBKPO-AUD-FUNC-CDE           71820099
815864     END-IF.                                                      71830099
815865                                                                  71840099
815866     PERFORM 7999-SET-CURRENT-TMST.                               71850099
815867     MOVE PV-CURRENT-TMST                      TO                 71860099
815868              AUBKPO-AUD-TMST.                                    71870099
815869                                                                  71880099
815870 EJECT                                                            71890099
815871                                                                  71900099
815872******************************************************************71910099
815873* DELETE A ROW FROM THE BOOKING VS TABLE  (TIMBKVS).             *71920099
815874******************************************************************71930099
815875 7635-DELETE-TIMBKPO.                                             71940099
815876                                                                  71950099
815877     PERFORM                                                      71960099
815878         WITH TEST AFTER                                          71970099
815879         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     71980099
815880         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            71990099
815881                 SQLCODE = ZERO                                   72000099
815882                                                                  72010099
815883         EXEC SQL                                                 72020099
815884              DELETE                                              72030099
815885                FROM TIMBKPO                                      72040099
815886               WHERE PO_NBR         =  :IMBKPO-PO-NBR             72050099
815887                 AND PO_BKG_SEQ_NBR =  :IMBKPO-PO-BKG-SEQ-NBR     72060099
815888         END-EXEC                                                 72070099
815889                                                                  72080099
815890         EVALUATE TRUE                                            72090099
815891             WHEN SQLCODE = ZERO                                  72100099
815892                 ADD +1 TO PA-TOT-BKPO-DELETES                    72110099
815893                 ADD +1 TO PA-TOT-RECS-DELETED                    72120099
815894                 SET PS-GOOD-BKPO-DELETE    TO TRUE               72130099
815895             WHEN SQLCODE = +100                                  72140099
815896                 CONTINUE                                         72150099
815897             WHEN SQLWARN0 NOT EQUAL SPACE                        72160099
815898             WHEN SQLCODE NOT EQUAL ZERO                          72170099
815899                 DISPLAY '**************************************' 72180099
815900                 DISPLAY '** ABEND                            **' 72190099
815901                 DISPLAY '** PROGRAM = TRKUP205               **' 72200099
815902                 DISPLAY '** PARAGRAPH = 7635-DELETE-TIMBKPO  **' 72210099
815903                 DISPLAY '** DELETE TIMBKVS                   **' 72220099
815904                 DISPLAY '** PO NBR         = ' TR024-EDL-PO-NBR  72230099
815905                 DISPLAY '** PO EXTL REF NBR= '                   72240099
815906                                        TR024-EDL-EXTL-REF-NBR    72250099
815907                 DISPLAY '** PO BKG DELY DTE= '                   72260099
815908                                       TR024-EDL-PO-BKG-DELY-DTE  72270099
815909                 DISPLAY '**************************************' 72280099
815910                 PERFORM 9100-SQL-ABEND                           72290099
815911         END-EVALUATE                                             72300099
815912     END-PERFORM.                                                 72310099
815913                                                                  72320099
815914     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    72330099
815915         (SQLCODE NOT = ZERO AND                                  72340099
815916          SQLCODE NOT = +100)                                     72350099
815917         DISPLAY '****************************************'       72360099
815918         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       72370099
815919         DISPLAY '** DELETE FROM TIMBKPO                **'       72380099
815920         DISPLAY '** PARAGRAPH = 7635-DELETE-TIMBKPO    **'       72390099
815921         DISPLAY '** PO NBR         = ' TR024-EDL-PO-NBR          72400099
815922         DISPLAY '** EXTL REF NBR   = ' TR024-EDL-EXTL-REF-NBR    72410099
815923         DISPLAY '** PO BKG DELY DTE= '                           72420099
815924                                  TR024-EDL-PO-BKG-DELY-DTE       72430099
815925         DISPLAY '****************************************'       72440099
815926         PERFORM 9100-SQL-ABEND                                   72450099
815927     END-IF.                                                      72460099
815928                                                                  72470099
815929 EJECT                                                            72480099
815930                                                                  72490099
815931******************************************************************72500099
815932* AUDIT THE WHOLE PO ROW TO TABLE (TAUBKPO) PRIOR TO DELETING IT *72510099
815933******************************************************************72520099
815934 7645-INSERT-TAUBKPO.                                             72530099
815935                                                                  72540099
815936     PERFORM                                                      72550099
815937         WITH TEST AFTER                                          72560099
815938         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     72570099
815939         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            72580099
815940                 SQLCODE = ZERO                                   72590099
815941                                                                  72600099
815942     EXEC SQL                                                     72610099
815943         INSERT INTO TAUBKPO                                      72620099
815944               (PO_NBR,                                           72630099
815945                PO_BKG_SEQ_NBR,                                   72640099
815946                PO_BKG_DELY_TMST,                                 72650099
815947                EXTL_REF_NBR,                                     72660099
815948                ORGN_SHPD_FR_CDE,                                 72670099
815949                CONSLR_SCAC_ID,                                   72680099
815950                IMPRT_TRIP_ID,                                    72690099
815951                DPRTR_TMST,                                       72700099
815952                POE_DELY_TMST,                                    72710099
815953                CARR_SCAC_ID,                                     72720099
815954                FOB_CDE,                                          72730099
815955                IMPRT_VEH_NM,                                     72740099
815956                TRIP_TYP_CDE,                                     72750099
815957                DEST_POE_CDE,                                     72760099
815958                C_O_PROD_CDE,                                     72770099
815959                PROD_FCTRY_NM,                                    72780099
815960                PO_CART_CNT,                                      72790099
815961                PO_CBMT_QTY,                                      72800099
815962                PO_WT_KGRM_QTY,                                   72810099
815963                PO_UNT_QTY,                                       72820099
815964                PO_EXC_APVL_CDE,                                  72830099
815965                PO_EXC_APVL_USR_ID,                               72840099
815966                PO_EXC_APVL_TMST,                                 72850099
815967                PO_EXC_RSN_DESC,                                  72860099
815968                EST_LBD_NM,                                       72870099
815969                EST_LBD_TMST,                                     72880099
815970                SHIPT_BKG_TMST,                                   72890099
815971                VOY_CHG_RSN_DESC,                                 72900099
815972                DAT_SRC_ENT_ID,                                   72910099
815973                LAST_UPD_BY_USR_ID,                               72920099
815974                LAST_UPD_TMST,                                    72930099
815975                AUD_FUNC_CDE,                                     72940099
815976                AUD_TMST)                                         72950099
815977       VALUES (:AUBKPO-PO-NBR,                                    72960099
815978               :AUBKPO-PO-BKG-SEQ-NBR,                            72970099
815979               :AUBKPO-PO-BKG-DELY-TMST,                          72980099
815980               :AUBKPO-EXTL-REF-NBR,                              72990099
815981               :AUBKPO-ORGN-SHPD-FR-CDE,                          73000099
815982               :AUBKPO-CONSLR-SCAC-ID,                            73010099
815983               :AUBKPO-IMPRT-TRIP-ID,                             73020099
815984               :AUBKPO-DPRTR-TMST,                                73030099
815985               :AUBKPO-POE-DELY-TMST,                             73040099
815986               :AUBKPO-CARR-SCAC-ID,                              73050099
815987               :AUBKPO-FOB-CDE,                                   73060099
815988               :AUBKPO-IMPRT-VEH-NM,                              73070099
815989               :AUBKPO-TRIP-TYP-CDE,                              73080099
815990               :AUBKPO-DEST-POE-CDE,                              73090099
815991               :AUBKPO-C-O-PROD-CDE,                              73100099
815992               :AUBKPO-PROD-FCTRY-NM,                             73110099
815993               :AUBKPO-PO-CART-CNT,                               73120099
815994               :AUBKPO-PO-CBMT-QTY,                               73130099
815995               :AUBKPO-PO-WT-KGRM-QTY,                            73140099
815996               :AUBKPO-PO-UNT-QTY,                                73150099
815997               :AUBKPO-PO-EXC-APVL-CDE,                           73160099
815998               :AUBKPO-PO-EXC-APVL-USR-ID,                        73170099
815999               :AUBKPO-PO-EXC-APVL-TMST,                          73180099
816000               :AUBKPO-PO-EXC-RSN-DESC,                           73190099
816001               :AUBKPO-EST-LBD-NM,                                73200099
816002               :AUBKPO-EST-LBD-TMST,                              73210099
816003               :AUBKPO-SHIPT-BKG-TMST,                            73220099
816004               :AUBKPO-VOY-CHG-RSN-DESC,                          73230099
816005               :AUBKPO-DAT-SRC-ENT-ID,                            73240099
816006               :AUBKPO-LAST-UPD-BY-USR-ID,                        73250099
816007               :AUBKPO-LAST-UPD-TMST,                             73260099
816008               :AUBKPO-AUD-FUNC-CDE,                              73270099
816009               :AUBKPO-AUD-TMST)                                  73280099
816010     END-EXEC                                                     73290099
816011                                                                  73300099
816012     EVALUATE TRUE                                                73310099
816013         WHEN SQLCODE = +0                                        73320099
816014             ADD +1                      TO PA-TOT-BKPO-AUDITS    73330099
816015             ADD +1                      TO PA-TOT-RECS-AUDITED   73340099
816016                                                                  73350099
816017         WHEN SQLCODE = -904                                      73360099
816018         WHEN SQLCODE = -911                                      73370099
816018         WHEN SQLCODE = -913                                      73380099
816019             CONTINUE                                             73390099
816020                                                                  73400099
816021         WHEN SQLWARN0 NOT EQUAL SPACE                            73410099
816022         WHEN SQLCODE NOT EQUAL ZERO                              73420099
816023             DISPLAY '** ABEND **'                                73430099
816024             DISPLAY '** PROGRAM = TRKUP205                  **'  73440099
816025             DISPLAY '** PARAGRAPH = 7645-INSERT-TAUBKPO     **'  73450099
816026             DISPLAY '**UNSUCCESSFUL INSERT TO TAUBKPO       **'  73460099
816027             DISPLAY '**TR024-PO-NBR = ' TR024-EDL-PO-NBR         73470099
816028          DISPLAY '**TR024-EXTL-REF-NBR =' TR024-EDL-EXTL-REF-NBR 73480099
816029          DISPLAY '**TR024-EDL-PO-BKG-DELY-DTE ='                 73490099
816030                                      TR024-EDL-PO-BKG-DELY-DTE   73500099
816031             PERFORM 9100-SQL-ABEND                               73510099
816032         END-EVALUATE                                             73520099
816033     END-PERFORM.                                                 73530099
816034                                                                  73540099
816035     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    73550099
816036          SQLCODE NOT = ZERO                                      73560099
816037                                                                  73570099
816038         DISPLAY '****************************************'       73580099
816039         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       73590099
816040         DISPLAY '** INSERT TO TAUBKPO                  **'       73600099
816041         DISPLAY '** PARAGRAPH = 7645-INSERT-TAUBKPO    **'       73610099
816042         DISPLAY '* PO NBR           = ' TR024-EDL-PO-NBR         73620099
816043         DISPLAY '* EXTL REF NBR     = ' TR024-EDL-EXTL-REF-NBR   73630099
816044         DISPLAY '* PO BKG DELY TMST = ' TR024-EDL-PO-BKG-DELY-DTE73640099
816045         DISPLAY '****************************************'       73650099
816046         PERFORM 9100-SQL-ABEND                                   73660099
816047     END-IF.                                                      73670099
816048                                                                  73680099
816049 EJECT                                                            73690099
816050***************************************************************** 73700099
816060* INSERT ROW INTO TRTW_BKG_CKPR                                   73710099
816070* SCM MQ PO TRIGGER FILE.                                         73720099
816080***************************************************************** 73730099
816090 7700-INSERT-SCM-MESSAGE.                                         73740099
816100                                                                  73750099
816200     PERFORM                                                      73760099
816300         WITH TEST AFTER                                          73770099
816400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     73780099
816500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            73790099
816600                 SQLCODE = ZERO                                   73800099
816700         EXEC SQL                                                 73810099
816800              INSERT INTO TRTW_BKG_CKPR                           73820099
816900                  (CKPR_REC_1_TXT)                                73830099
817000                 VALUES  (:TRT00038-CKPR-REC-1-TXT)               73840099
817100         END-EXEC                                                 73850099
817200         EVALUATE TRUE                                            73860099
817300             WHEN SQLCODE = ZERO                                  73870099
817400                 CONTINUE                                         73880099
817500                                                                  73890099
817600             WHEN SQLWARN0 NOT EQUAL SPACE                        73900099
817700             WHEN SQLCODE NOT EQUAL ZERO                          73910099
817800                 DISPLAY '**************************************' 73920099
817900                 DISPLAY '** ABEND                            **' 73930099
818000                 DISPLAY '** PROGRAM = TRKUP205               **' 73940099
818100                 DISPLAY '** PARAGRAPH = 7700-INSERT-SCM-     **' 73950099
818200                 DISPLAY '**                  MESSAGE         **' 73960099
818300                 DISPLAY '** INSERT INTO TRTW_BKG_CKPR        **' 73970099
818400                 DISPLAY '** TR405-RECORD = '                     73980099
818500                 DISPLAY '*'    TR405-ACTN-CDE                    73990099
818600                 DISPLAY '*'    TR405-EVENT-TYP                   74000099
818700                 DISPLAY '*'    TR405-PO-NBR                      74010099
818800                 DISPLAY '*'    TR405-EXTL-REF-NBR                74020099
818900                 DISPLAY '**************************************' 74030099
819000                 PERFORM 9100-SQL-ABEND                           74040099
819100         END-EVALUATE                                             74050099
819200     END-PERFORM.                                                 74060099
819300                                                                  74070099
819400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    74080099
819500         SQLCODE NOT = ZERO                                       74090099
819600         DISPLAY '****************************************'       74100099
819700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       74110099
819800         DISPLAY '** INSERT INTO TRTW_BKG_CKPR          **'       74120099
819900         DISPLAY '** PARAGRAPH = 7700-INSERT-SCM-MESSAGE**'       74130099
820000         DISPLAY '** TR405-RECORD = '                             74140099
820100         DISPLAY '*'    TR405-ACTN-CDE                            74150099
820200         DISPLAY '*'    TR405-EVENT-TYP                           74160099
820300         DISPLAY '*'    TR405-PO-NBR                              74170099
820400         DISPLAY '*'    TR405-EXTL-REF-NBR                        74180099
820500         DISPLAY '****************************************'       74190099
820600         PERFORM 9100-SQL-ABEND                                   74200099
820700     END-IF.                                                      74210099
820800                                                                  74220099
820900 EJECT                                                            74230099
821000******************************************************************74240099
821100* OPEN THE TMST CURSOR                                            74250099
821200******************************************************************74260099
821300 7800-SCM-OPEN-TMST-CURSOR.                                       74270099
821400                                                                  74280099
821500     EXEC SQL                                                     74290099
821600          OPEN TMST_CUR                                           74300099
821700     END-EXEC.                                                    74310099
821800                                                                  74320099
821900     EVALUATE TRUE                                                74330099
822000         WHEN SQLCODE = ZERO                                      74340099
822100             CONTINUE                                             74350099
822200         WHEN SQLWARN0 NOT EQUAL SPACE                            74360099
822300         WHEN SQLCODE NOT EQUAL ZERO                              74370099
822400             DISPLAY '** ABEND **'                                74380099
822500             DISPLAY '** PROGRAM = TRKUP205 **'                   74390099
822600             DISPLAY '** PARAGRAPH = 7800-SCM-OPEN-TMST-CURSOR **'74400099
822700             DISPLAY '*PO NBR             = '                     74410099
822800                                IMBKPO-PO-NBR                     74420099
822900             DISPLAY '*ORGN SHPD FR CDE   = '                     74430099
823000                                TR024-EDL-ORGN-SHPD-FR-CDE        74440099
823100             DISPLAY '** EXTL REF NBR     = '                     74450099
823200                                TR024-EDL-EXTL-REF-NBR            74460099
823300             DISPLAY '** PO BKG DELY DTE = '                      74470099
823400                                TR024-EDL-PO-BKG-DELY-DTE         74480099
823500             PERFORM 9100-SQL-ABEND                               74490099
823600     END-EVALUATE.                                                74500099
823700                                                                  74510099
823800 EJECT                                                            74520099
823900 7810-SCM-CLOS-TMST-CURSOR.                                       74530099
824000     EXEC SQL                                                     74540099
824100         CLOSE TMST_CUR                                           74550099
824200     END-EXEC.                                                    74560099
824300                                                                  74570099
824400                                                                  74580099
824500     EVALUATE TRUE                                                74590099
824600         WHEN SQLCODE = ZERO                                      74600099
824700             CONTINUE                                             74610099
824800         WHEN SQLWARN0 NOT EQUAL SPACE                            74620099
824900         WHEN SQLCODE NOT EQUAL ZERO                              74630099
825000             DISPLAY '**************************************'     74640099
825100             DISPLAY '** ABEND                            **'     74650099
825200             DISPLAY '** PROGRAM = TRKUP205               **'     74660099
825300             DISPLAY '** PARAGRAPH = 7810-SCM-CLOSE-TMST-CURSOR*' 74670099
825400             DISPLAY '** CLOSE TMST_CUR CURSOR            **'     74680099
825500             DISPLAY '**************************************'     74690099
825600             PERFORM 9100-SQL-ABEND                               74700099
825700     END-EVALUATE.                                                74710099
825800                                                                  74720099
825900 EJECT                                                            74730099
826000 7850-SCM-OPEN-ORGN-CURSOR.                                       74740099
826100     EXEC SQL                                                     74750099
826200          OPEN ORGN_CUR                                           74760099
826300     END-EXEC.                                                    74770099
826400                                                                  74780099
826500     EVALUATE TRUE                                                74790099
826600         WHEN SQLCODE = ZERO                                      74800099
826700             CONTINUE                                             74810099
826800         WHEN SQLWARN0 NOT EQUAL SPACE                            74820099
826900         WHEN SQLCODE NOT EQUAL ZERO                              74830099
827000             DISPLAY '** ABEND **'                                74840099
827100             DISPLAY '** PROGRAM = TRKUP205 **'                   74850099
827200             DISPLAY '** PARAGRAPH = 7850-SCM-OPEN-ORGN-CURSOR **'74860099
827300             DISPLAY '*PO NBR             = '                     74870099
827400                                IMBKPO-PO-NBR                     74880099
827500             DISPLAY '*ORGN SHPD FR CDE   = '                     74890099
827600                                TR024-EDL-ORGN-SHPD-FR-CDE        74900099
827700             DISPLAY '** EXTL REF NBR     = '                     74910099
827800                                TR024-EDL-EXTL-REF-NBR            74920099
827900             DISPLAY '** PO BKG DELY DTE = '                      74930099
828000                                TR024-EDL-PO-BKG-DELY-DTE         74940099
828100             PERFORM 9100-SQL-ABEND                               74950099
828200     END-EVALUATE.                                                74960099
828300                                                                  74970099
828400 EJECT                                                            74980099
828500 7860-SCM-CLOS-ORGN-CURSOR.                                       74990099
828600     EXEC SQL                                                     75000099
828700         CLOSE ORGN_CUR                                           75010099
828800     END-EXEC.                                                    75020099
828900                                                                  75030099
829000     EVALUATE TRUE                                                75040099
829100         WHEN SQLCODE = ZERO                                      75050099
829200             CONTINUE                                             75060099
829300                                                                  75070099
829400                                                                  75080099
829500         WHEN SQLWARN0 NOT EQUAL SPACE                            75090099
829600         WHEN SQLCODE NOT EQUAL ZERO                              75100099
829700             DISPLAY '**************************************'     75110099
829800             DISPLAY '** ABEND                            **'     75120099
829900             DISPLAY '** PROGRAM = TRKUP205               **'     75130099
830000             DISPLAY '** PARAGRAPH = 7860-SCM-CLOSE-ORGN-CURSOR*' 75140099
830100             DISPLAY '** CLOSE ORGN_CUR CURSOR            **'     75150099
830200             DISPLAY '**************************************'     75160099
830300             PERFORM 9100-SQL-ABEND                               75170099
830400     END-EVALUATE.                                                75180099
830500                                                                  75190099
830501 EJECT                                                            75200099
830502                                                                  75210099
830503******************************************************************75220099
830504* TAKES A FINAL COMMIT, CLOSES THE INPUT FILE, AND DISPLAYS      *75230099
830505* MISCELLANEOUS JOB SUMMARY INFORMATION.                         *75240099
830506* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *75250099
830507* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *75260099
830508* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *75270099
830509* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*75280099
830510* NO RETURN CODE OR MESSAGE IS SENT.                             *75290099
830511******************************************************************75300099
830512 8000-EOJ-ROUTINE.                                                75310099
830513                                                                  75320099
830514                                                                  75330099
830515     PERFORM 4300-COMMIT.                                         75340099
830516     DISPLAY 'COMMIT TAKEN AT '.                                  75350099
830517     DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)   75360099
830518      '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2).  75370099
830519                                                                  75380099
830520     CLOSE TR024-BOOKING-FILE.                                    75390099
830521                                                                  75400099
830522     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              75410099
830523     PERFORM 4200-UPDATE-TCKRSTCNTL.                              75420099
830524                                                                  75430099
830525     DISPLAY '**************************************'.            75440099
830526     DISPLAY '** TRKUP205 SUMMARY **'.                            75450099
830527     DISPLAY 'TOTAL EDD    RECORDS   = ' PA-TOT-EDD-RECS-READ.    75460099
830528     DISPLAY 'TOTAL EDDRSN RECORDS   = ' PA-TOT-EDDRSN-RECS-READ. 75470099
830529     DISPLAY 'TOTAL EDL    RECORDS   = ' PA-TOT-EDL-RECS-READ.    75480099
830530     DISPLAY 'TOTAL EDLVS  RECORDS   = ' PA-TOT-EDLVS-RECS-READ.  75490099
830531     DISPLAY 'TOTAL EDLUPC RECORDS   = ' PA-TOT-EDLUPC-RECS-READ. 75500099
830532     DISPLAY 'TOTAL INVALID REC TYPE = ' PA-TOT-BAD-REC-TYP.      75510099
830533     DISPLAY 'TOTAL RECORDS READ     = ' PA-TOTAL-RECS-READ.      75520099
830534     DISPLAY '**************************************'.            75530099
830535*                                                                 75540099
830536     DISPLAY 'TOTAL TRANS TYPE = A   = ' PA-TOT-TRN-TYP-A.        75550099
830537     DISPLAY 'TOTAL TRANS TYPE = C   = ' PA-TOT-TRN-TYP-C.        75560099
830538     DISPLAY 'TOTAL TRANS TYPE = D   = ' PA-TOT-TRN-TYP-D.        75570099
830539     DISPLAY 'TOTAL INVALID TRAN TYPE= ' PA-TOT-BAD-TRN-TYP.      75580099
830540     DISPLAY '**************************************'.            75590099
830541*                                                                 75600099
830542     DISPLAY 'TOTAL PO  INSERT COUNT = ' PA-TOT-BKPO-INSERTS.     75610099
830543     DISPLAY 'TOTAL TM1 INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS.  75620099
830544*    DISPLAY 'TOTAL VS  INSERT COUNT = ' PA-TOT-BKVS-INSERTS.     75630099
830545*    DISPLAY 'TOTAL UPC INSERT COUNT = ' PA-TOT-BKUPC-INSERTS.    75640099
830546     DISPLAY 'TOTAL RECORDS INSERTED = ' PA-TOT-RECS-INSERTED.    75650099
830547     DISPLAY '**************************************'.            75660099
830548*                                                                 75670099
830549     DISPLAY 'TOTAL PO  AUDIT  COUNT = ' PA-TOT-BKPO-AUDITS.      75680099
830550*    DISPLAY 'TOTAL VS  AUDIT  COUNT = ' PA-TOT-BKVS-AUDITS.      75690099
830551*    DISPLAY 'TOTAL UPC AUDIT  COUNT = ' PA-TOT-BKUPC-AUDITS.     75700099
830552     DISPLAY 'TOTAL RECORDS AUDITED  = ' PA-TOT-RECS-AUDITED.     75710099
830553     DISPLAY '**************************************'.            75720099
830554*                                                                 75730099
830555     DISPLAY 'TOTAL PO  DELETE COUNT = ' PA-TOT-BKPO-DELETES.     75740099
830556*    DISPLAY 'TOTAL VS  DELETE COUNT = ' PA-TOT-BKVS-DELETES.     75750099
830557*    DISPLAY 'TOTAL UPC DELETE COUNT = ' PA-TOT-BKUPC-DELETES.    75760099
830558     DISPLAY 'TOTAL RECORDS DELETED  = ' PA-TOT-RECS-DELETED.     75770099
830559     DISPLAY '**************************************'.            75780099
830560*                                                                 75790099
830561     DISPLAY 'TOTAL PO  CHANGE COUNT = ' PA-TOT-BKPO-CHANGES.     75800099
830562*    DISPLAY 'TOTAL VS  CHANGE COUNT = ' PA-TOT-BKVS-CHANGES.     75810099
830563*    DISPLAY 'TOTAL UPC CHANGE COUNT = ' PA-TOT-BKUP-CHANGES.     75820099
830564     DISPLAY 'TOTAL C REC CHANGES    = ' PA-TOT-RECS-CHANGED.     75830099
830565     DISPLAY '**************************************'.            75840099
830566*                                                                 75850099
830567     DISPLAY 'TOTAL PO  CHANGE ADDS  = ' PA-TOT-BKPO-CHANGES-B.   75860099
830568*    DISPLAY 'TOTAL VS  CHANGE ADDS  = ' PA-TOT-BKVS-CHANGES-B.   75870099
830569*    DISPLAY 'TOTAL UPC CHANGE ADDS  = ' PA-TOT-BKUP-CHANGES-B.   75880099
830570     DISPLAY 'TOTAL B CHANGE ADDS    = ' PA-TOT-RECS-CHANGED-B.   75890099
830571     DISPLAY '**************************************'.            75900099
830572*                                                                 75910099
830573*    DISPLAY 'TOTAL VS Z CHANGE ADDS = ' PA-TOT-BKVS-CHANGES-Z.   75920099
830574*    DISPLAY 'TOTAL UPC Z CHANGE ADDS= ' PA-TOT-BKUP-CHANGES-Z.   75930099
830575*    DISPLAY 'TOTAL Z CHANGE ADDS    = ' PA-TOT-RECS-CHANGED-Z.   75940099
830576*    DISPLAY '**************************************'.            75950099
830577*                                                                 75960099
830578*    DISPLAY 'TOTAL VS  E DELETES    = ' PA-TOT-BKVS-DELETES-E.   75970099
830579*    DISPLAY 'TOTAL UPC E DELETES    = ' PA-TOT-BKUP-DELETES-E.   75980099
830580*    DISPLAY 'TOTAL E CHANGE DELETES = ' PA-TOT-RECS-DELETED-E.   75990099
830581*    DISPLAY '**************************************'.            76000099
830582*                                                                 76010099
830583     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS.        76020099
830584*                                                                 76030099
830585     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.    76040099
830586     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.   76050099
830587     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED.    76060099
830588     DISPLAY '**************************************'.            76070099
830589                                                                  76080099
830590 EJECT                                                            76090099
830591                                                                  76100099
830592******************************************************************76110099
830593* SET THE CURRENT TIMESTAMP.                                     *76120099
830594******************************************************************76130099
830595 7999-SET-CURRENT-TMST.                                           76140099
830596                                                                  76150099
830597          EXEC SQL                                                76160099
830598              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            76170099
830599          END-EXEC                                                76180099
830600                                                                  76190099
830601         EVALUATE TRUE                                            76200099
830602             WHEN SQLCODE = ZERO                                  76210099
830603                 CONTINUE                                         76220099
830604                                                                  76230099
830605             WHEN SQLWARN0 NOT EQUAL SPACE                        76240099
830606             WHEN SQLCODE NOT EQUAL ZERO                          76250099
830607                 DISPLAY '**************************************' 76260099
830608                 DISPLAY '** ABEND                            **' 76270099
830609                 DISPLAY '** PROGRAM = TRKUP205               **' 76280099
830610                 DISPLAY '** PARAGRAPH = 7999-SET-CURRENT-TMST**' 76290099
830611                 DISPLAY '** SET CURRENT TIMESTAMP            **' 76300099
830612                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   76310099
830613                 DISPLAY '**************************************' 76320099
830614                 PERFORM 9100-SQL-ABEND                           76330099
830615         END-EVALUATE.                                            76340099
830616                                                                  76350099
830617                                                                  76360099
830618                                                                  76370099
830619 EJECT                                                            76380099
830620                                                                  76390099
830621******************************************************************76400099
830622* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *76410099
830623* ERROR OR WARNING CODE OCCURS.                                  *76420099
830624******************************************************************76430099
830625 9100-SQL-ABEND.                                                  76440099
830626******************************************************************76450099
830627* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *76460099
830628* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *76470099
830629* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *76480099
830630* FORMAT.                                                        *76490099
830631******************************************************************76500099
830632                                                                  76510099
830633     COPY DPPD004.                                                76520099
830634                                                                  76530099
830635     DISPLAY 'PO ABEND         '  TR024-EDD-PO-NBR.               76540099
830636     DISPLAY 'X REF ABEND      '  TR024-EDD-EXTL-REF-NBR.         76550099
830637     DISPLAY 'PO BKG DELY DTE ABEND  '  TR024-EDD-PO-BKG-DELY-DTE.76560099
830638     DISPLAY 'PO BKG DELY TM  ABEND  '  TR024-EDD-PO-BKG-DELY-TM. 76570099
830639     DISPLAY 'ORGN SHPD FR CDE ABEND'  TR024-EDD-ORGN-SHPD-FR-CDE.76580099
830640     DISPLAY 'HOLD PO ABEND    '  PV-HOLD-TR024-PO-NBR.           76590099
830641     DISPLAY 'HOLD X REF ABEND '  PV-HOLD-TR024-EXTL-REF-NBR.     76600099
830642     DISPLAY 'HOLD PO BKG DELY DTE ABEND  '                       76610099
830643                               TR024-EDD-PO-BKG-DELY-DTE.         76620099
830644     DISPLAY 'HOLD PO BKG DELY TM  ABEND  '                       76630099
830645                               TR024-EDD-PO-BKG-DELY-TM.          76640099
830646     DISPLAY 'HOLD ORGN SHPD FR CDE ABEND'                        76650099
830647                               PV-HOLD-ORGN-SHPD-FR-CDE.          76660099
830648     MOVE +4013 TO ABEND-CODE.                                    76670099
830649     CALL 'ILBOABN0' USING ABEND-CODE.                            76680099
830650                                                                  76690099
830651  EJECT                                                           76700099
830652                                                                  76710099
830653******************************************************************76720099
830654* INSERT A ROW IN TOUTTM1 - TROUBLE NOTIFICATION EXTRACT WORK     76730099
830655* TABLE PROCESSED IN JOB TMK625                                   76740099
830656******************************************************************76750099
830657                                                                  76760099
830658 A000-INSERT-TOUTTM1.                                             76770099
830659                                                                  76780099
830660         MOVE PC-BK               TO TM606-DATA-SOURCE.           76790099
830661         MOVE PC-DEFAULT-DTE      TO TM606-STRT-FCTRY-DTE         76800099
830662                                     TM606-LAST-FCTRY-DTE         76810099
830663                                     TM606-PO-BKG-DELY-DTE        76820099
830664                                     TM606-PO-RCVD-DELY-DTE       76830099
830665                                     TM606-EST-DPRTR-DTE          76840099
830666                                     TM606-MOM-POE-DELY-DTE.      76850099
830667         MOVE PC-DEFAULT-TMST     TO TM606-PURCHS-LAST-UPD-TMST   76860099
830668                                     TM606-PLNSHP-LAST-UPD-TMST   76870099
830669                                     TM606-IMBKPO-LAST-UPD-TMST   76880099
830670                                     TM606-IMRCPO-LAST-UPD-TMST   76890099
830671                                     TM606-IMCNPO-LAST-UPD-TMST.  76900099
830672                                                                  76910099
830673         MOVE IMBKPO-PO-NBR       TO TM606-PO-NBR.                76920099
830674         MOVE IMBKPO-PO-BKG-SEQ-NBR                               76930099
830675                                  TO TM606-PO-BKG-SEQ-NBR.        76940099
830676         MOVE IMBKPO-PO-BKG-DELY-TMST (1:10)                      76950099
830677                                  TO TM606-PO-BKG-DELY-DTE.       76960099
830678         MOVE IMBKPO-LAST-UPD-TMST                                76970099
830679                                  TO TM606-IMBKPO-LAST-UPD-TMST   76980099
830680                                                                  76990099
830681         MOVE TM606-PO-NBR    TO OUTTM1-PO-NBR.                   77000099
830682         MOVE TM606-ODR       TO OUTTM1-TRBL-ODR.                 77010099
830683         MOVE TM606-TMST-ODR  TO OUTTM1-TRBL-TMST-ODR.            77020099
830684                                                                  77030099
830685         EXEC SQL                                                 77040099
830686             INSERT INTO TOUTTM1                                  77050099
830687                 (PO_NBR                                          77060099
830688                 ,TRBL_ODR                                        77070099
830689                 ,TRBL_TMST_ODR                                   77080099
830690                  )                                               77090099
830691                VALUES                                            77100099
830692                 (:OUTTM1-PO-NBR                                  77110099
830693                 ,:OUTTM1-TRBL-ODR                                77120099
830694                 ,:OUTTM1-TRBL-TMST-ODR                           77130099
830695                 )                                                77140099
830696         END-EXEC.                                                77150099
830697                                                                  77160099
830698         EVALUATE TRUE                                            77170099
830699             WHEN SQLCODE = ZERO                                  77180099
830700                 ADD +1 TO PA-TOT-TOUTTM1-INSERTS                 77190099
830701                                                                  77200099
830702             WHEN SQLCODE = -803                                  77210099
830703                 CONTINUE                                         77220099
830704             WHEN SQLWARN0 NOT EQUAL SPACE                        77230099
830705             WHEN SQLCODE NOT EQUAL ZERO                          77240099
830706                 DISPLAY '**************************************' 77250099
830707                 DISPLAY '** ABEND                            **' 77260099
830708                 DISPLAY '** PROGRAM = TRKUP205               **' 77270099
830709                 DISPLAY '** PARAGRAPH = A000-INSERT-TOUTTM1  **' 77280099
830710                 DISPLAY '** PO NUMBER    = '  TM606-PO-NBR-X     77290099
830711                 DISPLAY '** PO BKG SEQ   = '                     77300099
830712                 DISPLAY  TM606-PO-BKG-SEQ-NBR-X                  77310099
830713                 DISPLAY '**************************************' 77320099
830714                 PERFORM 9100-SQL-ABEND                           77330099
830715         END-EVALUATE.                                            77340099
