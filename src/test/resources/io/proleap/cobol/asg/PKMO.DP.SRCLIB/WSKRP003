000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             WSKRP003.                                00050000
000600 AUTHOR.                 RANDY DELAURA.                           00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JUNE, 2009.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*                                                               * 00120000
001300*  THIS PROGRAM WILL PRINT WMOS SHIPMENT DOWNLOAD ERRORS REPORT * 00130000
001500***************************************************************** 00150000
001600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00160000
001700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00170000
001800*                                                               * 00180000
001900***************************************************************** 00190000
001910/                                                                 00191000
001920***************************************************************** 00192000
001930 ENVIRONMENT DIVISION.                                            00193000
001940***************************************************************** 00194000
001950                                                                  00195000
001960 CONFIGURATION SECTION.                                           00196000
001970 SOURCE-COMPUTER.        IBM-3090.                                00197000
001980 OBJECT-COMPUTER.        IBM-3090.                                00198000
001990                                                                  00199000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100                                                                  00210000
002200 FILE-CONTROL.                                                    00220000
002300                                                                  00230000
002400     SELECT INPUT01-FILE       ASSIGN TO INP01.                   00240000
002500     SELECT REPORT-FILE        ASSIGN TO RPT01.                   00250000
002600                                                                  00260000
002700***************************************************************** 00270000
002800 DATA DIVISION.                                                   00280000
002900***************************************************************** 00290000
003000                                                                  00300000
003100 FILE SECTION.                                                    00310000
003200                                                                  00320000
003300 FD  INPUT01-FILE                                                 00330000
003400     LABEL RECORDS ARE STANDARD                                   00340000
003500     RECORDING MODE IS F                                          00350000
003600     BLOCK CONTAINS 0 RECORDS                                     00360000
003700     RECORD CONTAINS 130 CHARACTERS.                              00370001
003800 01  INPUT01-RECORD                  PIC X(130).                  00380001
003900                                                                  00390000
004000 FD  REPORT-FILE                                                  00400000
004100     RECORDING MODE IS F                                          00410000
004200     BLOCK CONTAINS 0  RECORDS.                                   00420000
004300 01  REPORT-RECORD                   PIC  X(132).                 00430000
004400/                                                                 00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700 01  PROGRAM-SWITCHES.                                            00470000
004800     05  PS-END-OF-INPUT-SW          PIC  X(01)    VALUE 'N'.     00480000
004900         88  PS-END-OF-INPUT                       VALUE 'Y'.     00490000
005000     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00500000
005100         88  PS-FIRST-TIME                         VALUE 'Y'.     00510000
005101     05  PS-FIRST-TIME-PO-SW         PIC  X(01)    VALUE 'Y'.     00510144
005102         88  PS-FIRST-TIME-PO                      VALUE 'Y'.     00510244
005103         88  PS-FIRST-TIME-PO-NO                   VALUE 'N'.     00510344
005104     05  PS-FIRST-TIME-SHPMT-SW      PIC  X(01)    VALUE 'Y'.     00510451
005105         88  PS-FIRST-TIME-SHPMT                   VALUE 'Y'.     00510551
005106         88  PS-FIRST-TIME-SHPMT-NO                VALUE 'N'.     00510651
005110     05  PS-NEW-TRIP-SW              PIC  X(01)    VALUE 'Y'.     00511033
005120         88  PS-NEW-TRIP-YES                       VALUE 'Y'.     00512033
005130         88  PS-NEW-TRIP-NO                        VALUE 'N'.     00513033
005200                                                                  00520000
005300 01  PC-CONSTANTS.                                                00530000
005400     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00540000
005500                           'WSKRP003'.                            00550000
005600     05  PC-REPORT-NBR               PIC  X(02)    VALUE          00560000
005700                           '-1'.                                  00570000
005800                                                                  00580000
005900 01  PV-MISC-FIELDS.                                              00590000
006000     05  PV-LINE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00600000
006100     05  PV-LINE-LIMIT               PIC S9(03) COMP-3 VALUE +57. 00610000
006200     05  PV-PAGE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00620000
006300     05  PV-USER-NAME                PIC X(25)     VALUE SPACES.  00630000
006310     05  PV-RCVR-TOTAL               PIC S9(9) COMP-3 VALUE +0.   00631038
006320     05  PV-TRAILER-TOTAL            PIC S9(9) COMP-3 VALUE +0.   00632038
006400     05  PV-TODAYS-DATE.                                          00640000
006500         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    00650000
006600         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    00660000
006700         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    00670000
006800     05  PV-TODAYS-TIME.                                          00680000
006900         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    00690000
007000         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    00700000
007100         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    00710000
007200         10  FILLER                  PIC  9(02)    VALUE ZERO.    00720000
007300     05  PV-FORMAT-DATE.                                          00730000
007400         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  00740000
007500         10  FILLER                  PIC  X(01)    VALUE '/'.     00750000
007600         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  00760000
007700         10  FILLER                  PIC  X(01)    VALUE '/'.     00770000
007800         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  00780000
009400     05  PV-DC-LOCATION              PIC 9(04)         VALUE 0.   00940000
009410     05  PV-TRIP-ID                  PIC 9(09)         VALUE 0.   00941015
009410     05  PV-SHIPMT-NBR               PIC X(20)     VALUE SPACES.  00941171
009420     05  PV-PO-NBR                   PIC 9(08)         VALUE 0.   00942038
009430     05  PV-REC-SEQ-NBR              PIC 9(04)         VALUE 0.   00943038
009500/                                                                 00950000
009600****************************************************              00960000
009700* INPUT01 COPYBOOK                                 *              00970000
009800****************************************************              00980000
009900     COPY WSRD056.                                                00990001
010000/                                                                 01000000
010100****************************************************              01010000
010200* STANDARD 132 BYTE REPORT HEADER                  *              01020000
010300****************************************************              01030000
010400     COPY DPWS132O.                                               01040000
010500/                                                                 01050000
010600 01  HDR-LINES.                                                   01060000
010700     05  HDR01-LINE.                                              01070000
010800         10  FILLER                  PIC  X(52)    VALUE SPACES.  01080001
010900         10  FILLER                  PIC  X(29)    VALUE          01090001
011000             'WMOS SHIPMENT DOWNLOAD ERRORS'.                     01100001
011100         10  FILLER                  PIC  X(51)    VALUE SPACES.  01110001
011200     05  HDR02-LINE.                                              01120000
011300         10  FILLER                  PIC  X(17)    VALUE          01130000
011400             'DC.............: '.                                 01140000
011500         10  HDR02-DC                PIC  ZZZZ9.                  01150000
011600         10  FILLER                  PIC  X(02)    VALUE SPACES.  01160000
011700         10  HDR02-DC-DESCRIPTION    PIC  X(40)    VALUE SPACES.  01170000
011800         10  FILLER                  PIC  X(68)    VALUE SPACES.  01180000
013100     05  HDR03-LINE.                                              01310030
013110         10  FILLER                  PIC  X(45)    VALUE          01311030
013120             '                          TRLR               '.     01312030
013130         10  FILLER                  PIC  X(45)    VALUE          01313030
013140             '                             PK TY         TR'.     01314030
013150         10  FILLER                  PIC  X(42)    VALUE          01315030
013160             'BL 128   CSPK   UNIT MISMATCH    CRTN     '.        01316030
013200     05  HDR04-LINE.                                              01320002
013300         10  FILLER                  PIC  X(45)    VALUE          01330002
013400             'SCAC VEHICLE    TRIP ID   STAT  WMOS SHIPMENT'.     01340019
013500         10  FILLER                  PIC  X(45)    VALUE          01350002
013600             '     PO/RECEIVER   LNE  PCK  PO RC SKU NBR  I'.     01360027
013700         10  FILLER                  PIC  X(42)    VALUE          01370002
013800             'ND DATA  TYP TRNS QTY PRCSS QTY  COUNT    '.        01380027
014100     05  HDR05-LINE.                                              01410002
014200         10  FILLER                  PIC  X(45)    VALUE          01420002
014300             '---- ---------- --------- ---- --------------'.     01430018
014400         10  FILLER                  PIC  X(45)    VALUE          01440002
014500             '---- ------------ ---- ----  ----- ------- --'.     01450023
014600         10  FILLER                  PIC  X(42)   VALUE           01460005
014700             '-- ---- ---- ------------------- -------  '.        01470023
015000     05  BLANK-LINE                  PIC X(132)    VALUE SPACES.  01500000
015100     05  END-OF-REPORT-LINE.                                      01510000
015200         10  FILLER                  PIC  X(44)    VALUE SPACES.  01520000
015300         10  FILLER                  PIC  X(45)    VALUE          01530000
015400             '*******   E N D   O F   R E P O R T   *******'.     01540000
015500         10  FILLER                  PIC  X(43)    VALUE SPACES.  01550000
015600     05  NO-DATA-TO-REPORT-LINE.                                  01560000
015700         10  FILLER                  PIC  X(40)    VALUE SPACES.  01570000
015800         10  FILLER                  PIC  X(52)    VALUE          01580000
015900         '*******  N O   D A T A   T O   R E P O R T   *******'.  01590000
016000         10  FILLER                  PIC  X(40)    VALUE SPACES.  01600000
016100/                                                                 01610000
016200 01  DETAIL-LINES.                                                01620000
016300     05  DTL01-LINE.                                              01630000
016310         10  DTL01-SCAC              PIC  X(04)    VALUE SPACES.  01631003
016320         10  FILLER                  PIC  X(01)    VALUE SPACES.  01632003
016330         10  DTL01-VEHICLE           PIC  X(10)    VALUE SPACES.  01633016
016340         10  FILLER                  PIC  X(01)    VALUE SPACES.  01634003
016350         10  DTL01-TRIP-ID           PIC  ZZZ999999               01635015
016351                                         BLANK WHEN ZERO.         01635115
016360         10  FILLER                  PIC  X(02)    VALUE SPACES.  01636018
016361         10  DTL01-TRIP-STAT         PIC  X(02)    VALUE SPACES.  01636116
016362         10  FILLER                  PIC  X(02)    VALUE SPACES.  01636218
016370         10  DTL01-ORIG-SHIPMT-NBR   PIC  X(18)    VALUE SPACES.  01637021
016380         10  FILLER                  PIC  X(01)    VALUE SPACES.  01638003
016400         10  DTL01-PO-NUMBER         PIC  ZZZZZ999.               01640012
016500         10  FILLER                  PIC  X(01)    VALUE '-'.     01650000
016600         10  DTL01-REC-SEQ-NUMBER    PIC  999.                    01660000
016700         10  FILLER                  PIC  X(01)    VALUE SPACES.  01670016
016710         10  DTL01-PO-LINE-NUMBER    PIC  ZZZ9.                   01671003
016711         10  FILLER                  PIC  X(01)    VALUE SPACES.  01671116
016712         10  DTL01-PO-PACK-ID        PIC  ZZZ9                    01671229
016713                                         BLANK WHEN ZERO.         01671329
016720         10  FILLER                  PIC  X(02)    VALUE SPACES.  01672016
017110         10  DTL01-PO-PACK-TYPE      PIC  X(01)    VALUE SPACES.  01711016
017120         10  FILLER                  PIC  X(02)    VALUE SPACES.  01712016
017200         10  DTL01-PO-RCVR-PACK-TYPE PIC  X(01)    VALUE SPACES.  01720016
017300         10  FILLER                  PIC  X(02)    VALUE SPACES.  01730016
017400         10  DTL01-SKU-NUMBER        PIC  9(08).                  01740003
017500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01750016
017600         10  DTL01-TROUBLE-IND       PIC  X(01)    VALUE SPACES.  01760003
017700         10  FILLER                  PIC  X(03)    VALUE SPACES.  01770016
017800         10  DTL01-UCC128-IND        PIC  X(01)    VALUE SPACES.  01780003
017900         10  FILLER                  PIC  X(04)    VALUE SPACES.  01790016
018200         10  DTL01-CASEPACK-TYPE     PIC  X(01)    VALUE SPACES.  01820003
018300         10  FILLER                  PIC  X(04)    VALUE SPACES.  01830008
019000         10  DTL01-TRANSC-QTY        PIC  ZZZZZ9.                 01900038
019100         10  FILLER                  PIC  X(03)    VALUE SPACES.  01910016
019200         10  DTL01-PROCESS-QTY       PIC  ZZZZZ9.                 01920038
019500         10  FILLER                  PIC  X(4)     VALUE SPACES.  01950016
019510         10  DTL01-CRTN-COUNT        PIC  ZZZ9.                   01951038
019520         10  FILLER                  PIC  X(3)     VALUE SPACES.  01952018
019530     05  DTL02-LINE.                                              01953039
019550         10  FILLER                  PIC  X(105)   VALUE SPACES.  01955054
019699         10  DTL02-RCVR-HDG          PIC  X(14)    VALUE          01969954
019700                                     'PO CRTN TOTAL:'.            01970054
019710         10  FILLER                  PIC  X(4)     VALUE SPACES.  01971039
019720         10  DTL02-CRTN-RCVR-TOT     PIC  ZZZZZ9.                 01972039
019730         10  FILLER                  PIC  X(3)     VALUE SPACES.  01973039
019740     05  DTL03-LINE.                                              01974047
019750         10  FILLER                  PIC  X(96)    VALUE SPACES.  01975057
019760         10  DTL03-SHPMT-HDG         PIC  X(23)    VALUE          01976057
019771                            'DWNLD ERROR CRTN TOTAL:'.            01977157
019780         10  FILLER                  PIC  X(4)     VALUE SPACES.  01978047
019790         10  DTL03-SHPMT-CRTN-TOT    PIC  ZZZZZ9.                 01979047
019791         10  FILLER                  PIC  X(3)     VALUE SPACES.  01979147
019792     05  DTL04-LINE.                                              01979258
019793         10  FILLER                  PIC  X(97)    VALUE SPACES.  01979358
019794         10  DTL04-TOT-EXP-HDG       PIC  X(22)    VALUE          01979458
019795                            'TOTAL EXP SHPMT CRTNS:'.             01979558
019796         10  FILLER                  PIC  X(4)     VALUE SPACES.  01979658
019797         10  DTL04-TOT-EXP-SHPMT-CRT PIC  ZZZZZ9.                 01979758
019798         10  FILLER                  PIC  X(3)     VALUE SPACES.  01979858
019800/                                                                 01980039
020200******************************************************            02020000
020300*  XLT00010 - DC LOCATION TABLE                      *            02030000
020400******************************************************            02040000
020500     EXEC SQL                                                     02050000
020600          INCLUDE XLT00010                                        02060000
020700     END-EXEC.                                                    02070000
020800/                                                                 02080000
020900******************************************************            02090000
021000*  DB2 AREA FOR COMMUNICATIONS                       *            02100000
021100******************************************************            02110000
021200     EXEC SQL                                                     02120000
021300          INCLUDE SQLCA                                           02130000
021400     END-EXEC.                                                    02140000
021500                                                                  02150000
021600     COPY SQLCA2.                                                 02160000
021700/                                                                 02170000
021800 PROCEDURE DIVISION.                                              02180000
021900                                                                  02190000
022000******************************************************            02200000
022100* 0000-MAINLINE.                                     *            02210000
022200******************************************************            02220000
022300 0000-MAINLINE.                                                   02230000
022400                                                                  02240000
022500     PERFORM 0010-INITIALIZATION.                                 02250000
022600                                                                  02260000
022700     PERFORM 1000-PROCESS-INPUT                                   02270000
022800        THRU 1000-PROCESS-INPUT-EXIT                              02280000
022900         UNTIL ( PS-END-OF-INPUT ).                               02290000
023000                                                                  02300000
023100     PERFORM 0020-END-PROGRAM.                                    02310000
023200     GOBACK.                                                      02320000
023300/                                                                 02330000
023400******************************************************            02340000
023500* 0010-INITIALIZATION.                               *            02350000
023600******************************************************            02360000
023700 0010-INITIALIZATION.                                             02370000
023800                                                                  02380000
023900     OPEN INPUT  INPUT01-FILE                                     02390000
024000          OUTPUT REPORT-FILE.                                     02400000
024100                                                                  02410000
024200     ACCEPT PV-TODAYS-DATE   FROM DATE.                           02420000
024300     ACCEPT PV-TODAYS-TIME   FROM TIME.                           02430000
024400                                                                  02440000
024500     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             02450000
024600     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               02460000
024700     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              02470000
024800     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              02480000
024900     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            02490000
025000     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          02500000
025100     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         02510000
025101                                                                  02510143
025110     MOVE ZEROES TO PV-RCVR-TOTAL                                 02511043
025200                    PV-TRAILER-TOTAL.                             02520043
025210                                                                  02521043
025300     PERFORM 9050-REPORT-HEADERS.                                 02530000
025400/                                                                 02540000
025500******************************************************            02550000
025600* 0020-END-PROGRAM.                                  *            02560000
025700******************************************************            02570000
025800 0020-END-PROGRAM.                                                02580000
025900                                                                  02590000
026000     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           02600000
026100         PERFORM 9050-REPORT-HEADERS                              02610000
026200     END-IF.                                                      02620000
026300                                                                  02630000
026400     IF ( PS-FIRST-TIME )                                         02640000
026500         WRITE REPORT-RECORD FROM NO-DATA-TO-REPORT-LINE          02650000
026600              AFTER ADVANCING 2 LINES                             02660000
026700     END-IF.                                                      02670000
026800                                                                  02680000
026801     MOVE PV-RCVR-TOTAL        TO DTL02-CRTN-RCVR-TOT             02680155
026803     COMPUTE PV-TRAILER-TOTAL = PV-RCVR-TOTAL                     02680365
026805                                     + PV-TRAILER-TOTAL           02680565
026806     MOVE PV-TRAILER-TOTAL     TO DTL03-SHPMT-CRTN-TOT            02680666
026810     WRITE REPORT-RECORD FROM DTL02-LINE                          02681046
026820                  AFTER ADVANCING 1 LINE                          02682046
026830                                                                  02683046
026840     WRITE REPORT-RECORD FROM DTL03-LINE                          02684051
026850                  AFTER ADVANCING 1 LINE                          02685051
026851                                                                  02685159
026852     MOVE WS056-TOT-CRTNS-BY-SHPMT TO DTL04-TOT-EXP-SHPMT-CRT     02685259
026853            WRITE REPORT-RECORD FROM DTL04-LINE                   02685359
026854                      AFTER ADVANCING 1 LINE                      02685459
026860                                                                  02686051
026900     WRITE REPORT-RECORD FROM END-OF-REPORT-LINE                  02690000
027000          AFTER ADVANCING 3 LINES.                                02700000
027100                                                                  02710000
027200     CLOSE INPUT01-FILE                                           02720000
027300           REPORT-FILE.                                           02730000
027400/                                                                 02740000
027500******************************************************            02750000
027600* 1000-PROCESS-INPUT.                                *            02760000
027700******************************************************            02770000
027800 1000-PROCESS-INPUT.                                              02780000
027900                                                                  02790000
028000     READ INPUT01-FILE INTO WS056-DOWNLOAD-ERRORS-RECORD          02800003
028100         AT END MOVE 'Y' TO PS-END-OF-INPUT-SW                    02810000
028200                GO TO 1000-PROCESS-INPUT-EXIT.                    02820000
028300                                                                  02830000
028400     IF ( PS-FIRST-TIME )                                         02840000
028500         MOVE 'N' TO PS-FIRST-TIME-SW                             02850000
028600         MOVE WS056-DEST-LOC-NBR TO PV-DC-LOCATION                02860005
028700                                    HDR02-DC                      02870005
028800         PERFORM 2000-VALIDATE-DC                                 02880000
028900         PERFORM 9040-PAGE-HEADERS                                02890000
029000     END-IF.                                                      02900000
029100                                                                  02910000
029200     IF ( WS056-DEST-LOC-NBR NOT = PV-DC-LOCATION )               02920005
029300         MOVE WS056-DEST-LOC-NBR TO PV-DC-LOCATION                02930005
029400                                    HDR02-DC                      02940005
029500         PERFORM 2000-VALIDATE-DC                                 02950000
029600         PERFORM 9050-REPORT-HEADERS                              02960000
029700         PERFORM 9040-PAGE-HEADERS                                02970000
029800     END-IF.                                                      02980000
029900                                                                  02990000
030000     PERFORM 9000-REPORT-DETAIL.                                  03000000
030100                                                                  03010000
030200 1000-PROCESS-INPUT-EXIT.                                         03020000
030300     EXIT.                                                        03030000
030400/                                                                 03040000
030500******************************************************            03050000
030600* 2000-VALIDATE-DC.                                  *            03060000
030700******************************************************            03070000
030800 2000-VALIDATE-DC.                                                03080000
030900                                                                  03090000
031000     MOVE PV-DC-LOCATION TO XLT00010-LOC-NBR.                     03100000
031100                                                                  03110000
031200     EXEC SQL                                                     03120000
031300         SELECT A.LOC_NM                                          03130000
031400           INTO :XLT00010-LOC-NM                                  03140000
031500           FROM XLT_LOC A                                         03150000
031600          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 03160000
031700     END-EXEC.                                                    03170000
031800                                                                  03180000
031900     EVALUATE TRUE                                                03190000
032000       WHEN SQLCODE = ZERO                                        03200000
032100           MOVE XLT00010-LOC-NM TO HDR02-DC-DESCRIPTION           03210000
032200       WHEN OTHER                                                 03220000
032300           MOVE SPACES          TO HDR02-DC-DESCRIPTION           03230000
032400     END-EVALUATE.                                                03240000
032500/                                                                 03250000
032600******************************************************            03260000
032700* 9000-REPORT-DETAIL.                                *            03270000
032800******************************************************            03280000
032900 9000-REPORT-DETAIL.                                              03290000
033000                                                                  03300000
033100     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03310000
033200         PERFORM 9050-REPORT-HEADERS                              03320000
033300         PERFORM 9040-PAGE-HEADERS                                03330000
033400     END-IF.                                                      03340000
033500                                                                  03350000
033510     IF ( WS056-TRIP-ID = PV-TRIP-ID )                            03351032
033514         MOVE SPACES                TO DTL01-SCAC                 03351411
033515                                       DTL01-VEHICLE              03351511
033516*                                      DTL01-ORIG-SHIPMT-NBR      03351669
033517                                       DTL01-TRIP-STAT            03351727
033518         MOVE ZEROS                 TO DTL01-TRIP-ID              03351827
033519         SET PS-NEW-TRIP-NO         TO TRUE                       03351933
      * IF THE SHIPMENT # CHANGED, DISPLAY IT ON THE REPORT.  THIS IS   03352069
      * SO THAT DUMMY SHIPMENTS ARE SHOWN IN ADDITION TO THE ORIGINAL.  03352169
      * 12/14/09 MARJ HOEFS                                             03352269
               IF WS056-ORIG-SHIPMT-NBR NOT = PV-SHIPMT-NBR             03352372
                   MOVE WS056-ORIG-SHIPMT-NBR                           03352469
                                          TO DTL01-ORIG-SHIPMT-NBR      03352569
                                             PV-SHIPMT-NBR              03352669
               ELSE                                                     03352769
                   MOVE SPACES            TO DTL01-ORIG-SHIPMT-NBR      03352869
               END-IF                                                   03352969
033520     ELSE                                                         03353069
033521         MOVE WS056-SCAC            TO DTL01-SCAC                 03353169
033522         MOVE WS056-VEHICLE         TO DTL01-VEHICLE              03353269
033523         MOVE WS056-TRIP-ID         TO DTL01-TRIP-ID              03353369
033524                                       PV-TRIP-ID                 03353469
033525         MOVE WS056-TRIP-STATUS     TO DTL01-TRIP-STAT            03353569
033526         MOVE WS056-ORIG-SHIPMT-NBR TO DTL01-ORIG-SHIPMT-NBR      03353669
                                             PV-SHIPMT-NBR              03353773
033527         SET PS-NEW-TRIP-YES        TO TRUE                       03353869
033530     END-IF.                                                      03353969
033540                                                                  03354011
033543                                                                  03354338
033550     IF ( WS056-PO-NUMBER = PV-PO-NBR) AND                        03355038
033560        ( WS056-REC-SEQ-NUMBER = PV-REC-SEQ-NBR)                  03356044
033570            CONTINUE                                              03357044
033710     ELSE                                                         03371038
033720         MOVE WS056-PO-NUMBER      TO PV-PO-NBR                   03372041
033730         MOVE WS056-REC-SEQ-NUMBER TO PV-REC-SEQ-NBR              03373040
033731         IF PS-FIRST-TIME-PO                                      03373144
033732            SET PS-FIRST-TIME-PO-NO TO TRUE                       03373244
033733         ELSE                                                     03373344
033734            COMPUTE PV-TRAILER-TOTAL = PV-RCVR-TOTAL              03373450
033735                                     + PV-TRAILER-TOTAL           03373550
033740            MOVE PV-RCVR-TOTAL        TO DTL02-CRTN-RCVR-TOT      03374044
033750            MOVE ZEROES               TO PV-RCVR-TOTAL            03375044
033760            WRITE REPORT-RECORD FROM DTL02-LINE                   03376044
033761                      AFTER ADVANCING 1 LINE                      03376144
033762            ADD  +1 TO PV-LINE-CNT                                03376244
033764            MOVE ZEROES               TO DTL02-CRTN-RCVR-TOT      03376444
033765         END-IF                                                   03376544
033767     END-IF.                                                      03376742
033768                                                                  03376842
033770     MOVE WS056-PO-NUMBER          TO DTL01-PO-NUMBER.            03377011
033790     MOVE WS056-REC-SEQ-NUMBER     TO DTL01-REC-SEQ-NUMBER.       03379011
033792     MOVE WS056-LINE-NUMBER        TO DTL01-PO-LINE-NUMBER.       03379211
033793     MOVE WS056-PACK-ID            TO DTL01-PO-PACK-ID.           03379328
033798     MOVE WS056-PO-PACK-TYPE       TO DTL01-PO-PACK-TYPE.         03379811
033800     MOVE WS056-PO-RCVR-PACK-TYPE  TO DTL01-PO-RCVR-PACK-TYPE.    03380011
033801     MOVE WS056-SKU-NUMBER         TO DTL01-SKU-NUMBER.           03380111
033806     MOVE WS056-TROUBLE-IND        TO DTL01-TROUBLE-IND.          03380611
033807     MOVE WS056-UCC128-IND         TO DTL01-UCC128-IND.           03380711
033808     MOVE WS056-CASEPACK-TYPE      TO DTL01-CASEPACK-TYPE.        03380811
033810     MOVE WS056-TRANSC-QTY         TO DTL01-TRANSC-QTY.           03381011
033812     MOVE WS056-PROCESS-QTY        TO DTL01-PROCESS-QTY.          03381211
033813     MOVE WS056-CARTON-CNT         TO DTL01-CRTN-COUNT.           03381327
033814                                                                  03381445
033815     COMPUTE PV-RCVR-TOTAL    = WS056-CARTON-CNT + PV-RCVR-TOTAL  03381545
035500                                                                  03550000
035510     IF PS-NEW-TRIP-YES                                           03551033
035515        IF PS-FIRST-TIME-SHPMT                                    03551551
035516            SET PS-FIRST-TIME-SHPMT-NO TO TRUE                    03551651
035517            MOVE WS056-TOT-CRTNS-BY-SHPMT TO                      03551761
035518                                      DTL04-TOT-EXP-SHPMT-CRT     03551861
035519        ELSE                                                      03551951
035520            MOVE PV-TRAILER-TOTAL     TO DTL03-SHPMT-CRTN-TOT     03552047
035521            MOVE ZEROES               TO PV-TRAILER-TOTAL         03552147
035522            WRITE REPORT-RECORD FROM DTL03-LINE                   03552247
035523                      AFTER ADVANCING 1 LINE                      03552347
035524            ADD  +1 TO PV-LINE-CNT                                03552447
035527            WRITE REPORT-RECORD FROM DTL04-LINE                   03552759
035528                      AFTER ADVANCING 1 LINE                      03552859
035529            ADD  +1 TO PV-LINE-CNT                                03552959
035530            MOVE WS056-TOT-CRTNS-BY-SHPMT TO                      03553061
035531                                      DTL04-TOT-EXP-SHPMT-CRT     03553161
035532            MOVE ZEROES               TO DTL03-SHPMT-CRTN-TOT     03553263
035533            WRITE REPORT-RECORD FROM BLANK-LINE                   03553368
035534                AFTER ADVANCING 1 LINE                            03553468
035535            ADD  +1 TO PV-LINE-CNT                                03553568
035536        END-IF                                                    03553659
035537     END-IF                                                       03553759
035538                                                                  03553859
035540                                                                  03554033
035600     WRITE REPORT-RECORD FROM DTL01-LINE                          03560000
035700            AFTER ADVANCING 1 LINE.                               03570000
035800                                                                  03580000
035900     ADD  +1 TO PV-LINE-CNT.                                      03590000
036000/                                                                 03600000
036970******************************************************            03697000
036980* 9040-PAGE-HEADERS.                                 *            03698000
036990******************************************************            03699000
037000 9040-PAGE-HEADERS.                                               03700000
037010                                                                  03701000
037020     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03702000
037030         PERFORM 9050-REPORT-HEADERS                              03703000
037040     END-IF.                                                      03704000
037041                                                                  03704100
037042     WRITE REPORT-RECORD FROM HDR02-LINE                          03704200
037043            AFTER ADVANCING 2 LINES.                              03704300
037044     WRITE REPORT-RECORD FROM HDR03-LINE                          03704400
037045            AFTER ADVANCING 1 LINE.                               03704500
037046     WRITE REPORT-RECORD FROM HDR04-LINE                          03704600
037047            AFTER ADVANCING 1 LINE.                               03704700
037048     WRITE REPORT-RECORD FROM HDR05-LINE                          03704800
037049            AFTER ADVANCING 1 LINES.                              03704900
037052*    WRITE REPORT-RECORD FROM BLANK-LINE                          03705236
037053*           AFTER ADVANCING 1 LINE.                               03705336
037054                                                                  03705400
037055     ADD  +5 TO PV-LINE-CNT.                                      03705536
037056*    ADD  +6 TO PV-LINE-CNT.                                      03705636
037057/                                                                 03705736
037058******************************************************            03705836
037059* 9050-REPORT-HEADERS.                               *            03705936
037060******************************************************            03706036
037061 9050-REPORT-HEADERS.                                             03706136
037062                                                                  03706236
037063     ADD +1           TO PV-PAGE-CNT.                             03706336
037064     MOVE PV-PAGE-CNT TO DP132O-PAGE-NUMBER.                      03706436
037065                                                                  03706536
037066     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      03706636
037067            AFTER ADVANCING PAGE.                                 03706736
037068     WRITE REPORT-RECORD FROM HDR01-LINE                          03706836
037069            AFTER ADVANCING 1 LINE.                               03706936
037070*    WRITE REPORT-RECORD FROM BLANK-LINE                          03707036
037071*           AFTER ADVANCING 1 LINE.                               03707136
037072                                                                  03707236
037073     MOVE +2 TO PV-LINE-CNT.                                      03707336
037074*    MOVE +3 TO PV-LINE-CNT.                                      03707436
037075/                                                                 03707536
