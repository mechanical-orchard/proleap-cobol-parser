       IDENTIFICATION DIVISION.                                         11/22/94
00002  PROGRAM-ID.    MLKRP055                                          MLKRP055
00003  AUTHOR.        TESS BESTE.                                          LV003
00004  INSTALLATION.  KOHLS DEPARTMENT STORES.                          MLKRP055
00005  DATE-WRITTEN.  11/01/93.                                         MLKRP055
00006  DATE-COMPILED.                                                   MLKRP055
00007                                                                   MLKRP055
00008 ******************************************************************MLKRP055
00009 * THIS PROGRAM READS THE EDIT SPLIT REPORT DATA FILE AND          MLKRP055
00010 * REPORTS MERCHANDISE LEDGER AND INVENTORY LEDGER COST AND RETAIL MLKRP055
00011 * AMOUNTS.                                                        MLKRP055
00012 *                                                                 MLKRP055
00013 * THE REPORT SEQUENCE IS DOCUMENT NUMBER WITHIN BATCH WITHIN      MLKRP055
00014 * FINANCIAL LIABILITY DATE WITHIN TRANSACTION CODE WITHIN STORE.  MLKRP055
00015 * TOTALS ARE SHOWN AT EACH LEVEL EXCEPT THE BATCH LEVEL.          MLKRP055
00016 * ALL TOTALS ARE SPLIT INTO CURRENT AND NEXT FISCAL PERIOD        MLKRP055
00017 * AMOUNTS, AND A FINAL TOTAL PAGE IS PRINTED AT THE END.          MLKRP055
      * CHANGES                                                                 
      *                                                                         
      *CHANGE HISTORY:                                                          
      *  03/07/97 - FAST TRANSFER SYSTEM CHANGES - TOM MEDREK                   
      *     EXPANDED THE DOCUMENT NUMBER OF REPORT MLKRP055-1 TO 15             
      *     CHARACTERS FROM 5.  COMPARISON LOGIC ALSO CHANGED FOR THE           
      *     CURRENT/PREV DOCUMENT NUMBER.  INPUT LAYOUT EXPANDED FOR            
      *     MLRD025 FOR TRANSFER DOCUMENT STORE NUMBER AND SEQUENCE             
      *     NUMBER WHICH ARE REPORTED ON FOR FAST TRANSACTIONS.                 
      *                                                                         
      *  11/18/1998 - REMOVED 'X' FROM ML025-RPT1-XFER-DOC-NBR. FIELD           
      *               DOES NOT EXIST IN PRODUCTION MLRD025 COPYBOOK.            
21015 *                                                                         
21015 *  02/27/2001 - ROD JANSSEN      CHANGE ID: 21015                         
21015 *     EDIT SPLIT REPORT MODS. BREAK PURCHASES OUT AS ADJUSTMENTS          
21015 *     AND RECEIPTS.                                                       
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION             
W28545* W28545  08-22-2005 ROD JANSSEN THE NEW TRANSFER PROCESS                 
21015 *                                                                         
00018 ******************************************************************MLKRP055
00019                                                                   MLKRP055
00020                                                                   MLKRP055
00021  ENVIRONMENT DIVISION.                                            MLKRP055
00022  CONFIGURATION SECTION.                                           MLKRP055
00023  SOURCE-COMPUTER.        IBM-3090.                                MLKRP055
00024  OBJECT-COMPUTER.        IBM-3090.                                MLKRP055
00025  INPUT-OUTPUT SECTION.                                            MLKRP055
00026  FILE-CONTROL.                                                    MLKRP055
00027      SELECT EDIT-SPLIT-FILE                                       MLKRP055
00028          ASSIGN TO INP01.                                         MLKRP055
00029      SELECT STORE-SPLIT-REPORT                                    MLKRP055
00030          ASSIGN TO RPT01.                                         MLKRP055
00031                                                                   MLKRP055
00032                                                                   MLKRP055
00033  DATA DIVISION.                                                   MLKRP055
00034  FILE SECTION.                                                    MLKRP055
00035                                                                   MLKRP055
00036  FD  EDIT-SPLIT-FILE                                              MLKRP055
00037      LABEL RECORDS ARE STANDARD                                   MLKRP055
00038      BLOCK CONTAINS 0 RECORDS                                     MLKRP055
00039      RECORDING  MODE IS F                                         MLKRP055
00040      DATA RECORD IS EDIT-SPLIT-RECORD.                            MLKRP055
00041  01  EDIT-SPLIT-RECORD           PIC X(80).                       MLKRP055
00042                                                                   MLKRP055
00043  FD  STORE-SPLIT-REPORT                                           MLKRP055
00044      LABEL RECORDS ARE OMITTED                                    MLKRP055
00045      RECORD CONTAINS 200 CHARACTERS                               MLKRP055
00046      RECORDING  MODE IS F                                         MLKRP055
00047      DATA RECORD IS STORE-SPLIT-REPORT-LINE.                      MLKRP055
00048  01  STORE-SPLIT-REPORT-LINE      PIC X(200).                     MLKRP055
00049                                                                   MLKRP055
00050  WORKING-STORAGE SECTION.                                         MLKRP055
00051                                                                   MLKRP055
00052  01  PC-PROGRAM-CONSTANTS.                                        MLKRP055
00053      05  PC-MAX-RETRIES               PIC S9(04)    VALUE +3      MLKRP055
00054                                                         COMP SYNC.MLKRP055
00055      05  PC-LINE-LIMIT-FOR-DTL        PIC S9(04)    VALUE +57     MLKRP055
00056                                                         COMP SYNC.MLKRP055
00057      05  PC-LINE-LIMIT-FOR-HD-TC      PIC S9(04)    VALUE +54     MLKRP055
00058                                                         COMP SYNC.MLKRP055
00059      05  PC-OPER-CO                   PIC  X(02)    VALUE '03'.   MLKRP055
00060      05  PC-EFF-DATE-HD-LIT           PIC  X(08)    VALUE         MLKRP055
00061                                                        'EFF DATE'.MLKRP055
00062      05  PC-BATCH-HD-LIT              PIC  X(05)    VALUE         MLKRP055
00063                                                        'BATCH'.   MLKRP055
00064      05  PC-DOCUMENT-HD-LIT           PIC  X(08)    VALUE         MLKRP055
00065                                                        'DOCUMENT'.MLKRP055
00066      05  PC-INVENTORY-ONLY-MODE       PIC  X(20)    VALUE         MLKRP055
00067                                                '(INVENTORY ONLY)'.MLKRP055
00068                                                                   MLKRP055
00069  01  PV-PROGRAM-VARIABLES.                                        MLKRP055
W28545     05  PV-EDIT-LOC-NBR              PIC 9(05)     VALUE ZEROS.          
W28545     05  PV-EDIT-LOC-NBR-ALPH REDEFINES                                   
W28545         PV-EDIT-LOC-NBR              PIC X(05).                          
00070      05  PV-ADVANCE                   PIC S9(03)    VALUE ZERO    MLKRP055
00071                                                     COMP-3.       MLKRP055
00072      05  PV-PAGE-COUNT                PIC S9(05)    VALUE ZERO.   MLKRP055
00073      05  PV-LINE-COUNT                PIC S9(04)    VALUE ZERO    MLKRP055
00074                                                     COMP SYNC.    MLKRP055
00075      05  PV-PARAGRAPH-NAME            PIC  X(30)    VALUE SPACE.  MLKRP055
00076      05  PV-ABEND-MESSAGE             PIC  X(75)    VALUE SPACE.  MLKRP055
00077      05  PV-SQL-SUB                   PIC  9(03)    VALUE ZERO.   MLKRP055
00078      05  PV-DB2-OPER-ATTEMPTED        PIC  X(30)    VALUE SPACE.  MLKRP055
00079                                                                   MLKRP055
00080      05  PV-YYMMDD-DATE.                                          MLKRP055
00081          10  PV-YYMMDD-YY             PIC  X(02)    VALUE SPACE.  MLKRP055
00082          10  PV-YYMMDD-MM             PIC  X(02)    VALUE SPACE.  MLKRP055
00083          10  PV-YYMMDD-DD             PIC  X(02)    VALUE SPACE.  MLKRP055
00084      05  PV-ISO-FMT-DATE.                                         MLKRP055
00085          10  PV-ISO-FMT-CC            PIC  X(02).                 MLKRP055
00086          10  PV-ISO-FMT-YY            PIC  X(02).                 MLKRP055
00087          10  FILLER                   PIC  X.                     MLKRP055
00088          10  PV-ISO-FMT-MM            PIC  X(02).                 MLKRP055
00089          10  FILLER                   PIC  X.                     MLKRP055
00090          10  PV-ISO-FMT-DD            PIC  X(02).                 MLKRP055
00091      05  PV-TIME-HHMMSS.                                          MLKRP055
00092          10  PV-TIME-HHMMSS-HH        PIC  X(02)    VALUE SPACES. MLKRP055
00093          10  PV-TIME-HHMMSS-MM        PIC  X(02)    VALUE SPACES. MLKRP055
00094          10  PV-TIME-HHMMSS-SS        PIC  X(02)    VALUE SPACES. MLKRP055
00095      05  PV-LAST-CNTL-CARD-READ       PIC  X(80).                 MLKRP055
W26603     05  PV-EDIT-STORE                PIC X(05)     VALUE SPACES.         
W26603     05  PV-EDIT-STORE-NUM REDEFINES                                      
W26603         PV-EDIT-STORE                PIC 9(05).                          
00096                                                                   MLKRP055
00097  01  TOT-TOTAL-FIELDS.                                            MLKRP055
00098      05  TOT-DOC-NBR-TOTALS.                                      MLKRP055
00099          10  TOT-DOC-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00100          10  TOT-DOC-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00101          10  TOT-DOC-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00102          10  TOT-DOC-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00103          10  TOT-DOC-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00104          10  TOT-DOC-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00105          10  TOT-DOC-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00106          10  TOT-DOC-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00107      05  TOT-BCH-BATCH-NBR-TOTALS.                                MLKRP055
00108          10  TOT-BCH-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00109          10  TOT-BCH-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00110          10  TOT-BCH-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00111          10  TOT-BCH-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00112          10  TOT-BCH-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00113          10  TOT-BCH-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00114          10  TOT-BCH-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00115          10  TOT-BCH-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00116      05  TOT-FLB-FIN-LIAB-DTE-TOTALS.                             MLKRP055
00117          10  TOT-FLB-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00118          10  TOT-FLB-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00119          10  TOT-FLB-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00120          10  TOT-FLB-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00121          10  TOT-FLB-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00122          10  TOT-FLB-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00123          10  TOT-FLB-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00124          10  TOT-FLB-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00125      05  TOT-TCD-TRANS-CDE-TOTALS.                                MLKRP055
00126          10  TOT-TCD-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00127          10  TOT-TCD-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00128          10  TOT-TCD-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00129          10  TOT-TCD-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00130          10  TOT-TCD-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00131          10  TOT-TCD-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00132          10  TOT-TCD-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00133          10  TOT-TCD-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00134      05  TOT-STR-STORE-TOTALS.                                    MLKRP055
00135          10  TOT-STR-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00136          10  TOT-STR-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00137          10  TOT-STR-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00138          10  TOT-STR-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00139          10  TOT-STR-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00140          10  TOT-STR-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00141          10  TOT-STR-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00142          10  TOT-STR-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00143      05  TOT-FNL-FINAL-TOTALS.                                    MLKRP055
00144          10  TOT-FNL-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00145          10  TOT-FNL-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00146          10  TOT-FNL-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00147          10  TOT-FNL-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00148          10  TOT-FNL-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP055
00149          10  TOT-FNL-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP055
00150          10  TOT-FNL-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP055
00151          10  TOT-FNL-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP055
00152                                                                   MLKRP055
00153  01  SA-SAVE-AREAS.                                               MLKRP055
W26603     05  SA-PREV-STORE-NBR       PIC X(05)   VALUE SPACE.         MLKRP055
00155      05  SA-PREV-TRANS-CDE       PIC X(02)   VALUE SPACE.         MLKRP055
00156          88  SA-PREV-TRANS-PURCHASE          VALUE '10'.          MLKRP055
00157          88  SA-PREV-TRANS-SALE              VALUE '20'.          MLKRP055
00158          88  SA-PREV-TRANS-TRANSFER-FROM     VALUE '30'.          MLKRP055
00159          88  SA-PREV-TRANS-TRANSFER-TO       VALUE '31'.          MLKRP055
00160          88  SA-PREV-TRANS-MARKDOWN          VALUE '40'.          MLKRP055
00161          88  SA-PREV-TRANS-MARKUP            VALUE '50'.          MLKRP055
00162          88  SA-PREV-TRANS-ADJUSTMENT        VALUE '80'.          MLKRP055
21015      05  SA-PREV-SYST-ORIG-CDE   PIC X(02)   VALUE SPACES.                
21015          88  SA-PREV-PURCH-RECEIPT           VALUE '08'.                  
00163      05  SA-PREV-FIN-LIAB-DTE    PIC X(10)   VALUE SPACE.         MLKRP055
00164      05  SA-PREV-BATCH-NBR       PIC X(04)   VALUE SPACE.         MLKRP055
00165      05  SA-PREV-DOC-NBR              PIC X(15).                  MLKRP055
           05  SA-PREV-FAST-NBR  REDEFINES  SA-PREV-DOC-NBR.            MLKRP055
W26603         10  SA-PREV-DOC-FAST-LIT     PIC X(04).                          
W26603         10  SA-PREV-DOC-STORE        PIC X(04).                          
               10  SA-PREV-DOC-HYPHEN       PIC X.                              
               10  SA-PREV-DOC-SEQ          PIC X(06).                          
00166      05  SA-CURR-FSCL-YR-PER     PIC X(06)   VALUE SPACE.         MLKRP055
00167                                                                   MLKRP055
00165      05  ED-DOC-NBR                   PIC X(15).                  MLKRP055
           05  ED-FAST-NBR       REDEFINES  ED-DOC-NBR.                 MLKRP055
W26603         10  ED-DOC-FAST-LIT          PIC  X(04).                         
W26603         10  ED-DOC-STORE             PIC  X(04).                         
               10  ED-DOC-HYPHEN            PIC  X.                             
               10  ED-DOC-SEQ               PIC  X(06).                         
00168  01  SW-SWITCHES.                                                 MLKRP055
00169      05  SW-END-OF-EDIT-SPLIT-FILE-SW PIC X         VALUE 'N'.    MLKRP055
00170          88  SW-END-OF-EDIT-SPLIT-FILE              VALUE 'Y'.    MLKRP055
00171          88  SW-NOT-END-OF-EDIT-SPLIT-FILE          VALUE 'N'.    MLKRP055
00172      05  SW-EMPTY-EDIT-SPLIT-FILE-SW  PIC X         VALUE 'N'.    MLKRP055
00173          88  SW-EMPTY-EDIT-SPLIT-FILE               VALUE 'Y'.    MLKRP055
00174          88  SW-NOT-EMPTY-EDIT-SPLIT-FILE           VALUE 'N'.    MLKRP055
00175      05  SW-STORE-BREAK-SW            PIC X         VALUE 'N'.    MLKRP055
00176          88  SW-STORE-BREAK                         VALUE 'Y'.    MLKRP055
00177          88  SW-NOT-STORE-BREAK                     VALUE 'N'.    MLKRP055
00178      05  SW-TRANS-CDE-BREAK-SW        PIC X         VALUE 'N'.    MLKRP055
00179          88  SW-TRANS-CDE-BREAK                     VALUE 'Y'.    MLKRP055
00180          88  SW-NOT-TRANS-CDE-BREAK                 VALUE 'N'.    MLKRP055
00181      05  SW-FIN-LIAB-BREAK-SW         PIC X         VALUE 'N'.    MLKRP055
00182          88  SW-FIN-LIAB-BREAK                      VALUE 'Y'.    MLKRP055
00183          88  SW-NOT-FIN-LIAB-BREAK                  VALUE 'N'.    MLKRP055
00184      05  SW-BATCH-NBR-BREAK-SW        PIC X         VALUE 'N'.    MLKRP055
00185          88  SW-BATCH-NBR-BREAK                     VALUE 'Y'.    MLKRP055
00186          88  SW-NOT-BATCH-NBR-BREAK                 VALUE 'N'.    MLKRP055
00187      05  SW-CURR-OR-NEXT-FISC-PER-SW  PIC X         VALUE SPACE.  MLKRP055
00188          88  SW-CURR-FISC-PER                       VALUE 'C'.    MLKRP055
00189          88  SW-NEXT-FISC-PER                       VALUE 'N'.    MLKRP055
00190      05  SW-DETAIL-REPORTED-SW        PIC X         VALUE 'N'.    MLKRP055
00191          88  SW-DETAIL-REPORTED                     VALUE 'Y'.    MLKRP055
00192          88  SW-DETAIL-NOT-REPORTED                 VALUE 'N'.    MLKRP055
00193                                                                   MLKRP055
00194  01  FPN-FSCL-PER-NAME-TABLE-DATA.                                MLKRP055
00195          15  FPN-ENTRY01-DATA         PIC X(09) VALUE 'FEBRUARY '.MLKRP055
00196          15  FPN-ENTRY02-DATA         PIC X(09) VALUE 'MARCH    '.MLKRP055
00197          15  FPN-ENTRY03-DATA         PIC X(09) VALUE 'APRIL    '.MLKRP055
00198          15  FPN-ENTRY04-DATA         PIC X(09) VALUE 'MAY      '.MLKRP055
00199          15  FPN-ENTRY05-DATA         PIC X(09) VALUE 'JUNE     '.MLKRP055
00200          15  FPN-ENTRY06-DATA         PIC X(09) VALUE 'JULY     '.MLKRP055
00201          15  FPN-ENTRY07-DATA         PIC X(09) VALUE 'AUGUST   '.MLKRP055
00202          15  FPN-ENTRY08-DATA         PIC X(09) VALUE 'SEPTEMBER'.MLKRP055
00203          15  FPN-ENTRY09-DATA         PIC X(09) VALUE 'OCTOBER  '.MLKRP055
00204          15  FPN-ENTRY10-DATA         PIC X(09) VALUE 'NOVEMBER '.MLKRP055
00205          15  FPN-ENTRY11-DATA         PIC X(09) VALUE 'DECEMBER '.MLKRP055
00206          15  FPN-ENTRY12-DATA         PIC X(09) VALUE 'JANUARY  '.MLKRP055
00207                                                                   MLKRP055
00208  01  FPN-FSCL-PER-NAME-TABLE          REDEFINES                   MLKRP055
00209      FPN-FSCL-PER-NAME-TABLE-DATA.                                MLKRP055
00210      05  FPN-ENTRY                    OCCURS 12.                  MLKRP055
00211          10  FPN-FSCL-PER-NAME        PIC X(09).                  MLKRP055
00212                                                                   MLKRP055
00213  01  FPN-SUB-X.                                                   MLKRP055
00214      05  FPN-SUB                      PIC 9(02).                  MLKRP055
00215                                                                   MLKRP055
00216  01  TCT-TRANS-CDE-TABLE-DATA.                                    MLKRP055
00264      10  TCT-ENTRY1-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '10'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '10  '. MLKRP054
00266          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00267                                                   'PURCH ADJST'.  MLKRP054
00292                                                                   MLKRP054
21015      10  TCT-ENTRY8-DATA.                                         MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '1008'. MLKRP054
21015          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
21015                                                   'RECEIPTS   '.  MLKRP054
21015                                                                   MLKRP054
00268      10  TCT-ENTRY2-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '20'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '20  '. MLKRP054
00270          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00271                                                   'SALES'.        MLKRP054
00272      10  TCT-ENTRY3-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '30'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '30  '. MLKRP054
00274          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00275                                                   'TRANSFERS OUT'.MLKRP054
00276      10  TCT-ENTRY4-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '31'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '31  '. MLKRP054
00278          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00279                                                   'TRANSFERS IN'. MLKRP054
00280      10  TCT-ENTRY5-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '40'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '40  '. MLKRP054
00282          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00283                                                   'MARKDOWNS'.    MLKRP054
00284      10  TCT-ENTRY6-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '50'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '50  '. MLKRP054
00286          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00287                                                   'MARKUPS'.      MLKRP054
00288      10  TCT-ENTRY7-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '80'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '80  '. MLKRP054
00290          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00291                                                   'ADJUSTMENTS'.  MLKRP054
00245                                                                   MLKRP055
00246  01  TCT-TRANS-CDE-TABLE              REDEFINES                   MLKRP055
00247      TCT-TRANS-CDE-TABLE-DATA.                                    MLKRP055
00248 *    *------------------------------------------------------------MLKRP055
00249 *    *                !!! NOTE !!!                                MLKRP055
00250 *    *------------------------------------------------------------MLKRP055
00251 *    * IF ANY CHANGES ARE MADE TO THIS TABLE, THE HARD-CODED      MLKRP055
00252 *    * TABLE DATA (TCT-TRANS-CDE-TABLE-DATA) MUST BE CHANGED      MLKRP055
00253 *    * ACCORDINGLY.                                               MLKRP055
00254 *    *                                                            MLKRP055
00255 *    * IF THE  NUMBER OF ENTRIES IS CHANGED, TCT-MAX-ENTRIES      MLKRP055
00256 *    * MUST BE CHANGED TO REFLECT THE CORRECT NUMBER OF ENTRIES.  MLKRP055
00257 *    *------------------------------------------------------------MLKRP055
21015 **** 05  TCT-ENTRY                    OCCURS   7                  MLKRP055
21015      05  TCT-ENTRY                    OCCURS   8                  MLKRP055
00259                                       INDEXED BY TCT-IDX.         MLKRP055
00260          10  TCT-TRANS-CDE            PIC  X(02).                 MLKRP055
21015          10  TCT-SYS-ORIG-CDE         PIC  X(02).                 MLKRP054
00261          10  TCT-TRANS-CDE-DESC       PIC  X(15).                 MLKRP055
00262                                                                   MLKRP055
21015 **1  TCT-MAX-ENTRIES                  PIC S9(04)    VALUE +7      MLKRP055
21015  01  TCT-MAX-ENTRIES                  PIC S9(04)    VALUE +8      MLKRP055
00264                                                     COMP SYNC.    MLKRP055
00265                                                                   MLKRP055
00266  01  ABEND-CODE                  PIC S9(04)  VALUE ZERO COMP SYNC.MLKRP055
00267                                                                   MLKRP055
00268 ***************************************************************** MLKRP055
00269 * EDIT-SPLIT-RECORD LAYOUT.                                       MLKRP055
00270 ***************************************************************** MLKRP055
00271                                                                   MLKRP055
00272      COPY MLRD025.                                                   CL**3
00273                                                                   MLKRP055
00274 ******************************************************************MLKRP055
00275 * STANDARD REPORT HEADING                                         MLKRP055
00276 ******************************************************************MLKRP055
00277                                                                   MLKRP055
00278      COPY DPWS200O.                                               MLKRP055
00279                                                                   MLKRP055
00280  01  HD-ST-STORE-HEADING.                                         MLKRP055
00281      05  FILLER                       PIC  X(78)    VALUE SPACE.  MLKRP055
00282      05  FILLER                       PIC  X(11)    VALUE         MLKRP055
00283                                                     'EDIT SPLIT '.MLKRP055
00284      05  FILLER                       PIC  X(11)    VALUE         MLKRP055
00285                                                     'TOTALS FOR '.MLKRP055
00286      05  FILLER                       PIC  X(06)    VALUE         MLKRP055
00287                                                          'STORE '.MLKRP055
W26603     05  HD-ST-STORE-NBR              PIC  X(05).                 MLKRP055
00289      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00290      05  HD-ST-STORE-NAME             PIC  X(25).                 MLKRP055
00291      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00292      05  HD-ST-PROCESSING-MODE        PIC  X(20)    VALUE SPACE.  MLKRP055
00293                                                                   MLKRP055
00294  01  HD-FT-FINAL-TOTAL-HEADING.                                   MLKRP055
00295      05  FILLER                       PIC  X(87)    VALUE SPACE.  MLKRP055
00296      05  FILLER                       PIC  X(11)    VALUE         MLKRP055
00297                                                     'EDIT SPLIT '.MLKRP055
00298      05  FILLER                       PIC  X(12)    VALUE         MLKRP055
00299                                                    'FINAL TOTALS'.MLKRP055
00300      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00301      05  HD-FT-PROCESSING-MODE        PIC  X(20)    VALUE SPACE.  MLKRP055
00302                                                                   MLKRP055
00303  01  HD-ED-EDIT-DATE-HEADING.                                     MLKRP055
00304      05  FILLER                       PIC  X(92)    VALUE SPACE.  MLKRP055
00305      05  FILLER                       PIC  X(03)    VALUE 'FOR'.  MLKRP055
00306      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00307      05  HD-ED-DATE.                                              MLKRP055
00308          15  HD-ED-DATE-MM            PIC  X(02).                 MLKRP055
00309          15  FILLER                   PIC  X        VALUE '/'.    MLKRP055
00310          15  HD-ED-DATE-DD            PIC  X(02).                 MLKRP055
00311          15  FILLER                   PIC  X        VALUE '/'.    MLKRP055
00312          15  HD-ED-DATE-YY            PIC  X(02).                 MLKRP055
00313                                                                   MLKRP055
00314  01  HD-FP-FISCAL-PER-HEADING.                                    MLKRP055
00315      05  FILLER                       PIC  X(29)    VALUE SPACE.  MLKRP055
00316      05  FILLER                       PIC  X(31)    VALUE ALL '-'.MLKRP055
           05  FILLER                       PIC  X(09)    VALUE SPACE.  MLKRP055
00318      05  HD-FP-CURR-FISC-PERIOD-NAME  PIC  X(09).                 MLKRP055
00319      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00320      05  FILLER                       PIC  X(36)    VALUE ALL '-'.MLKRP055
00321      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP055
00322      05  FILLER                       PIC  X(37)    VALUE ALL '-'.MLKRP055
00323      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00324      05  HD-FP-NEXT-FISC-PERIOD-NAME  PIC  X(09).                 MLKRP055
00325      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
           05  FILLER                       PIC  X(28)    VALUE ALL '-'.MLKRP055
00327                                                                   MLKRP055
00328  01  HD-MI-ML-INV-HEADING.                                        MLKRP055
           05  FILLER                       PIC  X(45)    VALUE SPACE.  MLKRP055
00330      05  FILLER                       PIC  X(18)    VALUE         MLKRP055
00331                                              'MERCHANDISE LEDGER'.MLKRP055
00332      05  FILLER                       PIC  X(24)    VALUE SPACE.  MLKRP055
00333      05  FILLER                       PIC  X(16)    VALUE         MLKRP055
00334                                                'INVENTORY LEDGER'.MLKRP055
00335      05  FILLER                       PIC  X(26)    VALUE SPACE.  MLKRP055
00336      05  FILLER                       PIC  X(18)    VALUE         MLKRP055
00337                                              'MERCHANDISE LEDGER'.MLKRP055
00338      05  FILLER                       PIC  X(24)    VALUE SPACE.  MLKRP055
00339      05  FILLER                       PIC  X(16)    VALUE         MLKRP055
00340                                                'INVENTORY LEDGER'.MLKRP055
00341  01  HD-CL-COLUMN-HEADING.                                        MLKRP055
00342      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00343      05  HD-CL-EFF-DATE-HD-LIT        PIC  X(08)    VALUE SPACE.  MLKRP055
00344      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP055
00345      05  HD-CL-BATCH-HD-LIT           PIC  X(05)    VALUE SPACE.  MLKRP055
00346      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP055
00347      05  HD-CL-DOCUMENT-HD-LIT        PIC  X(08)    VALUE SPACE.  MLKRP055
           05  FILLER                       PIC  X(15)    VALUE SPACE.  MLKRP055
00349      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP055
00350      05  FILLER                       PIC  X(15)    VALUE SPACE.  MLKRP055
00351      05  FILLER                       PIC  X(06)    VALUE         MLKRP055
00352                                                          'RETAIL'.MLKRP055
           05  FILLER                       PIC  X(17)    VALUE SPACE.  MLKRP055
00354      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP055
00355      05  FILLER                       PIC  X(16)    VALUE SPACE.  MLKRP055
00356      05  FILLER                       PIC  X(06)    VALUE         MLKRP055
00357                                                          'RETAIL'.MLKRP055
           05  FILLER                       PIC  X(16)    VALUE SPACE.  MLKRP055
00359      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP055
00360      05  FILLER                       PIC  X(14)    VALUE SPACE.  MLKRP055
00361      05  FILLER                       PIC  X(06)    VALUE         MLKRP055
00362                                                          'RETAIL'.MLKRP055
           05  FILLER                       PIC  X(16)    VALUE SPACE.  MLKRP055
00364      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP055
00365      05  FILLER                       PIC  X(17)    VALUE SPACE.  MLKRP055
00366      05  FILLER                       PIC  X(06)    VALUE         MLKRP055
00367                                                          'RETAIL'.MLKRP055
00368                                                                   MLKRP055
00369  01  HD-TC-TRANS-CDE-HEADING.                                     MLKRP055
00370      05  HD-TC-TRANS-CDE-DESC         PIC  X(15).                 MLKRP055
00371                                                                   MLKRP055
00372  01  DL-DETAIL-LINE.                                              MLKRP055
00373      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00374      05  DL-EFF-DATE.                                             MLKRP055
00375          10  DL-EFF-DATE-MM           PIC  X(02).                 MLKRP055
00376          10  DL-EFF-DATE-SLASH1       PIC  X.                     MLKRP055
00377          10  DL-EFF-DATE-DD           PIC  X(02).                 MLKRP055
00378          10  DL-EFF-DATE-SLASH2       PIC  X.                     MLKRP055
00379          10  DL-EFF-DATE-YY           PIC  X(02).                 MLKRP055
00380      05  FILLER                       PIC  X(04)    VALUE SPACE.  MLKRP055
00381      05  DL-BATCH-NBR                 PIC  X(04).                 MLKRP055
           05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP055
           05  DL-DOC-NBR.                                              MLKRP055
W26603         10  DL-DOC-FAST-LIT          PIC  X(04)    VALUE 'FAST'.         
W26603         10  DL-DOC-STORE             PIC  X(04).                         
               10  DL-DOC-HYPHEN            PIC  X        VALUE '-'.            
               10  DL-DOC-SEQ               PIC  X(06).                         
00384      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP055
00385      05  DL-CURR-ML-COST              PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00386      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00387      05  DL-CURR-ML-RETAIL            PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00388      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00389      05  DL-CURR-INV-COST             PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00390      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00391      05  DL-CURR-INV-RETAIL           PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00392      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00393      05  DL-NEXT-ML-COST              PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00394      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00395      05  DL-NEXT-ML-RETAIL            PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00396      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00397      05  DL-NEXT-INV-COST             PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00398      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP055
00399      05  DL-NEXT-INV-RETAIL           PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP055
00400                                                                   MLKRP055
00401  01  TL-FL1-FIN-LIAB-TOTAL-LINE-1.                                MLKRP055
00402      05  FILLER                       PIC  X(2)     VALUE SPACE.  MLKRP055
00403      05  TL-FL1-EFF-DATE-MM           PIC  X(2).                  MLKRP055
00404      05  FILLER                       PIC  X        VALUE '/'.    MLKRP055
00405      05  TL-FL1-EFF-DATE-DD           PIC  X(2).                  MLKRP055
00406      05  FILLER                       PIC  X        VALUE '/'.    MLKRP055
00407      05  TL-FL1-EFF-DATE-YY           PIC  X(2).                  MLKRP055
00408                                                                   MLKRP055
00409  01  TL-FL2-FIN-LIAB-TOTAL-LINE-2.                                MLKRP055
00410      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP055
00411      05  FILLER                       PIC  X(05)    VALUE 'TOTAL'.MLKRP055
00412      05  FILLER                       PIC  X(26)    VALUE SPACE.  MLKRP055
00413      05  TL-FL2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00414      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00415      05  TL-FL2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00417      05  TL-FL2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00419      05  TL-FL2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00421      05  TL-FL2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00423      05  TL-FL2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00425      05  TL-FL2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00427      05  TL-FL2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00428                                                                   MLKRP055
00429  01  TL-TC1-TRANS-CDE-TOTAL-LINE-1.                               MLKRP055
00430      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00431      05  TL-TC1-TRANS-CDE-DESC        PIC  X(15).                 MLKRP055
00432                                                                   MLKRP055
00433  01  TL-TC2-TRANS-CDE-TOTAL-LINE-2.                               MLKRP055
00432      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00435      05  FILLER                       PIC  X(05)    VALUE 'TOTAL'.MLKRP055
           05  FILLER                       PIC  X(27)    VALUE SPACE.  MLKRP055
00437      05  TL-TC2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00438      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00439      05  TL-TC2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00441      05  TL-TC2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00443      05  TL-TC2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00444      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00445      05  TL-TC2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00446      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00447      05  TL-TC2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00449      05  TL-TC2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00451      05  TL-TC2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00452                                                                   MLKRP055
00453  01  TL-ST1-STORE-TOTAL-LINE-1.                                   MLKRP055
00454      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00455      05  FILLER                       PIC  X(05)    VALUE 'STORE'.MLKRP055
00456      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
W26603     05  TL-ST1-STORE-NBR             PIC  X(05).                 MLKRP055
00458                                                                   MLKRP055
00459  01  TL-ST2-STORE-TOTAL-LINE-2.                                   MLKRP055
00460      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00461      05  FILLER                       PIC  X(05)    VALUE 'TOTAL'.MLKRP055
           05  FILLER                       PIC  X(27)    VALUE SPACE.  MLKRP055
00463      05  TL-ST2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00464      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00465      05  TL-ST2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00467      05  TL-ST2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00469      05  TL-ST2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00471      05  TL-ST2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00473      05  TL-ST2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00475      05  TL-ST2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00477      05  TL-ST2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00478                                                                   MLKRP055
00479  01  TL-FN1-FINAL-TOTAL-LINE-1.                                   MLKRP055
00480      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00481      05  FILLER                       PIC  X(05)    VALUE 'FINAL'.MLKRP055
00482                                                                   MLKRP055
00483  01  TL-FN2-FINAL-TOTAL-LINE-2.                                   MLKRP055
00484      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00485      05  FILLER                       PIC  X(05)    VALUE 'TOTAL'.MLKRP055
           05  FILLER                       PIC  X(27)    VALUE SPACE.  MLKRP055
00487      05  TL-FN2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00488      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00489      05  TL-FN2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00491      05  TL-FN2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00493      05  TL-FN2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00495      05  TL-FN2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00497      05  TL-FN2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00499      05  TL-FN2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
           05  FILLER                       PIC  X        VALUE SPACE.  MLKRP055
00501      05  TL-FN2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP055
00502                                                                   MLKRP055
00503  01  ER-END-OF-REPORT-LINE.                                       MLKRP055
00504      05  FILLER                       PIC  X(21)    VALUE         MLKRP055
00505                                           '*** END OF REPORT ***'.MLKRP055
00506                                                                   MLKRP055
00507 ***************************************************************** MLKRP055
00508 *  SQL ABEND ROUTINE WORKING STORAGE                              MLKRP055
00509 ***************************************************************** MLKRP055
00510                                                                   MLKRP055
00511      COPY DPWS004.                                                MLKRP055
00512                                                                   MLKRP055
00513 ***************************************************************** MLKRP055
00514 * DB2 STORE TABLE DCLGEN.                                         MLKRP055
00515 ***************************************************************** MLKRP055
00516                                                                   MLKRP055
00517      EXEC SQL                                                     MLKRP055
00518          INCLUDE XMT00001                                         MLKRP055
00519      END-EXEC.                                                    MLKRP055
00520                                                                   MLKRP055
00521      EXEC SQL                                                     MLKRP055
00522          INCLUDE SQLCA                                            MLKRP055
00523      END-EXEC.                                                    MLKRP055
00524                                                                   MLKRP055
00525  LINKAGE SECTION.                                                 MLKRP055
00526                                                                   MLKRP055
00527                                                                   MLKRP055
00528  PROCEDURE DIVISION.                                              MLKRP055
00529                                                                   MLKRP055
00530  A100-MAIN-MODULE.                                                MLKRP055
00531                                                                   MLKRP055
00532      OPEN INPUT  EDIT-SPLIT-FILE                                  MLKRP055
00533           OUTPUT STORE-SPLIT-REPORT.                              MLKRP055
00534                                                                   MLKRP055
00535      PERFORM B100-PROCESS-CONTROL-CARD.                           MLKRP055
00536                                                                   MLKRP055
00537      PERFORM B200-CREATE-REPORT.                                  MLKRP055
00538                                                                   MLKRP055
00539      CLOSE EDIT-SPLIT-FILE                                        MLKRP055
00540            STORE-SPLIT-REPORT.                                    MLKRP055
00541                                                                   MLKRP055
00542      STOP RUN.                                                    MLKRP055
00543                                                                   MLKRP055
00544                                                                   MLKRP055
00545 ******************************************************************MLKRP055
00546 * MAKE SURE THAT THE EDIT-SPLIT FILE CONTAINS A CONTROL CARD AS   MLKRP055
00547 * THE FIRST RECORD. IF THE CONTROL CARD IS PRESENT, USE ITS       MLKRP055
00548 * FIELDS TO BUILD SOME OF THE HEADING FIELDS.                     MLKRP055
00549 ******************************************************************MLKRP055
00550  B100-PROCESS-CONTROL-CARD.                                       MLKRP055
00551                                                                   MLKRP055
00552      MOVE 'B100-PROCESS-CONTROL-CARD' TO PV-PARAGRAPH-NAME.       MLKRP055
00553                                                                   MLKRP055
00554      PERFORM Z100-READ-EDIT-SPLIT-FILE.                           MLKRP055
00555                                                                   MLKRP055
00556      IF SW-END-OF-EDIT-SPLIT-FILE                                 MLKRP055
00557          MOVE 'NO CONTROL CARD ON EDIT-SPLIT-FILE'                MLKRP055
00558                     TO PV-ABEND-MESSAGE                           MLKRP055
00559          MOVE SPACE TO EDIT-SPLIT-RECORD                          MLKRP055
00560          MOVE +4003 TO ABEND-CODE                                 MLKRP055
00561          PERFORM Z999-ABEND                                       MLKRP055
00562      ELSE                                                         MLKRP055
00563          IF NOT ML025-RPT1-CNTL-CARD-HDR-REC                      MLKRP055
00564              MOVE '1ST RECORD ON EDIT-SPLIT-FILE NOT CONTROL CARD'MLKRP055
00565                         TO PV-ABEND-MESSAGE                       MLKRP055
00566              MOVE +4003 TO ABEND-CODE                             MLKRP055
00567              PERFORM Z999-ABEND                                   MLKRP055
00568          ELSE                                                     MLKRP055
00569              PERFORM UNTIL ML025-RPT1-DETAIL-REC                  MLKRP055
00570                         OR SW-END-OF-EDIT-SPLIT-FILE              MLKRP055
00571                  MOVE ML025-RPT1-CNTL-CARD-RECORD                 MLKRP055
00572                                     TO PV-LAST-CNTL-CARD-READ     MLKRP055
00573                  MOVE ML025-RPT1-EDIT-DTE      TO PV-ISO-FMT-DATE MLKRP055
00574                  MOVE PV-ISO-FMT-MM            TO HD-ED-DATE-MM   MLKRP055
00575                  MOVE PV-ISO-FMT-DD            TO HD-ED-DATE-DD   MLKRP055
00576                  MOVE PV-ISO-FMT-YY            TO HD-ED-DATE-YY   MLKRP055
00577                  MOVE ML025-RPT1-CURR-FSCL-YR-PER                 MLKRP055
00578                                    TO SA-CURR-FSCL-YR-PER         MLKRP055
00579                  MOVE ML025-RPT1-CURR-FSCL-PER-CDE                MLKRP055
00580                                    TO FPN-SUB-X                   MLKRP055
00581                  MOVE FPN-FSCL-PER-NAME (FPN-SUB)                 MLKRP055
00582                                    TO HD-FP-CURR-FISC-PERIOD-NAME MLKRP055
00583                  MOVE ML025-RPT1-NEXT-FSCL-PER-CDE                MLKRP055
00584                                    TO FPN-SUB-X                   MLKRP055
00585                  MOVE FPN-FSCL-PER-NAME (FPN-SUB)                 MLKRP055
00586                                    TO HD-FP-NEXT-FISC-PERIOD-NAME MLKRP055
00587                  IF ML025-RPT1-MODE-INV-ONLY                      MLKRP055
00588                      MOVE PC-INVENTORY-ONLY-MODE                  MLKRP055
00589                                    TO HD-ST-PROCESSING-MODE       MLKRP055
00590                                       HD-FT-PROCESSING-MODE       MLKRP055
00591                  END-IF                                           MLKRP055
00592                  PERFORM Z100-READ-EDIT-SPLIT-FILE                MLKRP055
00593              END-PERFORM                                          MLKRP055
00594              DISPLAY '** MLKRP055 INPUT CONTROL CARD ='           MLKRP055
00595                       PV-LAST-CNTL-CARD-READ                      MLKRP055
00596          END-IF                                                   MLKRP055
00597      END-IF.                                                      MLKRP055
00598                                                                   MLKRP055
00599                                                                   MLKRP055
00600 ******************************************************************MLKRP055
00601 * CREATE THE STORE EDIT SPLIT REPORT BY DOCUMENT NUMBER WITHIN    MLKRP055
00602 * BATCH WITHIN FINANCIAL LIABILITY DATE WITHIN TRANS CDE WITHIN   MLKRP055
00603 * STORE.                                                          MLKRP055
00604 ******************************************************************MLKRP055
00605  B200-CREATE-REPORT.                                              MLKRP055
00606                                                                   MLKRP055
00607      PERFORM C200-INITIALIZATION.                                 MLKRP055
00608      PERFORM Z300-PRINT-STD-RPT-HEADING.                          MLKRP055
00609                                                                   MLKRP055
00610      IF SW-NOT-END-OF-EDIT-SPLIT-FILE                             MLKRP055
               PERFORM Z700-BUILD-EDITED-DOC-NBR                                
               MOVE ED-DOC-NBR               TO SA-PREV-DOC-NBR         MLKRP055
00612          MOVE ML025-RPT1-BATCH-NBR     TO SA-PREV-BATCH-NBR       MLKRP055
00613          MOVE ML025-RPT1-FIN-LIAB-DTE  TO SA-PREV-FIN-LIAB-DTE    MLKRP055
00614          MOVE ML025-RPT1-TRANS-CDE     TO SA-PREV-TRANS-CDE       MLKRP055
21015          MOVE ML025-RPT1-SYST-ORIG-CDE TO SA-PREV-SYST-ORIG-CDE           
00615          MOVE ML025-RPT1-STORE-NBR     TO SA-PREV-STORE-NBR       MLKRP055
00616          MOVE ML025-RPT1-STORE-NBR     TO HD-ST-STORE-NBR         MLKRP055
00617                                           TL-ST1-STORE-NBR        MLKRP055
W26603         PERFORM Z600-READ-XMTLOC                                 MLKRP055
W26603         MOVE XMT00001-LOC-NM          TO HD-ST-STORE-NAME        MLKRP055
00620                                                                   MLKRP055
00621          PERFORM Z350-PRINT-STORE-HEADING                         MLKRP055
00622          PERFORM Z400-PRINT-CONSTANT-HEADINGS                     MLKRP055
00623          PERFORM Z500-PRINT-TRANS-CDE-HEADING                     MLKRP055
00624                                                                   MLKRP055
00625          MOVE ML025-RPT1-FIN-LIAB-DTE TO PV-ISO-FMT-DATE          MLKRP055
00626          MOVE PV-ISO-FMT-MM           TO DL-EFF-DATE-MM           MLKRP055
00627                                          TL-FL1-EFF-DATE-MM       MLKRP055
00628          MOVE PV-ISO-FMT-DD           TO DL-EFF-DATE-DD           MLKRP055
00629                                          TL-FL1-EFF-DATE-DD       MLKRP055
00630          MOVE PV-ISO-FMT-YY           TO DL-EFF-DATE-YY           MLKRP055
00631                                          TL-FL1-EFF-DATE-YY       MLKRP055
00632          MOVE '/'                     TO DL-EFF-DATE-SLASH1       MLKRP055
00633                                          DL-EFF-DATE-SLASH2       MLKRP055
00634          MOVE ML025-RPT1-BATCH-NBR    TO DL-BATCH-NBR             MLKRP055
00635          IF ML025-RPT1-FSCL-YR-PER > SA-CURR-FSCL-YR-PER          MLKRP055
00636              SET SW-NEXT-FISC-PER TO TRUE                         MLKRP055
00637          ELSE                                                     MLKRP055
00638              SET SW-CURR-FISC-PER TO TRUE                         MLKRP055
00639          END-IF                                                   MLKRP055
00640                                                                   MLKRP055
00641          PERFORM C300-PROCESS-EDIT-SPLIT-FILE                     MLKRP055
00642              UNTIL SW-END-OF-EDIT-SPLIT-FILE                      MLKRP055
00643                                                                   MLKRP055
00644          PERFORM D050-DOC-NBR-BREAK                               MLKRP055
00645          PERFORM D100-BATCH-NBR-BREAK                             MLKRP055
00646          PERFORM D200-FIN-LIAB-BREAK                              MLKRP055
00647          PERFORM D300-TRANS-CDE-BREAK                             MLKRP055
00648          PERFORM D400-STORE-NBR-BREAK                             MLKRP055
00649          MOVE SPACE TO HD-ST-STORE-NBR                            MLKRP055
00650                        HD-ST-STORE-NAME                           MLKRP055
00651          PERFORM C400-PRINT-FINAL-TOTALS                          MLKRP055
00652      ELSE                                                         MLKRP055
00653          SET SW-EMPTY-EDIT-SPLIT-FILE TO TRUE                     MLKRP055
00654      END-IF.                                                      MLKRP055
00655                                                                   MLKRP055
00656      MOVE ER-END-OF-REPORT-LINE TO STORE-SPLIT-REPORT-LINE.       MLKRP055
00657      MOVE 3 TO PV-ADVANCE.                                        MLKRP055
00658      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00659                                                                   MLKRP055
00660                                                                   MLKRP055
00661 ******************************************************************MLKRP055
00662 * INITIALIZE FIELDS AS NECESSARY FOR THE STORE SPLIT REPORT.     *MLKRP055
00663 ******************************************************************MLKRP055
00664  C200-INITIALIZATION.                                             MLKRP055
00665                                                                   MLKRP055
00666      INITIALIZE PV-PAGE-COUNT                                     MLKRP055
00667                 TOT-TOTAL-FIELDS.                                 MLKRP055
00668                                                                   MLKRP055
00669      SET SW-NOT-EMPTY-EDIT-SPLIT-FILE                             MLKRP055
00670          SW-NOT-STORE-BREAK                                       MLKRP055
00671          SW-NOT-TRANS-CDE-BREAK                                   MLKRP055
00672          SW-NOT-FIN-LIAB-BREAK                                    MLKRP055
00673          SW-NOT-BATCH-NBR-BREAK TO TRUE.                          MLKRP055
00674                                                                   MLKRP055
00675      ACCEPT PV-YYMMDD-DATE FROM DATE.                             MLKRP055
00676      MOVE   PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      MLKRP055
00677      MOVE   PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     MLKRP055
00678      MOVE   PV-YYMMDD-DD TO DP200O-RUN-DAY.                       MLKRP055
00679      ACCEPT PV-TIME-HHMMSS FROM TIME.                             MLKRP055
00680      MOVE PV-TIME-HHMMSS-HH   TO DP200O-RUN-HOUR.                 MLKRP055
00681      MOVE PV-TIME-HHMMSS-MM   TO DP200O-RUN-MINUTE.               MLKRP055
00682      MOVE 'MLKRP055'          TO DP200O-PROGRAM-NAME.             MLKRP055
00683      MOVE 1 TO DP200O-REPORT-NUMBER.                              MLKRP055
00684                                                                   MLKRP055
00685      MOVE PC-EFF-DATE-HD-LIT   TO HD-CL-EFF-DATE-HD-LIT.          MLKRP055
00686      MOVE PC-BATCH-HD-LIT      TO HD-CL-BATCH-HD-LIT.             MLKRP055
00687      MOVE PC-DOCUMENT-HD-LIT   TO HD-CL-DOCUMENT-HD-LIT.          MLKRP055
00688                                                                   MLKRP055
00689                                                                   MLKRP055
00690 ******************************************************************MLKRP055
00691 * READ AND PROCESS THE INPUT FILE. BEFORE EACH RECORD IS         *MLKRP055
00692 * PROCESSED, CHECK FOR CONTROL BREAKS, AND DO ANY NECESSARY      *MLKRP055
00693 * CONTROL BREAK PROCESSING.                                      *MLKRP055
00694 ******************************************************************MLKRP055
00695  C300-PROCESS-EDIT-SPLIT-FILE.                                    MLKRP055
00696                                                                   MLKRP055
           PERFORM Z700-BUILD-EDITED-DOC-NBR                                    
                                                                                
00697      EVALUATE TRUE                                                MLKRP055
00698                                                                   MLKRP055
00699          WHEN ML025-RPT1-STORE-NBR NOT = SA-PREV-STORE-NBR        MLKRP055
00700              PERFORM D050-DOC-NBR-BREAK                           MLKRP055
00701              PERFORM D100-BATCH-NBR-BREAK                         MLKRP055
00702              PERFORM D200-FIN-LIAB-BREAK                          MLKRP055
00703              PERFORM D300-TRANS-CDE-BREAK                         MLKRP055
00704              PERFORM D400-STORE-NBR-BREAK                         MLKRP055
00705              SET SW-STORE-BREAK TO TRUE                           MLKRP055
00706                                                                   MLKRP055
00707          WHEN ML025-RPT1-TRANS-CDE NOT = SA-PREV-TRANS-CDE        MLKRP055
21015            OR ML025-RPT1-SYST-ORIG-CDE NOT = SA-PREV-SYST-ORIG-CDE        
00708              PERFORM D050-DOC-NBR-BREAK                           MLKRP055
00709              PERFORM D100-BATCH-NBR-BREAK                         MLKRP055
00710              PERFORM D200-FIN-LIAB-BREAK                          MLKRP055
00711              PERFORM D300-TRANS-CDE-BREAK                         MLKRP055
00712              SET SW-TRANS-CDE-BREAK TO TRUE                       MLKRP055
00713                                                                   MLKRP055
00714          WHEN ML025-RPT1-FIN-LIAB-DTE NOT = SA-PREV-FIN-LIAB-DTE  MLKRP055
00715              PERFORM D050-DOC-NBR-BREAK                           MLKRP055
00716              PERFORM D100-BATCH-NBR-BREAK                         MLKRP055
00717              PERFORM D200-FIN-LIAB-BREAK                          MLKRP055
00718              SET SW-FIN-LIAB-BREAK TO TRUE                        MLKRP055
00719                                                                   MLKRP055
00720          WHEN ML025-RPT1-BATCH-NBR NOT = SA-PREV-BATCH-NBR        MLKRP055
00721              PERFORM D050-DOC-NBR-BREAK                           MLKRP055
00722              PERFORM D100-BATCH-NBR-BREAK                         MLKRP055
00723              SET SW-BATCH-NBR-BREAK TO TRUE                       MLKRP055
00724                                                                   MLKRP055
00725          WHEN ED-DOC-NBR NOT = SA-PREV-DOC-NBR                    MLKRP055
00726              PERFORM D050-DOC-NBR-BREAK                           MLKRP055
00727                                                                   MLKRP055
00728      END-EVALUATE.                                                MLKRP055
00729                                                                   MLKRP055
00730      PERFORM D500-PROCESS-EDIT-SPLIT-REC.                         MLKRP055
00731      PERFORM Z100-READ-EDIT-SPLIT-FILE.                           MLKRP055
00732                                                                   MLKRP055
00733                                                                   MLKRP055
00734 ******************************************************************MLKRP055
00735 * PRINT THE FINAL TOTAL PAGE FOR THE STORE SPLIT REPORT.          MLKRP055
00736 ******************************************************************MLKRP055
00737  C400-PRINT-FINAL-TOTALS.                                         MLKRP055
00738                                                                   MLKRP055
00739      PERFORM Z300-PRINT-STD-RPT-HEADING.                          MLKRP055
00740      MOVE SPACE TO HD-CL-EFF-DATE-HD-LIT                          MLKRP055
00741                    HD-CL-BATCH-HD-LIT                             MLKRP055
00742                    HD-CL-DOCUMENT-HD-LIT.                         MLKRP055
00743      PERFORM Z375-PRINT-FINAL-TOT-HEADING.                        MLKRP055
00744      PERFORM Z400-PRINT-CONSTANT-HEADINGS.                        MLKRP055
00745      MOVE TL-FN1-FINAL-TOTAL-LINE-1 TO STORE-SPLIT-REPORT-LINE.   MLKRP055
00746      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00747                                                                   MLKRP055
00748      MOVE TOT-FNL-CURR-ML-COST    TO TL-FN2-CURR-ML-COST.         MLKRP055
00749      MOVE TOT-FNL-CURR-ML-RETAIL  TO TL-FN2-CURR-ML-RETAIL.       MLKRP055
00750      MOVE TOT-FNL-CURR-INV-COST   TO TL-FN2-CURR-INV-COST.        MLKRP055
00751      MOVE TOT-FNL-CURR-INV-RETAIL TO TL-FN2-CURR-INV-RETAIL.      MLKRP055
00752      MOVE TOT-FNL-NEXT-ML-COST    TO TL-FN2-NEXT-ML-COST.         MLKRP055
00753      MOVE TOT-FNL-NEXT-ML-RETAIL  TO TL-FN2-NEXT-ML-RETAIL.       MLKRP055
00754      MOVE TOT-FNL-NEXT-INV-COST   TO TL-FN2-NEXT-INV-COST.        MLKRP055
00755      MOVE TOT-FNL-NEXT-INV-RETAIL TO TL-FN2-NEXT-INV-RETAIL.      MLKRP055
00756                                                                   MLKRP055
00757      MOVE TL-FN2-FINAL-TOTAL-LINE-2 TO STORE-SPLIT-REPORT-LINE.   MLKRP055
00758      MOVE 1 TO PV-ADVANCE.                                        MLKRP055
00759      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00760                                                                   MLKRP055
00761                                                                   MLKRP055
00762 ******************************************************************MLKRP055
00763 * CHECK THE TOTALS FOR THE DOC-NBR. IF THEY ARE ALL ZERO, SKIP    MLKRP055
00764 * THE BREAK PROCESSING SO THAT THE DETAIL LINE WILL NOT BE        MLKRP055
00765 * PRODUCED.  IF ANY ARE NOT ZERO, CONTINUE THE BREAK PROCESSING.  MLKRP055
00766 ******************************************************************MLKRP055
00767  D050-DOC-NBR-BREAK.                                              MLKRP055
00768                                                                   MLKRP055
00769      IF  TOT-DOC-CURR-ML-COST     = ZERO                          MLKRP055
00770      AND TOT-DOC-CURR-ML-RETAIL   = ZERO                          MLKRP055
00771      AND TOT-DOC-CURR-INV-COST    = ZERO                          MLKRP055
00772      AND TOT-DOC-CURR-INV-RETAIL  = ZERO                          MLKRP055
00773      AND TOT-DOC-NEXT-ML-COST     = ZERO                          MLKRP055
00774      AND TOT-DOC-NEXT-ML-RETAIL   = ZERO                          MLKRP055
00775      AND TOT-DOC-NEXT-INV-COST    = ZERO                          MLKRP055
00776      AND TOT-DOC-NEXT-INV-RETAIL  = ZERO                          MLKRP055
00777          CONTINUE                                                 MLKRP055
00778      ELSE                                                         MLKRP055
00779          SET SW-DETAIL-REPORTED TO TRUE                           MLKRP055
00780          PERFORM E100-CONTINUE-DOC-NBR-BREAK                      MLKRP055
00781      END-IF.                                                      MLKRP055
00782                                                                   MLKRP055
           PERFORM Z700-BUILD-EDITED-DOC-NBR                                    
           MOVE ED-DOC-NBR             TO SA-PREV-DOC-NBR.              MLKRP055
00784                                                                   MLKRP055
00785                                                                   MLKRP055
00786 ******************************************************************MLKRP055
00787 * PROCESS A BREAK ON BATCH-NBR: ADD THE BATCH-NBR TOTALS TO       MLKRP055
00788 * THE NEXT HIGHER LEVEL TOTALS, AND INITIALIZE THE BATCH-NBR      MLKRP055
00789 * TOTALS. (BATCH NUMBER TOTALS ARE NOT PRINTED ON THE REPORT.)    MLKRP055
00790 ******************************************************************MLKRP055
00791  D100-BATCH-NBR-BREAK.                                            MLKRP055
00792                                                                   MLKRP055
00793      ADD TOT-BCH-CURR-ML-COST    TO TOT-FLB-CURR-ML-COST.         MLKRP055
00794      ADD TOT-BCH-CURR-ML-RETAIL  TO TOT-FLB-CURR-ML-RETAIL.       MLKRP055
00795      ADD TOT-BCH-CURR-INV-COST   TO TOT-FLB-CURR-INV-COST.        MLKRP055
00796      ADD TOT-BCH-CURR-INV-RETAIL TO TOT-FLB-CURR-INV-RETAIL.      MLKRP055
00797      ADD TOT-BCH-NEXT-ML-COST    TO TOT-FLB-NEXT-ML-COST.         MLKRP055
00798      ADD TOT-BCH-NEXT-ML-RETAIL  TO TOT-FLB-NEXT-ML-RETAIL.       MLKRP055
00799      ADD TOT-BCH-NEXT-INV-COST   TO TOT-FLB-NEXT-INV-COST.        MLKRP055
00800      ADD TOT-BCH-NEXT-INV-RETAIL TO TOT-FLB-NEXT-INV-RETAIL.      MLKRP055
00801                                                                   MLKRP055
00802      INITIALIZE TOT-BCH-BATCH-NBR-TOTALS.                         MLKRP055
00803      MOVE ML025-RPT1-BATCH-NBR    TO SA-PREV-BATCH-NBR.           MLKRP055
00804                                                                   MLKRP055
00805                                                                   MLKRP055
00806 ******************************************************************MLKRP055
00807 * PROCESS A BREAK ON FIN-LIAB-DTE: FORMAT AND PRINT THE TOTAL     MLKRP055
00808 * LINE, ADD THE FIN-LIAB TOTALS TO THE NEXT HIGHER LEVEL TOTALS,  MLKRP055
00809 * AND INITIALIZE THE FIN-LIAB TOTALS. NOTE THAT THE TOTAL LINE IS MLKRP055
00810 * ONLY PRINTED IF THERE WERE DETAIL LINES PRINTED.                MLKRP055
00811 ******************************************************************MLKRP055
00812  D200-FIN-LIAB-BREAK.                                             MLKRP055
00813                                                                   MLKRP055
00814      IF SW-DETAIL-REPORTED                                        MLKRP055
00815          SET SW-DETAIL-NOT-REPORTED TO TRUE                       MLKRP055
00816          MOVE TL-FL1-FIN-LIAB-TOTAL-LINE-1                        MLKRP055
00817                                   TO STORE-SPLIT-REPORT-LINE      MLKRP055
00818          MOVE 2 TO PV-ADVANCE                                     MLKRP055
00819          PERFORM Z200-WRITE-REPORT-LINE                           MLKRP055
00820                                                                   MLKRP055
00821          MOVE TOT-FLB-CURR-ML-COST    TO TL-FL2-CURR-ML-COST      MLKRP055
00822          MOVE TOT-FLB-CURR-ML-RETAIL  TO TL-FL2-CURR-ML-RETAIL    MLKRP055
00823          MOVE TOT-FLB-CURR-INV-COST   TO TL-FL2-CURR-INV-COST     MLKRP055
00824          MOVE TOT-FLB-CURR-INV-RETAIL TO TL-FL2-CURR-INV-RETAIL   MLKRP055
00825          MOVE TOT-FLB-NEXT-ML-COST    TO TL-FL2-NEXT-ML-COST      MLKRP055
00826          MOVE TOT-FLB-NEXT-ML-RETAIL  TO TL-FL2-NEXT-ML-RETAIL    MLKRP055
00827          MOVE TOT-FLB-NEXT-INV-COST   TO TL-FL2-NEXT-INV-COST     MLKRP055
00828          MOVE TOT-FLB-NEXT-INV-RETAIL TO TL-FL2-NEXT-INV-RETAIL   MLKRP055
00829                                                                   MLKRP055
00830          MOVE TL-FL2-FIN-LIAB-TOTAL-LINE-2                        MLKRP055
00831                                   TO STORE-SPLIT-REPORT-LINE      MLKRP055
00832          MOVE 1 TO PV-ADVANCE                                     MLKRP055
00833          PERFORM Z200-WRITE-REPORT-LINE                           MLKRP055
00834      END-IF.                                                      MLKRP055
00835                                                                   MLKRP055
00836      MOVE 2 TO PV-ADVANCE.                                        MLKRP055
00837                                                                   MLKRP055
00838      ADD TOT-FLB-CURR-ML-COST    TO TOT-TCD-CURR-ML-COST.         MLKRP055
00839      ADD TOT-FLB-CURR-ML-RETAIL  TO TOT-TCD-CURR-ML-RETAIL.       MLKRP055
00840      ADD TOT-FLB-CURR-INV-COST   TO TOT-TCD-CURR-INV-COST.        MLKRP055
00841      ADD TOT-FLB-CURR-INV-RETAIL TO TOT-TCD-CURR-INV-RETAIL.      MLKRP055
00842      ADD TOT-FLB-NEXT-ML-COST    TO TOT-TCD-NEXT-ML-COST.         MLKRP055
00843      ADD TOT-FLB-NEXT-ML-RETAIL  TO TOT-TCD-NEXT-ML-RETAIL.       MLKRP055
00844      ADD TOT-FLB-NEXT-INV-COST   TO TOT-TCD-NEXT-INV-COST.        MLKRP055
00845      ADD TOT-FLB-NEXT-INV-RETAIL TO TOT-TCD-NEXT-INV-RETAIL.      MLKRP055
00846                                                                   MLKRP055
00847      INITIALIZE TOT-FLB-FIN-LIAB-DTE-TOTALS.                      MLKRP055
00848                                                                   MLKRP055
00849      MOVE ML025-RPT1-FIN-LIAB-DTE TO SA-PREV-FIN-LIAB-DTE.        MLKRP055
00850      IF ML025-RPT1-FSCL-YR-PER > SA-CURR-FSCL-YR-PER              MLKRP055
00851          SET SW-NEXT-FISC-PER TO TRUE                             MLKRP055
00852      ELSE                                                         MLKRP055
00853          SET SW-CURR-FISC-PER TO TRUE                             MLKRP055
00854      END-IF.                                                      MLKRP055
00855                                                                   MLKRP055
00856                                                                   MLKRP055
00857 ******************************************************************MLKRP055
00858 * PROCESS A BREAK ON TRANS-CDE: FORMAT AND PRINT THE TOTAL        MLKRP055
00859 * LINE, ADD THE TRANS-CDE TOTALS TO THE NEXT HIGHER LEVEL TOTALS, MLKRP055
00860 * AND INITIALIZE THE TRANS-CDE TOTALS.                            MLKRP055
00861 ******************************************************************MLKRP055
00862  D300-TRANS-CDE-BREAK.                                            MLKRP055
00863                                                                   MLKRP055
00864      MOVE TL-TC1-TRANS-CDE-TOTAL-LINE-1                           MLKRP055
00865                                   TO STORE-SPLIT-REPORT-LINE.     MLKRP055
00866      MOVE 2 TO PV-ADVANCE.                                        MLKRP055
00867      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00868                                                                   MLKRP055
00869      MOVE TOT-TCD-CURR-ML-COST    TO TL-TC2-CURR-ML-COST.         MLKRP055
00870      MOVE TOT-TCD-CURR-ML-RETAIL  TO TL-TC2-CURR-ML-RETAIL.       MLKRP055
00871      MOVE TOT-TCD-CURR-INV-COST   TO TL-TC2-CURR-INV-COST.        MLKRP055
00872      MOVE TOT-TCD-CURR-INV-RETAIL TO TL-TC2-CURR-INV-RETAIL.      MLKRP055
00873      MOVE TOT-TCD-NEXT-ML-COST    TO TL-TC2-NEXT-ML-COST.         MLKRP055
00874      MOVE TOT-TCD-NEXT-ML-RETAIL  TO TL-TC2-NEXT-ML-RETAIL.       MLKRP055
00875      MOVE TOT-TCD-NEXT-INV-COST   TO TL-TC2-NEXT-INV-COST.        MLKRP055
00876      MOVE TOT-TCD-NEXT-INV-RETAIL TO TL-TC2-NEXT-INV-RETAIL.      MLKRP055
00877                                                                   MLKRP055
00878      MOVE TL-TC2-TRANS-CDE-TOTAL-LINE-2                           MLKRP055
00879                                   TO STORE-SPLIT-REPORT-LINE.     MLKRP055
00880      MOVE 1 TO PV-ADVANCE.                                        MLKRP055
00881      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00882                                                                   MLKRP055
00883      IF SA-PREV-TRANS-PURCHASE                                    MLKRP055
00884      OR SA-PREV-TRANS-TRANSFER-TO                                 MLKRP055
00885      OR SA-PREV-TRANS-MARKUP                                      MLKRP055
00886      OR SA-PREV-TRANS-ADJUSTMENT                                  MLKRP055
00887          ADD TOT-TCD-CURR-ML-COST    TO TOT-STR-CURR-ML-COST      MLKRP055
00888          ADD TOT-TCD-CURR-ML-RETAIL  TO TOT-STR-CURR-ML-RETAIL    MLKRP055
00889          ADD TOT-TCD-CURR-INV-COST   TO TOT-STR-CURR-INV-COST     MLKRP055
00890          ADD TOT-TCD-CURR-INV-RETAIL TO TOT-STR-CURR-INV-RETAIL   MLKRP055
00891          ADD TOT-TCD-NEXT-ML-COST    TO TOT-STR-NEXT-ML-COST      MLKRP055
00892          ADD TOT-TCD-NEXT-ML-RETAIL  TO TOT-STR-NEXT-ML-RETAIL    MLKRP055
00893          ADD TOT-TCD-NEXT-INV-COST   TO TOT-STR-NEXT-INV-COST     MLKRP055
00894          ADD TOT-TCD-NEXT-INV-RETAIL TO TOT-STR-NEXT-INV-RETAIL   MLKRP055
00895      ELSE                                                         MLKRP055
00896          SUBTRACT TOT-TCD-CURR-ML-COST                            MLKRP055
00897                                       FROM TOT-STR-CURR-ML-COST   MLKRP055
00898          SUBTRACT TOT-TCD-CURR-ML-RETAIL                          MLKRP055
00899                                       FROM TOT-STR-CURR-ML-RETAIL MLKRP055
00900          SUBTRACT TOT-TCD-CURR-INV-COST                           MLKRP055
00901                                       FROM TOT-STR-CURR-INV-COST  MLKRP055
00902          SUBTRACT TOT-TCD-CURR-INV-RETAIL                         MLKRP055
00903                                       FROM TOT-STR-CURR-INV-RETAILMLKRP055
00904          SUBTRACT TOT-TCD-NEXT-ML-COST                            MLKRP055
00905                                       FROM TOT-STR-NEXT-ML-COST   MLKRP055
00906          SUBTRACT TOT-TCD-NEXT-ML-RETAIL                          MLKRP055
00907                                       FROM TOT-STR-NEXT-ML-RETAIL MLKRP055
00908          SUBTRACT TOT-TCD-NEXT-INV-COST                           MLKRP055
00909                                       FROM TOT-STR-NEXT-INV-COST  MLKRP055
00910          SUBTRACT TOT-TCD-NEXT-INV-RETAIL                         MLKRP055
00911                                       FROM TOT-STR-NEXT-INV-RETAILMLKRP055
00912      END-IF.                                                      MLKRP055
00913                                                                   MLKRP055
00914      INITIALIZE TOT-TCD-TRANS-CDE-TOTALS.                         MLKRP055
00915      MOVE ML025-RPT1-TRANS-CDE    TO SA-PREV-TRANS-CDE.           MLKRP055
21015      MOVE ML025-RPT1-SYST-ORIG-CDE TO SA-PREV-SYST-ORIG-CDE.              
00916                                                                   MLKRP055
00917                                                                   MLKRP055
00918 ******************************************************************MLKRP055
00919 * PROCESS A BREAK ON STORE-NBR: FORMAT AND PRINT THE TOTAL        MLKRP055
00920 * LINE, ADD THE STORE TOTALS TO THE NEXT HIGHER LEVEL TOTALS,     MLKRP055
00921 * AND INITIALIZE THE STORE TOTALS.                                MLKRP055
00922 ******************************************************************MLKRP055
00923  D400-STORE-NBR-BREAK.                                            MLKRP055
00924                                                                   MLKRP055
00925      MOVE TL-ST1-STORE-TOTAL-LINE-1 TO STORE-SPLIT-REPORT-LINE.   MLKRP055
00926      MOVE 3 TO PV-ADVANCE.                                        MLKRP055
00927      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00928                                                                   MLKRP055
00929      MOVE TOT-STR-CURR-ML-COST    TO TL-ST2-CURR-ML-COST.         MLKRP055
00930      MOVE TOT-STR-CURR-ML-RETAIL  TO TL-ST2-CURR-ML-RETAIL.       MLKRP055
00931      MOVE TOT-STR-CURR-INV-COST   TO TL-ST2-CURR-INV-COST.        MLKRP055
00932      MOVE TOT-STR-CURR-INV-RETAIL TO TL-ST2-CURR-INV-RETAIL.      MLKRP055
00933      MOVE TOT-STR-NEXT-ML-COST    TO TL-ST2-NEXT-ML-COST.         MLKRP055
00934      MOVE TOT-STR-NEXT-ML-RETAIL  TO TL-ST2-NEXT-ML-RETAIL.       MLKRP055
00935      MOVE TOT-STR-NEXT-INV-COST   TO TL-ST2-NEXT-INV-COST.        MLKRP055
00936      MOVE TOT-STR-NEXT-INV-RETAIL TO TL-ST2-NEXT-INV-RETAIL.      MLKRP055
00937                                                                   MLKRP055
00938      MOVE TL-ST2-STORE-TOTAL-LINE-2 TO STORE-SPLIT-REPORT-LINE.   MLKRP055
00939      MOVE 1 TO PV-ADVANCE.                                        MLKRP055
00940      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
00941                                                                   MLKRP055
00942      ADD TOT-STR-CURR-ML-COST    TO TOT-FNL-CURR-ML-COST.         MLKRP055
00943      ADD TOT-STR-CURR-ML-RETAIL  TO TOT-FNL-CURR-ML-RETAIL.       MLKRP055
00944      ADD TOT-STR-CURR-INV-COST   TO TOT-FNL-CURR-INV-COST.        MLKRP055
00945      ADD TOT-STR-CURR-INV-RETAIL TO TOT-FNL-CURR-INV-RETAIL.      MLKRP055
00946      ADD TOT-STR-NEXT-ML-COST    TO TOT-FNL-NEXT-ML-COST.         MLKRP055
00947      ADD TOT-STR-NEXT-ML-RETAIL  TO TOT-FNL-NEXT-ML-RETAIL.       MLKRP055
00948      ADD TOT-STR-NEXT-INV-COST   TO TOT-FNL-NEXT-INV-COST.        MLKRP055
00949      ADD TOT-STR-NEXT-INV-RETAIL TO TOT-FNL-NEXT-INV-RETAIL.      MLKRP055
00950                                                                   MLKRP055
00951      INITIALIZE TOT-STR-STORE-TOTALS.                             MLKRP055
00952      MOVE ML025-RPT1-STORE-NBR TO SA-PREV-STORE-NBR.              MLKRP055
00953                                                                   MLKRP055
00954                                                                   MLKRP055
00955 ******************************************************************MLKRP055
00956 * PROCESS EACH INPUT RECORD: PRINT HEADINGS AS NECESSARY DUE TO   MLKRP055
00957 * CONTROL BREAKS; IF THE FINANCIAL LIABILITY DATE HAS CHANGED,    MLKRP055
00958 * RESET THE CURRENT OR NEXT FISCAL PERIOD INDICATOR; ADD THE      MLKRP055
00959 * COST AND RETAIL AMOUNTS TO THE LOWEST LEVEL TOTALS.             MLKRP055
00960 ******************************************************************MLKRP055
00961  D500-PROCESS-EDIT-SPLIT-REC.                                     MLKRP055
00962                                                                   MLKRP055
00963      EVALUATE TRUE                                                MLKRP055
00964          WHEN SW-STORE-BREAK                                      MLKRP055
00965              PERFORM Z300-PRINT-STD-RPT-HEADING                   MLKRP055
00966              MOVE ML025-RPT1-STORE-NBR    TO HD-ST-STORE-NBR      MLKRP055
00967                                              TL-ST1-STORE-NBR     MLKRP055
W26603             PERFORM Z600-READ-XMTLOC                             MLKRP055
W26603             MOVE XMT00001-LOC-NM         TO HD-ST-STORE-NAME     MLKRP055
00970              PERFORM Z350-PRINT-STORE-HEADING                     MLKRP055
00971              PERFORM Z400-PRINT-CONSTANT-HEADINGS                 MLKRP055
00972              PERFORM Z500-PRINT-TRANS-CDE-HEADING                 MLKRP055
00973              MOVE SA-PREV-FIN-LIAB-DTE    TO PV-ISO-FMT-DATE      MLKRP055
00974              MOVE PV-ISO-FMT-MM           TO DL-EFF-DATE-MM       MLKRP055
00975                                              TL-FL1-EFF-DATE-MM   MLKRP055
00976              MOVE PV-ISO-FMT-DD           TO DL-EFF-DATE-DD       MLKRP055
00977                                              TL-FL1-EFF-DATE-DD   MLKRP055
00978              MOVE PV-ISO-FMT-YY           TO DL-EFF-DATE-YY       MLKRP055
00979                                              TL-FL1-EFF-DATE-YY   MLKRP055
00980              MOVE '/'                     TO DL-EFF-DATE-SLASH1   MLKRP055
00981                                              DL-EFF-DATE-SLASH2   MLKRP055
00982              MOVE ML025-RPT1-BATCH-NBR    TO DL-BATCH-NBR         MLKRP055
00983              SET SW-NOT-STORE-BREAK TO TRUE                       MLKRP055
00984          WHEN SW-TRANS-CDE-BREAK                                  MLKRP055
00985              PERFORM Z500-PRINT-TRANS-CDE-HEADING                 MLKRP055
00986              MOVE SA-PREV-FIN-LIAB-DTE    TO PV-ISO-FMT-DATE      MLKRP055
00987              MOVE PV-ISO-FMT-MM           TO DL-EFF-DATE-MM       MLKRP055
00988                                              TL-FL1-EFF-DATE-MM   MLKRP055
00989              MOVE PV-ISO-FMT-DD           TO DL-EFF-DATE-DD       MLKRP055
00990                                              TL-FL1-EFF-DATE-DD   MLKRP055
00991              MOVE PV-ISO-FMT-YY           TO DL-EFF-DATE-YY       MLKRP055
00992                                              TL-FL1-EFF-DATE-YY   MLKRP055
00993              MOVE '/'                     TO DL-EFF-DATE-SLASH1   MLKRP055
00994                                              DL-EFF-DATE-SLASH2   MLKRP055
00995              MOVE ML025-RPT1-BATCH-NBR    TO DL-BATCH-NBR         MLKRP055
00996              SET SW-NOT-TRANS-CDE-BREAK TO TRUE                   MLKRP055
00997          WHEN SW-FIN-LIAB-BREAK                                   MLKRP055
00998              MOVE SA-PREV-FIN-LIAB-DTE    TO PV-ISO-FMT-DATE      MLKRP055
00999              MOVE PV-ISO-FMT-MM           TO DL-EFF-DATE-MM       MLKRP055
01000                                              TL-FL1-EFF-DATE-MM   MLKRP055
01001              MOVE PV-ISO-FMT-DD           TO DL-EFF-DATE-DD       MLKRP055
01002                                              TL-FL1-EFF-DATE-DD   MLKRP055
01003              MOVE PV-ISO-FMT-YY           TO DL-EFF-DATE-YY       MLKRP055
01004                                              TL-FL1-EFF-DATE-YY   MLKRP055
01005              MOVE '/'                     TO DL-EFF-DATE-SLASH1   MLKRP055
01006                                              DL-EFF-DATE-SLASH2   MLKRP055
01007              MOVE ML025-RPT1-BATCH-NBR    TO DL-BATCH-NBR         MLKRP055
01008              SET SW-NOT-FIN-LIAB-BREAK TO TRUE                    MLKRP055
01009          WHEN SW-BATCH-NBR-BREAK                                  MLKRP055
01010              MOVE ML025-RPT1-BATCH-NBR    TO DL-BATCH-NBR         MLKRP055
01011              SET SW-NOT-BATCH-NBR-BREAK TO TRUE                   MLKRP055
01012      END-EVALUATE.                                                MLKRP055
01013                                                                   MLKRP055
01014      IF SW-CURR-FISC-PER                                          MLKRP055
01015          IF ML025-RPT1-INCLUDE-IN-ML                              MLKRP055
01016              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP055
01017                                         TO TOT-DOC-CURR-ML-COST   MLKRP055
01018              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP055
01019                                         TO TOT-DOC-CURR-ML-RETAIL MLKRP055
01020          END-IF                                                   MLKRP055
01021          IF ML025-RPT1-INCLUDE-IN-INV                             MLKRP055
01022              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP055
01023                                         TO TOT-DOC-CURR-INV-COST  MLKRP055
01024              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP055
01025                                         TO TOT-DOC-CURR-INV-RETAILMLKRP055
01026          END-IF                                                   MLKRP055
01027      ELSE                                                         MLKRP055
01028          IF ML025-RPT1-INCLUDE-IN-ML                              MLKRP055
01029              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP055
01030                                         TO TOT-DOC-NEXT-ML-COST   MLKRP055
01031              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP055
01032                                         TO TOT-DOC-NEXT-ML-RETAIL MLKRP055
01033          END-IF                                                   MLKRP055
01034          IF ML025-RPT1-INCLUDE-IN-INV                             MLKRP055
01035              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP055
01036                                         TO TOT-DOC-NEXT-INV-COST  MLKRP055
01037              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP055
01038                                         TO TOT-DOC-NEXT-INV-RETAILMLKRP055
01039          END-IF                                                   MLKRP055
01040      END-IF.                                                      MLKRP055
01041                                                                   MLKRP055
01042                                                                   MLKRP055
01043 ******************************************************************MLKRP055
01044 * PROCESS A BREAK ON DOC-NBR: FORMAT AND PRINT A DETAIL LINE,     MLKRP055
01045 * ADD THE DOC-NBR TOTALS TO THE NEXT HIGHER LEVEL TOTALS, AND     MLKRP055
01046 * INITIALIZE THE DOC-NBR TOTALS.                                  MLKRP055
01047 ******************************************************************MLKRP055
01048  E100-CONTINUE-DOC-NBR-BREAK.                                     MLKRP055
01049                                                                   MLKRP055
01050      MOVE SA-PREV-DOC-NBR         TO DL-DOC-NBR                   MLKRP055
                                                                                
01051      MOVE TOT-DOC-CURR-ML-COST    TO DL-CURR-ML-COST.             MLKRP055
01052      MOVE TOT-DOC-CURR-ML-RETAIL  TO DL-CURR-ML-RETAIL.           MLKRP055
01053      MOVE TOT-DOC-CURR-INV-COST   TO DL-CURR-INV-COST.            MLKRP055
01054      MOVE TOT-DOC-CURR-INV-RETAIL TO DL-CURR-INV-RETAIL.          MLKRP055
01055      MOVE TOT-DOC-NEXT-ML-COST    TO DL-NEXT-ML-COST.             MLKRP055
01056      MOVE TOT-DOC-NEXT-ML-RETAIL  TO DL-NEXT-ML-RETAIL.           MLKRP055
01057      MOVE TOT-DOC-NEXT-INV-COST   TO DL-NEXT-INV-COST.            MLKRP055
01058      MOVE TOT-DOC-NEXT-INV-RETAIL TO DL-NEXT-INV-RETAIL.          MLKRP055
01059                                                                   MLKRP055
01060      IF PV-LINE-COUNT > PC-LINE-LIMIT-FOR-DTL                     MLKRP055
01061          PERFORM Z300-PRINT-STD-RPT-HEADING                       MLKRP055
01062          PERFORM Z350-PRINT-STORE-HEADING                         MLKRP055
01063          PERFORM Z400-PRINT-CONSTANT-HEADINGS                     MLKRP055
01064      END-IF.                                                      MLKRP055
01065                                                                   MLKRP055
01066      MOVE DL-DETAIL-LINE TO STORE-SPLIT-REPORT-LINE.              MLKRP055
01067      PERFORM Z200-WRITE-REPORT-LINE.                              MLKRP055
01068      MOVE 1 TO PV-ADVANCE.                                        MLKRP055
01069                                                                   MLKRP055
01070      ADD TOT-DOC-CURR-ML-COST    TO TOT-BCH-CURR-ML-COST.         MLKRP055
01071      ADD TOT-DOC-CURR-ML-RETAIL  TO TOT-BCH-CURR-ML-RETAIL.       MLKRP055
01072      ADD TOT-DOC-CURR-INV-COST   TO TOT-BCH-CURR-INV-COST.        MLKRP055
01073      ADD TOT-DOC-CURR-INV-RETAIL TO TOT-BCH-CURR-INV-RETAIL.      MLKRP055
01074      ADD TOT-DOC-NEXT-ML-COST    TO TOT-BCH-NEXT-ML-COST.         MLKRP055
01075      ADD TOT-DOC-NEXT-ML-RETAIL  TO TOT-BCH-NEXT-ML-RETAIL.       MLKRP055
01076      ADD TOT-DOC-NEXT-INV-COST   TO TOT-BCH-NEXT-INV-COST.        MLKRP055
01077      ADD TOT-DOC-NEXT-INV-RETAIL TO TOT-BCH-NEXT-INV-RETAIL.      MLKRP055
01078                                                                   MLKRP055
01079      INITIALIZE TOT-DOC-NBR-TOTALS                                MLKRP055
01080                 DL-DETAIL-LINE.                                   MLKRP055
01081                                                                   MLKRP055
01082                                                                   MLKRP055
01083  Z100-READ-EDIT-SPLIT-FILE.                                       MLKRP055
01084                                                                   MLKRP055
01085      READ EDIT-SPLIT-FILE                                         MLKRP055
01086          INTO ML025-RPT1-RECORD                                   MLKRP055
01087              AT END SET SW-END-OF-EDIT-SPLIT-FILE TO TRUE.        MLKRP055
01088                                                                   MLKRP055
01089                                                                   MLKRP055
01090  Z200-WRITE-REPORT-LINE.                                          MLKRP055
01091                                                                   MLKRP055
01092      WRITE STORE-SPLIT-REPORT-LINE                                MLKRP055
01093          AFTER ADVANCING PV-ADVANCE.                              MLKRP055
01094      ADD PV-ADVANCE TO PV-LINE-COUNT.                             MLKRP055
01095                                                                   MLKRP055
01096                                                                   MLKRP055
01097 ******************************************************************MLKRP055
01098 * PRINT THE STANDARD REPORT HEADING LINE FOR THE STORE REPORT.    MLKRP055
01099 ******************************************************************MLKRP055
01100  Z300-PRINT-STD-RPT-HEADING.                                      MLKRP055
01101                                                                   MLKRP055
01102      ADD 1 TO PV-PAGE-COUNT.                                      MLKRP055
01103      MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    MLKRP055
01104      MOVE DP200O-STANDRD-HEADER-200-COLS                          MLKRP055
01105          TO STORE-SPLIT-REPORT-LINE                               MLKRP055
01106      WRITE STORE-SPLIT-REPORT-LINE                                MLKRP055
01107          AFTER ADVANCING PAGE.                                    MLKRP055
01108      MOVE +1 TO PV-LINE-COUNT.                                    MLKRP055
01109                                                                   MLKRP055
01110                                                                   MLKRP055
01111 ******************************************************************MLKRP055
01112 * PRINT THE STORE HEADING LINE.                                   MLKRP055
01113 ******************************************************************MLKRP055
01114  Z350-PRINT-STORE-HEADING.                                        MLKRP055
01115                                                                   MLKRP055
01116      WRITE STORE-SPLIT-REPORT-LINE FROM HD-ST-STORE-HEADING       MLKRP055
01117          AFTER ADVANCING 2 LINES.                                 MLKRP055
01118      ADD +2 TO PV-LINE-COUNT.                                     MLKRP055
01119                                                                   MLKRP055
01120                                                                   MLKRP055
01121 ******************************************************************MLKRP055
01122 * PRINT THE FINAL TOTAL HEADING LINE FOR THE STORE REPORT.        MLKRP055
01123 ******************************************************************MLKRP055
01124  Z375-PRINT-FINAL-TOT-HEADING.                                    MLKRP055
01125                                                                   MLKRP055
01126      WRITE STORE-SPLIT-REPORT-LINE FROM HD-FT-FINAL-TOTAL-HEADING MLKRP055
01127              AFTER ADVANCING 2 LINES.                             MLKRP055
01128      ADD +2 TO PV-LINE-COUNT.                                     MLKRP055
01129                                                                   MLKRP055
01130                                                                   MLKRP055
01131 ******************************************************************MLKRP055
01132 * PRINT THE STORE REPORT HEADINGS THAT ARE THE SAME FOR BOTH THE  MLKRP055
01133 * DETAIL PAGES AND THE FINAL TOTAL PAGE. THE TRANS-CDE HEADING IS MLKRP055
01134 * NOT PRINTED HERE. IT IS PRINTED SPEARATELY BECAUSE UNLIKE THE   MLKRP055
01135 * HEADINGS PRINTED HERE, IT IS NOT REPRINTED UPON A PAGE BREAK.   MLKRP055
01136 ******************************************************************MLKRP055
01137  Z400-PRINT-CONSTANT-HEADINGS.                                    MLKRP055
01138                                                                   MLKRP055
01139      WRITE STORE-SPLIT-REPORT-LINE FROM HD-ED-EDIT-DATE-HEADING   MLKRP055
01140          AFTER ADVANCING 1 LINES.                                 MLKRP055
01141      WRITE STORE-SPLIT-REPORT-LINE FROM HD-FP-FISCAL-PER-HEADING  MLKRP055
01142          AFTER ADVANCING 2 LINES.                                 MLKRP055
01143      WRITE STORE-SPLIT-REPORT-LINE FROM HD-MI-ML-INV-HEADING      MLKRP055
01144          AFTER ADVANCING 2 LINES.                                 MLKRP055
01145      WRITE STORE-SPLIT-REPORT-LINE FROM HD-CL-COLUMN-HEADING      MLKRP055
01146          AFTER ADVANCING 1 LINE.                                  MLKRP055
01147      ADD +6 TO PV-LINE-COUNT.                                     MLKRP055
01148      MOVE 2  TO PV-ADVANCE.                                       MLKRP055
01149                                                                   MLKRP055
01150                                                                   MLKRP055
01151 ******************************************************************MLKRP055
01152 * PRINT THE TRANS-CDE HEADING. TRANS-CDE-TABLE IS SEARCHED TO FINDMLKRP055
01153 * THE DESCRIPTION THAT WILL BE USED IN THE HEADING.               MLKRP055
01154 ******************************************************************MLKRP055
01155  Z500-PRINT-TRANS-CDE-HEADING.                                    MLKRP055
01156                                                                   MLKRP055
01157      MOVE 'Z500-PRINT-TRANS-CDE-HEADING' TO PV-PARAGRAPH-NAME.    MLKRP055
01158                                                                   MLKRP055
01159      SET TCT-IDX TO 1.                                            MLKRP055
01160                                                                   MLKRP055
01161      SEARCH TCT-ENTRY                                             MLKRP055
01162          AT END                                                   MLKRP055
01163              MOVE 'TRANS-CDE ON INPUT RECORD NOT FOUND IN TCT-    MLKRP055
01164 -                    'TRANS-CDE-TABLE.' TO PV-ABEND-MESSAGE       MLKRP055
01165              MOVE +4008 TO ABEND-CODE                             MLKRP055
01166              PERFORM Z999-ABEND                                   MLKRP055
01167          WHEN TCT-TRANS-CDE (TCT-IDX) = ML025-RPT1-TRANS-CDE      MLKRP055
21015           AND TCT-SYS-ORIG-CDE (TCT-IDX)                          MLKRP054
21015                               = ML025-RPT1-SYST-ORIG-CDE                  
01168              MOVE TCT-TRANS-CDE-DESC (TCT-IDX)                    MLKRP055
01169                                       TO HD-TC-TRANS-CDE-DESC     MLKRP055
01170                                          TL-TC1-TRANS-CDE-DESC    MLKRP055
01171      END-SEARCH.                                                  MLKRP055
01172                                                                   MLKRP055
01173      IF PV-LINE-COUNT > PC-LINE-LIMIT-FOR-HD-TC                   MLKRP055
01174          PERFORM Z300-PRINT-STD-RPT-HEADING                       MLKRP055
01175          PERFORM Z350-PRINT-STORE-HEADING                         MLKRP055
01176          PERFORM Z400-PRINT-CONSTANT-HEADINGS                     MLKRP055
01177      END-IF.                                                      MLKRP055
01178                                                                   MLKRP055
01179      WRITE STORE-SPLIT-REPORT-LINE                                MLKRP055
01180          FROM HD-TC-TRANS-CDE-HEADING                             MLKRP055
01181          AFTER ADVANCING 2 LINES.                                 MLKRP055
01182                                                                   MLKRP055
01183      ADD +2 TO PV-LINE-COUNT.                                     MLKRP055
01184      MOVE 2 TO PV-ADVANCE.                                        MLKRP055
01185                                                                   MLKRP055
01186                                                                   MLKRP055
01187 ***************************************************************** MLKRP055
01188 * THIS PARAGRAPH RETRIEVES THE STORE NAME.                        MLKRP055
01189 ***************************************************************** MLKRP055
W26603 Z600-READ-XMTLOC.                                                MLKRP055
01191                                                                   MLKRP055
W26603     MOVE 'Z600-READ-XMTLOC' TO PV-PARAGRAPH-NAME.                MLKRP055
01193                                                                   MLKRP055
01194      PERFORM                                                      MLKRP055
01195          WITH TEST AFTER                                          MLKRP055
01196          VARYING PV-SQL-SUB FROM 1 BY 1                           MLKRP055
01197          UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        MLKRP055
01198             OR SQLCODE = 0                                        MLKRP055
01199                                                                   MLKRP055
W26603         MOVE ML025-RPT1-STORE-NBR TO PV-EDIT-STORE                       
W26603         MOVE PV-EDIT-STORE-NUM    TO XMT00001-LOC-NBR                    
W26603                                                                  MLKRP054
01506          EXEC SQL                                                 MLKRP054
W26603              SELECT LOC_NM                                       MLKRP054
W26603              INTO :XMT00001-LOC-NM                               MLKRP054
W26603              FROM XMT_LOC                                        MLKRP054
W26603              WHERE LOC_NBR = :XMT00001-LOC-NBR                   MLKRP054
W26603              WITH UR                                                     
01512          END-EXEC                                                 MLKRP054
01513                                                                   MLKRP054
01208          EVALUATE TRUE                                            MLKRP055
01209              WHEN SQLCODE = +100                                  MLKRP055
01210                  DISPLAY '*** MLKRP055 ABEND ***'                 MLKRP055
01211                  DISPLAY '**** NO MATCH FOR STORE '               MLKRP055
01212                                           ML025-RPT1-STORE-NBR    MLKRP055
01213                  DISPLAY '**** ON DB2 STORE TABLE'                MLKRP055
01214                  PERFORM Z900-SQL-ABEND                           MLKRP055
01215              WHEN SQLCODE = -904                                  MLKRP055
01216              WHEN SQLCODE = -911                                  MLKRP055
01217              WHEN SQLCODE = 0                                     MLKRP055
01218                  CONTINUE                                         MLKRP055
01219              WHEN SQLWARN NOT = SPACES                            MLKRP055
01220              WHEN SQLCODE NOT = ZERO                              MLKRP055
01221                  MOVE 'READING STORE TABLE'                       MLKRP055
01222                                TO  PV-DB2-OPER-ATTEMPTED          MLKRP055
01223                  PERFORM Z900-SQL-ABEND                           MLKRP055
01224          END-EVALUATE                                             MLKRP055
01225      END-PERFORM.                                                 MLKRP055
01226                                                                   MLKRP055
01227      IF  PV-SQL-SUB > PC-MAX-RETRIES                              MLKRP055
01228          MOVE 'READ RETRIES EXCEEDED'                             MLKRP055
01229                                TO  PV-DB2-OPER-ATTEMPTED          MLKRP055
01230          PERFORM Z900-SQL-ABEND                                   MLKRP055
01231      END-IF.                                                      MLKRP055
01232                                                                   MLKRP055
01233                                                                   MLKRP055
      ******************************************************************        
      *  THE DOCUMENT NBR HAS EXPANDED FROM 5 TO 15 CHARACTERS DUE TO           
      *  REPORTING CHANGINGS FOR THE NEW FAST TRANSFER SYSTEM.                  
      *                                                                         
      *  NOTE:  NON-FAST TRANSACTIONS WILL NOT CHANGE OTHER THAN HAVING         
      *         10 SPACES PADDED AFTER IT.                                      
      ******************************************************************        
       Z700-BUILD-EDITED-DOC-NBR.                                               
                                                                                
           IF  ML025-RPT1-DOC-5-NBRX = 'FAST '                          MLKRP053
W26603         MOVE ML025-RPT1-DOC-5-NBR (1:4)          TO              MLKRP053
                    ED-DOC-FAST-LIT                                             
               MOVE '-'                                 TO                      
                    ED-DOC-HYPHEN                                           MLKU
               IF  ML025-RPT1-XFER-DOC-STORE NUMERIC AND                        
                   ML025-RPT1-XFER-DOC-SEQ NUMERIC                              
W28545             MOVE ML025-RPT1-XFER-DOC-STORE (2:4) TO                      
W28545                  PV-EDIT-LOC-NBR                                     MLKU
W28545             MOVE PV-EDIT-LOC-NBR-ALPH (2:4) TO                           
                        ED-DOC-STORE                                        MLKU
                   MOVE ML025-RPT1-XFER-DOC-SEQ         TO                      
                        ED-DOC-SEQ                                          MLKU
               ELSE                                                             
1198RM*-- CHANGED NAME FROM ML025-RPT1-XFER-DOC-NBRX - FIELD DID NOT            
1198RM*-- EXIST IN PRODUCTION COPYBOOK                                          
W26603             MOVE ML025-RPT1-XFER-DOC-NBR        TO               MLRD005I
                        ED-DOC-STORE                                        MLKU
                   MOVE ML025-RPT1-XFER-DOC-NBR (5:6)  TO               MLRD005I
                        ED-DOC-SEQ                                          MLKU
               END-IF                                                           
           ELSE                                                                 
01050          MOVE ML025-RPT1-DOC-5-NBRX               TO                      
                    ED-DOC-NBR                                                  
           END-IF.                                                              
      *                                                                         
01234 ******************************************************************MLKRP055
01235 *  STANDARD DB2 ERROR ABEND ROUTINE                               MLKRP055
01236 *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             MLKRP055
01237 ******************************************************************MLKRP055
01238  Z900-SQL-ABEND.                                                  MLKRP055
01239                                                                   MLKRP055
01240      MOVE +4013                 TO ABEND-CODE.                    MLKRP055
01241      DISPLAY '**  ABEND     **'.                                  MLKRP055
01242      DISPLAY '**  PROGRAM   **  =  MLKRP055'.                     MLKRP055
01243      DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            MLKRP055
01244      DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        MLKRP055
01245                                                                   MLKRP055
01246 *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         MLKRP055
01247 *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        MLKRP055
01248                                                                   MLKRP055
01249      COPY DPPD004.                                                MLKRP055
01250                                                                   MLKRP055
01251      CALL 'ILBOABN0'  USING ABEND-CODE.                           MLKRP055
01252                                                                   MLKRP055
01253  Z999-ABEND.                                                      MLKRP055
01254                                                                   MLKRP055
01255      DISPLAY '**  ABEND     **'.                                  MLKRP055
01256      DISPLAY '**  PROGRAM   **  =  MLKRP055'.                     MLKRP055
01257      DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            MLKRP055
01258      DISPLAY '**  ' PV-ABEND-MESSAGE.                             MLKRP055
01259      DISPLAY '**  INPUT RECORD: ' EDIT-SPLIT-RECORD.              MLKRP055
01260      CALL 'ILBOABN0'  USING ABEND-CODE.                           MLKRP055
