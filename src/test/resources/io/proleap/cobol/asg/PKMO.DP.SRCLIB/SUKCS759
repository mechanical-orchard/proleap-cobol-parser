000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    SUKCS759.                                         00020000
000300 AUTHOR.        DEANNA BRANTNER.                                  00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  MARCH, 2003                                       00050000
000600 DATE-COMPILED.                                                   00060000
000700*---------------------------------------------------------------* 00070000
000800*    S759 - STORE UNIT ADJUSTMENT DETAIL SCREEN                   00080000
000900*---------------------------------------------------------------* 00090000
000910*                                                                 00091038
000920* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00092039
000930* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00093039
000940*---------------------------------------------------------------* 00094038
000950                                                                  00095038
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400 01  DK-DB2-KEYS.                                                 00140000
001500     05  DK-COMMENT-FIELD             PIC  X(255)  VALUE SPACES.  00150000
001600     05  DK-COMMENT-FIELD-X.                                      00160000
001700         10  DK-COMMENT-1              PIC  X(79)  VALUE SPACES.  00170000
001800         10  DK-COMMENT-2              PIC  X(79)  VALUE SPACES.  00180000
001900         10  DK-COMMENT-3              PIC  X(79)  VALUE SPACES.  00190000
002000     05  DK-USER-CODE                  PIC  X(08)  VALUE SPACES.  00200000
002100     05  DK-BEF-QTY                    PIC ZZZZZ9- VALUE ZEROES.  00210000
002200     05  DK-AFT-QTY                    PIC ZZZZZ9- VALUE ZEROES.  00220000
002300     05  DK-PO                         PIC S9(09) COMP VALUE ZERO.00230000
002400     05  DK-RCVR                       PIC S9(09) COMP VALUE ZERO.00240001
002500     05  DK-LINE                       PIC S9(09) COMP VALUE ZERO.00250001
002510     05  DK-STORE                      PIC S9(04) COMP VALUE ZERO.00251044
002600     05  DK-OPER-UNT-ID                PIC S9(04) COMP VALUE ZERO.00260001
002700     05  DK-STORE-NBR                  PIC S9(04) COMP VALUE ZERO.00270001
002800     05  DK-OPER-NAME                  PIC  X(25).                00280032
002900     05  DK-AUDIT                      PIC S9(09) COMP VALUE ZERO.00290001
003000     05  DK-PO-TRN-NBR                  PIC 9(09) VALUE ZEROES.   00300001
003100     05  DK-PO-RCVR-NBR-N               PIC 9(09) VALUE ZEROES.   00310001
003200     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00320001
003300         10  DK-RCVR-NBR-X                PIC X(09).              00330001
003400     05  DK-RCVR-NBR-9.                                           00340001
003500         10  FILLER                       PIC 9(06) VALUE ZEROES. 00350001
003600         10  DK-RCVR-NBR-3                PIC 9(03) VALUE ZEROES. 00360001
003700     05  DK-LINE-NBR-9.                                           00370001
003800         10  FILLER                       PIC 9(05) VALUE ZEROES. 00380001
003900         10  DK-LINE-NBR-4                PIC 9(04) VALUE ZEROES. 00390001
004000     05  DK-ACT-QTY                    PIC ZZZZZ9- VALUE ZEROES.  00400007
004100     05  DK-VRF-QTY                    PIC ZZZZZ9- VALUE ZEROES.  00410005
004200                                                                  00420001
004300     05  DK-PO-RCVR.                                              00430001
004400         10  DK-TRN-NBR                   PIC Z(09) VALUE ZEROES. 00440001
004500         10  FILLER                       PIC X(01) VALUE '-'.    00450001
004600         10  DK-RCVR-NBR                  PIC X(03) VALUE SPACES. 00460001
004700         10  FILLER                       PIC X(01) VALUE '-'.    00470001
004800         10  DK-LINE-NBR                  PIC X(04) VALUE SPACES. 00480001
004900                                                                  00490001
005000     05  DK-DISPLAY-DATE.                                         00500001
005100         10  DK-DIS-MM                    PIC X(02) VALUE SPACES. 00510001
005200         10  FILLER                       PIC X(01) VALUE '/'.    00520001
005300         10  DK-DIS-DD                    PIC X(02) VALUE SPACES. 00530001
005400         10  FILLER                       PIC X(01) VALUE '/'.    00540001
005500         10  DK-DIS-YY                    PIC X(04) VALUE SPACES. 00550001
005600         10  FILLER                       PIC X(01) VALUE ' '.    00560001
005700         10  FILLER                       PIC X(01) VALUE '-'.    00570001
005800         10  FILLER                       PIC X(01) VALUE ' '.    00580001
005900         10  DK-DIS-HR                    PIC X(02) VALUE SPACES. 00590001
006000         10  FILLER                       PIC X(01) VALUE ':'.    00600001
006100         10  DK-DIS-MN                    PIC X(02) VALUE SPACES. 00610001
006200         10  FILLER                       PIC X(01) VALUE ':'.    00620001
006300         10  DK-DIS-SC                    PIC X(02) VALUE SPACES. 00630001
006400                                                                  00640001
006500 01  PC-PROGRAM-CONSTANTS.                                        00650001
006600     05  PC-TMKCS520               PIC X(08)  VALUE  'TMKCS520'.  00660001
006700     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU759A  '.  00670001
006800     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM759'.   00680001
006900     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS759'.  00690001
007000     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00700001
007100     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00710001
007200     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00720001
007300     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00730001
007400     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00740001
007500                                               COMP SYNC.         00750001
007600     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00760001
007700                                               COMP SYNC.         00770001
007800     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00780001
007900                                               COMP-3.            00790001
008000     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00800001
008100                                               COMP SYNC.         00810001
008200     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00820001
008300                                               COMP-3.            00830001
008400     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00840001
008500     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00850001
008600     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00860001
008700     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00870001
008800     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00880001
008900     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00890001
009000                                               COMP.              00900001
009100     05  PC-01                     PIC  X(02)  VALUE '01'.        00910001
009200     05  PC-A                      PIC  X(01)  VALUE 'A'.         00920001
009300*                                                                 00930001
009400*----------------------------------------------------------------*00940001
009500*  SYSTEM MESSAGES                                               *00950001
009600*----------------------------------------------------------------*00960001
009700*   00005 = INVALID VALUE                                        *00970001
009800*   00008 = MUST BE NUMERIC                                      *00980001
009900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00990001
010000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01000001
010100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01010001
010200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01020001
010300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01030001
010400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01040001
010500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01050001
010600*   00059 - UPDATE(S) SUCCESSFULL                                *01060001
010700*   00069 - TOP OF LIST                                          *01070001
010800*   00070 - BOTTOM OF LIST                                       *01080001
010900*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01090001
011000*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01100001
011100*   00279 - MORE ITEMS TO DISPLAY                                *01110001
011200*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *01120001
011300*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01130001
011400*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01140001
011500*   03049 = UPDATE NOT ALLOWED - TRANSACTION ALREADY ACKNOWLEDGED*01150001
011600*   03050 = ENTER COMMENTS TO CLOSE THIS FAILED ADJUSTMENT       *01160001
011610*   03823 = CANT AUTO RESOLVE FAILED P2L ADJUSTMENTS             *01161040
011700*   99901 = INVALID COMMAND WAS ENTERED                          *01170001
011800*----------------------------------------------------------------*01180001
011900     05  PC-TSYMSG-NUMBERS.                                       01190001
012000         10  PC-TSYMSG-00004            PIC  9(05)  VALUE 00004.  01200001
012100         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01210001
012200         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01220001
012300         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01230001
012400         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01240001
012500         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01250001
012600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01260001
012700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01270001
012800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01280001
012900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01290001
013000         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01300001
013100         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01310001
013200         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01320001
013300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01330001
013400         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01340001
013500         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01350001
013600         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01360001
013700         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01370001
013800         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01380001
013900         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01390001
014000         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01400001
014100         10  PC-TSYMSG-03049            PIC  9(05)  VALUE 03049.  01410001
014200         10  PC-TSYMSG-03050            PIC  9(05)  VALUE 03050.  01420001
014210         10  PC-TSYMSG-03823            PIC  9(05)  VALUE 03823.  01421040
014300         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01430001
014400*                                                                 01440001
014500 01  PS-PROGRAM-SWITCHES.                                         01450001
014600     05  PS-EOC-LINE-CSR-SW             PIC  X(01)  VALUE 'N'.    01460001
014700         88  PS-EOC-LINE-CSR                        VALUE 'Y'.    01470001
014800         88  PS-NOT-EOC-LINE-CSR                    VALUE 'N'.    01480001
014900     05  PS-TRBL-FOUND-SW               PIC  X(01)  VALUE 'N'.    01490001
015000         88  PS-TRBL-FOUND                          VALUE 'Y'.    01500001
015100         88  PS-TRBL-NOT-FOUND                      VALUE 'N'.    01510001
015200     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01520001
015300         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01530001
015400         88  PS-BLOCK-ERROR                         VALUE 'N'.    01540001
015500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01550001
015600         88  PS-NO-ERROR                            VALUE 'Y'.    01560001
015700         88  PS-ERROR                               VALUE 'N'.    01570001
015800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01580001
015900         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01590001
016000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01600001
016100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01610001
016200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01620001
016300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01630001
016400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01640001
016500         88  PS-DONE                                VALUE 'Y'.    01650001
016600         88  PS-NOT-DONE                            VALUE 'N'.    01660001
016700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01670001
016800         88  PS-LIST-END                            VALUE  'Y'.   01680001
016900         88  PS-NO-LIST-END                         VALUE  'N'.   01690001
017000     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01700001
017100         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01710001
017200         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01720001
017210     05  PS-P2L-FAIL-ADJ-SW             PIC  X(01)  VALUE  'N'.   01721046
017220         88  PS-P2L-FAIL-ADJ                        VALUE  'Y'.   01722046
017230         88  PS-P2L-FAIL-ADJ-NO                     VALUE  'N'.   01723046
017300*                                                                 01730001
017400 01  PV-PROGRAM-VARIABLES.                                        01740001
017500     05  PV-DISP-ADJ-ERR-CDE            PIC  9(04).               01750042
017510     05  PV-DISP-PO                     PIC  9(09).               01751042
017600     05  PV-DISP-RCVR                   PIC  9(04).               01760044
017700     05  PV-DISP-LINE                   PIC  9(04).               01770044
017710     05  PV-DISP-STORE                  PIC  9(04).               01771044
017800     05  PV-DISP-NOTIF-NBR              PIC  9(09).               01780017
017900     05  PV-DISP-RESPONSE               PIC  9(08).               01790001
018000     05  PC-DEFAULT-TMST                PIC  X(26)  VALUE         01800001
018100                               '9999-09-09-09.09.09.999999'.      01810001
018200     05  PV-SHIPT-UNT-ID-Z             PIC ZZZZZZZZZZZZZZZZZZ.    01820001
018300     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01830001
018400                                                    COMP SYNC.    01840001
018500     05  PV-NULL-IND1                   PIC S9(04)  VALUE +0      01850001
018600                                                    COMP SYNC.    01860001
018700     05  PV-NULL-IND2                   PIC S9(04)  VALUE +0      01870001
018800                                                    COMP SYNC.    01880001
018900     05  PV-NULL-IND3                   PIC S9(04)  VALUE +0      01890001
019000                                                    COMP SYNC.    01900001
019100     05  PV-ONE                         PIC S9(09) COMP.          01910001
019200     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      01920001
019300                                                    COMP SYNC.    01930001
019400     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       01940001
019500     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       01950001
019600     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01960001
019700     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01970001
019800                                          COMP SYNC.              01980001
019900     05  PV-ADJUST-COUNT                PIC S9(04)  VALUE +0      01990001
020000                                                    COMP SYNC.    02000001
020100     05  PV-SUB                         PIC S9(04)  VALUE +0      02010001
020200                                                    COMP SYNC.    02020001
020300     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02030001
020400                                                    COMP SYNC.    02040001
020500     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02050001
020600                                                    COMP-3.       02060001
020700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02070001
020800                                                    COMP-3.       02080001
020900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02090001
021000                                                    COMP-3.       02100001
021100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02110001
021200                                                    COMP-3.       02120001
021300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02130001
021400                                                    COMP-3.       02140001
021500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02150001
021600                                                    COMP-3.       02160001
021700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02170001
021800                                                    COMP-3.       02180001
021900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02190001
022000                                                    COMP SYNC.    02200001
022100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02210001
022200                                                    COMP SYNC.    02220001
022300     05  PV-ITEM                        PIC S9(04)  VALUE +0      02230001
022400                                                    COMP SYNC.    02240001
022500     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02250001
022600                                                    COMP SYNC.    02260001
022700     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02270001
022800                                                    COMP SYNC.    02280001
022900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02290001
023000                                                    COMP SYNC.    02300001
023100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02310001
023200                                                    COMP SYNC.    02320001
023300     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02330001
023400                                                    COMP SYNC.    02340001
023500     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02350001
023600                                                    COMP SYNC.    02360001
023700     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02370001
023800                                                    COMP SYNC.    02380001
023900     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02390001
024000                                                    COMP SYNC.    02400001
024100     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02410001
024200                                                    COMP SYNC.    02420001
024300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02430001
024400                                                    COMP SYNC.    02440001
024500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02450001
024600                                                    COMP SYNC.    02460001
024700     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02470001
024800                                                    COMP SYNC.    02480001
024900     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02490001
025000                                                    COMP SYNC.    02500001
025100     05  PV-SOFT-ABORT-MSG.                                       02510001
025200         10  FILLER            PIC X(12) VALUE ' SUKCS759 - '.    02520001
025300         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02530001
025400         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02540001
025500         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02550001
025600         10  PV-SOFT-PARAGRAPH PIC X(30).                         02560001
025700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02570001
025800                                                     COMP SYNC.   02580001
025900     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02590001
026000     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02600001
026100     05  PV-CICS-MSG-HOLD.                                        02610001
026200         10  FILLER                      PIC  X(01)  VALUE SPACE. 02620001
026300         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02630001
026400     05  PV-CICS-MSG-HOLD2.                                       02640001
026500         10  FILLER                      PIC  X(01)  VALUE SPACE. 02650001
026600         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02660001
026700                                                                  02670001
026800     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02680001
026900     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02690001
027000     05  PV-SEL-TERM-ID                  PIC  X(04).              02700001
027100     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02710001
027200     05  PV-SEL-SEQ                      PIC  9(01).              02720001
027300     05  PV-NET-ADJ                      PIC S9(04) COMP.         02730001
027400     05  PV-FROM-TMST                    PIC  X(26) VALUE SPACES. 02740001
027500     05  PV-FROM-TMST-X.                                          02750001
027600         10  PV-FROM-CC                  PIC  X(02).              02760001
027700         10  PV-FROM-YY                  PIC  X(02).              02770001
027800         10  FILLER                      PIC  X(01) VALUE '-'.    02780001
027900         10  PV-FROM-MM                  PIC  X(02).              02790001
028000         10  FILLER                      PIC  X(01) VALUE '-'.    02800001
028100         10  PV-FROM-DD                  PIC  X(02).              02810001
028200         10  FILLER                      PIC  X(01) VALUE '-'.    02820001
028300         10  PV-FROM-HR                  PIC  X(02) VALUE ZERO.   02830001
028400         10  FILLER                      PIC  X(01) VALUE '.'.    02840001
028500         10  PV-FROM-MN                  PIC  X(02) VALUE ZERO.   02850001
028600         10  FILLER                      PIC  X(01) VALUE '.'.    02860001
028700         10  PV-FROM-SS                  PIC  X(02) VALUE ZERO.   02870001
028800         10  FILLER                      PIC  X(01) VALUE '.'.    02880001
028900         10  PV-FROM-REST                PIC  X(06) VALUE ZERO.   02890001
029000     05  PV-TO-TMST                      PIC  X(26) VALUE SPACES. 02900001
029100     05  PV-TO-TMST-X.                                            02910001
029200         10  PV-TO-CC                    PIC  X(02).              02920001
029300         10  PV-TO-YY                    PIC  X(02).              02930001
029400         10  FILLER                      PIC  X(01) VALUE '-'.    02940001
029500         10  PV-TO-MM                    PIC  X(02).              02950001
029600         10  FILLER                      PIC  X(01) VALUE '-'.    02960001
029700         10  PV-TO-DD                    PIC  X(02).              02970001
029800         10  FILLER                      PIC  X(01) VALUE '-'.    02980001
029900         10  PV-TO-HR                    PIC  X(02) VALUE '23'.   02990001
030000         10  FILLER                      PIC  X(01) VALUE '.'.    03000001
030100         10  PV-TO-MN                    PIC  X(02) VALUE '59'.   03010001
030200         10  FILLER                      PIC  X(01) VALUE '.'.    03020001
030300         10  PV-TO-SS                    PIC  X(02) VALUE '59'.   03030001
030400         10  FILLER                      PIC  X(01) VALUE '.'.    03040001
030500         10  PV-TO-REST                 PIC  X(06) VALUE '999999'.03050001
030600     05  PV-DATE-TIME-TMST.                                       03060001
030700         10  PV-TD-YY                    PIC  X(04).              03070001
030800         10  FILLER                      PIC  X(01).              03080001
030900         10  PV-TD-MM                    PIC  X(02).              03090001
031000         10  FILLER                      PIC  X(01).              03100001
031100         10  PV-TD-DD                    PIC  X(02).              03110001
031200         10  FILLER                      PIC  X(01).              03120001
031300         10  PV-TD-HR                    PIC  X(02).              03130001
031400         10  FILLER                      PIC  X(01).              03140001
031500         10  PV-TD-MN                    PIC  X(02).              03150001
031600         10  FILLER                      PIC  X(01).              03160001
031700         10  PV-TD-SS                    PIC  X(02).              03170001
031800         10  FILLER                      PIC  X(01).              03180001
031900         10  PV-TD-REST                  PIC  X(06).              03190001
032000     05  PV-DATE.                                                 03200001
032100         10  PV-DT-MM                    PIC  X(02).              03210001
032200         10  FILLER                      PIC  X(01) VALUE '/'.    03220001
032300         10  PV-DT-DD                    PIC  X(02).              03230001
032400     05  PV-TIME.                                                 03240001
032500         10  PV-TI-HR                    PIC  X(02).              03250001
032600         10  FILLER                      PIC  X(01) VALUE ':'.    03260001
032700         10  PV-TI-MN                    PIC  X(02).              03270001
032800     05  PV-OPER-UNT-ID            PIC S9(04) COMP VALUE ZERO.    03280001
032900     05  PV-PO                     PIC S9(09) COMP VALUE ZERO.    03290001
033000     05  PV-RCVR                   PIC S9(09) COMP VALUE ZERO.    03300001
033100     05  PV-LINE                   PIC S9(09) COMP VALUE ZERO.    03310001
033200     05  PV-SKU-UPC.                                              03320001
033300         10  PV-SKU                PIC  Z(08) VALUE ZERO.         03330001
033400         10  FILLER                PIC  X(01) VALUE '/'.          03340001
033500         10  PV-UPC                PIC  Z(15) VALUE ZERO.         03350001
033600     05  PV-AUDIT-STATUS.                                         03360001
033700         10  PV-AUDIT                  PIC  Z(09)  VALUE ZERO.    03370001
033800         10  FILLER                    PIC  X(01)  VALUE '/'.     03380001
033900         10  PV-AUDIT-STAT             PIC  X(09)  VALUE SPACES.  03390001
034000     05  PV-NAME                       PIC  X(30).                03400001
034100                                                                  03410001
034200*----------------------------------------------------------------*03420001
034300*    COMMAREA FOR TMKCS520.                                      *03430001
034400*----------------------------------------------------------------*03440001
034500                                                                  03450001
034600     COPY TMWS500.                                                03460001
034700                                                                  03470001
034800*---------------------------------------------------------------* 03480001
034900*    NUMERIC EDIT LAYOUT.                                       * 03490001
035000*---------------------------------------------------------------* 03500001
035100     COPY DPWS010I.                                               03510001
035200                                                                  03520001
035300*---------------------------------------------------------------* 03530001
035400* SELECTON QUEUE LAYOUT                                         * 03540001
035500*---------------------------------------------------------------* 03550001
035600     COPY SUWS039.                                                03560001
035700                                                                  03570001
035800*---------------------------------------------------------------* 03580001
035900*    MAP LAYOUT                                                 * 03590001
036000*---------------------------------------------------------------* 03600001
036100     COPY SUKM759.                                                03610001
036200*                                                                 03620001
036300*-----------------------------------------------------------------03630001
036400*  COPYBOOK FOR LOGISTIC MODULE XLKUT001                          03640001
036500*-----------------------------------------------------------------03650001
036600     COPY XLWS001.                                                03660001
036700                                                                  03670001
036800******************************************************************03680032
036900* COMMAREA FOR XLKUT071 - LOCATION MODULE                         03690032
037000******************************************************************03700032
037100     COPY XLWS071.                                                03710032
037200/                                                                 03720032
037300*---------------------------------------------------------------* 03730001
037400*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03740001
037500*---------------------------------------------------------------* 03750001
037600     COPY DPWS015.                                                03760001
037700                                                                  03770001
037800*---------------------------------------------------------------* 03780001
037900*    FUNCTION KEYS COPYBOOK.                                    * 03790001
038000*---------------------------------------------------------------* 03800001
038100     COPY DPWS016.                                                03810001
038200                                                                  03820001
038300*----------------------------------------------------------------*03830001
038400**  SECURITY SUBROUTINE PARAMETERS                                03840001
038500*----------------------------------------------------------------*03850001
038600     COPY DPWS008.                                                03860001
038700                                                                  03870001
038800*---------------------------------------------------------------* 03880001
038900*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 03890038
039000*---------------------------------------------------------------* 03900001
039100     COPY DPWS030.                                                03910001
039110     COPY DPWS930.                                                03911038
039200                                                                  03920001
039300*---------------------------------------------------------------* 03930001
039400*    STANDARD COMMAREA.                                         * 03940001
039500*---------------------------------------------------------------* 03950001
039600     COPY DPWS020.                                                03960001
039700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03970001
039800                                                                  03980001
039900*---------------------------------------------------------------* 03990001
040000* INTER-APPLICATION COMMAREA.                                   * 04000001
040100*   SUWS037 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04010001
040200*             SPEC SCREEN.                                      * 04020001
040300*   SUWS038 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04030001
040400*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04040001
040500*---------------------------------------------------------------* 04050001
040600                                                                  04060001
040700         10  INTER-APPL-COMM-AREA       PIC X(200).               04070001
040800*-----------------------------------------------------------------04080001
040900*  COPYBOOK FOR GETTING TO THE TROUBLE LIST SCREEN.               04090001
041000*-----------------------------------------------------------------04100001
041100     COPY SUWS037.                                                04110001
041200     COPY SUWS038.                                                04120001
041300*---------------------------------------------------------------* 04130001
041400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04140001
041500*---------------------------------------------------------------* 04150001
041600         10  ASC-SPECIFIC-COMMAREA.                               04160001
041700             15  ASC-UNT-ADJ-TYP             PIC  X(01).          04170001
041800                 88  ASC-UNT-ADJ-ALL               VALUE 'A'.     04180001
041900                 88  ASC-UNT-ADJ-CNFRM             VALUE 'C'.     04190001
042000                 88  ASC-UNT-ADJ-POSTV             VALUE 'P'.     04200001
042100                 88  ASC-UNT-ADJ-VERFY             VALUE 'V'.     04210001
042200                 88  ASC-UNT-ADJ-P2L               VALUE 'Q'.     04220001
042300             15  ASC-FAIL-SUCCESS-IND        PIC X(01).           04230001
042400                 88  ASC-FAIL-SUCC-ALL             VALUE 'A'.     04240001
042500                 88  ASC-FAIL                      VALUE 'F'.     04250001
042600                 88  ASC-SUCCESS                   VALUE 'S'.     04260001
042700                 88  ASC-UNACKNOWLEDGED            VALUE 'U'.     04270001
042800             15  ASC-FROM-DATE.                                   04280001
042900                 20  ASC-FROM-MM             PIC  X(02).          04290001
043000                 20  ASC-FROM-DD             PIC  X(02).          04300001
043100                 20  ASC-FROM-CC             PIC  X(02).          04310001
043200                 20  ASC-FROM-YY             PIC  X(02).          04320001
043300             15  ASC-TO-DATE.                                     04330001
043400                 20  ASC-TO-MM               PIC  X(02).          04340001
043500                 20  ASC-TO-DD               PIC  X(02).          04350001
043600                 20  ASC-TO-CC               PIC  X(02).          04360001
043700                 20  ASC-TO-YY               PIC  X(02).          04370001
043800             15  ASC-OPER-UNT-ID-X           PIC  X(04).          04380001
043900             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID-X.   04390001
044000                 20  ASC-OPER-UNT-ID         PIC  Z(04).          04400001
044100             15  ASC-OPER-NAME               PIC  X(25).          04410001
044200             15  ASC-PO-RCVR.                                     04420001
044300                 20  ASC-PO-NBR              PIC  X(09).          04430001
044400                 20  FILLER                  PIC  X(01).          04440001
044500                 20  ASC-RCVR-NBR            PIC  X(03).          04450001
044600             15  ASC-PO-X                    PIC  X(09).          04460001
044700             15  ASC-PO-N REDEFINES ASC-PO-X.                     04470001
044800                 20  ASC-PO                  PIC  9(09).          04480001
044900             15  ASC-RCVR-X                  PIC  X(04).          04490001
045000             15  ASC-RCVR-N REDEFINES ASC-RCVR-X.                 04500001
045100                 20  ASC-RCVR                PIC  9(04).          04510001
045200             15  ASC-LINE-X                  PIC X(04).           04520001
045300             15  ASC-LINE-N REDEFINES ASC-LINE-X.                 04530001
045400                 20  ASC-LINE                PIC  9(04).          04540001
045500             15  ASC-STR-NBR-X               PIC  X(04).          04550001
045600             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           04560001
045700                 20  ASC-STR-NBR             PIC  9(04).          04570019
045800             15  ASC-STR-NAME                PIC  X(20).          04580001
045900             15  ASC-SKU-X                   PIC  X(08).          04590001
046000             15  ASC-SKU-N REDEFINES ASC-SKU-X.                   04600001
046100                 20  ASC-SKU                 PIC  Z(08).          04610001
046200             15  ASC-UPC-X                   PIC  X(15).          04620001
046300             15  ASC-UPC-N REDEFINES ASC-UPC-X.                   04630001
046400                 20  ASC-UPC                 PIC  Z(15).          04640001
046500             15  ASC-AUDIT-X                 PIC  X(09).          04650001
046600             15  ASC-AUDIT-N REDEFINES ASC-AUDIT-X.               04660001
046700                 20  ASC-AUDIT               PIC  Z(09).          04670001
046800             15  ASC-AUDIT-STATUS            PIC  X(10).          04680001
046900             15  ASC-NET-ADJ                 PIC ZZZZZ9-.         04690001
047000             15  ASC-ADJ-SOURCE              PIC  X(08).          04700001
047100             15  ASC-PROCESS-GROUP           PIC  X(01).          04710001
047200             15  ASC-PROCESS-GRP-DESC        PIC  X(25).          04720001
047300             15  ASC-ACKNOWLEDGED            PIC  X(01).          04730001
047400             15  ASC-CRE-TMST                PIC  X(26).          04740001
047500             15  ASC-PRC-RSN-CDE             PIC  X(08).          04750001
047510                 88 ASC-FAILED-FROM-P2L      VALUE 'PCKCS722',    04751041
047520                                                   'PCCS722B',    04752041
047530                                                   'PCCS722C',    04753041
047540                                                   'PCCS722D',    04754041
047550                                                   'PCCS722E'.    04755041
047600             15  ASC-CRE-BY                  PIC  X(08).          04760001
047700             15  ASC-ADJ-NAME                PIC  X(30).          04770001
047800             15  ASC-RSLV-BY                 PIC  X(08).          04780001
047900             15  ASC-RSLV-NAME               PIC  X(30).          04790001
048000             15  ASC-RSLV-TMST               PIC  X(26).          04800001
048100             15  ASC-FINCL-ID                PIC S9(09) COMP.     04810001
048200             15  ASC-SHIPT-UNT-ID            PIC S9(18)V COMP-3.  04820001
048300             15  ASC-BEF-QTY                 PIC S9(06).          04830001
048400             15  ASC-AFT-QTY                 PIC S9(06).          04840001
048500             15  ASC-ADJ-ERR-CDE             PIC S9(04) COMP.     04850001
048600             15  ASC-ERR-CDE                 PIC  X(10).          04860001
048700             15  ASC-AUD-TYP.                                     04870001
048800                 20  ASC-SYS-MAN             PIC  X(07).          04880001
048900                 20  ASC-1-2-3               PIC  X(06).          04890001
049000             15  ASC-ACT-QTY                 PIC  X(06).          04900002
049100             15  ASC-VRF-QTY                 PIC  X(06).          04910002
049200             15  ASC-CURR-STATUS             PIC  X(08).          04920002
049300             15  ASC-COMMENT-FIELD           PIC  X(255).         04930001
049400             15  ASC-COMMENT-FIELD-X.                             04940000
049500                 20  ASC-COMMENT-1           PIC  X(79).          04950000
049600                 20  ASC-COMMENT-2           PIC  X(79).          04960000
049700                 20  ASC-COMMENT-3           PIC  X(79).          04970000
049800             15  ASC-INT-APPL-FORMAT-IND     PIC  X(01).          04980000
049900                                                                  04990000
050000*-----------------------------------------------------------------05000000
050100             15  ASC-BLK-SUB                  PIC S9(04) COMP     05010000
050200                                                         SYNC.    05020000
050300             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05030000
050400                                                         SYNC.    05040000
050500             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05050000
050600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05060000
050700             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05070000
050800             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05080000
050900             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05090000
051000             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05100000
051100                                                         SYNC.    05110000
051200             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05120000
051300             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05130000
051400             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05140000
051500                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05150000
051600                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05160000
051700             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05170000
051800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05180000
051900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05190000
052000             15  ASC-LIST-QUEUE-NAME.                             05200000
052100                 20  ASC-LIST-TERM-ID         PIC  X(04).         05210000
052200                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05220000
052300                 20  ASC-LIST-SEQ             PIC  9(01).         05230000
052400                                                                  05240000
052500             15  ASC-START-ITEM-REQUEST.                          05250000
052600                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05260000
052700                                                                  05270000
052800             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05280000
052900             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05290000
053000             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05300000
053100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05310000
053200             15  ASC-SEL-QUEUE-NAME.                              05320000
053300                 20  ASC-SEL-TERM-ID          PIC  X(04).         05330000
053400                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05340000
053500                 20  ASC-SEL-SEQ              PIC  9(01).         05350000
053600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05360000
053700                                                                  05370000
053800*-----------------------------------------------------------------05380000
053900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05390000
054000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05400000
054100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05410000
054200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05420000
054300                                                                  05430000
054400                                                                  05440000
054500*---------------------------------------------------------------* 05450000
054600*    ABEND PROCESSING COPYBOOK.                                 * 05460000
054700*---------------------------------------------------------------* 05470000
054800     COPY DPWS013.                                                05480000
054900                                                                  05490000
055000*----------------------------------------------------------------*05500022
055100***  LAYOUT FOR THE TEMP ASSOC INFO SUBROUTINE                    05510022
055200*----------------------------------------------------------------*05520022
055300     COPY XLWS067.                                                05530022
055400                                                                  05540022
055500*---------------------------------------------------------------* 05550000
055600*    DB2 AREA FOR SYSDUMMY TABLE                                  05560000
055700*---------------------------------------------------------------* 05570000
055800     EXEC SQL                                                     05580000
055900          INCLUDE SYSDUMMY                                        05590000
056000     END-EXEC.                                                    05600000
056100                                                                  05610000
056200*---------------------------------------------------------------* 05620000
056300*    PROCESS GROUP TABLE - SUT_PRC_GP                             05630000
056400*---------------------------------------------------------------* 05640000
056500     EXEC SQL                                                     05650000
056600          INCLUDE SUT00033                                        05660000
056700     END-EXEC.                                                    05670000
056800                                                                  05680000
056900*---------------------------------------------------------------* 05690000
057000*    FINANCIAL ADJUSTMENT TABLE - SUT_FINCL_ADJ                   05700000
057100*---------------------------------------------------------------* 05710000
057200     EXEC SQL                                                     05720000
057300          INCLUDE SUT00030                                        05730000
057400     END-EXEC.                                                    05740000
057500                                                                  05750000
057600*---------------------------------------------------------------* 05760000
057700*    STORE UNIT ADJUSTMENT ERROR CODE TABLE - SUT_ADJ_ERR_CDE     05770000
057800*---------------------------------------------------------------* 05780000
057900     EXEC SQL                                                     05790000
058000          INCLUDE SUT00031                                        05800000
058100     END-EXEC.                                                    05810000
058200                                                                  05820000
058300*---------------------------------------------------------------* 05830000
058400*     SUT_PO_AUD_REQ - SYSTEM REQUESTED AUDITS                    05840000
058500*---------------------------------------------------------------* 05850000
058600     EXEC SQL                                                     05860000
058700          INCLUDE SUT00015                                        05870000
058800     END-EXEC.                                                    05880000
058900                                                                  05890000
059000*---------------------------------------------------------------* 05900000
059100*    THE TSURSNC TABLE                                            05910000
059200*---------------------------------------------------------------* 05920000
059300     EXEC SQL                                                     05930000
059400          INCLUDE TSURSNC                                         05940000
059500     END-EXEC.                                                    05950000
059600                                                                  05960000
059700*---------------------------------------------------------------* 05970000
059800*    THE TSUNAUD TABLE                                            05980000
059900*---------------------------------------------------------------* 05990000
060000     EXEC SQL                                                     06000000
060100          INCLUDE TSUNAUD                                         06010000
060200     END-EXEC.                                                    06020000
060300                                                                  06030000
060400*---------------------------------------------------------------* 06040033
060500                                                                  06050000
060600     EXEC SQL                                                     06060000
060700          INCLUDE TRECDIS                                         06070000
060800     END-EXEC.                                                    06080000
060900                                                                  06090000
061000     EXEC SQL                                                     06100000
061100          INCLUDE TRECITM                                         06110000
061200     END-EXEC.                                                    06120000
061300                                                                  06130030
061400     EXEC SQL                                                     06140030
061500          INCLUDE TRECEIV                                         06150030
061600     END-EXEC.                                                    06160030
061700                                                                  06170000
061800     EXEC SQL                                                     06180000
061900          INCLUDE TDISTHD                                         06190000
062000     END-EXEC.                                                    06200000
062100                                                                  06210000
062200     EXEC SQL                                                     06220000
062300          INCLUDE TTRBNTF                                         06230000
062400     END-EXEC.                                                    06240000
062500                                                                  06250000
062600*---------------------------------------------------------------* 06260000
062700*---------------------------------------------------------------* 06270000
062800     EXEC SQL                                                     06280000
062900          INCLUDE SQLCA                                           06290000
063000     END-EXEC.                                                    06300000
063100                                                                  06310000
063200     EXEC SQL                                                     06320000
063300         DECLARE TRBNTF-LINE-CSR CURSOR WITH HOLD FOR             06330000
063400         SELECT PO_LNE_NBR                                        06340000
063500             FROM TTRBNTF                                         06350000
063600             WHERE PO_NBR         = :DK-PO                        06360000
063700               AND TRBL_RSN_CDE   = 371                           06370000
063800               AND REC_SEQ_NBR    = :DK-RCVR                      06380000
063900               AND RESOLVED_IND IN ('N', 'I')                     06390000
064000     END-EXEC.                                                    06400000
064100*-----------------------------------------------------------------06410000
064200 LINKAGE SECTION.                                                 06420000
064300                                                                  06430000
064400 01  DFHCOMMAREA.                                                 06440000
064500     05  FILLER                         OCCURS  1 TO 4072 TIMES   06450000
064600                                        DEPENDING ON EIBCALEN.    06460000
064700         10  FILLER                     PIC X.                    06470000
064800                                                                  06480000
064900                                                                  06490000
065000 PROCEDURE DIVISION.                                              06500000
065100******************************************************************06510000
065200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06520000
065300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06530000
065400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06540000
065500******************************************************************06550000
065600 0000-MAIN-MODULE.                                                06560000
065700     INITIALIZE DP030-CICS-API-FIELDS.                            06570000
065800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06580000
065900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06590000
066000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06600000
066100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06610000
066200     MOVE LENGTH OF SU759AI        TO DP030-MAP-LENGTH (1).       06620000
066300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06630000
066400     PERFORM 0001-CALL-CICS-ARCH-API.                             06640000
066500                                                                  06650000
066600     PERFORM 1000-CONTROL-PROCESSING                              06660000
066700*                                                                 06670000
066800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06680000
066900     PERFORM 0001-CALL-CICS-ARCH-API.                             06690000
067000                                                                  06700000
067100******************************************************************06710000
067200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06720000
067300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06730000
067400******************************************************************06740000
067500 0001-CALL-CICS-ARCH-API.                                         06750000
067600*    CALL 'DPKCS030' USING DFHEIBLK                               06760038
067610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06761038
067700                           DFHCOMMAREA                            06770000
067800                           DP030-CICS-API-FIELDS                  06780000
067900                           DP020-STANDARD-COMMAREA                06790000
068000                           SU759AI.                               06800000
068100*                                                                 06810000
068200     IF  DP030-RC-CALL-SUCCESSFUL                                 06820000
068300         CONTINUE                                                 06830000
068400     ELSE                                                         06840000
068500         SET DP013-NO-ROLLBACK                                    06850000
068600             DP013-XCTL-DISPLAY-RESTART                           06860000
068700             DP013-CICS-ABEND      TO TRUE                        06870000
068800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        06880000
068900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06890038
069000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06900038
069010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06901038
069020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06902038
069100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06910000
069200         PERFORM DP013-0000-PROCESS-ABEND                         06920000
069300     END-IF.                                                      06930000
069400                                                                  06940000
069500*----------------------------------------------------------------*06950000
069600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06960000
069700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06970000
069800*                                                                *06980000
069900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06990000
070000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07000000
070100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07010000
070200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07020000
070300*----------------------------------------------------------------*07030000
070400 1000-CONTROL-PROCESSING.                                         07040000
070500                                                                  07050000
070600     EVALUATE TRUE                                                07060000
070700         WHEN DP020-NEXT-ACT-INITIAL                              07070000
070800             INITIALIZE ASC-SPECIFIC-COMMAREA                     07080000
070900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07090000
071000                                      ASC-SEL-TERM-ID             07100000
071100             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   07110000
071200                                           ASC-SEL-TASK-NUMBER    07120000
071300             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              07130000
071400             MOVE PC-SEL-QUEUE-SEQ   TO ASC-SEL-SEQ               07140000
071500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07150000
071600             PERFORM 4000-BUILD-INITIAL-PANEL                     07160000
071700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07170000
071800                                                                  07180000
071900         WHEN DP020-NEXT-ACT-READ-MAP                             07190000
072000*            MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07200000
072100             MOVE +1 TO ASC-ITEM-AT-TOP-OF-PANEL PV-TOP-ITEM      07210000
072200             PERFORM 2000-PROCESS-PANEL                           07220000
072300                                                                  07230000
072400         WHEN DP020-NEXT-ACT-RETURN                               07240000
072500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07250000
072600                                                                  07260000
072700         WHEN OTHER                                               07270000
072800             SET DP013-LOGIC-ABEND TO TRUE                        07280000
072900             SET DP013-NO-ROLLBACK TO TRUE                        07290000
073000             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07300000
073100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07310000
073200                                   TO DP013-MESSAGE-TEXT(1)       07320000
073300             PERFORM DP013-0000-PROCESS-ABEND                     07330000
073400     END-EVALUATE.                                                07340000
073500                                                                  07350000
073600*----------------------------------------------------------------*07360000
073700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07370000
073800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07380000
073900*----------------------------------------------------------------*07390000
074000 1100-PROCESS-INTER-APPL-COMM.                                    07400000
074100                                                                  07410000
074200     SET PS-COMMAREA-VALID         TO TRUE.                       07420000
074300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07430000
074400                                                                  07440000
074500     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   07450009
074600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07460000
074700         MOVE SU037-UNT-ADJ-TYP       TO ASC-UNT-ADJ-TYP          07470000
074800         MOVE SU037-FAIL-SUCCESS-IND  TO ASC-FAIL-SUCCESS-IND     07480000
074900         MOVE SU037-REQUEST-FROM-DATE TO ASC-FROM-DATE            07490000
075000         MOVE SU037-REQUEST-TO-DATE   TO ASC-TO-DATE              07500000
075100         MOVE SU037-OPER-UNT-ID       TO ASC-OPER-UNT-ID          07510000
075200         MOVE SU037-OPER-NAME         TO ASC-OPER-NAME            07520000
075300         MOVE SU037-PO                TO ASC-PO                   07530000
075400                                         DK-TRN-NBR               07540000
075500         MOVE SU037-RCVR              TO ASC-RCVR                 07550000
075600                                         DK-PO-RCVR-NBR-N         07560000
075700         MOVE DK-PO-RCVR-NBR-N        TO DK-RCVR-NBR-9            07570000
075800         MOVE DK-RCVR-NBR-3           TO DK-RCVR-NBR              07580000
075900         MOVE DK-PO-RCVR              TO ASC-PO-RCVR              07590000
076000         MOVE SU037-LINE              TO ASC-LINE                 07600000
076100         MOVE SU037-STR-NBR           TO ASC-STR-NBR              07610000
076200         MOVE SU037-STR-NAME          TO ASC-STR-NAME             07620000
076300         MOVE SU037-UPC               TO ASC-UPC                  07630000
076400         MOVE SU037-SKU               TO ASC-SKU                  07640000
076500         MOVE SU037-AUDIT-NBR         TO ASC-AUDIT                07650000
076600     ELSE                                                         07660000
076700         IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT          07670000
076800             SET ASC-USE-SELECTION-QUEUE TO TRUE                  07680000
076900             MOVE SU038-NUMBER-OF-SELECTED-ITEMS TO               07690000
077000                                      ASC-NUMBER-OF-SELECTED-ITEMS07700000
077100             MOVE SU038-NUMBER-OF-TS-ITEMS TO                     07710000
077200                                            ASC-NUMBER-OF-TS-ITEMS07720000
077300             MOVE SU038-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME  07730000
077400             MOVE SU038-OPER-UNT-ID        TO ASC-OPER-UNT-ID     07740000
077500             MOVE SU038-PO-RCVR            TO ASC-PO-RCVR         07750000
077600             MOVE SU038-LINE               TO ASC-LINE            07760000
077700             MOVE SU038-SKU                TO ASC-SKU             07770000
077800             MOVE SU038-UPC                TO ASC-UPC             07780000
077900             MOVE SU038-UNT-ADJ-TYP        TO ASC-UNT-ADJ-TYP     07790000
078000             MOVE SU038-FAIL-SUCCSS        TO ASC-FAIL-SUCCESS-IND07800000
078100             MOVE SU038-AUDIT              TO ASC-AUDIT           07810000
078200             MOVE SU038-AUDIT-STATUS       TO ASC-AUDIT-STATUS    07820000
078300             MOVE SU038-FROM-DATE          TO ASC-FROM-DATE       07830000
078400             MOVE SU038-TO-DATE            TO ASC-TO-DATE         07840000
078500             PERFORM 1120-PREPARE-LIST-ENTRY                      07850000
078600             MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A            07860000
078700                                             ACOMMNT2A            07870000
078800                                             ACOMMNT3A            07880000
078900             MOVE DP015-BLUE             TO  ACOMMNT1C            07890000
079000                                             ACOMMNT2C            07900000
079100                                             ACOMMNT3C            07910000
079200             MOVE DP015-HL-OFF           TO  ACOMMNT1H            07920000
079300                                             ACOMMNT2H            07930000
079400                                             ACOMMNT3H            07940000
079500         ELSE                                                     07950000
079600             SET ASC-USE-SELECTION-QUEUE TO TRUE                  07960000
079700             MOVE SU038-NUMBER-OF-SELECTED-ITEMS TO               07970000
079800                                      ASC-NUMBER-OF-SELECTED-ITEMS07980000
079900             MOVE SU038-NUMBER-OF-TS-ITEMS TO                     07990000
080000                                            ASC-NUMBER-OF-TS-ITEMS08000000
080100             MOVE SU038-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME  08010000
080200             MOVE SU038-OPER-UNT-ID        TO ASC-OPER-UNT-ID     08020000
080300             MOVE SU038-PO-RCVR            TO ASC-PO-RCVR         08030000
080400             MOVE SU038-LINE               TO ASC-LINE            08040000
080500             MOVE SU038-SKU                TO ASC-SKU             08050000
080600             MOVE SU038-UPC                TO ASC-UPC             08060000
080700             MOVE SU038-UNT-ADJ-TYP        TO ASC-UNT-ADJ-TYP     08070000
080800             MOVE SU038-FAIL-SUCCSS        TO ASC-FAIL-SUCCESS-IND08080000
080900             MOVE SU038-AUDIT              TO ASC-AUDIT           08090000
081000             MOVE SU038-AUDIT-STATUS       TO ASC-AUDIT-STATUS    08100000
081100             MOVE SU038-FROM-DATE          TO ASC-FROM-DATE       08110000
081200             MOVE SU038-TO-DATE            TO ASC-TO-DATE         08120000
081300             PERFORM 1120-PREPARE-LIST-ENTRY                      08130000
081400             IF ASC-ACKNOWLEDGED = 'U'                            08140000
081500                 MOVE DP015-UNP-ALP-NOR-MDT  TO  ACOMMNT1A        08150000
081600                                                 ACOMMNT2A        08160000
081700                                                 ACOMMNT3A        08170000
081800                 MOVE DP015-GREEN            TO  ACOMMNT1C        08180000
081900                                                 ACOMMNT2C        08190000
082000                                                 ACOMMNT3C        08200000
082100                 MOVE DP015-UNDERLINE        TO  ACOMMNT1H        08210000
082200                                                 ACOMMNT2H        08220000
082300                                                 ACOMMNT3H        08230000
082400                 MOVE -1                     TO  ACOMMNT1L        08240000
082500                 SET DP030-SET-CURSOR-APPL-1 TO  TRUE             08250000
082600             ELSE                                                 08260000
082700                 MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A        08270000
082800                                                 ACOMMNT2A        08280000
082900                                                 ACOMMNT3A        08290000
083000                 MOVE DP015-BLUE             TO  ACOMMNT1C        08300000
083100                                                 ACOMMNT2C        08310000
083200                                                 ACOMMNT3C        08320000
083300                 MOVE DP015-HL-OFF           TO  ACOMMNT1H        08330000
083400                                                 ACOMMNT2H        08340000
083500                                                 ACOMMNT3H        08350000
083600             END-IF                                               08360000
083700         END-IF                                                   08370000
083800     END-IF.                                                      08380000
083900                                                                  08390000
084017                                                                  08401742
084018                                                                  08401842
084020*-----------------------------------------------------------------08402000
084100*  PREPARE LIST ENTRY                                             08410000
084200*-----------------------------------------------------------------08420000
084300 1120-PREPARE-LIST-ENTRY.                                         08430000
084400                                                                  08440000
084500     MOVE SU039-MAX-ITEMS          TO ASC-SEL-SUB.                08450000
084600     MOVE ZERO                     TO ASC-SEL-ITEM.               08460000
084700     PERFORM 1130-GET-NEXT-RECORD.                                08470000
084800                                                                  08480000
084900*-----------------------------------------------------------------08490000
085000*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08500000
085100*-----------------------------------------------------------------08510000
085200 1130-GET-NEXT-RECORD.                                            08520000
085300     ADD +1                       TO ASC-SEL-SUB.                 08530000
085400                                                                  08540000
085500     IF  ASC-SEL-SUB > SU039-MAX-ITEMS                            08550000
085600         ADD +1                   TO ASC-SEL-ITEM                 08560000
085700         MOVE +1                  TO ASC-SEL-SUB                  08570000
085800     END-IF.                                                      08580000
085900                                                                  08590000
086000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08600000
086100         PERFORM 9100-READ-SEL-QUEUE                              08610000
086200         IF  SU039-ITEM (ASC-SEL-SUB) > ZERO                      08620000
086300            MOVE SU039-STR-NBR (ASC-SEL-SUB)    TO ASC-STR-NBR    08630000
086400            MOVE SU039-UPC     (ASC-SEL-SUB)    TO ASC-UPC        08640000
086410            MOVE SU039-SKU     (ASC-SEL-SUB)    TO ASC-SKU        08641037
086500            MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB) TO ASC-ADJ-SOURCE 08650000
086600            MOVE SU039-PROCESS-GROUP (ASC-SEL-SUB)                08660000
086700                                             TO ASC-PROCESS-GROUP 08670000
086800            MOVE SU039-BEF-QTY (ASC-SEL-SUB)    TO ASC-BEF-QTY    08680000
086900            MOVE SU039-AFT-QTY (ASC-SEL-SUB)    TO ASC-AFT-QTY    08690000
087000            MOVE SU039-ERR-CDE (ASC-SEL-SUB)    TO ASC-ERR-CDE    08700000
087100            MOVE SU039-FINCL-ID (ASC-SEL-SUB)   TO ASC-FINCL-ID   08710000
087200            MOVE SU039-SHIPT-UNT-ID (ASC-SEL-SUB)                 08720000
087300                                              TO ASC-SHIPT-UNT-ID 08730000
087400            MOVE SU039-FAIL-SUCCSS(ASC-SEL-SUB) TO                08740000
087500                                           ASC-FAIL-SUCCESS-IND   08750000
087600           MOVE SU039-ACKNOWLEDGE(ASC-SEL-SUB) TO ASC-ACKNOWLEDGED08760000
087700           IF NOT SU039-UPD (ASC-SEL-SUB)                         08770000
087800               SET SU039-INQ (ASC-SEL-SUB) TO TRUE                08780000
087900           END-IF                                                 08790000
088000            PERFORM 9200-REWRITE-SEL-QUEUE                        08800000
088100            IF  ASC-INT-APPL-FORMAT-IND =  '3'                    08810000
088200                IF ASC-ACKNOWLEDGED = 'U'                         08820000
088300                     MOVE DP015-UNP-ALP-NOR-MDT  TO  ACOMMNT1A    08830000
088400                                                     ACOMMNT2A    08840000
088500                                                     ACOMMNT3A    08850000
088600                     MOVE DP015-GREEN            TO  ACOMMNT1C    08860000
088700                                                     ACOMMNT2C    08870000
088800                                                     ACOMMNT3C    08880000
088900                     MOVE DP015-UNDERLINE        TO  ACOMMNT1H    08890000
089000                                                     ACOMMNT2H    08900000
089100                                                     ACOMMNT3H    08910000
089200                     MOVE -1                     TO  ACOMMNT1L    08920000
089300                     SET DP030-SET-CURSOR-APPL-1 TO  TRUE         08930000
089400                ELSE                                              08940000
089500                     MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A    08950000
089600                                                     ACOMMNT2A    08960000
089700                                                     ACOMMNT3A    08970000
089800                     MOVE DP015-BLUE             TO  ACOMMNT1C    08980000
089900                                                     ACOMMNT2C    08990000
090000                                                     ACOMMNT3C    09000000
090100                     MOVE DP015-HL-OFF           TO  ACOMMNT1H    09010000
090200                                                     ACOMMNT2H    09020000
090300                                                     ACOMMNT3H    09030000
090400                 END-IF                                           09040000
090500             END-IF                                               09050000
090600         ELSE                                                     09060000
090700             SUBTRACT +1 FROM ASC-SEL-SUB                         09070000
090800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09080000
090900             SET DP020-MSG-INFORMATIONAL                          09090000
091000                 PS-LIST-END             TO TRUE                  09100000
091100         END-IF                                                   09110000
091200     ELSE                                                         09120000
091300         SUBTRACT +1 FROM ASC-SEL-ITEM                            09130000
091400         MOVE SU039-MAX-ITEMS     TO ASC-SEL-SUB                  09140000
091500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09150000
091600         SET DP020-MSG-INFORMATIONAL                              09160000
091700             PS-LIST-END             TO TRUE                      09170000
091800     END-IF.                                                      09180000
091900                                                                  09190000
092000*----------------------------------------------------------------*09200000
092100*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09210000
092200*    PROCESSED.                                                  *09220000
092300*----------------------------------------------------------------*09230000
092400 1140-GET-PREV-RECORD.                                            09240000
092500     SUBTRACT +1 FROM ASC-SEL-SUB.                                09250000
092600                                                                  09260000
092700     IF  ASC-SEL-SUB < +1                                         09270000
092800         SUBTRACT +1 FROM ASC-SEL-ITEM                            09280000
092900         MOVE SU039-MAX-ITEMS     TO ASC-SEL-SUB                  09290000
093000     END-IF.                                                      09300000
093100                                                                  09310000
093200     IF  ASC-SEL-ITEM > ZERO                                      09320000
093300         PERFORM 9100-READ-SEL-QUEUE                              09330000
093400         MOVE SU039-STR-NBR (ASC-SEL-SUB)    TO ASC-STR-NBR       09340000
093500         MOVE SU039-UPC     (ASC-SEL-SUB)    TO ASC-UPC           09350000
093600         MOVE SU039-SKU     (ASC-SEL-SUB)    TO ASC-SKU           09360000
093700         MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB) TO ASC-ADJ-SOURCE    09370000
093800         MOVE SU039-PROCESS-GROUP (ASC-SEL-SUB)                   09380000
093900                                             TO ASC-PROCESS-GROUP 09390000
094000         MOVE SU039-BEF-QTY (ASC-SEL-SUB)    TO ASC-BEF-QTY       09400000
094100         MOVE SU039-AFT-QTY (ASC-SEL-SUB)    TO ASC-AFT-QTY       09410000
094200         MOVE SU039-ERR-CDE (ASC-SEL-SUB)    TO ASC-ERR-CDE       09420000
094300         MOVE SU039-FINCL-ID (ASC-SEL-SUB)   TO ASC-FINCL-ID      09430000
094400         MOVE SU039-FAIL-SUCCSS(ASC-SEL-SUB) TO                   09440000
094500                                              ASC-FAIL-SUCCESS-IND09450000
094600         MOVE SU039-ACKNOWLEDGE(ASC-SEL-SUB) TO ASC-ACKNOWLEDGED  09460000
094700         IF NOT SU039-UPD (ASC-SEL-SUB)                           09470000
094800             SET SU039-INQ (ASC-SEL-SUB) TO TRUE                  09480000
094900         END-IF                                                   09490000
095000         PERFORM 9200-REWRITE-SEL-QUEUE                           09500000
095100         IF  ASC-INT-APPL-FORMAT-IND =  '3'                       09510000
095200             IF ASC-ACKNOWLEDGED = 'U'                            09520000
095300                  MOVE DP015-UNP-ALP-NOR-MDT  TO  ACOMMNT1A       09530000
095400                                                  ACOMMNT2A       09540000
095500                                                  ACOMMNT3A       09550000
095600                  MOVE DP015-GREEN            TO  ACOMMNT1C       09560000
095700                                                  ACOMMNT2C       09570000
095800                                                  ACOMMNT3C       09580000
095900                  MOVE DP015-UNDERLINE        TO  ACOMMNT1H       09590000
096000                                                  ACOMMNT2H       09600000
096100                                                  ACOMMNT3H       09610000
096200                  MOVE -1                     TO  ACOMMNT1L       09620000
096300                  SET DP030-SET-CURSOR-APPL-1 TO  TRUE            09630000
096400             ELSE                                                 09640000
096500                  MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A       09650000
096600                                                  ACOMMNT2A       09660000
096700                                                  ACOMMNT3A       09670000
096800                  MOVE DP015-BLUE             TO  ACOMMNT1C       09680000
096900                                                  ACOMMNT2C       09690000
097000                                                  ACOMMNT3C       09700000
097100                  MOVE DP015-HL-OFF           TO  ACOMMNT1H       09710000
097200                                                  ACOMMNT2H       09720000
097300                                                  ACOMMNT3H       09730000
097400              END-IF                                              09740000
097500          END-IF                                                  09750000
097600     ELSE                                                         09760000
097700         MOVE +1                  TO ASC-SEL-ITEM                 09770000
097800                                     ASC-SEL-SUB                  09780000
097900         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09790000
098000         SET DP020-MSG-INFORMATIONAL                              09800000
098100             PS-LIST-END             TO TRUE                      09810000
098200     END-IF.                                                      09820000
098300                                                                  09830000
098400*----------------------------------------------------------------*09840000
098500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09850000
098600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09860000
098700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09870000
098800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09880000
098900* FUNCTION KEYS CAN GET THIS FAR.                                *09890000
099000*----------------------------------------------------------------*09900000
099100 2000-PROCESS-PANEL.                                              09910000
099200     EVALUATE TRUE                                                09920000
099300         WHEN DP020-SRC-AID = DP016-CLEAR                         09930000
099400             MOVE ZERO   TO ASC-ITEM-AT-TOP-OF-PANEL              09940000
099500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09950000
099600                                                                  09960000
099700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09970000
099800             PERFORM 4000-BUILD-INITIAL-PANEL                     09980000
099900             IF ASC-ACKNOWLEDGED = 'U'                            09990000
100000                 MOVE DP015-UNP-ALP-NOR-MDT  TO  ACOMMNT1A        10000000
100100                                                 ACOMMNT2A        10010000
100200                                                 ACOMMNT3A        10020000
100300                 MOVE DP015-GREEN            TO  ACOMMNT1C        10030000
100400                                                 ACOMMNT2C        10040000
100500                                                 ACOMMNT3C        10050000
100600                 MOVE DP015-UNDERLINE        TO  ACOMMNT1H        10060000
100700                                                 ACOMMNT2H        10070000
100800                                                 ACOMMNT3H        10080000
100900                 MOVE -1                     TO  ACOMMNT1L        10090000
101000                 SET DP030-SET-CURSOR-APPL-1 TO  TRUE             10100000
101100             ELSE                                                 10110000
101200                 MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A        10120000
101300                                                 ACOMMNT2A        10130000
101400                                                 ACOMMNT3A        10140000
101500                 MOVE DP015-BLUE             TO  ACOMMNT1C        10150000
101600                                                 ACOMMNT2C        10160000
101700                                                 ACOMMNT3C        10170000
101800                 MOVE DP015-HL-OFF           TO  ACOMMNT1H        10180000
101900                                                 ACOMMNT2H        10190000
102000                                                 ACOMMNT3H        10200000
102100             END-IF                                               10210000
102200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10220000
102300                                                                  10230000
102400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10240000
102500             IF  ASC-USE-SELECTION-QUEUE                          10250000
102600                 PERFORM 1130-GET-NEXT-RECORD                     10260000
102700                 IF PS-LIST-END                                   10270000
102800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10280000
102900                     SET PS-NO-LIST-END TO TRUE                   10290000
103000                 ELSE                                             10300000
103100                     PERFORM 2050-DELETE-LIST-QUEUE               10310000
103200                     PERFORM 4000-BUILD-INITIAL-PANEL             10320000
103300                     IF ASC-ACKNOWLEDGED = 'U' AND                10330010
103400                        ASC-RSLV-BY = SPACES AND                  10340013
103500                        ASC-INT-APPL-FORMAT-IND =  '3'            10350013
103600                        MOVE DP015-UNP-ALP-NOR-MDT  TO  ACOMMNT1A 10360000
103700                                                        ACOMMNT2A 10370000
103800                                                        ACOMMNT3A 10380000
103900                        MOVE DP015-GREEN            TO  ACOMMNT1C 10390000
104000                                                        ACOMMNT2C 10400000
104100                                                        ACOMMNT3C 10410000
104200                        MOVE DP015-UNDERLINE        TO  ACOMMNT1H 10420000
104300                                                        ACOMMNT2H 10430000
104400                                                        ACOMMNT3H 10440000
104500                        MOVE -1                     TO  ACOMMNT1L 10450000
104600                        SET DP030-SET-CURSOR-APPL-1 TO  TRUE      10460000
104700                    ELSE                                          10470000
104800                         MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A10480000
104900                                                         ACOMMNT2A10490000
105000                                                         ACOMMNT3A10500000
105100                         MOVE DP015-BLUE             TO  ACOMMNT1C10510000
105200                                                         ACOMMNT2C10520000
105300                                                         ACOMMNT3C10530000
105400                         MOVE DP015-HL-OFF           TO  ACOMMNT1H10540000
105500                                                         ACOMMNT2H10550000
105600                                                         ACOMMNT3H10560000
105700                     END-IF                                       10570000
105800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10580000
105900                 END-IF                                           10590000
106000              ELSE                                                10600000
106100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10610000
106200*                --- BOTTOM OF LIST ---                           10620000
106300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         10630000
106400                 SET DP020-MSG-INFORMATIONAL TO TRUE              10640000
106500             END-IF                                               10650000
106600                                                                  10660000
106700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10670000
106800             IF  ASC-USE-SELECTION-QUEUE                          10680000
106900                 PERFORM 1140-GET-PREV-RECORD                     10690000
107000                 IF PS-LIST-END                                   10700000
107100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10710000
107200                     SET PS-NO-LIST-END TO TRUE                   10720000
107300                 ELSE                                             10730000
107400                     PERFORM 2050-DELETE-LIST-QUEUE               10740000
107500                     PERFORM 4000-BUILD-INITIAL-PANEL             10750000
107600                     IF ASC-ACKNOWLEDGED = 'U' AND                10760011
107700                        ASC-RSLV-BY = SPACES AND                  10770013
107800                        ASC-INT-APPL-FORMAT-IND =  '3'            10780013
107900                        MOVE DP015-UNP-ALP-NOR-MDT  TO  ACOMMNT1A 10790000
108000                                                        ACOMMNT2A 10800000
108100                                                        ACOMMNT3A 10810000
108200                        MOVE DP015-GREEN            TO  ACOMMNT1C 10820000
108300                                                        ACOMMNT2C 10830000
108400                                                        ACOMMNT3C 10840000
108500                        MOVE DP015-UNDERLINE        TO  ACOMMNT1H 10850000
108600                                                        ACOMMNT2H 10860000
108700                                                        ACOMMNT3H 10870000
108800                        MOVE -1                     TO  ACOMMNT1L 10880000
108900                        SET DP030-SET-CURSOR-APPL-1 TO  TRUE      10890000
109000                    ELSE                                          10900000
109100                        MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A 10910011
109200                                                        ACOMMNT2A 10920011
109300                                                        ACOMMNT3A 10930011
109400                        MOVE DP015-BLUE             TO  ACOMMNT1C 10940011
109500                                                        ACOMMNT2C 10950011
109600                                                        ACOMMNT3C 10960011
109700                        MOVE DP015-HL-OFF           TO  ACOMMNT1H 10970011
109800                                                        ACOMMNT2H 10980011
109900                                                        ACOMMNT3H 10990011
110000                     END-IF                                       11000000
110100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11010000
110200                 END-IF                                           11020000
110300             ELSE                                                 11030000
110400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11040000
110500                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         11050000
110600                 SET DP020-MSG-INFORMATIONAL TO TRUE              11060000
110700             END-IF                                               11070000
110800                                                                  11080000
110900         WHEN OTHER                                               11090000
111000             IF  PS-NO-ERROR                                      11100000
111100                 SET DP030-CONTINUE-GO TO TRUE                    11110000
111200                 PERFORM 2100-CHECK-FUNCTION-KEY                  11120000
111300             ELSE                                                 11130000
111400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11140000
111500                 SET DP030-OVERRIDE-GO TO TRUE                    11150000
111600             END-IF                                               11160000
111700     END-EVALUATE.                                                11170000
111800                                                                  11180000
111900*----------------------------------------------------------------*11190000
112000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11200000
112100*----------------------------------------------------------------*11210000
112200 2050-DELETE-LIST-QUEUE.                                          11220000
112300                                                                  11230000
112400     EXEC CICS                                                    11240000
112500         DELETEQ TS                                               11250000
112600             QUEUE (ASC-LIST-QUEUE-NAME)                          11260000
112700             RESP  (PV-CICS-RESP)                                 11270000
112800     END-EXEC.                                                    11280000
112900                                                                  11290000
113000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11300000
113100        (PV-CICS-RESP = DFHRESP(QIDERR))                          11310000
113200         CONTINUE                                                 11320000
113300     ELSE                                                         11330000
113400         SET DP013-CICS-ABEND      TO TRUE                        11340000
113500         SET DP013-NO-ROLLBACK     TO TRUE                        11350000
113600                                                                  11360000
113700         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         11370000
113800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11380000
113900                                   TO DP013-MESSAGE-TEXT (1)      11390000
114000         PERFORM DP013-0000-PROCESS-ABEND                         11400000
114100     END-IF.                                                      11410000
114200                                                                  11420000
114300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11430000
114400                                                                  11440000
114500*----------------------------------------------------------------*11450000
114600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11460000
114700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11470000
114800* CICS ARCHITECTURE API.                                         *11480000
114900*----------------------------------------------------------------*11490000
115000 2100-CHECK-FUNCTION-KEY.                                         11500000
115100                                                                  11510000
115200     EVALUATE TRUE                                                11520000
115300*                                                                 11530000
115400* F15 - UPDATE                                                    11540000
115500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11550000
115501             SET PS-P2L-FAIL-ADJ-NO  TO TRUE                      11550144
115510             PERFORM 3600-CHECK-P2L-FAIL-ADJ                      11551044
115520             IF  PS-P2L-FAIL-ADJ                                  11552044
115530                 SET DP030-OVERRIDE-GO TO TRUE                    11553044
115540                 MOVE PC-TSYMSG-03823 TO DP020-MSG-NUMBER         11554044
115550                 SET DP020-MSG-FATAL   TO TRUE                    11555044
115560             ELSE                                                 11556044
115600             IF ASC-ACKNOWLEDGED = ' '                            11560000
115700                 SET DP030-OVERRIDE-GO TO TRUE                    11570000
115800                 MOVE PC-TSYMSG-03049 TO DP020-MSG-NUMBER         11580000
115900                 SET DP020-MSG-FATAL   TO TRUE                    11590000
116000             ELSE                                                 11600000
116100                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             11610000
116200                 IF ASC-COMMENT-1  > SPACES                       11620000
116300                     MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER    11630000
116400                     SET DP020-MSG-WARNING TO TRUE                11640000
116500                     SET DP030-OVERRIDE-GO TO TRUE                11650000
116600                 ELSE                                             11660000
116700                     SET DP030-OVERRIDE-GO TO TRUE                11670000
116800                     MOVE PC-TSYMSG-03050  TO DP020-MSG-NUMBER    11680000
116900                     SET DP020-MSG-WARNING TO TRUE                11690000
117000                 END-IF                                           11700000
117100             END-IF                                               11710000
117110             END-IF                                               11711044
117200*                                                                 11720000
117300* F2 - CONFIRM                                                    11730000
117400         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    11740000
117410             SET PS-P2L-FAIL-ADJ-NO  TO TRUE                      11741049
117420             PERFORM 3600-CHECK-P2L-FAIL-ADJ                      11742049
117430             IF  PS-P2L-FAIL-ADJ                                  11743049
117440                 SET DP030-OVERRIDE-GO TO TRUE                    11744049
117450                 MOVE PC-TSYMSG-03823 TO DP020-MSG-NUMBER         11745049
117460                 SET DP020-MSG-FATAL   TO TRUE                    11746049
117470             ELSE                                                 11747049
117500             IF ASC-COMMENT-1  > SPACES                           11750020
117600                 PERFORM 3000-UPDATES                             11760021
117700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11770021
117800             ELSE                                                 11780020
117900                 SET DP030-OVERRIDE-GO TO TRUE                    11790020
118000                 MOVE PC-TSYMSG-03050  TO DP020-MSG-NUMBER        11800020
118100                 SET DP020-MSG-WARNING TO TRUE                    11810020
118200             END-IF                                               11820020
118210             END-IF                                               11821049
118300*                                                                 11830000
118400* F6 - FIRST PAGE                                                 11840000
118500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11850000
118600             MOVE +1               TO PV-TOP-ITEM                 11860000
118700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11870000
118800*                                                                 11880000
118900* F7 - PREVIOUS PAGE                                              11890000
119000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11900000
119100             PERFORM 2110-BROWSE-BACKWARD                         11910000
119200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11920000
119300*                                                                 11930000
119400* F8 - NEXT PAGE                                                  11940000
119500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11950000
119600             PERFORM 2120-BROWSE-FORWARD                          11960000
119700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11970000
119800*                                                                 11980000
119900* ENTER KEY                                                       11990000
120000         WHEN DP020-SRC-AID = DP016-ENTER                         12000000
120100* DMH - 6/01/2004 - BEGIN                                         12010028
120200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12020028
120300* DMH - 6/01/2004 - END                                           12030028
120400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12040000
120500                                                                  12050000
120600         WHEN OTHER                                               12060000
120700             SET DP013-NO-ROLLBACK                                12070000
120800                 DP013-XCTL-DISPLAY-RESTART                       12080000
120900                 DP013-CICS-ABEND  TO TRUE                        12090000
121000             MOVE '2100-CHECK-FUNCTION-KEY'                       12100000
121100                                   TO DP013-PARAGRAPH             12110000
121200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12120000
121300                                   TO DP013-MESSAGE-TEXT (1)      12130000
121400             PERFORM DP013-0000-PROCESS-ABEND                     12140000
121500     END-EVALUATE.                                                12150000
121600*                                                                 12160000
121700*----------------------------------------------------------------*12170000
121800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12180000
121900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12190000
122000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12200000
122100*    MESSAGE.                                                    *12210000
122200*----------------------------------------------------------------*12220000
122300 2110-BROWSE-BACKWARD.                                            12230000
122400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12240000
122500         GIVING PV-TOP-ITEM.                                      12250000
122600*                                                                 12260000
122700     IF  ((PV-TOP-ITEM < +1)                                      12270000
122800       OR (PV-TOP-ITEM = +1))                                     12280000
122900         MOVE +1                   TO PV-TOP-ITEM                 12290000
123000*        -- TOP OF LIST --                                        12300000
123100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12310000
123200         SET DP020-MSG-INFORMATIONAL TO TRUE                      12320000
123300     END-IF.                                                      12330000
123400                                                                  12340000
123500*----------------------------------------------------------------*12350000
123600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12360000
123700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12370000
123800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12380000
123900*----------------------------------------------------------------*12390000
124000 2120-BROWSE-FORWARD.                                             12400000
124100                                                                  12410000
124200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12420000
124300         GIVING PV-TOP-ITEM.                                      12430000
124400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12440000
124500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12450000
124600*        -- BOTTOM OF LIST --                                     12460000
124700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12470000
124800         SET DP020-MSG-INFORMATIONAL  TO TRUE                     12480000
124900     ELSE                                                         12490000
125000         COMPUTE PV-BOTTOM-ITEM =                                 12500000
125100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12510000
125200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12520000
125300*            -- BOTTOM OF LIST --                                 12530000
125400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12540000
125500             SET DP020-MSG-INFORMATIONAL TO TRUE                  12550000
125600         END-IF                                                   12560000
125700     END-IF.                                                      12570000
125800                                                                  12580000
125900*----------------------------------------------------------------*12590000
126000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*12600000
126100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *12610000
126200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *12620000
126300*----------------------------------------------------------------*12630000
126400 2200-MOVE-SCREEN-TO-COMMAREA.                                    12640000
126500                                                                  12650000
126600* COMMENT LINE 1                                                  12660000
126700     IF  ACOMMNT1L > ZERO                                         12670000
126800         MOVE ACOMMNT1I        TO ASC-COMMENT-1                   12680000
126900     ELSE                                                         12690000
127000         IF ACOMMNT1F = DP015-ERASE-EOF                           12700000
127100             MOVE SPACES       TO ASC-COMMENT-1                   12710000
127200         END-IF                                                   12720000
127300     END-IF.                                                      12730000
127400                                                                  12740000
127500* COMMENT LINE 2                                                  12750000
127600     IF  ACOMMNT2L > ZERO                                         12760000
127700         MOVE ACOMMNT2I        TO ASC-COMMENT-2                   12770000
127800     ELSE                                                         12780000
127900         IF ACOMMNT2F = DP015-ERASE-EOF                           12790000
128000             MOVE SPACES       TO ASC-COMMENT-2                   12800000
128100         END-IF                                                   12810000
128200     END-IF.                                                      12820000
128300                                                                  12830000
128400* COMMENT LINE 3                                                  12840000
128500     IF  ACOMMNT3L > ZERO                                         12850000
128600         MOVE ACOMMNT3I        TO ASC-COMMENT-3                   12860000
128700     ELSE                                                         12870000
128800         IF ACOMMNT3F = DP015-ERASE-EOF                           12880000
128900             MOVE SPACES       TO ASC-COMMENT-3                   12890000
129000         END-IF                                                   12900000
129100     END-IF.                                                      12910000
129200                                                                  12920000
129300*----------------------------------------------------------------*12930000
129400*    UPDATE THE RESOLVED USER ID, RESOLVED TIMESTAMP, AND        *12940000
129500*    RESOLVED COMMENTS ON SUT_FINCL_ADJ.                         *12950000
129600*----------------------------------------------------------------*12960000
129700 3000-UPDATES.                                                    12970000
129800                                                                  12980000
129900     MOVE ASC-COMMENT-1          TO  DK-COMMENT-1.                12990000
130000     MOVE ASC-COMMENT-2          TO  DK-COMMENT-2.                13000000
130100     MOVE ASC-COMMENT-3          TO  DK-COMMENT-3.                13010000
130200     MOVE DK-COMMENT-FIELD-X     TO  DK-COMMENT-FIELD.            13020000
130300                                                                  13030000
130400     EXEC SQL                                                     13040000
130500          SET :SUT00030-RSLV-TMST = CURRENT TIMESTAMP             13050000
130600     END-EXEC                                                     13060000
130700                                                                  13070000
130800     EXEC SQL                                                     13080000
130900       UPDATE SUT_FINCL_ADJ                                       13090000
131000          SET RSLV_CMNT_TXT  = :DK-COMMENT-FIELD                  13100000
131100             ,RSLV_BY_USR_ID = :DP020-USERID                      13110000
131200             ,RSLV_TMST      = :SUT00030-RSLV-TMST                13120000
131300       WHERE  FINCL_ADJ_ID   = :ASC-FINCL-ID                      13130000
131400     END-EXEC                                                     13140000
131500                                                                  13150000
131600     EVALUATE TRUE                                                13160000
131700         WHEN SQLCODE = +0                                        13170000
131800         WHEN SQLCODE = -904                                      13180000
131900         WHEN SQLCODE = -913                                      13190000
132000             MOVE ' ' TO ASC-ACKNOWLEDGED                         13200000
132100                                                                  13210000
132200         WHEN SQLWARN0 NOT = SPACES                               13220000
132300         WHEN SQLCODE < +0                                        13230000
132400         WHEN SQLCODE > +0                                        13240000
132500             MOVE '3000-UPDATES ' TO DP013-PARAGRAPH              13250000
132600             MOVE 'UPDATE SUT_FINCL_ADJ ' TO DP013-MESSAGE-TEXT(1)13260000
132700             MOVE SQLCA        TO DP013-SQLCA                     13270000
132800             MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)        13280000
132900             SET DP013-DB2-ABEND                                  13290000
133000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13300000
133100             PERFORM DP013-0000-PROCESS-ABEND                     13310000
133200     END-EVALUATE.                                                13320000
133300                                                                  13330000
133400     PERFORM 3100-CHECK-ALL-ADJUSTMENTS                           13340000
133500     MOVE DP015-PRO-NOR-OFF      TO  ACOMMNT1A                    13350000
133600                                     ACOMMNT2A                    13360000
133700                                     ACOMMNT3A.                   13370000
133800     MOVE DP015-BLUE             TO  ACOMMNT1C                    13380000
133900                                     ACOMMNT2C                    13390000
134000                                     ACOMMNT3C.                   13400000
134100     MOVE DP015-HL-OFF           TO  ACOMMNT1H                    13410000
134200                                     ACOMMNT2H                    13420000
134300                                     ACOMMNT3H.                   13430000
134400     MOVE DP020-USERID           TO  ASC-RSLV-BY.                 13440000
134500     MOVE ASC-RSLV-BY            TO  DK-USER-CODE.                13450000
134600*TCR BELOW                                                        13460026
134700     IF DK-USER-CODE > SPACE                                      13470026
134800        PERFORM 4050-GET-USER-NAME                                13480026
134900        IF XL067-KOHLS-NOT-FOUND                                  13490026
135000           MOVE SPACES                TO PV-NAME                  13500026
135100        ELSE                                                      13510026
135200           MOVE XL067-COMBINED-NAME-2 TO PV-NAME                  13520026
135300        END-IF                                                    13530026
135400     ELSE                                                         13540026
135500        MOVE SPACES                   TO PV-NAME                  13550026
135600     END-IF.                                                      13560026
135700*TCR ABOVE                                                        13570026
135800     MOVE PV-NAME                TO  ASC-RSLV-NAME.               13580000
135900     MOVE SUT00030-RSLV-TMST     TO  ASC-RSLV-TMST.               13590000
136000     PERFORM 9100-READ-SEL-QUEUE.                                 13600000
136100     SET SU039-UPD (ASC-SEL-SUB) TO TRUE.                         13610000
136200     PERFORM 9200-REWRITE-SEL-QUEUE.                              13620000
136300                                                                  13630000
136400 3100-CHECK-ALL-ADJUSTMENTS.                                      13640000
136500     MOVE ASC-PO             TO DK-PO.                            13650000
136600     MOVE ASC-RCVR           TO DK-RCVR.                          13660000
136700     MOVE ASC-LINE           TO DK-LINE.                          13670014
136800     PERFORM 3200-COUNT-ADJUSTMENTS.                              13680000
136900     IF PV-ADJUST-COUNT = 0                                       13690000
137000         PERFORM 3300-FIND-UNRESOLVED-TROUBLE                     13700000
137100         IF PS-TRBL-FOUND                                         13710000
137200             PERFORM 4080-TRY-RECITM                              13720034
137300             IF RECITM-VER-STATUS-CDE = 'A' OR                    13730036
137400                DK-LINE = 0                                       13740036
137500                 PERFORM 3400-RESOLVE-TROUBLE                     13750034
137600             ELSE                                                 13760034
137700                 PERFORM 3500-DELETE-LINE-TROUBLE                 13770034
137800             END-IF                                               13780034
137900         END-IF                                                   13790034
138000     END-IF.                                                      13800000
138100                                                                  13810000
138200 3200-COUNT-ADJUSTMENTS.                                          13820000
138300                                                                  13830000
138400     EXEC SQL                                                     13840000
138500       SELECT COUNT(*)                                            13850000
138600         INTO :PV-ADJUST-COUNT                                    13860000
138700         FROM SUT_FINCL_ADJ                                       13870000
138800       WHERE  PO_NBR         = :DK-PO                             13880000
138900         AND  RCVR_SEQ_NBR   = :DK-RCVR                           13890000
139000         AND  RCVR_LNE_NBR   = :DK-LINE                           13900014
139100         AND  AUTO_APL_IND   = 'N'                                13910008
139200         AND  RSLV_TMST      = '9999-09-09-09.09.09.999999'       13920000
139300     END-EXEC.                                                    13930000
139400                                                                  13940000
139500     EVALUATE TRUE                                                13950000
139600         WHEN SQLCODE = +0                                        13960000
139700         WHEN SQLCODE = -904                                      13970000
139800         WHEN SQLCODE = -913                                      13980000
139900             MOVE ' ' TO ASC-ACKNOWLEDGED                         13990000
140000                                                                  14000000
140100         WHEN SQLWARN0 NOT = SPACES                               14010000
140200         WHEN SQLCODE < +0                                        14020000
140300         WHEN SQLCODE > +0                                        14030000
140400             MOVE '3200-COUNT ' TO DP013-PARAGRAPH                14040000
140500             MOVE 'COUNT SUT_FINCL_ADJ ' TO DP013-MESSAGE-TEXT(1) 14050000
140600             MOVE SQLCA        TO DP013-SQLCA                     14060000
140700             MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)        14070000
140800             MOVE DK-PO        TO PV-DISP-PO                      14080000
140900             MOVE DK-RCVR      TO PV-DISP-RCVR                    14090000
141000             STRING 'PO = '                                       14100000
141100                    PV-DISP-PO                                    14110000
141200                    ' RECV = '                                    14120000
141300                    PV-DISP-RCVR                                  14130000
141400                          DELIMITED BY SIZE                       14140000
141500                                       INTO DP013-MESSAGE-TEXT(2) 14150000
141600             SET DP013-DB2-ABEND                                  14160000
141700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14170000
141800             PERFORM DP013-0000-PROCESS-ABEND                     14180000
141900     END-EVALUATE.                                                14190000
142000                                                                  14200000
142100 3300-FIND-UNRESOLVED-TROUBLE.                                    14210000
142200                                                                  14220000
142300     EXEC SQL                                                     14230000
142400         SELECT NOTIF_NBR                                         14240000
142500             INTO :TRBNTF-NOTIF-NBR                               14250000
142600             FROM TTRBNTF                                         14260000
142700             WHERE PO_NBR         = :DK-PO                        14270000
142800               AND TRBL_RSN_CDE   = 371                           14280000
142900               AND REC_SEQ_NBR    = :DK-RCVR                      14290000
143000               AND PO_LNE_NBR     = :DK-LINE                      14300014
143100               AND RESOLVED_IND IN ('N', 'I')                     14310000
143200     END-EXEC                                                     14320000
143300                                                                  14330000
143400     EVALUATE TRUE                                                14340000
143500         WHEN SQLCODE = ZERO                                      14350000
143600         WHEN SQLCODE = -811                                      14360000
143700             SET PS-TRBL-FOUND        TO TRUE                     14370000
143800                                                                  14380000
143900         WHEN SQLCODE = +100                                      14390000
144000             SET PS-TRBL-NOT-FOUND    TO TRUE                     14400000
144100                                                                  14410000
144200         WHEN SQLWARN0 NOT = SPACES                               14420000
144300         WHEN SQLCODE < +0                                        14430000
144400         WHEN SQLCODE > +0                                        14440000
144500             MOVE '3300-FIND-UNRESOLVED-TROUBLE'                  14450000
144600                                TO DP013-PARAGRAPH                14460000
144700             MOVE SQLCA        TO DP013-SQLCA                     14470000
144800             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        14480000
144900             MOVE DK-PO        TO PV-DISP-PO                      14490000
145000             MOVE DK-RCVR      TO PV-DISP-RCVR                    14500000
145100             STRING 'PO = '                                       14510000
145200                    PV-DISP-PO                                    14520000
145300                    ' RECV = '                                    14530000
145400                    PV-DISP-RCVR                                  14540000
145500                          DELIMITED BY SIZE                       14550000
145600                                       INTO DP013-MESSAGE-TEXT(1) 14560000
145700             SET DP013-DB2-ABEND                                  14570000
145800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14580000
145900             PERFORM DP013-0000-PROCESS-ABEND                     14590000
146000     END-EVALUATE.                                                14600000
146100                                                                  14610000
146200 3400-RESOLVE-TROUBLE.                                            14620000
146300                                                                  14630000
146400**   PERFORM 3420-OPEN-LINE-CURSOR.                               14640014
146500**   PERFORM 3440-FETCH-LINE-CURSOR.                              14650014
146600**   PERFORM 3460-PROCESS-LINE-CURSOR UNTIL PS-EOC-LINE-CSR.      14660014
146700**   PERFORM 3480-CLOSE-LINE-CURSOR.                              14670014
146800     MOVE DK-LINE      TO TRBNTF-PO-LNE-NBR.                      14680014
146900     PERFORM 3460-PROCESS-LINE.                                   14690014
147000                                                                  14700000
147100 3420-OPEN-LINE-CURSOR.                                           14710000
147200     EXEC SQL                                                     14720000
147300         OPEN TRBNTF-LINE-CSR                                     14730000
147400     END-EXEC.                                                    14740000
147500                                                                  14750000
147600     EVALUATE TRUE                                                14760000
147700         WHEN SQLCODE = ZERO                                      14770000
147800             SET PS-NOT-EOC-LINE-CSR TO TRUE                      14780000
147900                                                                  14790000
148000         WHEN SQLWARN0 NOT = SPACES                               14800000
148100         WHEN SQLCODE < +0                                        14810000
148200         WHEN SQLCODE > +0                                        14820000
148300             MOVE '3420-OPEN-LINE-CURSOR'                         14830000
148400                                TO DP013-PARAGRAPH                14840000
148500             MOVE SQLCA        TO DP013-SQLCA                     14850000
148600             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        14860000
148700             MOVE DK-PO        TO PV-DISP-PO                      14870000
148800             MOVE DK-RCVR      TO PV-DISP-RCVR                    14880000
148900             STRING 'PO = '                                       14890000
149000                    PV-DISP-PO                                    14900000
149100                    ' RECV = '                                    14910000
149200                    PV-DISP-RCVR                                  14920000
149300                          DELIMITED BY SIZE                       14930000
149400                                       INTO DP013-MESSAGE-TEXT(1) 14940000
149500             SET DP013-DB2-ABEND                                  14950000
149600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14960000
149700             PERFORM DP013-0000-PROCESS-ABEND                     14970000
149800     END-EVALUATE.                                                14980000
149900                                                                  14990000
150000 3440-FETCH-LINE-CURSOR.                                          15000000
150100     EXEC SQL                                                     15010000
150200         FETCH TRBNTF-LINE-CSR                                    15020000
150300          INTO :TRBNTF-PO-LNE-NBR                                 15030000
150400     END-EXEC.                                                    15040000
150500                                                                  15050000
150600     EVALUATE TRUE                                                15060000
150700         WHEN SQLCODE = ZERO                                      15070000
150800             CONTINUE                                             15080000
150900         WHEN SQLCODE = +100                                      15090000
151000             SET PS-EOC-LINE-CSR TO TRUE                          15100000
151100                                                                  15110000
151200         WHEN SQLWARN0 NOT = SPACES                               15120000
151300         WHEN SQLCODE < +0                                        15130000
151400         WHEN SQLCODE > +0                                        15140000
151500             MOVE '3440-FETCH-LINE-CURSOR'                        15150000
151600                                TO DP013-PARAGRAPH                15160000
151700             MOVE SQLCA        TO DP013-SQLCA                     15170000
151800             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        15180000
151900             MOVE DK-PO        TO PV-DISP-PO                      15190000
152000             MOVE DK-RCVR      TO PV-DISP-RCVR                    15200000
152100             STRING 'PO = '                                       15210000
152200                    PV-DISP-PO                                    15220000
152300                    ' RECV = '                                    15230000
152400                    PV-DISP-RCVR                                  15240000
152500                          DELIMITED BY SIZE                       15250000
152600                                       INTO DP013-MESSAGE-TEXT(1) 15260000
152700             SET DP013-DB2-ABEND                                  15270000
152800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15280000
152900             PERFORM DP013-0000-PROCESS-ABEND                     15290000
153000     END-EVALUATE.                                                15300000
153100                                                                  15310000
153200 3460-PROCESS-LINE.                                               15320014
153300                                                                  15330000
153400     INITIALIZE TM500-FIELDS.                                     15340000
153500     SET TM500-UPDATE                                             15350000
153600         TM500-NO-DETAILS                                         15360000
153700         TM500-RESOLVE-SPECIFIC    TO  TRUE.                      15370000
153800                                                                  15380000
153900     MOVE 0                        TO  TM500-NOTIF-NBR.           15390000
154000     MOVE 1                        TO  TM500-FCLTY-ID.            15400000
154100     PERFORM 3470-SELECT-TRECEIV.                                 15410029
154200**   MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         15420029
154300                                                                  15430000
154400     MOVE DK-PO                    TO  TM500-PO-NBR.              15440000
154500                                                                  15450000
154600     MOVE TRBNTF-PO-LNE-NBR        TO  TM500-PO-LNE-NBR.          15460000
154700     IF TRBNTF-PO-LNE-NBR > 0                                     15470000
154800         SET TM500-LINE-LEVEL      TO  TRUE                       15480000
154900     ELSE                                                         15490000
155000         SET TM500-PO-LEVEL        TO  TRUE                       15500000
155100     END-IF.                                                      15510000
155200                                                                  15520000
155300     MOVE DK-RCVR                  TO  TM500-REC-SEQ-NBR.         15530000
155400     MOVE 371                      TO  TM500-TRBL-RSN-CDE.        15540000
155500                                                                  15550000
155600**   MOVE RC809-UNITS-TO-ALLOC        TO TM500-UNITS-TO-ALLOC     15560000
155700**   MOVE RC809-AD-ITM-IND            TO TM500-AD-SW              15570000
155800**   MOVE RC809-DEPT-NBR              TO TM500-DEPT-NBR           15580000
155900**   MOVE RC809-PRORATE-IND           TO TM500-PRORATE-IND        15590000
156000     MOVE 'SUKCS759'               TO  TM500-CRE-UID              15600000
156100                                       TM500-NOTIF-UID.           15610000
156200     MOVE DP020-USERID             TO  TM500-RESOLVED-UID         15620000
156300                                       TM500-ACKNOWLG-UID.        15630000
156400                                                                  15640000
156500**   MOVE SU035-FINCL-ADJ-ID    TO PV-DISP-FINCL-ADJ-ID.          15650000
156600     MOVE 'FAILED AUTO ADJUSTMENT HAS BEEN RESOLVED'              15660001
156700              TO TM500-FREEFORM-TEXT.                             15670000
156800                                                                  15680000
156900     PERFORM 8200-LINK-TO-UPDATE.                                 15690000
157000     IF TM500-CALL-SUCCESSFUL                                     15700000
157100***   OR TM500-TPURCHS-SELECT-NOT-FND OR                          15710000
157200***      TM500-TTRBNTF-UPDATE-NOT-FND OR                          15720000
157300***      TM500-DIDNT-ALLOC-DUE-TO-TRBL                            15730000
157400             CONTINUE                                             15740000
157500     ELSE                                                         15750000
157600         MOVE '3460-PROCESS-LINE'                                 15760029
157700                                TO DP013-PARAGRAPH                15770000
157800         MOVE 'CALL TMKCS520       ' TO DP013-MESSAGE-TEXT(1)     15780000
157900         MOVE SQLCA         TO DP013-SQLCA                        15790015
158000         MOVE DK-PO        TO PV-DISP-PO                          15800000
158100         MOVE DK-RCVR      TO PV-DISP-RCVR                        15810000
158200         MOVE TM500-PO-LNE-NBR                                    15820015
158300                           TO PV-DISP-LINE                        15830015
158400         MOVE TM500-NOTIF-NBR                                     15840017
158500                           TO PV-DISP-NOTIF-NBR                   15850017
158600         STRING 'PO '                                             15860015
158700                PV-DISP-PO                                        15870000
158800                ' RECV '                                          15880015
158900                PV-DISP-RCVR                                      15890000
159000                ' LINE '                                          15900015
159100                PV-DISP-LINE                                      15910016
159200                ' RET CDE '                                       15920015
159300                TM500-RETURN-CODE                                 15930012
159400                      DELIMITED BY SIZE                           15940000
159500                                   INTO DP013-MESSAGE-TEXT(2)     15950000
159600         STRING 'SQL '                                            15960017
159700                TM500-SQLCODE                                     15970017
159800                ' NOTIF NBR '                                     15980017
159900                PV-DISP-NOTIF-NBR                                 15990017
160000                      DELIMITED BY SIZE                           16000017
160100                                   INTO DP013-MESSAGE-TEXT(3)     16010017
160200         MOVE TM500-RETURN-MSG       TO DP013-MESSAGE-TEXT(4)     16020018
160300         SET DP013-DB2-ABEND                                      16030000
160400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   16040000
160500         PERFORM DP013-0000-PROCESS-ABEND                         16050000
160600     END-IF.                                                      16060000
160700**   PERFORM 3440-FETCH-LINE-CURSOR.                              16070014
160800                                                                  16080000
160900 3470-SELECT-TRECEIV.                                             16090029
161000                                                                  16100029
161100     EXEC SQL                                                     16110029
161200         SELECT OPER_UNT_ID                                       16120029
161300             INTO :RECEIV-OPER-UNT-ID                             16130029
161400             FROM TRECEIV                                         16140029
161500             WHERE ORD_NBR        = :DK-PO                        16150029
161600               AND REC_SEQ_NBR    = :DK-RCVR                      16160029
161700         WITH UR                                                  16170029
161800     END-EXEC.                                                    16180029
161900                                                                  16190029
162000     EVALUATE TRUE                                                16200029
162100         WHEN SQLCODE = ZERO                                      16210029
162200             MOVE RECEIV-OPER-UNT-ID       TO  TM500-OPER-UNT-ID  16220029
162300                                                                  16230029
162400         WHEN SQLWARN0 NOT = SPACES                               16240029
162500         WHEN SQLCODE < +0                                        16250029
162600         WHEN SQLCODE > +0                                        16260029
162700             MOVE '3470-SELECT-TRECEIV'                           16270029
162800                                TO DP013-PARAGRAPH                16280029
162900             MOVE SQLCA        TO DP013-SQLCA                     16290029
163000             MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)        16300029
163100             MOVE DK-PO        TO PV-DISP-PO                      16310029
163200             MOVE DK-RCVR      TO PV-DISP-RCVR                    16320029
163300             STRING 'PO = '                                       16330029
163400                    PV-DISP-PO                                    16340029
163500                    ' RECV = '                                    16350029
163600                    PV-DISP-RCVR                                  16360029
163700                          DELIMITED BY SIZE                       16370029
163800                                       INTO DP013-MESSAGE-TEXT(1) 16380029
163900             SET DP013-DB2-ABEND                                  16390029
164000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16400029
164100             PERFORM DP013-0000-PROCESS-ABEND                     16410029
164200     END-EVALUATE.                                                16420029
164300                                                                  16430029
164400 3480-CLOSE-LINE-CURSOR.                                          16440000
164500     EXEC SQL                                                     16450000
164600         FETCH TRBNTF-LINE-CSR                                    16460000
164700          INTO :TRBNTF-PO-LNE-NBR                                 16470000
164800     END-EXEC.                                                    16480000
164900                                                                  16490000
165000     EVALUATE TRUE                                                16500000
165100         WHEN SQLCODE = ZERO                                      16510000
165200             CONTINUE                                             16520000
165300         WHEN SQLCODE = +100                                      16530000
165400             SET PS-EOC-LINE-CSR TO TRUE                          16540000
165500                                                                  16550000
165600         WHEN SQLWARN0 NOT = SPACES                               16560000
165700         WHEN SQLCODE < +0                                        16570000
165800         WHEN SQLCODE > +0                                        16580000
165900             MOVE '3440-FETCH-LINE-CURSOR'                        16590000
166000                                TO DP013-PARAGRAPH                16600000
166100             MOVE SQLCA        TO DP013-SQLCA                     16610000
166200             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        16620000
166300             MOVE DK-PO        TO PV-DISP-PO                      16630000
166400             MOVE DK-RCVR      TO PV-DISP-RCVR                    16640000
166500             STRING 'PO = '                                       16650000
166600                    PV-DISP-PO                                    16660000
166700                    ' RECV = '                                    16670000
166800                    PV-DISP-RCVR                                  16680000
166900                          DELIMITED BY SIZE                       16690000
167000                                       INTO DP013-MESSAGE-TEXT(1) 16700000
167100             SET DP013-DB2-ABEND                                  16710000
167200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16720000
167300             PERFORM DP013-0000-PROCESS-ABEND                     16730000
167400     END-EVALUATE.                                                16740000
167500                                                                  16750000
167600 3490-GET-GROUP-DESC.                                             16760000
167700                                                                  16770000
167800     EXEC SQL                                                     16780000
167900       SELECT PRC_GP_DESC                                         16790000
168000         INTO :SUT00033-PRC-GP-DESC                               16800000
168100         FROM SUT_PRC_GP                                          16810000
168200       WHERE  PRC_GP_CDE     = :ASC-PROCESS-GROUP                 16820000
168300     END-EXEC.                                                    16830000
168400                                                                  16840000
168500     EVALUATE TRUE                                                16850000
168600         WHEN SQLCODE = +0                                        16860000
168700         WHEN SQLCODE = +100                                      16870000
168800         WHEN SQLCODE = -904                                      16880000
168900         WHEN SQLCODE = -913                                      16890000
169000             MOVE SUT00033-PRC-GP-DESC TO ASC-PROCESS-GRP-DESC    16900000
169100                                                                  16910000
169200         WHEN SQLWARN0 NOT = SPACES                               16920000
169300         WHEN SQLCODE < +0                                        16930000
169400         WHEN SQLCODE > +0                                        16940000
169500             MOVE '3490-GET-GROUP-DESC' TO DP013-PARAGRAPH        16950000
169600             MOVE 'GET PROCESS GROUP DSC' TO DP013-MESSAGE-TEXT(1)16960000
169700             MOVE SQLCA        TO DP013-SQLCA                     16970000
169800             MOVE 'SUT_PRC_GP' TO DP013-DB2-TABLE-NAME (1)        16980000
169900             MOVE DK-PO        TO PV-DISP-PO                      16990000
170000             MOVE DK-RCVR      TO PV-DISP-RCVR                    17000000
170100             SET DP013-DB2-ABEND                                  17010000
170200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17020000
170300             PERFORM DP013-0000-PROCESS-ABEND                     17030000
170400     END-EVALUATE.                                                17040000
170500                                                                  17050000
170600 3500-DELETE-LINE-TROUBLE.                                        17060034
170700                                                                  17070034
170800     EXEC SQL                                                     17080034
170900          DELETE                                                  17090034
171000            FROM TTRBNTF                                          17100034
171100           WHERE PO_NBR       = :DK-PO                            17110034
171200             AND REC_SEQ_NBR  = :DK-RCVR                          17120034
171300             AND PO_LNE_NBR   = :DK-LINE                          17130034
171400     END-EXEC                                                     17140034
171500                                                                  17150034
171600     EVALUATE TRUE                                                17160034
171700         WHEN SQLCODE = +0                                        17170034
171800         WHEN SQLCODE = +100                                      17180034
171900            INITIALIZE PV-CICS-MSG-AREA                           17190036
172000            MOVE DK-PO        TO PV-DISP-PO                       17200036
172100            MOVE DK-RCVR      TO PV-DISP-RCVR                     17210036
172200            MOVE DK-LINE      TO PV-DISP-LINE                     17220036
172300            STRING ' SUKCS759 - DELETED TROUBLE-'                 17230036
172400                   ' PO = ' PV-DISP-PO                            17240036
172500                   ' REC = ' PV-DISP-RCVR                         17250036
172600                   ' LINE = ' PV-DISP-LINE                        17260036
172700                                            DELIMITED BY SIZE     17270036
172800                                       INTO PV-CICS-MSG-AREA      17280036
172900            PERFORM 9800-WRITE-CICS-LOG                           17290036
173000                                                                  17300034
173100         WHEN SQLWARN0 NOT = SPACES                               17310034
173200         WHEN SQLCODE < +0                                        17320034
173300         WHEN SQLCODE > +0                                        17330034
173400             MOVE '3500-DELETE-LINE-TROUBLE'                      17340034
173500                                        TO DP013-PARAGRAPH        17350034
173600             MOVE 'DELETE TTRBNTF REC ' TO DP013-MESSAGE-TEXT(1)  17360034
173700             MOVE SQLCA        TO DP013-SQLCA                     17370034
173800             MOVE 'TTRBNTF'    TO DP013-DB2-TABLE-NAME (1)        17380034
173900             MOVE DK-PO        TO PV-DISP-PO                      17390034
174000             MOVE DK-RCVR      TO PV-DISP-RCVR                    17400034
174100             MOVE DK-LINE      TO PV-DISP-LINE                    17410034
174200             STRING 'PO = '                                       17420034
174300                    PV-DISP-PO                                    17430034
174400                    ' RECV = '                                    17440034
174500                    PV-DISP-RCVR                                  17450034
174600                    ' LINE = '                                    17460034
174700                    PV-DISP-LINE                                  17470034
174800                          DELIMITED BY SIZE                       17480034
174900                                       INTO DP013-MESSAGE-TEXT(2) 17490034
175000             SET DP013-DB2-ABEND                                  17500034
175100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17510034
175200             PERFORM DP013-0000-PROCESS-ABEND                     17520034
175300     END-EVALUATE.                                                17530034
175310                                                                  17531044
175320                                                                  17532044
175324*----------------------------------------------------------------*17532444
175325* CHECK IF FAILED STORE UNIT ADJUSTMENT IS FROM PACK-TO-LIGHT    *17532544
175326* IF IT IS DO NOT ALLOW IT TO BE ACKNOWLEDGED.  IT WILL BE       *17532644
175327* HANDLED IN NIGHTLY PROCESS THAT WILL CREATE A CORRECTION       *17532744
175328* RECEIVER 'CR' FOR THE UNITS.   'PTL-FSA'                       *17532844
175329*----------------------------------------------------------------*17532947
175330 3600-CHECK-P2L-FAIL-ADJ.                                         17533044
175331                                                                  17533144
175332     MOVE ASC-PO             TO DK-PO.                            17533244
175333     MOVE ASC-RCVR           TO DK-RCVR.                          17533344
175334     MOVE ASC-LINE           TO DK-LINE.                          17533444
175335     MOVE ASC-STR-NBR        TO DK-STORE.                         17533544
175336                                                                  17533644
175337     EXEC SQL                                                     17533744
175338          SELECT D.ADJ_ERR_CDE                                    17533845
175339            INTO :SUT00031-ADJ-ERR-CDE                            17533944
175340            FROM SUT_FINCL_ADJ A                                  17534044
175341               , TSURSNC C                                        17534144
175342               , SUT_ADJ_ERR_CDE D                                17534244
175343          WHERE A.PRC_RSN_CDE IN ('PCKCS722',                     17534344
175344                                  'PCCS722B',                     17534444
175345                                  'PCCS722C',                     17534544
175346                                  'PCCS722D',                     17534644
175347                                  'PCCS722E')                     17534744
175348            AND A.RSLV_BY_USR_ID  = ' '                           17534844
175349            AND A.RSLV_TMST       >  CURRENT TIMESTAMP            17534944
175350            AND A.PRC_RSN_CDE     =  C.PRC_RSN_CDE                17535044
175351            AND A.ADJ_ERR_CDE     =  D.ADJ_ERR_CDE                17535144
175352            AND A.PO_NBR          = :DK-PO                        17535244
175353            AND A.RCVR_SEQ_NBR    = :DK-RCVR                      17535344
175354            AND A.RCVR_LNE_NBR    = :DK-LINE                      17535444
175355            AND A.DEST_LOC_NBR    = :DK-STORE                     17535544
175357     END-EXEC.                                                    17535744
175358                                                                  17535844
175359     EVALUATE TRUE                                                17535944
175360         WHEN SQLCODE = +0                                        17536044
175361         WHEN SQLCODE = -811                                      17536144
175362              SET  PS-P2L-FAIL-ADJ  TO  TRUE                      17536244
175363                                                                  17536344
175364         WHEN SQLCODE = +100                                      17536444
175365              SET  PS-P2L-FAIL-ADJ-NO  TO  TRUE                   17536544
175369            MOVE DK-LINE      TO PV-DISP-LINE                     17536944
175377                                                                  17537744
175378         WHEN SQLWARN0 NOT = SPACES                               17537844
175379         WHEN SQLCODE < +0                                        17537944
175380         WHEN SQLCODE > +0                                        17538044
175381             MOVE '3600-CHECK-P2L-FAIL-ADJ '                      17538144
175382                                        TO DP013-PARAGRAPH        17538244
175383             MOVE 'CHECK P2L FAIL ADJ ' TO DP013-MESSAGE-TEXT(1)  17538344
175384             MOVE SQLCA        TO DP013-SQLCA                     17538444
175385             MOVE 'SUT_FINCL_ADJ'  TO DP013-DB2-TABLE-NAME (1)    17538544
175386             MOVE 'TSURSNC'        TO DP013-DB2-TABLE-NAME (2)    17538648
175387             MOVE 'SUT_ADJ_ERR_CD' TO DP013-DB2-TABLE-NAME (3)    17538744
175388             MOVE DK-PO        TO PV-DISP-PO                      17538844
175389             MOVE DK-RCVR      TO PV-DISP-RCVR                    17538944
175390             MOVE DK-LINE      TO PV-DISP-LINE                    17539044
175391             MOVE DK-STORE     TO PV-DISP-STORE                   17539144
175392             STRING 'PO:  '                                       17539244
175393                    PV-DISP-PO '-'                                17539344
175395                    PV-DISP-RCVR '-'                              17539544
175397                    PV-DISP-LINE                                  17539744
175398                    '  STORE:'  PV-DISP-STORE                     17539844
175399                          DELIMITED BY SIZE                       17539944
175400                                       INTO DP013-MESSAGE-TEXT(2) 17540044
175401             SET DP013-DB2-ABEND                                  17540144
175402                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17540244
175403             PERFORM DP013-0000-PROCESS-ABEND                     17540344
175404     END-EVALUATE.                                                17540444
175405                                                                  17540544
175406                                                                  17540644
175407                                                                  17540744
175410*----------------------------------------------------------------*17541034
175500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *17550034
175600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *17560034
175700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *17570034
175800*    DISPLAY THE PANEL TO USER.                                  *17580034
175900*----------------------------------------------------------------*17590034
176000 4000-BUILD-INITIAL-PANEL.                                        17600034
176100                                                                  17610000
176200     PERFORM 4010-GET-ADJ-REC.                                    17620000
176300     MOVE SPACES TO ASC-AUDIT-STATUS.                             17630000
176400     PERFORM 4020-GET-AUDIT-STATUS.                               17640000
176500     MOVE ASC-OPER-UNT-ID  TO DK-STORE-NBR.                       17650000
176600     PERFORM 4040-GET-STORE-NAME.                                 17660000
176700     MOVE DK-OPER-NAME       TO ASC-OPER-NAME.                    17670032
176800     MOVE ASC-STR-NBR      TO DK-STORE-NBR.                       17680000
176900     PERFORM 4040-GET-STORE-NAME.                                 17690000
177000     MOVE DK-OPER-NAME       TO ASC-STR-NAME.                     17700032
177100     MOVE ASC-CRE-BY         TO DK-USER-CODE.                     17710000
177200*TCR BELOW                                                        17720026
177300     IF DK-USER-CODE > SPACE                                      17730026
177400        PERFORM 4050-GET-USER-NAME                                17740026
177500        IF XL067-KOHLS-NOT-FOUND                                  17750026
177600           MOVE SPACES                TO PV-NAME                  17760026
177700        ELSE                                                      17770026
177800           MOVE XL067-COMBINED-NAME-2 TO PV-NAME                  17780026
177900        END-IF                                                    17790026
178000     ELSE                                                         17800026
178100        MOVE SPACES                   TO PV-NAME                  17810026
178200     END-IF.                                                      17820026
178300*TCR ABOVE                                                        17830026
178400     MOVE PV-NAME            TO ASC-ADJ-NAME.                     17840000
178500     MOVE ASC-RSLV-BY        TO DK-USER-CODE.                     17850000
178600*TCR BELOW                                                        17860026
178700     IF DK-USER-CODE > SPACE                                      17870026
178800        PERFORM 4050-GET-USER-NAME                                17880026
178900        IF XL067-KOHLS-NOT-FOUND                                  17890026
179000           MOVE SPACES                TO PV-NAME                  17900026
179100        ELSE                                                      17910026
179200           MOVE XL067-COMBINED-NAME-2 TO PV-NAME                  17920026
179300        END-IF                                                    17930026
179400     ELSE                                                         17940026
179500        MOVE SPACES                   TO PV-NAME                  17950026
179600     END-IF.                                                      17960026
179700*TCR ABOVE                                                        17970026
179800     MOVE PV-NAME            TO ASC-RSLV-NAME.                    17980000
179900     MOVE ASC-PO             TO DK-PO.                            17990000
180000     MOVE ASC-RCVR           TO DK-RCVR.                          18000000
180100     MOVE ASC-LINE           TO DK-LINE.                          18010000
180200     MOVE ASC-STR-NBR        TO DK-STORE-NBR.                     18020000
180300     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   18030000
180400* SINCE THE ACTUAL AND VERIFIED QUANTITIES ARE NOT AT THE CARTON  18040000
180500* LEVEL, IT WAS DECIDED TO REMOVE THEM FROM THE SCREEN.           18050000
180600* 9/26/03 DEANNA BRANTNER                                         18060000
180700* ON 10/17/03 IT WAS DETERMINED THAT THIS INFORMATION WAS NEEDED  18070002
180800* FOR P2L ADJUSTMENTS TO HELP DETERMINE IF SOMETHING NEEDS TO BE  18080002
180900* FIXED.  DEANNA BRANTNER                                         18090002
181000     IF  ASC-CRE-BY = 'P2L'                                       18100002
181100         IF ASC-STR-NBR > 0                                       18110007
181200             PERFORM 4065-SUM-RECDIS-STR                          18120007
181300         ELSE                                                     18130007
181400             PERFORM 4060-SUM-RECDIS                              18140007
181500         END-IF                                                   18150007
181600         MOVE RECDIS-VERIFY-ITM-QTY     TO DK-ACT-QTY             18160007
181700         MOVE RECDIS-AP-VERIFY-ITM-QTY  TO DK-VRF-QTY             18170007
181800         MOVE DK-ACT-QTY                TO ASC-ACT-QTY            18180007
181900         MOVE DK-VRF-QTY                TO ASC-VRF-QTY            18190007
182000         PERFORM 4070-FIND-CURR-STATUS                            18200007
182100     END-IF.                                                      18210007
182200     MOVE ASC-COMMENT-FIELD  TO  ASC-COMMENT-FIELD-X.             18220000
182300*    MOVE DK-COMMENT-1       TO  ASC-COMMENT-1.                   18230000
182400*    MOVE DK-COMMENT-2       TO  ASC-COMMENT-2.                   18240000
182500*    MOVE DK-COMMENT-3       TO  ASC-COMMENT-3.                   18250000
182600                                                                  18260000
182700*----------------------------------------------------------------*18270000
182800*    GET ADJUSTMENT RECORD                                        18280000
182900*----------------------------------------------------------------*18290000
183000 4010-GET-ADJ-REC.                                                18300000
183100                                                                  18310000
183200     EXEC SQL                                                     18320000
183300          SELECT  PO_NBR                                          18330000
183400                 ,RCVR_LNE_NBR                                    18340000
183500                 ,RCVR_SEQ_NBR                                    18350000
183600                 ,CRE_TMST                                        18360000
183700                 ,SHIPT_UNT_ID                                    18370000
183800                 ,PRC_RSN_CDE                                     18380000
183900                 ,AUD_CNTL_NBR                                    18390000
184000                 ,ORGN_LOC_NBR                                    18400000
184100                 ,AUD_ADJ_STAT_CDE                                18410000
184200                 ,AUTO_APL_IND                                    18420000
184300                 ,CRE_BY_USR_ID                                   18430000
184400                 ,RSLV_BY_USR_ID                                  18440000
184500                 ,RSLV_TMST                                       18450000
184600                 ,RSLV_CMNT_TXT                                   18460000
184700                 ,ADJ_ERR_CDE                                     18470000
184800             INTO :SUT00030-PO-NBR                                18480000
184900                 ,:SUT00030-RCVR-LNE-NBR                          18490000
185000                 ,:SUT00030-RCVR-SEQ-NBR                          18500000
185100                 ,:SUT00030-CRE-TMST                              18510000
185200                 ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND2            18520000
185300                 ,:SUT00030-PRC-RSN-CDE                           18530000
185400                 ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND1            18540000
185500                 ,:SUT00030-ORGN-LOC-NBR                          18550000
185600                 ,:SUT00030-AUD-ADJ-STAT-CDE                      18560000
185700                 ,:SUT00030-AUTO-APL-IND                          18570000
185800                 ,:SUT00030-CRE-BY-USR-ID                         18580000
185900                 ,:SUT00030-RSLV-BY-USR-ID                        18590000
186000                 ,:SUT00030-RSLV-TMST                             18600000
186100                 ,:SUT00030-RSLV-CMNT-TXT :PV-NULL-IND            18610000
186200                 ,:SUT00030-ADJ-ERR-CDE   :PV-NULL-IND3           18620000
186300            FROM  SUT_FINCL_ADJ                                   18630000
186400         WHERE  FINCL_ADJ_ID     = :ASC-FINCL-ID                  18640000
186500     END-EXEC.                                                    18650000
186600                                                                  18660000
186700     EVALUATE TRUE                                                18670000
186800         WHEN SQLCODE = ZERO                                      18680000
186900             MOVE SUT00030-PO-NBR           TO  ASC-PO            18690000
187000             MOVE SUT00030-RCVR-LNE-NBR     TO  ASC-LINE          18700000
187100             MOVE SUT00030-RCVR-SEQ-NBR     TO  ASC-RCVR          18710000
187200             MOVE SUT00030-CRE-TMST         TO  ASC-CRE-TMST      18720000
187300             IF PV-NULL-IND2 < 0                                  18730000
187400               MOVE ZEROES                  TO  ASC-SHIPT-UNT-ID  18740000
187500             ELSE                                                 18750000
187600               MOVE SUT00030-SHIPT-UNT-ID   TO  ASC-SHIPT-UNT-ID  18760000
187700             END-IF                                               18770000
187800             MOVE SUT00030-PRC-RSN-CDE      TO  ASC-PRC-RSN-CDE   18780000
187900             MOVE SUT00030-AUD-CNTL-NBR     TO  ASC-AUDIT         18790000
188000             MOVE SUT00030-AUTO-APL-IND    TO ASC-FAIL-SUCCESS-IND18800000
188100             MOVE SUT00030-ORGN-LOC-NBR     TO  ASC-OPER-UNT-ID   18810000
188200             MOVE SUT00030-AUD-ADJ-STAT-CDE TO  ASC-UNT-ADJ-TYP   18820000
188300             MOVE SUT00030-CRE-BY-USR-ID    TO  ASC-CRE-BY        18830000
188400             MOVE SUT00030-RSLV-BY-USR-ID   TO  ASC-RSLV-BY       18840000
188500             MOVE SUT00030-RSLV-TMST        TO  ASC-RSLV-TMST     18850027
188600* DMH 6/1/04 BEGIN                                                18860027
188700             IF  ASC-ACKNOWLEDGED = 'U'                           18870027
188800                 MOVE ASC-COMMENT-FIELD-X    TO  ASC-COMMENT-FIELD18880028
188900             ELSE                                                 18890027
189000                 MOVE SUT00030-RSLV-CMNT-TXT TO  ASC-COMMENT-FIELD18900027
189100             END-IF                                               18910027
189200* DMH 6/1/04 END                                                  18920027
189300             IF PV-NULL-IND3 < 0                                  18930000
189400               MOVE ZEROES                TO  ASC-ADJ-ERR-CDE     18940000
189500             ELSE                                                 18950000
189600               MOVE SUT00030-ADJ-ERR-CDE  TO  ASC-ADJ-ERR-CDE     18960000
189700             END-IF                                               18970000
189800         WHEN SQLCODE = +100                                      18980000
189900             MOVE ZEROES                 TO  ASC-PO               18990000
190000                                             ASC-LINE             19000000
190100                                             ASC-RCVR             19010000
190200                                             ASC-AUDIT            19020000
190300                                             ASC-OPER-UNT-ID      19030000
190400             MOVE SPACES                 TO  ASC-CRE-TMST         19040000
190500                                             ASC-PRC-RSN-CDE      19050000
190600                                             ASC-CRE-BY           19060000
190700                                             ASC-RSLV-BY          19070000
190800                                             ASC-RSLV-TMST        19080000
190900                                             ASC-UNT-ADJ-TYP      19090000
191000                                             ASC-FAIL-SUCCESS-IND 19100000
191100                                             ASC-COMMENT-1        19110000
191200                                             ASC-COMMENT-2        19120000
191300                                             ASC-COMMENT-3        19130000
191400         WHEN SQLWARN0 NOT = SPACE                                19140000
191500         WHEN SQLCODE NOT = ZERO                                  19150000
191600              MOVE '4010-GET-ADJ-REC.' TO DP013-PARAGRAPH         19160000
191700              MOVE 'GET ADJSTMNT RECORD  '                        19170000
191800                               TO DP013-MESSAGE-TEXT (1)          19180000
191900              MOVE SQLCA       TO DP013-SQLCA                     19190000
192000              MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)       19200000
192100              SET DP013-DB2-ABEND TO TRUE                         19210000
192200              PERFORM DP013-0000-PROCESS-ABEND                    19220000
192300     END-EVALUATE.                                                19230000
192400                                                                  19240000
192500*----------------------------------------------------------------*19250000
192600*    GET THE AUDIT STATUS FROM SUT_PO_AUD_REQ                     19260000
192700*----------------------------------------------------------------*19270000
192800 4020-GET-AUDIT-STATUS.                                           19280000
192900                                                                  19290000
193000     MOVE ASC-AUDIT  TO  DK-AUDIT.                                19300000
193100     MOVE SPACES     TO  ASC-AUD-TYP.                             19310000
193200     EXEC SQL                                                     19320000
193300          SELECT AUD_STAT_CDE                                     19330000
193400          INTO  :SUT00015-AUD-STAT-CDE                            19340000
193500          FROM  SUT_PO_AUD_REQ                                    19350000
193600        WHERE    AUD_CNTL_NBR   =  :DK-AUDIT                      19360000
193700     END-EXEC.                                                    19370000
193800                                                                  19380000
193900     EVALUATE TRUE                                                19390000
194000         WHEN SQLCODE = +0                                        19400000
194100             IF SUT00015-AUD-STAT-CDE = 'P'                       19410000
194200                 MOVE 'PASS      ' TO  ASC-AUDIT-STATUS           19420000
194300             ELSE                                                 19430000
194400                 IF SUT00015-AUD-STAT-CDE = 'F'                   19440000
194500                     MOVE 'FAIL      ' TO  ASC-AUDIT-STATUS       19450000
194600                 ELSE                                             19460000
194700                     IF SUT00015-AUD-STAT-CDE = 'I'               19470000
194800                         MOVE 'INPROCESS ' TO  ASC-AUDIT-STATUS   19480000
194900                     ELSE                                         19490000
195000                         IF SUT00015-AUD-STAT-CDE = 'N'           19500000
195100                            MOVE 'NOT NEEDED' TO  ASC-AUDIT-STATUS19510000
195200                         END-IF                                   19520000
195300                     END-IF                                       19530000
195400                 END-IF                                           19540000
195500             END-IF                                               19550000
195600             MOVE 'SYSTEM '  TO  ASC-SYS-MAN                      19560000
195700             PERFORM 4030-TRY-TSUNAUD                             19570000
195800         WHEN OTHER                                               19580000
195900             PERFORM 4030-TRY-TSUNAUD                             19590000
196000     END-EVALUATE.                                                19600000
196100                                                                  19610000
196200*----------------------------------------------------------------*19620000
196300*    GET THE AUDIT STATUS FROM TSUNAUD                            19630000
196400*----------------------------------------------------------------*19640000
196500 4030-TRY-TSUNAUD.                                                19650000
196600                                                                  19660000
196700     EXEC SQL                                                     19670000
196800          SELECT AUD_STAT_CDE                                     19680000
196900                ,AUD_TYP_CDE                                      19690000
197000          INTO  :SUNAUD-AUD-STAT-CDE                              19700000
197100               ,:SUNAUD-AUD-TYP-CDE                               19710000
197200          FROM  TSUNAUD                                           19720000
197300        WHERE    AUD_CNTL_NBR   =  :DK-AUDIT                      19730000
197400     END-EXEC.                                                    19740000
197500                                                                  19750000
197600     EVALUATE TRUE                                                19760000
197700         WHEN SQLCODE = +0                                        19770000
197800             IF ASC-AUDIT-STATUS = SPACES                         19780000
197900                 IF SUNAUD-AUD-STAT-CDE = 'CM'                    19790000
198000                     MOVE 'COMPLETED ' TO  ASC-AUDIT-STATUS       19800000
198100                 ELSE                                             19810000
198200                     IF SUNAUD-AUD-STAT-CDE = 'IP'                19820000
198300                         MOVE 'INPROCESS ' TO  ASC-AUDIT-STATUS   19830000
198400                     ELSE                                         19840000
198500                         IF SUNAUD-AUD-STAT-CDE = 'PP'            19850000
198600                            MOVE 'POSTPONED ' TO  ASC-AUDIT-STATUS19860000
198700                         END-IF                                   19870000
198800                     END-IF                                       19880000
198900                 END-IF                                           19890000
199000             END-IF                                               19900000
199100             IF ASC-SYS-MAN = SPACES                              19910000
199200                 MOVE 'MANUAL '  TO  ASC-SYS-MAN                  19920000
199300             END-IF                                               19930000
199400             IF SUNAUD-AUD-TYP-CDE = '01'                         19940000
199500                 MOVE '100%  '  TO  ASC-1-2-3                     19950000
199600             ELSE                                                 19960000
199700                 IF SUNAUD-AUD-TYP-CDE = '02'                     19970000
199800                     MOVE 'SPOT  '  TO  ASC-1-2-3                 19980000
199900                 ELSE                                             19990000
200000                     IF SUNAUD-AUD-TYP-CDE = '03'                 20000000
200100                         MOVE 'REWORK'  TO  ASC-1-2-3             20010000
200200                     END-IF                                       20020000
200300                 END-IF                                           20030000
200400             END-IF                                               20040000
200500         WHEN OTHER                                               20050000
200600             MOVE SPACES TO ASC-AUDIT-STATUS                      20060000
200700     END-EVALUATE.                                                20070000
200800                                                                  20080000
200900*-------------------------------------------------------------    20090000
201000*  GET STORE NAME                                                 20100000
201100*-------------------------------------------------------------    20110000
201200 4040-GET-STORE-NAME.                                             20120000
201300                                                                  20130000
201400     INITIALIZE XL071-COMMAREA-REC.                               20140032
201500     MOVE DK-STORE-NBR               TO XL071-LOCATION-NUMBER.    20150032
201600                                                                  20160032
201700     CALL XL071-LOCATION-MODULE  USING  DFHEIBLK                  20170032
201800                                        XL071-COMMAREA            20180032
201900                                        XL071-COMMAREA-REC.       20190032
202000                                                                  20200032
202100                                                                  20210032
202200     EVALUATE TRUE                                                20220032
202300         WHEN XL071-NO-ERRORS                                     20230032
202400            MOVE  XL071-LOC-NM     TO DK-OPER-NAME                20240032
202500         WHEN XL071-LOC-NOT-FOUND                                 20250032
202600            MOVE 'UNKNOWN'         TO DK-OPER-NAME                20260032
202700         WHEN OTHER                                               20270032
202800            MOVE '4040-GET-STORE-NAME'                            20280032
202900                                   TO DP013-PARAGRAPH             20290032
203000            INITIALIZE PV-CICS-MSG-AREA                           20300032
203100            STRING ' SUKCS759 - CALL XLKUT071 -'                  20310032
203200                   ' SQLCODE=' XL071-SQLCODE                      20320032
203300                   ' TABLE='   XL071-DB2-TABLE                    20330032
203400                                            DELIMITED BY SIZE     20340032
203500                                       INTO PV-CICS-MSG-AREA      20350032
203600            PERFORM 9800-WRITE-CICS-LOG                           20360032
203700                                                                  20370032
203800            SET DP013-DB2-ABEND                                   20380032
203900                DP013-XCTL-DISPLAY-RESTART                        20390032
204000                                 TO TRUE                          20400032
204100            PERFORM DP013-0000-PROCESS-ABEND                      20410032
204200     END-EVALUATE.                                                20420032
204300/                                                                 20430032
204400*-------------------------------------------------------------    20440000
204500*  GET USER NAME                                                  20450000
204600*-------------------------------------------------------------    20460000
204700 4050-GET-USER-NAME.                                              20470000
204800                                                                  20480022
204900     INITIALIZE XL067-USER-COMMAREA.                              20490022
205000                                                                  20500022
205100     SET XL067-BY-USER-ID            TO TRUE.                     20510022
205200     SET XL067-SELECT-KOHLS-USER     TO TRUE.                     20520022
205300                                                                  20530022
205400     MOVE DK-USER-CODE   TO XL067-KEY-USER-ID.                    20540026
205500                                                                  20550022
205600     CALL XL067-USER-PGM USING DFHEIBLK                           20560023
205700                               XL067-COMMAREA                     20570023
205800                               XL067-USER-COMMAREA.               20580023
205900                                                                  20590022
206000     EVALUATE TRUE                                                20600022
206100         WHEN XL067-SUCCESSFUL                                    20610022
206200             CONTINUE                                             20620022
206300         WHEN OTHER                                               20630022
206400              DISPLAY '***********************************'       20640022
206500              DISPLAY '****     SUKCS759  ABEND       ****'       20650022
206600              DISPLAY '***********************************'       20660022
206700              DISPLAY '**  PARAGRAPH 4050-GET-USER-NAME **'       20670022
206800              DISPLAY '**  UNSUCCESSFUL CALL TO XLKUT067**'       20680022
206900              DISPLAY '**  SEE PROD COPYBOOK XLWS067    **'       20690022
207000              DISPLAY '**  XL067-RETURN-CODE:'  XL067-RETURN-CODE 20700022
207100              DISPLAY '***********************************'       20710022
207200              MOVE '4050-GET-USER-NAME'   TO DP013-PARAGRAPH      20720022
207300              MOVE 'CALL MODULE XLKUT067' TO DP013-MESSAGE-TEXT(1)20730022
207400              MOVE SQLCA                  TO DP013-SQLCA          20740022
207500              MOVE 'XLT_USR '          TO DP013-DB2-TABLE-NAME (1)20750022
207600              SET DP013-DB2-ABEND                                 20760022
207700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              20770022
207800              PERFORM DP013-0000-PROCESS-ABEND                    20780022
207900     END-EVALUATE.                                                20790022
208000                                                                  20800022
208100*-------------------------------------------------------------    20810000
208200*  SUM ITEM QUANTITIES                                            20820000
208300*-------------------------------------------------------------    20830000
208400 4060-SUM-RECDIS.                                                 20840000
208500     MOVE ZERO                 TO  RECDIS-VERIFY-ITM-QTY.         20850000
208600     MOVE ZERO                 TO  RECDIS-EXPTED-ITM-QTY.         20860000
208700                                                                  20870000
208800     EXEC SQL                                                     20880000
208900          SELECT SUM(AP_VERIFY_ITM_QTY)                           20890000
209000                ,SUM(VERIFY_ITM_QTY)                              20900000
209100          INTO  :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            20910000
209200               ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               20920000
209300          FROM   TRECDIS                                          20930000
209400          WHERE ORD_NBR          =  :DK-PO                        20940000
209500           AND  ORD_LNE_NBR      =  :DK-LINE                      20950000
209600           AND  REC_SEQ_NBR      =  :DK-RCVR                      20960000
209700           AND  FCLTY_ID         =  1                             20970000
209800           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               20980000
210000     END-EXEC.                                                    21000000
210100                                                                  21010000
210200     EVALUATE TRUE                                                21020000
210300         WHEN SQLCODE = ZERO                                      21030000
210400             CONTINUE                                             21040000
210500         WHEN OTHER                                               21050000
210600             MOVE ZERO     TO  RECDIS-VERIFY-ITM-QTY              21060000
210700             MOVE ZERO     TO  RECDIS-EXPTED-ITM-QTY              21070000
210800     END-EVALUATE.                                                21080000
210900                                                                  21090000
211000*-------------------------------------------------------------    21100000
211100*  SUM ITEM QUANTITIES- TO STORE LEVEL                            21110000
211200*-------------------------------------------------------------    21120000
211300 4065-SUM-RECDIS-STR.                                             21130000
211400     MOVE ZERO                 TO  RECDIS-VERIFY-ITM-QTY.         21140000
211500     MOVE ZERO                 TO  RECDIS-EXPTED-ITM-QTY.         21150000
211600                                                                  21160000
211700     EXEC SQL                                                     21170000
211800          SELECT SUM(AP_VERIFY_ITM_QTY)                           21180000
211900                ,SUM(VERIFY_ITM_QTY)                              21190000
212000          INTO  :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            21200000
212100               ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               21210000
212200          FROM   TRECDIS                                          21220000
212300          WHERE ORD_NBR          =  :DK-PO                        21230000
212400           AND  ORD_LNE_NBR      =  :DK-LINE                      21240000
212500           AND  REC_SEQ_NBR      =  :DK-RCVR                      21250000
212600           AND  STR_NBR          =  :DK-STORE-NBR                 21260000
212700           AND  FCLTY_ID         =  1                             21270000
212800           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               21280000
213000     END-EXEC.                                                    21300000
213100                                                                  21310000
213200     EVALUATE TRUE                                                21320000
213300         WHEN SQLCODE = ZERO                                      21330000
213400             CONTINUE                                             21340000
213500         WHEN OTHER                                               21350000
213600             MOVE ZERO     TO  RECDIS-VERIFY-ITM-QTY              21360000
213700             MOVE ZERO     TO  RECDIS-EXPTED-ITM-QTY              21370000
213800     END-EVALUATE.                                                21380000
213900                                                                  21390000
214000*----------------------------------------------------------------*21400000
214100* FIND CURRENT STATUS                                             21410000
214200*----------------------------------------------------------------*21420000
214300 4070-FIND-CURR-STATUS.                                           21430000
214400                                                                  21440000
214500     EXEC SQL                                                     21450000
214600          SELECT  PRCG_STAT_CDE                                   21460000
214700                 ,RSLTS_RCVD_TMST                                 21470000
214800                 ,FCSE_CNFRMN_TMST                                21480000
214900          INTO  :DISTHD-PRCG-STAT-CDE                             21490000
215000               ,:DISTHD-RSLTS-RCVD-TMST                           21500000
215100               ,:DISTHD-FCSE-CNFRMN-TMST                          21510000
215200          FROM  TDISTHD                                           21520000
215300          WHERE ORD_NBR          =  :DK-PO                        21530000
215400          AND   ORD_LNE_NBR      =  :DK-LINE                      21540000
215500          AND   RCVR_SEQ_NBR     =  :DK-RCVR                      21550000
215600     END-EXEC.                                                    21560000
215700                                                                  21570000
215800     EVALUATE TRUE                                                21580000
215900         WHEN SQLCODE = ZERO                                      21590000
216000*            CONTINUE                                             21600004
216100             IF DISTHD-PRCG-STAT-CDE = 'V'                        21610004
216200                 MOVE 'VERIFIED   '  TO ASC-CURR-STATUS           21620004
216300             ELSE                                                 21630004
216400               IF DISTHD-RSLTS-RCVD-TMST NOT = PC-DEFAULT-TMST    21640004
216500                   MOVE 'P2L PROCESSD'  TO ASC-CURR-STATUS        21650004
216600               ELSE                                               21660004
216700                  IF DISTHD-FCSE-CNFRMN-TMST NOT = PC-DEFAULT-TMST21670004
216800                      MOVE 'FCSE CONFIRM'  TO ASC-CURR-STATUS     21680004
216900                  ELSE                                            21690004
217000                      MOVE 'IN PROCESS  '  TO ASC-CURR-STATUS     21700004
217100                  END-IF                                          21710004
217200               END-IF                                             21720004
217300             END-IF                                               21730004
217400         WHEN OTHER                                               21740000
217500             PERFORM 4080-TRY-RECITM                              21750000
217600     END-EVALUATE.                                                21760000
217700                                                                  21770000
217800*----------------------------------------------------------------*21780000
217900* TRY RECITM                                                      21790000
218000*----------------------------------------------------------------*21800000
218100 4080-TRY-RECITM.                                                 21810000
218200                                                                  21820000
218300     EXEC SQL                                                     21830000
218400          SELECT  STATUS_CDE                                      21840000
218500               ,  VER_STATUS_CDE                                  21850034
218600          INTO  :RECITM-STATUS-CDE                                21860000
218700             ,  :RECITM-VER-STATUS-CDE                            21870034
218800          FROM  TRECITM                                           21880000
218900          WHERE ORD_NBR          =  :DK-PO                        21890000
219000          AND   ORD_LNE_NBR      =  :DK-LINE                      21900000
219100          AND   REC_SEQ_NBR      =  :DK-RCVR                      21910000
219200     END-EXEC.                                                    21920000
219300                                                                  21930000
219400     EVALUATE TRUE                                                21940000
219500         WHEN SQLCODE = ZERO                                      21950000
219600*            CONTINUE                                             21960004
219700             IF RECITM-STATUS-CDE = 'VE'                          21970004
219800                 MOVE 'VERIFIED   '  TO ASC-CURR-STATUS           21980004
219900             ELSE                                                 21990004
220000               IF RECITM-STATUS-CDE = 'CM'                        22000004
220100                   MOVE 'COMPLETED   '  TO ASC-CURR-STATUS        22010004
220200               ELSE                                               22020004
220300                   MOVE 'IN PROCESS  '  TO ASC-CURR-STATUS        22030004
220400               END-IF                                             22040004
220500             END-IF                                               22050004
220600         WHEN OTHER                                               22060000
220700*            CONTINUE                                             22070004
220800             MOVE SPACES TO ASC-CURR-STATUS                       22080004
220900                            RECITM-VER-STATUS-CDE                 22090035
221000     END-EVALUATE.                                                22100000
221100                                                                  22110000
221200*----------------------------------------------------------------*22120000
221300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22130000
221400*----------------------------------------------------------------*22140000
221500 4400-MOVE-COMMAREA-TO-SCREEN.                                    22150000
221600     MOVE ASC-OPER-UNT-ID        TO  AOPERO.                      22160000
221700     MOVE ASC-OPER-NAME          TO  AOPNAMEO.                    22170000
221800     MOVE ASC-PO                 TO  DK-TRN-NBR.                  22180000
221900     MOVE ASC-RCVR               TO  DK-RCVR-NBR-3.               22190000
222000     MOVE DK-RCVR-NBR-3          TO  DK-RCVR-NBR.                 22200000
222100     MOVE ASC-LINE               TO  DK-LINE-NBR-4.               22210000
222200     MOVE DK-LINE-NBR-4          TO  DK-LINE-NBR.                 22220000
222300     MOVE DK-PO-RCVR             TO  APORCVRLO.                   22230000
222400     MOVE ASC-AUDIT              TO  ANUMBERO.                    22240000
222500     IF ASC-SKU-X = SPACES                                        22250000
222600         PERFORM 4500-GET-SKU-INFO                                22260000
222700     END-IF.                                                      22270000
222800     MOVE ASC-SKU                TO  PV-SKU.                      22280000
222900     MOVE ASC-UPC                TO  PV-UPC.                      22290000
223000     MOVE PV-SKU-UPC             TO  ASKUUPCO.                    22300000
223100     MOVE ASC-AUDIT-STATUS       TO  ASTATUSO.                    22310000
223200     MOVE ASC-STR-NBR            TO  ASTOREO.                     22320000
223300     MOVE ASC-STR-NAME           TO  ASTRNAMEO.                   22330000
223400     MOVE ASC-AUD-TYP            TO  AAUDTYPEO.                   22340000
223500     MOVE ASC-SHIPT-UNT-ID       TO  PV-SHIPT-UNT-ID-Z.           22350000
223600     MOVE PV-SHIPT-UNT-ID-Z      TO  ASMLNOO.                     22360000
223700     MOVE ASC-CRE-BY             TO  AUSERIDO.                    22370000
223800     MOVE ASC-ADJ-NAME           TO  AUSRNAMEO.                   22380000
223900     MOVE ASC-ADJ-SOURCE         TO  AADJSRCO.                    22390000
224000                                                                  22400000
224100* DMH 8/19/03 - BEGIN                                             22410000
224200     PERFORM 3490-GET-GROUP-DESC.                                 22420000
224300     MOVE ASC-PROCESS-GRP-DESC   TO  AGROUPO.                     22430000
224400* DMH 8/19/03 - END                                               22440000
224500                                                                  22450000
224600     IF ASC-FAIL-SUCCESS-IND = 'N'                                22460000
224700         MOVE 'FAIL      '          TO AFALSUCSO                  22470000
224800     ELSE                                                         22480000
224900         IF ASC-FAIL-SUCCESS-IND = 'Y'                            22490000
225000             MOVE 'SUCCESSFUL'      TO AFALSUCSO                  22500000
225100         END-IF                                                   22510000
225200     END-IF.                                                      22520000
225300                                                                  22530000
225400     EVALUATE TRUE                                                22540000
225500         WHEN ASC-UNT-ADJ-TYP = 'P'                               22550000
225600              MOVE 'POST VERIFICATION'     TO AADJTYPEO           22560000
225700         WHEN ASC-UNT-ADJ-TYP = 'C'                               22570000
225800              MOVE 'CONFIRMATION'          TO AADJTYPEO           22580000
225900         WHEN ASC-UNT-ADJ-TYP = 'V'                               22590000
226000              MOVE 'VERIFICATION'          TO AADJTYPEO           22600000
226100         WHEN ASC-UNT-ADJ-TYP = 'Q'                               22610000
226200              MOVE 'P2L UNIT ADJST'        TO AADJTYPEO           22620000
226300     END-EVALUATE.                                                22630000
226400                                                                  22640000
226500     IF ASC-ADJ-ERR-CDE  > 0                                      22650000
226600         PERFORM 4600-GET-ERR-CDE                                 22660000
226700     END-IF.                                                      22670000
226800     MOVE ASC-ERR-CDE          TO AERRORCDO.                      22680000
226900     MOVE ASC-CRE-TMST         TO PV-DATE-TIME-TMST.              22690000
227000     MOVE PV-TD-YY             TO DK-DIS-YY.                      22700000
227100     MOVE PV-TD-MM             TO DK-DIS-MM.                      22710000
227200     MOVE PV-TD-DD             TO DK-DIS-DD.                      22720000
227300     MOVE PV-TD-HR             TO DK-DIS-HR.                      22730000
227400     MOVE PV-TD-MN             TO DK-DIS-MN.                      22740000
227500     MOVE PV-TD-SS             TO DK-DIS-SC.                      22750000
227600     MOVE DK-DISPLAY-DATE      TO AADJTMSTO.                      22760000
227700     COMPUTE ASC-NET-ADJ = ASC-AFT-QTY - ASC-BEF-QTY.             22770000
227800     MOVE ASC-BEF-QTY          TO DK-BEF-QTY.                     22780000
227900     MOVE DK-BEF-QTY           TO ABEFQTYO.                       22790000
228000     MOVE ASC-AFT-QTY          TO DK-AFT-QTY.                     22800000
228100     MOVE DK-AFT-QTY           TO AAFTQTYO.                       22810000
228200     MOVE ASC-NET-ADJ          TO ANETADJO.                       22820000
228300     MOVE ASC-RSLV-BY          TO AACKUSERO.                      22830000
228400     MOVE ASC-RSLV-NAME        TO AACKNAMEO.                      22840000
228500     MOVE ASC-RSLV-TMST        TO PV-DATE-TIME-TMST.              22850000
228600     IF PV-TD-YY  NOT = '9999'                                    22860000
228700         MOVE PV-TD-YY         TO DK-DIS-YY                       22870000
228800         MOVE PV-TD-MM         TO DK-DIS-MM                       22880000
228900         MOVE PV-TD-DD         TO DK-DIS-DD                       22890000
229000         MOVE PV-TD-HR         TO DK-DIS-HR                       22900000
229100         MOVE PV-TD-MN         TO DK-DIS-MN                       22910000
229200         MOVE PV-TD-SS         TO DK-DIS-SC                       22920000
229300     ELSE                                                         22930000
229400         MOVE SPACES           TO DK-DISPLAY-DATE                 22940000
229500     END-IF.                                                      22950000
229600     MOVE DK-DISPLAY-DATE      TO AACKTMSTO.                      22960000
229700     IF ASC-CRE-BY = 'P2L'                                        22970006
229800         STRING 'ACTUAL QTY: ' ASC-ACT-QTY                        22980006
229900                               DELIMITED BY SIZE    INTO AACTQTYO 22990006
230000         STRING 'VERIFY QTY: ' ASC-VRF-QTY                        23000006
230100                               DELIMITED BY SIZE    INTO AVERQTYO 23010006
230200         STRING 'CURR STATS: ' ASC-CURR-STATUS                    23020006
230300                               DELIMITED BY SIZE    INTO ACURSTTO 23030006
230400     ELSE                                                         23040006
230500         MOVE SPACES           TO AACTQTYO                        23050006
230600                                  AVERQTYO                        23060006
230700                                  ACURSTTO                        23070006
230800     END-IF.                                                      23080006
230900*    MOVE ASC-ACT-QTY          TO DK-ACT-QTY.                     23090002
231000*    MOVE DK-ACT-QTY           TO AACTQTYO.                       23100002
231100*    MOVE ASC-VRF-QTY          TO DK-VRF-QTY.                     23110002
231200*    MOVE DK-VRF-QTY           TO AVRFQTYO.                       23120002
231300*    MOVE ASC-CURR-STATUS      TO ACURSTATO.                      23130002
231400     MOVE ASC-COMMENT-1        TO ACOMMNT1O.                      23140000
231500     MOVE ASC-COMMENT-2        TO ACOMMNT2O.                      23150000
231600     MOVE ASC-COMMENT-3        TO ACOMMNT3O.                      23160000
231700                                                                  23170000
231800*----------------------------------------------------------------*23180000
231900* RETRIEVE SKU # SO THAT IT CAN BE DISPLAYED ON THE SCREEN.      *23190000
232000*----------------------------------------------------------------*23200000
232100 4500-GET-SKU-INFO.                                               23210000
232200                                                                  23220000
232300     INITIALIZE XL001-ITEM-COMMAREA.                              23230000
232400     MOVE ASC-UPC TO XL001-KEY-UPC-NBR.                           23240000
232500     MOVE 'I'     TO XL001-KEY-UPC-TYP-CDE.                       23250000
232600     SET  XL001-BY-UPC-NBR                                        23260000
232700          XL001-SELECT-SKU     TO TRUE.                           23270000
232800     CALL XL001-VSM-PGM USING DFHEIBLK                            23280000
232900                           XL001-COMMAREA                         23290000
233000                           XL001-ITEM-COMMAREA.                   23300000
233100     EVALUATE TRUE                                                23310000
233200         WHEN XL001-SUCCESSFUL                                    23320000
233300              MOVE XL001-SKU-NBR  TO ASC-SKU                      23330000
233400         WHEN OTHER                                               23340000
233500             PERFORM 4505-GET-SKU                                 23350000
233600     END-EVALUATE.                                                23360000
233700                                                                  23370000
233800*----------------------------------------------------------------*23380000
233900*    GET THE SKU NUMBER USING XLKUT001                            23390000
234000*----------------------------------------------------------------*23400000
234100 4505-GET-SKU.                                                    23410000
234200     INITIALIZE XL001-ITEM-COMMAREA.                              23420000
234300     MOVE ASC-UPC TO XL001-KEY-UPC-NBR.                           23430000
234400     MOVE 'I'     TO XL001-KEY-UPC-TYP-CDE.                       23440000
234500     SET  XL001-BY-UPC-NBR                                        23450000
234600          XL001-SELECT-SKU     TO TRUE.                           23460000
234700     CALL XL001-VSM-PGM USING DFHEIBLK                            23470000
234800                           XL001-COMMAREA                         23480000
234900                           XL001-ITEM-COMMAREA.                   23490000
235000     EVALUATE TRUE                                                23500000
235100         WHEN XL001-SUCCESSFUL                                    23510000
235200              MOVE XL001-SKU-NBR  TO ASC-SKU                      23520000
235300         WHEN OTHER                                               23530000
235400             MOVE ZEROES          TO ASC-SKU                      23540000
235500     END-EVALUATE.                                                23550000
235600                                                                  23560000
235700*----------------------------------------------------------------*23570000
235800*    GET THE ERROR CODE DESCRIPTION FROM TSURSNC                  23580000
235900*----------------------------------------------------------------*23590000
236000 4600-GET-ERR-CDE.                                                23600000
236100     INITIALIZE SUT00031-ADJ-ERR-SHRT-DESC.                       23610000
236200                                                                  23620000
236300     EXEC SQL                                                     23630000
236400          SELECT ADJ_ERR_SHRT_DESC                                23640000
236500          INTO  :SUT00031-ADJ-ERR-SHRT-DESC                       23650000
236600          FROM  SUT_ADJ_ERR_CDE                                   23660000
236700        WHERE    ADJ_ERR_CDE    =  :ASC-ADJ-ERR-CDE               23670000
236800     END-EXEC.                                                    23680000
236900                                                                  23690000
237000     EVALUATE TRUE                                                23700000
237100         WHEN SQLCODE = +0                                        23710000
237200             MOVE SUT00031-ADJ-ERR-SHRT-DESC  TO ASC-ERR-CDE      23720000
237300         WHEN OTHER                                               23730000
237400             MOVE SPACES                      TO ASC-ERR-CDE      23740000
237500     END-EVALUATE.                                                23750000
237600                                                                  23760000
237700*************************************************************     23770000
237800 8200-LINK-TO-UPDATE.                                             23780000
237900                                                                  23790000
238000     EXEC CICS LINK                                               23800000
238100          PROGRAM (PC-TMKCS520)                                   23810000
238200          COMMAREA(TM500-FIELDS)                                  23820000
238300          RESP    (PV-CICS-RESPONSE)                              23830000
238400     END-EXEC.                                                    23840000
238500                                                                  23850000
238600     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               23860000
238700         MOVE PV-CICS-RESPONSE     TO PV-DISP-RESPONSE            23870000
238800         MOVE '8200-LINK-TO-UPDATE'                               23880000
238900                                TO DP013-PARAGRAPH                23890000
239000         MOVE 'CALL TMKCS520       ' TO DP013-MESSAGE-TEXT(1)     23900000
239100         STRING 'CICS RESPONSE = '                                23910000
239200                PV-DISP-RESPONSE                                  23920000
239300                      DELIMITED BY SIZE                           23930000
239400                                   INTO DP013-MESSAGE-TEXT(2)     23940000
239500         SET DP013-DB2-ABEND                                      23950000
239600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   23960000
239700         PERFORM DP013-0000-PROCESS-ABEND                         23970000
239800     END-IF.                                                      23980000
239900                                                                  23990000
240000*-----------------------------------------------------------------24000000
240100*  READ THE LIST QUEUE RECORD                                     24010000
240200*-----------------------------------------------------------------24020000
240300 9100-READ-SEL-QUEUE.                                             24030000
240400                                                                  24040000
240500     EXEC CICS                                                    24050000
240600         READQ TS                                                 24060000
240700             QUEUE (ASC-SEL-QUEUE-NAME)                           24070000
240800             INTO  (SU039-SELECT-RECORD)                          24080000
240900             ITEM  (ASC-SEL-ITEM)                                 24090000
241000             RESP  (PV-CICS-RESP)                                 24100000
241100     END-EXEC.                                                    24110000
241200     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        24120000
241300         CONTINUE                                                 24130000
241400     ELSE                                                         24140000
241500         SET DP013-LOGIC-ABEND                                    24150000
241600             DP013-NO-ROLLBACK   TO   TRUE                        24160000
241700         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          24170000
241800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   24180000
241900                                 TO   DP013-MESSAGE-TEXT (1)      24190000
242000         PERFORM DP013-0000-PROCESS-ABEND                         24200000
242100     END-IF.                                                      24210000
242200                                                                  24220000
242300*-----------------------------------------------------------------24230000
242400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24240000
242500*-----------------------------------------------------------------24250000
242600 9200-REWRITE-SEL-QUEUE.                                          24260000
242700                                                                  24270000
242800     EXEC CICS                                                    24280000
242900          WRITEQ TS                                               24290000
243000              QUEUE  (ASC-SEL-QUEUE-NAME)                         24300000
243100              FROM   (SU039-SELECT-RECORD)                        24310000
243200              ITEM   (ASC-SEL-ITEM)                               24320000
243300              RESP   (PV-CICS-RESP)                               24330000
243400              REWRITE                                             24340000
243500     END-EXEC.                                                    24350000
243600                                                                  24360000
243700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   24370000
243800         SET DP013-CICS-ABEND                                     24380000
243900             DP013-NO-ROLLBACK     TO TRUE                        24390000
244000         MOVE '9200-REWRITE-SEL-QUEUE'                            24400000
244100                                   TO DP013-PARAGRAPH             24410000
244200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   24420000
244300                                   TO DP013-MESSAGE-TEXT (1)      24430000
244400         PERFORM DP013-0000-PROCESS-ABEND                         24440000
244500     END-IF.                                                      24450000
244600                                                                  24460000
244700*----------------------------------------------------------------*24470032
244800 9800-WRITE-CICS-LOG.                                             24480032
244900                                                                  24490032
245000     MOVE LENGTH OF PV-CICS-MSG-AREA                              24500032
245100          TO PV-COMMAREA-LENGTH                                   24510032
245200                                                                  24520032
245300     EXEC CICS                                                    24530032
245400         WRITEQ TD                                                24540032
245500             QUEUE  ('CSSL')                                      24550032
245600             FROM   (PV-CICS-MSG-AREA)                            24560032
245700             LENGTH (PV-COMMAREA-LENGTH)                          24570032
245800             RESP   (PV-CICS-RESPONSE)                            24580032
245900     END-EXEC.                                                    24590032
246000                                                                  24600032
246100     MOVE SPACES TO PV-CICS-MSG-AREA.                             24610032
246200*                                                                 24620032
246300*----------------------------------------------------------------*24630000
246400*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *24640000
246500*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *24650000
246600*----------------------------------------------------------------*24660000
246700 9900-SOFT-ABORT.                                                 24670000
246800                                                                  24680000
246900     EXEC CICS SYNCPOINT                                          24690000
247000          ROLLBACK                                                24700000
247100     END-EXEC.                                                    24710000
247200                                                                  24720000
247300     SET  PS-ERROR                                                24730000
247400          PS-SOFT-ABORT-ERROR                                     24740000
247500          DP020-MSG-FATAL       TO  TRUE.                         24750000
247600                                                                  24760000
247700*----------------------------------------------------------------*24770000
247800*    ABEND PROCESSOR MODULE                                      *24780000
247900*----------------------------------------------------------------*24790000
248000                                                                  24800000
248100     COPY DPPD013.                                                24810000
