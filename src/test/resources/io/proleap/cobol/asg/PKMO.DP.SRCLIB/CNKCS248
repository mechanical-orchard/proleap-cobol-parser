000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CNKCS248.                                         00040000
000500 AUTHOR.        DENISE HAHN.                                      00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  NOVEMBER 2016.                                    00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
000910*---------------------------------------------------------------* 00091000
000920*    Y248 - WST_ATTR_ELEM - LIST                                * 00092000
000930*---------------------------------------------------------------* 00093000
263455* CHANGED 11/03/2021    BY JIM HUNTER      WR: CHG0263455         00093181
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00093281
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00093381
263455*----------------------------------------------------------------*00093481
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00093582
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00093682
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00093782
CICS  *-----------------------------------------------------------------00093882
000940                                                                  00094000
000950 EJECT                                                            00095000
000960 ENVIRONMENT DIVISION.                                            00096000
000970                                                                  00097000
000980 DATA DIVISION.                                                   00098000
000990                                                                  00099000
001000 WORKING-STORAGE SECTION.                                         00100000
001100*                                                                 00110000
001200 01  DK-DB2-KEYS.                                                 00120000
001300     05  DK-ATTR-DEFN              PIC  X(10)     VALUE SPACES.   00130000
001310     05  DK-ATTR-UNIQUE-SEQ        PIC  S9(9) COMP VALUE ZEROES.  00131076
001400                                                                  00140000
001500 01  PC-PROGRAM-CONSTANTS.                                        00150000
001600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CNK248  '.  00160000
001700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CNKM248 '.  00170000
001800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CNKCS248'.  00180000
001900     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00190047
002000***  05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00200072
002010     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 3.           00201072
002100     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00210000
002200     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00220000
002210     05  PC-PARM-LIST-FORMAT       PIC  X(01)  VALUE '2'.         00221060
002220     05  PC-DEFN-LIST-FORMAT       PIC  X(01)  VALUE '4'.         00222060
002300     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +08          00230068
002400                                               COMP SYNC.         00240000
002500     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00250000
002600                                               COMP SYNC.         00260000
002700     05  PC-MAX-ITEMS              PIC S9(08)  VALUE +1000000     00270064
002800                                               COMP-3.            00280000
002900     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00290000
003000                                               COMP SYNC.         00300000
003100     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00310000
003200                                               COMP-3.            00320000
003300     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00330000
003400     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00340000
003500     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00350000
003600     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00360000
003601                                                                  00360109
003610     05  PC-ELEM-SEQ         PIC  X(12)  VALUE 'ELEM SEQ    '.    00361009
003620     05  PC-DEFN-SEQ         PIC  X(12)  VALUE 'DEFN SEQ    '.    00362009
003630     05  PC-UNIQUE-ELEM      PIC  X(12)  VALUE 'UNIQUE ELEM '.    00363077
003700                                                                  00370000
006100                                                                  00610049
006110                                                                  00611049
006200*----------------------------------------------------------------*00620000
006300*  SYSTEM MESSAGES                                               *00630000
006400*----------------------------------------------------------------*00640000
006500*   00005 = INVALID VALUE                                        *00650000
006600*   00008 = MUST BE NUMERIC                                      *00660000
006700*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00670000
006800*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00680000
006900*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00690000
007000*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00700000
007100*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00710000
007200*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00720000
007300*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00730000
007400*   00069 - TOP OF LIST                                          *00740000
007500*   00070 - BOTTOM OF LIST                                       *00750000
007600*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00760000
007700*   00279 - MORE ITEMS TO DISPLAY                                *00770000
007800*----------------------------------------------------------------*00780000
007900     05  PC-TSYMSG-NUMBERS.                                       00790000
008000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00800000
008100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00810000
008200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00820000
008300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00830000
008400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00840000
008500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00850000
008600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00860000
008700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00870000
008800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00880000
008900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00890000
009000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00900000
009100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00910000
009200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00920000
009300                                                                  00930000
009400*                                                                 00940000
009500 01  PS-PROGRAM-SWITCHES.                                         00950000
009600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00960000
009700         88  PS-NO-ERROR                            VALUE 'Y'.    00970000
009800         88  PS-ERROR                               VALUE 'N'.    00980000
009900     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    00990000
010000         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01000000
010100         88  PS-BLOCK-ERROR                         VALUE 'N'.    01010000
010200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01020000
010300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01030000
010400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01040000
010500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01050000
010600         88  PS-LIST-END                            VALUE  'Y'.   01060000
010700         88  PS-NO-LIST-END                         VALUE  'N'.   01070000
010800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01080000
010900         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01090000
011000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01100000
011001*                                                                 01100175
011010     05  PS-CURSOR-SELECTION-SW         PIC  X(01)  VALUE '1'.    01101075
011020         88  PS-ALL-ELEMENT-CURSOR                  VALUE '1'.    01102075
011030         88  PS-UNIQUE-ELEMENT-CURSOR               VALUE '2'.    01103075
011100*                                                                 01110000
011200 01  PV-PROGRAM-VARIABLES.                                        01120000
011300     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01130000
011400                                        COMP SYNC.                01140000
011500     05  PV-SUB                         PIC S9(04)  VALUE +0      01150000
011600                                                    COMP SYNC.    01160000
011700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01170000
011800                                                    COMP SYNC.    01180000
011900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01190000
012000                                                    COMP-3.       01200000
012100     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01210000
012200                                                    COMP-3.       01220000
012300     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01230000
012400                                                    COMP-3.       01240000
012500     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01250000
012600                                                    COMP-3.       01260000
012700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01270000
012800                                                    COMP-3.       01280000
012900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01290000
013000                                                    COMP-3.       01300000
013100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01310000
013200                                                    COMP-3.       01320000
013300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01330000
013400                                                    COMP SYNC.    01340000
013500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01350000
013600                                                    COMP SYNC.    01360000
013700     05  PV-ITEM                        PIC S9(04)  VALUE +0      01370000
013800                                                    COMP SYNC.    01380000
013900     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01390000
014000                                                    COMP SYNC.    01400000
014100     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01410000
014200                                                    COMP SYNC.    01420000
014300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01430000
014400                                                    COMP SYNC.    01440000
014500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01450000
014600                                                    COMP SYNC.    01460000
014700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01470000
014800                                                    COMP SYNC.    01480000
014900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01490000
015000                                                    COMP SYNC.    01500000
015100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01510000
015200                                                    COMP SYNC.    01520000
015300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01530000
015400                                                    COMP SYNC.    01540000
015500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01550000
015600                                                    COMP SYNC.    01560000
015700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01570000
015800                                                    COMP SYNC.    01580000
015900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01590000
016000                                                    COMP SYNC.    01600000
016100     05  PV-WST00010-ELEM-COUNT         PIC S9(09)  COMP.         01610000
016500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01650000
016600                                                    COMP SYNC.    01660000
017300     05  PV-SOFT-ABORT-MSG.                                       01730000
017400         10  FILLER            PIC X(12) VALUE ' CNKCS248 - '.    01740000
017500         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01750000
017600         10  PV-SOFT-SQLCODE   PIC ZZ9-.                          01760000
017700         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01770000
017800         10  PV-SOFT-PARAGRAPH PIC X(30).                         01780000
017900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01790000
018000                                                     COMP SYNC.   01800000
018100     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 01810000
018200     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01820000
018300     05  PV-CICS-MSG-HOLD.                                        01830000
018400         10  FILLER                      PIC  X(01)  VALUE SPACE. 01840000
018500         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 01850000
018600     05  PV-CICS-MSG-HOLD2.                                       01860000
018700         10  FILLER                      PIC  X(01)  VALUE SPACE. 01870000
018800         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 01880000
018900                                                                  01890000
023500                                                                  02350000
023600     05  PV-SEL-TERM-ID                  PIC  X(04).              02360000
023700     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02370000
023800     05  PV-SEL-SEQ                      PIC  9(01).              02380000
023900                                                                  02390000
024000     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02400000
024100                                                     COMP SYNC.   02410000
024200     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02420000
024300     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02430000
027900     05  PV-DISP-MAX-LENGTH             PIC ZZZ9    VALUE ZEROS.  02790000
028000     05  PV-DISP-DEC-POS                PIC ZZZ9    VALUE ZEROS.  02800000
028100     05  PV-DISP-ELEM-CNT               PIC ZZZ9    VALUE ZEROS.  02810000
028101     05  PV-DISP-ATTR-NBR               PIC -9(10).9(2).          02810149
028102                                                                  02810201
028110     05  PV-NULL-ELEM-TXT               PIC S9(04)  VALUE ZEROS   02811001
028120                                                    COMP SYNC.    02812001
028140     05  PV-ELEM-TXT-WORK.                                        02814001
028150         49  WS-ATTR-ELEM-TXT-LEN       PIC S9(4) COMP.           02815001
028160         49  WS-ATTR-ELEM-TXT-TEXT      PIC X(50).                02816001
028170                                                                  02817001
028180     05  PV-NULL-ELEM-TMST              PIC S9(04)  VALUE ZEROS   02818001
028190                                                    COMP SYNC.    02819001
028191     05  PV-NULL-ELEM-NBR               PIC S9(04)  VALUE ZEROS   02819101
028192                                                    COMP SYNC.    02819201
028200                                                                  02820000
028300******************************************************************02830000
028400**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02840000
028500**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02850000
028600**  APPLICATION-SPECIFIC COMMAREA.                              **02860000
028700******************************************************************02870000
028800 01  LQW-LIST-QUEUE-WORK-AREA.                                    02880000
028900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02890000
029000     05  LQW-ITEM-ENTRIES               OCCURS  9 TIMES           02900062
029100                                        INDEXED BY LQW-IDX.       02910000
029200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02920000
029300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02930000
029400         10  LQW-SELECTED-SW            PIC  X(01).               02940000
029500             88  LQW-SELECT                         VALUE 'S'.    02950000
029600             88  LQW-DESELECT                       VALUE ' '.    02960000
029700         10  LQW-ACTION                 PIC  X(01).               02970000
029800             88  LQW-ADD                            VALUE 'A'.    02980000
029900             88  LQW-INQ                            VALUE 'I'.    02990000
030000             88  LQW-UPD                            VALUE 'U'.    03000000
030100             88  LQW-ERR                            VALUE 'E'.    03010000
030110         10  LQW-ELEM-SEQ               PIC  9(04).               03011039
030120         10  LQW-DEFN-SEQ               PIC  9(04).               03012039
030130         10  LQW-DATA-TYPE              PIC  X(03).               03013039
030140             88  LQW-DATE                           VALUE 'DTE'.  03014039
030150             88  LQW-NUMERIC                        VALUE 'NUM'.  03015039
030160             88  LQW-STRING                         VALUE 'STR'.  03016039
030170         10  LQW-DEFN-DESCR          PIC  X(08).                  03017043
031560         10  LQW-ELEM-VALUE          PIC  X(50).                  03156039
031570         10  LQW-ELEM-TEXT           PIC  X(50).                  03157039
031580         10  LQW-ELEM-TEXT-NULL      PIC  X(01).                  03158039
031590         10  LQW-ELEM-TMST           PIC  X(26).                  03159039
031591         10  LQW-ELEM-TMST-NULL      PIC  X(01).                  03159139
031592         10  LQW-ELEM-NBR            PIC  9(10).9(2)-.            03159249
031594         10  LQW-ELEM-NBR-NULL       PIC  X(01).                  03159439
031600                                                                  03160000
031700*---------------------------------------------------------------* 03170000
031800* SELECTON QUEUE LAYOUT - FROM INTEGRATION LIST (CNKCS246)      * 03180000
031900*---------------------------------------------------------------* 03190000
032000     COPY CNWS024.                                                03200000
032100                                                                  03210000
032200*---------------------------------------------------------------* 03220000
032300* SELECTION QUEUE LAYOUT                                        * 03230000
032400*---------------------------------------------------------------* 03240000
032500     COPY CNWS028.                                                03250026
032600                                                                  03260000
032700*---------------------------------------------------------------* 03270000
032800*    MAP LAYOUT                                                 * 03280000
032900*---------------------------------------------------------------* 03290000
033000     COPY CNKM248.                                                03300000
033100*                                                                 03310000
033200 01  MR-OCCURS-LAYOUT                   REDEFINES  CNK248O.       03320000
033300     05  FILLER                         PIC X(129).               03330002
033400     05  MR-SCROLL-AREA                 OCCURS  8 TIMES.          03340064
033500         10  MR-SELECTL                 PIC S9(04) COMP.          03350002
033600         10  MR-SELECTA                 PIC  X(01).               03360002
033700         10  MR-SELECTC                 PIC  X(01).               03370002
033800         10  MR-SELECTH                 PIC  X(01).               03380002
033900         10  MR-SELECTI                 PIC  X(01).               03390002
034000                                                                  03400002
034100         10  MR-ACTIONL                 PIC S9(04) COMP.          03410002
034200         10  MR-ACTIONA                 PIC  X(01).               03420002
034300         10  MR-ACTIONC                 PIC  X(01).               03430002
034400         10  MR-ACTIONH                 PIC  X(01).               03440002
034500         10  MR-ACTION                  PIC  X(01).               03450002
034600                                                                  03460002
034700         10  MR-ELMSEQL                PIC S9(04) COMP.           03470002
034800         10  MR-ELMSEQA                PIC  X(01).                03480002
034900         10  MR-ELMSEQC                PIC  X(01).                03490002
035000         10  MR-ELMSEQH                PIC  X(01).                03500002
035100         10  MR-ELMSEQ                 PIC  Z(04).                03510002
035200                                                                  03520002
035300         10  MR-DEFSEQL                PIC S9(04) COMP.           03530002
035400         10  MR-DEFSEQA                PIC  X(01).                03540002
035500         10  MR-DEFSEQC                PIC  X(01).                03550002
035600         10  MR-DEFSEQH                PIC  X(01).                03560002
035700         10  MR-DEFSEQ                 PIC  Z(04).                03570002
035800                                                                  03580002
035900         10  MR-DATYPEL                PIC S9(04) COMP.           03590002
036000         10  MR-DATYPEA                PIC  X(01).                03600002
036100         10  MR-DATYPEC                PIC  X(01).                03610002
036200         10  MR-DATYPEH                PIC  X(01).                03620002
036300         10  MR-DATYPE                 PIC  X(03).                03630002
036400                                                                  03640002
036500         10  MR-DADESCL                PIC S9(04) COMP.           03650002
036600         10  MR-DADESCA                PIC  X(01).                03660002
036700         10  MR-DADESCC                PIC  X(01).                03670002
036800         10  MR-DADESCH                PIC  X(01).                03680002
036900         10  MR-DADESC                 PIC  X(08).                03690002
037000                                                                  03700002
037100         10  MR-VALUEL                 PIC S9(04) COMP.           03710002
037200         10  MR-VALUEA                 PIC  X(01).                03720002
037300         10  MR-VALUEC                 PIC  X(01).                03730002
037400         10  MR-VALUEH                 PIC  X(01).                03740002
037500         10  MR-VALUE                  PIC  X(49).                03750058
037600                                                                  03760002
037700                                                                  03770002
037800     05  FILLER                         PIC  X(12).               03780002
039100                                                                  03910000
039200*---------------------------------------------------------------* 03920000
039300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03930000
039400*---------------------------------------------------------------* 03940000
039500     COPY DPWS015.                                                03950000
039600                                                                  03960000
039700*---------------------------------------------------------------* 03970000
039800*    FUNCTION KEYS COPYBOOK.                                    * 03980000
039900*---------------------------------------------------------------* 03990000
040000     COPY DPWS016.                                                04000000
040100                                                                  04010000
040200*---------------------------------------------------------------* 04020000
040300*    NUMERIC EDIT LAYOUT.                                       * 04030000
040400*---------------------------------------------------------------* 04040000
040500     COPY DPWS010I.                                               04050000
040600                                                                  04060000
040700*---------------------------------------------------------------* 04070000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04080082
040900*---------------------------------------------------------------* 04090000
041000     COPY DPWS030.                                                04100000
CICS       COPY DPWS930.                                                04101082
041100                                                                  04110000
041200*---------------------------------------------------------------* 04120000
041300*    STANDARD COMMAREA.                                         * 04130000
041400*---------------------------------------------------------------* 04140000
041500     COPY DPWS020.                                                04150000
041600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04160000
041700                                                                  04170000
041800*---------------------------------------------------------------* 04180000
041900* INTER-APPLICATION COMMAREA.                                   * 04190000
042000*   CNWS022 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04200000
042100*             SPEC SCREEN.  (CNKCS243)                          * 04210000
042200*   CNWS022 - IS THE INPUT LAYOUT WHEN COMING FROM THE DEFN     * 04220026
042300*             LIST SCREEN.  (CNKCS247)                          * 04230026
042400*   CNWS023 - IS THE INPUT LAYOUT WHEN COMING FROM THE CODE     * 04240026
042500*             LIST SCREEN.  (CNKCS246)                          * 04250026
042510*   CNWS027 - IS THE OUTPUT LAYOUT WHEN NAVIGATING TO THE       * 04251026
042520*             ADD/UPDATE ELEM SCREEN (CNKCS249)                 * 04252026
042600                                                                  04260000
042700         10  INTER-APPL-COMM-AREA       PIC X(200).               04270000
042800     COPY CNWS022.                                                04280000
042900     COPY CNWS023.                                                04290000
043000     COPY CNWS027.                                                04300026
043100                                                                  04310000
043200*---------------------------------------------------------------* 04320000
043300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04330000
043400*---------------------------------------------------------------* 04340000
043500         10  ASC-SPECIFIC-COMMAREA.                               04350000
043600             15  ASC-FUNCTION                 PIC  X(02).         04360000
043700                 88  ASC-FUNCTION-NONE             VALUE ' '.     04370000
043800                 88  ASC-ADD-CODE                  VALUE 'AC'.    04380000
043900                 88  ASC-UPD-CODE                  VALUE 'UC'.    04390000
044000                 88  ASC-ADD-PARM                  VALUE 'AP'.    04400000
044100                 88  ASC-UPD-PARM                  VALUE 'UP'.    04410000
044400             15  ASC-PARM-NAME                PIC  X(10).         04440000
044500             15  ASC-PARM-DESC                PIC  X(27).         04450067
044900                                                                  04490000
044910             15  ASC-ORD-SEQ                  PIC  X(12).         04491008
044920             15  ASC-LIST-SEQ-SW              PIC  X(1).          04492009
044930                 88  ASC-LIST-BY-ELEM                VALUE 'E'.   04493010
044940                 88  ASC-LIST-BY-DEFN                VALUE 'D'.   04494010
044941                 88  ASC-LIST-BY-UNIQUE-ELEM         VALUE 'U'.   04494176
044942* DMH-11/07/07 BEGIN                                              04494276
044950             15  ASC-UNIQUE-ELEM-SEQ          PIC  X(09).         04495075
044960* DMH-11/07/07 END                                                04496075
045000             15  FILLER                      PIC   X(10).         04500066
045100*-----------------------------------------------------------------04510000
045200             15  ASC-BLK-SUB                  PIC S9(04) COMP     04520000
045300                                                         SYNC.    04530000
045400             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04540000
045500                                                         SYNC.    04550000
045600             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04560000
045700             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04570000
045800             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04580000
045900             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04590000
046000             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04600000
046100             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04610000
046200                                                         SYNC.    04620000
046300             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04630000
046400             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04640000
046500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04650000
046600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04660000
046700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04670000
046800             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         04680000
046900                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     04690000
047000                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     04700000
047100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04710000
047200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04720000
047300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04730000
047400             15  ASC-LIST-QUEUE-NAME.                             04740000
047500                 20  ASC-LIST-TERM-ID         PIC  X(04).         04750000
047600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04760000
047700                 20  ASC-LIST-SEQ             PIC  9(01).         04770000
047800                                                                  04780000
047900             15  ASC-START-ITEM-REQUEST.                          04790000
048000                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04800000
048100                                                                  04810000
048200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04820000
048300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04830000
048400                                                                  04840000
048500             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04850000
048600                 88  ASC-USE-SELECTION-QUEUE       VALUE 'Y'.     04860000
048700             15  ASC-SEL-QUEUE-NAME.                              04870000
048800                 20  ASC-SEL-TERM-ID          PIC  X(04).         04880000
048900                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04890000
049000                 20  ASC-SEL-SEQ              PIC  9(01).         04900000
049010             15  ASC-SEL-QUEUE-NAME-2.                            04901038
049020                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         04902038
049030                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  04903038
049040                 20  ASC-SEL-SEQ-2            PIC  9(01).         04904038
049100                                                                  04910000
049200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04920000
049300                                                                  04930000
049400*-----------------------------------------------------------------04940000
049500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04950000
049600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04960000
049700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04970000
049800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04980000
049900                                                                  04990000
050000                 20  ASC-ITEM-ARRAY.                              05000000
050100                     25  ASC-ITEM-ENTRIES OCCURS  8 TIMES.        05010064
050200                         30  ASC-LIST-ITEM-NUMBER                 05020000
050300                                                     PIC S9(09)   05030000
050400                                                     COMP-3.      05040000
050500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05050000
050600                             88  ASC-VALID-SELECT    VALUE ' '    05060000
050700                                                           'S'    05070000
050800                                                           'B'    05080000
050900                                                           'E'.   05090000
051000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05100000
051100                             88  ASC-TEMP-SELECT     VALUE 'S'.   05110000
051200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05120000
051300                             88  ASC-TEMP-END        VALUE 'E'.   05130000
051400                         30  ASC-SELECTED-SW         PIC  X(01).  05140000
051500                             88  ASC-NO-SELECT       VALUE ' '.   05150000
051600                             88  ASC-SELECT          VALUE 'S'.   05160000
051700                             88  ASC-BEGIN           VALUE 'B'.   05170000
051800                             88  ASC-END             VALUE 'E'.   05180000
051900                         30  ASC-ACTION              PIC  X(01).  05190000
052000                         30  ASC-ELEM-SEQ            PIC  9(04).  05200004
052100                         30  ASC-DEFN-SEQ            PIC  9(04).  05210004
052200                         30  ASC-DATA-TYPE           PIC  X(03).  05220004
052300                         30  ASC-DEFN-DESCR          PIC  X(08).  05230042
052400                         30  ASC-ELEM-VALUE          PIC  X(50).  05240004
052500                         30  ASC-ELEM-TEXT           PIC  X(50).  05250004
052600                         30  ASC-ELEM-TEXT-NULL      PIC  X(01).  05260004
052700                         30  ASC-ELEM-TMST           PIC  X(26).  05270004
052800                         30  ASC-ELEM-TMST-NULL      PIC  X(01).  05280004
052900                         30  ASC-ELEM-NBR            PIC          05290004
053000                                                      9(10).99-.  05300049
053100                         30  ASC-ELEM-NBR-NULL       PIC  X(01).  05310004
053400                                                                  05340000
053500                                                                  05350000
053600*---------------------------------------------------------------* 05360000
053700*    ABEND PROCESSING COPYBOOK.                                 * 05370000
053800*---------------------------------------------------------------* 05380000
053900     COPY DPWS013.                                                05390000
054000                                                                  05400000
054100*----------------------------------------------------------------*05410000
054200*    DB2 TABLE FOR WST_INTGRTN_TYP INTEGRATION CODE TABLE         05420000
054300*----------------------------------------------------------------*05430000
054400     EXEC SQL                                                     05440000
054500          INCLUDE WST00008                                        05450000
054600     END-EXEC.                                                    05460000
054700                                                                  05470000
054800                                                                  05480000
054900*----------------------------------------------------------------*05490000
055000*    DB2 TABLE FOR WST_ATTR_DEFN ATTRIBUTE DEFINITION TABLE       05500000
055100*----------------------------------------------------------------*05510000
055200     EXEC SQL                                                     05520000
055300          INCLUDE WST00009                                        05530000
055400     END-EXEC.                                                    05540000
055500                                                                  05550000
055600                                                                  05560000
055700*----------------------------------------------------------------*05570000
055800*    DB2 TABLE FOR WST_ATTR_ELEM ATTRIBUTE ELEMENT TABLE          05580000
055900*----------------------------------------------------------------*05590000
056000     EXEC SQL                                                     05600000
056100          INCLUDE WST00010                                        05610000
056200     END-EXEC.                                                    05620000
056300                                                                  05630000
056400                                                                  05640000
056500                                                                  05650000
056600*---------------------------------------------------------------* 05660000
056700* WST_ATTR_ELEM CURSOR - ELEMENT SEQUENCE                       * 05670000
056800*---------------------------------------------------------------* 05680000
056900     EXEC SQL                                                     05690000
057000        DECLARE ATTR-ELEM-ELEM-SEQ-CSR CURSOR FOR                 05700000
057100         SELECT A.INTGRTN_TYP_CDE                                 05710000
057200              , A.ATTR_DEFN_SEQ_NBR                               05720000
057300              , A.ATTR_ELEM_SEQ_NBR                               05730000
057400              , A.ATTR_ELEM_TXT                                   05740000
057500              , A.ATTR_ELEM_TMST                                  05750000
057600              , A.ATTR_ELEM_NBR                                   05760000
057700              , B.DATYP_CDE                                       05770000
057800              , B.ATTR_DEFN_DESC                                  05780000
057900           FROM WST_ATTR_ELEM A                                   05790000
058000              , WST_ATTR_DEFN B                                   05800000
058100          WHERE A.INTGRTN_TYP_CDE   =  :DK-ATTR-DEFN              05810000
058110            AND A.INTGRTN_TYP_CDE   =  B.INTGRTN_TYP_CDE          05811000
058120            AND A.ATTR_DEFN_SEQ_NBR =  B.ATTR_DEFN_SEQ_NBR        05812000
058130          ORDER BY A.ATTR_ELEM_SEQ_NBR                            05813000
058140                 , A.ATTR_DEFN_SEQ_NBR                            05814000
058150     END-EXEC.                                                    05815000
058160                                                                  05816000
058170*---------------------------------------------------------------* 05817000
058180* WST_ATTR_ELEM CURSOR - DEFINITION SEQUENCE                    * 05818000
058190*---------------------------------------------------------------* 05819000
058191     EXEC SQL                                                     05819100
058192        DECLARE ATTR-ELEM-DEFN-SEQ-CSR CURSOR FOR                 05819200
058193         SELECT A.INTGRTN_TYP_CDE                                 05819300
058194              , A.ATTR_DEFN_SEQ_NBR                               05819400
058195              , A.ATTR_ELEM_SEQ_NBR                               05819500
058196              , A.ATTR_ELEM_TXT                                   05819600
058197              , A.ATTR_ELEM_TMST                                  05819700
058198              , A.ATTR_ELEM_NBR                                   05819800
058199              , B.DATYP_CDE                                       05819900
058200              , B.ATTR_DEFN_DESC                                  05820000
058201           FROM WST_ATTR_ELEM A                                   05820100
058202              , WST_ATTR_DEFN B                                   05820200
058203          WHERE A.INTGRTN_TYP_CDE   =  :DK-ATTR-DEFN              05820300
058204            AND A.INTGRTN_TYP_CDE   =  B.INTGRTN_TYP_CDE          05820400
058205            AND A.ATTR_DEFN_SEQ_NBR =  B.ATTR_DEFN_SEQ_NBR        05820500
058206          ORDER BY ATTR_DEFN_SEQ_NBR                              05820600
058207                 , ATTR_ELEM_SEQ_NBR                              05820700
058208     END-EXEC.                                                    05820800
058209                                                                  05820900
058210                                                                  05821000
058220*---------------------------------------------------------------* 05822076
058230* ATTR-UNIQUE-ELEM-CSR - FOR UNIQUE ELEMENT SEQUENCE            * 05823076
058240*---------------------------------------------------------------* 05824076
058250     EXEC SQL                                                     05825076
058260        DECLARE ATTR-UNIQUE-ELEM-CSR CURSOR FOR                   05826076
058270         SELECT A.INTGRTN_TYP_CDE                                 05827076
058280              , A.ATTR_DEFN_SEQ_NBR                               05828076
058290              , A.ATTR_ELEM_SEQ_NBR                               05829076
058291              , A.ATTR_ELEM_TXT                                   05829176
058292              , A.ATTR_ELEM_TMST                                  05829276
058293              , A.ATTR_ELEM_NBR                                   05829376
058294              , B.DATYP_CDE                                       05829476
058295              , B.ATTR_DEFN_DESC                                  05829576
058296           FROM WST_ATTR_ELEM A                                   05829676
058297              , WST_ATTR_DEFN B                                   05829776
058298          WHERE A.INTGRTN_TYP_CDE   =  :DK-ATTR-DEFN              05829876
058299            AND A.ATTR_ELEM_SEQ_NBR =  :DK-ATTR-UNIQUE-SEQ        05829976
058300            AND A.INTGRTN_TYP_CDE   =  B.INTGRTN_TYP_CDE          05830076
058301            AND A.ATTR_DEFN_SEQ_NBR =  B.ATTR_DEFN_SEQ_NBR        05830176
058302          ORDER BY ATTR_DEFN_SEQ_NBR                              05830276
058303                 , ATTR_ELEM_SEQ_NBR                              05830376
058304     END-EXEC.                                                    05830476
058305                                                                  05830576
058306                                                                  05830676
058310*---------------------------------------------------------------* 05831000
058400*    DB2 AREA FOR COMMUNICATIONS                                * 05840000
058500*---------------------------------------------------------------* 05850000
058600     EXEC SQL                                                     05860000
058700          INCLUDE SQLCA                                           05870000
058800     END-EXEC.                                                    05880000
058900                                                                  05890000
059000                                                                  05900000
059100*---------------------------------------------------------------* 05910000
059200*                                                               * 05920000
059300*---------------------------------------------------------------* 05930000
059400 LINKAGE SECTION.                                                 05940000
059500                                                                  05950000
059600 01  DFHCOMMAREA.                                                 05960000
059700     05  FILLER                         OCCURS  1 TO 4072 TIMES   05970000
059800                                        DEPENDING ON EIBCALEN.    05980000
059900         10  FILLER                     PIC X.                    05990000
060000                                                                  06000000
060100 EJECT                                                            06010000
060200 PROCEDURE DIVISION.                                              06020000
060300******************************************************************06030000
060400**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06040000
060500**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06050000
060600**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06060000
060700******************************************************************06070000
060800 0000-MAIN-MODULE.                                                06080000
060900     INITIALIZE DP030-CICS-API-FIELDS.                            06090000
061000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06100000
061100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06110000
061200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06120000
061300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06130000
061400     MOVE LENGTH OF CNK248I        TO DP030-MAP-LENGTH (1).       06140000
061500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06150000
061600     PERFORM 0001-CALL-CICS-ARCH-API.                             06160000
061700*                                                                 06170000
061800     PERFORM 1000-CONTROL-PROCESSING                              06180000
061900*                                                                 06190000
062000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06200000
062100     PERFORM 0001-CALL-CICS-ARCH-API.                             06210000
062200                                                                  06220000
062300******************************************************************06230000
062400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06240000
062500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06250000
062600******************************************************************06260000
062700 0001-CALL-CICS-ARCH-API.                                         06270000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06280082
062900                                    DFHCOMMAREA                   06290082
063000                                    DP030-CICS-API-FIELDS         06300082
063100                                    DP020-STANDARD-COMMAREA       06310082
063200                                    CNK248I.                      06320082
063300*                                                                 06330000
063400     IF  DP030-RC-CALL-SUCCESSFUL                                 06340000
063500         CONTINUE                                                 06350000
063600     ELSE                                                         06360000
063700         SET DP013-NO-ROLLBACK                                    06370000
063800             DP013-XCTL-DISPLAY-RESTART                           06380000
063900             DP013-CICS-ABEND      TO TRUE                        06390000
064000         MOVE '0001-CALL-CICS-ARCH-API'                           06400000
064100                                   TO DP013-PARAGRAPH             06410000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06411082
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06412082
064400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06440000
064500         PERFORM DP013-0000-PROCESS-ABEND                         06450000
064600     END-IF.                                                      06460000
064700*----------------------------------------------------------------*06470000
064800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06480000
064900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06490000
065000*                                                                *06500000
065100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06510000
065200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *06520000
065300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *06530000
065400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *06540000
065500*----------------------------------------------------------------*06550000
065600                                                                  06560000
065700 1000-CONTROL-PROCESSING.                                         06570000
065800                                                                  06580000
065900     EVALUATE TRUE                                                06590000
066000         WHEN DP020-NEXT-ACT-INITIAL                              06600000
066100             INITIALIZE ASC-SPECIFIC-COMMAREA                     06610000
066200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06620000
066300                                      ASC-SEL-TERM-ID             06630000
066310                                      ASC-SEL-TERM-ID-2           06631038
066400             MOVE DP020-SRC-TASK-NUMBER                           06640000
066500                                   TO ASC-LIST-TASK-NUMBER        06650000
066600                                      ASC-SEL-TASK-NUMBER         06660000
066610                                      ASC-SEL-TASK-NUMBER-2       06661038
066700             MOVE PC-LIST-QUEUE-SEQ                               06670000
066800                                   TO ASC-LIST-SEQ                06680000
066900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 06690000
066910                                      ASC-SEL-SEQ-2               06691038
066911* DMH - 11/07/17 BEGIN                                            06691175
066930             SET  PS-ALL-ELEMENT-CURSOR TO TRUE                   06693075
066950* DMH - 11/07/17 END                                              06695075
067000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06700000
067100                                                                  06710000
067110             PERFORM 3200-RESET-ATTRIBUTES                        06711055
067120                                                                  06712055
067200             PERFORM 4000-BUILD-INITIAL-PANEL                     06720000
067300                                                                  06730000
067400         WHEN DP020-NEXT-ACT-READ-MAP                             06740000
067500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06750000
067600                                   TO PV-TOP-ITEM                 06760000
067700             PERFORM 2000-PROCESS-PANEL                           06770000
067800                                                                  06780000
067900         WHEN DP020-NEXT-ACT-RETURN                               06790000
068000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06800000
068100                                   TO PV-TOP-ITEM                 06810000
068200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06820000
068300                                                                  06830000
069302             PERFORM 3200-RESET-ATTRIBUTES                        06930252
069303             MOVE +1               TO PV-TOP-ITEM                 06930352
069304**DMH                                                             06930459
069305             PERFORM 2050-DELETE-LIST-QUEUE                       06930559
069306**DMH                                                             06930659
069307             PERFORM 4000-BUILD-INITIAL-PANEL                     06930751
069400                                                                  06940000
069500         WHEN OTHER                                               06950000
069600             SET DP013-LOGIC-ABEND TO TRUE                        06960000
069700             SET DP013-NO-ROLLBACK TO TRUE                        06970000
069800             MOVE '1000-CONTROL-PROCESSING'                       06980000
069900                                   TO DP013-PARAGRAPH             06990000
070000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07000000
070100                                   TO DP013-MESSAGE-TEXT(1)       07010000
070200             PERFORM DP013-0000-PROCESS-ABEND                     07020000
070300     END-EVALUATE.                                                07030000
070400                                                                  07040000
070500 EJECT                                                            07050000
070600*----------------------------------------------------------------*07060000
070700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07070000
070800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07080000
070900*----------------------------------------------------------------*07090000
071000                                                                  07100000
071100 1100-PROCESS-INTER-APPL-COMM.                                    07110000
071200                                                                  07120000
071300     SET PS-COMMAREA-VALID         TO TRUE.                       07130000
071400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07140000
071500                                                                  07150000
071600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07160076
071610         SET ASC-LIST-BY-ELEM          TO TRUE                    07161011
071620         MOVE PC-ELEM-SEQ              TO ASC-ORD-SEQ             07162008
071700         MOVE CN022-FUNCTION           TO ASC-FUNCTION            07170000
072000         MOVE CN022-PARM-NAME          TO ASC-PARM-NAME           07200000
072100         MOVE CN022-PARM-DESC          TO ASC-PARM-DESC           07210000
072200         MOVE CN022-ELEM-SEQ           TO ASC-UNIQUE-ELEM-SEQ     07220075
072210         IF  ASC-UNIQUE-ELEM-SEQ  > 0                             07221076
072220             SET  ASC-LIST-BY-UNIQUE-ELEM TO  TRUE                07222079
072221             MOVE PC-UNIQUE-ELEM       TO ASC-ORD-SEQ             07222179
072230         END-IF                                                   07223076
072300     ELSE                                                         07230000
072320     IF  DP020-INT-APPL-FORMAT-IND = PC-DEFN-LIST-FORMAT          07232076
072330         SET ASC-LIST-BY-ELEM          TO TRUE                    07233076
072340         MOVE PC-ELEM-SEQ              TO ASC-ORD-SEQ             07234076
072350         MOVE CN022-FUNCTION           TO ASC-FUNCTION            07235076
072360         MOVE CN022-PARM-NAME          TO ASC-PARM-NAME           07236076
072370         MOVE CN022-PARM-DESC          TO ASC-PARM-DESC           07237076
072380         MOVE ZEROES                   TO ASC-UNIQUE-ELEM-SEQ     07238076
072390     ELSE                                                         07239076
072400         IF  CN023-NUMBER-OF-SELECTED-ITEMS > 0                   07240008
072410             SET ASC-LIST-BY-ELEM          TO TRUE                07241011
072420             MOVE PC-ELEM-SEQ              TO ASC-ORD-SEQ         07242008
072500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  07250000
072600             MOVE CN023-NUMBER-OF-SELECTED-ITEMS                  07260000
072700                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 07270000
072800             MOVE CN023-NUMBER-OF-TS-ITEMS                        07280000
072900                                  TO ASC-NUMBER-OF-TS-ITEMS       07290000
073000             MOVE CN023-SEL-QUEUE-NAME                            07300000
073100                                  TO ASC-SEL-QUEUE-NAME           07310000
073200                                                                  07320000
073300             MOVE CN023-FUNCTION      TO ASC-FUNCTION             07330000
073600             MOVE CN023-PARM-CODE     TO ASC-PARM-NAME            07360000
073700             MOVE CN023-PARM-DESC     TO ASC-PARM-DESC            07370000
073800             MOVE ZEROES              TO ASC-UNIQUE-ELEM-SEQ      07380076
073900                                                                  07390000
074100             PERFORM 1120-PREPARE-LIST-ENTRY                      07410000
074200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07420000
074400         END-IF                                                   07440000
074410     END-IF                                                       07441076
074500     END-IF.                                                      07450000
074600                                                                  07460000
074700                                                                  07470000
074800*----------------------------------------------------------------*07480000
074900*                                                                *07490000
075000*----------------------------------------------------------------*07500000
075100 1120-PREPARE-LIST-ENTRY.                                         07510000
075200                                                                  07520000
075300     MOVE CN024-MAX-ITEMS          TO ASC-SEL-SUB.                07530000
075400     MOVE ZERO                     TO ASC-SEL-ITEM.               07540000
075500     PERFORM 1130-GET-NEXT-RECORD.                                07550000
075600                                                                  07560000
075700*----------------------------------------------------------------*07570000
075800*  GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED  *07580000
075900*----------------------------------------------------------------*07590000
076000 1130-GET-NEXT-RECORD.                                            07600000
076100                                                                  07610000
076200     ADD +1                       TO ASC-SEL-SUB.                 07620000
076300                                                                  07630000
076400     IF  ASC-SEL-SUB > CN024-MAX-ITEMS                            07640000
076500         ADD +1                   TO ASC-SEL-ITEM                 07650000
076600         MOVE +1                  TO ASC-SEL-SUB                  07660000
076700     END-IF.                                                      07670000
076800                                                                  07680000
076900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07690000
077000         PERFORM 9100-READ-SEL-QUEUE                              07700000
077100         IF  CN024-ITEM (ASC-SEL-SUB) > ZERO                      07710000
077200             MOVE CN024-PARM-NAME   (ASC-SEL-SUB)                 07720000
077300                                  TO ASC-PARM-NAME                07730000
077400             MOVE CN024-PARM-DESC  (ASC-SEL-SUB)                  07740000
077500                                  TO ASC-PARM-DESC                07750000
078200                                                                  07820000
078300             SET CN024-INQ (ASC-SEL-SUB)                          07830000
078400                                  TO TRUE                         07840000
078500             PERFORM 9200-REWRITE-SEL-QUEUE                       07850000
078600         ELSE                                                     07860000
078700             SUBTRACT +1 FROM ASC-SEL-SUB                         07870000
078800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             07880000
078900             SET DP020-MSG-INFORMATIONAL                          07890000
079000                 PS-LIST-END             TO TRUE                  07900000
079100         END-IF                                                   07910000
079200     ELSE                                                         07920000
079300         SUBTRACT +1 FROM ASC-SEL-ITEM                            07930000
079400         MOVE CN024-MAX-ITEMS     TO ASC-SEL-SUB                  07940000
079500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07950000
079600         SET DP020-MSG-INFORMATIONAL                              07960000
079700             PS-LIST-END             TO TRUE                      07970000
079800     END-IF.                                                      07980000
079900                                                                  07990000
080000                                                                  08000000
080100*----------------------------------------------------------------*08010000
080200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *08020000
080300*    PROCESSED.                                                  *08030000
080400*----------------------------------------------------------------*08040000
080500 1140-GET-PREV-RECORD.                                            08050000
080600                                                                  08060000
080700     SUBTRACT +1 FROM ASC-SEL-SUB.                                08070000
080800                                                                  08080000
080900     IF  ASC-SEL-SUB < +1                                         08090000
081000         SUBTRACT +1 FROM ASC-SEL-ITEM                            08100000
081100         MOVE CN024-MAX-ITEMS     TO ASC-SEL-SUB                  08110000
081200     END-IF.                                                      08120000
081300                                                                  08130000
081400     IF  ASC-SEL-ITEM > ZERO                                      08140000
081500         PERFORM 9100-READ-SEL-QUEUE                              08150000
081600         IF  CN024-ITEM (ASC-SEL-SUB) > ZERO                      08160000
081700             MOVE CN024-PARM-NAME  (ASC-SEL-SUB)                  08170000
081800                                  TO ASC-PARM-NAME                08180000
081900             MOVE CN024-PARM-DESC  (ASC-SEL-SUB)                  08190000
082000                                  TO ASC-PARM-DESC                08200000
082700                                                                  08270000
082800             SET CN024-INQ (ASC-SEL-SUB)                          08280000
082900                                  TO TRUE                         08290000
083000         PERFORM 9200-REWRITE-SEL-QUEUE                           08300000
083100     ELSE                                                         08310000
083200         MOVE +1                  TO ASC-SEL-ITEM                 08320000
083300                                     ASC-SEL-SUB                  08330000
083400         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             08340000
083500         SET DP020-MSG-INFORMATIONAL                              08350000
083600             PS-LIST-END             TO TRUE                      08360000
083700     END-IF.                                                      08370000
083800                                                                  08380000
083900                                                                  08390000
084000                                                                  08400000
084100*----------------------------------------------------------------*08410000
084200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08420000
084300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08430000
084400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08440000
084500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08450000
084600* FUNCTION KEYS CAN GET THIS FAR.                                *08460000
084700*----------------------------------------------------------------*08470000
084800                                                                  08480000
084900 2000-PROCESS-PANEL.                                              08490000
085000     EVALUATE TRUE                                                08500000
085100         WHEN DP020-SRC-AID = DP016-CLEAR                         08510000
085200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08520000
085300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08530000
085400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08540000
085500                                                                  08550000
085600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08560000
085700             PERFORM 2050-DELETE-LIST-QUEUE                       08570000
085800             PERFORM 4000-BUILD-INITIAL-PANEL                     08580000
085900                                                                  08590000
086000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    08600000
086100             PERFORM 2140-DESELECT-ALL-ITEMS                      08610000
086200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08620000
086300                                                                  08630000
086400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  08640000
086500             PERFORM 2150-SELECT-ALL-ITEMS                        08650000
086600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08660000
086700                                                                  08670000
086800         WHEN OTHER                                               08680000
086900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08690000
086910             PERFORM 3200-RESET-ATTRIBUTES                        08691048
087000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08700000
087100                                                                  08710000
087300             IF  PS-NO-ERROR                                      08730048
087500                 PERFORM 2100-CHECK-FUNCTION-KEY                  08750048
087600                 IF PS-NO-ERROR                                   08760048
087700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08770048
087800                     SET DP030-CONTINUE-GO TO TRUE                08780048
087900                 ELSE                                             08790048
088000                     SET DP030-OVERRIDE-GO TO TRUE                08800048
088010                 END-IF                                           08801048
088020             ELSE                                                 08802048
088030                 SET DP030-OVERRIDE-GO TO TRUE                    08803048
088040             END-IF                                               08804048
088100     END-EVALUATE.                                                08810000
088200                                                                  08820000
088300                                                                  08830000
088400*----------------------------------------------------------------*08840000
088500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08850000
088600*----------------------------------------------------------------*08860000
088700 2050-DELETE-LIST-QUEUE.                                          08870000
088800                                                                  08880000
088900     EXEC CICS                                                    08890000
089000         DELETEQ TS                                               08900000
089100             QUEUE (ASC-LIST-QUEUE-NAME)                          08910000
089200             RESP  (PV-CICS-RESP)                                 08920000
089300     END-EXEC.                                                    08930000
089400                                                                  08940000
089500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       08950000
089600        (PV-CICS-RESP = DFHRESP(QIDERR))                          08960000
089700         CONTINUE                                                 08970000
089800     ELSE                                                         08980000
089900         SET DP013-CICS-ABEND      TO TRUE                        08990000
090000         SET DP013-NO-ROLLBACK     TO TRUE                        09000000
090100                                                                  09010000
090200         MOVE '2050-DELETE-LIST-QUEUE'                            09020000
090300                                   TO DP013-PARAGRAPH             09030000
090400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09040000
090500                                   TO DP013-MESSAGE-TEXT (1)      09050000
090600         PERFORM DP013-0000-PROCESS-ABEND                         09060000
090700     END-IF.                                                      09070000
090800                                                                  09080000
090900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09090000
091000 EJECT                                                            09100000
091100*----------------------------------------------------------------*09110000
091200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09120000
091300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09130000
091400* CICS ARCHITECTURE API.                                         *09140000
091500*----------------------------------------------------------------*09150000
091600 2100-CHECK-FUNCTION-KEY.                                         09160000
091700                                                                  09170000
091800     EVALUATE TRUE                                                09180000
091900*                                                                 09190000
092000* F13 - ADD ELEM  (WST_ATTR_ELEM) (LOCAL-FUNC-01)                 09200008
092100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09210000
092900                  SET CN022-ADD-ELEM TO TRUE                      09290069
093000                  MOVE ASC-PARM-NAME    TO  CN022-PARM-NAME       09300000
093100                  MOVE ASC-PARM-DESC    TO  CN022-PARM-DESC       09310000
093900                                                                  09390000
094000* F15 - UPD ELEM  (WST_ATTR_ELEM) (LOCAL-FUNC-02)                 09400008
094100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09410000
094200              IF  ASC-NUMBER-OF-SELECTED-ITEMS > 0                09420000
094300                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               09430000
094400                                TO CN027-NUMBER-OF-SELECTED-ITEMS 09440025
094500                  MOVE ASC-NUMBER-OF-TS-ITEMS                     09450000
094600                                      TO CN027-NUMBER-OF-TS-ITEMS 09460025
094700                  MOVE ASC-SEL-QUEUE-NAME                         09470000
094800                                         TO  CN027-SEL-QUEUE-NAME 09480025
094900                  SET CN027-UPD-ELEM TO TRUE                      09490027
095000                  MOVE ASC-PARM-NAME    TO  CN027-FUNC-NAME       09500025
095100                  MOVE ASC-PARM-DESC    TO  CN027-FUNC-DESC       09510025
095300                  PERFORM 5000-PREPARE-SEL-QUEUE                  09530000
095400              ELSE                                                09540000
095500                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            09550000
095600                  SET DP030-OVERRIDE-GO TO TRUE                   09560000
095700                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       09570000
095800                  SET DP020-MSG-FATAL   TO TRUE                   09580000
095900             END-IF                                               09590000
096000                                                                  09600000
096100* F14 - ORDER               (LOCAL-FUNC-03)                       09610008
096200         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09620000
096300             PERFORM 2050-DELETE-LIST-QUEUE                       09630008
096400                                                                  09640008
096500             IF ASC-LIST-BY-DEFN                                  09650008
096600                SET ASC-LIST-BY-ELEM  TO TRUE                     09660008
096610                MOVE PC-ELEM-SEQ      TO ASC-ORD-SEQ              09661008
096620             ELSE                                                 09662008
096621             IF ASC-LIST-BY-UNIQUE-ELEM                           09662176
096623                MOVE PC-UNIQUE-ELEM   TO ASC-ORD-SEQ              09662376
096624             ELSE                                                 09662476
096630                SET ASC-LIST-BY-DEFN  TO TRUE                     09663008
096640                MOVE PC-DEFN-SEQ      TO ASC-ORD-SEQ              09664008
096650             END-IF                                               09665008
096651             END-IF                                               09665176
096652             PERFORM 2050-DELETE-LIST-QUEUE                       09665276
096653             PERFORM 4000-BUILD-INITIAL-PANEL                     09665376
096660                                                                  09666008
096700                                                                  09670000
097300* F6 - FIRST PAGE                                                 09730000
097400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09740000
097500             PERFORM 3200-RESET-ATTRIBUTES                        09750000
097600             MOVE +1               TO PV-TOP-ITEM                 09760000
097700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09770000
097800                                                                  09780000
097900* F7 - PREVIOUS PAGE                                              09790000
098000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09800000
098100             PERFORM 3200-RESET-ATTRIBUTES                        09810000
098200             PERFORM 2110-BROWSE-BACKWARD                         09820000
098300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09830000
098400                                                                  09840000
098500* F8 - NEXT PAGE                                                  09850000
098600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   09860000
098700             PERFORM 3200-RESET-ATTRIBUTES                        09870000
098800             PERFORM 2120-BROWSE-FORWARD                          09880000
098900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09890000
099000                                                                  09900000
099100* ENTER KEY                                                       09910000
099200         WHEN DP020-SRC-AID = DP016-ENTER                         09920000
099300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09930000
099400             IF  PS-ERROR                                         09940000
099500                 CONTINUE                                         09950000
099600             ELSE                                                 09960000
099610                 PERFORM 3200-RESET-ATTRIBUTES                    09961080
099630                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               09963080
099700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09970000
099800             END-IF                                               09980000
099900                                                                  09990000
100000         WHEN OTHER                                               10000000
100100             SET DP013-NO-ROLLBACK                                10010000
100200                 DP013-XCTL-DISPLAY-RESTART                       10020000
100300                 DP013-CICS-ABEND  TO TRUE                        10030000
100400             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    10040000
100500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10050000
100600                                   TO DP013-MESSAGE-TEXT (1)      10060000
100700             PERFORM DP013-0000-PROCESS-ABEND                     10070000
100800     END-EVALUATE.                                                10080000
100900                                                                  10090000
101000******************************************************************10100000
101100** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **10110000
101200** INTER-APPLICATION COMMAREA.                                  **10120000
101300******************************************************************10130000
101400 2110-PREPARE-INTER-APPL-COMM.                                    10140000
101500                                                                  10150000
101600     INITIALIZE CN022-INTER-APPL-COMMAREA.                        10160000
101700                                                                  10170000
101800     MOVE ASC-FUNCTION             TO CN022-FUNCTION.             10180000
101900                                                                  10190000
102000 2115-PREPARE-INTER-APPL-ELEM.                                    10200000
102100                                                                  10210000
102200     INITIALIZE CN022-INTER-APPL-COMMAREA.                        10220000
102300                                                                  10230000
102400     SET  CN022-FUNCTION-NONE       TO TRUE.                      10240000
102500     MOVE CN022-FUNCTION            TO ASC-FUNCTION.              10250000
102800     MOVE ASC-PARM-NAME             TO CN022-PARM-NAME.           10280000
102900     MOVE ASC-PARM-DESC             TO CN022-PARM-DESC.           10290000
103000                                                                  10300000
103100                                                                  10310000
103200*----------------------------------------------------------------*10320000
103300*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10330000
103400*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10340000
103500*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10350000
103600*    MESSAGE.                                                    *10360000
103700*----------------------------------------------------------------*10370000
103800                                                                  10380000
103900 2110-BROWSE-BACKWARD.                                            10390000
104000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10400000
104100         GIVING PV-TOP-ITEM.                                      10410000
104200*                                                                 10420000
104300     IF  ((PV-TOP-ITEM < +1)                                      10430000
104400       OR (PV-TOP-ITEM = +1))                                     10440000
104500         MOVE +1                   TO PV-TOP-ITEM                 10450000
104600*        -- TOP OF LIST --                                        10460000
104700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10470000
104800         SET DP020-MSG-INFORMATIONAL TO TRUE                      10480000
104900     END-IF.                                                      10490000
105000                                                                  10500000
105100 EJECT                                                            10510000
105200*----------------------------------------------------------------*10520000
105300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10530000
105400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *10540000
105500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *10550000
105600*----------------------------------------------------------------*10560000
105700                                                                  10570000
105800 2120-BROWSE-FORWARD.                                             10580000
105900                                                                  10590000
106000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10600000
106100         GIVING PV-TOP-ITEM.                                      10610000
106200     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   10620000
106300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10630000
106400                                   TO PV-TOP-ITEM                 10640000
106500*        -- BOTTOM OF LIST --                                     10650000
106600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10660000
106700         SET DP020-MSG-INFORMATIONAL                              10670000
106800                                   TO TRUE                        10680000
106900     ELSE                                                         10690000
107000         COMPUTE PV-BOTTOM-ITEM =                                 10700000
107100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 10710000
107200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            10720000
107300*            -- BOTTOM OF LIST --                                 10730000
107400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10740000
107500             SET DP020-MSG-INFORMATIONAL                          10750000
107600                                   TO TRUE                        10760000
107700         END-IF                                                   10770000
107800     END-IF.                                                      10780000
107900 EJECT                                                            10790000
108000*----------------------------------------------------------------*10800000
108100*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *10810000
108200*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *10820000
108300*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *10830000
108400*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *10840000
108500*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *10850000
108600*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *10860000
108700*----------------------------------------------------------------*10870000
108800                                                                  10880000
108900 2130-CHECK-FOR-JUMP-BROWSE.                                      10890000
109000     SET PS-NO-ERROR               TO TRUE.                       10900000
109100     IF (ASC-START-ITEM-REQUEST = SPACE)                          10910000
109200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10920000
109300                                   TO PV-TOP-ITEM                 10930000
109400     ELSE                                                         10940000
109500         MOVE ASC-START-ITEM-REQUEST                              10950000
109600                                   TO DP010I-UNEDITED-FIELD       10960000
109700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     10970000
109800         MOVE LENGTH OF ASC-START-ITEM-REQUEST                    10980000
109900                                 TO DP010I-MAXIMUM-DIGITS         10990000
110000         SET DP010I-NEGATIVE-NOT-ALLOWED                          11000000
110100                                   TO TRUE                        11010000
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11021081
263455              USING DP010I-NUMERIC-EDIT-AREA                      11022081
110300                                                                  11030000
110400         IF  NOT DP010I-ERROR-DETECTED                            11040000
110500             MOVE DP010I-NUMERIC-FIELD                            11050000
110600                                   TO  ASC-START-ITEM-REQUEST-N   11060000
110700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11070000
110800                 IF  ASC-START-ITEM-REQUEST-N >                   11080000
110900                                          ASC-NUMBER-OF-ITEMS-READ11090000
111000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11100000
111100                     COMPUTE PV-TOP-ITEM =                        11110000
111200                             ASC-NUMBER-OF-ITEMS-READ             11120000
111300                             - PC-ITEMS-PER-PANEL + 1             11130000
111400                     IF  PV-TOP-ITEM < +1                         11140000
111500                         MOVE +1   TO PV-TOP-ITEM                 11150000
111600                         MOVE PC-TSYMSG-00070                     11160000
111700                                   TO DP020-MSG-NUMBER            11170000
111800                         SET DP020-MSG-INFORMATIONAL              11180000
111900                                   TO TRUE                        11190000
112000                     ELSE                                         11200000
112100                         MOVE  PV-TOP-ITEM                        11210000
112200                           TO  ASC-START-ITEM-REQUEST-N           11220000
112300                     END-IF                                       11230000
112400                 ELSE                                             11240000
112500                     MOVE ASC-START-ITEM-REQUEST-N                11250000
112600                                   TO PV-TOP-ITEM                 11260000
112700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11270000
112800                     COMPUTE PV-BOTTOM-ITEM =                     11280000
112900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11290000
113000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11300000
113100                         SUBTRACT  PV-TOP-ITEM                    11310000
113200                             FROM  ASC-NUMBER-OF-ITEMS-READ       11320000
113300                           GIVING  ASC-ITEMS-DISPLAYED            11330000
113400                         MOVE  ASC-NUMBER-OF-ITEMS-READ           11340000
113500                           TO  PV-BOTTOM-ITEM                     11350000
113600*                        -- BOTTOM OF LIST --                     11360000
113700                         MOVE PC-TSYMSG-00070                     11370000
113800                                   TO DP020-MSG-NUMBER            11380000
113900                         SET DP020-MSG-INFORMATIONAL              11390000
114000                                   TO TRUE                        11400000
114100                     END-IF                                       11410000
114200                 END-IF                                           11420000
114300             ELSE                                                 11430000
114400*                --- VALUE OUT OF RANGE ----                      11440000
114500                 MOVE PC-TSYMSG-00101                             11450000
114600                                   TO DP020-MSG-NUMBER            11460000
114700                 MOVE -1           TO ASTRTITL                    11470000
114800                 SET DP030-SET-CURSOR-APPL-1                      11480000
114900                                   TO TRUE                        11490000
115000                 MOVE DP015-REVERSE                               11500000
115100                                   TO ASTRTITH                    11510000
115200                 MOVE DP015-RED    TO ASTRTITC                    11520000
115300                 MOVE DP015-UNP-NUM-BRT-MDT                       11530000
115400                                   TO ASTRTITA                    11540000
115500                 SET DP020-MSG-FATAL                              11550000
115600                                   TO TRUE                        11560000
115700                 SET PS-ERROR      TO TRUE                        11570000
115800             END-IF                                               11580000
115900                                                                  11590000
116000         ELSE                                                     11600000
116100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11610000
116200             MOVE -1               TO ASTRTITL                    11620000
116300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11630000
116400             MOVE DP015-REVERSE    TO ASTRTITH                    11640000
116500             MOVE DP015-RED        TO ASTRTITC                    11650000
116600             MOVE DP015-UNP-NUM-BRT-MDT                           11660000
116700                                   TO ASTRTITA                    11670000
116800             SET DP020-MSG-FATAL   TO TRUE                        11680000
116900             SET PS-ERROR          TO TRUE                        11690000
117000         END-IF                                                   11700000
117100     END-IF.                                                      11710000
117200 EJECT                                                            11720000
117300*----------------------------------------------------------------*11730000
117400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *11740000
117500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *11750000
117600*----------------------------------------------------------------*11760000
117700 2140-DESELECT-ALL-ITEMS.                                         11770000
117800     MOVE +1                       TO ASC-BLK-SUB.                11780000
117900                                                                  11790000
118000     PERFORM 2141-CLEAR-SELECTED-INDS                             11800000
118100         VARYING ASC-ITEM-SUB                                     11810000
118200         FROM 1 BY 1                                              11820000
118300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11830000
118400                                                                  11840000
118500     ADD +1                        TO ASC-BLK-SUB.                11850000
118600                                                                  11860000
118700     PERFORM 2141-CLEAR-SELECTED-INDS                             11870000
118800         VARYING ASC-ITEM-SUB                                     11880000
118900         FROM 1 BY 1                                              11890000
119000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11900000
119100                                                                  11910000
119200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               11920000
119300                                   TO PV-LIST-ITEM-NUMBER.        11930000
119400                                                                  11940000
119500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11950000
119600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11960000
119700                                                                  11970000
119800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11980000
119900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      11990000
120000         MOVE +1                   TO ASC-BLK-SUB                 12000000
120100                                                                  12010000
120200         PERFORM 5100-WRITE-TEMP-STORAGE                          12020000
120300                                                                  12030000
120400         MOVE +1                   TO PV-BLOCK-NUMBER             12040000
120500                                                                  12050000
120600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12060000
120700             PV-FIRST-BLOCK-IN-ARRAY - 1                          12070000
120800                                                                  12080000
120900         PERFORM                                                  12090000
121000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12100000
121100                                                                  12110000
121200             PERFORM 4410-READ-TEMP-STORAGE                       12120000
121300                                                                  12130000
121400             PERFORM 2141-CLEAR-SELECTED-INDS                     12140000
121500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12150000
121600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12160000
121700                                                                  12170000
121800             PERFORM 5100-WRITE-TEMP-STORAGE                      12180000
121900                                                                  12190000
122000             ADD +1                TO PV-BLOCK-NUMBER             12200000
122100                                                                  12210000
122200         END-PERFORM                                              12220000
122300                                                                  12230000
122400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12240000
122500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12250000
122600                                                                  12260000
122700         PERFORM                                                  12270000
122800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12280000
122900                   ASC-HIGHEST-BLOCK-WRITTEN                      12290000
123000                                                                  12300000
123100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12310000
123200                                   TO PV-BLOCK-NUMBER             12320000
123300                                                                  12330000
123400             PERFORM 4410-READ-TEMP-STORAGE                       12340000
123500                                                                  12350000
123600             PERFORM 2141-CLEAR-SELECTED-INDS                     12360000
123700                 VARYING ASC-ITEM-SUB                             12370000
123800                 FROM 1 BY 1                                      12380000
123900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12390000
124000                                                                  12400000
124100             PERFORM 5100-WRITE-TEMP-STORAGE                      12410000
124200                                                                  12420000
124300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12430000
124400                                                                  12440000
124500         END-PERFORM                                              12450000
124600                                                                  12460000
124700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12470000
124800                                   TO PV-BLOCK-NUMBER             12480000
124900                                                                  12490000
125000         PERFORM 4410-READ-TEMP-STORAGE                           12500000
125100     END-IF.                                                      12510000
125200                                                                  12520000
125300     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.12530000
125400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.12540000
125500     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  12550000
125600                                                                  12560000
125700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12570000
125800                                                                  12580000
125900 EJECT                                                            12590000
126000*----------------------------------------------------------------*12600000
126100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *12610000
126200*----------------------------------------------------------------*12620000
126300                                                                  12630000
126400 2141-CLEAR-SELECTED-INDS.                                        12640000
126500                                                                  12650000
126600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12660000
126700             NOT EQUAL ZERO                                       12670000
126800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12680000
126900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12690000
127000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    12700000
127100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12710000
127200                                   TO TRUE                        12720000
127300         END-IF                                                   12730000
127400     END-IF.                                                      12740000
127500                                                                  12750000
127600 EJECT                                                            12760000
127700*----------------------------------------------------------------*12770000
127800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *12780000
127900*  FOR ALL ITEMS.                                                *12790000
128000*----------------------------------------------------------------*12800000
128100                                                                  12810000
128200 2150-SELECT-ALL-ITEMS.                                           12820000
128300                                                                  12830000
128400     MOVE +1                       TO ASC-BLK-SUB.                12840000
128500                                                                  12850000
128600     PERFORM 2151-SET-SELECTED-INDS                               12860000
128700         VARYING ASC-ITEM-SUB                                     12870000
128800         FROM 1 BY 1                                              12880000
128900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12890000
129000                                                                  12900000
129100     ADD +1                        TO ASC-BLK-SUB.                12910000
129200                                                                  12920000
129300     PERFORM 2151-SET-SELECTED-INDS                               12930000
129400         VARYING ASC-ITEM-SUB                                     12940000
129500         FROM 1 BY 1                                              12950000
129600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12960000
129700                                                                  12970000
129800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12980000
129900                                   TO PV-LIST-ITEM-NUMBER.        12990000
130000                                                                  13000000
130100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13010000
130200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13020000
130300                                                                  13030000
130400* 2/18/00 - BEGIN                                                 13040000
130500     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            13050000
130600         MOVE +1                   TO ASC-BLK-SUB                 13060000
130700                                                                  13070000
130800         PERFORM 5100-WRITE-TEMP-STORAGE                          13080000
130900         MOVE +2                   TO ASC-BLK-SUB                 13090000
131000         PERFORM 5100-WRITE-TEMP-STORAGE                          13100000
131100         MOVE +1                   TO ASC-BLK-SUB                 13110000
131200         MOVE +1                   TO PV-BLOCK-NUMBER             13120000
131300     END-IF.                                                      13130000
131400* 2/18/00 - END                                                   13140000
131500                                                                  13150000
131600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13160000
131700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13170000
131800         MOVE +1                   TO ASC-BLK-SUB                 13180000
131900                                                                  13190000
132000         PERFORM 5100-WRITE-TEMP-STORAGE                          13200000
132100                                                                  13210000
132200         MOVE +1                   TO PV-BLOCK-NUMBER             13220000
132300                                                                  13230000
132400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13240000
132500             PV-FIRST-BLOCK-IN-ARRAY - 1                          13250000
132600                                                                  13260000
132700         PERFORM                                                  13270000
132800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13280000
132900                                                                  13290000
133000             PERFORM 4410-READ-TEMP-STORAGE                       13300000
133100                                                                  13310000
133200             PERFORM 2151-SET-SELECTED-INDS                       13320000
133300                 VARYING ASC-ITEM-SUB                             13330000
133400                 FROM 1 BY 1                                      13340000
133500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13350000
133600                                                                  13360000
133700             PERFORM 5100-WRITE-TEMP-STORAGE                      13370000
133800                                                                  13380000
133900             ADD +1                TO PV-BLOCK-NUMBER             13390000
134000                                                                  13400000
134100         END-PERFORM                                              13410000
134200                                                                  13420000
134300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13430000
134400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13440000
134500                                                                  13450000
134600         PERFORM                                                  13460000
134700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13470000
134800                   ASC-HIGHEST-BLOCK-WRITTEN                      13480000
134900                                                                  13490000
135000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13500000
135100                                   TO PV-BLOCK-NUMBER             13510000
135200                                                                  13520000
135300             PERFORM 4410-READ-TEMP-STORAGE                       13530000
135400                                                                  13540000
135500             PERFORM 2151-SET-SELECTED-INDS                       13550000
135600                 VARYING ASC-ITEM-SUB                             13560000
135700                 FROM 1 BY 1                                      13570000
135800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13580000
135900                                                                  13590000
136000             PERFORM 5100-WRITE-TEMP-STORAGE                      13600000
136100                                                                  13610000
136200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13620000
136300                                                                  13630000
136400         END-PERFORM                                              13640000
136500                                                                  13650000
136600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13660000
136700                                   TO PV-BLOCK-NUMBER             13670000
136800                                                                  13680000
136900         PERFORM 4410-READ-TEMP-STORAGE                           13690000
137000     END-IF.                                                      13700000
137100                                                                  13710000
137200                                                                  13720000
137300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             13730000
137400                       ASC-NUMBER-OF-SELECTED-ITEMS.              13740000
137500                                                                  13750000
137600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13760000
137700                                                                  13770000
137800 EJECT                                                            13780000
137900*----------------------------------------------------------------*13790000
138000*    MARK EACH ITEM AS BEING SELECTED.                           *13800000
138100*----------------------------------------------------------------*13810000
138200                                                                  13820000
138300 2151-SET-SELECTED-INDS.                                          13830000
138400                                                                  13840000
138500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13850000
138600             NOT EQUAL ZERO                                       13860000
138700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13870000
138800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13880000
138900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        13890000
139000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13900000
139100                               TO  TRUE                           13910000
139200         END-IF                                                   13920000
139300     END-IF.                                                      13930000
139400******************************************************************13940000
139500** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13950000
139600** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13960000
139700******************************************************************13970000
139800 2200-MOVE-SCREEN-TO-COMMAREA.                                    13980000
139900                                                                  13990000
140000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14000000
140100     MOVE +1                       TO PV-SUB.                     14010000
140200*                                                                 14020000
140300     PERFORM 3100-SET-SUBSCRIPTS.                                 14030000
140400     IF  ASTRTITL > ZERO                                          14040000
140500         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14050000
140600     ELSE                                                         14060000
140700         IF  ASTRTITF = DP015-ERASE-EOF                           14070000
140800             INITIALIZE ASC-START-ITEM-REQUEST                    14080000
140900         END-IF                                                   14090000
141000     END-IF.                                                      14100000
141100                                                                  14110000
141200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14120000
141300         VARYING PV-SUB                                           14130000
141400         FROM 1 BY 1                                              14140000
141500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14150000
141600******************************************************************14160000
141700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**14170000
141800******************************************************************14180000
141900 2210-MOVE-LINES-TO-COMMAREA.                                     14190000
142000     IF  MR-SELECTL (PV-SUB) > ZERO                               14200000
142100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14210000
142200         MOVE MR-SELECTI (PV-SUB)                                 14220000
142300                                   TO ASC-TEMP-SELECTED-SW        14230000
142400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14240000
142500     ELSE                                                         14250000
142600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                14260000
142700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     14270000
142800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        14280000
142900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14290000
143000         END-IF                                                   14300000
143100     END-IF.                                                      14310000
143200     ADD +1                        TO ASC-ITEM-SUB.               14320000
143300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        14330000
143400         ADD +1                    TO ASC-BLK-SUB                 14340000
143500         MOVE +1                   TO ASC-ITEM-SUB                14350000
143600     END-IF.                                                      14360000
143700                                                                  14370000
143800                                                                  14380000
143900******************************************************************14390000
144000** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **14400000
144100** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **14410000
144200******************************************************************14420000
144300 3000-EDIT-DATA-IN-COMMAREA.                                      14430000
144400     SET PS-NO-ERROR               TO TRUE.                       14440000
144500     PERFORM 3200-RESET-ATTRIBUTES.                               14450056
144600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     14460000
144700                                                                  14470000
144800*                                                                 14480000
144900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              14490000
145000* EDITTING IS DONE FROM THE BOTTOM UP.                            14500000
145100*                                                                 14510000
145200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14520000
145300         ASC-ITEMS-DISPLAYED - 1.                                 14530000
145400     PERFORM 3100-SET-SUBSCRIPTS.                                 14540000
145500                                                                  14550000
145600     IF  PS-NO-ERROR                                              14560000
145700         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        14570000
145800     END-IF.                                                      14580000
145900                                                                  14590000
146000     IF  PS-NO-ERROR                                              14600000
146100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        14610000
146200     END-IF.                                                      14620000
146300*                                                                 14630000
146400     IF  ((PS-NO-ERROR)                                           14640000
146500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   14650000
146600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    14660000
146700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  14670000
146800     END-IF.                                                      14680000
146900                                                                  14690000
147000*----------------------------------------------------------------*14700000
147100*   3005-EDIT-COMMAREA-BLOCKS                                    *14710000
147200*----------------------------------------------------------------*14720000
147300 3005-EDIT-COMMAREA-BLOCKS.                                       14730000
147400     MOVE +1                       TO PV-BLOCK-NUMBER.            14740000
147500     MOVE +1                       TO ASC-BLK-SUB.                14750000
147600     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               14760000
147700                                                                  14770000
147800     COMPUTE PV-BLOCK-NUMBER  =                                   14780000
147900        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 14790000
148000            PC-ITEMS-PER-PANEL.                                   14800000
148100                                                                  14810000
148200     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          14820000
148300                                                                  14830000
148400     PERFORM                                                      14840000
148500       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          14850000
148600          OR PS-ERROR                                             14860000
148700          OR PS-BLOCK-ERROR                                       14870000
148800                                                                  14880000
148900             COMPUTE PV-ITEMS-HOLD  =                             14890000
149000                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        14900000
149100                     PC-ITEMS-PER-PANEL - 1                       14910000
149200                                                                  14920000
149300             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       14930000
149400                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               14940000
149500                     FROM  PV-ITEMS-HOLD                          14950000
149600                   GIVING  PV-ITEMS-DIFF                          14960000
149700                 SUBTRACT  PV-ITEMS-DIFF                          14970000
149800                     FROM  PC-ITEMS-PER-PANEL                     14980000
149900                   GIVING  PV-ITEMS-HOLD                          14990000
150000                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              15000000
150100                                              ASC-ITEM-SUB        15010000
150200                                              ASC-ITEMS-DISPLAYED 15020000
150300             ELSE                                                 15030000
150400                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              15040000
150500                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        15050000
150600             END-IF                                               15060000
150700                                                                  15070000
150800             PERFORM 3300-EDIT-SELECTIONS                         15080000
150900                     VARYING PV-SUB                               15090000
151000                        FROM PV-SUB BY -1                         15100000
151100                       UNTIL PV-SUB < +1                          15110000
151200                                                                  15120000
151300             MOVE +1               TO ASC-BLK-SUB                 15130000
151400                                                                  15140000
151500             PERFORM 5105-REWRITE-ASC-LISTQ                       15150000
151600                                                                  15160000
151700             MOVE +1                TO ASC-BLK-SUB                15170000
151800                                                                  15180000
151900             IF  PS-BLOCK-ERROR                                   15190000
152000                 SET  PS-ERROR     TO TRUE                        15200000
152100                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        15210000
152200                                   TO PV-TOP-ITEM                 15220000
152300             ELSE                                                 15230000
152400                 ADD  +1           TO PV-BLOCK-NUMBER             15240000
152500                 IF  PV-BLOCK-NUMBER >                            15250000
152600                     ASC-HIGHEST-BLOCK-WRITTEN                    15260000
152700                     MOVE +2       TO ASC-BLK-SUB                 15270000
152800                     PERFORM 4410-READ-TEMP-STORAGE               15280000
152900                     MOVE +1       TO ASC-BLK-SUB                 15290000
153000                 ELSE                                             15300000
153100                     PERFORM 4410-READ-TEMP-STORAGE               15310000
153200                     ADD  +1        TO PV-BLOCK-NUMBER            15320000
153300                     MOVE +2        TO ASC-BLK-SUB                15330000
153400                     PERFORM 4410-READ-TEMP-STORAGE               15340000
153500                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            15350000
153600                     MOVE +1        TO ASC-BLK-SUB                15360000
153700                 END-IF                                           15370000
153800             END-IF                                               15380000
153900     END-PERFORM.                                                 15390000
154000                                                                  15400000
154100     IF  PV-ORIGINAL-BLOCK  = +1    OR                            15410000
154200         PS-ERROR                   OR                            15420000
154300         PS-BLOCK-ERROR                                           15430000
154400         CONTINUE                                                 15440000
154500     ELSE                                                         15450000
154600         MOVE +1                 TO PV-BLOCK-NUMBER               15460000
154700         MOVE +1                 TO ASC-BLK-SUB                   15470000
154800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  15480000
154900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           15490000
155000         PERFORM 4410-READ-TEMP-STORAGE                           15500000
155100                                                                  15510000
155200         PERFORM                                                  15520000
155300           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              15530000
155400              OR PS-ERROR                                         15540000
155500              OR PS-BLOCK-ERROR                                   15550000
155600                                                                  15560000
155700                 COMPUTE PV-ITEMS-HOLD  =                         15570000
155800                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    15580000
155900                         PC-ITEMS-PER-PANEL - 1                   15590000
156000                                                                  15600000
156100                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     15610000
156200                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           15620000
156300                         FROM  PV-ITEMS-HOLD                      15630000
156400                       GIVING  PV-ITEMS-DIFF                      15640000
156500                     SUBTRACT  PV-ITEMS-DIFF                      15650000
156600                         FROM  PC-ITEMS-PER-PANEL                 15660000
156700                       GIVING  PV-ITEMS-HOLD                      15670000
156800                         MOVE  PV-ITEMS-HOLD TO PV-SUB            15680000
156900                                                ASC-ITEM-SUB      15690000
157000                                               ASC-ITEMS-DISPLAYED15700000
157100                 ELSE                                             15710000
157200                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          15720000
157300                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    15730000
157400                 END-IF                                           15740000
157500                                                                  15750000
157600                 PERFORM 3300-EDIT-SELECTIONS                     15760000
157700                         VARYING PV-SUB                           15770000
157800                            FROM PV-SUB BY -1                     15780000
157900                           UNTIL PV-SUB < +1                      15790000
158000                                                                  15800000
158100                 MOVE +1               TO ASC-BLK-SUB             15810000
158200                                                                  15820000
158300                 PERFORM 5105-REWRITE-ASC-LISTQ                   15830000
158400                                                                  15840000
158500                 MOVE +1                TO ASC-BLK-SUB            15850000
158600                                                                  15860000
158700                 IF  PS-BLOCK-ERROR                               15870000
158800                     SET  PS-ERROR     TO TRUE                    15880000
158900                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    15890000
159000                                       TO PV-TOP-ITEM             15900000
159100                 ELSE                                             15910000
159200                     ADD  +1            TO PV-BLOCK-NUMBER        15920000
159300                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      15930000
159400                         MOVE +2        TO ASC-BLK-SUB            15940000
159500                         PERFORM 4410-READ-TEMP-STORAGE           15950000
159600                         MOVE +1        TO ASC-BLK-SUB            15960000
159700                     ELSE                                         15970000
159800                         PERFORM 4410-READ-TEMP-STORAGE           15980000
159900                         ADD  +1        TO PV-BLOCK-NUMBER        15990000
160000                         MOVE +2        TO ASC-BLK-SUB            16000000
160100                         PERFORM 4410-READ-TEMP-STORAGE           16010000
160200                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        16020000
160300                         MOVE +1        TO ASC-BLK-SUB            16030000
160400                     END-IF                                       16040000
160500                 END-IF                                           16050000
160600     END-PERFORM.                                                 16060000
160700                                                                  16070000
160800                                                                  16080000
160900*----------------------------------------------------------------*16090000
161000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *16100000
161100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*16110000
161200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *16120000
161300*                                                                *16130000
161400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *16140000
161500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *16150000
161600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *16160000
161700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *16170000
161800*----------------------------------------------------------------*16180000
161900                                                                  16190000
162000 3100-SET-SUBSCRIPTS.                                             16200000
162100                                                                  16210000
162200     COMPUTE ASC-ITEM-SUB =                                       16220000
162300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        16230000
162400                                                                  16240000
162500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16250000
162600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16260000
162700                                                                  16270000
162800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16280000
162900     ELSE                                                         16290000
163000         MOVE +1                     TO ASC-BLK-SUB               16300000
163100     END-IF.                                                      16310000
163200******************************************************************16320000
163300** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16330000
163400******************************************************************16340000
163500                                                                  16350000
163600 3200-RESET-ATTRIBUTES.                                           16360000
163700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16370000
163800     MOVE DP015-GREEN              TO ASTRTITC.                   16380000
163900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16390000
164000*                                                                 16400000
164100     PERFORM                                                      16410000
164200         VARYING PV-SUB                                           16420000
164300         FROM 1 BY 1                                              16430000
164400         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        16440000
164500         MOVE DP015-UNP-ALP-NOR-OFF                               16450000
164600                                   TO MR-SELECTA (PV-SUB)         16460000
164700         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         16470000
164800         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         16480000
164801                                                                  16480170
164810             IF  PV-SUB  >  ASC-ITEMS-DISPLAYED  AND              16481070
164820                 NOT DP020-FK-PREV-PAGE(DP020-SRC-AID)            16482070
164830                 CONTINUE                                         16483070
164840             ELSE                                                 16484070
164850                 MOVE DP015-UNP-ALP-NOR-OFF                       16485070
164860                                   TO MR-SELECTA (PV-SUB)         16486070
164880                 MOVE DP015-GREEN  TO MR-SELECTC (PV-SUB)         16488070
164898                 MOVE DP015-UNDERLINE                             16489870
164899                                   TO MR-SELECTH (PV-SUB)         16489970
164901             END-IF                                               16490170
164910     END-PERFORM.                                                 16491000
165000******************************************************************16500000
165100** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **16510000
165200** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **16520000
165300** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **16530000
165400** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **16540000
165500******************************************************************16550000
165600 3300-EDIT-SELECTIONS.                                            16560000
165700     EVALUATE TRUE                                                16570000
165800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16580000
165900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16590000
166000                 CONTINUE                                         16600000
166100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16610000
166200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16620000
166300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16630000
166400                 MOVE ASC-TEMP-SELECTED-SW                        16640000
166500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16650000
166600                                TO ASC-SELECTED-SW                16660000
166700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16670000
166800             END-IF                                               16680000
166900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16690000
167000                 = SPACE                                          16700000
167100             EVALUATE TRUE                                        16710000
167200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16720000
167300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16730000
167400                     MOVE SPACE TO ASC-SELECTED-SW                16740000
167500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16750000
167600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16760000
167700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    16770000
167800                     MOVE SPACE TO ASC-SELECTED-SW                16780000
167900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16790000
168000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          16800000
168100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      16810000
168200                     MOVE SPACE TO ASC-SELECTED-SW                16820000
168300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16830000
168400             END-EVALUATE                                         16840000
168500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16850000
168600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16860000
168700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16870000
168800             END-IF                                               16880000
168900             PERFORM 3310-EDIT-RANGE                              16890000
169000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             16900000
169100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16910000
169200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16920000
169300             END-IF                                               16930000
169400             PERFORM 3310-EDIT-RANGE                              16940000
169500         WHEN OTHER                                               16950000
169600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           16960000
169700             SET DP020-MSG-FATAL    TO TRUE                       16970000
169800             MOVE -1                TO MR-SELECTL (PV-SUB)        16980000
169900             SET DP030-SET-CURSOR-APPL-1                          16990000
170000                                    TO TRUE                       17000000
170100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        17010000
170200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        17020000
170300             SET PS-ERROR TO TRUE                                 17030000
170400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17040000
170500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17050000
170600                 MOVE SPACE         TO ASC-SELECTED-SW            17060000
170700                                        (ASC-BLK-SUB ASC-ITEM-SUB)17070000
170800             END-IF                                               17080000
170900     END-EVALUATE.                                                17090000
171000                                                                  17100000
171100     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 17110000
171200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               17120000
171300     IF  ASC-ITEM-SUB < 1                                         17130000
171400         SUBTRACT +1 FROM ASC-BLK-SUB                             17140000
171500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                17150000
171600     END-IF.                                                      17160000
171700******************************************************************17170000
171800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **17180000
171900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **17190000
172000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**17200000
172100** THE ENDING.                                                  **17210000
172200******************************************************************17220000
172300 3310-EDIT-RANGE.                                                 17230000
172400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                17240000
172500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   17250000
172600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)17260000
172700                                   TO ASC-SELECTED-SW             17270000
172800                                        (ASC-BLK-SUB ASC-ITEM-SUB)17280000
172900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 17290000
173000         ELSE                                                     17300000
173100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     17310000
173200                 CONTINUE                                         17320000
173300             ELSE                                                 17330000
173400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        17340000
173500                 MOVE PC-TSYMSG-00054                             17350000
173600                                   TO DP020-MSG-NUMBER            17360000
173700                 SET DP020-MSG-FATAL                              17370000
173800                                   TO TRUE                        17380000
173900                 MOVE -1           TO MR-SELECTL (PV-SUB)         17390000
174000                 SET DP030-SET-CURSOR-APPL-1                      17400000
174100                                   TO TRUE                        17410000
174200                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         17420000
174300                 MOVE DP015-UNDERLINE                             17430000
174400                                   TO MR-SELECTH (PV-SUB)         17440000
174500                 SET PS-ERROR      TO TRUE                        17450000
174600             END-IF                                               17460000
174700         END-IF                                                   17470000
174800     ELSE                                                         17480000
174900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     17490000
175000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17500000
175100                                   TO ASC-SELECTED-SW             17510000
175200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17520000
175300             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   17530000
175400         ELSE                                                     17540000
175500             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17550000
175600                 CONTINUE                                         17560000
175700             ELSE                                                 17570000
175800*                -- ONLY ONE END-OF-RANGE ALLOWED --              17580000
175900                 MOVE PC-TSYMSG-00055                             17590000
176000                                   TO DP020-MSG-NUMBER            17600000
176100                 SET DP020-MSG-FATAL                              17610000
176200                                   TO TRUE                        17620000
176300                 MOVE -1           TO MR-SELECTL (PV-SUB)         17630000
176400                 SET DP030-SET-CURSOR-APPL-1                      17640000
176500                                   TO TRUE                        17650000
176600                 SET PS-ERROR      TO TRUE                        17660000
176700             END-IF                                               17670000
176800         END-IF                                                   17680000
176900     END-IF.                                                      17690000
177000                                                                  17700000
177100******************************************************************17710000
177200** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **17720000
177300** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **17730000
177400******************************************************************17740000
177500 3400-CHECK-RANGE-SEQUENCE.                                       17750000
177600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       17760000
177700       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      17770000
177800       AND  ASC-START-OF-SELECTED-RANGE >                         17780000
177900                                         ASC-END-OF-SELECTED-RANGE17790000
178000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                17800000
178100         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 17810000
178200         SET DP020-MSG-FATAL TO TRUE                              17820000
178300         SET PS-ERROR TO TRUE                                     17830000
178400         PERFORM 3410-POSITION-AT-ERROR                           17840000
178500     END-IF.                                                      17850000
178600                                                                  17860000
178700                                                                  17870000
178800******************************************************************17880000
178900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **17890000
179000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **17900000
179100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **17910000
179200******************************************************************17920000
179300 3410-POSITION-AT-ERROR.                                          17930000
179400     SET DP030-SET-CURSOR-APPL-1                                  17940000
179500                                   TO TRUE.                       17950000
179600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 17960000
179700                    - PV-TOP-ITEM + 1.                            17970000
179800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17980000
179900         CONTINUE                                                 17990000
180000     ELSE                                                         18000000
180100         MOVE -1                   TO MR-SELECTL (PV-SUB)         18010000
180200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18020000
180300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18030000
180400     END-IF.                                                      18040000
180500*                                                                 18050000
180600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   18060000
180700                    - PV-TOP-ITEM + 1.                            18070000
180800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18080000
180900         CONTINUE                                                 18090000
181000     ELSE                                                         18100000
181100         MOVE -1                   TO MR-SELECTL (PV-SUB)         18110000
181200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18120000
181300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18130000
181400     END-IF.                                                      18140000
181500 EJECT                                                            18150000
181600*----------------------------------------------------------------*18160000
181700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *18170000
181800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *18180000
181900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *18190000
182000*----------------------------------------------------------------*18200000
182100                                                                  18210000
182200 3500-MARK-RANGE-AS-SELECTED.                                     18220000
182300     MOVE +1                       TO  ASC-BLK-SUB.               18230000
182400     PERFORM 3510-MARK-SELECTED-INDS                              18240000
182500         VARYING ASC-ITEM-SUB                                     18250000
182600         FROM 1 BY 1                                              18260000
182700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18270000
182800                                                                  18280000
182900     ADD +1                        TO ASC-BLK-SUB.                18290000
183000     PERFORM 3510-MARK-SELECTED-INDS                              18300000
183100         VARYING ASC-ITEM-SUB                                     18310000
183200         FROM 1 BY 1                                              18320000
183300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18330000
183400                                                                  18340000
183500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18350000
183600                                   TO  PV-LIST-ITEM-NUMBER.       18360000
183700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18370000
183800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         18380000
183900               PC-ITEMS-PER-PANEL).                               18390000
184000                                                                  18400000
184100     MOVE ASC-START-OF-SELECTED-RANGE                             18410000
184200                                   TO PV-START-OF-SELECTED-RANGE. 18420000
184300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            18430000
184400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  18440000
184500               PC-ITEMS-PER-PANEL).                               18450000
184600                                                                  18460000
184700     MOVE ASC-END-OF-SELECTED-RANGE                               18470000
184800                                   TO  PV-END-OF-SELECTED-RANGE.  18480000
184900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             18490000
185000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    18500000
185100               PC-ITEMS-PER-PANEL).                               18510000
185200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             18520000
185300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             18530000
185400                                                                  18540000
185500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18550000
185600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18560000
185700         MOVE +1                   TO ASC-BLK-SUB                 18570000
185800         PERFORM 5100-WRITE-TEMP-STORAGE                          18580000
185900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18590000
186000             PV-FIRST-BLOCK-IN-ARRAY - 1                          18600000
186100                                                                  18610000
186200         PERFORM                                                  18620000
186300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      18630000
186400                   PV-PREV-BLOCK-IN-ARRAY                         18640000
186500             MOVE PV-FIRST-BLOCK-IN-RANGE                         18650000
186600                                   TO PV-BLOCK-NUMBER             18660000
186700             PERFORM 4410-READ-TEMP-STORAGE                       18670000
186800             PERFORM 3510-MARK-SELECTED-INDS                      18680000
186900                 VARYING ASC-ITEM-SUB                             18690000
187000                 FROM 1 BY 1                                      18700000
187100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18710000
187200             PERFORM 5100-WRITE-TEMP-STORAGE                      18720000
187300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     18730000
187400         END-PERFORM                                              18740000
187500                                                                  18750000
187600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18760000
187700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18770000
187800         PERFORM                                                  18780000
187900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18790000
188000                   PV-LAST-BLOCK-IN-RANGE                         18800000
188100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18810000
188200                                   TO PV-BLOCK-NUMBER             18820000
188300             PERFORM 4410-READ-TEMP-STORAGE                       18830000
188400             PERFORM 3510-MARK-SELECTED-INDS                      18840000
188500                 VARYING ASC-ITEM-SUB                             18850000
188600                 FROM 1 BY 1                                      18860000
188700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18870000
188800             PERFORM 5100-WRITE-TEMP-STORAGE                      18880000
188900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18890000
189000         END-PERFORM                                              18900000
189100                                                                  18910000
189200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18920000
189300                                   TO PV-BLOCK-NUMBER             18930000
189400         PERFORM 4410-READ-TEMP-STORAGE                           18940000
189500     END-IF.                                                      18950000
189600                                                                  18960000
189700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 18970000
189800                                      ASC-END-OF-SELECTED-RANGE.  18980000
189900                                                                  18990000
190000 EJECT                                                            19000000
190100*----------------------------------------------------------------*19010000
190200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *19020000
190300*----------------------------------------------------------------*19030000
190400                                                                  19040000
190500 3510-MARK-SELECTED-INDS.                                         19050000
190600                                                                  19060000
190700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19070000
190800                                ASC-ITEM-SUB) >                   19080000
190900         ASC-START-OF-SELECTED-RANGE)                             19090000
191000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19100000
191100                                ASC-ITEM-SUB) =                   19110000
191200         ASC-START-OF-SELECTED-RANGE)                             19120000
191300                                                                  19130000
191400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19140000
191500                                    ASC-ITEM-SUB) <               19150000
191600             ASC-END-OF-SELECTED-RANGE)                           19160000
191700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19170000
191800                                    ASC-ITEM-SUB) =               19180000
191900             ASC-END-OF-SELECTED-RANGE)                           19190000
192000                                                                  19200000
192100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19210000
192200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   19220000
192300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   19230000
192400                               TO TRUE                            19240000
192500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              19250000
192600                               TO TRUE                            19260000
192700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    19270000
192800             END-IF                                               19280000
192900         END-IF                                                   19290000
193000     END-IF.                                                      19300000
193100                                                                  19310000
193200                                                                  19320000
193300*----------------------------------------------------------------*19330000
193400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *19340000
193500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *19350000
193600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *19360000
193700*    DISPLAY THE PANEL TO USER.                                  *19370000
193800*----------------------------------------------------------------*19380000
193900                                                                  19390000
194000 4000-BUILD-INITIAL-PANEL.                                        19400000
194100                                                                  19410000
194200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            19420000
194300                                 ASC-BLOCK-ENTRIES (2).           19430000
194400     MOVE +1                 TO  ASC-BLK-SUB.                     19440000
194500     SET ASC-ITEMS-LEFT-ON-DB                                     19450000
194600                             TO TRUE.                             19460000
194700                                                                  19470000
194800     MOVE +0                 TO ASC-ITEM-SUB                      19480000
194900                                ASC-NUMBER-OF-ITEMS-READ          19490000
195000                                ASC-NUMBER-OF-SELECTED-ITEMS      19500000
195100                                ASC-HIGHEST-BLOCK-WRITTEN         19510000
195200                                ASC-START-OF-SELECTED-RANGE       19520000
195300                                ASC-END-OF-SELECTED-RANGE         19530000
195400                                ASC-ITEM-AT-TOP-OF-PANEL.         19540000
195500                                                                  19550000
195600                                                                  19560000
195700     PERFORM 4100-PREPARE-CURSOR                                  19570000
195800                                                                  19580000
195900     PERFORM 4010-OPEN-CURSOR.                                    19590000
196000                                                                  19600000
196100     PERFORM 4300-READ-ITEMS-FROM-DB.                             19610000
196200                                                                  19620000
196300     PERFORM 4020-CLOSE-CURSOR.                                   19630000
196400                                                                  19640000
196500     MOVE +1                   TO  PV-TOP-ITEM.                   19650000
196600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          19660000
196700         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    19670000
196800         SET DP020-MSG-FATAL   TO  TRUE                           19680000
196900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               19690000
197000     ELSE                                                         19700000
197100         MOVE -1               TO MR-SELECTL (1)                  19710000
197200         SET DP030-SET-CURSOR-APPL-1                              19720000
197300                               TO TRUE                            19730000
197400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     19740000
197500     END-IF.                                                      19750000
197600 EJECT                                                            19760000
197700*----------------------------------------------------------------*19770000
197800* OPEN THE TMESSAGE CURSOR.                                      *19780000
197900*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *19790000
198000*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *19800000
198100*   USER.                                                        *19810000
198200*----------------------------------------------------------------*19820000
198300                                                                  19830000
198400 4010-OPEN-CURSOR.                                                19840000
198500     PERFORM                                                      19850000
198600         WITH TEST AFTER                                          19860000
198700         VARYING PV-RETRY-COUNTER                                 19870000
198800         FROM 1 BY 1                                              19880000
198900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19890000
199000                   OR (SQLCODE = ZERO))                           19900000
199100                                                                  19910000
199200              MOVE 'CURSOR:  ATTR-DEFN-CSR   '                    19920000
199300                                        TO DP013-MESSAGE-TEXT (2) 19930000
199400                                                                  19940000
199410             IF  ASC-LIST-BY-UNIQUE-ELEM                          19941076
199411                 EXEC SQL                                         19941176
199412                      OPEN ATTR-UNIQUE-ELEM-CSR                   19941276
199413                 END-EXEC                                         19941376
199414             ELSE                                                 19941476
199420                 IF  ASC-LIST-BY-DEFN                             19942076
199500                     EXEC SQL                                     19950076
199600                          OPEN ATTR-ELEM-DEFN-SEQ-CSR             19960076
199700                     END-EXEC                                     19970076
199710                 ELSE                                             19971076
199720                     EXEC SQL                                     19972076
199730                          OPEN ATTR-ELEM-ELEM-SEQ-CSR             19973076
199740                     END-EXEC                                     19974076
199750                 END-IF                                           19975076
199760             END-IF                                               19976076
199800                                                                  19980000
199900         EVALUATE TRUE                                            19990000
200000             WHEN SQLCODE = ZERO                                  20000000
200100             WHEN SQLCODE = -904                                  20010000
200200             WHEN SQLCODE = -913                                  20020000
200300                 CONTINUE                                         20030000
200400             WHEN SQLWARN0 NOT = SPACES                           20040000
200500             WHEN SQLCODE < ZERO                                  20050000
200600             WHEN SQLCODE > ZERO                                  20060000
200700                 MOVE '4010-OPEN-CURSOR'                          20070000
200800                                   TO DP013-PARAGRAPH             20080000
200900                 MOVE 'OPEN ATTR-DEFN CURSOR - '                  20090000
201000                                   TO DP013-MESSAGE-TEXT (1)      20100000
201100                 MOVE SQLCA        TO DP013-SQLCA                 20110000
201200                 MOVE 'WST_ATTR_DEFN' TO DP013-DB2-TABLE-NAME (1) 20120000
201300                 SET DP013-DB2-ABEND                              20130000
201400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20140000
201500                 PERFORM DP013-0000-PROCESS-ABEND                 20150000
201600         END-EVALUATE                                             20160000
201700     END-PERFORM.                                                 20170000
201800*                                                                 20180000
201900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20190000
202000         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             20200000
202100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   20210000
202200                                   TO DP013-MESSAGE-TEXT (1)      20220000
202300         MOVE SQLCA                TO DP013-SQLCA                 20230000
202400         MOVE 'WST_ATTR_DEFN'      TO DP013-DB2-TABLE-NAME (1)    20240000
202500         SET DP013-DB2-ABEND                                      20250000
202600             DP013-XCTL-DISPLAY-RESTART                           20260000
202700                                   TO TRUE                        20270000
202800         PERFORM DP013-0000-PROCESS-ABEND                         20280000
202900     END-IF.                                                      20290000
203000                                                                  20300000
203100                                                                  20310000
203200*----------------------------------------------------------------*20320000
203300* CLOSE THE TMESSAGE CURSOR.                                     *20330000
203400*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *20340000
203500*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *20350000
203600*   USER.                                                        *20360000
203700*----------------------------------------------------------------*20370000
203800                                                                  20380000
203900 4020-CLOSE-CURSOR.                                               20390000
203910                                                                  20391008
203911     IF  ASC-LIST-BY-UNIQUE-ELEM                                  20391176
203912         EXEC SQL                                                 20391276
203913             CLOSE ATTR-UNIQUE-ELEM-CSR                           20391376
203914         END-EXEC                                                 20391476
203915     ELSE                                                         20391576
203920         IF  ASC-LIST-BY-DEFN                                     20392076
204000             EXEC SQL                                             20400076
204100                 CLOSE ATTR-ELEM-DEFN-SEQ-CSR                     20410076
204200             END-EXEC                                             20420076
204210         ELSE                                                     20421076
204220             EXEC SQL                                             20422076
204230                 CLOSE ATTR-ELEM-ELEM-SEQ-CSR                     20423076
204240             END-EXEC                                             20424076
204250         END-IF                                                   20425076
204260     END-IF                                                       20426076
204300*                                                                 20430000
204400     EVALUATE TRUE                                                20440000
204500         WHEN SQLCODE = ZERO                                      20450000
204600             CONTINUE                                             20460000
204700         WHEN SQLWARN0 NOT = SPACES                               20470000
204800         WHEN SQLCODE < ZERO                                      20480000
204900         WHEN SQLCODE > ZERO                                      20490000
205000             MOVE '4020-CLOSE-CURSOR'                             20500000
205100                               TO DP013-PARAGRAPH                 20510000
205200             MOVE 'CLOSE ATTR_DEFN CURSOR '                       20520000
205300                                  TO DP013-MESSAGE-TEXT (1)       20530000
205400             MOVE SQLCA           TO DP013-SQLCA                  20540000
205500             MOVE 'WST_ATTR_DEFN' TO DP013-DB2-TABLE-NAME (1)     20550000
205600             SET DP013-DB2-ABEND                                  20560000
205700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20570000
205800             PERFORM DP013-0000-PROCESS-ABEND                     20580000
205900     END-EVALUATE.                                                20590000
206000                                                                  20600000
206100                                                                  20610000
206200*----------------------------------------------------------------*20620000
206300*    SET UP THE HOST VARIABLES.                                  *20630000
206400*----------------------------------------------------------------*20640000
206500                                                                  20650000
206600 4100-PREPARE-CURSOR.                                             20660000
206700                                                                  20670000
206800     MOVE ASC-PARM-NAME        TO  DK-ATTR-DEFN.                  20680000
206810     MOVE ASC-UNIQUE-ELEM-SEQ  TO  DK-ATTR-UNIQUE-SEQ.            20681076
206900                                                                  20690000
207400                                                                  20740000
207500*----------------------------------------------------------------*20750000
207600*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20760000
207700*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20770000
207800*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20780000
207900*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20790000
208000*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20800000
208100*                                                                *20810000
208200*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20820000
208300*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20830000
208400*    UPON INITIALIZATION.                                        *20840000
208500*----------------------------------------------------------------*20850000
208600 4300-READ-ITEMS-FROM-DB.                                         20860000
208700                                                                  20870000
208800     PERFORM                                                      20880000
208900         VARYING PV-READ-COUNT                                    20890000
209000         FROM 1 BY 1                                              20900000
209100         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20910000
209200            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20920000
209300                                                                  20930000
209400         PERFORM 4310-FETCH                                       20940000
209401                                                                  20940113
209600         IF  ASC-ITEMS-LEFT-ON-DB                                 20960000
209700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20970000
209800                 ADD +1            TO ASC-ITEM-SUB                20980000
209900             ELSE                                                 20990000
210000                 ADD +1            TO ASC-BLK-SUB                 21000000
210100                 MOVE +1           TO ASC-ITEM-SUB                21010000
210200                                                                  21020000
210300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21030000
210400                     MOVE +1       TO ASC-BLK-SUB                 21040000
210500                     SET ASC-BLOCK-MODIFIED (1)                   21050000
210600                                   TO TRUE                        21060000
210700                     PERFORM 5100-WRITE-TEMP-STORAGE              21070000
210800                     MOVE ASC-BLOCK-ENTRIES                       21080000
210900                               (PC-MAX-BLOCKS-IN-ARRAY)           21090000
211000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21100000
211100                     ADD +1        TO ASC-BLK-SUB                 21110000
211200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21120000
211300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21130000
211400                                   TO TRUE                        21140000
211500                 END-IF                                           21150000
211600             END-IF                                               21160000
211700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    21170000
211800             MOVE ASC-NUMBER-OF-ITEMS-READ                        21180000
211900                                   TO ASC-LIST-ITEM-NUMBER        21190000
212000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21200000
212001                                                                  21200114
212010             MOVE  SPACES          TO ASC-ELEM-TEXT               21201014
212020                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21202014
212030                                      ASC-ELEM-TMST               21203014
212040                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21204014
212050             MOVE  ZEROES          TO ASC-ELEM-NBR                21205014
212060                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21206014
212100                                                                  21210000
212200             MOVE  WST00010-ATTR-DEFN-SEQ-NBR TO  ASC-DEFN-SEQ    21220005
212300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21230005
212400             MOVE  WST00010-ATTR-ELEM-SEQ-NBR TO  ASC-ELEM-SEQ    21240005
212500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21250005
212600                                                                  21260005
212700             IF  PV-NULL-ELEM-TXT  =  -1                          21270005
212800                 MOVE  SPACES              TO ASC-ELEM-TEXT       21280005
212900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21290005
213000                 MOVE  'Y'                 TO ASC-ELEM-TEXT-NULL  21300005
213100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21310005
213200             ELSE                                                 21320005
213300                 MOVE  WS-ATTR-ELEM-TXT-TEXT  TO  ASC-ELEM-TEXT   21330005
213400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21340005
213500             END-IF                                               21350005
213600                                                                  21360005
213700             IF  PV-NULL-ELEM-TMST  =  -1                         21370005
213800                 MOVE  SPACES              TO ASC-ELEM-TMST       21380005
213900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21390005
214000                 MOVE  'Y'                 TO ASC-ELEM-TMST-NULL  21400005
214100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21410005
214200             ELSE                                                 21420005
214300                 MOVE  WST00010-ATTR-ELEM-TMST TO  ASC-ELEM-TMST  21430005
214400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21440005
214500             END-IF                                               21450005
214600                                                                  21460005
214700             IF  PV-NULL-ELEM-NBR  =  -1                          21470005
214800                 MOVE  ZEROES              TO ASC-ELEM-NBR        21480005
214900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21490005
215000                 MOVE  'Y'                 TO ASC-ELEM-NBR-NULL   21500005
215100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21510005
215110             ELSE                                                 21511005
215120                 MOVE  WST00010-ATTR-ELEM-NBR  TO  ASC-ELEM-NBR   21512005
215130                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21513005
215140             END-IF                                               21514005
215150                                                                  21515005
215160             MOVE  WST00009-DATYP-CDE    TO ASC-DATA-TYPE         21516005
215170                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21517005
215180             MOVE  WST00009-ATTR-DEFN-DESC                        21518005
215190                                         TO ASC-DEFN-DESCR        21519005
215191                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21519105
215192                                                                  21519205
215200                                                                  21520000
215300         END-IF                                                   21530000
215400     END-PERFORM.                                                 21540000
215500                                                                  21550000
215600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21560000
215700         MOVE +1               TO ASC-BLK-SUB                     21570000
215800         PERFORM 5100-WRITE-TEMP-STORAGE                          21580000
215900         ADD +1                TO ASC-BLK-SUB                     21590000
216000         PERFORM 5100-WRITE-TEMP-STORAGE                          21600000
216100                                                                  21610000
216200         MOVE 1                TO ASC-BLK-SUB                     21620000
216300                                  PV-BLOCK-NUMBER                 21630000
216400         PERFORM 4410-READ-TEMP-STORAGE                           21640000
216500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21650000
216600             MOVE 2            TO ASC-BLK-SUB                     21660000
216700                                  PV-BLOCK-NUMBER                 21670000
216800             PERFORM 4410-READ-TEMP-STORAGE                       21680000
216900         END-IF                                                   21690000
217000     END-IF.                                                      21700000
217100                                                                  21710049
217110                                                                  21711049
217200*----------------------------------------------------------------*21720000
217300*    FETCH THE MESSAGE CURSOR.                                   *21730000
217400*----------------------------------------------------------------*21740000
217600 4310-FETCH.                                                      21760000
217610                                                                  21761000
217611     MOVE  SPACES  TO  PV-ELEM-TXT-WORK                           21761118
217612                                                                  21761218
217613     IF  ASC-LIST-BY-UNIQUE-ELEM                                  21761376
217614         EXEC SQL                                                 21761476
217615              FETCH ATTR-UNIQUE-ELEM-CSR                          21761576
217617               INTO                                               21761776
217618                    :WST00010-INTGRTN-TYP-CDE                     21761876
217619                  , :WST00010-ATTR-DEFN-SEQ-NBR                   21761976
217620                  , :WST00010-ATTR-ELEM-SEQ-NBR                   21762076
217621                  , :PV-ELEM-TXT-WORK        :PV-NULL-ELEM-TXT    21762176
217622                  , :WST00010-ATTR-ELEM-TMST :PV-NULL-ELEM-TMST   21762276
217623                  , :WST00010-ATTR-ELEM-NBR  :PV-NULL-ELEM-NBR    21762376
217624                  , :WST00009-DATYP-CDE                           21762476
217625                  , :WST00009-ATTR-DEFN-DESC                      21762576
217626         END-EXEC                                                 21762676
217627     ELSE                                                         21762776
217630     IF  ASC-LIST-BY-DEFN                                         21763008
217700         EXEC SQL                                                 21770008
217800              FETCH ATTR-ELEM-DEFN-SEQ-CSR                        21780008
217900               INTO                                               21790008
218000                    :WST00010-INTGRTN-TYP-CDE                     21800008
218100                  , :WST00010-ATTR-DEFN-SEQ-NBR                   21810008
218200                  , :WST00010-ATTR-ELEM-SEQ-NBR                   21820008
218300                  , :PV-ELEM-TXT-WORK        :PV-NULL-ELEM-TXT    21830008
218400                  , :WST00010-ATTR-ELEM-TMST :PV-NULL-ELEM-TMST   21840008
218500                  , :WST00010-ATTR-ELEM-NBR  :PV-NULL-ELEM-NBR    21850008
218600                  , :WST00009-DATYP-CDE                           21860008
218700                  , :WST00009-ATTR-DEFN-DESC                      21870008
218710         END-EXEC                                                 21871008
218720     ELSE                                                         21872008
218730         EXEC SQL                                                 21873008
218740              FETCH ATTR-ELEM-ELEM-SEQ-CSR                        21874008
218750               INTO                                               21875008
218760                    :WST00010-INTGRTN-TYP-CDE                     21876008
218770                  , :WST00010-ATTR-DEFN-SEQ-NBR                   21877008
218780                  , :WST00010-ATTR-ELEM-SEQ-NBR                   21878008
218790                  , :PV-ELEM-TXT-WORK        :PV-NULL-ELEM-TXT    21879008
218800                  , :WST00010-ATTR-ELEM-TMST :PV-NULL-ELEM-TMST   21880008
218810                  , :WST00010-ATTR-ELEM-NBR  :PV-NULL-ELEM-NBR    21881008
218820                  , :WST00009-DATYP-CDE                           21882008
218830                  , :WST00009-ATTR-DEFN-DESC                      21883008
218840         END-EXEC                                                 21884008
218850     END-IF                                                       21885076
218860     END-IF.                                                      21886076
218900                                                                  21890000
219000     EVALUATE TRUE                                                21900000
219100         WHEN SQLCODE = ZERO                                      21910000
219200              CONTINUE                                            21920000
219300                                                                  21930000
219400         WHEN SQLCODE = +100                                      21940000
219500              CONTINUE                                            21950000
219600                                                                  21960000
219700         WHEN SQLWARN0 NOT = SPACE                                21970000
219800         WHEN SQLCODE NOT = ZERO                                  21980000
219900              MOVE '4310-FETCH-CURSOR'                            21990000
220000                               TO DP013-PARAGRAPH                 22000000
220100              MOVE 'FETCH MESSAGE CURSOR'                         22010000
220200                               TO DP013-MESSAGE-TEXT (1)          22020000
220300              MOVE SQLCA       TO DP013-SQLCA                     22030000
220400              SET DP013-DB2-ABEND                                 22040000
220500                               TO TRUE                            22050000
220600              PERFORM DP013-0000-PROCESS-ABEND                    22060000
220700     END-EVALUATE.                                                22070000
220800                                                                  22080000
220900     IF  SQLCODE EQUAL +100                                       22090000
221000         SET ASC-NO-ITEMS-LEFT-ON-DB                              22100000
221100                                   TO TRUE                        22110000
221200     END-IF.                                                      22120000
221300                                                                  22130000
221400                                                                  22140000
221500*----------------------------------------------------------------*22150000
221600* COUNT THE NUMBER OF ROWS ON WST_ATTR_ELEM FOR THE PARM         *22160000
221700*----------------------------------------------------------------*22170000
221800 4320-GET-ELEM-COUNT.                                             22180000
221900                                                                  22190000
222000       EXEC SQL                                                   22200000
222100            SELECT COUNT(*)                                       22210000
222200              INTO :PV-WST00010-ELEM-COUNT                        22220000
222300              FROM WST_ATTR_ELEM                                  22230000
222400             WHERE INTGRTN_TYP_CDE   = :WST00009-INTGRTN-TYP-CDE  22240000
222500               AND ATTR_DEFN_SEQ_NBR = :WST00009-ATTR-DEFN-SEQ-NBR22250000
222600       END-EXEC.                                                  22260000
222700                                                                  22270000
222800                                                                  22280000
222900     EVALUATE TRUE                                                22290000
223000         WHEN SQLCODE = ZERO                                      22300000
223100              CONTINUE                                            22310000
223200                                                                  22320000
223300         WHEN SQLCODE = +100                                      22330000
223400              MOVE 0  TO  PV-WST00010-ELEM-COUNT                  22340000
223500                                                                  22350000
223600         WHEN SQLWARN0 NOT = SPACE                                22360000
223700         WHEN SQLCODE NOT = ZERO                                  22370000
223800              MOVE '4320-GET-ELEM-COUNT' TO DP013-PARAGRAPH       22380000
223900              MOVE 'COUNT # OF ELEM ROWS  '                       22390000
224000                               TO DP013-MESSAGE-TEXT (1)          22400000
224100              MOVE SQLCA       TO DP013-SQLCA                     22410000
224200              SET DP013-DB2-ABEND TO TRUE                         22420000
224300              PERFORM DP013-0000-PROCESS-ABEND                    22430000
224400     END-EVALUATE.                                                22440000
224500                                                                  22450000
224600                                                                  22460000
224700*----------------------------------------------------------------*22470000
224800* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22480000
224900*----------------------------------------------------------------*22490000
225100 4400-MOVE-COMMAREA-TO-SCREEN.                                    22510000
225200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22520000
225300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22530000
225400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          22540000
225500             MOVE +1    TO ASC-BLK-SUB                            22550000
225600             PERFORM 5100-WRITE-TEMP-STORAGE                      22560000
225700             ADD +1     TO ASC-BLK-SUB                            22570000
225800             PERFORM 5100-WRITE-TEMP-STORAGE                      22580000
225900             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             22590000
226000                 GIVING PV-BLOCK-NUMBER                           22600000
226100                 REMAINDER PV-REMAINDER                           22610000
226200             IF  PV-REMAINDER > ZERO                              22620000
226300                 ADD +1 TO PV-BLOCK-NUMBER                        22630000
226400             END-IF                                               22640000
226500             MOVE +1    TO ASC-BLK-SUB                            22650000
226600             PERFORM 4410-READ-TEMP-STORAGE                       22660000
226700             ADD +1     TO ASC-BLK-SUB                            22670000
226800                           PV-BLOCK-NUMBER                        22680000
226900             PERFORM 4410-READ-TEMP-STORAGE                       22690000
227000     END-IF.                                                      22700000
227100     MOVE +1            TO ASC-BLK-SUB.                           22710000
227200     COMPUTE ASC-ITEM-SUB =                                       22720000
227300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              22730000
227400         + PC-ITEMS-PER-PANEL).                                   22740000
227500*                                                                 22750000
227600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22760000
227700         ADD +1         TO ASC-BLK-SUB                            22770000
227800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22780000
227900     END-IF.                                                      22790000
228000*                                                                 22800000
228100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           22810000
228200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                22820000
228300     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        22830000
228400     PERFORM 4420-FORMAT-LIST-LINES                               22840000
228500         VARYING PV-SUB                                           22850000
228600         FROM PC-ITEMS-PER-PANEL BY -1                            22860000
228700         UNTIL PV-SUB < +1.                                       22870000
228800*                                                                 22880000
228900     COMPUTE ASC-ITEMS-DISPLAYED =                                22890000
229000         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          22900000
229100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    22910000
229200                                      ASTRTITO.                   22920000
229300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    22930000
229400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    22940000
229500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            22950000
229600                                   TO ASELITO.                    22960000
229700*                                                                 22970000
229800     MOVE  ASC-PARM-NAME           TO AIPARMO.                    22980000
229900     MOVE  ASC-PARM-DESC           TO AIPDESCO.                   22990000
229910     MOVE  ASC-ORD-SEQ             TO AORDERO.                    22991012
230000                                                                  23000000
230100                                                                  23010000
230200*                                                                 23020000
230300     IF  DP020-MSG-NUMBER-X = SPACE                               23030000
230400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23040000
230500*            --- MORE ITEMS TO DISPLAY ----                       23050000
230600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23060000
230700             SET DP020-MSG-INFORMATIONAL TO TRUE                  23070000
230800         END-IF                                                   23080000
230900     END-IF.                                                      23090000
230910                                                                  23091049
230920                                                                  23092049
231000*----------------------------------------------------------------*23100000
231100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23110000
231200*----------------------------------------------------------------*23120000
231400 4410-READ-TEMP-STORAGE.                                          23140000
231500                                                                  23150000
231600     EXEC CICS                                                    23160000
231700         READQ TS                                                 23170000
231800             QUEUE (ASC-LIST-QUEUE-NAME)                          23180000
231900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23190000
232000             ITEM  (PV-BLOCK-NUMBER)                              23200000
232100             RESP  (PV-CICS-RESP)                                 23210000
232200     END-EXEC.                                                    23220000
232300                                                                  23230000
232400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23240000
232500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23250000
232600         CONTINUE                                                 23260000
232700     ELSE                                                         23270000
232800         SET DP013-CICS-ABEND     TO TRUE                         23280000
232900         SET DP013-NO-ROLLBACK    TO TRUE                         23290000
233000         MOVE '4410-READ-TEMP-STORAGE'                            23300000
233100                                  TO DP013-PARAGRAPH              23310000
233200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      23320000
233300                                  TO DP013-MESSAGE-TEXT(1)        23330000
233400         PERFORM DP013-0000-PROCESS-ABEND                         23340000
233500     END-IF.                                                      23350000
233600                                                                  23360000
233700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             23370000
233800*                                                                 23380000
233900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         23390000
234000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               23400000
234100     END-IF.                                                      23410000
234200                                                                  23420049
234210                                                                  23421049
234300*----------------------------------------------------------------*23430000
234400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *23440000
234500*----------------------------------------------------------------*23450000
234700 4420-FORMAT-LIST-LINES.                                          23470000
234800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      23480000
234900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                23490000
235000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           23500000
235100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           23510000
235200         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      23520003
235300                                    MR-ACTION       (PV-SUB)      23530003
235400                                    MR-DATYPE       (PV-SUB)      23540003
235500                                    MR-DADESC       (PV-SUB)      23550003
235600                                    MR-VALUE        (PV-SUB)      23560003
235700         MOVE ZEROES             TO MR-ELMSEQ       (PV-SUB)      23570003
235800                                    MR-DEFSEQ       (PV-SUB)      23580003
236100     ELSE                                                         23610000
236200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      23620000
236300                                                   > SPACE        23630000
236400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23640000
236500                                 TO MR-SELECTI (PV-SUB)           23650000
236600         ELSE                                                     23660000
236700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      23670000
236800                                 TO MR-SELECTI (PV-SUB)           23680000
236900         END-IF                                                   23690000
237000*                                                                 23700000
237100         IF  DP030-SET-CURSOR-TRAILER                             23710000
237200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)23720000
237300                 > SPACE)                                         23730000
237400               OR (PV-SUB = 1))                                   23740000
237500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23750000
237600                MOVE -1          TO MR-SELECTL (PV-SUB)           23760000
237700             END-IF                                               23770000
237800         END-IF                                                   23780000
237900*                                                                 23790000
238000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               23800000
238100                                          TO MR-ACTION   (PV-SUB) 23810000
238200         MOVE ASC-DEFN-SEQ       (ASC-BLK-SUB ASC-ITEM-SUB)       23820003
238300                                          TO MR-DEFSEQ   (PV-SUB) 23830003
238400         MOVE ASC-ELEM-SEQ       (ASC-BLK-SUB ASC-ITEM-SUB)       23840003
238500                                          TO MR-ELMSEQ   (PV-SUB) 23850003
238600         MOVE ASC-DATA-TYPE      (ASC-BLK-SUB ASC-ITEM-SUB)       23860003
238700                                          TO MR-DATYPE   (PV-SUB) 23870003
238800         MOVE ASC-DEFN-DESCR     (ASC-BLK-SUB ASC-ITEM-SUB)       23880003
238900                                          TO MR-DADESC   (PV-SUB) 23890003
239000                                                                  23900003
239010         MOVE SPACES                      TO MR-VALUE    (PV-SUB) 23901015
239020                                                                  23902015
239100         IF   ASC-DATA-TYPE  (ASC-BLK-SUB ASC-ITEM-SUB) = 'STR'   23910003
239200              MOVE  ASC-ELEM-TEXT (ASC-BLK-SUB ASC-ITEM-SUB)      23920003
239300                                          TO MR-VALUE    (PV-SUB) 23930003
239400         END-IF                                                   23940003
239500                                                                  23950003
239600         IF   ASC-DATA-TYPE  (ASC-BLK-SUB ASC-ITEM-SUB) = 'NUM'   23960003
239700              MOVE  ASC-ELEM-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)      23970003
239800                                          TO PV-DISP-ATTR-NBR     23980003
239900              MOVE  PV-DISP-ATTR-NBR      TO MR-VALUE    (PV-SUB) 23990003
240000         END-IF                                                   24000003
240100                                                                  24010003
240110         IF   ASC-DATA-TYPE  (ASC-BLK-SUB ASC-ITEM-SUB) = 'DTE'   24011003
240120              MOVE  ASC-ELEM-TMST (ASC-BLK-SUB ASC-ITEM-SUB)      24012003
240130                                          TO MR-VALUE    (PV-SUB) 24013003
240140         END-IF                                                   24014003
240150                                                                  24015003
240160     END-IF.                                                      24016003
240200                                                                  24020000
240300     SUBTRACT +1 FROM ASC-ITEM-SUB                                24030000
240400     IF  ASC-ITEM-SUB < + 1                                       24040000
240500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24050000
240600         MOVE +1                 TO ASC-BLK-SUB                   24060000
240700     END-IF.                                                      24070000
240710                                                                  24071049
240720                                                                  24072049
240800******************************************************************24080000
240900** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24090000
241000** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24100000
241100** ISSUE A WARNING.                                             **24110000
241200******************************************************************24120000
241300 4430-CHECK-FOR-BEGIN-AND-END.                                    24130000
241400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24140000
241500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24150000
241600*            -- NO END-OF-RANGE SPECFIED ---                      24160000
241700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24170000
241800             SET DP020-MSG-WARNING TO TRUE                        24180000
241900             PERFORM 4431-POSITION-AT-WARNING                     24190000
242000         END-IF                                                   24200000
242100     ELSE                                                         24210000
242200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24220000
242300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24230000
242400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24240000
242500             SET DP020-MSG-WARNING TO TRUE                        24250000
242600             PERFORM 4431-POSITION-AT-WARNING                     24260000
242700         END-IF                                                   24270000
242800     END-IF.                                                      24280000
242810                                                                  24281049
242820                                                                  24282049
242900******************************************************************24290000
243000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **24300000
243100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **24310000
243200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **24320000
243300** POSITION THE CURSOR THERE.                                   **24330000
243400******************************************************************24340000
243500 4431-POSITION-AT-WARNING.                                        24350000
243600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24360000
243700                    - PV-TOP-ITEM + 1.                            24370000
243800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24380000
243900         CONTINUE                                                 24390000
244000     ELSE                                                         24400000
244100         SET DP030-SET-CURSOR-APPL-1                              24410000
244200                                   TO TRUE                        24420000
244300         MOVE -1                   TO MR-SELECTL (PV-SUB)         24430000
244400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24440000
244500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24450000
244600     END-IF.                                                      24460000
244700*                                                                 24470000
244800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24480000
244900                    - PV-TOP-ITEM + 1.                            24490000
245000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24500000
245100         CONTINUE                                                 24510000
245200     ELSE                                                         24520000
245300         SET DP030-SET-CURSOR-APPL-1                              24530000
245400                                   TO TRUE                        24540000
245500         MOVE -1                   TO MR-SELECTL (PV-SUB)         24550000
245600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24560000
245700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24570000
245800     END-IF.                                                      24580000
245900                                                                  24590000
246000                                                                  24600049
250600*----------------------------------------------------------------*25060000
250700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL       *25070000
250800* SELECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT  *25080000
250900* FOR THE SELECTED ITEMS QUEUE.                                  *25090000
251000*                                                                *25100000
251100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25110000
251200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25120000
251300* THE ARRAY IS FULL.                                             *25130000
251400*----------------------------------------------------------------*25140000
251500 5000-PREPARE-SEL-QUEUE.                                          25150000
251600                                                                  25160000
251700     MOVE +1                   TO  ASC-BLK-SUB.                   25170000
251800     PERFORM 5100-WRITE-TEMP-STORAGE.                             25180000
251900     ADD +1                    TO  ASC-BLK-SUB.                   25190000
252000     PERFORM 5100-WRITE-TEMP-STORAGE.                             25200000
252100                                                                  25210000
252200     MOVE ASC-SEL-QUEUE-NAME-2 TO  CN027-SEL-QUEUE-NAME.          25220038
252300     PERFORM 6010-DELETE-SEL-QUEUE.                               25230000
252400                                                                  25240000
252500     SET ASC-UPDATE-TSQ        TO  TRUE.                          25250000
252600                                                                  25260000
252700     SET CN028-IDX             TO  1.                             25270034
252800*    MOVE ZERO                 TO CN027-NUMBER-OF-TS-ITEMS.       25280025
252900     INITIALIZE CN028-SELECTED-ITEM-ARRAY.                        25290034
253000                                                                  25300000
253100     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25310000
253200             VARYING PV-ITEM                                      25320000
253300             FROM 1 BY 1                                          25330000
253400             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25340000
253500                                                                  25350000
253600     IF  CN028-IDX > 1                                            25360034
253700         PERFORM 5205-WRITE-SEL-QUEUE                             25370000
253800         ADD +1                TO CN027-NUMBER-OF-TS-ITEMS        25380025
253900     END-IF.                                                      25390000
254000                                                                  25400049
254010                                                                  25401049
254100*----------------------------------------------------------------*25410000
254200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25420000
254300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25430000
254400*----------------------------------------------------------------*25440000
254600 5100-WRITE-TEMP-STORAGE.                                         25460000
254700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25470000
254800                                   TO PV-LIST-ITEM-NUMBER.        25480000
254900     COMPUTE PV-BLOCK-NUMBER =                                    25490000
255000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25500000
255100                                                                  25510000
255200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25520000
255300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25530000
255400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25540000
255500             PERFORM 5105-REWRITE-ASC-LISTQ                       25550000
255600         END-IF                                                   25560000
255700     ELSE                                                         25570000
255800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25580000
255900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25590000
256000         PERFORM 5110-WRITE-ASC-LISTQ                             25600000
256100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25610000
256200     END-IF.                                                      25620000
256300                                                                  25630000
256400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25640000
256410                                                                  25641049
256420                                                                  25642049
256500******************************************************************25650000
256600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25660000
256700** SPECIFIC COMMAREA.                                           **25670000
256800******************************************************************25680000
256900 5105-REWRITE-ASC-LISTQ.                                          25690000
257000     EXEC CICS                                                    25700000
257100         WRITEQ TS                                                25710000
257200             QUEUE (ASC-LIST-QUEUE-NAME)                          25720000
257300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25730000
257400             ITEM  (PV-BLOCK-NUMBER)                              25740000
257500             REWRITE                                              25750000
257600             RESP  (PV-CICS-RESP)                                 25760000
257700     END-EXEC.                                                    25770000
257800                                                                  25780000
257900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           25790000
258000         CONTINUE                                                 25800000
258100     ELSE                                                         25810000
258200         SET DP013-CICS-ABEND            TO TRUE                  25820000
258300         SET DP013-NO-ROLLBACK           TO TRUE                  25830000
258400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       25840000
258500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     25850000
258600                                         TO DP013-MESSAGE-TEXT(1) 25860000
258700         PERFORM DP013-0000-PROCESS-ABEND                         25870000
258800     END-IF.                                                      25880000
258900                                                                  25890000
258910                                                                  25891049
259000******************************************************************25900000
259100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **25910000
259200** SPECIFIC COMMAREA.                                           **25920000
259300******************************************************************25930000
259400 5110-WRITE-ASC-LISTQ.                                            25940000
259500     EXEC CICS                                                    25950000
259600         WRITEQ TS                                                25960000
259700             QUEUE (ASC-LIST-QUEUE-NAME)                          25970000
259800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25980000
259900             ITEM  (PV-BLOCK-NUMBER)                              25990000
260000             RESP  (PV-CICS-RESP)                                 26000000
260100     END-EXEC.                                                    26010000
260200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26020000
260300         SET DP013-CICS-ABEND      TO TRUE                        26030000
260400         SET DP013-NO-ROLLBACK     TO TRUE                        26040000
260500         MOVE '5110-WRITE-ASC-LISTQ'                              26050000
260600                                   TO DP013-PARAGRAPH             26060000
260700         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26070000
260800                                   TO DP013-MESSAGE-TEXT(1)       26080000
260900         PERFORM DP013-0000-PROCESS-ABEND                         26090000
261000     END-IF.                                                      26100000
261100                                                                  26110049
261110                                                                  26111049
261200*----------------------------------------------------------------*26120000
261300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26130000
261400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26140000
261500*----------------------------------------------------------------*26150000
261700 5200-FILL-SEL-QUEUE-RECORD.                                      26170000
261800                                                                  26180000
261900     PERFORM 6112-READ-LIST-QUEUE.                                26190000
262000                                                                  26200000
262100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26210000
262200         PERFORM                                                  26220000
262300         VARYING LQW-IDX                                          26230000
262400         FROM 1 BY 1                                              26240000
262500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26250000
262600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26260000
262700                                                                  26270000
262800             IF  LQW-SELECT (LQW-IDX)                             26280000
262900                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX)               26290000
263000                            TO CN028-ITEM          (CN028-IDX)    26300034
263100                 MOVE LQW-ACTION             (LQW-IDX)            26310032
263200                            TO CN028-ACTION-SW     (CN028-IDX)    26320034
263700                                                                  26370000
263800                 MOVE  LQW-ELEM-SEQ          (LQW-IDX)            26380044
263900                            TO CN028-ELEM-SEQ      (CN028-IDX)    26390044
263910                 MOVE  LQW-DEFN-SEQ          (LQW-IDX)            26391044
263920                            TO CN028-DEFN-SEQ      (CN028-IDX)    26392044
264500                 MOVE  LQW-DATA-TYPE         (LQW-IDX)            26450000
264600                            TO CN028-DATA-TYPE     (CN028-IDX)    26460034
265400                                                                  26540000
265500                 SET CN028-IDX UP BY 1                            26550034
265600                 IF  CN028-IDX > CN028-MAX-ITEMS                  26560034
265700                     PERFORM 5205-WRITE-SEL-QUEUE                 26570000
265800                     ADD +1        TO CN027-NUMBER-OF-TS-ITEMS    26580025
265900                     INITIALIZE CN028-SELECTED-ITEM-ARRAY         26590034
266000                     SET CN028-IDX TO  1                          26600034
266100                 END-IF                                           26610000
266200             END-IF                                               26620000
266300         END-PERFORM                                              26630000
266400     END-IF.                                                      26640000
266500                                                                  26650000
266510                                                                  26651049
266600*----------------------------------------------------------------*26660000
266700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *26670000
266800*----------------------------------------------------------------*26680000
267000 5205-WRITE-SEL-QUEUE.                                            26700000
267100                                                                  26710000
267200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26720000
267300                                   TO CN028-SELECTED-ITEMS.       26730034
267400                                                                  26740000
267500     EXEC CICS                                                    26750000
267600          WRITEQ TS                                               26760000
267700              QUEUE (ASC-SEL-QUEUE-NAME-2)                        26770074
267800              FROM  (CN028-SELECT-RECORD)                         26780034
267900              ITEM  (PV-SEL-QUEUE-ITEM)                           26790000
268000              RESP  (PV-CICS-RESP)                                26800000
268100     END-EXEC.                                                    26810000
268200                                                                  26820000
268300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26830000
268400         CONTINUE                                                 26840000
268500     ELSE                                                         26850000
268600         SET DP013-CICS-ABEND      TO TRUE                        26860000
268700         SET DP013-NO-ROLLBACK     TO TRUE                        26870000
268800         MOVE '5205-WRITE-SEL-QUEUE'                              26880000
268900                                   TO DP013-PARAGRAPH             26890000
269000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          26900000
269100                                   TO DP013-MESSAGE-TEXT(1)       26910000
269200         PERFORM DP013-0000-PROCESS-ABEND                         26920000
269300     END-IF.                                                      26930000
269400                                                                  26940049
269410                                                                  26941049
269500******************************************************************26950000
269600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **26960000
269700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **26970000
269800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **26980000
269900** THE USER.                                                    **26990000
270000******************************************************************27000000
270100 6000-REFRESH-PANEL-FROM-TEMP.                                    27010000
270200                                                                  27020000
270300     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      27030000
270400         SET ASC-NO-TSQ-UPDATE TO TRUE                            27040000
270500         MOVE ZERO                 TO PV-SAVE-ITEM                27050000
270600                                      PV-SEL-QUEUE-ITEM           27060000
270700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27070000
270800                                   TO PV-HOLD-SELECTED-ITEMS      27080000
270900         MOVE +1                   TO PV-ITEMS-PROCESSED          27090000
271000         PERFORM 6100-UPDATE-TSQ                                  27100000
271100             UNTIL PV-ITEMS-PROCESSED >                           27110000
271200                                     PV-HOLD-SELECTED-ITEMS       27120000
271300         PERFORM 6010-DELETE-SEL-QUEUE                            27130000
271400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27140000
271500                    ASC-BLOCK-ENTRIES (2)                         27150000
271600     END-IF.                                                      27160000
271700                                                                  27170000
271710                                                                  27171049
271800*----------------------------------------------------------------*27180000
271900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27190000
272000*----------------------------------------------------------------*27200000
272100 6010-DELETE-SEL-QUEUE.                                           27210000
272200                                                                  27220000
272300     EXEC CICS                                                    27230000
272400         DELETEQ TS                                               27240000
272500             QUEUE (ASC-SEL-QUEUE-NAME-2)                         27250073
272600             RESP  (PV-CICS-RESP)                                 27260000
272700     END-EXEC.                                                    27270000
272800*                                                                 27280000
272900     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27290000
273000        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27300000
273100         CONTINUE                                                 27310000
273200     ELSE                                                         27320000
273300         SET DP013-CICS-ABEND TO TRUE                             27330000
273400         SET DP013-NO-ROLLBACK TO TRUE                            27340000
273500         MOVE '6010-DELETE-SEL-QUEUE'                             27350000
273600                        TO DP013-PARAGRAPH                        27360000
273700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27370000
273800                        TO DP013-MESSAGE-TEXT (1)                 27380000
273900         PERFORM DP013-0000-PROCESS-ABEND                         27390000
274000     END-IF.                                                      27400000
274100                                                                  27410000
274200*----------------------------------------------------------------*27420000
274300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27430000
274400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27440000
274500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27450000
274600*    THE TEMP QUEUE.                                             *27460000
274700*----------------------------------------------------------------*27470000
274800                                                                  27480000
274900 6100-UPDATE-TSQ.                                                 27490000
275000                                                                  27500000
275100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             27510000
275200     PERFORM 6105-READ-SEL-QUEUE.                                 27520000
275300     PERFORM                                                      27530000
275400         VARYING CN028-IDX                                        27540034
275500         FROM 1 BY 1                                              27550000
275600         UNTIL ((PV-ITEMS-PROCESSED >                             27560000
275700                              PV-HOLD-SELECTED-ITEMS)             27570000
275800         OR (CN028-IDX GREATER THAN CN028-MAX-ITEMS))             27580034
275900         IF  CN028-ACTION-SW (CN028-IDX) > SPACE                  27590034
276000             PERFORM 6110-PROCESS-ITEMS                           27600000
276100         END-IF                                                   27610000
276200         ADD +1                TO PV-ITEMS-PROCESSED              27620000
276300     END-PERFORM.                                                 27630000
276400     PERFORM 6111-WRITE-LIST-QUEUE.                               27640000
276410                                                                  27641053
276420                                                                  27642053
276500*----------------------------------------------------------------*27650000
276600*    READ THE LIST QUEUE RECORD.                                 *27660000
276700*----------------------------------------------------------------*27670000
276900 6105-READ-SEL-QUEUE.                                             27690000
277000                                                                  27700000
277100     EXEC CICS                                                    27710000
277200          READQ TS                                                27720000
277300              QUEUE (ASC-SEL-QUEUE-NAME)                          27730000
277400              INTO  (CN028-SELECT-RECORD)                         27740034
277500              ITEM  (PV-SEL-QUEUE-ITEM)                           27750000
277600              RESP  (PV-CICS-RESP)                                27760000
277700     END-EXEC.                                                    27770000
277800*                                                                 27780000
277900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27790000
278000         CONTINUE                                                 27800000
278100     ELSE                                                         27810000
278200         SET DP013-CICS-ABEND      TO  TRUE                       27820000
278300         SET DP013-NO-ROLLBACK     TO  TRUE                       27830000
278400         MOVE '6105-READ-SEL-QUEUE'                               27840000
278500                                   TO  DP013-PARAGRAPH            27850000
278600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           27860000
278700                                   TO  DP013-MESSAGE-TEXT(1)      27870000
278800                                                                  27880000
278900         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              27890000
279000         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          27900000
279100         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  27910000
279200         STRING ' QUEUE TERM ID-'                                 27920000
279300                 PV-SEL-TERM-ID                                   27930000
279400                ' QUEUE TASK-'                                    27940000
279500                 PV-SEL-TASK-NUMBER                               27950000
279600                ' QUEUE SEQ-'                                     27960000
279700                 PV-SEL-SEQ           DELIMITED BY SIZE           27970000
279800                                 INTO  DP013-MESSAGE-TEXT(2)      27980000
279900         PERFORM DP013-0000-PROCESS-ABEND                         27990000
280000     END-IF.                                                      28000000
280100                                                                  28010049
280110                                                                  28011049
280200*----------------------------------------------------------------*28020000
280300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28030000
280400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28040000
280500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28050000
280600*----------------------------------------------------------------*28060000
280800 6110-PROCESS-ITEMS.                                              28080000
280900                                                                  28090000
281000     COMPUTE PV-ITEM = 1 + ((CN028-ITEM (CN028-IDX) - 1)          28100034
281100                     / PC-ITEMS-PER-PANEL).                       28110000
281200                                                                  28120000
281300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28130000
281400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28140000
281500             PERFORM 6111-WRITE-LIST-QUEUE                        28150000
281600         END-IF                                                   28160000
281700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28170000
281800                                                                  28180000
281900         PERFORM 6112-READ-LIST-QUEUE                             28190000
282000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28200000
282100             CONTINUE                                             28210000
282200         END-IF                                                   28220000
282300     END-IF.                                                      28230000
282400                                                                  28240000
282500     COMPUTE PV-SUB = (CN028-ITEM (CN028-IDX)                     28250034
282600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28260000
282700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28270000
282800     MOVE LQW-SELECTED-SW (PV-SUB)                                28280000
282900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28290000
283000     EVALUATE TRUE                                                28300000
283100         WHEN CN028-INQ (CN028-IDX)                               28310034
283200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28320000
283300                                                                  28330000
283400         WHEN CN028-UPD (CN028-IDX)                               28340034
283500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28350000
283700              MOVE  CN028-ELEM-SEQ  (CN028-IDX)                   28370044
283800                               TO  LQW-ELEM-SEQ   (LQW-IDX)       28380044
284000              MOVE CN028-DEFN-SEQ  (CN028-IDX)                    28400044
284100                               TO LQW-DEFN-SEQ  (PV-SUB)          28410000
284600              MOVE CN028-DATA-TYPE (CN028-IDX)                    28460034
284700                               TO LQW-DATA-TYPE (PV-SUB)          28470000
284800                                                                  28480049
285300         WHEN CN028-DEL (CN028-IDX)                               28530034
285400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28540000
285500                                                                  28550000
285600         WHEN CN028-ERR (CN028-IDX)                               28560034
285700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28570000
285800     END-EVALUATE.                                                28580000
285900                                                                  28590000
286000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28600000
286100                                                                  28610000
286110                                                                  28611049
286200*----------------------------------------------------------------*28620000
286300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28630000
286400*----------------------------------------------------------------*28640000
286600 6111-WRITE-LIST-QUEUE.                                           28660000
286700                                                                  28670000
286800     EXEC CICS                                                    28680000
286900         WRITEQ TS                                                28690000
287000             QUEUE (ASC-LIST-QUEUE-NAME)                          28700000
287100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28710000
287200             ITEM  (PV-SAVE-ITEM)                                 28720000
287300             REWRITE                                              28730000
287400             RESP  (PV-CICS-RESP)                                 28740000
287500     END-EXEC.                                                    28750000
287600*                                                                 28760000
287700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28770000
287800         CONTINUE                                                 28780000
287900     ELSE                                                         28790000
288000         SET DP013-CICS-ABEND  TO  TRUE                           28800000
288100         SET DP013-NO-ROLLBACK TO  TRUE                           28810000
288200         MOVE '6111-WRITE-LIST-QUEUE'                             28820000
288300                               TO  DP013-PARAGRAPH                28830000
288400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28840000
288500                               TO  DP013-MESSAGE-TEXT(1)          28850000
288600         PERFORM DP013-0000-PROCESS-ABEND                         28860000
288700     END-IF.                                                      28870000
288800                                                                  28880000
288900                                                                  28890049
289000*----------------------------------------------------------------*28900000
289100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*28910000
289200*----------------------------------------------------------------*28920000
289400 6112-READ-LIST-QUEUE.                                            28940000
289500                                                                  28950000
289600     EXEC CICS                                                    28960000
289700         READQ TS                                                 28970000
289800             QUEUE (ASC-LIST-QUEUE-NAME)                          28980000
289900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     28990000
290000             ITEM  (PV-ITEM)                                      29000000
290100             RESP  (PV-CICS-RESP)                                 29010000
290200     END-EXEC.                                                    29020000
290300*                                                                 29030000
290400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29040000
290500         CONTINUE                                                 29050000
290600     ELSE                                                         29060000
290700         SET DP013-CICS-ABEND        TO TRUE                      29070000
290800         SET DP013-NO-ROLLBACK       TO TRUE                      29080000
290900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29090000
291000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29100000
291100                                     TO DP013-MESSAGE-TEXT(1)     29110000
291200         PERFORM DP013-0000-PROCESS-ABEND                         29120000
291300     END-IF.                                                      29130000
291400                                                                  29140000
291410                                                                  29141049
291500*----------------------------------------------------------------*29150000
291600* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29160000
291700*----------------------------------------------------------------*29170000
291800 9100-READ-SEL-QUEUE.                                             29180000
291900     EXEC CICS                                                    29190000
292000         READQ TS                                                 29200000
292100             QUEUE (ASC-SEL-QUEUE-NAME)                           29210000
292200             INTO  (CN024-SELECT-RECORD)                          29220000
292300             ITEM  (ASC-SEL-ITEM)                                 29230000
292400             RESP  (PV-CICS-RESP)                                 29240000
292500     END-EXEC.                                                    29250000
292600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        29260000
292700         CONTINUE                                                 29270000
292800     ELSE                                                         29280000
292900         SET DP013-LOGIC-ABEND                                    29290000
293000             DP013-NO-ROLLBACK   TO   TRUE                        29300000
293100         MOVE '9100-READ-SEL-QUEUE'                               29310000
293200                                 TO   DP013-PARAGRAPH             29320000
293300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   29330000
293400                                 TO   DP013-MESSAGE-TEXT (1)      29340000
293500         PERFORM DP013-0000-PROCESS-ABEND                         29350000
293600     END-IF.                                                      29360000
293700                                                                  29370000
293800                                                                  29380000
293900*----------------------------------------------------------------*29390000
294000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29400000
294100*----------------------------------------------------------------*29410000
294200 9200-REWRITE-SEL-QUEUE.                                          29420000
294300                                                                  29430000
294400     EXEC CICS                                                    29440000
294500          WRITEQ TS                                               29450000
294600              QUEUE  (ASC-SEL-QUEUE-NAME)                         29460000
294700              FROM   (CN024-SELECT-RECORD)                        29470000
294800              ITEM   (ASC-SEL-ITEM)                               29480000
294900              RESP   (PV-CICS-RESP)                               29490000
295000              REWRITE                                             29500000
295100     END-EXEC.                                                    29510000
295200                                                                  29520000
295300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   29530000
295400         SET DP013-CICS-ABEND                                     29540000
295500             DP013-NO-ROLLBACK     TO TRUE                        29550000
295600         MOVE '9200-REWRITE-SEL-QUEUE'                            29560000
295700                                   TO DP013-PARAGRAPH             29570000
295800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   29580000
295900                                   TO DP013-MESSAGE-TEXT (1)      29590000
296000         PERFORM DP013-0000-PROCESS-ABEND                         29600000
296100     END-IF.                                                      29610000
296200                                                                  29620000
296300                                                                  29630000
296400*----------------------------------------------------------------*29640000
296500*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *29650000
296600*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *29660000
296700*----------------------------------------------------------------*29670000
296800 9900-SOFT-ABORT.                                                 29680000
296900                                                                  29690000
297000     EXEC CICS SYNCPOINT                                          29700000
297100          ROLLBACK                                                29710000
297200     END-EXEC.                                                    29720000
297300                                                                  29730000
297400     SET  PS-ERROR                                                29740000
297500          PS-SOFT-ABORT-ERROR                                     29750000
297600          DP020-MSG-FATAL       TO  TRUE.                         29760000
297700                                                                  29770000
297800                                                                  29780000
297900*----------------------------------------------------------------*29790000
298000*    ABEND PROCESSOR MODULE                                      *29800000
298100*----------------------------------------------------------------*29810000
298200                                                                  29820000
298300     COPY DPPD013.                                                29830000
