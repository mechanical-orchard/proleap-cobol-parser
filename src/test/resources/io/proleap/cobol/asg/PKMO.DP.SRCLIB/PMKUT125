      *----------------------------------------------------------       00010064
       IDENTIFICATION DIVISION.                                         00020064
      *----------------------------------------------------------       00030064
       PROGRAM-ID.             PMKUT125.                                00040064
       AUTHOR.                 ALEXIS KEIKER                            00050064
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060064
       DATE-WRITTEN.           JANUARY 2004.                            00070064
       DATE-COMPILED.                                                   00080064
      *----------------------------------------------------------       00090064
      *          PMKUT125 - PROMO ID FILE CREATOR                       00100064
      *----------------------------------------------------------       00110066
      * THIS PROGRAM ACCEPTS A CONTROL CARD WITH A RUN DATE,            00120064
      * A REPORT INDICATOR, AND AN LPS END DATE.  THIS PROGRAM          00130064
      * WILL CHECK IF ANY PROMOTIONS ENDED THE DAY BEFORE AND           00140064
      * THEN POPULATE A FILE WITH THAT PROMOTION.  IF THE REPORT        00150064
      * INDICATOR WAS YES IT WILL CHECK IF ANY PROMOTIONS ENDED         00160064
      * THE DAY BEFORE AND IF THERE ARE ANY PROMOTIONS THAT WILL        00170064
      * END ALL THE WAY IN THE FUTURE UP UNTIL THE LPS END DATE.        00180064
      * THIS PROGRAM CAN POPULATE UP TO 34 PROMO ID FILES.              00190064
      *----------------------------------------------------------       00200064
      * HISTORY LOG:                                                    00210064
      *----------------------------------------------------------       00220064
      * DATE:         11/22/2004                                        00230064
      * WR/IR#:       P000713029                                        00240064
      * PROGRAMMER:   COLLEEN CUMMINGS                                  00250064
      * DESCRIPTION:  MODIFY TO ANALYZE PROMO-ID 405 INSTEAD OF         00260064
      *               AD EVENT NAMED "LOWEST PRICES".                   00270064
      *               FIND '*CGC' FOR WHAT TO UNCOMMENT.                00280064
      *                                                                 00290064
      *----------------------------------------------------------       00300064
      * DATE:         11/23/2004                                        00310064
      * WR/IR#:       P000713479                                        00320064
      * PROGRAMMER:   COLLEEN CUMMINGS                                  00330064
      * DESCRIPTION:  MODIFY TO ANALYZE PROMO-ID 461 AS A NON-MAIN      00340064
      *               PROMOTION INSTEAD OF A MAIN PROMOTION.            00350064
      *               (AFTER THANKSGIVING MAIN - LPS PRICING CAN        00360064
      *               BE EQUAL TO OR LESS THAN THIS MAIN - SO NEEDS     00370064
      *               TO BE TREATED AS NON-MAIN).                       00380064
      *               FIND '*CGC2' FOR WHAT TO UNCOMMENT.               00390064
      *                                                                 00400064
      *----------------------------------------------------------       00410064
      * DATE:         11/30/2004                                        00420064
      * WR/IR#:       P000713479                                        00430064
      * PROGRAMMER:   COLLEEN CUMMINGS                                  00440064
      * DESCRIPTION:  MISSED THE HISTORY SPOT TO ANALYZE:               00450064
      *               MODIFY TO ANALYZE PROMO-ID 461 AS A NON-MAIN      00460064
      *               PROMOTION INSTEAD OF A MAIN PROMOTION.            00470064
      *               (AFTER THANKSGIVING MAIN - LPS PRICING CAN        00480064
      *               BE EQUAL TO OR LESS THAN THIS MAIN - SO NEEDS     00490064
      *               TO BE TREATED AS NON-MAIN).                       00500064
      *               FIND '*CGC2' FOR WHAT TO UNCOMMENT.               00510064
      *----------------------------------------------------------       00520064
      * DATE:         01/20/2005                                        00530064
      * WR/IR#:       WR28178                                           00540064
      * PROGRAMMER:   COLLEEN CUMMINGS                                  00550064
      * DESCRIPTION:  REMOVED ABOVE CODE (CGC2) TO ONCE AGAIN           00560064
      *               ANALYZE "LOWEST PRICES" IN THE AD EVENT NAME.     00570064
      *               REMOVED ALL PRIOR HARDCODING.                     00580064
      *----------------------------------------------------------       00590064
      * DATE:         05/05/2005                                        00600064
      * WR/IR#:       P000760046                                        00610064
      * PROGRAMMER:   TOM BOYD                                          00620064
      * DESCRIPTION:  ADDED ADDITIONAL FILES TO ALLOW FOR MORE IDS      00630064
      *               - 10 MAIN     (FILE 01-10)                        00640064
      *               - 16 NON-MAIN (FILE 11-26)                        00650064
      *               -  8 LPS      (FILE 27-34)                        00660064
      *----------------------------------------------------------       00670064
      * DATE:         10/19/2005                                        00680064
      * WR/IR#:       WR29647                                           00690064
      * PROGRAMMER:   ERIC ZUNKE                                        00700064
      * DESCRIPTION:  ADDED INP02 (LOWEST PRICED PROMO ID) FOR SPECIFIC 00710064
      *               PROMO LPS RUNS.                                   00720064
      *----------------------------------------------------------       00730064
      * DATE:         03/20/2006                                        00740064
      * WR/IR#:       P000862123                                        00750064
      * PROGRAMMER:   TOM BOYD                                          00760064
      * DESCRIPTION:  ADDED LOGIC TO EXCLUDE EB/NO FROM BEING WRITTEN   00770064
      *               TO PROMO ID FILES.                                00780064
      *----------------------------------------------------------       00790064
      * DATE:         06/27/2006                                        00800064
      * WR/IR#:       P000894839                                        00810064
      * PROGRAMMER:   ERIC ZUNKE                                        00820064
      * DESCRIPTION:  CHANGED PROMO END TIMESTAMP TO INCLUDE THE 59     00830064
      *               SECONDS RATHER THAN A HARDCODED '00'.             00840064
      *----------------------------------------------------------       00850064
AJ0606* DATE:         06/06/2007                                        00860064
      * WR/IR#:       P001030785                                        00870064
      * PROGRAMMER:   AMANDA JEFFORDS                                   00880064
      * DESCRIPTION:  RUSH HOUR PROMOTIONS NEEDED TO BE IGNORED.        00890064
      *               THEY ARE REPLACING EB/NO.                         00900064
      *----------------------------------------------------------       00910064
      * DATE:         06/07/2007                                        00920064
      * WR/IR#:       P001030785                                        00930064
      * PROGRAMMER:   AMANDA JEFFORDS                                   00940064
      * DESCRIPTION:  NEEDED AN AND INSTEAD OF AN OR.                   00950064
      *----------------------------------------------------------       00960064
W33193* DATE:         07/25/2007                                        00970064
      * WR/IR#:       WR33193                                           00980064
      * PROGRAMMER:   DAVID FELLENZ                                     00990064
      * DESCRIPTION:  PARTIAL DAY PROMOTIONS ARE TO BE IGNORED.         01000064
      *               THEY ARE EB/SEB/ATSEB/SPOT/RUSH.                  01010064
      *----------------------------------------------------------       01020064
W33193* DATE:         08/03/2007                                        01030064
      * WR/IR#:       WR33193                                           01040064
      * PROGRAMMER:   DAVID FELLENZ                                     01050064
      * DESCRIPTION:  WENT ONE STEP FURTHER AND ADDED THE INDICATOR     01060064
      *               PRTN_OF_DAY_EFF_CDE(F=FULL, P=PARTIAL)            01070064
      *               FROM TABLE PMT_PROMO FOUND IN VIEW PMV_PROMO_DIM. 01080064
      *               THIS ELIMINATES THE NEED FOR HARD CODING THE      01090064
      *               PARTIAL DAY PROMOTIONS. ALSO, CHANGED TO NEW      01100064
      *               WAY OF CALLING ORACLE.                            01110064
      *----------------------------------------------------------       01120064
      * DATE:         10/29/2008                                        01130064
      * WR/IR#:       INC000000567913                                   01140064
      * PROGRAMMER:   DARYL STEWART                                     01150064
      * DESCRIPTION:  HARD CODING BYPASS FOR NOVEMBER 2008 "DEAL OF THE 01160064
      *               DAY" PROMOTIONS. THEY ARE WEB ONLY AND SHOULD     01170064
      *               NOT BE COMPARED TO THE HOLIDAY LPS PROMOTION.     01180064
      *----------------------------------------------------------       01190064
W36026* DATE:         03/24/2009                                        01200064
W36026* WR/IR#:       WR36026                                           01210064
W36026* PROGRAMMER:   PAUL KEBER                                        01220064
W36026* DESCRIPTION:  SET RETURN-CODE TO 4095 IF NO PROMOTIONS ARE      01230064
W36026*               FOUND.                                            01240064
      *                                                                 01250064
      *----------------------------------------------------------       01260064
W36026* DATE:         02/10/2011                                        01270064
W36026* WR/IR#:       WR39472                                           01280064
W36026* PROGRAMMER:   PAUL KEBER                                        01290064
W36026* DESCRIPTION:  ALLOW BONUS BUY PROMOTION TO BE AN LPS PROMOTION  01300064
W36026*               IN THE 3000-PROCESS-FUT-PROMO-CSR ROUTINE.        01310064
      *                                                                 01320064
      *----------------------------------------------------------       01330064
PE7835* DATE:         08/19/2011                                        01340064
PE7835* WR/IR#:       PKE000000007835,PKE000000008031                   01350064
PE7835* PROGRAMMER:   COGNIZANT                                         01360064
PE7835* DESCRIPTION:                                                    01370064
PE7835*             1.TO PROCESS LPS PARTIAL PROMO ID'S ONLY ON SPECIFIC01380064
PE7835*               CONDITIONS, INCLUDED CC-LPS-PARTIAL-IND IN CONTROL01390064
PE7835*               CARD AND GIVEN COMMENTS IN PMCC142 AND PMCC169    01400064
PE7835*               TO DIFFERENTIATE FROM REPORT INDICATOR.           01410064
PK8031*             2.CHANGED THE END TIME STAMP TO PICK THE PROMO      01420064
PK8031*               WHICH HAS THE SAME RUN DATE BUT WITH DIFFERENT    01430064
PK8031*               TIME STAMP.                                       01440064
AR0921* DATE:         09/21/2011                                        01450064
AR0921* WR/IR#:       INC000001851135                                   01460064
AR0921* PROGRAMMER:   COGNIZANT                                         01470064
AR0921* DESCRIPTION:                                                    01480064
AR0921*             1.TO CHANGE THE REPORT INDICATOR CHECK TO SPACES    01490064
AR0921*               INSTEAD OF (NOT = 'Y' AND 'N')                    01500064
      *----------------------------------------------------------       01510064
PE9343* DATE:         10/21/2011                                        01520064
PE9343* WR/IR#:       PKE000000009343                                   01530064
PE9343* PROGRAMMER:   COGNIZANT                                         01540064
PE9343* DESCRIPTION:                                                    01550064
PE9343*               CHANGED THE PROGRAM FOR CLOSED STORE PROMOTION    01560064
PE9343*               BEING BYPASSED FOR COMPARISON.                    01570064
      *----------------------------------------------------------*      01571172
070941* DATE:         07/30/2018                                        01572072
070941* WR/IR#:       CHG0204126                                        01573072
070941* PROGRAMMER:   COGNIZANT                                         01574072
070941* DESCRIPTION:  ORACLE LOGON STANDARDS PROGRAM CHANGE             01575072
      *----------------------------------------------------------       01576074
C06337* DATE:         08/22/2018                                        01577074
C06337* WR/IR#:       CHG0206337                                        01578074
C06337* PROGRAMMER:   COGNIZANT                                         01579074
C06337* DESCRIPTION:                                                    01580074
C06337*               CHANGED THE PROGRAM FOR CLOSED STORE PROMOTION    01580174
C06337*               'Z STORE' AND PRICING TESTS 'Z CONTROL'           01580274
C06337*               BEING BYPASSED FOR COMPARISON.                    01580374
      *----------------------------------------------------------*      01580474
239376* DATE:         02/07/2020                                        01580582
239376* WR/IR#:       CHG0239376                                        01580682
239376* PROGRAMMER:   COGNIZANT                                         01580782
239376* DESCRIPTION:                                                    01580882
239376*               CHANGED THE PROGRAM FOR SELECTING UNADV           01580982
239376*               PROMOTION OTHER THAN IN LPS EVENT FOR             01581082
239376*               COMPARISON.                                       01581182
      *----------------------------------------------------------*      01581282
      *----------------------------------------------------------*      01582082
       ENVIRONMENT DIVISION.                                            01590064
      *----------------------------------------------------------       01600064
       CONFIGURATION SECTION.                                           01610064
       SOURCE-COMPUTER. IBM-3090.                                       01620064
       OBJECT-COMPUTER. IBM-3090.                                       01630064
                                                                        01640064
       INPUT-OUTPUT SECTION.                                            01650064
                                                                        01660064
       FILE-CONTROL.                                                    01670064
                                                                        01680064
           SELECT CONTROL-CARD-FILE                                     01690064
                  ASSIGN TO INP01.                                      01700064
                                                                        01710064
           SELECT LPS-PROMO-ID-CC-FILE                                  01720064
                  ASSIGN TO INP02.                                      01730064
                                                                        01740064
070941*    SELECT IN-ORACLE-SRC-CTL                                     01750071
070941*           ASSIGN TO INP03.                                      01760071
070941     SELECT ORACLE-LOGON-FILE                                     01761067
070941            ASSIGN TO ORALOGON.                                   01762071
                                                                        01770064
           SELECT PROMO-ID-FILE-1                                       01780064
                  ASSIGN TO OUT01.                                      01790064
                                                                        01800064
           SELECT PROMO-ID-FILE-2                                       01810064
                  ASSIGN TO OUT02.                                      01820064
                                                                        01830064
           SELECT PROMO-ID-FILE-3                                       01840064
                  ASSIGN TO OUT03.                                      01850064
                                                                        01860064
           SELECT PROMO-ID-FILE-4                                       01870064
                  ASSIGN TO OUT04.                                      01880064
                                                                        01890064
           SELECT PROMO-ID-FILE-5                                       01900064
                  ASSIGN TO OUT05.                                      01910064
                                                                        01920064
           SELECT PROMO-ID-FILE-6                                       01930064
                  ASSIGN TO OUT06.                                      01940064
                                                                        01950064
           SELECT PROMO-ID-FILE-7                                       01960064
                  ASSIGN TO OUT07.                                      01970064
                                                                        01980064
           SELECT PROMO-ID-FILE-8                                       01990064
                  ASSIGN TO OUT08.                                      02000064
                                                                        02010064
           SELECT PROMO-ID-FILE-9                                       02020064
                  ASSIGN TO OUT09.                                      02030064
                                                                        02040064
           SELECT PROMO-ID-FILE-10                                      02050064
                  ASSIGN TO OUT10.                                      02060064
                                                                        02070064
           SELECT PROMO-ID-FILE-11                                      02080064
                  ASSIGN TO OUT11.                                      02090064
                                                                        02100064
           SELECT PROMO-ID-FILE-12                                      02110064
                  ASSIGN TO OUT12.                                      02120064
                                                                        02130064
           SELECT PROMO-ID-FILE-13                                      02140064
                  ASSIGN TO OUT13.                                      02150064
                                                                        02160064
           SELECT PROMO-ID-FILE-14                                      02170064
                  ASSIGN TO OUT14.                                      02180064
                                                                        02190064
           SELECT PROMO-ID-FILE-15                                      02200064
                  ASSIGN TO OUT15.                                      02210064
                                                                        02220064
           SELECT PROMO-ID-FILE-16                                      02230064
                  ASSIGN TO OUT16.                                      02240064
                                                                        02250064
           SELECT PROMO-ID-FILE-17                                      02260064
                  ASSIGN TO OUT17.                                      02270064
                                                                        02280064
           SELECT PROMO-ID-FILE-18                                      02290064
                  ASSIGN TO OUT18.                                      02300064
                                                                        02310064
           SELECT PROMO-ID-FILE-19                                      02320064
                  ASSIGN TO OUT19.                                      02330064
                                                                        02340064
           SELECT PROMO-ID-FILE-20                                      02350064
                  ASSIGN TO OUT20.                                      02360064
                                                                        02370064
           SELECT PROMO-ID-FILE-21                                      02380064
                  ASSIGN TO OUT21.                                      02390064
                                                                        02400064
           SELECT PROMO-ID-FILE-22                                      02410064
                  ASSIGN TO OUT22.                                      02420064
                                                                        02430064
           SELECT PROMO-ID-FILE-23                                      02440064
                  ASSIGN TO OUT23.                                      02450064
                                                                        02460064
           SELECT PROMO-ID-FILE-24                                      02470064
                  ASSIGN TO OUT24.                                      02480064
                                                                        02490064
           SELECT PROMO-ID-FILE-25                                      02500064
                  ASSIGN TO OUT25.                                      02510064
                                                                        02520064
           SELECT PROMO-ID-FILE-26                                      02530064
                  ASSIGN TO OUT26.                                      02540064
                                                                        02550064
           SELECT PROMO-ID-FILE-27                                      02560064
                  ASSIGN TO OUT27.                                      02570064
                                                                        02580064
           SELECT PROMO-ID-FILE-28                                      02590064
                  ASSIGN TO OUT28.                                      02600064
                                                                        02610064
           SELECT PROMO-ID-FILE-29                                      02620064
                  ASSIGN TO OUT29.                                      02630064
                                                                        02640064
           SELECT PROMO-ID-FILE-30                                      02650064
                  ASSIGN TO OUT30.                                      02660064
                                                                        02670064
           SELECT PROMO-ID-FILE-31                                      02680064
                  ASSIGN TO OUT31.                                      02690064
                                                                        02700064
           SELECT PROMO-ID-FILE-32                                      02710064
                  ASSIGN TO OUT32.                                      02720064
                                                                        02730064
           SELECT PROMO-ID-FILE-33                                      02740064
                  ASSIGN TO OUT33.                                      02750064
                                                                        02760064
           SELECT PROMO-ID-FILE-34                                      02770064
                  ASSIGN TO OUT34.                                      02780064
                                                                        02790064
                                                                        02800064
      *----------------------------------------------------------       02810064
       DATA DIVISION.                                                   02820064
      *----------------------------------------------------------       02830064
       FILE SECTION.                                                    02840064
                                                                        02850064
       FD  CONTROL-CARD-FILE                                            02860064
           RECORDING MODE F                                             02870064
           BLOCK CONTAINS 0 RECORDS                                     02880064
           LABEL RECORDS ARE OMITTED                                    02890064
           DATA RECORD IS CONTROL-CARD-RECORD.                          02900064
       01  CONTROL-CARD-RECORD              PIC X(80).                  02910064
                                                                        02920064
       FD  LPS-PROMO-ID-CC-FILE                                         02930064
           RECORDING MODE F                                             02940064
           BLOCK CONTAINS 0 RECORDS                                     02950064
           LABEL RECORDS ARE OMITTED                                    02960064
           DATA RECORD IS LPS-PROMO-ID-CC-RECORD.                       02970064
       01  CONTROL-CARD-RECORD              PIC X(80).                  02980064
                                                                        02990064
070941*FD  IN-ORACLE-SRC-CTL                                            03000071
070941*01  IN-ORA-SRC-CTL-RECORD           PIC  X(80).                  03000171
070941 FD  ORACLE-LOGON-FILE                                            03001067
070941     RECORDING MODE IS F                                          03002067
           LABEL RECORDS ARE STANDARD                                   03010067
070941     BLOCK CONTAINS 0 RECORDS                                     03041067
           RECORD CONTAINS 80 CHARACTERS                                03042067
           DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      03043067
070941 01  OL-ORACLE-LOGON-RECORD           PIC X(80).                  03044071
                                                                        03050064
       FD  PROMO-ID-FILE-1                                              03060064
           RECORDING MODE F                                             03070064
           BLOCK CONTAINS 0 RECORDS                                     03080064
           LABEL RECORDS ARE OMITTED                                    03090064
           DATA RECORD IS PROMO-ID-REC-1.                               03100064
       01  PROMO-ID-REC-1                   PIC X(80).                  03110064
                                                                        03120064
       FD  PROMO-ID-FILE-2                                              03130064
           RECORDING MODE F                                             03140064
           BLOCK CONTAINS 0 RECORDS                                     03150064
           LABEL RECORDS ARE OMITTED                                    03160064
           DATA RECORD IS PROMO-ID-REC-2.                               03170064
       01  PROMO-ID-REC-2                   PIC X(80).                  03180064
                                                                        03190064
       FD  PROMO-ID-FILE-3                                              03200064
           RECORDING MODE F                                             03210064
           BLOCK CONTAINS 0 RECORDS                                     03220064
           LABEL RECORDS ARE OMITTED                                    03230064
           DATA RECORD IS PROMO-ID-REC-3.                               03240064
       01  PROMO-ID-REC-3                   PIC X(80).                  03250064
                                                                        03260064
       FD  PROMO-ID-FILE-4                                              03270064
           RECORDING MODE F                                             03280064
           BLOCK CONTAINS 0 RECORDS                                     03290064
           LABEL RECORDS ARE OMITTED                                    03300064
           DATA RECORD IS PROMO-ID-REC-4.                               03310064
       01  PROMO-ID-REC-4                   PIC X(80).                  03320064
                                                                        03330064
       FD  PROMO-ID-FILE-5                                              03340064
           RECORDING MODE F                                             03350064
           BLOCK CONTAINS 0 RECORDS                                     03360064
           LABEL RECORDS ARE OMITTED                                    03370064
           DATA RECORD IS PROMO-ID-REC-5.                               03380064
       01  PROMO-ID-REC-5                   PIC X(80).                  03390064
                                                                        03400064
       FD  PROMO-ID-FILE-6                                              03410064
           RECORDING MODE F                                             03420064
           BLOCK CONTAINS 0 RECORDS                                     03430064
           LABEL RECORDS ARE OMITTED                                    03440064
           DATA RECORD IS PROMO-ID-REC-6.                               03450064
       01  PROMO-ID-REC-6                   PIC X(80).                  03460064
                                                                        03470064
       FD  PROMO-ID-FILE-7                                              03480064
           RECORDING MODE F                                             03490064
           BLOCK CONTAINS 0 RECORDS                                     03500064
           LABEL RECORDS ARE OMITTED                                    03510064
           DATA RECORD IS PROMO-ID-REC-7.                               03520064
       01  PROMO-ID-REC-7                   PIC X(80).                  03530064
                                                                        03540064
       FD  PROMO-ID-FILE-8                                              03550064
           RECORDING MODE F                                             03560064
           BLOCK CONTAINS 0 RECORDS                                     03570064
           LABEL RECORDS ARE OMITTED                                    03580064
           DATA RECORD IS PROMO-ID-REC-8.                               03590064
       01  PROMO-ID-REC-8                   PIC X(80).                  03600064
                                                                        03610064
       FD  PROMO-ID-FILE-9                                              03620064
           RECORDING MODE F                                             03630064
           BLOCK CONTAINS 0 RECORDS                                     03640064
           LABEL RECORDS ARE OMITTED                                    03650064
           DATA RECORD IS PROMO-ID-REC-9.                               03660064
       01  PROMO-ID-REC-9                   PIC X(80).                  03670064
                                                                        03680064
       FD  PROMO-ID-FILE-10                                             03690064
           RECORDING MODE F                                             03700064
           BLOCK CONTAINS 0 RECORDS                                     03710064
           LABEL RECORDS ARE OMITTED                                    03720064
           DATA RECORD IS PROMO-ID-REC-10.                              03730064
       01  PROMO-ID-REC-10                  PIC X(80).                  03740064
                                                                        03750064
       FD  PROMO-ID-FILE-11                                             03760064
           RECORDING MODE F                                             03770064
           BLOCK CONTAINS 0 RECORDS                                     03780064
           LABEL RECORDS ARE OMITTED                                    03790064
           DATA RECORD IS PROMO-ID-REC-11.                              03800064
       01  PROMO-ID-REC-11                  PIC X(80).                  03810064
                                                                        03820064
       FD  PROMO-ID-FILE-12                                             03830064
           RECORDING MODE F                                             03840064
           BLOCK CONTAINS 0 RECORDS                                     03850064
           LABEL RECORDS ARE OMITTED                                    03860064
           DATA RECORD IS PROMO-ID-REC-12.                              03870064
       01  PROMO-ID-REC-12                  PIC X(80).                  03880064
                                                                        03890064
       FD  PROMO-ID-FILE-13                                             03900064
           RECORDING MODE F                                             03910064
           BLOCK CONTAINS 0 RECORDS                                     03920064
           LABEL RECORDS ARE OMITTED                                    03930064
           DATA RECORD IS PROMO-ID-REC-13.                              03940064
       01  PROMO-ID-REC-13                  PIC X(80).                  03950064
                                                                        03960064
       FD  PROMO-ID-FILE-14                                             03970064
           RECORDING MODE F                                             03980064
           BLOCK CONTAINS 0 RECORDS                                     03990064
           LABEL RECORDS ARE OMITTED                                    04000064
           DATA RECORD IS PROMO-ID-REC-14.                              04010064
       01  PROMO-ID-REC-14                  PIC X(80).                  04020064
                                                                        04030064
       FD  PROMO-ID-FILE-15                                             04040064
           RECORDING MODE F                                             04050064
           BLOCK CONTAINS 0 RECORDS                                     04060064
           LABEL RECORDS ARE OMITTED                                    04070064
           DATA RECORD IS PROMO-ID-REC-15.                              04080064
       01  PROMO-ID-REC-15                  PIC X(80).                  04090064
                                                                        04100064
       FD  PROMO-ID-FILE-16                                             04110064
           RECORDING MODE F                                             04120064
           BLOCK CONTAINS 0 RECORDS                                     04130064
           LABEL RECORDS ARE OMITTED                                    04140064
           DATA RECORD IS PROMO-ID-REC-16.                              04150064
       01  PROMO-ID-REC-16                  PIC X(80).                  04160064
                                                                        04170064
       FD  PROMO-ID-FILE-17                                             04180064
           RECORDING MODE F                                             04190064
           BLOCK CONTAINS 0 RECORDS                                     04200064
           LABEL RECORDS ARE OMITTED                                    04210064
           DATA RECORD IS PROMO-ID-REC-17.                              04220064
       01  PROMO-ID-REC-17                  PIC X(80).                  04230064
                                                                        04240064
       FD  PROMO-ID-FILE-18                                             04250064
           RECORDING MODE F                                             04260064
           BLOCK CONTAINS 0 RECORDS                                     04270064
           LABEL RECORDS ARE OMITTED                                    04280064
           DATA RECORD IS PROMO-ID-REC-18.                              04290064
       01  PROMO-ID-REC-18                  PIC X(80).                  04300064
                                                                        04310064
       FD  PROMO-ID-FILE-19                                             04320064
           RECORDING MODE F                                             04330064
           BLOCK CONTAINS 0 RECORDS                                     04340064
           LABEL RECORDS ARE OMITTED                                    04350064
           DATA RECORD IS PROMO-ID-REC-19.                              04360064
       01  PROMO-ID-REC-19                  PIC X(80).                  04370064
                                                                        04380064
       FD  PROMO-ID-FILE-20                                             04390064
           RECORDING MODE F                                             04400064
           BLOCK CONTAINS 0 RECORDS                                     04410064
           LABEL RECORDS ARE OMITTED                                    04420064
           DATA RECORD IS PROMO-ID-REC-20.                              04430064
       01  PROMO-ID-REC-20                  PIC X(80).                  04440064
                                                                        04450064
       FD  PROMO-ID-FILE-21                                             04460064
           RECORDING MODE F                                             04470064
           BLOCK CONTAINS 0 RECORDS                                     04480064
           LABEL RECORDS ARE OMITTED                                    04490064
           DATA RECORD IS PROMO-ID-REC-21.                              04500064
       01  PROMO-ID-REC-21                  PIC X(80).                  04510064
                                                                        04520064
       FD  PROMO-ID-FILE-22                                             04530064
           RECORDING MODE F                                             04540064
           BLOCK CONTAINS 0 RECORDS                                     04550064
           LABEL RECORDS ARE OMITTED                                    04560064
           DATA RECORD IS PROMO-ID-REC-22.                              04570064
       01  PROMO-ID-REC-22                  PIC X(80).                  04580064
                                                                        04590064
       FD  PROMO-ID-FILE-23                                             04600064
           RECORDING MODE F                                             04610064
           BLOCK CONTAINS 0 RECORDS                                     04620064
           LABEL RECORDS ARE OMITTED                                    04630064
           DATA RECORD IS PROMO-ID-REC-23.                              04640064
       01  PROMO-ID-REC-23                  PIC X(80).                  04650064
                                                                        04660064
       FD  PROMO-ID-FILE-24                                             04670064
           RECORDING MODE F                                             04680064
           BLOCK CONTAINS 0 RECORDS                                     04690064
           LABEL RECORDS ARE OMITTED                                    04700064
           DATA RECORD IS PROMO-ID-REC-24.                              04710064
       01  PROMO-ID-REC-24                  PIC X(80).                  04720064
                                                                        04730064
       FD  PROMO-ID-FILE-25                                             04740064
           RECORDING MODE F                                             04750064
           BLOCK CONTAINS 0 RECORDS                                     04760064
           LABEL RECORDS ARE OMITTED                                    04770064
           DATA RECORD IS PROMO-ID-REC-25.                              04780064
       01  PROMO-ID-REC-25                  PIC X(80).                  04790064
                                                                        04800064
       FD  PROMO-ID-FILE-26                                             04810064
           RECORDING MODE F                                             04820064
           BLOCK CONTAINS 0 RECORDS                                     04830064
           LABEL RECORDS ARE OMITTED                                    04840064
           DATA RECORD IS PROMO-ID-REC-26.                              04850064
       01  PROMO-ID-REC-26                  PIC X(80).                  04860064
                                                                        04870064
       FD  PROMO-ID-FILE-27                                             04880064
           RECORDING MODE F                                             04890064
           BLOCK CONTAINS 0 RECORDS                                     04900064
           LABEL RECORDS ARE OMITTED                                    04910064
           DATA RECORD IS PROMO-ID-REC-27.                              04920064
       01  PROMO-ID-REC-27                  PIC X(80).                  04930064
                                                                        04940064
       FD  PROMO-ID-FILE-28                                             04950064
           RECORDING MODE F                                             04960064
           BLOCK CONTAINS 0 RECORDS                                     04970064
           LABEL RECORDS ARE OMITTED                                    04980064
           DATA RECORD IS PROMO-ID-REC-28.                              04990064
       01  PROMO-ID-REC-28                  PIC X(80).                  05000064
                                                                        05010064
       FD  PROMO-ID-FILE-29                                             05020064
           RECORDING MODE F                                             05030064
           BLOCK CONTAINS 0 RECORDS                                     05040064
           LABEL RECORDS ARE OMITTED                                    05050064
           DATA RECORD IS PROMO-ID-REC-29.                              05060064
       01  PROMO-ID-REC-29                  PIC X(80).                  05070064
                                                                        05080064
       FD  PROMO-ID-FILE-30                                             05090064
           RECORDING MODE F                                             05100064
           BLOCK CONTAINS 0 RECORDS                                     05110064
           LABEL RECORDS ARE OMITTED                                    05120064
           DATA RECORD IS PROMO-ID-REC-30.                              05130064
       01  PROMO-ID-REC-30                  PIC X(80).                  05140064
                                                                        05150064
       FD  PROMO-ID-FILE-31                                             05160064
           RECORDING MODE F                                             05170064
           BLOCK CONTAINS 0 RECORDS                                     05180064
           LABEL RECORDS ARE OMITTED                                    05190064
           DATA RECORD IS PROMO-ID-REC-31.                              05200064
       01  PROMO-ID-REC-31                  PIC X(80).                  05210064
                                                                        05220064
       FD  PROMO-ID-FILE-32                                             05230064
           RECORDING MODE F                                             05240064
           BLOCK CONTAINS 0 RECORDS                                     05250064
           LABEL RECORDS ARE OMITTED                                    05260064
           DATA RECORD IS PROMO-ID-REC-32.                              05270064
       01  PROMO-ID-REC-32                  PIC X(80).                  05280064
                                                                        05290064
       FD  PROMO-ID-FILE-33                                             05300064
           RECORDING MODE F                                             05310064
           BLOCK CONTAINS 0 RECORDS                                     05320064
           LABEL RECORDS ARE OMITTED                                    05330064
           DATA RECORD IS PROMO-ID-REC-33.                              05340064
       01  PROMO-ID-REC-33                  PIC X(80).                  05350064
                                                                        05360064
       FD  PROMO-ID-FILE-34                                             05370064
           RECORDING MODE F                                             05380064
           BLOCK CONTAINS 0 RECORDS                                     05390064
           LABEL RECORDS ARE OMITTED                                    05400064
           DATA RECORD IS PROMO-ID-REC-34.                              05410064
       01  PROMO-ID-REC-34                  PIC X(80).                  05420064
                                                                        05430064
                                                                        05440064
       WORKING-STORAGE SECTION.                                         05450064
      *----------------------------------------------------------       05460064
      * ABEND- ABEND VARIABLES                                          05470064
      *----------------------------------------------------------       05480064
       01  ABEND-CODE                       PIC S9(04) COMP VALUE +0.   05490064
           88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     05500064
           88  ABEND-4002-READ-ERROR                   VALUE +4002.     05510064
           88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     05520064
           88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     05530064
           88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     05540064
           88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     05550064
           88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     05560064
           88  ABEND-4008-DATA-ERROR                   VALUE +4008.     05570064
           88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     05580064
           88  ABEND-4013-SQL-ERROR                    VALUE +4013.     05590064
           88  ABEND-4014-ORACLE-LOGON-ERROR           VALUE +4014.     05600064
           88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     05610064
           88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     05620064
                                                                        05630064
      *----------------------------------------------------------       05640064
      * CC- CONTROL CARDS                                               05650064
      *----------------------------------------------------------       05660064
      *01  CC-CONTROL-CARD-REC.                                         05670064
      *    05  CC-RUN-DTE                     PIC X(08) VALUE SPACES.   05680064
      *    05  FILLER                         PIC X(01) VALUE SPACES.   05690064
PE7835*    05  FILLER                         PIC X(11) VALUE           05700064
PE7835*                                                 'REPORT IND:'.  05710064
PE7835*    05  FILLER                         PIC X(01) VALUE SPACES.   05720064
PE7835*    05  CC-RPT-IND                     PIC X(01) VALUE SPACES.   05730064
PE7835*    05  FILLER                         PIC X(01) VALUE SPACES.   05740064
PE7835*    05  CC-LPS-END-DTE                 PIC X(08) VALUE SPACES.   05750064
PE7835*    05  FILLER                         PIC X(49) VALUE SPACES.   05760064
                                                                        05770064
PE9343 01  CC-CONTROL-CARD-REC.                                         05780064
PE9343     05  CC-RUN-DTE                     PIC X(08) VALUE SPACES.   05790064
PE9343     05  FILLER                         PIC X(01) VALUE SPACES.   05800064
PE9343     05  CC-RPT-IND                     PIC X(01) VALUE SPACES.   05810064
PE9343     05  FILLER                         PIC X(01) VALUE SPACES.   05820064
PE9343     05  CC-LPS-END-DTE                 PIC X(08) VALUE SPACES.   05830064
PE9343     05  FILLER                         PIC X(61) VALUE SPACES.   05840064
                                                                        05850064
       01  LPS-PROMO-ID-CC-REC.                                         05860064
           05  CC-LPS-PROMO-ID                PIC X(10) VALUE SPACES.   05870064
PE7835     05  FILLER                         PIC X(01) VALUE SPACES.   05880064
PE7835     05  FILLER                         PIC X(27) VALUE           05890064
PE7835                                 'PROCESS PARTIAL DAY PROMOS:'.   05900064
PE7835     05  FILLER                         PIC X(01) VALUE SPACES.   05910064
PE7835     05  CC-LPS-PARTIAL-IND             PIC X(01) VALUE SPACES.   05920064
PE7835     05  FILLER                         PIC X(40) VALUE SPACES.   05930064
                                                                        05940064
      *----------------------------------------------------------       05950064
      * PS- PROGRAM SWITCHES                                            05960064
      *----------------------------------------------------------       05970064
       01  PS-PROGRAM-SWITCHES.                                         05980064
070941     05  PS-END-OF-LOGON-FILE-SW      PIC X(01)  VALUE 'N'.       05981071
070941         88  PS-END-OF-LOGON-FILE                VALUE 'Y'.       05982068
070941     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(01)  VALUE 'N'.       05983071
070941         88  PS-ORA-SRC-EMPTY                    VALUE 'Y'.       05984068
           05  PS-END-OF-PROMO-CSR-SW       PIC X(01)  VALUE 'N'.       05990064
               88  PS-END-OF-PROMO-CSR                 VALUE 'Y'.       06000064
               88  PS-NOT-END-OF-PROMO-CSR             VALUE 'N'.       06010064
                                                                        06020064
070941 01  CC-ORACLE-CONNECTION.                                        06021068
070941     05  CC-ORACLE-USERID             PIC X(40).                  06022071
070941         88 CC-AUTO-LOGON                        VALUE '/'.       06023068
070941     05  CC-ORACLE-PASSWORD           PIC X(40).                  06024071
      *----------------------------------------------------------       06030064
      * PC- PROGRAM CONSTANTS                                           06040064
      *----------------------------------------------------------       06050064
       01  PC-PROGRAM-CONSTANTS.                                        06060064
070941*    05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)  VALUE           06070071
070941     05  PC-AUTO-LOGON                PIC  X(1)   VALUE '/'.      06071071
070941     05  PC-PROGRAM-NAME              PIC  X(08)  VALUE           06072071
                                                        'PMKUT125'.     06080068
           05  PC-MIN-DAYS                  PIC  9(03)  VALUE 001.      06090064
           05  PC-STRT-TM                   PIC  X(08)  VALUE           06100064
                                                 '00:00:00'.            06110064
           05  PC-END-TM                    PIC  X(08)  VALUE           06120064
                                                 '23:59:00'.            06130064
                                                                        06140064
      *----------------------------------------------------------       06150064
      * PV- PROGRAM VARIABLES                                           06160064
      *----------------------------------------------------------       06170064
       01  PV-PROGRAM-VARIABLES.                                        06180064
070941     05  PV-ORACLE-USERID-LEN         PIC S9(4)  VALUE ZEROS      06181071
070941                                                 COMP SYNC.       06182068
070941     05  PV-ORACLE-PASSWORD-LEN       PIC S9(4)  VALUE ZEROS      06183071
070941                                                 COMP SYNC.       06184068
070941     05  PC-AUTO-LOGON                PIC X(01)  VALUE '/'.       06185071
           05  PV-TABLE-NAME                PIC X(30)  VALUE SPACES.    06190064
           05  PV-SQL-CODE                  PIC 9(09)  VALUE 0.         06200064
           05  PV-OPERATION-MSG             PIC X(60)  VALUE SPACES.    06210064
           05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    06220064
           05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACES.    06230064
           05  PV-SYS-DATE                  PIC X(21)  VALUE SPACES.    06240064
           05  PV-RUN-DTE-TMST.                                         06250064
               10 PV-RUN-DTE                PIC X(08)  VALUE SPACES.    06260064
               10 FILLER                    PIC X(01)  VALUE '-'.       06270064
PK8031*        10 PV-RUN-TM                 PIC X(08)  VALUE            06280064
PK8031*                                                '23.59.59'.      06290064
PK8031         10 PV-RUN-TM                 PIC X(08)  VALUE            06300064
PK8031                                                 '00.00.01'.      06310064
PK8031     05  PV-RUN-DTE-TMST-END.                                     06320064
PK8031         10 PV-RUN-DTE-END            PIC X(08)  VALUE SPACES.    06330064
PK8031         10 FILLER                    PIC X(01)  VALUE '-'.       06340064
PK8031         10 PV-RUN-TM-END             PIC X(08)  VALUE            06350064
PK8031                                                 '23.59.59'.      06360064
           05  PV-TBL-RUN-TMST              PIC X(17)  VALUE SPACES.    06370064
PK8031     05  PV-TBL-RUN-TMST-END          PIC X(17)  VALUE SPACES.    06380064
           05  PV-LPS-END-DTE.                                          06390064
               10 PV-LPS-DTE                PIC X(08)  VALUE SPACES.    06400064
               10 FILLER                    PIC X(01)  VALUE '-'.       06410064
               10 PV-LPS-TM                 PIC X(08)  VALUE            06420064
                                                       '23.59.59'.      06430064
           05  PV-TBL-LPS-TMST              PIC X(17)  VALUE SPACES.    06440064
           05  PV-LPS-PROMO-ID              PIC S9(10)  VALUE +0        06450064
                                            COMP-3.                     06460064
                                                                        06470064
       01  PV-SELECT-VARIABLES.                                         06480064
           05  PV-ADEVNT-NAME               PIC X(40)  VALUE SPACES.    06490064
           05  PV-PROMO-ID                  PIC S9(10) VALUE +0         06500064
                                            COMP-3.                     06510064
           05  PV-ADEVNT-ID                 PIC S9(10) VALUE +0         06520064
                                            COMP-3.                     06530064
           05  PV-ADV-PROMO-TYP-CDE         PIC X(02)  VALUE SPACES.    06540064
           05  PV-PROMO-STRT-DTE            PIC X(08)  VALUE SPACES.    06550064
           05  PV-PROMO-END-DTE             PIC X(08)  VALUE SPACES.    06560064
           05  PV-PROMO-ABBR-NM             PIC X(05)  VALUE SPACES.    06570064
           05  PV-NULL-IND.                                             06580064
               10  PV-ADV-PROMO-TYP-NULL    PIC S9(4) COMP VALUE +0.    06590064
W33193     05  PV-PRTN-OF-DAY-EFF-CDE       PIC X(01)  VALUE SPACES.    06600064
PE9343     05  PV-PROMO-NM                  PIC X(40)  VALUE SPACES.    06610064
                                                                        06620064
      *----------------------------------------------------------       06630064
      * PA- PROGRAM ACCUMULATORS                                        06640064
      *----------------------------------------------------------       06650064
       01  PA-PROGRAM-ACCUMULATORS.                                     06660064
           05  PA-PROMO-CNT                 PIC 9(09) VALUE ZEROES.     06670064
           05  PA-CNT-MAIN                  PIC 9(09) VALUE ZEROES.     06680064
           05  PA-CNT-NONMAIN               PIC 9(09) VALUE ZEROES.     06690064
           05  PA-CNT-LPS                   PIC 9(09) VALUE ZEROES.     06700064
                                                                        06710064
      *----------------------------------------------------------       06720064
      * COPYBOOK FOR THE PROMO ID FILES - OUTPUT                        06730064
      *----------------------------------------------------------       06740064
           COPY PMRD122.                                                06750064
                                                                        06760064
      *----------------------------------------------------------       06770064
      *                      O  R  A  C  L  E                           06780064
      *==========================================================       06790064
      *                                                                 06800064
      * ORACLE DECLARE SECTION                                          06810064
      * ORACLE USED AND RETURNED VARIABLES                              06820064
      *                                                                 06830064
      *----------------------------------------------------------       06840064
070941*    COPY PMWS800.                                                06850071
                                                                        06860064
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     06870064
                                                                        06880064
      *----------------------------------------------------------       06890064
      * ORACLE LOGON WORKING STORAGE COPYBOOK                           06900064
      *----------------------------------------------------------       06910064
                                                                        06920064
       01  PC-ENT01-TYPE-CDE                PIC X(02)  VALUE '01'.      06930064
       01  PV-ORACLE-ID                     PIC X(1)   VALUE '/'.       06940064
                                                                        06950064
       01  USERNAME                         PIC X(10)  VARYING.         06960064
       01  PASSWD                           PIC X(10)  VARYING.         06970064
                                                                        06980064
       01  ORACLE-RETURN                    PIC X(200) VALUE SPACES.    06990064
                                                                        07000064
           EXEC SQL END DECLARE SECTION END-EXEC.                       07010064
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       07020064
                                                                        07030064
       EJECT                                                            07040064
                                                                        07050064
      *----------------------------------------------------------       07060064
       PROCEDURE DIVISION.                                              07070064
      *----------------------------------------------------------       07080064
       0000-MAINLINE.                                                   07090064
                                                                        07100064
           PERFORM 1000-INITIALIZATION.                                 07110064
                                                                        07120064
           IF CC-RPT-IND = 'N'                                          07130064
              PERFORM 2000-PROCESS-PROMO-CSR                            07140064
                      UNTIL PS-END-OF-PROMO-CSR                         07150064
              PERFORM 2030-CLOSE-PROMO-CSR                              07160064
           ELSE                                                         07170064
              PERFORM 3000-PROCESS-FUT-PROMO-CSR                        07180064
                      UNTIL PS-END-OF-PROMO-CSR                         07190064
              PERFORM 3030-CLOSE-FUT-PROMO-CSR                          07200064
           END-IF.                                                      07210064
                                                                        07220064
           PERFORM 9999-WRAPUP.                                         07230064
                                                                        07240064
           IF PA-PROMO-CNT = 0                                          07250064
              MOVE 4095 TO RETURN-CODE                                  07260064
           END-IF.                                                      07270064
                                                                        07280064
           GOBACK.                                                      07290064
                                                                        07300064
      *0000-EXIT.                                                       07310064
       EJECT.                                                           07320064
                                                                        07330064
      *----------------------------------------------------------       07340064
      * 1000-INITIALIZATION.                                            07350064
      *     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      07360064
      *     FILES, READS CONTROL CARD, AND PROCESSES ANY CONTROL        07370064
      *     CARD PARAMETERS IT MAY NEED TO USE TO FETCH PROMOTIONS      07380064
      *     FROM THE CURSOR.                                            07390064
      *----------------------------------------------------------       07400064
       1000-INITIALIZATION.                                             07410064
                                                                        07420064
           INITIALIZE PV-SELECT-VARIABLES.                              07430064
                                                                        07440064
070941     DISPLAY 'ORACLE FILE OPEN'.                                  07441068
070941     OPEN INPUT ORACLE-LOGON-FILE.                                07442068
070941                                                                  07443068
070941     DISPLAY 'ORACLE FILE READ'.                                  07444068
070941     PERFORM 7000-READ-ORACLE-LOGON.                              07445068
070941                                                                  07446068
070941     DISPLAY 'ORACLE FILE CLOSE'.                                 07447068
070941     CLOSE ORACLE-LOGON-FILE.                                     07448068
070941                                                                  07449068
070941     IF ((PS-END-OF-LOGON-FILE)                                   07449168
070941             OR (CC-ORACLE-CONNECTION = SPACES))                  07449268
070941         DISPLAY '** ABEND **'                                    07449368
070941         DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '  07449468
070941                   'NOT PROVIDED'                                 07449568
070941         SET PS-ORA-SRC-EMPTY TO TRUE                             07449668
070941         CALL 'ILBOABN0' USING ABEND-CODE                         07449768
070941     END-IF.                                                      07449868
070941                                                                  07449968
070941     IF CC-AUTO-LOGON                                             07450068
070941         DISPLAY PC-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'        07450168
070941         EXEC SQL                                                 07450268
070941              CONNECT :USERNAME                                   07450368
070941         END-EXEC                                                 07450468
070941     ELSE                                                         07450568
070941         INITIALIZE PV-ORACLE-USERID-LEN                          07450668
070941                    PV-ORACLE-PASSWORD-LEN                        07450768
070941         INSPECT CC-ORACLE-USERID                                 07450868
070941             TALLYING PV-ORACLE-USERID-LEN                        07450968
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     07451068
070941      INSPECT CC-ORACLE-PASSWORD                                  07451168
070941          TALLYING PV-ORACLE-PASSWORD-LEN                         07451268
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     07451368
070941      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           07451468
070941                USERNAME-ARR                                      07451568
070941      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   07451668
070941      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       07451768
070941                PASSWD-ARR                                        07451868
070941      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   07451968
070941      DISPLAY PC-PROGRAM-NAME ' - LOGON TO ORACLE AS USER '       07452068
070941                USERNAME-ARR                                      07452168
070941      EXEC SQL                                                    07452268
070941        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   07452368
070941      END-EXEC                                                    07452468
070941      INITIALIZE CC-ORACLE-PASSWORD                               07452568
070941                 PASSWD                                           07452668
070941      END-IF.                                                     07452768
070941                                                                  07452868
070941     IF (SQLCODE NOT = 0)                                         07452968
070941         DISPLAY PV-PARAGRAPH-NAME                                07453068
070941         DISPLAY PC-PROGRAM-NAME ' - ERROR LOGGING ON TO ORACLE'  07453168
070941         PERFORM 9900-ORACLE-ABEND                                07453268
070941     END-IF.                                                      07453368
           OPEN INPUT  CONTROL-CARD-FILE                                07454064
                       LPS-PROMO-ID-CC-FILE                             07460064
070941*                IN-ORACLE-SRC-CTL                                07470071
                OUTPUT PROMO-ID-FILE-1                                  07480064
                       PROMO-ID-FILE-2                                  07490064
                       PROMO-ID-FILE-3                                  07500064
                       PROMO-ID-FILE-4                                  07510064
                       PROMO-ID-FILE-5                                  07520064
                       PROMO-ID-FILE-6                                  07530064
                       PROMO-ID-FILE-7                                  07540064
                       PROMO-ID-FILE-8                                  07550064
                       PROMO-ID-FILE-9                                  07560064
                       PROMO-ID-FILE-10                                 07570064
                       PROMO-ID-FILE-11                                 07580064
                       PROMO-ID-FILE-12                                 07590064
                       PROMO-ID-FILE-13                                 07600064
                       PROMO-ID-FILE-14                                 07610064
                       PROMO-ID-FILE-15                                 07620064
                       PROMO-ID-FILE-16                                 07630064
                       PROMO-ID-FILE-17                                 07640064
                       PROMO-ID-FILE-18                                 07650064
                       PROMO-ID-FILE-19                                 07660064
                       PROMO-ID-FILE-20                                 07670064
                       PROMO-ID-FILE-21                                 07680064
                       PROMO-ID-FILE-22                                 07690064
                       PROMO-ID-FILE-23                                 07700064
                       PROMO-ID-FILE-24                                 07710064
                       PROMO-ID-FILE-25                                 07720064
                       PROMO-ID-FILE-26                                 07730064
                       PROMO-ID-FILE-27                                 07740064
                       PROMO-ID-FILE-28                                 07750064
                       PROMO-ID-FILE-29                                 07760064
                       PROMO-ID-FILE-30                                 07770064
                       PROMO-ID-FILE-31                                 07780064
                       PROMO-ID-FILE-32                                 07790064
                       PROMO-ID-FILE-33                                 07800064
                       PROMO-ID-FILE-34.                                07810064
                                                                        07820064
070941*    PERFORM PM800-A000-ORACLE-SETUP.                             07830071
           PERFORM 1100-READ-CONTROL-FILE.                              07840064
W33193*    PERFORM PM700-A000-ORACLE-SETUP.                             07850064
                                                                        07860064
           IF CC-RPT-IND = 'N'                                          07870064
              PERFORM 1300-DECLARE-PROMO-CSR                            07880064
              PERFORM 2010-OPEN-PROMO-CSR                               07890064
              PERFORM 2020-FETCH-PROMO-CSR                              07900064
           ELSE                                                         07910064
              PERFORM 1400-DECLARE-FUT-PROMO-CSR                        07920064
              PERFORM 3010-OPEN-FUT-PROMO-CSR                           07930064
              PERFORM 3020-FETCH-FUT-PROMO-CSR                          07940064
           END-IF.                                                      07950064
                                                                        07960064
           IF PS-END-OF-PROMO-CSR                                       07970064
              DISPLAY 'NO PROMOTIONS ASSOCIATED WITH THESE DATES'       07980064
           END-IF.                                                      07990064
                                                                        08000064
      *1000-EXIT.                                                       08010064
       EJECT.                                                           08020064
                                                                        08030064
      *---------------------------------------------------------------  08040064
      * 1100-READ-CONTROL-FILE.                                         08050064
      *     READS THE CONTROL CARD AND GETS A DATE.                     08060064
      *---------------------------------------------------------------  08070064
       1100-READ-CONTROL-FILE.                                          08080064
                                                                        08090064
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD-REC.             08100064
                                                                        08110064
AR0921     IF CC-RUN-DTE = SPACES OR CC-RPT-IND = SPACES                08120064
PE7835        OR CC-LPS-END-DTE = SPACES                                08130064
              MOVE '1100-READ-CONTROL-FILE' TO PV-PARAGRAPH-NAME        08140064
              MOVE 'CONTROL CARD IS EMPTY'     TO PV-OPERATION-MSG-1    08150064
              SET ABEND-4003-CTRL-CARD-ERROR   TO TRUE                  08160064
              PERFORM 9800-ABEND                                        08170064
           ELSE                                                         08180064
              DISPLAY '** RUN DATE CONTROL CARD  **'                    08190064
              DISPLAY 'CC-RUN-DTE: ' CC-RUN-DTE                         08200064
              DISPLAY 'CC-RPT-IND: ' CC-RPT-IND                         08210064
              DISPLAY 'CC-LPS-END-DTE: ' CC-LPS-END-DTE                 08220064
              DISPLAY ' '                                               08230064
              MOVE CC-RUN-DTE        TO  PV-RUN-DTE                     08240064
              MOVE PV-RUN-DTE-TMST   TO  PV-TBL-RUN-TMST                08250064
PK8031        MOVE CC-RUN-DTE        TO  PV-RUN-DTE-END                 08260064
PK8031        MOVE PV-RUN-DTE-TMST-END                                  08270064
PK8031                               TO  PV-TBL-RUN-TMST-END            08280064
              MOVE CC-LPS-END-DTE    TO  PV-LPS-DTE                     08290064
              MOVE PV-LPS-END-DTE    TO  PV-TBL-LPS-TMST                08300064
           END-IF.                                                      08310064
                                                                        08320064
           READ LPS-PROMO-ID-CC-FILE INTO LPS-PROMO-ID-CC-REC.          08330064
                                                                        08340064
PE7835     IF ((CC-LPS-PROMO-ID = SPACES) OR                            08350064
AR0921          (CC-LPS-PARTIAL-IND = SPACES))                          08360064
              MOVE '1100-READ-CONTROL-FILE'    TO PV-PARAGRAPH-NAME     08370064
PE7835        MOVE 'LPS PROMO ID CC IS EMPTY OR PARTIAL PROMO ID HAS    08380064
PE7835-                   'AN INVALID VALUE'   TO PV-OPERATION-MSG-1    08390064
              SET ABEND-4003-CTRL-CARD-ERROR   TO TRUE                  08400064
              PERFORM 9800-ABEND                                        08410064
           ELSE                                                         08420064
              DISPLAY '** LPS PROMO ID CONTROL CARD  **'                08430064
              DISPLAY 'CC-LPS-PROMO-ID: ' CC-LPS-PROMO-ID               08440064
PE7835        DISPLAY 'CC-LPS-PARTIAL-IND:' CC-LPS-PARTIAL-IND          08450064
              DISPLAY ' '                                               08460064
              MOVE CC-LPS-PROMO-ID   TO  PV-LPS-PROMO-ID                08470064
           END-IF.                                                      08480064
                                                                        08490064
      *1100-EXIT.                                                       08500064
       EJECT.                                                           08510064
                                                                        08520064
      *--------------------------------------------------------------   08530064
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT      08540064
      * LOGS ON TO ORACLE.                                              08550064
      *---------------------------------------------------------------  08560064
070941*    COPY PMPD800.                                                08570071
W33193*    COPY PMPD700.                                                08580064
                                                                        08590064
                                                                        08600064
      *---------------------------------------------------------------  08610064
      * 1300-DECLARE-PROMO-CSR.                                         08620064
      *     DECLARE THE PROMO CURSOR.                                   08630064
      *---------------------------------------------------------------  08640064
       1300-DECLARE-PROMO-CSR.                                          08650064
                                                                        08660064
           EXEC SQL                                                     08670064
                DECLARE PROMOCSR CURSOR FOR                             08680064
                  SELECT  AD_EVNT_ID                                    08690064
                         ,PROMO_ID                                      08700064
                         ,ADV_PROMO_TYP_CDE                             08710064
                         ,TO_CHAR(PROMO_DFLT_STRT_TMST, 'YYYYMMDD')     08720064
                         ,TO_CHAR(PROMO_DFLT_END_TMST, 'YYYYMMDD')      08730064
TB0320                   ,PROMO_ABBR_NM                                 08740064
W33193                   ,DECODE(PRTN_OF_DAY_EFF_CDE, NULL, 'F',        08750064
W33193                                        PRTN_OF_DAY_EFF_CDE)      08760064
PE9343                   ,UPPER(PROMO_NM)                               08770064
                    FROM  PMV_PROMO_DIM                                 08780064
PK8031*            WHERE  PROMO_DFLT_END_TMST =                         08790064
PK8031*                   TO_DATE(:PV-TBL-RUN-TMST,                     08800064
PK8031*                           'YYYYMMDD-HH24.MI.SS')                08810064
PK8031             WHERE  PROMO_DFLT_END_TMST BETWEEN                   08820064
PK8031                    (TO_DATE(:PV-TBL-RUN-TMST,                    08830064
PK8031                              'YYYYMMDD-HH24.MI.SS')              08840064
PK8031                    - :PC-MIN-DAYS) AND                           08850064
PK8031                    (TO_DATE(:PV-TBL-RUN-TMST-END,                08860064
PK8031                              'YYYYMMDD-HH24.MI.SS')              08870064
PK8031                    - :PC-MIN-DAYS)                               08880064
                     AND  PROMO_TYP_CDE  = 'R'                          08890064
                     AND  PROMO_STAT_CDE = 'S'                          08900064
239376*              AND  REG_PROMO_TYP_CDE = 'A'                       08910082
239376*              AND  ADV_PROMO_TYP_CDE IN ('M', 'O')               08920082
567913               AND  PROMO_ABBR_NM <> 'DOD'                        08930064
                ORDER BY  AD_EVNT_ID, PROMO_ID                          08940064
           END-EXEC.                                                    08950064
                                                                        08960064
      *1300-EXIT.                                                       08970064
       EJECT.                                                           08980064
                                                                        08990064
      *---------------------------------------------------------------  09000064
      * 1400-DECLARE-FUT-PROMO-CSR.                                     09010064
      *     DECLARE THE FUTURE PROMO CURSOR.                            09020064
      *---------------------------------------------------------------  09030064
       1400-DECLARE-FUT-PROMO-CSR.                                      09040064
                                                                        09050064
           EXEC SQL                                                     09060064
                DECLARE FUTPROMOCSR CURSOR FOR                          09070064
                  SELECT  AD_EVNT_ID                                    09080064
                         ,AD_EVNT_NM                                    09090064
                         ,PROMO_ID                                      09100064
                         ,ADV_PROMO_TYP_CDE                             09110064
                         ,TO_CHAR(PROMO_DFLT_STRT_TMST, 'YYYYMMDD')     09120064
                         ,TO_CHAR(PROMO_DFLT_END_TMST, 'YYYYMMDD')      09130064
                         ,PROMO_ABBR_NM                                 09140064
W33193                   ,DECODE(PRTN_OF_DAY_EFF_CDE, NULL, 'F',        09150064
W33193                                        PRTN_OF_DAY_EFF_CDE)      09160064
PE9343                   ,UPPER(PROMO_NM)                               09170064
                    FROM  PMV_PROMO_DIM                                 09180064
                   WHERE  PROMO_DFLT_END_TMST BETWEEN                   09190064
                          (TO_DATE(:PV-TBL-RUN-TMST,                    09200064
                                    'YYYYMMDD-HH24.MI.SS')              09210064
                          - :PC-MIN-DAYS) AND                           09220064
                          TO_DATE(:PV-TBL-LPS-TMST,                     09230064
                                    'YYYYMMDD-HH24.MI.SS')              09240064
                     AND  PROMO_TYP_CDE  = 'R'                          09250064
                     AND  PROMO_STAT_CDE = 'S'                          09260064
239376*              AND  REG_PROMO_TYP_CDE = 'A'                       09270082
239376*              AND  ADV_PROMO_TYP_CDE IN ('M', 'O')               09280082
567913               AND  PROMO_ABBR_NM <> 'DOD'                        09290064
                ORDER BY  AD_EVNT_ID, PROMO_ID                          09300064
           END-EXEC.                                                    09310064
                                                                        09320064
      *1400-EXIT.                                                       09330064
       EJECT.                                                           09340064
                                                                        09350064
      *----------------------------------------------------------       09360064
      * 2000-PROCESS-PROMO-CSR.                                         09370064
      *     FETCHES THE PROMOTION CURSOR AND WRITES OUT EACH            09380064
      *     PROMOTION TO A SEPERATE FILE.                               09390064
      *----------------------------------------------------------       09400064
       2000-PROCESS-PROMO-CSR.                                          09410064
                                                                        09420064
           INITIALIZE PM122-PROMO-ID-REC.                               09430064
           MOVE PV-PROMO-END-DTE TO PM122-RUN-DTE.                      09440064
                                                                        09450064
           MOVE PV-PROMO-ID      TO PM122-PROMO-ID.                     09460064
           MOVE 'H'              TO PM122-HIST-FUT-IND.                 09470064
                                                                        09480064
           IF PV-ADV-PROMO-TYP-CDE = 'M'                                09490064
              ADD +1             TO PA-CNT-MAIN                         09500064
                                    PA-PROMO-CNT                        09510064
              MOVE 'M'           TO PM122-PROMO-TYP-IND                 09520064
              PERFORM 9000-WRITE-MAIN-FILES                             09530064
           ELSE                                                         09540064
239376        IF (PV-ADV-PROMO-TYP-CDE = 'O') OR                        09550082
239376            (PV-ADV-PROMO-TYP-CDE = ' ')                          09551082
W33193*          IF (((PV-PROMO-ABBR-NM NOT = 'EB')   AND               09560064
W33193*               (PV-PROMO-ABBR-NM NOT = 'RUSH')  AND              09570064
W33193           IF ((PV-PRTN-OF-DAY-EFF-CDE NOT = 'P') OR              09580064
PE7835                ((PV-LPS-PROMO-ID > 0) AND                        09590064
PE7835                 (CC-LPS-PARTIAL-IND = 'Y')))                     09600064
C06337              IF PV-PROMO-NM(1:7) = 'Z STORE' OR                  09610074
C06337                 PV-PROMO-NM(1:9) = 'Z CONTROL'                   09611074
PE9343                  DISPLAY 'THE BELOW CLOSED STORE PROMOTION '     09620064
PE9343-                         'BEING BYPASSED FOR COMPARISON.'        09630064
PE9343                  DISPLAY 'PROMO ID : ' PV-PROMO-ID               09640064
PE9343-                         ' PROMO NAME : ' PV-PROMO-NM            09650065
PE9343              ELSE                                                09660064
                        ADD +1          TO PA-CNT-NONMAIN               09670064
                                           PA-PROMO-CNT                 09680064
                        MOVE 'N'        TO PM122-PROMO-TYP-IND          09690064
                        PERFORM 9100-WRITE-NONMAIN-FILES                09700064
PE9343              END-IF                                              09710064
                 END-IF                                                 09720064
              END-IF                                                    09730064
           END-IF.                                                      09740064
                                                                        09750064
           INITIALIZE PV-SELECT-VARIABLES.                              09760064
           PERFORM 2020-FETCH-PROMO-CSR.                                09770064
                                                                        09780064
      *2000-EXIT.                                                       09790064
       EJECT.                                                           09800064
                                                                        09810064
      *----------------------------------------------------------       09820064
      * 2010-OPEN-PROMO-CSR.                                            09830064
      *     OPENS THE PROMO CURSOR.                                     09840064
      *----------------------------------------------------------       09850064
       2010-OPEN-PROMO-CSR.                                             09860064
                                                                        09870064
           EXEC SQL                                                     09880064
                 OPEN PROMOCSR                                          09890064
           END-EXEC.                                                    09900064
                                                                        09910064
           EVALUATE TRUE                                                09920064
               WHEN SQLCODE = ZEROES                                    09930064
                    SET PS-NOT-END-OF-PROMO-CSR TO TRUE                 09940064
               WHEN OTHER                                               09950064
                    SET ABEND-4013-SQL-ERROR TO TRUE                    09960064
                    MOVE SQLCODE             TO PV-SQL-CODE             09970064
                    MOVE '2010-OPEN-PROMO-CSR'                          09980064
                                      TO PV-PARAGRAPH-NAME              09990064
                    MOVE 'OPEN ERROR ON PROMOCSR'                       10000064
                                      TO PV-OPERATION-MSG               10010064
                    PERFORM 9900-ORACLE-ABEND                           10020064
           END-EVALUATE.                                                10030064
                                                                        10040064
      *2010-EXIT.                                                       10050064
       EJECT.                                                           10060064
                                                                        10070064
      *----------------------------------------------------------       10080064
      * 2020-FETCH-PROMO-CSR.                                           10090064
      *     FETCHES THE PROMO CURSOR.                                   10100064
      *----------------------------------------------------------       10110064
       2020-FETCH-PROMO-CSR.                                            10120064
                                                                        10130064
           EXEC SQL                                                     10140064
               FETCH PROMOCSR                                           10150064
                INTO  :PV-ADEVNT-ID                                     10160064
                     ,:PV-PROMO-ID                                      10170064
                     ,:PV-ADV-PROMO-TYP-CDE :PV-ADV-PROMO-TYP-NULL      10180064
                     ,:PV-PROMO-STRT-DTE                                10190064
                     ,:PV-PROMO-END-DTE                                 10200064
TB0320               ,:PV-PROMO-ABBR-NM                                 10210064
W33193               ,:PV-PRTN-OF-DAY-EFF-CDE                           10220064
PE9343               ,:PV-PROMO-NM                                      10230064
           END-EXEC.                                                    10240064
                                                                        10250064
           EVALUATE TRUE                                                10260064
               WHEN SQLCODE = ZERO                                      10270064
      *             DISPLAY 'PROMO ID: ' PV-PROMO-ID                    10280064
                    CONTINUE                                            10290064
               WHEN SQLCODE = 1403                                      10300064
                    SET PS-END-OF-PROMO-CSR TO TRUE                     10310064
               WHEN OTHER                                               10320064
                    MOVE SQLCODE      TO PV-SQL-CODE                    10330064
                    SET ABEND-4013-SQL-ERROR TO TRUE                    10340064
                    MOVE '2020-FETCH-PROMO-CSR'                         10350064
                                      TO PV-PARAGRAPH-NAME              10360064
                    MOVE 'FETCH ERROR ON ADEVENTCSR'                    10370064
                                     TO PV-OPERATION-MSG                10380064
                    PERFORM 9900-ORACLE-ABEND                           10390064
           END-EVALUATE.                                                10400064
                                                                        10410064
      *2020-EXIT.                                                       10420064
       EJECT.                                                           10430064
                                                                        10440064
      *----------------------------------------------------------       10450064
      * 2030-CLOSE-PROMO-CSR.                                           10460064
      *     CLOSE THE PROMO CURSOR.                                     10470064
      *----------------------------------------------------------       10480064
       2030-CLOSE-PROMO-CSR.                                            10490064
                                                                        10500064
           EXEC SQL                                                     10510064
                CLOSE PROMOCSR                                          10520064
           END-EXEC.                                                    10530064
                                                                        10540064
           EVALUATE TRUE                                                10550064
               WHEN SQLCODE = ZERO                                      10560064
                    CONTINUE                                            10570064
               WHEN OTHER                                               10580064
                    MOVE SQLCODE     TO PV-SQL-CODE                     10590064
                    SET ABEND-4013-SQL-ERROR TO TRUE                    10600064
                    MOVE '2030-CLOSE-PROMO-CSR'                         10610064
                                     TO PV-PARAGRAPH-NAME               10620064
                    MOVE 'CLOSE ERROR ON PROMOCSR'                      10630064
                                     TO PV-OPERATION-MSG                10640064
                    PERFORM 9900-ORACLE-ABEND                           10650064
           END-EVALUATE.                                                10660064
                                                                        10670064
      *2030-EXIT.                                                       10680064
       EJECT.                                                           10690064
                                                                        10700064
      *----------------------------------------------------------       10710064
      * 3000-PROCESS-FUT-PROMO-CSR.                                     10720064
      *     FETCHES THE FUT PROMOTION CURSOR AND WRITES OUT EACH        10730064
      *     PROMOTION TO A SEPERATE FILE.                               10740064
      *----------------------------------------------------------       10750064
       3000-PROCESS-FUT-PROMO-CSR.                                      10760064
                                                                        10770064
           INITIALIZE PM122-PROMO-ID-REC.                               10780064
                                                                        10790064
           MOVE PV-PROMO-ID      TO PM122-PROMO-ID.                     10800064
           MOVE PV-PROMO-END-DTE TO PM122-RUN-DTE.                      10810064
                                                                        10820064
           IF PV-PROMO-STRT-DTE < CC-RUN-DTE                            10830064
              MOVE 'H'           TO PM122-HIST-FUT-IND                  10840064
           ELSE                                                         10850064
              MOVE 'F'           TO PM122-HIST-FUT-IND                  10860064
           END-IF.                                                      10870064
                                                                        10880064
      *    DISPLAY 'ADEVENT NAME: ' PV-ADEVNT-NAME.                     10890064
      *    DISPLAY 'FUTURE PROMO ID    : ' PV-PROMO-ID                  10900064
           IF ((PV-ADEVNT-NAME = 'LOWEST PRICES') OR                    10910064
               (PV-PROMO-ID = PV-LPS-PROMO-ID))                         10920064
                                                                        10930064
39472 ***     IF PV-PROMO-ABBR-NM NOT = 'BB'                            10940064
                 ADD +1             TO PA-CNT-LPS                       10950064
                                       PA-PROMO-CNT                     10960064
                 MOVE 'L'           TO PM122-HIST-FUT-IND               10970064
                 MOVE 'L'           TO PM122-PROMO-TYP-IND              10980064
                 PERFORM 9200-WRITE-LPS-FILES                           10990064
39472 ***     END-IF                                                    11000064
           ELSE                                                         11010064
              IF PV-ADV-PROMO-TYP-CDE = 'M'                             11020064
                 ADD +1          TO PA-CNT-MAIN                         11030064
                                    PA-PROMO-CNT                        11040064
                 MOVE 'M'        TO PM122-PROMO-TYP-IND                 11050064
                 PERFORM 9000-WRITE-MAIN-FILES                          11060064
              ELSE                                                      11070064
239376           IF (PV-ADV-PROMO-TYP-CDE = 'O' OR                      11080082
239376              PV-ADV-PROMO-TYP-CDE = ' ') AND                     11081082
239376              PV-ADEVNT-NAME NOT = 'LPS'                          11082082
W33193*             IF (((PV-PROMO-ABBR-NM NOT = 'EB')   AND            11090064
W33193*                 (PV-PROMO-ABBR-NM NOT = 'RUSH')  AND            11100064
W33193              IF ((PV-PRTN-OF-DAY-EFF-CDE NOT = 'P') OR           11110064
PE7835                  ((PV-LPS-PROMO-ID > 0) AND                      11120064
PE7835                   (CC-LPS-PARTIAL-IND = 'Y')))                   11130064
C06337                 IF PV-PROMO-NM(1:7) = 'Z STORE' OR               11140074
C06337                    PV-PROMO-NM(1:9) = 'Z CONTROL'                11141074
PE9343                    DISPLAY 'THE BELOW CLOSED STORE PROMOTION '   11150064
PE9343-                           'BEING BYPASSED FOR COMPARISON.'      11160064
PE9343                    DISPLAY 'PROMO ID : ' PV-PROMO-ID             11170064
PE9343-                           ' PROMO NAME : ' PV-PROMO-NM          11180065
PE9343                 ELSE                                             11190064
                          ADD +1       TO PA-CNT-NONMAIN                11200064
                                          PA-PROMO-CNT                  11210064
                          MOVE 'N'     TO PM122-PROMO-TYP-IND           11220064
                          PERFORM 9100-WRITE-NONMAIN-FILES              11230064
PE9343                 END-IF                                           11240064
                    END-IF                                              11250064
                 END-IF                                                 11260064
              END-IF                                                    11270064
           END-IF.                                                      11280064
                                                                        11290064
           INITIALIZE PV-SELECT-VARIABLES.                              11300064
           PERFORM 3020-FETCH-FUT-PROMO-CSR.                            11310064
                                                                        11320064
      *3000-EXIT.                                                       11330064
       EJECT.                                                           11340064
                                                                        11350064
      *----------------------------------------------------------       11360064
      * 3010-OPEN-FUT-PROMO-CSR.                                        11370064
      *     OPENS THE FUTURE PROMO CURSOR.                              11380064
      *----------------------------------------------------------       11390064
       3010-OPEN-FUT-PROMO-CSR.                                         11400064
                                                                        11410064
           EXEC SQL                                                     11420064
                 OPEN FUTPROMOCSR                                       11430064
           END-EXEC.                                                    11440064
                                                                        11450064
           EVALUATE TRUE                                                11460064
               WHEN SQLCODE = ZEROES                                    11470064
                    SET PS-NOT-END-OF-PROMO-CSR TO TRUE                 11480064
               WHEN OTHER                                               11490064
                    SET ABEND-4013-SQL-ERROR TO TRUE                    11500064
                    MOVE SQLCODE             TO PV-SQL-CODE             11510064
                    MOVE '3010-OPEN-FUT-PROMO-CSR'                      11520064
                                      TO PV-PARAGRAPH-NAME              11530064
                    MOVE 'OPEN ERROR ON PROMOCSR'                       11540064
                                      TO PV-OPERATION-MSG               11550064
                    PERFORM 9900-ORACLE-ABEND                           11560064
           END-EVALUATE.                                                11570064
                                                                        11580064
      *3010-EXIT.                                                       11590064
       EJECT.                                                           11600064
                                                                        11610064
      *----------------------------------------------------------       11620064
      * 3020-FETCH-FUT-PROMO-CSR.                                       11630064
      *     FETCHES THE FUTURE PROMO CURSOR.                            11640064
      *----------------------------------------------------------       11650064
       3020-FETCH-FUT-PROMO-CSR.                                        11660064
                                                                        11670064
           EXEC SQL                                                     11680064
               FETCH FUTPROMOCSR                                        11690064
                INTO  :PV-ADEVNT-ID                                     11700064
                     ,:PV-ADEVNT-NAME                                   11710064
                     ,:PV-PROMO-ID                                      11720064
                     ,:PV-ADV-PROMO-TYP-CDE :PV-ADV-PROMO-TYP-NULL      11730064
                     ,:PV-PROMO-STRT-DTE                                11740064
                     ,:PV-PROMO-END-DTE                                 11750064
                     ,:PV-PROMO-ABBR-NM                                 11760064
W33193               ,:PV-PRTN-OF-DAY-EFF-CDE                           11770064
PE9343               ,:PV-PROMO-NM                                      11780064
           END-EXEC.                                                    11790064
                                                                        11800064
           EVALUATE TRUE                                                11810064
               WHEN SQLCODE = ZERO                                      11820064
      *             DISPLAY 'PROMO ID: ' PV-PROMO-ID                    11830064
                    CONTINUE                                            11840064
               WHEN SQLCODE = 1403                                      11850064
                    SET PS-END-OF-PROMO-CSR TO TRUE                     11860064
               WHEN OTHER                                               11870064
                    MOVE SQLCODE      TO PV-SQL-CODE                    11880064
                    SET ABEND-4013-SQL-ERROR TO TRUE                    11890064
                    MOVE '3020-FETCH-FUT-PROMO-CSR'                     11900064
                                      TO PV-PARAGRAPH-NAME              11910064
                    MOVE 'FETCH ERROR ON FUTPROMOCSR'                   11920064
                                     TO PV-OPERATION-MSG                11930064
                    PERFORM 9900-ORACLE-ABEND                           11940064
           END-EVALUATE.                                                11950064
                                                                        11960064
      *3020-EXIT.                                                       11970064
       EJECT.                                                           11980064
                                                                        11990064
      *----------------------------------------------------------       12000064
      * 3030-CLOSE-FUT-PROMO-CSR.                                       12010064
      *     CLOSE THE FUTURE PROMO CURSOR.                              12020064
      *----------------------------------------------------------       12030064
       3030-CLOSE-FUT-PROMO-CSR.                                        12040064
                                                                        12050064
           EXEC SQL                                                     12060064
                CLOSE FUTPROMOCSR                                       12070064
           END-EXEC.                                                    12080064
                                                                        12090064
           EVALUATE TRUE                                                12100064
               WHEN SQLCODE = ZERO                                      12110064
                    CONTINUE                                            12120064
               WHEN OTHER                                               12130064
                    MOVE SQLCODE     TO PV-SQL-CODE                     12140064
                    SET ABEND-4013-SQL-ERROR TO TRUE                    12150064
                    MOVE '3030-CLOSE-FUT-PROMO-CSR'                     12160064
                                     TO PV-PARAGRAPH-NAME               12170064
                    MOVE 'CLOSE ERROR ON FUTPROMOCSR'                   12180064
                                     TO PV-OPERATION-MSG                12190064
                    PERFORM 9900-ORACLE-ABEND                           12200064
           END-EVALUATE.                                                12210064
                                                                        12220064
      *3030-EXIT.                                                       12230064
       EJECT.                                                           12240064
                                                                        12240169
070941****************************************************************  12241069
070941** READ THE ORACLE LOGON CONTROL CARD.                        **  12242069
070941****************************************************************  12243069
070941 7000-READ-ORACLE-LOGON.                                          12244069
070941                                                                  12245069
070941     READ ORACLE-LOGON-FILE                                       12246069
070941         INTO CC-ORACLE-CONNECTION                                12247069
070941         AT END                                                   12248069
070941             SET PS-END-OF-LOGON-FILE TO TRUE                     12249069
070941     END-READ.                                                    12249169
                                                                        12250064
      *----------------------------------------------------------       12260064
      * 9000-WRITE-MAIN-FILES.                                          12270064
      *     WRITES THE PROMO ID TO A FILE.                              12280064
      *----------------------------------------------------------       12290064
       9000-WRITE-MAIN-FILES.                                           12300064
                                                                        12310064
      *    DISPLAY '9000-MAIN FILE PROMO ID = ' PM122-PROMO-ID.         12320064
                                                                        12330064
           EVALUATE TRUE                                                12340064
             WHEN PA-CNT-MAIN = 1                                       12350064
                  DISPLAY 'MAIN FILE1 PROMO ID = ' PM122-PROMO-ID       12360064
                  WRITE PROMO-ID-REC-1                                  12370064
                        FROM PM122-PROMO-ID-REC                         12380064
             WHEN PA-CNT-MAIN = 2                                       12390064
                  DISPLAY 'MAIN FILE2 PROMO ID = ' PM122-PROMO-ID       12400064
                  WRITE PROMO-ID-REC-2                                  12410064
                        FROM PM122-PROMO-ID-REC                         12420064
             WHEN PA-CNT-MAIN = 3                                       12430064
                  DISPLAY 'MAIN FILE3 PROMO ID = ' PM122-PROMO-ID       12440064
                  WRITE PROMO-ID-REC-3                                  12450064
                        FROM PM122-PROMO-ID-REC                         12460064
             WHEN PA-CNT-MAIN = 4                                       12470064
                  DISPLAY 'MAIN FILE4 PROMO ID = ' PM122-PROMO-ID       12480064
                  WRITE PROMO-ID-REC-4                                  12490064
                        FROM PM122-PROMO-ID-REC                         12500064
             WHEN PA-CNT-MAIN = 5                                       12510064
                  DISPLAY 'MAIN FILE5 PROMO ID = ' PM122-PROMO-ID       12520064
                  WRITE PROMO-ID-REC-5                                  12530064
                        FROM PM122-PROMO-ID-REC                         12540064
             WHEN PA-CNT-MAIN = 6                                       12550064
                  DISPLAY 'MAIN FILE6 PROMO ID = ' PM122-PROMO-ID       12560064
                  WRITE PROMO-ID-REC-6                                  12570064
                        FROM PM122-PROMO-ID-REC                         12580064
             WHEN PA-CNT-MAIN = 7                                       12590064
                  DISPLAY 'MAIN FILE7 PROMO ID = ' PM122-PROMO-ID       12600064
                  WRITE PROMO-ID-REC-7                                  12610064
                        FROM PM122-PROMO-ID-REC                         12620064
             WHEN PA-CNT-MAIN = 8                                       12630064
                  DISPLAY 'MAIN FILE8 PROMO ID = ' PM122-PROMO-ID       12640064
                  WRITE PROMO-ID-REC-8                                  12650064
                        FROM PM122-PROMO-ID-REC                         12660064
             WHEN PA-CNT-MAIN = 9                                       12670064
                  DISPLAY 'MAIN FILE9 PROMO ID = ' PM122-PROMO-ID       12680064
                  WRITE PROMO-ID-REC-9                                  12690064
                        FROM PM122-PROMO-ID-REC                         12700064
             WHEN PA-CNT-MAIN = 10                                      12710064
                  DISPLAY 'MAIN FILE10 PROMO ID = ' PM122-PROMO-ID      12720064
                  WRITE PROMO-ID-REC-10                                 12730064
                        FROM PM122-PROMO-ID-REC                         12740064
             WHEN OTHER                                                 12750064
                  DISPLAY 'TOO MANY MAIN PROMOTIONS!!!'                 12760064
           END-EVALUATE.                                                12770064
                                                                        12780064
      *9000-EXIT.                                                       12790064
       EJECT.                                                           12800064
                                                                        12810064
      *----------------------------------------------------------       12820064
      * 9100-WRITE-NONMAIN-FILES.                                       12830064
      *     WRITES THE NONMAIN PROMOTION ID FILES.                      12840064
      *----------------------------------------------------------       12850064
       9100-WRITE-NONMAIN-FILES.                                        12860064
                                                                        12870064
      *    DISPLAY '9100-NON-MAIN FILE PROMO ID = ' PM122-PROMO-ID.     12880064
                                                                        12890064
           EVALUATE TRUE                                                12900064
             WHEN PA-CNT-NONMAIN = 1                                    12910064
                  DISPLAY 'NON-MAIN FILE1 PROMO ID = ' PM122-PROMO-ID   12920064
                  WRITE PROMO-ID-REC-11                                 12930064
                        FROM PM122-PROMO-ID-REC                         12940064
             WHEN PA-CNT-NONMAIN = 2                                    12950064
                  DISPLAY 'NON-MAIN FILE2 PROMO ID = ' PM122-PROMO-ID   12960064
                  WRITE PROMO-ID-REC-12                                 12970064
                        FROM PM122-PROMO-ID-REC                         12980064
             WHEN PA-CNT-NONMAIN = 3                                    12990064
                  DISPLAY 'NON-MAIN FILE3 PROMO ID = ' PM122-PROMO-ID   13000064
                  WRITE PROMO-ID-REC-13                                 13010064
                        FROM PM122-PROMO-ID-REC                         13020064
             WHEN PA-CNT-NONMAIN = 4                                    13030064
                  DISPLAY 'NON-MAIN FILE4 PROMO ID = ' PM122-PROMO-ID   13040064
                  WRITE PROMO-ID-REC-14                                 13050064
                        FROM PM122-PROMO-ID-REC                         13060064
             WHEN PA-CNT-NONMAIN = 5                                    13070064
                  DISPLAY 'NON-MAIN FILE5 PROMO ID = ' PM122-PROMO-ID   13080064
                  WRITE PROMO-ID-REC-15                                 13090064
                        FROM PM122-PROMO-ID-REC                         13100064
             WHEN PA-CNT-NONMAIN = 6                                    13110064
                  DISPLAY 'NON-MAIN FILE6 PROMO ID = ' PM122-PROMO-ID   13120064
                  WRITE PROMO-ID-REC-16                                 13130064
                        FROM PM122-PROMO-ID-REC                         13140064
             WHEN PA-CNT-NONMAIN = 7                                    13150064
                  DISPLAY 'NON-MAIN FILE7 PROMO ID = ' PM122-PROMO-ID   13160064
                  WRITE PROMO-ID-REC-17                                 13170064
                        FROM PM122-PROMO-ID-REC                         13180064
             WHEN PA-CNT-NONMAIN = 8                                    13190064
                  DISPLAY 'NON-MAIN FILE8 PROMO ID = ' PM122-PROMO-ID   13200064
                  WRITE PROMO-ID-REC-18                                 13210064
                        FROM PM122-PROMO-ID-REC                         13220064
             WHEN PA-CNT-NONMAIN = 9                                    13230064
                  DISPLAY 'NON-MAIN FILE9 PROMO ID = ' PM122-PROMO-ID   13240064
                  WRITE PROMO-ID-REC-19                                 13250064
                        FROM PM122-PROMO-ID-REC                         13260064
             WHEN PA-CNT-NONMAIN = 10                                   13270064
                  DISPLAY 'NON-MAIN FILE10 PROMO ID = ' PM122-PROMO-ID  13280064
                  WRITE PROMO-ID-REC-20                                 13290064
                        FROM PM122-PROMO-ID-REC                         13300064
             WHEN PA-CNT-NONMAIN = 11                                   13310064
                  DISPLAY 'NON-MAIN FILE11 PROMO ID = ' PM122-PROMO-ID  13320064
                  WRITE PROMO-ID-REC-21                                 13330064
                        FROM PM122-PROMO-ID-REC                         13340064
             WHEN PA-CNT-NONMAIN = 12                                   13350064
                  DISPLAY 'NON-MAIN FILE12 PROMO ID = ' PM122-PROMO-ID  13360064
                  WRITE PROMO-ID-REC-22                                 13370064
                        FROM PM122-PROMO-ID-REC                         13380064
             WHEN PA-CNT-NONMAIN = 13                                   13390064
                  DISPLAY 'NON-MAIN FILE13 PROMO ID = ' PM122-PROMO-ID  13400064
                  WRITE PROMO-ID-REC-23                                 13410064
                        FROM PM122-PROMO-ID-REC                         13420064
             WHEN PA-CNT-NONMAIN = 14                                   13430064
                  DISPLAY 'NON-MAIN FILE14 PROMO ID = ' PM122-PROMO-ID  13440064
                  WRITE PROMO-ID-REC-24                                 13450064
                        FROM PM122-PROMO-ID-REC                         13460064
             WHEN PA-CNT-NONMAIN = 15                                   13470064
                  DISPLAY 'NON-MAIN FILE15 PROMO ID = ' PM122-PROMO-ID  13480064
                  WRITE PROMO-ID-REC-25                                 13490064
                        FROM PM122-PROMO-ID-REC                         13500064
             WHEN PA-CNT-NONMAIN = 16                                   13510064
                  DISPLAY 'NON-MAIN FILE16 PROMO ID = ' PM122-PROMO-ID  13520064
                  WRITE PROMO-ID-REC-26                                 13530064
                        FROM PM122-PROMO-ID-REC                         13540064
             WHEN OTHER                                                 13550064
                  DISPLAY 'TOO MANY NONMAIN PROMOTIONS!!!'              13560064
           END-EVALUATE.                                                13570064
                                                                        13580064
      *9100-EXIT.                                                       13590064
       EJECT.                                                           13600064
                                                                        13610064
      *----------------------------------------------------------       13620064
      * 9200-WRITE-LPS-FILES.                                           13630064
      *     WRITES THE LPS PROMOTION ID FILES.                          13640064
      *----------------------------------------------------------       13650064
       9200-WRITE-LPS-FILES.                                            13660064
                                                                        13670064
      *    DISPLAY '9200-LPS FILE PROMO ID = ' PM122-PROMO-ID.          13680064
                                                                        13690064
           EVALUATE TRUE                                                13700064
             WHEN PA-CNT-LPS = 1                                        13710064
                  DISPLAY 'LPS FILE1 PROMO ID = ' PM122-PROMO-ID        13720064
                  WRITE PROMO-ID-REC-27                                 13730064
                        FROM PM122-PROMO-ID-REC                         13740064
             WHEN PA-CNT-LPS = 2                                        13750064
                  DISPLAY 'LPS FILE2 PROMO ID = ' PM122-PROMO-ID        13760064
                  WRITE PROMO-ID-REC-28                                 13770064
                        FROM PM122-PROMO-ID-REC                         13780064
             WHEN PA-CNT-LPS = 3                                        13790064
                  DISPLAY 'LPS FILE3 PROMO ID = ' PM122-PROMO-ID        13800064
                  WRITE PROMO-ID-REC-29                                 13810064
                        FROM PM122-PROMO-ID-REC                         13820064
             WHEN PA-CNT-LPS = 4                                        13830064
                  DISPLAY 'LPS FILE4 PROMO ID = ' PM122-PROMO-ID        13840064
                  WRITE PROMO-ID-REC-30                                 13850064
                        FROM PM122-PROMO-ID-REC                         13860064
             WHEN PA-CNT-LPS = 5                                        13870064
                  DISPLAY 'LPS FILE5 PROMO ID = ' PM122-PROMO-ID        13880064
                  WRITE PROMO-ID-REC-31                                 13890064
                        FROM PM122-PROMO-ID-REC                         13900064
             WHEN PA-CNT-LPS = 6                                        13910064
                  DISPLAY 'LPS FILE6 PROMO ID = ' PM122-PROMO-ID        13920064
                  WRITE PROMO-ID-REC-32                                 13930064
                        FROM PM122-PROMO-ID-REC                         13940064
             WHEN PA-CNT-LPS = 7                                        13950064
                  DISPLAY 'LPS FILE7 PROMO ID = ' PM122-PROMO-ID        13960064
                  WRITE PROMO-ID-REC-33                                 13970064
                        FROM PM122-PROMO-ID-REC                         13980064
             WHEN PA-CNT-LPS = 8                                        13990064
                  DISPLAY 'LPS FILE8 PROMO ID = ' PM122-PROMO-ID        14000064
                  WRITE PROMO-ID-REC-34                                 14010064
                        FROM PM122-PROMO-ID-REC                         14020064
             WHEN OTHER                                                 14030064
                  DISPLAY 'TOO MANY LPS PROMOTIONS!!!'                  14040064
           END-EVALUATE.                                                14050064
                                                                        14060064
      *9200-EXIT.                                                       14070064
       EJECT.                                                           14080064
                                                                        14090064
      *----------------------------------------------------------       14100064
      * 9800-ABEND.                                                     14110064
      *     PERFORMS A NON-SQL-ABEND.                                   14120064
      *----------------------------------------------------------       14130064
       9800-ABEND.                                                      14140064
                                                                        14150064
           DISPLAY '** ABEND           **'.                             14160064
070941*    DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  14170071
70941      DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          14171068
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        14180064
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         14190064
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       14200064
                                                                        14210064
           CALL 'ILBOABN0' USING ABEND-CODE.                            14220064
                                                                        14230064
      *9800-EXIT.                                                       14240064
       EJECT.                                                           14250064
                                                                        14260064
      *----------------------------------------------------------       14270064
      * 9900-ORACLE-ABEND.                                              14280064
      *     PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE.            14290064
      *----------------------------------------------------------       14300064
       9900-ORACLE-ABEND.                                               14310064
                                                                        14320064
           DISPLAY '                       '.                           14330064
           DISPLAY '** ABEND **       ** =   SQLERROR'.                 14340070
070941*    DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.   14350071
70941      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.           14351068
           DISPLAY '** SQLCODE        ** = ' PV-SQL-CODE.               14360064
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                14370064
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   14380064
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  14390064
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                14400064
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         14410064
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             14420064
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG.          14430064
           DISPLAY '                       '.                           14440064
                                                                        14450064
           CALL 'ILBOABN0' USING ABEND-CODE.                            14460064
                                                                        14470064
      *9900-EXIT.                                                       14480064
       EJECT.                                                           14490064
                                                                        14500064
      *----------------------------------------------------------       14730064
      * 9999-WRAPUP.                                                    14740064
      *     END OF PROGRAM ROUTINE.  CLOSES ALL FILES AND DISPLAYS      14750064
      *     ANY DATA FROM THE PROGRAM.                                  14760064
      *----------------------------------------------------------       14770064
       9999-WRAPUP.                                                     14780064
                                                                        14790064
           CLOSE CONTROL-CARD-FILE                                      14800064
                 LPS-PROMO-ID-CC-FILE                                   14810064
070941*          IN-ORACLE-SRC-CTL                                      14820071
                 PROMO-ID-FILE-1                                        14830064
                 PROMO-ID-FILE-2                                        14840064
                 PROMO-ID-FILE-3                                        14850064
                 PROMO-ID-FILE-4                                        14860064
                 PROMO-ID-FILE-5                                        14870064
                 PROMO-ID-FILE-6                                        14880064
                 PROMO-ID-FILE-7                                        14890064
                 PROMO-ID-FILE-8                                        14900064
                 PROMO-ID-FILE-9                                        14910064
                 PROMO-ID-FILE-10                                       14920064
                 PROMO-ID-FILE-11                                       14930064
                 PROMO-ID-FILE-12                                       14940064
                 PROMO-ID-FILE-13                                       14950064
                 PROMO-ID-FILE-14                                       14960064
                 PROMO-ID-FILE-15                                       14970064
                 PROMO-ID-FILE-16                                       14980064
                 PROMO-ID-FILE-17                                       14990064
                 PROMO-ID-FILE-18                                       15000064
                 PROMO-ID-FILE-19                                       15010064
                 PROMO-ID-FILE-20                                       15020064
                 PROMO-ID-FILE-21                                       15030064
                 PROMO-ID-FILE-22                                       15040064
                 PROMO-ID-FILE-23                                       15050064
                 PROMO-ID-FILE-24                                       15060064
                 PROMO-ID-FILE-25                                       15070064
                 PROMO-ID-FILE-26                                       15080064
                 PROMO-ID-FILE-27                                       15090064
                 PROMO-ID-FILE-28                                       15100064
                 PROMO-ID-FILE-29                                       15110064
                 PROMO-ID-FILE-30                                       15120064
                 PROMO-ID-FILE-31                                       15130064
                 PROMO-ID-FILE-32                                       15140064
                 PROMO-ID-FILE-33                                       15150064
                 PROMO-ID-FILE-34.                                      15160064
                                                                        15170064
           DISPLAY ' '.                                                 15180064
           DISPLAY '*********************************************'.     15190064
           DISPLAY 'PROGRAM NAME: ' PC-PROGRAM-NAME.                    15200068
           DISPLAY '*********************************************'.     15210064
           DISPLAY 'NUMBER OF MAIN PROMOTIONS: ' PA-CNT-MAIN.           15220064
           DISPLAY 'NUMBER OF NONMAIN PROMOTIONS: ' PA-CNT-NONMAIN.     15230064
           DISPLAY 'NUMBER OF LPS PROMOTIONS: ' PA-CNT-LPS.             15240064
           DISPLAY 'NUMBER OF PROMOTIONS: ' PA-PROMO-CNT.               15250064
           DISPLAY '*********************************************'.     15260064
                                                                        15270064
      *9999-EXIT.                                                       15280064
       EJECT.                                                           15290064
                                                                        15300064
