000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      SNKUT444.                                       00040000
000500 AUTHOR.          NATALIYA PALATNIK.                              00050000
000600 DATE-WRITTEN.    05/07/93.                                       00060000
000700******************************************************************00070000
000800* ASN TABLES VERIFICATION PROGRAM                                *00080000
000900*                                                                *00090000
001000*                                                                *00100000
001100*                                                                *00110000
001200******************************************************************00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 CONFIGURATION SECTION.                                           00140000
001500 SOURCE-COMPUTER. IBM-3090.                                       00150000
001600 OBJECT-COMPUTER. IBM-3090.                                       00160000
001700                                                                  00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900 FILE-CONTROL.                                                    00190000
002000                                                                  00200000
002100     SELECT ADV-SHIP-NOTICE-REPORT                                00210000
002200         ASSIGN                       TO RPT01.                   00220000
002300                                                                  00230000
002400     SELECT ASNHDR-DELETE-FILE                                    00240000
002500            ASSIGN TO OUT01.                                      00250000
002600                                                                  00260000
002610     SELECT ASNHDR-READABLE-DELETE-FILE                           00261003
002620            ASSIGN TO OUT02.                                      00262003
002630                                                                  00263003
002700/                                                                 00270000
002800                                                                  00280000
002900***************                                                   00290000
003000 DATA DIVISION.                                                   00300000
003100***************                                                   00310000
003200 FILE SECTION.                                                    00320000
003300                                                                  00330000
003400                                                                  00340000
003500 FD  ADV-SHIP-NOTICE-REPORT                                       00350000
003600     RECORDING MODE F                                             00360000
003700     BLOCK CONTAINS 0 RECORDS                                     00370000
003800     RECORD CONTAINS 132 CHARACTERS                               00380000
003900     LABEL RECORDS ARE OMITTED                                    00390000
004000     DATA RECORD IS ADV-SHIP-NOTICE-LINE.                         00400000
004100 01  ADV-SHIP-NOTICE-LINE                PIC X(132).              00410000
004200                                                                  00420000
004300 FD  ASNHDR-DELETE-FILE                                           00430000
004400     RECORDING MODE IS F                                          00440000
004500     LABEL RECORDS ARE STANDARD                                   00450000
004600     RECORD CONTAINS 5  CHARACTERS                                00460000
004700     BLOCK CONTAINS 0 RECORDS.                                    00470000
004800                                                                  00480000
004900 01  ASNHDR-DELETE-RECORD        PIC X(5).                        00490000
005000                                                                  00500000
005010 FD  ASNHDR-READABLE-DELETE-FILE                                  00501003
005020     RECORDING MODE IS F                                          00502003
005030     LABEL RECORDS ARE STANDARD                                   00503003
005040     RECORD CONTAINS 75 CHARACTERS                                00504005
005050     BLOCK CONTAINS 0 RECORDS.                                    00505003
005060                                                                  00506003
005070 01  ASNHDR-READABLE-DELETE-RECORD       PIC X(75).               00507005
005080                                                                  00508003
005100/                                                                 00510000
005200/                                                                 00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400/                                                                 00540000
005500****************************************************************  00550000
005600 01  FILLER                           PIC X(08) VALUE 'BEGIN WS'. 00560000
005700****************************************************************  00570000
005800/                                                                 00580000
005900*                                                                 00590000
006000*  STANDARD HEADER LINE - KOHLS 132 COL                           00600000
006100*                                                                 00610000
006200     COPY DPWS132O.                                               00620000
006300/                                                                 00630000
006400 01  H2-HEADING-LINE2.                                            00640000
006500     05  FILLER                       PIC X(43)      VALUE SPACE. 00650000
006600     05  FILLER                       PIC X(48)      VALUE        00660000
006700         'ADVANCE SHIP NOTICE TABLES TOP DOWN CHECK REPORT'.      00670000
006800     05  FILLER                       PIC X(41)      VALUE SPACE. 00680000
006900                                                                  00690000
007000 01  H3-HEADING-LINE3.                                            00700000
007100     05  FILLER                       PIC X(02)      VALUE SPACE. 00710000
007200     05  FILLER                       PIC X(57)      VALUE        00720000
007300     'ORDER OR ITEM LEVELS ARE MISSING FOR FOLLOWING SHIPMENTS:'. 00730000
007400     05  FILLER                       PIC X(74)      VALUE SPACE. 00740000
007500                                                                  00750000
007600 01  H4-HEADING-LINE4.                                            00760000
007700     05  FILLER                       PIC X(02)      VALUE SPACE. 00770000
007800     05  FILLER                       PIC X(57)      VALUE        00780000
007900     '                                                         '. 00790000
008000     05  FILLER                       PIC X(74)      VALUE SPACE. 00800000
008100/                                                                 00810000
008200 01  END-OF-REPORT-LINE.                                          00820000
008300     05  FILLER                       PIC X(132)     VALUE        00830000
008400         '  ** END OF REPORT **         '.                        00840000
008500/                                                                 00850000
008600/                                                                 00860000
008700 01  CD-CPU-DATE.                                                 00870000
008800     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE ZEROS. 00880000
008900     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE ZEROS. 00890000
009000     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE ZEROS. 00900000
009100                                                                  00910000
009200 01  CT-CPU-TIME.                                                 00920000
009300     05  CD-CPU-TIME-HH               PIC 9(02)      VALUE ZEROS. 00930000
009400     05  CD-CPU-TIME-MM               PIC 9(02)      VALUE ZEROS. 00940000
009500     05  CD-CPU-TIME-SS               PIC 9(02)      VALUE ZEROS. 00950000
009600     05  CD-CPU-TIME-HS               PIC 9(02)      VALUE ZEROS. 00960000
009700                                                                  00970000
009800 01  PA-PROGRAM-ACCUMULATORS.                                     00980000
009900                                                                  00990000
010000     05  PA-LINE-CNT                  PIC S9(03)     VALUE +99    01000000
010100                                                     COMP-3.      01010000
010200     05  PA-PAGE-CNT                  PIC 9(03)      VALUE ZEROS  01020000
010300                                                     COMP-3.      01030000
010400                                                                  01040000
010500                                                                  01050000
010600 01  PC-PROGRAM-CONTROLS.                                         01060000
010700     05  PC-MAX-LINES                 PIC S9(03)     VALUE +48    01070000
010800                                                     COMP-3.      01080000
010900     05  PC-OPERCO-NBR                PIC  X(02)     VALUE '03'.  01090000
011000     05  PC-NEG-1                     PIC S9(03)     VALUE -1     01100000
011100                                                     COMP-3.      01110000
011200     05  PC-NEG-803                   PIC S9(03)     VALUE -803   01120000
011300                                                     COMP-3.      01130000
011400     05  PC-POS-1                     PIC S9(03)     VALUE +1     01140000
011500                                                     COMP-3.      01150000
011600     05  PC-POS-2                     PIC S9(03)     VALUE +2     01160000
011700                                                     COMP-3.      01170000
011800     05  PC-POS-3                     PIC S9(03)     VALUE +3     01180000
011900                                                     COMP-3.      01190000
012000     05  PC-POS-4                     PIC S9(03)     VALUE +4     01200000
012100                                                     COMP-3.      01210000
012200     05  PC-POS-10                    PIC S9(03)     VALUE +10    01220000
012300                                                     COMP-3.      01230000
012400     05  PC-POS-19                    PIC S9(03)     VALUE +19    01240000
012500                                                     COMP-3.      01250000
012600     05  PC-POS-20                    PIC S9(03)     VALUE +20    01260000
012700                                                     COMP-3.      01270000
012800     05  PC-POS-30                    PIC S9(04)     VALUE +30    01280000
012900                                                     COMP-3.      01290000
013000     05  PC-POS-54                    PIC S9(04)     VALUE +54    01300000
013100                                                     COMP-3.      01310000
013200     05  PC-POS-100                   PIC S9(04)     VALUE +100   01320000
013300                                                     COMP-3.      01330000
013400     05  PC-MAX-RETRIES               PIC S9(03)     VALUE +5     01340000
013500                                                     COMP-3.      01350000
013600     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   01360000
013700                                                     COMP SYNC.   01370000
013800     05  PC-NEG-904                   PIC S9(04)     VALUE -904   01380000
013900                                                     COMP SYNC.   01390000
014000     05  PC-NEG-913                   PIC S9(04)     VALUE -913   01400000
014100                                                     COMP SYNC.   01410000
014200                                                                  01420000
014300 01  PS-PROGRAM-SWITCHES.                                         01430000
014400     05  PS-END-OF-ISA-SW             PIC X(01)      VALUE 'N'.   01440000
014500         88  END-OF-ISA                              VALUE 'Y'.   01450000
014600         88  NEW-ISA                                 VALUE 'N'.   01460000
014700     05  PS-DB2-DATA-SW               PIC X(01)      VALUE 'N'.   01470000
014800         88  PS-NO-DATA-LEFT                         VALUE 'Y'.   01480000
014900         88  PS-DATA-ON-TABLE                        VALUE 'N'.   01490000
015000     05  PS-ERROR-SW                  PIC X(01)      VALUE 'N'.   01500000
015100         88 ERROR-DETECTED                           VALUE 'Y'.   01510000
015200         88 ERROR-NOT-DETECTED                       VALUE 'N'.   01520000
015300     05  PS-RET-CODE-SW               PIC X(01)      VALUE 'N'.   01530000
015400         88 SET-RET-CODE                             VALUE 'Y'.   01540000
015500         88 DONT-SET-RET-CODE                        VALUE 'N'.   01550000
015600/                                                                 01560000
015700/                                                                 01570000
015800 01  PW-PROGRAM-WORKAREA.                                         01580000
015900     05  PW-RETRY-COUNTER             PIC S9(04)     VALUE +0     01590000
016000                                                     COMP SYNC.   01600000
016100     05  PW-SUB                       PIC S9(03)     COMP-3       01610000
016200                                                     VALUE ZERO.  01620000
016300     05  PW-SQLCODE                   PIC  9(06)     VALUE ZERO.  01630000
016400     05  PW-LIN-SUB                   PIC S9(03)     COMP-3       01640000
016500                                                     VALUE ZERO.  01650000
016600     05  PW-DATE-YYMMDD.                                          01660000
016700         10  PW-DATE-YY               PIC 9(02)       VALUE ZEROS.01670000
016800         10  PW-DATE-MM               PIC 9(02)       VALUE ZEROS.01680000
016900         10  PW-DATE-DD               PIC 9(02)       VALUE ZEROS.01690000
017000                                                                  01700000
017100 01  PW-CURRENT-PARA                  PIC X(35)       VALUE SPACE.01710000
017200                                                                  01720000
017300 01  PW-ADV-SHIP-NOTICE-LINE          PIC X(132).                 01730000
017400/                                                                 01740000
017500 01  MSG-LINES.                                                   01750000
017600     05  MSG-1B.                                                  01760000
017700         10  FILLER                   PIC X(02)       VALUE SPACE.01770000
017800         10  FILLER                   PIC X(52)       VALUE       01780000
017900        'ORDER AND ITEM LEVELS ARE PRESENT FOR ALL SHIPMENTS'.    01790000
018000         10  FILLER                   PIC X(68)       VALUE SPACE.01800000
018100     05  MSG-1C.                                                  01810000
018200         10  FILLER                   PIC X(02)       VALUE SPACE.01820000
018300         10  FILLER                   PIC X(41)       VALUE       01830000
018400             '** MISSING ORDER OR ITEM LEVELS ARE FOUND'.         01840000
018500         10  FILLER                   PIC X(72)       VALUE SPACE.01850000
018600/                                                                 01860000
018700                                                                  01870000
018800 01  PW-ASNHDR-RECORD.                                            01880000
018900      05 FILLER                       PIC  X(08)      VALUE       01890000
019000                                             'OPERCO ='.          01900000
019100      05 PW-ASNHDR-OPERCO-NBR         PIC  X(02)      VALUE SPACE.01910000
019200      05 FILLER                       PIC  X(14)      VALUE       01920000
019300                                             ' EDI-VEND-ID ='.    01930000
019400      05 PW-ASNHDR-EDI-VEND-ID        PIC  X(17)      VALUE SPACE.01940000
019500      05 FILLER                       PIC  X(13)      VALUE       01950000
019600                                             ' ASNHDR-NBR ='.     01960000
019700      05 PW-ASNHDR-ASNHDR-NBR         PIC  X(30)      VALUE SPACE.01970000
019800      05 FILLER                       PIC  X(13)      VALUE       01980000
019900                                             ' ASNHDR-ID  ='.     01990000
020000      05 PW-ASNHDR-ID                 PIC  9(09)      VALUE ZERO. 02000000
020001      05 PW-OUTPUT-WRITE-COUNT        PIC  9(09)      VALUE ZERO. 02000101
020010      05 PW-DISPLAY-NBR               PIC  ZZZZZZZZ9  VALUE ZERO. 02001001
020100 01  PW-ASNHDR-ASNHDR-ID              PIC S9(09)      VALUE ZERO  02010000
020200                                                      COMP.       02020000
020300/                                                                 02030000
020400 01  ABEND-CODE                       PIC S9(04)     VALUE +0     02040000
020500                                                     COMP SYNC.   02050000
020600     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 02060000
020700     88  ABEND-4002-READ-ERROR                       VALUE +4002. 02070000
020800     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 02080000
020900     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 02090000
021000     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 02100000
021100     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 02110000
021200     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 02120000
021300     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 02130000
021400     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 02140000
021500     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 02150000
021600                                                                  02160000
021700*  ASNHDR DELETE RECORD LAYOUT                                    02170000
021800*                                                                 02180000
021900     COPY SNRD002O.                                               02190000
021901                                                                  02190103
021910*  ASNHDR DELETE RECORD LAYOUT - HUMAN READABLE FORMAT            02191003
021920*                                                                 02192003
021930     COPY SNRD007.                                                02193003
022000/                                                                 02200000
022100/                                                                 02210000
022200*  VE ADVANCE SHIP NOTICE TABLE LAYOUT                            02220000
022300*                                                                 02230000
022400     EXEC SQL                                                     02240000
022500         INCLUDE TASNHDR                                          02250000
022600     END-EXEC.                                                    02260000
022700/                                                                 02270000
022800*  VE ASN SHIPPED ORDER TABLE LAYOUT                              02280000
022900*                                                                 02290000
023000     EXEC SQL                                                     02300000
023100         INCLUDE TASNORD                                          02310000
023200     END-EXEC.                                                    02320000
023300/                                                                 02330000
023400*  VE ASN ITEM TABLE LAYOUT                                       02340000
023500*                                                                 02350000
023600     EXEC SQL                                                     02360000
023700         INCLUDE TASNDTL                                          02370000
023800     END-EXEC.                                                    02380000
023900/                                                                 02390000
024000* DB2 COMMUNICATION AREA.                                         02400000
024100*                                                                 02410000
024200     EXEC SQL                                                     02420000
024300         INCLUDE SQLCA                                            02430000
024400     END-EXEC.                                                    02440000
024500/                                                                 02450000
024600* DB2 COMMUNICATION AREA 2                                        02460000
024700*                                                                 02470000
024800     COPY SQLCA2.                                                 02480000
024900/                                                                 02490000
025000*                                                                 02500000
025100* CURSOR TO FETCH ASN HEADER TABLE                                02510000
025200*                                                                 02520000
025300     EXEC SQL                                                     02530000
025400       DECLARE ASNHDR_CURSOR CURSOR FOR                           02540000
025500           SELECT                                                 02550000
025600             A.OPERCO_NBR,                                        02560000
025700             A.EDI_VEND_ID,                                       02570000
025800             A.ASNHDR_NBR,                                        02580000
025900             A.ASNHDR_ID                                          02590000
026000        FROM TASNHDR  A                                           02600000
026100        WHERE  NOT EXISTS                                         02610000
026200          (SELECT 1                                               02620000
026300             FROM                                                 02630000
026400               TASNORD  B,                                        02640000
026500               TASNDTL  C                                         02650000
026600             WHERE                                                02660000
026700                A.ASNHDR_ID  = B.ASNHDR_ID                        02670000
026800          AND   B.ASNHDR_ID  = C.ASNHDR_ID                        02680000
026900          AND   B.PO_NBR =  C.PO_NBR                              02690000
027000          AND   B.SELR_INV_NBR  = C.SELR_INV_NBR)                 02700000
027100     END-EXEC.                                                    02710000
027200/                                                                 02720000
027300/                                                                 02730000
027400****************************************************************  02740000
027500 01  FILLER                           PIC X(08) VALUE 'END WS  '. 02750000
027600****************************************************************  02760000
027700/                                                                 02770000
027800****************************************************************  02780000
027900 PROCEDURE DIVISION.                                              02790000
028000****************************************************************  02800000
028100                                                                  02810000
028200***************************************************************** 02820000
028300*     MAINLINE                                                  * 02830000
028400*                                                               * 02840000
028500*   - MAINLINE PROCESSING                                       * 02850000
028600***************************************************************** 02860000
028700 0000-MAINLINE.                                                   02870000
028800     MOVE '0000-MAINLINE                  '                       02880000
028900                                 TO PW-CURRENT-PARA.              02890000
029000*    DISPLAY '0000-MAINLINE'.                                     02900000
029100     OPEN  OUTPUT ADV-SHIP-NOTICE-REPORT                          02910000
029200                  ASNHDR-DELETE-FILE                              02920003
029210                  ASNHDR-READABLE-DELETE-FILE.                    02921003
029300                                                                  02930000
029400     INITIALIZE SN002O-ASN-DELETE-RECORD                          02940003
029410                SN007-ASN-DELETE-RECORD.                          02941003
029500                                                                  02950000
029600        PERFORM A000-ACCEPT-CURR-DATE-TIME.                       02960000
029700        PERFORM Z600-PROCESS-HEADING-LINES.                       02970000
029800                                                                  02980000
029900        PERFORM A100-PROCESS-ASN.                                 02990000
030000                                                                  03000000
030100        MOVE  END-OF-REPORT-LINE                                  03010000
030200                  TO  PW-ADV-SHIP-NOTICE-LINE.                    03020000
030300        PERFORM  Z510-WRITE-REPORT-LINE.                          03030000
030400                                                                  03040000
030620     MOVE PW-OUTPUT-WRITE-COUNT TO PW-DISPLAY-NBR.                03062001
030630     DISPLAY 'OUTPUT FILE COUNT: ' PW-DISPLAY-NBR.                03063001
030631                                                                  03063107
030632     IF  PW-OUTPUT-WRITE-COUNT > 0                                03063207
031263         MOVE SPACES  TO  SN007-RECORD                            03126308
031264         STRING ' OUTPUT FILE COUNT: ' PW-DISPLAY-NBR             03126407
031267                 DELIMITED BY SIZE                                03126707
031268            INTO SN007-RECORD                                     03126807
031269         WRITE ASNHDR-READABLE-DELETE-RECORD                      03126907
031270            FROM SN007-ASN-DELETE-RECORD                          03127007
031271                                                                  03127109
031272         MOVE SPACES  TO  SN007-RECORD                            03127209
031275         WRITE ASNHDR-READABLE-DELETE-RECORD                      03127509
031276            FROM SN007-ASN-DELETE-RECORD                          03127609
031277     END-IF.                                                      03127707
031280                                                                  03128008
031281     CLOSE    ADV-SHIP-NOTICE-REPORT                              03128108
031282                  ASNHDR-DELETE-FILE                              03128208
031283                  ASNHDR-READABLE-DELETE-FILE.                    03128308
031284                                                                  03128408
031285                                                                  03128501
031286     IF SET-RET-CODE                                              03128600
031287         MOVE +4008 TO RETURN-CODE                                03128700
031288     END-IF.                                                      03128800
031289     STOP RUN.                                                    03128900
031290*                                                                 03129000
031300***************************************************************** 03130000
031400 A000-ACCEPT-CURR-DATE-TIME.                                      03140000
031500     MOVE 'A000-ACCEPT-CURR-DATE-TIME     '                       03150000
031600                                 TO PW-CURRENT-PARA.              03160000
031700*    DISPLAY 'A000-ACCEPT-CURR-DATE-TIME'.                        03170000
031800                                                                  03180000
031900     ACCEPT CT-CPU-TIME FROM TIME.                                03190000
032000     MOVE CD-CPU-TIME-HH         TO DP132O-RUN-HOUR.              03200000
032100     MOVE CD-CPU-TIME-MM         TO DP132O-RUN-MINUTE.            03210000
032200                                                                  03220000
032300     ACCEPT CD-CPU-DATE FROM DATE.                                03230000
032400     MOVE CD-CPU-DATE-MM         TO DP132O-RUN-MONTH.             03240000
032500     MOVE CD-CPU-DATE-DD         TO DP132O-RUN-DAY.               03250000
032600     MOVE CD-CPU-DATE-YY         TO DP132O-RUN-YEAR.              03260000
032700/                                                                 03270000
032800***************************************************************** 03280000
032900*                                                               * 03290000
033000*                                                               * 03300000
033100***************************************************************** 03310000
033200 A100-PROCESS-ASN.                                                03320000
033300     MOVE 'A100-PROCESS-ASN               '                       03330000
033400                                 TO PW-CURRENT-PARA.              03340000
033500                                                                  03350000
033600      PERFORM  X100-OPEN-ASNHDR-CURSOR.                           03360000
033700                                                                  03370000
033800      SET ERROR-NOT-DETECTED  TO TRUE.                            03380000
033900                                                                  03390000
034000      PERFORM  UNTIL PS-NO-DATA-LEFT                              03400000
034100        PERFORM  B100-PROCESS-TASNHDR                             03410000
034200      END-PERFORM.                                                03420000
034300      PERFORM  X300-CLOSE-ASNHDR-CURSOR.                          03430000
034400        IF ERROR-NOT-DETECTED                                     03440000
034500           DISPLAY MSG-1B                                         03450000
034510           MOVE MSG-1B                                            03451000
034600                  TO  PW-ADV-SHIP-NOTICE-LINE                     03460000
034700            PERFORM  Z510-WRITE-REPORT-LINE                       03470000
034800        ELSE                                                      03480000
034900           DISPLAY MSG-1C                                         03490000
034910           MOVE MSG-1C                                            03491000
035000                  TO  PW-ADV-SHIP-NOTICE-LINE                     03500000
035100            PERFORM  Z510-WRITE-REPORT-LINE                       03510000
035200            SET SET-RET-CODE  TO TRUE                             03520000
035210                                                                  03521005
035212            MOVE SPACES      TO SN007-RECORD                      03521211
035213            WRITE ASNHDR-READABLE-DELETE-RECORD                   03521311
035214               FROM SN007-ASN-DELETE-RECORD                       03521411
035215                                                                  03521511
035216            INITIALIZE SN007-RECORD                               03521611
035220            INITIALIZE SN007-RECORD                               03522005
035270            MOVE MSG-1C      TO SN007-RECORD                      03527005
035280            WRITE ASNHDR-READABLE-DELETE-RECORD                   03528005
035290               FROM SN007-ASN-DELETE-RECORD                       03529005
035291                                                                  03529105
035292            MOVE SPACES      TO SN007-RECORD                      03529206
035293            WRITE ASNHDR-READABLE-DELETE-RECORD                   03529306
035294               FROM SN007-ASN-DELETE-RECORD                       03529406
035295                                                                  03529506
035300        END-IF.                                                   03530000
035400                                                                  03540000
035500*                                                                 03550000
035600***************************************************************** 03560000
035700*                                                               * 03570000
035800***************************************************************** 03580000
035900 B100-PROCESS-TASNHDR.                                            03590000
036000     MOVE 'B100-PROCESS-TASNHDR           '                       03600000
036100                                 TO PW-CURRENT-PARA.              03610000
036200     INITIALIZE SN002O-ASN-DELETE-RECORD                          03620003
036210                SN007-ASN-DELETE-RECORD.                          03621003
036300                                                                  03630000
036400      PERFORM  X200-FETCH-ASNHDR-CURSOR.                          03640000
036500      IF SQLCODE = ZERO                                           03650000
036600            MOVE  PW-ASNHDR-ASNHDR-ID  TO PW-ASNHDR-ID            03660000
036700            MOVE PW-ASNHDR-RECORD                                 03670000
036800                  TO  PW-ADV-SHIP-NOTICE-LINE                     03680000
036900            PERFORM  Z500-WRITE-REPORT-LINE                       03690000
037000                 SET ERROR-DETECTED  TO TRUE                      03700000
037100                                                                  03710000
037500            MOVE  PW-ASNHDR-ASNHDR-ID  TO SN002O-ASNHDR-ID        03750000
037600                                                                  03760000
037700            WRITE ASNHDR-DELETE-RECORD                            03770000
037800               FROM SN002O-ASN-DELETE-RECORD                      03780000
037810                                                                  03781001
037814            ADD +1 TO PW-OUTPUT-WRITE-COUNT                       03781401
037815                                                                  03781501
037820            MOVE PW-ASNHDR-ASNHDR-ID TO PW-DISPLAY-NBR            03782001
037830            DISPLAY ' MISSING ASNORD AND OR ASNDTL DATA FOR'      03783002
037840                    ' ASN ID: ' PW-DISPLAY-NBR                    03784001
037850                    ' AND NBR: ' PW-ASNHDR-ASNHDR-NBR             03785001
037859                                                                  03785911
037860            MOVE SPACES      TO SN007-RECORD                      03786011
037861            WRITE ASNHDR-READABLE-DELETE-RECORD                   03786111
037862               FROM SN007-ASN-DELETE-RECORD                       03786211
037863            INITIALIZE SN007-RECORD                               03786311
037864                                                                  03786411
037865            STRING ' MISSING ASNORD AND OR ASNDTL DATA FOR'       03786505
037870                    ' ASN ID: ' PW-DISPLAY-NBR                    03787005
037880                    ' AND NBR: ' PW-ASNHDR-ASNHDR-NBR             03788005
037890                    DELIMITED BY SIZE                             03789005
037900               INTO SN007-RECORD                                  03790005
037910            WRITE ASNHDR-READABLE-DELETE-RECORD                   03791005
037920               FROM SN007-ASN-DELETE-RECORD                       03792005
037970                                                                  03797010
038000      END-IF.                                                     03800000
038100***************************************************************** 03810000
038200*     SQL FETCH CURSOR ON TASNHDR                               * 03820000
038300*                                                               * 03830000
038400***************************************************************** 03840000
038500 X200-FETCH-ASNHDR-CURSOR.                                        03850000
038600                                                                  03860000
038700     MOVE 'X200-FETCH-ASNHDR-CURSOR           '                   03870000
038800                                 TO PW-CURRENT-PARA.              03880000
038900         EXEC SQL                                                 03890000
039000          FETCH ASNHDR_CURSOR                                     03900000
039100          INTO :PW-ASNHDR-OPERCO-NBR,                             03910000
039200               :PW-ASNHDR-EDI-VEND-ID,                            03920000
039300               :PW-ASNHDR-ASNHDR-NBR,                             03930000
039400               :PW-ASNHDR-ASNHDR-ID                               03940000
039500         END-EXEC.                                                03950000
039600                                                                  03960000
039700                                                                  03970000
039800         EVALUATE TRUE                                            03980000
039900           WHEN SQLCODE = ZERO                                    03990000
040000                 CONTINUE                                         04000000
040100           WHEN SQLCODE = +100                                    04010000
040200              SET PS-NO-DATA-LEFT      TO TRUE                    04020000
040300           WHEN SQLCODE < ZERO                                    04030000
040400                 DISPLAY '**************************************' 04040000
040500                 DISPLAY 'ERROR ISSUED ON FETCH OF ASNHDR CURSOR' 04050000
040600                 DISPLAY 'OPERCO-NBR:         '                   04060000
040700                          ASNHDR-OPERCO-NBR                       04070000
040800                 DISPLAY 'EDI-VEND-ID:   '                        04080000
040900                          ASNHDR-EDI-VEND-ID                      04090000
041000                 DISPLAY 'ASNHDR-NBR:         '                   04100000
041100                          ASNHDR-ASNHDR-NBR                       04110000
041200                 DISPLAY '**************************************' 04120000
041300                 PERFORM Z900-SQL-ERROR                           04130000
041400                                                                  04140000
041500         END-EVALUATE.                                            04150000
041600                                                                  04160000
041700/                                                                 04170000
041800***************************************************************** 04180000
041900*     SQL OPEN  CURSOR ON TASNHDR                               * 04190000
042000*                                                               * 04200000
042100***************************************************************** 04210000
042200 X100-OPEN-ASNHDR-CURSOR.                                         04220000
042300                                                                  04230000
042400     MOVE 'X100-OPEN-ASNHDR-CURSOR           '                    04240000
042500                                 TO PW-CURRENT-PARA.              04250000
042600         EXEC SQL                                                 04260000
042700          OPEN ASNHDR_CURSOR                                      04270000
042800         END-EXEC.                                                04280000
042900                                                                  04290000
043000         EVALUATE TRUE                                            04300000
043100           WHEN SQLCODE = ZERO                                    04310000
043200           WHEN SQLCODE = +100                                    04320000
043300                 CONTINUE                                         04330000
043400           WHEN  OTHER                                            04340000
043500                 DISPLAY '**************************************' 04350000
043600                 DISPLAY 'ERROR ISSUED ON OPEN OF ASNHDR CURSOR'  04360000
043700                 DISPLAY '**************************************' 04370000
043800                 PERFORM Z900-SQL-ERROR                           04380000
043900                                                                  04390000
044000         END-EVALUATE.                                            04400000
044100                                                                  04410000
044200/                                                                 04420000
044300***************************************************************** 04430000
044400*     SQL CLOSE CURSOR ON TASNHDR                               * 04440000
044500*                                                               * 04450000
044600***************************************************************** 04460000
044700 X300-CLOSE-ASNHDR-CURSOR.                                        04470000
044800                                                                  04480000
044900     MOVE 'X300-CLOSE-ASOHDR-CURSOR          '                    04490000
045000                                 TO PW-CURRENT-PARA.              04500000
045100         EXEC SQL                                                 04510000
045200          CLOSE ASNHDR_CURSOR                                     04520000
045300         END-EXEC.                                                04530000
045400                                                                  04540000
045500         EVALUATE TRUE                                            04550000
045600           WHEN SQLCODE = ZERO                                    04560000
045700           WHEN SQLCODE = +100                                    04570000
045800                 CONTINUE                                         04580000
045900           WHEN  OTHER                                            04590000
046000               DISPLAY '**************************************'   04600000
046100               DISPLAY 'ERROR ISSUED ON CLOSE OF ASNHDR CURSOR'   04610000
046200               DISPLAY '**************************************'   04620000
046300                 PERFORM Z900-SQL-ERROR                           04630000
046400                                                                  04640000
046500         END-EVALUATE.                                            04650000
046600                                                                  04660000
046700/                                                                 04670000
046800***************************************************************** 04680000
046900****************************************************************  04690000
047000*     WRITE-REPORT-LINE                                        *  04700000
047100*                                                              *  04710000
047200*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  04720000
047300****************************************************************  04730000
047400 Z500-WRITE-REPORT-LINE.                                          04740000
047500     MOVE 'Z500-WRITE-REPORT-LINE         '                       04750000
047600                                 TO PW-CURRENT-PARA.              04760000
047700*    DISPLAY 'Z500-WRITE-REPORT-LINE'.                            04770000
047800                                                                  04780000
047900     ADD 1                       TO PA-LINE-CNT.                  04790000
048000                                                                  04800000
048100     IF PA-LINE-CNT > PC-POS-54                                   04810000
048200         PERFORM Z600-PROCESS-HEADING-LINES                       04820000
048300     END-IF.                                                      04830000
048400                                                                  04840000
048500     WRITE ADV-SHIP-NOTICE-LINE                                   04850000
048600       FROM PW-ADV-SHIP-NOTICE-LINE                               04860000
048700       AFTER ADVANCING 1 LINE.                                    04870000
048800/                                                                 04880000
048900****************************************************************  04890000
049000*     WRITE-REPORT-LINE                                        *  04900000
049100*                                                              *  04910000
049200*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  04920000
049300****************************************************************  04930000
049400 Z510-WRITE-REPORT-LINE.                                          04940000
049500     MOVE 'Z510-WRITE-REPORT-LINE         '                       04950000
049600                                 TO PW-CURRENT-PARA.              04960000
049700*    DISPLAY 'Z510-WRITE-REPORT-LINE'.                            04970000
049800                                                                  04980000
049900     ADD 2                       TO PA-LINE-CNT.                  04990000
050000                                                                  05000000
050100     IF PA-LINE-CNT > PC-POS-54                                   05010000
050200         PERFORM Z600-PROCESS-HEADING-LINES                       05020000
050300     END-IF.                                                      05030000
050400                                                                  05040000
050500     WRITE ADV-SHIP-NOTICE-LINE                                   05050000
050600       FROM PW-ADV-SHIP-NOTICE-LINE                               05060000
050700       AFTER ADVANCING 2 LINE.                                    05070000
050800/                                                                 05080000
050900****************************************************************  05090000
051000*     PROCESS-HEADING-LINES                                    *  05100000
051100*                                                              *  05110000
051200*     -  CONTROL THE LOADING AND PRINTING OF THE HEADING LINES *  05120000
051300****************************************************************  05130000
051400 Z600-PROCESS-HEADING-LINES.                                      05140000
051500     MOVE 'Z600-PROCESS-HEADING-LINES     '                       05150000
051600                                 TO PW-CURRENT-PARA.              05160000
051700*    DISPLAY 'Z600-PROCESS-HEADING-LINES'.                        05170000
051800                                                                  05180000
051900     MOVE 'SNKRP444'             TO DP132O-PROGRAM-NAME.          05190000
052000     MOVE 1                      TO DP132O-REPORT-NUMBER.         05200000
052100                                                                  05210000
052200     ADD 1                       TO PA-PAGE-CNT.                  05220000
052300     MOVE PA-PAGE-CNT            TO DP132O-PAGE-NUMBER.           05230000
052400                                                                  05240000
052500     WRITE ADV-SHIP-NOTICE-LINE                                   05250000
052600        FROM DP132O-STANDRD-HEADER-132-COLS                       05260000
052700        AFTER ADVANCING PAGE.                                     05270000
052800                                                                  05280000
052900     WRITE ADV-SHIP-NOTICE-LINE                                   05290000
053000         FROM H2-HEADING-LINE2                                    05300000
053100         AFTER ADVANCING 1 LINE.                                  05310000
053200                                                                  05320000
053300     WRITE ADV-SHIP-NOTICE-LINE                                   05330000
053400         FROM H3-HEADING-LINE3                                    05340000
053500         AFTER ADVANCING 2 LINE.                                  05350000
053600                                                                  05360000
053700     WRITE ADV-SHIP-NOTICE-LINE                                   05370000
053800         FROM H4-HEADING-LINE4                                    05380000
053900         AFTER ADVANCING 1 LINE.                                  05390000
054000     MOVE 5                      TO PA-LINE-CNT.                  05400000
054100                                                                  05410000
054200/                                                                 05420000
054300 Z800-SQL-WARNING.                                                05430000
054400******************************************************************05440000
054500*  THIS MODULE PERFORMS THE SQL WARNING.                         *05450000
054600******************************************************************05460000
054700      MOVE SQLCODE               TO SQLCODE2.                     05470000
054800      MOVE SQLERRD(3)            TO SQLERRD3.                     05480000
054900      DISPLAY '** ABEND **       ** = SQLWARNING'.                05490000
055000      DISPLAY '** PROGRAM        ** = SNKUT333'.                  05500000
055100      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 05510000
055200      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 05520000
055300      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 05530000
055400      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 05540000
055500      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 05550000
055600      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 05560000
055700      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 05570000
055800      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 05580000
055900      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 05590000
056000      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 05600000
056100                                                                  05610000
056200      EXEC SQL                                                    05620000
056300          ROLLBACK                                                05630000
056400      END-EXEC.                                                   05640000
056500                                                                  05650000
056600      SET ABEND-4013-DB2-ERROR   TO TRUE                          05660000
056700      CALL 'ILBOABN0' USING ABEND-CODE.                           05670000
056800/                                                                 05680000
056900 Z900-SQL-ERROR.                                                  05690000
057000******************************************************************05700000
057100* THIS MODULE PERFORMS THE SQL ERROR.                            *05710000
057200******************************************************************05720000
057300      MOVE SQLCODE               TO SQLCODE2.                     05730000
057400      MOVE SQLERRD(3)            TO SQLERRD3.                     05740000
057500      DISPLAY '** ABEND **       ** = SQLERROR'.                  05750000
057600      DISPLAY '** PROGRAM        ** = SNKUT333'.                  05760000
057700      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 05770000
057800      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 05780000
057900      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  05790000
058000      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 05800000
058100                                                                  05810000
058200      EXEC SQL                                                    05820000
058300          ROLLBACK                                                05830000
058400      END-EXEC.                                                   05840000
058500                                                                  05850000
058600      SET ABEND-4013-DB2-ERROR   TO TRUE                          05860000
058700      CALL 'ILBOABN0' USING ABEND-CODE.                           05870000
058800*                                                                 05880000
