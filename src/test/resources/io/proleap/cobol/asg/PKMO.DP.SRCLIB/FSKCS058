      *-----------------------*                                         00010099
       IDENTIFICATION DIVISION.                                         00020099
      *-----------------------*                                         00030099
       PROGRAM-ID.    FSKCS058.                                         00040099
       AUTHOR.        DAVE METZGER                                      00050099
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
       DATE-WRITTEN.  02-05-97.                                         00070099
       DATE-COMPILED.                                                   00080099
                                                                        00090099
      *---------------------------------------------------------------* 00100099
      *    F058 - SKU STORE LIST FOR FASHION SALES                    * 00110099
      *                                                               * 00120099
      *    THIS PROGRAM CAN ONLY BE ACCESSED WHEN USING THE SCREENS   * 00130099
      *    BELOW UNDER THE FASHION SALES MENU ONLY                    * 00140099
      *                    =======================                    * 00150099
      *                                                               * 00160099
      *    THIS PROGRAM DISPLAYS A LIST OF STORES                     * 00170099
      *         1) FOR THE SKU SELECTED FROM THE SKU LIST SCREEN      * 00180099
      *         2) FOR THE SKU ENTERED ON THE SKU/STORE LIST SCREEN   * 00190099
      *         3) FOR THE SKU(S) CRITERIA ENTERED ON THE SALES       * 00200099
      *            CRITERIA SCREEN                                    * 00210099
      *                                                               * 00220099
      *    08/25/97 - JULIE SEIDLER - WR5175                          * 00230099
      *        MODIFIED LOGIC TO NOT DISPLAY DETAIL LINE WHEN         * 00240099
      *        ONHAND, SALES OR ON-ORDER QUANTITES ARE ZERO.          * 00250099
      *                                                               * 00260099
      *    10/02/97 - JULIE SEIDLER - WR9999                          * 00270099
      *        CORRECT A PROGRAM BUG.  THE PROGRAM WAS ABENDING       * 00280099
      *        WHEN TRYING TO DISPLAY THE LAST SCREEN OF DATA.        * 00290099
      *        THIS WAS ONLY HAPPENING ON DUMB TERMINALS.  CHANGE     * 00300099
      *        LOGIC IN THE 5810- ROUTINE TO CORRECTLY FILL IN THE    * 00310099
      *        ATTRIBUTE BYTES.                                       * 00320099
      *                                                               * 00330099
      *    03/05/98 - PAUL KEBER    - WR5847                          * 00340099
      *        INCREASED THE SIZE OF THE ENROUTE FIELD ON THE DETAIL  * 00350099
      *        LINES FROM 7 TO 9 DIGITS.  THE DETAIL LINE AMOUNT MAP  * 00360099
      *        FIELDS WERE MERGED INTO ONE DATA FIELD IN ORDER TO     * 00370099
      *        ACCOMPLISH THIS.                                       * 00380099
      *                                                               * 00390099
      *    05/20/98 - JEFF HARTIG/COMPUWARE  WR# 9999                 * 00400099
      *        CHANGED DATE COMPARE LOGIC TO PICK UP CORRECT DC       * 00410099
      *        BASED ON START, STOP AND CURRENT DATES IN PARAGRAPH    * 00420099
      *        5710-MOVE-STORE-DC                                     * 00430099
      *                                                               * 00440099
      *    07/31/98 - PAUL KEBER    - WR6041                          * 00450099
      *        UPDATED PROGRAM TO CONVERT THE SKU STORE WEEKLY SALES  * 00460099
      *        TABLE FROM THE OLD NAME (TSKSTWKSL) TO THE NEW NAME    * 00470099
      *        (TSKSTWKS).  REPLACED SALES_INDCT FIELD WITH NEW DATE  * 00480099
      *        FIELD FSCL_BOW_DTE.  USED KY_ITM_IND FROM TUPC INSTEAD * 00490099
      *        OF TSK IN THE MULTI-SKUS-CSR-2 CURSOR AND THE          * 00500099
      *        7235-GET-SKU-COUNT-2 ROUTINE.                          * 00510099
      *                                                               * 00520099
      * 04/14/99  ROLLIN KRING - REMOVED REFERENCE TO DPG51-SYSTEM-DATE*00530099
      *       WHICH IS NO LONGER SUPPORTED BY THE CALENDAR ROUTINE.    *00540099
      *       REMOVED WORKING STORAGE FIELD PC-DPKUT500-CALENDAR TO    *00550099
      *       STANDARDIZE FIELD IN CALENDAR ROUTINE COPYBOOK.          *00560099
      *                                           (WR# 10647)          *00570099
      * 10/20/99  ROLLIN KRING - CORRECTED PROBLEM WITH DC LOGIC. ADDED*00580099
      *       DC1_RCT_START_DATE AND DC2_RCT_START_DATE TO STORES-CSR.  00590099
      *       THESE FIELDS WERE NOT IN CURSOR SO THEY NEVER HAD A      *00600099
      *       PROPER VALUE IN THEM.  THE WRONG DC WAS DISPLAYED FOR A  *00610099
      *       STORE.                              (WR# 99999)          *00620099
      * 10/21/99  MARIA KLAMIK - CORRECTED PROBLEM WITH FSWS006.       *00630099
      *       GARBAGE DATA BEING SENT FROM FSKCS056 (FORMAT-IND = 1).  *00640099
      *                                           (WR# 99999)          *00650099
      * 12/15/99  MARIA KLAMIK - ADDED LOGIC FOR REGIONAL CLEARANCE    *00660099
      *       PRICING - CALLS TO TUPCPLS FOR CURRENT RETAIL. DELETED   *00670099
      *       ALL REFERENCES TO METRO AREA.                .           *00680099
      *                                           (WR# 10760)          *00690099
      * 06/24/2000 MARIA KLAMIK- CHANGE TO CALL TSKSTOO (ON-ORDER      *00700099
      *       DB2 DATABASE) - DELETE REFERENCES TO THE ON-ORDER        *00710099
      *       VSAM FILE.                                                00720099
      *                                           (WR# 21062)          *00730099
      * 12/11/2001 MARY COLEMAN-REPLACED 2 WEEK SALES ROUTINES WITH    *00740099
      *       INTRANSIT QUANTITY LOGIC - TABLE: PCT_IN_TRNST_QTY       *00750099
      *       NEW/CHANGED PARAGRAPHS:                                  *00760099
      *          4355-GET-INTRANSIT-QTY                                *00770099
      *          7215-FETCH-SKUS-CSR-2                                 *00780099
      * 06/25/2002 MARY COLEMAN-MADE CHANGES FOR NON-INTELLEGENT       *00790099
      *       SKU    WR# 21568                                         *00800099
      * 09/12/2003 MARIA KLAMIK - CHANGED RCP CODE FOR BUSINESS RULE   *00810099
      *       CHANGE.                                                  *00820099
      *       NEW/CHANGED PARAGRAPH:                                   *00830099
      *          4370-EVALUATE-MULTI-SKU-STORE                         *00840099
      * 09/17/2004  A KINTOPF     STORE NUMBER EXPANSION CHANGES.      *00850099
      *                           CHANGED TO USE THE NEW NUMERIC       *00860099
      *                           STORE NUMBER FIELDS ON TSKSTWKS,     *00870099
      *                           TSKSTWKI AND TSTST.                  *00880099
      *                           CHANGED PROGRAM TO USE XMT_LOC       *00890099
      *                           INSTEAD OF TSTR000.                  *00900099
      *                           GOT RID OF ENROUTE FIELD AND ADDED   *00910099
      *                           STORE ONHAND.                        *00920099
      *                           WR26354                              *00930099
RK0806* 08/08/2006  RICH KELLEN   REMOVE CHECK OF SKU_STAT_CDE = '00'  *00940099
RK0806*                           WR30723 AND ALL REFERENCES TO TABLE  *00950099
RK0806*                           TDST000 AS WELL AS PF21 FUNCTIONALITY*00960099
RK0806*                           WHICH IS NO LONGER NEEDED.           *00970099
SR3403* 05/01/2012  J SELWITSCHKA LARGE RETAIL EXPANSION.              *00980099
SR3403*                           CRQ000000023799                      *00990099
0518  * 05/18/2018  J ARENDT      FOR MAINFRAME REFACTOR,  BROKE THE   *01000099
0518  *                           VENDOR STYLE CODE INTO TWO FIELDS    *01010099
0518  *                           ONE SHORT X(15) AND ONE LONG X(20).  *01020099
0518  *                           CHG0201762                           *01030099
272945* 08/05/2022  JIM HUNTER    CHANGE CALL OF DPKUT100 TO           *01031099
272945*                           CALL DP010I-NUMERIC-EDIT-ROUTINE     *01032099
272945*                           MAKING THE CALL DYNAMIC VS STATIC.   *01033099
272945*                           CHG0272945                           *01034099
1022RM* 10/24/2022  BOB MCASEY    CHANGE PARAMETERS FOR CALLING THE    *01035099
1022RM*                           CICS ARCHITECTURE API.  ADDED        *01036099
1022RM*                           DPKCS930 COPYBOOK.                   *01037099
1022RM*                           CHG0                                 *01038099
      *----------------------------------------------------------------*01040099
                                                                        01050099
       ENVIRONMENT DIVISION.                                            01060099
                                                                        01070099
       DATA DIVISION.                                                   01080099
                                                                        01090099
       WORKING-STORAGE SECTION.                                         01100099
                                                                        01110099
       01  PC-PROGRAM-CONSTANTS.                                        01120099
           05  PC-OPERATING-COMPANY           PIC X(02)   VALUE '03'.   01130099
           05  PC-CURRENT-MAP-NAME            PIC X(08)   VALUE         01140099
                                                          'FS058A  '.   01150099
           05  PC-CURRENT-MAPSET-NAME         PIC X(08)   VALUE         01160099
                                                          'FSKM058 '.   01170099
           05  PC-CURRENT-PROGRAM-NAME        PIC X(08)   VALUE         01180099
                                                          'FSKCS058'.   01190099
           05  PC-DPKCS030                    PIC X(08)   VALUE         01200099
                                                          'DPKCS030'.   01210099
           05  PC-EN-ROUTE-FILE               PIC X(08)   VALUE         01220099
                                                          'FSENRTE'.    01230099
           05  PC-NA                          PIC X(02)   VALUE 'NA'.   01240099
           05  PC-CS                          PIC X(02)   VALUE 'CS'.   01250099
           05  PC-DC                          PIC X(02)   VALUE 'DC'.   01260099
           05  PC-DS                          PIC X(02)   VALUE 'DS'.   01270099
           05  PC-SEL-QUEUE-SEQ               PIC 9(01)   VALUE 2.      01280099
           05  PC-DTL-QUEUE-SEQ               PIC 9(01)   VALUE 3.      01290099
           05  PC-CRIT-SPEC-FORMAT            PIC X(01)   VALUE '1'.    01300099
           05  PC-LIST-SCREEN-FORMAT          PIC X(01)   VALUE '2'.    01310099
           05  PC-MULTI-SKU-CRITERA-FORMAT    PIC X(01)   VALUE '4'.    01320099
           05  PC-INQ                         PIC X(03)   VALUE 'INQ'.  01330099
           05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     01340099
                                                          COMP SYNC.    01350099
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01360099
                                                          COMP SYNC.    01370099
           05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01380099
                                                          +1000000      01390099
                                                          COMP-3.       01400099
           05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      01410099
                                                          COMP SYNC.    01420099
           05  PC-MAX-RETRIES                 PIC S9(3)   VALUE 3       01430099
                                                          COMP-3.       01440099
           05  PC-MAX-NUM-WEEKS               PIC S9(03)  VALUE +5      01450099
                                                          COMP-3.       01460099
           05  PC-YEAR-99                     PIC 9(2)    VALUE 99.     01470099
           05  PC-ABSTIME                     PIC S9(18)  VALUE ZERO    01480099
                                                          COMP SYNC.    01490099
           05  PC-SYSTEM-DATE                 PIC X(06).                01500099
           05  PC-LOW-VALUES                  PIC X(15)   VALUE         01510099
                                                    LOW-VALUES.         01520099
           05  PC-HIGH-VALUES                 PIC X(15)   VALUE         01530099
                                                    HIGH-VALUES.        01540099
           05  PC-VENDOR-HIGH                 PIC 9(3)    VALUE 999.    01550099
           05  PC-VENDOR-LOW                  PIC 9(3)    VALUE ZERO.   01560099
           05  PC-STATUS-10                   PIC 9(3)    VALUE 10.     01570099
           05  PC-STATUS-20                   PIC 9(3)    VALUE 20.     01580099
MK         05  PC-STATUS-25                   PIC 9(3)    VALUE 25.     01590099
           05  PC-STATUS-30                   PIC 9(3)    VALUE 30.     01600099
           05  PC-STATUS-40                   PIC 9(3)    VALUE 40.     01610099
           05  PC-STATUS-90                   PIC 9(3)    VALUE 90.     01620099
           05  PC-CORP-STORE                  PIC X(05)   VALUE '00000'.01630099
           05  PC-COLOR-000                   PIC X(03)   VALUE '000'.  01640099
           05  PC-COLOR-999                   PIC X(03)   VALUE '999'.  01650099
           05  PC-ALL-SIZES                   PIC X(10)   VALUE         01660099
                                                    'ALL SIZES '.       01670099
           05  PC-ALL-COLS                    PIC  X(10)  VALUE         01680099
                                                    'ALL COLORS'.       01690099
                                                                        01700099
       01  PC-TSYMSG-NUMBERS.                                           01710099
           05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  01720099
           05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  01730099
           05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  01740099
           05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  01750099
           05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  01760099
           05  PC-TSYMSG-00113                PIC 9(5)    VALUE 00113.  01770099
           05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  01780099
           05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  01790099
           05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  01800099
           05  PC-TSYMSG-00419                PIC 9(5)    VALUE 00419.  01810099
           05  PC-TSYMSG-00989                PIC 9(5)    VALUE 00989.  01820099
           05  PC-TSYMSG-01056                PIC 9(5)    VALUE 01056.  01830099
                                                                        01840099
       01  PS-PROGRAM-SUBSCRIPTS.                                       01850099
           05  PS-SUB                         PIC S9(04)   VALUE +0     01860099
                                                           COMP SYNC.   01870099
       01  PS-PROGRAM-SWITCHES.                                         01880099
           05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   01890099
               88  PS-NO-ERROR                             VALUE 'Y'.   01900099
               88  PS-ERROR                                VALUE 'N'.   01910099
           05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   01920099
               88  PS-COMMAREA-VALID                       VALUE 'Y'.   01930099
               88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   01940099
           05  PS-START-ITEM-ERROR-SW         PIC  X       VALUE 'Y'.   01950099
               88  PS-NO-START-ITEM-ERROR                  VALUE 'Y'.   01960099
               88  PS-START-ITEM-ERROR                     VALUE 'N'.   01970099
           05  PS-SIZE-DESC-FOUND-SW          PIC X(01)    VALUE 'N'.   01980099
               88  PS-SIZE-DESC-FOUND                      VALUE 'Y'.   01990099
               88  PS-SIZE-DESC-NOT-FOUND                  VALUE 'N'.   02000099
           05  PS-QTY-ONHAND-FOUND-SW         PIC X(01)    VALUE 'N'.   02010099
               88  PS-QTY-ONHAND-FOUND                     VALUE 'Y'.   02020099
               88  PS-QTY-ONHAND-NOT-FOUND                 VALUE 'N'.   02030099
           05  PS-VENDOR-FOUND-SW             PIC X(01)    VALUE 'N'.   02040099
               88  PS-VENDOR-FOUND                         VALUE 'Y'.   02050099
               88  PS-VENDOR-NOT-FOUND                     VALUE 'N'.   02060099
           05  PS-END-OF-LAST-STORES-SW       PIC X(01)    VALUE 'N'.   02070099
               88  PS-END-OF-LAST-STORES                   VALUE 'Y'.   02080099
               88  PS-NOT-END-OF-LAST-STORES               VALUE 'N'.   02090099
           05  PS-SKU-INFO-FOUND-SW           PIC X(01)    VALUE 'N'.   02100099
               88  PS-SKU-INFO-FOUND                       VALUE 'Y'.   02110099
               88  PS-SKU-INFO-NOT-FOUND                   VALUE 'N'.   02120099
           05  PS-ALL-SKUS-PROCESSED-SE       PIC X(01)    VALUE 'N'.   02130099
               88  PS-ALL-SKUS-PROCESSED                   VALUE 'Y'.   02140099
               88  PS-ALL-SKUS-NOT-PROCESSED               VALUE 'N'.   02150099
           05  PS-PROCESS-SOME-STORES-SW      PIC X(01)    VALUE 'N'.   02160099
               88  PS-PROCESS-SOME-STORES                  VALUE 'Y'.   02170099
               88  PS-PROCESS-ALL-STORES                   VALUE 'N'.   02180099
           05  PS-STORES-DC-FOUND-SW          PIC X(01)    VALUE 'N'.   02190099
               88  PS-STORE-DC-FOUND                       VALUE 'Y'.   02200099
               88  PS-STORE-DC-NOT-FOUND                   VALUE 'N'.   02210099
           05  PS-PROCESS-CLR-SKU-STORE-SW    PIC X(01)    VALUE 'N'.   02220099
               88  PS-PROCESS-CLR-SKU-STORE                VALUE 'Y'.   02230099
               88  PS-PROCESS-NON-CLR-SKU-STORE            VALUE 'N'.   02240099
           05  PS-USE-CUR-CLR-RTL-SW          PIC X(01)    VALUE 'N'.   02250099
               88  PS-USE-CUR-CLR-RTL                      VALUE 'Y'.   02260099
               88  PS-USE-CUR-REG-RTL                      VALUE 'N'.   02270099
           05  PS-GET-ALL-STORE-INFO          PIC X(01)    VALUE 'N'.   02280099
               88  PS-ALL-STORE-INFO                       VALUE 'Y'.   02290099
               88  PS-ONE-STORE-INFO                       VALUE 'N'.   02300099
                                                                        02310099
       01  PV-PROGRAM-VARIABLES.                                        02320099
           05  PV-SALES-FIGURES.                                        02330099
               10  PV-WKLY-SALES     OCCURS  5 TIMES.                   02340099
                   15  PV-SALES-QTY           PIC S9(9)   COMP-3.       02350099
                   15  PV-SALES-AMT           PIC S9(9)V99   COMP-3.    02360099
           05  PV-STORE-AMOUNTS.                                        02370099
               10  PV-RECEIPT-AMT-CALC        PIC S9(9)V99 COMP-3.      02380099
               10  PV-STORE-OH-AMT-CALC       PIC S9(9)V99 COMP-3.      02390099
               10  PV-ON-ORDER-AMT-CALC       PIC S9(9)V99 COMP-3.      02400099
               10  PV-CUR-ONHAND-AMT-CALC     PIC S9(9)V99 COMP-3.      02410099
               10  PV-INTRANSIT-AMT-CALC      PIC S9(9)V99 COMP-3.      02420099
           05  PV-TOTAL-AMOUNTS.                                        02430099
               10  PV-TOT-CUR-ONHAND-QTY      PIC S9(11)    COMP-3.     02440099
               10  PV-TOT-CUR-ONHAND-AMT      PIC S9(11)V99 COMP-3.     02450099
               10  PV-TOT-CUR-SALES-QTY       PIC S9(11)    COMP-3.     02460099
               10  PV-TOT-CUR-SALES-AMT       PIC S9(11)V99 COMP-3.     02470099
               10  PV-TOT-LAST-WK-SALES-QTY   PIC S9(11)    COMP-3.     02480099
               10  PV-TOT-LAST-WK-SALES-AMT   PIC S9(11)V99 COMP-3.     02490099
MC1201         10  PV-TOT-INTRANSIT-QTY       PIC S9(11)    COMP-3.     02500099
MC1201         10  PV-TOT-INTRANSIT-AMT       PIC S9(11)V99 COMP-3.     02510099
               10  PV-TOT-ON-ORDER-QTY        PIC S9(11)    COMP-3.     02520099
               10  PV-TOT-ON-ORDER-AMT        PIC S9(11)V99 COMP-3.     02530099
               10  PV-TOT-RECEIPT-QTY         PIC S9(11)    COMP-3.     02540099
               10  PV-TOT-RECEIPT-AMT         PIC S9(11)V99 COMP-3.     02550099
               10  PV-TOT-STORE-OH-QTY        PIC S9(11)    COMP-3.     02560099
               10  PV-TOT-STORE-OH-AMT        PIC S9(11)V99 COMP-3.     02570099
           05  PV-STORE-OH-QTY                PIC S9(9)    COMP-3.      02580099
           05  PV-TODAYS-DATE                 PIC 9(7)      VALUE ZERO. 02590099
           05  FILLER REDEFINES PV-TODAYS-DATE.                         02600099
               10  FILLER                     PIC X(2).                 02610099
               10  PV-TODAYS-YYDDD            PIC 9(5).                 02620099
           05  PV-CURRENT-DATE                PIC X(10)   VALUE SPACES. 02630099
           05  PV-WK                          PIC S9(04)  VALUE +0      02640099
                                                          COMP SYNC.    02650099
           05  PV-BOW-DATE                    PIC X(10)   VALUE SPACES. 02660099
                                                                        02670099
           05  PV-WKLY-DATE-KEYS.                                       02680099
               10  PV-WKLY-DATE-KEY  OCCURS  5 TIMES.                   02690099
                   15  PV-WKLY-BOW-DATE       PIC X(10).                02700099
                                                                        02710099
           05  PV-REMAINDER                   PIC S9(04)   VALUE +0     02720099
                                                           COMP SYNC.   02730099
           05  PV-TOTAL-SKUS                  PIC S9(04)   VALUE +0     02740099
                                                           COMP-3.      02750099
           05  PV-SKUS-FETCHED                PIC S9(04)   VALUE +0     02760099
                                                           COMP-3.      02770099
           05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     02780099
                                                           COMP-3.      02790099
           05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     02800099
                                                           COMP-3.      02810099
           05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     02820099
                                                           COMP SYNC.   02830099
           05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     02840099
                                                           COMP SYNC.   02850099
           05  PV-CICS-RESP-STORE-OH          PIC S9(04)   VALUE +0     02860099
                                                           COMP SYNC.   02870099
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     02880099
                                                           COMP SYNC.   02890099
           05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     02900099
                                                           COMP SYNC.   02910099
           05  PV-RETRY-COUNT                 PIC S9(4)    VALUE ZERO   02920099
                                                           COMP SYNC.   02930099
           05  PV-STORE-NBR-COMP              PIC S9(4)    VALUE ZERO   02940099
                                                           COMP.        02950099
           05  PV-STORE-NMBR-9                PIC  9(05)   VALUE ZEROS. 02960099
           05  PV-STORE-NMBR                  PIC  X(05)   VALUE ZEROS. 02970099
SR3403*    05  PV-CUR-RTL-EDIT                PIC  ZZZ9.99 VALUE ZEROS. 02980099
SR3403     05  PV-CUR-RTL-EDIT                PIC  ZZZZ9.99 VALUE ZEROS.02990099
           05  PV-COST-EDIT                   PIC  ZZZ9.99 VALUE ZEROS. 03000099
MC0602     05  PV-SKU-NMBR                    PIC  X(08)   VALUE SPACES.03010099
           05  PV-SKU-DESC                    PIC  X(25)   VALUE SPACES.03020099
           05  PV-CUR-RTL                     PIC  S9(5)V99             03030099
                                                    COMP-3.             03040099
           05  PV-CUR-CLR-RTL                 PIC  S9(5)V99             03050099
                                                    COMP-3.             03060099
           05  PV-COST                        PIC  S9(5)V99             03070099
                                                    COMP-3.             03080099
           05  PV-VENDOR                      PIC  X(03).               03090099
           05  PV-VENDOR-NAME                 PIC  X(10).               03100099
           05  PV-VENDOR-STYLE                PIC  X(20).               03110099
           05  PV-STATUS-CODE-TBL OCCURS 5 TIMES                        03120099
                                   INDEXED BY STAT-IND.                 03130099
               10  PV-STATUS-CODE             PIC  X(03).               03140099
           05  PV-COLOR                       PIC  X(20).               03150099
           05  PV-SIZE                        PIC  X(20).               03160099
                                                                        03170099
      ****************************************************************  03180099
      * STORE TABLE USED TO ACCUMULATE SKU QUANTITIES / AMOUNTS FOR     03190099
      * EACH STORE UNTIL WRITTEN TO TEMP STORAGE WHEN LAST SKU IS       03200099
      * PROCESSED                                                       03210099
      ****************************************************************  03220099
       01 ST-STORE-TABLE.                                               03230099
           05  FILLER  OCCURS 99999 TIMES INDEXED BY ST-IND.            03240099
               10  ST-CUR-OH-QTY              PIC S9(9)    COMP-3.      03250099
               10  ST-CUR-OH-AMT              PIC S9(9)V99 COMP-3.      03260099
               10  ST-CUR-SALES-QTY           PIC S9(9)    COMP-3.      03270099
               10  ST-CUR-SALES-AMT           PIC S9(9)V99 COMP-3.      03280099
               10  ST-LAST-WK-SALES-QTY       PIC S9(9)    COMP-3.      03290099
               10  ST-LAST-WK-SALES-AMT       PIC S9(9)V99 COMP-3.      03300099
      *        10  ST-4-WK-SALES-QTY          PIC S9(9)    COMP-3.      03310099
      *        10  ST-4-WK-SALES-AMT          PIC S9(9)V99 COMP-3.      03320099
MC1201         10  ST-INTRANSIT-QTY           PIC S9(9)    COMP-3.      03330099
MC1201         10  ST-INTRANSIT-AMT           PIC S9(9)V99 COMP-3.      03340099
               10  ST-ON-ORDER-QTY            PIC S9(9)    COMP-3.      03350099
               10  ST-ON-ORDER-AMT            PIC S9(9)V99 COMP-3.      03360099
               10  ST-STORE-OH-QTY            PIC S9(9)    COMP-3.      03370099
               10  ST-STORE-OH-AMT            PIC S9(9)V99 COMP-3.      03380099
               10  ST-RECEIPT-QTY             PIC S9(9)    COMP-3.      03390099
               10  ST-RECEIPT-AMT             PIC S9(9)V99 COMP-3.      03400099
                                                                        03410099
      * NOTE: THE FOLLOWING PV- FIELDS ARE AT AN 01 LEVEL BECAUSE       03420099
      * THEY ARE USED IN CURSOR DECLARATIONS FOR DB2                    03430099
                                                                        03440099
MC0602 01  PV-DEPT-NMBR-C3                    PIC S9(04)V COMP-3.       03450099
                                                                        03460099
MC0602 01  PV-CLASS-LOW-C3                    PIC S9(04)V COMP-3.       03470099
                                                                        03480099
MC0602 01  PV-CLASS-HIGH-C3                   PIC S9(04)V COMP-3.       03490099
                                                                        03500099
       01  PV-DB2-FROM-YYMM                   PIC X(4)  VALUE SPACES.   03510099
       01  FILLER  REDEFINES  PV-DB2-FROM-YYMM.                         03520099
           05  PV-DB2-FROM-YYMM-YY            PIC 9(2).                 03530099
           05  PV-DB2-FROM-MM                 PIC 9(2).                 03540099
                                                                        03550099
       01  PV-DB2-TO-YYMM                     PIC X(4)  VALUE SPACES.   03560099
       01  FILLER  REDEFINES  PV-DB2-TO-YYMM.                           03570099
           05  PV-DB2-TO-YYMM-YY              PIC 9(2).                 03580099
           05  PV-DB2-TO-MM                   PIC 9(2).                 03590099
                                                                        03600099
       01  PV-DB2-FROM-YYWW                   PIC X(4)  VALUE SPACES.   03610099
       01  FILLER  REDEFINES  PV-DB2-FROM-YYWW.                         03620099
           05  PV-DB2-FROM-YYWW-YY            PIC 9(2).                 03630099
           05  PV-DB2-FROM-WW                 PIC 9(2).                 03640099
                                                                        03650099
       01  PV-DB2-TO-YYWW                     PIC X(4)  VALUE SPACES.   03660099
       01  FILLER  REDEFINES  PV-DB2-TO-YYWW.                           03670099
           05  PV-DB2-TO-YYWW-YY              PIC 9(2).                 03680099
           05  PV-DB2-TO-WW                   PIC 9(2).                 03690099
                                                                        03700099
       01  PV-STATUS-CODES.                                             03710099
           05  PV-STATUS-1                    PIC S999V VALUE ZERO      03720099
                                                        COMP-3.         03730099
           05  PV-STATUS-2                    PIC S999V VALUE ZERO      03740099
                                                        COMP-3.         03750099
           05  PV-STATUS-3                    PIC S999V VALUE ZERO      03760099
                                                        COMP-3.         03770099
           05  PV-STATUS-4                    PIC S999V VALUE ZERO      03780099
                                                        COMP-3.         03790099
           05  PV-STATUS-5                    PIC S999V VALUE ZERO      03800099
                                                        COMP-3.         03810099
MK         05  PV-STATUS-6                    PIC S999V VALUE ZERO      03820099
MK                                                      COMP-3.         03830099
       01  PV-STORE-LOW                       PIC 9(05) VALUE ZERO.     03840099
       01  PV-STORE-HIGH                      PIC 9(05) VALUE ZERO.     03850099
       01  PV-STORE-LOW-COMP                  PIC S9(4)    VALUE ZERO   03860099
                                                           COMP.        03870099
       01  PV-STORE-HIGH-COMP                 PIC S9(4)    VALUE ZERO   03880099
                                                           COMP.        03890099
       01  PV-DISTRICT-LOW                    PIC X(02) VALUE SPACES.   03900099
       01  PV-DISTRICT-HIGH                   PIC X(02) VALUE SPACES.   03910099
MK    *01  PV-METRO-LOW                       PIC S999V VALUE ZERO      03920099
      *                                                 COMP-3.         03930099
MK    *01  PV-METRO-HIGH                      PIC S999V VALUE ZERO      03940099
      *                                                 COMP-3.         03950099
MC0602 01  PV-SKU-LOW-C3                      PIC S9(08)V COMP-3.       03960099
MC0602 01  PV-SKU-HIGH-C3                     PIC S9(08)V COMP-3.       03970099
       01  PV-GROUP-HIGH                      PIC X(3)  VALUE SPACES.   03980099
       01  PV-GROUP-LOW                       PIC X(3)  VALUE SPACES.   03990099
0518   01  PV-VND-STYL-LO                     PIC X(15) VALUE SPACES.   04000099
0518   01  PV-VND-STYL-HI                     PIC X(15) VALUE SPACES.   04010099
0518   01  PV-LNG-STYL-LO                     PIC X(20) VALUE SPACES.   04020099
0518   01  PV-LNG-STYL-HI                     PIC X(20) VALUE SPACES.   04030099
0518  *01  PV-STYLE-HIGH                      PIC X(20) VALUE SPACES.   04040099
0518  *01  PV-STYLE-LOW                       PIC X(20) VALUE SPACES.   04050099
       01  PV-KYITM-LOW                       PIC X     VALUE SPACES.   04060099
       01  PV-KYITM-HIGH                      PIC X     VALUE SPACES.   04070099
       01  PV-REPLEN-LOW                      PIC X     VALUE SPACES.   04080099
       01  PV-REPLEN-HIGH                     PIC X     VALUE SPACES.   04090099
       01  PV-LONG-COLOR-LOW                  PIC X(10) VALUE SPACES.   04100099
       01  PV-LONG-COLOR-HIGH                 PIC X(10) VALUE SPACES.   04110099
       01  PV-COLOR-LOW                       PIC XXX   VALUE SPACES.   04120099
       01  PV-COLOR-HIGH                      PIC XXX   VALUE SPACES.   04130099
       01  PV-SIZE-LOW                        PIC X(5)  VALUE SPACES.   04140099
       01  PV-SIZE-HIGH                       PIC X(5)  VALUE SPACES.   04150099
       01  PV-VENDOR-HIGH                     PIC S999V VALUE ZERO      04160099
                                                        COMP-3.         04170099
       01  PV-VENDOR-LOW                      PIC S999V VALUE ZERO      04180099
                                                        COMP-3.         04190099
                                                                        04200039
       01  DL-DETAIL-LINE-AREA.                                         04210039
           05  DL-DETAIL-LINE                 PIC X(59)   VALUE SPACES. 04220035
           05  FILLER REDEFINES DL-DETAIL-LINE.                         04230039
               10  DL-CURR-ONHAND.                                      04240099
                   15  DL-CURR-ONHAND-9       PIC -------9.             04250099
                   15  DL-CURR-ONHAND-C REDEFINES DL-CURR-ONHAND-9      04260099
                                              PIC X(08).                04270099
               10  FILLER                     PIC X(02).                04280039
               10  DL-CURR-SALES.                                       04290099
                   15  DL-CURR-SALES-9        PIC -------9.             04300099
                   15  DL-CURR-SALES-C REDEFINES DL-CURR-SALES-9        04310099
                                              PIC X(08).                04320099
               10  FILLER                     PIC X(02).                04330039
               10  DL-LAST-WK-SALES.                                    04340099
                   15  DL-LAST-WK-SALES-9     PIC -------9.             04350099
                   15  DL-LAST-WK-SALES-C REDEFINES DL-LAST-WK-SALES-9  04360099
                                              PIC X(08).                04370099
               10  FILLER                     PIC X(01).                04380039
MC1201         10  DL-INTRANSIT.                                        04390099
MC1201             15  DL-INTRANSIT-9         PIC -------9.             04400099
MC1201             15  DL-INTRANSIT-C REDEFINES DL-INTRANSIT-9          04410099
                                              PIC X(08).                04420099
               10  FILLER                     PIC X(02).                04430039
               10  DL-ON-ORDER.                                         04440099
                   15  DL-ON-ORDER-9          PIC ZZZZZZZ9.             04450099
                   15  DL-ON-ORDER-C REDEFINES DL-ON-ORDER-9            04460099
                                              PIC X(08).                04470099
               10  FILLER                     PIC X(02).                04480039
               10  DL-STORE-OH.                                         04490099
                   15  DL-STORE-OH-9          PIC --------9.            04500099
                   15  DL-STORE-OH-C REDEFINES DL-STORE-OH-9            04510099
                                              PIC X(09).                04520099
                                                                        04530039
       01  TL-TOTALS-LINE-AREA.                                         04540039
           05  TL-TOTALS-LINE                 PIC X(59)   VALUE SPACES. 04550035
           05  FILLER REDEFINES TL-TOTALS-LINE.                         04560039
               10  TL-CURR-ONHAND.                                      04570099
                   15  TL-CURR-ONHAND-9       PIC -------9.             04580099
                   15  TL-CURR-ONHAND-C REDEFINES TL-CURR-ONHAND-9      04590099
                                              PIC X(08).                04600099
               10  FILLER                     PIC X(02).                04610039
               10  TL-CURR-SALES.                                       04620099
                   15  TL-CURR-SALES-9        PIC -------9.             04630099
                   15  TL-CURR-SALES-C REDEFINES TL-CURR-SALES-9        04640099
                                              PIC X(08).                04650099
               10  FILLER                     PIC X(02).                04660039
               10  TL-LAST-WK-SALES.                                    04670099
                   15  TL-LAST-WK-SALES-9     PIC -------9.             04680099
                   15  TL-LAST-WK-SALES-C REDEFINES TL-LAST-WK-SALES-9  04690099
                                              PIC X(08).                04700099
               10  FILLER                     PIC X(01).                04710039
MC1201         10  TL-INTRANSIT.                                        04720099
MC1201             15  TL-INTRANSIT-9         PIC -------9.             04730099
MC1201             15  TL-INTRANSIT-C   REDEFINES TL-INTRANSIT-9        04740099
                                              PIC X(08).                04750099
               10  FILLER                     PIC X(02).                04760039
               10  TL-ON-ORDER.                                         04770099
                   15  TL-ON-ORDER-9          PIC ZZZZZZZ9.             04780099
                   15  TL-ON-ORDER-C REDEFINES TL-ON-ORDER-9            04790099
                                              PIC X(08).                04800099
               10  FILLER                     PIC X(02).                04810039
               10  TL-STORE-OH.                                         04820099
                   15  TL-STORE-OH-9          PIC ZZZZZZZZ9.            04830099
                   15  TL-STORE-OH-C REDEFINES TL-STORE-OH-9            04840099
                                              PIC X(09).                04850099
                                                                        04860099
      *---------------------------------------------------------------* 04870099
      *    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 04880099
      *---------------------------------------------------------------* 04890099
           COPY DPWS030.                                                04900099
1022RM     COPY DPWS930.                                                04901099
                                                                        04910099
      *---------------------------------------------------------------* 04920099
      *    STANDARD COMMAREA.                                         * 04930099
      *---------------------------------------------------------------* 04940099
           COPY DPWS020.                                                04950099
           COPY FSWS000.                                                04960099
           COPY FSWS006.                                                04970099
                                                                        04980099
                                                                        04990099
               10  ASC-SPECIFIC-COMMAREA.                               05000099
                   15  ASC-TSK-HEADER-INFO.                             05010099
MC0602                 20  ASC-DEPT-NMBR        PIC  X(03).             05020099
MC0602                 20  ASC-DEPT-NMBR-9 REDEFINES                    05030099
MC0602                     ASC-DEPT-NMBR        PIC  999.               05040099
MC0602                 20  ASC-CLASS-NMBR       PIC  X(02).             05050099
MC0602                 20  ASC-CLASS-NMBR-9 REDEFINES                   05060099
MC0602                     ASC-CLASS-NMBR       PIC  99.                05070099
MC0602                 20  ASC-CLASS-NMBR-RDF REDEFINES                 05080099
MC0602                     ASC-CLASS-NMBR.                              05090099
MC0602                     25  ASC-MAJOR-CLASS  PIC  X(01).             05100099
MC0602                     25  ASC-MINOR-CLASS  PIC  X(01).             05110099
MC0602                 20  ASC-SKU-NMBR         PIC  X(08).             05120099
MC0602                 20  ASC-SKU-NMBR-9 REDEFINES                     05130099
MC0602                     ASC-SKU-NMBR         PIC  9(8).              05140099
                   15  ASC-SKU-DESC                 PIC  X(25).         05150099
                   15  ASC-CLASS-DESC               PIC  X(25).         05160099
                   15  ASC-STORE-NUMBER             PIC  X(05).         05170099
MC0602             15  ASC-INITL-SKU-NMBR           PIC  X(08).         05180099
MC0602             15  ASC-INITL-SKU-NMBR-9 REDEFINES                   05190099
MC0602                 ASC-INITL-SKU-NMBR           PIC  9(08).         05200099
                                                                        05210099
                   15  ASC-HEADER-ALREADY-MOVED-SW  PIC X(01).          05220099
                       88  ASC-HEADER-ALREADY-MOVED        VALUE 'Y'.   05230099
                       88  ASC-HEADER-NOT-ALREADY-MOVED    VALUE 'N'.   05240099
                                                                        05250099
                   15  ASC-GET-MULTI-SKUS-SW        PIC X(01).          05260099
                       88  ASC-GET-MULTI-SKUS              VALUE 'Y'.   05270099
                       88  ASC-DO-NOT-GET-MULTI-SKUS       VALUE 'N'.   05280099
                                                                        05290099
                   15  ASC-DISPLAY-TYPE             PIC X(01).          05300099
                       88  ASC-DISPLAY-DOLLARS             VALUE 'D'.   05310099
                       88  ASC-DISPLAY-UNITS               VALUE 'U'.   05320099
                                                                        05330099
                                                                        05340099
                   15  ASC-MORE-DISTRICTS-SW        PIC X(01).          05350099
                       88  ASC-MORE-DISTRICTS              VALUE 'Y'.   05360099
                       88  ASC-NO-MORE-DISTRICTS           VALUE 'N'.   05370099
                                                                        05380099
                   15  ASC-NEXT-DIST-FKEY-HIT-SW    PIC X(01).          05390099
                       88  ASC-NEXT-DIST-FKEY-HIT          VALUE 'Y'.   05400099
                       88  ASC-NEXT-DIST-FKEY-NOT-HIT      VALUE 'N'.   05410099
                                                                        05420099
                   15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05430099
                       20  ASC-BLOCK-MODIFIED-SW                        05440099
                                                 PIC X(01).             05450099
                           88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     05460099
                           88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     05470099
                                                                        05480099
                       20  ASC-ITEM-ARRAY.                              05490099
                           25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        05500099
                               30  ASC-LIST-ITEM-NUMBER    PIC S9(09)   05510099
                                                           COMP-3.      05520099
                               30  ASC-STORE-NMBR          PIC  X(05).  05530099
                               30  ASC-STORE-NMBR-9   REDEFINES         05540099
                                   ASC-STORE-NMBR          PIC  9(05).  05550099
                               30  ASC-STORE-NMBR-C        PIC  X(01).  05560099
                               30  ASC-STORE-SHORT-NAME    PIC  X(10).  05570099
                               30  ASC-STORE-SHORT-NAME-C  PIC  X(01).  05580099
                               30  ASC-DETAIL-LINE-C       PIC  X(01).  05590099
                               30  ASC-CUR-ONHAND-AMT      PIC  S9(9)   05600099
                                                                COMP-3. 05610099
                               30  ASC-CUR-ONHAND-QTY      PIC  S9(9)   05620099
                                                                COMP-3. 05630099
                               30  ASC-CUR-SALES-AMT       PIC  S9(9)   05640099
                                                                COMP-3. 05650099
                               30  ASC-CUR-SALES-QTY       PIC  S9(9)   05660099
                                                                COMP-3. 05670099
                               30  ASC-LAST-WK-SALES-AMT   PIC  S9(9)   05680099
                                                                COMP-3. 05690099
                               30  ASC-LAST-WK-SALES-QTY   PIC  S9(9)   05700099
                                                                COMP-3. 05710099
MC1201                         30  ASC-INTRANSIT-AMT       PIC  S9(9)   05720099
MC1201                                                          COMP-3. 05730099
MC1201                         30  ASC-INTRANSIT-QTY       PIC  S9(9)   05740099
MC1201                                                          COMP-3. 05750099
                               30  ASC-ON-ORDER-AMT        PIC  S9(9)   05760099
                                                                COMP-3. 05770099
                               30  ASC-ON-ORDER-QTY        PIC  S9(9)   05780099
                                                                COMP-3. 05790099
                               30  ASC-STORE-OH-AMT        PIC  S9(9)   05800099
                                                                COMP-3. 05810099
                               30  ASC-STORE-OH-QTY        PIC  S9(9)   05820099
                                                                COMP-3. 05830099
                               30  ASC-DC                  PIC  X(2).   05840099
                               30  ASC-DC-C                PIC  X(01).  05850099
                                                                        05860099
                   15  ASC-TOTALS.                                      05870099
                       20  ASC-TOT-CUR-ONHAND-AMT          PIC  S9(09)  05880099
                                                                COMP-3. 05890099
                       20  ASC-TOT-CUR-ONHAND-QTY          PIC  S9(09)  05900099
                                                                COMP-3. 05910099
                       20  ASC-TOT-CUR-SALES-AMT           PIC  S9(09)  05920099
                                                                COMP-3. 05930099
                       20  ASC-TOT-CUR-SALES-QTY           PIC  S9(09)  05940099
                                                                COMP-3. 05950099
                       20  ASC-TOT-LAST-WK-SALES-AMT       PIC  S9(09)  05960099
                                                                COMP-3. 05970099
                       20  ASC-TOT-LAST-WK-SALES-QTY       PIC  S9(09)  05980099
                                                                COMP-3. 05990099
MC1201                 20  ASC-TOT-INTRANSIT-AMT           PIC  S9(09)  06000099
MC1201                                                          COMP-3. 06010099
MC1201                 20  ASC-TOT-INTRANSIT-QTY           PIC  S9(09)  06020099
MC1201                                                          COMP-3. 06030099
                       20  ASC-TOT-ON-ORDER-AMT            PIC S9(09)   06040099
                                                                COMP-3. 06050099
                       20  ASC-TOT-ON-ORDER-QTY            PIC S9(09)   06060099
                                                                COMP-3. 06070099
                       20  ASC-TOT-STORE-OH-AMT            PIC S9(09)   06080099
                                                                COMP-3. 06090099
                       20  ASC-TOT-STORE-OH-QTY            PIC S9(09)   06100099
                                                                COMP-3. 06110099
                                                                        06120099
                   15  ASC-BLK-SUB                         PIC S9(04)   06130099
                                                               COMP     06140099
                                                               SYNC.    06150099
                   15  ASC-ITEM-SUB                        PIC S9(04)   06160099
                                                               COMP     06170099
                                                               SYNC.    06180099
                   15  ASC-SEL-SUB                         PIC S9(04)   06190099
                                                               COMP.    06200099
                   15  ASC-SEL-ITEM                        PIC S9(04)   06210099
                                                               COMP.    06220099
                   15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   06230099
                                                               COMP-3.  06240099
                   15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   06250099
                                                               COMP-3.  06260099
                   15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   06270099
                                                               COMP-3.  06280099
                   15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   06290099
                                                               COMP-3.  06300099
                   15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06310099
                                                               COMP-3.  06320099
                   15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06330099
                                                               COMP-3.  06340099
                   15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06350099
                                                               COMP     06360099
                                                               SYNC.    06370099
                   15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06380099
                                                               COMP-3.  06390099
                   15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06400099
                                                               COMP-3.  06410099
                   15  ASC-FS002-IDX                       PIC S9(04)   06420099
                                                               COMP.    06430099
                   15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06440099
                       88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 06450099
                       88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 06460099
                   15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  06470099
                       88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06480099
                   15  ASC-LIST-QUEUE-NAME.                             06490099
                       20  ASC-LIST-TERM-ID                PIC  X(04).  06500099
                       20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06510099
                                                               COMP-3.  06520099
                       20  ASC-LIST-SEQ                    PIC  9(01).  06530099
                   15  ASC-SEL-QUEUE-NAME.                              06540099
                       20  ASC-SEL-TERM-ID                 PIC  X(04).  06550099
                       20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06560099
                                                                COMP-3. 06570099
                       20  ASC-SEL-SEQ                     PIC  9(01).  06580099
                   15  ASC-TS-ITEM-NMBR                    PIC S9(04)   06590099
                                                               COMP.    06600099
                   15  ASC-START-ITEM-REQUEST.                          06610099
                       20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06620099
                                                                        06630099
      *---------------------------------------------------------------* 06640099
      *    TS QUEUE AREA                                              * 06650099
      *---------------------------------------------------------------* 06660099
           COPY FSWS002.                                                06670099
                                                                        06680099
      *---------------------------------------------------------------* 06690099
      *    ABEND PROCESSING COPYBOOK.                                 * 06700099
      *---------------------------------------------------------------* 06710099
           COPY DPWS013.                                                06720099
                                                                        06730099
      *---------------------------------------------------------------* 06740099
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 06750099
      *---------------------------------------------------------------* 06760099
           COPY DPWS015.                                                06770099
                                                                        06780099
      *---------------------------------------------------------------* 06790099
      *    FUNCTION KEYS COPYBOOK.                                    * 06800099
      *---------------------------------------------------------------* 06810099
           COPY DPWS016.                                                06820099
                                                                        06830099
      *---------------------------------------------------------------* 06840099
      *          DATE ROUTINE COPYBOOKS                               * 06850099
      *---------------------------------------------------------------* 06860099
           COPY DPWS500.                                                06870099
                                                                        06880099
      *---------------------------------------------------------------* 06890099
      *    NUMERIC EDIT LAYOUT.                                       * 06900099
      *---------------------------------------------------------------* 06910099
           COPY DPWS010I.                                               06920099
                                                                        06930099
      *---------------------------------------------------------------* 06940099
      *    MAP LAYOUT                                                 * 06950099
      *---------------------------------------------------------------* 06960099
           COPY FSKM058.                                                06970099
                                                                        06980099
       01  MR-OCCURS-LAYOUT          REDEFINES  FS058AO.                06990099
      *    05  FILLER                PIC X(341).                        07000099
SR3403*    05  FILLER                PIC X(335).                        07010099
SR3403     05  FILLER                PIC X(336).                        07020099
           05  MR-SCROLL-AREA OCCURS 12 TIMES.                          07030099
               10  MR-STORE-NMBRL             PIC S9(04) COMP.          07040099
               10  MR-STORE-NMBRA             PIC  X(01).               07050099
               10  MR-STORE-NMBRC             PIC  X(01).               07060099
               10  MR-STORE-NMBRH             PIC  X(01).               07070099
               10  MR-STORE-NMBR              PIC  X(05).               07080099
                                                                        07090099
               10  MR-STORE-NAMEL             PIC S9(04) COMP.          07100099
               10  MR-STORE-NAMEA             PIC  X(01).               07110099
               10  MR-STORE-NAMEC             PIC  X(01).               07120099
               10  MR-STORE-NAMEH             PIC  X(01).               07130099
               10  MR-STORE-NAME              PIC  X(10).               07140099
                                                                        07150099
               10  MR-DETAIL-LINEL            PIC S9(04) COMP.          07160099
               10  MR-DETAIL-LINEA            PIC  X(01).               07170099
               10  MR-DETAIL-LINEC            PIC  X(01).               07180099
               10  MR-DETAIL-LINEH            PIC  X(01).               07190099
               10  MR-DETAIL-LINE             PIC  X(59).               07200099
                                                                        07210099
               10  MR-DCL                     PIC S9(04) COMP.          07220099
               10  MR-DCA                     PIC  X(01).               07230099
               10  MR-DCC                     PIC  X(01).               07240099
               10  MR-DCH                     PIC  X(01).               07250099
               10  MR-DC                      PIC  X(2).                07260099
                                                                        07270099
           05  MR-TOTALS-AREA.                                          07280099
               10  MR-TOTALS-LINEL            PIC S9(04) COMP.          07290099
               10  MR-TOTALS-LINEA            PIC  X(01).               07300099
               10  MR-TOTALS-LINEC            PIC  X(01).               07310099
               10  MR-TOTALS-LINEH            PIC  X(01).               07320099
               10  MR-TOTALS-LINE             PIC  X(61).               07330099
                                                                        07340099
      ******************************************************************07350099
      *    INTRANSIT COPYBOOK.                                         *07360099
      ******************************************************************07370099
           COPY XLWS074.                                                07380099
                                                                        07390099
      *---------------------------------------------------------------* 07400099
      *  COPY MEMBER FOR THE RECEIPT ENROUTE VSAM FILE                * 07410099
      *---------------------------------------------------------------* 07420099
      *    COPY FSRD048.                                                07430099
      *                                                                 07440099
      *---------------------------------------------------------------* 07450099
      *    DB2 AREA FOR TSK                                           * 07460099
      *---------------------------------------------------------------* 07470099
           EXEC SQL                                                     07480099
                INCLUDE TSK                                             07490099
           END-EXEC.                                                    07500099
                                                                        07510099
      *---------------------------------------------------------------* 07520099
      *    DB2 AREA FOR TSKXREF                                       * 07530099
      *---------------------------------------------------------------* 07540099
           EXEC SQL                                                     07550099
                INCLUDE TSKXREF                                         07560099
           END-EXEC.                                                    07570099
                                                                        07580099
      *---------------------------------------------------------------* 07590099
      *  SQL AND COBOL DECLARATIONS FOR THE UPC SKU TABLE TO INCLUDE  * 07600099
      *  REPLENISHMENT SKUS                                           * 07610099
      *---------------------------------------------------------------* 07620099
                                                                        07630099
           EXEC SQL                                                     07640099
               INCLUDE TUPCSKU                                          07650099
           END-EXEC.                                                    07660099
                                                                        07670099
      *---------------------------------------------------------------* 07680099
      *  SQL AND COBOL DECLARATIONS FOR THE UPC TABLE TO INCLUDE      * 07690099
      *  REPLENISHMENT SKUS                                           * 07700099
      *---------------------------------------------------------------* 07710099
                                                                        07720099
           EXEC SQL                                                     07730099
               INCLUDE TUPC                                             07740099
           END-EXEC.                                                    07750099
                                                                        07760099
      *---------------------------------------------------------------* 07770099
      *    DB2 AREA FOR TSKST                                         * 07780099
      *---------------------------------------------------------------* 07790099
           EXEC SQL                                                     07800099
                INCLUDE TSKST                                           07810099
           END-EXEC.                                                    07820099
                                                                        07830099
      *---------------------------------------------------------------* 07840099
      *    DB2 AREA FOR XMT_LOC                                       * 07850099
      *---------------------------------------------------------------* 07860099
           EXEC SQL                                                     07870099
                INCLUDE XMT00001                                        07880099
           END-EXEC.                                                    07890099
                                                                        07900099
      *---------------------------------------------------------------* 07910099
      *    DB2 AREA FOR DC_LOC_ASGMT                                  * 07920099
      *---------------------------------------------------------------* 07930099
           EXEC SQL                                                     07940099
                INCLUDE XMT00002                                        07950099
           END-EXEC.                                                    07960099
                                                                        07970099
      *---------------------------------------------------------------* 07980099
      *    TSKSTWKS IS THE DCLGEN MEMBER FOR THE SKU WEEKLY SALES TBL * 07990099
      *---------------------------------------------------------------* 08000099
           EXEC SQL                                                     08010099
               INCLUDE TSKSTWKS                                         08020099
           END-EXEC.                                                    08030099
                                                                        08040099
      *---------------------------------------------------------------* 08050099
      *  SQL AND COBOL DECLARATIONS FOR THE NRF SIZE TABLE (TSIZE)    * 08060099
      *---------------------------------------------------------------* 08070099
                                                                        08080099
           EXEC SQL                                                     08090099
               INCLUDE TSIZE                                            08100099
           END-EXEC.                                                    08110099
                                                                        08120099
      *---------------------------------------------------------------* 08130099
      *  SQL AND COBOL DECLARATIONS FOR THE VENDOR DEPT TABLE         * 08140099
      *---------------------------------------------------------------* 08150099
                                                                        08160099
           EXEC SQL                                                     08170099
               INCLUDE TVNDDPT                                          08180099
           END-EXEC.                                                    08190099
                                                                        08200099
      *---------------------------------------------------------------* 08210099
      *  SQL AND COBOL DECLARATIONS FOR THE NAME TABLE TO GET VENDOR  * 08220099
      *  NAME                                                         * 08230099
      *---------------------------------------------------------------* 08240099
                                                                        08250099
           EXEC SQL                                                     08260099
               INCLUDE TENTNME                                          08270099
           END-EXEC.                                                    08280099
                                                                        08290099
                                                                        08300099
      *---------------------------------------------------------------* 08310099
      *  SQL AND COBOL DECLARATIONS FOR THE PRICE LOOKUP TABLE        * 08320099
      *---------------------------------------------------------------* 08330099
           EXEC SQL                                                     08340099
               INCLUDE TUPCPLS                                          08350099
           END-EXEC.                                                    08360099
                                                                        08370099
      *---------------------------------------------------------------* 08380099
      *  SQL AND COBOL DECLARATIONS FOR THE ON-ORDER TABLE (TSKSTOO)  * 08390099
      *---------------------------------------------------------------* 08400099
                                                                        08410099
           EXEC SQL                                                     08420099
MK             INCLUDE TSKSTOO                                          08430099
           END-EXEC.                                                    08440099
                                                                        08450099
MC1201*---------------------------------------------------------------* 08460099
MC1201*  SQL AND COBOL DECLARATIONS FOR THE INTRANSIT QTY TABLE       * 08470099
MC1201*  (PCT_IN_TRNST_QTY)                                           * 08480099
MC1201*---------------------------------------------------------------* 08490099
                                                                        08500099
MC1201*    EXEC SQL                                                     08510099
MC1201*        INCLUDE PCT00000                                         08520099
MC1201*    END-EXEC.                                                    08530099
                                                                        08540099
      *---------------------------------------------------------------* 08550099
      *    DB2 AREA FOR COMMUNICATIONS                                * 08560099
      *---------------------------------------------------------------* 08570099
           EXEC SQL                                                     08580099
                INCLUDE SQLCA                                           08590099
           END-EXEC.                                                    08600099
                                                                        08610099
      *---------------------------------------------------------------* 08620099
      *    CURSOR TO OBTAIN SKUS WITH REPLENISH INDICATOR ONLY VALID  * 08630099
      *    FOR DEPTS THAT HAVE BEEN CONVERTED TO VSM                  * 08640099
      *---------------------------------------------------------------* 08650099
                                                                        08660099
           EXEC SQL                                                     08670099
               DECLARE MULTI-SKUS-CSR-2 CURSOR FOR                      08680099
                   SELECT                                               08690099
MC0602                 X.DEPT,                                          08700099
MC0602                 X.SUBCLASS,                                      08710099
MC0602                 X.SKU,                                           08720099
                       A.CUR_UNIT_RTL_AMT,                              08730099
                       A.UNIT_COST_AMT,                                 08740099
                       A.ITEM_NMBR,                                     08750099
                       A.GP_RTL_AMT,                                    08760099
                       A.GP_QTY,                                        08770099
                       A.STATUS_CODE,                                   08780099
                       C.RPLNMT_IND,                                    08790099
                       A.REGN_PRIC_IND,                                 08800099
                       C.INTR_UPC_ID                                    08810099
                  FROM TSK     A                                        08820099
                      ,TUPCSKU B                                        08830099
                      ,TUPC    C                                        08840099
                      ,TSKXREF X                                        08850099
                      WHERE                                             08860099
MC0602                  ((X.DEPT             = :PV-DEPT-NMBR-C3)        08870099
                                 AND                                    08880099
MC0602                   (X.SUBCLASS         = :PV-CLASS-LOW-C3)        08890099
                                 AND                                    08900099
MC0602                   (X.SKU              = :PV-SKU-LOW-C3 OR        08910099
MC0602                    X.SKU              > :PV-SKU-HIGH-C3)         08920099
                                 AND                                    08930099
                         (A.STATUS_CODE IN (:PV-STATUS-1,               08940099
                                            :PV-STATUS-2,               08950099
                                            :PV-STATUS-3,               08960099
                                            :PV-STATUS-4,               08970099
                                            :PV-STATUS-5,               08980099
                                            :PV-STATUS-6))              08990099
                                 AND                                    09000099
                         (A.GROUP_CODE BETWEEN                          09010099
                                     :PV-GROUP-LOW AND :PV-GROUP-HIGH)  09020099
                                 AND                                    09030099
                         (A.VNDR_IN_HSE_NMBR BETWEEN                    09040099
                                     :PV-VENDOR-LOW AND :PV-VENDOR-HIGH)09050099
                                 AND                                    09060099
0518                    ((A.VENDOR_STYLE_CODE BETWEEN :PV-VND-STYL-LO   09070099
0518                                              AND :PV-VND-STYL-HI)  09080099
0518                             OR                                     09090099
0518                     (A.LONG_VENDOR_STYLE BETWEEN :PV-LNG-STYL-LO   09100099
0518                                              AND :PV-LNG-STYL-HI)) 09110099
0518  *                  (A.LONG_VENDOR_STYLE BETWEEN                   09120099
0518  *                              :PV-STYLE-LOW AND :PV-STYLE-HIGH OR09130099
0518  *                   A.VENDOR_STYLE_CODE BETWEEN                   09140099
0518  *                              :PV-STYLE-LOW AND :PV-STYLE-HIGH)  09150099
                                 AND                                    09160099
                         (A.SIZE_CDE BETWEEN                            09170099
                          :PV-SIZE-LOW AND :PV-SIZE-HIGH)               09180099
                                 AND                                    09190099
                         (A.LONG_COLOR_DESC BETWEEN                     09200099
                          :PV-LONG-COLOR-LOW AND :PV-LONG-COLOR-HIGH)   09210099
                                 AND                                    09220099
                         (A.COLOR_CDE BETWEEN                           09230099
                          :PV-COLOR-LOW AND :PV-COLOR-HIGH)             09240099
                                 AND                                    09250099
                         (C.KY_ITM_IND BETWEEN                          09260099
                          :PV-KYITM-LOW AND :PV-KYITM-HIGH)             09270099
                                 AND                                    09280099
                         (A.ITEM_NMBR   = B.ITEM_NBR       AND          09290099
MC0602                    B.ITEM_NBR    = X.ITM_NBR        AND          09300099
                          B.UPC_NBR     = C.UPC_NBR        AND          09310099
                          C.UPC_TYP_CDE = 'I'              AND          09320099
                          C.RPLNMT_IND BETWEEN                          09330099
                          :PV-REPLEN-LOW AND :PV-REPLEN-HIGH AND        09340099
                          ((CURRENT DATE BETWEEN                        09350099
                            C.EFF_BEG_DTE  AND  C.EFF_END_DTE) OR       09360099
                           (CURRENT DATE > C.EFF_BEG_DTE AND            09370099
                            C.EFF_END_DTE IS NULL))))                   09380099
           END-EXEC.                                                    09390099
                                                                        09400099
      *---------------------------------------------------------------* 09410099
      *    CURSOR TO OBTAIN LONG DESCRIPTION AND CORRECTIVE ACTION    * 09420099
      *    FOR REGULAR STORES / TYPE = DS                             * 09430099
      *---------------------------------------------------------------* 09440099
           EXEC SQL                                                     09450099
                DECLARE STORES-CSR CURSOR                               09460099
                FOR SELECT                                              09470099
                      CURRENT DATE                                      09480099
                     ,A.DC_NBR                                          09490099
                     ,C.LOC_10_ABBR_NM                                  09500099
                     ,C.LOC_NBR                                         09510099
                  FROM XMT_DC_LOC_ASGMT A                               09520099
                      ,XMT_LOC C                                        09530099
                WHERE (C.LOC_NBR      = :PV-STORE-LOW-COMP)             09540099
                  AND  C.LOC_TYP_CDE  = 'DS'                            09550099
                                                                        09560099
                  AND  CLO_DTE    >=  CURRENT DATE - 1 MONTH            09570099
                                                                        09580099
                  AND  A.LOC_NBR = C.LOC_NBR                            09590099
                  AND  A.EFF_BEG_DTE =                                  09600099
                       (SELECT MAX(B.EFF_BEG_DTE)                       09610099
                         FROM XMT_DC_LOC_ASGMT B                        09620099
                        WHERE B.EFF_BEG_DTE <= CURRENT DATE             09630099
                          AND A.LOC_NBR = B.LOC_NBR)                    09640099
            ORDER BY  C.LOC_NBR                                         09650099
            OPTIMIZE FOR 300 ROWS                                       09660099
                                                                        09670099
           END-EXEC.                                                    09680099
                                                                        09690099
      *---------------------------------------------------------------* 09700099
      *    CURSOR TO OBTAIN LONG DESCRIPTION AND CORRECTIVE ACTION    * 09710099
      *    FOR REGULAR STORES / TYPE = DS                             * 09720099
      *---------------------------------------------------------------* 09730099
           EXEC SQL                                                     09740099
                DECLARE STORES-CSR-ALL CURSOR                           09750099
                FOR SELECT                                              09760099
                      CURRENT DATE                                      09770099
                     ,A.DC_NBR                                          09780099
                     ,C.LOC_10_ABBR_NM                                  09790099
                     ,C.LOC_NBR                                         09800099
                  FROM XMT_DC_LOC_ASGMT A                               09810099
                      ,XMT_LOC C                                        09820099
                WHERE  C.LOC_NBR      > :PV-STORE-HIGH-COMP             09830099
                  AND  C.LOC_TYP_CDE  = 'DS'                            09840099
                                                                        09850099
                  AND  CLO_DTE    >=  CURRENT DATE - 1 MONTH            09860099
                                                                        09870099
                  AND  A.LOC_NBR = C.LOC_NBR                            09880099
                  AND  A.EFF_BEG_DTE =                                  09890099
                       (SELECT MAX(B.EFF_BEG_DTE)                       09900099
                         FROM XMT_DC_LOC_ASGMT B                        09910099
                        WHERE B.EFF_BEG_DTE <= CURRENT DATE             09920099
                          AND A.LOC_NBR = B.LOC_NBR)                    09930099
            ORDER BY  C.LOC_NBR                                         09940099
            OPTIMIZE FOR 300 ROWS                                       09950099
                                                                        09960099
           END-EXEC.                                                    09970099
                                                                        09980099
      *---------------------------------------------------------------* 09990099
      *    CURSOR TO OBTAIN NA/NON-ALLOCATED LOCATIONS                * 10000099
      *                     CS/CENTRAL STOCK LOCATIONS                * 10010099
      *                     DC/DISTRIBUTION CENTERS LOCATIONS         * 10020099
      *                     DEPENDING ON THE TYPE CODE USED           * 10030099
      *---------------------------------------------------------------* 10040099
           EXEC SQL                                                     10050099
                DECLARE LAST-STORES-CSR CURSOR                          10060099
                FOR SELECT                                              10070099
                      CURRENT DATE                                      10080099
                     ,A.DC_NBR                                          10090099
                     ,C.LOC_10_ABBR_NM                                  10100099
                     ,C.LOC_NBR                                         10110099
                  FROM XMT_DC_LOC_ASGMT A                               10120099
                      ,XMT_LOC C                                        10130099
                WHERE LOC_TYP_CDE  = :XMT00001-LOC-TYP-CDE              10140099
                  AND CLO_DTE  >=  CURRENT DATE - 1 MONTH               10150099
                  AND A.LOC_NBR = C.LOC_NBR                             10160099
                  AND A.EFF_BEG_DTE =                                   10170099
                      (SELECT MAX(B.EFF_BEG_DTE)                        10180099
                         FROM XMT_DC_LOC_ASGMT B                        10190099
                        WHERE B.EFF_BEG_DTE <= CURRENT DATE             10200099
                          AND A.LOC_NBR = B.LOC_NBR)                    10210099
            ORDER BY  LOC_NBR                                           10220099
                                                                        10230099
           END-EXEC.                                                    10240099
                                                                        10250099
       LINKAGE SECTION.                                                 10260099
                                                                        10270099
       01  DFHCOMMAREA.                                                 10280099
           05  FILLER                         OCCURS  1 TO 4072 TIMES   10290099
                                              DEPENDING ON EIBCALEN.    10300099
               10  FILLER                     PIC X.                    10310099
                                                                        10320099
       PROCEDURE DIVISION.                                              10330099
                                                                        10340099
      ******************************************************************10350099
      * MAINLINE PARAGRAPH                                              10360099
      ******************************************************************10370099
       0000-MAIN-MODULE.                                                10380099
                                                                        10390099
           INITIALIZE DP030-CICS-API-FIELDS.                            10400099
           MOVE +1                      TO DP030-NUMBER-OF-MAPS.        10410099
           MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           10420099
           MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          10430099
           SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        10440099
           MOVE LENGTH OF FS058AI       TO DP030-MAP-LENGTH (1).        10450099
           MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      10460099
           PERFORM 0001-CALL-CICS-ARCH-API.                             10470099
                                                                        10480099
           PERFORM 1000-CONTROL-PROCESSING.                             10490099
                                                                        10500099
           MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      10510099
           PERFORM 0001-CALL-CICS-ARCH-API.                             10520099
                                                                        10530099
      ******************************************************************10540099
      *   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *10550099
      *   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *10560099
      ******************************************************************10570099
                                                                        10580099
       0001-CALL-CICS-ARCH-API.                                         10590099
                                                                        10600099
           CALL DP930-CICS-ARCH-API   USING DFHEIBLK                    10610099
                                            DFHCOMMAREA                 10620099
                                            DP030-CICS-API-FIELDS       10630099
                                            DP020-STANDARD-COMMAREA     10640099
                                            FS058AI.                    10650099
                                                                        10660099
           IF  DP030-RC-CALL-SUCCESSFUL                                 10670099
               CONTINUE                                                 10680099
           ELSE                                                         10690099
               SET DP013-NO-ROLLBACK TO TRUE                            10700099
               SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   10710099
               SET DP013-CICS-ABEND TO TRUE                             10720099
               MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        10730099
1022RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10751099
1022RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10752099
               MOVE DP030-RETURN-CODE                                   10760099
                                     TO DP013-MESSAGE-TEXT (3)          10770099
               PERFORM DP013-0000-PROCESS-ABEND                         10780099
           END-IF.                                                      10790099
                                                                        10800099
      ******************************************************************10810099
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10820099
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10830099
      *                                                                *10840099
      * NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10850099
      *  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10860099
      *  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10870099
      *  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10880099
      ******************************************************************10890099
       1000-CONTROL-PROCESSING.                                         10900099
                                                                        10910099
           EXEC CICS                                                    10920099
               ASKTIME                                                  10930099
                   ABSTIME(PC-ABSTIME)                                  10940099
           END-EXEC.                                                    10950099
                                                                        10960099
           EXEC CICS                                                    10970099
               FORMATTIME                                               10980099
                   ABSTIME(PC-ABSTIME)                                  10990099
                   MMDDYY(PC-SYSTEM-DATE)                               11000099
           END-EXEC.                                                    11010099
                                                                        11020099
      *--> THE FOLLOWING STATEMENT IS NEEDED TO CLEAR GARBAGE DATA FROM 11030099
      *--> THE FSWS006 COPYBOOK.  FSKCS056 IS NOT FORMATTING THE COPYBOO11040099
           IF DP020-INT-APPL-FORMAT-IND = '1'                           11050099
              INITIALIZE CA-FSKCS034-CRITERIA-DATA                      11060099
           END-IF.                                                      11070099
                                                                        11080099
      *--> THE FOLLOWING DISPLAYS SKU(S) WHICH WERE SELECTED BY ANOTHER 11090099
      *--> SELECTION LIST PROGRAM.                                      11100099
                                                                        11110099
           IF DP020-INT-APPL-FORMAT-IND = '2'                           11120099
      *-->     DEALING W/ A SELECTED ITEM FROM A LIST SCREEN.           11130099
               EVALUATE TRUE                                            11140099
      *-->     THE 9000- ROUTINE LOADS UP ASC-SKU W/ THE KEY VALUE      11150099
      *-->     FOUND ON THE TEMP STORAGE RECORD.  THE REMAINDER OF THE  11160099
      *-->     PROGRAM CAN STAY THE SAME.                               11170099
                                                                        11180099
                   WHEN DP020-NEXT-ACT-INITIAL                          11190099
                       PERFORM 1100-PROCESS-INTER-APPL-COMM             11200099
                       MOVE EIBTRMID          TO ASC-LIST-TERM-ID       11210099
                                                 ASC-SEL-TERM-ID        11220099
                       MOVE DP020-SRC-TASK-NUMBER                       11230099
                                              TO ASC-LIST-TASK-NUMBER   11240099
                       MOVE CA-TS-TASK-NMBR   TO ASC-SEL-TASK-NUMBER    11250099
                       MOVE PC-DTL-QUEUE-SEQ  TO ASC-LIST-SEQ           11260099
                       MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ            11270099
                                                                        11280099
                   WHEN (DP020-NEXT-ACT-READ-MAP AND                    11290099
                         DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID))         11300099
      *-->             ** "NEXT SKU" PFKEY HIT **                       11310099
                       ADD +1 TO ASC-FS002-IDX                          11320099
                       IF ASC-FS002-IDX > FS002-MAX-ITEMS               11330099
                           ADD  +1 TO ASC-TS-ITEM-NMBR                  11340099
                           MOVE +1 TO ASC-FS002-IDX                     11350099
                       END-IF                                           11360099
                   WHEN OTHER                                           11370099
                       CONTINUE                                         11380099
               END-EVALUATE                                             11390099
                                                                        11400099
               IF DP020-NEXT-ACT-INITIAL OR                             11410099
                 (DP020-NEXT-ACT-READ-MAP AND                           11420099
                  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID))                11430099
                   PERFORM 9000-READ-TS-QUEUE                           11440099
                                                                        11450099
                   IF FS002-KEY-DATA(ASC-FS002-IDX) =                   11460099
                       (SPACES OR LOW-VALUES)                           11470099
      *-->             NO MORE DATA                                     11480099
                       MOVE PC-TSYMSG-00113         TO DP020-MSG-NUMBER 11490099
                       SET DP020-MSG-WARNING        TO TRUE             11500099
                       SET PS-ERROR                 TO TRUE             11510099
                       SET DP030-SET-CURSOR-TRAILER TO TRUE             11520099
                   ELSE                                                 11530099
MC0602                 MOVE FS002-DEPT-NMBR(ASC-FS002-IDX)              11540099
MC0602                                              TO ASC-DEPT-NMBR    11550099
MC0602                 MOVE FS002-CLASS-NMBR(ASC-FS002-IDX)             11560099
MC0602                                              TO ASC-CLASS-NMBR   11570099
MC0602                 MOVE FS002-SKU-NMBR(ASC-FS002-IDX)               11580099
MC0602                                              TO ASC-SKU-NMBR     11590099
MC0602                                                 PV-SKU-NMBR      11600099
MC0602                 MOVE ASC-CLASS-NMBR-9        TO PV-CLASS-LOW-C3  11610099
MC0602                                                 PV-CLASS-HIGH-C3 11620099
MC0602                 MOVE ASC-SKU-NMBR-9          TO PV-SKU-LOW-C3    11630099
                       PERFORM 1220-FILL-SINGLE-SKU-CRITERIA            11640099
                       MOVE PC-INQ TO FS002-ACTION-SW (ASC-FS002-IDX)   11650099
                       PERFORM 9100-REWRITE-TS-QUEUE                    11660099
                       PERFORM 2050-DELETE-DETAIL-QUEUE                 11670099
                       SET ASC-HEADER-NOT-ALREADY-MOVED TO TRUE         11680099
                       PERFORM 4000-BUILD-INITIAL-PANEL                 11690099
                   END-IF                                               11700099
               END-IF                                                   11710099
      *-->     ***  END OF SELECTION LIST CODE  ***                     11720099
           ELSE                                                         11730099
      *-->     ** COMING IN FROM THE CRITERIA SPEC SCREEN **   4 OR 1   11740099
               EVALUATE TRUE                                            11750099
                   WHEN DP020-NEXT-ACT-INITIAL                          11760099
                       PERFORM 1100-PROCESS-INTER-APPL-COMM             11770099
                       IF  PS-COMMAREA-NOT-VALID                        11780099
                           SET DP020-NEXT-ACT-APPL-ERROR                11790099
                                         TO  TRUE                       11800099
                       ELSE                                             11810099
                           MOVE EIBTRMID         TO ASC-LIST-TERM-ID    11820099
                                                    ASC-SEL-TERM-ID     11830099
                           MOVE DP020-SRC-TASK-NUMBER                   11840099
                                                 TO ASC-LIST-TASK-NUMBER11850099
                                                    ASC-SEL-TASK-NUMBER 11860099
                           MOVE PC-DTL-QUEUE-SEQ TO ASC-LIST-SEQ        11870099
                           MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ         11880099
                           PERFORM 2050-DELETE-DETAIL-QUEUE             11890099
                           PERFORM 4000-BUILD-INITIAL-PANEL             11900099
                       END-IF                                           11910099
               END-EVALUATE                                             11920099
                                                                        11930099
           END-IF.                                                      11940099
                                                                        11950099
           EVALUATE TRUE                                                11960099
               WHEN  DP020-NEXT-ACT-INITIAL                             11970099
               WHEN  DP020-NEXT-ACT-APPL-ERROR                          11980099
                   CONTINUE                                             11990099
               WHEN (DP020-NEXT-ACT-READ-MAP AND                        12000099
                     DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID))             12010099
                   IF DP020-INT-APPL-FORMAT-IND = '2'                   12020099
                       CONTINUE                                         12030099
                   ELSE                                                 12040099
      *-->             ** NO "NEXT SKU" WHEN COMING FROM THE CRITERIA   12050099
      *-->             ** SPEC SCREEN - THE SKU IS FULLY QUALIFIED.     12060099
                       MOVE PC-TSYMSG-00113  TO  DP020-MSG-NUMBER       12070099
                       SET DP020-MSG-WARNING TO  TRUE                   12080099
                       SET PS-ERROR          TO  TRUE                   12090099
                       SET DP030-SET-CURSOR-TRAILER TO TRUE             12100099
                   END-IF                                               12110099
               WHEN DP020-NEXT-ACT-READ-MAP                             12120099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12130099
                                     TO PV-TOP-ITEM                     12140099
                   PERFORM 2000-PROCESS-PANEL                           12150099
                                                                        12160099
               WHEN DP020-NEXT-ACT-RETURN                               12170099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12180099
                                     TO PV-TOP-ITEM                     12190099
                   SET ASC-DISPLAY-UNITS   TO  TRUE                     12200099
                   MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        12210099
                   PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                 12220099
                                                                        12230099
               WHEN OTHER                                               12240099
                   SET DP013-LOGIC-ABEND TO TRUE                        12250099
                   SET DP013-NO-ROLLBACK TO TRUE                        12260099
                   MOVE '1000-CONTROL-PROCESSING'                       12270099
                                     TO  DP013-PARAGRAPH                12280099
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12290099
                                     TO  DP013-MESSAGE-TEXT(1)          12300099
                   PERFORM DP013-0000-PROCESS-ABEND                     12310099
           END-EVALUATE.                                                12320099
                                                                        12330099
      ******************************************************************12340099
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *12350099
      * IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *12360099
      ******************************************************************12370099
                                                                        12380099
       1100-PROCESS-INTER-APPL-COMM.                                    12390099
                                                                        12400099
           SET PS-COMMAREA-VALID            TO TRUE.                    12410099
                                                                        12420099
           INITIALIZE ASC-SPECIFIC-COMMAREA.                            12430099
                                                                        12440099
           SET ASC-DO-NOT-GET-MULTI-SKUS    TO TRUE.                    12450099
           SET ASC-HEADER-NOT-ALREADY-MOVED TO TRUE.                    12460099
           SET ASC-NEXT-DIST-FKEY-NOT-HIT   TO TRUE.                    12470099
                                                                        12480099
           MOVE CA-STORE-NUMBER-X           TO ASC-STORE-NUMBER.        12490099
                                                                        12500099
           MOVE SPACE                       TO ASC-START-ITEM-REQUEST.  12510099
                                                                        12520099
           EVALUATE DP020-INT-APPL-FORMAT-IND                           12530099
               WHEN PC-CRIT-SPEC-FORMAT                                 12540099
               WHEN PC-LIST-SCREEN-FORMAT                               12550099
               WHEN PC-MULTI-SKU-CRITERA-FORMAT                         12560099
                   CONTINUE                                             12570099
               WHEN OTHER                                               12580099
                   MOVE PC-TSYMSG-00148          TO DP020-MSG-NUMBER    12590099
                   SET DP020-MSG-FATAL           TO TRUE                12600099
                   SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                12610099
           END-EVALUATE.                                                12620099
                                                                        12630099
           IF DP020-NAV-KEY-DATA > SPACES                               12640099
               MOVE DP020-NAV-KEY-DATA TO CA-SKU-NUMBER-X               12650099
               IF CA-SKU-NUMBER-X NOT NUMERIC                           12660099
                   MOVE PC-TSYMSG-00419          TO DP020-MSG-NUMBER    12670099
                   SET DP020-MSG-FATAL           TO TRUE                12680099
                   SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                12690099
               END-IF                                                   12700099
           END-IF.                                                      12710099
                                                                        12720099
           EVALUATE DP020-INT-APPL-FORMAT-IND                           12730099
               WHEN PC-LIST-SCREEN-FORMAT                               12740099
      *-->          IND = 2                                             12750099
                    CONTINUE                                            12760099
               WHEN PC-MULTI-SKU-CRITERA-FORMAT                         12770099
      *-->          IND = 4                                             12780099
                    IF CA-DEPT-NUMBER-X  > SPACES AND                   12790099
                       CA-CLASS-NUMBER-X > SPACES AND                   12800099
MC0602                 CA-SKU-NUMBER-X   > SPACES                       12810099
                       MOVE CA-DEPT-NUMBER-X     TO ASC-DEPT-NMBR       12820099
                       MOVE CA-CLASS-NUMBER-X    TO ASC-CLASS-NMBR      12830099
MC0602                 MOVE CA-SKU-NUMBER-9      TO PV-SKU-LOW-C3       12840099
MC0602                 MOVE CA-SKU-NUMBER-X      TO PV-SKU-NMBR         12850099
                                                    ASC-SKU-NMBR-9      12860099
MC0602                 MOVE CA-SKU-NUMBER-X      TO ASC-INITL-SKU-NMBR  12870099
MC0602                 MOVE +99999999            TO PV-SKU-HIGH-C3      12880099
                       MOVE CA-SKU-DESCRIPTION   TO PV-SKU-DESC         12890099
                                                    ASC-SKU-DESC        12900099
                       PERFORM 1210-FILL-MULTI-SKUS-CRITERIA            12910099
                    ELSE                                                12920099
                      IF  CA-DEPT-NUMBER-X > SPACES AND                 12930099
                          CA-MAJOR-CLASS   > SPACES AND                 12940099
                          CA-MINOR-CLASS   > SPACES                     12950099
                          MOVE CA-DEPT-NUMBER-X  TO ASC-DEPT-NMBR       12960099
                          MOVE CA-CLASS-NUMBER-X TO ASC-CLASS-NMBR      12970099
MC0602                    MOVE ZERO              TO PV-SKU-LOW-C3       12980099
MC0602                                              PV-SKU-HIGH-C3      12990099
MC0602                    MOVE SPACES            TO PV-SKU-NMBR         13000099
MC0602                                              ASC-SKU-NMBR        13010099
MC0602                                              ASC-INITL-SKU-NMBR  13020099
                          MOVE CA-CLASS-DESCRIPTION                     13030099
                                                 TO PV-SKU-DESC         13040099
                                                    ASC-CLASS-DESC      13050099
                          SET  ASC-GET-MULTI-SKUS TO TRUE               13060099
                          PERFORM 1210-FILL-MULTI-SKUS-CRITERIA         13070099
                      END-IF                                            13080099
                   END-IF                                               13090099
               WHEN OTHER                                               13100099
      *-->          IND = 1 OR ANYTHING ELSE                            13110099
                    MOVE CA-DEPT-NUMBER-X       TO ASC-DEPT-NMBR        13120099
                    MOVE CA-CLASS-NUMBER-X      TO ASC-CLASS-NMBR       13130099
MC0602              MOVE CA-CLASS-NUMBER-9      TO PV-CLASS-LOW-C3      13140099
MC0602                                             PV-CLASS-HIGH-C3     13150099
MC0602              MOVE CA-SKU-NUMBER-9        TO PV-SKU-LOW-C3        13160099
MC0602              MOVE CA-SKU-NUMBER-X        TO PV-SKU-NMBR          13170099
MC0602              MOVE CA-SKU-NUMBER-X        TO ASC-SKU-NMBR         13180099
MC0602                                             ASC-INITL-SKU-NMBR   13190099
                    PERFORM 1220-FILL-SINGLE-SKU-CRITERIA               13200099
           END-EVALUATE.                                                13210099
                                                                        13220099
      ******************************************************************13230099
      *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *13240099
      *    ON WHAT FUNCTION KEY WAS SELECTED.                          *13250099
      ******************************************************************13260099
       1210-FILL-MULTI-SKUS-CRITERIA.                                   13270099
                                                                        13280099
           PERFORM 1230-SET-STORE-CSR-VALUES.                           13290099
                                                                        13300099
MC0602     MOVE ASC-DEPT-NMBR-9    TO PV-DEPT-NMBR-C3.                  13310099
                                                                        13320099
MC0602     MOVE ASC-CLASS-NMBR-9   TO PV-CLASS-LOW-C3                   13330099
MC0602                                PV-CLASS-HIGH-C3.                 13340099
                                                                        13350099
           INITIALIZE PV-STATUS-CODES.                                  13360099
           SET STAT-IND            TO 1.                                13370099
                                                                        13380099
           IF CA-STAT-10-ENTERED                                        13390099
               MOVE PC-STATUS-10   TO PV-STATUS-1                       13400099
               MOVE 'NEW'          TO PV-STATUS-CODE(STAT-IND)          13410099
               SET STAT-IND        UP BY 1                              13420099
           END-IF                                                       13430099
           IF CA-STAT-20-ENTERED                                        13440099
               MOVE PC-STATUS-20   TO PV-STATUS-2                       13450099
               MOVE PC-STATUS-25   TO PV-STATUS-6                       13460099
               MOVE 'ACT'          TO PV-STATUS-CODE(STAT-IND)          13470099
               SET STAT-IND        UP BY 1                              13480099
           END-IF                                                       13490099
           IF CA-STAT-30-ENTERED                                        13500099
               MOVE PC-STATUS-30   TO PV-STATUS-3                       13510099
               MOVE PC-STATUS-25   TO PV-STATUS-6                       13520099
               MOVE 'CLR'          TO PV-STATUS-CODE(STAT-IND)          13530099
               SET STAT-IND        UP BY 1                              13540099
           END-IF                                                       13550099
           IF CA-STAT-40-ENTERED                                        13560099
               MOVE PC-STATUS-40   TO PV-STATUS-4                       13570099
               MOVE 'PRO'          TO PV-STATUS-CODE(STAT-IND)          13580099
               SET STAT-IND        UP BY 1                              13590099
           END-IF                                                       13600099
           IF CA-STAT-90-ENTERED                                        13610099
               MOVE PC-STATUS-90   TO PV-STATUS-5                       13620099
               MOVE 'DIS'          TO PV-STATUS-CODE(STAT-IND)          13630099
           END-IF.                                                      13640099
           IF CA-STAT-25-ENTERED                                        13650099
               MOVE PC-STATUS-25   TO PV-STATUS-6                       13660099
               MOVE 'MIX'          TO PV-STATUS-CODE(STAT-IND)          13670099
           END-IF.                                                      13680099
                                                                        13690099
           IF CA-GROUP-CODE > SPACES                                    13700099
               MOVE CA-GROUP-CODE  TO PV-GROUP-LOW                      13710099
                                      PV-GROUP-HIGH                     13720099
           ELSE                                                         13730099
               MOVE PC-LOW-VALUES  TO PV-GROUP-LOW                      13740099
               MOVE PC-HIGH-VALUES TO PV-GROUP-HIGH                     13750099
           END-IF.                                                      13760099
                                                                        13770099
           IF CA-STYLE > SPACES                                         13780099
0518           MOVE CA-STYLE       TO PV-VND-STYL-LO                    13790099
0518                                  PV-VND-STYL-HI                    13800099
0518                                  PV-LNG-STYL-LO                    13810099
0518                                  PV-LNG-STYL-HI                    13820099
0518                                  PV-VENDOR-STYLE                   13830099
0518  *        MOVE CA-STYLE TO PV-STYLE-LOW                            13840099
0518  *                         PV-STYLE-HIGH                           13850099
0518  *                         PV-VENDOR-STYLE                         13860099
           ELSE                                                         13870099
0518           MOVE PC-LOW-VALUES  TO PV-VND-STYL-LO                    13880099
0518                                  PV-LNG-STYL-LO                    13890099
0518           MOVE PC-HIGH-VALUES TO PV-VND-STYL-HI                    13900099
0518                                  PV-LNG-STYL-HI                    13910099
0518  *        MOVE PC-LOW-VALUES  TO PV-STYLE-LOW                      13920099
0518  *        MOVE PC-HIGH-VALUES TO PV-STYLE-HIGH                     13930099
               MOVE SPACES         TO PV-VENDOR-STYLE                   13940099
           END-IF.                                                      13950099
                                                                        13960099
           IF CA-KEY-ITEM  = 'Y' OR                                     13970099
              CA-KEY-ITEM  = 'N'                                        13980099
               MOVE CA-KEY-ITEM    TO PV-KYITM-LOW                      13990099
                                      PV-KYITM-HIGH                     14000099
           ELSE                                                         14010099
               MOVE PC-LOW-VALUES  TO PV-KYITM-LOW                      14020099
               MOVE PC-HIGH-VALUES TO PV-KYITM-HIGH                     14030099
           END-IF.                                                      14040099
                                                                        14050099
           IF CA-VSM-REPLENISH = 'Y' OR                                 14060099
              CA-VSM-REPLENISH = 'N'                                    14070099
               MOVE CA-VSM-REPLENISH  TO PV-REPLEN-LOW                  14080099
                                         PV-REPLEN-HIGH                 14090099
           ELSE                                                         14100099
               MOVE PC-LOW-VALUES     TO PV-REPLEN-LOW                  14110099
               MOVE PC-HIGH-VALUES    TO PV-REPLEN-HIGH                 14120099
           END-IF.                                                      14130099
                                                                        14140099
           IF CA-TSK-LONG-COLOR = SPACES                                14150099
              MOVE PC-LOW-VALUES     TO PV-LONG-COLOR-LOW               14160099
              MOVE PC-HIGH-VALUES    TO PV-LONG-COLOR-HIGH              14170099
              MOVE SPACES            TO PV-COLOR                        14180099
           ELSE                                                         14190099
              MOVE CA-TSK-LONG-COLOR TO PV-LONG-COLOR-LOW               14200099
                                        PV-LONG-COLOR-HIGH              14210099
                                        PV-COLOR                        14220099
           END-IF.                                                      14230099
                                                                        14240099
           IF CA-COLOR-1-X = SPACES                                     14250099
              MOVE PC-LOW-VALUES  TO PV-COLOR-LOW                       14260099
              MOVE PC-HIGH-VALUES TO PV-COLOR-HIGH                      14270099
           ELSE                                                         14280099
              MOVE CA-COLOR-1-X    TO PV-COLOR-LOW                      14290099
              IF CA-COLOR-2-X = SPACES                                  14300099
                 MOVE CA-COLOR-1-X TO PV-COLOR-HIGH                     14310099
              ELSE                                                      14320099
                 MOVE CA-COLOR-2-X TO PV-COLOR-HIGH                     14330099
              END-IF                                                    14340099
           END-IF.                                                      14350099
                                                                        14360099
           IF PV-COLOR = SPACES                                         14370099
              IF CA-COLOR-1-X = SPACES AND                              14380099
                 CA-COLOR-2-X = SPACES                                  14390099
                 MOVE PC-ALL-COLS   TO PV-COLOR                         14400099
              ELSE                                                      14410099
                 MOVE CA-COLOR-DESC TO PV-COLOR                         14420099
              END-IF                                                    14430099
           END-IF.                                                      14440099
                                                                        14450099
           IF CA-SIZE-CDE > SPACES                                      14460099
              MOVE CA-SIZE-CDE     TO PV-SIZE-LOW                       14470099
                                      PV-SIZE-HIGH                      14480099
              MOVE CA-SIZE-DESC    TO PV-SIZE                           14490099
           ELSE                                                         14500099
              MOVE PC-LOW-VALUES   TO PV-SIZE-LOW                       14510099
              MOVE PC-HIGH-VALUES  TO PV-SIZE-HIGH                      14520099
              MOVE PC-ALL-SIZES    TO PV-SIZE                           14530099
           END-IF.                                                      14540099
                                                                        14550099
           IF CA-INHOUSE-NUMBER > SPACES                                14560099
               MOVE CA-INHOUSE-NUMBER-9 TO PV-VENDOR-LOW                14570099
                                           PV-VENDOR-HIGH               14580099
               MOVE CA-INHOUSE-NUMBER   TO PV-VENDOR                    14590099
               MOVE CA-VENDOR-NAME      TO PV-VENDOR-NAME               14600099
           ELSE                                                         14610099
               MOVE PC-VENDOR-LOW       TO PV-VENDOR-LOW                14620099
               MOVE PC-VENDOR-HIGH      TO PV-VENDOR-HIGH               14630099
               MOVE SPACES              TO PV-VENDOR                    14640099
                                           PV-VENDOR-NAME               14650099
           END-IF.                                                      14660099
                                                                        14670099
      ******************************************************************14680099
      *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *14690099
      *    ON WHAT FUNCTION KEY WAS SELECTED.                          *14700099
      ******************************************************************14710099
       1220-FILL-SINGLE-SKU-CRITERIA.                                   14720099
                                                                        14730099
MC0602     MOVE ASC-DEPT-NMBR-9        TO PV-DEPT-NMBR-C3.              14740099
                                                                        14750099
MC0602     MOVE +99999999              TO PV-SKU-HIGH-C3.               14760099
                                                                        14770099
           PERFORM 1230-SET-STORE-CSR-VALUES.                           14780099
                                                                        14790099
           INITIALIZE PV-STATUS-CODES.                                  14800099
                                                                        14810099
           MOVE PC-STATUS-10        TO PV-STATUS-1.                     14820099
           MOVE PC-STATUS-20        TO PV-STATUS-2.                     14830099
           MOVE PC-STATUS-30        TO PV-STATUS-3.                     14840099
           MOVE PC-STATUS-40        TO PV-STATUS-4.                     14850099
           MOVE PC-STATUS-90        TO PV-STATUS-5.                     14860099
           MOVE PC-STATUS-25        TO PV-STATUS-6.                     14870099
                                                                        14880099
           MOVE PC-LOW-VALUES       TO PV-GROUP-LOW.                    14890099
           MOVE PC-HIGH-VALUES      TO PV-GROUP-HIGH.                   14900099
                                                                        14910099
0518  *    MOVE PC-LOW-VALUES       TO PV-STYLE-LOW.                    14920099
0518  *    MOVE PC-HIGH-VALUES      TO PV-STYLE-HIGH.                   14930099
0518       MOVE PC-LOW-VALUES       TO PV-VND-STYL-LO                   14940099
0518                                   PV-LNG-STYL-LO.                  14950099
0518       MOVE PC-HIGH-VALUES      TO PV-VND-STYL-HI                   14960099
0518                                   PV-LNG-STYL-HI.                  14970099
                                                                        14980099
           MOVE PC-LOW-VALUES       TO PV-KYITM-LOW.                    14990099
           MOVE PC-HIGH-VALUES      TO PV-KYITM-HIGH.                   15000099
                                                                        15010099
           MOVE PC-LOW-VALUES       TO PV-REPLEN-LOW.                   15020099
           MOVE PC-HIGH-VALUES      TO PV-REPLEN-HIGH.                  15030099
                                                                        15040099
           MOVE PC-LOW-VALUES       TO PV-LONG-COLOR-LOW.               15050099
           MOVE PC-HIGH-VALUES      TO PV-LONG-COLOR-HIGH.              15060099
                                                                        15070099
           MOVE PC-LOW-VALUES       TO PV-COLOR-LOW.                    15080099
           MOVE PC-HIGH-VALUES      TO PV-COLOR-HIGH.                   15090099
                                                                        15100099
           MOVE PC-LOW-VALUES       TO PV-SIZE-LOW.                     15110099
           MOVE PC-HIGH-VALUES      TO PV-SIZE-HIGH.                    15120099
                                                                        15130099
           MOVE PC-VENDOR-LOW       TO PV-VENDOR-LOW.                   15140099
           MOVE PC-VENDOR-HIGH      TO PV-VENDOR-HIGH.                  15150099
                                                                        15160099
      ******************************************************************15170099
      *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *15180099
      *    ON WHAT FUNCTION KEY WAS SELECTED.                          *15190099
      ******************************************************************15200099
       1230-SET-STORE-CSR-VALUES.                                       15210099
                                                                        15220099
      *--> SET PROCESS STORES SW TO SOME STORES / RESET IF STORE 000    15230099
      *--> USED TO DETERMINE IF NA/CS/DC STORES ARE DISPLAYED           15240099
           SET PS-PROCESS-SOME-STORES TO TRUE.                          15250099
           SET PS-ALL-STORE-INFO      TO TRUE.                          15260099
                                                                        15270099
      *--> SET STORE NUMBER FIELD                                       15280099
           IF ASC-STORE-NUMBER NOT NUMERIC                              15290099
              SET PS-PROCESS-ALL-STORES  TO TRUE                        15300099
              MOVE ZEROS                 TO PV-STORE-HIGH               15310099
              MOVE PV-STORE-HIGH         TO PV-STORE-HIGH-COMP          15320099
              SET PS-ALL-STORE-INFO      TO TRUE                        15330099
              MOVE 'ALL STORES'          TO ASTTYPI                     15340099
           ELSE                                                         15350099
           IF ASC-STORE-NUMBER = ZEROS                                  15360099
              SET PS-PROCESS-ALL-STORES  TO TRUE                        15370099
              MOVE ASC-STORE-NUMBER      TO PV-STORE-HIGH               15380099
              MOVE PV-STORE-HIGH         TO PV-STORE-HIGH-COMP          15390099
              SET PS-ALL-STORE-INFO      TO TRUE                        15400099
              MOVE 'ALL STORES'          TO ASTTYPI                     15410099
           ELSE                                                         15420099
              SET PS-PROCESS-SOME-STORES TO TRUE                        15430099
              MOVE ASC-STORE-NUMBER      TO PV-STORE-LOW                15440099
              MOVE PV-STORE-LOW          TO PV-STORE-LOW-COMP           15450099
              SET PS-ONE-STORE-INFO      TO TRUE                        15460099
           END-IF.                                                      15470099
                                                                        15480099
                                                                        15490099
      ** MK-10760-B DELETED REFERENCE TO METRO AREA.                    15500099
      *--> SET METRO AREA NUMBER FIELD                                  15510099
      **   IF CA-METRO-NUMBER NOT NUMERIC                               15520099
      **      MOVE 999                   TO PV-METRO-LOW                15530099
      **      MOVE 000                   TO PV-METRO-HIGH               15540099
      **   ELSE                                                         15550099
      **      SET PS-PROCESS-SOME-STORES TO TRUE                        15560099
      **      MOVE CA-METRO-NUMBER-9     TO PV-METRO-LOW                15570099
      **      MOVE 999                   TO PV-METRO-HIGH               15580099
      **      MOVE 'METRO: '             TO ASTTYPHI                    15590099
      **      MOVE CA-METRO-NAME         TO ASTTYPI                     15600099
      **   END-IF.                                                      15610099
      ** MK-10760-E DELETED REFERENCE TO METRO AREA.                    15620099
                                                                        15630099
      ******************************************************************15640099
      *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *15650099
      *    ON WHAT FUNCTION KEY WAS SELECTED.                          *15660099
      ******************************************************************15670099
       2000-PROCESS-PANEL.                                              15680099
                                                                        15690099
           EVALUATE TRUE                                                15700099
               WHEN DP020-SRC-AID = DP016-CLEAR                         15710099
                   MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                15720099
                   PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                 15730099
                   PERFORM 3200-RESET-ATTRIBUTES                        15740099
                                                                        15750099
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    15760099
      ********     PERFORM 2050-DELETE-DETAIL-QUEUE                     15770099
      ********     PERFORM 4000-BUILD-INITIAL-PANEL                     15780099
                   PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                 15790099
                   PERFORM 3200-RESET-ATTRIBUTES                        15800099
                                                                        15810099
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  15820099
                   MOVE +1 TO PV-TOP-ITEM                               15830099
                   PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                 15840099
                   PERFORM 3200-RESET-ATTRIBUTES                        15850099
                                                                        15860099
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   15870099
                   PERFORM 2110-BROWSE-BACKWARD                         15880099
                   PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                 15890099
                   PERFORM 3200-RESET-ATTRIBUTES                        15900099
                                                                        15910099
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15920099
                   PERFORM 2120-BROWSE-FORWARD                          15930099
                   PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                 15940099
                   PERFORM 3200-RESET-ATTRIBUTES                        15950099
                                                                        15960099
               WHEN DP020-SRC-AID = DP016-ENTER                         15970099
                   PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15980099
                   IF  PS-ERROR                                         15990099
                       CONTINUE                                         16000099
                   ELSE                                                 16010099
                       PERFORM 5800-MOVE-COMMAREA-TO-SCREEN             16020099
                       PERFORM 3200-RESET-ATTRIBUTES                    16030099
                   END-IF                                               16040099
                                                                        16050099
               WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               16060099
                    IF ASC-DISPLAY-UNITS                                16070099
                        SET ASC-DISPLAY-DOLLARS  TO TRUE                16080099
                    ELSE                                                16090099
                        SET ASC-DISPLAY-UNITS    TO TRUE                16100099
                    END-IF                                              16110099
                    PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                16120099
                    PERFORM 3200-RESET-ATTRIBUTES                       16130099
                                                                        16140099
               WHEN OTHER                                               16150099
                   SET DP013-NO-ROLLBACK TO TRUE                        16160099
                   SET DP013-XCTL-DISPLAY-RESTART TO TRUE               16170099
                   SET DP013-CICS-ABEND TO TRUE                         16180099
                   MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         16190099
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      16200099
                                         TO DP013-MESSAGE-TEXT (1)      16210099
                   PERFORM DP013-0000-PROCESS-ABEND                     16220099
                                                                        16230099
           END-EVALUATE.                                                16240099
                                                                        16250099
      ******************************************************************16260099
      *    DELETE THE TEMPORARY STORAGE QUEUE.                         *16270099
      ******************************************************************16280099
       2050-DELETE-DETAIL-QUEUE.                                        16290099
                                                                        16300099
           EXEC CICS                                                    16310099
               DELETEQ TS                                               16320099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          16330099
                   RESP  (PV-CICS-RESP)                                 16340099
           END-EXEC.                                                    16350099
                                                                        16360099
           IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       16370099
              (PV-CICS-RESP = DFHRESP(QIDERR))                          16380099
               CONTINUE                                                 16390099
           ELSE                                                         16400099
               SET DP013-CICS-ABEND TO TRUE                             16410099
               SET DP013-NO-ROLLBACK TO TRUE                            16420099
                                                                        16430099
               MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       16440099
               MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  16450099
                              TO DP013-MESSAGE-TEXT (1)                 16460099
               PERFORM DP013-0000-PROCESS-ABEND                         16470099
           END-IF.                                                      16480099
                                                                        16490099
           MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        16500099
                                                                        16510099
      ******************************************************************16520099
      *    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16530099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16540099
      *    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16550099
      *    MESSAGE.                                                    *16560099
      ******************************************************************16570099
       2110-BROWSE-BACKWARD.                                            16580099
                                                                        16590099
           SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16600099
               GIVING PV-TOP-ITEM.                                      16610099
                                                                        16620099
           IF  PV-TOP-ITEM < +1                                         16630099
               MOVE +1              TO PV-TOP-ITEM                      16640099
      *-->     -- TOP OF LIST --                                        16650099
               MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 16660099
               SET DP020-MSG-INFORMATIONAL TO TRUE                      16670099
           END-IF.                                                      16680099
                                                                        16690099
      ******************************************************************16700099
      *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16710099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16720099
      *    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *16730099
      ******************************************************************16740099
       2120-BROWSE-FORWARD.                                             16750099
                                                                        16760099
           ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              16770099
               GIVING PV-TOP-ITEM.                                      16780099
           IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16790099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16800099
                                         TO PV-TOP-ITEM                 16810099
      *-->     -- BOTTOM OF LIST --                                     16820099
               MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16830099
               SET DP020-MSG-INFORMATIONAL                              16840099
                                         TO TRUE                        16850099
           ELSE                                                         16860099
               COMPUTE PV-BOTTOM-ITEM =                                 16870099
                   PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16880099
               IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16890099
      *-->         -- BOTTOM OF LIST --                                 16900099
                   MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16910099
                   SET DP020-MSG-INFORMATIONAL                          16920099
                                         TO TRUE                        16930099
               END-IF                                                   16940099
           END-IF.                                                      16950099
                                                                        16960099
      ******************************************************************16970099
      *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16980099
      *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16990099
      *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *17000099
      *    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *17010099
      *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *17020099
      *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *17030099
      ******************************************************************17040099
       2130-CHECK-FOR-JUMP-BROWSE.                                      17050099
                                                                        17060099
           IF ASTRTITL > ZEROES                                         17070099
               MOVE ASTRTITI TO ASC-START-ITEM-REQUEST.                 17080099
                                                                        17090099
           IF (ASC-START-ITEM-REQUEST = SPACE)                          17100099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17110099
                                         TO PV-TOP-ITEM                 17120099
           ELSE                                                         17130099
               MOVE ASC-START-ITEM-REQUEST                              17140099
                                         TO DP010I-UNEDITED-FIELD       17150099
               MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17160099
               MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     17170099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          17180099
                                         TO TRUE                        17190099
272945         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17201099
272945                         USING DP010I-NUMERIC-EDIT-AREA           17202099
                                                                        17210099
               IF  NOT DP010I-ERROR-DETECTED                            17220099
                   MOVE DP010I-NUMERIC-FIELD                            17230099
                                         TO ASC-START-ITEM-REQUEST-N    17240099
                   IF  ASC-START-ITEM-REQUEST-N > ZERO                  17250099
                       IF  ASC-START-ITEM-REQUEST-N >                   17260099
                                                ASC-NUMBER-OF-ITEMS-READ17270099
                           MOVE SPACE TO ASC-START-ITEM-REQUEST         17280099
                           COMPUTE PV-TOP-ITEM =                        17290099
                                   ASC-NUMBER-OF-ITEMS-READ             17300099
                                   - PC-ITEMS-PER-PANEL + 1             17310099
                           IF  PV-TOP-ITEM < +1                         17320099
                               MOVE +1   TO PV-TOP-ITEM                 17330099
                               MOVE PC-TSYMSG-00070                     17340099
                                         TO DP020-MSG-NUMBER            17350099
                               SET DP020-MSG-INFORMATIONAL              17360099
                                         TO TRUE                        17370099
                           END-IF                                       17380099
                       ELSE                                             17390099
                           MOVE ASC-START-ITEM-REQUEST-N                17400099
                                         TO PV-TOP-ITEM                 17410099
                           MOVE SPACE    TO ASC-START-ITEM-REQUEST      17420099
                           COMPUTE PV-BOTTOM-ITEM =                     17430099
                               PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17440099
                           IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17450099
      *-->                     -- BOTTOM OF LIST --                     17460099
                               MOVE PC-TSYMSG-00070                     17470099
                                         TO DP020-MSG-NUMBER            17480099
                               SET DP020-MSG-INFORMATIONAL              17490099
                                         TO TRUE                        17500099
                           END-IF                                       17510099
                       END-IF                                           17520099
                   ELSE                                                 17530099
      *-->             --- VALUE OUT OF RANGE ----                      17540099
                       MOVE PC-TSYMSG-00101                             17550099
                                         TO DP020-MSG-NUMBER            17560099
                       MOVE -1           TO ASTRTITL                    17570099
                       SET DP030-SET-CURSOR-APPL-1                      17580099
                                         TO TRUE                        17590099
                       MOVE DP015-REVERSE                               17600099
                                         TO ASTRTITH                    17610099
                       MOVE DP015-RED    TO ASTRTITC                    17620099
                       MOVE DP015-UNP-NUM-BRT-OFF                       17630099
                                         TO ASTRTITA                    17640099
                       SET DP020-MSG-FATAL                              17650099
                           PS-START-ITEM-ERROR                          17660099
                                         TO TRUE                        17670099
                   END-IF                                               17680099
                                                                        17690099
               ELSE                                                     17700099
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17710099
                   MOVE -1               TO ASTRTITL                    17720099
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17730099
                   MOVE DP015-REVERSE    TO ASTRTITH                    17740099
                   MOVE DP015-RED        TO ASTRTITC                    17750099
                   MOVE DP015-UNP-NUM-BRT-OFF                           17760099
                                         TO ASTRTITA                    17770099
                   SET DP020-MSG-FATAL                                  17780099
                       PS-START-ITEM-ERROR                              17790099
                                         TO TRUE                        17800099
               END-IF                                                   17810099
           END-IF.                                                      17820099
                                                                        17830099
      ******************************************************************17840099
      *    RESET ATTRIBUTES.                                           *17850099
      ******************************************************************17860099
       3200-RESET-ATTRIBUTES.                                           17870099
                                                                        17880099
           MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   17890099
           MOVE DP015-GREEN              TO ASTRTITC.                   17900099
           MOVE DP015-UNDERLINE          TO ASTRTITH.                   17910099
           MOVE -1                       TO ASTRTITL.                   17920099
           SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       17930099
                                                                        17940099
      ******************************************************************17950099
      *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *17960099
      *    INITIALIZE ALL COUNTERS AND FLAGS.                          *17970099
      *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *17980099
      *    DISPLAY THE PANEL TO USER.                                  *17990099
      ******************************************************************18000099
       4000-BUILD-INITIAL-PANEL.                                        18010099
                                                                        18020099
           INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18030099
                                       ASC-BLOCK-ENTRIES (2).           18040099
           MOVE +1                  TO  ASC-BLK-SUB.                    18050099
           SET ASC-ITEMS-LEFT-ON-DB TO  TRUE.                           18060099
                                                                        18070099
           MOVE +0                  TO ASC-ITEM-SUB                     18080099
                                       ASC-NUMBER-OF-ITEMS-READ         18090099
                                       ASC-NUMBER-OF-SELECTED-ITEMS     18100099
                                       ASC-HIGHEST-BLOCK-WRITTEN        18110099
                                       ASC-START-OF-SELECTED-RANGE      18120099
                                       ASC-END-OF-SELECTED-RANGE        18130099
                                       ASC-ITEM-AT-TOP-OF-PANEL.        18140099
                                                                        18150099
           INITIALIZE PV-STORE-AMOUNTS                                  18160099
                      PV-TOTAL-AMOUNTS                                  18170099
                      ST-STORE-TABLE.                                   18180099
                                                                        18190099
           SET ASC-DISPLAY-UNITS    TO TRUE.                            18200099
                                                                        18210099
      *--> GET 5 WEEKS OF SALES DATES - USED TO GET WEEKLY SALES        18220099
           PERFORM 4020-SET-SALES-DATES.                                18230099
                                                                        18240099
      *--> GET SKU COUNT TO DETERMINE WHEN TS FOR EACH STORE IS WRITTEN 18250099
           PERFORM 7235-GET-SKU-COUNT-2                                 18260099
                                                                        18270099
      *--> PROCESS ALL SKUS - (CURSOR USED FOR SINGLE AND MULTIPLE SKUS)18280099
           PERFORM 7205-OPEN-SKUS-CSR-2                                 18290099
                                                                        18300099
           SET PS-ALL-SKUS-NOT-PROCESSED TO TRUE.                       18310099
           PERFORM 7215-FETCH-SKUS-CSR-2                                18320099
                                                                        18330099
           PERFORM 4100-PROCESS-SKUS                                    18340099
               UNTIL PS-ALL-SKUS-PROCESSED.                             18350099
                                                                        18360099
           PERFORM 7225-CLOSE-SKUS-CSR-2                                18370099
                                                                        18380099
      *--> FINISH  WRITING TEMP-STOREAGE RECS                           18390099
           IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          18400099
               MOVE +1                       TO  ASC-BLK-SUB            18410099
               PERFORM 6100-WRITE-TEMP-STORAGE                          18420099
               ADD +1                        TO  ASC-BLK-SUB            18430099
               PERFORM 6100-WRITE-TEMP-STORAGE                          18440099
                                                                        18450099
               MOVE 1                        TO  ASC-BLK-SUB            18460099
                                                 PV-BLOCK-NUMBER        18470099
               PERFORM 6000-READ-TEMP-STORAGE                           18480099
               IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             18490099
                   MOVE 2                    TO  ASC-BLK-SUB            18500099
                                                 PV-BLOCK-NUMBER        18510099
                   PERFORM 6000-READ-TEMP-STORAGE                       18520099
               END-IF                                                   18530099
           END-IF.                                                      18540099
                                                                        18550099
      *--> MOVE TOTAL-LINE TO COMMAREA - QTYS & DOLLARS                 18560099
           PERFORM  4010-MOVE-TOTALS.                                   18570099
                                                                        18580099
      ******************************************************************18590099
      *    MOVE SKU-INFO                                               *18600099
      ******************************************************************18610099
       4010-MOVE-TOTALS.                                                18620099
                                                                        18630099
      *--> MOVE TOTAL QTYS TO COMMAREA QTY TOTALS                       18640099
           MOVE PV-TOT-CUR-ONHAND-QTY    TO ASC-TOT-CUR-ONHAND-QTY.     18650099
           MOVE PV-TOT-CUR-SALES-QTY     TO ASC-TOT-CUR-SALES-QTY.      18660099
           MOVE PV-TOT-LAST-WK-SALES-QTY TO ASC-TOT-LAST-WK-SALES-QTY.  18670099
MC1201     MOVE PV-TOT-INTRANSIT-QTY     TO ASC-TOT-INTRANSIT-QTY.      18680099
           MOVE PV-TOT-ON-ORDER-QTY      TO ASC-TOT-ON-ORDER-QTY.       18690099
           COMPUTE PV-TOT-STORE-OH-QTY  =                               18700099
              PV-TOT-CUR-ONHAND-QTY - PV-TOT-RECEIPT-QTY                18710099
           MOVE PV-TOT-STORE-OH-QTY      TO ASC-TOT-STORE-OH-QTY.       18720099
                                                                        18730099
      *--> ROUND AND MOVE TOTAL AMTS TO COMMAREA AMT TOTALS             18740099
           COMPUTE ASC-TOT-CUR-ONHAND-AMT    ROUNDED =                  18750099
                   PV-TOT-CUR-ONHAND-AMT     * 1.                       18760099
           COMPUTE ASC-TOT-CUR-SALES-AMT     ROUNDED =                  18770099
                   PV-TOT-CUR-SALES-AMT      * 1.                       18780099
           COMPUTE ASC-TOT-LAST-WK-SALES-AMT ROUNDED =                  18790099
                   PV-TOT-LAST-WK-SALES-AMT  * 1.                       18800099
MC1201     COMPUTE ASC-TOT-INTRANSIT-AMT     ROUNDED =                  18810099
MC1201             PV-TOT-INTRANSIT-AMT      * 1.                       18820099
           COMPUTE ASC-TOT-ON-ORDER-AMT      ROUNDED =                  18830099
                   PV-TOT-ON-ORDER-AMT       * 1.                       18840099
                                                                        18850099
           COMPUTE PV-TOT-STORE-OH-AMT  =                               18860099
              PV-TOT-CUR-ONHAND-AMT - PV-TOT-RECEIPT-AMT                18870099
           COMPUTE ASC-TOT-STORE-OH-AMT      ROUNDED =                  18880099
                   PV-TOT-STORE-OH-AMT       * 1.                       18890099
                                                                        18900099
           MOVE +1                           TO  PV-TOP-ITEM.           18910099
                                                                        18920099
      *--> IF THERE ISN'T ANY INFORMATION TO DISPLAY AND F21 (NXT DIST) 18930099
      *--> WAS NOT HIT DISPLAY AN ERROR MESSAGE, OTHERWISE DISPLAY THE  18940099
      *--> SCREEN INFORMATION.                                          18950099
           IF ASC-NUMBER-OF-ITEMS-READ = ZERO AND                       18960099
              ASC-NEXT-DIST-FKEY-NOT-HIT                                18970099
               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    18980099
               SET DP020-MSG-FATAL           TO  TRUE                   18990099
               MOVE PC-TSYMSG-00050          TO  DP020-MSG-NUMBER       19000099
           ELSE                                                         19010099
               MOVE -1                       TO ASTRTITL                19020099
               SET DP030-SET-CURSOR-APPL-1   TO TRUE                    19030099
               PERFORM 5800-MOVE-COMMAREA-TO-SCREEN                     19040099
           END-IF.                                                      19050099
                                                                        19060099
           SET ASC-NEXT-DIST-FKEY-NOT-HIT    TO TRUE.                   19070099
                                                                        19080099
      ******************************************************************19090099
      * THIS WILL USE THE STANDARD SYSTEM ROUTINE TO FIND THE CURRENT   19100099
      * FIRST WEEKDAY DATE, GIVEN TODAYS DATE FROM THE EIBDATE FIELD.   19110099
      * THIS WEEK'S FIRST WEEKDAY DATE WILL BE PLACED IN THE FIRST ENTRY19120099
      * OF THE 5 ENTRY WEEKLY DATE TABLE (THIS TABLE CONTAINS THIS WEEK 19130099
      * AND THE PREVIOUS 4 WEEKS)                                       19140099
      ******************************************************************19150099
       4020-SET-SALES-DATES.                                            19160099
                                                                        19170099
           MOVE SPACES                 TO PV-WKLY-DATE-KEYS.            19180099
                                                                        19190099
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              19200099
           SET DPG51-FISCAL-JAN-DEC-F2                                  19210099
               DPG51-DO-NOT-INCR-DECR-DATE                              19220099
               DPG52-LK-DTE-GREG       TO TRUE.                         19230099
           MOVE PC-SYSTEM-DATE         TO DPG52-GREG-DATE-N.            19240099
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          19250099
                                                   DPG53 DPG54          19260099
                                                   DPG55 DPG56.         19270099
           MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO PV-WKLY-BOW-DATE(1).       19280099
                                                                        19290099
           PERFORM VARYING PV-WK                                        19300099
             FROM 2 BY 1                                                19310099
               UNTIL PV-WK > PC-MAX-NUM-WEEKS                           19320099
                 SET DPG51-FISCAL-JAN-DEC-F2                            19330099
                     DPG51-DECREMENT-DATE                               19340099
                     DPG52-LK-DTE-GREG      TO TRUE                     19350099
                 MOVE 7                     TO DPG51-INCR-DECR-DAYS-9   19360099
                 MOVE DPG55-1ST-WKDY-GREG-N TO DPG52-GREG-DATE-N        19370099
                 CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52    19380099
                                                         DPG53 DPG54    19390099
                                                         DPG55 DPG56    19400099
                 MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO                      19410099
                                     PV-WKLY-BOW-DATE(PV-WK)            19420099
           END-PERFORM.                                                 19430099
                                                                        19440099
      ******************************************************************19450099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *19460099
      *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *19470099
      *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *19480099
      *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *19490099
      *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *19500099
      *                                                                *19510099
      *    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *19520099
      *    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *19530099
      *    UPON INITIALIZATION.                                        *19540099
      ******************************************************************19550099
                                                                        19560099
       4100-PROCESS-SKUS.                                               19570099
                                                                        19580099
           IF ASC-GET-MULTI-SKUS                                        19590099
MC0602        MOVE SKXREF-DEPT                TO ASC-DEPT-NMBR-9        19600099
MC0602        MOVE SKXREF-SUBCLASS            TO ASC-CLASS-NMBR-9       19610099
MC0602        MOVE SKXREF-SKU                 TO ASC-SKU-NMBR-9         19620099
              MOVE TSK-CUR-UNIT-RTL-AMT       TO PV-CUR-RTL             19630099
           ELSE                                                         19640099
              PERFORM 7100-SELECT-SKU-INFO                              19650099
              PERFORM 4110-MOVE-SKU-INFO                                19660099
              PERFORM 4120-MOVE-VENDOR-INFO                             19670099
           END-IF.                                                      19680099
                                                                        19690099
           IF PS-ALL-STORE-INFO                                         19700099
               PERFORM 7400-OPEN-ALL-STORES-CURSOR                      19710099
                                                                        19720099
               SET  ASC-ITEMS-LEFT-ON-DB TO TRUE                        19730099
               PERFORM 7410-FETCH-ALL-STORES                            19740099
                                                                        19750099
      *--> SET STORE INDEX TO ONE FOR FIRST STORE ACCUMULATORS          19760099
               SET ST-IND TO 1                                          19770099
                                                                        19780099
               PERFORM 4200-PROCESS-STORES                              19790099
                  UNTIL ASC-NO-ITEMS-LEFT-ON-DB                         19800099
                                                                        19810099
               PERFORM 7420-CLOSE-ALL-STORES-CURSOR                     19820099
           ELSE                                                         19830099
               PERFORM 7300-OPEN-STORES-CURSOR                          19840099
                                                                        19850099
               SET  ASC-ITEMS-LEFT-ON-DB TO TRUE                        19860099
               PERFORM 7310-FETCH-STORES                                19870099
                                                                        19880099
      *--> SET STORE INDEX TO ONE FOR FIRST STORE ACCUMULATORS          19890099
               SET ST-IND TO 1                                          19900099
                                                                        19910099
               PERFORM 4200-PROCESS-STORES                              19920099
                  UNTIL ASC-NO-ITEMS-LEFT-ON-DB                         19930099
                                                                        19940099
               PERFORM 7320-CLOSE-STORES-CURSOR                         19950099
           END-IF.                                                      19960099
                                                                        19970099
      *--> ONLY MOVE NA/CS/DC LOCATIONS FOR ALL STORES / STORE 000      19980099
           IF PS-PROCESS-ALL-STORES                                     19990099
              PERFORM 5000-MOVE-LAST-STORES                             20000099
           END-IF.                                                      20010099
                                                                        20020099
           PERFORM 7215-FETCH-SKUS-CSR-2.                               20030099
                                                                        20040099
      ******************************************************************20050099
      *    MOVE SKU-INFO                                               *20060099
      ******************************************************************20070099
       4110-MOVE-SKU-INFO.                                              20080099
                                                                        20090099
           IF TSK-LONG-VENDOR-STYLE  =  SPACES                          20100099
              MOVE TSK-VENDOR-STYLE-CODE   TO PV-VENDOR-STYLE           20110099
           ELSE                                                         20120099
              MOVE TSK-LONG-VENDOR-STYLE   TO PV-VENDOR-STYLE           20130099
           END-IF.                                                      20140099
                                                                        20150099
           MOVE TSK-UNIT-COST-AMT          TO PV-COST                   20160099
           MOVE TSK-CUR-UNIT-RTL-AMT       TO PV-CUR-RTL                20170099
                                                                        20180099
           MOVE TSK-VNDR-IN-HSE-NMBR       TO PV-VENDOR.                20190099
                                                                        20200099
           IF TSK-LONG-COLOR-DESC =  SPACES                             20210099
              MOVE TSK-COLOR-DESC          TO PV-COLOR                  20220099
           ELSE                                                         20230099
              MOVE TSK-LONG-COLOR-DESC     TO PV-COLOR                  20240099
           END-IF.                                                      20250099
                                                                        20260099
           MOVE TSK-SKU-DESC       TO PV-SKU-DESC.                      20270099
                                                                        20280099
           SET STAT-IND            TO 1.                                20290099
                                                                        20300099
           EVALUATE TSK-STATUS-CODE                                     20310099
               WHEN 10                                                  20320099
                   MOVE 'NEW'      TO PV-STATUS-CODE(1)                 20330099
               WHEN 20                                                  20340099
                   MOVE 'ACT'      TO PV-STATUS-CODE(1)                 20350099
               WHEN 25                                                  20360099
                   MOVE 'MIX'      TO PV-STATUS-CODE(1)                 20370099
               WHEN 30                                                  20380099
                   MOVE 'CLR'      TO PV-STATUS-CODE(1)                 20390099
               WHEN 40                                                  20400099
                   MOVE 'PRO'      TO PV-STATUS-CODE(1)                 20410099
               WHEN 90                                                  20420099
                   MOVE 'DIS'      TO PV-STATUS-CODE(1)                 20430099
           END-EVALUATE.                                                20440099
                                                                        20450099
           MOVE SPACES TO PV-STATUS-CODE(2)                             20460099
                          PV-STATUS-CODE(3)                             20470099
                          PV-STATUS-CODE(4)                             20480099
                          PV-STATUS-CODE(5).                            20490099
                                                                        20500099
           MOVE TSK-SIZE-CDE  TO SIZE-NRF-SIZE-CDE.                     20510099
           PERFORM 6140-GET-SIZE-DESC.                                  20520099
                                                                        20530099
           IF PS-SIZE-DESC-FOUND                                        20540099
              MOVE SIZE-KOHLS-DESC  TO PV-SIZE                          20550099
           ELSE                                                         20560099
              IF TSK-LONG-SIZE-DESC  =  SPACES                          20570099
                 MOVE TSK-SIZE-DESC TO PV-SIZE                          20580099
              ELSE                                                      20590099
                 MOVE TSK-LONG-SIZE-DESC                                20600099
                                    TO PV-SIZE                          20610099
              END-IF                                                    20620099
           END-IF.                                                      20630099
                                                                        20640099
      ******************************************************************20650099
      *    MOVE VENDOR INFO                                            *20660099
      ******************************************************************20670099
       4120-MOVE-VENDOR-INFO.                                           20680099
                                                                        20690099
           MOVE ASC-DEPT-NMBR    TO VNDDPT-DEPT-NBR.                    20700099
           MOVE PV-VENDOR        TO VNDDPT-INHOUSE-NBR.                 20710099
           PERFORM 6130-GET-VENDOR-NAME.                                20720099
                                                                        20730099
           IF PS-VENDOR-FOUND                                           20740099
              MOVE ENTNME-ENT-NAME-DESC TO PV-VENDOR-NAME               20750099
           ELSE                                                         20760099
              MOVE SPACES               TO PV-VENDOR-NAME               20770099
           END-IF.                                                      20780099
                                                                        20790099
      ******************************************************************20800099
      *    MOVE SKU-INFO                                               *20810099
      ******************************************************************20820099
       4200-PROCESS-STORES.                                             20830099
BJD   *--> EXCLUDE GIFT WITH PURCHASE SKUS FROM ACCUMMULATIVE STORE     20840099
BJD   *--> TOTALS IF MULTIPLE SKUS ARE REQUESTED                        20850099
BJD        IF TSK-CUR-UNIT-RTL-AMT = 0                                  20860099
BJD          AND ASC-GET-MULTI-SKUS                                     20870099
BJD            CONTINUE                                                 20880099
BJD        ELSE                                                         20890099
      *--> MK-10760-B                                                   20900099
               MOVE 'N' TO PS-PROCESS-CLR-SKU-STORE-SW                  20910099
               MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW                        20920099
               MOVE  0  TO PV-CUR-CLR-RTL                               20930099
               IF TSK-REGN-PRIC-IND = 'Y'                               20940099
                  PERFORM 4360-PROCESS-CLR-SKU-STORE                    20950099
               END-IF                                                   20960099
               PERFORM 4300-ACCUM-QTY-AMTS                              20970099
           END-IF.                                                      20980099
      *--> MK-10760-E                                                   20990099
                                                                        21000099
                                                                        21010099
           IF PV-SKUS-FETCHED = PV-TOTAL-SKUS                           21020099
      *-->    SET TYPE CODE TO "DS" TO GET REGULAR STORE DC'S           21030099
              MOVE PC-DS             TO  XMT00001-LOC-TYP-CDE           21040099
JS0825        IF ST-CUR-OH-QTY(ST-IND) EQUAL 0                          21050099
JS0825            AND ST-CUR-SALES-QTY(ST-IND) EQUAL 0                  21060099
JS0825            AND ST-LAST-WK-SALES-QTY(ST-IND) EQUAL 0              21070099
JS0825*           AND ST-4-WK-SALES-QTY(ST-IND) EQUAL 0                 21080099
MC1201            AND ST-INTRANSIT-QTY(ST-IND) EQUAL 0                  21090099
JS0825            AND ST-ON-ORDER-QTY(ST-IND) EQUAL ZERO                21100099
JS0825            CONTINUE                                              21110099
JS0825        ELSE                                                      21120099
JS0825            PERFORM 5700-MOVE-DATA-TO-TEMP-STORAGE                21130099
              END-IF                                                    21140099
           END-IF.                                                      21150099
                                                                        21160099
      *--> INCREASE STORE INDEX BY ONE FOR NEXT STORE ACCUMULATORS      21170099
           SET ST-IND UP BY 1.                                          21180099
                                                                        21190099
           IF PS-ALL-STORE-INFO                                         21200099
               PERFORM 7410-FETCH-ALL-STORES                            21210099
           ELSE                                                         21220099
               PERFORM 7310-FETCH-STORES                                21230099
           END-IF.                                                      21240099
                                                                        21250099
      ******************************************************************21260099
      *    MOVE SKU-INFO                                               *21270099
      ******************************************************************21280099
       4300-ACCUM-QTY-AMTS.                                             21290099
                                                                        21300099
           INITIALIZE   PV-RECEIPT-AMT-CALC                             21310099
                        PV-STORE-OH-AMT-CALC                            21320099
                        PV-ON-ORDER-AMT-CALC                            21330099
                        PV-CUR-ONHAND-AMT-CALC                          21340099
                        PV-INTRANSIT-AMT-CALC.                          21350099
                                                                        21360099
           MOVE XMT00001-LOC-NBR        TO PV-STORE-NMBR-9              21370099
           MOVE PV-STORE-NMBR-9         TO TSKST-LOC-NBR.               21380099
           MOVE TSK-ITEM-NMBR           TO TSKST-ITEM-NMBR.             21390099
                                                                        21400099
MC1201*--> SET INDEX VALUES FOR INTRANSIT TABLE                         21410099
MC1201     MOVE PV-STORE-NMBR-9         TO PV-STORE-NBR-COMP.           21420099
                                                                        21430099
      *--> GET STORE ON-HAND QUANTITIES / AMOUNTS                       21440099
      *--> IF NOT FOUND SKUS DO NOT EXIST AT STORE SO                   21450099
           PERFORM 4310-GET-QTY-ONHAND.                                 21460099
                                                                        21470099
      *--> ONLY ACCUM ON-HAND AND SALES IF ROW EXISTS ON TSKST          21480099
           IF PS-QTY-ONHAND-FOUND                                       21490099
              PERFORM 4320-ACCUM-ONHAND-N-SALES                         21500099
           END-IF.                                                      21510099
                                                                        21520099
      *--> SUM STORE ON ORDER QUANTITIES / AMOUNTS                      21530099
           PERFORM 4340-SUM-STORE-ON-ORDER-QTY                          21540099
                                                                        21550099
      *--> GET ON STORE-OH QUANTITIES / AMOUNTS                         21560099
           PERFORM 4350-READ-STORE-OH-FILE.                             21570099
                                                                        21580099
MC1201*--> GET STORE INTRANSIT QUANTITIES / AMOUNTS                     21590099
MC1201*    PERFORM 4355-GET-INTRANSIT-QTY.                              21600099
                                                                        21610099
      ******************************************************************21620099
      *   GET QUANTITY ON-HAND AMOUNTS                                  21630099
      ******************************************************************21640099
       4310-GET-QTY-ONHAND.                                             21650099
                                                                        21660099
                   EXEC SQL                                             21670099
                           SELECT  ONHAND_QTY                           21680099
                           INTO   :TSKST-ONHAND-QTY                     21690099
                           FROM    TSKST                                21700099
                           WHERE  ITEM_NMBR  = :TSKST-ITEM-NMBR         21710099
                             AND  LOC_NBR    = :TSKST-LOC-NBR           21720099
                   END-EXEC                                             21730099
                                                                        21740099
               EVALUATE TRUE                                            21750099
                   WHEN SQLCODE = ZERO                                  21760099
                        SET PS-QTY-ONHAND-FOUND     TO TRUE             21770099
                   WHEN SQLCODE = +100                                  21780099
                        SET PS-QTY-ONHAND-NOT-FOUND TO TRUE             21790099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        21800099
                   WHEN SQLCODE NOT EQUAL ZERO                          21810099
                        MOVE '4310-GET-ONHAND-QTY'                      21820099
                                         TO DP013-PARAGRAPH             21830099
                        MOVE 'SELECT TSKST'                             21840099
                                         TO DP013-MESSAGE-TEXT (1)      21850099
                        MOVE SQLCA       TO DP013-SQLCA                 21860099
                        SET DP013-DB2-ABEND                             21870099
                                         TO TRUE                        21880099
                        PERFORM DP013-0000-PROCESS-ABEND                21890099
               END-EVALUATE.                                            21900099
      ******************************************************************21910099
      *   ACCUMULATE ON-HANDS AND WEEKLY SALES FOR EACH STORE           21920099
      ******************************************************************21930099
       4320-ACCUM-ONHAND-N-SALES.                                       21940099
                                                                        21950099
      *--> STORE/SKU ONHAND  QTYS / AMOUNTS                             21960099
MK         IF TSK-REGN-PRIC-IND = 'Y'                                   21970099
MK            IF PS-PROCESS-CLR-SKU-STORE                               21980099
MK               ADD TSKST-ONHAND-QTY       TO ST-CUR-OH-QTY(ST-IND)    21990099
MK               IF PS-USE-CUR-CLR-RTL                                  22000099
MK                  COMPUTE PV-CUR-ONHAND-AMT-CALC  =                   22010099
MK                          PV-CUR-CLR-RTL * TSKST-ONHAND-QTY           22020099
MK               ELSE                                                   22030099
MK                  COMPUTE PV-CUR-ONHAND-AMT-CALC  =                   22040099
MK                          TSK-CUR-UNIT-RTL-AMT * TSKST-ONHAND-QTY     22050099
MK            ELSE                                                      22060099
MK               ADD ZERO                   TO ST-CUR-OH-QTY(ST-IND)    22070099
MK               MOVE ZERO                  TO PV-CUR-ONHAND-AMT-CALC   22080099
MK         ELSE                                                         22090099
              ADD TSKST-ONHAND-QTY          TO ST-CUR-OH-QTY(ST-IND)    22100099
              COMPUTE PV-CUR-ONHAND-AMT-CALC  =                         22110099
                      TSK-CUR-UNIT-RTL-AMT * TSKST-ONHAND-QTY           22120099
MK         END-IF.                                                      22130099
                                                                        22140099
           ADD PV-CUR-ONHAND-AMT-CALC    TO ST-CUR-OH-AMT(ST-IND).      22150099
                                                                        22160099
      *--> GET 5 WEEKS OF SALE QTYS / AMOUNTS                           22170099
           INITIALIZE PV-SALES-FIGURES.                                 22180099
                                                                        22190099
           MOVE TSK-ITEM-NMBR            TO SKSTWKS-ITEM-NMBR.          22200099
           MOVE XMT00001-LOC-NBR         TO SKSTWKS-STR-NBR.            22210099
           PERFORM 4330-GET-WEEKLY-SALES VARYING PV-WK                  22220099
             FROM +1 BY +1                                              22230099
             UNTIL PV-WK > PC-MAX-NUM-WEEKS.                            22240099
                                                                        22250099
      *--> CURRENT WEEK SALE QTYS / AMOUNTS                             22260099
           ADD  PV-SALES-QTY(1)         TO ST-CUR-SALES-QTY(ST-IND).    22270099
           ADD  PV-SALES-AMT(1)         TO ST-CUR-SALES-AMT(ST-IND).    22280099
                                                                        22290099
      *--> LAST WEEK SALE QTYS / AMOUNTS  / ALSO ADD TO 4 FULL WKS      22300099
           ADD  PV-SALES-QTY(2)         TO ST-LAST-WK-SALES-QTY(ST-IND).22310099
      *                                    ST-4-WK-SALES-QTY(ST-IND).   22320099
           ADD  PV-SALES-AMT(2)         TO ST-LAST-WK-SALES-AMT(ST-IND).22330099
      *                                    ST-4-WK-SALES-AMT(ST-IND).   22340099
                                                                        22350099
      ******************************************************************22360099
      *   GET WEEKLY SALES AMOUNTS FOR EACH STORE                       22370099
      ******************************************************************22380099
       4330-GET-WEEKLY-SALES.                                           22390099
                                                                        22400099
           MOVE PV-WKLY-DATE-KEY(PV-WK) TO PV-BOW-DATE                  22410099
                                                                        22420099
           PERFORM                                                      22430099
               WITH TEST AFTER                                          22440099
               VARYING PV-RETRY-COUNT                                   22450099
               FROM 1 BY 1                                              22460099
               UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                    22470099
                  OR SQLCODE = +0                                       22480099
                  OR SQLCODE = +100                                     22490099
                  OR SQLCODE = -305                                     22500099
                                                                        22510099
                   INITIALIZE SKSTWKS-SALES-UNIT-QTY                    22520099
                              SKSTWKS-SALES-AMT                         22530099
                                                                        22540099
                   EXEC SQL                                             22550099
                           SELECT  SUM(SALES_UNIT_QTY)                  22560099
                                  ,SUM(SALES_AMT)                       22570099
                           INTO   :SKSTWKS-SALES-UNIT-QTY               22580099
                                 ,:SKSTWKS-SALES-AMT                    22590099
                           FROM   TSKSTWKS                              22600099
                           WHERE  ITEM_NMBR    = :SKSTWKS-ITEM-NMBR     22610099
                             AND  STR_NBR      = :SKSTWKS-STR-NBR       22620099
                             AND  FSCL_BOW_DTE = :PV-BOW-DATE           22630099
                   END-EXEC                                             22640099
                                                                        22650099
               EVALUATE TRUE                                            22660099
                   WHEN SQLCODE = ZERO                                  22670099
                   WHEN SQLCODE = +100                                  22680099
      *-->         A "-305" OCCURS WHEN DOING A DB2 BUILT-IN FUNCTION   22690099
      *-->         (I.E. "SUM") AND A NOT-FOUND OCCURS.                 22700099
                   WHEN SQLCODE = -305                                  22710099
                        CONTINUE                                        22720099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        22730099
                   WHEN SQLCODE NOT EQUAL ZERO                          22740099
                        MOVE '4330-GET-WEEKLY-SALES'                    22750099
                                         TO DP013-PARAGRAPH             22760099
                        MOVE 'SELECT TSKSTWKS'                          22770099
                                         TO DP013-MESSAGE-TEXT (1)      22780099
                        MOVE SQLCA       TO DP013-SQLCA                 22790099
                        SET DP013-DB2-ABEND                             22800099
                                         TO TRUE                        22810099
                        PERFORM DP013-0000-PROCESS-ABEND                22820099
               END-EVALUATE                                             22830099
           END-PERFORM.                                                 22840099
                                                                        22850099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          22860099
               MOVE '4330-GET-WEEKLY-SALES'                             22870099
                                         TO DP013-PARAGRAPH             22880099
               MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             22890099
                                         TO DP013-MESSAGE-TEXT (1)      22900099
               MOVE SQLCA                TO DP013-SQLCA                 22910099
               SET DP013-DB2-ABEND       TO TRUE                        22920099
               PERFORM DP013-0000-PROCESS-ABEND                         22930099
           END-IF.                                                      22940099
                                                                        22950099
           IF SQLCODE = +0                                              22960099
      *--> THESE VALUES ROUNDED FOR INDIVIDUAL STORE QTYS/AMOUNTS       22970099
      *--> WHEN CURRENT RETAIL AMT IS ZERO, DO NOT INCLUDE THE          22980099
      *-->     NUMBERS IN THE GRAND TOTAL                               22990099
              COMPUTE PV-SALES-QTY(PV-WK) =                             23000099
                      SKSTWKS-SALES-UNIT-QTY * 1                        23010099
              COMPUTE PV-SALES-AMT(PV-WK) ROUNDED =                     23020099
                      SKSTWKS-SALES-AMT        * 1                      23030099
JS0897        IF TSK-CUR-UNIT-RTL-AMT = 0                               23040099
JS0897            CONTINUE                                              23050099
JS0897        ELSE                                                      23060099
      *--> TOTAL VALUES NOT ROUNDED UNTIL MOVED TO COMMAREA             23070099
              EVALUATE PV-WK                                            23080099
                WHEN 1                                                  23090099
                   ADD SKSTWKS-SALES-AMT      TO PV-TOT-CUR-SALES-AMT   23100099
                   ADD SKSTWKS-SALES-UNIT-QTY TO PV-TOT-CUR-SALES-QTY   23110099
                WHEN 2                                                  23120099
                   ADD SKSTWKS-SALES-AMT TO PV-TOT-LAST-WK-SALES-AMT    23130099
      *                                     PV-TOT-4-WKS-SALES-AMT      23140099
                   ADD SKSTWKS-SALES-UNIT-QTY                           23150099
                                           TO PV-TOT-LAST-WK-SALES-QTY  23160099
      *                                       PV-TOT-4-WKS-SALES-QTY    23170099
JS0897          END-EVALUATE                                            23180099
JS0897       END-IF                                                     23190099
           ELSE                                                         23200099
               MOVE +0             TO PV-SALES-QTY(PV-WK)               23210099
               MOVE +0             TO PV-SALES-AMT(PV-WK)               23220099
           END-IF.                                                      23230099
                                                                        23240099
      ******************************************************************23250099
      *    SUM STORE ON ORDER QTY / AMT AND ACCUMULATE                 *23260099
      ******************************************************************23270099
       4340-SUM-STORE-ON-ORDER-QTY.                                     23280099
                                                                        23290099
           PERFORM                                                      23300099
               WITH TEST AFTER                                          23310099
               VARYING PV-RETRY-COUNT                                   23320099
               FROM 1 BY 1                                              23330099
               UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                    23340099
                  OR SQLCODE = +0                                       23350099
                  OR SQLCODE = +100                                     23360099
                  OR SQLCODE = -305                                     23370099
                                                                        23380099
                   INITIALIZE DCLTSKSTOO                                23390099
                                                                        23400099
                   EXEC SQL                                             23410099
                      SELECT SUM(ONORD_UNT_QTY)                         23420099
                        INTO :SKSTOO-ONORD-UNT-QTY                      23430099
                        FROM TSKSTOO                                    23440099
                       WHERE ITM_NBR = :TSK-ITEM-NMBR                   23450099
                         AND STR_NBR = :XMT00001-LOC-NBR                23460099
                   END-EXEC                                             23470099
                                                                        23480099
               EVALUATE TRUE                                            23490099
                   WHEN SQLCODE = ZERO                                  23500099
                      ADD SKSTOO-ONORD-UNT-QTY                          23510099
                                    TO ST-ON-ORDER-QTY(ST-IND)          23520099
                      IF PS-USE-CUR-CLR-RTL                             23530099
                         COMPUTE PV-ON-ORDER-AMT-CALC                   23540099
                           = (SKSTOO-ONORD-UNT-QTY                      23550099
                                * PV-CUR-CLR-RTL)                       23560099
                      ELSE                                              23570099
                         COMPUTE PV-ON-ORDER-AMT-CALC                   23580099
                           = (SKSTOO-ONORD-UNT-QTY                      23590099
                                * TSK-CUR-UNIT-RTL-AMT)                 23600099
                      END-IF                                            23610099
                      ADD PV-ON-ORDER-AMT-CALC TO                       23620099
                           ST-ON-ORDER-AMT(ST-IND)                      23630099
                   WHEN SQLCODE = +100                                  23640099
                      ADD ZERO TO ST-ON-ORDER-QTY(ST-IND)               23650099
                      ADD ZERO TO ST-ON-ORDER-AMT(ST-IND)               23660099
                   WHEN SQLCODE = -305                                  23670099
                      ADD ZERO TO ST-ON-ORDER-QTY(ST-IND)               23680099
                      ADD ZERO TO ST-ON-ORDER-AMT(ST-IND)               23690099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        23700099
                   WHEN SQLCODE NOT EQUAL ZERO                          23710099
                        MOVE '4340-SUM-STORE-ON-ORDER-QTY'              23720099
                                         TO DP013-PARAGRAPH             23730099
                        MOVE 'SELECT TSKSTOO '                          23740099
                                         TO DP013-MESSAGE-TEXT (1)      23750099
                        MOVE SQLCA       TO DP013-SQLCA                 23760099
                        SET DP013-DB2-ABEND                             23770099
                                         TO TRUE                        23780099
                        PERFORM DP013-0000-PROCESS-ABEND                23790099
               END-EVALUATE                                             23800099
           END-PERFORM.                                                 23810099
                                                                        23820099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          23830099
               MOVE '4340-SUM-ON-ORDER'                                 23840099
                                         TO DP013-PARAGRAPH             23850099
               MOVE 'MAX RETRIES EXCEEDED FOR SUM'                      23860099
                                         TO DP013-MESSAGE-TEXT (1)      23870099
               MOVE SQLCA                TO DP013-SQLCA                 23880099
               SET DP013-DB2-ABEND       TO TRUE                        23890099
               PERFORM DP013-0000-PROCESS-ABEND                         23900099
           END-IF.                                                      23910099
                                                                        23920099
      ******************************************************************23930099
      *    READ STORE-OH VSAM FILE TO RETRIEVE UNITS STORE-OH TO STORE *23940099
      ******************************************************************23950099
       4350-READ-STORE-OH-FILE.                                         23960099
                                                                        23970099
           INITIALIZE XL074-ITEM-COMMAREA.                              23980099
                                                                        23990099
           SET XL074-BY-SKU               TO TRUE.                      24000099
           MOVE ASC-SKU-NMBR              TO XL074-KEY-SKU.             24010099
                                                                        24020099
           SET XL074-BY-STORE          TO TRUE                          24030099
           MOVE PV-STORE-NMBR-9        TO PV-STORE-NBR-COMP             24040099
           MOVE PV-STORE-NBR-COMP      TO XL074-KEY-LOC-NBR             24050099
                                                                        24060099
           CALL XL074-ONLINE-PGM                                        24070099
               USING DFHEIBLK                                           24080099
                     XL074-COMMAREA                                     24090099
                     XL074-ITEM-COMMAREA.                               24100099
                                                                        24110099
           EVALUATE XL074-RETURN-CODE                                   24120099
              WHEN '00'                                                 24130099
      *----------> SUCCESSFUL                                           24140099
                                                                        24150099
                IF XL074-SE-QTY            IS NEGATIVE                  24160099
                   CONTINUE                                             24170099
                ELSE                                                    24180099
                   ADD XL074-SE-QTY            TO                       24190099
                                               ST-RECEIPT-QTY (ST-IND)  24200099
                   IF PS-USE-CUR-CLR-RTL                                24210099
                      COMPUTE PV-RECEIPT-AMT-CALC =                     24220099
                        (XL074-SE-QTY             * PV-CUR-CLR-RTL)     24230099
                   ELSE                                                 24240099
                      COMPUTE PV-RECEIPT-AMT-CALC =                     24250099
                      (XL074-SE-QTY             * TSK-CUR-UNIT-RTL-AMT) 24260099
                   END-IF                                               24270099
                   ADD PV-RECEIPT-AMT-CALC   TO ST-RECEIPT-AMT(ST-IND)  24280099
                END-IF                                                  24290099
                                                                        24300099
                ADD XL074-IT-QTY   TO ST-INTRANSIT-QTY(ST-IND)          24310099
                                                                        24320099
                IF PS-USE-CUR-CLR-RTL                                   24330099
                    COMPUTE PV-INTRANSIT-AMT-CALC                       24340099
                            = (XL074-IT-QTY * PV-CUR-CLR-RTL)           24350099
                ELSE                                                    24360099
                    COMPUTE PV-INTRANSIT-AMT-CALC                       24370099
                            = (XL074-IT-QTY  * TSK-CUR-UNIT-RTL-AMT)    24380099
                END-IF                                                  24390099
                ADD PV-INTRANSIT-AMT-CALC TO  ST-INTRANSIT-AMT(ST-IND)  24400099
                                                                        24410099
                                                                        24420099
              WHEN OTHER                                                24430099
      *----------> SOME TYPE OF ERROR                                   24440099
      *----------> ONLY ACCEPT +100 ERROR (NOT FOUND)                   24450099
                 IF XL074-SQLCODE = +100                                24460099
                     CONTINUE                                           24470099
                 ELSE                                                   24480099
                    MOVE 'GET A RECORD FROM THE STORE-OH API'           24490099
                        TO DP013-MESSAGE-TEXT(1)                        24500099
                    MOVE '4350-READ-STORE-OH-FILE'                      24510099
                        TO DP013-PARAGRAPH                              24520099
                    PERFORM DP013-0000-PROCESS-ABEND                    24530099
                 END-IF                                                 24540099
           END-EVALUATE.                                                24550099
                                                                        24560099
                                                                        24570099
      ******************************************************************24580099
      *  SELECT INFORMATION FROM THE INTRANSIT QUANTITY SUMMARY TABLE. *24590099
      ******************************************************************24600099
      *4355-GET-INTRANSIT-QTY.                                          24610099
      *                                                                 24620099
      *    PERFORM                                                      24630099
      *        WITH TEST AFTER                                          24640099
      *        VARYING PV-RETRY-COUNT                                   24650099
      *        FROM 1 BY 1                                              24660099
      *        UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                    24670099
      *           OR SQLCODE = +0                                       24680099
      *           OR SQLCODE = +100                                     24690099
      *                                                                 24700099
      *            INITIALIZE DCLPCT00000                               24710099
      *                                                                 24720099
      *            EXEC SQL                                             24730099
      *               SELECT IN_TRNST_QTY                               24740099
      *                 INTO :PCT00000-IN-TRNST-QTY                     24750099
      *                 FROM PCT_IN_TRNST_QTY                           24760099
      *                WHERE INTR_UPC_ID = :UPC-INTR-UPC-ID             24770099
      *                  AND STR_NBR   = :PV-STORE-NBR-COMP             24780099
      *            END-EXEC                                             24790099
      *                                                                 24800099
      *            EVALUATE TRUE                                        24810099
      *               WHEN SQLCODE = ZERO                               24820099
      *                    ADD PCT00000-IN-TRNST-QTY                    24830099
      *                             TO ST-INTRANSIT-QTY(ST-IND)         24840099
      *                    IF PS-USE-CUR-CLR-RTL                        24850099
      *                       COMPUTE PV-INTRANSIT-AMT-CALC             24860099
      *                         = (PCT00000-IN-TRNST-QTY                24870099
      *                              * PV-CUR-CLR-RTL)                  24880099
      *                    ELSE                                         24890099
      *                       COMPUTE PV-INTRANSIT-AMT-CALC             24900099
      *                         = (PCT00000-IN-TRNST-QTY                24910099
      *                              * TSK-CUR-UNIT-RTL-AMT)            24920099
      *                    END-IF                                       24930099
      *                    ADD PV-INTRANSIT-AMT-CALC TO                 24940099
      *                         ST-INTRANSIT-AMT(ST-IND)                24950099
      *               WHEN SQLCODE = +100                               24960099
      *                    ADD ZERO TO ST-INTRANSIT-QTY(ST-IND)         24970099
      *                    ADD ZERO TO ST-INTRANSIT-AMT(ST-IND)         24980099
      *               WHEN SQLWARN0 NOT EQUAL SPACE                     24990099
      *               WHEN SQLCODE NOT EQUAL ZERO                       25000099
      *                    MOVE '4355-GET-INTRANSIT-QTY     '           25010099
      *                                  TO DP013-PARAGRAPH             25020099
      *                    MOVE 'SELECT PCT_IN_TRNST_QTY'               25030099
      *                                  TO DP013-MESSAGE-TEXT (1)      25040099
      *                    MOVE SQLCA    TO DP013-SQLCA                 25050099
      *                    SET DP013-DB2-ABEND                          25060099
      *                                  TO TRUE                        25070099
      *                    PERFORM DP013-0000-PROCESS-ABEND             25080099
      *            END-EVALUATE                                         25090099
      *    END-PERFORM.                                                 25100099
      *                                                                 25110099
      ******************************************************************25120099
      *    PROCESS REGIONAL CLEARANCE PRICE STORES.                    *25130099
      *    THIS PARAGRAPH WILL DETERMINE IF A SPECIFIC STORE IS        *25140099
      *    REGIONLLY CLEARANCE PRICED. IF THE STORE IS REGIONALLY      *25150099
      *    CLEARANCE PRICED, THEN THE FOLLOWING CALCULATIONS WILL NEED *25160099
      *    TO USE THE CURRENT RETAIL FROM TUPCPLS - NOT TSK.           *25170099
      ******************************************************************25180099
       4360-PROCESS-CLR-SKU-STORE.                                      25190099
                                                                        25200099
           PERFORM                                                      25210099
               WITH TEST AFTER                                          25220099
               VARYING PV-RETRY-COUNT                                   25230099
               FROM 1 BY 1                                              25240099
               UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                    25250099
                  OR SQLCODE = +0                                       25260099
                  OR SQLCODE = +100                                     25270099
                                                                        25280099
                   INITIALIZE UPCPLS-UNT-RTL-AMT                        25290099
                                                                        25300099
                   EXEC SQL                                             25310099
                           SELECT  UNT_RTL_AMT                          25320099
                           INTO   :UPCPLS-UNT-RTL-AMT                   25330099
                           FROM   TUPCPLS                               25340099
                           WHERE  OPERCO_NBR   = '03'                   25350099
                             AND  ITM_NBR      = :TSK-ITEM-NMBR         25360099
                             AND  STR_NBR      = :XMT00001-LOC-NBR      25370099
                             AND ((EFF_BEG_TMST <= CURRENT TIMESTAMP    25380099
                             AND EFF_END_TMST >= CURRENT TIMESTAMP)     25390099
                              OR (EFF_BEG_TMST <= CURRENT TIMESTAMP     25400099
                             AND EFF_END_TMST IS NULL))                 25410099
                   END-EXEC                                             25420099
                                                                        25430099
               EVALUATE TRUE                                            25440099
                   WHEN SQLCODE = ZERO                                  25450099
                   WHEN SQLCODE = +100                                  25460099
                        CONTINUE                                        25470099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        25480099
                   WHEN SQLCODE NOT EQUAL ZERO                          25490099
                        MOVE '4360-PROCESS-CLR-SKU-STORE'               25500099
                                         TO DP013-PARAGRAPH             25510099
                        MOVE 'SELECT TUPCPLS '                          25520099
                                         TO DP013-MESSAGE-TEXT (1)      25530099
                        MOVE SQLCA       TO DP013-SQLCA                 25540099
                        SET DP013-DB2-ABEND                             25550099
                                         TO TRUE                        25560099
                        PERFORM DP013-0000-PROCESS-ABEND                25570099
               END-EVALUATE                                             25580099
           END-PERFORM.                                                 25590099
                                                                        25600099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          25610099
               MOVE '4360-PROCESS-CLR-SKU-STORE'                        25620099
                                         TO DP013-PARAGRAPH             25630099
               MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             25640099
                                         TO DP013-MESSAGE-TEXT (1)      25650099
               MOVE SQLCA                TO DP013-SQLCA                 25660099
               SET DP013-DB2-ABEND       TO TRUE                        25670099
               PERFORM DP013-0000-PROCESS-ABEND                         25680099
           END-IF.                                                      25690099
                                                                        25700099
           IF ASC-GET-MULTI-SKUS                                        25710099
              PERFORM 4370-EVALUATE-MULTI-SKU-STORE                     25720099
           ELSE                                                         25730099
              PERFORM 4380-EVALUATE-SKU-STORE                           25740099
           END-IF.                                                      25750099
                                                                        25760099
      ******************************************************************25770099
      *    THIS PARAGRAPH WILL EVALUATE WHAT WAS ENTERED ON THE        *25780099
      *    CRITERIA SCREEN (FSKCS034).  IT WILL DETERMINE IF THE       *25790099
      *    SKU/STORE SHOULD BE PROCESSED.  THIS PROCESS IS USED WHEN   *25800099
      *    MULTIPLE SKUS ARE BEING REQUESTED.                          *25810099
      ******************************************************************25820099
       4370-EVALUATE-MULTI-SKU-STORE.                                   25830099
                                                                        25840099
           IF SQLCODE = 0                                               25850099
              IF (TSK-STATUS-CODE = 25)                                 25860099
                 IF (CA-STAT-20-ENTERED AND CA-STAT-30-ENTERED)         25870099
                 OR (CA-STAT-25-ENTERED)                                25880099
                 OR (CA-STAT-30-ENTERED)                                25890099
                    MOVE 'Y' TO PS-PROCESS-CLR-SKU-STORE-SW             25900099
                    MOVE 'Y' TO PS-USE-CUR-CLR-RTL-SW                   25910099
                    MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-CLR-RTL           25920099
                 ELSE                                                   25930099
                    MOVE 'N' TO PS-PROCESS-CLR-SKU-STORE-SW             25940099
                    MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW                   25950099
                    MOVE ZERO TO PV-CUR-CLR-RTL                         25960099
                 END-IF                                                 25970099
              ELSE                                                      25980099
                 IF (CA-STAT-30-ENTERED)                                25990099
                    MOVE 'Y' TO PS-USE-CUR-CLR-RTL-SW                   26000099
                    MOVE 'Y' TO PS-PROCESS-CLR-SKU-STORE-SW             26010099
                    MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-CLR-RTL           26020099
                 ELSE                                                   26030099
                    MOVE 'N' TO PS-PROCESS-CLR-SKU-STORE-SW             26040099
                    MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW                   26050099
                    MOVE ZERO TO PV-CUR-CLR-RTL                         26060099
                 END-IF                                                 26070099
              END-IF                                                    26080099
           ELSE                                                         26090099
              IF (CA-STAT-20-ENTERED) OR (CA-STAT-25-ENTERED)           26100099
MK               OR (CA-STAT-30-ENTERED)                                26110099
                 MOVE 'Y' TO PS-PROCESS-CLR-SKU-STORE-SW                26120099
                 MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW                      26130099
                 MOVE ZERO TO PV-CUR-CLR-RTL                            26140099
              ELSE                                                      26150099
                 MOVE 'N' TO PS-PROCESS-CLR-SKU-STORE-SW                26160099
                 MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW                      26170099
                 MOVE ZERO TO PV-CUR-CLR-RTL                            26180099
              END-IF                                                    26190099
           END-IF.                                                      26200099
                                                                        26210099
      ******************************************************************26220099
      *    THIS PARAGRAPH WILL EVALUATE WHAT WAS ENTERED ON THE        *26230099
      *    CRITERIA SCREEN (FSKCS034).  IT WILL DETERMINE IF THE       *26240099
      *    SKU/STORE SHOULD BE PROCESSED.  THIS IS USED WHEN A SPECIFIC*26250099
      *    SKU WAS REQUESTED.                                          *26260099
      ******************************************************************26270099
       4380-EVALUATE-SKU-STORE.                                         26280099
                                                                        26290099
           IF SQLCODE = 0                                               26300099
              MOVE 'Y' TO PS-PROCESS-CLR-SKU-STORE-SW                   26310099
              MOVE 'Y' TO PS-USE-CUR-CLR-RTL-SW                         26320099
              MOVE UPCPLS-UNT-RTL-AMT TO PV-CUR-CLR-RTL                 26330099
           ELSE                                                         26340099
              MOVE 'Y' TO PS-PROCESS-CLR-SKU-STORE-SW                   26350099
              MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW                         26360099
              MOVE ZERO TO PV-CUR-CLR-RTL                               26370099
           END-IF.                                                      26380099
                                                                        26390099
      ******************************************************************26400099
      *    MOVE LAST STORES INFO / TYPES NA/CS/DC                      *26410099
      ******************************************************************26420099
       5000-MOVE-LAST-STORES.                                           26430099
                                                                        26440099
      *--> GET NON-ALLOCATED STORES QTY/AMTS - 899                      26450099
           PERFORM 5010-MOVE-NA-LAST-STORES.                            26460099
                                                                        26470099
      *--> GET CENTRAL STOCK STORES QTY/AMTS - 802/812                  26480099
           PERFORM 5020-MOVE-CS-LAST-STORES.                            26490099
                                                                        26500099
      *--> GET DISTRIBUTION CENTERS QTY/AMTS - 085/810/830              26510099
           PERFORM 5030-MOVE-DC-LAST-STORES.                            26520099
                                                                        26530099
      ******************************************************************26540099
      *    FORMAT THE NON-ALLOCATED STORES LAST ON SCREEN              *26550099
      ******************************************************************26560099
       5010-MOVE-NA-LAST-STORES.                                        26570099
                                                                        26580099
           MOVE PC-NA                    TO  XMT00001-LOC-TYP-CDE.      26590099
           PERFORM 5100-OPEN-LAST-STORES-CSR.                           26600099
                                                                        26610099
           SET PS-NOT-END-OF-LAST-STORES TO TRUE.                       26620099
                                                                        26630099
           PERFORM 5120-FETCH-LAST-STORES-CSR.                          26640099
                                                                        26650099
           PERFORM 5110-PROCESS-LAST-STORES                             26660099
               UNTIL PS-END-OF-LAST-STORES.                             26670099
                                                                        26680099
           PERFORM 5130-CLOSE-LAST-STORES-CSR.                          26690099
                                                                        26700099
      ******************************************************************26710099
      *    FORMAT THE CENTRAL STOCK STORES LAST ON SCREEN               26720099
      ******************************************************************26730099
       5020-MOVE-CS-LAST-STORES.                                        26740099
                                                                        26750099
           MOVE PC-CS                    TO  XMT00001-LOC-TYP-CDE.      26760099
           PERFORM 5100-OPEN-LAST-STORES-CSR.                           26770099
                                                                        26780099
           SET PS-NOT-END-OF-LAST-STORES TO TRUE.                       26790099
                                                                        26800099
           PERFORM 5120-FETCH-LAST-STORES-CSR.                          26810099
                                                                        26820099
           PERFORM 5110-PROCESS-LAST-STORES                             26830099
               UNTIL PS-END-OF-LAST-STORES.                             26840099
                                                                        26850099
           PERFORM 5130-CLOSE-LAST-STORES-CSR.                          26860099
                                                                        26870099
      ******************************************************************26880099
      *    FORMAT THE DISTRIBUTION CENTERS LAST ON SCREEN               26890099
      ******************************************************************26900099
       5030-MOVE-DC-LAST-STORES.                                        26910099
                                                                        26920099
           MOVE PC-DC                    TO  XMT00001-LOC-TYP-CDE.      26930099
           PERFORM 5100-OPEN-LAST-STORES-CSR.                           26940099
                                                                        26950099
           SET PS-NOT-END-OF-LAST-STORES TO TRUE.                       26960099
                                                                        26970099
           PERFORM 5120-FETCH-LAST-STORES-CSR.                          26980099
                                                                        26990099
           PERFORM 5110-PROCESS-LAST-STORES                             27000099
               UNTIL PS-END-OF-LAST-STORES.                             27010099
                                                                        27020099
           PERFORM 5130-CLOSE-LAST-STORES-CSR.                          27030099
                                                                        27040099
      ******************************************************************27050099
      *  OPEN LAST STORES CURSOR                                        27060099
      ******************************************************************27070099
       5100-OPEN-LAST-STORES-CSR.                                       27080099
                                                                        27090099
           EXEC SQL                                                     27100099
                OPEN LAST-STORES-CSR                                    27110099
           END-EXEC.                                                    27120099
                                                                        27130099
           EVALUATE TRUE                                                27140099
               WHEN SQLCODE = ZERO                                      27150099
                    CONTINUE                                            27160099
               WHEN SQLWARN0 NOT EQUAL SPACE                            27170099
               WHEN SQLCODE NOT EQUAL ZERO                              27180099
                    MOVE '5100-OPEN-LAST-STORES-CURSOR'                 27190099
                                 TO  DP013-PARAGRAPH                    27200099
                    MOVE 'OPEN LAST STORES CURSOR'                      27210099
                                 TO  DP013-MESSAGE-TEXT (1)             27220099
                    MOVE SQLCA   TO  DP013-SQLCA                        27230099
                    SET DP013-DB2-ABEND                                 27240099
                                 TO  TRUE                               27250099
                    PERFORM DP013-0000-PROCESS-ABEND                    27260099
           END-EVALUATE.                                                27270099
                                                                        27280099
      ******************************************************************27290099
      *  FETCH LAST STORES CURSOR                                       27300099
      ******************************************************************27310099
       5110-PROCESS-LAST-STORES.                                        27320099
                                                                        27330099
      *--> MK-10760-B                                                   27340099
           MOVE 'N' TO PS-PROCESS-CLR-SKU-STORE-SW.                     27350099
           MOVE 'N' TO PS-USE-CUR-CLR-RTL-SW.                           27360099
           MOVE  0  TO PV-CUR-CLR-RTL.                                  27370099
           IF TSK-REGN-PRIC-IND = 'Y'                                   27380099
              PERFORM 4360-PROCESS-CLR-SKU-STORE                        27390099
           END-IF.                                                      27400099
           PERFORM 4300-ACCUM-QTY-AMTS.                                 27410099
      *--> MK-10760-E                                                   27420099
                                                                        27430099
           IF PV-SKUS-FETCHED = PV-TOTAL-SKUS                           27440099
JS0825         IF ST-CUR-OH-QTY(ST-IND) EQUAL 0                         27450099
JS0825            AND ST-CUR-SALES-QTY(ST-IND) EQUAL 0                  27460099
JS0825            AND ST-LAST-WK-SALES-QTY(ST-IND) EQUAL 0              27470099
JS0825            AND ST-INTRANSIT-QTY(ST-IND) EQUAL 0                  27480099
JS0825*           AND ST-4-WK-SALES-QTY(ST-IND) EQUAL 0                 27490099
JS0825            AND ST-ON-ORDER-QTY(ST-IND) EQUAL ZERO                27500099
                  CONTINUE                                              27510099
JS0825         ELSE                                                     27520099
                  PERFORM 5700-MOVE-DATA-TO-TEMP-STORAGE                27530099
               END-IF                                                   27540099
           ELSE                                                         27550099
               CONTINUE                                                 27560099
           END-IF.                                                      27570099
                                                                        27580099
      *--> INCREASE STORE INDEX BY ONE FOR NEXT STORE ACCUMULATORS      27590099
           SET ST-IND UP BY 1.                                          27600099
                                                                        27610099
           PERFORM 5120-FETCH-LAST-STORES-CSR.                          27620099
                                                                        27630099
      ******************************************************************27640099
      *  FETCH LAST STORES CURSOR                                       27650099
      ******************************************************************27660099
       5120-FETCH-LAST-STORES-CSR.                                      27670099
                                                                        27680099
           EXEC SQL                                                     27690099
                FETCH LAST-STORES-CSR                                   27700099
                INTO  :PV-CURRENT-DATE                                  27710099
                     ,:XMT00002-DC-NBR                                  27720099
                     ,:XMT00001-LOC-10-ABBR-NM                          27730099
                     ,:XMT00001-LOC-NBR                                 27740099
           END-EXEC                                                     27750099
                                                                        27760099
           EVALUATE TRUE                                                27770099
               WHEN SQLCODE = ZERO                                      27780099
                    CONTINUE                                            27790099
               WHEN SQLCODE = +100                                      27800099
                    SET PS-END-OF-LAST-STORES TO TRUE                   27810099
               WHEN SQLWARN0 NOT EQUAL SPACE                            27820099
               WHEN SQLCODE  NOT EQUAL ZERO                             27830099
                    MOVE '5120-FETCH-LAST-STORES-CURSOR'                27840099
                                 TO  DP013-PARAGRAPH                    27850099
                    MOVE 'FETCH LAST STORES CURSOR'                     27860099
                                 TO  DP013-MESSAGE-TEXT (1)             27870099
                    MOVE SQLCA   TO  DP013-SQLCA                        27880099
                    SET DP013-DB2-ABEND                                 27890099
                                 TO  TRUE                               27900099
                    PERFORM DP013-0000-PROCESS-ABEND                    27910099
           END-EVALUATE.                                                27920099
                                                                        27930099
      ******************************************************************27940099
      *  OPEN LAST STORES CURSOR                                        27950099
      ******************************************************************27960099
       5130-CLOSE-LAST-STORES-CSR.                                      27970099
                                                                        27980099
           EXEC SQL                                                     27990099
               CLOSE LAST-STORES-CSR                                    28000099
           END-EXEC.                                                    28010099
                                                                        28020099
           EVALUATE TRUE                                                28030099
               WHEN SQLCODE = ZERO                                      28040099
                    CONTINUE                                            28050099
               WHEN SQLWARN0 NOT EQUAL SPACE                            28060099
               WHEN SQLCODE  NOT EQUAL ZERO                             28070099
                    MOVE '5130-CLOSE-LAST-STORES-CURSOR'                28080099
                                 TO  DP013-PARAGRAPH                    28090099
                    MOVE 'CLOSE LAST STORES CURSOR'                     28100099
                                 TO  DP013-MESSAGE-TEXT (1)             28110099
                    MOVE SQLCA   TO  DP013-SQLCA                        28120099
                    SET DP013-DB2-ABEND                                 28130099
                                 TO  TRUE                               28140099
                    PERFORM DP013-0000-PROCESS-ABEND                    28150099
           END-EVALUATE.                                                28160099
                                                                        28170099
      ******************************************************************28180099
      *    MOVE DATA TO PROGRAM VARIABLE AREAS                         *28190099
      ******************************************************************28200099
       5700-MOVE-DATA-TO-TEMP-STORAGE.                                  28210099
                                                                        28220099
           IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        28230099
               ADD +1                TO ASC-ITEM-SUB                    28240099
           ELSE                                                         28250099
               ADD +1                TO ASC-BLK-SUB                     28260099
               MOVE +1               TO ASC-ITEM-SUB                    28270099
               IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 28280099
                   MOVE +1           TO ASC-BLK-SUB                     28290099
                   SET ASC-BLOCK-MODIFIED (1)                           28300099
                                     TO TRUE                            28310099
                   PERFORM 6100-WRITE-TEMP-STORAGE                      28320099
                   MOVE ASC-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY)       28330099
                                     TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)  28340099
                   ADD +1            TO ASC-BLK-SUB                     28350099
                   INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           28360099
                   SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)              28370099
                                     TO TRUE                            28380099
               END-IF                                                   28390099
           END-IF.                                                      28400099
                                                                        28410099
           ADD +1                    TO ASC-NUMBER-OF-ITEMS-READ.       28420099
                                                                        28430099
           MOVE ASC-NUMBER-OF-ITEMS-READ   TO ASC-LIST-ITEM-NUMBER      28440099
                                           (ASC-BLK-SUB ASC-ITEM-SUB).  28450099
           MOVE XMT00001-LOC-NBR           TO PV-STORE-NMBR-9           28460099
           MOVE PV-STORE-NMBR-9            TO PV-STORE-NMBR             28470099
           MOVE PV-STORE-NMBR              TO ASC-STORE-NMBR            28480099
                                           (ASC-BLK-SUB ASC-ITEM-SUB).  28490099
           MOVE XMT00001-LOC-10-ABBR-NM    TO ASC-STORE-SHORT-NAME      28500099
                                           (ASC-BLK-SUB ASC-ITEM-SUB).  28510099
                                                                        28520099
           PERFORM 5710-MOVE-STORE-DC.                                  28530099
                                                                        28540099
      *--> MOVE ON-HAND QTYS/AMTS TO COMMAREA                           28550099
           MOVE ST-CUR-OH-QTY(ST-IND)       TO ASC-CUR-ONHAND-QTY       28560099
                                        (ASC-BLK-SUB ASC-ITEM-SUB).     28570099
           COMPUTE ASC-CUR-ONHAND-AMT (ASC-BLK-SUB ASC-ITEM-SUB)        28580099
                   ROUNDED = ST-CUR-OH-AMT(ST-IND) * 1.                 28590099
                                                                        28600099
JS0897     IF TSK-CUR-UNIT-RTL-AMT = 0                                  28610099
BJD          AND ASC-DO-NOT-GET-MULTI-SKUS                              28620099
JS0897        CONTINUE                                                  28630099
JS0897     ELSE                                                         28640099
JS0897       ADD  ST-CUR-OH-QTY(ST-IND)   TO PV-TOT-CUR-ONHAND-QTY      28650099
             ADD  ST-CUR-OH-AMT(ST-IND)   TO PV-TOT-CUR-ONHAND-AMT.     28660099
                                                                        28670099
      *--> MOVE CUR-WK SALES QTYS/AMTS TO COMMAREA                      28680099
           MOVE ST-CUR-SALES-QTY(ST-IND)    TO ASC-CUR-SALES-QTY        28690099
                                        (ASC-BLK-SUB ASC-ITEM-SUB).     28700099
           COMPUTE ASC-CUR-SALES-AMT  (ASC-BLK-SUB ASC-ITEM-SUB)        28710099
                   ROUNDED = ST-CUR-SALES-AMT(ST-IND) * 1.              28720099
                                                                        28730099
      *--> MOVE LAST-WK SALES QTYS/AMTS TO COMMAREA                     28740099
           MOVE ST-LAST-WK-SALES-QTY(ST-IND) TO ASC-LAST-WK-SALES-QTY   28750099
                                        (ASC-BLK-SUB ASC-ITEM-SUB).     28760099
           COMPUTE ASC-LAST-WK-SALES-AMT  (ASC-BLK-SUB ASC-ITEM-SUB)    28770099
                   ROUNDED = ST-LAST-WK-SALES-AMT(ST-IND) * 1.          28780099
                                                                        28790099
MC1201*--> MOVE INTRANSIT QTYS/AMTS TO COMMAREA                         28800099
MC1201     MOVE ST-INTRANSIT-QTY(ST-IND)    TO ASC-INTRANSIT-QTY        28810099
                                      (ASC-BLK-SUB ASC-ITEM-SUB).       28820099
MC1201     COMPUTE ASC-INTRANSIT-AMT  (ASC-BLK-SUB ASC-ITEM-SUB)        28830099
MC1201             ROUNDED = ST-INTRANSIT-AMT(ST-IND) * 1.              28840099
MC1201     ADD ST-INTRANSIT-QTY(ST-IND)  TO PV-TOT-INTRANSIT-QTY.       28850099
MC1201     ADD ST-INTRANSIT-AMT(ST-IND)  TO PV-TOT-INTRANSIT-AMT.       28860099
                                                                        28870099
      *--> MOVE ON-ORDER QTYS/AMTS TO COMMAREA                          28880099
           MOVE ST-ON-ORDER-QTY(ST-IND)      TO ASC-ON-ORDER-QTY        28890099
                                        (ASC-BLK-SUB ASC-ITEM-SUB).     28900099
           COMPUTE ASC-ON-ORDER-AMT     (ASC-BLK-SUB ASC-ITEM-SUB)      28910099
                   ROUNDED = ST-ON-ORDER-AMT(ST-IND) * 1.               28920099
                                                                        28930099
                                                                        28940099
JS0897     IF TSK-CUR-UNIT-RTL-AMT = 0                                  28950099
BJD          AND ASC-DO-NOT-GET-MULTI-SKUS                              28960099
JS0897        CONTINUE                                                  28970099
JS0897     ELSE                                                         28980099
               ADD ST-ON-ORDER-QTY(ST-IND)  TO PV-TOT-ON-ORDER-QTY      28990099
               ADD ST-ON-ORDER-AMT(ST-IND)  TO PV-TOT-ON-ORDER-AMT.     29000099
                                                                        29010099
      *--> MOVE STORE-OH QTYS/AMTS TO COMMAREA                          29020099
           COMPUTE PV-STORE-OH-QTY =                                    29030099
                     ST-CUR-OH-QTY(ST-IND) - ST-RECEIPT-QTY(ST-IND)     29040099
           MOVE PV-STORE-OH-QTY              TO ASC-STORE-OH-QTY        29050099
                                        (ASC-BLK-SUB ASC-ITEM-SUB).     29060099
           COMPUTE PV-STORE-OH-AMT-CALC =                               29070099
                     ST-CUR-OH-AMT(ST-IND) - ST-RECEIPT-AMT(ST-IND)     29080099
           COMPUTE ASC-STORE-OH-AMT     (ASC-BLK-SUB ASC-ITEM-SUB)      29090099
                   ROUNDED = PV-STORE-OH-AMT-CALC * 1.                  29100099
                                                                        29110099
BJD        IF TSK-CUR-UNIT-RTL-AMT = 0                                  29120099
BJD          AND ASC-DO-NOT-GET-MULTI-SKUS                              29130099
BJD            CONTINUE                                                 29140099
           ELSE                                                         29150099
             ADD ST-RECEIPT-QTY(ST-IND)      TO PV-TOT-RECEIPT-QTY      29160099
             ADD ST-RECEIPT-AMT(ST-IND)      TO PV-TOT-RECEIPT-AMT.     29170099
                                                                        29180099
           IF ASC-ITEMS-LEFT-ON-DB                                      29190099
      *-->    DETAIL LINES BLUE FOR ALL REGULAR STORE                   29200099
              MOVE DP015-BLUE     TO ASC-STORE-NMBR-C                   29210099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29220099
                                     ASC-STORE-NMBR-C                   29230099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29240099
                                     ASC-STORE-SHORT-NAME-C             29250099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29260099
                                     ASC-DETAIL-LINE-C                  29270099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29280099
                                     ASC-DC-C                           29290099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29300099
           ELSE                                                         29310099
      *-->    DETAIL LINES YELLOW FOR ALL NA/CS/DC STORES               29320099
              MOVE DP015-YELLOW   TO ASC-STORE-NMBR-C                   29330099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29340099
                                     ASC-STORE-NMBR-C                   29350099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29360099
                                     ASC-STORE-SHORT-NAME-C             29370099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29380099
                                     ASC-DETAIL-LINE-C                  29390099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29400099
                                     ASC-DC-C                           29410099
                                     (ASC-BLK-SUB ASC-ITEM-SUB)         29420099
           END-IF.                                                      29430099
                                                                        29440099
           INITIALIZE PV-STORE-AMOUNTS.                                 29450099
                                                                        29460099
      ******************************************************************29470099
      *   GET AND MOVE EACH STORE DC                                    29480099
      ******************************************************************29490099
       5710-MOVE-STORE-DC.                                              29500099
                                                                        29510099
           SET PS-STORE-DC-NOT-FOUND TO TRUE.                           29520099
                                                                        29530099
           PERFORM 5720-GET-STORES-DC.                                  29540099
                                                                        29550099
           IF PS-STORE-DC-FOUND                                         29560099
              MOVE XMT00001-LOC-5-ABBR-NM  TO ASC-DC                    29570099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 29580099
           ELSE                                                         29590099
              MOVE SPACES                  TO ASC-DC                    29600099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 29610099
           END-IF.                                                      29620099
                                                                        29630099
      ******************************************************************29640099
      *    GET THE STORE'S DISTRIBUTION CENTER 5 CHARACTER NAME        *29650099
      *    ONLY USE THE LAST 2-BYTES OF THE DC NAME                    *29660099
      ******************************************************************29670099
       5720-GET-STORES-DC.                                              29680099
                                                                        29690099
           EXEC SQL                                                     29700099
                SELECT SUBSTR(LOC_5_ABBR_NM,4,2)                        29710099
                  INTO :XMT00001-LOC-5-ABBR-NM                          29720099
                 FROM  XMT_LOC                                          29730099
                WHERE  LOC_TYP_CDE = 'DC'                               29740099
                  AND  LOC_NBR = :XMT00002-DC-NBR                       29750099
                                                                        29760099
           END-EXEC.                                                    29770099
               EVALUATE TRUE                                            29780099
                   WHEN SQLCODE = ZERO                                  29790099
                        SET PS-STORE-DC-FOUND     TO TRUE               29800099
                   WHEN SQLCODE = +100                                  29810099
                        SET PS-STORE-DC-NOT-FOUND TO TRUE               29820099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        29830099
                   WHEN SQLCODE  NOT EQUAL ZERO                         29840099
                        MOVE '5720-GET-STORES-DC'                       29850099
                                         TO DP013-PARAGRAPH             29860099
                        MOVE 'SELECT XMT LOC'                           29870099
                                         TO DP013-MESSAGE-TEXT (1)      29880099
                        MOVE SQLCA       TO DP013-SQLCA                 29890099
                        SET DP013-DB2-ABEND                             29900099
                                         TO TRUE                        29910099
                        PERFORM DP013-0000-PROCESS-ABEND                29920099
               END-EVALUATE.                                            29930099
                                                                        29940099
      ******************************************************************29950099
      *    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *29960099
      ******************************************************************29970099
       5800-MOVE-COMMAREA-TO-SCREEN.                                    29980099
                                                                        29990099
           IF ASC-HEADER-NOT-ALREADY-MOVED                              30000099
              SET ASC-HEADER-ALREADY-MOVED TO TRUE                      30010099
              MOVE ASC-DEPT-NMBR          TO ADEPTO                     30020099
              MOVE ASC-CLASS-NMBR         TO ACLASSO                    30030099
              MOVE PV-SKU-DESC            TO ASKUDSCO                   30040099
                                                                        30050099
              MOVE PV-VENDOR              TO AVNDRO                     30060099
              MOVE PV-VENDOR-NAME         TO AVNAMO                     30070099
              MOVE PV-VENDOR-STYLE        TO AVSTYO                     30080099
              MOVE PV-COLOR               TO ACOLORO                    30090099
              MOVE PV-SIZE                TO ASIZEO                     30100099
                                                                        30110099
              MOVE PV-STATUS-CODE(1)      TO ASTAT1O                    30120099
              MOVE PV-STATUS-CODE(2)      TO ASTAT2O                    30130099
              MOVE PV-STATUS-CODE(3)      TO ASTAT3O                    30140099
              MOVE PV-STATUS-CODE(4)      TO ASTAT4O                    30150099
              MOVE PV-STATUS-CODE(5)      TO ASTAT5O                    30160099
                                                                        30170099
              IF ASC-GET-MULTI-SKUS                                     30180099
MC0602           MOVE PV-SKU-NMBR         TO ASKUO                      30190099
                 MOVE SPACES              TO ACURRTLO                   30200099
                                             ACOSTO                     30210099
                 MOVE CA-VSM-REPLENISH    TO ARPLO                      30220099
              ELSE                                                      30230099
MC0602           MOVE ASC-SKU-NMBR        TO ASKUO                      30240099
MK               IF TSK-REGN-PRIC-IND = 'Y'                             30250099
MK                  IF (ASC-STORE-NUMBER = '000') OR                    30260099
MK                     (DP020-INT-APPL-FORMAT-IND = '1')                30270099
MK                     MOVE 'MIXED'          TO ACURRTLO                30280099
MK                  ELSE                                                30290099
MK                     IF PS-USE-CUR-CLR-RTL                            30300099
MK                        MOVE PV-CUR-CLR-RTL   TO PV-CUR-RTL-EDIT      30310099
MK                        MOVE PV-CUR-RTL-EDIT  TO ACURRTLO             30320099
MK                     ELSE                                             30330099
MK                        MOVE TSK-CUR-UNIT-RTL-AMT TO                  30340099
MK                                      PV-CUR-RTL-EDIT                 30350099
MK                        MOVE PV-CUR-RTL-EDIT  TO ACURRTLO             30360099
MK                  END-IF                                              30370099
MK               ELSE                                                   30380099
                    MOVE PV-CUR-RTL       TO PV-CUR-RTL-EDIT            30390099
                    MOVE PV-CUR-RTL-EDIT  TO ACURRTLO                   30400099
MK               END-IF                                                 30410099
                 MOVE PV-COST             TO PV-COST-EDIT               30420099
                 MOVE PV-COST-EDIT        TO ACOSTO                     30430099
                 MOVE UPC-RPLNMT-IND      TO ARPLO                      30440099
              END-IF                                                    30450099
           END-IF.                                                      30460099
                                                                        30470099
           IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             30480099
               AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          30490099
               OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          30500099
                   MOVE +1               TO ASC-BLK-SUB                 30510099
                   PERFORM 6100-WRITE-TEMP-STORAGE                      30520099
                   ADD +1                TO ASC-BLK-SUB                 30530099
                   PERFORM 6100-WRITE-TEMP-STORAGE                      30540099
                   DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             30550099
                       GIVING PV-BLOCK-NUMBER                           30560099
                       REMAINDER PV-REMAINDER                           30570099
                   IF  PV-REMAINDER > ZERO                              30580099
                       ADD +1            TO PV-BLOCK-NUMBER             30590099
                   END-IF                                               30600099
                   MOVE +1               TO ASC-BLK-SUB                 30610099
                   PERFORM 6000-READ-TEMP-STORAGE                       30620099
                   ADD +1                TO ASC-BLK-SUB                 30630099
                                            PV-BLOCK-NUMBER             30640099
                   PERFORM 6000-READ-TEMP-STORAGE                       30650099
           END-IF.                                                      30660099
                                                                        30670099
           MOVE +1                       TO ASC-BLK-SUB.                30680099
                                                                        30690099
           COMPUTE ASC-ITEM-SUB =                                       30700099
               ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              30710099
               + PC-ITEMS-PER-PANEL).                                   30720099
                                                                        30730099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30740099
               ADD +1                    TO ASC-BLK-SUB                 30750099
               SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30760099
           END-IF.                                                      30770099
                                                                        30780099
           COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30790099
               ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30800099
                                                                        30810099
           PERFORM 5810-FORMAT-LIST-LINES                               30820099
               VARYING PS-SUB                                           30830099
               FROM PC-ITEMS-PER-PANEL BY -1                            30840099
               UNTIL PS-SUB < +1.                                       30850099
                                                                        30860099
           COMPUTE ASC-ITEMS-DISPLAYED =                                30870099
               ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          30880099
                                                                        30890099
           IF PS-NO-START-ITEM-ERROR                                    30900099
               MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL30910099
                                                ASTRTITO                30920099
               MOVE SPACE                    TO ASC-START-ITEM-REQUEST  30930099
           ELSE                                                         30940099
               MOVE ASC-START-ITEM-REQUEST   TO ASTRTITO                30950099
           END-IF.                                                      30960099
                                                                        30970099
           MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    30980099
           MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    30990099
                                                                        31000099
           IF  DP020-MSG-NUMBER-X = SPACE                               31010099
               IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  31020099
      *-->         --- MORE ITEMS TO DISPLAY ----                       31030099
                   MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            31040099
                   SET DP020-MSG-INFORMATIONAL                          31050099
                                         TO TRUE                        31060099
               END-IF                                                   31070099
           END-IF.                                                      31080099
                                                                        31090099
      *--> MOVE COMMAREA TOTALS TO MAP TOTAL LINE AND DISPLAY           31100099
      *--> POUND SIGNS IF TRUNCATION OCCURS                             31110099
                                                                        31120099
           IF ASC-DISPLAY-UNITS                                         31130099
              PERFORM 5840-MOVE-TOTAL-QTYS                              31140099
           ELSE                                                         31150099
              PERFORM 5850-MOVE-TOTAL-DLRS                              31160099
           END-IF.                                                      31170099
                                                                        31180099
      ******************************************************************31190099
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *31200099
      ******************************************************************31210099
       5810-FORMAT-LIST-LINES.                                          31220099
                                                                        31230099
           IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      31240099
               SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                31250099
               MOVE SPACES             TO MR-STORE-NMBR    (PS-SUB)     31260099
                                          MR-STORE-NAME    (PS-SUB)     31270099
                                          MR-DETAIL-LINE   (PS-SUB)     31280099
                                          MR-DC            (PS-SUB)     31290099
      *--> MOVE DEFAULT COLOR TO SCREEN DETAIL FIELD COLORS             31300099
JS1002         MOVE DP015-BLUE TO                                       31310099
JS1002                        MR-STORE-NMBRC (PS-SUB)                   31320099
JS1002                        MR-STORE-NAMEC (PS-SUB)                   31330099
JS1002                        MR-DETAIL-LINEC (PS-SUB)                  31340099
JS1002                        MR-DCC (PS-SUB)                           31350099
           ELSE                                                         31360099
              MOVE ASC-STORE-NMBR        (ASC-BLK-SUB ASC-ITEM-SUB)     31370099
                                       TO MR-STORE-NMBR (PS-SUB)        31380099
              MOVE ASC-STORE-SHORT-NAME  (ASC-BLK-SUB ASC-ITEM-SUB)     31390099
                                       TO MR-STORE-NAME (PS-SUB)        31400099
              MOVE ASC-DC                (ASC-BLK-SUB ASC-ITEM-SUB)     31410099
                                       TO MR-DC (PS-SUB)                31420099
              IF ASC-DISPLAY-UNITS                                      31430099
                 PERFORM 5820-MOVE-DETAIL-QTYS                          31440099
              ELSE                                                      31450099
                 PERFORM 5830-MOVE-DETAIL-DLRS                          31460099
              END-IF                                                    31470099
      *-->    MOVE COMMAREA COLORS TO SCREEN DETAIL FIELD COLORS        31480099
JS1002        MOVE ASC-STORE-NMBR-C  (ASC-BLK-SUB ASC-ITEM-SUB)         31490099
JS1002                                 TO MR-STORE-NMBRC (PS-SUB)       31500099
JS1002        MOVE ASC-STORE-SHORT-NAME-C                               31510099
JS1002                                 (ASC-BLK-SUB ASC-ITEM-SUB)       31520099
JS1002                                 TO MR-STORE-NAMEC (PS-SUB)       31530099
JS1002        MOVE ASC-DETAIL-LINE-C  (ASC-BLK-SUB ASC-ITEM-SUB)        31540099
JS1002                                 TO MR-DETAIL-LINEC (PS-SUB)      31550099
JS1002        MOVE ASC-DC-C           (ASC-BLK-SUB ASC-ITEM-SUB)        31560099
JS1002                                 TO MR-DCC (PS-SUB)               31570099
JS1002     END-IF.                                                      31580099
                                                                        31590099
           SUBTRACT +1 FROM ASC-ITEM-SUB.                               31600099
                                                                        31610099
           IF  ASC-ITEM-SUB < + 1                                       31620099
               MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  31630099
               MOVE +1                 TO ASC-BLK-SUB                   31640099
           END-IF.                                                      31650099
                                                                        31660099
      ******************************************************************31670099
      *  MOVE DETAIL LINE QUANITIES                                    *31680099
      ******************************************************************31690099
       5820-MOVE-DETAIL-QTYS.                                           31700099
                                                                        31710099
           MOVE SPACES                  TO ADOL1O                       31720099
                                           ADOL2O                       31730099
      *                                    ADOL3O                       31740099
                                           ADOL4O                       31750099
                                           ADOL5O                       31760099
                                           ADOL6O.                      31770099
                                                                        31780099
           IF ASC-CUR-ONHAND-QTY(ASC-BLK-SUB ASC-ITEM-SUB)              31790099
              > +99999999 OR < -9999999                                 31800099
              MOVE '########'           TO DL-CURR-ONHAND-C             31810099
           ELSE                                                         31820099
              MOVE ASC-CUR-ONHAND-QTY(ASC-BLK-SUB ASC-ITEM-SUB)         31830099
                                        TO DL-CURR-ONHAND-9             31840099
           END-IF.                                                      31850099
                                                                        31860099
           IF ASC-CUR-SALES-QTY(ASC-BLK-SUB ASC-ITEM-SUB)               31870099
              > +99999999 OR  < -9999999                                31880099
              MOVE '########'           TO DL-CURR-SALES-C              31890099
           ELSE                                                         31900099
              MOVE ASC-CUR-SALES-QTY(ASC-BLK-SUB ASC-ITEM-SUB)          31910099
                                        TO DL-CURR-SALES-9              31920099
           END-IF.                                                      31930099
                                                                        31940099
           IF ASC-LAST-WK-SALES-QTY(ASC-BLK-SUB ASC-ITEM-SUB)           31950099
              > +99999999 OR  < -9999999                                31960099
              MOVE '########'           TO DL-LAST-WK-SALES-C           31970099
           ELSE                                                         31980099
              MOVE ASC-LAST-WK-SALES-QTY(ASC-BLK-SUB ASC-ITEM-SUB)      31990099
                                        TO DL-LAST-WK-SALES-9           32000099
           END-IF.                                                      32010099
                                                                        32020099
MC1201     IF ASC-INTRANSIT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)               32030099
              > +99999999 OR  < -9999999                                32040099
MC1201        MOVE ' #######'           TO DL-INTRANSIT-C               32050099
           ELSE                                                         32060099
MC1201        MOVE ASC-INTRANSIT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)          32070099
MC1201                                  TO DL-INTRANSIT-9               32080099
           END-IF.                                                      32090099
                                                                        32100099
                                                                        32110099
           IF ASC-ON-ORDER-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                32120099
              > +99999999                                               32130099
              MOVE '########'           TO DL-ON-ORDER-C                32140099
           ELSE                                                         32150099
              MOVE ASC-ON-ORDER-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          32160099
                                        TO DL-ON-ORDER-9                32170099
           END-IF.                                                      32180099
                                                                        32190099
           MOVE ASC-STORE-OH-QTY(ASC-BLK-SUB ASC-ITEM-SUB)              32200099
                                        TO DL-STORE-OH-9.               32210099
                                                                        32220099
           MOVE DL-DETAIL-LINE          TO MR-DETAIL-LINE (PS-SUB).     32230099
                                                                        32240099
      ******************************************************************32250099
      *  MOVE DETAIL LINE DOLLAR AMOUNTS                               *32260099
      ******************************************************************32270099
       5830-MOVE-DETAIL-DLRS.                                           32280099
                                                                        32290099
           MOVE '$'                     TO ADOL1O                       32300099
                                           ADOL2O                       32310099
      *                                    ADOL3O                       32320099
                                           ADOL4O                       32330099
                                           ADOL5O                       32340099
                                           ADOL6O.                      32350099
                                                                        32360099
           IF ASC-CUR-ONHAND-AMT(ASC-BLK-SUB ASC-ITEM-SUB)              32370099
              > +99999999 OR < -9999999                                 32380099
              MOVE '########'           TO DL-CURR-ONHAND-C             32390099
           ELSE                                                         32400099
              MOVE ASC-CUR-ONHAND-AMT(ASC-BLK-SUB ASC-ITEM-SUB)         32410099
                                        TO DL-CURR-ONHAND-9             32420099
           END-IF.                                                      32430099
                                                                        32440099
           IF ASC-CUR-SALES-AMT(ASC-BLK-SUB ASC-ITEM-SUB)               32450099
              > +99999999 OR  < -9999999                                32460099
              MOVE '########'           TO DL-CURR-SALES-C              32470099
           ELSE                                                         32480099
              MOVE ASC-CUR-SALES-AMT(ASC-BLK-SUB ASC-ITEM-SUB)          32490099
                                        TO DL-CURR-SALES-9              32500099
           END-IF.                                                      32510099
                                                                        32520099
           IF ASC-LAST-WK-SALES-AMT(ASC-BLK-SUB ASC-ITEM-SUB)           32530099
              > +99999999 OR < -9999999                                 32540099
              MOVE '########'           TO DL-LAST-WK-SALES-C           32550099
           ELSE                                                         32560099
              MOVE ASC-LAST-WK-SALES-AMT(ASC-BLK-SUB ASC-ITEM-SUB)      32570099
                                        TO DL-LAST-WK-SALES-9           32580099
           END-IF.                                                      32590099
                                                                        32600099
MC1201     IF ASC-INTRANSIT-AMT(ASC-BLK-SUB ASC-ITEM-SUB)               32610099
              > +99999999 OR  < -9999999                                32620099
MC1201        MOVE ' #######'           TO DL-INTRANSIT-C               32630099
           ELSE                                                         32640099
MC1201        MOVE ASC-INTRANSIT-AMT(ASC-BLK-SUB ASC-ITEM-SUB)          32650099
MC1201                                  TO DL-INTRANSIT-9               32660099
           END-IF.                                                      32670099
                                                                        32680099
                                                                        32690099
           IF ASC-ON-ORDER-AMT(ASC-BLK-SUB ASC-ITEM-SUB)                32700099
              > +99999999                                               32710099
              MOVE '########'           TO DL-ON-ORDER-C                32720099
           ELSE                                                         32730099
              MOVE ASC-ON-ORDER-AMT (ASC-BLK-SUB ASC-ITEM-SUB)          32740099
                                        TO DL-ON-ORDER-9                32750099
           END-IF.                                                      32760099
                                                                        32770099
           MOVE ASC-STORE-OH-AMT(ASC-BLK-SUB ASC-ITEM-SUB)              32780099
                                        TO DL-STORE-OH-9.               32790099
                                                                        32800099
           MOVE DL-DETAIL-LINE          TO MR-DETAIL-LINE (PS-SUB).     32810099
                                                                        32820099
      ******************************************************************32830099
      *  MOVE TOTAL LINE QUANITIES                                     *32840099
      ******************************************************************32850099
       5840-MOVE-TOTAL-QTYS.                                            32860099
                                                                        32870099
           IF ASC-TOT-CUR-ONHAND-QTY > +99999999 OR < -9999999          32880099
              MOVE '########'                TO TL-CURR-ONHAND-C        32890099
           ELSE                                                         32900099
              MOVE ASC-TOT-CUR-ONHAND-QTY    TO TL-CURR-ONHAND-9        32910099
           END-IF.                                                      32920099
                                                                        32930099
           IF ASC-TOT-CUR-SALES-QTY > +99999999 OR < -9999999           32940099
              MOVE '########'                TO TL-CURR-SALES-C         32950099
           ELSE                                                         32960099
              MOVE ASC-TOT-CUR-SALES-QTY     TO TL-CURR-SALES-9         32970099
           END-IF.                                                      32980099
                                                                        32990099
           IF ASC-TOT-LAST-WK-SALES-QTY > +99999999 OR < -9999999       33000099
              MOVE '########'                TO TL-LAST-WK-SALES-C      33010099
           ELSE                                                         33020099
              MOVE ASC-TOT-LAST-WK-SALES-QTY TO TL-LAST-WK-SALES-9      33030099
           END-IF.                                                      33040099
                                                                        33050099
MC1201     IF ASC-TOT-INTRANSIT-QTY > +99999999 OR < -9999999           33060099
MC1201        MOVE ' #######'                TO TL-INTRANSIT-C          33070099
           ELSE                                                         33080099
MC1201        MOVE ASC-TOT-INTRANSIT-QTY   TO TL-INTRANSIT-9            33090099
           END-IF.                                                      33100099
                                                                        33110099
           IF ASC-TOT-ON-ORDER-QTY > +99999999                          33120099
              MOVE '########'                TO TL-ON-ORDER-C           33130099
           ELSE                                                         33140099
              MOVE ASC-TOT-ON-ORDER-QTY      TO TL-ON-ORDER-9           33150099
           END-IF.                                                      33160099
                                                                        33170099
           MOVE ASC-TOT-STORE-OH-QTY         TO TL-STORE-OH-9.          33180099
                                                                        33190099
           MOVE TL-TOTALS-LINE               TO MR-TOTALS-LINE.         33200099
                                                                        33210099
      ******************************************************************33220099
      *  MOVE TOTAL LINE DOLLAR AMOUNTS                                *33230099
      ******************************************************************33240099
       5850-MOVE-TOTAL-DLRS.                                            33250099
                                                                        33260099
           IF ASC-TOT-CUR-ONHAND-AMT > +99999999 OR < -9999999          33270099
              MOVE '########'                TO TL-CURR-ONHAND-C        33280099
           ELSE                                                         33290099
              MOVE ASC-TOT-CUR-ONHAND-AMT    TO TL-CURR-ONHAND-9        33300099
           END-IF.                                                      33310099
                                                                        33320099
           IF ASC-TOT-CUR-SALES-AMT > +99999999 OR < -9999999           33330099
              MOVE '########'                TO TL-CURR-SALES-C         33340099
           ELSE                                                         33350099
              MOVE ASC-TOT-CUR-SALES-AMT     TO TL-CURR-SALES-9         33360099
           END-IF.                                                      33370099
                                                                        33380099
           IF ASC-TOT-LAST-WK-SALES-AMT > +99999999 OR < -9999999       33390099
              MOVE '########'                TO TL-LAST-WK-SALES-C      33400099
           ELSE                                                         33410099
              MOVE ASC-TOT-LAST-WK-SALES-AMT TO TL-LAST-WK-SALES-9      33420099
           END-IF.                                                      33430099
                                                                        33440099
MC1201     IF ASC-TOT-INTRANSIT-AMT > +99999999 OR < -9999999           33450099
MC1201        MOVE ' #######'                TO TL-INTRANSIT-C          33460099
           ELSE                                                         33470099
MC1201        MOVE ASC-TOT-INTRANSIT-AMT     TO TL-INTRANSIT-9          33480099
           END-IF.                                                      33490099
                                                                        33500099
           IF ASC-TOT-ON-ORDER-AMT > +99999999                          33510099
              MOVE '########'                TO TL-ON-ORDER-C           33520099
           ELSE                                                         33530099
              MOVE ASC-TOT-ON-ORDER-AMT      TO TL-ON-ORDER-9           33540099
           END-IF.                                                      33550099
                                                                        33560099
           MOVE ASC-TOT-STORE-OH-AMT         TO TL-STORE-OH-9.          33570099
                                                                        33580099
           MOVE TL-TOTALS-LINE               TO MR-TOTALS-LINE.         33590099
                                                                        33600099
      ******************************************************************33610099
      *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *33620099
      ******************************************************************33630099
       6000-READ-TEMP-STORAGE.                                          33640099
                                                                        33650099
           EXEC CICS                                                    33660099
               READQ TS                                                 33670099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          33680099
                   INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33690099
                   ITEM  (PV-BLOCK-NUMBER)                              33700099
                   RESP  (PV-CICS-RESP)                                 33710099
           END-EXEC.                                                    33720099
                                                                        33730099
           IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33740099
             OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33750099
               CONTINUE                                                 33760099
           ELSE                                                         33770099
               SET DP013-CICS-ABEND            TO TRUE                  33780099
               SET DP013-NO-ROLLBACK           TO TRUE                  33790099
               MOVE '6000-READ-TEMP-STORAGE'   TO DP013-PARAGRAPH       33800099
               MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33810099
                                               TO DP013-MESSAGE-TEXT(1) 33820099
               PERFORM DP013-0000-PROCESS-ABEND                         33830099
           END-IF.                                                      33840099
                                                                        33850099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33860099
                                                                        33870099
           IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33880099
               INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33890099
           END-IF.                                                      33900099
                                                                        33910099
      ******************************************************************33920099
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *33930099
      *    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *33940099
      ******************************************************************33950099
       6100-WRITE-TEMP-STORAGE.                                         33960099
                                                                        33970099
           MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     33980099
                                         TO PV-LIST-ITEM-NUMBER.        33990099
           COMPUTE PV-BLOCK-NUMBER =                                    34000099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    34010099
                                                                        34020099
           IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             34030099
           OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             34040099
               IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      34050099
                   PERFORM 6110-REWRITE-ASC-LISTQ                       34060099
               END-IF                                                   34070099
           ELSE                                                         34080099
               COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       34090099
               ASC-HIGHEST-BLOCK-WRITTEN + 1                            34100099
               PERFORM 6120-WRITE-ASC-LISTQ                             34110099
               ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   34120099
           END-IF.                                                      34130099
                                                                        34140099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      34150099
                                         TO TRUE.                       34160099
                                                                        34170099
                                                                        34180099
      ******************************************************************34190099
      *  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *34200099
      *  SPECIFIC COMMAREA.                                            *34210099
      ******************************************************************34220099
       6110-REWRITE-ASC-LISTQ.                                          34230099
                                                                        34240099
           EXEC CICS                                                    34250099
               WRITEQ TS                                                34260099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          34270099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34280099
                   ITEM  (PV-BLOCK-NUMBER)                              34290099
                   REWRITE                                              34300099
                   RESP  (PV-CICS-RESP)                                 34310099
           END-EXEC.                                                    34320099
                                                                        34330099
           IF  PV-CICS-RESP = DFHRESP(NORMAL)                           34340099
               CONTINUE                                                 34350099
           ELSE                                                         34360099
               SET DP013-CICS-ABEND          TO TRUE                    34370099
               SET DP013-NO-ROLLBACK         TO TRUE                    34380099
               MOVE '6110-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         34390099
               MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     34400099
                                             TO DP013-MESSAGE-TEXT(1)   34410099
               PERFORM DP013-0000-PROCESS-ABEND                         34420099
           END-IF.                                                      34430099
                                                                        34440099
      ******************************************************************34450099
      *  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *34460099
      *  SPECIFIC COMMAREA.                                            *34470099
      ******************************************************************34480099
       6120-WRITE-ASC-LISTQ.                                            34490099
                                                                        34500099
           EXEC CICS                                                    34510099
               WRITEQ TS                                                34520099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          34530099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34540099
                   ITEM  (PV-BLOCK-NUMBER)                              34550099
                   RESP  (PV-CICS-RESP)                                 34560099
           END-EXEC.                                                    34570099
                                                                        34580099
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      34590099
               SET DP013-CICS-ABEND        TO TRUE                      34600099
               SET DP013-NO-ROLLBACK       TO TRUE                      34610099
               MOVE '6120-WRITE-ASC-LISTQ' TO DP013-PARAGRAPH           34620099
               MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           34630099
                                           TO DP013-MESSAGE-TEXT(1)     34640099
               PERFORM DP013-0000-PROCESS-ABEND                         34650099
           END-IF.                                                      34660099
                                                                        34670099
      ******************************************************************34680099
      *  READ THE VENDOR NAME FROM THE ENTITY TABLE USING THE          *34690099
      *  DEPARTMENT NUMBER AND THE IN-HOUSE VENDOR NUMBER THAT IS      *34700099
      *  PASSED IN THE COMMAREA.                                       *34710099
      ******************************************************************34720099
       6130-GET-VENDOR-NAME.                                            34730099
                                                                        34740099
           MOVE '*6130-GET-VENDOR-NAME.          *' TO DP013-PARAGRAPH. 34750099
                                                                        34760099
           EXEC SQL                                                     34770099
                SELECT A.ENT_NAME_DESC                                  34780099
                  INTO :ENTNME-ENT-NAME-DESC                            34790099
                  FROM TENTNME A                                        34800099
                      ,TVNDDPT B                                        34810099
                 WHERE A.ENT_ID      =  B.ENT_ID                        34820099
                   AND B.DEPT_NBR    = :VNDDPT-DEPT-NBR                 34830099
                   AND B.INHOUSE_NBR = :VNDDPT-INHOUSE-NBR              34840099
                   AND A.TYPE_CDE = '01'                                34850099
           END-EXEC.                                                    34860099
                                                                        34870099
           EVALUATE TRUE                                                34880099
               WHEN SQLCODE = ZERO                                      34890099
               WHEN SQLCODE = -811                                      34900099
                   SET PS-VENDOR-FOUND     TO TRUE                      34910099
               WHEN SQLCODE = +100                                      34920099
                   SET PS-VENDOR-NOT-FOUND TO TRUE                      34930099
               WHEN SQLCODE  NOT = ZERO                                 34940099
               WHEN SQLWARN0 NOT = SPACES                               34950099
                   MOVE SQLCA              TO DP013-SQLCA               34960099
                   SET DP013-DB2-ABEND     TO TRUE                      34970099
                   MOVE 'SELECT A VENDOR NAME FROM TENTNME'             34980099
                                           TO DP013-MESSAGE-TEXT(1)     34990099
                   PERFORM DP013-0000-PROCESS-ABEND                     35000099
           END-EVALUATE.                                                35010099
                                                                        35020099
      ******************************************************************35030099
      *  GET THE KOHL'S SIZE DESCRIPTION FOR A SPECIFIC SKU SIZE CODE. *35040099
      *  SELECT THE REQUIRED SIZE DESC INFORMATION FROM THE DB2 TSIZE  *35050099
      *  TABLE USING THE SKU TABLE (TSK) SIZE_CDE.                     *35060099
      *  IF A RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE     *35070099
      *  SELECT WILL BE RETRIED UP TO A SET NUMBER OF TIMES.  IF NO    *35080099
      *  DESCRIPTION IS FOUND FOR THE SKU SIZE CODE WHERE THE          *35090099
      *  EFF-END-DTE FIELD IS GREATER THAN THE CURRENT DATE, THE MOST  *35100099
      *  CURRENT EXPIRED DESCRIPTION WILL BE SELECTED (PARA 5230-)     *35110099
      ******************************************************************35120099
       6140-GET-SIZE-DESC.                                              35130099
           MOVE '*6140-GET-SIZE-DESC.             *' TO DP013-PARAGRAPH.35140099
                                                                        35150099
           EXEC SQL                                                     35160099
               SELECT KOHLS_DESC                                        35170099
                   INTO :SIZE-KOHLS-DESC                                35180099
                   FROM TSIZE                                           35190099
                   WHERE NRF_SIZE_CDE = :SIZE-NRF-SIZE-CDE AND          35200099
                         (EFF_END_DTE IS NULL               OR          35210099
                          EFF_END_DTE > CURRENT DATE)                   35220099
           END-EXEC.                                                    35230099
                                                                        35240099
           EVALUATE TRUE                                                35250099
               WHEN SQLCODE = 0                                         35260099
                   SET PS-SIZE-DESC-FOUND TO TRUE                       35270099
               WHEN SQLCODE = +100                                      35280099
                   PERFORM 6150-SELECT-OUTDATED-SIZE-DESC               35290099
               WHEN SQLCODE = -911                                      35300099
               WHEN SQLCODE = -913                                      35310099
                   ADD 1 TO PV-RETRY-COUNT                              35320099
               WHEN SQLWARN0 NOT = SPACES                               35330099
               WHEN SQLCODE  NOT = ZERO                                 35340099
                   MOVE SQLCA            TO DP013-SQLCA                 35350099
                   SET DP013-DB2-ABEND   TO TRUE                        35360099
                   MOVE 'SELECT A SIZE DESC FORM SIZE TABLE (TSIZE)'    35370099
                                         TO DP013-MESSAGE-TEXT(1)       35380099
                   PERFORM DP013-0000-PROCESS-ABEND                     35390099
           END-EVALUATE.                                                35400099
                                                                        35410099
      ******************************************************************35420099
      *  SELECT INFORMATION FROM THE SIZETABLE FOR THE CURRENT SKU.    *35430099
      *  IF THE RESOURCE IS NOT AVAILABLE, OR A DEADLOCK OCCURS, THE   *35440099
      *  SELECT WILL BE RETRIED.  IF ANY OTHER ERRORS ARE DETECTED,    *35450099
      *  AN ERROR MESSAGE WILL BE FORMATTED AND SENT TO THE SCREEN,    *35460099
      *  AND CONTROL WILL BE RETURNED TO NATIVE CICS.                  *35470099
      ******************************************************************35480099
       6150-SELECT-OUTDATED-SIZE-DESC.                                  35490099
           MOVE '*6150-SELECT-OUTDATED-SIZE DESC. *' TO DP013-PARAGRAPH 35500099
                                                                        35510099
           EXEC SQL                                                     35520099
               SELECT KOHLS_DESC                                        35530099
                   INTO :SIZE-KOHLS-DESC                                35540099
                   FROM TSIZE                                           35550099
                   WHERE NRF_SIZE_CDE = : SIZE-NRF-SIZE-CDE AND         35560099
                         EFF_END_DTE  =                                 35570099
                         ( SELECT MAX (EFF_END_DTE)                     35580099
                           FROM   TSIZE                                 35590099
                           WHERE  NRF_SIZE_CDE = :SIZE-NRF-SIZE-CDE)    35600099
           END-EXEC.                                                    35610099
                                                                        35620099
           EVALUATE TRUE                                                35630099
               WHEN SQLCODE = 0                                         35640099
               WHEN SQLCODE = -811                                      35650099
                   SET PS-SIZE-DESC-FOUND     TO TRUE                   35660099
               WHEN SQLCODE = +100                                      35670099
                   SET PS-SIZE-DESC-NOT-FOUND TO TRUE                   35680099
               WHEN SQLCODE = -911                                      35690099
               WHEN SQLCODE = -913                                      35700099
                   ADD 1 TO PV-RETRY-COUNT                              35710099
               WHEN SQLWARN0 NOT = SPACES                               35720099
               WHEN SQLCODE  NOT = ZERO                                 35730099
                   MOVE SQLCA            TO DP013-SQLCA                 35740099
                   SET DP013-DB2-ABEND   TO TRUE                        35750099
                   MOVE 'SELECT OUTDATED DESC FROM SIZE TABLE(TSIZE)'   35760099
                                         TO DP013-MESSAGE-TEXT(1)       35770099
                   PERFORM DP013-0000-PROCESS-ABEND                     35780099
           END-EVALUATE.                                                35790099
                                                                        35800099
      ******************************************************************35810099
      *  GET THE NEXT DISTRICT NUMBER AND NAME.  THIS PARAGRAPH IS      35820099
      *  CALLED WHEN THE F21 KEY IS HIT TO GET THE INFORMATION FOR      35830099
      *  BE DISPLAYED FOR THE NEXT DISTRICT.                            35840099
      ******************************************************************35850099
      ******************************************************************35860099
      *  SELECT SKU INFO                                                35870099
      ******************************************************************35880099
       7100-SELECT-SKU-INFO.                                            35890099
                                                                        35900099
           EXEC SQL                                                     35910099
              SELECT  STATUS_CODE                                       35920099
                     ,UNIT_COST_AMT                                     35930099
                     ,CUR_UNIT_RTL_AMT                                  35940099
                     ,VNDR_IN_HSE_NMBR                                  35950099
                     ,VENDOR_STYLE_CODE                                 35960099
                     ,SIZE_DESC                                         35970099
                     ,COLOR_DESC                                        35980099
                     ,SKU_DESC                                          35990099
                     ,LONG_VENDOR_STYLE                                 36000099
                     ,LONG_SIZE_DESC                                    36010099
                     ,LONG_COLOR_DESC                                   36020099
                     ,SIZE_CDE                                          36030099
                     ,ITEM_NMBR                                         36040099
                     ,REGN_PRIC_IND                                     36050099
MC0602               ,DEPT                                              36060099
MC0602               ,SUBCLASS                                          36070099
MC0602               ,SKU                                               36080099
                INTO :TSK-STATUS-CODE                                   36090099
                    ,:TSK-UNIT-COST-AMT                                 36100099
                    ,:TSK-CUR-UNIT-RTL-AMT                              36110099
                    ,:TSK-VNDR-IN-HSE-NMBR                              36120099
                    ,:TSK-VENDOR-STYLE-CODE                             36130099
                    ,:TSK-SIZE-DESC                                     36140099
                    ,:TSK-COLOR-DESC                                    36150099
                    ,:TSK-SKU-DESC                                      36160099
                    ,:TSK-LONG-VENDOR-STYLE                             36170099
                    ,:TSK-LONG-SIZE-DESC                                36180099
                    ,:TSK-LONG-COLOR-DESC                               36190099
                    ,:TSK-SIZE-CDE                                      36200099
                    ,:TSK-ITEM-NMBR                                     36210099
                    ,:TSK-REGN-PRIC-IND                                 36220099
MC0602              ,:SKXREF-DEPT                                       36230099
MC0602              ,:SKXREF-SUBCLASS                                   36240099
MC0602              ,:SKXREF-SKU                                        36250099
                FROM  TSK                                               36260099
MC0602          JOIN  TSKXREF                                           36270099
MC0602            ON  TSK.ITEM_NMBR = TSKXREF.ITM_NBR                   36280099
MC0602         WHERE  SKU              = :SKXREF-SKU                    36290099
           END-EXEC                                                     36300099
                                                                        36310099
           EVALUATE TRUE                                                36320099
               WHEN SQLCODE = +100                                      36330099
                    SET PS-SKU-INFO-NOT-FOUND TO TRUE                   36340099
               WHEN SQLCODE = +0                                        36350099
                    SET PS-SKU-INFO-FOUND     TO TRUE                   36360099
MC0602              MOVE SKXREF-DEPT     TO ASC-DEPT-NMBR-9             36370099
MC0602              MOVE SKXREF-SUBCLASS TO ASC-CLASS-NMBR-9            36380099
MC0602              MOVE SKXREF-SKU      TO ASC-SKU-NMBR-9              36390099
               WHEN SQLCODE  NOT = ZERO                                 36400099
               WHEN SQLWARN0 NOT = SPACES                               36410099
                    MOVE '7100-SELECT-SKU-INFO'                         36420099
                                        TO DP013-PARAGRAPH              36430099
                    MOVE 'SELECT TSK'   TO DP013-MESSAGE-TEXT (1)       36440099
                    MOVE SQLCA          TO DP013-SQLCA                  36450099
                    SET DP013-DB2-ABEND TO TRUE                         36460099
                    PERFORM DP013-0000-PROCESS-ABEND                    36470099
           END-EVALUATE.                                                36480099
                                                                        36490099
      ******************************************************************36500099
      *  OPEN CURSOR FOR ALL SKUS BASED ON SALES CRITERIA SCRN FSKCS034 36510099
      ******************************************************************36520099
       7205-OPEN-SKUS-CSR-2.                                            36530099
                                                                        36540099
           EXEC SQL                                                     36550099
                OPEN MULTI-SKUS-CSR-2                                   36560099
           END-EXEC.                                                    36570099
                                                                        36580099
           EVALUATE TRUE                                                36590099
               WHEN SQLCODE = ZERO                                      36600099
                    CONTINUE                                            36610099
               WHEN SQLWARN0 NOT EQUAL SPACE                            36620099
               WHEN SQLCODE  NOT EQUAL ZERO                             36630099
                    MOVE '7205-OPEN-SKUS-CSR-2'                         36640099
                                        TO DP013-PARAGRAPH              36650099
                    MOVE 'OPEN SKUS CURSOR'                             36660099
                                        TO DP013-MESSAGE-TEXT (1)       36670099
                    MOVE SQLCA          TO DP013-SQLCA                  36680099
                    SET DP013-DB2-ABEND TO TRUE                         36690099
                    PERFORM DP013-0000-PROCESS-ABEND                    36700099
           END-EVALUATE.                                                36710099
                                                                        36720099
      ******************************************************************36730099
      *  FETCH ALL SKUS MEETING CRITERIA INFO                           36740099
      ******************************************************************36750099
       7215-FETCH-SKUS-CSR-2.                                           36760099
                                                                        36770099
               EXEC SQL                                                 36780099
                    FETCH MULTI-SKUS-CSR-2                              36790099
MC0602              INTO :SKXREF-DEPT,                                  36800099
MC0602                   :SKXREF-SUBCLASS,                              36810099
MC0602                   :SKXREF-SKU,                                   36820099
                         :TSK-CUR-UNIT-RTL-AMT,                         36830099
                         :TSK-UNIT-COST-AMT,                            36840099
                         :TSK-ITEM-NMBR,                                36850099
                         :TSK-GP-RTL-AMT,                               36860099
                         :TSK-GP-QTY,                                   36870099
                         :TSK-STATUS-CODE,                              36880099
                         :UPC-RPLNMT-IND,                               36890099
                         :TSK-REGN-PRIC-IND,                            36900099
                         :UPC-INTR-UPC-ID                               36910099
               END-EXEC                                                 36920099
                                                                        36930099
               EVALUATE TRUE                                            36940099
                   WHEN SQLCODE = ZERO                                  36950099
                        ADD 1 TO PV-SKUS-FETCHED                        36960099
                   WHEN SQLCODE = +100                                  36970099
                        SET PS-ALL-SKUS-PROCESSED TO  TRUE              36980099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        36990099
                   WHEN SQLCODE  NOT EQUAL ZERO                         37000099
                        MOVE '7215-FETCH-SKUS-CSR-2 '                   37010099
                                            TO DP013-PARAGRAPH          37020099
                        MOVE 'FETCH SKUS CURSOR'                        37030099
                                            TO DP013-MESSAGE-TEXT (1)   37040099
                        MOVE SQLCA          TO DP013-SQLCA              37050099
                        SET DP013-DB2-ABEND TO TRUE                     37060099
                        PERFORM DP013-0000-PROCESS-ABEND                37070099
               END-EVALUATE.                                            37080099
                                                                        37090099
      ******************************************************************37100099
      *  CLOSE SKUS CURSOR                                              37110099
      ******************************************************************37120099
       7225-CLOSE-SKUS-CSR-2.                                           37130099
                                                                        37140099
           EXEC SQL                                                     37150099
               CLOSE MULTI-SKUS-CSR-2                                   37160099
           END-EXEC.                                                    37170099
                                                                        37180099
           EVALUATE TRUE                                                37190099
               WHEN SQLCODE = ZERO                                      37200099
                    CONTINUE                                            37210099
               WHEN SQLWARN0 NOT EQUAL SPACE                            37220099
               WHEN SQLCODE  NOT EQUAL ZERO                             37230099
                    MOVE '7225-CLOSE-SKUS-CSR-2'                        37240099
                                        TO DP013-PARAGRAPH              37250099
                    MOVE 'CLOSE MULTI SKUS CURSOR'                      37260099
                                        TO DP013-MESSAGE-TEXT (1)       37270099
                    MOVE SQLCA          TO DP013-SQLCA                  37280099
                    SET DP013-DB2-ABEND TO TRUE                         37290099
                    PERFORM DP013-0000-PROCESS-ABEND                    37300099
           END-EVALUATE.                                                37310099
                                                                        37320099
      ******************************************************************37330099
      *  GET NUMBER OF COUNT OF SKUS THAT WILL BE PROCESSED             37340099
      ******************************************************************37350099
       7235-GET-SKU-COUNT-2.                                            37360099
                                                                        37370099
MC0602     MOVE ASC-DEPT-NMBR-9    TO PV-DEPT-NMBR-C3.                  37380099
           MOVE ZEROS              TO PV-TOTAL-SKUS.                    37390099
                                                                        37400099
           EXEC SQL                                                     37410099
               SELECT  COUNT(*)                                         37420099
                 INTO :PV-TOTAL-SKUS                                    37430099
               FROM TSK     A                                           37440099
                   ,TUPCSKU B                                           37450099
                   ,TUPC    C                                           37460099
                   ,TSKXREF X                                           37470099
                   WHERE                                                37480099
MC0602               ((X.DEPT             = :PV-DEPT-NMBR-C3)           37490099
                              AND                                       37500099
MC0602                (X.SUBCLASS         = :PV-CLASS-LOW-C3)           37510099
                              AND                                       37520099
MC0602                (X.SKU              = :PV-SKU-LOW-C3 OR           37530099
MC0602                 X.SKU              > :PV-SKU-HIGH-C3)            37540099
                              AND                                       37550099
                      (A.STATUS_CODE IN (:PV-STATUS-1,                  37560099
                                         :PV-STATUS-2,                  37570099
                                         :PV-STATUS-3,                  37580099
                                         :PV-STATUS-4,                  37590099
                                         :PV-STATUS-5,                  37600099
                                         :PV-STATUS-6))                 37610099
                              AND                                       37620099
                      (A.GROUP_CODE BETWEEN                             37630099
                                  :PV-GROUP-LOW AND :PV-GROUP-HIGH)     37640099
                              AND                                       37650099
                      (A.VNDR_IN_HSE_NMBR BETWEEN                       37660099
                                  :PV-VENDOR-LOW AND :PV-VENDOR-HIGH)   37670099
                              AND                                       37680099
0518                  ((A.VENDOR_STYLE_CODE BETWEEN :PV-VND-STYL-LO     37690099
0518                                            AND :PV-VND-STYL-HI)    37700099
0518                OR (A.LONG_VENDOR_STYLE BETWEEN :PV-LNG-STYL-LO     37710099
0518                                            AND :PV-LNG-STYL-HI))   37720099
0518  *               (A.LONG_VENDOR_STYLE BETWEEN                      37730099
0518  *                           :PV-STYLE-LOW AND :PV-STYLE-HIGH  OR  37740099
0518  *                A.VENDOR_STYLE_CODE BETWEEN                      37750099
0518  *                           :PV-STYLE-LOW AND :PV-STYLE-HIGH)     37760099
                              AND                                       37770099
                      (A.SIZE_CDE BETWEEN                               37780099
                       :PV-SIZE-LOW AND :PV-SIZE-HIGH)                  37790099
                              AND                                       37800099
                      (A.LONG_COLOR_DESC BETWEEN                        37810099
                       :PV-LONG-COLOR-LOW AND :PV-LONG-COLOR-HIGH)      37820099
                              AND                                       37830099
                      (A.COLOR_CDE BETWEEN                              37840099
                       :PV-COLOR-LOW AND :PV-COLOR-HIGH)                37850099
                              AND                                       37860099
                      (C.KY_ITM_IND BETWEEN                             37870099
                       :PV-KYITM-LOW AND :PV-KYITM-HIGH)                37880099
                                 AND                                    37890099
                      (A.ITEM_NMBR   = B.ITEM_NBR       AND             37900099
MC0602                 A.ITEM_NMBR   = X.ITM_NBR        AND             37910099
                       B.UPC_NBR     = C.UPC_NBR        AND             37920099
                       C.UPC_TYP_CDE = 'I'              AND             37930099
                       C.RPLNMT_IND BETWEEN                             37940099
                       :PV-REPLEN-LOW AND :PV-REPLEN-HIGH AND           37950099
                       ((CURRENT DATE BETWEEN                           37960099
                         C.EFF_BEG_DTE  AND  C.EFF_END_DTE) OR          37970099
                        (CURRENT DATE > C.EFF_BEG_DTE AND               37980099
                         C.EFF_END_DTE IS NULL))))                      37990099
                                                                        38000099
           END-EXEC.                                                    38010099
                                                                        38020099
           EVALUATE TRUE                                                38030099
               WHEN SQLCODE = ZERO                                      38040099
               WHEN SQLCODE = -305                                      38050099
                    CONTINUE                                            38060099
               WHEN SQLWARN0 NOT EQUAL SPACE                            38070099
               WHEN SQLCODE  NOT EQUAL ZERO                             38080099
                    MOVE '7235-GET-SKU-COUNT-2'                         38090099
                                        TO DP013-PARAGRAPH              38100099
                    MOVE 'SELECT SKU COUNT'                             38110099
                                        TO DP013-MESSAGE-TEXT (1)       38120099
                    MOVE SQLCA          TO DP013-SQLCA                  38130099
                    SET DP013-DB2-ABEND TO TRUE                         38140099
                    PERFORM DP013-0000-PROCESS-ABEND                    38150099
           END-EVALUATE.                                                38160099
                                                                        38170099
      ******************************************************************38180099
      * OPEN THE CURSOR.                                               *38190099
      ******************************************************************38200099
       7300-OPEN-STORES-CURSOR.                                         38210099
                                                                        38220099
           EXEC SQL                                                     38230099
                OPEN STORES-CSR                                         38240099
           END-EXEC.                                                    38250099
                                                                        38260099
           EVALUATE TRUE                                                38270099
               WHEN SQLCODE = ZERO                                      38280099
                    CONTINUE                                            38290099
               WHEN SQLWARN0 NOT EQUAL SPACE                            38300099
               WHEN SQLCODE  NOT EQUAL ZERO                             38310099
                    MOVE '7300-OPEN-STORES-CSR'                         38320099
                                          TO DP013-PARAGRAPH            38330099
                    MOVE 'OPEN STORE CURSOR'                            38340099
                                          TO DP013-MESSAGE-TEXT(1)      38350099
                    MOVE SQLCA            TO DP013-SQLCA                38360099
                    SET DP013-DB2-ABEND   TO TRUE                       38370099
                    PERFORM DP013-0000-PROCESS-ABEND                    38380099
           END-EVALUATE.                                                38390099
                                                                        38400099
      ******************************************************************38410099
      *    FETCH THE TEXT CURSOR.                                      *38420099
      ******************************************************************38430099
       7310-FETCH-STORES.                                               38440099
                                                                        38450099
               EXEC SQL                                                 38460099
                    FETCH STORES-CSR                                    38470099
                    INTO  :PV-CURRENT-DATE                              38480099
                         ,:XMT00002-DC-NBR                              38490099
                         ,:XMT00001-LOC-10-ABBR-NM                      38500099
                         ,:XMT00001-LOC-NBR                             38510099
               END-EXEC                                                 38520099
                                                                        38530099
               EVALUATE TRUE                                            38540099
                   WHEN SQLCODE = ZERO                                  38550099
                        CONTINUE                                        38560099
                   WHEN SQLCODE = +100                                  38570099
                        SET ASC-NO-ITEMS-LEFT-ON-DB TO  TRUE            38580099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        38590099
                   WHEN SQLCODE  NOT EQUAL ZERO                         38600099
                        MOVE '5110-FETCH-STORES-CURSOR'                 38610099
                                             TO  DP013-PARAGRAPH        38620099
                        MOVE 'FETCH MESSAGE CURSOR'                     38630099
                                             TO  DP013-MESSAGE-TEXT (1) 38640099
                        MOVE SQLCA           TO  DP013-SQLCA            38650099
                        SET DP013-DB2-ABEND  TO  TRUE                   38660099
                        PERFORM DP013-0000-PROCESS-ABEND                38670099
               END-EVALUATE.                                            38680099
                                                                        38690099
      ******************************************************************38700099
      * CLOSE THE CURSOR.                                              *38710099
      ******************************************************************38720099
       7320-CLOSE-STORES-CURSOR.                                        38730099
                                                                        38740099
           EXEC SQL                                                     38750099
               CLOSE STORES-CSR                                         38760099
           END-EXEC.                                                    38770099
                                                                        38780099
           EVALUATE TRUE                                                38790099
               WHEN SQLCODE = ZERO                                      38800099
                    CONTINUE                                            38810099
               WHEN SQLWARN0 NOT EQUAL SPACE                            38820099
               WHEN SQLCODE  NOT EQUAL ZERO                             38830099
                    MOVE '7320-CLOSE-STORES-CURSOR'                     38840099
                                         TO  DP013-PARAGRAPH            38850099
                    MOVE 'CLOSE STORE CURSOR'                           38860099
                                         TO  DP013-MESSAGE-TEXT (1)     38870099
                    MOVE SQLCA           TO  DP013-SQLCA                38880099
                    SET DP013-DB2-ABEND  TO  TRUE                       38890099
                    PERFORM DP013-0000-PROCESS-ABEND                    38900099
           END-EVALUATE.                                                38910099
                                                                        38920099
      ******************************************************************38930099
      * OPEN THE CURSOR.                                               *38940099
      ******************************************************************38950099
       7400-OPEN-ALL-STORES-CURSOR.                                     38960099
                                                                        38970099
           EXEC SQL                                                     38980099
                OPEN STORES-CSR-ALL                                     38990099
           END-EXEC.                                                    39000099
                                                                        39010099
           EVALUATE TRUE                                                39020099
               WHEN SQLCODE = ZERO                                      39030099
                    CONTINUE                                            39040099
               WHEN SQLWARN0 NOT EQUAL SPACE                            39050099
               WHEN SQLCODE  NOT EQUAL ZERO                             39060099
                    MOVE '7400-OPEN-ALL-STORES-CSR'                     39070099
                                          TO DP013-PARAGRAPH            39080099
                    MOVE 'OPEN STORE CURSOR ALL'                        39090099
                                          TO DP013-MESSAGE-TEXT(1)      39100099
                    MOVE SQLCA            TO DP013-SQLCA                39110099
                    SET DP013-DB2-ABEND   TO TRUE                       39120099
                    PERFORM DP013-0000-PROCESS-ABEND                    39130099
           END-EVALUATE.                                                39140099
                                                                        39150099
      ******************************************************************39160099
      *    FETCH THE TEXT CURSOR.                                      *39170099
      ******************************************************************39180099
       7410-FETCH-ALL-STORES.                                           39190099
                                                                        39200099
               EXEC SQL                                                 39210099
                    FETCH STORES-CSR-ALL                                39220099
                    INTO  :PV-CURRENT-DATE                              39230099
                         ,:XMT00002-DC-NBR                              39240099
                         ,:XMT00001-LOC-10-ABBR-NM                      39250099
                         ,:XMT00001-LOC-NBR                             39260099
               END-EXEC                                                 39270099
                                                                        39280099
               EVALUATE TRUE                                            39290099
                   WHEN SQLCODE = ZERO                                  39300099
                        CONTINUE                                        39310099
                   WHEN SQLCODE = +100                                  39320099
                        SET ASC-NO-ITEMS-LEFT-ON-DB TO  TRUE            39330099
                   WHEN SQLWARN0 NOT EQUAL SPACE                        39340099
                   WHEN SQLCODE  NOT EQUAL ZERO                         39350099
                        MOVE '7410-FETCH-ALL-STORES-CURSOR'             39360099
                                             TO  DP013-PARAGRAPH        39370099
                        MOVE 'FETCH MESSAGE CURSOR'                     39380099
                                             TO  DP013-MESSAGE-TEXT (1) 39390099
                        MOVE SQLCA           TO  DP013-SQLCA            39400099
                        SET DP013-DB2-ABEND  TO  TRUE                   39410099
                        PERFORM DP013-0000-PROCESS-ABEND                39420099
               END-EVALUATE.                                            39430099
                                                                        39440099
      ******************************************************************39450099
      * CLOSE THE CURSOR.                                              *39460099
      ******************************************************************39470099
       7420-CLOSE-ALL-STORES-CURSOR.                                    39480099
                                                                        39490099
           EXEC SQL                                                     39500099
               CLOSE STORES-CSR-ALL                                     39510099
           END-EXEC.                                                    39520099
                                                                        39530099
           EVALUATE TRUE                                                39540099
               WHEN SQLCODE = ZERO                                      39550099
                    CONTINUE                                            39560099
               WHEN SQLWARN0 NOT EQUAL SPACE                            39570099
               WHEN SQLCODE  NOT EQUAL ZERO                             39580099
                    MOVE '7420-CLOSE-ALL-STORES-CURSOR'                 39590099
                                         TO  DP013-PARAGRAPH            39600099
                    MOVE 'CLOSE ALL STORE CURSOR'                       39610099
                                         TO  DP013-MESSAGE-TEXT (1)     39620099
                    MOVE SQLCA           TO  DP013-SQLCA                39630099
                    SET DP013-DB2-ABEND  TO  TRUE                       39640099
                    PERFORM DP013-0000-PROCESS-ABEND                    39650099
           END-EVALUATE.                                                39660099
                                                                        39670099
      ******************************************************************39680099
      *  READ TEMP STORAGE QUEUE                                        39690099
      ******************************************************************39700099
       9000-READ-TS-QUEUE.                                              39710099
           MOVE '*9000-READ-TS-QUEUE.             *' TO DP013-PARAGRAPH 39720099
                                                                        39730099
           IF DP020-NEXT-ACT-INITIAL                                    39740099
               MOVE +1 TO ASC-TS-ITEM-NMBR                              39750099
                          ASC-FS002-IDX.                                39760099
                                                                        39770099
           EXEC CICS                                                    39780099
                READQ TS                                                39790099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          39800099
                    INTO  (FS002-TS-SEL-REC)                            39810099
                    ITEM  (ASC-TS-ITEM-NMBR)                            39820099
                    RESP  (PV-CICS-RESP)                                39830099
           END-EXEC.                                                    39840099
                                                                        39850099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39860099
               CONTINUE                                                 39870099
           ELSE                                                         39880099
               IF PV-CICS-RESP = DFHRESP (ITEMERR)                      39890099
                   MOVE PC-TSYMSG-00113         TO DP020-MSG-NUMBER     39900099
                   SET PS-ERROR                 TO TRUE                 39910099
                   SET DP020-MSG-WARNING        TO TRUE                 39920099
                   SET DP030-SET-CURSOR-TRAILER TO TRUE                 39930099
               ELSE                                                     39940099
                   SET DP013-CICS-ABEND         TO TRUE                 39950099
                   SET DP013-NO-ROLLBACK        TO TRUE                 39960099
                   MOVE '9000-READ-TS-QUEUE'    TO DP013-PARAGRAPH      39970099
                   MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'       39980099
                                               TO DP013-MESSAGE-TEXT(1) 39990099
                   PERFORM DP013-0000-PROCESS-ABEND                     40000099
               END-IF                                                   40010099
           END-IF.                                                      40020099
                                                                        40030099
      ******************************************************************40040099
      *  REWRITE TEMP STORAGE QUEUE                                     40050099
      ******************************************************************40060099
       9100-REWRITE-TS-QUEUE.                                           40070099
           MOVE '*9100-REWRITE-TS-QUEUE.          *' TO DP013-PARAGRAPH 40080099
                                                                        40090099
           EXEC CICS                                                    40100099
                WRITEQ TS                                               40110099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          40120099
                    FROM  (FS002-TS-SEL-REC)                            40130099
                    ITEM  (ASC-TS-ITEM-NMBR)                            40140099
                    RESP  (PV-CICS-RESP)                                40150099
                    REWRITE                                             40160099
           END-EXEC.                                                    40170099
                                                                        40180099
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      40190099
               SET DP013-CICS-ABEND         TO TRUE                     40200099
               SET DP013-NO-ROLLBACK        TO TRUE                     40210099
               MOVE '9100-REWRITE-TS-QUEUE' TO DP013-PARAGRAPH          40220099
               MOVE 'ATTEMPTING TO REWRITE SELECTED ITEMS QUEUE'        40230099
                                            TO DP013-MESSAGE-TEXT(1)    40240099
               MOVE 'TO SIGNIFY THAT THE SKU HAS BEEN VIEWED   '        40250099
                                            TO DP013-MESSAGE-TEXT(2)    40260099
               PERFORM DP013-0000-PROCESS-ABEND                         40270099
           END-IF.                                                      40280099
                                                                        40290099
      ******************************************************************40300099
      *    ABEND PROCESSOR MODULE                                      *40310099
      ******************************************************************40320099
                                                                        40330099
           COPY DPPD013.                                                40340099
