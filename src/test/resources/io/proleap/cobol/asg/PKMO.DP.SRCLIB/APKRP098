000100*------------------------*                                        00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*------------------------*                                        00030000
000400 PROGRAM-ID.     APKRP098.                                        00040000
000500 AUTHOR.         KEVIN CATLIN.                                    00050000
000600 DATE-WRITTEN.   JUNE, 2003.                                      00060000
000700*---------------------------------------------------------------* 00070000
000800*                    EDI 210 SURCHARGE REPORT                   * 00080001
000900*---------------------------------------------------------------* 00090000
001000*                            COBOL 2                            * 00100001
001100*---------------------------------------------------------------* 00110000
001200*                                                               * 00120000
001300*    THE PURPOSE OF THIS PROGRAM IS TO CREATE A REPORT THAT     * 00130000
001400*    WILL SHOW EDI 210 INVOICES THAT HAVE FUEL SURCHARGES ON    * 00140009
001500*    THEM.  THIS WILL BE USED AS A MANAGEMENT TOOL TO MONITOR   * 00150009
001600*    FUEL SURCHARGE ACTIVITY.                                   * 00160009
001700*                                                               * 00170000
001800*---------------------------------------------------------------* 00180000
001900* INPUT:                                    COPYBOOK:           * 00190000
002000*  1. FUEL SURCHARGE FILE.                  APRD079             * 00200000
002100*                                                               * 00210000
002200* OUTPUT:                                                       * 00220000
002300*  1. EDI 210 SURCHARGE REPORT.             APKRP098-1          * 00230000
002400*                                                               * 00240000
002500*---------------------------------------------------------------* 00250000
002600* CHANGE LOG:                                                   * 00260000
002700*   DATE  __/__/____                                            * 00270000
002800*       CHANGE MADE: _________________________________________  * 00280000
002900*       ______________________________________________________  * 00290000
003000*       MADE BY: _______________________ WR/IR #: _________     * 00300000
003100*                                                               * 00310000
003200*   DATE  07/31/2003                                            * 00320032
003300*       CHANGE MADE: INITIAL VERSION.                           * 00330000
003400*       MADE BY: KEVIN CATLIN            WR/IR #: WR24933       * 00340028
003500*                                                               * 00350000
003600*---------------------------------------------------------------* 00360000
003700                                                                  00370000
003800*---------------------*                                           00380000
003900 ENVIRONMENT DIVISION.                                            00390000
004000*---------------------*                                           00400000
004100 CONFIGURATION SECTION.                                           00410000
004200 SOURCE-COMPUTER.    IBM-3090.                                    00420000
004300 OBJECT-COMPUTER.    IBM-3090.                                    00430000
004400                                                                  00440000
004500 INPUT-OUTPUT SECTION.                                            00450000
004600 FILE-CONTROL.                                                    00460000
004700                                                                  00470000
004800     SELECT FUEL-SURCHG-FILE       ASSIGN TO INP01.               00480000
004900     SELECT SURCHG-REPORT-FILE     ASSIGN TO RPT01.               00490000
005000                                                                  00500000
005100*--------------*                                                  00510000
005200 DATA DIVISION.                                                   00520000
005300*--------------*                                                  00530000
005400 FILE SECTION.                                                    00540000
005500                                                                  00550000
005600 FD  FUEL-SURCHG-FILE                                             00560000
005700     RECORDING MODE IS F                                          00570000
005800     LABEL RECORDS ARE STANDARD                                   00580000
005900     BLOCK CONTAINS 0 RECORDS                                     00590000
006000     DATA RECORD IS FUEL-SURCHG-REC.                              00600000
006100 01  FUEL-SURCHG-REC             PIC  X(270).                     00610013
006200                                                                  00620000
006300 FD  SURCHG-REPORT-FILE                                           00630000
006400     RECORDING MODE IS F                                          00640000
006500     LABEL RECORDS ARE STANDARD                                   00650000
006600     BLOCK CONTAINS 0 RECORDS                                     00660000
006700     DATA RECORD IS REPORT-REC.                                   00670004
006800 01  REPORT-REC                  PIC  X(150).                     00680009
006900                                                                  00690000
007000 EJECT.                                                           00700007
007100                                                                  00710000
007200 WORKING-STORAGE SECTION.                                         00720000
007300                                                                  00730000
007400 01  PROGRAM-CONSTANTS.                                           00740000
007500     05  FILLER                  PIC  X(31)  VALUE                00750015
007600         '** BEGINNING OF APKRP098 W/S **'.                       00760014
007700     05  PC-PROGRAM-NAME         PIC  X(08)   VALUE 'APKRP098'.   00770002
007800                                                                  00780000
007900 01  PV-PROCESS-COUNTERS.                                         00790002
008000     05  PV-FILE-REC-COUNT       PIC  9(07)   VALUE ZEROS.        00800006
008100     05  PV-SURCHG-RPT-OUT       PIC  9(07)   VALUE ZEROS.        00810006
008200                                                                  00820000
008300 01  PV-REPORT-CONTROLS.                                          00830002
008400     05  PAGE-COUNT              PIC S9(05) COMP-3 VALUE +0.      00840004
008500     05  LINE-COUNT              PIC S9(03) COMP-3 VALUE +0.      00850004
008600     05  MAX-LINES               PIC S9(03) COMP-3 VALUE +65.     00860007
008700                                                                  00870002
008800 01  PROGRAM-SWITCHES.                                            00880000
008900     05  PS-END-OF-FILE          PIC  X       VALUE 'N'.          00890002
009000         88  NOT-END-OF-FILE                  VALUE 'N'.          00900002
009100         88  END-OF-FILE                      VALUE 'Y'.          00910002
009200                                                                  00920000
009300 01  PROGRAM-VARIABLES.                                           00930000
009400     05  PV-TOTAL-MISC-CHG       PIC S9(07)V99 COMP-3 VALUE +0.   00940010
009500     05  PV-SYSTEM-DATE          PIC X(08)  VALUE ZERO.           00950010
009600     05  FILLER REDEFINES PV-SYSTEM-DATE.                         00960004
009700         10  PV-SYSTEM-CCYY.                                      00970004
009800             15  PV-SYSTEM-CENTURY   PIC  X(02).                  00980004
009900             15  PV-SYSTEM-YEAR      PIC  X(02).                  00990004
010000         10  PV-SYSTEM-MONTH         PIC  X(02).                  01000004
010100         10  PV-SYSTEM-DAY           PIC  X(02).                  01010004
010200     05  PV-SYSTEM-TIME.                                          01020004
010300         10  PV-SYSTEM-HOUR          PIC  9(02)  VALUE ZERO.      01030004
010400         10  PV-SYSTEM-MINUTE        PIC  9(02)  VALUE ZERO.      01040004
010500         10  PV-SYSTEM-SECOND        PIC  9(02)  VALUE ZERO.      01050004
010600         10  FILLER                  PIC  9(02)  VALUE ZERO.      01060004
010700                                                                  01070000
010800 EJECT                                                            01080000
010900*----------------------------------------------------------------*01090000
011000*  STANDARD HEADER LAYOUT                                        *01100000
011100*----------------------------------------------------------------*01110000
011200     COPY DPWS150.                                                01120011
011300                                                                  01130000
011400 01  BLANK-LINE                  PIC X(150) VALUE SPACES.         01140009
011500                                                                  01150003
011600 01  HDR-TITLE-1.                                                 01160003
011700     05  FILLER                  PIC  X(63) VALUE SPACE.          01170009
011800     05  FILLER                  PIC  X(24) VALUE                 01180003
011900          'EDI 210 SURCHARGE REPORT'.                             01190003
012000     05  FILLER                  PIC  X(63) VALUE SPACE.          01200009
012100                                                                  01210003
012200 01  HEADER-1.                                                    01220003
012300     05  FILLER                PIC X(11) VALUE 'PICKUP DATE'.     01230009
012400     05  FILLER                PIC X(02) VALUE SPACES.            01240009
012500     05  FILLER                PIC X(12) VALUE 'CONTAINER ID'.    01250019
012600     05  FILLER                PIC X(02) VALUE SPACES.            01260009
012700     05  FILLER                PIC X(10) VALUE 'VENDOR NBR'.      01270009
012800     05  FILLER                PIC X(02) VALUE SPACES.            01280009
012900     05  FILLER                PIC X(11) VALUE 'VENDOR NAME'.     01290009
013000     05  FILLER                PIC X(07) VALUE SPACES.            01300030
013100     05  FILLER                PIC X(09) VALUE 'PO NUMBER'.       01310009
013200     05  FILLER                PIC X(02) VALUE SPACES.            01320009
013300     05  FILLER                PIC X(14) VALUE 'INVOICE NUMBER'.  01330009
013400     05  FILLER                PIC X(05) VALUE SPACES.            01340016
013500     05  FILLER                PIC X(10) VALUE 'DECON SCAC'.      01350020
013600     05  FILLER                PIC X(02) VALUE SPACES.            01360016
013700     05  FILLER                PIC X(11) VALUE 'DRAYAGE AMT'.     01370020
013800     05  FILLER                PIC X(02) VALUE SPACES.            01380020
013900     05  FILLER                PIC X(14) VALUE 'FUEL SURCHARGE'.  01390009
014000     05  FILLER                PIC X(02) VALUE SPACES.            01400009
014100     05  FILLER                PIC X(12) VALUE 'MISC CHARGES'.    01410009
014200     05  FILLER                PIC X(02) VALUE SPACES.            01420030
014300     05  FILLER                PIC X(08) VALUE 'PEND RVW'.        01430030
014400                                                                  01440003
014500 01  HEADER-2.                                                    01450003
014600     05  FILLER                PIC X(11) VALUE ALL '-'.           01460009
014700     05  FILLER                PIC X(02) VALUE SPACES.            01470009
014800     05  FILLER                PIC X(12) VALUE ALL '-'.           01480019
014900     05  FILLER                PIC X(02) VALUE SPACES.            01490003
015000     05  FILLER                PIC X(10) VALUE ALL '-'.           01500009
015100     05  FILLER                PIC X(02) VALUE SPACES.            01510009
015200     05  FILLER                PIC X(11) VALUE ALL '-'.           01520009
015300     05  FILLER                PIC X(07) VALUE SPACES.            01530030
015400     05  FILLER                PIC X(09) VALUE ALL '-'.           01540009
015500     05  FILLER                PIC X(02) VALUE SPACES.            01550009
015600     05  FILLER                PIC X(14) VALUE ALL '-'.           01560009
015700     05  FILLER                PIC X(05) VALUE SPACES.            01570016
015800     05  FILLER                PIC X(10) VALUE ALL '-'.           01580020
015900     05  FILLER                PIC X(02) VALUE SPACES.            01590016
016000     05  FILLER                PIC X(11) VALUE ALL '-'.           01600020
016100     05  FILLER                PIC X(02) VALUE SPACES.            01610020
016200     05  FILLER                PIC X(14) VALUE ALL '-'.           01620009
016300     05  FILLER                PIC X(02) VALUE SPACES.            01630009
016400     05  FILLER                PIC X(12) VALUE ALL '-'.           01640009
016500     05  FILLER                PIC X(02) VALUE SPACES.            01650030
016600     05  FILLER                PIC X(08) VALUE ALL '-'.           01660030
016700                                                                  01670003
016800 01  DETAIL-1.                                                    01680003
016900     05  DTL-PICKUP-DTE        PIC X(10).                         01690009
017000     05  FILLER                PIC X(03) VALUE SPACES.            01700003
017100     05  DTL-CONTNR-NBR        PIC X(12).                         01710009
017200     05  FILLER                PIC X(02) VALUE SPACES.            01720019
017300     05  DTL-VENDOR-NBR        PIC X(09).                         01730009
017400     05  FILLER                PIC X(03) VALUE SPACES.            01740009
017500     05  DTL-VENDOR-NAME       PIC X(16).                         01750030
017600     05  FILLER                PIC X(02) VALUE SPACES.            01760009
017700     05  DTL-PO-NBR            PIC ZZZZZZZZZ.                     01770026
017800     05  FILLER                PIC X(02) VALUE SPACES.            01780009
017900     05  DTL-INVOICE-NBR       PIC X(16).                         01790009
018000     05  FILLER                PIC X(06) VALUE SPACES.            01800022
018100     05  DTL-DECON-SCAC-ID     PIC X(04).                         01810020
018200     05  FILLER                PIC X(05) VALUE SPACES.            01820027
018300     05  DTL-DRAYAGE-AMT       PIC -------9.99.                   01830027
018400     05  FILLER                PIC X(05) VALUE SPACES.            01840018
018500     05  DTL-FUEL-SURCHG       PIC -------9.99.                   01850009
018600     05  FILLER                PIC X(03) VALUE SPACES.            01860018
018700     05  DTL-MISC-CHG          PIC -------9.99.                   01870009
018800     05  FILLER                PIC X(05) VALUE SPACES.            01880030
018900     05  DTL-PEND-RVW          PIC X(01).                         01890030
019000     05  FILLER                PIC X(04) VALUE SPACES.            01900030
019100                                                                  01910003
019200 01  END-OF-REPORT.                                               01920002
019300     05  FILLER                  PIC  X(59)     VALUE SPACES.     01930009
019400     05  FILLER                  PIC  X(33)     VALUE             01940002
019500         '***  E N D  O F  R E P O R T  ***'.                     01950002
019600     05  FILLER                  PIC  X(58)     VALUE SPACES.     01960009
019700                                                                  01970002
019800 01  NO-DATA-TO-REPORT.                                           01980012
019900     05  FILLER                  PIC  X(52)     VALUE SPACES.     01990009
020000     05  FILLER                  PIC  X(46)     VALUE             02000003
020100         '*** NO EDI 210 SURCHARGE DATA TO REPORT ON ***'.        02010003
020200     05  FILLER                  PIC  X(52)     VALUE SPACES.     02020009
020300                                                                  02030003
020400 01  FILLER                      PIC  X(25)     VALUE             02040002
020500     '** END OF APKRP098 W/S **'.                                 02050002
020600                                                                  02060002
020700 EJECT                                                            02070017
020800*----------------------------------------------------------------*02080000
020900*    COPYBOOK FOR FUEL SURCHARGE REPORT FILE                      02090000
021000*----------------------------------------------------------------*02100000
021100     COPY APRD079.                                                02110000
021200                                                                  02120000
021300*-------------------*                                             02130000
021400 PROCEDURE DIVISION.                                              02140000
021500*-------------------*                                             02150000
021600 A100-MAINLINE.                                                   02160000
021700                                                                  02170000
021800     PERFORM B100-INITIALIZE.                                     02180000
021900                                                                  02190000
022000     PERFORM B200-CREATE-REPORT                                   02200005
022100         UNTIL END-OF-FILE.                                       02210001
022200                                                                  02220000
022300     PERFORM B300-END-OF-PROGRAM.                                 02230000
022400                                                                  02240000
022500     GOBACK.                                                      02250000
022600                                                                  02260000
022700                                                                  02270000
022800*----------------------------------------------------------------*02280000
022900*    INITIALIZATION PROCESSING                                   *02290000
023000*    - OPEN FILES.                                               *02300029
023100*    - FORMAT PAGE HEADINGS.                                     *02310030
023200*    - READ AND PROCESS INPUT FILE.                              *02320030
023300*----------------------------------------------------------------*02330030
023400 B100-INITIALIZE.                                                 02340030
023500                                                                  02350030
023600     DISPLAY '**------  APKRP098  (PROCESSING MSGS)  ------**'.   02360030
023700                                                                  02370030
023800     OPEN INPUT  FUEL-SURCHG-FILE                                 02380030
023900          OUTPUT SURCHG-REPORT-FILE.                              02390030
024000                                                                  02400030
024100     MOVE FUNCTION CURRENT-DATE       TO PV-SYSTEM-DATE.          02410030
024200     MOVE PV-SYSTEM-MONTH             TO DP150-RUN-MONTH.         02420030
024300     MOVE PV-SYSTEM-DAY               TO DP150-RUN-DAY.           02430030
024400     MOVE PV-SYSTEM-YEAR              TO DP150-RUN-YEAR.          02440030
024500                                                                  02450030
024600     ACCEPT PV-SYSTEM-TIME            FROM TIME.                  02460030
024700     MOVE PV-SYSTEM-HOUR              TO DP150-RUN-HOUR.          02470030
024800     MOVE PV-SYSTEM-MINUTE            TO DP150-RUN-MINUTE.        02480030
024900     MOVE PC-PROGRAM-NAME             TO DP150-PROGRAM-NAME.      02490030
025000     MOVE 1                           TO DP150-REPORT-NUMBER.     02500030
025100                                                                  02510030
025200     PERFORM W100-WRITE-HEADINGS.                                 02520030
025300                                                                  02530030
025400     PERFORM R100-READ-FILE.                                      02540030
025500                                                                  02550030
025600     IF END-OF-FILE                                               02560030
025700        DISPLAY '!!! EMPTY FUEL SURCHARGE FILE !!!'               02570030
025800        WRITE REPORT-REC FROM NO-DATA-TO-REPORT                   02580030
025900                   AFTER ADVANCING 2 LINES                        02590030
026000     END-IF.                                                      02600030
026100                                                                  02610030
026200                                                                  02620030
026300*--------------------------------------------------------------*  02630030
026400*  THIS ROUTINE HOLDS THE MAIN LOGIC FOR REPORT CREATION.      *  02640030
026500*--------------------------------------------------------------*  02650030
026600 B200-CREATE-REPORT.                                              02660030
026700                                                                  02670030
026800     MOVE AP079-CONTNR-PU-DTE        TO DTL-PICKUP-DTE.           02680030
026900     MOVE AP079-CONTAINER-ID         TO DTL-CONTNR-NBR.           02690030
027000     MOVE AP079-VENDOR-NBR           TO DTL-VENDOR-NBR.           02700030
027100     MOVE AP079-VENDOR-NAME          TO DTL-VENDOR-NAME.          02710030
027200     MOVE AP079-PO-NBR               TO DTL-PO-NBR.               02720030
027300     MOVE AP079-INVOICE-NBR          TO DTL-INVOICE-NBR.          02730030
027400     MOVE AP079-DECON-SCAC-ID        TO DTL-DECON-SCAC-ID.        02740030
027500     MOVE AP079-PEND-RVW             TO DTL-PEND-RVW.             02750030
027600                                                                  02760030
027700     PERFORM VARYING AP079-IDX FROM 1 BY 1                        02770030
027800       UNTIL (AP079-IDX > 20)                                     02780030
027900          OR (AP079-CHARGE-CDE(AP079-IDX) = SPACES)               02790030
028000              IF AP079-CHARGE-CDE(AP079-IDX) = '405'              02800030
028100                 MOVE AP079-CHARGE-AMT(AP079-IDX)                 02810030
028200                                    TO DTL-FUEL-SURCHG            02820030
028300              ELSE                                                02830030
028400                 IF AP079-CHARGE-CDE(AP079-IDX) = 'DRA'           02840030
028500                    MOVE AP079-CHARGE-AMT(AP079-IDX)              02850030
028600                                    TO DTL-DRAYAGE-AMT            02860030
028700                 ELSE                                             02870030
028800                    IF AP079-CHARGE-CDE(AP079-IDX) = 'MIS' OR     02880030
028900                       AP079-CHARGE-CDE(AP079-IDX) = '690'        02890030
029000                        ADD AP079-CHARGE-AMT(AP079-IDX)           02900030
029100                                          TO PV-TOTAL-MISC-CHG    02910030
029200                    END-IF                                        02920030
029300                 END-IF                                           02930030
029400              END-IF                                              02940030
029500     END-PERFORM.                                                 02950030
029600                                                                  02960030
029700     MOVE PV-TOTAL-MISC-CHG  TO  DTL-MISC-CHG.                    02970030
029800                                                                  02980030
029900     PERFORM W200-WRITE-DETAIL.                                   02990030
030000                                                                  03000030
030100     INITIALIZE PV-TOTAL-MISC-CHG.                                03010030
030200                                                                  03020030
030300     PERFORM R100-READ-FILE.                                      03030030
030400                                                                  03040030
030500                                                                  03050030
030600*----------------------------------------------------------------*03060030
030700*    END OF PROGRAM                                              *03070030
030800*    - PROCESS THE REPORT SUMMARY LINE.                          *03080030
030900*    - CLOSE THE FILES.                                          *03090030
031000*----------------------------------------------------------------*03100030
031100 B300-END-OF-PROGRAM.                                             03110030
031200                                                                  03120030
031300     IF LINE-COUNT > MAX-LINES                                    03130030
031400        CONTINUE                                                  03140030
031500     ELSE                                                         03150030
031600        WRITE REPORT-REC FROM END-OF-REPORT                       03160030
031700        AFTER ADVANCING 2 LINES                                   03170030
031800     END-IF.                                                      03180030
031900                                                                  03190030
032000     DISPLAY '*************************************************'. 03200030
032100     DISPLAY '*************************************************'. 03210030
032200     DISPLAY '** TOTAL RECORDS READ    = ' PV-FILE-REC-COUNT.     03220030
032300     DISPLAY '*************************************************'. 03230030
032400     DISPLAY '** TOTAL RECORDS WRITTEN = ' PV-SURCHG-RPT-OUT.     03240030
032500     DISPLAY '*************************************************'. 03250030
032600     DISPLAY '**         END OF APKRP098 PROCESSING          **'. 03260030
032700     DISPLAY '*************************************************'. 03270030
032800     DISPLAY ' '                                                  03280030
032900                                                                  03290030
033000     CLOSE FUEL-SURCHG-FILE                                       03300030
033100           SURCHG-REPORT-FILE.                                    03310030
033200                                                                  03320030
033300                                                                  03330030
033400*----------------------------------------------------------------*03340030
033500*    READ FUEL SURCHARGE FILE INTO COPYBOOK.                     *03350030
033600*----------------------------------------------------------------*03360030
033700 R100-READ-FILE.                                                  03370030
033800                                                                  03380030
033900     READ FUEL-SURCHG-FILE  INTO  AP079-SURCHG-RPT-RECORD         03390030
034000         AT END                                                   03400030
034100             SET END-OF-FILE TO TRUE                              03410030
034200         NOT AT END                                               03420030
034300             ADD +1 TO PV-FILE-REC-COUNT.                         03430030
034400                                                                  03440030
034500                                                                  03450030
034600*----------------------------------------------------------------*03460030
034700*    WRITE PAGE HEADING LINES.                                   *03470030
034800*----------------------------------------------------------------*03480030
034900 W100-WRITE-HEADINGS.                                             03490030
035000                                                                  03500030
035100     ADD 1 TO PAGE-COUNT.                                         03510030
035200     MOVE PAGE-COUNT TO DP150-PAGE-NUMBER.                        03520030
035300                                                                  03530030
035400     WRITE REPORT-REC FROM DP150-STANDRD-HEADER-150-COLS          03540030
035500         AFTER ADVANCING PAGE.                                    03550030
035600     WRITE REPORT-REC FROM HDR-TITLE-1                            03560030
035700         AFTER ADVANCING 1 LINE.                                  03570030
035800     WRITE REPORT-REC FROM HEADER-1                               03580030
035900         AFTER ADVANCING 2 LINES.                                 03590030
036000     WRITE REPORT-REC FROM HEADER-2                               03600030
036100         AFTER ADVANCING 1 LINE.                                  03610030
036200     WRITE REPORT-REC FROM BLANK-LINE                             03620030
036300         AFTER ADVANCING 1 LINE.                                  03630030
036400                                                                  03640030
036500     MOVE +7            TO LINE-COUNT.                            03650030
036600                                                                  03660030
036700*--------------------------------------------------------------*  03670030
036800*  THIS ROUTINE WRITES THE REPORT DETAIL LINES                 *  03680030
036900*--------------------------------------------------------------*  03690030
037000 W200-WRITE-DETAIL.                                               03700030
037100                                                                  03710030
037200     IF LINE-COUNT >= MAX-LINES                                   03720030
037300        PERFORM W100-WRITE-HEADINGS                               03730030
037400     END-IF.                                                      03740030
037500                                                                  03750030
037600     WRITE REPORT-REC FROM DETAIL-1                               03760030
037700           AFTER ADVANCING 2 LINES.                               03770030
037800                                                                  03780030
037900     ADD 2 TO LINE-COUNT                                          03790030
038000              PV-SURCHG-RPT-OUT.                                  03800030
038100                                                                  03810030
038200     INITIALIZE DETAIL-1.                                         03820030
038300                                                                  03830030
038400                                                                  03840030
