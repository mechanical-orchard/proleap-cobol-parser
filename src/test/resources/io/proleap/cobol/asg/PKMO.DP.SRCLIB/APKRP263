000100 IDENTIFICATION DIVISION.                                         00010024
000200 PROGRAM-ID.     APKRP263.                                        00020024
000300 AUTHOR.         P.THOMPSON, G&R.                                 00030024
000400 DATE-WRITTEN.   07/01/1994.                                      00040024
000500 DATE-COMPILED.                                                   00050024
000600*************************************************************     00060024
000700*    COBOL 2                                                *     00070024
000800*                                                           *     00080024
000900*    RECONCILIATION RESULTS REPORT                          *     00090025
001000*                                                           *     00100025
001100*   PROGRAM OVERVIEW:                                       *     00110024
001200*                                                           *     00120024
001300*     THIS PROGRAM CREATES THE INVOICE RECONCILATION        *     00130024
001400*   NOTICE REPORT FROM A FLAT FILE.                         *     00140024
001500*                                                           *     00150024
001600*   INPUT:                                                  *     00160024
001700*                                                           *     00170024
001800*  1) RESULTS-INVOICE-FILE          (APRD263)               *     00180025
001900*                                                           *     00190024
002000*   OUTPUT:                                                 *     00200024
002100*                                                           *     00210024
002200*  1) RECON-REPORT-FILE             (DPWS133O)              *     00220025
002300*  2) ERROR-FILE                    (DPWS133O)              *     00230025
002400*                                                           *     00240024
002500*************************************************************     00250024
002600*   CHANGES:                                                *     00260024
002700*                                                           *     00270024
002800*   09/30/94   ENABLED RECEIVING SEQ WITH SAME NUMBER TO    *     00280024
002900*   DCV        BE ADDED.  INITIALIZED PW-PREV-SEQ-NO.       *     00290024
003000*                                                           *     00300024
003100*   09/29/94   CHANGED HEADING TOTALS ON THE MANUAL AND EDI *     00310024
003200*   DCV        SUMMARY REPORTS.  ADDED TOTALS FOR REMAINDER *     00320024
003300*              INVOICE ADDITIONS (TRANS 12)                 *     00330024
003400*                                                           *     00340024
003500*   12/27/94   CHANGED RECEIVER TABLE OCCURRENCES TO 500    *     00350024
003600*   MKK        AND ADDED ABEND LOGIC IF TABLE OVERFLOWS.    *     00360024
003700*                                                           *     00370024
003800*   09/18/95   AUTO RECONCILIATION PHASE 1 CHANGE (WR#3257).*     00380024
003900*   PJK        CHANGED TO ADD A RECONCILIATION SOURCE NAME  *     00390024
004000*              TO THE PO LINE OF THE RECONCILIATION RESULTS *     00400024
004100*              REPORT AND TO ADD THE RECONCILIATION SOURCE  *     00410024
004200*              NAME TO THE DETAIL LINES OF THE              *     00420024
004300*              RECONCILIATION RESULTS ERROR REPORT.         *     00430024
004400*                                                           *     00440024
004500*   04/25/96   POST INVENTORY CHANGES  PART VIII  (P160013).*     00450024
004600*   HGM        CHANGE THE DAILY RECONCILIATION RESULTS FILE *     00460024
004700*              LAYOUT AND ADD TOTALS TO THE DAILY REPORT.   *     00470024
004800*              SOME OF THE FILE LAYOUT CHANGES ARE INTENDED *     00480024
004900*              FOR A NEW MONTHLY REPORT TO BE GENERATED FOR *     00490024
005000*              THE BUYING AREA.                             *     00500024
005100*                                                           *     00510024
005200*   02/13/97   INCREASED NUMBER OF ENTRIES IN THE RECEIVING *     00520024
005300*   NAE & MW   TABLE TO 999 AND ADDED A DISPLAY OF THE PO   *     00530024
005400*              NUMBER TO THE ABEND FOR TABLE OVERFLOWS.     *     00540024
005500*                                                           *     00550024
005600*   09/02/97   INCREASED NUMBER OF ENTRIES IN THE INVOICE   *     00560024
005700*   NAE & MB   TABLE TO 999 AND ADDED A DISPLAY OF THE PO   *     00570024
005800*              NUMBER TO THE ABEND FOR TABLE OVERFLOWS.     *     00580024
005900*              (P110175)                                    *     00590024
006000*                                                           *     00600024
006100*   04/29/98   INCREASED NUMBER OF ENTRIES IN THE RT-       *     00610024
006200*   M BESKE    RECEIVER-TABLE TO 6000 TEMPORARILY.          *     00620024
006300*              (P183595)                                    *     00630024
006400*                                                           *     00640024
006500*   05/25/98   RETURNED THE NUMBER OF ENTRIES FOR RT-       *     00650024
006600*   M BESKE    RECEIVER-TABLE BACK TO 999.                  *     00660024
006700*              (P183595)                                    *     00670024
006800*                                                           *     00680024
006900*   09/10/98   INCREASED NUMBER OF ENTRIES IN THE RT-       *     00690024
007000*   R BERNOSKI RECEIVER-TABLE TO 3000 TEMPORARILY.          *     00700024
007100*              (WR 5587)                                    *     00710024
007200*                                                           *     00720024
007300*   09/16/98   RETURNED THE NUMBER OF ENTRIES FOR RT-       *     00730024
007400*   R BERNOSKI RECEIVER-TABLE BACK TO 999.                  *     00740024
007500*              (WR 5587)                                    *     00750024
007600*                                                           *     00760024
007700*   05/06/99   INCREASED NUMBER OF ENTRIES IN THE RT-       *     00770024
007800*   C GIFFORD  RECEIVER-TABLE TO 3000 TEMPORARILY.          *     00780024
007900*              (WR 5587)                                    *     00790024
008000*                                                           *     00800024
008100*   05/10/99   RETURNED NUMBER OF ENTRIES IN THE RT-        *     00810024
008200*   C GIFFORD  RECEIVER-TABLE BACK TO 999.                  *     00820024
008300*              (WR 5587)                                    *     00830024
008400*                                                           *     00840024
008500*   05/12/99   INCREASED NUMBER OF ENTRIES IN THE RT-       *     00850024
008600*   C GIFFORD  RECEIVER-TABLE TO 3000 TEMPORARILY.          *     00860024
008700*              (WR 5587)                                    *     00870024
008800*                                                           *     00880024
008900*   05/17/99   RETURNED NUMBER OF ENTRIES IN THE RT-        *     00890024
009000*   C GIFFORD  RECEIVER-TABLE BACK TO 999.                  *     00900024
009100*              (WR 5587)                                    *     00910024
009200*                                                           *     00920024
009300*   06/21/99   INCREASED NUMBER OF ENTRIES IN THE RT-       *     00930024
009400*   M BESKE    RECEIVER-TABLE TO 2000 TEMPORARILY.          *     00940024
009500*              (WR 5587)                                    *     00950024
009600*                                                           *     00960024
009700*   06/22/99   RETURNED THE NUMBER OF ENTRIES FOR RT-       *     00970024
009800*   M BESKE    RECEIVER-TABLE BACK TO 999.                  *     00980024
009900*              (WR 5587)                                    *     00990024
010000*                                                           *     01000024
010100*   01/28/99   PEOPLESOFT CONVERSION.  INCREASED THE SIZE OF*     01010024
010200*   M BESKE    AP263-DOC-NO AND AP263-REFERENCE-NBR AND ANY *     01020024
010300*              OTHER FIELDS INVOLVED WITH THESE TWO.  THE   *     01030024
010400*              DATE PARTITION OF THE REFERENCE-NBR IS NOW   *     01040024
010500*              YYMMDD NOT JULIAN.  THE DOC-NO IS NOW 16 NOT *     01050024
010600*              10 IN ORDER TO MATCH PEOPLESOFT.             *     01060024
010700*              (WR ????)                                    *     01070024
010800*                                                           *     01080024
010900*   07/15/99   CHANGED THE TABLE PERCENT, IT-TERMS-PCT,     *     01090024
011000*   JILL JUEL  FIELD TO BE A DECIMAL INSTEAD OF A WHOLE     *     01100024
011100*              NUMBER AND THEN MULITPLIED IT BY 100 SO THAT *     01110024
011200*              SO THAT IT WILL STILL BE A WHOLE NUMBER ON   *     01120024
011300*              THE REPORT.  THIS WAS DONE BECAUSE THE       *     01130024
011400*              AP263-TERMS-PCT IN APRD263 WAS CHANGED TO    *     01140024
011500*              BE A PERCENT FROM A WHOLE NUMBER.            *     01150024
011600*              (WR 5998)                                    *     01160024
011700*                                                           *     01170024
011800*   12/23/99                                                *     01180024
011900*     INCREASED THE NUMBER OF ENTRIES FOR RT-RECEIVE        *     01190024
012000*     TABLE TO 9000.  THEN RETURNED THE NUMBER OF           *     01200024
012100*     ENTRIES FOR RT-RECEIVER-TABLE BACK TO 999.            *     01210024
012200*      MADE BY:  MARK BURNSIDE          PITS : 334748       *     01220024
012300*                                                           *     01230024
012400*   12/13/00                                                *     01240024
012500*     INCREASED THE NUMBER OF ENTRIES FOR IT-INVOICE        *     01250024
012600*     TABLE TO 2000 FROM 999.                               *     01260024
012700*      MADE BY:  ROBIN BERNOSKI         PITS : 20704        *     01270024
012800*                                                           *     01280024
012900* 02/05/2003                                                *     01290025
013000*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     01300025
013100*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.     *     01310025
013200*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK.   *     01320025
013300*    UPDATED THE VARIOUS W/S AND PRINT PO NUMBER FIELDS TO  *     01330025
013400*    SIMILAR FIELD NAMES (IE, -PO-NBR). CHANGED THE VARIOUS *     01340025
013500*    PRINT PO NUMBERS TO PIC Z(9). INCREASED THE SIZE OF THE*     01350025
013600*    VARIOUS W/S PO NBR FROM 7 TO 9 BYTES. CHANGED THE LEN  *     01360025
013700*    OF PW-PREV-FILLER TO MATCH THE SIZE TO 13 BYTES. THIS  *     01370025
013800*    WILL ALLOW PW-PREV-RECORD-KEY TO MATCH AP263-RECORD-KEY*     01380025
013900* MADE BY:  MIKE BESKE                          WR#: 23500  *     01390025
014000*                                                           *     01400027
014100*   10/12/04                                                *     01410027
014200*     INCREASED THE NUMBER OF ENTRIES FOR IT-INVOICE        *     01420027
014300*     TABLE TO 4000 FROM 2000.                              *     01430027
014400*      MADE BY:  MIKE BESKE             PITS : P000700922   *     01440027
014500*                                                           *     01450027
014600* DATE  10/12/2004                                          *     01460028
014700*     CHANGE MADE: ADDED IMPORTANT PROGRAMMING NOTE BY THE  *     01470028
014800*     IT-IND-LIMIT FIELD REGARDING ANY UPDATES TO ITS VALUE.*     01480028
014900*     MADE BY: MIKE BESKE              WR/IR #: P000700924  *     01490028
015000*                                                           *     01500028
015100* DATE  12/03/2004                                          *     01510035
015200*     CHANGE MADE: ADDED LOGIC TO PRODUCE SUBTOTALS FOR AUTO*     01520035
015300*     AND MANUAL PAY-RELEASED ACTIVITY.  THESE SUBTOTALS    *     01530035
015400*     APPEAR AT THE END OF THE REPORT BETWEEN THE GRAND     *     01540035
015500*     TOTALS.  MODIFIED REMAINDER INVOICE ADDITIONS TOTAL   *     01550039
015600*     LINE TO HAVE BRACKETS '<' & '>' TO INDICATE THE AMOUNT*     01560039
015700*     IS ACTUALLY NEGATIVE.                                 *     01570039
015800*     MADE BY: MIKE BESKE              WR/IR #: WR26889     *     01580035
015900* DATE  03/11/2007                                          *     01590044
016000*     CHANGE MADE: ADDED MATCH LEVEL TO THE HEADER AFTER    *     01600040
016100*     LOCATION NUMER                                        *     01610040
016200*     MADE BY: GREG WISIALOWSKI        WR/IR #: WR21578     *     01620040
016300*                                                           *     01630035
016400* DATE  01/10/2011                                          *     01640046
016500*     CHANGE MADE: INCREASED THE NUMBER OF ENTRIES FOR      *     01650046
016600*     IT-INVOICE TABLE TO 4800 FROM 4000.                   *     01660046
016700*     MADE BY:  NANCY EILBES       WR/IR #: INC000001550911 *     01670046
016800*                                                           *     01680046
016900* DATE  12/06/2011                                                01690047
017000*     CHANGE MADE: INCREASED SIZE OF IT-INVOICE TABLE FROM 4800   01700047
017100*     TO 5800 ENTRIES TO ALLOW PROCESSING OF SEVERAL CONSUMER     01710047
017200*     DIRECT POS FROM BLACK FRIDAY AND CYBER MONDAY SALES.        01720047
017300*     MADE BY: MIKE BESKE              WR/IR #: CRQ000000016459   01730048
017400*                                                           *     01740049
017500* DATE  12/19/2011                                                01750049
017600*     CHANGE MADE: INCREASED SIZE OF IT-INVOICE TABLE FROM 5800   01760049
017700*     TO 7000 ENTRIES TO ALLOW PROCESSING OF SEVERAL CONSUMER     01770049
017800*     DIRECT POS FROM BLACK FRIDAY AND CYBER MONDAY SALES.        01780049
017900*     MADE BY: MIKE BESKE              WR/IR #: CRQ000000017193   01790049
018000*                                                           *     01800050
018100* DATE  01/16/2012                                                01810052
018200*     CHANGE MADE: INCREASED SIZE OF IT-INVOICE TABLE FROM 7000   01820050
018300*     TO 7500 ENTRIES TO ALLOW PROCESSING OF SEVERAL CONSUMER     01830050
018400*     DIRECT POS FROM BLACK FRIDAY AND CYBER MONDAY SALES.        01840050
018500*     MADE BY: MIKE BESKE              WR/IR #: CRQ000000018612   01850050
018501*                                                                 01850154
018510* DATE  09/23/2013                                                01851054
018520*     CHANGE MADE: INCREASED SIZE OF INTERNAL TINVOIC TABLE       01852054
018530*     FROM 7500 TO 8000 ALLOW PAY RELEASE OF CONSUMER             01853054
018540*     DIRECT POS DUE TO ATG PROBLEMS                              01854054
018550*     MADE BY: MIKE BESKE              WR/IR #: CHG0063481        01855054
018560*                                                                 01856054
018570* DATE  01/28/2014                                                01857055
018580*     CHANGE MADE: INCREASED SIZE OF INTERNAL TINVOIC TABLE       01858055
018590*     FROM 8000 TO 8500 ALLOW PAY RELEASE OF CONSUMER             01859055
018591*     DIRECT POS                                                  01859155
018592*     MADE BY: ANAND KUMAR             WR/IR #: CHG0072776        01859257
018593*                                                                 01859362
018594* DATE  01/19/2016                                                01859463
018595*     CHANGE MADE: INCREASED SIZE OF INTERNAL TINVOIC TABLE       01859563
018596*     FROM 8500 TO 10000 TO ALLOW PAY RELEASE OF CONSUMER         01859663
018597*     DIRECT POS. ALSO MADE CORRESPONDING CHANGES TO APKRP263.    01859763
018598*     MADE BY: SRINATH (COGNIZANT)     WR/IR #: CHG0132253        01859863
018599*                                                                 01859963
018600*   26/02/2016                                              *     01860061
018601*     INCREASED THE NUMBER OF ENTRIES FOR RT-RECEIVER-TABLE *     01860161
018602*     TABLE TO 2000 FROM 999.                               *     01860261
018603*      MADE BY: COGNIZANT               WR/IR #: CHG0135445 *     01860362
018604*                                                                 01860465
018605* DATE  01/29/2020                                                01860564
018606*     CHANGE MADE: INCREASED SIZE OF INTERNAL TINVOIC TABLE       01860664
018607*     FROM 10000 TO 12000 TO ALLOW PAY RELEASE OF CONSUMER        01860764
018608*     DIRECT POS. ALSO MADE CORRESPONDING CHANGES TO APKRP263.    01860864
018609*     MADE BY: COGNIZANT               WR/IR #: CHG0238863        01860965
018610*                                                                 01861067
018611* DATE  12/22/2020                                                01861167
018612*     CHANGE MADE: INCREASED SIZE OF INTERNAL TINVOIC TABLE       01861267
018613*     FROM 12000 TO 15000 TO ALLOW PAY RELEASE OF CONSUMER        01861367
018614*     DIRECT POS. ALSO MADE CORRESPONDING CHANGES TO APKCS330.    01861468
018615*     MADE BY: NANCY EILBES            WR/IR #: CHG0252211        01861567
018620******************************************************************01862067
018700/                                                                 01870050
018800 ENVIRONMENT DIVISION.                                            01880050
018900 CONFIGURATION SECTION.                                           01890050
019000 INPUT-OUTPUT SECTION.                                            01900050
019100 FILE-CONTROL.                                                    01910050
019200     SELECT RESULTS-INVOICE-FILE ASSIGN TO UT-S-INP01.            01920050
019300     SELECT RECON-REPORT-FILE    ASSIGN TO UT-S-RPT01.            01930050
019400     SELECT ERROR-FILE           ASSIGN TO UT-S-RPT03.            01940050
019500/                                                                 01950050
019600 DATA DIVISION.                                                   01960050
019700 FILE SECTION.                                                    01970050
019800 FD  RESULTS-INVOICE-FILE                                         01980050
019900     RECORDING MODE IS F                                          01990050
020000     LABEL RECORDS ARE STANDARD                                   02000050
020100     BLOCK CONTAINS 0 RECORDS                                     02010050
020200     DATA RECORD IS RESULTS-INVOICE-RECORD.                       02020050
020300 01  RESULTS-INVOICE-RECORD.                                      02030050
020400     05  RESULTS-INVOICE-KEY          PIC  X(30).                 02040050
020500     05  FILLER                       PIC  X(90).                 02050050
020600                                                                  02060050
020700 FD  RECON-REPORT-FILE                                            02070050
020800     RECORDING MODE IS F                                          02080050
020900     LABEL RECORDS ARE STANDARD                                   02090050
021000     BLOCK CONTAINS 0 RECORDS                                     02100050
021100     DATA RECORD IS RECON-REPORT-REC.                             02110050
021200 01  RECON-REPORT-REC                 PIC  X(132).                02120050
021300                                                                  02130050
021400 FD  ERROR-FILE                                                   02140050
021500     RECORDING MODE IS F                                          02150050
021600     LABEL RECORDS ARE STANDARD                                   02160050
021700     BLOCK CONTAINS 0 RECORDS                                     02170050
021800     DATA RECORD IS ERROR-REC.                                    02180050
021900 01  ERROR-REC                        PIC  X(132).                02190050
022000/                                                                 02200050
022100 WORKING-STORAGE SECTION.                                         02210050
022200 01  PROGRAM-WORKAREA.                                            02220050
022300     05  FILLER                      PIC  X(30) VALUE             02230050
022400                                 '** BEGINING OF APKRP263 W/S **'.02240050
022500     05  PW-CURRENT-PARAGRAPH         PIC  X(30).                 02250050
022600     05  PW-REPORT-NAME               PIC  X(08)    VALUE         02260050
022700                                      'APKRP263'.                 02270050
022800     05  PW-BREAK-COUNT-INVC          PIC  9(05)    VALUE ZEROES  02280050
022900                                                    COMP-3.       02290050
023000     05  PW-BREAK-AMOUNT-INVC         PIC S9(11)V99 VALUE ZEROES  02300050
023100                                                    COMP-3.       02310050
023200     05  PW-BREAK-COUNT-INVC-M        PIC  9(05)    VALUE ZEROES  02320050
023300                                                    COMP-3.       02330050
023400     05  PW-BREAK-AMOUNT-INVC-M       PIC S9(11)V99 VALUE ZEROES  02340050
023500                                                    COMP-3.       02350050
023600     05  PW-BREAK-COUNT-INVC-A        PIC  9(05)    VALUE ZEROES  02360050
023700                                                    COMP-3.       02370050
023800     05  PW-BREAK-AMOUNT-INVC-A       PIC S9(11)V99 VALUE ZEROES  02380050
023900                                                    COMP-3.       02390050
024000     05  PW-BREAK-COUNT-REM           PIC  9(05)    VALUE ZEROES  02400050
024100                                                    COMP-3.       02410050
024200     05  PW-BREAK-AMOUNT-REM          PIC S9(11)V99 VALUE ZEROES  02420050
024300                                                    COMP-3.       02430050
024400     05  PW-BREAK-COUNT-REM-M         PIC  9(05)    VALUE ZEROES  02440050
024500                                                    COMP-3.       02450050
024600     05  PW-BREAK-AMOUNT-REM-M        PIC S9(11)V99 VALUE ZEROES  02460050
024700                                                    COMP-3.       02470050
024800     05  PW-BREAK-COUNT-REM-A         PIC  9(05)    VALUE ZEROES  02480050
024900                                                    COMP-3.       02490050
025000     05  PW-BREAK-AMOUNT-REM-A        PIC S9(11)V99 VALUE ZEROES  02500050
025100                                                    COMP-3.       02510050
025200     05  PW-BREAK-COUNT-REM-ADD       PIC  9(05)    VALUE ZEROES  02520050
025300                                                    COMP-3.       02530050
025400     05  PW-BREAK-AMOUNT-REM-ADD      PIC S9(11)V99 VALUE ZEROES  02540050
025500                                                    COMP-3.       02550050
025600     05  PW-BREAK-COUNT-REM-ADD-M     PIC  9(05)    VALUE ZEROES  02560050
025700                                                    COMP-3.       02570050
025800     05  PW-BREAK-AMOUNT-REM-ADD-M    PIC S9(11)V99 VALUE ZEROES  02580050
025900                                                    COMP-3.       02590050
026000     05  PW-BREAK-COUNT-REM-ADD-A     PIC  9(05)    VALUE ZEROES  02600050
026100                                                    COMP-3.       02610050
026200     05  PW-BREAK-AMOUNT-REM-ADD-A    PIC S9(11)V99 VALUE ZEROES  02620050
026300                                                    COMP-3.       02630050
026400     05  PW-LINE-COUNT                PIC  9(03)    VALUE 99      02640050
026500                                                    COMP-3.       02650050
026600     05  PW-PAGE-COUNT                PIC  9(05)    VALUE ZERO    02660050
026700                                                    COMP-3.       02670050
026800     05  PW-ERROR-COUNT               PIC  9(05)    VALUE ZERO    02680050
026900                                                    COMP-3.       02690050
027000     05  PW-INPUT-COUNT               PIC  9(05)    VALUE ZERO    02700050
027100                                                    COMP-3.       02710050
027200     05  PW-MAX-LINES                 PIC  9(03)    VALUE 60      02720050
027300                                                    COMP-3.       02730050
027400     05  PW-LINES-IN-HDR              PIC  9(01)    VALUE 6       02740050
027500                                                    COMP-3.       02750050
027600     05  PW-ADVANCE-COUNT             PIC S9(03)    VALUE ZERO    02760050
027700                                                    COMP-3.       02770050
027800     05  PW-ERROR-PERCENT             PIC  9V99     VALUE 0.05    02780050
027900                                                    COMP-3.       02790050
028000     05  PW-ERROR-LINE-COUNT          PIC  9(03)    VALUE  99     02800050
028100                                                    COMP-3.       02810050
028200     05  PW-ERROR-PAGE-COUNT          PIC  9(05)    VALUE ZERO    02820050
028300                                                    COMP-3.       02830050
028400     05  PW-ERROR-THRESH              PIC  9(05)    VALUE 0       02840050
028500                                                    COMP-3.       02850050
028600     05  PW-DISPLAY-COUNT             PIC  9(05)    VALUE 0.      02860050
028700                                                                  02870050
028800     05  PW-SAVE-ENTRY-METHOD         PIC  X(01)    VALUE SPACE.  02880050
028900     05  PW-PREV-RI-DOC-NO            PIC  X(16)    VALUE SPACES. 02890050
029000     05  PW-SAVE-REPORT-NBR           PIC  9(01)    VALUE ZERO.   02900050
029100     05  PW-PREV-RECORD-KEY.                                      02910050
029200         10 PW-PREV-DEPT-NBR          PIC  X(03)    VALUE SPACE.  02920050
029300         10 PW-PREV-PO-NBR            PIC  9(09)    VALUE ZERO.   02930050
029400         10 PW-PREV-STORE-NBR         PIC  9(04)    VALUE ZERO.   02940050
029500         10 PW-PREV-RECORD-TYPE       PIC  X(01)    VALUE SPACE.  02950050
029600             88  PREV-VENDOR-RECORD                 VALUE 'A'.    02960050
029700             88  PREV-INVOICE-RECORD                VALUE 'B'.    02970050
029800             88  PREV-INVOICE-ADJ-RECORD            VALUE 'C'.    02980050
029900             88  PREV-RECEIVER-RECORD               VALUE 'D'.    02990050
030000             88  PREV-RECEIVER-ADJ-RECORD           VALUE 'E'.    03000050
030100         10 PW-PREV-FILLER            PIC  X(13)    VALUE SPACE.  03010050
030200     05  PW-PREV-VENDOR-NAME          PIC  X(30)    VALUE SPACES. 03020050
030300     05  PW-PREV-VENDOR-NBR           PIC  9(09)    VALUE ZERO.   03030050
030400     05  PW-PREV-RECON-SOURCE         PIC  X(06)    VALUE SPACES. 03040050
030500     05  PW-PREV-INVOICE-NBR          PIC  X(22)    VALUE SPACES. 03050050
030600     05  PW-PREV-SEQ-NBR              PIC  9(9)     VALUE ZERO.   03060050
030700     05  PW-PREV-TYP                  PIC  X(2)     VALUE SPACES. 03070050
030800     05  PW-PREV-TRAN-CODE            PIC  X(2)     VALUE SPACES. 03080050
030900     05  PW-PREV-DOC-TYP              PIC  X(2)     VALUE SPACES. 03090050
031000         88  PW-CREDIT-ADJ                          VALUE 'CM'.   03100050
031100         88  PW-DEBIT-ADJ                           VALUE 'DM'.   03110050
031200                                                                  03120050
031300 01  WS-TOTAL-FIELDS.                                             03130050
031400     05  WS-INV-GROSS-AMT             PIC S9(11)V99 VALUE ZEROES  03140050
031500                                                    COMP-3.       03150050
031600     05  WS-INV-NET-AMT               PIC S9(11)V99 VALUE ZEROES  03160050
031700                                                    COMP-3.       03170050
031800     05  WS-INV-DM-ADJ-AMT            PIC S9(11)V99 VALUE ZEROES  03180050
031900                                                    COMP-3.       03190050
032000     05  WS-INV-CM-ADJ-AMT            PIC S9(11)V99 VALUE ZEROES  03200050
032100                                                    COMP-3.       03210050
032200     05  WS-RCVR-GROSS-AMT            PIC S9(11)V99 VALUE ZEROES  03220050
032300                                                    COMP-3.       03230050
032400     05  WS-RCVR-NET-AMT              PIC S9(11)V99 VALUE ZEROES  03240050
032500                                                    COMP-3.       03250050
032600     05  WS-RCVR-DM-ADJ-AMT           PIC S9(11)V99 VALUE ZEROES  03260050
032700                                                    COMP-3.       03270050
032800     05  WS-RCVR-CM-ADJ-AMT           PIC S9(11)V99 VALUE ZEROES  03280050
032900                                                    COMP-3.       03290050
033000     05  WS-TRAN-DM-ADJ-AMT           PIC S9(11)V99 VALUE ZEROES  03300050
033100                                                    COMP-3.       03310050
033200     05  WS-TRAN-CM-ADJ-AMT           PIC S9(11)V99 VALUE ZEROES  03320050
033300                                                    COMP-3.       03330050
033400                                                                  03340050
033500 01  WS-ABEND-FIELDS.                                             03350050
033600     05  WS-ABEND-PROGRAM             PIC X(8)  VALUE 'APKRP263'. 03360050
033700     05  WS-ABEND-PARAGRAPH           PIC X(50) VALUE SPACES.     03370050
033800     05  WS-ABEND-OPERATION           PIC X(50) VALUE SPACES.     03380050
033900     05  WS-ABEND-STATUS              PIC XX    VALUE SPACES.     03390050
034000     05  WS-ABEND-CODE                PIC S9(04)    VALUE ZERO    03400050
034100                                                    COMP SYNC.    03410050
034200         88 WRITE-ERROR                             VALUE +4001.  03420050
034300         88 READ-ERROR                              VALUE +4002.  03430050
034400         88 CC-ERRROR                               VALUE +4003.  03440050
034500         88 TABLE-ERROR                             VALUE +4004.  03450050
034600         88 OPEN-ERROR                              VALUE +4005.  03460050
034700         88 CLOSE-ERROR                             VALUE +4006.  03470050
034800         88 SEQ-ERROR                               VALUE +4007.  03480050
034900         88 DATA-ERROR                              VALUE +4008.  03490050
035000         88 KEYPUNCH-ERROR                          VALUE +4009.  03500050
035100         88 SORT-ERROR                              VALUE +4012.  03510050
035200         88 DB2-ERROR                               VALUE +4013.  03520050
035300         88 DATE-ERROR                              VALUE +4019.  03530050
035400                                                                  03540050
035500 01  PROGRAM-SWITCHES.                                            03550050
035600     05  PW-END-PROCESSING-SW         PIC  X(01)    VALUE 'N'.    03560050
035700         88  END-OF-PROCESSING                      VALUE 'Y'.    03570050
035800     05  PW-FIRST-TIME-SW             PIC  X(01)    VALUE 'Y'.    03580050
035900         88  FIRST-TIME                             VALUE 'Y'.    03590050
036000         88  NOT-FIRST-TIME                         VALUE 'N'.    03600050
036100     05  PW-RECON-SW                  PIC  X(01)    VALUE 'U'.    03610050
036200         88  PS-MANUAL-RECON                        VALUE 'M'.    03620050
036300         88  PS-AUTO-RECON                          VALUE 'A'.    03630050
036400         88  PS-UNKNOWN-RECON                       VALUE 'U'.    03640050
036500     05  PW-DATA-ERROR                PIC  X(34)    VALUE SPACES. 03650050
036600         88  PW-NO-INVOICES                         VALUE         03660050
036700             'MISSING INVOICE RECORD            '.                03670050
036800         88  PW-NO-RECEIVERS                        VALUE         03680050
036900             'MISSING RECEIVER RECORD           '.                03690050
037000         88  PW-MULTIPLE-VENDORS                    VALUE         03700050
037100             'MULTIPLE VENDOR RECORDS           '.                03710050
037200         88  PW-NO-DETAILS                          VALUE         03720050
037300             'MISSING DETAIL RECORDS FOR VENDOR '.                03730050
037400         88  PW-NO-VENDOR                           VALUE         03740050
037500             'MISSING VENDOR RECORD             '.                03750050
037600         88  PW-NO-INV-ADJ                          VALUE         03760050
037700             'MISSING INVOICE ADJUSTMENT RECORDS'.                03770050
037800         88  PW-NO-RECV-ADJ                         VALUE         03780050
037900             'MISSING RECEIVER ADJUSTMENT RECORD'.                03790050
038000                                                                  03800050
038100 01  PW-CURRENT-DATE.                                             03810050
038200     05  PW-CURRENT-YEAR              PIC  9(02)    VALUE ZEROES. 03820050
038300     05  PW-CURRENT-MONTH             PIC  9(02)    VALUE ZEROES. 03830050
038400     05  PW-CURRENT-DAY               PIC  9(02)    VALUE ZEROES. 03840050
038500                                                                  03850050
038600 01  PW-CURRENT-TIME.                                             03860050
038700     05  PW-CURRENT-HOUR              PIC  9(02)    VALUE ZEROES. 03870050
038800     05  PW-CURRENT-MINUTE            PIC  9(02)    VALUE ZEROES. 03880050
038900     05  FILLER                       PIC  9(02)    VALUE ZEROES. 03890050
039000                                                                  03900050
039100 01  PW-CONSTANTS.                                                03910050
039200     05  PW-EDI-METHOD                PIC  X(22)    VALUE         03920050
039300                                      'EDI INVOICES SUMMARY '.    03930050
039400     05  PW-RECON-METHOD              PIC  X(22)    VALUE         03940050
039500                                      'MANUAL INVOICE SUMMARY'.   03950050
039600     05  PW-NO-VENDOR-NAME            PIC  X(15)    VALUE         03960050
039700                                      '*NO VENDOR NAME'.          03970050
039800     05  PW-NO-VENDOR-NBR             PIC  9(09)    VALUE         03980050
039900                                      999999999.                  03990050
040000     05  PW-DEBIT                     PIC  X(02)    VALUE         04000050
040100                                      'DM'.                       04010050
040200     05  PW-CREDIT                    PIC  X(02)    VALUE         04020050
040300                                      'CM'.                       04030050
040400                                                                  04040050
040500***************************************************************** 04050050
040600****  IMPORTANT PROGRAM NOTE:                                **** 04060050
040700****  -----------------------                                **** 04070050
040800****                                                         **** 04080050
040900****  THE IT-IND-LIMIT VALUE & NUMBER OF OCCURS FOR THE      **** 04090050
041000****  IT-INVOICES SHOULD BE UPDATED TO MATCH TO ANY          **** 04100050
041100****  CHANGES IN APKCS330 TO THE CORRESPONDING FIELDS TO     **** 04110050
041200****  AVOID A FATAL PROD ABEND IN JOB APK070!!!!! THE VALUES **** 04120050
041300****  MUST MATCH EXACTLY!!!!  THE APKCS330 FIELDS ARE:       **** 04130050
041400****  IH-MAX AND THE NUMBER OF OCCURS FOR THE TINVOIC-ENTRIES**** 04140051
041500****  INTERNAL ARRAY.                                        **** 04150050
041600****                                                         **** 04160050
041700***************************************************************** 04170050
041800 01  IT-INVOICE-TABLE.                                            04180050
041900     05  IT-IND-LIMIT            PIC S9(05) VALUE 15000           04190067
042000                                             COMP SYNC.           04200050
042100     05  IT-IND-MAX              PIC S9(04) VALUE ZEROS           04210050
042200                                             COMP SYNC.           04220050
042300     05  IT-INVOICES OCCURS 15000 TIMES INDEXED BY IT-IND.        04230067
042400         10  IT-INVOICE-NBR      PIC  X(22).                      04240050
042500         10  IT-INVOICE-TYPE     PIC  X(02).                      04250050
042600         10  IT-ENTRY-METHOD     PIC  X(01).                      04260050
042700         10  IT-DUE-DATE.                                         04270050
042800             15 IT-DUE-MONTH     PIC  9(02).                      04280050
042900             15 IT-DUE-DAY       PIC  9(02).                      04290050
043000             15 IT-DUE-YEAR      PIC  9(02).                      04300050
043100         10  IT-INVOICE-QTY      PIC  9(07).                      04310050
043200         10  IT-GROSS-AMT        PIC  9(09)V99 COMP-3.            04320050
043300*        10  IT-TERMS-PCT        PIC  9(03)V99 COMP-3.            04330050
043400         10  IT-TERMS-PCT        PIC  9V9999   COMP-3.            04340050
043500         10  IT-ALW-IND          PIC  X(01).                      04350050
043600                                                                  04360050
043700 01  RT-RECEIVER-TABLE.                                           04370050
043800     05  RT-IND-LIMIT            PIC S9(04) VALUE 2500            04380061
043900                                             COMP SYNC.           04390050
044000     05  RT-IND-MAX              PIC S9(04) VALUE ZEROS           04400050
044100                                             COMP SYNC.           04410050
044200     05  RT-RECEIVERS OCCURS 2500 TIMES INDEXED BY RT-IND.        04420061
044300         10  RT-RECVR-SEQ-NO     PIC  9(09).                      04430050
044400         10  RT-RECVR-TYPE       PIC  X(02).                      04440050
044500         10  RT-RECVR-QTY        PIC  9(07).                      04450050
044600         10  RT-RECVR-AMT        PIC  9(09)V99.                   04460050
044700/                                                                 04470050
044800     COPY DPWS133O.                                               04480050
044900                                                                  04490050
045000 01  HDR-LINE-2.                                                  04500050
045100     05  FILLER                       PIC  X(55)   VALUE SPACES.  04510050
045200     05  FILLER                       PIC  X(22)  VALUE           04520050
045300         'RECONCILIATION RESULTS'.                                04530050
045400     05  FILLER                       PIC  X(55)   VALUE SPACES.  04540050
045500                                                                  04550050
045600 01  PO-HDR-1.                                                    04560050
045700     05  PO-PO-NBR                    PIC  Z(09).                 04570050
045800     05  FILLER                       PIC  X(02)    VALUE SPACES. 04580050
045900     05  FILLER                       PIC  X(07)    VALUE         04590050
046000                                      'LOC #: '.                  04600050
046100     05  PO-STORE-NBR                 PIC  X(04).                 04610050
046200     05  FILLER                       PIC  X(02)    VALUE SPACES. 04620050
046300     05  FILLER                       PIC  X(10)    VALUE         04630050
046400                                      'MTCH LVL: '.               04640050
046500     05  FILLER                       PIC  X(02)    VALUE SPACES. 04650050
046600     05  PO-MTCH-LVL-CDE              PIC  X(01).                 04660050
046700     05  FILLER                       PIC  X(02)    VALUE SPACES. 04670050
046800     05  FILLER                       PIC  X(13)    VALUE         04680050
046900                                      'VENDOR NAME: '.            04690050
047000     05  PO-VENDOR-NAME               PIC  X(30).                 04700050
047100     05  FILLER                       PIC  X(03)    VALUE SPACES. 04710050
047200     05  FILLER                       PIC  X(09)    VALUE         04720050
047300                                      'VENDOR#: '.                04730050
047400     05  PO-VENDOR-NBR                PIC  X(09).                 04740050
047500     05  FILLER                       PIC  X(04)    VALUE SPACES. 04750050
047600     05  FILLER                       PIC  X(12)    VALUE         04760050
047700                                      'RECON SRCE: '.             04770050
047800     05  PO-RECON-SOURCE              PIC  X(06).                 04780050
047900     05  FILLER                       PIC  X(07)    VALUE SPACES. 04790050
048000                                                                  04800050
048100 01  INV-HDR-1.                                                   04810050
048200     05  FILLER                       PIC  X(03)    VALUE         04820050
048300                                      'PO#'.                      04830050
048400     05  FILLER                       PIC  X(04)    VALUE SPACE.  04840050
048500     05  FILLER                       PIC  X(08)    VALUE         04850050
048600                                      'INVOICE#'.                 04860050
048700     05  FILLER                       PIC  X(16)    VALUE SPACE.  04870050
048800     05  FILLER                       PIC  X(03)    VALUE         04880050
048900                                      'MTH'.                      04890050
049000     05  FILLER                       PIC  X(02)    VALUE SPACE.  04900050
049100     05  FILLER                       PIC  X(08)    VALUE         04910050
049200                                      'DUE DATE'.                 04920050
049300     05  FILLER                       PIC  X(02)    VALUE SPACE.  04930050
049400     05  FILLER                       PIC  X(08)    VALUE         04940050
049500                                      'QUANTITY'.                 04950050
049600     05  FILLER                       PIC  X(07)    VALUE SPACE.  04960050
049700     05  FILLER                       PIC  X(12)    VALUE         04970050
049800                                      'GROSS AMOUNT'.             04980050
049900     05  FILLER                       PIC  X(04)    VALUE SPACE.  04990050
050000     05  FILLER                       PIC  X(05)    VALUE         05000050
050100                                      'TERMS'.                    05010050
050200     05  FILLER                       PIC  X(02)    VALUE SPACE.  05020050
050300     05  FILLER                       PIC  X(03)    VALUE         05030050
050400                                      'ALW'.                      05040050
050500     05  FILLER                       PIC  X(45)    VALUE SPACE.  05050050
050600                                                                  05060050
050700 01  INV-INVOICE-DETAIL-LINE.                                     05070050
050800     05  FILLER                       PIC  X(07)    VALUE SPACES. 05080050
050900     05  INV-INVOICE-NBR              PIC  X(22).                 05090050
051000     05  FILLER                       PIC  X(03)    VALUE SPACES. 05100050
051100     05  INV-ENTRY-METHOD             PIC  X(01).                 05110050
051200     05  FILLER                       PIC  X(03)    VALUE SPACES. 05120050
051300     05  INV-DUE-DATE.                                            05130050
051400         10  INV-DUE-DATE-MM          PIC  X(02).                 05140050
051500         10  FILLER                   PIC  X(01)    VALUE '-'.    05150050
051600         10  INV-DUE-DATE-DD          PIC  X(02).                 05160050
051700         10  FILLER                   PIC  X(01)    VALUE '-'.    05170050
051800         10  INV-DUE-DATE-YY          PIC  X(02).                 05180050
051900     05  FILLER                       PIC  X(03)    VALUE SPACE.  05190050
052000     05  INV-INVOICE-QTY              PIC  ZZZZZZ9.               05200050
052100     05  FILLER                       PIC  X(05)    VALUE SPACE.  05210050
052200     05  INV-GROSS-INVOICE-AMT        PIC  ZZZ,ZZZ,ZZ9.99.        05220050
052300     05  FILLER                       PIC  X(03)    VALUE SPACE.  05230050
052400     05  INV-TERMS-PCT                PIC  ZZ9.99.                05240050
052500     05  FILLER                       PIC  X(03)    VALUE SPACE.  05250050
052600     05  INV-ALW-IND                  PIC  X(01).                 05260050
052700     05  FILLER                       PIC  X(46)    VALUE SPACE.  05270050
052800                                                                  05280050
052900 01  INV-RECVR-DETAIL-LINE.                                       05290050
053000     05  FILLER                       PIC  X(26)    VALUE SPACE.  05300050
053100     05  INV-RECVR-SEQ-NO             PIC  ZZZZZZZZ9.             05310050
053200     05  FILLER                       PIC  X(02)    VALUE SPACES. 05320050
053300     05  INV-RECVR-TYPE               PIC  X(02).                 05330050
053400     05  FILLER                       PIC  X(08)    VALUE SPACES. 05340050
053500     05  INV-RECVR-QTY                PIC  ZZZZZZ9.               05350050
053600     05  FILLER                       PIC  X(05)    VALUE SPACES. 05360050
053700     05  INV-RECVR-AMT                PIC  ZZZ,ZZZ,ZZ9.99.        05370050
053800     05  FILLER                       PIC  X(59)    VALUE SPACES. 05380050
053900                                                                  05390050
054000 01  RES-HDR-1.                                                   05400050
054100     05  FILLER                       PIC  X(09)    VALUE         05410050
054200                                      'RESULTS: '.                05420050
054300     05  FILLER                       PIC  X(03)    VALUE         05430050
054400                                      'TR '.                      05440050
054500     05  FILLER                       PIC  X(04)    VALUE         05450050
054600                                      'DTYP'.                     05460050
054700     05  FILLER                       PIC  X(02)    VALUE SPACES. 05470050
054800     05  FILLER                       PIC  X(04)    VALUE         05480050
054900                                      'DOC#'.                     05490050
055000     05  FILLER                       PIC  X(13)    VALUE SPACES. 05500050
055100     05  FILLER                       PIC  X(04)    VALUE         05510050
055200                                      'REL#'.                     05520050
055300     05  FILLER                       PIC  X(20)    VALUE SPACES. 05530050
055400     05  FILLER                       PIC  X(03)    VALUE         05540050
055500                                      'LN#'.                      05550050
055600     05  FILLER                       PIC  X(03)    VALUE SPACES. 05560050
055700     05  FILLER                       PIC  X(08)    VALUE         05570050
055800                                      'UNIT QTY'.                 05580050
055900     05  FILLER                       PIC  X(03)    VALUE SPACES. 05590050
056000     05  FILLER                       PIC  X(09)    VALUE         05600050
056100                                      'UNIT COST'.                05610050
056200     05  FILLER                       PIC  X(03)    VALUE SPACES. 05620050
056300     05  FILLER                       PIC  X(09)    VALUE         05630050
056400                                      'RECD COST'.                05640050
056500     05  FILLER                       PIC  X(09)    VALUE SPACES. 05650050
056600     05  FILLER                       PIC  X(08)    VALUE         05660050
056700                                      'EXT COST'.                 05670050
056800     05  FILLER                       PIC  X(18)    VALUE SPACES. 05680050
056900                                                                  05690050
057000 01  RES-DETAIL-LINE.                                             05700050
057100     05  FILLER                       PIC  X(09)    VALUE SPACES. 05710050
057200     05  RES-TRAN-CODE                PIC  X(02).                 05720050
057300     05  FILLER                       PIC  X(02)    VALUE SPACES. 05730050
057400     05  RES-DOC-TYP                  PIC  X(02).                 05740050
057500     05  FILLER                       PIC  X(03)    VALUE SPACES. 05750050
057600     05  RES-DOC-NO                   PIC  X(16).                 05760050
057700     05  FILLER                       PIC  X(01)    VALUE SPACES. 05770050
057800     05  RES-RELATED-INV-NBR          PIC  X(22).                 05780050
057900     05  FILLER                       PIC  X(01)    VALUE SPACES. 05790050
058000     05  RES-PO-LINE-NO               PIC  ZZZ9.                  05800050
058100     05  FILLER                       PIC  X(04)    VALUE SPACES. 05810050
058200     05  RES-UNIT-QTY                 PIC  ZZZZZZ9.               05820050
058300     05  FILLER                       PIC  X(02)    VALUE SPACES. 05830050
058400     05  RES-UNIT-COST                PIC  ZZZ,ZZ9.99.            05840050
058500     05  FILLER                       PIC  X(02)    VALUE SPACES. 05850050
058600     05  RES-REC-COST                 PIC  ZZZ,ZZ9.99.            05860050
058700     05  FILLER                       PIC  X(03)    VALUE SPACES. 05870050
058800     05  RES-EXTD-COST                PIC  ZZZ,ZZZ,ZZ9.99.        05880050
058900     05  FILLER                       PIC  X(18)    VALUE SPACES. 05890050
059000                                                                  05900050
059100 01  EM-TOTAL-HDR.                                                05910050
059200     05  EM-TOTAL-ENTRY-METHOD        PIC  X(22)    VALUE SPACES. 05920050
059300     05  FILLER                       PIC  X(10)    VALUE SPACES. 05930050
059400     05  FILLER                       PIC  X(12)    VALUE         05940050
059500         'TOTAL NUMBER'.                                          05950050
059600     05  FILLER                       PIC  X(08)    VALUE SPACES. 05960050
059700     05  FILLER                       PIC  X(12)    VALUE         05970050
059800         'TOTAL AMOUNT'.                                          05980050
059900     05  FILLER                       PIC  X(92)    VALUE SPACES. 05990050
060000                                                                  06000050
060100 01  EM-TOTAL-LINE.                                               06010050
060200     05  EM-TOTAL-INVOICE-TYPE        PIC  X(30)    VALUE SPACES. 06020050
060300     05  FILLER                       PIC  X(12)    VALUE SPACES. 06030050
060400     05  EM-TOTAL-BREAK-COUNT         PIC  ZZZZ9.                 06040050
060500     05  FILLER                       PIC  X(04)    VALUE SPACES. 06050050
060600     05  FILLER                       PIC  X(01)    VALUE '$'.    06060050
060700     05  EM-TOTAL-BREAK-AMOUNT        PIC  ZZZZ,ZZZ,ZZZ.99.       06070050
060800     05  FILLER                       PIC  X(92)    VALUE SPACES. 06080050
060900                                                                  06090050
061000 01  EM-TOTAL-LINE-N.                                             06100050
061100     05  EM-TOTAL-INVOICE-TYPE-N      PIC  X(30)    VALUE SPACES. 06110050
061200     05  FILLER                       PIC  X(12)    VALUE SPACES. 06120050
061300     05  EM-TOTAL-BREAK-COUNT-N       PIC  ZZZZ9.                 06130050
061400     05  FILLER                       PIC  X(03)    VALUE SPACES. 06140050
061500     05  EM-TOT-LEFT-NEG-PAR          PIC  X(01)    VALUE '<'.    06150050
061600     05  FILLER                       PIC  X(01)    VALUE '$'.    06160050
061700     05  EM-TOTAL-BREAK-AMOUNT-N      PIC  ZZZZ,ZZZ,ZZZ.99.       06170050
061800     05  EM-TOT-RIGHT-NEG-PAR         PIC  X(01)    VALUE '>'.    06180050
061900     05  FILLER                       PIC  X(91)    VALUE SPACES. 06190050
062000                                                                  06200050
062100 01  EXT-COST-TOTAL-LINE.                                         06210050
062200     05  FILLER                       PIC  X(93)   VALUE SPACES.  06220050
062300     05  FILLER                       PIC  X(15)   VALUE ALL '-'. 06230050
062400     05  FILLER                       PIC  X(07)   VALUE SPACES.  06240050
062500     05  EXT-LEFT-NEG-PAR             PIC  X(01).                 06250050
062600     05  EXT-TOTAL-TRAN-AMOUNT        PIC  ZZZZ,ZZZ,ZZZ.99.       06260050
062700     05  EXT-RIGHT-NEG-PAR            PIC  X(01).                 06270050
062800                                                                  06280050
062900 01  INV-GROSS-LINE.                                              06290050
063000     05  FILLER                       PIC  X(97)    VALUE SPACES. 06300050
063100     05  FILLER                       PIC  X(17)    VALUE         06310050
063200         'INVOICE GROSS   ='.                                     06320050
063300     05  FILLER                       PIC  X(02)    VALUE SPACES. 06330050
063400     05  INV-GROSS-AMOUNT             PIC  ZZZZ,ZZZ,ZZZ.99.       06340050
063500     05  FILLER                       PIC  X(01)    VALUE SPACES. 06350050
063600                                                                  06360050
063700 01  INV-NET-LINE.                                                06370050
063800     05  FILLER                       PIC  X(97)    VALUE SPACES. 06380050
063900     05  FILLER                       PIC  X(17)    VALUE         06390050
064000         'NET PAID        ='.                                     06400050
064100     05  FILLER                       PIC  X(02)    VALUE SPACES. 06410050
064200     05  INV-NET-AMOUNT               PIC  ZZZZ,ZZZ,ZZZ.99.       06420050
064300     05  FILLER                       PIC  X(01)    VALUE SPACES. 06430050
064400                                                                  06440050
064500 01  RCVR-GROSS-LINE.                                             06450050
064600     05  FILLER                       PIC  X(97)    VALUE SPACES. 06460050
064700     05  FILLER                       PIC  X(17)    VALUE         06470050
064800         'RECEIVING GROSS ='.                                     06480050
064900     05  FILLER                       PIC  X(02)    VALUE SPACES. 06490050
065000     05  RCVR-GROSS-AMOUNT            PIC  ZZZZ,ZZZ,ZZZ.99.       06500050
065100     05  FILLER                       PIC  X(01)    VALUE SPACES. 06510050
065200                                                                  06520050
065300 01  RCVR-NET-LINE.                                               06530050
065400     05  FILLER                       PIC  X(97)    VALUE SPACES. 06540050
065500     05  FILLER                       PIC  X(17)    VALUE         06550050
065600         'NET JOURNALS    ='.                                     06560050
065700     05  FILLER                       PIC  X(02)    VALUE SPACES. 06570050
065800     05  RCVR-NET-AMOUNT              PIC  ZZZZ,ZZZ,ZZZ.99.       06580050
065900     05  FILLER                       PIC  X(01)    VALUE SPACES. 06590050
066000                                                                  06600050
066100 01  PO-SEPARATOR.                                                06610050
066200     05  FILLER                       PIC  X(132)  VALUE ALL '-'. 06620050
066300 01  TOTAL-SEPARATOR.                                             06630050
066400     05  FILLER                       PIC  X(115)  VALUE SPACES.  06640050
066500     05  FILLER                       PIC  X(17)   VALUE ALL '-'. 06650050
066600                                                                  06660050
066700 01  EOR-END-OF-REPORT.                                           06670050
066800     05  FILLER                       PIC  X(52)  VALUE SPACES.   06680050
066900     05  FILLER                       PIC  X(80)  VALUE           06690050
067000         '*****  END OF REPORT *****'.                            06700050
067100                                                                  06710050
067200 01  EH-ERROR-HEADER.                                             06720050
067300     05  FILLER                  PIC  X(01)  VALUE SPACE.         06730050
067400     05  FILLER                  PIC  X(05)  VALUE 'TYP'.         06740050
067500     05  FILLER                  PIC  X(07)  VALUE 'STORE#'.      06750050
067600     05  FILLER                  PIC  X(11)  VALUE 'P/O#'.        06760050
067700     05  FILLER                  PIC  X(03)  VALUE 'M'.           06770050
067800     05  FILLER                  PIC  X(11)  VALUE 'VENDOR#'.     06780050
067900     05  FILLER                  PIC  X(16)  VALUE 'VENDOR NAME'. 06790050
068000     05  FILLER                  PIC  X(12)  VALUE 'RECON SRCE'.  06800050
068100     05  FILLER                  PIC  X(24)  VALUE 'INVOICE#'.    06810050
068200     05  FILLER                  PIC  X(40)  VALUE                06820050
068300         'ERROR MESSAGE'.                                         06830050
068400     05  FILLER                  PIC  X(02)  VALUE SPACES.        06840050
068500                                                                  06850050
068600 01  H3-HEADER3.                                                  06860050
068700     05  FILLER                  PIC  X(60) VALUE SPACES.         06870050
068800     05  FILLER                  PIC  X(12)  VALUE                06880050
068900         'ERROR REPORT'.                                          06890050
069000     05  FILLER                  PIC  X(60) VALUE SPACES.         06900050
069100                                                                  06910050
069200 01  ED-ERROR-DETAIL.                                             06920050
069300     05  FILLER                  PIC  X(02)  VALUE SPACE.         06930050
069400     05  ED-RECORD-TYPE          PIC  X(01)  VALUE SPACES.        06940050
069500     05  FILLER                  PIC  X(04)  VALUE SPACES.        06950050
069600     05  ED-STORE-NBR            PIC  9(04)  VALUE ZEROS.         06960050
069700     05  FILLER                  PIC  X(02)  VALUE SPACES.        06970050
069800     05  ED-PO-NBR               PIC  Z(09)  VALUE ZEROS.         06980050
069900     05  FILLER                  PIC  X(02)  VALUE SPACES.        06990050
070000     05  ED-ENTRY-METHOD         PIC  X(01)  VALUE SPACES.        07000050
070100     05  FILLER                  PIC  X(02)  VALUE SPACES.        07010050
070200     05  ED-VENDOR-NBR           PIC  9(09)  VALUE ZEROS.         07020050
070300     05  FILLER                  PIC  X(02)  VALUE SPACES.        07030050
070400     05  ED-VENDOR-NAME          PIC  X(15)  VALUE SPACES.        07040050
070500     05  FILLER                  PIC  X(03)  VALUE SPACES.        07050050
070600     05  ED-RECON-SOURCE         PIC  X(06)  VALUE SPACES.        07060050
070700     05  FILLER                  PIC  X(04)  VALUE SPACES.        07070050
070800     05  ED-INVOICE-NBR          PIC  X(22)  VALUE SPACES.        07080050
070900     05  FILLER                  PIC  X(02)  VALUE SPACES.        07090050
071000     05  ED-ERROR-MESSAGE        PIC  X(40)  VALUE SPACES.        07100050
071100     05  FILLER                  PIC  X(02)  VALUE SPACES.        07110050
071200                                                                  07120050
071300 01  ET-ERROR-TOTALS.                                             07130050
071400     05  FILLER                  PIC  X(01)  VALUE SPACE.         07140050
071500     05  FILLER                  PIC  X(24)  VALUE                07150050
071600         'TOTAL NUMBER OF ERRORS: '.                              07160050
071700     05  ET-ERROR-COUNT          PIC  ZZZZ9  VALUE ZEROS.         07170050
071800     05  FILLER                  PIC  X(103) VALUE SPACES.        07180050
071900/                                                                 07190050
072000     COPY APRD263.                                                07200050
072100/                                                                 07210050
072200 PROCEDURE DIVISION.                                              07220050
072300*                                                                 07230050
072400 0000-MAINLINE.                                                   07240050
072500                                                                  07250050
072600     MOVE '0000-MAINLINE                ' TO PW-CURRENT-PARAGRAPH.07260050
072700     PERFORM 7000-INITIALIZATION.                                 07270050
072800     PERFORM 1000-DETAIL-PROCESSING                               07280050
072900         UNTIL END-OF-PROCESSING.                                 07290050
073000     PERFORM 9900-END-OF-INPUT.                                   07300050
073100                                                                  07310050
073200     GOBACK.                                                      07320050
073300/                                                                 07330050
073400 1000-DETAIL-PROCESSING.                                          07340050
073500     MOVE '1000-DETAIL-PROCESSING      ' TO PW-CURRENT-PARAGRAPH. 07350050
073600                                                                  07360050
073700     IF FIRST-TIME                                                07370050
073800         SET NOT-FIRST-TIME TO TRUE                               07380050
073900     ELSE                                                         07390050
074000         PERFORM 1200-CHECK-RECORD-SEQ                            07400050
074100     END-IF.                                                      07410050
074200                                                                  07420050
074300     IF (AP263-PO-NBR NOT = PW-PREV-PO-NBR OR                     07430050
074400               AP263-STR-NBR NOT = PW-PREV-STORE-NBR) AND         07440050
074500               (NOT VENDOR-RECORD)                                07450050
074600         PERFORM 1600-KEY-BREAK                                   07460050
074700         INITIALIZE PW-PREV-SEQ-NBR                               07470050
074800                    PW-PREV-TYP                                   07480050
074900     END-IF.                                                      07490050
075000                                                                  07500050
075100     IF (AP263-PO-NBR NOT = PW-PREV-PO-NBR OR                     07510050
075200               AP263-STR-NBR NOT = PW-PREV-STORE-NBR)             07520050
075300         INITIALIZE PW-PREV-SEQ-NBR                               07530050
075400                    PW-PREV-TYP                                   07540050
075500     END-IF.                                                      07550050
075600                                                                  07560050
075700     EVALUATE TRUE                                                07570050
075800         WHEN VENDOR-RECORD                                       07580050
075900             PERFORM 2000-PROCESS-VENDOR                          07590050
076000         WHEN INVOICE-RECORD                                      07600050
076100             PERFORM 3000-PROCESS-INVOICE                         07610050
076200         WHEN RECEIVER-RECORD                                     07620050
076300             PERFORM 4000-PROCESS-RECEIVER                        07630050
076400         WHEN INVOICE-ADJ-RECORD                                  07640050
076500             PERFORM 5000-PROCESS-INVOICE-ADJ                     07650050
076600         WHEN RECEIVER-ADJ-RECORD                                 07660050
076700             PERFORM 6000-PROCESS-RECEIVER-ADJ                    07670050
076800         WHEN OTHER                                               07680050
076900             MOVE PW-CURRENT-PARAGRAPH      TO WS-ABEND-PARAGRAPH 07690050
077000             MOVE 'INVALID RECORD TYPE    ' TO WS-ABEND-OPERATION 07700050
077100             SET DATA-ERROR TO TRUE                               07710050
077200             PERFORM 9999-ABEND                                   07720050
077300     END-EVALUATE.                                                07730050
077400                                                                  07740050
077500     MOVE AP263-RECORD-KEY  TO PW-PREV-RECORD-KEY.                07750050
077600     MOVE SPACES TO PW-DATA-ERROR.                                07760050
077700     PERFORM 8000-READ-RESULTS-INVOICE-FILE.                      07770050
077800                                                                  07780050
077900/                                                                 07790050
078000 1200-CHECK-RECORD-SEQ.                                           07800050
078100                                                                  07810050
078200     IF PREV-VENDOR-RECORD                                        07820050
078300         IF VENDOR-RECORD                                         07830050
078400             IF AP263-RECORD-KEY = PW-PREV-RECORD-KEY             07840050
078500                 SET PW-MULTIPLE-VENDORS TO TRUE                  07850050
078600                 PERFORM 9800-PRINT-ERRORS                        07860050
078700             ELSE                                                 07870050
078800                 SET PW-NO-DETAILS TO TRUE                        07880050
078900                 PERFORM 9800-PRINT-ERRORS                        07890050
079000             END-IF                                               07900050
079100         ELSE                                                     07910050
079200             IF INVOICE-RECORD                                    07920050
079300                 CONTINUE                                         07930050
079400             ELSE                                                 07940050
079500                 IF INVOICE-ADJ-RECORD                            07950050
079600                     SET PW-NO-INV-ADJ TO TRUE                    07960050
079700                     PERFORM 9800-PRINT-ERRORS                    07970050
079800                 ELSE                                             07980050
079900                     IF RECEIVER-RECORD                           07990050
080000                         SET PW-NO-INVOICES TO TRUE               08000050
080100                         PERFORM 9800-PRINT-ERRORS                08010050
080200                     ELSE                                         08020050
080300                         IF RECEIVER-ADJ-RECORD                   08030050
080400                             SET PW-NO-RECV-ADJ TO TRUE           08040050
080500                             PERFORM 9800-PRINT-ERRORS            08050050
080600                         END-IF                                   08060050
080700                     END-IF                                       08070050
080800                 END-IF                                           08080050
080900             END-IF                                               08090050
081000         END-IF                                                   08100050
081100     END-IF.                                                      08110050
081200                                                                  08120050
081300     IF PREV-INVOICE-RECORD                                       08130050
081400         IF INVOICE-ADJ-RECORD                                    08140050
081500             PERFORM 4200-CHECK-FOR-INVC                          08150050
081600         ELSE                                                     08160050
081700             IF RECEIVER-RECORD                                   08170050
081800                 PERFORM 4200-CHECK-FOR-INVC                      08180050
081900                 PERFORM 9640-PRINT-INV-NET-LINE                  08190050
082000             ELSE                                                 08200050
082100                 IF VENDOR-RECORD      OR                         08210050
082200                         RECEIVER-ADJ-RECORD                      08220050
082300                     SET PW-NO-RECEIVERS TO TRUE                  08230050
082400                     PERFORM 9800-PRINT-ERRORS                    08240050
082500                     PERFORM 4200-CHECK-FOR-INVC                  08250050
082600                     PERFORM 9640-PRINT-INV-NET-LINE              08260050
082700                     PERFORM 4300-CHECK-FOR-RCVR                  08270050
082800                 END-IF                                           08280050
082900             END-IF                                               08290050
083000         END-IF                                                   08300050
083100     END-IF.                                                      08310050
083200                                                                  08320050
083300     IF PREV-INVOICE-ADJ-RECORD                                   08330050
083400         IF RECEIVER-ADJ-RECORD                                   08340050
083500             SET PW-NO-RECEIVERS TO TRUE                          08350050
083600             PERFORM 9800-PRINT-ERRORS                            08360050
083700             PERFORM 4300-CHECK-FOR-RCVR                          08370050
083800         END-IF                                                   08380050
083900     END-IF.                                                      08390050
084000                                                                  08400050
084100     IF PREV-RECEIVER-RECORD                                      08410050
084200         IF RECEIVER-RECORD                                       08420050
084300             CONTINUE                                             08430050
084400         ELSE                                                     08440050
084500             IF RECEIVER-ADJ-RECORD                               08450050
084600                 PERFORM 4300-CHECK-FOR-RCVR                      08460050
084700             ELSE                                                 08470050
084800                 IF VENDOR-RECORD                                 08480050
084900                     PERFORM 4300-CHECK-FOR-RCVR                  08490050
085000                     PERFORM 9660-PRINT-RCVR-NET-LINE             08500050
085100                 END-IF                                           08510050
085200             END-IF                                               08520050
085300                                                                  08530050
085400             IF INVOICE-RECORD OR                                 08540050
085500                     INVOICE-ADJ-RECORD                           08550050
085600                 SET PW-NO-VENDOR TO TRUE                         08560050
085700                 PERFORM 9800-PRINT-ERRORS                        08570050
085800             END-IF                                               08580050
085900         END-IF                                                   08590050
086000     END-IF.                                                      08600050
086100                                                                  08610050
086200     IF PREV-RECEIVER-ADJ-RECORD                                  08620050
086300         IF INVOICE-RECORD OR                                     08630050
086400                 INVOICE-ADJ-RECORD OR                            08640050
086500                 RECEIVER-RECORD                                  08650050
086600             SET PW-NO-VENDOR TO TRUE                             08660050
086700             PERFORM 9800-PRINT-ERRORS                            08670050
086800         END-IF                                                   08680050
086900     END-IF.                                                      08690050
087000                                                                  08700050
087100     IF PREV-INVOICE-ADJ-RECORD                                   08710050
087200            AND NOT INVOICE-ADJ-RECORD                            08720050
087300        PERFORM 9640-PRINT-INV-NET-LINE                           08730050
087400     END-IF.                                                      08740050
087500                                                                  08750050
087600     IF PREV-RECEIVER-ADJ-RECORD                                  08760050
087700            AND NOT RECEIVER-ADJ-RECORD                           08770050
087800        PERFORM 9660-PRINT-RCVR-NET-LINE                          08780050
087900     END-IF.                                                      08790050
088000                                                                  08800050
088100/                                                                 08810050
088200 1600-KEY-BREAK.                                                  08820050
088300     MOVE '1600-KEY-BREAK    '  TO PW-CURRENT-PARAGRAPH.          08830050
088400     MOVE AP263-PO-NBR          TO PO-PO-NBR.                     08840050
088500     MOVE AP263-STR-NBR         TO PO-STORE-NBR.                  08850050
088600     MOVE AP263-MTCH-LVL-CDE    TO PO-MTCH-LVL-CDE.               08860050
088700     MOVE PW-NO-VENDOR-NAME     TO PO-VENDOR-NAME                 08870050
088800                                   PW-PREV-VENDOR-NAME.           08880050
088900     MOVE PW-NO-VENDOR-NBR      TO PO-VENDOR-NBR                  08890050
089000                                   PW-PREV-VENDOR-NBR.            08900050
089100     MOVE SPACES                TO PW-PREV-RECORD-TYPE            08910050
089200                                   PO-RECON-SOURCE                08920050
089300                                   PW-PREV-RECON-SOURCE.          08930050
089400     PERFORM 9100-PRINT-PO-HDR-LINE.                              08940050
089500     IF PW-NO-VENDOR                                              08950050
089600         CONTINUE                                                 08960050
089700     ELSE                                                         08970050
089800         SET PW-NO-VENDOR TO TRUE                                 08980050
089900         PERFORM 9800-PRINT-ERRORS                                08990050
090000     END-IF.                                                      09000050
090100/                                                                 09010050
090200 2000-PROCESS-VENDOR.                                             09020050
090300     MOVE '2000-PROCESS-VENDOR          ' TO PW-CURRENT-PARAGRAPH.09030050
090400                                                                  09040050
090500     MOVE AP263-PO-NBR          TO PO-PO-NBR.                     09050050
090600     MOVE AP263-STR-NBR         TO PO-STORE-NBR.                  09060050
090700     MOVE AP263-MTCH-LVL-CDE    TO PO-MTCH-LVL-CDE.               09070050
090800     MOVE AP263-VENDOR-NAME     TO PO-VENDOR-NAME                 09080050
090900                                   PW-PREV-VENDOR-NAME.           09090050
091000     MOVE AP263-VENDOR-NBR      TO PO-VENDOR-NBR                  09100050
091100                                   PW-PREV-VENDOR-NBR.            09110050
091200     IF AP263-POSTRR-CRE-PRC-CDE = 'O'                            09120050
091300         MOVE 'MANUAL'          TO PO-RECON-SOURCE                09130050
091400                                   PW-PREV-RECON-SOURCE           09140050
091500         SET PS-MANUAL-RECON    TO TRUE                           09150050
091600     ELSE                                                         09160050
091700         IF AP263-POSTRR-CRE-PRC-CDE = 'A'                        09170050
091800             MOVE 'AUTO'        TO PO-RECON-SOURCE                09180050
091900                                   PW-PREV-RECON-SOURCE           09190050
092000             SET PS-AUTO-RECON  TO TRUE                           09200050
092100         ELSE                                                     09210050
092200             MOVE SPACES        TO PO-RECON-SOURCE                09220050
092300                                   PW-PREV-RECON-SOURCE           09230050
092400             SET PS-UNKNOWN-RECON                                 09240050
092500                                TO TRUE                           09250050
092600         END-IF                                                   09260050
092700     END-IF.                                                      09270050
092800     PERFORM 9100-PRINT-PO-HDR-LINE.                              09280050
092900/                                                                 09290050
093000 3000-PROCESS-INVOICE.                                            09300050
093100     MOVE '3000-PROCESS-INVOICE         ' TO PW-CURRENT-PARAGRAPH.09310050
093200*                                                                 09320050
093300     MOVE AP263-INVOICE-NBR        TO IT-INVOICE-NBR (IT-IND)     09330050
093400                                      PW-PREV-INVOICE-NBR.        09340050
093500     MOVE AP263-INVOICE-TYPE       TO IT-INVOICE-TYPE   (IT-IND). 09350050
093600     MOVE AP263-ENTRY-METHOD       TO IT-ENTRY-METHOD   (IT-IND). 09360050
093700     MOVE AP263-DUE-DATE           TO IT-DUE-DATE       (IT-IND). 09370050
093800     MOVE AP263-INVOICE-QTY        TO IT-INVOICE-QTY    (IT-IND). 09380050
093900     MOVE AP263-GROSS-INVOICE-AMT  TO IT-GROSS-AMT      (IT-IND). 09390050
094000     MOVE AP263-TERMS-PCT          TO IT-TERMS-PCT      (IT-IND). 09400050
094100     MOVE AP263-ALW-IND            TO IT-ALW-IND        (IT-IND). 09410050
094200                                                                  09420050
094300     SET IT-IND UP BY 1.                                          09430050
094400     ADD 1 TO IT-IND-MAX.                                         09440050
094500     IF IT-IND-MAX > IT-IND-LIMIT                                 09450050
094600        DISPLAY 'PO NBR IN PROCESS =  ' AP263-PO-NBR              09460050
094700        MOVE '3000-PROCESS-INVOICE ' TO WS-ABEND-PARAGRAPH        09470050
094800        MOVE 'IT-INVOICE-TABLE SUBSCRIPT EXCEEDS LIMIT '          09480050
094900                                   TO WS-ABEND-OPERATION          09490050
095000        SET TABLE-ERROR            TO TRUE                        09500050
095100        PERFORM 9999-ABEND                                        09510050
095200     END-IF.                                                      09520050
095300                                                                  09530050
095400/                                                                 09540050
095500 4000-PROCESS-RECEIVER.                                           09550050
095600     MOVE '4000-PROCESS-RECEIVER        ' TO PW-CURRENT-PARAGRAPH.09560050
095700*                                                                 09570050
095800     IF AP263-RECVR-SEQ-NBR = PW-PREV-SEQ-NBR   AND               09580050
095900        AP263-RECVR-TYPE    = PW-PREV-TYP                         09590050
096000         ADD  AP263-RECVR-QTY      TO RT-RECVR-QTY    (RT-IND - 1)09600050
096100         ADD  AP263-RECVR-AMT      TO RT-RECVR-AMT    (RT-IND - 1)09610050
096200     ELSE                                                         09620050
096300         MOVE AP263-RECVR-SEQ-NBR  TO RT-RECVR-SEQ-NO (RT-IND)    09630050
096400                                      PW-PREV-SEQ-NBR             09640050
096500         MOVE AP263-RECVR-TYPE     TO RT-RECVR-TYPE   (RT-IND)    09650050
096600                                      PW-PREV-TYP                 09660050
096700         MOVE AP263-RECVR-QTY      TO RT-RECVR-QTY    (RT-IND)    09670050
096800         MOVE AP263-RECVR-AMT      TO RT-RECVR-AMT    (RT-IND)    09680050
096900         SET RT-IND                UP BY 1                        09690050
097000         ADD 1                     TO RT-IND-MAX                  09700050
097100         IF RT-IND-MAX > RT-IND-LIMIT                             09710050
097200            DISPLAY 'PO NBR IN PROCESS =  ' AP263-PO-NBR          09720050
097300             MOVE '4000-PROCESS-RECEIVER' TO WS-ABEND-PARAGRAPH   09730050
097400             MOVE 'RT-RECEIVER-TABLE SUBSCRIPT EXCEEDS LIMIT'     09740050
097500                                        TO WS-ABEND-OPERATION     09750050
097600             SET TABLE-ERROR            TO TRUE                   09760050
097700             PERFORM 9999-ABEND                                   09770050
097800         END-IF                                                   09780050
097900     END-IF.                                                      09790050
098000                                                                  09800050
098100/                                                                 09810050
098200 4200-CHECK-FOR-INVC.                                             09820050
098300     MOVE '4200-CHECK-FOR-INVC' TO PW-CURRENT-PARAGRAPH.          09830050
098400                                                                  09840050
098500     SET IT-IND TO 1.                                             09850050
098600     PERFORM 4500-PREPARE-INVC                                    09860050
098700         UNTIL IT-IND > IT-IND-MAX.                               09870050
098800     SET IT-IND TO 1.                                             09880050
098900     MOVE ZERO TO IT-IND-MAX.                                     09890050
099000     INITIALIZE PW-PREV-SEQ-NBR                                   09900050
099100                    PW-PREV-TYP.                                  09910050
099200                                                                  09920050
099300     MOVE WS-INV-GROSS-AMT     TO INV-GROSS-AMOUNT.               09930050
099400     PERFORM 9600-PRINT-INV-GROSS-LINE.                           09940050
099500                                                                  09950050
099600/                                                                 09960050
099700 4300-CHECK-FOR-RCVR.                                             09970050
099800     MOVE '4300-CHECK-FOR-RCVR' TO PW-CURRENT-PARAGRAPH.          09980050
099900                                                                  09990050
100000     SET RT-IND TO 1.                                             10000050
100100     PERFORM 4400-PREPARE-RCVR                                    10010050
100200         UNTIL RT-IND > RT-IND-MAX.                               10020050
100300     SET RT-IND TO 1.                                             10030050
100400     MOVE ZERO TO RT-IND-MAX.                                     10040050
100500                                                                  10050050
100600     MOVE WS-RCVR-GROSS-AMT     TO RCVR-GROSS-AMOUNT.             10060050
100700     PERFORM 9620-PRINT-RCVR-GROSS-LINE.                          10070050
100800                                                                  10080050
100900/                                                                 10090050
101000 4400-PREPARE-RCVR.                                               10100050
101100     MOVE '4400-PREPARE-RCVR' TO PW-CURRENT-PARAGRAPH.            10110050
101200                                                                  10120050
101300     IF RT-IND > RT-IND-MAX                                       10130050
101400         MOVE SPACES TO INV-RECVR-DETAIL-LINE                     10140050
101500     ELSE                                                         10150050
101600         MOVE RT-RECVR-SEQ-NO   (RT-IND) TO INV-RECVR-SEQ-NO      10160050
101700         MOVE RT-RECVR-TYPE     (RT-IND) TO INV-RECVR-TYPE        10170050
101800         MOVE RT-RECVR-QTY      (RT-IND) TO INV-RECVR-QTY         10180050
101900         MOVE RT-RECVR-AMT      (RT-IND) TO INV-RECVR-AMT         10190050
102000         ADD RT-RECVR-AMT       (RT-IND) TO WS-RCVR-GROSS-AMT     10200050
102100         SET RT-IND UP BY 1                                       10210050
102200     END-IF.                                                      10220050
102300                                                                  10230050
102400     PERFORM 9500-PRINT-RCVR-DETAIL-LINE.                         10240050
102500                                                                  10250050
102600/                                                                 10260050
102700 4500-PREPARE-INVC.                                               10270050
102800     MOVE '4500-PREPARE-INVC' TO PW-CURRENT-PARAGRAPH.            10280050
102900                                                                  10290050
103000     IF IT-IND > IT-IND-MAX                                       10300050
103100         MOVE SPACES TO INV-INVOICE-DETAIL-LINE                   10310050
103200     ELSE                                                         10320050
103300         MOVE IT-INVOICE-NBR    (IT-IND) TO INV-INVOICE-NBR       10330050
103400         MOVE IT-ENTRY-METHOD   (IT-IND) TO INV-ENTRY-METHOD      10340050
103500         MOVE IT-DUE-YEAR       (IT-IND) TO INV-DUE-DATE-YY       10350050
103600         MOVE IT-DUE-MONTH      (IT-IND) TO INV-DUE-DATE-MM       10360050
103700         MOVE IT-DUE-DAY        (IT-IND) TO INV-DUE-DATE-DD       10370050
103800         MOVE IT-INVOICE-QTY    (IT-IND) TO INV-INVOICE-QTY       10380050
103900         MOVE IT-GROSS-AMT      (IT-IND) TO INV-GROSS-INVOICE-AMT 10390050
104000*        MOVE IT-TERMS-PCT      (IT-IND) TO INV-TERMS-PCT         10400050
104100         COMPUTE INV-TERMS-PCT = IT-TERMS-PCT (IT-IND) * 100      10410050
104200         MOVE IT-ALW-IND        (IT-IND) TO INV-ALW-IND           10420050
104300         IF IT-INVOICE-TYPE(IT-IND) = 'MI'                        10430050
104400             ADD 1                       TO PW-BREAK-COUNT-INVC   10440050
104500             ADD IT-GROSS-AMT (IT-IND)   TO PW-BREAK-AMOUNT-INVC  10450050
104600             IF PS-MANUAL-RECON                                   10460050
104700                ADD 1                    TO PW-BREAK-COUNT-INVC-M 10470050
104800                ADD IT-GROSS-AMT (IT-IND)                         10480050
104900                                         TO PW-BREAK-AMOUNT-INVC-M10490050
105000             ELSE                                                 10500050
105100                ADD 1                    TO PW-BREAK-COUNT-INVC-A 10510050
105200                ADD IT-GROSS-AMT (IT-IND)                         10520050
105300                                         TO PW-BREAK-AMOUNT-INVC-A10530050
105400             END-IF                                               10540050
105500         ELSE                                                     10550050
105600             ADD 1                       TO PW-BREAK-COUNT-REM    10560050
105700             ADD IT-GROSS-AMT (IT-IND)   TO PW-BREAK-AMOUNT-REM   10570050
105800             IF PS-MANUAL-RECON                                   10580050
105900                ADD 1                    TO PW-BREAK-COUNT-REM-M  10590050
106000                ADD IT-GROSS-AMT (IT-IND)                         10600050
106100                                         TO PW-BREAK-AMOUNT-REM-M 10610050
106200             ELSE                                                 10620050
106300                ADD 1                    TO PW-BREAK-COUNT-REM-A  10630050
106400                ADD IT-GROSS-AMT (IT-IND)                         10640050
106500                                         TO PW-BREAK-AMOUNT-REM-A 10650050
106600             END-IF                                               10660050
106700         END-IF                                                   10670050
106800                                                                  10680050
106900         ADD IT-GROSS-AMT (IT-IND)     TO WS-INV-GROSS-AMT        10690050
107000         SET IT-IND UP BY 1                                       10700050
107100     END-IF.                                                      10710050
107200                                                                  10720050
107300     PERFORM 9200-PRINT-INV-DETAIL-LINE.                          10730050
107400                                                                  10740050
107500/                                                                 10750050
107600 5000-PROCESS-INVOICE-ADJ.                                        10760050
107700     MOVE '5000-PROCESS-INVOICE-ADJ     ' TO PW-CURRENT-PARAGRAPH.10770050
107800                                                                  10780050
107900     IF NOT PREV-INVOICE-ADJ-RECORD                               10790050
108000         MOVE AP263-TRAN-CODE       TO PW-PREV-TRAN-CODE          10800050
108100         MOVE AP263-DOC-TYP         TO PW-PREV-DOC-TYP            10810050
108200         PERFORM 9300-PRINT-RESULTS-HDR-LINE                      10820050
108300     END-IF.                                                      10830050
108400                                                                  10840050
108500     IF AP263-TRAN-CODE NOT EQUAL PW-PREV-TRAN-CODE               10850050
108600         PERFORM 9645-PRINT-INV-TRN-TTL-LINE                      10860050
108700     END-IF.                                                      10870050
108800                                                                  10880050
108900     MOVE AP263-DOC-TYP             TO RES-DOC-TYP.               10890050
109000     MOVE AP263-DOC-NBR             TO RES-DOC-NO.                10900050
109100     MOVE AP263-TRAN-CODE           TO RES-TRAN-CODE.             10910050
109200     MOVE AP263-RELATED-INV-NBR     TO RES-RELATED-INV-NBR.       10920050
109300     MOVE AP263-PO-LINE-NBR         TO RES-PO-LINE-NO.            10930050
109400     MOVE AP263-UNIT-QTY            TO RES-UNIT-QTY.              10940050
109500     MOVE AP263-UNIT-COST           TO RES-UNIT-COST.             10950050
109600     MOVE AP263-REC-COST            TO RES-REC-COST.              10960050
109700     MOVE AP263-EXTD-COST           TO RES-EXTD-COST.             10970050
109800                                                                  10980050
109900     IF DEBIT-ADJ                                                 10990050
110000         ADD AP263-EXTD-COST        TO WS-TRAN-DM-ADJ-AMT         11000050
110100     ELSE                                                         11010050
110200         ADD AP263-EXTD-COST        TO WS-TRAN-CM-ADJ-AMT         11020050
110300     END-IF.                                                      11030050
110400                                                                  11040050
110500     IF AP263-TRAN-CODE = 12                                      11050050
110600         ADD AP263-EXTD-COST        TO PW-BREAK-AMOUNT-REM-ADD    11060050
110700         IF PS-MANUAL-RECON                                       11070050
110800            ADD AP263-EXTD-COST                                   11080050
110900                                    TO PW-BREAK-AMOUNT-REM-ADD-M  11090050
111000         ELSE                                                     11100050
111100            ADD AP263-EXTD-COST                                   11110050
111200                                    TO PW-BREAK-AMOUNT-REM-ADD-A  11120050
111300         END-IF                                                   11130050
111400         IF AP263-DOC-NBR  NOT = PW-PREV-RI-DOC-NO                11140050
111500             ADD 1                  TO PW-BREAK-COUNT-REM-ADD     11150050
111600             MOVE AP263-DOC-NBR     TO PW-PREV-RI-DOC-NO          11160050
111700             IF PS-MANUAL-RECON                                   11170050
111800                ADD 1               TO PW-BREAK-COUNT-REM-ADD-M   11180050
111900             ELSE                                                 11190050
112000                ADD 1               TO PW-BREAK-COUNT-REM-ADD-A   11200050
112100             END-IF                                               11210050
112200         END-IF                                                   11220050
112300     END-IF.                                                      11230050
112400                                                                  11240050
112500     PERFORM 9400-PRINT-RES-DETAIL-LINE.                          11250050
112600                                                                  11260050
112700     MOVE AP263-TRAN-CODE           TO PW-PREV-TRAN-CODE.         11270050
112800     MOVE AP263-DOC-TYP             TO PW-PREV-DOC-TYP.           11280050
112900/                                                                 11290050
113000 6000-PROCESS-RECEIVER-ADJ.                                       11300050
113100/                                                                 11310050
113200     MOVE '6000-PROCESS-RECEIVER-ADJ    ' TO PW-CURRENT-PARAGRAPH.11320050
113300                                                                  11330050
113400     IF NOT PREV-RECEIVER-ADJ-RECORD                              11340050
113500         MOVE AP263-TRAN-CODE       TO PW-PREV-TRAN-CODE          11350050
113600         MOVE AP263-DOC-TYP         TO PW-PREV-DOC-TYP            11360050
113700         PERFORM 9300-PRINT-RESULTS-HDR-LINE.                     11370050
113800                                                                  11380050
113900     IF AP263-TRAN-CODE NOT EQUAL PW-PREV-TRAN-CODE               11390050
114000         PERFORM 9665-PRINT-RCVR-TRN-TTL-LINE                     11400050
114100     END-IF.                                                      11410050
114200                                                                  11420050
114300     MOVE AP263-DOC-TYP             TO RES-DOC-TYP.               11430050
114400     MOVE AP263-DOC-NBR             TO RES-DOC-NO.                11440050
114500     MOVE AP263-TRAN-CODE           TO RES-TRAN-CODE.             11450050
114600     MOVE AP263-RELATED-INV-NBR     TO RES-RELATED-INV-NBR.       11460050
114700     MOVE AP263-PO-LINE-NBR         TO RES-PO-LINE-NO.            11470050
114800     MOVE AP263-UNIT-QTY            TO RES-UNIT-QTY.              11480050
114900     MOVE AP263-UNIT-COST           TO RES-UNIT-COST.             11490050
115000     MOVE AP263-REC-COST            TO RES-REC-COST.              11500050
115100     MOVE AP263-EXTD-COST           TO RES-EXTD-COST.             11510050
115200                                                                  11520050
115300     IF DEBIT-ADJ                                                 11530050
115400         ADD AP263-EXTD-COST        TO WS-TRAN-DM-ADJ-AMT         11540050
115500     ELSE                                                         11550050
115600         ADD AP263-EXTD-COST        TO WS-TRAN-CM-ADJ-AMT         11560050
115700     END-IF.                                                      11570050
115800                                                                  11580050
115900     PERFORM 9400-PRINT-RES-DETAIL-LINE.                          11590050
116000                                                                  11600050
116100     MOVE AP263-TRAN-CODE           TO PW-PREV-TRAN-CODE.         11610050
116200     MOVE AP263-DOC-TYP             TO PW-PREV-DOC-TYP.           11620050
116300/                                                                 11630050
116400 7000-INITIALIZATION.                                             11640050
116500     MOVE '7000-INITIALIZATION          ' TO PW-CURRENT-PARAGRAPH.11650050
116600*                                                                 11660050
116700     OPEN INPUT RESULTS-INVOICE-FILE.                             11670050
116800     OPEN OUTPUT RECON-REPORT-FILE                                11680050
116900                 ERROR-FILE.                                      11690050
117000                                                                  11700050
117100     ACCEPT PW-CURRENT-DATE FROM DATE.                            11710050
117200                                                                  11720050
117300     MOVE PW-CURRENT-MONTH            TO DP133O-RUN-MONTH.        11730050
117400     MOVE PW-CURRENT-DAY              TO DP133O-RUN-DAY.          11740050
117500     MOVE PW-CURRENT-YEAR             TO DP133O-RUN-YEAR.         11750050
117600     ACCEPT PW-CURRENT-TIME FROM TIME.                            11760050
117700     MOVE PW-CURRENT-HOUR             TO DP133O-RUN-HOUR.         11770050
117800     MOVE PW-CURRENT-MINUTE           TO DP133O-RUN-MINUTE.       11780050
117900     MOVE PW-REPORT-NAME              TO DP133O-PROGRAM-NAME.     11790050
118000     MOVE 1                           TO DP133O-REPORT-NUMBER.    11800050
118100     PERFORM 8000-READ-RESULTS-INVOICE-FILE.                      11810050
118200     SET IT-IND TO 1.                                             11820050
118300     SET RT-IND TO 1.                                             11830050
118400     IF END-OF-PROCESSING                                         11840050
118500         PERFORM 9000-NEW-PAGE-PROCESSING                         11850050
118600         PERFORM 9700-PRINT-TOTAL-LINE                            11860050
118700     END-IF.                                                      11870050
118800/                                                                 11880050
118900 8000-READ-RESULTS-INVOICE-FILE.                                  11890050
119000     MOVE '8000-READ-RESULTS-INVOICE-FILE   '                     11900050
119100         TO PW-CURRENT-PARAGRAPH.                                 11910050
119200*                                                                 11920050
119300     READ RESULTS-INVOICE-FILE                                    11930050
119400          INTO AP263-RECORD                                       11940050
119500          AT END SET END-OF-PROCESSING TO TRUE.                   11950050
119600     IF NOT END-OF-PROCESSING                                     11960050
119700         ADD 1 TO PW-INPUT-COUNT.                                 11970050
119800*                                                                 11980050
119900/                                                                 11990050
120000 9000-NEW-PAGE-PROCESSING.                                        12000050
120100     MOVE '9000-NEW-PAGE-PROCESSING     ' TO PW-CURRENT-PARAGRAPH.12010050
120200*                                                                 12020050
120300     ADD 1                            TO PW-PAGE-COUNT.           12030050
120400     MOVE PW-PAGE-COUNT               TO DP133O-PAGE-NUMBER.      12040050
120500*                                                                 12050050
120600     WRITE RECON-REPORT-REC FROM DP133O-STANDRD-HEADER-133-COLS   12060050
120700               AFTER ADVANCING PAGE.                              12070050
120800     WRITE RECON-REPORT-REC FROM HDR-LINE-2                       12080050
120900               AFTER ADVANCING 1 LINE.                            12090050
121000     WRITE RECON-REPORT-REC FROM INV-HDR-1                        12100050
121100               AFTER ADVANCING 2 LINES.                           12110050
121200     INITIALIZE RECON-REPORT-REC.                                 12120050
121300     WRITE RECON-REPORT-REC                                       12130050
121400               AFTER ADVANCING 1 LINE.                            12140050
121500*                                                                 12150050
121600     MOVE PW-LINES-IN-HDR             TO PW-LINE-COUNT.           12160050
121700*                                                                 12170050
121800/                                                                 12180050
121900 9100-PRINT-PO-HDR-LINE.                                          12190050
122000     MOVE '9100-PRINT-PO-HDR-LINE         ' TO                    12200050
122100         PW-CURRENT-PARAGRAPH.                                    12210050
122200*                                                                 12220050
122300     IF PW-LINE-COUNT > PW-LINES-IN-HDR                           12230050
122400         ADD 1                        TO PW-LINE-COUNT            12240050
122500         IF PW-LINE-COUNT >= PW-MAX-LINES                         12250050
122600             PERFORM 9000-NEW-PAGE-PROCESSING                     12260050
122700         ELSE                                                     12270050
122800             WRITE RECON-REPORT-REC FROM PO-SEPARATOR             12280050
122900                     AFTER ADVANCING 1 LINE                       12290050
123000         END-IF                                                   12300050
123100     END-IF.                                                      12310050
123200                                                                  12320050
123300     ADD 1                            TO PW-LINE-COUNT.           12330050
123400     IF PW-LINE-COUNT >= PW-MAX-LINES                             12340050
123500         PERFORM 9000-NEW-PAGE-PROCESSING                         12350050
123600         ADD 1                        TO PW-LINE-COUNT            12360050
123700     END-IF.                                                      12370050
123800                                                                  12380050
123900     WRITE RECON-REPORT-REC FROM PO-HDR-1                         12390050
124000             AFTER ADVANCING 1 LINE.                              12400050
124100                                                                  12410050
124200     INITIALIZE PO-HDR-1.                                         12420050
124300/                                                                 12430050
124400 9200-PRINT-INV-DETAIL-LINE.                                      12440050
124500     MOVE '9200-PRINT-INV-DETAIL-LINE     ' TO                    12450050
124600         PW-CURRENT-PARAGRAPH.                                    12460050
124700*                                                                 12470050
124800     ADD 1                            TO PW-LINE-COUNT.           12480050
124900     IF PW-LINE-COUNT >= PW-MAX-LINES                             12490050
125000         PERFORM 9000-NEW-PAGE-PROCESSING                         12500050
125100         ADD 1                        TO PW-LINE-COUNT            12510050
125200     END-IF.                                                      12520050
125300                                                                  12530050
125400     WRITE RECON-REPORT-REC FROM INV-INVOICE-DETAIL-LINE          12540050
125500             AFTER ADVANCING 1 LINE.                              12550050
125600                                                                  12560050
125700     INITIALIZE INV-INVOICE-DETAIL-LINE.                          12570050
125800/                                                                 12580050
125900 9300-PRINT-RESULTS-HDR-LINE.                                     12590050
126000     MOVE '9300-PRINT-RESULTS-HDR-LINE  ' TO PW-CURRENT-PARAGRAPH.12600050
126100*                                                                 12610050
126200     ADD 3                            TO PW-LINE-COUNT.           12620050
126300     IF PW-LINE-COUNT >= PW-MAX-LINES                             12630050
126400         PERFORM 9000-NEW-PAGE-PROCESSING                         12640050
126500         ADD 3                        TO PW-LINE-COUNT            12650050
126600     ELSE                                                         12660050
126700         SUBTRACT 1 FROM PW-LINE-COUNT                            12670050
126800     END-IF.                                                      12680050
126900                                                                  12690050
127000     WRITE RECON-REPORT-REC FROM RES-HDR-1                        12700050
127100             AFTER ADVANCING 1 LINE.                              12710050
127200/                                                                 12720050
127300 9400-PRINT-RES-DETAIL-LINE.                                      12730050
127400     MOVE '9400-PRINT-RES-DETAIL-LINE   ' TO PW-CURRENT-PARAGRAPH.12740050
127500*                                                                 12750050
127600     ADD 1                            TO PW-LINE-COUNT.           12760050
127700     IF PW-LINE-COUNT >= PW-MAX-LINES                             12770050
127800         PERFORM 9000-NEW-PAGE-PROCESSING                         12780050
127900         PERFORM 9300-PRINT-RESULTS-HDR-LINE                      12790050
128000         ADD 3                        TO PW-LINE-COUNT            12800050
128100     END-IF.                                                      12810050
128200                                                                  12820050
128300     WRITE RECON-REPORT-REC FROM RES-DETAIL-LINE                  12830050
128400             AFTER ADVANCING 1 LINE.                              12840050
128500     INITIALIZE RES-DETAIL-LINE.                                  12850050
128600/                                                                 12860050
128700 9500-PRINT-RCVR-DETAIL-LINE.                                     12870050
128800     MOVE '9500-PRINT-RCVR-DETAIL-LINE     ' TO                   12880050
128900         PW-CURRENT-PARAGRAPH.                                    12890050
129000*                                                                 12900050
129100     ADD 1                            TO PW-LINE-COUNT.           12910050
129200     IF PW-LINE-COUNT >= PW-MAX-LINES                             12920050
129300         PERFORM 9000-NEW-PAGE-PROCESSING                         12930050
129400         ADD 1                        TO PW-LINE-COUNT            12940050
129500     END-IF.                                                      12950050
129600                                                                  12960050
129700     WRITE RECON-REPORT-REC FROM INV-RECVR-DETAIL-LINE            12970050
129800             AFTER ADVANCING 1 LINE.                              12980050
129900                                                                  12990050
130000     INITIALIZE INV-RECVR-DETAIL-LINE.                            13000050
130100/                                                                 13010050
130200 9600-PRINT-INV-GROSS-LINE.                                       13020050
130300     MOVE '9600-PRINT-INV-GROSS-LINE    ' TO PW-CURRENT-PARAGRAPH.13030050
130400*                                                                 13040050
130500     ADD 1                            TO PW-LINE-COUNT.           13050050
130600     IF PW-LINE-COUNT >= PW-MAX-LINES                             13060050
130700         PERFORM 9000-NEW-PAGE-PROCESSING                         13070050
130800         ADD 1                        TO PW-LINE-COUNT            13080050
130900     END-IF.                                                      13090050
131000                                                                  13100050
131100     WRITE RECON-REPORT-REC FROM INV-GROSS-LINE                   13110050
131200             AFTER ADVANCING 1 LINES.                             13120050
131300                                                                  13130050
131400/                                                                 13140050
131500 9620-PRINT-RCVR-GROSS-LINE.                                      13150050
131600     MOVE '9620-PRINT-RCVR-GROSS-LINE   ' TO PW-CURRENT-PARAGRAPH.13160050
131700*                                                                 13170050
131800     ADD 1                            TO PW-LINE-COUNT.           13180050
131900     IF PW-LINE-COUNT >= PW-MAX-LINES                             13190050
132000         PERFORM 9000-NEW-PAGE-PROCESSING                         13200050
132100         ADD 1                        TO PW-LINE-COUNT            13210050
132200     END-IF.                                                      13220050
132300                                                                  13230050
132400     WRITE RECON-REPORT-REC FROM RCVR-GROSS-LINE                  13240050
132500             AFTER ADVANCING 1 LINES.                             13250050
132600                                                                  13260050
132700/                                                                 13270050
132800 9640-PRINT-INV-NET-LINE.                                         13280050
132900     MOVE '9640-PRINT-INV-NET-LINE    ' TO PW-CURRENT-PARAGRAPH.  13290050
133000*                                                                 13300050
133100     ADD 2                            TO PW-LINE-COUNT.           13310050
133200     IF PW-LINE-COUNT >= PW-MAX-LINES                             13320050
133300         PERFORM 9000-NEW-PAGE-PROCESSING                         13330050
133400         ADD 2                        TO PW-LINE-COUNT            13340050
133500     END-IF.                                                      13350050
133600                                                                  13360050
133700     IF WS-TRAN-DM-ADJ-AMT GREATER THAN ZERO OR                   13370050
133800             WS-TRAN-CM-ADJ-AMT GREATER THAN ZERO                 13380050
133900         PERFORM 9645-PRINT-INV-TRN-TTL-LINE                      13390050
134000     END-IF.                                                      13400050
134100                                                                  13410050
134200     WRITE RECON-REPORT-REC FROM TOTAL-SEPARATOR                  13420050
134300             AFTER ADVANCING 1 LINES.                             13430050
134400                                                                  13440050
134500     COMPUTE WS-INV-NET-AMT = WS-INV-GROSS-AMT                    13450050
134600                       - WS-INV-DM-ADJ-AMT +  WS-INV-CM-ADJ-AMT.  13460050
134700                                                                  13470050
134800     MOVE WS-INV-NET-AMT              TO INV-NET-AMOUNT.          13480050
134900     WRITE RECON-REPORT-REC FROM INV-NET-LINE                     13490050
135000             AFTER ADVANCING 1 LINES.                             13500050
135100                                                                  13510050
135200                                                                  13520050
135300     MOVE ZERO                        TO WS-INV-NET-AMT           13530050
135400                                         WS-INV-GROSS-AMT         13540050
135500                                         WS-INV-DM-ADJ-AMT        13550050
135600                                         WS-INV-CM-ADJ-AMT.       13560050
135700/                                                                 13570050
135800 9645-PRINT-INV-TRN-TTL-LINE.                                     13580050
135900     MOVE '9645-PRINT-INV-TRN-TTL-LINE ' TO PW-CURRENT-PARAGRAPH. 13590050
136000*                                                                 13600050
136100     ADD 1                            TO PW-LINE-COUNT.           13610050
136200     IF PW-LINE-COUNT >= PW-MAX-LINES                             13620050
136300         PERFORM 9000-NEW-PAGE-PROCESSING                         13630050
136400         ADD 1                        TO PW-LINE-COUNT            13640050
136500     END-IF.                                                      13650050
136600                                                                  13660050
136700     IF WS-TRAN-DM-ADJ-AMT GREATER THAN ZERO                      13670050
136800         ADD WS-TRAN-DM-ADJ-AMT       TO WS-INV-DM-ADJ-AMT        13680050
136900         MOVE WS-TRAN-DM-ADJ-AMT      TO EXT-TOTAL-TRAN-AMOUNT    13690050
137000         MOVE '<'                     TO EXT-LEFT-NEG-PAR         13700050
137100         MOVE '>'                     TO EXT-RIGHT-NEG-PAR        13710050
137200     ELSE                                                         13720050
137300         ADD WS-TRAN-CM-ADJ-AMT       TO WS-INV-CM-ADJ-AMT        13730050
137400         MOVE WS-TRAN-CM-ADJ-AMT      TO EXT-TOTAL-TRAN-AMOUNT    13740050
137500         MOVE SPACES                  TO EXT-LEFT-NEG-PAR         13750050
137600                                         EXT-RIGHT-NEG-PAR        13760050
137700     END-IF.                                                      13770050
137800                                                                  13780050
137900     WRITE RECON-REPORT-REC FROM EXT-COST-TOTAL-LINE              13790050
138000               AFTER ADVANCING 1 LINES.                           13800050
138100                                                                  13810050
138200     MOVE ZERO                        TO EXT-TOTAL-TRAN-AMOUNT    13820050
138300                                         WS-TRAN-DM-ADJ-AMT       13830050
138400                                         WS-TRAN-CM-ADJ-AMT.      13840050
138500                                                                  13850050
138600/                                                                 13860050
138700 9660-PRINT-RCVR-NET-LINE.                                        13870050
138800     MOVE '9660-PRINT-RCVR-NET-LINE   ' TO PW-CURRENT-PARAGRAPH.  13880050
138900*                                                                 13890050
139000     ADD 2                            TO PW-LINE-COUNT.           13900050
139100     IF PW-LINE-COUNT >= PW-MAX-LINES                             13910050
139200         PERFORM 9000-NEW-PAGE-PROCESSING                         13920050
139300         ADD 2                        TO PW-LINE-COUNT            13930050
139400     END-IF.                                                      13940050
139500                                                                  13950050
139600     IF WS-TRAN-DM-ADJ-AMT GREATER THAN ZERO OR                   13960050
139700             WS-TRAN-CM-ADJ-AMT GREATER THAN ZERO                 13970050
139800         PERFORM 9665-PRINT-RCVR-TRN-TTL-LINE                     13980050
139900     END-IF.                                                      13990050
140000                                                                  14000050
140100     WRITE RECON-REPORT-REC FROM TOTAL-SEPARATOR                  14010050
140200             AFTER ADVANCING 1 LINES.                             14020050
140300                                                                  14030050
140400     COMPUTE WS-RCVR-NET-AMT = WS-RCVR-GROSS-AMT                  14040050
140500                     - WS-RCVR-DM-ADJ-AMT +  WS-RCVR-CM-ADJ-AMT.  14050050
140600                                                                  14060050
140700     MOVE WS-RCVR-NET-AMT             TO RCVR-NET-AMOUNT.         14070050
140800     WRITE RECON-REPORT-REC FROM RCVR-NET-LINE                    14080050
140900             AFTER ADVANCING 1 LINES.                             14090050
141000                                                                  14100050
141100     MOVE ZERO                        TO WS-RCVR-NET-AMT          14110050
141200                                         WS-RCVR-GROSS-AMT        14120050
141300                                         WS-RCVR-DM-ADJ-AMT       14130050
141400                                         WS-RCVR-CM-ADJ-AMT.      14140050
141500/                                                                 14150050
141600 9665-PRINT-RCVR-TRN-TTL-LINE.                                    14160050
141700     MOVE '9665-PRINT-RCVR-TRN-TTL-LINE' TO PW-CURRENT-PARAGRAPH. 14170050
141800*                                                                 14180050
141900     ADD 1                            TO PW-LINE-COUNT.           14190050
142000     IF PW-LINE-COUNT >= PW-MAX-LINES                             14200050
142100         PERFORM 9000-NEW-PAGE-PROCESSING                         14210050
142200         ADD 1                        TO PW-LINE-COUNT            14220050
142300     END-IF.                                                      14230050
142400                                                                  14240050
142500     IF WS-TRAN-DM-ADJ-AMT GREATER THAN ZERO                      14250050
142600         ADD WS-TRAN-DM-ADJ-AMT       TO WS-RCVR-DM-ADJ-AMT       14260050
142700         MOVE WS-TRAN-DM-ADJ-AMT      TO EXT-TOTAL-TRAN-AMOUNT    14270050
142800         MOVE '<'                     TO EXT-LEFT-NEG-PAR         14280050
142900         MOVE '>'                     TO EXT-RIGHT-NEG-PAR        14290050
143000     ELSE                                                         14300050
143100         ADD WS-TRAN-CM-ADJ-AMT       TO WS-RCVR-CM-ADJ-AMT       14310050
143200         MOVE WS-TRAN-CM-ADJ-AMT      TO EXT-TOTAL-TRAN-AMOUNT    14320050
143300         MOVE SPACES                  TO EXT-LEFT-NEG-PAR         14330050
143400                                         EXT-RIGHT-NEG-PAR        14340050
143500     END-IF.                                                      14350050
143600                                                                  14360050
143700     WRITE RECON-REPORT-REC FROM EXT-COST-TOTAL-LINE              14370050
143800               AFTER ADVANCING 1 LINES.                           14380050
143900                                                                  14390050
144000     MOVE ZERO                        TO EXT-TOTAL-TRAN-AMOUNT    14400050
144100                                         WS-TRAN-DM-ADJ-AMT       14410050
144200                                         WS-TRAN-CM-ADJ-AMT.      14420050
144300                                                                  14430050
144400/                                                                 14440050
144500 9700-PRINT-TOTAL-LINE.                                           14450050
144600     MOVE '9700-PRINT-TOTAL-LINE        ' TO PW-CURRENT-PARAGRAPH.14460050
144700*                                                                 14470050
144800     ADD 4                            TO PW-LINE-COUNT.           14480050
144900     IF PW-LINE-COUNT >= PW-MAX-LINES                             14490050
145000         PERFORM 9000-NEW-PAGE-PROCESSING                         14500050
145100         ADD 4                        TO PW-LINE-COUNT            14510050
145200     END-IF.                                                      14520050
145300                                                                  14530050
145400     WRITE RECON-REPORT-REC FROM EM-TOTAL-HDR                     14540050
145500             AFTER ADVANCING 2 LINES.                             14550050
145600                                                                  14560050
145700     MOVE ' MERCHANDISE INVOICES' TO EM-TOTAL-INVOICE-TYPE.       14570050
145800     MOVE PW-BREAK-COUNT-INVC     TO EM-TOTAL-BREAK-COUNT.        14580050
145900     MOVE PW-BREAK-AMOUNT-INVC    TO EM-TOTAL-BREAK-AMOUNT.       14590050
146000                                                                  14600050
146100     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE                    14610050
146200             AFTER ADVANCING 1 LINE.                              14620050
146300                                                                  14630050
146400     MOVE ' --> MAN RECON MERCH INVCS' TO EM-TOTAL-INVOICE-TYPE.  14640050
146500     MOVE PW-BREAK-COUNT-INVC-M   TO EM-TOTAL-BREAK-COUNT.        14650050
146600     MOVE PW-BREAK-AMOUNT-INVC-M  TO EM-TOTAL-BREAK-AMOUNT.       14660050
146700                                                                  14670050
146800     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE                    14680050
146900             AFTER ADVANCING 1 LINE.                              14690050
147000                                                                  14700050
147100     MOVE ' --> AUTO RECON MERCH INVCS' TO EM-TOTAL-INVOICE-TYPE. 14710050
147200     MOVE PW-BREAK-COUNT-INVC-A   TO EM-TOTAL-BREAK-COUNT.        14720050
147300     MOVE PW-BREAK-AMOUNT-INVC-A  TO EM-TOTAL-BREAK-AMOUNT.       14730050
147400                                                                  14740050
147500     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE                    14750050
147600             AFTER ADVANCING 1 LINE.                              14760050
147700                                                                  14770050
147800     MOVE ' RELEASED REMAINDER INVOICES' TO EM-TOTAL-INVOICE-TYPE.14780050
147900     MOVE PW-BREAK-COUNT-REM             TO EM-TOTAL-BREAK-COUNT. 14790050
148000     MOVE PW-BREAK-AMOUNT-REM            TO EM-TOTAL-BREAK-AMOUNT.14800050
148100                                                                  14810050
148200     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE                    14820050
148300             AFTER ADVANCING 1 LINE.                              14830050
148400                                                                  14840050
148500     MOVE ' --> MAN RECON REM INVCS    ' TO EM-TOTAL-INVOICE-TYPE.14850050
148600     MOVE PW-BREAK-COUNT-REM-M           TO EM-TOTAL-BREAK-COUNT. 14860050
148700     MOVE PW-BREAK-AMOUNT-REM-M          TO EM-TOTAL-BREAK-AMOUNT.14870050
148800                                                                  14880050
148900     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE                    14890050
149000             AFTER ADVANCING 1 LINE.                              14900050
149100                                                                  14910050
149200     MOVE ' --> AUTO RECON REM INVCS   ' TO EM-TOTAL-INVOICE-TYPE.14920050
149300     MOVE PW-BREAK-COUNT-REM-A           TO EM-TOTAL-BREAK-COUNT. 14930050
149400     MOVE PW-BREAK-AMOUNT-REM-A          TO EM-TOTAL-BREAK-AMOUNT.14940050
149500                                                                  14950050
149600     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE                    14960050
149700             AFTER ADVANCING 1 LINE.                              14970050
149800                                                                  14980050
149900     MOVE ' REMAINDER INVOICE ADDITIONS'                          14990050
150000                                     TO EM-TOTAL-INVOICE-TYPE-N.  15000050
150100     MOVE PW-BREAK-COUNT-REM-ADD     TO EM-TOTAL-BREAK-COUNT-N.   15010050
150200     MOVE PW-BREAK-AMOUNT-REM-ADD    TO EM-TOTAL-BREAK-AMOUNT-N.  15020050
150300                                                                  15030050
150400     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE-N                  15040050
150500             AFTER ADVANCING 1 LINE.                              15050050
150600                                                                  15060050
150700     MOVE ' --> MAN RECON REM INVC ADDS'                          15070050
150800                                     TO EM-TOTAL-INVOICE-TYPE-N.  15080050
150900     MOVE PW-BREAK-COUNT-REM-ADD-M   TO EM-TOTAL-BREAK-COUNT-N.   15090050
151000     MOVE PW-BREAK-AMOUNT-REM-ADD-M  TO EM-TOTAL-BREAK-AMOUNT-N.  15100050
151100                                                                  15110050
151200     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE-N                  15120050
151300             AFTER ADVANCING 1 LINE.                              15130050
151400                                                                  15140050
151500     MOVE ' --> AUTO RECON REM INVC ADDS'                         15150050
151600                                      TO EM-TOTAL-INVOICE-TYPE-N. 15160050
151700     MOVE PW-BREAK-COUNT-REM-ADD-A    TO EM-TOTAL-BREAK-COUNT-N.  15170050
151800     MOVE PW-BREAK-AMOUNT-REM-ADD-A   TO EM-TOTAL-BREAK-AMOUNT-N. 15180050
151900                                                                  15190050
152000     WRITE RECON-REPORT-REC FROM EM-TOTAL-LINE-N                  15200050
152100             AFTER ADVANCING 1 LINE.                              15210050
152200                                                                  15220050
152300     INITIALIZE PW-PREV-RI-DOC-NO                                 15230050
152400                PW-BREAK-COUNT-INVC                               15240050
152500                PW-BREAK-AMOUNT-INVC                              15250050
152600                PW-BREAK-COUNT-INVC-M                             15260050
152700                PW-BREAK-AMOUNT-INVC-M                            15270050
152800                PW-BREAK-COUNT-INVC-A                             15280050
152900                PW-BREAK-AMOUNT-INVC-A                            15290050
153000                PW-BREAK-COUNT-REM                                15300050
153100                PW-BREAK-AMOUNT-REM                               15310050
153200                PW-BREAK-COUNT-REM-M                              15320050
153300                PW-BREAK-AMOUNT-REM-M                             15330050
153400                PW-BREAK-COUNT-REM-A                              15340050
153500                PW-BREAK-AMOUNT-REM-A                             15350050
153600                PW-BREAK-COUNT-REM-ADD                            15360050
153700                PW-BREAK-AMOUNT-REM-ADD                           15370050
153800                PW-BREAK-COUNT-REM-ADD-M                          15380050
153900                PW-BREAK-AMOUNT-REM-ADD-M                         15390050
154000                PW-BREAK-COUNT-REM-ADD-A                          15400050
154100                PW-BREAK-AMOUNT-REM-ADD-A.                        15410050
154200*                                                                 15420050
154300     ADD 2                            TO PW-LINE-COUNT.           15430050
154400     IF PW-LINE-COUNT >= PW-MAX-LINES                             15440050
154500         PERFORM 9000-NEW-PAGE-PROCESSING                         15450050
154600         ADD 2                        TO PW-LINE-COUNT            15460050
154700     END-IF.                                                      15470050
154800                                                                  15480050
154900     WRITE RECON-REPORT-REC FROM EOR-END-OF-REPORT AFTER 2.       15490050
155000/                                                                 15500050
155100 9800-PRINT-ERRORS.                                               15510050
155200     MOVE '9800-PRINT-ERRORS' TO PW-CURRENT-PARAGRAPH.            15520050
155300                                                                  15530050
155400     ADD 1  TO PW-ERROR-LINE-COUNT.                               15540050
155500     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       15550050
155600         PERFORM 9820-PRINT-ERROR-HEADERS                         15560050
155700         ADD 1  TO PW-ERROR-LINE-COUNT                            15570050
155800     END-IF.                                                      15580050
155900     MOVE PW-DATA-ERROR   TO ED-ERROR-MESSAGE.                    15590050
156000                                                                  15600050
156100     IF PW-NO-DETAILS       OR                                    15610050
156200        PW-MULTIPLE-VENDORS                                       15620050
156300         MOVE PW-PREV-PO-NBR                 TO ED-PO-NBR         15630050
156400         MOVE PW-PREV-STORE-NBR              TO ED-STORE-NBR      15640050
156500         MOVE PW-PREV-RECORD-TYPE            TO ED-RECORD-TYPE    15650050
156600         MOVE PW-PREV-VENDOR-NAME            TO ED-VENDOR-NAME    15660050
156700         MOVE PW-PREV-VENDOR-NBR             TO ED-VENDOR-NBR     15670050
156800         MOVE PW-PREV-RECON-SOURCE           TO ED-RECON-SOURCE   15680050
156900     ELSE                                                         15690050
157000         MOVE AP263-PO-NBR                   TO ED-PO-NBR         15700050
157100         MOVE AP263-STR-NBR                  TO ED-STORE-NBR      15710050
157200         MOVE AP263-ENTRY-METHOD             TO ED-ENTRY-METHOD   15720050
157300         MOVE AP263-RECORD-TYPE              TO ED-RECORD-TYPE    15730050
157400         IF PW-NO-VENDOR                                          15740050
157500             MOVE PW-NO-VENDOR-NAME          TO ED-VENDOR-NAME    15750050
157600             MOVE PW-NO-VENDOR-NBR           TO ED-VENDOR-NBR     15760050
157700         ELSE                                                     15770050
157800             IF VENDOR-RECORD                                     15780050
157900                 MOVE AP263-VENDOR-NAME      TO ED-VENDOR-NAME    15790050
158000                 MOVE AP263-VENDOR-NBR       TO ED-VENDOR-NBR     15800050
158100                 IF AP263-POSTRR-CRE-PRC-CDE = 'O'                15810050
158200                     MOVE 'MANUAL'           TO ED-RECON-SOURCE   15820050
158300                 ELSE                                             15830050
158400                     IF AP263-POSTRR-CRE-PRC-CDE = 'A'            15840050
158500                         MOVE 'AUTO'         TO ED-RECON-SOURCE   15850050
158600                     ELSE                                         15860050
158700                         MOVE SPACES         TO ED-RECON-SOURCE   15870050
158800                     END-IF                                       15880050
158900                 END-IF                                           15890050
159000             ELSE                                                 15900050
159100                 MOVE PW-PREV-VENDOR-NAME    TO ED-VENDOR-NAME    15910050
159200                 MOVE PW-PREV-VENDOR-NBR     TO ED-VENDOR-NBR     15920050
159300                 MOVE PW-PREV-RECON-SOURCE   TO ED-RECON-SOURCE   15930050
159400             END-IF                                               15940050
159500         END-IF                                                   15950050
159600     END-IF.                                                      15960050
159700                                                                  15970050
159800     IF PW-NO-RECEIVERS                                           15980050
159900         MOVE PW-PREV-INVOICE-NBR TO ED-INVOICE-NBR.              15990050
160000                                                                  16000050
160100     WRITE ERROR-REC FROM ED-ERROR-DETAIL AFTER 1.                16010050
160200                                                                  16020050
160300     INITIALIZE ED-ERROR-DETAIL.                                  16030050
160400     ADD 1  TO PW-ERROR-COUNT.                                    16040050
160500/                                                                 16050050
160600 9810-PRINT-END-ERROR.                                            16060050
160700     MOVE '9810-PRINT-END-ERROR' TO PW-CURRENT-PARAGRAPH.         16070050
160800                                                                  16080050
160900     ADD 2  TO PW-ERROR-LINE-COUNT.                               16090050
161000     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       16100050
161100         PERFORM 9820-PRINT-ERROR-HEADERS                         16110050
161200     END-IF.                                                      16120050
161300                                                                  16130050
161400     MOVE PW-ERROR-COUNT         TO ET-ERROR-COUNT.               16140050
161500     WRITE ERROR-REC FROM ET-ERROR-TOTALS AFTER 2.                16150050
161600                                                                  16160050
161700     ADD 2  TO PW-ERROR-LINE-COUNT.                               16170050
161800     IF PW-ERROR-LINE-COUNT >= PW-MAX-LINES                       16180050
161900         PERFORM 9820-PRINT-ERROR-HEADERS                         16190050
162000     END-IF.                                                      16200050
162100     WRITE ERROR-REC FROM EOR-END-OF-REPORT AFTER 2.              16210050
162200/                                                                 16220050
162300 9820-PRINT-ERROR-HEADERS.                                        16230050
162400                                                                  16240050
162500     MOVE '9820-PRINT-ERROR-HEADERS'  TO PW-CURRENT-PARAGRAPH.    16250050
162600                                                                  16260050
162700     ADD 1                            TO PW-ERROR-PAGE-COUNT.     16270050
162800     MOVE PW-ERROR-PAGE-COUNT         TO DP133O-PAGE-NUMBER.      16280050
162900     MOVE DP133O-REPORT-NUMBER        TO PW-SAVE-REPORT-NBR.      16290050
163000     MOVE 3                           TO DP133O-REPORT-NUMBER.    16300050
163100                                                                  16310050
163200     WRITE ERROR-REC                                              16320050
163300           FROM DP133O-STANDRD-HEADER-133-COLS AFTER PAGE.        16330050
163400     WRITE ERROR-REC FROM HDR-LINE-2 AFTER 1.                     16340050
163500     WRITE ERROR-REC FROM H3-HEADER3 AFTER 1.                     16350050
163600     WRITE ERROR-REC FROM EH-ERROR-HEADER AFTER 2.                16360050
163700                                                                  16370050
163800     MOVE PW-SAVE-REPORT-NBR TO DP133O-REPORT-NUMBER.             16380050
163900     INITIALIZE ERROR-REC.                                        16390050
164000     WRITE ERROR-REC AFTER 1.                                     16400050
164100                                                                  16410050
164200     MOVE 6                           TO PW-ERROR-LINE-COUNT.     16420050
164300/                                                                 16430050
164400 9900-END-OF-INPUT.                                               16440050
164500     MOVE '9900-END-OF-INPUT            ' TO PW-CURRENT-PARAGRAPH.16450050
164600                                                                  16460050
164700     IF PREV-INVOICE-RECORD                                       16470050
164800         PERFORM 4200-CHECK-FOR-INVC                              16480050
164900         PERFORM 9640-PRINT-INV-NET-LINE                          16490050
165000     END-IF.                                                      16500050
165100                                                                  16510050
165200     IF PREV-RECEIVER-RECORD                                      16520050
165300         PERFORM 4300-CHECK-FOR-RCVR                              16530050
165400         PERFORM 9660-PRINT-RCVR-NET-LINE                         16540050
165500     END-IF.                                                      16550050
165600                                                                  16560050
165700     IF PREV-RECEIVER-ADJ-RECORD                                  16570050
165800        PERFORM 9660-PRINT-RCVR-NET-LINE                          16580050
165900     END-IF.                                                      16590050
166000                                                                  16600050
166100     PERFORM 9810-PRINT-END-ERROR.                                16610050
166200     PERFORM 9700-PRINT-TOTAL-LINE.                               16620050
166300                                                                  16630050
166400     CLOSE RESULTS-INVOICE-FILE                                   16640050
166500           RECON-REPORT-FILE                                      16650050
166600           ERROR-FILE.                                            16660050
166700                                                                  16670050
166800     COMPUTE PW-ERROR-THRESH ROUNDED =                            16680050
166900         PW-INPUT-COUNT * PW-ERROR-PERCENT.                       16690050
167000******************************************************************16700050
167100     DISPLAY '** APKRP263 SUMMARY **'.                            16710050
167200     MOVE PW-INPUT-COUNT TO PW-DISPLAY-COUNT.                     16720050
167300     DISPLAY '** INPUT COUNT - ' PW-DISPLAY-COUNT.                16730050
167400     MOVE PW-ERROR-COUNT TO PW-DISPLAY-COUNT.                     16740050
167500     DISPLAY '** ERROR COUNT - ' PW-DISPLAY-COUNT.                16750050
167600     MOVE PW-ERROR-THRESH TO PW-DISPLAY-COUNT.                    16760050
167700     DISPLAY '** THRSH COUNT - ' PW-DISPLAY-COUNT.                16770050
167800******************************************************************16780050
167900     IF PW-ERROR-COUNT > PW-ERROR-THRESH                          16790050
168000         DISPLAY '*****************************************'      16800050
168100         DISPLAY '*                                       *'      16810050
168200         DISPLAY '* PROGRAM HAS COMPLETED ----            *'      16820050
168300         DISPLAY '* THIS ABEND HAS OCCURED BECAUSE THE    *'      16830050
168400         DISPLAY '* NUMBER OF ERRORS HAS EXCEEDED THE     *'      16840050
168500         DISPLAY '* TOLERANCE LEVEL SET UP FOR THIS PGM   *'      16850050
168600         DISPLAY '*                                       *'      16860050
168700         DISPLAY '* THIS SHOULD BE LOOKED INTO IN ORDER   *'      16870050
168800         DISPLAY '* TO DETERMINE IF THERE TRULY IS A      *'      16880050
168900         DISPLAY '* DATA PROBLEM THAT NEEDS TO BE RESOLVED*'      16890050
169000         DISPLAY '*                                       *'      16900050
169100         DISPLAY '* PROCESSING CAN CONTINUE               *'      16910050
169200         DISPLAY '*                                       *'      16920050
169300         DISPLAY '* MAX ERRORS ALLOWED REACHED            *'      16930050
169400         DISPLAY '*                                       *'      16940050
169500         DISPLAY '*****************************************'      16950050
169600         DISPLAY '                                         ' .    16960050
169700****** THIS LOGIC TO ABEND IS BEING REMOVED UNTIL WE CAN          16970050
169800****** DETERMINE A BETTER WAY TO HANDLE THIS........              16980050
169900*        MOVE PW-CURRENT-PARAGRAPH          TO WS-ABEND-PARAGRAPH 16990050
170000*        MOVE 'MAX ERRORS ALLOWED REACHED ' TO WS-ABEND-OPERATION 17000050
170100*        SET DATA-ERROR TO TRUE                                   17010050
170200*        PERFORM 9999-ABEND.                                      17020050
170300                                                                  17030050
170400***************************************************************** 17040050
170500*    ABEND ROUTINE                                               *17050050
170600***************************************************************** 17060050
170700 9999-ABEND.                                                      17070050
170800                                                                  17080050
170900     MOVE '9999-ABEND' TO PW-CURRENT-PARAGRAPH.                   17090050
171000                                                                  17100050
171100     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 17110050
171200     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               17120050
171300     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               17130050
171400     CALL 'ILBOABN0' USING WS-ABEND-CODE.                         17140050
171500                                                                  17150050
