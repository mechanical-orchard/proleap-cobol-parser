000200 IDENTIFICATION DIVISION.                                         00020000
000500 PROGRAM-ID.             MLKRP025.                                00050000
000600 AUTHOR.                 WILLIAM B. BURT.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            AUGUST, 1989.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*      THIS PROGRAM SEQUENTIALLY PROCESSES THE MARKDOWN/MARKON    00120000
001300*  FILE CREATED IN PROGRAM MLKRP026 TO PRODUCE A MARKDOWN/MARKON  00130000
001400*  DETAIL BY BUYER AND DEPARTMENT REPORT.  THIS REPORT IS SET     00140000
001500*  UP AS A LASER PRINTER APPLICATION.                             00150000
001600*                                                                 00160000
      *CHANGE HISTORY:                                                  00161003
      * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00162003
      * ------- ---------- ----------- -------------------------------- 00163003
001700*  CHANGE: TOM MEDREK 10/28/96                                    00170000
001800*    PULLED HARDCODE FOR GMM NAME AND ADDED QUERY FROM MERCHANDISE00180000
001900*    AREA AND RESPONSIBILITY AREA TABLES FOR GMM NAME.  ADDED DB2.00190000
002000*                                                                 00200000
002100*  CHANGE: SCOTT JACKSON 12/22/97                                 00210000
002200*    REFORMAT REPORT OUTPUT TO DISPLAY DEPARTMENT NUMBER IN THE   00220000
002300*    HEADER TITLE TO ALLOW REPORT SEGREGATION IN INFOPAC (RDS).   00230000
002400*                                                                 00240000
002500*  CHANGE: BARBARA HULL 05/11/98                                  00250000
002600*    ADDED LOGIC TO DETERMINE THE FINANCIAL CORPORATION NUMBER.   00260000
002700*    ALSO, ADDED LOGIC TO ENSURE THAT THE 7-DIGIT DOCUMENT NUMBER 00270000
002800*    IS COMPLETED.                                                00280000
002900*                                                                 00290000
002100*  CHANGE: CAROL WOJCIECHOWSKI  03/18/02   WR:23511               00300001
002200*    EXPAND MARKDOWN AND MARKUP FIELDS                            00310001
002400*                                                                 00320001
RM4904*  CHANGE: RONNA MCDONALD       04/09/04   PM00647358             00321010
RM4904*    GMA 03 WAS ADDED TO THE MBS STRUCTURE.  THIS IS HARDCODED    00322010
RM4904*    IN THE PROGRAM. WE NEEDED A QUICK FIX.                       00323010
RM4904*                                                                 00323110
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION     00324003
745378*                                                                 00324127
745378*  CHANGE: R MCDONALD           03/14/05   PM00745378             00325027
745378*    CHANGE EDIT ON GMA AND IF IT ISN'T MISCELLANEOUS THEN LOOK   00326027
745378*    IT UP.                                                       00327027
880227* PM000880227 05-15-2006 ROD JANSSEN S07C ABEND IN MLKRP025.....  00329031
C76841*                                                                 00329134
C76841*   CHANGE: COGNIZANT            09/01/17   CHG0176841            00329234
C76841*     INCREASED NUMBER OF SORT WORK FILES TO PREVENT INTERNAL     00329334
C76841*     SORT ERROR.                                                 00329434
003000******************************************************************00330000
003100                                                                  00340000
003200******************************************************************00350000
003300 ENVIRONMENT DIVISION.                                            00360000
003400******************************************************************00370000
003500                                                                  00380000
003600 CONFIGURATION SECTION.                                           00390000
003700                                                                  00400000
003800 SOURCE-COMPUTER.        IBM-3090.                                00410000
003900 OBJECT-COMPUTER.        IBM-3090.                                00420000
004000                                                                  00430000
004100 INPUT-OUTPUT SECTION.                                            00440000
004200                                                                  00450000
004300 FILE-CONTROL.                                                    00460000
004400                                                                  00470000
004500     SELECT MARKDOWN-MARKON-FILE                                  00480000
004600         ASSIGN TO INP01.                                         00490000
004700                                                                  00500000
004800     SELECT DEPT-RELATIONSHIP-FILE                                00510000
004900         ASSIGN TO INP02.                                         00520000
005000                                                                  00530000
005100     SELECT SORT-WORK-FILE                                        00540000
005200         ASSIGN TO SORTWK01                                       00550000
005300                   SORTWK02                                       00560019
005400                   SORTWK03                                       00570019
005500                   SORTWK04                                       00580019
005600                   SORTWK05                                       00590019
C76841                   SORTWK06                                       00600034
C76841                   SORTWK07                                       00601034
C76841                   SORTWK08                                       00602034
C76841                   SORTWK09                                       00603034
C76841                   SORTWK10                                       00604034
C76841                   SORTWK11                                       00605034
C76841                   SORTWK12                                       00606034
C76841                   SORTWK13                                       00607034
C76841                   SORTWK14                                       00608034
C76841                   SORTWK15                                       00609034
C76841                   SORTWK16                                       00609134
C76841                   SORTWK17                                       00609234
C76841                   SORTWK18                                       00609334
C76841                   SORTWK19                                       00609434
C76841                   SORTWK20.                                      00609534
005800                                                                  00610000
005900     SELECT MARKDOWN-ON-SUMMARY-FILE                              00620000
006000         ASSIGN TO OUT01.                                         00630000
006100                                                                  00640000
006200     SELECT MARKDOWN-ON-DETAIL-REPORT                             00650000
006300         ASSIGN TO RPT01.                                         00660000
006400                                                                  00670000
006500******************************************************************00680000
006600 DATA DIVISION.                                                   00690000
006700******************************************************************00700000
006800                                                                  00710000
006900 FILE SECTION.                                                    00720000
007000                                                                  00730000
007100 FD  MARKDOWN-MARKON-FILE                                         00740000
007200     RECORDING MODE IS F                                          00750000
007300     LABEL RECORDS ARE STANDARD                                   00760000
007400     BLOCK CONTAINS 0 RECORDS.                                    00770000
007500                                                                  00780000
       01  MARKDOWN-MARKON-RECORD              PIC X(100).              00790014
007700                                                                  00800000
007800 FD  DEPT-RELATIONSHIP-FILE                                       00810000
007900     RECORDING MODE IS F                                          00820000
008000     LABEL RECORDS ARE STANDARD                                   00830000
008100     BLOCK CONTAINS 0 RECORDS.                                    00840000
008200                                                                  00850000
008300 01  DEPT-RELATIONSHIP-RECORD            PIC X(87).               00860000
008400                                                                  00870000
008500 FD  MARKDOWN-ON-DETAIL-REPORT                                    00880000
008600     RECORDING MODE IS F                                          00890000
008700     LABEL RECORDS ARE STANDARD                                   00900000
008800     BLOCK CONTAINS 0 RECORDS.                                    00910000
008900                                                                  00920000
009000 01  MARKDOWN-ON-DETAIL-LINE             PIC X(75).               00930000
009100                                                                  00940000
009200 FD  MARKDOWN-ON-SUMMARY-FILE                                     00950000
009300     RECORDING MODE IS F                                          00960000
009400     LABEL RECORDS ARE STANDARD                                   00970000
009500     BLOCK CONTAINS 0 RECORDS.                                    00980000
009600                                                                  00990000
009700 01  MARKDOWN-ON-SUMMARY-RECORD          PIC X(124).              01000000
009800                                                                  01010000
009900 SD  SORT-WORK-FILE                                               01020000
W26603     RECORD CONTAINS 108 CHARACTERS                               01030015
010100     DATA RECORD IS SORT-WORK-RECORD.                             01040000
010200                                                                  01050000
010300 01  SORT-WORK-RECORD.                                            01060000
010400     05  SR-MARKDOWN-RECORDS.                                     01070000
010500         10  SR-MARKDOWN-CODE            PIC  X(02).              01080000
010600         10  FILLER                      PIC  X(10).              01090000
010700         10  SR-BUYER-NUMBER             PIC  X(02).              01100000
23511          10  FILLER                      PIC  X(52).              01110002
010900         10  SR-FINANCE-CORP-NMBR        PIC  9(02).              01120000
011000         10  FILLER                      PIC  X(04).              01130000
011100         10  SR-DOCUMENT-NUMBER          PIC  X(07).              01140000
011200         10  FILLER                      PIC  X(21).              01150002
011300     05  SR-INCLUDED-SORT-FIELDS.                                 01160000
011400         10  SR-DEPT-NUMBER              PIC  X(03).              01170000
W26603         10  SR-STORE-NUMBER             PIC  X(05).              01180015
011600                                                                  01190000
011700******************************************************************01200000
011800 WORKING-STORAGE SECTION.                                         01210000
011900******************************************************************01220000
012000*                                                                 01230000
012100*  COPY BOOK FOR THE MARKDOWN/MARKON RECORD LAYOUT - INPUT        01240000
012200*                                                                 01250000
012300     COPY MLRD009I.                                               01260003
012400                                                                  01270000
012500*                                                                 01280000
012600*  COPY BOOK FOR THE MARKDOWN/MARKON RECORD LAYOUT - OUTPUT       01290000
012700*                                                                 01300000
012800     COPY MLRD009O.                                               01310003
012900                                                                  01320000
013000*                                                                 01330000
013100*  COPY BOOK FOR THE MARKDOWN/MARKON SUMMARY LAYOUT - OUTPUT      01340000
013200*                                                                 01350000
013300     COPY MLRD010O.                                               01360003
013400                                                                  01370000
013500*                                                                 01380000
013600*  COPY BOOK FOR THE DEPARTMENT RELATIONSHIP FILE LAYOUT - INPUT  01390000
013700*                                                                 01400000
013800     COPY MPRD013I.                                               01410003
013900                                                                  01420000
014000*                                                                 01430000
014100*  COPY BOOK FOR THE ACCOUNTING MONTH NAME TABLE                  01440000
014200*                                                                 01450000
014300*  STANDARD REPORT HEADER FOR 75 COLUMN REPORT                    01460000
014400*                                                                 01470000
014500     COPY DPWS075O.                                               01480003
014600                                                                  01490000
014700*                                                                 01500000
014800* THIS IS A WORKING STORAGE LAYOUT FOR ABEND CODE VALUES.         01510000
014900*     USE THE SET COMMAND TO PROVIDE VALUES TO ABEND-CODE.        01520000
015000*     IE SET AE-DB2-ERR TO TRUE:  CALL USING ABEND-CODE.          01530003
015100*                                                                 01540000
015200                                                                  01550000
015300 01  ABEND-CODE                  PIC S9(04)     VALUE +0          01560000
015400                                                COMP              01570000
015500                                                SYNC.             01580000
015600                                                                  01590000
015700     88  AC-INVALID-KEY-WRITE                   VALUE +4001.      01600000
015800     88  AC-INVALID-KEY-READ                    VALUE +4002.      01610000
015900     88  AC-INVALID-CONTROL-CARD                VALUE +4003.      01620000
016000     88  AC-TABLE-OVERFLOW                      VALUE +4004.      01630000
016100     88  AC-OPEN-FILE-ERROR                     VALUE +4005.      01640000
016200     88  AC-CLOSE-FILE-ERROR                    VALUE +4006.      01650000
016300     88  AC-SEQUENCE-ERROR                      VALUE +4007.      01660000
016400     88  AC-INVALID-DATA                        VALUE +4008.      01670000
016500     88  AC-INVALID-KEYPUNCH                    VALUE +4009.      01680000
016800     88  AC-INTERNAL-SORT-ERROR                 VALUE +4012.      01710000
016900     88  AC-DB2-ERROR                           VALUE +4013.      01720000
017000                                                                  01730000
017100 01  CD-CPU-DATE.                                                 01740000
017200     05  CD-YEAR                         PIC  9(02)  VALUE ZEROS. 01750000
017300     05  CD-MONTH                        PIC  9(02)  VALUE ZEROS. 01760000
017400     05  CD-DAY                          PIC  9(02)  VALUE ZEROS. 01770000
017500                                                                  01780000
017600 01  CT-CPU-TIME.                                                 01790000
017700     05  CT-HOUR                         PIC  9(02)   VALUE ZEROS.01800000
017800     05  CT-MINUTE                       PIC  9(02)   VALUE ZEROS.01810000
017900     05  FILLER                          PIC  9(04)   VALUE ZEROS.01820000
018000                                                                  01830000
018100 01  CK-CURRENT-KEY-AREA.                                         01840000
018200     05  CK-FINANCE-CORP-NMBR            PIC  9(02)  VALUE ZEROS. 01850000
W26603     05  CK-STORE-NUMBER                 PIC  9(05)  VALUE ZEROS. 01860015
018400     05  CK-BUYER-NUMBER                 PIC  9(02)  VALUE ZEROS. 01870000
018500     05  CK-DEPT-NUMBER                  PIC  9(03)  VALUE ZEROS. 01880000
018600     05  CK-DOCUMENT-NUMBER.                                      01890000
018700         10  CK-CATEGORY                 PIC  9(02)  VALUE ZEROS. 01900000
018800         10  CK-DOCUMENT-NMBR            PIC  9(05)  VALUE ZEROS. 01910000
018900     05  CK-CODE-NUMBER                  PIC  9(02)  VALUE ZEROS. 01920000
019000                                                                  01930000
019100 01  DA-DISPLAY-AREAS.                                            01940000
019200     05  DA-SORT-RECORD-COUNT            PIC ZZZ,ZZZ,ZZZ          01950000
019300                                                     VALUE ZEROS. 01960000
019400 01  DC-DISPLAY-COUNTERS-LINE.                                    01970000
019500     05  FILLER                          PIC  X(05)  VALUE SPACE. 01980000
019600     05  DC-TOTAL-RECORDS-READ           PIC ZZZ,ZZZ,ZZZ          01990000
019700                                                     VALUE ZEROS. 02000000
019800     05  DC-MARKDOWN-MARKON-IDENTIFIER.                           02010000
019900         10  FILLER                      PIC  X(01)  VALUE SPACE. 02020000
020000         10  DC-MARKDOWN-MARKON-LABEL    PIC  X(08)  VALUE SPACE. 02030000
020100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02040000
020200         10  DC-MARKDOWN-MARKON-RECS-LABEL                        02050000
020300                                         PIC  X(15)  VALUE        02060000
020400             'RECORDS TOTALED'.                                   02070000
020500         10  FILLER                      PIC  X(34)  VALUE SPACE. 02080000
020600     05  DC-COMPANY-IDENTIFIER REDEFINES                          02090000
020700                 DC-MARKDOWN-MARKON-IDENTIFIER.                   02100000
020800         10  FILLER                      PIC  X(01).              02110000
020900         10  DC-COMPANY-RECS-LABEL       PIC  X(13).              02120000
021000         10  FILLER                      PIC  X(45).              02130000
021100                                                                  02140000
021200 01  DI-DETAIL-IDENTIFIER-LEVEL-IND                   COMP SYNC.  02150000
021300     05  DI-PLU-MKDN-MKON-LEVEL          PIC S9(04)   VALUE +1.   02160000
021400     05  DI-REGISTER-MKDN-MKON-LEVEL     PIC S9(04)   VALUE +2.   02170000
021500     05  DI-UNMATCHED-MKDN-MKON-LEVEL    PIC S9(04)   VALUE +3.   02180000
021600     05  DI-BUYER-MKDN-MKON-LEVEL        PIC S9(04)   VALUE +4.   02190000
021700     05  DI-STORE-MKDN-MKON-LEVEL        PIC S9(04)   VALUE +5.   02200000
021800     05  DI-BUYER-LEVEL                  PIC S9(04)   VALUE +6.   02210000
021900     05  DI-CODE-LEVEL                   PIC S9(04)   VALUE +7.   02220000
022000     05  DI-DEPT-LEVEL                   PIC S9(04)   VALUE +8.   02230000
022100     05  DI-FINANCE-CORP-LEVEL           PIC S9(04)   VALUE +9.   02240000
022200     05  DI-DOCUMENT-LEVEL               PIC S9(04)   VALUE +10.  02250000
022300     05  DI-STORE-DOCUMENT-LEVEL         PIC S9(04)   VALUE +11.  02260000
022400                                                                  02270000
022500 01  DI-DETAIL-IDENTIFIER-DATA.                                   02280000
022600     05  DI-PLU-IDENTIFIER.                                       02290000
022700         10  FILLER                      PIC  X(28)   VALUE       02300000
022800             '         PLU MARKDOWN TOTAL'.                       02310000
022900     05  DI-REGISTER-IDENTIFIER.                                  02320000
023000         10  FILLER                      PIC  X(28)   VALUE       02330000
023100             '    REGISTER MARKDOWN TOTAL'.                       02340000
023200     05  DI-UNMATCHED-IDENTIFIER.                                 02350000
023300         10  FILLER                      PIC  X(28)   VALUE       02360000
023400             '   UNMATCHED MARKDOWN TOTAL'.                       02370000
023500     05  DI-BUYER-IDENTIFIER.                                     02380000
023600         10  FILLER                      PIC  X(28)   VALUE       02390000
023700             '       BUYER MARKDOWN TOTAL'.                       02400000
023800     05  DI-STORE-IDENTIFIER.                                     02410000
023900         10  FILLER                      PIC  X(28)   VALUE       02420000
024000             '       STORE MARKDOWN TOTAL'.                       02430000
024100     05  DI-BUYER-LEVEL-IDENTIFIER.                               02440000
024200         10  FILLER                      PIC  X(14)   VALUE SPACE.02450000
024300         10  FILLER                      PIC  X(06)   VALUE       02460000
024400             'BUYER '.                                            02470000
024500         10  DI-BL-BUYER-NO              PIC  9(02)   VALUE ZEROS.02480000
024600         10  FILLER                      PIC  X(06)   VALUE       02490000
024700             ' TOTAL'.                                            02500000
024800     05  DI-CODE-LEVEL-IDENTIFIER.                                02510000
024900         10  FILLER                      PIC  X(13)   VALUE SPACE.02520000
025000         10  DI-CL-CODE-DESC             PIC  X(08)   VALUE SPACE.02530000
025100         10  FILLER                      PIC  X(07)   VALUE       02540000
025200             ' TOTAL'.                                            02550000
025300     05  DI-DEPT-LEVEL-IDENTIFIER.                                02560000
025400         10  FILLER                      PIC  X(07)   VALUE SPACE.02570000
025500         10  FILLER                      PIC  X(11)   VALUE       02580000
025600             'DEPARTMENT '.                                       02590000
025700         10  DI-DL-DEPT-NMBR             PIC  9(03)   VALUE ZEROS.02600000
025800         10  FILLER                      PIC  X(06)   VALUE       02610000
025900             ' TOTAL'.                                            02620000
026000     05  DI-FINANCE-LEVEL-IDENTIFIER.                             02630000
026100         10  FILLER                      PIC  X(07)   VALUE SPACE.02640000
026200         10  FILLER                      PIC  X(13)   VALUE       02650000
026300             'FINANCE CORP '.                                     02660000
026400         10  DI-FL-FINANCE-CORP-NMBR     PIC  9(02)   VALUE ZEROS.02670000
026500         10  FILLER                      PIC  X(06)   VALUE       02680000
026600             ' TOTAL'.                                            02690000
026700     05  DI-DOCUMENT-LEVEL-IDENTIFIER.                            02700000
026800         10  FILLER                      PIC  X(06)   VALUE SPACE.02710000
026900         10  FILLER                      PIC  X(09)   VALUE       02720000
027000             'DOCUMENT '.                                         02730000
027100         10  DI-DL-DOCUMENT-NUMBER.                               02740000
027200             15  DI-DL-CATEGORY          PIC  X(02)   VALUE SPACE.02750000
027300             15  DI-DL-DOCUMENT-NMBR     PIC  X(05)   VALUE SPACE.02760000
027400         10  FILLER                      PIC  X(06)   VALUE       02770000
027500             ' TOTAL'.                                            02780000
027600     05  DI-STORE-DOCUMENT-IDENTIFIER.                            02790000
027700         10  FILLER                      PIC  X(08)   VALUE SPACE.02800000
027800         10  FILLER                      PIC  X(20)   VALUE       02810000
027900             'STORE DOCUMENT COUNT'.                              02820000
028000                                                                  02830000
028100 01  DI-DETAIL-IDENTIFIER-TABLE  REDEFINES                        02840000
028200                                     DI-DETAIL-IDENTIFIER-DATA.   02850000
028300     05  DI-DETAIL-IDENTIFIER            OCCURS 11 TIMES          02860000
028400                                         INDEXED BY DI-IDENT-IDX  02870000
028500                                         PIC  X(28).              02880000
028600                                                                  02890000
028700 01  DL-DETAIL-LINE.                                              02900000
028800     05  DL-DETAIL-IDENTIFIER.                                    02910000
028900         10  FILLER                      PIC  X(06)  VALUE SPACE. 02920000
029000         10  DL-BUYER-NUMBER             PIC  X(02)  VALUE SPACE. 02930000
029100         10  FILLER                      PIC  X(06)  VALUE SPACE. 02940000
029200         10  DL-DEPT-NUMBER              PIC  X(03)  VALUE SPACE. 02950000
029300         10  FILLER                      PIC  X(05)  VALUE SPACE. 02960000
029400         10  DL-DOCUMENT-NUMBER.                                  02970000
029500             15  DL-CATEGORY             PIC  X(02)  VALUE SPACE. 02980000
029600             15  DL-DOCUMENT-NMBR        PIC  X(05)  VALUE SPACE. 02990000
W26603         10  FILLER                      PIC  X(08)  VALUE SPACE. 03000015
W26603         10  DL-STORE-NUMBER             PIC  X(05)  VALUE SPACE. 03010015
W26603         10  FILLER                      PIC  X(01)  VALUE SPACE. 03020006
030000     05  DL-TOTAL-IDENTIFIERS REDEFINES DL-DETAIL-IDENTIFIER.     03030000
030100         10  FILLER                      PIC  X(06).              03040000
030200         10  DL-TOTAL-BUYER-NUMBER       PIC  X(02).              03050000
030300         10  DL-TOTAL-IDENTIFIER         PIC  X(27).              03060000
030400         10  FILLER                      PIC  X(08).              03070000
030500     05  DL-STORE-DOC-TOTAL-LINE REDEFINES DL-DETAIL-IDENTIFIER.  03080000
030600         10  FILLER                      PIC  X(08).              03090000
030700         10  DL-STORE-DOC-IDENTIFIER     PIC  X(27).              03100000
030800         10  FILLER                      PIC  X(02).              03110000
030900         10  DL-STORE-DOCUMENT-COUNT     PIC  ZZZ9.               03120000
031000         10  FILLER                      PIC  X(02).              03130000
031100     05  DL-QUANTITY                     PIC ZZZ,ZZZ,ZZZ.         03140000
031200     05  FILLER                          PIC  X(06)  VALUE SPACE. 03150000
031300     05  DL-EXTENDED-AMOUNT              PIC ZZZ,ZZZ,ZZZ.99-      03160000
031400                                                     VALUE ZEROS. 03170000
031500                                                                  03180000
031600 01  DR-DEPT-RELATIONSHIP-TABLE.                                  03190000
880227     05  DR-DEPT-ENTRY                   OCCURS 999 TIMES         03200031
031800                                           ASCENDING KEY IS       03210000
031900                                           DR-DEPT-NMBR           03220000
032000                                           INDEXED BY DR-DEPT-IDX.03230000
032100         10  DR-DEPT-NMBR                PIC  9(03).              03240000
032200         10  DR-DEPT-DESC                PIC  X(20).              03250000
032300         10  DR-BYR-NMBR                 PIC  X(02).              03260000
032400         10  DR-BYR-NAME                 PIC  X(20).              03270000
032500         10  DR-DMM-NMBR                 PIC  X(02).              03280000
032600         10  DR-DMM-NAME                 PIC  X(20).              03290000
032700         10  DR-GMM-NMBR                 PIC  X(01).              03300000
032800         10  DR-GMM-NAME                 PIC  X(20).              03310000
032900                                                                  03320000
033000 01  END-OF-REPORT-LINE.                                          03330000
033100     05  FILLER                          PIC  X(25)  VALUE SPACE. 03340000
033200     05  FILLER                          PIC  X(25)  VALUE        03350000
033300         '***** END OF REPORT *****'.                             03360000
033400     05  FILLER                          PIC  X(25)  VALUE SPACE. 03370000
033500                                                                  03380000
033600 01  FT-FINANCE-TOTAL-INDICATORS                     COMP SYNC.   03390000
033700     05  FT-MARKDOWN-CODE-LEVEL          PIC S9(04)  VALUE +1.    03400000
033800     05  FT-MARKON-CODE-LEVEL            PIC S9(04)  VALUE +2.    03410000
033900     05  FT-CORP01-LEVEL                 PIC S9(04)  VALUE +1.    03420000
034000     05  FT-CORP02-LEVEL                 PIC S9(04)  VALUE +2.    03430000
034100                                                                  03440000
034200 01  FT-FINANCIAL-CORP-TOTAL-TABLE.                               03450000
034300     05  FT-CODE-ENTRY                   OCCURS 2 TIMES           03460000
034400                                         INDEXED BY FT-CODE-IDX.  03470000
034500         10  FT-FINANCE-CORP-ENTRY       OCCURS 2 TIMES           03480000
034600                                         INDEXED BY FT-CORP-IDX.  03490000
034700             15  FT-MARKDOWN-ON-ENTRY    OCCURS 5 TIMES           03500000
034800                                         INDEXED BY               03510000
034900                                             FT-MKDN-MKON-IDX.    03520000
035000                 20  FT-EXTENDED-AMOUNT  PIC S9(09)V99            03530000
035100                                         COMP-3.                  03540000
035200                                                                  03550000
035300 01  HL1-HEADING-LINE-1.                                          03560000
035400     05  FILLER                          PIC  X(25)  VALUE SPACE. 03570000
035500     05  HL1-FINANCE-CORP-TITLE          PIC  X(22)  VALUE SPACE. 03580000
035600     05  HL1-COMPANY-DESC REDEFINES HL1-FINANCE-CORP-TITLE.       03590000
035700         10  HL1-COMPANY-TITLE           PIC  X(22).              03600000
035800     05  HL1-FINANCE-CORP-NMBR-ALPHA     PIC  X(02)  VALUE SPACE. 03610000
035900     05  HL1-FINANCE-CORP-NUMERIC REDEFINES                       03620000
036000                   HL1-FINANCE-CORP-NMBR-ALPHA.                   03630000
036100         10  HL1-FINANCE-CORP-NMBR       PIC  9(02).              03640000
036200     05  FILLER                          PIC  X(26)  VALUE SPACE. 03650000
036300                                                                  03660000
036400 01  HL2-HEADING-LINE-2.                                          03670000
036500     05  FILLER                          PIC  X(11)  VALUE SPACE. 03680000
036600     05  HL2-TITLE                       PIC  X(44)  VALUE SPACE. 03690000
036700     05  HL2-ACCOUNTING-MONTH            PIC  X(09)  VALUE SPACE. 03700000
036800*    05  FILLER  X(DEPT:157)             PIC  X(11)  VALUE SPACE. 03710000
036900     05  FILLER                          PIC  X(01)  VALUE SPACE. 03720000
037000     05  FILLER                          PIC  X(6) VALUE '(DEPT '.03730000
037100     05  HL2-DEPT                        PIC  X(03)  VALUE SPACE. 03740000
037200     05  FILLER                          PIC  X(01)  VALUE ')'.   03750000
037300                                                                  03760000
037400 01  HL3-HEADING-LINE-3.                                          03770000
037500     05  FILLER                          PIC  X(64)  VALUE SPACE. 03780000
037600     05  FILLER                          PIC  X(08)  VALUE        03790000
037700         'EXTENDED'.                                              03800000
037800     05  FILLER                          PIC  X(03)  VALUE SPACE. 03810000
037900                                                                  03820000
038000 01  HL4-HEADING-LINE-4.                                          03830000
038100     05  FILLER                          PIC  X(05)  VALUE SPACE. 03840000
038200     05  FILLER                          PIC  X(05)  VALUE        03850000
038300         'BUYER'.                                                 03860000
038400     05  FILLER                          PIC  X(08)  VALUE        03870000
038500         '    DEPT'.                                              03880000
038600     05  FILLER                          PIC  X(10)  VALUE        03890000
038700         '     DOCNO'.                                            03900000
038800     05  FILLER                          PIC  X(15)  VALUE        03910000
038900         '         STORE '.                                       03920000
039000     05  FILLER                          PIC  X(10)  VALUE        03930000
039100         '  QUANTITY'.                                            03940000
039200     05  FILLER                          PIC  X(18)  VALUE        03950000
039300         '            AMOUNT'.                                    03960000
039400     05  FILLER                          PIC  X(04)  VALUE SPACE. 03970000
039500                                                                  03980000
039600 01  PC-CONSTANTS.                                                03990000
W26603     05  PC-STORE-MAX                    PIC S9(04) VALUE +9999   04000004
039800                                                     COMP SYNC.   04010000
039900     05  PC-REGISTER-IND2                PIC  9(02)  VALUE 99.    04020000
040000     05  PC-NOT-STORE-MKDN-OR-MKON       PIC  9(02)  VALUE 00.    04030000
040100     05  PC-UNMATCHED-IND3               PIC  9(03)  VALUE 999.   04040000
040200     05  PC-LINES-NEEDED-FOR-TOTAL       PIC S9(04)  VALUE +7.    04050000
040300     05  PC-MAX-MONTHS                   PIC  9(02)  VALUE 12.    04060000
040400     05  PC-PAGE-SIZE                    PIC S9(04)  VALUE +55    04070000
040500                                                     COMP SYNC.   04080000
040600     05  PC-PAGE-BREAK                   PIC S9(04)  VALUE +61    04090000
040700                                                     COMP SYNC.   04100000
040800     05  PC-MARKDOWN-CODE                PIC  9(02)  VALUE 40.    04110000
040900     05  PC-MARKDOWN-LABEL               PIC  X(08)  VALUE        04120000
041000         'MARKDOWN'.                                              04130000
041100     05  PC-MARKDOWN-TITLE               PIC  X(44)  VALUE        04140000
041200         'MARKDOWN DETAIL BY BUYER AND DEPARTMENT FOR '.          04150000
041300     05  PC-MARKON-CANCEL-CODE           PIC  9(02)  VALUE 50.    04160000
041400     05  PC-MARKON-CANCEL-LABEL          PIC  X(08)  VALUE        04170000
041500         '  MARKON'.                                              04180000
041600     05  PC-MARKON-TITLE                 PIC  X(44)  VALUE        04190000
041700         '  MARKON DETAIL BY BUYER AND DEPARTMENT FOR '.          04200000
041800     05  PC-COMPANY-RECS-LABEL           PIC  X(13)  VALUE        04210000
041900         'TOTAL RECORDS'.                                         04220000
042000     05  PC-REGISTER-MARKDOWN-IND        PIC  9(02)  VALUE 99.    04230000
042100     05  PC-UNMATCHED-MARKDOWN-IND       PIC  9(03)  VALUE 999.   04240000
042200     05  PC-MAX-MKDN-MKON-TYPES          PIC S9(04)  VALUE +5     04250000
042300                                                     COMP SYNC.   04260000
W26603     05  PC-MAX-FINANCE-CORPS            PIC S9(04)  VALUE +1     04270008
042500                                                     COMP SYNC.   04280000
           05  PC-MAX-CODES                    PIC S9(04)  VALUE +2     04290009
042700                                                     COMP SYNC.   04300000
042800     05  PC-BUYER-MKDN-MKON-IND          PIC  9(02)  VALUE 00.    04310000
042900     05  PC-FINANCE-CORP-01              PIC  9(02)  VALUE 01.    04320000
043000     05  PC-FINANCE-CORP-02              PIC  9(02)  VALUE 02.    04330000
043100     05  PC-HARDLINES-DIVISION           PIC  9(01)  VALUE 1.     04340000
043200*    05  PC-GMM-FOR-HARDLINES            PIC  X(20)  VALUE        04350000
043300*        'KEVIN MANSELL       '.                                  04360000
043400     05  PC-SOFTLINES-DIVISION           PIC  9(01)  VALUE 2.     04370000
RM4904     05  PC-DIVISION-THREE               PIC  9(01)  VALUE 3.     04371010
043500*    05  PC-GMM-FOR-SOFTLINES            PIC  X(20)  VALUE        04380000
043600*        'FRED AYARZA         '.                                  04390000
043700     05  PC-MISCELLANEOUS-DIVISION       PIC  9(01)  VALUE 9.     04400000
043800     05  PC-GMM-FOR-MISCELLANEOUS        PIC  X(20)  VALUE        04410000
043900         'MISCELLANEOUS       '.                                  04420000
044000     05  PC-COMPANY-TITLE                PIC  X(22)  VALUE        04430000
044100         '    COMPANY TOTALS    '.                                04440000
044200     05  PC-FINANCE-CORP-TITLE           PIC  X(22)  VALUE        04450000
044300         'FINANCIAL CORPORATION '.                                04460000
044400     05  PC-CATEGORY-IND.                                         04470000
044500         10  PC-PLU-IND                  PIC  9(01)  VALUE 1.     04480000
044600         10  PC-REGISTER-IND             PIC  9(01)  VALUE 2.     04490000
044700         10  PC-UNMATCHED-IND            PIC  9(01)  VALUE 3.     04500000
044800         10  PC-BUYER-IND                PIC  9(01)  VALUE 4.     04510000
044900         10  PC-STORE-IND                PIC  9(01)  VALUE 5.     04520000
045000     05  PC-MAX-RETRIES                  PIC  S9(4)  VALUE +3.    04530000
045100                                                                  04540000
045200 01  PS-PROGRAM-SWITCHES.                                         04550000
045300     05  PS-ACCOUNTING-MONTH-FOUND-IND   PIC  X(01)  VALUE 'N'.   04560000
045400         88  PS-ACCOUNTING-MONTH-FOUND               VALUE 'Y'.   04570000
045500     05  PS-END-OF-MARKDOWN-ON-FILE-IND  PIC  X(01)  VALUE 'N'.   04580000
045600         88  PS-END-OF-MARKDOWN-MARKON-FILE          VALUE 'Y'.   04590000
045700     05  PS-END-OF-RELATIONSHP-FILE-IND  PIC  X(01)  VALUE 'N'.   04600000
045800         88  PS-END-OF-RELATIONSHIP-FILE             VALUE 'Y'.   04610000
045900     05  PS-END-OF-SORT-WORK-FILE-IND    PIC  X(01)  VALUE 'N'.   04620000
046000         88  PS-END-OF-SORT-WORK-FILE                VALUE 'Y'.   04630000
046100                                                                  04640000
046200 01  PV-PROGRAM-VARIABLES.                                        04650000
046300     05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     04660000
046400                                                     COMP.        04670000
046500     05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     04680000
046600                                                     COMP.        04690000
046700     05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     04700000
046800                                                     COMP.        04710000
046900     05  PV-STORE-DOCUMENT-COUNT         PIC S9(04)  VALUE +0     04720000
047000                                                     COMP.        04730000
047100     05  PV-MARKDOWN-RECS-READ           PIC S9(09)  VALUE +0     04740000
047200                                                     COMP-3.      04750000
047300     05  PV-MARKON-CANCEL-RECS-READ      PIC S9(09)  VALUE +0     04760000
047400                                                     COMP-3.      04770000
047500     05  PV-TOTAL-RECS-READ              PIC S9(09)  VALUE +0     04780000
047600                                                     COMP-3.      04790000
047700     05  PV-EXTENDED-AMOUNT              PIC S9(09)V99            04800000
047800                                                     VALUE +0     04810000
047900                                                     COMP-3.      04820000
048000     05  PV-QUANTITY                     PIC S9(09)V99            04830000
048100                                                     VALUE +0     04840000
048200                                                     COMP-3.      04850000
048300     05  PV-RECORDS-INTO-SORT            PIC S9(09)  VALUE +0     04860000
048400                                                     COMP-3.      04870000
048500     05  PV-RECORDS-OUT-OF-SORT          PIC S9(09)  VALUE +0     04880000
048600                                                     COMP-3.      04890000
048700     05  PV-SORT-RETURN                  PIC  9(02)  VALUE ZEROS. 04900000
048800     05  PV-KOHLS-MONTH                  PIC  9(02)  VALUE ZEROS. 04910000
048900     05  PV-RETRY-COUNT                  PIC  S9(4)  VALUE ZERO   04920000
049000                                              COMP SYNC.          04930000
049100     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 04940000
049200     05  PV-DB2-OPERATION                PIC  X(30)  VALUE SPACE. 04950000
049300     05  PV-GMA-NBR                      PIC  X(02)  VALUE SPACE. 04960000
049400     05  PV-GMM-NAME                     PIC  X(30)  VALUE SPACE. 04970000
049500     05  PV-COMPANY-NBR                  PIC  X(02)  VALUE '03'.  04980000
049600                                                                  04990000
049700 01  SA-SAVE-AREA.                                                05000000
049800     05  SA-FINANCE-CORP-NMBR            PIC  9(02)  VALUE ZEROS. 05010000
W26603     05  SA-STORE-NUMBER                 PIC  9(05)  VALUE ZEROS. 05020015
050000     05  SA-BUYER-NUMBER                 PIC  9(02)  VALUE ZEROS. 05030000
050100     05  SA-DEPT-NUMBER                  PIC  9(03)  VALUE ZEROS. 05040000
050200     05  SA-DOCUMENT-NUMBER.                                      05050000
050300         10  SA-CATEGORY-IND             PIC  9(02)  VALUE ZEROS. 05060000
050400         10  SA-DOCUMENT-NMBR.                                    05070000
050500             15  SA-DN-DEPT-NMBR         PIC  9(03)  VALUE ZEROS. 05080000
050600             15  SA-DN-DATE-DAY          PIC  9(02)  VALUE ZEROS. 05090000
050700     05  SA-CODE-NUMBER                  PIC  9(02)  VALUE ZEROS. 05100000
050800     05  SA-CATEGORY                     PIC  9(01)  VALUE ZEROS. 05110000
050900                                                                  05120000
051000 01  TT-TOTAL-TABLE-INDICATORS                       COMP SYNC.   05130000
051100     05  TT-PLU-MKDN-MKON-LEVEL          PIC S9(04)  VALUE +1.    05140000
051200     05  TT-REGISTER-MKDN-MKON-LEVEL     PIC S9(04)  VALUE +2.    05150000
051300     05  TT-UNMATCHED-MKDN-MKON-LEVEL    PIC S9(04)  VALUE +3.    05160000
051400     05  TT-BUYER-MKDN-MKON-LEVEL        PIC S9(04)  VALUE +4.    05170000
051500     05  TT-STORE-MKDN-MKON-LEVEL        PIC S9(04)  VALUE +5.    05180000
051600     05  TT-STORE-LEVEL                  PIC S9(04)  VALUE +1.    05190000
051700     05  TT-DOCUMENT-LEVEL               PIC S9(04)  VALUE +2.    05200000
051800     05  TT-FINANCE-CORP-LEVEL           PIC S9(04)  VALUE +3.    05210000
051900     05  TT-DEPT-LEVEL                   PIC S9(04)  VALUE +4.    05220000
052000     05  TT-CODE-LEVEL                   PIC S9(04)  VALUE +5.    05230000
052100                                                                  05240000
052200 01  TT-TOTAL-TABLE.                                              05250000
052300     05  TT-MARKDOWN-ON-ENTRY            OCCURS 5 TIMES           05260000
052400                                         INDEXED BY               05270000
052500                                             TT-MKDN-MKON-IDX     05280000
052600                                             TT-MKDN-MKON-IDX-2.  05290000
052700         10  TT-TOTAL-ENTRY              OCCURS 5 TIMES           05300000
052800                                         INDEXED BY TT-TOTAL-IDX. 05310000
052900             15  TT-QUANTITY             PIC S9(09)V99            05320000
053000                                         COMP-3.                  05330000
23511              15  TT-EXTENDED-AMOUNT      PIC S9(09)V99            05340001
053200                                         COMP-3.                  05350000
053300*                                                                 05360000
053400     COPY DPWS500.                                                05370003
053500*                                                                 05380000
053600******************************************************************05390000
053700*    MERCHANDISE AREA DB2 TABLE                                   05400000
053800******************************************************************05410000
053900     EXEC SQL                                                     05420000
054000         INCLUDE TMDSEAR                                          05430000
054100     END-EXEC.                                                    05440000
054200*                                                                 05450000
054300******************************************************************05460000
054400*    RESPONSIBILITY AREA DB2 TABLE                                05470000
054500******************************************************************05480000
054600     EXEC SQL                                                     05490000
054700         INCLUDE TRSPBAR                                          05500000
054800     END-EXEC.                                                    05510000
054900*                                                                 05520000
055000******************************************************************05530000
055100*    DB2 FORMATTED MESSAGES                                       05540000
055200******************************************************************05550000
055300     COPY DPWS004.                                                05560003
055400     EJECT                                                        05570000
055500                                                                  05580000
055600 01  SD-STORE-DOCUMENT-TABLE.                                     05590000
W26603     05  SD-STORE-ENTRY                  OCCURS 10000 TIMES       05600003
055800                                         ASCENDING KEY IS         05610000
055900                                         SD-STORE-NUMBER          05620000
056000                                         INDEXED BY SD-STORE-IDX. 05630000
W26603         10  SD-STORE-NUMBER             PIC 9(05).               05640015
056200         10  SD-FINANCIAL-CORP-NMBR-X    PIC X(02).               05650000
056300         10  SD-FINANCIAL-CORP-NMBR REDEFINES                     05660000
056400                       SD-FINANCIAL-CORP-NMBR-X                   05670000
056500                                         PIC 9(02).               05680000
056600         10  SD-TYPE-CODE                PIC X(02).               05690000
056700         10  SD-DOCUMENT-FOUND-IND       PIC X(01).               05700000
056800*                                                                 05710000
056900*  DCLGEN FOR THE DB2 STORE TABLE                                 05720000
057000*                                                                 05730000
057100     EXEC SQL                                                     05740000
W26603         INCLUDE XMT00001                                         05750003
057300     END-EXEC.                                                    05760000
057400                                                                  05770000
057500*                                                                 05780000
057600******************************************************************05790000
057700*    SQL COMMUNICATIONS AREA DCLGEN                               05800000
057800******************************************************************05810000
057900     EXEC SQL                                                     05820000
058000         INCLUDE SQLCA                                            05830000
058100     END-EXEC.                                                    05840000
058200*                                                                 05850000
058300******************************************************************05860000
058400*  EXTENSION TO THE SQL COMMUNICATIONS AREA FOR EDITING           05870000
058500*  SQL CODES FOR DISPLAY                                          05880000
058600******************************************************************05890000
058700     COPY SQLCA2.                                                 05900003
058800*                                                                 05910000
058900*                                                                 05920000
059000*                                                                 05930000
059100*                                                                 05940000
059200*  SQL DB2 STORE TABLE CURSOR DECLARATION                         05950000
059300*                                                                 05960000
059400     EXEC SQL                                                     05970000
059500         DECLARE STORE_CURSOR CURSOR FOR                          05980000
W26603             SELECT LOC_NBR,                                      06000003
W26603                    LOC_TYP_CDE                                   06010003
W26603             FROM XMT_LOC                                         06030003
W26603             WHERE (LOC_TYP_CDE = 'DS'  OR                        06050003
W26603                    LOC_TYP_CDE = 'DC'  OR                        06060003
W26603                    LOC_TYP_CDE = 'RV'  OR                        06070003
W26603                    LOC_TYP_CDE = 'DA'  OR                        06080003
W26603                    LOC_TYP_CDE = 'CS')                           06090003
W26603             ORDER BY LOC_NBR                                     06110003
060900     END-EXEC.                                                    06120000
061000                                                                  06130000
061100******************************************************************06140000
061200 PROCEDURE DIVISION.                                              06150000
061300******************************************************************06160000
061400                                                                  06170000
061500******************************************************************06180000
061600* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PRO-06190000
061700* GRAM.                                                           06200000
061800******************************************************************06210000
061900 0000-PROGRAM-MAINLINE.                                           06220000
062000     PERFORM 1000-INITIALIZE.                                     06230000
062100                                                                  06240000
062200     SORT SORT-WORK-FILE                                          06250000
062300         ON ASCENDING KEY SR-BUYER-NUMBER                         06260000
062400                          SR-MARKDOWN-CODE                        06270000
062500                          SR-DEPT-NUMBER                          06280000
062600                          SR-FINANCE-CORP-NMBR                    06290000
062700                          SR-DOCUMENT-NUMBER                      06300000
062800                          SR-STORE-NUMBER                         06310000
062900         INPUT PROCEDURE IS 2000-RELEASE-RECORDS-TO-SORT          06320000
063000         OUTPUT PROCEDURE IS 3000-RETURN-SORT-WORK-FILE.          06330000
063100                                                                  06340000
063200     MOVE SORT-RETURN TO PV-SORT-RETURN.                          06350000
063300     IF PV-SORT-RETURN NOT = ZERO                                 06360000
063400         DISPLAY '** ABEND **'                                    06370000
063500         DISPLAY '** PROGRAM **  = MLKRP025'                      06380000
063600         DISPLAY '** INTERNAL SORT ERROR'                         06390000
063700         DISPLAY '** SORT RETURN CODE = ' PV-SORT-RETURN          06400000
063800         SET AC-INTERNAL-SORT-ERROR TO TRUE                       06410000
063900         CALL 'ILBOABN0' USING ABEND-CODE                         06420000
064000     END-IF.                                                      06430000
064100                                                                  06440000
064200     MOVE PV-RECORDS-INTO-SORT   TO DA-SORT-RECORD-COUNT.         06450000
064300     DISPLAY 'SORT RECORDS  IN = '  DA-SORT-RECORD-COUNT.         06460000
064400     MOVE PV-RECORDS-OUT-OF-SORT TO DA-SORT-RECORD-COUNT.         06470000
064500     DISPLAY 'SORT RECORDS OUT = '  DA-SORT-RECORD-COUNT.         06480000
064600                                                                  06490000
064700     PERFORM 5300-PRINT-CODE-TOTALS.                              06500000
064800     PERFORM 8300-PRINT-DISPLAY-COUNTS.                           06510000
064900     PERFORM 9000-EOJ-ROUTINE.                                    06520000
065000     STOP RUN.                                                    06530000
065100*0000-EXIT.                                                       06540000
065200                                                                  06550000
065300******************************************************************06560000
065400*  1000-INITIALIZE - ACCEPTS THE CPU DATE AND TIME. OPENS ALL     06570000
065500*  FILES ASSOCIATED WITH THE JOB.  FILLS APPROPRIATE HEADING      06580000
065600*  INFORMATION.  INITIALIZES THE TOTAL, FINANCIAL AND DEPARTMENT  06590000
065700*  RELATIONSHIP TABLES.  ALL NUMERIC DATA ON THE DEPARTMENT RE-   06600000
065800*  LATIONSHIP TABLE IS REPLACED BY 999.  THIS IS BECAUSE A BINARY 06610000
065900*  SEARCH WILL BE DONE ON THE DEPARTMENT NUMBER FIELD OF THAT     06620000
066000*  TABLE.                                                         06630000
066100******************************************************************06640000
066200 1000-INITIALIZE.                                                 06650000
066300     ACCEPT CD-CPU-DATE     FROM DATE.                            06660000
066400     ACCEPT CT-CPU-TIME     FROM TIME.                            06670000
066500                                                                  06680000
066600     OPEN INPUT  MARKDOWN-MARKON-FILE                             06690000
066700                 DEPT-RELATIONSHIP-FILE                           06700000
066800          OUTPUT MARKDOWN-ON-DETAIL-REPORT                        06710000
066900                 MARKDOWN-ON-SUMMARY-FILE.                        06720000
067000                                                                  06730000
067100     MOVE CD-YEAR     TO  DP075O-RUN-YEAR.                        06740000
067200     MOVE CD-MONTH    TO  DP075O-RUN-MONTH.                       06750000
067300     MOVE CD-DAY      TO  DP075O-RUN-DAY.                         06760000
067400     MOVE CT-HOUR     TO  DP075O-RUN-HOUR.                        06770000
067500     MOVE CT-MINUTE   TO  DP075O-RUN-MINUTE.                      06780000
067600     MOVE 'MLKRP025'  TO  DP075O-PROGRAM-NAME.                    06790000
067700                                                                  06800000
067800     INITIALIZE DPG51.                                            06810000
067900     INITIALIZE DPG52.                                            06820000
068000     INITIALIZE DPG53.                                            06830000
068100                                                                  06840000
068200     ACCEPT DPG51-CALENDAR-TYPE FROM SYSIN.                       06850000
068300     MOVE CD-CPU-DATE TO DPG51-SYSTEM-DATE.                       06860000
068400                                                                  06870000
068500     INITIALIZE TT-TOTAL-TABLE.                                   06880000
068600     INITIALIZE FT-FINANCIAL-CORP-TOTAL-TABLE.                    06890000
068700     INITIALIZE DR-DEPT-RELATIONSHIP-TABLE                        06900000
068800         REPLACING NUMERIC DATA BY 999.                           06910000
068900                                                                  06920000
069000     SET SD-STORE-IDX TO 1.                                       06930000
069100     PERFORM 1200-LOAD-STORE-ENTRIES.                             06940000
069200                                                                  06950000
069300*1000-EXIT.                                                       06960000
069400                                                                  06970000
069500******************************************************************06980000
069600* 1200-LOAD-STORE-ENTRIES - INITIALIZE THE DCLGEN, OPENS AND      06990000
069700* VERIFIES THE STORE CURSOR, DOES PRIMING FETCH OF STORE TABLE,   07000000
069800* LOADS THE STORE CLASS TABLE UNTIL END OF DATA, CLOSING AND      07010000
069900* VERIFIES THE STORE CURSOR.  THE STORE DOCUMENT TABLE IS INIT-   07020000
070000* ALIZED WITH NUMERIC DATA BEING REPLACED BY 999.  THIS IS RE-    07030000
070100* QUIRED, BECUASE A BINARY SEARCH WILL BE PERFORMED ON THE STORE  07040000
070200* NUMBER.                                                         07050000
070300******************************************************************07060000
070400 1200-LOAD-STORE-ENTRIES.                                         07070000
070500     INITIALIZE SD-STORE-DOCUMENT-TABLE                           07080000
W26603         REPLACING NUMERIC DATA BY 99999.                         07090022
070700                                                                  07100000
W26603     INITIALIZE DCLXMT00001.                                      07110003
070900                                                                  07120000
071000     EXEC SQL                                                     07130000
071100         OPEN STORE_CURSOR                                        07140000
071200     END-EXEC.                                                    07150000
071300                                                                  07160000
071400     IF SQLCODE < ZERO                                            07170000
071500         DISPLAY '** ABEND - MLKRP025 **'                         07180000
071600         DISPLAY '** OPEN ERROR ON STORE TABLE'                   07190000
071700         PERFORM 9100-SQL-ERROR                                   07200000
071800     ELSE                                                         07210000
071900         IF ((SQLCODE > 0 ) AND (SQLCODE NOT = 100)) OR           07220000
072000                   (SQLWARN0 = 'W')                               07230000
072100               DISPLAY '** ABEND - MLKRP025 **'                   07240000
072200               DISPLAY '** OPEN WARNING ON STORE TABLE'           07250000
072300               PERFORM 9200-SQL-WARNING                           07260000
072400         END-IF                                                   07270000
072500     END-IF.                                                      07280000
072600                                                                  07290000
072700     PERFORM 1225-FETCH-STORE-TABLE.                              07300000
072800     PERFORM                                                      07310000
072900         UNTIL SQLCODE = +100                                     07320000
073000         IF SD-STORE-IDX < PC-STORE-MAX                           07330000
073100             PERFORM 1250-LOAD-STORES                             07340000
073200         ELSE                                                     07350000
073300             DISPLAY '** ABEND **'                                07360000
073400             DISPLAY '** PGM = MLKRP025 **'                       07370000
073500             DISPLAY '** STORE TABLE IS TOO SMALL'                07380000
073600             DISPLAY '** INCREASE STORE TABLE SIZE'               07390000
073700             SET AC-TABLE-OVERFLOW TO TRUE                        07400000
073800             CALL 'ILBOABN0' USING ABEND-CODE                     07410000
073900         END-IF                                                   07420000
074000     END-PERFORM.                                                 07430000
074100                                                                  07440000
074200     EXEC SQL                                                     07450000
074300         CLOSE STORE_CURSOR                                       07460000
074400     END-EXEC.                                                    07470000
074500                                                                  07480000
074600     IF SQLCODE < ZERO                                            07490000
074700         DISPLAY '** ABEND - MLKRP025 **'                         07500000
074800         DISPLAY '** CLOSE ERROR ON STORE TABLE'                  07510000
074900         PERFORM 9100-SQL-ERROR                                   07520000
075000     ELSE                                                         07530000
075100         IF ((SQLCODE > 0 ) AND (SQLCODE NOT = 100)) OR           07540000
075200                   (SQLWARN0 = 'W')                               07550000
075300               DISPLAY '** ABEND - MLKRP025 **'                   07560000
075400               DISPLAY '** CLOSE WARNING ON STORE TABLE'          07570000
075500               PERFORM 9200-SQL-WARNING                           07580000
075600         END-IF                                                   07590000
075700     END-IF.                                                      07600000
075800                                                                  07610000
075900     EXEC SQL                                                     07620000
076000         COMMIT                                                   07630000
076100     END-EXEC.                                                    07640000
076200                                                                  07650000
076300     IF SQLCODE < ZERO                                            07660000
076400         DISPLAY '** ABEND - MLKRP025 **'                         07670000
076500         DISPLAY '** COMMIT ERROR ON STORE TABLE'                 07680000
076600         PERFORM 9100-SQL-ERROR                                   07690000
076700     ELSE                                                         07700000
076800         IF (((SQLCODE > 0 ) AND (SQLCODE NOT = 100)) OR          07710000
076900                   (SQLWARN0 = 'W'))                              07720000
077000               DISPLAY '** ABEND - MLKRP025 **'                   07730000
077100               DISPLAY '** COMMIT WARNING ON STORE TABLE'         07740000
077200               PERFORM 9200-SQL-WARNING                           07750000
077300         END-IF                                                   07760000
077400     END-IF.                                                      07770000
077500*1200-EXIT.                                                       07780000
077600                                                                  07790000
077700******************************************************************07800000
077800* 1225-FETCH-STORE-TABLE - FETCH THE DB2 STORE TABLE INTO THE     07810000
077900* DCLGEN.                                                         07820000
078000******************************************************************07830000
078100 1225-FETCH-STORE-TABLE.                                          07840000
078200     EXEC SQL                                                     07850000
078300         FETCH STORE_CURSOR                                       07860000
W26603         INTO   :XMT00001-LOC-NBR,                                07880003
W26603                :XMT00001-LOC-TYP-CDE                             07890003
078800     END-EXEC.                                                    07910000
078900                                                                  07920000
079000     IF SQLCODE < ZERO                                            07930000
079100         DISPLAY '** ABEND - MLKRP025 **'                         07940000
079200         DISPLAY '** FETCH ERROR ON STORE TABLE'                  07950000
079300         PERFORM 9100-SQL-ERROR                                   07960000
079400     ELSE                                                         07970000
079500         IF ((SQLCODE > 0 ) AND (SQLCODE NOT = 100)) OR           07980000
079600                   (SQLWARN0 = 'W')                               07990000
079700               DISPLAY '** ABEND - MLKRP025 **'                   08000000
079800               DISPLAY '** FETCH WARNING ON STORE TABLE'          08010000
079900               PERFORM 9200-SQL-WARNING                           08020000
080000         END-IF                                                   08030000
080100     END-IF.                                                      08040000
080200*1225-EXIT.                                                       08050000
080300                                                                  08060000
080400******************************************************************08070000
080500* 1250-LOAD-STORES - THE STORE IS CHECKED TO SEE IF IT'S CURRENTLY08080000
080600* OPEN. IF SO, THE STORE NAME, NUMBER AND FINANCIAL CORPORATION   08090000
080700* NUMBER IS MOVED INTO THE STORE DOCUMENT TABLE.                  08100000
080800******************************************************************08110000
080900 1250-LOAD-STORES.                                                08120000
081000                                                                  08130000
W26603     MOVE '01'                                                    08140003
081200         TO SD-FINANCIAL-CORP-NMBR-X (SD-STORE-IDX).              08150000
W26603     MOVE XMT00001-LOC-NBR                                        08160003
081400         TO SD-STORE-NUMBER (SD-STORE-IDX).                       08170000
W26603     MOVE XMT00001-LOC-TYP-CDE                                    08180003
081600         TO SD-TYPE-CODE (SD-STORE-IDX).                          08190000
081700     MOVE SPACE                                                   08200000
081800         TO SD-DOCUMENT-FOUND-IND (SD-STORE-IDX).                 08210000
081900     SET SD-STORE-IDX UP BY 1.                                    08220000
082000                                                                  08230000
082100     PERFORM 1225-FETCH-STORE-TABLE.                              08240000
082200*1250-EXIT.                                                       08250000
082300                                                                  08260000
082400******************************************************************08270000
082500* 2000-RELEASE-RECORDS-TO-SORT SECTION.  PERFORMS THE PRIMING     08280000
082600* READ OF THE MARKDOWN/MARKON FILE AND CONTROLS THE LOOP FOR PRO- 08290000
082700* CESSING THE MARKDOWN/MARKON FILE UNTIL END OF FILE.  2000-EXIT  08300000
082800* SECTION DENOTES THE END OF THE INPUT SECTION.                   08310000
082900******************************************************************08320000
083000 2000-RELEASE-RECORDS-TO-SORT SECTION.                            08330000
083100     PERFORM 7000-READ-MARKDOWN-MARKON-FILE.                      08340000
083200     PERFORM 2100-RELEASE-MARKDOWN-ON-FILE                        08350000
083300                 UNTIL PS-END-OF-MARKDOWN-MARKON-FILE.            08360000
083400 2000-EXIT SECTION.                                               08370000
083500                                                                  08380000
083600******************************************************************08390000
083700* 2100-RELEASE-MARKDOWN-ON-FILE.  EVALUATES WHICH TYPE OF RECORD  08400000
083800* HAS BEEN ENCOUNTERED AND MOVES THE RECORD INTO THE SORT WORK    08410000
083900* RECORD.  COMPLETES THE 7 DIGIT DOCUMENT NUMBER BY DETERMINING   08420000
084000* THE CATEGORY.  THE DEPARTMENT, DOCUMENT AND STORE NUMBER FIELDS 08430000
084100* ARE MOVED SEPARATELY BECAUSE THEY HOLD DIFFERENT POSITIONS      08440000
084200* WITHIN THE RECORD TYPES.  THE FINANCE CORPORATION NUMBER IS     08450000
084300* DETERMINED.  THE RECORD IS THEN RELEASED INTO THE SORT AND A    08460000
084400* SORT COUNTER INCREMENTED.  THEN THE NEXT RECORD IS READ.        08470000
084500******************************************************************08480000
084600 2100-RELEASE-MARKDOWN-ON-FILE.                                   08490000
084700     EVALUATE TRUE                                                08500000
084800         WHEN ML009I-MARKDOWN-CODE-40                             08510000
084900             IF ML009I-7-DIGIT-DOC-NMBR-40 = SPACES               08520000
085000                 MOVE ML009I-5-DIGIT-DOC-NMBR-40                  08530000
085100                     TO ML009I-DOCUMENT-NUMBER-40                 08540000
085200                 MOVE 00 TO ML009I-CATEGORY-IND-40                08550000
085300                 PERFORM 2110-FIND-MKDN-CATEGORY                  08560000
085400             ELSE                                                 08570000
085500                 IF ML009I-CATEGORY-40 NOT NUMERIC                08580000
085600                     PERFORM 2110-FIND-MKDN-CATEGORY              08590000
085700                 END-IF                                           08600000
085800             END-IF                                               08610000
085900             MOVE ML009I-MARKDOWN-RECORDS   TO SR-MARKDOWN-RECORDS08620000
086000             MOVE ML009I-DEPT-NUMBER-40     TO SR-DEPT-NUMBER     08630000
086100             MOVE ML009I-STORE-NUMBER-40    TO SR-STORE-NUMBER    08640000
086200                                               CK-STORE-NUMBER    08650000
086300         WHEN ML009I-MARKON-CANCEL-CODE-50                        08660000
086400             IF ML009I-7-DIGIT-DOC-NMBR-50 = SPACES               08670000
086500                 MOVE ML009I-5-DIGIT-DOC-NMBR-50                  08680000
086600                     TO ML009I-DOCUMENT-NUMBER-50                 08690000
086700                 MOVE 00 TO ML009I-CATEGORY-IND-50                08700000
086800                 PERFORM 2120-FIND-MKON-CATEGORY                  08710000
086900             ELSE                                                 08720000
087000                 IF ML009I-CATEGORY-50 NOT NUMERIC                08730000
087100                     PERFORM 2120-FIND-MKON-CATEGORY              08740000
087200                 END-IF                                           08750000
087300             END-IF                                               08760000
087400             MOVE ML009I-MARKDOWN-RECORDS   TO SR-MARKDOWN-RECORDS08770000
087500             MOVE ML009I-DEPT-NUMBER-50     TO SR-DEPT-NUMBER     08780000
087600             MOVE ML009I-STORE-NUMBER-50    TO SR-STORE-NUMBER    08790000
087700                                               CK-STORE-NUMBER    08800000
087800         WHEN OTHER                                               08810000
087900             DISPLAY '** ABEND **'                                08820000
088000             DISPLAY '** PGM = MLKRP025'                          08830000
088100             DISPLAY '** INVALID DATA ON DATASET'                 08840000
088200             DISPLAY '** MARKDOWN CODE = ' ML009I-MARKDOWN-CODE   08850000
088300             DISPLAY '** SHOULD BE EITHER A 40 OR 50'             08860000
088400             SET AC-INVALID-DATA TO TRUE                          08870000
088500             CALL 'ILBOABN0' USING ABEND-CODE                     08880000
088600     END-EVALUATE.                                                08890000
088700                                                                  08900000
088800     PERFORM 2130-GET-FINANCE-CORP-NMBR.                          08910000
088900                                                                  08920000
089000     RELEASE SORT-WORK-RECORD.                                    08930000
089100     ADD +1 TO PV-RECORDS-INTO-SORT.                              08940000
089200     PERFORM 7000-READ-MARKDOWN-MARKON-FILE.                      08950000
089300*2100-EXIT.                                                       08960000
089400                                                                  08970000
089500******************************************************************08980000
089600* 2110-FIND-MKDN-CATEGORY - FOR NON DATA ENTRY KEYED MARKDOWNS,   08990000
089700* THE CORRESPONDING CATEGORY IS DETERMINED.                       09000000
089800*                                                                 09010000
089900* ***** NOTE **** THE RELATIVE POSITION OF THE EVALUATE STATEMENT 09020000
090000* MUST REMAIN IN THE SEQUENCE IT IS IN, BECAUSE OF THE WAY THE    09030000
090100* CATEGORIES ARE BEING DETERMINED.                                09040000
090200******************************************************************09050000
090300 2110-FIND-MKDN-CATEGORY.                                         09060000
090400     EVALUATE TRUE                                                09070000
090500       WHEN ((ML009I-DATE-DAY-40 = PC-REGISTER-IND2) AND          09080000
090600           (ML009I-CATEGORY-IND-40 = PC-NOT-STORE-MKDN-OR-MKON))  09090000
090700           MOVE 2 TO ML009I-CATEGORY-40                           09100000
090800       WHEN ML009I-DEPT-NMBR-40 = PC-UNMATCHED-IND3               09110000
090900           MOVE 3 TO ML009I-CATEGORY-40                           09120000
091000       WHEN ML009I-DEPT-NMBR-40 = ML009I-DEPT-NUMBER-40           09130000
091100           MOVE 1 TO ML009I-CATEGORY-40                           09140000
091200       WHEN ML009I-CATEGORY-IND-40 = PC-NOT-STORE-MKDN-OR-MKON    09150000
091300           MOVE 4 TO ML009I-CATEGORY-40                           09160000
091400       WHEN ML009I-CATEGORY-IND-40 NOT = PC-NOT-STORE-MKDN-OR-MKON09170000
091500           MOVE 5 TO ML009I-CATEGORY-40                           09180000
091600     END-EVALUATE.                                                09190000
091700*2110-EXIT.                                                       09200000
091800                                                                  09210000
091900******************************************************************09220000
092000* 2120-FIND-MKON-CATEGORY - FOR NON DATA ENTRY KEYED MARKONS,     09230000
092100* THE CORRESPONDING CATEGORY IS DETERMINED.                       09240000
092200*                                                                 09250000
092300* ***** NOTE **** THE RELATIVE POSITION OF THE EVALUATE STATEMENT 09260000
092400* MUST REMAIN IN THE SEQUENCE IT IS IN, BECAUSE OF THE WAY THE    09270000
092500* CATEGORIES ARE BEING DETERMINED.                                09280000
092600******************************************************************09290000
092700 2120-FIND-MKON-CATEGORY.                                         09300000
092800     EVALUATE TRUE                                                09310000
092900       WHEN ((ML009I-DATE-DAY-50 = PC-REGISTER-IND2) AND          09320000
093000           (ML009I-CATEGORY-IND-50 = PC-NOT-STORE-MKDN-OR-MKON))  09330000
093100           MOVE 2 TO ML009I-CATEGORY-50                           09340000
093200       WHEN ML009I-DEPT-NMBR-50 = PC-UNMATCHED-IND3               09350000
093300           MOVE 3 TO ML009I-CATEGORY-50                           09360000
093400       WHEN ML009I-DEPT-NMBR-50 = ML009I-DEPT-NUMBER-50           09370000
093500           MOVE 1 TO ML009I-CATEGORY-50                           09380000
093600       WHEN ML009I-CATEGORY-IND-50 = PC-NOT-STORE-MKDN-OR-MKON    09390000
093700           MOVE 4 TO ML009I-CATEGORY-50                           09400000
093800       WHEN ML009I-CATEGORY-IND-50 NOT = PC-NOT-STORE-MKDN-OR-MKON09410000
093900           MOVE 5 TO ML009I-CATEGORY-50                           09420000
094000     END-EVALUATE.                                                09430000
094100*2120-EXIT.                                                       09440000
094200                                                                  09450000
094300******************************************************************09460000
094400* 2130-GET-FINANCE-CORP-NMBR - A BINARY SEARCH IS PERFORMED ON THE09470000
094500* STORE NUMBER.                                                   09480000
094600******************************************************************09490000
094700 2130-GET-FINANCE-CORP-NMBR.                                      09500000
094800     SEARCH ALL SD-STORE-ENTRY                                    09510000
094900         AT END                                                   09520000
095000             DISPLAY '** ABEND **'                                09530000
095100             DISPLAY '** PGM = MLKRP025 **'                       09540000
095200             DISPLAY '** PARA = 2130-GET-FINANCE-CORP-NMBR **'    09550000
095300             DISPLAY '** STORE ' CK-STORE-NUMBER                  09560000
095400             DISPLAY '** NOT FOUND IS STORE TABLE'                09570000
095500             DISPLAY '** PROBABLE BAD DATA OR'                    09580000
095600             DISPLAY '** STORE NOT LOADED FROM DB2 TABLE'         09590000
095700             SET AC-INVALID-DATA TO TRUE                          09600000
095800             CALL 'ILBOABN0' USING ABEND-CODE                     09610000
095900         WHEN SD-STORE-NUMBER (SD-STORE-IDX) = CK-STORE-NUMBER    09620000
096000             MOVE SD-FINANCIAL-CORP-NMBR (SD-STORE-IDX)           09630000
096100                 TO SR-FINANCE-CORP-NMBR                          09640000
096200     END-SEARCH.                                                  09650000
096300*2130-EXIT.                                                       09660000
096400                                                                  09670000
096500******************************************************************09680000
096600*  3000-RETURN-SORT-WORK-FILE SECTION.  PERFORMS THE PRIMING READ 09690000
096700*  OF THE DEPARTMENT RELATIONSHIP FILE.  CONTROLS THE LOOP FOR    09700000
096800*  LOADING THE DEPARTMENT RELATIONSHIP TABLE UNTIL EOF.  PERFORMS 09710000
096900*  THE PRIMING RETURN OF THE SORT WORK FILE.  DETERMINES THE      09720000
097000*  ACCOUNTING MONTH IN WHICH THE MARKDOWNS/MARKONS WERE PROCESSED 09730000
097100*  AND CONTROL THE LOOP FOR PROCESSING THE SORTED MARKDOWN/MARKON 09740000
097200*  FILE UNTIL EOF.  3000-EXIT SECTION DENOTES THE END OF THE      09750000
097300*  OUTPUT SECTION.  PRINTS THE SEPARATOR SHEET FOR THE FIRST BUYER09760000
097400*  SETS UP THE DJDE FOR THE REPORT.                               09770000
097500******************************************************************09780000
097600 3000-RETURN-SORT-WORK-FILE SECTION.                              09790000
097700     SET DR-DEPT-IDX TO 1.                                        09800000
097800     PERFORM 7100-READ-RELATIONSHIP-FILE.                         09810000
097900     PERFORM 4000-LOAD-SUMMARY-ENTRIES                            09820000
098000         UNTIL PS-END-OF-RELATIONSHIP-FILE.                       09830000
098100     PERFORM 7200-RETURN-SORT-WORK-FILE.                          09840000
098200     PERFORM 4100-FIND-ACCT-MONTH.                                09850000
098300     PERFORM 4200-PROCESS-MARKDOWN-ON-FILE                        09860000
098400         UNTIL PS-END-OF-SORT-WORK-FILE.                          09870000
098500                                                                  09880000
098600 3000-EXIT SECTION.                                               09890000
098700                                                                  09900000
098800******************************************************************09910000
098900* 4000-LOAD-SUMMARY-ENTRIES - LOADS THE APPROPRIATE INFORMATION   09920000
099000* INTO THE DEPARTMENT RELATIONSHIP TABLE.                         09930000
099100******************************************************************09940000
099200 4000-LOAD-SUMMARY-ENTRIES.                                       09950000
099300     MOVE MP013I-DEPT-NMBR TO DR-DEPT-NMBR (DR-DEPT-IDX).         09960000
099400     MOVE MP013I-DEPT-DESC TO DR-DEPT-DESC (DR-DEPT-IDX).         09970000
099500     MOVE MP013I-BYR-NMBR  TO DR-BYR-NMBR  (DR-DEPT-IDX).         09980000
099600     MOVE MP013I-BYR-NAME  TO DR-BYR-NAME  (DR-DEPT-IDX).         09990000
099700     MOVE MP013I-DMM-NMBR  TO DR-DMM-NMBR  (DR-DEPT-IDX).         10000000
099800     MOVE MP013I-DMM-NAME  TO DR-DMM-NAME  (DR-DEPT-IDX).         10010000
099900     MOVE MP013I-DIV-NMBR  TO DR-GMM-NMBR  (DR-DEPT-IDX).         10020000
100000                                                                  10030000
100100     EVALUATE TRUE                                                10040000
100500       WHEN MP013I-DIV-NMBR-RPT02 = PC-MISCELLANEOUS-DIVISION     10041026
100600          MOVE PC-GMM-FOR-MISCELLANEOUS                           10042026
100700              TO DR-GMM-NAME (DR-DEPT-IDX)                        10043026
745378*      WHEN MP013I-DIV-NMBR-RPT02 = PC-HARDLINES-DIVISION         10050027
745378*      WHEN MP013I-DIV-NMBR-RPT02 = PC-SOFTLINES-DIVISION         10060027
745378*      WHEN MP013I-DIV-NMBR-RPT02 = PC-DIVISION-THREE             10061027
745378*         PERFORM 4010-GET-GMM-NAME                               10070027
100800       WHEN OTHER                                                 10110000
745378          PERFORM 4010-GET-GMM-NAME                               10111027
745378*        DISPLAY '** ABEND **'                                    10120027
745378*        DISPLAY '** PGM = MLKRP025'                              10130027
745378*        DISPLAY '** INVALID DATA ON'                             10140027
745378*        DISPLAY '** DEPARTMENT RELATIONSHIP FILE'                10150027
745378*        DISPLAY '** DIVISION NMBR = ' MP013I-DIV-NMBR-RPT02      10160027
745378*        DISPLAY '** SHOULD BE EITHER A "1" "2" "3" OR "9"'       10170027
745378*        SET AC-INVALID-DATA TO TRUE                              10180027
745378*        CALL 'ILBOABN0' USING ABEND-CODE                         10190027
101700     END-EVALUATE.                                                10200000
101800                                                                  10210000
101900     SET DR-DEPT-IDX UP BY 1.                                     10220000
102000     PERFORM 7100-READ-RELATIONSHIP-FILE.                         10230000
102100*4000-EXIT.                                                       10240000
102200*                                                                 10250000
102300 4010-GET-GMM-NAME.                                               10260000
102400     MOVE '03'                  TO PV-COMPANY-NBR                 10270000
102500     MOVE '0'                   TO PV-GMA-NBR (1:1)               10280000
102600     MOVE MP013I-DIV-NMBR-RPT02 TO PV-GMA-NBR (2:1)               10290000
102700                                                                  10300000
102800     MOVE SPACES TO PV-GMM-NAME                                   10310000
102900     MOVE ZERO   TO PV-RETRY-COUNT                                10320000
103000     PERFORM                                                      10330000
103100         WITH TEST AFTER                                          10340000
103200         UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                    10350000
103300            OR SQLCODE = ZERO                                     10360000
103400                                                                  10370000
103500         EXEC SQL                                                 10380000
103600           SELECT A.OPERCO_NBR                                    10390000
103700                  ,A.GMA_NBR                                      10400000
103800                  ,A.DMA_NBR                                      10410000
103900                  ,B.WORKER_STRT_DTE                              10420000
104000                  ,B.WORKER_END_DTE                               10430000
104100                  ,B.WORKER_FIR_NAME                              10440000
104200                  ,B.WORKER_LAST_NAME                             10450000
104300             INTO :MDSEAR-OPERCO-NBR                              10460000
104400                  ,:MDSEAR-GMA-NBR                                10470000
104500                  ,:MDSEAR-DMA-NBR                                10480000
104600                  ,:RSPBAR-WORKER-STRT-DTE                        10490000
104700                  ,:RSPBAR-WORKER-END-DTE                         10500000
104800                  ,:RSPBAR-WORKER-FIR-NAME                        10510000
104900                  ,:RSPBAR-WORKER-LAST-NAME                       10520000
105000             FROM TMDSEAR A                                       10530000
105100                  ,TRSPBAR B                                      10540000
105200            WHERE A.OPERCO_NBR  = :PV-COMPANY-NBR                 10550000
105300              AND A.GMA_NBR     = :PV-GMA-NBR                     10560000
105400              AND A.MDSELV_CDE  = 'GMA'                           10570000
105500              AND B.RSPLVL_CDE  = 'GMM'                           10580000
105600              AND CURRENT DATE BETWEEN                            10590000
105700                  B.WORKER_STRT_DTE AND                           10600000
105800                  B.WORKER_END_DTE                                10610000
105900              AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                   10620000
106000         END-EXEC                                                 10630000
106100                                                                  10640000
106200         EVALUATE SQLCODE                                         10650000
106300             WHEN -913                                            10660000
106400             WHEN -911                                            10670000
106500             WHEN -904                                            10680000
106600               COMPUTE PV-RETRY-COUNT = PV-RETRY-COUNT + 1        10690000
106700             WHEN -811                                            10700000
106800             WHEN +0                                              10710000
106900               STRING RSPBAR-WORKER-FIR-NAME  DELIMITED BY '  '   10720000
107000                      SPACE                   DELIMITED BY SIZE   10730000
107100                      RSPBAR-WORKER-LAST-NAME DELIMITED BY SIZE   10740000
107200                 INTO PV-GMM-NAME                                 10750000
107300               END-STRING                                         10760000
107400               MOVE PV-GMM-NAME (1:20)   TO                       10770000
107500                    DR-GMM-NAME (DR-DEPT-IDX)                     10780000
745378             WHEN +100                                            10780127
745378               DISPLAY '** ABEND **'                              10781027
745378               DISPLAY '** PGM = MLKRP025'                        10782027
745378               DISPLAY '** INVALID DATA ON'                       10783027
745378               DISPLAY '** DEPARTMENT RELATIONSHIP FILE'          10784027
745378               DISPLAY '** DIVISION NMBR = ' MP013I-DIV-NMBR-RPT0210785027
745378               DISPLAY 'PGM MLKRP025 ABENDED - GMM NAME SELECT'   10786127
745378               DISPLAY '** GMM NOT FOUND FOR DIVISION'            10786227
745378               SET AC-INVALID-DATA TO TRUE                        10787027
745378               CALL 'ILBOABN0' USING ABEND-CODE                   10788027
107600             WHEN OTHER                                           10790000
107700               DISPLAY 'PGM MLKRP025 ABENDED - GMM NAME SELECT'   10800026
107800               MOVE '4010-GET-GMM-NAMES' TO PV-PARAGRAPH-NAME     10810000
107900               MOVE 'SELECT GMM NAME   ' TO PV-DB2-OPERATION      10820000
108000               PERFORM 9100-SQL-ERROR                             10830000
108100         END-EVALUATE                                             10840000
108200                                                                  10850000
108300         COMPUTE PV-RETRY-COUNT = PV-RETRY-COUNT + 1              10860000
108400     END-PERFORM                                                  10870000
108500                                                                  10880000
108600     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          10890000
108700         DISPLAY 'PGM FSKRP025 ABENDED - MAX RETRIES EXCEEDED'    10900000
108800         MOVE '4010-GET-GMM-NAME  ' TO PV-PARAGRAPH-NAME          10910000
108900         MOVE 'SELECT GMM NAME    ' TO PV-DB2-OPERATION           10920000
109000         PERFORM 9100-SQL-ERROR                                   10930000
109100     END-IF.                                                      10940000
109200                                                                  10950000
109300 4010-EXIT.                                                       10960000
109400     EXIT.                                                        10970000
109500                                                                  10980000
109600******************************************************************10990000
109700* 4100-FIND-ACCT-MONTH.  FINDS THE ACCOUNTING MONTH IN WHICH THE  11000000
109800*  MARKDOWNS/MARKONS WERE PROCESSED.                              11010000
109900******************************************************************11020000
110000 4100-FIND-ACCT-MONTH.                                            11030000
110100     MOVE ML009O-KOHLS-MONTH-40 TO PV-KOHLS-MONTH                 11040000
110200                                   DPG52-FISCAL-PRD-PP.           11050000
110300     MOVE CD-YEAR               TO DPG52-FISCAL-PRD-YR.           11060000
110400     SET DPG52-LK-DTE-FISC-PRD  TO TRUE.                          11070000
110500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                11080000
110600                                   DPG52                          11090000
110700                                   DPG53                          11100000
110800                                   DPG54                          11110000
110900                                   DPG55                          11120000
111000                                   DPG56.                         11130000
111100                                                                  11140000
111200     IF  DPG54-NO-ERROR                                           11150000
111300         MOVE DPG56-FISCAL-PERIOD-NAME                            11160000
111400                               TO  HL2-ACCOUNTING-MONTH           11170000
111500     ELSE                                                         11180000
111600         DISPLAY '*** ABEND *** IN MLKRP025'                      11190000
111700         DISPLAY 'PARA: 4100-FIND-ACCT-MONTH'                     11200000
111800         DISPLAY 'DATE ROUTINE(FISCAL DATE) ERROR. '              11210000
111900         DISPLAY 'DPG51 INPUT PARMS: ' DPG51                      11220000
112000         DISPLAY 'DPG52 INPUT PARMS: ' DPG52                      11230000
112100         DISPLAY 'DPG53 INPUT PARMS: ' DPG53                      11240000
112200         DISPLAY 'DPG54 RESPONSE   : ' DPG54                      11250000
112300         MOVE +4019 TO ABEND-CODE                                 11260030
112400         CALL 'ILBOABN0' USING ABEND-CODE                         11270000
112500     END-IF.                                                      11280000
112600                                                                  11290000
112700*4100-EXIT.                                                       11300000
112800                                                                  11310000
112900******************************************************************11320000
113000* 4200-PROCESS-MARKDOWN-ON-FILE - UPON CHANGE IN BUYER NO BUYER   11330000
113100* TOTALS ARE PRODUCED, BECAUSE THEY WOULD BE IDENTICAL TO THE CODE11340000
113200* TOTAL.                                                          11350000
113300******************************************************************11360000
113400 4200-PROCESS-MARKDOWN-ON-FILE.                                   11370000
113500     IF ML009O-MARKDOWN-CODE-40                                   11380000
113600         MOVE ML009O-BUYER-NUMBER-40 TO CK-BUYER-NUMBER           11390000
113700     ELSE                                                         11400000
113800         IF ML009O-MARKON-CANCEL-CODE-50                          11410000
113900             MOVE ML009O-BUYER-NUMBER-50 TO CK-BUYER-NUMBER       11420000
114000         END-IF                                                   11430000
114100     END-IF.                                                      11440000
114200                                                                  11450000
114300     PERFORM 4300-PROCESS-CODE                                    11460000
114400         UNTIL ((PS-END-OF-SORT-WORK-FILE)                        11470000
114500                 OR (SA-BUYER-NUMBER NOT = CK-BUYER-NUMBER)).     11480000
114600*4200-EXIT.                                                       11490000
114700                                                                  11500000
114800******************************************************************11510000
114900* 4300-PROCESS-CODE - PRODUCE CODE TOTALS WITHIN A BUYER.         11520000
115000******************************************************************11530000
115100 4300-PROCESS-CODE.                                               11540000
115200     IF ML009O-MARKDOWN-CODE-40                                   11550000
115300         MOVE PC-MARKDOWN-CODE  TO CK-CODE-NUMBER                 11560000
115400         MOVE PC-MARKDOWN-TITLE TO HL2-TITLE                      11570000
115500         SET FT-CODE-IDX        TO 1                              11580000
115600         MOVE 1                 TO DP075O-REPORT-NUMBER           11590000
115700     ELSE                                                         11600000
115800         IF ML009O-MARKON-CANCEL-CODE-50                          11610000
115900             MOVE PC-MARKON-CANCEL-CODE TO CK-CODE-NUMBER         11620000
116000             MOVE PC-MARKON-TITLE       TO HL2-TITLE              11630000
116100             SET FT-CODE-IDX            TO 2                      11640000
116200             MOVE 2                     TO DP075O-REPORT-NUMBER   11650000
116300         END-IF                                                   11660000
116400     END-IF.                                                      11670000
116500                                                                  11680000
116600     PERFORM 4400-PROCESS-DEPT                                    11690000
116700         UNTIL ((PS-END-OF-SORT-WORK-FILE)                        11700000
116800                 OR (SA-BUYER-NUMBER NOT = CK-BUYER-NUMBER)       11710000
116900                 OR (SA-CODE-NUMBER NOT = CK-CODE-NUMBER)).       11720000
117000                                                                  11730000
117100     SET TT-TOTAL-IDX TO TT-CODE-LEVEL.                           11740000
117200     SET DI-IDENT-IDX TO DI-CODE-LEVEL.                           11750000
117300     IF CK-CODE-NUMBER = PC-MARKDOWN-CODE                         11760000
117400         MOVE PC-MARKDOWN-LABEL TO DI-CL-CODE-DESC                11770000
117500     ELSE                                                         11780000
117600         IF CK-CODE-NUMBER = PC-MARKON-CANCEL-CODE                11790000
117700             MOVE PC-MARKON-CANCEL-LABEL TO DI-CL-CODE-DESC       11800000
117800         END-IF                                                   11810000
117900     END-IF.                                                      11820000
118000     MOVE CK-BUYER-NUMBER TO DL-TOTAL-BUYER-NUMBER.               11830000
118100     PERFORM 5100-CONTROL-BREAK.                                  11840000
118200     INITIALIZE PV-PAGE-COUNT.                                    11850000
118300     MOVE PC-PAGE-BREAK TO PV-LINE-COUNT.                         11860000
118400*4300-EXIT.                                                       11870000
118500                                                                  11880000
118600******************************************************************11890000
118700* 4400-PROCESS-DEPT - PRODUCE DEPARTMENT TOTALS WITHIN A CODE.    11900000
118800******************************************************************11910000
118900 4400-PROCESS-DEPT.                                               11920000
119000     IF ML009O-MARKDOWN-CODE-40                                   11930000
119100         MOVE ML009O-DEPT-NUMBER-40 TO CK-DEPT-NUMBER             11940000
119200     ELSE                                                         11950000
119300         IF ML009O-MARKON-CANCEL-CODE-50                          11960000
119400             MOVE ML009O-DEPT-NUMBER-50 TO CK-DEPT-NUMBER         11970000
119500         END-IF                                                   11980000
119600     END-IF.                                                      11990000
119700                                                                  12000000
119800     PERFORM 4500-PROCESS-FINANCE-CORP-NMBR                       12010000
119900         UNTIL ((PS-END-OF-SORT-WORK-FILE)                        12020000
120000                 OR (SA-BUYER-NUMBER NOT = CK-BUYER-NUMBER)       12030000
120100                 OR (SA-CODE-NUMBER NOT = CK-CODE-NUMBER)         12040000
120200                 OR (SA-DEPT-NUMBER  NOT = CK-DEPT-NUMBER)).      12050000
120300                                                                  12060000
120400     SET TT-TOTAL-IDX TO TT-DEPT-LEVEL.                           12070000
120500     SET DI-IDENT-IDX TO DI-DEPT-LEVEL.                           12080000
120600     MOVE CK-BUYER-NUMBER TO DL-TOTAL-BUYER-NUMBER.               12090000
120700     MOVE CK-DEPT-NUMBER TO DI-DL-DEPT-NMBR.                      12100000
120800     MOVE PC-PAGE-BREAK TO PV-LINE-COUNT.                         12110000
120900     MOVE PC-COMPANY-TITLE TO HL1-COMPANY-TITLE.                  12120000
121000     MOVE SPACES TO HL1-FINANCE-CORP-NMBR-ALPHA.                  12130000
121100     PERFORM 5100-CONTROL-BREAK.                                  12140000
121200*4400-EXIT.                                                       12150000
121300                                                                  12160000
121400******************************************************************12170000
121500* 4500-PROCESS-FINANCE-CORP-NMBR -  PRODUCE FINANCIAL CORPORATION 12180000
121600* TOTALS WITH A DEPARTMENT.                                       12190000
121700******************************************************************12200000
121800 4500-PROCESS-FINANCE-CORP-NMBR.                                  12210000
W26603*    IF ML009O-MARKDOWN-CODE-40                                   12220005
W26603*        MOVE ML009O-FINANCE-CORP-NMBR-40                         12230005
W26603*            TO CK-FINANCE-CORP-NMBR                              12240005
W26603*    ELSE                                                         12250005
W26603*        IF ML009O-MARKON-CANCEL-CODE-50                          12260005
W26603*            MOVE ML009O-FINANCE-CORP-NMBR-50                     12270005
W26603*                TO CK-FINANCE-CORP-NMBR                          12280005
W26603*        END-IF                                                   12290005
W26603*    END-IF.                                                      12300005
W26603     MOVE 01     TO CK-FINANCE-CORP-NMBR.                         12301005
122800                                                                  12310000
122900     MOVE PC-FINANCE-CORP-TITLE TO HL1-FINANCE-CORP-TITLE.        12320000
123000     IF CK-FINANCE-CORP-NMBR = PC-FINANCE-CORP-01                 12330000
123100         MOVE PC-FINANCE-CORP-01 TO HL1-FINANCE-CORP-NMBR         12340000
123200         SET FT-CORP-IDX TO 1                                     12350000
123300     ELSE                                                         12360000
123400         IF CK-FINANCE-CORP-NMBR = PC-FINANCE-CORP-02             12370000
123500             MOVE PC-FINANCE-CORP-02 TO HL1-FINANCE-CORP-NMBR     12380000
123600             SET FT-CORP-IDX TO 2                                 12390000
123700         END-IF                                                   12400000
123800     END-IF.                                                      12410000
123900                                                                  12420000
124000     PERFORM 8100-WRITE-HEADING-LINES.                            12430000
124100                                                                  12440000
124200     PERFORM 4600-PROCESS-DOCUMENT-NUMBER                         12450000
124300         UNTIL ((PS-END-OF-SORT-WORK-FILE)                        12460000
124400                 OR (SA-BUYER-NUMBER NOT = CK-BUYER-NUMBER)       12470000
124500                 OR (SA-CODE-NUMBER NOT = CK-CODE-NUMBER)         12480000
124600                 OR (SA-DEPT-NUMBER NOT = CK-DEPT-NUMBER)         12490000
124700                 OR (SA-FINANCE-CORP-NMBR NOT =                   12500000
124800                         CK-FINANCE-CORP-NMBR)).                  12510000
124900                                                                  12520000
125000     SET TT-TOTAL-IDX TO TT-FINANCE-CORP-LEVEL.                   12530000
125100     SET DI-IDENT-IDX TO DI-FINANCE-CORP-LEVEL.                   12540000
125200     MOVE CK-FINANCE-CORP-NMBR TO DI-FL-FINANCE-CORP-NMBR.        12550000
125300     MOVE CK-BUYER-NUMBER TO DL-TOTAL-BUYER-NUMBER.               12560000
125400     IF (PC-LINES-NEEDED-FOR-TOTAL + PV-LINE-COUNT) >             12570000
125500          PC-PAGE-SIZE                                            12580000
125600          PERFORM 8100-WRITE-HEADING-LINES                        12590000
125700     END-IF.                                                      12600000
125800     PERFORM 5100-CONTROL-BREAK.                                  12610000
125900     PERFORM 5200-FILL-SUMMARY-RECORD.                            12620000
126000*4500-EXIT.                                                       12630000
126100                                                                  12640000
126200******************************************************************12650000
126300* 4600-PROCESS-DOCUMENT-NUMBER - PRODUCE DOCUMENT TOTALS WITHIN   12660000
126400* A FINANCIAL CORPORATION.                                        12670000
126500******************************************************************12680000
126600 4600-PROCESS-DOCUMENT-NUMBER.                                    12690000
126700     IF ML009O-MARKDOWN-CODE-40                                   12700000
126800         MOVE ML009O-7-DIGIT-DOC-NMBR-40 TO CK-DOCUMENT-NUMBER    12710000
126900     ELSE                                                         12720000
127000         IF ML009O-MARKON-CANCEL-CODE-50                          12730000
127100             MOVE ML009O-7-DIGIT-DOC-NMBR-50 TO CK-DOCUMENT-NUMBER12740000
127200         END-IF                                                   12750000
127300     END-IF.                                                      12760000
127400                                                                  12770000
127500     PERFORM 4700-PROCESS-STORE                                   12780000
127600         UNTIL ((PS-END-OF-SORT-WORK-FILE)                        12790000
127700                 OR (SA-BUYER-NUMBER NOT = CK-BUYER-NUMBER)       12800000
127800                 OR (SA-CODE-NUMBER NOT = CK-CODE-NUMBER)         12810000
127900                 OR (SA-DEPT-NUMBER NOT = CK-DEPT-NUMBER)         12820000
128000                 OR (SA-FINANCE-CORP-NMBR NOT =                   12830000
128100                         CK-FINANCE-CORP-NMBR)                    12840000
128200                 OR (SA-DOCUMENT-NUMBER NOT =                     12850000
128300                         CK-DOCUMENT-NUMBER)).                    12860000
128400                                                                  12870000
128500     SET TT-TOTAL-IDX TO TT-DOCUMENT-LEVEL.                       12880000
128600     SET DI-IDENT-IDX TO DI-DOCUMENT-LEVEL.                       12890000
128700     IF CK-CATEGORY = PC-BUYER-MKDN-MKON-IND                      12900000
128800         MOVE SPACES TO DI-DL-CATEGORY                            12910000
128900         MOVE CK-DOCUMENT-NMBR TO DI-DL-DOCUMENT-NMBR             12920000
129000     ELSE                                                         12930000
129100         MOVE CK-DOCUMENT-NUMBER TO DI-DL-DOCUMENT-NUMBER         12940000
129200     END-IF.                                                      12950000
129300     PERFORM 5100-CONTROL-BREAK.                                  12960000
129400     MOVE 2 TO PV-ADVANCE-COUNT.                                  12970000
129500*4600-EXIT.                                                       12980000
129600                                                                  12990000
129700******************************************************************13000000
129800*  4700-PROCESS-STORE - PRODUCE A STORE TOTAL WITHIN A DOCUMENT.  13010000
129900******************************************************************13020000
130000 4700-PROCESS-STORE.                                              13030000
130100     IF ML009O-MARKDOWN-CODE-40                                   13040000
130200         MOVE ML009O-STORE-NUMBER-40 TO CK-STORE-NUMBER           13050000
130300     ELSE                                                         13060000
130400         IF ML009O-MARKON-CANCEL-CODE-50                          13070000
130500             MOVE ML009O-STORE-NUMBER-50 TO CK-STORE-NUMBER       13080000
130600         END-IF                                                   13090000
130700     END-IF.                                                      13100000
130800                                                                  13110000
130900     SET TT-TOTAL-IDX TO TT-STORE-LEVEL.                          13120000
131000                                                                  13130000
131100     PERFORM                                                      13140000
131200         UNTIL ((PS-END-OF-SORT-WORK-FILE)                        13150000
131300                 OR (SA-BUYER-NUMBER NOT = CK-BUYER-NUMBER)       13160000
131400                 OR (SA-CODE-NUMBER NOT = CK-CODE-NUMBER)         13170000
131500                 OR (SA-DEPT-NUMBER NOT = CK-DEPT-NUMBER)         13180000
131600                 OR (SA-FINANCE-CORP-NMBR NOT =                   13190000
131700                         CK-FINANCE-CORP-NMBR)                    13200000
131800                 OR (SA-DOCUMENT-NUMBER NOT =                     13210000
131900                         CK-DOCUMENT-NUMBER)                      13220000
132000                 OR (SA-STORE-NUMBER NOT = CK-STORE-NUMBER))      13230000
132100         IF ML009O-MARKDOWN-CODE-40                               13240000
132200             MOVE ML009O-CATEGORY-40 TO SA-CATEGORY               13250000
132300         ELSE                                                     13260000
132400             IF ML009O-MARKON-CANCEL-CODE-50                      13270000
132500                 MOVE ML009O-CATEGORY-50 TO SA-CATEGORY           13280000
132600             END-IF                                               13290000
132700         END-IF                                                   13300000
132800         PERFORM 5000-SET-MKDN-MKON-IDX                           13310000
132900         IF ML009O-MARKDOWN-CODE-40                               13320000
133000           COMPUTE TT-EXTENDED-AMOUNT                             13330000
133100                     (TT-MKDN-MKON-IDX, TT-TOTAL-IDX) =           13340000
133200               TT-EXTENDED-AMOUNT                                 13350000
133300                     (TT-MKDN-MKON-IDX, TT-TOTAL-IDX) +           13360000
133400               ((ML009O-OLD-PRICE-40 - ML009O-NEW-PRICE-40) *     13370000
133500                   ML009O-QUANTITY-40)                            13380000
133600           COMPUTE TT-QUANTITY (TT-MKDN-MKON-IDX, TT-TOTAL-IDX) = 13390000
133700             TT-QUANTITY (TT-MKDN-MKON-IDX, TT-TOTAL-IDX)         13400000
133800                 + ML009O-QUANTITY-40                             13410000
133900         ELSE                                                     13420000
134000           IF ML009O-MARKON-CANCEL-CODE-50                        13430000
134100               COMPUTE TT-EXTENDED-AMOUNT                         13440000
134200                         (TT-MKDN-MKON-IDX, TT-TOTAL-IDX) =       13450000
134300                   TT-EXTENDED-AMOUNT                             13460000
134400                             (TT-MKDN-MKON-IDX, TT-TOTAL-IDX) +   13470000
134500                     ((ML009O-NEW-PRICE-50 - ML009O-OLD-PRICE-50) 13480000
134600                               *  ML009O-QUANTITY-50)             13490000
134700               COMPUTE TT-QUANTITY                                13500000
134800                         (TT-MKDN-MKON-IDX, TT-TOTAL-IDX) =       13510000
134900                   TT-QUANTITY (TT-MKDN-MKON-IDX, TT-TOTAL-IDX)   13520000
135000                             + ML009O-QUANTITY-50                 13530000
135100           END-IF                                                 13540000
135200         END-IF                                                   13550000
135300         PERFORM 7200-RETURN-SORT-WORK-FILE                       13560000
135400     END-PERFORM.                                                 13570000
135500                                                                  13580000
135600     IF TT-MKDN-MKON-IDX = TT-STORE-MKDN-MKON-LEVEL               13590000
135700         ADD +1 TO PV-STORE-DOCUMENT-COUNT                        13600000
135800     END-IF.                                                      13610000
135900     PERFORM 5100-CONTROL-BREAK.                                  13620000
136000     MOVE 1 TO PV-ADVANCE-COUNT.                                  13630000
136100*4700-EXIT.                                                       13640000
136200                                                                  13650000
136300******************************************************************13660000
136400* 5000-SET-MKDN-MKON-IDX.  EVALUATES WHICH TYPE OF MARKDOWN/MARK- 13670000
136500* ON HAS BEEN ENCOUNTERED, AND SETS THE APPROPRIATE INDEX.        13680000
136600******************************************************************13690000
136700 5000-SET-MKDN-MKON-IDX.                                          13700000
136800     EVALUATE TRUE                                                13710000
136900         WHEN SA-CATEGORY = PC-PLU-IND                            13720000
137000             SET TT-MKDN-MKON-IDX TO TT-PLU-MKDN-MKON-LEVEL       13730000
137100         WHEN SA-CATEGORY = PC-REGISTER-IND                       13740000
137200             SET TT-MKDN-MKON-IDX TO TT-REGISTER-MKDN-MKON-LEVEL  13750000
137300         WHEN SA-CATEGORY = PC-UNMATCHED-IND                      13760000
137400             SET TT-MKDN-MKON-IDX TO TT-UNMATCHED-MKDN-MKON-LEVEL 13770000
137500         WHEN SA-CATEGORY = PC-BUYER-IND                          13780000
137600             SET TT-MKDN-MKON-IDX TO TT-BUYER-MKDN-MKON-LEVEL     13790000
137700         WHEN SA-CATEGORY = PC-STORE-IND                          13800000
137800             SET TT-MKDN-MKON-IDX TO TT-STORE-MKDN-MKON-LEVEL     13810000
137900     END-EVALUATE.                                                13820000
138000*5000-EXIT.                                                       13830000
138100                                                                  13840000
138200******************************************************************13850000
138300*  5100-CONTROL-BREAK - PRINT CONTROL BREAK TOTALS FOR THE CUR-   13860000
138400*  RENT LEVEL.  ADD THE CURRENT LEVEL TO THE NEXT HIGHER LEVEL    13870000
138500*  TOTALS, IF THE CURRENT LEVEL IS NOT THE CODE TOTAL LEVEL.      13880000
138600*  INITIALZE THE CURRENT LEVEL OF CONTROL BREAK. A STORE DOCUMENT 13890000
138700*  COUNT LINE IS WRITTEN IS THE CURRENT CONTROL BREAK LEVEL IS AT 13900000
138800*  DOCUMENT LEVEL AND A THE CATEGORY OF MARKDOWN/MARKON RESIDES   13910000
138900*  AT A BUYER/STORE INITIATED MARKDOWN/MARKON.                    13920000
139000******************************************************************13930000
139100 5100-CONTROL-BREAK.                                              13940000
139200     IF TT-TOTAL-IDX NOT = TT-STORE-LEVEL                         13950000
139300         MOVE DI-DETAIL-IDENTIFIER (DI-IDENT-IDX)                 13960000
139400            TO DL-TOTAL-IDENTIFIER                                13970000
139500         MOVE 2 TO PV-ADVANCE-COUNT                               13980000
139600     ELSE                                                         13990000
139700         MOVE CK-BUYER-NUMBER        TO DL-BUYER-NUMBER           14000000
139800         MOVE CK-DEPT-NUMBER         TO DL-DEPT-NUMBER            14010000
139900         IF CK-CATEGORY = PC-BUYER-MKDN-MKON-IND                  14020000
140000             MOVE SPACES TO DL-CATEGORY                           14030000
140100             MOVE CK-DOCUMENT-NMBR   TO DL-DOCUMENT-NMBR          14040000
140200         ELSE                                                     14050000
140300             MOVE CK-DOCUMENT-NUMBER TO DL-DOCUMENT-NUMBER        14060000
140400         END-IF                                                   14070000
140500         MOVE CK-STORE-NUMBER        TO DL-STORE-NUMBER           14080000
140600     END-IF.                                                      14090000
140700                                                                  14100000
140800     INITIALIZE PV-QUANTITY                                       14110000
140900                PV-EXTENDED-AMOUNT.                               14120000
141000                                                                  14130000
141100     PERFORM                                                      14140000
141200         VARYING TT-MKDN-MKON-IDX-2                               14150000
141300         FROM 1 BY 1                                              14160000
141400         UNTIL TT-MKDN-MKON-IDX-2 > PC-MAX-MKDN-MKON-TYPES        14170000
141500         ADD TT-QUANTITY (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)       14180000
141600             TO PV-QUANTITY                                       14190000
141700         ADD TT-EXTENDED-AMOUNT (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)14200000
141800             TO PV-EXTENDED-AMOUNT                                14210000
141900     END-PERFORM.                                                 14220000
142000                                                                  14230000
142100     MOVE PV-QUANTITY TO  DL-QUANTITY.                            14240000
142200     MOVE PV-EXTENDED-AMOUNT TO DL-EXTENDED-AMOUNT.               14250000
142300                                                                  14260000
142400     PERFORM 8000-WRITE-DETAIL-LINE.                              14270000
142500                                                                  14280000
142600     IF ((TT-TOTAL-IDX = TT-DOCUMENT-LEVEL) AND                   14290000
142700               (TT-MKDN-MKON-IDX = TT-STORE-MKDN-MKON-LEVEL))     14300000
142800         SET DI-IDENT-IDX TO DI-STORE-DOCUMENT-LEVEL              14310000
142900         MOVE DI-DETAIL-IDENTIFIER (DI-IDENT-IDX)                 14320000
143000             TO DL-STORE-DOC-IDENTIFIER                           14330000
143100         MOVE PV-STORE-DOCUMENT-COUNT TO DL-STORE-DOCUMENT-COUNT  14340000
143200         MOVE 1 TO PV-ADVANCE-COUNT                               14350000
143300         PERFORM 8000-WRITE-DETAIL-LINE                           14360000
143400         INITIALIZE PV-STORE-DOCUMENT-COUNT                       14370000
143500     END-IF.                                                      14380000
143600                                                                  14390000
143700     IF TT-TOTAL-IDX = TT-FINANCE-CORP-LEVEL                      14400000
143800         SET ML010O-MKDN-MKON-IDX TO 1                            14410000
143900         SET FT-MKDN-MKON-IDX     TO 1                            14420000
144000     END-IF.                                                      14430000
144100                                                                  14440000
144200     IF TT-TOTAL-IDX > TT-DOCUMENT-LEVEL                          14450000
144300         MOVE 2 TO PV-ADVANCE-COUNT                               14460000
144400         PERFORM                                                  14470000
144500             VARYING TT-MKDN-MKON-IDX-2                           14480000
144600             FROM 1 BY 1                                          14490000
144700             UNTIL TT-MKDN-MKON-IDX-2 > PC-MAX-MKDN-MKON-TYPES    14500000
144800             SET DI-IDENT-IDX TO TT-MKDN-MKON-IDX-2               14510000
144900             MOVE DI-DETAIL-IDENTIFIER (DI-IDENT-IDX)             14520000
145000                 TO DL-TOTAL-IDENTIFIER                           14530000
145100             MOVE TT-QUANTITY (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)  14540000
145200                 TO DL-QUANTITY                                   14550000
145300             MOVE TT-EXTENDED-AMOUNT                              14560000
145400                       (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)         14570000
145500                 TO DL-EXTENDED-AMOUNT                            14580000
145600             IF TT-TOTAL-IDX = TT-FINANCE-CORP-LEVEL              14590000
145700                 MOVE TT-EXTENDED-AMOUNT                          14600000
145800                           (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)     14610000
145900                     TO ML010O-MKDN-MKON-TOTALS                   14620000
146000                               (ML010O-MKDN-MKON-IDX)             14630000
146100                 ADD TT-EXTENDED-AMOUNT                           14640000
146200                           (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)     14650000
146300                     TO FT-EXTENDED-AMOUNT                        14660000
146400                      (FT-CODE-IDX, FT-CORP-IDX, FT-MKDN-MKON-IDX)14670000
146500                 SET ML010O-MKDN-MKON-IDX UP BY 1                 14680000
146600                 SET FT-MKDN-MKON-IDX UP BY 1                     14690000
146700             END-IF                                               14700000
146800             PERFORM 8000-WRITE-DETAIL-LINE                       14710000
146900             MOVE 1 TO PV-ADVANCE-COUNT                           14720000
147000         END-PERFORM                                              14730000
147100     END-IF.                                                      14740000
147200                                                                  14750000
147300     PERFORM                                                      14760000
147400         VARYING TT-MKDN-MKON-IDX-2                               14770000
147500         FROM 1 BY 1                                              14780000
147600         UNTIL TT-MKDN-MKON-IDX-2 > PC-MAX-MKDN-MKON-TYPES        14790000
147700         IF TT-TOTAL-IDX NOT = TT-CODE-LEVEL                      14800000
147800             ADD TT-QUANTITY (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)   14810000
147900                TO TT-QUANTITY                                    14820000
148000                          (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX + 1)  14830000
148100             ADD TT-EXTENDED-AMOUNT                               14840000
148200                       (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)         14850000
148300                 TO TT-EXTENDED-AMOUNT                            14860000
148400                           (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX + 1) 14870000
148500         END-IF                                                   14880000
148600         INITIALIZE TT-QUANTITY                                   14890000
148700                           (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)     14900000
148800         INITIALIZE TT-EXTENDED-AMOUNT                            14910000
148900                           (TT-MKDN-MKON-IDX-2, TT-TOTAL-IDX)     14920000
149000     END-PERFORM.                                                 14930000
149100*5100-EXIT.                                                       14940000
149200                                                                  14950000
149300******************************************************************14960000
149400* 5200-FILL-SUMMARY-RECORD - FILLS THE SUMMARY RECORD, AFTER A    14970000
149500*  BINARY SEARCH IS DONE TO RETREIVE ALL THE INFORMATION FOR THAT 14980000
149600*  DEPARTMENT.  THIS IS PERFORMED ON CHANGE IN FINANCIAL COR-     14990000
149700*  PORATION NUMBER.  THEREFORE, TWO RECORDS WILL BE PRODUCED FOR  15000000
149800*  EACH DEPARTMENT.                                               15010000
149900******************************************************************15020000
150000 5200-FILL-SUMMARY-RECORD.                                        15030000
150100     MOVE CK-FINANCE-CORP-NMBR TO ML010O-FINANCE-CORP-NMBR.       15040000
150200     MOVE CK-CODE-NUMBER       TO ML010O-MKDN-MKON-CODE.          15050000
150300     SEARCH ALL DR-DEPT-ENTRY                                     15060000
150400         AT END                                                   15070000
150500             DISPLAY '** ABEND **'                                15080000
150600             DISPLAY '** PGM = MLKRP025'                          15090000
150700             DISPLAY '** DEPT ' CK-DEPT-NUMBER                    15100000
150800             DISPLAY '** NOT FOUND IN DEPT RELATIONSHIP TABLE'    15110000
150900             SET AC-INVALID-DATA TO TRUE                          15120000
151000             CALL 'ILBOABN0' USING ABEND-CODE                     15130000
151100         WHEN DR-DEPT-NMBR (DR-DEPT-IDX) = CK-DEPT-NUMBER         15140000
151200             MOVE DR-DEPT-NMBR (DR-DEPT-IDX)                      15150000
151300                 TO  ML010O-DEPT-NMBR                             15160000
151400             MOVE DR-DEPT-DESC (DR-DEPT-IDX)                      15170000
151500                 TO  ML010O-DEPT-DESC                             15180000
151600             MOVE DR-BYR-NMBR  (DR-DEPT-IDX)                      15190000
151700                 TO  ML010O-BYR-NMBR                              15200000
151800             MOVE DR-BYR-NAME  (DR-DEPT-IDX)                      15210000
151900                 TO  ML010O-BYR-NAME                              15220000
152000             MOVE DR-DMM-NMBR  (DR-DEPT-IDX)                      15230000
152100                 TO  ML010O-DMM-NMBR                              15240000
152200             MOVE DR-DMM-NAME  (DR-DEPT-IDX)                      15250000
152300                 TO  ML010O-DMM-NAME                              15260000
152400             MOVE DR-GMM-NMBR  (DR-DEPT-IDX)                      15270000
152500                 TO  ML010O-GMM-NMBR                              15280000
152600             MOVE DR-GMM-NAME  (DR-DEPT-IDX)                      15290000
152700                 TO  ML010O-GMM-NAME.                             15300000
152800             MOVE PV-KOHLS-MONTH TO ML010O-KOHLS-MONTH            15310000
152900     PERFORM 8200-WRITE-SUMMARY-RECORD.                           15320000
153000*5200-EXIT.                                                       15330000
153100                                                                  15340000
153200******************************************************************15350000
153300* 5300-PRINT-CODE-TOTALS - PRINTS THE MARKDOWN/MARKON TOTALS BY   15360000
153400* FINANCIAL CORPORATION AND CATEGORY AS A COMPANY TOTAL PAGE FOR  15370000
153500* AUDIT TRAIL PURPOSES.                                           15380000
153600******************************************************************15390000
153700 5300-PRINT-CODE-TOTALS.                                          15400000
153800     PERFORM                                                      15410000
153900         VARYING FT-CODE-IDX                                      15420000
154000         FROM 1 BY 1                                              15430000
154100         UNTIL FT-CODE-IDX > PC-MAX-CODES                         15440000
154200         SET DI-IDENT-IDX TO DI-CODE-LEVEL                        15450000
154300         IF FT-CODE-IDX = FT-MARKDOWN-CODE-LEVEL                  15460000
154400             MOVE PC-MARKDOWN-LABEL TO DI-CL-CODE-DESC            15470000
154500         ELSE                                                     15480000
154600             IF FT-CODE-IDX = FT-MARKON-CODE-LEVEL                15490000
154700                 MOVE PC-MARKON-CANCEL-LABEL TO DI-CL-CODE-DESC   15500000
154800             END-IF                                               15510000
154900         END-IF                                                   15520000
155000         MOVE DI-DETAIL-IDENTIFIER (DI-IDENT-IDX)                 15530000
155100             TO DL-TOTAL-IDENTIFIER                               15540000
155200         PERFORM 8000-WRITE-DETAIL-LINE                           15550000
155300         MOVE 1 TO PV-ADVANCE-COUNT                               15560000
155400         PERFORM                                                  15570000
155500             VARYING FT-CORP-IDX                                  15580000
155600             FROM 1 BY 1                                          15590000
155700             UNTIL FT-CORP-IDX > PC-MAX-FINANCE-CORPS             15600000
155800             SET DI-IDENT-IDX TO DI-FINANCE-CORP-LEVEL            15610000
155900             IF FT-CORP-IDX = FT-CORP01-LEVEL                     15620000
156000                 MOVE PC-FINANCE-CORP-01                          15630000
156100                     TO DI-FL-FINANCE-CORP-NMBR                   15640000
156200             ELSE                                                 15650000
156300                 IF FT-CORP-IDX = FT-CORP02-LEVEL                 15660000
156400                     MOVE PC-FINANCE-CORP-02                      15670000
156500                         TO DI-FL-FINANCE-CORP-NMBR               15680000
156600                 END-IF                                           15690000
156700             END-IF                                               15700000
156800             MOVE DI-DETAIL-IDENTIFIER (DI-IDENT-IDX)             15710000
156900                 TO DL-TOTAL-IDENTIFIER                           15720000
157000             PERFORM 8000-WRITE-DETAIL-LINE                       15730000
157100             MOVE 2 TO PV-ADVANCE-COUNT                           15740000
157200             PERFORM                                              15750000
157300                 VARYING FT-MKDN-MKON-IDX                         15760000
157400                 FROM 1 BY 1                                      15770000
157500                 UNTIL FT-MKDN-MKON-IDX > PC-MAX-MKDN-MKON-TYPES  15780000
157600                 SET DI-IDENT-IDX TO FT-MKDN-MKON-IDX             15790000
157700                 MOVE DI-DETAIL-IDENTIFIER (DI-IDENT-IDX)         15800000
157800                     TO DL-TOTAL-IDENTIFIER                       15810000
157900                 MOVE FT-EXTENDED-AMOUNT                          15820000
158000                     (FT-CODE-IDX, FT-CORP-IDX, FT-MKDN-MKON-IDX) 15830000
158100                     TO DL-EXTENDED-AMOUNT                        15840000
158200                 PERFORM 8000-WRITE-DETAIL-LINE                   15850000
158300                 MOVE 1 TO PV-ADVANCE-COUNT                       15860000
158400             END-PERFORM                                          15870000
158500             MOVE 2 TO PV-ADVANCE-COUNT                           15880000
158600         END-PERFORM                                              15890000
158700     END-PERFORM.                                                 15900000
158900                                                                  15920000
159000******************************************************************15930000
159100* 7000-READ-MARKDOWN-MARKON-FILE - READ THE MARKDOWN/MARKON FILE  15940000
159200* INTO THE MARKDOWN/MARKON FILE RECORD LAYOUT.                    15950000
159300******************************************************************15960000
159400 7000-READ-MARKDOWN-MARKON-FILE.                                  15970000
159500     READ MARKDOWN-MARKON-FILE                                    15980000
159600         INTO ML009I-MARKDOWN-RECORDS                             15990000
159700             AT END                                               16000000
159800                 SET PS-END-OF-MARKDOWN-MARKON-FILE TO TRUE       16010000
159900     DISPLAY ML009I-MARKDOWN-RECORDS                              16020000
160000     END-READ.                                                    16030000
160100*7000-EXIT.                                                       16040000
160200                                                                  16050000
160300******************************************************************16060000
160400* 7100-READ-RELATIONSHIP-FILE - READ THE DEPARTMENT RELATIONSHIP  16070000
160500* FILE INTO THE DEPARTMENT RELATIONSHIP RECORD LAYOUT.            16080000
160600******************************************************************16090000
160700 7100-READ-RELATIONSHIP-FILE.                                     16100000
160800     READ DEPT-RELATIONSHIP-FILE                                  16110000
160900         INTO MP013I-DEPT-RELATIONAL-RECORD                       16120000
161000             AT END                                               16130000
161100                 SET PS-END-OF-RELATIONSHIP-FILE TO TRUE          16140000
161200     END-READ.                                                    16150000
161300*7100-EXIT.                                                       16160000
161400                                                                  16170000
161500******************************************************************16180000
161600* 7200-RETURN-SORT-WORK-FILE - RETURN THE SORTED MARKDOWN/MARKON  16190000
161700* FILE INTO THE MARKDOWN/MARKON FILE RECORD LAYOUT - OUTPUT.      16200000
161800******************************************************************16210000
161900 7200-RETURN-SORT-WORK-FILE.                                      16220000
162000     RETURN SORT-WORK-FILE                                        16230000
162100         INTO ML009O-MARKDOWN-RECORDS                             16240000
162200             AT END                                               16250000
162300                 SET PS-END-OF-SORT-WORK-FILE TO TRUE.            16260000
162400                                                                  16270000
162500     IF NOT PS-END-OF-SORT-WORK-FILE                              16280000
162600         ADD +1 TO PV-RECORDS-OUT-OF-SORT                         16290000
162700         IF ML009O-MARKDOWN-CODE-40                               16300000
162800             ADD 1 TO PV-MARKDOWN-RECS-READ                       16310000
162900             MOVE PC-MARKDOWN-CODE        TO SA-CODE-NUMBER       16320000
163000             MOVE ML009O-BUYER-NUMBER-40  TO SA-BUYER-NUMBER      16330000
163100             MOVE ML009O-DEPT-NUMBER-40   TO SA-DEPT-NUMBER       16340000
163200             MOVE ML009O-FINANCE-CORP-NMBR-40                     16350000
163300                 TO SA-FINANCE-CORP-NMBR                          16360000
163400             MOVE ML009O-7-DIGIT-DOC-NMBR-40                      16370000
163500                 TO SA-DOCUMENT-NUMBER                            16380000
163600             MOVE ML009O-STORE-NUMBER-40  TO SA-STORE-NUMBER      16390000
163700         ELSE                                                     16400000
163800            IF ML009O-MARKON-CANCEL-CODE-50                       16410000
163900               ADD 1 TO PV-MARKON-CANCEL-RECS-READ                16420000
164000               MOVE PC-MARKON-CANCEL-CODE   TO SA-CODE-NUMBER     16430000
164100               MOVE ML009O-BUYER-NUMBER-50  TO SA-BUYER-NUMBER    16440000
164200               MOVE ML009O-DEPT-NUMBER-50   TO SA-DEPT-NUMBER     16450000
164300               MOVE ML009O-FINANCE-CORP-NMBR-50                   16460000
164400                   TO SA-FINANCE-CORP-NMBR                        16470000
164500               MOVE ML009O-7-DIGIT-DOC-NMBR-50                    16480000
164600                   TO SA-DOCUMENT-NUMBER                          16490000
164700               MOVE ML009O-STORE-NUMBER-50  TO SA-STORE-NUMBER    16500000
164800            END-IF                                                16510000
164900         END-IF                                                   16520000
165000     END-IF.                                                      16530000
165100*7200-EXIT.                                                       16540000
165200                                                                  16550000
165300******************************************************************16560000
165400* 8000-WRITE-DETAIL-LINE. PERFORMS A CHECK VERYING THE PAGE SIZE  16570000
165500* HAS NOT BEEN EXCEEDED.  IF SO, HEADING LINES ARE PRODUCED.  A   16580000
165600* DETAIL LINE IS WRITTEN AND THE LINE COUNT COMPUTED.             16590000
165700******************************************************************16600000
165800 8000-WRITE-DETAIL-LINE.                                          16610000
165900     IF (PV-LINE-COUNT + PV-ADVANCE-COUNT) >                      16620000
166000             PC-PAGE-SIZE                                         16630000
166100         INITIALIZE PV-LINE-COUNT                                 16640000
166200         PERFORM 8100-WRITE-HEADING-LINES                         16650000
166300     END-IF.                                                      16660000
166400     WRITE MARKDOWN-ON-DETAIL-LINE                                16670000
166500         FROM DL-DETAIL-LINE                                      16680000
166600         AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  16690000
166700     COMPUTE PV-LINE-COUNT =                                      16700000
166800             PV-LINE-COUNT + PV-ADVANCE-COUNT.                    16710000
166900     MOVE SPACES TO DL-DETAIL-LINE.                               16720000
167000*8000-EXIT.                                                       16730000
167100                                                                  16740000
167200******************************************************************16750000
167300* 8100-WRITE-USR-TITLE-LINES.  PRODUCES HEADINGS ASSOCIATED WITH  16760000
167400* MARKDOWN/MARKON DETAIL BY BUYER AND DEPARTMENT REPORT.          16770000
167500******************************************************************16780000
167600 8100-WRITE-HEADING-LINES.                                        16790000
167700     ADD 1 TO PV-PAGE-COUNT.                                      16800000
167800     MOVE PV-PAGE-COUNT TO DP075O-PAGE-NUMBER.                    16810000
167900     IF PV-PAGE-COUNT = 1                                         16820000
168000         IF PS-END-OF-SORT-WORK-FILE                              16830000
168100             MOVE 'ALL'          TO HL2-DEPT                      16840000
168200         ELSE                                                     16850000
168300             MOVE CK-DEPT-NUMBER TO HL2-DEPT                      16860000
168400         END-IF                                                   16870000
168500     ELSE                                                         16880000
168600         MOVE CK-DEPT-NUMBER TO HL2-DEPT                          16890000
168700     END-IF.                                                      16900000
168800     WRITE MARKDOWN-ON-DETAIL-LINE                                16910000
168900         FROM DP075O-STANDARD-HEADER-75-COLS                      16920000
169000             AFTER ADVANCING PAGE.                                16930000
169100     MOVE SPACES TO DP075O-LASER-NEW-PAGE-INDICATR.               16940000
169200                                                                  16950000
169300     WRITE MARKDOWN-ON-DETAIL-LINE                                16960000
169400         FROM HL1-HEADING-LINE-1                                  16970000
169500         AFTER ADVANCING 1 LINES                                  16980000
169600                                                                  16990000
169700     WRITE MARKDOWN-ON-DETAIL-LINE                                17000000
169800         FROM HL2-HEADING-LINE-2                                  17010000
169900         AFTER ADVANCING 1 LINES.                                 17020000
170000                                                                  17030000
170100     WRITE MARKDOWN-ON-DETAIL-LINE                                17040000
170200         FROM HL3-HEADING-LINE-3                                  17050000
170300         AFTER ADVANCING 2 LINES.                                 17060000
170400                                                                  17070000
170500     WRITE MARKDOWN-ON-DETAIL-LINE                                17080000
170600         FROM HL4-HEADING-LINE-4                                  17090000
170700         AFTER ADVANCING 1 LINES.                                 17100000
170800                                                                  17110000
170900     MOVE 2 TO PV-ADVANCE-COUNT.                                  17120000
171000     MOVE 7 TO PV-LINE-COUNT.                                     17130000
171100*8100-EXIT.                                                       17140000
171200                                                                  17150000
171300******************************************************************17160000
171400* 8200-WRITE-SUMMARY-RECORD - WRITES THE MARKDOWN/MARKON SUMMATION17170000
171500* RECORD.                                                         17180000
171600******************************************************************17190000
171700 8200-WRITE-SUMMARY-RECORD.                                       17200000
171800     WRITE MARKDOWN-ON-SUMMARY-RECORD                             17210000
171900         FROM ML010O-MKDN-MKON-SUM-RECORD.                        17220000
172000*8200-EXIT.                                                       17230000
172100                                                                  17240000
172200******************************************************************17250000
172300* 8300-PRINT-DISPLAY-COUNTS.  PRINTS DISPLAY COUNTERS FOR         17260000
172400* MARKDOWN/MARKON AND TOTAL RECORDS READ, ALONG WITH WRITTING     17270000
172500* THE KOHLS STANDARD END OF REPORT LINE.                          17280000
172600******************************************************************17290000
172700  8300-PRINT-DISPLAY-COUNTS.                                      17300000
172800     MOVE PV-MARKDOWN-RECS-READ TO DC-TOTAL-RECORDS-READ.         17310000
172900     MOVE PC-MARKDOWN-LABEL TO DC-MARKDOWN-MARKON-LABEL.          17320000
173000     WRITE MARKDOWN-ON-DETAIL-LINE                                17330000
173100         FROM  DC-DISPLAY-COUNTERS-LINE                           17340000
173200         AFTER ADVANCING 2 LINES.                                 17350000
173300     MOVE PV-MARKON-CANCEL-RECS-READ TO DC-TOTAL-RECORDS-READ.    17360000
173400     MOVE PC-MARKON-CANCEL-LABEL TO DC-MARKDOWN-MARKON-LABEL.     17370000
173500     WRITE MARKDOWN-ON-DETAIL-LINE                                17380000
173600         FROM  DC-DISPLAY-COUNTERS-LINE                           17390000
173700         AFTER ADVANCING 1 LINES.                                 17400000
173800     MOVE SPACES TO DC-DISPLAY-COUNTERS-LINE.                     17410000
173900     COMPUTE PV-TOTAL-RECS-READ =                                 17420000
174000         PV-MARKDOWN-RECS-READ + PV-MARKON-CANCEL-RECS-READ.      17430000
174100     MOVE PV-TOTAL-RECS-READ TO DC-TOTAL-RECORDS-READ.            17440000
174200     MOVE PC-COMPANY-RECS-LABEL TO DC-COMPANY-RECS-LABEL          17450000
174300     WRITE MARKDOWN-ON-DETAIL-LINE                                17460000
174400         FROM  DC-DISPLAY-COUNTERS-LINE                           17470000
174500         AFTER ADVANCING 2 LINES.                                 17480000
174600     WRITE MARKDOWN-ON-DETAIL-LINE                                17490000
174700         FROM  END-OF-REPORT-LINE                                 17500000
174800         AFTER ADVANCING 2 LINES.                                 17510000
174900*8300-EXIT.                                                       17520000
175000                                                                  17530000
175100******************************************************************17540000
175200* 9000-EOJ-ROUTINE  -  CLOSES ALL FILES ASSOCIATED WITH JOB       17550000
175300******************************************************************17560000
175400 9000-EOJ-ROUTINE.                                                17570000
175500     CLOSE MARKDOWN-MARKON-FILE                                   17580000
175600           DEPT-RELATIONSHIP-FILE                                 17590000
175700           MARKDOWN-ON-DETAIL-REPORT                              17600000
175800           MARKDOWN-ON-SUMMARY-FILE.                              17610000
175900*9000-EXIT.                                                       17620000
176000                                                                  17630000
176100******************************************************************17640000
176200*  FORMAT A DB2 ERROR MESSAGE, RELEASE ALL LOCKS, AND ABEND THE  *17650000
176300*  PROGRAM.                                                      *17660000
176400******************************************************************17670000
176500 9100-SQL-ERROR.                                                  17680000
176600     MOVE SQLCODE                    TO SQLCODE2.                 17690000
176700     MOVE SQLERRD(3)                 TO SQLERRD3.                 17700000
176800     DISPLAY '** ABEND **          = SQL ERROR'.                  17710000
176900     DISPLAY '** PROGRAM **        = MLKRP025'                    17720000
177000     DISPLAY '** PARAGRAPH **      = ' PV-PARAGRAPH-NAME          17730000
177100     DISPLAY '** SQLCODE **        = ' SQLCODE2.                  17740000
177200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  17750000
177300     DISPLAY '** SQLERRM **        = ' SQLERRM.                   17760000
177400     DISPLAY '** SQLERRMC **       = ' SQLERRMC.                  17770000
177500                                                                  17780000
177600     DISPLAY '** SQLWARN0 **       = ' SQLWARN0.                  17790000
177700     DISPLAY '** SQLWARN1 **       = ' SQLWARN1.                  17800000
177800     DISPLAY '** SQLWARN2 **       = ' SQLWARN2.                  17810000
177900     DISPLAY '** SQLWARN3 **       = ' SQLWARN3.                  17820000
178000     DISPLAY '** SQLWARN4 **       = ' SQLWARN4.                  17830000
178100     DISPLAY '** SQLWARN5 **       = ' SQLWARN5.                  17840000
178200     DISPLAY '** SQLWARN6 **       = ' SQLWARN6.                  17850000
178300     DISPLAY '** SQLWARN7 **       = ' SQLWARN7.                  17860000
178400     DISPLAY '** ABEND     **'.                                   17870000
178500     DISPLAY '** PROGRAM   ** = MLKRP025'.                        17880000
178600     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              17890000
178700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               17900000
178800                                                                  17910000
178900******************************************************************17920000
179000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    17930000
179100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         17940000
179200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     17950000
179300* FORMAT.                                                         17960000
179400******************************************************************17970000
179500     COPY DPPD004.                                                17980003
179600                                                                  17990000
179700     SET AC-DB2-ERROR TO TRUE.                                    18000000
179800     CALL 'ILBOABN0' USING ABEND-CODE.                            18010000
179900                                                                  18020000
180000******************************************************************18030000
180100* 9200-SQL-WARNING - PERFORMS THE ABEND FOR THE PROGRAM IN THE    18040000
180200* EVENT THAT AN SQL WARNING CODE OCCURS.                          18050000
180300******************************************************************18060000
180400 9200-SQL-WARNING.                                                18070000
180500     MOVE SQLCODE TO SQLCODE2.                                    18080000
180600     MOVE SQLERRD(3) TO SQLERRD3.                                 18090000
180700     DISPLAY '** ABEND **       ** = SQLWARNING'.                 18100000
180800     DISPLAY '** PROGRAM        ** = MLKRP025'.                   18110000
180900     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  18120000
181000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  18130000
181100     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  18140000
181200     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  18150000
181300     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  18160000
181400     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  18170000
181500     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  18180000
181600     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  18190000
181700     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  18200000
181800     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  18210000
181900     SET AC-DB2-ERROR TO TRUE.                                    18220000
182000     CALL 'ILBOABN0' USING ABEND-CODE.                            18230000
182100*9200-EXIT.                                                       18240000
182200                                                                  18250000
