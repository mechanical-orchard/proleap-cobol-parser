000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS216.                                         00020000
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-16-94                                          00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    E216 - MATCH PURCHASE ORDER LINE LIST                        00080000
000900*                                                                 00090000
001000*    DISPLAYS ALL PURCHASE ORDER LINES FOR A PURCHASE ORDER.      00100000
001100*    THE USER CAN SELECT LINES TO ADD TO THE PACK SLIP            00110000
001200*                                                                 00120000
001300*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00130000
001400*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00140000
001500*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00150000
001600*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00160000
001700*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00170000
001800*                                                                 00180000
001900* 06/25/2014  CHERI PARMLEY                                       00190011
002000*    ADDING CHECK WITHIN THE PROCESSING OF THE PO'S TO CHECK FOR  00200012
002100*    THE PACKAGING CODE, PREPK-ID AND THE CANCEL STATUS, IF IT    00210012
002200*    MEETS CRITERIA THE ITEM ROW WILL NOT BE DISPLAYED ON THE     00220012
002300*    SCREEN.  MAIN CHANGE BEGINS IN 4040-GET-PO-ITEMS             00230012
002400*        SEE CHANGES TAGGED WITH CLP 06/25/14                     00240006
002500******************************************************************00250000
002510*---------------------------------------------------------------* 00251011
002520* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00252011
002530* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00253011
002540* MAKING THE CALL DYNAMIC VS STATIC.                              00254011
002550*---------------------------------------------------------------* 00255011
002600 ENVIRONMENT DIVISION.                                            00260000
002700 DATA DIVISION.                                                   00270000
002800 WORKING-STORAGE SECTION.                                         00280000
002900                                                                  00290000
003000 01  PC-PROGRAM-CONSTANTS.                                        00300000
003100     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC216A  '. 00310000
003200     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM216 '. 00320000
003300     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS216'. 00330000
003400     05  PC-RCKUP006                  PIC X(08) VALUE 'RCKUP006'. 00340000
003500     05  PC-PO-ALLOCATION             PIC X(8)  VALUE 'PO ALLC '. 00350000
003600     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00360000
003700     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00370000
003800     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +6          00380000
003900                                                COMP SYNC.        00390000
004000     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00400000
004100                                                COMP SYNC.        00410000
004200     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00420000
004300                                                COMP SYNC.        00430000
004400     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00440000
004500                                                COMP SYNC.        00450000
004600     05  PC-01                        PIC X(02) VALUE '01'.       00460000
004700     05  PC-AC                        PIC X(02) VALUE 'AC'.       00470000
004800     05  PC-AP                        PIC X(02) VALUE 'AP'.       00480000
004900     05  PC-CA                        PIC X(02) VALUE 'CA'.       00490000
005000     05  PC-CB                        PIC X(02) VALUE 'CB'.       00500000
005100     05  PC-CM                        PIC X(02) VALUE 'CM'.       00510000
005200     05  PC-RV                        PIC X(02) VALUE 'RV'.       00520000
005300     05  PC-IN                        PIC X(02) VALUE 'IN'.       00530000
005400     05  PC-IP                        PIC X(02) VALUE 'IP'.       00540000
005500     05  PC-VE                        PIC X(02) VALUE 'VE'.       00550000
005600     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00560000
005700     05  PC-A                         PIC X(01) VALUE 'A'.        00570000
005800     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00580000
005900     05  PC-N                         PIC X(01) VALUE 'N'.        00590000
006000*CLP 06/25/14 - START                                             00600007
006100     05  PC-I                         PIC X(01) VALUE 'I'.        00610007
006200     05  PC-M                         PIC X(01) VALUE 'M'.        00620007
006300*CLP 06/25/14 - END                                               00630007
006400     05  PC-STAT-1                    PIC X(02) VALUE SPACE.      00640000
006500     05  PC-STAT-2                    PIC X(02) VALUE SPACE.      00650000
006600     05  PC-STAT-3                    PIC X(02) VALUE SPACE.      00660000
006700     05  PC-STAT-4                    PIC X(02) VALUE SPACE.      00670000
006800     05  PC-STAT-5                    PIC X(02) VALUE SPACE.      00680000
006900     05  PC-STAT-6                    PIC X(02) VALUE SPACE.      00690000
007000                                                                  00700000
007100     05  PC-TSYMSG-NUMBERS.                                       00710000
007200         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00720000
007300*            INVALID VALUE                                        00730000
007400         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00740000
007500*            MUST BE NUMERIC                                      00750000
007600         10  PC-TSYMSG-00034          PIC 9(5)  VALUE 00034.      00760000
007700*            ADD(S) SUCCESSFUL                                    00770000
007800         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00780000
007900*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00790000
008000         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00800000
008100*            NO END OF RANGE HAS BEEN SPECIFIED                   00810000
008200         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00820000
008300*            END OF RANGE PRECEDES START OF RANGE                 00830000
008400         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00840000
008500*            NO START OF RANGE HAS BEEN SPECIFIED                 00850000
008600         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00860000
008700*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00870000
008800         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00880000
008900*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00890000
009000         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00900000
009100*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00910000
009200         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00920000
009300*            TOP OF LIST                                          00930000
009400         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00940000
009500*            BOTTOM OF LIST                                       00950000
009600         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00960000
009700*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00970000
009800         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     00980000
009900*            CANNOT ADD - RECORD ALREADY EXISTS                   00990000
010000         10  PC-TSYMSG-00148          PIC 9(5)  VALUE 00148.      01000000
010100*            DATA DOES NOT EXIST                                  01010000
010200         10  PC-TSYMSG-00168          PIC 9(5)  VALUE 00168.      01020000
010300*            INVALID PURCHASE ORDER STATUS FOR THIS FUNCTION      01030000
010400         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01040000
010500*            MORE ITEMS TO DISPLAY                                01050000
010600         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      01060000
010700*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL01070000
010800         10  PC-TSYMSG-00726          PIC 9(5)  VALUE 00726.      01080000
010900*            PURCHASE ORDER NOT FOUND                             01090000
011000                                                                  01100000
011100 01  PS-PROGRAM-SWITCHES.                                         01110000
011200     05  PS-PREPACK-SW                PIC X(01) VALUE 'N'.        01120000
011300         88  PREPACK-PO                         VALUE 'Y'.        01130000
011400         88  NOT-PREPACK-PO                     VALUE 'N'.        01140000
011500     05  PS-ORIG-ASN-PKSLIP-SW        PIC  X    VALUE 'N'.        01150000
011600         88  PS-ORIG-ASN-PKSLIP-YES             VALUE 'Y'.        01160000
011700         88  PS-ORIG-ASN-PKSLIP-NO              VALUE 'N'.        01170000
011800     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01180000
011900         88  PS-NO-ERROR                        VALUE 'N'.        01190000
012000         88  PS-ERROR                           VALUE 'Y'.        01200000
012100     05  PS-SEARCH-LINE-SW            PIC  X    VALUE 'N'.        01210000
012200         88  PS-INVALID-SEARCH-LINE             VALUE 'N'.        01220000
012300         88  PS-VALID-SEARCH-LINE               VALUE 'Y'.        01230000
012400     05  PS-PKITEM-SW                 PIC  X    VALUE 'N'.        01240000
012500         88  PS-PKITEM-NOT-FOUND                VALUE 'N'.        01250000
012600         88  PS-PKITEM-FOUND                    VALUE 'Y'.        01260000
012700     05  PS-PLAN-FOUND-SW             PIC  X    VALUE 'N'.        01270000
012800         88  PS-PLAN-NOT-FOUND                  VALUE 'N'.        01280000
012900         88  PS-PLAN-FOUND                      VALUE 'Y'.        01290000
013000     05  PS-PROCESS-PO-SW             PIC  X    VALUE 'Y'.        01300000
013100         88  PS-PROCESS-PO                      VALUE 'Y'.        01310000
013200         88  PS-DONT-PROCESS-PO                 VALUE 'N'.        01320000
013300     05  PS-ERROR-IN-QTY-SW           PIC  X    VALUE 'Y'.        01330000
013400         88  PS-ERROR-IN-QTY                    VALUE 'Y'.        01340000
013500         88  PS-NO-ERROR-IN-QTY                 VALUE 'N'.        01350000
013600                                                                  01360000
013700 01  DK-DB2-KEYS.                                                 01370000
013800     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01380000
013900     05  DK-STR-NBR-B                 PIC S9(4) COMP VALUE +0.    01390000
014000     05  DK-STR-NBR-E                 PIC S9(4) COMP VALUE +9999. 01400000
014100                                                                  01410000
014200 01  PV-PROGRAM-VARIABLES.                                        01420000
014300     05  PV-SUB                       PIC S9(4) VALUE ZERO        01430000
014400                                                COMP SYNC.        01440000
014500     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01450000
014600                                                COMP SYNC.        01460000
014700     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01470000
014800                                                COMP-3.           01480000
014900     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01490000
015000                                                COMP-3.           01500000
015100     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01510000
015200                                                COMP-3.           01520000
015300     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01530000
015400                                                COMP-3.           01540000
015500     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01550000
015600                                                COMP-3.           01560000
015700     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01570000
015800                                                COMP-3.           01580000
015900     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01590000
016000                                                COMP-3.           01600000
016100     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01610000
016200                                                COMP SYNC.        01620000
016300     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01630000
016400                                                COMP SYNC.        01640000
016500     05  PV-COUNTER                   PIC S9(04) VALUE +0         01650000
016600                                                 COMP SYNC.       01660000
016700     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01670000
016800                                                 COMP SYNC.       01680000
016900     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01690000
017000                                                COMP SYNC.        01700000
017100     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01710000
017200                                                COMP SYNC.        01720000
017300     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01730000
017400                                                COMP SYNC.        01740000
017500     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01750000
017600                                                COMP SYNC.        01760000
017700     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01770000
017800                                                COMP SYNC.        01780000
017900     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01790000
018000                                                COMP SYNC.        01800000
018100     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01810000
018200                                                COMP SYNC.        01820000
018300     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01830000
018400                                                COMP SYNC.        01840000
018500     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01850000
018600                                                COMP SYNC.        01860000
018700     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01870000
018800                                                COMP SYNC.        01880000
018900     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01890000
019000                                                COMP SYNC.        01900000
019100     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01910000
019200                                                COMP SYNC.        01920000
019300     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        01930000
019400                                                COMP SYNC.        01940000
019500     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        01950000
019600                                                COMP SYNC.        01960000
019700     05  PV-REC-IND                   PIC S9(4) VALUE ZERO        01970000
019800                                                COMP SYNC.        01980000
019900     05  PV-DISTRO-IND                PIC S9(4) VALUE ZERO        01990000
020000                                                COMP SYNC.        02000000
020100     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        02010000
020200                                                COMP SYNC.        02020000
020300     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        02030000
020400                                                COMP SYNC.        02040000
020500     05  PV-REC-ITEMS                 PIC S9(9) VALUE ZERO        02050000
020600                                                COMP SYNC.        02060000
020700     05  PV-SUM-EXPTED-QTY            PIC S9(9) VALUE ZERO        02070000
020800                                                COMP SYNC.        02080000
020900     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        02090000
021000                                                COMP SYNC.        02100000
021100     05  PV-SUM-DISTRO-QTY            PIC S9(9) VALUE ZERO        02110000
021200                                                COMP SYNC.        02120000
021300     05  PV-SUM-STR-DISTRO-QTY        PIC S9(9) VALUE ZERO        02130000
021400                                                COMP SYNC.        02140000
021500     05  PV-ORIG-PKSL-ITM-QTY         PIC S9(9) VALUE +0 COMP.    02150000
021600     05  PV-OPEN-TO-REC               PIC S9(7) COMP-3            02160000
021700                                                VALUE ZERO.       02170000
021800     05  PV-OPEN-TO-REC-X             PIC X(5).                   02180000
021900     05  PV-STATUS-CDE                PIC X(02) VALUE SPACES.     02190000
022000         88  PV-VALID-STATUS-CDE                VALUES 'AP', 'AC'.02200000
022100     05  PV-PKGNG-CDE                 PIC X(01) VALUE SPACES.     02210006
022200     05  PV-NUMBER-OF-RV-ITEMS        PIC S9(2) VALUE ZERO.       02220000
022300     05  PV-NIS-SKU-NBR               PIC  9(8) VALUE ZERO.       02230000
022400*                                                                 02240000
022500     05  PC-000                       PIC X(03) VALUE '000'.      02250000
022600     05  PC-999                       PIC X(03) VALUE '999'.      02260000
022700*                                                                 02270000
022800     05  WS-PUBLISH-MESSAGE.                                      02280000
022900         10  FILLER                   PIC X(9)  VALUE 'RCKCS216'. 02290000
023000         10  WS-PUBLISH-PO            PIC 9(8)  VALUE 0.          02300000
023100         10  FILLER                   PIC X(14) VALUE             02310000
023200             'PSLPCK        '.                                    02320000
023300         10  FILLER                   PIC X(20) VALUE             02330000
023400             'PACKSLIP PACK RECPT '.                              02340000
023500         10  WS-PUBLISH-SKU           PIC 9(8)  VALUE 0.          02350000
023600 01  LQW-LIST-QUEUE-WORK-AREA.                                    02360000
023700     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02370000
023800     05  LQW-ITEM-ENTRIES             OCCURS 6 TIMES              02380000
023900                                      INDEXED BY LQW-IDX.         02390000
024000         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02400000
024100         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02410000
024200         10  LQW-SELECTED-SW          PIC X(01).                  02420000
024300             88  LQW-SELECT                      VALUE 'S'.       02430000
024400             88  LQW-DESELECT                    VALUE ' '.       02440000
024500         10  LQW-PKSL-ITM-QTY         PIC 9(06).                  02450000
024600         10  LQW-PKSL-LNE-NBR         PIC 9(04).                  02460000
024700         10  LQW-VEND-STYL-NAME       PIC X(20).                  02470000
024800         10  LQW-COLOR-DESC           PIC X(25).                  02480000
024900         10  LQW-OPEN-TO-REC          PIC X(06).                  02490000
025000         10  LQW-OTR-QTY              PIC 9(6).                   02500000
025100         10  LQW-UNT-COST-AMT         PIC 9(4)V9(3).              02510000
025200         10  LQW-VEND-DESC            PIC X(20).                  02520000
025300         10  LQW-SIZE-DESC            PIC X(25).                  02530000
025400         10  LQW-CL-NBR               PIC X(02).                  02540000
025500         10  LQW-SKU-SEQ-NBR          PIC X(08).                  02550000
025600         10  LQW-STATUS               PIC X(02).                  02560000
025700         10  LQW-PURITM-VER-NBR       PIC S9(9)  COMP.            02570000
025800         10  LQW-PO-LNE-NBR           PIC  9(04).                 02580000
025900                                                                  02590000
026000*----------------------------------------------------------------*02600000
026100* COPY BOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               02610000
026200*----------------------------------------------------------------*02620000
026300     COPY XLWS001.                                                02630000
026400*                                                                 02640000
026500******************************************************************02650000
026600*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02660000
026700******************************************************************02670000
026800     COPY RCWS013.                                                02680000
026900                                                                  02690000
027000******************************************************************02700000
027100*    BMS MAP                                                      02710000
027200******************************************************************02720000
027300     COPY RCKM216.                                                02730000
027400                                                                  02740000
027500 01  MR-OCCURS-LAYOUT                 REDEFINES RC216AO.          02750000
027600** CHG0094517  CHANGED FILLER LENGTH FROM 137 TO 138              02760010
027700     05  FILLER                       PIC X(138).                 02770010
027800     05  MR-SCROLL-AREA               OCCURS 6 TIMES.             02780000
027900         10  MR-SELECTL               PIC S9(4) COMP.             02790000
028000         10  MR-SELECTA               PIC X.                      02800000
028100         10  MR-SELECTC               PIC X.                      02810000
028200         10  MR-SELECTH               PIC X.                      02820000
028300         10  MR-SELECTI               PIC X.                      02830000
028400                                                                  02840000
028500         10  MR-PKSL-ITM-QTY-L        PIC S9(4) COMP.             02850000
028600         10  MR-PKSL-ITM-QTY-A        PIC X.                      02860000
028700         10  MR-PKSL-ITM-QTY-C        PIC X.                      02870000
028800         10  MR-PKSL-ITM-QTY-H        PIC X.                      02880000
028900         10  MR-PKSL-ITM-QTY.                                     02890000
029000             15  MR-PKSL-ITM-QTY-EDITED                           02900000
029100                                      PIC ZZZZZZ.                 02910000
029200                                                                  02920000
029300         10  MR-LINE-L                PIC S9(4) COMP.             02930000
029400         10  MR-LINE-A                PIC X.                      02940000
029500         10  MR-LINE-C                PIC X.                      02950000
029600         10  MR-LINE-H                PIC X.                      02960000
029700         10  MR-LINE                  PIC X(04).                  02970000
029800                                                                  02980000
029900         10  MR-VEND-STYL-NAME-L      PIC S9(4) COMP.             02990000
030000         10  MR-VEND-STYL-NAME-A      PIC X.                      03000000
030100         10  MR-VEND-STYL-NAME-C      PIC X.                      03010000
030200         10  MR-VEND-STYL-NAME-H      PIC X.                      03020000
030300         10  MR-VEND-STYL-NAME        PIC X(20).                  03030000
030400                                                                  03040000
030500         10  MR-COLOR-DESC-L          PIC S9(4) COMP.             03050000
030600         10  MR-COLOR-DESC-A          PIC X.                      03060000
030700         10  MR-COLOR-DESC-C          PIC X.                      03070000
030800         10  MR-COLOR-DESC-H          PIC X.                      03080000
030900         10  MR-COLOR-DESC            PIC X(25).                  03090000
031000                                                                  03100000
031100         10  MR-OTR-L                 PIC S9(4) COMP.             03110000
031200         10  MR-OTR-A                 PIC X.                      03120000
031300         10  MR-OTR-C                 PIC X.                      03130000
031400         10  MR-OTR-H                 PIC X.                      03140000
031500         10  MR-OTR                   PIC X(6).                   03150000
031600                                                                  03160000
031700         10  MR-UNT-COST-AMT-L        PIC S9(4) COMP.             03170000
031800         10  MR-UNT-COST-AMT-A        PIC X.                      03180000
031900         10  MR-UNT-COST-AMT-C        PIC X.                      03190000
032000         10  MR-UNT-COST-AMT-H        PIC X.                      03200000
032100         10  MR-UNT-COST-AMT.                                     03210000
032200             15  MR-UNT-COST-AMT-EDITED                           03220000
032300                                      PIC ZZ,ZZZ.999.             03230000
032400                                                                  03240000
032500         10  MR-VEND-DESC-L           PIC S9(4) COMP.             03250000
032600         10  MR-VEND-DESC-A           PIC X.                      03260000
032700         10  MR-VEND-DESC-C           PIC X.                      03270000
032800         10  MR-VEND-DESC-H           PIC X.                      03280000
032900         10  MR-VEND-DESC             PIC X(20).                  03290000
033000                                                                  03300000
033100         10  MR-SIZE-DESC-L           PIC S9(4) COMP.             03310000
033200         10  MR-SIZE-DESC-A           PIC X.                      03320000
033300         10  MR-SIZE-DESC-C           PIC X.                      03330000
033400         10  MR-SIZE-DESC-H           PIC X.                      03340000
033500         10  MR-SIZE-DESC             PIC X(25).                  03350000
033600                                                                  03360000
033700         10  MR-CL-NBR-L              PIC S9(4) COMP.             03370000
033800         10  MR-CL-NBR-A              PIC X.                      03380000
033900         10  MR-CL-NBR-C              PIC X.                      03390000
034000         10  MR-CL-NBR-H              PIC X.                      03400000
034100         10  MR-CL-NBR                PIC X(02).                  03410000
034200                                                                  03420000
034300         10  MR-SKU-SEQ-NBR-L         PIC S9(4) COMP.             03430000
034400         10  MR-SKU-SEQ-NBR-A         PIC X.                      03440000
034500         10  MR-SKU-SEQ-NBR-C         PIC X.                      03450000
034600         10  MR-SKU-SEQ-NBR-H         PIC X.                      03460000
034700         10  MR-SKU-SEQ-NBR           PIC X(08).                  03470000
034800                                                                  03480000
034900         10  MR-STATUS-L              PIC S9(4) COMP.             03490000
035000         10  MR-STATUS-A              PIC X.                      03500000
035100         10  MR-STATUS-C              PIC X.                      03510000
035200         10  MR-STATUS-H              PIC X.                      03520000
035300         10  MR-STATUS                PIC X(02).                  03530000
035400                                                                  03540000
035500******************************************************************03550000
035600*    BMS ATTRIBUTES                                               03560000
035700******************************************************************03570000
035800     COPY DPWS015.                                                03580000
035900                                                                  03590000
036000******************************************************************03600000
036100*    FUNCTION KEYS                                                03610000
036200******************************************************************03620000
036300     COPY DPWS016.                                                03630000
036400                                                                  03640000
036500******************************************************************03650000
036600*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   03660000
036700******************************************************************03670000
036800     COPY DPWS010I.                                               03680000
036900                                                                  03690000
037000******************************************************************03700000
037100*    PARAMETER LIST FOR CICS API                                  03710000
037200******************************************************************03720000
037300     COPY DPWS030.                                                03730000
037310     COPY DPWS930.                                                03731012
037400                                                                  03740000
037500******************************************************************03750000
037600*    GLOBAL COMMUNICATION AREA                                    03760000
037700******************************************************************03770000
037800     COPY DPWS020.                                                03780000
037900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03790000
038000                                                                  03800000
038100******************************************************************03810000
038200*    INTER-APPLICATION COMMUNICATION AREA                         03820000
038300*    RCWS015 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    03830000
038400******************************************************************03840000
038500         10  INTER-APPL-COMM-AREA       PIC X(200).               03850000
038600     COPY RCWS015.                                                03860000
038700                                                                  03870000
038800******************************************************************03880000
038900*    APPLICATION SPECIFIC COMMUNICATION AREA                      03890000
039000******************************************************************03900000
039100         10  ASC-SPECIFIC-COMMAREA.                               03910000
039200             15  ASC-LIST-HEADER-INFO.                            03920000
039300                 20  ASC-KEY-SEARCH-LINE.                         03930000
039400                     25  ASC-KEY-SEARCH-LINE-N  PIC 9(04).        03940000
039500** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03950009
039600                 20  ASC-KEY-PO-NBR.                              03960009
039700                     25  ASC-KEY-PO-NBR-N       PIC 9(08).        03970009
039800                 20  ASC-KEY-PKSL-NBR           PIC X(10).        03980000
039900                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        03990000
040000                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   04000000
040100                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   04010000
040200                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   04020000
040300                 20  ASC-KEY-STR-NBR            PIC S9(4) COMP.   04030000
040400                 20  ASC-KEY-REC-SEQ-NBR        PIC S9(9) COMP.   04040000
040500             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               04050000
040600                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       04060000
040700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04070000
040800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04080000
040900                                                                  04090000
041000                 20  ASC-ITEM-ARRAY.                              04100000
041100                     25  ASC-ITEM-ENTRIES  OCCURS 6 TIMES.        04110000
041200                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    04120000
041300                                                     COMP-3.      04130000
041400                         30  ASC-TEMP-SELECTED-SW    PIC X.       04140000
041500                             88  ASC-VALID-SELECT    VALUE ' '    04150000
041600                                                           'S'    04160000
041700                                                           'B'    04170000
041800                                                           'E'.   04180000
041900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04190000
042000                             88  ASC-TEMP-SELECT     VALUE 'S'.   04200000
042100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04210000
042200                             88  ASC-TEMP-END        VALUE 'E'.   04220000
042300                         30  ASC-SELECTED-SW         PIC  X.      04230000
042400                             88  ASC-NO-SELECT       VALUE ' '.   04240000
042500                             88  ASC-SELECT          VALUE 'S'.   04250000
042600                             88  ASC-BEGIN           VALUE 'B'.   04260000
042700                             88  ASC-END             VALUE 'E'.   04270000
042800                         30  ASC-PKSL-ITM-QTY.                    04280000
042900                             35  ASC-PKSL-ITM-QTY-N  PIC 9(06).   04290000
043000                         30  ASC-PKSL-LNE-NBR.                    04300000
043100                             35  ASC-PKSL-LNE-NBR-N  PIC 9(04).   04310000
043200                         30  ASC-VEND-STYL-NAME      PIC X(20).   04320000
043300                         30  ASC-COLOR-DESC          PIC X(25).   04330000
043400                         30  ASC-OPEN-TO-REC         PIC X(6).    04340000
043500                         30  ASC-OTR-QTY             PIC 9(6).    04350000
043600                         30  ASC-UNT-COST-AMT.                    04360000
043700                             35  ASC-UNT-COST-AMT-N PIC 9(4)V9(3).04370000
043800                         30  ASC-VEND-DESC           PIC X(20).   04380000
043900                         30  ASC-SIZE-DESC           PIC X(25).   04390000
044000                         30  ASC-CL-NBR              PIC X(02).   04400000
044100                         30  ASC-SKU-SEQ-NBR         PIC X(08).   04410000
044200                         30  ASC-STATUS              PIC X(02).   04420000
044300                         30  ASC-PURITM-VER-NBR      PIC S9(9)    04430000
044400                                                     COMP.        04440000
044500                         30  ASC-PO-LNE-NBR.                      04450000
044600                             35  ASC-PO-LNE-NBR-N    PIC  9(04).  04460000
044700                                                                  04470000
044800             15  ASC-BLK-SUB                         PIC S9(4)    04480000
044900                                                     COMP SYNC.   04490000
045000             15  ASC-ITEM-SUB                        PIC S9(4)    04500000
045100                                                     COMP SYNC.   04510000
045200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    04520000
045300                                                     COMP-3.      04530000
045400             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    04540000
045500                                                     COMP-3.      04550000
045600             15  ASC-ITEMS-DISPLAYED                 PIC S999     04560000
045700                                                     COMP-3.      04570000
045800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    04580000
045900                                                     COMP-3.      04590000
046000             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    04600000
046100                                                     COMP-3.      04610000
046200             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    04620000
046300                                                     COMP SYNC.   04630000
046400             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    04640000
046500                                                     COMP-3.      04650000
046600             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    04660000
046700                                                     COMP-3.      04670000
046800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       04680000
046900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04690000
047000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04700000
047100             15  ASC-LIST-QUEUE-NAME.                             04710000
047200                 20  ASC-LIST-TERM-ID                PIC X(4).    04720000
047300                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    04730000
047400                                                     COMP-3.      04740000
047500                 20  ASC-LIST-SEQ                    PIC 9.       04750000
047600             15  ASC-SEL-QUEUE-NAME.                              04760000
047700                 20  ASC-SEL-TERM-ID                 PIC X(4).    04770000
047800                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    04780000
047900                                                     COMP-3.      04790000
048000                 20  ASC-SEL-SEQ                     PIC 9.       04800000
048100             15  ASC-START-ITEM-REQUEST.                          04810000
048200                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    04820000
048300             15  ASC-PO-ITEMS-SW                     PIC X.       04830000
048400                 88  ASC-MORE-PO-ITEMS               VALUE 'Y'.   04840000
048500                 88  ASC-NO-MORE-PO-ITEMS            VALUE 'N'.   04850000
048600             15  ASC-HOLD-INTER-APPL                 PIC X(200).  04860000
048700                                                                  04870000
048800******************************************************************04880000
048900*    ABEND PROCESSING                                             04890000
049000******************************************************************04900000
049100     COPY DPWS013.                                                04910000
049200                                                                  04920000
049300******************************************************************04930000
049400*    DB2 SQL COMMUNICATION AREA                                   04940000
049500******************************************************************04950000
049600     EXEC SQL                                                     04960000
049700          INCLUDE SQLCA                                           04970000
049800     END-EXEC.                                                    04980000
049900                                                                  04990000
050000******************************************************************05000000
050100*    DB2 DCLGEN FOR PACK SLIP TABLE                               05010000
050200******************************************************************05020000
050300     EXEC SQL                                                     05030000
050400          INCLUDE TPKSLIP                                         05040000
050500     END-EXEC.                                                    05050000
050600                                                                  05060000
050700******************************************************************05070000
050800*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          05080000
050900******************************************************************05090000
051000     EXEC SQL                                                     05100000
051100          INCLUDE TPKITEM                                         05110000
051200     END-EXEC.                                                    05120000
051300                                                                  05130000
051400******************************************************************05140000
051500*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          05150000
051600******************************************************************05160000
051700     EXEC SQL                                                     05170000
051800          INCLUDE TPURCHS                                         05180000
051900     END-EXEC.                                                    05190000
052000                                                                  05200000
052100******************************************************************05210000
052200*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     05220000
052300******************************************************************05230000
052400     EXEC SQL                                                     05240000
052500          INCLUDE TPURITM                                         05250000
052600     END-EXEC.                                                    05260000
052700                                                                  05270000
052800******************************************************************05280000
052900*    DB2 DCLGEN FOR SKU TABLE                                     05290000
053000******************************************************************05300000
053100     EXEC SQL                                                     05310000
053200          INCLUDE XLT00003                                        05320000
053300     END-EXEC.                                                    05330000
053400                                                                  05340000
053500******************************************************************05350000
053600*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  05360000
053700******************************************************************05370000
053800     EXEC SQL                                                     05380000
053900          INCLUDE TENTNME                                         05390000
054000     END-EXEC.                                                    05400000
054100******************************************************************05410000
054200*    DB2 DCLGEN WFT_LOD_CNTL                                      05420000
054300******************************************************************05430000
054400     EXEC SQL                                                     05440000
054500          INCLUDE WFT00001                                        05450000
054600     END-EXEC.                                                    05460000
054700                                                                  05470000
054800******************************************************************05480000
054900*    DB2 DCLGEN WFT_LOD_XFER                                      05490000
055000******************************************************************05500000
055100     EXEC SQL                                                     05510000
055200          INCLUDE WFT00002                                        05520000
055300     END-EXEC.                                                    05530000
055400                                                                  05540000
055500******************************************************************05550000
055600*    DB2 DCLGEN TPOPRPK                                           05560000
055700******************************************************************05570000
055800     EXEC SQL                                                     05580000
055900          INCLUDE TPOPRPK                                         05590000
056000     END-EXEC.                                                    05600000
056100                                                                  05610000
056200******************************************************************05620000
056300*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PURCHASE ORDER ITEMS  05630000
056400******************************************************************05640000
056500     EXEC SQL                                                     05650000
056600          DECLARE PURITM-CURSOR CURSOR FOR                        05660000
056700           SELECT A.PO_NBR,                                       05670000
056800                  A.VER_NBR,                                      05680000
056900                  A.PO_LNE_NBR,                                   05690000
057000                  A.SKU_SEQ_NBR,                                  05700000
057100                  A.VEND_STYL_NAME,                               05710000
057200                  B.CSTM_CLOR_DESC,                               05720000
057300                  A.SIZE_DESC,                                    05730000
057400                  A.UNT_QTY,                                      05740000
057500                  A.UNT_COST_AMT,                                 05750000
057600                  A.SKU_DESC,                                     05760000
057700                  A.APP_PO_LNE_NBR,                               05770000
057800                  A.STATUS_CDE,                                   05780000
057900                  A.ITM_NBR,                                      05790007
058000*CLP 06/25/14 - START                                             05800007
058100                  A.PO_PREPK_ID                                   05810007
058200*CLP 06/25/14 - END                                               05820007
058300             FROM TPURITM  A                                      05830000
058400                 ,XLT_SKU  B                                      05840000
058500            WHERE A.PO_NBR         = :DK-PO-NBR                   05850000
058600              AND A.VER_STATUS_CDE = :PC-ACTIVE                   05860000
058700              AND A.STATUS_CDE IN (:PC-STAT-1 ,                   05870000
058800                                 :PC-STAT-2 ,                     05880000
058900                                 :PC-STAT-3 ,                     05890000
059000                                 :PC-STAT-4 ,                     05900000
059100                                 :PC-STAT-5 ,                     05910000
059200                                 :PC-STAT-6 )                     05920000
059300              AND A.ITM_NBR = B.ITM_NBR                           05930000
059400         ORDER BY PO_LNE_NBR                                      05940000
059500     END-EXEC.                                                    05950000
059600                                                                  05960000
059700     COPY DPWS276.                                                05970000
059800                                                                  05980000
059900 LINKAGE SECTION.                                                 05990000
060000                                                                  06000000
060100 01  DFHCOMMAREA.                                                 06010000
060200     05  FILLER                       OCCURS 1 TO 4072 TIMES      06020000
060300                                      DEPENDING ON EIBCALEN.      06030000
060400         10  FILLER                   PIC X.                      06040000
060500                                                                  06050000
060600                                                                  06060000
060700 PROCEDURE DIVISION.                                              06070000
060800                                                                  06080000
060900 0000-MAIN-MODULE.                                                06090000
061000                                                                  06100000
061100     INITIALIZE DP030-CICS-API-FIELDS.                            06110000
061200                                                                  06120000
061300     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         06130000
061400     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            06140000
061500     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           06150000
061600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         06160000
061700     MOVE LENGTH OF RC216AI      TO DP030-MAP-LENGTH (1).         06170000
061800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       06180000
061900     SET DP030-OVERRIDE-APPL-ERROR                                06190000
062000                                 TO TRUE.                         06200000
062100                                                                  06210000
062200     PERFORM 0001-CALL-CICS-ARCH-API.                             06220000
062300                                                                  06230000
062400     PERFORM 1000-CONTROL-PROCESSING.                             06240000
062500                                                                  06250000
062600     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       06260000
062700                                                                  06270000
062800     PERFORM 0001-CALL-CICS-ARCH-API.                             06280000
062900                                                                  06290000
063000 0001-CALL-CICS-ARCH-API.                                         06300000
063100                                                                  06310000
063110     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06311012
063300                                    DFHCOMMAREA                   06330012
063400                                    DP030-CICS-API-FIELDS         06340012
063500                                    DP020-STANDARD-COMMAREA       06350012
063600                                    RC216AI.                      06360012
063700                                                                  06370000
063800     IF DP030-RC-CALL-SUCCESSFUL OR                               06380000
063900        DP030-RC-APPL-ERROR                                       06390000
064000         CONTINUE                                                 06400000
064100     ELSE                                                         06410000
064200         SET DP013-CICS-ABEND                                     06420000
064300             DP013-NO-ROLLBACK                                    06430000
064400             DP013-XCTL-DISPLAY-RESTART                           06440000
064500                                 TO TRUE                          06450000
064600         MOVE '0001-CALL-CICS-ARCH-API'                           06460000
064700                                 TO DP013-PARAGRAPH               06470000
064710         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O06471012
064720-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06472012
065000         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        06500000
065100                                                                  06510000
065200         PERFORM DP013-0000-PROCESS-ABEND.                        06520000
065300                                                                  06530000
065400 1000-CONTROL-PROCESSING.                                         06540000
065500                                                                  06550000
065600     EVALUATE TRUE                                                06560000
065700                                                                  06570000
065800         WHEN DP030-RC-APPL-ERROR                                 06580000
065900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06590000
066000                                 TO PV-TOP-ITEM                   06600000
066100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06610000
066200                                                                  06620000
066300              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06630000
066400                                                                  06640000
066500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06650000
066600                                                                  06660000
066700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06670000
066800                                                                  06680000
066900                                                                  06690000
067000         WHEN DP020-NEXT-ACT-INITIAL                              06700000
067100              INITIALIZE ASC-SPECIFIC-COMMAREA                    06710000
067200              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              06720000
067300                                    ASC-SEL-TERM-ID               06730000
067400              MOVE DP020-SRC-TASK-NUMBER                          06740000
067500                                 TO ASC-LIST-TASK-NUMBER          06750000
067600                                    ASC-SEL-TASK-NUMBER           06760000
067700              MOVE PC-LIST-QUEUE-SEQ                              06770000
067800                                 TO ASC-LIST-SEQ                  06780000
067900              MOVE PC-SEL-QUEUE-SEQ                               06790000
068000                                 TO ASC-SEL-SEQ                   06800000
068100              SET PS-NO-ERROR    TO TRUE                          06810000
068200                                                                  06820000
068300              PERFORM 1100-PROCESS-INTER-APPL-COMM                06830000
068400                                                                  06840000
068500              IF PS-NO-ERROR                                      06850000
068600                  MOVE INTER-APPL-COMM-AREA                       06860000
068700                                 TO ASC-HOLD-INTER-APPL           06870000
068800                  PERFORM 4000-BUILD-INITIAL-PANEL                06880000
068900              END-IF                                              06890000
069000                                                                  06900000
069100                                                                  06910000
069200         WHEN DP020-NEXT-ACT-READ-MAP                             06920000
069300              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06930000
069400                                 TO PV-TOP-ITEM                   06940000
069500                                                                  06950000
069600              PERFORM 2000-PROCESS-PANEL                          06960000
069700                                                                  06970000
069800                                                                  06980000
069900         WHEN DP020-NEXT-ACT-RETURN                               06990000
070000              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07000000
070100                                 TO PV-TOP-ITEM                   07010000
070200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      07020000
070300              MOVE ASC-HOLD-INTER-APPL                            07030000
070400                                 TO INTER-APPL-COMM-AREA          07040000
070500                                                                  07050000
070600              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                07060000
070700                                                                  07070000
070800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07080000
070900                                                                  07090000
071000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07100000
071100                                                                  07110000
071200                                                                  07120000
071300         WHEN OTHER                                               07130000
071400              SET DP013-LOGIC-ABEND                               07140000
071500                  DP013-NO-ROLLBACK                               07150000
071600                                 TO TRUE                          07160000
071700              MOVE '1000-CONTROL-PROCESSING'                      07170000
071800                                 TO DP013-PARAGRAPH               07180000
071900              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   07190000
072000                                 TO DP013-MESSAGE-TEXT(1)         07200000
072100                                                                  07210000
072200              PERFORM DP013-0000-PROCESS-ABEND                    07220000
072300                                                                  07230000
072400     END-EVALUATE.                                                07240000
072500                                                                  07250000
072600 1100-PROCESS-INTER-APPL-COMM.                                    07260000
072700                                                                  07270000
072800     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       07280000
072900     MOVE RC015-PO-NBR           TO ASC-KEY-PO-NBR-N.             07290000
073000     MOVE RC015-PKSL-NBR         TO ASC-KEY-PKSL-NBR.             07300000
073100     MOVE RC015-SEQ-NBR          TO ASC-KEY-SEQ-NBR.              07310000
073200     MOVE RC015-OPER-UNT-ID      TO ASC-KEY-OPER-UNT-ID.          07320000
073300     MOVE RC015-FCLTY-ID         TO ASC-KEY-FCLTY-ID.             07330000
073400     MOVE RC015-STR-NBR          TO ASC-KEY-STR-NBR.              07340000
073500     MOVE RC015-REC-SEQ-NBR      TO ASC-KEY-REC-SEQ-NBR.          07350000
073600                                                                  07360000
073700 2000-PROCESS-PANEL.                                              07370000
073800                                                                  07380000
073900     EVALUATE TRUE                                                07390000
074000                                                                  07400000
074100         WHEN DP020-SRC-AID = DP016-CLEAR                         07410000
074200              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      07420000
074300                                                                  07430000
074400              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07440000
074500                                                                  07450000
074600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07460000
074700                                                                  07470000
074800                                                                  07480000
074900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07490000
075000                                                                  07500000
075100              PERFORM 2050-DELETE-LIST-QUEUE                      07510000
075200                                                                  07520000
075300              PERFORM 4000-BUILD-INITIAL-PANEL                    07530000
075400                                                                  07540000
075500                                                                  07550000
075600         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   07560000
075700                                                                  07570000
075800              PERFORM 2140-DESELECT-ALL-ITEMS                     07580000
075900                                                                  07590000
076000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07600000
076100                                                                  07610000
076200                                                                  07620000
076300         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 07630000
076400                                                                  07640000
076500              PERFORM 2150-SELECT-ALL-ITEMS                       07650000
076600                                                                  07660000
076700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07670000
076800                                                                  07680000
076900                                                                  07690000
077000         WHEN OTHER                                               07700000
077100                                                                  07710000
077200              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                07720000
077300                                                                  07730000
077400              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07740000
077500                                                                  07750000
077600              IF PS-NO-ERROR                                      07760000
077700                  SET DP030-CONTINUE-GO                           07770000
077800                                 TO TRUE                          07780000
077900                                                                  07790000
078000                  PERFORM 2100-CHECK-FUNCTION-KEY                 07800000
078100                                                                  07810000
078200              ELSE                                                07820000
078300                  SET DP030-OVERRIDE-GO                           07830000
078400                                 TO TRUE                          07840000
078500              END-IF                                              07850000
078600                                                                  07860000
078700     END-EVALUATE.                                                07870000
078800                                                                  07880000
078900 2050-DELETE-LIST-QUEUE.                                          07890000
079000                                                                  07900000
079100     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             07910000
079200                          RESP  (PV-CICS-RESP)                    07920000
079300                          END-EXEC.                               07930000
079400                                                                  07940000
079500     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      07950000
079600        (PV-CICS-RESP = DFHRESP (QIDERR))                         07960000
079700         CONTINUE                                                 07970000
079800     ELSE                                                         07980000
079900         SET DP013-CICS-ABEND                                     07990000
080000             DP013-NO-ROLLBACK   TO TRUE                          08000000
080100         MOVE '2050-DELETE-LIST-QUEUE'                            08010000
080200                                 TO DP013-PARAGRAPH               08020000
080300         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 08030000
080400                                 TO DP013-MESSAGE-TEXT (1)        08040000
080500                                                                  08050000
080600         PERFORM DP013-0000-PROCESS-ABEND                         08060000
080700     END-IF.                                                      08070000
080800                                                                  08080000
080900     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    08090000
081000                                                                  08100000
081100 2100-CHECK-FUNCTION-KEY.                                         08110000
081200                                                                  08120000
081300     EVALUATE TRUE                                                08130000
081400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 08140000
081500              IF (DP020-FK-MNEMONIC (DP020-SRC-AID)               08150000
081600                                  = PC-PO-ALLOCATION              08160000
081700                AND ASC-NUMBER-OF-SELECTED-ITEMS = ZERO)          08170000
081800                  SET ASC-NO-TSQ-UPDATE                           08180000
081900                                 TO TRUE                          08190000
082000                  SET DP030-OVERRIDE-GO                           08200000
082100                      DP020-MSG-WARNING                           08210000
082200                                 TO TRUE                          08220000
082300                  MOVE PC-TSYMSG-00057                            08230000
082400                                 TO DP020-MSG-NUMBER              08240000
082500              ELSE                                                08250000
082600                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               08260000
082700                                 TO RC015-NUMBER-OF-SELECTED-ITEMS08270000
082800                  MOVE ASC-KEY-PO-NBR-N                           08280000
082900                                 TO RC015-PO-NBR                  08290000
083000                  PERFORM 5000-PREPARE-SEL-QUEUE                  08300000
083100                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          08310000
083200                      SET ASC-NO-TSQ-UPDATE                       08320000
083300                                 TO TRUE                          08330000
083400                  END-IF                                          08340000
083500              END-IF                                              08350000
083600                                                                  08360000
083700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08370000
083800              IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              08380000
083900                  INITIALIZE RC015-INTER-APPL-COMMAREA            08390000
084000                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               08400000
084100                                 TO RC015-NUMBER-OF-SELECTED-ITEMS08410000
084200                  MOVE ASC-KEY-PO-NBR-N                           08420000
084300                                 TO RC015-PO-NBR                  08430000
084400                  MOVE ASC-KEY-PKSL-NBR                           08440000
084500                                 TO RC015-PKSL-NBR                08450000
084600                  PERFORM 5000-PREPARE-SEL-QUEUE                  08460000
084700              ELSE                                                08470000
084800                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          08480000
084900                      SET ASC-NO-TSQ-UPDATE                       08490000
085000                                 TO TRUE                          08500000
085100                      SET DP030-OVERRIDE-GO                       08510000
085200                          DP020-MSG-WARNING                       08520000
085300                                 TO TRUE                          08530000
085400                      MOVE PC-TSYMSG-00057                        08540000
085500                                 TO DP020-MSG-NUMBER              08550000
085600                  END-IF                                          08560000
085700              END-IF                                              08570000
085800                                                                  08580000
085900         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 08590000
086000             MOVE +1             TO PV-TOP-ITEM                   08600000
086100                                                                  08610000
086200             PERFORM 3200-RESET-ATTRIBUTES                        08620000
086300                                                                  08630000
086400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08640000
086500                                                                  08650000
086600                                                                  08660000
086700         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  08670000
086800                                                                  08680000
086900             PERFORM 2110-BROWSE-BACKWARD                         08690000
087000                                                                  08700000
087100             PERFORM 3200-RESET-ATTRIBUTES                        08710000
087200                                                                  08720000
087300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08730000
087400                                                                  08740000
087500                                                                  08750000
087600         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  08760000
087700                                                                  08770000
087800             PERFORM 2120-BROWSE-FORWARD                          08780000
087900                                                                  08790000
088000             PERFORM 3200-RESET-ATTRIBUTES                        08800000
088100                                                                  08810000
088200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08820000
088300                                                                  08830000
088400                                                                  08840000
088500         WHEN DP020-SRC-AID = DP016-ENTER                         08850000
088600                                                                  08860000
088700             PERFORM 2160-CHECK-FOR-JUMP-BROWSE                   08870000
088800                                                                  08880000
088900             IF PS-NO-ERROR                                       08890000
089000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08900000
089100             END-IF                                               08910000
089200                                                                  08920000
089300                                                                  08930000
089400         WHEN OTHER                                               08940000
089500             SET DP013-CICS-ABEND                                 08950000
089600                 DP013-NO-ROLLBACK                                08960000
089700                 DP013-XCTL-DISPLAY-RESTART                       08970000
089800                                 TO TRUE                          08980000
089900             MOVE '2100-CHECK-FUNCTION-KEY'                       08990000
090000                                 TO DP013-PARAGRAPH               09000000
090100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09010000
090200                                 TO DP013-MESSAGE-TEXT (1)        09020000
090300                                                                  09030000
090400             PERFORM DP013-0000-PROCESS-ABEND                     09040000
090500     END-EVALUATE.                                                09050000
090600                                                                  09060000
090700 2110-BROWSE-BACKWARD.                                            09070000
090800                                                                  09080000
090900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    09090000
091000         GIVING PV-TOP-ITEM.                                      09100000
091100                                                                  09110000
091200     IF PV-TOP-ITEM NOT > +1                                      09120000
091300         MOVE +1                 TO PV-TOP-ITEM                   09130000
091400         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              09140000
091500         SET DP020-MSG-INFORMATIONAL                              09150000
091600                                 TO TRUE.                         09160000
091700                                                                  09170000
091800 2120-BROWSE-FORWARD.                                             09180000
091900                                                                  09190000
092000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              09200000
092100         GIVING PV-TOP-ITEM.                                      09210000
092200                                                                  09220000
092300     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    09230000
092400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            09240000
092500                                 TO PV-TOP-ITEM                   09250000
092600         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              09260000
092700         SET DP020-MSG-INFORMATIONAL                              09270000
092800                                 TO TRUE                          09280000
092900     ELSE                                                         09290000
093000         COMPUTE PV-BOTTOM-ITEM =                                 09300000
093100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 09310000
093200         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             09320000
093300             MOVE PC-TSYMSG-00070                                 09330000
093400                                 TO DP020-MSG-NUMBER              09340000
093500             SET DP020-MSG-INFORMATIONAL                          09350000
093600                                 TO TRUE.                         09360000
093700                                                                  09370000
093800 2160-CHECK-FOR-JUMP-BROWSE.                                      09380000
093900                                                                  09390000
094000     SET PS-NO-ERROR             TO TRUE.                         09400000
094100                                                                  09410000
094200     IF ASC-KEY-SEARCH-LINE > ZERO                                09420000
094300         PERFORM 2300-CHECK-FOR-SEARCH-LINE                       09430000
094400     END-IF.                                                      09440000
094500                                                                  09450000
094600     IF ASC-START-ITEM-REQUEST = SPACE                            09460000
094700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            09470000
094800                                 TO PV-TOP-ITEM                   09480000
094900     ELSE                                                         09490000
095000         MOVE ASC-START-ITEM-REQUEST                              09500000
095100                                 TO DP010I-UNEDITED-FIELD         09510000
095200         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         09520000
095300         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       09530000
095400         SET DP010I-NEGATIVE-NOT-ALLOWED                          09540000
095500                                 TO TRUE                          09550000
095600                                                                  09560000
095710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09571011
095720              USING DP010I-NUMERIC-EDIT-AREA                      09572011
095800                                                                  09580000
095900         IF NOT DP010I-ERROR-DETECTED                             09590000
096000             MOVE DP010I-NUMERIC-FIELD                            09600000
096100                                 TO ASC-START-ITEM-REQUEST-N      09610000
096200             IF ASC-START-ITEM-REQUEST-N > ZERO                   09620000
096300                IF ASC-START-ITEM-REQUEST-N >                     09630000
096400                                          ASC-NUMBER-OF-ITEMS-READ09640000
096500                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        09650000
096600                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ09660000
096700                                          - PC-ITEMS-PER-PANEL + 109670000
096800                    IF PV-TOP-ITEM < +1                           09680000
096900                        MOVE +1  TO PV-TOP-ITEM                   09690000
097000                        MOVE PC-TSYMSG-00070                      09700000
097100                                 TO DP020-MSG-NUMBER              09710000
097200                        SET DP020-MSG-INFORMATIONAL               09720000
097300                                 TO TRUE                          09730000
097400                    END-IF                                        09740000
097500                ELSE                                              09750000
097600                    MOVE ASC-START-ITEM-REQUEST-N                 09760000
097700                                 TO PV-TOP-ITEM                   09770000
097800                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        09780000
097900                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        09790000
098000                                            PC-ITEMS-PER-PANEL - 109800000
098100                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  09810000
098200                         MOVE PC-TSYMSG-00070                     09820000
098300                                 TO DP020-MSG-NUMBER              09830000
098400                         SET DP020-MSG-INFORMATIONAL              09840000
098500                                 TO TRUE                          09850000
098600                    END-IF                                        09860000
098700                END-IF                                            09870000
098800             ELSE                                                 09880000
098900                 MOVE PC-TSYMSG-00101                             09890000
099000                                 TO DP020-MSG-NUMBER              09900000
099100                 SET DP030-SET-CURSOR-APPL-1                      09910000
099200                                 TO TRUE                          09920000
099300                 MOVE -1         TO ASTRTITL                      09930000
099400                 MOVE DP015-UNP-NUM-BRT-MDT                       09940000
099500                                 TO ASTRTITA                      09950000
099600                 MOVE DP015-RED  TO ASTRTITC                      09960000
099700                 MOVE DP015-REVERSE                               09970000
099800                                 TO ASTRTITH                      09980000
099900                 SET PS-ERROR                                     09990000
100000                     DP020-MSG-FATAL                              10000000
100100                                 TO TRUE                          10010000
100200             END-IF                                               10020000
100300         ELSE                                                     10030000
100400             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             10040000
100500             SET DP030-SET-CURSOR-APPL-1                          10050000
100600                                 TO TRUE                          10060000
100700             MOVE -1             TO ASTRTITL                      10070000
100800             MOVE DP015-UNP-NUM-BRT-MDT                           10080000
100900                                 TO ASTRTITA                      10090000
101000             MOVE DP015-RED      TO ASTRTITC                      10100000
101100             MOVE DP015-REVERSE  TO ASTRTITH                      10110000
101200             SET PS-ERROR                                         10120000
101300                 DP020-MSG-FATAL TO TRUE                          10130000
101400         END-IF                                                   10140000
101500     END-IF.                                                      10150000
101600                                                                  10160000
101700 2140-DESELECT-ALL-ITEMS.                                         10170000
101800                                                                  10180000
101900     MOVE +1                     TO ASC-BLK-SUB.                  10190000
102000                                                                  10200000
102100     PERFORM 2141-CLEAR-SELECTED-INDS                             10210000
102200             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    10220000
102300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           10230000
102400                                                                  10240000
102500     ADD +1                      TO ASC-BLK-SUB.                  10250000
102600                                                                  10260000
102700     PERFORM 2141-CLEAR-SELECTED-INDS                             10270000
102800             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    10280000
102900             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           10290000
103000                                                                  10300000
103100     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              10310000
103200                                 TO PV-LIST-ITEM-NUMBER.          10320000
103300                                                                  10330000
103400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10340000
103500             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).10350000
103600                                                                  10360000
103700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10370000
103800              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)10380000
103900         MOVE +1                 TO ASC-BLK-SUB                   10390000
104000                                                                  10400000
104100         PERFORM 5100-WRITE-TEMP-STORAGE                          10410000
104200                                                                  10420000
104300         MOVE +1                 TO PV-BLOCK-NUMBER               10430000
104400                                                                  10440000
104500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10450000
104600                                       PV-FIRST-BLOCK-IN-ARRAY - 110460000
104700                                                                  10470000
104800         PERFORM                                                  10480000
104900           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         10490000
105000                                                                  10500000
105100                 PERFORM 4410-READ-TEMP-STORAGE                   10510000
105200                                                                  10520000
105300                 PERFORM 2141-CLEAR-SELECTED-INDS                 10530000
105400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10540000
105500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10550000
105600                                                                  10560000
105700                 PERFORM 5100-WRITE-TEMP-STORAGE                  10570000
105800                                                                  10580000
105900                 ADD +1          TO PV-BLOCK-NUMBER               10590000
106000                                                                  10600000
106100         END-PERFORM                                              10610000
106200                                                                  10620000
106300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         10630000
106400                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY10640000
106500                                                                  10650000
106600         PERFORM                                                  10660000
106700           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         10670000
106800                                         ASC-HIGHEST-BLOCK-WRITTEN10680000
106900                                                                  10690000
107000                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      10700000
107100                                 TO PV-BLOCK-NUMBER               10710000
107200                                                                  10720000
107300                 PERFORM 4410-READ-TEMP-STORAGE                   10730000
107400                                                                  10740000
107500                 PERFORM 2141-CLEAR-SELECTED-INDS                 10750000
107600                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10760000
107700                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10770000
107800                                                                  10780000
107900                 PERFORM 5100-WRITE-TEMP-STORAGE                  10790000
108000                                                                  10800000
108100                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        10810000
108200                                                                  10820000
108300         END-PERFORM                                              10830000
108400                                                                  10840000
108500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             10850000
108600                                 TO PV-BLOCK-NUMBER               10860000
108700                                                                  10870000
108800         PERFORM 4410-READ-TEMP-STORAGE                           10880000
108900                                                                  10890000
109000     END-IF.                                                      10900000
109100                                                                  10910000
109200     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  10920000
109300                                    ASC-START-OF-SELECTED-RANGE   10930000
109400                                    ASC-END-OF-SELECTED-RANGE.    10940000
109500                                                                  10950000
109600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10960000
109700                                                                  10970000
109800 2141-CLEAR-SELECTED-INDS.                                        10980000
109900                                                                  10990000
110000     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO11000000
110100        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           11010000
110200            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          11020000
110300                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     11030000
110400                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  11040000
110500                                 TO TRUE.                         11050000
110600                                                                  11060000
110700 2150-SELECT-ALL-ITEMS.                                           11070000
110800                                                                  11080000
110900     MOVE +1                     TO ASC-BLK-SUB.                  11090000
111000                                                                  11100000
111100     PERFORM 2151-SET-SELECTED-INDS                               11110000
111200             VARYING ASC-ITEM-SUB FROM 1 BY 1                     11120000
111300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           11130000
111400                                                                  11140000
111500     ADD +1                      TO ASC-BLK-SUB.                  11150000
111600                                                                  11160000
111700     PERFORM 2151-SET-SELECTED-INDS                               11170000
111800             VARYING ASC-ITEM-SUB FROM 1 BY 1                     11180000
111900             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           11190000
112000                                                                  11200000
112100     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              11210000
112200                                 TO PV-LIST-ITEM-NUMBER.          11220000
112300                                                                  11230000
112400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11240000
112500             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).11250000
112600                                                                  11260000
112700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11270000
112800              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)11280000
112900         MOVE +1                 TO ASC-BLK-SUB                   11290000
113000                                                                  11300000
113100         PERFORM 5100-WRITE-TEMP-STORAGE                          11310000
113200                                                                  11320000
113300         MOVE +1                 TO PV-BLOCK-NUMBER               11330000
113400                                                                  11340000
113500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11350000
113600                                       PV-FIRST-BLOCK-IN-ARRAY - 111360000
113700                                                                  11370000
113800         PERFORM                                                  11380000
113900           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         11390000
114000                                                                  11400000
114100                 PERFORM 4410-READ-TEMP-STORAGE                   11410000
114200                                                                  11420000
114300                 PERFORM 2151-SET-SELECTED-INDS                   11430000
114400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11440000
114500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11450000
114600                                                                  11460000
114700                 PERFORM 5100-WRITE-TEMP-STORAGE                  11470000
114800                                                                  11480000
114900                 ADD +1          TO PV-BLOCK-NUMBER               11490000
115000                                                                  11500000
115100         END-PERFORM                                              11510000
115200                                                                  11520000
115300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11530000
115400                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY11540000
115500                                                                  11550000
115600         PERFORM                                                  11560000
115700           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         11570000
115800                                         ASC-HIGHEST-BLOCK-WRITTEN11580000
115900                                                                  11590000
116000                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      11600000
116100                                 TO PV-BLOCK-NUMBER               11610000
116200                                                                  11620000
116300                 PERFORM 4410-READ-TEMP-STORAGE                   11630000
116400                                                                  11640000
116500                 PERFORM 2151-SET-SELECTED-INDS                   11650000
116600                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11660000
116700                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11670000
116800                                                                  11680000
116900                 PERFORM 5100-WRITE-TEMP-STORAGE                  11690000
117000                                                                  11700000
117100                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        11710000
117200                                                                  11720000
117300         END-PERFORM                                              11730000
117400                                                                  11740000
117500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11750000
117600                                 TO PV-BLOCK-NUMBER               11760000
117700                                                                  11770000
117800         PERFORM 4410-READ-TEMP-STORAGE                           11780000
117900     END-IF.                                                      11790000
118000                                                                  11800000
118100     COMPUTE ASC-NUMBER-OF-SELECTED-ITEMS =                       11810000
118200             ASC-NUMBER-OF-ITEMS-READ - PV-NUMBER-OF-RV-ITEMS.    11820000
118300                                                                  11830000
118400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11840000
118500                                                                  11850000
118600 2151-SET-SELECTED-INDS.                                          11860000
118700                                                                  11870000
118800     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO11880000
118900        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              11890000
119000           IF ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) NOT = 'RV'    11900000
119100               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          11910000
119200                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     11920000
119300                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               11930000
119400                                    TO TRUE                       11940000
119500           ELSE                                                   11950000
119600               ADD 1 TO PV-NUMBER-OF-RV-ITEMS                     11960000
119700           END-IF                                                 11970000
119800        END-IF                                                    11980000
119900     END-IF.                                                      11990000
120000                                                                  12000000
120100 2200-MOVE-SCREEN-TO-COMMAREA.                                    12010000
120200                                                                  12020000
120300     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               12030000
120400     MOVE +1                     TO PV-SUB.                       12040000
120500                                                                  12050000
120600     PERFORM 3100-SET-SUBSCRIPTS.                                 12060000
120700                                                                  12070000
120800     IF ALINEL > ZERO                                             12080000
120900         MOVE ALINEI             TO ASC-KEY-SEARCH-LINE           12090000
121000     ELSE                                                         12100000
121100         IF ALINEF = DP015-ERASE-EOF                              12110000
121200             MOVE ZERO           TO ASC-KEY-SEARCH-LINE           12120000
121300         END-IF                                                   12130000
121400     END-IF.                                                      12140000
121500                                                                  12150000
121600     IF ASTRTITL > ZERO                                           12160000
121700         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        12170000
121800     ELSE                                                         12180000
121900         IF ASTRTITF = DP015-ERASE-EOF                            12190000
122000             INITIALIZE ASC-START-ITEM-REQUEST                    12200000
122100         END-IF                                                   12210000
122200     END-IF.                                                      12220000
122300                                                                  12230000
122400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          12240000
122500             VARYING PV-SUB  FROM 1 BY 1                          12250000
122600             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                12260000
122700                                                                  12270000
122800 2210-MOVE-LINES-TO-COMMAREA.                                     12280000
122900                                                                  12290000
123000     IF MR-SELECTL (PV-SUB) > ZERO                                12300000
123100         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  12310000
123200                                 TO TRUE                          12320000
123300         MOVE MR-SELECTI (PV-SUB)                                 12330000
123400                                 TO ASC-TEMP-SELECTED-SW          12340000
123500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12350000
123600     ELSE                                                         12360000
123700         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 12370000
123800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 12380000
123900                                 TO TRUE                          12390000
124000             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          12400000
124100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12410000
124200         END-IF                                                   12420000
124300     END-IF.                                                      12430000
124400                                                                  12440000
124500     IF MR-PKSL-ITM-QTY-L (PV-SUB) > ZERO                         12450000
124600         MOVE MR-PKSL-ITM-QTY (PV-SUB)                            12460000
124700                                 TO ASC-PKSL-ITM-QTY              12470000
124800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12480000
124900     ELSE                                                         12490000
125000         IF MR-PKSL-ITM-QTY-A (PV-SUB) = DP015-ERASE-EOF          12500000
125100             MOVE ZEROS          TO ASC-PKSL-ITM-QTY-N            12510000
125200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     12520000
125300         END-IF                                                   12530000
125400     END-IF.                                                      12540000
125500                                                                  12550000
125600     ADD +1                      TO ASC-ITEM-SUB.                 12560000
125700                                                                  12570000
125800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         12580000
125900         ADD  +1                 TO ASC-BLK-SUB                   12590000
126000         MOVE +1                 TO ASC-ITEM-SUB                  12600000
126100     END-IF.                                                      12610000
126200                                                                  12620000
126300******************************************************************12630000
126400* THE USER CAN CHANGE THE SEARCH FOR PO LINE FIELD TO REPOSITION *12640000
126500* THE LIST TO THE NEXT PO LINE THAT IS EQUAL OR GREATER THAN THE *12650000
126600* SEARCH FOR PO LINE ENTERED.                                    *12660000
126700******************************************************************12670000
126800 2300-CHECK-FOR-SEARCH-LINE.                                      12680000
126900                                                                  12690000
127000     MOVE 99999                    TO ASC-START-ITEM-REQUEST-N.   12700000
127100                                                                  12710000
127200     IF ASC-KEY-SEARCH-LINE > ZERO                                12720000
127300         MOVE ASC-KEY-SEARCH-LINE  TO DP010I-UNEDITED-FIELD       12730000
127400         MOVE LENGTH OF ASC-KEY-SEARCH-LINE                       12740000
127500                                   TO DP010I-MAXIMUM-DIGITS       12750000
127600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     12760000
127700         SET DP010I-NEGATIVE-NOT-ALLOWED                          12770000
127800                                   TO TRUE                        12780000
127910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12791011
127920              USING DP010I-NUMERIC-EDIT-AREA                      12792011
128000                                                                  12800000
128100         IF  DP010I-ERROR-DETECTED                                12810000
128200             CONTINUE                                             12820000
128300         ELSE                                                     12830000
128400             MOVE DP010I-NUMERIC-FIELD                            12840000
128500                                   TO ASC-KEY-SEARCH-LINE-N       12850000
128600         END-IF                                                   12860000
128700     ELSE                                                         12870000
128800         MOVE ZERO                 TO ASC-KEY-SEARCH-LINE-N       12880000
128900     END-IF.                                                      12890000
129000                                                                  12900000
129100     PERFORM 2400-SEARCH-LISTQ-CNTL                               12910000
129200         VARYING PV-ITEM                                          12920000
129300         FROM 1 BY 1                                              12930000
129400         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                12940000
129500         OR ASC-KEY-SEARCH-LINE < LQW-PKSL-LNE-NBR (LQW-IDX)      12950000
129600         OR ASC-KEY-SEARCH-LINE = LQW-PKSL-LNE-NBR (LQW-IDX).     12960000
129700                                                                  12970000
129800     IF PS-INVALID-SEARCH-LINE                                    12980000
129900         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER            12990000
130000         MOVE -1                   TO ALINEL                      13000000
130100         SET DP030-SET-CURSOR-APPL-1                              13010000
130200                                   TO TRUE                        13020000
130300         MOVE DP015-REVERSE        TO ALINEH                      13030000
130400         MOVE DP015-YELLOW         TO ALINEC                      13040000
130500         MOVE DP015-UNP-ALP-BRT-MDT                               13050000
130600                                   TO ALINEA                      13060000
130700         SET DP020-MSG-WARNING     TO TRUE                        13070000
130800         SET PS-ERROR              TO TRUE                        13080000
130900     END-IF.                                                      13090000
131000                                                                  13100000
131100******************************************************************13110000
131200*   READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED       *13120000
131300*   OBJECTS TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.     *13130000
131400******************************************************************13140000
131500 2400-SEARCH-LISTQ-CNTL.                                          13150000
131600                                                                  13160000
131700     PERFORM 6112-READ-LIST-QUEUE.                                13170000
131800                                                                  13180000
131900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           13190000
132000         PERFORM                                                  13200000
132100             VARYING LQW-IDX                                      13210000
132200             FROM 1 BY 1                                          13220000
132300             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   13230000
132400             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO             13240000
132500                 IF ASC-KEY-SEARCH-LINE =                         13250000
132600                    LQW-PKSL-LNE-NBR (LQW-IDX)  OR                13260000
132700                    ASC-KEY-SEARCH-LINE <                         13270000
132800                    LQW-PKSL-LNE-NBR (LQW-IDX)                    13280000
132900                     SET PS-VALID-SEARCH-LINE                     13290000
133000                                 TO TRUE                          13300000
133100                     MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)          13310000
133200                                 TO ASC-START-ITEM-REQUEST-N      13320000
133300                     SET LQW-IDX TO PC-ITEMS-PER-PANEL            13330000
133400                     ADD ASC-HIGHEST-BLOCK-WRITTEN                13340000
133500                                 TO PV-ITEM                       13350000
133600                 END-IF                                           13360000
133700         END-PERFORM                                              13370000
133800     END-IF.                                                      13380000
133900                                                                  13390000
134000 3000-EDIT-DATA-IN-COMMAREA.                                      13400000
134100                                                                  13410000
134200     SET PS-NO-ERROR             TO TRUE.                         13420000
134300                                                                  13430000
134400     PERFORM 3200-RESET-ATTRIBUTES.                               13440000
134500                                                                  13450000
134600     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       13460000
134700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13470000
134800                                          ASC-ITEMS-DISPLAYED - 1.13480000
134900     PERFORM 3100-SET-SUBSCRIPTS.                                 13490000
135000                                                                  13500000
135100     PERFORM 3300-EDIT-SELECTIONS                                 13510000
135200             VARYING PV-SUB  FROM PV-SUB BY -1                    13520000
135300             UNTIL   PV-SUB < +1.                                 13530000
135400                                                                  13540000
135500     IF PS-NO-ERROR                                               13550000
135600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        13560000
135700     END-IF.                                                      13570000
135800                                                                  13580000
135900     IF PS-NO-ERROR AND                                           13590000
136000        ASC-START-OF-SELECTED-RANGE > ZERO AND                    13600000
136100        ASC-END-OF-SELECTED-RANGE > ZERO                          13610000
136200                                                                  13620000
136300         PERFORM 3500-MARK-RANGE-AS-SELECTED                      13630000
136400     END-IF.                                                      13640000
136500                                                                  13650000
136600                                                                  13660000
136700 3100-SET-SUBSCRIPTS.                                             13670000
136800                                                                  13680000
136900     COMPUTE ASC-ITEM-SUB =                                       13690000
137000                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.13700000
137100                                                                  13710000
137200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13720000
137300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13730000
137400         MOVE PC-MAX-BLOCKS-IN-ARRAY                              13740000
137500                                 TO ASC-BLK-SUB                   13750000
137600     ELSE                                                         13760000
137700         MOVE +1                 TO ASC-BLK-SUB                   13770000
137800     END-IF.                                                      13780000
137900                                                                  13790000
138000 3200-RESET-ATTRIBUTES.                                           13800000
138100                                                                  13810000
138200     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA                      13820000
138300                                    ALINEA.                       13830000
138400     MOVE DP015-GREEN            TO ASTRTITC                      13840000
138500                                    ALINEC.                       13850000
138600     MOVE DP015-UNDERLINE        TO ASTRTITH                      13860000
138700                                    ALINEH.                       13870000
138800                                                                  13880000
138900     IF DP020-NEXT-ACT-RETURN OR                                  13890000
139000        DP020-NEXT-ACT-READ-MAP                                   13900000
139100         PERFORM VARYING PV-SUB  FROM 1 BY 1                      13910000
139200                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             13920000
139300                 MOVE DP015-UNP-ALP-NOR-OFF                       13930000
139400                                 TO MR-SELECTA (PV-SUB)           13940000
139500                 MOVE DP015-UNP-NUM-NOR-OFF                       13950000
139600                                 TO MR-PKSL-ITM-QTY-A (PV-SUB)    13960000
139700                 MOVE DP015-GREEN                                 13970000
139800                                 TO MR-SELECTC (PV-SUB)           13980000
139900                                    MR-PKSL-ITM-QTY-C (PV-SUB)    13990000
140000                 MOVE DP015-UNDERLINE                             14000000
140100                                 TO MR-SELECTH (PV-SUB)           14010000
140200                                    MR-PKSL-ITM-QTY-H (PV-SUB)    14020000
140300         END-PERFORM                                              14030000
140400     ELSE                                                         14040000
140500         PERFORM VARYING PV-SUB  FROM 1 BY 1                      14050000
140600                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              14060000
140700                 MOVE DP015-UNP-ALP-NOR-OFF                       14070000
140800                                 TO MR-SELECTA (PV-SUB)           14080000
140900                 MOVE DP015-UNP-NUM-NOR-OFF                       14090000
141000                                 TO MR-PKSL-ITM-QTY-A (PV-SUB)    14100000
141100                 MOVE DP015-GREEN                                 14110000
141200                                 TO MR-SELECTC (PV-SUB)           14120000
141300                                    MR-PKSL-ITM-QTY-C (PV-SUB)    14130000
141400                 MOVE DP015-UNDERLINE                             14140000
141500                                 TO MR-SELECTH (PV-SUB)           14150000
141600                                    MR-PKSL-ITM-QTY-H (PV-SUB)    14160000
141700         END-PERFORM                                              14170000
141800     END-IF.                                                      14180000
141900                                                                  14190000
142000 3300-EDIT-SELECTIONS.                                            14200000
142100                                                                  14210000
142200     EVALUATE TRUE                                                14220000
142300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   14230000
142400                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14240000
142500              CONTINUE                                            14250000
142600                                                                  14260000
142700         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        14270000
142800              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14280000
142900                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  14290000
143000                  MOVE ASC-TEMP-SELECTED-SW                       14300000
143100                                        (ASC-BLK-SUB ASC-ITEM-SUB)14310000
143200                                 TO ASC-SELECTED-SW               14320000
143300                                        (ASC-BLK-SUB ASC-ITEM-SUB)14330000
143400              END-IF                                              14340000
143500                                                                  14350000
143600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   14360000
143700                                                             SPACE14370000
143800              EVALUATE TRUE                                       14380000
143900                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     14390000
144000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14400000
144100                     MOVE SPACE  TO ASC-SELECTED-SW               14410000
144200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14420000
144300                                                                  14430000
144400                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     14440000
144500                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   14450000
144600                       MOVE SPACE                                 14460000
144700                                 TO ASC-SELECTED-SW               14470000
144800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14480000
144900                                                                  14490000
145000                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     14500000
145100                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     14510000
145200                       MOVE SPACE                                 14520000
145300                                 TO ASC-SELECTED-SW               14530000
145400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14540000
145500             END-EVALUATE                                         14550000
145600                                                                  14560000
145700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14570000
145800              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           14580000
145900                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   14590000
146000              END-IF                                              14600000
146100                                                                  14610000
146200              PERFORM 3310-EDIT-RANGE                             14620000
146300                                                                  14630000
146400         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            14640000
146500              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14650000
146600                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   14660000
146700              END-IF                                              14670000
146800                                                                  14680000
146900              PERFORM 3310-EDIT-RANGE                             14690000
147000                                                                  14700000
147100         WHEN OTHER                                               14710000
147200              MOVE PC-TSYMSG-00005                                14720000
147300                                 TO DP020-MSG-NUMBER              14730000
147400              SET PS-ERROR                                        14740000
147500                  DP020-MSG-FATAL                                 14750000
147600                  DP030-SET-CURSOR-APPL-1                         14760000
147700                                 TO TRUE                          14770000
147800              MOVE -1            TO MR-SELECTL (PV-SUB)           14780000
147900              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           14790000
148000              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           14800000
148100              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14810000
148200                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14820000
148300                  MOVE SPACE     TO ASC-SELECTED-SW               14830000
148400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     14840000
148500              END-IF                                              14850000
148600     END-EVALUATE.                                                14860000
148700                                                                  14870000
148800     SET PS-NO-ERROR-IN-QTY TO TRUE.                              14880000
148900     IF ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES      14890000
149000         MOVE ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         14900000
149100                               TO DP010I-UNEDITED-FIELD           14910000
149200         MOVE LENGTH OF ASC-PKSL-ITM-QTY                          14920000
149300                               (ASC-BLK-SUB ASC-ITEM-SUB)         14930000
149400                               TO DP010I-MAXIMUM-DIGITS           14940000
149500         MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS         14950000
149600         SET DP010I-NEGATIVE-NOT-ALLOWED                          14960000
149700                               TO TRUE                            14970000
149810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14981011
149820              USING DP010I-NUMERIC-EDIT-AREA                      14982011
149900                                                                  14990000
150000         IF  DP010I-ERROR-DETECTED                                15000000
150100             SET PS-ERROR                                         15010000
150200                 DP020-MSG-FATAL                                  15020000
150300                 DP030-SET-CURSOR-APPL-1                          15030000
150400                               TO TRUE                            15040000
150500             MOVE PC-TSYMSG-00005                                 15050000
150600                               TO DP020-MSG-NUMBER                15060000
150700             MOVE DP015-UNP-NUM-BRT-OFF                           15070000
150800                               TO MR-PKSL-ITM-QTY-A (PV-SUB)      15080000
150900             MOVE -1           TO MR-PKSL-ITM-QTY-L (PV-SUB)      15090000
151000             MOVE DP015-RED    TO MR-PKSL-ITM-QTY-C (PV-SUB)      15100000
151100             MOVE DP015-REVERSE                                   15110000
151200                               TO MR-PKSL-ITM-QTY-H (PV-SUB)      15120000
151300             SET DP030-SET-CURSOR-APPL-1                          15130000
151400                               TO TRUE                            15140000
151500             IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             15150000
151600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15160000
151700                 SET PS-ERROR-IN-QTY TO TRUE                      15170000
151800             END-IF                                               15180000
151900         ELSE                                                     15190000
152000             MOVE DP010I-NUMERIC-FIELD                            15200000
152100                               TO ASC-PKSL-ITM-QTY-N              15210000
152200                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15220000
152300             MOVE ASC-PKSL-ITM-QTY-N                              15230000
152400                                 (ASC-BLK-SUB ASC-ITEM-SUB)       15240000
152500                               TO MR-PKSL-ITM-QTY-EDITED          15250000
152600                                                    (PV-SUB)      15260000
152700         END-IF                                                   15270000
152800     END-IF.                                                      15280000
152900                                                                  15290000
153000     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) AND                 15300000
153100         PS-NO-ERROR-IN-QTY                                       15310000
153200         IF ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  15320000
153300             MOVE ASC-PKSL-ITM-QTY (ASC-BLK-SUB ASC-ITEM-SUB)     15330000
153400                                   TO DP010I-UNEDITED-FIELD       15340000
153500             MOVE LENGTH OF ASC-PKSL-ITM-QTY                      15350000
153600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     15360000
153700                                   TO DP010I-MAXIMUM-DIGITS       15370000
153800             MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS     15380000
153900             SET DP010I-NEGATIVE-NOT-ALLOWED                      15390000
154000                                   TO TRUE                        15400000
154110             CALL DP010I-NUMERIC-EDIT-ROUTINE                     15411011
154120                  USING DP010I-NUMERIC-EDIT-AREA                  15412011
154200                                                                  15420000
154300             IF  DP010I-ERROR-DETECTED                            15430000
154400                 SET PS-ERROR                                     15440000
154500                     DP020-MSG-FATAL                              15450000
154600                     DP030-SET-CURSOR-APPL-1                      15460000
154700                                   TO TRUE                        15470000
154800                 MOVE PC-TSYMSG-00005                             15480000
154900                                   TO DP020-MSG-NUMBER            15490000
155000                 MOVE DP015-UNP-NUM-BRT-OFF                       15500000
155100                                   TO MR-PKSL-ITM-QTY-A (PV-SUB)  15510000
155200                 MOVE -1           TO MR-PKSL-ITM-QTY-L (PV-SUB)  15520000
155300                 MOVE DP015-RED    TO MR-PKSL-ITM-QTY-C (PV-SUB)  15530000
155400                 MOVE DP015-REVERSE                               15540000
155500                                   TO MR-PKSL-ITM-QTY-H (PV-SUB)  15550000
155600                 SET DP030-SET-CURSOR-APPL-1                      15560000
155700                                   TO TRUE                        15570000
155800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15580000
155900             ELSE                                                 15590000
156000                 MOVE DP010I-NUMERIC-FIELD                        15600000
156100                                   TO ASC-PKSL-ITM-QTY-N          15610000
156200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15620000
156300                 IF ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB) 15630000
156400                                   = ZERO                         15640000
156500                     MOVE ASC-OTR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  15650000
156600                                   TO ASC-PKSL-ITM-QTY-N          15660000
156700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15670000
156800                                      MR-PKSL-ITM-QTY-EDITED      15680000
156900                                                        (PV-SUB)  15690000
157000                     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)         15700000
157100                                   TO TRUE                        15710000
157200                 ELSE                                             15720000
157300                     MOVE ASC-PKSL-ITM-QTY-N                      15730000
157400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15740000
157500                                   TO MR-PKSL-ITM-QTY-EDITED      15750000
157600                                                        (PV-SUB)  15760000
157700                 END-IF                                           15770000
157800             END-IF                                               15780000
157900         ELSE                                                     15790000
158000             MOVE ASC-OTR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          15800000
158100                                   TO ASC-PKSL-ITM-QTY-N          15810000
158200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15820000
158300                                      MR-PKSL-ITM-QTY-EDITED      15830000
158400                                                        (PV-SUB)  15840000
158500         END-IF                                                   15850000
158600     END-IF.                                                      15860000
158700                                                                  15870000
158800     IF ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) = 'RV'              15880000
158900         MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)            15890000
159000                                   MR-PKSL-ITM-QTY-A (PV-SUB)     15900000
159100     END-IF.                                                      15910000
159200                                                                  15920000
159300     SUBTRACT +1 FROM PV-ITEM-IN-USE                              15930000
159400                      ASC-ITEM-SUB.                               15940000
159500                                                                  15950000
159600     IF ASC-ITEM-SUB < 1                                          15960000
159700         SUBTRACT +1 FROM ASC-BLK-SUB                             15970000
159800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  15980000
159900     END-IF.                                                      15990000
160000                                                                  16000000
160100 3310-EDIT-RANGE.                                                 16010000
160200                                                                  16020000
160300     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 16030000
160400        IF ASC-START-OF-SELECTED-RANGE = ZERO                     16040000
160500            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  16050000
160600                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  16060000
160700            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   16070000
160800        ELSE                                                      16080000
160900            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16090000
161000                CONTINUE                                          16100000
161100            ELSE                                                  16110000
161200                MOVE PC-TSYMSG-00054                              16120000
161300                                 TO DP020-MSG-NUMBER              16130000
161400                SET DP020-MSG-FATAL                               16140000
161500                    PS-ERROR                                      16150000
161600                    DP030-SET-CURSOR-APPL-1                       16160000
161700                                 TO TRUE                          16170000
161800                MOVE -1          TO MR-SELECTL (PV-SUB)           16180000
161900                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           16190000
162000                MOVE DP015-UNDERLINE                              16200000
162100                                 TO MR-SELECTH (PV-SUB)           16210000
162200            END-IF                                                16220000
162300        END-IF                                                    16230000
162400     ELSE                                                         16240000
162500         IF ASC-END-OF-SELECTED-RANGE = ZERO                      16250000
162600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16260000
162700                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16270000
162800             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     16280000
162900         ELSE                                                     16290000
163000             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        16300000
163100                 CONTINUE                                         16310000
163200             ELSE                                                 16320000
163300                MOVE PC-TSYMSG-00055                              16330000
163400                                 TO DP020-MSG-NUMBER              16340000
163500                SET DP020-MSG-FATAL                               16350000
163600                    PS-ERROR                                      16360000
163700                    DP030-SET-CURSOR-APPL-1                       16370000
163800                                 TO TRUE                          16380000
163900                MOVE -1          TO MR-SELECTL (PV-SUB)           16390000
164000             END-IF                                               16400000
164100         END-IF                                                   16410000
164200     END-IF.                                                      16420000
164300                                                                  16430000
164400 3400-CHECK-RANGE-SEQUENCE.                                       16440000
164500                                                                  16450000
164600     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    16460000
164700        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    16470000
164800        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   16480000
164900         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              16490000
165000         SET PS-ERROR                                             16500000
165100             DP020-MSG-FATAL     TO TRUE                          16510000
165200                                                                  16520000
165300         PERFORM 3410-POSITION-AT-ERROR                           16530000
165400     END-IF.                                                      16540000
165500                                                                  16550000
165600 3410-POSITION-AT-ERROR.                                          16560000
165700                                                                  16570000
165800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16580000
165900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               16590000
166000                                                  PV-TOP-ITEM + 1.16600000
166100     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       16610000
166200         CONTINUE                                                 16620000
166300     ELSE                                                         16630000
166400         MOVE -1                 TO MR-SELECTL (PV-SUB)           16640000
166500         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           16650000
166600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           16660000
166700     END-IF.                                                      16670000
166800                                                                  16680000
166900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.16690000
167000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       16700000
167100         CONTINUE                                                 16710000
167200     ELSE                                                         16720000
167300         MOVE -1                 TO MR-SELECTL (PV-SUB)           16730000
167400         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           16740000
167500         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           16750000
167600     END-IF.                                                      16760000
167700                                                                  16770000
167800 3500-MARK-RANGE-AS-SELECTED.                                     16780000
167900                                                                  16790000
168000     MOVE +1                     TO ASC-BLK-SUB.                  16800000
168100                                                                  16810000
168200     PERFORM 3510-MARK-SELECTED-INDS                              16820000
168300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    16830000
168400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16840000
168500                                                                  16850000
168600     ADD +1                      TO ASC-BLK-SUB.                  16860000
168700                                                                  16870000
168800     PERFORM 3510-MARK-SELECTED-INDS                              16880000
168900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    16890000
169000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16900000
169100                                                                  16910000
169200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              16920000
169300                                 TO PV-LIST-ITEM-NUMBER.          16930000
169400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        16940000
169500                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).16950000
169600     MOVE ASC-START-OF-SELECTED-RANGE                             16960000
169700                                 TO PV-START-OF-SELECTED-RANGE.   16970000
169800     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        16980000
169900             ((PV-START-OF-SELECTED-RANGE - 1) /                  16990000
170000                                              PC-ITEMS-PER-PANEL).17000000
170100     MOVE ASC-END-OF-SELECTED-RANGE                               17010000
170200                                 TO PV-END-OF-SELECTED-RANGE.     17020000
170300     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         17030000
170400             ((PV-END-OF-SELECTED-RANGE - 1) /                    17040000
170500                                              PC-ITEMS-PER-PANEL).17050000
170600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.17060000
170700                                                                  17070000
170800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17080000
170900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17090000
171000         MOVE +1                 TO ASC-BLK-SUB                   17100000
171100                                                                  17110000
171200         PERFORM 5100-WRITE-TEMP-STORAGE                          17120000
171300                                                                  17130000
171400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17140000
171500                                       PV-FIRST-BLOCK-IN-ARRAY - 117150000
171600                                                                  17160000
171700         PERFORM                                                  17170000
171800           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 17180000
171900                 MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER  17190000
172000                                                                  17200000
172100                 PERFORM 4410-READ-TEMP-STORAGE                   17210000
172200                                                                  17220000
172300                 PERFORM 3510-MARK-SELECTED-INDS                  17230000
172400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17240000
172500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17250000
172600                                                                  17260000
172700                 PERFORM 5100-WRITE-TEMP-STORAGE                  17270000
172800                                                                  17280000
172900                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       17290000
173000         END-PERFORM                                              17300000
173100                                                                  17310000
173200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17320000
173300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY17330000
173400         PERFORM                                                  17340000
173500           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  17350000
173600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      17360000
173700                                 TO PV-BLOCK-NUMBER               17370000
173800                                                                  17380000
173900                 PERFORM 4410-READ-TEMP-STORAGE                   17390000
174000                                                                  17400000
174100                 PERFORM 3510-MARK-SELECTED-INDS                  17410000
174200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17420000
174300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17430000
174400                                                                  17440000
174500                 PERFORM 5100-WRITE-TEMP-STORAGE                  17450000
174600                                                                  17460000
174700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        17470000
174800         END-PERFORM                                              17480000
174900                                                                  17490000
175000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17500000
175100                                 TO PV-BLOCK-NUMBER               17510000
175200                                                                  17520000
175300         PERFORM 4410-READ-TEMP-STORAGE                           17530000
175400                                                                  17540000
175500     END-IF.                                                      17550000
175600                                                                  17560000
175700     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   17570000
175800                                    ASC-END-OF-SELECTED-RANGE.    17580000
175900                                                                  17590000
176000 3510-MARK-SELECTED-INDS.                                         17600000
176100                                                                  17610000
176200     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     17620000
176300                                       ASC-START-OF-SELECTED-RANGE17630000
176400        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  17640000
176500                                         ASC-END-OF-SELECTED-RANGE17650000
176600           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           17660000
176700               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          17670000
176800                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               17680000
176900                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     17690000
177000                                 TO TRUE                          17700000
177100               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  17710000
177200           END-IF                                                 17720000
177300        END-IF                                                    17730000
177400     END-IF.                                                      17740000
177500                                                                  17750000
177600 4000-BUILD-INITIAL-PANEL.                                        17760000
177700                                                                  17770000
177800     INITIALIZE ASC-BLOCK-ENTRIES (1)                             17780000
177900                ASC-BLOCK-ENTRIES (2).                            17790000
178000                                                                  17800000
178100     MOVE +1                     TO ASC-BLK-SUB.                  17810000
178200     SET ASC-MORE-PO-ITEMS       TO TRUE.                         17820000
178300                                                                  17830000
178400     MOVE ZERO                   TO ASC-ITEM-SUB                  17840000
178500                                    ASC-NUMBER-OF-ITEMS-READ      17850000
178600                                    ASC-NUMBER-OF-SELECTED-ITEMS  17860000
178700                                    ASC-HIGHEST-BLOCK-WRITTEN     17870000
178800                                    ASC-START-OF-SELECTED-RANGE   17880000
178900                                    ASC-END-OF-SELECTED-RANGE     17890000
179000                                    ASC-ITEM-AT-TOP-OF-PANEL.     17900000
179100                                                                  17910000
179200     PERFORM 4010-FORMAT-KEYS.                                    17920000
179300                                                                  17930000
179400     PERFORM 4060-CHECK-PO-STATUS.                                17940000
179500                                                                  17950000
179600     IF PS-NO-ERROR                                               17960000
179700         PERFORM 4020-GET-VENDOR-NAME                             17970000
179800         PERFORM 4200-CALC-OPEN-TO-REC                            17980000
179900         PERFORM 4030-OPEN-CURSOR                                 17990000
180000         PERFORM 4040-GET-PO-ITEMS                                18000000
180100         PERFORM 4050-CLOSE-CURSOR                                18010000
180200         MOVE +1                 TO PV-TOP-ITEM                   18020000
180300     END-IF                                                       18030000
180400                                                                  18040000
180500     IF PS-NO-ERROR                                               18050000
180600         IF ASC-NUMBER-OF-ITEMS-READ = ZERO                       18060000
180700             SET DP020-MSG-FATAL                                  18070000
180800                 DP020-NEXT-ACT-APPL-ERROR                        18080000
180900                                 TO TRUE                          18090000
181000             MOVE PC-TSYMSG-00050                                 18100000
181100                                 TO DP020-MSG-NUMBER              18110000
181200         ELSE                                                     18120000
181300             MOVE -1             TO MR-SELECTL (1)                18130000
181400             SET DP030-SET-CURSOR-APPL-1                          18140000
181500                                 TO TRUE                          18150000
181600                                                                  18160000
181700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18170000
181800         END-IF                                                   18180000
181900     END-IF.                                                      18190000
182000                                                                  18200000
182100 4010-FORMAT-KEYS.                                                18210000
182200                                                                  18220000
182300     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    18230000
182400     IF ASC-KEY-STR-NBR > ZERO                                    18240000
182500         MOVE ASC-KEY-STR-NBR    TO DK-STR-NBR-B                  18250000
182600                                    DK-STR-NBR-E                  18260000
182700     END-IF.                                                      18270000
182800                                                                  18280000
182900     IF RC015-DISPLAY-Z-OTR = PC-N                                18290000
183000         MOVE PC-AC              TO PC-STAT-1                     18300000
183100                                    PC-STAT-3                     18310000
183200                                    PC-STAT-4                     18320000
183300                                    PC-STAT-5                     18330000
183400         MOVE PC-AP              TO PC-STAT-2                     18340000
183500         MOVE PC-RV              TO PC-STAT-6                     18350000
183600     ELSE                                                         18360000
183700         MOVE PC-AC              TO PC-STAT-1                     18370000
183800         MOVE PC-AP              TO PC-STAT-2                     18380000
183900         MOVE PC-CA              TO PC-STAT-3                     18390004
184000         MOVE PC-CB              TO PC-STAT-4                     18400000
184100         MOVE PC-CM              TO PC-STAT-5                     18410000
184200         MOVE PC-RV              TO PC-STAT-6                     18420000
184300     END-IF.                                                      18430000
184400                                                                  18440000
184500 4020-GET-VENDOR-NAME.                                            18450000
184600                                                                  18460000
184700     PERFORM WITH TEST AFTER                                      18470000
184800         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    18480000
184900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             18490000
185000                 SQLCODE = ZERO OR                                18500000
185100                 SQLCODE = +100                                   18510000
185200                                                                  18520000
185300         EXEC SQL                                                 18530000
185400              SELECT B.ENT_NAME_DESC                              18540000
185500                INTO :ENTNME-ENT-NAME-DESC                        18550000
185600                FROM TPURCHS A,                                   18560000
185700                     TENTNME B                                    18570000
185800               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                18580000
185900                 AND A.PO_NBR         = :DK-PO-NBR                18590000
186000                 AND A.ENT_ID         = B.ENT_ID                  18600000
186100                 AND B.TYPE_CDE       = :PC-01                    18610000
186200         END-EXEC                                                 18620000
186300                                                                  18630000
186400         EVALUATE TRUE                                            18640000
186500             WHEN SQLCODE = ZERO                                  18650000
186600             WHEN SQLCODE = +100                                  18660000
186700             WHEN SQLCODE = -904                                  18670000
186800             WHEN SQLCODE = -913                                  18680000
186900                  CONTINUE                                        18690000
187000                                                                  18700000
187100             WHEN SQLWARN0 NOT = SPACES                           18710000
187200             WHEN SQLCODE  NOT = ZERO                             18720000
187300                  MOVE '4020-GET-VENDOR-NAME'                     18730000
187400                                 TO DP013-PARAGRAPH               18740000
187500                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       18750000
187600                                 TO DP013-MESSAGE-TEXT (1)        18760000
187700                  MOVE SQLCA     TO DP013-SQLCA                   18770000
187800                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      18780000
187900                  SET DP013-DB2-ABEND                             18790000
188000                      DP013-XCTL-DISPLAY-RESTART                  18800000
188100                                 TO TRUE                          18810000
188200                                                                  18820000
188300                  PERFORM DP013-0000-PROCESS-ABEND                18830000
188400         END-EVALUATE                                             18840000
188500     END-PERFORM.                                                 18850000
188600                                                                  18860000
188700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  18870000
188800         MOVE '4020-GET-VENDOR-NAME'                              18880000
188900                                 TO DP013-PARAGRAPH               18890000
189000         MOVE 'MAX RETRIES EXCEEDED ON SELECT VENDOR NAME'        18900000
189100                                 TO DP013-MESSAGE-TEXT (1)        18910000
189200         MOVE SQLCA              TO DP013-SQLCA                   18920000
189300         MOVE 'TENTNME '         TO DP013-DB2-TABLE-NAME (1)      18930000
189400         SET DP013-XCTL-DISPLAY-RESTART                           18940000
189500             DP013-DB2-ABEND     TO TRUE                          18950000
189600                                                                  18960000
189700         PERFORM DP013-0000-PROCESS-ABEND                         18970000
189800     END-IF.                                                      18980000
189900                                                                  18990000
190000     IF SQLCODE = ZERO                                            19000000
190100         MOVE ENTNME-ENT-NAME-DESC                                19010000
190200                                 TO ASC-KEY-VENDOR-NAME           19020000
190300     ELSE                                                         19030000
190400         IF SQLCODE = +100                                        19040000
190500             MOVE 'VENDOR NOT FOUND'                              19050000
190600                                 TO ASC-KEY-VENDOR-NAME           19060000
190700         END-IF                                                   19070000
190800     END-IF.                                                      19080000
190900                                                                  19090000
191000 4030-OPEN-CURSOR.                                                19100000
191100                                                                  19110000
191200     PERFORM WITH TEST AFTER                                      19120000
191300         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    19130000
191400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             19140000
191500                 SQLCODE = ZERO                                   19150000
191600                                                                  19160000
191700         EXEC SQL                                                 19170000
191800              OPEN PURITM-CURSOR                                  19180000
191900         END-EXEC                                                 19190000
192000                                                                  19200000
192100         EVALUATE TRUE                                            19210000
192200             WHEN SQLCODE = ZERO                                  19220000
192300             WHEN SQLCODE = -904                                  19230000
192400             WHEN SQLCODE = -913                                  19240000
192500                  CONTINUE                                        19250000
192600                                                                  19260000
192700             WHEN SQLWARN0 NOT = SPACES                           19270000
192800             WHEN SQLCODE  NOT = ZERO                             19280000
192900                  MOVE '4030-OPEN-CURSOR'                         19290000
193000                                 TO DP013-PARAGRAPH               19300000
193100                  MOVE 'UNSUCCESSFUL PO ITEM CURSOR OPEN'         19310000
193200                                 TO DP013-MESSAGE-TEXT (1)        19320000
193300                  MOVE SQLCA TO DP013-SQLCA                       19330000
193400                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)      19340000
193500                  MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (2)      19350000
193600                  SET DP013-XCTL-DISPLAY-RESTART                  19360000
193700                      DP013-DB2-ABEND                             19370000
193800                                 TO TRUE                          19380000
193900                                                                  19390000
194000                  PERFORM DP013-0000-PROCESS-ABEND                19400000
194100         END-EVALUATE                                             19410000
194200     END-PERFORM.                                                 19420000
194300                                                                  19430000
194400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  19440000
194500         MOVE '4030-OPEN-CURSOR' TO DP013-PARAGRAPH               19450000
194600         MOVE 'MAX RETRIES EXCEEDED ON PURITM CURSOR OPEN'        19460000
194700                                 TO DP013-MESSAGE-TEXT (1)        19470000
194800         MOVE SQLCA              TO DP013-SQLCA                   19480000
194900         MOVE 'TPURITM '         TO DP013-DB2-TABLE-NAME (1)      19490000
195000         MOVE 'TPURCHS '         TO DP013-DB2-TABLE-NAME (2)      19500000
195100         SET DP013-XCTL-DISPLAY-RESTART                           19510000
195200             DP013-DB2-ABEND     TO TRUE                          19520000
195300                                                                  19530000
195400         PERFORM DP013-0000-PROCESS-ABEND                         19540000
195500     END-IF.                                                      19550000
195600                                                                  19560000
195700 4040-GET-PO-ITEMS.                                               19570000
195800                                                                  19580000
195900     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   19590000
196000         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    19600000
196100               ASC-NO-MORE-PO-ITEMS                               19610000
196200                                                                  19620000
196300         PERFORM 4042-FETCH-PO-ITEMS                              19630000
196400*                                                                 19640000
196500*----------------------------------------------------------------*19650000
196600* ADDED THE LOGIC TO CHECK FOR THE DUMMY SKU                     *19660000
196700* IF NOT DUMMY SKU CALL THE LOGISTICS DOMAIN ITEM ACCESS         *19670000
196800*                           MODULE                               *19680000
196900*----------------------------------------------------------------*19690000
197000*                                                                 19700000
197100     INITIALIZE XL001-ITEM-COMMAREA                               19710000
197200     INITIALIZE PV-NIS-SKU-NBR                                    19720000
197300                                                                  19730005
197400*                                                                 19740000
197500     IF (PURITM-SKU-SEQ-NBR NOT = PC-000  AND                     19750000
197600         PURITM-SKU-SEQ-NBR NOT = PC-999) AND                     19760000
197700         ASC-MORE-PO-ITEMS                                        19770000
197800                                                                  19780000
197900         PERFORM 4045-CALL-CICS-API-ARCH                          19790000
198000     ELSE                                                         19800000
198100         IF PURITM-SKU-SEQ-NBR = PC-000                           19810000
198200            MOVE ZEROES          TO PV-NIS-SKU-NBR                19820000
198300         ELSE                                                     19830000
198400            IF PURITM-SKU-SEQ-NBR = PC-999                        19840000
198500               MOVE  99999999    TO PV-NIS-SKU-NBR                19850000
198600            END-IF                                                19860000
198700         END-IF                                                   19870000
198800     END-IF                                                       19880000
198900*                                                                 19890000
199000         IF ASC-MORE-PO-ITEMS                                     19900000
199100             SET PS-PROCESS-PO       TO TRUE                      19910000
199200             MOVE PURITM-APP-PO-LNE-NBR                           19920000
199300                                    TO DP276-SEARCH-NBR           19930000
199400             PERFORM 4210-SEARCH-OTR                              19940000
199500             MOVE DP276-OTR-OUT   TO PV-OPEN-TO-REC               19950000
199600             MOVE DP276-OTR-OUT-X TO PV-OPEN-TO-REC-X             19960000
199700                                                                  19970000
199800             IF RC015-DISPLAY-Z-OTR = PC-N                        19980000
199900                 IF ASC-KEY-STR-NBR > ZEROS                       19990000
200000                     IF DP276-OTR-OUT NOT > ZERO                  20000000
200100                         SET PS-DONT-PROCESS-PO TO TRUE           20010000
200200                     END-IF                                       20020000
200300                 END-IF                                           20030000
200400             END-IF                                               20040000
200500         END-IF                                                   20050000
200600                                                                  20060000
200700*CLP 06/25/14 - START                                             20070006
200800         IF ASC-MORE-PO-ITEMS                                     20080005
200900            AND PS-PROCESS-PO                                     20090005
201000            AND PV-PKGNG-CDE > SPACE                              20100006
201100            PERFORM 4300-CHECK-CA-LINES                           20110007
201200         END-IF                                                   20120006
201300*CLP 06/25/14 - END                                               20130006
201400                                                                  20140007
201500         IF ASC-MORE-PO-ITEMS                                     20150000
201600            AND PS-PROCESS-PO                                     20160000
201700             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 20170000
201800                 ADD +1          TO ASC-ITEM-SUB                  20180000
201900             ELSE                                                 20190000
202000                 ADD +1          TO ASC-BLK-SUB                   20200000
202100                 MOVE +1         TO ASC-ITEM-SUB                  20210000
202200                                                                  20220000
202300                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          20230000
202400                     MOVE +1     TO ASC-BLK-SUB                   20240000
202500                     SET ASC-BLOCK-MODIFIED (1)                   20250000
202600                                 TO TRUE                          20260000
202700                                                                  20270000
202800                     PERFORM 5100-WRITE-TEMP-STORAGE              20280000
202900                                                                  20290000
203000                     MOVE ASC-BLOCK-ENTRIES                       20300000
203100                                          (PC-MAX-BLOCKS-IN-ARRAY)20310000
203200                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)20320000
203300                     ADD +1      TO ASC-BLK-SUB                   20330000
203400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20340000
203500                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     20350000
203600                                 TO TRUE                          20360000
203700                 END-IF                                           20370000
203800             END-IF                                               20380000
203900             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      20390000
204000             MOVE ASC-NUMBER-OF-ITEMS-READ                        20400000
204100                                 TO ASC-LIST-ITEM-NUMBER          20410000
204200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20420000
204300             MOVE PURITM-APP-PO-LNE-NBR                           20430000
204400                                 TO ASC-PKSL-LNE-NBR-N            20440000
204500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20450000
204600             MOVE PV-NIS-SKU-NBR  TO                              20460000
204700                  ASC-SKU-SEQ-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)     20470000
204800             MOVE PURITM-VEND-STYL-NAME                           20480000
204900                                 TO ASC-VEND-STYL-NAME            20490000
205000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20500000
205100             MOVE XLT00003-CSTM-CLOR-DESC                         20510000
205200                                 TO ASC-COLOR-DESC                20520000
205300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20530000
205400             INSPECT ASC-COLOR-DESC (ASC-BLK-SUB ASC-ITEM-SUB)    20540000
205500                 REPLACING ALL LOW-VALUES BY SPACES               20550000
205600                                                                  20560000
205700             MOVE PV-OPEN-TO-REC TO ASC-OTR-QTY                   20570000
205800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20580000
205900             MOVE PV-OPEN-TO-REC-X TO ASC-OPEN-TO-REC             20590000
206000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20600000
206100             MOVE PURITM-UNT-COST-AMT                             20610000
206200                                 TO ASC-UNT-COST-AMT-N            20620000
206300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20630000
206400             MOVE PURITM-SKU-DESC                                 20640000
206500                                 TO ASC-VEND-DESC                 20650000
206600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20660000
206700             MOVE PURITM-SIZE-DESC                                20670000
206800                                 TO ASC-SIZE-DESC                 20680000
206900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20690000
207000             MOVE XL001-SUB-CL-NBR-2CH                            20700000
207100                                 TO ASC-CL-NBR                    20710000
207200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20720000
207300             MOVE PURITM-VER-NBR TO ASC-PURITM-VER-NBR            20730000
207400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20740000
207500             MOVE PURITM-PO-LNE-NBR                               20750000
207600                                 TO ASC-PO-LNE-NBR-N              20760000
207700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20770000
207800             MOVE PURITM-STATUS-CDE                               20780000
207900                                 TO ASC-STATUS                    20790000
208000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20800000
208100         END-IF                                                   20810000
208200     END-PERFORM.                                                 20820000
208300                                                                  20830000
208400     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           20840000
208500         MOVE +1                 TO ASC-BLK-SUB                   20850000
208600                                                                  20860000
208700         PERFORM 5100-WRITE-TEMP-STORAGE                          20870000
208800                                                                  20880000
208900         ADD +1                  TO ASC-BLK-SUB                   20890000
209000                                                                  20900000
209100         PERFORM 5100-WRITE-TEMP-STORAGE                          20910000
209200                                                                  20920000
209300         MOVE +1                 TO ASC-BLK-SUB                   20930000
209400                                    PV-BLOCK-NUMBER               20940000
209500                                                                  20950000
209600         PERFORM 4410-READ-TEMP-STORAGE                           20960000
209700                                                                  20970000
209800         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         20980000
209900             MOVE +2             TO ASC-BLK-SUB                   20990000
210000                                    PV-BLOCK-NUMBER               21000000
210100                                                                  21010000
210200             PERFORM 4410-READ-TEMP-STORAGE                       21020000
210300         END-IF                                                   21030000
210400     END-IF.                                                      21040000
210500                                                                  21050000
210600 4042-FETCH-PO-ITEMS.                                             21060000
210700                                                                  21070000
210800     EXEC SQL                                                     21080000
210900          FETCH  PURITM-CURSOR                                    21090000
211000           INTO :PURITM-PO-NBR,                                   21100000
211100                :PURITM-VER-NBR,                                  21110000
211200                :PURITM-PO-LNE-NBR,                               21120000
211300                :PURITM-SKU-SEQ-NBR,                              21130000
211400                :PURITM-VEND-STYL-NAME,                           21140000
211500                :XLT00003-CSTM-CLOR-DESC,                         21150000
211600                :PURITM-SIZE-DESC,                                21160000
211700                :PURITM-UNT-QTY,                                  21170000
211800                :PURITM-UNT-COST-AMT,                             21180000
211900                :PURITM-SKU-DESC,                                 21190000
212000                :PURITM-APP-PO-LNE-NBR,                           21200000
212100                :PURITM-STATUS-CDE,                               21210000
212200                :PURITM-ITM-NBR,                                  21220007
212300*CLP 06/25/14 - START                                             21230007
212400                :PURITM-PO-PREPK-ID                               21240007
212500*CLP 06/25/14 - END                                               21250007
212600     END-EXEC.                                                    21260000
212700                                                                  21270000
212800     EVALUATE TRUE                                                21280000
212900         WHEN SQLCODE = ZERO                                      21290000
213000         WHEN SQLCODE = +100                                      21300000
213100              CONTINUE                                            21310000
213200                                                                  21320000
213300         WHEN SQLWARN0 NOT = SPACES                               21330000
213400         WHEN SQLCODE  NOT = ZERO                                 21340000
213500              MOVE '4042-FETCH-PO-ITEMS'                          21350000
213600                                 TO DP013-PARAGRAPH               21360000
213700              MOVE 'UNSUCCESSFUL FETCH OF PO ITEM CURSOR'         21370000
213800                                 TO DP013-MESSAGE-TEXT (1)        21380000
213900              MOVE SQLCA         TO DP013-SQLCA                   21390000
214000              MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)      21400000
214100              SET DP013-DB2-ABEND                                 21410000
214200                  DP013-XCTL-DISPLAY-RESTART                      21420000
214300                                 TO TRUE                          21430000
214400                                                                  21440000
214500              PERFORM DP013-0000-PROCESS-ABEND                    21450000
214600     END-EVALUATE.                                                21460000
214700                                                                  21470000
214800     IF SQLCODE = +100                                            21480000
214900         SET ASC-NO-MORE-PO-ITEMS                                 21490000
215000                                 TO TRUE                          21500000
215100     END-IF.                                                      21510000
215200                                                                  21520000
215300*----------------------------------------------------------------*21530000
215400* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *21540000
215500*----------------------------------------------------------------*21550000
215600*                                                                 21560000
215700 4045-CALL-CICS-API-ARCH.                                         21570000
215800******************************************************            21580000
215900******************************************************            21590000
216000                                                                  21600000
216100        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               21610000
216200                                                                  21620000
216300        SET  XL001-BY-ITEM                                        21630000
216400             XL001-SELECT-SKU                                     21640000
216500             XL001-SELECT-VND-STYL                                21650000
216600                              TO TRUE.                            21660000
216700                                                                  21670000
216800        CALL XL001-VSM-PGM USING  DFHEIBLK                        21680000
216900                                  XL001-COMMAREA                  21690000
217000                                  XL001-ITEM-COMMAREA.            21700000
217100                                                                  21710000
217200        EVALUATE TRUE                                             21720000
217300                                                                  21730000
217400            WHEN XL001-SUCCESSFUL                                 21740000
217500                 MOVE XL001-SKU-NBR   TO PV-NIS-SKU-NBR           21750000
217600                                                                  21760000
217700            WHEN XL001-SKU-SQLCODE = +100                         21770000
217800                 CONTINUE                                         21780000
217900                                                                  21790000
218000            WHEN XL001-INVALID-ACCESS                             21800000
218100                 MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'        21810000
218200                                    TO DP013-PARAGRAPH            21820000
218300                 MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'            21830000
218400                                    TO DP013-MESSAGE-TEXT (1)     21840000
218500                 MOVE SQLCA         TO DP013-SQLCA                21850000
218600                 MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)   21860000
218700                 SET DP013-DB2-ABEND                              21870000
218800                     DP013-XCTL-DISPLAY-RESTART                   21880000
218900                                    TO TRUE                       21890000
219000                                                                  21900000
219100                 PERFORM DP013-0000-PROCESS-ABEND                 21910000
219200            WHEN OTHER                                            21920000
219300                 MOVE '4045-CALL-CICS-API-ARCH'                   21930000
219400                                    TO DP013-PARAGRAPH            21940000
219500                 MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'            21950000
219600                                    TO DP013-MESSAGE-TEXT (1)     21960000
219700                 MOVE XL001-SKU-SQLCODE                           21970000
219800                                    TO SQLCODE                    21980000
219900                 MOVE SQLCA         TO DP013-SQLCA                21990000
220000                 MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)   22000000
220100                 SET DP013-DB2-ABEND                              22010000
220200                     DP013-XCTL-DISPLAY-RESTART                   22020000
220300                                    TO TRUE                       22030000
220400                                                                  22040000
220500                 PERFORM DP013-0000-PROCESS-ABEND                 22050000
220600            END-EVALUATE.                                         22060000
220700                                                                  22070000
220800                                                                  22080000
220900 4050-CLOSE-CURSOR.                                               22090000
221000                                                                  22100000
221100     EXEC SQL                                                     22110000
221200          CLOSE PURITM-CURSOR                                     22120000
221300     END-EXEC.                                                    22130000
221400                                                                  22140000
221500     EVALUATE TRUE                                                22150000
221600         WHEN SQLCODE = ZERO                                      22160000
221700              CONTINUE                                            22170000
221800                                                                  22180000
221900         WHEN SQLWARN0 NOT = SPACES                               22190000
222000         WHEN SQLCODE  NOT = ZERO                                 22200000
222100              MOVE '4050-CLOSE-CURSOR'                            22210000
222200                                 TO DP013-PARAGRAPH               22220000
222300              MOVE 'UNSUCCESSFUL PO ITEM CURSOR CLOSE'            22230000
222400                                 TO DP013-MESSAGE-TEXT (1)        22240000
222500              MOVE SQLCA TO DP013-SQLCA                           22250000
222600              MOVE 'TPURITM '    TO DP013-DB2-TABLE-NAME (1)      22260000
222700              SET DP013-DB2-ABEND                                 22270000
222800                  DP013-XCTL-DISPLAY-RESTART                      22280000
222900                                 TO TRUE                          22290000
223000                                                                  22300000
223100              PERFORM DP013-0000-PROCESS-ABEND                    22310000
223200     END-EVALUATE.                                                22320000
223300                                                                  22330000
223400 4060-CHECK-PO-STATUS.                                            22340000
223500                                                                  22350000
223600                                                                  22360005
223700     PERFORM WITH TEST AFTER                                      22370000
223800         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    22380000
223900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             22390000
224000                 SQLCODE = ZERO OR                                22400000
224100                 SQLCODE = +100                                   22410000
224200                                                                  22420000
224300*CLP 06/25/14 - ADD PACKAGING CODE                                22430006
224400         EXEC SQL                                                 22440000
224500              SELECT STATUS_CDE                                   22450000
224600                    ,PKGNG_CDE                                    22460006
224700                INTO :PV-STATUS-CDE                               22470000
224800                    ,:PV-PKGNG-CDE                                22480006
224900                FROM TPURCHS                                      22490000
225000               WHERE VER_STATUS_CDE = :PC-ACTIVE                  22500000
225100                 AND PO_NBR         = :DK-PO-NBR                  22510000
225200         END-EXEC                                                 22520000
225300                                                                  22530000
225400         EVALUATE TRUE                                            22540000
225500             WHEN SQLCODE = ZERO                                  22550000
225600             WHEN SQLCODE = +100                                  22560000
225700             WHEN SQLCODE = -904                                  22570000
225800             WHEN SQLCODE = -913                                  22580000
225900                  CONTINUE                                        22590000
226000                                                                  22600000
226100             WHEN SQLWARN0 NOT = SPACES                           22610000
226200             WHEN SQLCODE  NOT = ZERO                             22620000
226300                  MOVE '4060-CHECK-PO-STATUS'                     22630000
226400                                 TO DP013-PARAGRAPH               22640000
226500                  MOVE 'UNSUCCESSFUL SELECT OF PO STATUS'         22650000
226600                                 TO DP013-MESSAGE-TEXT (1)        22660000
226700                  MOVE SQLCA     TO DP013-SQLCA                   22670000
226800                  MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)      22680000
226900                  SET DP013-DB2-ABEND                             22690000
227000                      DP013-XCTL-DISPLAY-RESTART                  22700000
227100                                 TO TRUE                          22710000
227200                                                                  22720000
227300                  PERFORM DP013-0000-PROCESS-ABEND                22730000
227400         END-EVALUATE                                             22740000
227500     END-PERFORM.                                                 22750000
227600                                                                  22760000
227700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO  22770000
227800         MOVE '4060-CHECK-PO-STATUS'                              22780000
227900                                 TO DP013-PARAGRAPH               22790000
228000         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO STATUS'          22800000
228100                                 TO DP013-MESSAGE-TEXT (1)        22810000
228200         MOVE SQLCA              TO DP013-SQLCA                   22820000
228300         MOVE 'TPURCHS '         TO DP013-DB2-TABLE-NAME (1)      22830000
228400         SET DP013-XCTL-DISPLAY-RESTART                           22840000
228500             DP013-DB2-ABEND     TO TRUE                          22850000
228600                                                                  22860000
228700         PERFORM DP013-0000-PROCESS-ABEND                         22870000
228800     END-IF.                                                      22880000
228900                                                                  22890000
229000     IF SQLCODE = ZERO                                            22900000
229100         IF PV-VALID-STATUS-CDE                                   22910000
229200             CONTINUE                                             22920000
229300         ELSE                                                     22930000
229400             SET DP020-NEXT-ACT-APPL-ERROR                        22940000
229500                 PS-ERROR                                         22950000
229600                 DP020-MSG-FATAL TO TRUE                          22960000
229700             MOVE PC-TSYMSG-00168                                 22970000
229800                                 TO DP020-MSG-NUMBER              22980000
229900         END-IF                                                   22990000
230000     ELSE                                                         23000000
230100         IF SQLCODE = +100                                        23010000
230200             SET DP020-NEXT-ACT-APPL-ERROR                        23020000
230300                 PS-ERROR                                         23030000
230400                 DP020-MSG-FATAL TO TRUE                          23040000
230500             MOVE PC-TSYMSG-00726                                 23050000
230600                                 TO DP020-MSG-NUMBER              23060000
230700         END-IF                                                   23070000
230800     END-IF.                                                      23080000
230900                                                                  23090000
231000******************************************************************23100000
231100*  COMPUTES THE OPEN TO RECEIVE AMOUNT FOR THE GIVEN STORE.       23110000
231200******************************************************************23120000
231300                                                                  23130000
231400 4200-CALC-OPEN-TO-REC.                                           23140000
231500                                                                  23150000
231600     SET DP276-LINE-LEVEL-OTR                                     23160000
231700         DP276-PO-OTR            TO TRUE                          23170000
231800                                                                  23180000
231900     INITIALIZE DP276-KEYS                                        23190000
232000     MOVE DK-PO-NBR              TO DP276-PO-NBR                  23200000
232100     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              23210000
232200     MOVE ASC-KEY-REC-SEQ-NBR    TO DP276-REC-SEQ-NBR             23220000
232300     MOVE ASC-KEY-OPER-UNT-ID    TO DP276-OPER-UNT-ID             23230000
232400     MOVE ASC-KEY-FCLTY-ID       TO DP276-FCLTY-ID                23240000
232500     MOVE ASC-KEY-STR-NBR        TO DP276-STR-NBR.                23250000
232600     COPY DPPD276.                                                23260000
232700/                                                                 23270000
232800*CLP 06/25/14 - START                                             23280007
232900******************************************************************23290007
233000*  CHECK THE PKGNG CODE, PREPK-ID AND CANCEL STATUS TO DETERMINE  23300007
233100*  IF ROW SHOULD NOT BE DISPLAYED ON SCREEN                       23310007
233200*                                                                 23320007
233300*    IF 'I' OR 'M' PKGNG-CDE THEN BYPASS THIS ROW IF PREPK-ID = 0 23330007
233400*          AND 'CA' STATUS                                        23340007
233500*       OR IF PKGNG NOT 'I' OR 'M' THEN BYPASS IF PREPK-ID > 0    23350007
233600*          AND 'CA' STATUS                                        23360007
233700******************************************************************23370007
233800 4300-CHECK-CA-LINES.                                             23380007
233900                                                                  23390007
234000     IF PV-PKGNG-CDE = PC-I OR PC-M                               23400007
234100         IF PURITM-PO-PREPK-ID = 0                                23410007
234200             IF PURITM-STATUS-CDE = PC-CA                         23420007
234300                SET PS-DONT-PROCESS-PO TO TRUE                    23430007
234400             END-IF                                               23440007
234500         END-IF                                                   23450007
234600     ELSE                                                         23460007
234700         IF PURITM-PO-PREPK-ID > 0                                23470007
234800            AND PURITM-STATUS-CDE = PC-CA                         23480007
234900                SET PS-DONT-PROCESS-PO TO TRUE                    23490007
235000         END-IF                                                   23500007
235100     END-IF.                                                      23510008
235200                                                                  23520007
235300*CLP 06/25/14 - END                                               23530007
235400                                                                  23540007
235500 4400-MOVE-COMMAREA-TO-SCREEN.                                    23550000
235600                                                                  23560000
235700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         23570000
235800           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         23580000
235900           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            23590000
236000             MOVE +1             TO ASC-BLK-SUB                   23600000
236100                                                                  23610000
236200             PERFORM 5100-WRITE-TEMP-STORAGE                      23620000
236300                                                                  23630000
236400             ADD +1              TO ASC-BLK-SUB                   23640000
236500                                                                  23650000
236600             PERFORM 5100-WRITE-TEMP-STORAGE                      23660000
236700                                                                  23670000
236800             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23680000
236900                 GIVING PV-BLOCK-NUMBER                           23690000
237000                 REMAINDER PV-REMAINDER                           23700000
237100             IF PV-REMAINDER > ZERO                               23710000
237200                 ADD +1          TO PV-BLOCK-NUMBER               23720000
237300             END-IF                                               23730000
237400             MOVE +1             TO ASC-BLK-SUB                   23740000
237500                                                                  23750000
237600             PERFORM 4410-READ-TEMP-STORAGE                       23760000
237700                                                                  23770000
237800             ADD +1              TO ASC-BLK-SUB                   23780000
237900                                    PV-BLOCK-NUMBER               23790000
238000                                                                  23800000
238100             PERFORM 4410-READ-TEMP-STORAGE                       23810000
238200                                                                  23820000
238300     END-IF.                                                      23830000
238400                                                                  23840000
238500     MOVE +1                     TO ASC-BLK-SUB.                  23850000
238600     COMPUTE ASC-ITEM-SUB =                                       23860000
238700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23870000
238800                       + PC-ITEMS-PER-PANEL).                     23880000
238900                                                                  23890000
239000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         23900000
239100         ADD +1                  TO ASC-BLK-SUB                   23910000
239200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23920000
239300     END-IF.                                                      23930000
239400                                                                  23940000
239500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23950000
239600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23960000
239700                                                                  23970000
239800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23980000
239900                                                                  23990000
240000     PERFORM 4420-FORMAT-LIST-LINES                               24000000
240100         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            24010000
240200         UNTIL   PV-SUB < +1.                                     24020000
240300                                                                  24030000
240400     COMPUTE ASC-ITEMS-DISPLAYED =                                24040000
240500                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).24050000
240600     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      24060000
240700                                    ASTRTITO.                     24070000
240800     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                24080000
240900                                 TO AENDITO.                      24090000
241000     MOVE ASC-NUMBER-OF-ITEMS-READ                                24100000
241100                                 TO ATOTITO.                      24110000
241200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            24120000
241300                                 TO ASELITO.                      24130000
241400                                                                  24140000
241500     MOVE ASC-KEY-PO-NBR-N       TO APOO.                         24150000
241600     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       24160000
241700     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      24170000
241800     MOVE ASC-KEY-PKSL-NBR       TO APKSLIPO.                     24180000
241900     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       24190000
242000     MOVE ASC-KEY-STR-NBR        TO ASTRO.                        24200000
242100                                                                  24210000
242200     IF DP020-MSG-NUMBER-X = SPACE                                24220000
242300        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    24230000
242400            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              24240000
242500            SET DP020-MSG-INFORMATIONAL                           24250000
242600                                 TO TRUE                          24260000
242700        END-IF                                                    24270000
242800     END-IF.                                                      24280000
242900                                                                  24290000
243000 4410-READ-TEMP-STORAGE.                                          24300000
243100                                                                  24310000
243200     EXEC CICS READQ TS                                           24320000
243300               QUEUE (ASC-LIST-QUEUE-NAME)                        24330000
243400               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            24340000
243500               ITEM  (PV-BLOCK-NUMBER)                            24350000
243600               RESP  (PV-CICS-RESP)                               24360000
243700     END-EXEC.                                                    24370000
243800                                                                  24380000
243900     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     24390000
244000         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      24400000
244100         CONTINUE                                                 24410000
244200     ELSE                                                         24420000
244300         SET DP013-CICS-ABEND                                     24430000
244400             DP013-NO-ROLLBACK   TO TRUE                          24440000
244500         MOVE '4410-READ-TEMP-STORAGE'                            24450000
244600                                 TO DP013-PARAGRAPH               24460000
244700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   24470000
244800                                 TO DP013-MESSAGE-TEXT (1)        24480000
244900                                                                  24490000
245000         PERFORM DP013-0000-PROCESS-ABEND                         24500000
245100     END-IF.                                                      24510000
245200                                                                  24520000
245300     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     24530000
245400                                 TO TRUE.                         24540000
245500                                                                  24550000
245600     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          24560000
245700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24570000
245800     END-IF.                                                      24580000
245900                                                                  24590000
246000 4420-FORMAT-LIST-LINES.                                          24600000
246100                                                                  24610000
246200     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       24620000
246300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24630000
246400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     24640000
246500                                    MR-PKSL-ITM-QTY-A(PV-SUB)     24650000
246600         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     24660000
246700                                    MR-PKSL-ITM-QTY  (PV-SUB)     24670000
246800                                    MR-LINE          (PV-SUB)     24680000
246900                                    MR-VEND-STYL-NAME(PV-SUB)     24690000
247000                                    MR-COLOR-DESC    (PV-SUB)     24700000
247100                                    MR-OTR           (PV-SUB)     24710000
247200                                    MR-UNT-COST-AMT  (PV-SUB)     24720000
247300                                    MR-VEND-DESC     (PV-SUB)     24730000
247400                                    MR-SIZE-DESC     (PV-SUB)     24740000
247500                                    MR-CL-NBR        (PV-SUB)     24750000
247600                                    MR-SKU-SEQ-NBR   (PV-SUB)     24760000
247700                                    MR-STATUS        (PV-SUB)     24770000
247800     ELSE                                                         24780000
247900         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     24790000
248000                                                             SPACE24800000
248100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 24810000
248200                                 TO MR-SELECTI (PV-SUB)           24820000
248300         ELSE                                                     24830000
248400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24840000
248500                                 TO MR-SELECTI (PV-SUB)           24850000
248600         END-IF                                                   24860000
248700                                                                  24870000
248800         IF DP030-SET-CURSOR-TRAILER                              24880000
248900            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  24890000
249000                                                             SPACE24900000
249100               OR PV-SUB = 1                                      24910000
249200                SET DP030-SET-CURSOR-APPL-1                       24920000
249300                                 TO TRUE                          24930000
249400                MOVE -1          TO MR-SELECTL (PV-SUB)           24940000
249500            END-IF                                                24950000
249600         END-IF                                                   24960000
249700                                                                  24970000
249800         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            24980000
249900             MOVE ASC-PKSL-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)   24990000
250000                                 TO MR-PKSL-ITM-QTY-EDITED        25000000
250100                                                       (PV-SUB)   25010000
250200             MOVE ASC-PKSL-LNE-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)   25020000
250300                                 TO MR-LINE            (PV-SUB)   25030000
250400             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB ASC-ITEM-SUB)   25040000
250500                                 TO MR-VEND-STYL-NAME  (PV-SUB)   25050000
250600             MOVE ASC-COLOR-DESC     (ASC-BLK-SUB ASC-ITEM-SUB)   25060000
250700                                 TO MR-COLOR-DESC      (PV-SUB)   25070000
250800             MOVE ASC-OPEN-TO-REC    (ASC-BLK-SUB ASC-ITEM-SUB)   25080000
250900                                 TO MR-OTR             (PV-SUB)   25090000
251000             MOVE ASC-UNT-COST-AMT-N (ASC-BLK-SUB ASC-ITEM-SUB)   25100000
251100                                 TO MR-UNT-COST-AMT-EDITED        25110000
251200                                                       (PV-SUB)   25120000
251300             MOVE ASC-VEND-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   25130000
251400                                 TO MR-VEND-DESC       (PV-SUB)   25140000
251500             MOVE ASC-SIZE-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)   25150000
251600                                 TO MR-SIZE-DESC       (PV-SUB)   25160000
251700             MOVE ASC-CL-NBR         (ASC-BLK-SUB ASC-ITEM-SUB)   25170000
251800                                 TO MR-CL-NBR          (PV-SUB)   25180000
251900             MOVE ASC-SKU-SEQ-NBR    (ASC-BLK-SUB ASC-ITEM-SUB)   25190000
252000                                 TO MR-SKU-SEQ-NBR     (PV-SUB)   25200000
252100             MOVE ASC-STATUS         (ASC-BLK-SUB ASC-ITEM-SUB)   25210000
252200                                 TO MR-STATUS          (PV-SUB)   25220000
252300         END-IF                                                   25230000
252400                                                                  25240000
252500         IF ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) = 'RV'          25250000
252600             MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)        25260000
252700                                     MR-PKSL-ITM-QTY-A (PV-SUB)   25270000
252800         ELSE                                                     25280000
252900             MOVE DP015-UNP-ALP-NOR-OFF                           25290000
253000                                    TO MR-SELECTA (PV-SUB)        25300000
253100             MOVE DP015-UNP-NUM-NOR-OFF                           25310000
253200                                    TO MR-PKSL-ITM-QTY-A (PV-SUB) 25320000
253300             MOVE DP015-GREEN                                     25330000
253400                                    TO MR-SELECTC (PV-SUB)        25340000
253500                                       MR-PKSL-ITM-QTY-C (PV-SUB) 25350000
253600             MOVE DP015-UNDERLINE                                 25360000
253700                                   TO MR-SELECTH (PV-SUB)         25370000
253800                                      MR-PKSL-ITM-QTY-H (PV-SUB)  25380000
253900         END-IF                                                   25390000
254000     END-IF.                                                      25400000
254100                                                                  25410000
254200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               25420000
254300                                                                  25430000
254400     IF ASC-ITEM-SUB < +1                                         25440000
254500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25450000
254600         MOVE +1                 TO ASC-BLK-SUB.                  25460000
254700                                                                  25470000
254800 4430-CHECK-FOR-BEGIN-AND-END.                                    25480000
254900                                                                  25490000
255000     IF ASC-START-OF-SELECTED-RANGE > ZERO                        25500000
255100        IF ASC-END-OF-SELECTED-RANGE = ZERO                       25510000
255200            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              25520000
255300            SET DP020-MSG-WARNING                                 25530000
255400                                 TO TRUE                          25540000
255500                                                                  25550000
255600            PERFORM 4431-POSITION-AT-WARNING                      25560000
255700                                                                  25570000
255800         END-IF                                                   25580000
255900     ELSE                                                         25590000
256000         IF ASC-END-OF-SELECTED-RANGE > ZERO                      25600000
256100             MOVE PC-TSYMSG-00053                                 25610000
256200                                 TO DP020-MSG-NUMBER              25620000
256300             SET DP020-MSG-WARNING                                25630000
256400                                 TO TRUE                          25640000
256500                                                                  25650000
256600             PERFORM 4431-POSITION-AT-WARNING                     25660000
256700                                                                  25670000
256800         END-IF                                                   25680000
256900     END-IF.                                                      25690000
257000                                                                  25700000
257100 4431-POSITION-AT-WARNING.                                        25710000
257200                                                                  25720000
257300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               25730000
257400                                                  PV-TOP-ITEM + 1.25740000
257500     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       25750000
257600         CONTINUE                                                 25760000
257700     ELSE                                                         25770000
257800         SET DP030-SET-CURSOR-APPL-1                              25780000
257900                                 TO TRUE                          25790000
258000         MOVE -1                 TO MR-SELECTL (PV-SUB)           25800000
258100         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           25810000
258200         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           25820000
258300     END-IF.                                                      25830000
258400                                                                  25840000
258500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.25850000
258600                                                                  25860000
258700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       25870000
258800         CONTINUE                                                 25880000
258900     ELSE                                                         25890000
259000         SET DP030-SET-CURSOR-APPL-1                              25900000
259100                                 TO TRUE                          25910000
259200         MOVE -1                 TO MR-SELECTL (PV-SUB)           25920000
259300         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           25930000
259400         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           25940000
259500     END-IF.                                                      25950000
259600                                                                  25960000
259700 5000-PREPARE-SEL-QUEUE.                                          25970000
259800                                                                  25980000
259900     MOVE +1                     TO ASC-BLK-SUB.                  25990000
260000                                                                  26000000
260100     PERFORM 5100-WRITE-TEMP-STORAGE.                             26010000
260200                                                                  26020000
260300     ADD +1                      TO ASC-BLK-SUB.                  26030000
260400                                                                  26040000
260500     PERFORM 5100-WRITE-TEMP-STORAGE.                             26050000
260600                                                                  26060000
260700     MOVE ASC-SEL-QUEUE-NAME     TO RC015-SEL-QUEUE-NAME.         26070000
260800                                                                  26080000
260900     PERFORM 6010-DELETE-SEL-QUEUE.                               26090000
261000                                                                  26100000
261100     SET ASC-UPDATE-TSQ          TO TRUE.                         26110000
261200     SET RC013-IDX               TO 1.                            26120000
261300     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     26130000
261400     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        26140000
261500                                                                  26150000
261600     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    26160000
261700         MOVE ASC-KEY-PO-NBR-N   TO DK-PO-NBR                     26170000
261800         MOVE ASC-KEY-PO-NBR-N   TO PKITEM-PO-NBR                 26180000
261900         MOVE ASC-KEY-SEQ-NBR    TO PKITEM-SEQ-NBR                26190000
262000         PERFORM 5300-SEARCH-FOR-SELECTION                        26200000
262100             VARYING PV-ITEM  FROM 1 BY 1                         26210000
262200             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          26220000
262300             IF PS-ERROR                                          26230000
262400                 MOVE PC-TSYMSG-00117                             26240000
262500                                 TO DP020-MSG-NUMBER              26250000
262600             ELSE                                                 26260000
262700                 MOVE PC-TSYMSG-00034                             26270000
262800                                 TO DP020-MSG-NUMBER              26280000
262900             END-IF                                               26290000
263000     ELSE                                                         26300000
263100         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       26310000
263200             VARYING PV-ITEM  FROM 1 BY 1                         26320000
263300             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          26330000
263400     END-IF.                                                      26340000
263500                                                                  26350000
263600     IF RC013-IDX > 1                                             26360000
263700         PERFORM 5205-WRITE-SEL-QUEUE                             26370000
263800         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      26380000
263900     END-IF.                                                      26390000
264000                                                                  26400000
264100 5100-WRITE-TEMP-STORAGE.                                         26410000
264200                                                                  26420000
264300     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    26430000
264400                                 TO PV-LIST-ITEM-NUMBER.          26440000
264500     COMPUTE PV-BLOCK-NUMBER = 1 +                                26450000
264600                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).26460000
264700                                                                  26470000
264800     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           26480000
264900        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       26490000
265000                                                                  26500000
265100            PERFORM 5105-REWRITE-ASC-LISTQ                        26510000
265200                                                                  26520000
265300        END-IF                                                    26530000
265400     ELSE                                                         26540000
265500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       26550000
265600                                     ASC-HIGHEST-BLOCK-WRITTEN + 126560000
265700         PERFORM 5110-WRITE-ASC-LISTQ                             26570000
265800                                                                  26580000
265900         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     26590000
266000     END-IF.                                                      26600000
266100                                                                  26610000
266200     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     26620000
266300                                 TO TRUE.                         26630000
266400                                                                  26640000
266500 5105-REWRITE-ASC-LISTQ.                                          26650000
266600                                                                  26660000
266700     EXEC CICS WRITEQ TS                                          26670000
266800               QUEUE   (ASC-LIST-QUEUE-NAME)                      26680000
266900               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           26690000
267000               ITEM    (PV-BLOCK-NUMBER)                          26700000
267100               REWRITE                                            26710000
267200               RESP    (PV-CICS-RESP)                             26720000
267300     END-EXEC.                                                    26730000
267400                                                                  26740000
267500     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       26750000
267600         SET DP013-CICS-ABEND                                     26760000
267700             DP013-NO-ROLLBACK   TO TRUE                          26770000
267800         MOVE '5105-REWRITE-ASC-LISTQ'                            26780000
267900                                 TO DP013-PARAGRAPH               26790000
268000         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'26800000
268100                                 TO DP013-MESSAGE-TEXT (1)        26810000
268200         PERFORM DP013-0000-PROCESS-ABEND                         26820000
268300     END-IF.                                                      26830000
268400                                                                  26840000
268500 5110-WRITE-ASC-LISTQ.                                            26850000
268600                                                                  26860000
268700     EXEC CICS WRITEQ TS                                          26870000
268800               QUEUE (ASC-LIST-QUEUE-NAME)                        26880000
268900               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            26890000
269000               ITEM  (PV-BLOCK-NUMBER)                            26900000
269100               RESP  (PV-CICS-RESP)                               26910000
269200     END-EXEC.                                                    26920000
269300                                                                  26930000
269400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26940000
269500         SET DP013-CICS-ABEND                                     26950000
269600             DP013-NO-ROLLBACK   TO TRUE                          26960000
269700         MOVE '5110-WRITE-ASC-LISTQ'                              26970000
269800                                 TO DP013-PARAGRAPH               26980000
269900         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  26990000
270000                                 TO DP013-MESSAGE-TEXT (1)        27000000
270100         PERFORM DP013-0000-PROCESS-ABEND                         27010000
270200     END-IF.                                                      27020000
270300                                                                  27030000
270400 5200-FILL-SEL-QUEUE-RECORD.                                      27040000
270500                                                                  27050000
270600     PERFORM 6112-READ-LIST-QUEUE.                                27060000
270700                                                                  27070000
270800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           27080000
270900         PERFORM                                                  27090000
271000         VARYING LQW-IDX  FROM 1 BY 1                             27100000
271100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  27110000
271200                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27120000
271300                                                                  27130000
271400             IF LQW-SELECT (LQW-IDX)                              27140000
271500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27150000
271600                                 TO RC013-ITEM         (RC013-IDX)27160000
271700                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    27170000
271800                                 TO RC013-PKSL-LNE-NBR-N          27180000
271900                                                       (RC013-IDX)27190000
272000                 MOVE SPACE      TO RC013-ACTION-SW    (RC013-IDX)27200000
272100                 SET RC013-IDX UP BY 1                            27210000
272200                 IF RC013-IDX > RC013-MAX-ITEMS                   27220000
272300                                                                  27230000
272400                     PERFORM 5205-WRITE-SEL-QUEUE                 27240000
272500                                                                  27250000
272600                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      27260000
272700                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         27270000
272800                     SET RC013-IDX                                27280000
272900                                 TO 1                             27290000
273000                 END-IF                                           27300000
273100             END-IF                                               27310000
273200         END-PERFORM                                              27320000
273300     END-IF.                                                      27330000
273400                                                                  27340000
273500 5205-WRITE-SEL-QUEUE.                                            27350000
273600                                                                  27360000
273700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27370000
273800                                 TO RC013-SELECTED-ITEMS.         27380000
273900                                                                  27390000
274000     EXEC CICS WRITEQ TS                                          27400000
274100               QUEUE (ASC-SEL-QUEUE-NAME)                         27410000
274200               FROM  (RC013-DC-SELECT-RECORD)                     27420000
274300               ITEM  (PV-SEL-QUEUE-ITEM)                          27430000
274400               RESP  (PV-CICS-RESP)                               27440000
274500     END-EXEC.                                                    27450000
274600                                                                  27460000
274700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       27470000
274800         SET DP013-CICS-ABEND                                     27480000
274900             DP013-NO-ROLLBACK   TO TRUE                          27490000
275000         MOVE '5205-WRITE-SEL-QUEUE'                              27500000
275100                                 TO DP013-PARAGRAPH               27510000
275200         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   27520000
275300                                 TO DP013-MESSAGE-TEXT (1)        27530000
275400         PERFORM DP013-0000-PROCESS-ABEND                         27540000
275500     END-IF.                                                      27550000
275600                                                                  27560000
275700 5300-SEARCH-FOR-SELECTION.                                       27570000
275800                                                                  27580000
275900     PERFORM 6112-READ-LIST-QUEUE.                                27590000
276000                                                                  27600000
276100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           27610000
276200         PERFORM                                                  27620000
276300         VARYING LQW-IDX  FROM 1 BY 1                             27630000
276400         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  27640000
276500                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27650000
276600                                                                  27660000
276700             IF LQW-SELECT (LQW-IDX)                              27670000
276800                 PERFORM 5400-SELECT-TPKITEM                      27680000
276900                 IF PS-PKITEM-FOUND                               27690000
277000                     SET PS-ERROR                                 27700000
277100                                 TO TRUE                          27710000
277200                 ELSE                                             27720000
277300                     IF LQW-PKSL-ITM-QTY (LQW-IDX) = ZERO AND     27730000
277400                        LQW-OTR-QTY (LQW-IDX) = ZERO              27740000
277500                         CONTINUE                                 27750000
277600                     ELSE                                         27760000
277700                         PERFORM 5500-INSERT-TPKITEM              27770000
277800                         ADD +1      TO RC015-NUMBER-OF-TS-ITEMS  27780000
277900                     END-IF                                       27790000
278000                 END-IF                                           27800000
278100             END-IF                                               27810000
278200         END-PERFORM                                              27820000
278300     END-IF.                                                      27830000
278400                                                                  27840000
278500/                                                                 27850000
278600*----------------------------------------------------------------*27860000
278700*    CHECK IF THE PO LINE NUMBER ALREADY EXISTS ON THE PACK SLIP *27870000
278800*----------------------------------------------------------------*27880000
278900                                                                  27890000
279000 5400-SELECT-TPKITEM.                                             27900000
279100                                                                  27910000
279200     MOVE LQW-PKSL-LNE-NBR  (LQW-IDX)                             27920000
279300                                 TO PKITEM-PKSL-LNE-NBR.          27930000
279400                                                                  27940000
279500     PERFORM                                                      27950000
279600         WITH TEST AFTER                                          27960000
279700         VARYING PV-RETRY-COUNTER                                 27970000
279800         FROM 1 BY 1                                              27980000
279900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27990000
280000             OR (SQLCODE = +0)                                    28000000
280100             OR (SQLCODE = +100))                                 28010000
280200                                                                  28020000
280300         EXEC SQL                                                 28030000
280400              SELECT PO_NBR                                       28040000
280500                INTO :PKITEM-PO-NBR                               28050000
280600                FROM TPKITEM                                      28060000
280700               WHERE PO_NBR       = :PKITEM-PO-NBR                28070000
280800                 AND SEQ_NBR      = :PKITEM-SEQ-NBR               28080000
280900                 AND PKSL_LNE_NBR = :PKITEM-PKSL-LNE-NBR          28090000
281000                 AND VER_STAT_CDE = :PC-ACTIVE                    28100000
281100         END-EXEC                                                 28110000
281200                                                                  28120000
281300         EVALUATE TRUE                                            28130000
281400             WHEN SQLCODE = +0                                    28140000
281500                  SET PS-PKITEM-FOUND                             28150000
281600                                   TO TRUE                        28160000
281700             WHEN SQLCODE = +100                                  28170000
281800                  SET PS-PKITEM-NOT-FOUND                         28180000
281900                                   TO TRUE                        28190000
282000             WHEN SQLCODE = -904                                  28200000
282100             WHEN SQLCODE = -913                                  28210000
282200                  CONTINUE                                        28220000
282300                                                                  28230000
282400             WHEN SQLWARN0 NOT = SPACES                           28240000
282500             WHEN SQLCODE < +0                                    28250000
282600             WHEN SQLCODE > +0                                    28260000
282700                  MOVE '5400-SELECT-TPKITEM'                      28270000
282800                                   TO DP013-PARAGRAPH             28280000
282900                  MOVE 'UNSUCCESSFUL SELECT OF TPKITEM'           28290000
283000                                   TO DP013-MESSAGE-TEXT (1)      28300000
283100                  MOVE SQLCA       TO DP013-SQLCA                 28310000
283200                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    28320000
283300                  SET DP013-DB2-ABEND                             28330000
283400                      DP013-XCTL-DISPLAY-RESTART                  28340000
283500                                   TO TRUE                        28350000
283600                  PERFORM DP013-0000-PROCESS-ABEND                28360000
283700         END-EVALUATE                                             28370000
283800     END-PERFORM.                                                 28380000
283900                                                                  28390000
284000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO 28400000
284100         MOVE '5400-SELECT-TPKITEM'                               28410000
284200                                   TO DP013-PARAGRAPH             28420000
284300         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TPKITEM'        28430000
284400                                   TO DP013-MESSAGE-TEXT (1)      28440000
284500         MOVE SQLCA                TO DP013-SQLCA                 28450000
284600         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    28460000
284700         SET DP013-XCTL-DISPLAY-RESTART                           28470000
284800             DP013-DB2-ABEND       TO TRUE                        28480000
284900         PERFORM DP013-0000-PROCESS-ABEND                         28490000
285000     END-IF.                                                      28500000
285100                                                                  28510000
285200/                                                                 28520000
285300*----------------------------------------------------------------*28530000
285400*    INSERT A PACK SLIP ITEM ROW                                 *28540000
285500*----------------------------------------------------------------*28550000
285600                                                                  28560000
285700 5500-INSERT-TPKITEM.                                             28570000
285800                                                                  28580000
285900     IF LQW-PKSL-ITM-QTY (LQW-IDX) = ZERO                         28590000
286000         MOVE LQW-OTR-QTY (LQW-IDX)                               28600000
286100                                 TO PKITEM-PKSL-ITM-QTY           28610000
286200     ELSE                                                         28620000
286300         MOVE LQW-PKSL-ITM-QTY (LQW-IDX)                          28630000
286400                                 TO PKITEM-PKSL-ITM-QTY           28640000
286500     END-IF.                                                      28650000
286600                                                                  28660000
286700     MOVE LQW-PKSL-LNE-NBR  (LQW-IDX)                             28670000
286800                                 TO PKITEM-PKSL-LNE-NBR.          28680000
286900     MOVE LQW-PURITM-VER-NBR(LQW-IDX)                             28690000
287000                                 TO PKITEM-PURITM-VER-NBR.        28700000
287100                                                                  28710000
287200*TCR  AUTOVE                                                      28720000
287300     SET PS-ORIG-ASN-PKSLIP-NO   TO TRUE.                         28730000
287400     PERFORM 5525-CHECK-ASN.                                      28740000
287500     MOVE 0 TO PV-ORIG-PKSL-ITM-QTY.                              28750000
287600     IF PS-ORIG-ASN-PKSLIP-YES                                    28760000
287700        MOVE PKITEM-PKSL-ITM-QTY TO PV-ORIG-PKSL-ITM-QTY          28770000
287800     END-IF.                                                      28780000
287900*TCR  AUTOVE                                                      28790000
288000                                                                  28800000
288100     PERFORM                                                      28810000
288200         WITH TEST AFTER                                          28820000
288300         VARYING PV-RETRY-COUNTER                                 28830000
288400         FROM 1 BY 1                                              28840000
288500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28850000
288600             OR (SQLCODE = +0))                                   28860000
288700                                                                  28870000
288800         EXEC SQL                                                 28880000
288900              INSERT INTO TPKITEM                                 28890000
289000                     (PO_NBR,                                     28900000
289100                      SEQ_NBR,                                    28910000
289200                      PKSL_LNE_NBR,                               28920000
289300                      CRE_TMST,                                   28930000
289400                      VER_STAT_CDE,                               28940000
289500                      PKSL_ITM_QTY,                               28950000
289600                      CRE_UID,                                    28960000
289700                      PURITM_VER_NBR,                             28970000
289800                      ORIG_PKSL_ITM_QTY)                          28980000
289900              VALUES (:PKITEM-PO-NBR,                             28990000
290000                      :PKITEM-SEQ-NBR,                            29000000
290100                      :PKITEM-PKSL-LNE-NBR,                       29010000
290200                       CURRENT TIMESTAMP,                         29020000
290300                      :PC-ACTIVE,                                 29030000
290400                      :PKITEM-PKSL-ITM-QTY,                       29040000
290500                      :DP020-USERID,                              29050000
290600                      :PKITEM-PURITM-VER-NBR,                     29060000
290700                      :PV-ORIG-PKSL-ITM-QTY)                      29070000
290800         END-EXEC                                                 29080000
290900                                                                  29090000
291000         EVALUATE TRUE                                            29100000
291100             WHEN SQLCODE = +0                                    29110000
291200                PERFORM 5700-CHECK-PREPACK                        29120000
291300                IF PREPACK-PO                                     29130000
291400                   PERFORM 5550-GET-PACK-SKU                      29140000
291500                ELSE                                              29150000
291600                   MOVE 0        TO POPRPK-PK-SKU-NBR             29160000
291700                   PERFORM 5600-INSERT-WFT-LOD-XFER               29170000
291800                   PERFORM 5575-INSERT-WFT-LOD-CNTL               29180000
291900                END-IF                                            29190000
292000             WHEN SQLCODE = -904                                  29200000
292100             WHEN SQLCODE = -913                                  29210000
292200                  CONTINUE                                        29220000
292300                                                                  29230000
292400             WHEN SQLWARN0 NOT = SPACES                           29240000
292500             WHEN SQLCODE < +0                                    29250000
292600             WHEN SQLCODE > +0                                    29260000
292700                  MOVE '5500-INSERT-TPKITEM'                      29270000
292800                                   TO DP013-PARAGRAPH             29280000
292900                  MOVE 'UNSUCCESSFUL INSERT FOR TPKITEM'          29290000
293000                                   TO DP013-MESSAGE-TEXT (1)      29300000
293100                  MOVE SQLCA       TO DP013-SQLCA                 29310000
293200                  MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (1)    29320000
293300                  SET DP013-DB2-ABEND                             29330000
293400                      DP013-XCTL-DISPLAY-RESTART                  29340000
293500                                   TO TRUE                        29350000
293600                  PERFORM DP013-0000-PROCESS-ABEND                29360000
293700         END-EVALUATE                                             29370000
293800     END-PERFORM.                                                 29380000
293900                                                                  29390000
294000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE NOT = ZERO 29400000
294100         MOVE '5500-INSERT-TPKITEM'                               29410000
294200                                   TO DP013-PARAGRAPH             29420000
294300         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TPKITEM'        29430000
294400                                   TO DP013-MESSAGE-TEXT (1)      29440000
294500         MOVE SQLCA                TO DP013-SQLCA                 29450000
294600         MOVE 'TPKITEM '           TO DP013-DB2-TABLE-NAME (1)    29460000
294700         SET DP013-XCTL-DISPLAY-RESTART                           29470000
294800             DP013-DB2-ABEND       TO TRUE                        29480000
294900         PERFORM DP013-0000-PROCESS-ABEND                         29490000
295000     END-IF.                                                      29500000
295100                                                                  29510000
295200******************************************************************29520000
295300**  CHECK TO SEE IF ASN IS ORIGINAL (CRE_UID = RCKUP006)        **29530000
295400******************************************************************29540000
295500 5525-CHECK-ASN.                                                  29550000
295600                                                                  29560000
295700         EXEC SQL                                                 29570000
295800           SELECT COUNT(CRE_UID)                                  29580000
295900           INTO  :PV-COUNTER:PV-NULL-IND                          29590000
296000           FROM   TPKSLIP                                         29600000
296100           WHERE  PO_NBR       = :DK-PO-NBR                       29610000
296200             AND  SEQ_NBR      = :ASC-KEY-SEQ-NBR                 29620000
296300             AND  CRE_UID      = 'RCKUP006'                       29630000
296400         END-EXEC.                                                29640000
296500                                                                  29650000
296600         EVALUATE TRUE                                            29660000
296700             WHEN SQLCODE = ZERO                                  29670000
296800                  IF PV-COUNTER > 0                               29680000
296900                     SET PS-ORIG-ASN-PKSLIP-YES  TO TRUE          29690000
297000                  END-IF                                          29700000
297100             WHEN SQLCODE = +100                                  29710000
297200                  CONTINUE                                        29720000
297300             WHEN SQLCODE = -904                                  29730000
297400             WHEN SQLCODE = -911                                  29740000
297500             WHEN SQLCODE = -913                                  29750000
297600                  CONTINUE                                        29760000
297700                                                                  29770000
297800             WHEN SQLWARN0 NOT = SPACES                           29780000
297900             WHEN SQLCODE  NOT = ZERO                             29790000
298000                  MOVE '5525-CHECK-ASN'                           29800000
298100                                   TO DP013-PARAGRAPH             29810000
298200                  MOVE 'UNSUCCESSFUL SELECT FOR TPKSLIP'          29820000
298300                                   TO DP013-MESSAGE-TEXT (1)      29830000
298400                  MOVE SQLCA       TO DP013-SQLCA                 29840000
298500                  MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)    29850000
298600                  SET DP013-DB2-ABEND                             29860000
298700                      DP013-XCTL-DISPLAY-RESTART                  29870000
298800                                   TO TRUE                        29880000
298900                  PERFORM DP013-0000-PROCESS-ABEND                29890000
299000         END-EVALUATE.                                            29900000
299100                                                                  29910000
299200***************************************************************** 29920000
299300*     CHECK PACK UPC                                              29930000
299400***************************************************************** 29940000
299500 5550-GET-PACK-SKU.                                               29950000
299600                                                                  29960000
299700     MOVE PKITEM-PO-NBR TO PURITM-PO-NBR.                         29970000
299800     MOVE PKITEM-PKSL-LNE-NBR TO PURITM-PO-LNE-NBR.               29980000
299900     EXEC SQL                                                     29990000
300000        SELECT  B.PO_NBR, B.PK_SKU_NBR                            30000000
300100          INTO :POPRPK-PO-NBR,                                    30010000
300200               :POPRPK-PK-SKU-NBR                                 30020000
300300          FROM TPURITM A,                                         30030000
300400               TPOPRPK B                                          30040000
300500          WHERE A.PO_NBR          = :PURITM-PO-NBR       AND      30050000
300600                A.APP_PO_LNE_NBR  = :PURITM-PO-LNE-NBR   AND      30060000
300700                A.PO_NBR      = B.PO_NBR             AND          30070000
300800                A.PO_PREPK_ID = B.PO_PREPK_ID        AND          30080000
300900                A.VER_STATUS_CDE = 'A'                            30090000
301000     END-EXEC.                                                    30100000
301100     EVALUATE TRUE                                                30110000
301200        WHEN SQLCODE = +0                                         30120000
301300           PERFORM 5600-INSERT-WFT-LOD-XFER                       30130000
301400           PERFORM 5575-INSERT-WFT-LOD-CNTL                       30140000
301500        WHEN SQLCODE = +100                                       30150000
301600           MOVE 0 TO SQLCODE                                      30160000
301700        WHEN SQLWARN0 NOT = SPACES                                30170000
301800        WHEN SQLCODE < +0                                         30180000
301900        WHEN SQLCODE > +0                                         30190000
302000             MOVE '5550-GET-PACK-SKU'                             30200000
302100                              TO DP013-PARAGRAPH                  30210000
302200             MOVE 'UNSUCCESSFUL SELECT PACK SKU'                  30220000
302300                              TO DP013-MESSAGE-TEXT (1)           30230000
302400             MOVE SQLCA       TO DP013-SQLCA                      30240000
302500             MOVE 'TPOPRPK '  TO DP013-DB2-TABLE-NAME (1)         30250000
302600             SET DP013-DB2-ABEND                                  30260000
302700                 DP013-XCTL-DISPLAY-RESTART                       30270000
302800                              TO TRUE                             30280000
302900             PERFORM DP013-0000-PROCESS-ABEND                     30290000
303000     END-EVALUATE.                                                30300000
303100 5575-INSERT-WFT-LOD-CNTL.                                        30310000
303200                                                                  30320000
303300                                                                  30330000
303400     EXEC SQL                                                     30340000
303500         INSERT INTO WFT_LOD_CNTL                                 30350000
303600             ( PRC_CNTL_TMST                                      30360000
303700              ,TRN_TYP_CDE                                        30370000
303800              ,STAT_CDE                                           30380000
303900              ,INIT_PRCG_BEG_TMST                                 30390000
304000              ,END_TMST                                           30400000
304100              ,ARCH_DAT_IND                                       30410000
304200              ,DAT_LOD_VER_NBR                                    30420000
304300              ,STR_NBR                                            30430000
304400             )                                                    30440000
304500         VALUES                                                   30450000
304600             (:WFT00002-PRC-CNTL-TMST                             30460000
304700             ,'PSLPCK'                                            30470000
304800             ,'READY'                                             30480000
304900             ,'0001-01-01-00.00.00.000000'                        30490000
305000             ,'0001-01-01-00.00.00.000000'                        30500000
305100             ,'N'                                                 30510000
305200             ,10.01                                               30520000
305300             ,0900                                                30530000
305400             )                                                    30540000
305500     END-EXEC.                                                    30550000
305600                                                                  30560000
305700     EVALUATE TRUE                                                30570000
305800        WHEN SQLCODE = +0                                         30580000
305900        WHEN SQLCODE = +100                                       30590000
306000        WHEN SQLCODE = -904                                       30600000
306100        WHEN SQLCODE = -913                                       30610000
306200             CONTINUE                                             30620000
306300        WHEN SQLWARN0 NOT = SPACES                                30630000
306400        WHEN SQLCODE < +0                                         30640000
306500        WHEN SQLCODE > +0                                         30650000
306600             MOVE '5575-INSERT-WFT-LOD-CNTL'                      30660000
306700                              TO DP013-PARAGRAPH                  30670000
306800             MOVE 'UNSUCCESSFUL INSERT WFT-LOD-CNTL'              30680000
306900                              TO DP013-MESSAGE-TEXT (1)           30690000
307000             MOVE SQLCA       TO DP013-SQLCA                      30700000
307100             MOVE 'WFT_LOD-CNTL'  TO DP013-DB2-TABLE-NAME (1)     30710000
307200             SET DP013-DB2-ABEND                                  30720000
307300                 DP013-XCTL-DISPLAY-RESTART                       30730000
307400                              TO TRUE                             30740000
307500             PERFORM DP013-0000-PROCESS-ABEND                     30750000
307600     END-EVALUATE.                                                30760000
307700 5600-INSERT-WFT-LOD-XFER.                                        30770000
307800                                                                  30780000
307900     INITIALIZE WFT00002-LOD-DAT-TXT.                             30790000
308000                                                                  30800000
308100     EXEC SQL                                                     30810000
308200         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          30820000
308300     END-EXEC.                                                    30830000
308400                                                                  30840000
308500     MOVE POPRPK-PO-NBR TO WS-PUBLISH-PO.                         30850000
308600     MOVE POPRPK-PK-SKU-NBR TO WS-PUBLISH-SKU.                    30860000
308700     MOVE LENGTH OF WS-PUBLISH-MESSAGE TO                         30870000
308800        WFT00002-LOD-DAT-TXT-LEN.                                 30880000
308900                                                                  30890000
309000     MOVE WS-PUBLISH-MESSAGE TO                                   30900000
309100        WFT00002-LOD-DAT-TXT-TEXT.                                30910000
309200                                                                  30920000
309300                                                                  30930000
309400     EXEC SQL                                                     30940000
309500         INSERT INTO WFT_LOD_XFER                                 30950000
309600             ( PRC_CNTL_TMST                                      30960000
309700              ,TRN_TYP_CDE                                        30970000
309800              ,BTCH_LOD_SEQ_ID                                    30980000
309900              ,LOD_DAT_TXT                                        30990000
310000             )                                                    31000000
310100         VALUES                                                   31010000
310200             (:WFT00002-PRC-CNTL-TMST                             31020000
310300             ,'PSLPCK'                                            31030000
310400             ,1                                                   31040000
310500             ,:WFT00002-LOD-DAT-TXT                               31050000
310600             )                                                    31060000
310700     END-EXEC.                                                    31070000
310800                                                                  31080000
310900     EVALUATE TRUE                                                31090000
311000        WHEN SQLCODE = +0                                         31100000
311100        WHEN SQLCODE = +100                                       31110000
311200        WHEN SQLCODE = -904                                       31120000
311300        WHEN SQLCODE = -913                                       31130000
311400             CONTINUE                                             31140000
311500        WHEN SQLWARN0 NOT = SPACES                                31150000
311600        WHEN SQLCODE < +0                                         31160000
311700        WHEN SQLCODE > +0                                         31170000
311800             MOVE '5600-INSERT-WFT-LOD-XFER'                      31180000
311900                              TO DP013-PARAGRAPH                  31190000
312000             MOVE 'UNSUCCESSFUL INSERT WFT-LOD-XFER'              31200000
312100                              TO DP013-MESSAGE-TEXT (1)           31210000
312200             MOVE SQLCA       TO DP013-SQLCA                      31220000
312300             MOVE 'WFT_LOD-XFER'  TO DP013-DB2-TABLE-NAME (1)     31230000
312400             SET DP013-DB2-ABEND                                  31240000
312500                 DP013-XCTL-DISPLAY-RESTART                       31250000
312600                              TO TRUE                             31260000
312700             PERFORM DP013-0000-PROCESS-ABEND                     31270000
312800     END-EVALUATE.                                                31280000
312900/                                                                 31290000
313000***************************************************************** 31300000
313100*     CHECK PREPACK                                               31310000
313200*                                                                 31320000
313300***************************************************************** 31330000
313400 5700-CHECK-PREPACK.                                              31340000
313500     MOVE PKITEM-PO-NBR TO POPRPK-PO-NBR.                         31350000
313600     EXEC SQL                                                     31360000
313700        SELECT A.PO_PREPK_ID                                      31370000
313800          INTO :POPRPK-PO-PREPK-ID                                31380000
313900          FROM TPOPRPK A                                          31390000
314000          WHERE A.PO_NBR = :POPRPK-PO-NBR                         31400000
314100     END-EXEC.                                                    31410000
314200                                                                  31420000
314300     EVALUATE TRUE                                                31430000
314400        WHEN SQLCODE = +0                                         31440000
314500        WHEN SQLCODE = -811                                       31450000
314600           SET PREPACK-PO TO TRUE                                 31460000
314700        WHEN SQLCODE = +100                                       31470000
314800           SET NOT-PREPACK-PO TO TRUE                             31480000
314900        WHEN SQLCODE = -904                                       31490000
315000        WHEN SQLCODE = -913                                       31500000
315100             CONTINUE                                             31510000
315200        WHEN SQLWARN0 NOT = SPACES                                31520000
315300        WHEN SQLCODE < +0                                         31530000
315400        WHEN SQLCODE > +0                                         31540000
315500             MOVE '5700-CHECK-PREPACK'                            31550000
315600                              TO DP013-PARAGRAPH                  31560000
315700             MOVE 'UNSUCCESSFUL SELECT TPOPRPK'                   31570000
315800                              TO DP013-MESSAGE-TEXT (1)           31580000
315900             MOVE SQLCA       TO DP013-SQLCA                      31590000
316000             MOVE 'TPOPRPK'  TO DP013-DB2-TABLE-NAME (1)          31600000
316100             SET DP013-DB2-ABEND                                  31610000
316200                 DP013-XCTL-DISPLAY-RESTART                       31620000
316300                              TO TRUE                             31630000
316400             PERFORM DP013-0000-PROCESS-ABEND                     31640000
316500     END-EVALUATE.                                                31650000
316600     MOVE 0 TO SQLCODE.                                           31660000
316700                                                                  31670000
316800 6000-REFRESH-PANEL-FROM-TEMP.                                    31680000
316900                                                                  31690000
317000     IF ASC-UPDATE-TSQ                                            31700000
317100         SET ASC-NO-TSQ-UPDATE   TO TRUE                          31710000
317200         MOVE ZERO               TO PV-SAVE-ITEM                  31720000
317300                                    PV-SEL-QUEUE-ITEM             31730000
317400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        31740000
317500                                 TO PV-HOLD-SELECTED-ITEMS        31750000
317600         PERFORM 6100-UPDATE-TSQ                                  31760000
317700           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS31770000
317800                                                                  31780000
317900         PERFORM 6010-DELETE-SEL-QUEUE                            31790000
318000                                                                  31800000
318100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         31810000
318200                    ASC-BLOCK-ENTRIES (2)                         31820000
318300                                                                  31830000
318400         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 31840000
318500                GIVING    PV-BLOCK-NUMBER                         31850000
318600                REMAINDER PV-REMAINDER                            31860000
318700                                                                  31870000
318800         IF PV-REMAINDER > ZERO                                   31880000
318900             ADD +1              TO PV-BLOCK-NUMBER               31890000
319000         END-IF                                                   31900000
319100                                                                  31910000
319200         MOVE +1                 TO ASC-BLK-SUB                   31920000
319300                                                                  31930000
319400         PERFORM 4410-READ-TEMP-STORAGE                           31940000
319500                                                                  31950000
319600         ADD +1                  TO ASC-BLK-SUB                   31960000
319700                            PV-BLOCK-NUMBER                       31970000
319800         PERFORM 4410-READ-TEMP-STORAGE                           31980000
319900                                                                  31990000
320000     END-IF.                                                      32000000
320100                                                                  32010000
320200 6010-DELETE-SEL-QUEUE.                                           32020000
320300                                                                  32030000
320400     EXEC CICS DELETEQ TS                                         32040000
320500               QUEUE (ASC-SEL-QUEUE-NAME)                         32050000
320600               RESP  (PV-CICS-RESP)                               32060000
320700     END-EXEC.                                                    32070000
320800                                                                  32080000
320900     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     32090000
321000         (PV-CICS-RESP = DFHRESP (QIDERR)))                       32100000
321100         CONTINUE                                                 32110000
321200     ELSE                                                         32120000
321300         SET DP013-CICS-ABEND                                     32130000
321400             DP013-NO-ROLLBACK   TO TRUE                          32140000
321500         MOVE '6010-DELETE-SEL-QUEUE'                             32150000
321600                                 TO DP013-PARAGRAPH               32160000
321700         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  32170000
321800                                 TO DP013-MESSAGE-TEXT (1)        32180000
321900         PERFORM DP013-0000-PROCESS-ABEND                         32190000
322000     END-IF.                                                      32200000
322100                                                                  32210000
322200 6100-UPDATE-TSQ.                                                 32220000
322300                                                                  32230000
322400     ADD 1                       TO PV-SEL-QUEUE-ITEM.            32240000
322500                                                                  32250000
322600     PERFORM 6105-READ-SEL-QUEUE.                                 32260000
322700                                                                  32270000
322800     PERFORM                                                      32280000
322900     VARYING RC013-IDX  FROM 1 BY 1                               32290000
323000     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       32300000
323100             RC013-IDX > RC013-MAX-ITEMS                          32310000
323200                                                                  32320000
323300         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   32330000
323400            PERFORM 6110-PROCESS-ITEMS                            32340000
323500         END-IF                                                   32350000
323600                                                                  32360000
323700         ADD +1                  TO PV-ITEMS-PROCESSED            32370000
323800     END-PERFORM.                                                 32380000
323900                                                                  32390000
324000     PERFORM 6111-WRITE-LIST-QUEUE.                               32400000
324100                                                                  32410000
324200                                                                  32420000
324300 6105-READ-SEL-QUEUE.                                             32430000
324400                                                                  32440000
324500     EXEC CICS READQ TS                                           32450000
324600               QUEUE (ASC-SEL-QUEUE-NAME)                         32460000
324700               INTO  (RC013-DC-SELECT-RECORD)                     32470000
324800               ITEM  (PV-SEL-QUEUE-ITEM)                          32480000
324900               RESP  (PV-CICS-RESP)                               32490000
325000     END-EXEC.                                                    32500000
325100                                                                  32510000
325200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       32520000
325300         SET DP013-CICS-ABEND                                     32530000
325400             DP013-NO-ROLLBACK   TO TRUE                          32540000
325500         MOVE '6105-READ-SEL-QUEUE'                               32550000
325600                                 TO DP013-PARAGRAPH               32560000
325700         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    32570000
325800                                 TO DP013-MESSAGE-TEXT (1)        32580000
325900         PERFORM DP013-0000-PROCESS-ABEND                         32590000
326000     END-IF.                                                      32600000
326100                                                                  32610000
326200 6110-PROCESS-ITEMS.                                              32620000
326300                                                                  32630000
326400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          32640000
326500                                            / PC-ITEMS-PER-PANEL).32650000
326600                                                                  32660000
326700     IF PV-ITEM NOT = PV-SAVE-ITEM                                32670000
326800        IF PV-SAVE-ITEM NOT = ZERO                                32680000
326900                                                                  32690000
327000            PERFORM 6111-WRITE-LIST-QUEUE                         32700000
327100                                                                  32710000
327200        END-IF                                                    32720000
327300        MOVE PV-ITEM             TO PV-SAVE-ITEM                  32730000
327400                                                                  32740000
327500        PERFORM 6112-READ-LIST-QUEUE                              32750000
327600                                                                  32760000
327700     END-IF.                                                      32770000
327800                                                                  32780000
327900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   32790000
328000                                    LQW-LIST-ITEM-NUMBER (1)) + 1.32800000
328100     SET LQW-DESELECT (PV-SUB)   TO TRUE                          32810000
328200     MOVE LQW-SELECTED-SW (PV-SUB)                                32820000
328300                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).32830000
328400                                                                  32840000
328500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                32850000
328600                                                                  32860000
328700 6111-WRITE-LIST-QUEUE.                                           32870000
328800                                                                  32880000
328900     EXEC CICS WRITEQ TS                                          32890000
329000               QUEUE (ASC-LIST-QUEUE-NAME)                        32900000
329100               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   32910000
329200               ITEM  (PV-SAVE-ITEM)                               32920000
329300               REWRITE                                            32930000
329400               RESP  (PV-CICS-RESP)                               32940000
329500     END-EXEC.                                                    32950000
329600                                                                  32960000
329700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       32970000
329800         SET DP013-CICS-ABEND                                     32980000
329900             DP013-NO-ROLLBACK   TO TRUE                          32990000
330000         MOVE '6111-WRITE-LIST-QUEUE'                             33000000
330100                                 TO DP013-PARAGRAPH               33010000
330200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'33020000
330300                                 TO DP013-MESSAGE-TEXT(1)         33030000
330400         PERFORM DP013-0000-PROCESS-ABEND                         33040000
330500     END-IF.                                                      33050000
330600                                                                  33060000
330700 6112-READ-LIST-QUEUE.                                            33070000
330800                                                                  33080000
330900     EXEC CICS READQ TS                                           33090000
331000               QUEUE (ASC-LIST-QUEUE-NAME)                        33100000
331100               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   33110000
331200               ITEM  (PV-ITEM)                                    33120000
331300               RESP  (PV-CICS-RESP)                               33130000
331400     END-EXEC.                                                    33140000
331500                                                                  33150000
331600     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       33160000
331700         SET DP013-CICS-ABEND                                     33170000
331800             DP013-NO-ROLLBACK   TO TRUE                          33180000
331900         MOVE '6112-READ-LIST-QUEUE'                              33190000
332000                                 TO DP013-PARAGRAPH               33200000
332100         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   33210000
332200                                 TO DP013-MESSAGE-TEXT(1)         33220000
332300         PERFORM DP013-0000-PROCESS-ABEND                         33230000
332400     END-IF.                                                      33240000
332500/                                                                 33250000
332600******************************************************************33260000
332700*    ABEND PROCESSING                                             33270000
332800******************************************************************33280000
332900     COPY DPPD013.                                                33290000
