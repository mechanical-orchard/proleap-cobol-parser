000200 IDENTIFICATION DIVISION.                                         00010000
000300 PROGRAM-ID.         XMKRP031.                                    00020000
000400 AUTHOR.             BOB MCASEY.                                  00030000
000600 DATE-WRITTEN.       02-07-2003.                                  00040000
000700 DATE-COMPILED.                                                   00050000
000800*                                                                 00060000
000900******************************************************************00070000
001000*  COMPARES DATA FROM DOMAIN TABLES AND RMS REGION TABLE          00080000
001100*  FOR THE XMT_REGN                                               00090000
001200******************************************************************00100000
      *---------------------------------------------------------------* 00110005
      *    WR/PITS#     DATE        DESCRIPTION                       * 00120005
      *    --------   ----------   ---------------------------------  * 00130005
      *    WR24442    08/20/2003   INITIAL CREATION.                  * 00140005
      *---------------------------------------------------------------* 00150005
001300                                                                  00160000
001400 ENVIRONMENT DIVISION.                                            00170000
001500                                                                  00180000
001600 CONFIGURATION SECTION.                                           00190000
001700                                                                  00200000
001800 SOURCE-COMPUTER.    IBM-3090.                                    00210000
001900 OBJECT-COMPUTER.    IBM-3090.                                    00220000
002000                                                                  00230000
002100 INPUT-OUTPUT SECTION.                                            00240000
002200                                                                  00250000
002300 FILE-CONTROL.                                                    00260000
002400                                                                  00270000
002500     SELECT XMT-INPUT-FILE       ASSIGN TO INP01.                 00280000
002600     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00290000
002700     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00300000
002800                                                                  00310000
002900 DATA DIVISION.                                                   00320000
003000                                                                  00330000
003100 FILE SECTION.                                                    00340000
003200                                                                  00350000
003300 FD  RMS-INPUT-FILE                                               00360000
003400     RECORDING MODE IS F                                          00370000
003500     BLOCK CONTAINS 0 RECORDS                                     00380000
003600     LABEL RECORDS ARE OMITTED.                                   00390000
003700 01  RMS-INPUT-RECORD                    PIC  X(62).              00400000
003800                                                                  00410000
003900 FD  XMT-INPUT-FILE                                               00420000
004000     RECORDING MODE IS F                                          00430000
004100     BLOCK CONTAINS 0 RECORDS                                     00440000
004200     LABEL RECORDS ARE OMITTED.                                   00450000
004300 01  XMT-INPUT-RECORD                    PIC  X(62).              00460000
004400                                                                  00470000
004500 FD  ERROR-REPORT                                                 00480000
004600     RECORDING MODE IS F                                          00490000
004700     BLOCK CONTAINS 0 RECORDS                                     00500000
004800     LABEL RECORDS ARE OMITTED.                                   00510000
004900 01  ERR-RPT-LINE                        PIC  X(200).             00520000
005000                                                                  00530000
005100 WORKING-STORAGE SECTION.                                         00540000
005200                                                                  00550000
006200 01 PC-PROGRAM-CONSTANTS.                                         00560000
006300     05 PC-PGM-NAME           PIC X(08)  VALUE 'XMKRP031'.        00570000
006400                                                                  00580000
006500 01 PV-PROGRAM-VARIABLES.                                         00590000
006600     05 PV-XMT-KEY.                                               00600000
006700        10 PV-XMT-REGN-NBR       PIC 9(04).                       00610000
006710     05 PV-XMT-REGN-TERR-NBR     PIC 9(04).                       00620000
006800     05 PV-XMT-REGN-NM           PIC X(20) VALUE SPACE.           00630000
006900     05 PV-XMT-REGN-MGR-NM       PIC X(32) VALUE SPACE.           00640000
007000                                                                  00650000
007100     05 PV-RMS-KEY.                                               00660000
007200         10 PV-RMS-REGN-NBR       PIC 9(04).                      00670000
007210     05 PV-RMS-REGN-TERR-NBR      PIC 9(04).                      00680000
007300     05 PV-RMS-REGN-NM            PIC X(20) VALUE SPACE.          00690000
007400     05 PV-RMS-REGN-MGR-NM        PIC X(32) VALUE SPACE.          00700000
007500                                                                  00710000
007600     05 PV-PAGE-CNT               PIC S9(05)  VALUE ZERO.         00720000
007700     05 PV-LINE-CNT               PIC S9(04)  COMP VALUE ZERO.    00730000
007800     05 PV-MAX-LINES              PIC S9(04)  COMP VALUE +71.     00740000
007900                                                                  00750000
008000     05 PV-DISPLAY-CNT            PIC ZZZZ9.                      00760000
008100     05 PV-NBR-ERRORS             PIC S9(04)  COMP                00770000
008200                                                VALUE ZERO.       00780000
008300     05 PV-DATE-YYMMDD.                                           00790000
008400          10 PV-YYMMDD-YY       PIC X(02)  VALUE SPACE.           00800000
008500          10 PV-YYMMDD-MM       PIC X(02)  VALUE SPACE.           00810000
008600          10 PV-YYMMDD-DD       PIC X(02)  VALUE SPACE.           00820000
008700     05 PV-TIME-HHMMSS.                                           00830000
008800          10 PV-HHMMSS-HH       PIC X(02)  VALUE SPACE.           00840000
008900          10 PV-HHMMSS-MM       PIC X(02)  VALUE SPACE.           00850000
009000          10 PV-HHMMSS-SS       PIC X(02)  VALUE SPACE.           00860000
009100     05 PV-MESSAGE              PIC X(58)  VALUE SPACE.           00870000
009200                                                                  00880000
009300 01 RPT-TOTAL-LINE.                                               00890000
009400     05 FILLER     PIC  X(23) VALUE                               00900000
009500                         'TOTAL NUMBER OF ERRORS '.               00910000
009600     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00920000
009700                                                                  00930000
009800 01 RPT-END-OF-REPORT-LINE.                                       00940000
009900     05 FILLER     PIC  X(21) VALUE                               00950000
010000                            '*** END OF REPORT ***'.              00960000
010100 01 PA-PROGRAM-ACCUMULATORS.                                      00970000
010200     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              00980000
010300     05 PA-XMT-RECS-READ       PIC 9(13) VALUE ZERO.              00990000
010400     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              01000000
010500                                                                  01010000
010600 01 PS-PROGRAM-SWITCHES.                                          01020000
010700     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01030000
010800         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01040000
010900         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01050000
011000     05 PS-MORE-XMT-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01060000
011100         88 PS-MORE-XMT-INPUT-RECS           VALUE 'Y'.           01070000
011200         88 PS-END-OF-XMT-INPUT-RECS         VALUE 'N'.           01080000
011300     05 PS-RMS-OR-XMT-ERR        PIC X(01)   VALUE '0'.           01090000
011400         88 PS-RMS-ERROR                     VALUE '1'.           01100000
011500         88 PS-XMT-ERROR                     VALUE '2'.           01110000
011600         88 PS-DATA-ERROR                    VALUE '3'.           01120000
011700                                                                  01130000
011800 01 RPT-REPORT-HEADING.                                           01140000
011900     05 FILLER     PIC  X(86)    VALUE SPACES.                    01150000
012000     05 FILLER     PIC  X(37)    VALUE                            01160000
012100     'XM REGION DATA INTEGRITY ERRORS'.                           01170002
012200                                                                  01180000
012300 01 RPT-COL-HEADING-1.                                            01190000
012400     05 FILLER     PIC  X(01) VALUE SPACE.                        01200000
012500     05 FILLER     PIC  X(01) VALUE ALL '-'.                      01210000
012600     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01220000
012700     05 FILLER     PIC  X(01) VALUE ALL '-'.                      01230000
012800                                                                  01240000
012900 01 RPT-COL-HEADING-2.                                            01250000
013200     05 FILLER     PIC  X(23) VALUE SPACE.                        01260000
013300     05 FILLER     PIC  X(34) VALUE 'XM DOMAIN'.                  01270002
013400     05 FILLER     PIC  X(24) VALUE SPACE.                        01280000
013500     05 FILLER     PIC  X(41) VALUE                               01290002
013500        'RETAIL MANAGEMENT SYSTEM - RMS'.                         01300002
013800                                                                  01310000
013900 01 RPT-COL-HEADING-3.                                            01320000
014000     05 FILLER     PIC  X(01) VALUE SPACE.                        01330000
014010     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01340000
014020     05 FILLER     PIC  X(04) VALUE SPACE.                        01350000
014100     05 FILLER     PIC  X(04) VALUE 'TERR'.                       01360000
014200     05 FILLER     PIC  X(02) VALUE SPACE.                        01370000
014210     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01380000
014220     05 FILLER     PIC  X(18) VALUE SPACE.                        01390000
014300     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01400000
014400     05 FILLER     PIC  X(30) VALUE SPACE.                        01410000
014500     05 FILLER     PIC  X(04) VALUE 'TERR'.                       01420000
014600     05 FILLER     PIC  X(02) VALUE SPACE.                        01430000
014610     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01440000
014620     05 FILLER     PIC  X(18) VALUE SPACE.                        01450000
014700     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01460000
014800                                                                  01470000
014900 01 RPT-COL-HEADING-4.                                            01480000
015010     05 FILLER     PIC  X(01) VALUE SPACE.                        01490000
015020     05 FILLER     PIC  X(04) VALUE '_NBR'.                       01500000
015030     05 FILLER     PIC  X(04) VALUE SPACE.                        01510000
015040     05 FILLER     PIC  X(04) VALUE '_NBR'.                       01520000
015050     05 FILLER     PIC  X(02) VALUE SPACE.                        01530000
015060     05 FILLER     PIC  X(03) VALUE '_NM'.                        01540000
015070     05 FILLER     PIC  X(19) VALUE SPACE.                        01550000
015080     05 FILLER     PIC  X(07) VALUE '_MGR_NM'.                    01560000
015090     05 FILLER     PIC  X(27) VALUE SPACE.                        01570000
015091     05 FILLER     PIC  X(04) VALUE '_NBR'.                       01580000
015092     05 FILLER     PIC  X(02) VALUE SPACE.                        01590000
015093     05 FILLER     PIC  X(03) VALUE '_NM'.                        01600000
015094     05 FILLER     PIC  X(19) VALUE SPACE.                        01610000
015095     05 FILLER     PIC  X(07) VALUE '_MGR_NM'.                    01620000
015096     05 FILLER     PIC  X(27) VALUE SPACE.                        01630000
015097     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01640000
015100                                                                  01650000
015110 01 RPT-COL-HEADING-5.                                            01660000
015120     05 FILLER     PIC  X(175) VALUE ALL '-'.                     01670000
015130                                                                  01680000
015200 01 DL-DETAIL-LINE.                                               01690000
015300     05 FILLER                PIC  X(01) VALUE SPACE.             01700000
015400     05 DL-REGN-NBR           PIC  X(04) VALUE SPACE.             01710000
015500     05 FILLER                PIC  X(04) VALUE SPACE.             01720000
015510     05 DL-XMT-REGN-TERR-NBR  PIC  X(04) VALUE SPACE.             01730000
015520     05 FILLER                PIC  X(02) VALUE SPACE.             01740000
015600     05 DL-XMT-REGN-NM        PIC  X(20) VALUE SPACE.             01750000
015700     05 FILLER                PIC  X(02) VALUE SPACE.             01760000
015800     05 DL-XMT-REGN-MGR-NM    PIC  X(32) VALUE SPACE.             01770000
015900     05 FILLER                PIC  X(02) VALUE SPACE.             01780000
015910     05 DL-RMS-REGN-TERR-NBR  PIC  X(04) VALUE SPACE.             01790000
015920     05 FILLER                PIC  X(02) VALUE SPACE.             01800000
016000     05 DL-RMS-REGN-NM        PIC  X(20) VALUE SPACE.             01810000
016100     05 FILLER                PIC  X(02) VALUE SPACE.             01820000
016200     05 DL-RMS-REGN-MGR-NM    PIC  X(32) VALUE SPACE.             01830000
016300     05 FILLER                PIC  X(02) VALUE SPACE.             01840000
016400     05 DL-MESSAGE            PIC  X(53) VALUE SPACE.             01850000
016500                                                                  01860000
005700 01 XMT-REC.                                                      01870002
005800     05 XMT-REGN-NBR          PIC S9(04) COMP-3.                  01880002
005810     05 XMT-REGN-TERR-NBR     PIC S9(04) COMP-3.                  01890002
005900     05 XMT-REGN-NM           PIC X(20) VALUE SPACE.              01900002
006000     05 XMT-REGN-MGR-NM       PIC X(32) VALUE SPACE.              01910002
006100                                                                  01920002
005300     COPY HORD007.                                                01930003
005400                                                                  01940000
005500     COPY DPWS200O.                                               01950003
005600                                                                  01960000
016600 PROCEDURE DIVISION.                                              01970000
016700                                                                  01980000
016800 0000-MAIN-MODULE.                                                01990000
016900                                                                  02000000
017000       OPEN INPUT RMS-INPUT-FILE                                  02010000
017100                  XMT-INPUT-FILE                                  02020000
017200            OUTPUT ERROR-REPORT.                                  02030000
017300                                                                  02040000
017400       PERFORM 1000-INITIALIZE.                                   02050000
017500       PERFORM 7000-READ-XMT-INPUT-FILE.                          02060000
017600       PERFORM 7100-READ-RMS-INPUT-FILE.                          02070000
017700                                                                  02080000
017800       PERFORM 2000-PROCESS-RECS                                  02090000
017900          UNTIL (PS-END-OF-XMT-INPUT-RECS                         02100000
018000            AND PS-END-OF-RMS-INPUT-RECS).                        02110000
018100                                                                  02120000
018200       PERFORM 8400-WRITE-TOTALS.                                 02130000
018300                                                                  02140000
018400       CLOSE RMS-INPUT-FILE                                       02150000
018500             XMT-INPUT-FILE                                       02160000
018600             ERROR-REPORT.                                        02170000
018700                                                                  02180000
018800       DISPLAY '**** XMKRP031 STATISTICS ****'                    02190000
018900       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     02200000
019000       DISPLAY 'TOTAL XMT RECORDS READ : ' PA-XMT-RECS-READ.      02210000
019100       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      02220000
019200       DISPLAY ' '                                                02230000
019300                                                                  02240000
019400       STOP RUN.                                                  02250000
019500                                                                  02260000
019600 1000-INITIALIZE.                                                 02270000
019700                                                                  02280000
019800       ACCEPT PV-DATE-YYMMDD FROM DATE.                           02290000
019900       MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      02300000
020000       MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     02310000
020100       MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                       02320000
020200                                                                  02330000
020300       ACCEPT PV-TIME-HHMMSS FROM TIME.                           02340000
020400       MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                      02350000
020500       MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                    02360000
020600       MOVE PC-PGM-NAME TO DP200O-PROGRAM-NAME.                   02370000
020700       MOVE 1        TO DP200O-REPORT-NUMBER.                     02380000
020800                                                                  02390000
020900       PERFORM 8100-WRITE-STD-RPT-HEADING.                        02400000
021000       PERFORM 8200-WRITE-REPORT-HEADING.                         02410000
021100       PERFORM 8300-WRITE-COLUMN-HEADING.                         02420000
021200                                                                  02430000
021300 2000-PROCESS-RECS.                                               02440000
021400                                                                  02450000
021500       MOVE HO007-REGN-NBR      TO  PV-RMS-REGN-NBR.              02460000
021510       MOVE HO007-REGN-TERR-NBR TO  PV-RMS-REGN-TERR-NBR.         02470000
021600       MOVE HO007-REGN-NM       TO  PV-RMS-REGN-NM.               02480000
021700       MOVE HO007-REGN-MGR-NM   TO  PV-RMS-REGN-MGR-NM.           02490000
021800                                                                  02500000
021900       MOVE XMT-REGN-NBR        TO  PV-XMT-REGN-NBR.              02510000
021910       MOVE XMT-REGN-TERR-NBR   TO  PV-XMT-REGN-TERR-NBR.         02520000
022000       MOVE XMT-REGN-NM         TO  PV-XMT-REGN-NM.               02530000
022100       MOVE XMT-REGN-MGR-NM     TO  PV-XMT-REGN-MGR-NM.           02540000
022200                                                                  02550000
022300     IF PV-XMT-KEY = PV-RMS-KEY                                   02560000
022400*----- KEYS ON BOTH RMS AND XMT, CONTINUE PROCESSING              02570000
022500        PERFORM 3000-COMPARE-FIELDS                               02580000
022600        PERFORM 7000-READ-XMT-INPUT-FILE                          02590000
022700        PERFORM 7100-READ-RMS-INPUT-FILE                          02600000
022800      ELSE                                                        02610000
022900          IF ((PV-RMS-KEY < PV-XMT-KEY)                           02620000
023000             OR PS-END-OF-XMT-INPUT-RECS) AND                     02630000
023100             PS-MORE-RMS-INPUT-RECS                               02640000
023200             MOVE '1' TO PS-RMS-OR-XMT-ERR                        02650000
023300             MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'           02660000
023400                 TO PV-MESSAGE                                    02670000
023500             PERFORM 8000-WRITE-OUTPUT-REC                        02680000
023600             PERFORM 7100-READ-RMS-INPUT-FILE                     02690000
023700          ELSE                                                    02700000
023800              IF (PV-RMS-KEY > PV-XMT-KEY                         02710000
023900                   OR PS-END-OF-RMS-INPUT-RECS)                   02720000
024000                  AND PS-MORE-XMT-INPUT-RECS                      02730000
024100                  MOVE '2' TO PS-RMS-OR-XMT-ERR                   02740000
024200                  MOVE 'KEY ON XM DOMAIN TABLE ONLY'              02750003
024210                                                   TO PV-MESSAGE  02760000
024300                  PERFORM 8000-WRITE-OUTPUT-REC                   02770000
024400                  PERFORM 7000-READ-XMT-INPUT-FILE                02780000
024500              END-IF                                              02790000
024600          END-IF                                                  02800000
024700      END-IF.                                                     02810000
024800                                                                  02820000
024900 3000-COMPARE-FIELDS.                                             02830004
025000                                                                  02840000
025100      EVALUATE TRUE                                               02850000
025200         WHEN PV-RMS-REGN-TERR-NBR NOT = PV-XMT-REGN-TERR-NBR     02860000
025300             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02870000
025400             MOVE 'REGION TERRITORY NUMBER DOES NOT MATCH'        02880000
025500                                                TO PV-MESSAGE     02890000
025501             PERFORM 8000-WRITE-OUTPUT-REC                        02900000
025510         WHEN PV-RMS-REGN-NM  NOT = PV-XMT-REGN-NM                02910000
025520             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02920000
025530             MOVE 'REGION NAME DOES NOT MATCH'                    02930004
025540                                                TO PV-MESSAGE     02940000
025600             PERFORM 8000-WRITE-OUTPUT-REC                        02950000
025700         WHEN PV-RMS-REGN-MGR-NM  NOT = PV-XMT-REGN-MGR-NM        02960000
025800             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02970000
025900             MOVE 'REGION MANAGER NAME DOES NOT MATCH'            02980000
026000                                                TO PV-MESSAGE     02990000
026100             PERFORM 8000-WRITE-OUTPUT-REC                        03000000
026200      END-EVALUATE.                                               03010000
026300                                                                  03020000
026400 7000-READ-XMT-INPUT-FILE.                                        03030000
026500                                                                  03040000
026600       INITIALIZE XMT-REC.                                        03050000
026700                                                                  03060000
026800       READ XMT-INPUT-FILE INTO XMT-REC                           03070000
026900           AT END SET PS-END-OF-XMT-INPUT-RECS TO TRUE.           03080000
027000                                                                  03090000
027100       ADD 1 TO PA-XMT-RECS-READ.                                 03100000
027200                                                                  03110000
027300 7100-READ-RMS-INPUT-FILE.                                        03120000
027400                                                                  03130000
027500       INITIALIZE HO007-REGION-DATA.                              03140000
027600                                                                  03150000
027700       READ RMS-INPUT-FILE INTO HO007-REGION-DATA                 03160000
027800            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          03170000
027900                                                                  03180000
028000       ADD 1 TO PA-RMS-RECS-READ.                                 03190000
028100                                                                  03200000
028200 8000-WRITE-OUTPUT-REC.                                           03210000
028300                                                                  03220000
028500       IF PS-RMS-ERROR                                            03230000
028600          MOVE SPACES TO DL-DETAIL-LINE                           03240000
028700          MOVE PV-RMS-REGN-NBR      TO DL-REGN-NBR                03250000
028710          MOVE PV-RMS-REGN-TERR-NBR TO DL-RMS-REGN-TERR-NBR       03260000
028800          MOVE PV-RMS-REGN-NM       TO DL-RMS-REGN-NM             03270000
028900          MOVE PV-RMS-REGN-MGR-NM   TO DL-RMS-REGN-MGR-NM         03280000
029000          MOVE PV-MESSAGE TO DL-MESSAGE                           03290000
029100       ELSE                                                       03300000
029200          IF PS-XMT-ERROR                                         03310000
029300             MOVE SPACES TO DL-DETAIL-LINE                        03320000
029400             MOVE PV-XMT-REGN-NBR      TO DL-REGN-NBR             03330000
029410             MOVE PV-XMT-REGN-TERR-NBR TO DL-XMT-REGN-TERR-NBR    03340000
029500             MOVE PV-XMT-REGN-NM       TO DL-XMT-REGN-NM          03350000
029600             MOVE PV-XMT-REGN-MGR-NM   TO DL-XMT-REGN-MGR-NM      03360000
029700             MOVE PV-MESSAGE TO DL-MESSAGE                        03370000
029800          ELSE                                                    03380000
029900             MOVE SPACES TO DL-DETAIL-LINE                        03390000
030000             MOVE PV-RMS-REGN-NBR      TO DL-REGN-NBR             03400000
030010             MOVE PV-RMS-REGN-TERR-NBR TO DL-RMS-REGN-TERR-NBR    03410000
030100             MOVE PV-RMS-REGN-NM       TO DL-RMS-REGN-NM          03420000
030200             MOVE PV-RMS-REGN-MGR-NM   TO DL-RMS-REGN-MGR-NM      03430000
030210             MOVE PV-XMT-REGN-TERR-NBR TO DL-XMT-REGN-TERR-NBR    03440000
030300             MOVE PV-XMT-REGN-NM       TO DL-XMT-REGN-NM          03450000
030400             MOVE PV-XMT-REGN-MGR-NM   TO DL-XMT-REGN-MGR-NM      03460000
030500             MOVE PV-MESSAGE TO DL-MESSAGE                        03470000
030600          END-IF                                                  03480000
030700       END-IF.                                                    03490000
030800                                                                  03500000
030900       IF PV-LINE-CNT > PV-MAX-LINES                              03510000
031000          PERFORM 8100-WRITE-STD-RPT-HEADING                      03520000
031100          PERFORM 8200-WRITE-REPORT-HEADING                       03530000
031200          PERFORM 8300-WRITE-COLUMN-HEADING                       03540000
031300       END-IF.                                                    03550000
031400                                                                  03560000
031500       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     03570000
031600             AFTER ADVANCING 1 LINE.                              03580000
031700       ADD +1 TO PV-LINE-CNT.                                     03590000
031800                                                                  03600000
031810       MOVE 4095 TO RETURN-CODE.                                  03610000
031900       ADD 1 TO PA-ERROR-MESSAGES.                                03620000
032000                                                                  03630000
032100 8100-WRITE-STD-RPT-HEADING.                                      03640000
032200                                                                  03650000
032300       ADD 1  TO PV-PAGE-CNT.                                     03660000
032400       MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                    03670000
032500       WRITE ERR-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS     03680000
032600             AFTER ADVANCING PAGE.                                03690000
032700       MOVE +1 TO PV-LINE-CNT.                                    03700000
032800                                                                  03710000
032900 8200-WRITE-REPORT-HEADING.                                       03720000
033000                                                                  03730000
033100       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03740000
033200            AFTER ADVANCING 1 LINES.                              03750000
033300       ADD +1 TO PV-LINE-CNT.                                     03760000
033400                                                                  03770000
033500 8300-WRITE-COLUMN-HEADING.                                       03780000
033600                                                                  03790000
033700       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03800000
033800            AFTER ADVANCING 2 LINES.                              03810000
033900       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03820000
034000            AFTER ADVANCING 1 LINES.                              03830000
034100       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03840000
034200            AFTER ADVANCING 1 LINES.                              03850000
034300       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03860000
034400            AFTER ADVANCING 1 LINES.                              03870000
034410       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-5                  03880000
034420            AFTER ADVANCING 1 LINES.                              03890000
034500       ADD +6 TO PV-LINE-CNT.                                     03900000
034600                                                                  03910000
034700 8400-WRITE-TOTALS.                                               03920000
034800                                                                  03930000
034900      IF PV-LINE-CNT > PV-MAX-LINES                               03940000
035000         PERFORM 8100-WRITE-STD-RPT-HEADING                       03950000
035100         PERFORM 8200-WRITE-REPORT-HEADING                        03960000
035200         PERFORM 8300-WRITE-COLUMN-HEADING                        03970000
035300      END-IF.                                                     03980000
035400                                                                  03990000
035500      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    04000000
035600      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      04010000
035700            AFTER ADVANCING 2 LINES.                              04020000
035800      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              04030000
035900            AFTER ADVANCING 1 LINES.                              04040000
036000                                                                  04050000
