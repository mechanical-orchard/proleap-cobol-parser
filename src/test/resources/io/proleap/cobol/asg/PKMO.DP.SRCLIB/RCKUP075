000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUP075.                                00050000
000600 AUTHOR.                 DENISE HAHN.                             00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            FEBRUARY 2022.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001110*                                                                *00111000
001120*  N O T E:  THIS IS A COPY OF RCKUP072 - COULD NOT GET          *00112000
001121*            CHECKPOINT RESTART TO WORK - GETTING -805 ON        *00112100
001122*            RESTART.                                            *00112200
001123*            CHECKPOINT PREP:  RCKUT191                          *00112300
001124*            UPDATE PROGRAM:   RCKUP072                          *00112400
001125*                                                                *00112500
001126*            RCKUP075 IS THE UPDATE PROGRAM WITHOUT ANY          *00112600
001127*            CHECKPOINT LOGIC                                    *00112700
001128*                                                                *00112800
001130******************************************************************00113000
001200* RECEIVER CREATE FOR ASN FROM THIRD PARTY DISTRIBUTION.  3WD     00120000
001210* THIS PROGRAM IS A COPY OF RCKUP064 BUT WILL BE USED TO CREATE   00121000
001220* RECEIVERS FOR SEPHORA MDSE PROCESSED BY GEODIS.                 00122000
001230*                                                                 00123000
001240* INPUT LAYOUT:  RCRD119                                          00124000
001250*                                                                 00125000
001260* INPUT SEQUENCE:  PO-LINE-STORE-SML                              00126000
001270*                                                                 00127000
001280* FROM THE FILE FROM THE 3RD PARTY THIS PROGRAM WILL CREATE:      00128000
001290*    - TPKSLIP - PACKSLIPS                                        00129000
001300*    - TPKITEM - PACKSLIP ITEMS                                   00130000
001400*    - TRECEIV - RECEIVER(S)                                      00140000
001500*    - TRECITM - RECEIVER ITEM(S)                                 00150000
001510*    - TRECDIS - RECEIVER ITEM DISTRIBUTION(S)                    00151000
001520*    - SUT_OTBND_CART - OUTBOUND CARTON (0042 - 3WD)              00152000
001530*    - SUT_OTBND_UPC  - OUTBOUND CARTON UPC                       00153000
001540*    - SUT_OTBND_LOC  - OUTBOUND CARTON LOCATION (RECV)           00154000
001550*                                                                 00155000
001560* A GDG WILL GENERATED WITH THE RECEIVERS THAT WERE CREATED.      00156000
001570* THE GDG WILL BE IN RCRD119 FORMAT WITH THE RECEIVER NUMBER      00157000
001580* THAT WAS CREATED.                                               00158000
001590******************************************************************00159000
001600 ENVIRONMENT DIVISION.                                            00160000
001610******************************************************************00161000
001620 INPUT-OUTPUT SECTION.                                            00162000
001630 FILE-CONTROL.                                                    00163000
001640                                                                  00164000
001641     SELECT THIRD-PARTY-OTBND-FILE                                00164101
001642         ASSIGN TO INP01.                                         00164201
001650                                                                  00165000
001660     SELECT OUT-PO-STR-SSCC-FILE                                  00166000
001670         ASSIGN TO OUT01.                                         00167000
001680                                                                  00168000
001690     SELECT OUT-PO-RCVR-OPER-SSCC-FILE                            00169000
001700         ASSIGN TO OUT02.                                         00170000
001800                                                                  00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300 FILE SECTION.                                                    00230000
002400                                                                  00240000
002410 FD  THIRD-PARTY-OTBND-FILE                                       00241001
002420     RECORDING MODE IS F                                          00242001
002430     BLOCK CONTAINS 0  RECORDS.                                   00243001
002440 01  THIRD-PARTY-OTBND-RECORD             PIC  X(300).            00244001
002450                                                                  00245001
002500 FD  OUT-PO-STR-SSCC-FILE                                         00250000
002600     RECORDING MODE IS F                                          00260000
002700     LABEL RECORDS ARE STANDARD                                   00270000
002800     BLOCK CONTAINS 0 RECORDS.                                    00280000
002900                                                                  00290000
003000 01  OUT-PO-STR-SSCC-RECORD               PIC  X(300).            00300000
003100                                                                  00310000
003200                                                                  00320000
003210 FD  OUT-PO-RCVR-OPER-SSCC-FILE                                   00321000
003220     RECORDING MODE IS F                                          00322000
003230     LABEL RECORDS ARE STANDARD                                   00323000
003240     BLOCK CONTAINS 0 RECORDS.                                    00324000
003250                                                                  00325000
003260 01  OUT-PO-RCVR-OPER-SSCC-RECORD         PIC  X(125).            00326000
003270                                                                  00327000
003280                                                                  00328000
003290******************************************************************00329000
003300 WORKING-STORAGE SECTION.                                         00330000
003400******************************************************************00340000
003500                                                                  00350000
003600*----------------------------------------------------------------*00360000
003700* INPUT FILE LAYOUT                                              *00370000
003710*----------------------------------------------------------------*00371000
003720     COPY RCRD119.                                                00372000
003730                                                                  00373000
003740*----------------------------------------------------------------*00374000
003750* OUTPUT FILE LAYOUT FOR STORE EXPECTED                          *00375000
003760*----------------------------------------------------------------*00376000
003770     COPY RCRD095.                                                00377000
003780                                                                  00378000
003790*----------------------------------------------------------------*00379000
003800*    COMMUNICATION AREA FOR XL-ITEM MODULE                       *00380000
003900*----------------------------------------------------------------*00390000
004000                                                                  00400000
004100     COPY XLWS001.                                                00410000
004200                                                                  00420000
004300                                                                  00430000
004400******************************************************************00440000
004500*  DB2 FORMATTED MESSAGE AREA                                     00450000
004600******************************************************************00460000
004700     COPY DPWS004.                                                00470000
004800*                                                                 00480000
004900 01  DK-DB2-KEYS.                                                 00490000
005000     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00500000
005100     05  DK-FCLTY-ID                     PIC S9(04) COMP.         00510000
005200     05  DK-PO-NBR                       PIC S9(09) COMP SYNC.    00520000
005400     05  DK-PO-LNE-NBR                   PIC S9(09) COMP.         00540000
005500     05  DK-PREPK-ID                     PIC S9(09) COMP.         00550000
005600     05  DK-STR-DEST-NBR                 PIC S9(04) COMP          00560000
005700                                                    VALUE +0.     00570000
005800     05  DK-STR-NBR                      PIC S9(04) COMP SYNC.    00580000
005900     05  DK-SHIPT-UNT-ID                 PIC S9(18) COMP-3.       00590000
006200*                                                                 00620000
006300 01  DN-DB2-NULL-INDICATORS.                                      00630000
006400     05  DN-SEQ-NBR-IND             PIC S9(04) COMP VALUE ZEROES. 00640000
006500                                                                  00650000
006600                                                                  00660000
006700 01  PC-PROGRAM-CONSTANTS.                                        00670000
006800     05  PC-DEFAULT-TMST           PIC  X(26)  VALUE              00680000
006900                                  '9999-09-09-09.09.09.999999'.   00690000
007000     05  PC-DEFAULT-DATE           PIC  X(10)  VALUE '9999-09-09'.00700000
007200     05  PC-PROGRAM-NAME           PIC  X(08)  VALUE 'RCKUP075'.  00720000
007300     05  PC-THRDPRTY               PIC  X(08)  VALUE 'THRDPRTY'.  00730000
007400                                                                  00740000
007500     05  PC-90                     PIC S9(04)  COMP VALUE 90.     00750000
007600     05  PC-ONE                    PIC S9(04)  COMP VALUE 1.      00760000
007700     05  PC-A                      PIC  X(01)  VALUE 'A'.         00770000
007800     05  PC-AC                     PIC  X(02)  VALUE 'AC'.        00780000
007900     05  PC-3WD                    PIC  X(03)  VALUE '3WD'.       00790000
008200     05  PC-FCLTY                  PIC S9(04)  VALUE  0001  COMP. 00820000
008300     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00830000
008400     05  PC-KHL                    PIC  X(03)  VALUE 'KHL'.       00840000
008500     05  PC-MR                     PIC  X(02)  VALUE 'MR'.        00850000
008600     05  PC-N                      PIC  X(01)  VALUE 'N'.         00860000
008700     05  PC-P                      PIC  X(01)  VALUE 'P'.         00870000
008800     05  PC-PO                     PIC  X(02)  VALUE 'PO'.        00880000
008900     05  PC-RECV                   PIC  X(04)  VALUE 'RECV'.      00890000
009100     05  PC-VE                     PIC  X(02)  VALUE 'VE'.        00910000
009200     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         00920000
009300                                                                  00930000
009400     05  PC-MAX-LINE-TABLE-ROWS    PIC S9(04)  VALUE +1500        00940000
009500                                               COMP SYNC.         00950000
009600                                                                  00960000
010700 01  ABEND-CODE                       PIC S9(04)  VALUE +0        01070000
010800                                                  COMP SYNC.      01080000
010900                                                                  01090000
011000 01  PS-PROGRAM-SWITCHES.                                         01100000
011100     05  PS-EOF-SW                      PIC X(01)    VALUE 'N'.   01110010
011200         88  PS-EOF-YES                              VALUE 'Y'.   01120010
011300         88  PS-EOF-NO                               VALUE 'N'.   01130010
011310     05  PS-TEST-ONLY-DISPLAY-SW        PIC X(01)    VALUE 'Y'.   01131010
011320         88  PS-TEST-ONLY-DISPLAY-YES                VALUE 'Y'.   01132010
011330         88  PS-TEST-ONLY-DISPLAY-NO                 VALUE 'N'.   01133010
011400     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01140000
011500         88  PS-ERROR-YES                            VALUE 'Y'.   01150000
011600         88  PS-ERROR-NO                             VALUE 'N'.   01160000
011700     05  PS-FIRST-RECORD-SW             PIC X(01)    VALUE 'N'.   01170000
011800         88  PS-FIRST-RECORD                         VALUE 'Y'.   01180000
011900         88  PS-FIRST-RECORD-NO                      VALUE 'N'.   01190000
012000     05  PS-PACKAGING-TYPE-SW           PIC X(01)    VALUE ' '.   01200000
012100         88  PS-PBS                                  VALUE 'S'.   01210000
012200         88  PS-BULK                                 VALUE 'B'.   01220000
012300         88  PS-PREPACK                              VALUE 'P'.   01230000
012400     05  PS-FIRST-PKSLIP-LINE-SW        PIC  X       VALUE 'N'.   01240000
012500         88  PS-FIRST-PKSLIP-LINE                    VALUE 'Y'.   01250000
012600         88  PS-NOT-FIRST-PKSLIP-LINE                VALUE 'N'.   01260000
012700     05  PS-PKSLIP-INSERT-SW            PIC  X(01)   VALUE 'N'.   01270000
012800         88  PS-PKSLIP-INSERTED                      VALUE 'N'.   01280000
012900         88  PS-PKSLIP-NOT-INSERTED                  VALUE 'Y'.   01290000
013000     05  PS-UPDATE-TPKITEM-SW            PIC  X(01)  VALUE 'N'.   01300000
013100         88  PS-UPDATE-TPKITEM-YES                   VALUE 'Y'.   01310000
013200         88  PS-UPDATE-TPKITEM-NO                    VALUE 'N'.   01320000
013300     05  PS-NEW-RECITM-FOUND-SW          PIC  X(01)  VALUE 'N'.   01330000
013400         88  PS-NEW-RECITM-FOUND                     VALUE 'Y'.   01340000
013500         88  PS-NEW-RECITM-NOT-FOUND                 VALUE 'N'.   01350000
013600     05  PS-RECITM-YES-RECDIS-NO-SW      PIC  X(01)  VALUE 'N'.   01360000
013700         88  PS-RECITM-YES-RECDIS-NO                 VALUE 'Y'.   01370000
013800     05  PS-PRETICKET-SW                 PIC  X(01)  VALUE 'N'.   01380000
013900         88  PS-PRETICKET                            VALUE 'Y'.   01390000
014000         88  PS-NOT-PRETICKET                        VALUE 'N'.   01400000
014100     05  PS-FIRST-PREPK-LINE-SW          PIC  X(01)  VALUE 'Y'.   01410000
014200         88  PS-FIRST-PREPK-LINE-YES                 VALUE 'Y'.   01420000
014300         88  PS-FIRST-PREPK-LINE-NO                  VALUE 'N'.   01430000
014400     05  PS-FIRST-PO-LINE-SW             PIC  X(01)  VALUE 'Y'.   01440000
014500         88  PS-FIRST-PO-LINE-FOR-CTN                VALUE 'Y'.   01450000
014600         88  PS-NOT-FIRST-PO-LINE-FOR-CTN            VALUE 'N'.   01460000
014700     05  PS-ODD-UNT-CRTN-FOUND-SW        PIC  X(01)  VALUE 'N'.   01470000
014800         88  PS-ODD-UNT-CRTN-FOUND                   VALUE 'Y'.   01480000
014900         88  PS-ODD-UNT-CRTN-FOUND-NO                VALUE 'N'.   01490000
015300     05  PS-FOUND-ON-CURSOR-SW           PIC  X(01)  VALUE 'Y'.   01530000
015400         88  PS-FOUND-ON-CURSOR                      VALUE 'Y'.   01540000
015500         88  PS-NOT-FOUND-ON-CURSOR                  VALUE 'N'.   01550000
015600*    05  PS-FIRST-PREPK-SW               PIC  X(01)  VALUE 'Y'.   01560000
015700*        88  PS-FIRST-PREPK                          VALUE 'Y'.   01570000
015800*        88  PS-NOT-FIRST-PREPK                      VALUE 'N'.   01580000
015900*    05  PS-EOF-PREPK-LINE-CSR-SW        PIC  X(01)  VALUE 'N'.   01590000
016000*        88  PS-EOF-PREPK-LINE-CSR                   VALUE 'Y'.   01600000
016100*        88  PS-EOF-PREPK-LINE-CSR-NO                VALUE 'N'.   01610000
016200*    05  PS-VALID-LINE-SW                PIC  X(01)  VALUE 'N'.   01620000
016300*        88  PS-VALID-LINE                           VALUE 'Y'.   01630000
016400*        88  PS-VALID-LINE-NO                        VALUE 'N'.   01640000
016500*    05  PS-MATCH-PACKS-SW               PIC  X(01)  VALUE 'N'.   01650000
016600*        88  PS-MATCH-PACKS-YES                      VALUE 'Y'.   01660000
016700*        88  PS-MATCH-PACKS-NO                       VALUE 'N'.   01670000
017100     05  PS-EOF-VERIFY-RECITM-CSR-SW     PIC  X(01)  VALUE 'N'.   01710000
017200         88  PS-EOF-VERIFY-RECITM-CSR                VALUE 'Y'.   01720000
017300         88  PS-EOF-VERIFY-RECITM-CSR-NO             VALUE 'N'.   01730000
017400     05  PS-RESTART-REQUIRED-SW          PIC X       VALUE 'N'.   01740000
017500         88  PS-RESTART-REQUIRED                     VALUE 'Y'.   01750000
017600         88  PS-RESTART-NOT-REQUIRED                 VALUE 'N'.   01760000
017700                                                                  01770000
017800                                                                  01780000
017900 01  PV-PROGRAM-VARIABLES.                                        01790000
017901     05  PV-TOT-RC119-PRCD-QTY           PIC   9(09) VALUE ZEROS. 01790120
017902     05  PV-TOT-RC119-FILE-QTY           PIC   9(09) VALUE ZEROS. 01790220
017903     05  PV-RESTART-QTY                  PIC  S9(9) COMP          01790318
017904                                                    VALUE ZEROES. 01790418
017905     05  PV-BYPASS-COUNT                 PIC  9(09) COMP          01790518
017906                                                    VALUE ZEROES. 01790618
017910     05  PV-INPUT-COUNT                  PIC  9(09) VALUE ZEROES. 01791002
017920     05  PV-RCRD119-COUNT                PIC  9(09) VALUE ZEROES. 01792017
017921     05  PV-RCRD095-COUNT                PIC  9(09) VALUE ZEROES. 01792117
017922     05  PV-COMMIT-COUNT                 PIC  9(09) VALUE ZEROES. 01792217
017930     05  PV-DISP-COUNT                   PIC  ZZZ,ZZZ,ZZ9.        01793023
017940     05  PV-DISP-PARM-QTY                PIC  ZZZ,ZZZ,ZZ9.        01794023
017970                                                                  01797002
017980     05  PV-PREV-KOHLS-PO-NBR            PIC  9(08).              01798002
017990     05  PV-PREV-STORE-SUPPORT-DC-NBR    PIC  9(04).              01799002
017991     05  PV-PREV-SHIP-SCAC               PIC  X(04).              01799102
017992     05  PV-PREV-SHIP-VEH-NBR            PIC  X(10).              01799202
017993     05  PV-PREV-SHIP-BOL-NBR            PIC  X(30).              01799302
017994     05  PV-PREV-COMMIT-RECORD-NBR       PIC  9(06).              01799404
017995                                                                  01799504
018000     05  PV-DISP-PO                      PIC  9(09).              01800000
018100     05  PV-DISP-LINE                    PIC  9(04).              01810000
018200     05  PV-DISP-RCVR                    PIC  9(04).              01820000
018300     05  PV-DISP-STR                     PIC  9(04).              01830000
018500     05  PV-DISP-SQLCODE                 PIC -9(03) VALUE ZEROES. 01850000
018700     05  PV-DISP-VE-PO-NBR               PIC  9(09).              01870000
018800     05  PV-DISP-VE-RCVR-NBR             PIC  9(04).              01880000
018900     05  PV-DISP-VE-OPER-UNT             PIC  9(04).              01890000
019000     05  PV-DISP-VE-FCLTY-ID             PIC  9(04).              01900000
019100     05  PV-DISP-VE-LINE-NBR             PIC  9(04).              01910000
019200     05  PV-DISP-LAST-RCVR               PIC  9(04).              01920000
019300     05  PV-DISP-NEW-RCVR                PIC  9(04).              01930000
020500                                                                  02050000
020600     05  PV-DISP-RECDIS-OPER             PIC  Z(04).              02060000
020700     05  PV-DISP-RECDIS-PO-NBR           PIC  Z(09).              02070000
020800     05  PV-DISP-RECDIS-REC-SEQ-NBR      PIC  Z(04).              02080000
020900     05  PV-DISP-RECDIS-TRN-LNE-NBR      PIC  Z(04).              02090000
021000     05  PV-DISP-RECDIS-STR-NBR          PIC  Z(04).              02100000
021100     05  PV-DISP-RECITM-OPER-UNT-ID      PIC  Z(04).              02110000
021200     05  PV-DISP-RECITM-FCLTY-ID         PIC  Z(04).              02120000
021300     05  PV-DISP-RECITM-ORD-NBR          PIC  Z(09).              02130000
021400     05  PV-DISP-RECITM-REC-SEQ-NBR      PIC  Z(04).              02140000
021500     05  PV-DISP-RECITM-ORD-LNE-NBR      PIC  Z(04).              02150000
021600     05  PV-DISP-RECITM-PKSL-QTY         PIC  ZZZ,ZZZ,ZZ9.        02160000
021700     05  PV-DISP-RECITM-ODD-QTY          PIC  ZZZ,ZZZ,ZZ9.        02170000
021800     05  PV-DISP-PV-RECITM-ODD-QTY       PIC  ZZZ,ZZZ,ZZ9.        02180000
021900     05  PV-DISP-SHIP-UNT-QTY            PIC  ZZZ,ZZZ,ZZ9.        02190000
022000                                                                  02200000
022100     05  PV-DISP-ORIG-PKSL               PIC  Z(04).              02210000
022200     05  PV-DISP-NEW-PKSL                PIC  Z(04).              02220000
022300     05  PV-DISP-PKITEM-PO               PIC  Z(09).              02230000
022400     05  PV-DISP-PKITEM-SEQ              PIC  Z(04).              02240000
022500     05  PV-DISP-PKITEM-LINE             PIC  Z(04).              02250000
022800     05  PV-LAST-REC-SEQ-NBR             PIC S9(09) COMP          02280000
022900                                                    VALUE ZEROES. 02290000
023000     05  PV-NEW-REC-SEQ-NBR              PIC S9(09) COMP          02300000
023100                                                    VALUE ZEROES. 02310000
023200     05  PV-MAX-SEQ-NBR                  PIC S9(04) VALUE +0      02320000
023300                                                 COMP.            02330000
023400     05  PV-NEW-PKSLIP-SEQ-NBR           PIC S9(04) VALUE +0      02340000
023500                                                 COMP.            02350000
023600     05  PV-ORIG-PKSLIP-SEQ-NBR          PIC S9(04) VALUE +0      02360000
023700                                                 COMP.            02370000
023800                                                                  02380000
023900     05  PV-DB2-TMST                     PIC  X(26).              02390000
024000     05  PV-DB2-TMST-REDEF  REDEFINES  PV-DB2-TMST.               02400000
024100         10  FILLER                      PIC  X(17).              02410002
025100         10  PV-DB2-TMST-SS              PIC  X(02).              02510000
025200             88  PV-DB2-TMST-SS-01                   VALUE '01'.  02520000
025300         10  FILLER                      PIC  X(01).              02530000
025400         10  PV-DB2-TMST-MS              PIC  X(06).              02540000
025500             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  02550000
025600                                                                  02560000
025700     05  PV-TICKET-DESC                  PIC  X(20) VALUE SPACE.  02570000
025800     05  PV-TKT-FMT-ID                   PIC  X(06) VALUE SPACE.  02580000
026100     05  PV-PKSL-ITM-UPD-QTY             PIC S9(09) COMP.         02610000
026200     05  PV-DTL-CK-ITM-QTY               PIC S9(09) COMP.         02620000
026300     05  PV-EXPTED-ITM-UPD-QTY           PIC S9(09) COMP.         02630000
026400     05  PV-VERIFY-ITM-UPD-QTY           PIC S9(09) COMP.         02640000
026500     05  PV-AP-VERIFY-ITM-UPD-QTY        PIC S9(09) COMP.         02650000
026600     05  PV-RECITM-ORIG-PKSL-ITM-QTY     PIC S9(09) COMP.         02660000
026700     05  PV-RECITM-PKSL-ITM-QTY          PIC S9(09) COMP.         02670000
026800     05  PV-RECITM-PREPK-ODD-UNT-QTY     PIC S9(09) COMP.         02680000
027000     05  PV-TRN-LNE-NBR                  PIC S9(09) COMP.         02700000
027100     05  PV-HOLD-TRN-LNE-NBR             PIC S9(09) COMP.         02710000
027200     05  PV-OUTER-QTY                    PIC S9(04) COMP.         02720000
027300     05  PV-PREV-STR                     PIC  9(04) VALUE ZEROES. 02730000
027400     05  PV-PREV-PKSL-PO                 PIC  9(09).              02740000
027500     05  PV-PREV-PKSL-SML                PIC  9(18).              02750000
027600     05  PV-PREV-SML                     PIC  X(20).              02760000
027700     05  PV-LINE-TABLE-ROWS          PIC  9(04)  VALUE ZEROS.     02770011
029800     05  PV-SML-BARCODE              PIC  X(18).                  02980000
031700     05  PV-VE-OPER-UNT-ID           PIC S9(04) COMP.             03170000
031800     05  PV-VE-FCLTY-ID              PIC S9(04) COMP.             03180000
031900     05  PV-VE-PO-NBR                PIC S9(09) COMP.             03190000
032000     05  PV-VE-RCVR-NBR              PIC S9(09) COMP.             03200000
032100     05  PV-VE-LNE-NBR               PIC S9(09) COMP.             03210000
032200     05  PV-VE-STATUS                PIC  X(02) VALUE SPACE.      03220000
032300     05  PV-VE-RCVR-CARTON-CNT       PIC  9(04) VALUE ZEROES.     03230000
032400     05  PV-VE-PREPK-ODD-UNT-QTY     PIC S9(04) COMP.             03240000
032700     05  PV-VE-CARTON-LINE-ODD-UNITS PIC  9(09) VALUE ZEROES.     03270000
032900     05  PV-SHIP-UNT-QTY             PIC  S9(9) COMP.             03290000
032910*    05  PV-LEAST-NBR-OF-PKS         PIC  9(04) VALUE ZEROES.     03291002
032920*    05  PV-ODD-PACKS                PIC  9(04) VALUE ZEROES.     03292002
032930*    05  PV-ODD-PACKS-UNITS          PIC  9(09) VALUE ZEROES.     03293002
033000                                                                  03300000
033100                                                                  03310000
033200*----------------------------------------------------------------*03320000
033300* VALID LINES FOR A GIVEN PO-LINE FOR PREPACK VALIDATION         *03330000
033400*----------------------------------------------------------------*03340000
033500 01 TBL-VALID-LINES.                                              03350000
033600    05 TBL-VALID-LINE-ENTRY     OCCURS  1500 TIMES                03360000
033700                                INDEXED BY LINE-INX.              03370000
033800       10 TBL-LINE-NBR          PIC 9(04).                        03380000
033900       10 TBL-RATIO             PIC 9(04).                        03390000
034000       10 TBL-PACKS             PIC 9(04).                        03400000
034100       10 TBL-ODD-UNITS         PIC 9(09).                        03410000
034200       10 TBL-RECEIVED          PIC X(01).                        03420000
034300          88  TBL-RECEIVED-NO       VALUE 'N'.                    03430000
034400          88  TBL-RECEIVED-YES      VALUE 'Y'.                    03440000
034500                                                                  03450000
034600*---------------------------------------------------------------* 03460000
034700* DB2 AREA FOR THE RECEIVER TABLE                                 03470000
034800*---------------------------------------------------------------* 03480000
034900     EXEC SQL                                                     03490000
035000          INCLUDE TRECEIV                                         03500000
035100     END-EXEC.                                                    03510000
035200                                                                  03520000
035300*---------------------------------------------------------------* 03530000
035400* DB2 AREA FOR THE RECEIVER ITEM TABLE                            03540000
035500*---------------------------------------------------------------* 03550000
035600     EXEC SQL                                                     03560000
035700          INCLUDE TRECITM                                         03570000
035800     END-EXEC.                                                    03580000
035900                                                                  03590000
036000*---------------------------------------------------------------* 03600000
036100* DB2 AREA FOR THE RECEIVER DISTRIBUTION TABLE                    03610000
036200*---------------------------------------------------------------* 03620000
036300     EXEC SQL                                                     03630000
036400          INCLUDE TRECDIS                                         03640000
036500     END-EXEC.                                                    03650000
036600                                                                  03660000
036700*---------------------------------------------------------------* 03670000
036800* DB2 AREA FOR THE PACKSLIP TABLE                                 03680000
036900*---------------------------------------------------------------* 03690000
037000     EXEC SQL                                                     03700000
037100          INCLUDE TPKSLIP                                         03710000
037200     END-EXEC.                                                    03720000
037300                                                                  03730000
037400*---------------------------------------------------------------* 03740000
037500* DB2 AREA FOR THE PACKSLIP ITEM TABLE                            03750000
037600*---------------------------------------------------------------* 03760000
037700     EXEC SQL                                                     03770000
037800          INCLUDE TPKITEM                                         03780000
037900     END-EXEC.                                                    03790000
038000                                                                  03800000
038100*---------------------------------------------------------------* 03810000
038200*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 03820000
038300*---------------------------------------------------------------* 03830000
038400     EXEC SQL                                                     03840000
038500          INCLUDE TPURCHS                                         03850000
038600     END-EXEC.                                                    03860000
038700                                                                  03870000
038800*---------------------------------------------------------------* 03880000
038900*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 03890000
039000*---------------------------------------------------------------* 03900000
039100     EXEC SQL                                                     03910000
039200          INCLUDE TPURITM                                         03920000
039300     END-EXEC.                                                    03930000
039400                                                                  03940000
039500*---------------------------------------------------------------* 03950000
039600*    OUTBOUND CARTON - SUT_OTBND_CART                           * 03960000
039700*---------------------------------------------------------------* 03970000
039800     EXEC SQL                                                     03980000
039900          INCLUDE SUT00024                                        03990000
040000     END-EXEC.                                                    04000000
040100                                                                  04010000
040200*---------------------------------------------------------------* 04020000
040300*    OUTBOUND UPC - SUT_OTBND_UPC                               * 04030000
040400*---------------------------------------------------------------* 04040000
040500     EXEC SQL                                                     04050000
040600          INCLUDE SUT00028                                        04060000
040700     END-EXEC.                                                    04070000
040800                                                                  04080000
040900*---------------------------------------------------------------* 04090000
041000*    OUTBOUND LOCATION - SUT_OTBND_LOC                          * 04100000
041100*---------------------------------------------------------------* 04110000
041200     EXEC SQL                                                     04120000
041300          INCLUDE SUT00027                                        04130000
041400     END-EXEC.                                                    04140000
041500                                                                  04150000
041600*---------------------------------------------------------------* 04160000
041700*    PRE-TICKET - LINE                                          * 04170000
041800*---------------------------------------------------------------* 04180000
041900     EXEC SQL                                                     04190000
042000          INCLUDE TPTKLNE                                         04200000
042100     END-EXEC.                                                    04210000
042200                                                                  04220000
042300*---------------------------------------------------------------* 04230000
042400*    PRE-TICKET - REQUEST                                       * 04240000
042500*---------------------------------------------------------------* 04250000
042600     EXEC SQL                                                     04260000
042700          INCLUDE TPTKREQ                                         04270000
042800     END-EXEC.                                                    04280000
042900                                                                  04290000
043000*---------------------------------------------------------------* 04300000
043100*  TICKET FORMAT                                                * 04310000
043200*---------------------------------------------------------------* 04320000
043300     EXEC SQL                                                     04330000
043400          INCLUDE TTKTFMT                                         04340000
043500     END-EXEC.                                                    04350000
043600                                                                  04360000
043700*---------------------------------------------------------------* 04370000
043800*  PARM TABLE                                                   * 04380000
043900*---------------------------------------------------------------* 04390000
044000     EXEC SQL                                                     04400000
044100          INCLUDE TKRPRPM                                         04410000
044200     END-EXEC.                                                    04420000
044300                                                                  04430000
044400*---------------------------------------------------------------* 04440000
044500*  RCT_VRFD_ODD_UNT                                             * 04450000
044600*---------------------------------------------------------------* 04460000
044700     EXEC SQL                                                     04470000
044800          INCLUDE RCT00009                                        04480000
044900     END-EXEC.                                                    04490000
045000                                                                  04500000
045100*---------------------------------------------------------------* 04510000
045200*  COMMUNICATIONS AREA FOR DB2                                    04520000
045300*---------------------------------------------------------------* 04530000
045400     EXEC SQL                                                     04540000
045500         INCLUDE SQLCA                                            04550000
045600     END-EXEC.                                                    04560000
045700                                                                  04570000
045800*---------------------------------------------------------------* 04580000
045900*  SQL COMMUNICATIONS WORK AREA                                  *04590000
046000*---------------------------------------------------------------* 04600000
046100*    COPY SQLCA2.                                                 04610008
046200                                                                  04620000
046300                                                                  04630000
046400*----------------------------------------------------------------*04640000
046500*  CURSOR TO SELECT THE LINE(S), LINE NUMBER, PREPACK ID        * 04650000
046600*  AND SHIPPED QUANTITY                                         * 04660000
046700*---------------------------------------------------------------* 04670000
046800*                                                                 04680000
046900*    EXEC SQL                                                     04690000
047000*         DECLARE PREPK-CSR CURSOR FOR                            04700000
047100*         SELECT D.PREPK_ID                                       04710000
047200*               ,D.PREPK_RATO_QTY                                 04720000
047300*               ,A.SHPD_QTY                                       04730000
047400*         FROM   TSHUUPC A                                        04740000
047500*              , TINPKSU B                                        04750000
047600*              , TPKSLIP C                                        04760000
047700*              , TRECITM D                                        04770000
047800*         WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 04780000
047900*         AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    04790000
048000*         AND  B.PO_NBR       = C.PO_NBR                          04800000
048100*         AND  B.SEQ_NBR      = C.SEQ_NBR                         04810000
048200*         AND  C.VER_STAT_CDE = 'A'                               04820000
048300*         AND  C.PO_NBR       = D.ORD_NBR                         04830000
048400*         AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     04840000
048500*         AND  C.REC_SEQ_NBR  = :PV-NEW-REC-SEQ-NBR               04850000
048600*         AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     04860000
048700*        WITH UR                                                  04870000
048800*    END-EXEC.                                                    04880000
048900*                                                                 04890000
049000*---------------------------------------------------------------* 04900000
049100*  PREPK-LINE-CURSOR                                              04910000
049200*---------------------------------------------------------------* 04920000
049300                                                                  04930000
049400     EXEC SQL                                                     04940000
049500          DECLARE PREPK-LINE-CSR CURSOR FOR                       04950000
049600           SELECT PO_LNE_NBR                                      04960000
049700                 ,PREPK_RATO_QTY                                  04970000
049800             FROM TPURITM                                         04980000
049900            WHERE PO_NBR        =  :DK-PO-NBR                     04990000
050000              AND PO_PREPK_ID   =  :DK-PREPK-ID                   05000000
050100            ORDER BY 1                                            05010000
050200            WITH UR                                               05020000
050300     END-EXEC.                                                    05030000
050400                                                                  05040000
050500*---------------------------------------------------------------* 05050000
050600*  SSCC LINE CURSOR FOR PREPACK ODD UNIT CHECK                    05060000
050700*---------------------------------------------------------------* 05070000
050800*    EXEC SQL                                                     05080000
050900*         DECLARE SSCC-LINE-CSR CURSOR FOR                        05090000
051000*          SELECT DISTINCT UPC_NBR                                05100000
051100*                        , TRN_LNE_NBR                            05110000
051200*                        , SUM(SHPD_QTY)                          05120000
051300*            FROM TSHUUPC                                         05130000
051400*           WHERE SHIPT_UNT_ID =   :DK-SHIPT-UNT-ID               05140000
051500*           GROUP BY UPC_NBR                                      05150000
051600*                  , TRN_LNE_NBR                                  05160000
051700*           WITH UR                                               05170000
051800*    END-EXEC.                                                    05180000
051900*                                                                 05190000
052000*----------------------------------------------------------------*05200000
052100*  CURSOR USED TO VERIFY LINES ON THE RECEIVER                  * 05210000
052200*---------------------------------------------------------------* 05220000
052300                                                                  05230000
052400     EXEC SQL                                                     05240000
052500          DECLARE PO-RCVR-VE-CSR CURSOR FOR                       05250000
052600          SELECT                                                  05260000
052700                 A.OPER_UNT_ID                                    05270000
052800               , A.FCLTY_ID                                       05280000
052900               , B.ORD_LNE_NBR                                    05290000
053000               , A.STATUS_CDE                                     05300000
053100               , B.PREPK_ODD_UNT_QTY                              05310000
053200          FROM   TRECEIV A                                        05320000
053300               , TRECITM B                                        05330000
053400          WHERE                                                   05340000
053500                A.ORD_NBR         = :PV-VE-PO-NBR                 05350000
053600            AND A.REC_SEQ_NBR     = :PV-VE-RCVR-NBR               05360000
053700            AND A.ORD_NBR         =  B.ORD_NBR                    05370000
053800            AND A.REC_SEQ_NBR     =  B.REC_SEQ_NBR                05380000
053900            AND A.VER_STATUS_CDE  = 'A'                           05390000
054000            AND B.VER_STATUS_CDE  = 'A'                           05400000
054100            AND NOT A.STATUS_CDE  = 'VE'                          05410000
054200            AND NOT B.STATUS_CDE  = 'VE'                          05420000
054300     END-EXEC.                                                    05430000
054400                                                                  05440000
057000                                                                  05700000
057100*----------------------------------------------------------------*05710000
057200 PROCEDURE DIVISION.                                              05720000
057300*----------------------------------------------------------------*05730000
057400 0000-PROGRAM-MAINLINE.                                           05740000
057500                                                                  05750000
057600     DISPLAY '******************************'.                    05760000
057700     DISPLAY '*                            *'.                    05770000
057800     DISPLAY '* RCKUP075 - BEGIN           *'.                    05780000
057900     DISPLAY '*                            *'.                    05790000
058000     DISPLAY '******************************'.                    05800000
058100                                                                  05810000
058200     OPEN INPUT  THIRD-PARTY-OTBND-FILE                           05820002
058210          OUTPUT OUT-PO-STR-SSCC-FILE                             05821002
058300                 OUT-PO-RCVR-OPER-SSCC-FILE.                      05830000
058400                                                                  05840000
058401     SET  PS-TEST-ONLY-DISPLAY-NO  TO TRUE.                       05840102
058402     PERFORM 0050-CHECK-DISPLAY-PARM.                             05840202
058404                                                                  05840402
058405*                                                                 05840502
058410* CHECK TO SEE IF THIS IS A RESTART RUN.  IF PARM VALUE IS        05841002
058420* GREATER THEN 0 IT IS A RESTART - READ INPUT X TIMES.            05842002
058500*                                                                 05850002
058600     PERFORM 7200-CHECK-RESTART.                                  05860002
058601                                                                  05860102
058602     IF  PV-RESTART-QTY  >  0                                     05860202
058604         PERFORM 7010-READ-RESTART                                05860402
058605           UNTIL PV-BYPASS-COUNT  = PV-RESTART-QTY                05860502
058606              OR PS-EOF-YES                                       05860602
058607              OR PS-ERROR-YES                                     05860702
058608     ELSE                                                         05860804
058609         PERFORM 7000-READ-INPUT                                  05860904
058610     END-IF.                                                      05861002
058800                                                                  05880000
059300     PERFORM 1000-INITIAL-PROCESS.                                05930002
059500                                                                  05950000
059600     PERFORM 2000-PROCESS-FILE                                    05960000
059800       UNTIL PS-EOF-YES                                           05980010
059810          OR PS-ERROR-YES.                                        05981002
059900                                                                  05990000
059910     IF  PS-ERROR-NO                                              05991012
060000         IF  PV-RCRD119-COUNT  >  0                               06000017
060100             PERFORM 3000-PO-STORE-BREAK                          06010012
060200         END-IF                                                   06020012
060210     END-IF.                                                      06021012
060300                                                                  06030000
060400*                                                                 06040002
060410*    RESET RESTART PARM = 0                                       06041002
060420*                                                                 06042002
060430     IF  PS-ERROR-NO                                              06043012
060600         PERFORM 7210-RESET-RESTART                               06060012
060601         PERFORM 8200-COMMIT-DB2                                  06060125
060610     END-IF.                                                      06061012
060700                                                                  06070000
060800     PERFORM 9000-DISPLAY-TOTALS.                                 06080000
060900                                                                  06090000
061000     CLOSE  THIRD-PARTY-OTBND-FILE                                06100002
061100            OUT-PO-STR-SSCC-FILE                                  06110002
061200            OUT-PO-RCVR-OPER-SSCC-FILE.                           06120000
061300                                                                  06130000
061400     GOBACK.                                                      06140000
061500                                                                  06150000
061600                                                                  06160000
061700*----------------------------------------------------------------*06170000
061800* PARM USED TO DISPLAY PARAGRAPH TRACKING                        *06180000
061900*----------------------------------------------------------------*06190000
062000 0050-CHECK-DISPLAY-PARM.                                         06200000
062100                                                                  06210000
062200     EXEC SQL                                                     06220000
062300          SELECT FUNC_TXT                                         06230000
062400            INTO :PS-TEST-ONLY-DISPLAY-SW                         06240000
062500            FROM TKRPRPM                                          06250000
062600           WHERE LOC_ID             = :PC-90                      06260000
062700             AND INTFC_SYS_CDE      = :PC-KHL                     06270000
062800             AND SYS_PRC_FUNC_CDE   = 'RC072D'                    06280000
062900             AND FUNC_PRC_STAT_CDE  = :PC-AC                      06290000
063000             AND FUNC_BEG_TMST     <= CURRENT TIMESTAMP           06300000
063100             AND FUNC_END_TMST     >= CURRENT TIMESTAMP           06310000
063200            WITH UR                                               06320000
063300     END-EXEC.                                                    06330000
063400                                                                  06340000
063500     EVALUATE TRUE                                                06350000
063600         WHEN SQLCODE = +0                                        06360000
063700              CONTINUE                                            06370000
063800                                                                  06380000
063900         WHEN SQLCODE = +100                                      06390000
064000              SET  PS-TEST-ONLY-DISPLAY-NO  TO  TRUE              06400000
064100                                                                  06410000
064200         WHEN SQLWARN0 NOT = SPACES                               06420000
064300         WHEN SQLCODE < +0                                        06430000
064400         WHEN SQLCODE > +0                                        06440000
064500                                                                  06450000
064600              SET  PS-ERROR-YES         TO TRUE                   06460000
064700                                                                  06470000
064800              MOVE SQLCODE              TO PV-DISP-SQLCODE        06480000
064900              DISPLAY  ' RCKUP075-0050-'                          06490000
065000                       ' SQL:'             PV-DISP-SQLCODE        06500000
065100                       ' PO:'              RC119-KOHLS-PO-NBR     06510000
065200                       ' STR:'             RC119-DEST-STORE-NBR   06520000
065300                       ' SSCC:'                                   06530000
065400              DISPLAY  ' RCKUP075-0050-'                          06540000
065500                       ' SML:'             RC119-SML-NBR-NUM      06550000
065600                                                                  06560000
065700              DISPLAY '*****************************************' 06570000
065800              DISPLAY '*ABEND                                  *' 06580000
065900              DISPLAY '*PROGRAM   = RCKUP075                   *' 06590000
066000              DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM          *' 06600000
066100              DISPLAY '*PARAGRAPH = 0050-CHECK-DISPLAY-PARM    *' 06610000
066200              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               06620000
066300              DISPLAY '*PARM:       RC064D'                       06630000
066400              DISPLAY '*****************************************' 06640000
066500              PERFORM 9100-SQL-ABEND                              06650000
066600     END-EVALUATE.                                                06660000
066700                                                                  06670000
066800                                                                  06680000
066900*----------------------------------------------------------------*06690000
067000* FIRST RECORD PROCESS                                           *06700000
067100* - SELECT THE PO INFORMATION                                    *06710000
067200* - CREATE NEW RECEIVER FOR PO-STORE                             *06720000
067300* - GET THE ORIGINAL PACKSLIP INFORMATION FOR THE CARTON         *06730000
067400* - CREATE THE NEW PACKSLIP                                      *06740000
067500*----------------------------------------------------------------*06750000
067600 1000-INITIAL-PROCESS.                                            06760000
067700     IF  PS-TEST-ONLY-DISPLAY-YES                                 06770000
067800         DISPLAY ' RCKUP075 - 1000-INITIAL-PROCESS'               06780000
067900     END-IF.                                                      06790000
068000                                                                  06800000
068400     MOVE RC119-KOHLS-PO-NBR                                      06840000
068500                         TO  PV-PREV-KOHLS-PO-NBR                 06850004
068600     MOVE RC119-STORE-SUPPORT-DC-NBR                              06860000
068700                         TO  PV-PREV-STORE-SUPPORT-DC-NBR         06870004
068800     MOVE RC119-SHIP-SCAC                                         06880000
068900                         TO  PV-PREV-SHIP-SCAC                    06890004
069000     MOVE RC119-SHIP-VEH-NBR                                      06900000
069100                         TO  PV-PREV-SHIP-VEH-NBR                 06910004
069200     MOVE RC119-SHIP-BOL-NBR                                      06920000
069300                         TO  PV-PREV-SHIP-BOL-NBR                 06930004
069400                                                                  06940000
069500     PERFORM 3200-GET-PO-INFORMATION.                             06950000
069600                                                                  06960000
069700     IF  PS-ERROR-NO                                              06970000
069800         PERFORM 4000-CREATE-RECEIVER                             06980000
069900     END-IF.                                                      06990000
070000                                                                  07000000
070100     IF  PS-ERROR-NO                                              07010000
070200         PERFORM 4010-CREATE-NEW-PKSLIP                           07020000
070300     END-IF.                                                      07030000
070400                                                                  07040000
070500     SET  PS-FIRST-RECORD     TO  TRUE.                           07050000
070600                                                                  07060000
070700                                                                  07070000
070800*----------------------------------------------------------------*07080000
070900*                                                                *07090000
071000*----------------------------------------------------------------*07100000
071100 2000-PROCESS-FILE.                                               07110000
071200     IF  PS-TEST-ONLY-DISPLAY-YES                                 07120000
071300         DISPLAY ' RCKUP075 - 2000-PROCESS-FILE   '               07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
071600     ADD RC119-SHIP-UNT-QTY   TO PV-TOT-RC119-PRCD-QTY.           07160018
071700                                                                  07170018
072000     IF  PV-PREV-KOHLS-PO-NBR = RC119-KOHLS-PO-NBR AND            07200000
072100         PV-PREV-STORE-SUPPORT-DC-NBR                             07210000
072200                            = RC119-STORE-SUPPORT-DC-NBR AND      07220000
072300         PV-PREV-STR        = RC119-DEST-STORE-NBR                07230000
072400                                                                  07240000
072500         CONTINUE                                                 07250000
072600     ELSE                                                         07260000
072700       IF  PS-PBS                                                 07270000
072800           PERFORM 3000-PO-STORE-BREAK                            07280000
072900       ELSE                                                       07290000
073300         IF  (PV-PREV-KOHLS-PO-NBR NOT = RC119-KOHLS-PO-NBR)  OR  07330000
073400             (PV-PREV-STORE-SUPPORT-DC-NBR NOT =                  07340000
073500                                 RC119-STORE-SUPPORT-DC-NBR)      07350000
073600             PERFORM 3000-PO-STORE-BREAK                          07360000
073700         END-IF                                                   07370000
073800       END-IF                                                     07380000
073900     END-IF.                                                      07390000
074000                                                                  07400000
074100     SET  PS-FIRST-RECORD-NO  TO  TRUE                            07410000
074200                                                                  07420000
074300     PERFORM 2010-LINK-CRTN-PKSLIP.                               07430000
074400                                                                  07440000
075600     PERFORM 7000-READ-INPUT.                                     07560000
075700                                                                  07570000
075800                                                                  07580000
075900*----------------------------------------------------------------*07590000
076000* ADD THE CARTON TO THE NEW PACKSLIP                             *07600000
076100* - UPDATE TPKITEM FOR THE NEW PACKSLIP CARTON IS MOVING TO      *07610000
076200*   IT TPKITEM DOES NOT EXIST - WILL INSERT NEW ROW              *07620000
076300* - INSERT SUT_OTBND_CART                                        *07630000
076400* - INSERT SUT_OTBND_UPC                                         *07640000
076500* - INSERT SUT_OTBND_LOC                                         *07650000
076600*----------------------------------------------------------------*07660000
076700 2010-LINK-CRTN-PKSLIP.                                           07670000
076800     IF  PS-TEST-ONLY-DISPLAY-YES                                 07680000
076900         DISPLAY ' RCKUP075 - 2010-LINK-CRTN-PKSLIP'              07690000
077000                 ' RCKUP075 - 2010-'                              07700000
077100                 ' RCVR TYPE:'  PS-PACKAGING-TYPE-SW              07710000
077200     END-IF.                                                      07720000
077300                                                                  07730000
077400     MOVE RC119-SML-NBR-NUM    TO  DK-SHIPT-UNT-ID.               07740000
077500                                                                  07750000
077600     IF  RC119-KOHLS-PO-NBR  =  PV-PREV-PKSL-PO  AND              07760000
077700         RC119-SML-NBR-NUM   =  PV-PREV-PKSL-SML                  07770000
077800         CONTINUE                                                 07780000
077900     ELSE                                                         07790000
078000         ADD  1  TO   PV-VE-RCVR-CARTON-CNT                       07800000
078100         MOVE RC119-KOHLS-PO-NBR  TO  PV-PREV-PKSL-PO             07810000
078200         MOVE RC119-SML-NBR-NUM   TO  PV-PREV-PKSL-SML            07820000
078300     END-IF.                                                      07830000
078400                                                                  07840000
078500     SET  PS-FIRST-PKSLIP-LINE                                    07850000
078600          PS-UPDATE-TPKITEM-NO                                    07860000
078700          PS-NEW-RECITM-NOT-FOUND TO TRUE.                        07870000
078800                                                                  07880000
078900     PERFORM 3500-PRCESS-PKSLIP-LINK.                             07890000
079000                                                                  07900000
079100     PERFORM 6500-CREATE-SML.                                     07910000
079200                                                                  07920000
079300     PERFORM 7100-WRITE-OUTPUT.                                   07930000
079400     PERFORM 7110-WRITE-OUTPUT2.                                  07940000
079500                                                                  07950000
079600                                                                  07960000
079700*----------------------------------------------------------------*07970000
079800* PO STORE BREAK                                                 *07980000
079900*  -  VERIFY PREVIOUS PO-STORE RECEIVER                          *07990000
080000*  -  COMMIT                                                     *08000000
080100*  -  CREATE NEW PO-STORE RECIEVER                               *08010000
080200*  -  CREATE NEW PACKSLIP                                        *08020000
080300*----------------------------------------------------------------*08030000
080400 3000-PO-STORE-BREAK.                                             08040000
080500     IF  PS-TEST-ONLY-DISPLAY-YES                                 08050000
080600         DISPLAY ' RCKUP075 - 3000-PO-STORE-BREAK'                08060000
080700     END-IF.                                                      08070000
080800                                                                  08080000
080900     PERFORM 8000-VERIFY-PREV-RCVR.                               08090000
081000     PERFORM 7220-SET-COMMIT-RESTART.                             08100015
081110     PERFORM 8200-COMMIT-DB2.                                     08111003
081200                                                                  08120000
081300     IF  NOT PS-EOF-YES                                           08130003
081800         MOVE  RC119-KOHLS-PO-NBR                                 08180000
081900                                TO  PV-PREV-KOHLS-PO-NBR          08190000
082000         MOVE  RC119-STORE-SUPPORT-DC-NBR                         08200000
082100                                TO  PV-PREV-STORE-SUPPORT-DC-NBR  08210000
082200         MOVE  RC119-SHIP-SCAC                                    08220000
082300                                TO  PV-PREV-SHIP-SCAC             08230000
082400         MOVE  RC119-SHIP-VEH-NBR                                 08240000
082500                                TO  PV-PREV-SHIP-VEH-NBR          08250000
082600         MOVE  RC119-SHIP-BOL-NBR                                 08260000
082700                                TO  PV-PREV-SHIP-BOL-NBR          08270000
082800         MOVE  ZEROES           TO  PV-VE-RCVR-CARTON-CNT         08280000
082900                                                                  08290000
083000         PERFORM 3200-GET-PO-INFORMATION                          08300000
083100                                                                  08310000
083200         IF  PS-ERROR-NO                                          08320000
083300             PERFORM 4000-CREATE-RECEIVER                         08330000
083400         END-IF                                                   08340000
083500                                                                  08350000
083600         IF  PS-ERROR-NO                                          08360000
083700             PERFORM 4010-CREATE-NEW-PKSLIP                       08370000
083800         END-IF                                                   08380000
083900     END-IF.                                                      08390000
084000                                                                  08400000
084100                                                                  08410000
084200*----------------------------------------------------------------*08420000
084300* GET PO INFORMATION FOR NEW RECEIVER                            *08430000
084400*----------------------------------------------------------------*08440000
084500 3200-GET-PO-INFORMATION.                                         08450000
084600     IF  PS-TEST-ONLY-DISPLAY-YES                                 08460000
084700         DISPLAY ' RCKUP075 - 3200-GET-PO-INFORMATION'            08470000
084800     END-IF.                                                      08480000
084900                                                                  08490000
085000     MOVE RC119-KOHLS-PO-NBR TO DK-PO-NBR.                        08500000
085100     EXEC SQL                                                     08510000
085200          SELECT PKGNG_CDE                                        08520000
085300               , VER_NBR                                          08530000
085400            INTO :PURCHS-PKGNG-CDE                                08540000
085500               , :PURCHS-VER-NBR                                  08550000
085600            FROM TPURCHS                                          08560000
085700           WHERE PO_NBR         = :DK-PO-NBR                      08570000
085800             AND VER_STATUS_CDE = 'A'                             08580000
085900     END-EXEC.                                                    08590000
086000                                                                  08600000
086100     EVALUATE TRUE                                                08610000
086200         WHEN SQLCODE = +0                                        08620000
086300              MOVE PURCHS-PKGNG-CDE TO RECEIV-PKGNG-CDE           08630000
086400                                                                  08640000
086500         WHEN SQLWARN0 NOT = SPACES                               08650000
086600         WHEN SQLCODE < +0                                        08660000
086700         WHEN SQLCODE > +0                                        08670000
086800                                                                  08680000
086900              SET  PS-ERROR-YES         TO TRUE                   08690000
087000                                                                  08700000
087100              MOVE SQLCODE              TO PV-DISP-SQLCODE        08710000
087200              DISPLAY  ' RCKUP075-3200-'                          08720000
087300                       ' SQL:'             PV-DISP-SQLCODE        08730000
087400                       ' PO:'              RC119-KOHLS-PO-NBR     08740000
087500                       ' STR:'             RC119-DEST-STORE-NBR   08750000
087600                       ' SSCC:'            RC119-SML-NBR-NUM      08760000
087700              DISPLAY  ' RCKUP075-3200-'                          08770000
087800                       ' SML:'             RC119-SML-NBR-NUM      08780000
087900                                                                  08790000
088000              DISPLAY '*****************************************' 08800000
088100              DISPLAY '*ABEND                                  *' 08810000
088200              DISPLAY '*PROGRAM   = RCKUP075                   *' 08820000
088300              DISPLAY '*DB2 OPER  = SELECT ON TPURCHS          *' 08830000
088400              DISPLAY '*PARAGRAPH = 3200-GET-PO-INFORMATION    *' 08840000
088500              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               08850000
088600              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            08860000
088700              DISPLAY '*****************************************' 08870000
088800              PERFORM 9100-SQL-ABEND                              08880000
088900     END-EVALUATE.                                                08890000
089000                                                                  08900000
089100                                                                  08910000
089200*----------------------------------------------------------------*08920000
089300* GET NEXT RECEIVER SEQUENCE NUMBER                              *08930000
089400*----------------------------------------------------------------*08940000
089500 3210-GET-NEXT-RCVR-SEQ.                                          08950000
089600     IF  PS-TEST-ONLY-DISPLAY-YES                                 08960000
089700         DISPLAY ' RCKUP075 - 3210-GET-NEXT-RCVR-SEQ'             08970000
089800     END-IF.                                                      08980000
089900                                                                  08990000
090000     MOVE RC119-KOHLS-PO-NBR   TO DK-PO-NBR.                      09000000
090100     MOVE RC119-DEST-STORE-NBR TO DK-STR-DEST-NBR.                09010000
090200                                                                  09020000
090300     EXEC SQL                                                     09030000
090400          SELECT MAX(REC_SEQ_NBR)                                 09040000
090500            INTO :PV-LAST-REC-SEQ-NBR                             09050000
090600            FROM TRECEIV                                          09060000
090700           WHERE ORD_NBR            = :DK-PO-NBR                  09070000
090800     END-EXEC                                                     09080000
090900                                                                  09090000
091000     EVALUATE TRUE                                                09100000
091100         WHEN SQLCODE = +0                                        09110000
091200              ADD  1  TO  PV-LAST-REC-SEQ-NBR                     09120000
091300                  GIVING  PV-NEW-REC-SEQ-NBR                      09130000
091400                                                                  09140000
091500         WHEN SQLCODE = +100                                      09150000
091600         WHEN SQLCODE = -305                                      09160000
091700              MOVE  0  TO  PV-LAST-REC-SEQ-NBR                    09170000
091800              MOVE  1  TO  PV-NEW-REC-SEQ-NBR                     09180000
091900                                                                  09190000
092000         WHEN SQLWARN0 NOT = SPACES                               09200000
092100         WHEN SQLCODE  NOT = ZERO                                 09210000
092200                                                                  09220000
092300              SET  PS-ERROR-YES         TO TRUE                   09230000
092400                                                                  09240000
092500              MOVE SQLCODE              TO PV-DISP-SQLCODE        09250000
092600              DISPLAY  ' RCKUP075-3210-'                          09260000
092700                       ' SQL:'             PV-DISP-SQLCODE        09270000
092800                       ' PO:'              RC119-KOHLS-PO-NBR     09280000
092900                       ' STR:'             RC119-DEST-STORE-NBR   09290000
093000                       ' SSCC:'            RC119-SML-NBR-NUM      09300000
093100              DISPLAY  ' RCKUP075-3210-'                          09310000
093200                       ' SML:'             RC119-SML-NBR-NUM      09320000
093300                                                                  09330000
093400              MOVE  PV-LAST-REC-SEQ-NBR TO PV-DISP-LAST-RCVR      09340000
093500              MOVE  PV-NEW-REC-SEQ-NBR  TO PV-DISP-NEW-RCVR       09350000
093600              DISPLAY ' RCKUP075 - 3210-'                         09360000
093700                      ' LAST:' PV-DISP-LAST-RCVR                  09370000
093800                      ' NEW:'  PV-DISP-NEW-RCVR                   09380000
093900              DISPLAY '*****************************************' 09390000
094000              DISPLAY '*ABEND                                  *' 09400000
094100              DISPLAY '*PROGRAM   = RCKUP075                   *' 09410000
094200              DISPLAY '*DB2 OPER  = SELECT ON TRECEIV          *' 09420000
094300              DISPLAY '*PARAGRAPH = 3210-GET-NEXT-RCVR-SEQ     *' 09430000
094400              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               09440000
094500              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            09450000
094600              DISPLAY '*****************************************' 09460000
094700             PERFORM 9100-SQL-ABEND                               09470000
094800     END-EVALUATE.                                                09480000
094900                                                                  09490000
095000     IF  PS-TEST-ONLY-DISPLAY-YES                                 09500000
095100         MOVE  PV-LAST-REC-SEQ-NBR TO PV-DISP-LAST-RCVR           09510000
095200         MOVE  PV-NEW-REC-SEQ-NBR  TO PV-DISP-NEW-RCVR            09520000
095300         DISPLAY ' RCKUP075 - 3210-'                              09530000
095400                 ' LAST:' PV-DISP-LAST-RCVR                       09540000
095500                 ' NEW:'  PV-DISP-NEW-RCVR                        09550000
095600     END-IF.                                                      09560000
095700                                                                  09570000
095800                                                                  09580000
095900*----------------------------------------------------------------*09590000
096000* CREATE THE NEW RECEIVER                                        *09600000
096100*----------------------------------------------------------------*09610000
096200 3220-CREATE-RECEIVER.                                            09620000
096300     IF  PS-TEST-ONLY-DISPLAY-YES                                 09630000
096400         DISPLAY ' RCKUP075 - 3220-CREATE-RECEIVER'               09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700     EXEC SQL                                                     09670000
096800          INSERT INTO TRECEIV                                     09680000
096900                 ( ORD_NBR                                        09690000
097000                  ,REC_SEQ_NBR                                    09700000
097100                  ,CRE_TMST                                       09710000
097200                  ,CRE_UID                                        09720000
097300                  ,PO_VER_NBR                                     09730000
097400                  ,OPER_UNT_ID                                    09740000
097500                  ,FCLTY_ID                                       09750000
097600                  ,STATUS_CDE                                     09760000
097700                  ,SYST_CRE_CDE                                   09770000
097800                  ,REC_TYP_CDE                                    09780000
097900                  ,VER_STATUS_CDE                                 09790000
098000                  ,PACK_BY_ST_IND                                 09800000
098100                  ,REC_TMST                                       09810000
098200                  ,EXPTED_CART_CNT                                09820000
098300                  ,ACTL_CART_CNT                                  09830000
098400                  ,EXPTED_ITM_QTY                                 09840000
098500                  ,ACTL_ITM_QTY                                   09850000
098600                  ,RCVR_NBR                                       09860000
098700                  ,ML_POST_TMST                                   09870000
098800                  ,FS_POST_TMST                                   09880000
098900                  ,PRE_TKT_IND                                    09890000
099000                  ,AD_INFO_DESC                                   09900000
099100                  ,IN_TRBL_TMST                                   09910000
099200                  ,IN_TRBL_MIN_CNT                                09920000
099300                  ,IN_TRBL_HOUR_CNT                               09930000
099400                  ,VERFYD_TMST                                    09940000
099500                  ,RCVG_CLERK_INIT_ID                             09950000
099600                  ,REFER_BACK_SEQ_NBR                             09960000
099700                  ,AP_PRC_CDE                                     09970000
099800                  ,AP_PRC_DTE                                     09980000
099900                  ,MIS_DIRECT_IND                                 09990000
100000                  ,IMPRT_IND                                      10000000
100100                  ,CRE_OPER_UNT_ID                                10010000
100200                  ,CRE_FCLTY_ID                                   10020000
100300                  ,CURR_OPER_UNT_ID                               10030000
100400                  ,CURR_FCLTY_ID                                  10040000
100500                  ,UPD_TMST                                       10050000
100600                  ,UPD_UID                                        10060000
100700                  ,UPD_PGM_ID                                     10070000
100800                  ,GOH_IND                                        10080000
100900                  ,MKNG_APRN_PRT_TMST                             10090000
101000                  ,AP_RVRSL_DTE                                   10100000
101100                  ,PKGNG_CDE                                      10110000
101200                  )                                               10120000
101300         VALUES ( :RECEIV-ORD-NBR                                 10130000
101400                 ,:RECEIV-REC-SEQ-NBR                             10140000
101500                 , CURRENT TIMESTAMP                              10150000
101600                 ,:RECEIV-CRE-UID                                 10160000
101700                 ,:RECEIV-PO-VER-NBR                              10170000
101800                 ,:RECEIV-OPER-UNT-ID                             10180000
101900                 ,:RECEIV-FCLTY-ID                                10190000
102000                 ,:RECEIV-STATUS-CDE                              10200000
102100                 ,:RECEIV-SYST-CRE-CDE                            10210000
102200                 ,:RECEIV-REC-TYP-CDE                             10220000
102300                 ,:RECEIV-VER-STATUS-CDE                          10230000
102400                 ,:RECEIV-PACK-BY-ST-IND                          10240000
102500                 , CURRENT TIMESTAMP                              10250000
102600                 ,:RECEIV-EXPTED-CART-CNT                         10260000
102700                 ,:RECEIV-ACTL-CART-CNT                           10270000
102800                 ,:RECEIV-EXPTED-ITM-QTY                          10280000
102900                 ,:RECEIV-ACTL-ITM-QTY                            10290000
103000                 ,:RECEIV-RCVR-NBR                                10300000
103100                 ,:RECEIV-ML-POST-TMST                            10310000
103200                 ,:RECEIV-FS-POST-TMST                            10320000
103300                 ,:RECEIV-PRE-TKT-IND                             10330000
103400                 ,:RECEIV-AD-INFO-DESC                            10340000
103500                 ,:RECEIV-IN-TRBL-TMST                            10350000
103600                 ,:RECEIV-IN-TRBL-MIN-CNT                         10360000
103700                 ,:RECEIV-IN-TRBL-HOUR-CNT                        10370000
103800                 ,:RECEIV-VERFYD-TMST                             10380000
103900                 ,:RECEIV-RCVG-CLERK-INIT-ID                      10390000
104000                 ,:RECEIV-REFER-BACK-SEQ-NBR                      10400000
104100                 ,:RECEIV-AP-PRC-CDE                              10410000
104200                 ,:RECEIV-AP-PRC-DTE                              10420000
104300                 ,:RECEIV-MIS-DIRECT-IND                          10430000
104400                 ,:RECEIV-IMPRT-IND                               10440000
104500                 ,:RECEIV-CRE-OPER-UNT-ID                         10450000
104600                 ,:RECEIV-CRE-FCLTY-ID                            10460000
104700                 ,:RECEIV-CURR-OPER-UNT-ID                        10470000
104800                 ,:RECEIV-CURR-FCLTY-ID                           10480000
104900                 , CURRENT TIMESTAMP                              10490000
105000                 ,:RECEIV-UPD-UID                                 10500000
105100                 ,:RECEIV-UPD-PGM-ID                              10510000
105200                 ,:RECEIV-GOH-IND                                 10520000
105300                 ,:RECEIV-MKNG-APRN-PRT-TMST                      10530000
105400                 ,:RECEIV-AP-PRC-DTE                              10540000
105500                 ,:RECEIV-PKGNG-CDE                               10550000
105600                 )                                                10560000
105700         END-EXEC                                                 10570000
105800                                                                  10580000
105900         EVALUATE TRUE                                            10590000
106000             WHEN SQLCODE = +0                                    10600000
106100                 CONTINUE                                         10610000
106200                                                                  10620000
106300             WHEN SQLWARN0 NOT = SPACE                            10630000
106400             WHEN SQLCODE < +0                                    10640000
106500             WHEN SQLCODE > +0                                    10650000
106600                                                                  10660000
106700              SET  PS-ERROR-YES         TO TRUE                   10670000
106800                                                                  10680000
106900              MOVE SQLCODE              TO PV-DISP-SQLCODE        10690000
107000              DISPLAY  ' RCKUP075-3220-'                          10700000
107100                       ' SQL:'             PV-DISP-SQLCODE        10710000
107200                       ' PO:'              RC119-KOHLS-PO-NBR     10720000
107300                       ' STR:'             RC119-DEST-STORE-NBR   10730000
107400                       ' SSCC:'            RC119-SML-NBR-NUM      10740000
107500              DISPLAY  ' RCKUP075-3220-'                          10750000
107600                       ' SML:'             RC119-SML-NBR-NUM      10760000
107700                       ' DC:'        RC119-STORE-SUPPORT-DC-NBR   10770000
107800                                                                  10780000
107900              DISPLAY '*****************************************' 10790000
108000              DISPLAY '*ABEND                                  *' 10800000
108100              DISPLAY '*PROGRAM   = RCKUP075                   *' 10810000
108200              DISPLAY '*DB2 OPER  = INSERT TO TRECEIV          *' 10820000
108300              DISPLAY '*PARAGRAPH = 3220-CREATE-RECEIVER       *' 10830000
108400              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               10840000
108500              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            10850000
108600              DISPLAY '*****************************************' 10860000
108700             PERFORM 9100-SQL-ABEND                               10870000
108800     END-EVALUATE.                                                10880000
108900                                                                  10890000
109000                                                                  10900000
109100*----------------------------------------------------------------*10910000
109200* GET THE NEXT PACKSLIP SEQUENCE NUMBER                          *10920000
109300*----------------------------------------------------------------*10930000
109400 3240-GET-NEXT-PKSLIP-SEQ.                                        10940000
109500     IF  PS-TEST-ONLY-DISPLAY-YES                                 10950000
109600         DISPLAY ' RCKUP075 - 3240-GET-NEXT-PKSLIP-SEQ'           10960000
109700     END-IF.                                                      10970000
109800                                                                  10980000
109900     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             10990000
110000     MOVE RC119-KOHLS-PO-NBR       TO PKSLIP-PO-NBR.              11000000
110100                                                                  11010000
110200     EXEC SQL                                                     11020000
110300          SELECT MAX(SEQ_NBR)                                     11030000
110400            INTO :PV-MAX-SEQ-NBR :DN-SEQ-NBR-IND                  11040000
110500            FROM TPKSLIP                                          11050000
110600           WHERE PO_NBR = :PKSLIP-PO-NBR                          11060000
110700     END-EXEC                                                     11070000
110800                                                                  11080000
110900     EVALUATE TRUE                                                11090000
111000         WHEN SQLCODE = +0                                        11100000
111100              IF  DN-SEQ-NBR-IND = -1                             11110000
111200                  MOVE +1          TO PV-NEW-PKSLIP-SEQ-NBR       11120000
111300              ELSE                                                11130000
111400                  COMPUTE PV-NEW-PKSLIP-SEQ-NBR                   11140000
111500                                          = PV-MAX-SEQ-NBR + 1    11150000
111600              END-IF                                              11160000
111700                                                                  11170000
111800         WHEN SQLCODE = +100                                      11180000
111900              MOVE +1          TO PV-NEW-PKSLIP-SEQ-NBR           11190000
112000                                                                  11200000
112100         WHEN SQLWARN0 NOT = SPACE                                11210000
112200         WHEN SQLCODE < +0                                        11220000
112300         WHEN SQLCODE > +0                                        11230000
112400                                                                  11240000
112500              SET  PS-ERROR-YES         TO TRUE                   11250000
112600                                                                  11260000
112700              MOVE SQLCODE              TO PV-DISP-SQLCODE        11270000
112800              DISPLAY  ' RCKUP075-3240-'                          11280000
112900                       ' SQL:'             PV-DISP-SQLCODE        11290000
113000                       ' PO:'              RC119-KOHLS-PO-NBR     11300000
113100                       ' STR:'             RC119-DEST-STORE-NBR   11310000
113200                       ' SSCC:'            RC119-SML-NBR-NUM      11320000
113300              DISPLAY  ' RCKUP075-3240-'                          11330000
113400                       ' SML:'             RC119-SML-NBR-NUM      11340000
113500                                                                  11350000
113600              DISPLAY '*****************************************' 11360000
113700              DISPLAY '*ABEND                                  *' 11370000
113800              DISPLAY '*PROGRAM   = RCKUP075                   *' 11380000
113900              DISPLAY '*DB2 OPER  = SELECT ON TPKSLIP          *' 11390000
114000              DISPLAY '*PARAGRAPH = 3240-GET-NEXT-PKSLIP-SEQ   *' 11400000
114100              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               11410000
114200              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            11420000
114300              DISPLAY '*****************************************' 11430000
114400             PERFORM 9100-SQL-ABEND                               11440000
114500     END-EVALUATE.                                                11450000
114600                                                                  11460000
114700     IF  PS-TEST-ONLY-DISPLAY-YES                                 11470000
114800         MOVE PV-NEW-PKSLIP-SEQ-NBR TO PV-DISP-NEW-PKSL           11480000
114900         DISPLAY ' RCKUP075 - 3240-GET-NEXT-PKSLIP-SEQ'           11490000
115000                 ' NEW PKSL:' PV-DISP-NEW-PKSL                    11500000
115100     END-IF.                                                      11510000
115200                                                                  11520000
115300                                                                  11530000
115400*----------------------------------------------------------------*11540000
115500* CREATE NEW PACKSLIP                                            *11550000
115600*----------------------------------------------------------------*11560000
115700 3250-CREATE-NEW-PACKSLIP.                                        11570000
115800     IF  PS-TEST-ONLY-DISPLAY-YES                                 11580000
115900         DISPLAY ' RCKUP075 - 3250-CREATE-NEW-PACKSLIP'           11590000
116000     END-IF.                                                      11600000
116100                                                                  11610000
116200     EXEC SQL                                                     11620000
116300          INSERT INTO TPKSLIP                                     11630000
116400                 (                                                11640000
116500                   PO_NBR                                         11650000
116600                 , SEQ_NBR                                        11660000
116700                 , CRE_TMST                                       11670000
116800                 , VER_STAT_CDE                                   11680000
116900                 , OPER_UNT_ID                                    11690000
117000                 , FCLTY_ID                                       11700000
117100                 , PKSL_NBR                                       11710000
117200                 , STR_DEST_NBR                                   11720000
117300                 , REC_SEQ_NBR                                    11730000
117400                 , SHIPT_ID                                       11740000
117500                 , BOL_NBR                                        11750000
117600                 , PRO_NBR                                        11760000
117700                 , PKSL_STAT_CDE                                  11770000
117800                 , CRE_UID                                        11780000
117900                 , PO_VER_NBR                                     11790000
118000                 , CRE_SRC_CDE                                    11800000
118100                 , EXPTED_PKG_QTY                                 11810000
118200                 , OWNER_SCAC_ID                                  11820000
118300                 , ASN_NBR                                        11830000
118400                 , VEND_SHIP_DTE                                  11840000
118500                 , PKSL_PG_CNT                                    11850000
118600                 , CONTNR_ID                                      11860000
118700                 , ORIG_PKSL_SEQ_NBR                              11870000
118800                 )                                                11880000
118900         VALUES  (                                                11890000
119000                   :PKSLIP-PO-NBR                                 11900000
119100                 , :PKSLIP-SEQ-NBR                                11910000
119200                 , :PV-DB2-TMST                                   11920000
119300                 , :PKSLIP-VER-STAT-CDE                           11930000
119400                 , :PKSLIP-OPER-UNT-ID                            11940000
119500                 , :PKSLIP-FCLTY-ID                               11950000
119600                 , :PKSLIP-PKSL-NBR                               11960000
119700                 , :PKSLIP-STR-DEST-NBR                           11970000
119800                 , :PKSLIP-REC-SEQ-NBR                            11980000
119900                 , :PKSLIP-SHIPT-ID                               11990000
120000                 , :PKSLIP-BOL-NBR                                12000000
120100                 , :PKSLIP-PRO-NBR                                12010000
120200                 , :PKSLIP-PKSL-STAT-CDE                          12020000
120300                 , :PKSLIP-CRE-UID                                12030000
120400                 , :PKSLIP-PO-VER-NBR                             12040000
120500                 , :PKSLIP-CRE-SRC-CDE                            12050000
120600                 , :PKSLIP-EXPTED-PKG-QTY                         12060000
120700                 , :PKSLIP-OWNER-SCAC-ID                          12070000
120800                 , :PKSLIP-ASN-NBR                                12080000
120900                 , :PKSLIP-VEND-SHIP-DTE                          12090000
121000                 , :PKSLIP-PKSL-PG-CNT                            12100000
121100                 , :PKSLIP-CONTNR-ID                              12110000
121200                 , :PKSLIP-ORIG-PKSL-SEQ-NBR                      12120000
121300                 )                                                12130000
121400        END-EXEC                                                  12140000
121500                                                                  12150000
121600        EVALUATE TRUE                                             12160000
121700           WHEN SQLCODE = +0                                      12170000
121800              SET PS-PKSLIP-INSERTED TO TRUE                      12180000
121900           WHEN SQLCODE = -803                                    12190000
122000              ADD 1                TO PKSLIP-SEQ-NBR              12200000
122100              ADD 1                TO PV-NEW-PKSLIP-SEQ-NBR       12210000
122200                                                                  12220000
122300         WHEN SQLWARN0 NOT = SPACES                               12230000
122400         WHEN SQLCODE < +0                                        12240000
122500         WHEN SQLCODE > +0                                        12250000
122600                                                                  12260000
122700              SET  PS-ERROR-YES         TO TRUE                   12270000
122800                                                                  12280000
122900              MOVE SQLCODE              TO PV-DISP-SQLCODE        12290000
123000              DISPLAY  ' RCKUP075-3250-'                          12300000
123100                       ' SQL:'             PV-DISP-SQLCODE        12310000
123200                       ' PO:'              RC119-KOHLS-PO-NBR     12320000
123300                       ' STR:'             RC119-DEST-STORE-NBR   12330000
123400                       ' SSCC:'            RC119-SML-NBR-NUM      12340000
123500              DISPLAY  ' RCKUP075-3250-'                          12350000
123600                       ' SML:'             RC119-SML-NBR-NUM      12360000
123700                                                                  12370000
123800              DISPLAY '*****************************************' 12380000
123900              DISPLAY '*ABEND                                  *' 12390000
124000              DISPLAY '*PROGRAM   = RCKUP075                   *' 12400000
124100              DISPLAY '*DB2 OPER  = INSERT TO TPKSLIP          *' 12410000
124200              DISPLAY '*PARAGRAPH = 3250-CREATE-NEW-PACKSLIP   *' 12420000
124300              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               12430000
124400              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            12440000
124500              DISPLAY '*****************************************' 12450000
124600              PERFORM 9100-SQL-ABEND                              12460000
124700     END-EVALUATE.                                                12470000
124800                                                                  12480000
124900                                                                  12490000
125000*----------------------------------------------------------------*12500000
125100* SELECT PURITM_VER_NBR FROM TPKITEM FOR ORIGINAL PACKSLIP ITEM  *12510000
125200*----------------------------------------------------------------*12520000
125300 3330-SELECT-PURITM-VER-NBR.                                      12530000
125400     IF  PS-TEST-ONLY-DISPLAY-YES                                 12540000
125500         DISPLAY ' RCKUP075 - 3330-SELECT-PURITM-VER-NBR'         12550000
125600     END-IF.                                                      12560000
125700                                                                  12570000
125800     MOVE  RC119-KOHLS-PO-NBR      TO  DK-PO-NBR                  12580000
125900     MOVE  RC119-KOHLS-PO-LINE-NBR TO  DK-PO-LNE-NBR              12590000
126000                                                                  12600000
126100     EXEC SQL                                                     12610000
126200         SELECT  VER_NBR                                          12620000
126300          INTO  :PURITM-VER-NBR                                   12630000
126400           FROM TPURITM                                           12640000
126500          WHERE PO_NBR         = :DK-PO-NBR                       12650000
126600            AND PO_LNE_NBR     = :DK-PO-LNE-NBR                   12660000
126700            AND VER_STATUS_CDE = 'A'                              12670000
126800           WITH UR                                                12680000
126900     END-EXEC.                                                    12690000
127000                                                                  12700000
127100     EVALUATE TRUE                                                12710000
127200       WHEN SQLCODE = ZERO                                        12720000
127300           CONTINUE                                               12730000
127400       WHEN SQLWARN0 NOT = SPACES                                 12740000
127500       WHEN SQLCODE  NOT = ZERO                                   12750000
127600                                                                  12760000
127700              SET  PS-ERROR-YES           TO TRUE                 12770000
127800                                                                  12780000
127900              MOVE SQLCODE                TO PV-DISP-SQLCODE      12790000
128000              MOVE PV-ORIG-PKSLIP-SEQ-NBR TO PV-DISP-ORIG-PKSL    12800000
128100              DISPLAY  ' RCKUP075-3330-'                          12810000
128200                       ' SQL:'           PV-DISP-SQLCODE          12820000
128300                       ' PO:'            RC119-KOHLS-PO-NBR       12830000
128400                       ' STR:'           RC119-DEST-STORE-NBR     12840000
128500                       ' SSCC:'          RC119-SML-NBR-NUM        12850000
128600              DISPLAY  ' RCKUP075-3330-'                          12860000
128700                       ' SML:'           RC119-SML-NBR-NUM        12870000
128800                       ' LINE:'          RC119-KOHLS-PO-LINE-NBR  12880000
128900                                                                  12890000
129000                                                                  12900000
129100              DISPLAY '*****************************************' 12910000
129200              DISPLAY '*ABEND                                  *' 12920000
129300              DISPLAY '*PROGRAM   = RCKUP075                   *' 12930000
129400              DISPLAY '*DB2 OPER  = SELECT FROM TPURITM        *' 12940000
129500              DISPLAY '*PARAGRAPH = 3330-SELECT-PURITM-VER-NBR *' 12950000
129600              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               12960000
129700              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            12970000
129800              DISPLAY '*****************************************' 12980000
129900              PERFORM 9100-SQL-ABEND                              12990000
130000     END-EVALUATE.                                                13000000
130100                                                                  13010000
130200                                                                  13020000
130300*----------------------------------------------------------------*13030000
130400*                                                                *13040000
130500*----------------------------------------------------------------*13050000
130600 3500-PRCESS-PKSLIP-LINK.                                         13060000
130700     IF  PS-TEST-ONLY-DISPLAY-YES                                 13070000
130800         DISPLAY ' RCKUP075 - 3500-PRCESS-PKSLIP-LINK'            13080000
130900         MOVE PV-NEW-PKSLIP-SEQ-NBR   TO PV-DISP-PKITEM-SEQ       13090000
131000         MOVE RC119-KOHLS-PO-LINE-NBR TO PV-DISP-PKITEM-LINE      13100000
131100         DISPLAY ' RCKUP075 - 3500-'                              13110000
131200                 ' SEQ:'                PV-DISP-PKITEM-SEQ        13120000
131300                 ' LINE:'               PV-DISP-PKITEM-LINE       13130000
131400     END-IF.                                                      13140000
131500                                                                  13150000
131600      MOVE PV-NEW-PKSLIP-SEQ-NBR   TO PKITEM-SEQ-NBR.             13160000
131700      MOVE RC119-KOHLS-PO-LINE-NBR TO PKITEM-PKSL-LNE-NBR.        13170000
131800                                                                  13180000
131900      PERFORM 3510-UPDATE-TPKITEM.                                13190000
132000                                                                  13200000
132100      IF  PS-UPDATE-TPKITEM-NO                                    13210000
132200          PERFORM 3520-PRCESS-PKSLIP-CRE-DETAIL                   13220000
132300      ELSE                                                        13230000
132400          PERFORM 4500-PROCSS-PKSLIP                              13240000
132500      END-IF.                                                     13250000
132600                                                                  13260000
132700                                                                  13270000
132800*----------------------------------------------------------------*13280000
132900*                                                                *13290000
133000*----------------------------------------------------------------*13300000
133100 3510-UPDATE-TPKITEM.                                             13310000
133200     IF  PS-TEST-ONLY-DISPLAY-YES                                 13320000
133300         DISPLAY ' RCKUP075 - 3510-UPDATE-TPKITEM'                13330000
133400         MOVE RC119-KOHLS-PO-NBR     TO PV-DISP-PKITEM-PO         13340000
133500         MOVE PV-NEW-PKSLIP-SEQ-NBR   TO PV-DISP-PKITEM-SEQ       13350000
133600         MOVE RC119-KOHLS-PO-LINE-NBR TO PV-DISP-PKITEM-LINE      13360000
133700         DISPLAY ' RCKUP075 - 3510-'                              13370000
133800                 ' PO:'                 PV-DISP-PKITEM-PO         13380000
133900                 ' SEQ:'                PV-DISP-PKITEM-SEQ        13390000
134000                 ' LINE:'               PV-DISP-PKITEM-LINE       13400000
134100     END-IF.                                                      13410000
134200                                                                  13420000
134300     MOVE  RC119-KOHLS-PO-NBR       TO  DK-PO-NBR                 13430000
134400     MOVE  RC119-KOHLS-PO-LINE-NBR  TO  DK-PO-LNE-NBR             13440000
134500     MOVE  RC119-SHIP-UNT-QTY       TO  PV-SHIP-UNT-QTY           13450000
134600                                                                  13460000
134700     EXEC SQL                                                     13470000
134800       UPDATE TPKITEM                                             13480000
134900          SET PKSL_ITM_QTY      = (PKSL_ITM_QTY +                 13490000
135000                                   :PV-SHIP-UNT-QTY)              13500000
135100            , ORIG_PKSL_ITM_QTY = (ORIG_PKSL_ITM_QTY +            13510000
135200                                   :PV-SHIP-UNT-QTY)              13520000
135300        WHERE PO_NBR            = :DK-PO-NBR                      13530000
135400          AND SEQ_NBR           = :PV-NEW-PKSLIP-SEQ-NBR          13540000
135500          AND PKSL_LNE_NBR      = :DK-PO-LNE-NBR                  13550000
135600     END-EXEC.                                                    13560000
135700                                                                  13570000
135800     EVALUATE TRUE                                                13580000
135900         WHEN SQLCODE = +0                                        13590000
136000              SET PS-UPDATE-TPKITEM-YES TO TRUE                   13600000
136100         WHEN SQLCODE = +100                                      13610000
136200              SET PS-UPDATE-TPKITEM-NO  TO TRUE                   13620000
136300         WHEN SQLWARN0 NOT = SPACES                               13630000
136400         WHEN SQLCODE < +0                                        13640000
136500         WHEN SQLCODE > +0                                        13650000
136600                                                                  13660000
136700              SET  PS-ERROR-YES         TO TRUE                   13670000
136800                                                                  13680000
136900              MOVE SQLCODE              TO PV-DISP-SQLCODE        13690000
137000              DISPLAY  ' RCKUP075-3510-'                          13700000
137100                       ' SQL:'             PV-DISP-SQLCODE        13710000
137200                       ' PO:'              RC119-KOHLS-PO-NBR     13720000
137300                       ' STR:'             RC119-DEST-STORE-NBR   13730000
137400                       ' SSCC:'            RC119-SML-NBR-NUM      13740000
137500              DISPLAY  ' RCKUP075-3510-'                          13750000
137600                       ' SML:'             RC119-SML-NBR-NUM      13760000
137700                                                                  13770000
137800                                                                  13780000
137900              DISPLAY '*****************************************' 13790000
138000              DISPLAY '*ABEND                                  *' 13800000
138100              DISPLAY '*PROGRAM   = RCKUP075                   *' 13810000
138200              DISPLAY '*DB2 OPER  = UPDATE TPKITEM             *' 13820000
138300              DISPLAY '*PARAGRAPH = 3510-UPDATE-TPKITEM        *' 13830000
138400              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               13840000
138500              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            13850000
138600              DISPLAY '*****************************************' 13860000
138700              PERFORM 9100-SQL-ABEND                              13870000
138800     END-EVALUATE.                                                13880000
138900                                                                  13890000
139000                                                                  13900000
139100*----------------------------------------------------------------*13910000
139200*                                                                *13920000
139300*----------------------------------------------------------------*13930000
139400 3520-PRCESS-PKSLIP-CRE-DETAIL.                                   13940000
139500     IF  PS-TEST-ONLY-DISPLAY-YES                                 13950000
139600         DISPLAY ' RCKUP075 - 3520-PRCESS-PKSLIP-CRE-DETAIL'      13960000
139700     END-IF.                                                      13970000
139800                                                                  13980000
139900     MOVE    PV-NEW-PKSLIP-SEQ-NBR    TO PKITEM-SEQ-NBR           13990000
140000     MOVE    RC119-KOHLS-PO-LINE-NBR  TO PKITEM-PKSL-LNE-NBR      14000000
140100                                         DK-PO-LNE-NBR            14010000
140200     MOVE    RC119-SHIP-UNT-QTY       TO PKITEM-PKSL-ITM-QTY      14020000
140300                                         PKITEM-ORIG-PKSL-ITM-QTY 14030000
140400     MOVE    PV-NEW-REC-SEQ-NBR       TO RECEIV-REC-SEQ-NBR.      14040000
140500                                                                  14050000
140600                                                                  14060000
140700     PERFORM 3330-SELECT-PURITM-VER-NBR.                          14070000
140800     PERFORM 4370-INSERT-TPKITEM.                                 14080000
140900                                                                  14090000
141000     PERFORM 4500-PROCSS-PKSLIP.                                  14100000
141100                                                                  14110000
141200                                                                  14120000
141300*----------------------------------------------------------------*14130000
141400*                                                                *14140000
141500*----------------------------------------------------------------*14150000
141600 4370-INSERT-TPKITEM.                                             14160000
141700     IF  PS-TEST-ONLY-DISPLAY-YES                                 14170000
141800         DISPLAY ' RCKUP075 - 4370-INSERT-TPKITEM'                14180000
141900     END-IF.                                                      14190000
142000                                                                  14200000
142100     MOVE  RC119-KOHLS-PO-NBR       TO  DK-PO-NBR                 14210000
142200     MOVE  RC119-KOHLS-PO-LINE-NBR  TO  DK-PO-LNE-NBR             14220000
142300                                                                  14230000
142400     EXEC SQL                                                     14240000
142500         INSERT INTO TPKITEM                                      14250000
142600         (    PO_NBR                                              14260000
142700          ,   SEQ_NBR                                             14270000
142800          ,   PKSL_LNE_NBR                                        14280000
142900          ,   CRE_TMST                                            14290000
143000          ,   VER_STAT_CDE                                        14300000
143100          ,   PKSL_ITM_QTY                                        14310000
143200          ,   CRE_UID                                             14320000
143300          ,   PURITM_VER_NBR                                      14330000
143400          ,   ORIG_PKSL_ITM_QTY)                                  14340000
143500         VALUES                                                   14350000
143600         (   :DK-PO-NBR                                           14360000
143700          ,  :PKITEM-SEQ-NBR                                      14370000
143800          ,  :DK-PO-LNE-NBR                                       14380000
143900          ,   CURRENT TIMESTAMP                                   14390000
144000          ,  'A'                                                  14400000
144100          ,  :PKITEM-PKSL-ITM-QTY                                 14410000
144200          ,  :PC-THRDPRTY                                         14420000
144300          ,  :PKITEM-PURITM-VER-NBR                               14430000
144400          ,  :PKITEM-ORIG-PKSL-ITM-QTY                            14440000
144500         )                                                        14450000
144600     END-EXEC.                                                    14460000
144700                                                                  14470000
144800     EVALUATE TRUE                                                14480000
144900         WHEN SQLCODE = +0                                        14490000
145000             CONTINUE                                             14500000
145100         WHEN SQLWARN0 NOT = SPACES                               14510000
145200         WHEN SQLCODE < +0                                        14520000
145300         WHEN SQLCODE > +0                                        14530000
145400                                                                  14540000
145500              SET  PS-ERROR-YES         TO TRUE                   14550000
145600                                                                  14560000
145700              MOVE SQLCODE              TO PV-DISP-SQLCODE        14570000
145800              DISPLAY  ' RCKUP075-4370-'                          14580000
145900                       ' SQL:'             PV-DISP-SQLCODE        14590000
146000                       ' PO:'              RC119-KOHLS-PO-NBR     14600000
146100                       ' STR:'             RC119-DEST-STORE-NBR   14610000
146200                       ' SSCC:'            RC119-SML-NBR-NUM      14620000
146300              DISPLAY  ' RCKUP075-4370-'                          14630000
146400                       ' SML:'             RC119-SML-NBR-NUM      14640000
146500                                                                  14650000
146600                                                                  14660000
146700              DISPLAY '*****************************************' 14670000
146800              DISPLAY '*ABEND                                  *' 14680000
146900              DISPLAY '*PROGRAM   = RCKUP075                   *' 14690000
147000              DISPLAY '*DB2 OPER  = INSERT TPKITEM             *' 14700000
147100              DISPLAY '*PARAGRAPH = 4370-INSERT-TPKITEM        *' 14710000
147200              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               14720000
147300              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            14730000
147400              DISPLAY '*****************************************' 14740000
147500              PERFORM 9100-SQL-ABEND                              14750000
147600     END-EVALUATE.                                                14760000
147700                                                                  14770000
147800                                                                  14780000
147900*----------------------------------------------------------------*14790000
148000*                                                                *14800000
148100*----------------------------------------------------------------*14810000
148200 4000-CREATE-RECEIVER.                                            14820000
148300     IF  PS-TEST-ONLY-DISPLAY-YES                                 14830000
148400         DISPLAY ' RCKUP075 - 4000-CREATE-RECEIVER'               14840000
148500     END-IF.                                                      14850000
148600                                                                  14860000
148700     PERFORM 3210-GET-NEXT-RCVR-SEQ.                              14870000
148800                                                                  14880000
148900     IF  PS-TEST-ONLY-DISPLAY-YES                                 14890000
149000         MOVE PV-NEW-REC-SEQ-NBR  TO  PV-DISP-RCVR                14900000
149100         DISPLAY ' RCKUP075 - 4000-CREATE-RECEIVER'               14910000
149200                   RC119-KOHLS-PO-NBR '-'                         14920000
149300                   PV-DISP-RCVR                                   14930000
149400     END-IF.                                                      14940000
149500                                                                  14950000
149600     MOVE  RC119-KOHLS-PO-NBR     TO  RECEIV-ORD-NBR.             14960000
149700     MOVE  PV-NEW-REC-SEQ-NBR     TO  RECEIV-REC-SEQ-NBR.         14970000
149800                                                                  14980000
149900     MOVE  PC-THRDPRTY            TO  RECEIV-CRE-UID              14990000
150000                                      RECEIV-UPD-UID.             15000000
150100     MOVE  PC-PROGRAM-NAME        TO  RECEIV-UPD-PGM-ID.          15010000
150200                                                                  15020000
150300     MOVE  PURCHS-VER-NBR         TO  RECEIV-PO-VER-NBR.          15030000
150400                                                                  15040000
150500     MOVE  PC-FCLTY               TO  RECEIV-FCLTY-ID             15050000
150600                                      RECEIV-CRE-FCLTY-ID         15060000
150700                                      RECEIV-CURR-FCLTY-ID.       15070000
150800                                                                  15080000
150900     MOVE  PC-IP                  TO  RECEIV-STATUS-CDE.          15090000
151000     MOVE  PC-P                   TO  RECEIV-SYST-CRE-CDE.        15100000
151100     MOVE  PC-MR                  TO  RECEIV-REC-TYP-CDE.         15110000
151200     MOVE  PC-A                   TO  RECEIV-VER-STATUS-CDE.      15120000
151300     MOVE  PC-N                   TO  RECEIV-PRE-TKT-IND.         15130000
151400     MOVE  PC-N                   TO  RECEIV-GOH-IND.             15140000
151500                                                                  15150000
151600     IF  PURCHS-PKGNG-CDE  > ' '                                  15160000
151700         MOVE PC-N                TO  RECEIV-PACK-BY-ST-IND       15170000
151800         MOVE PURCHS-PKGNG-CDE    TO  RECEIV-PKGNG-CDE            15180000
151900         IF  PURCHS-PKGNG-CDE  =  'C'  OR                         15190000
152000             PURCHS-PKGNG-CDE  =  'B'                             15200000
152100             SET  PS-BULK         TO  TRUE                        15210000
152200         ELSE                                                     15220000
152300             SET  PS-PREPACK      TO  TRUE                        15230000
152400         END-IF                                                   15240000
152500     ELSE                                                         15250000
152600         MOVE PC-Y                TO  RECEIV-PACK-BY-ST-IND       15260000
152700         MOVE SPACES              TO  RECEIV-PKGNG-CDE            15270000
152800         SET  PS-PBS              TO  TRUE                        15280000
152900     END-IF.                                                      15290000
153000                                                                  15300000
153100     IF  PS-PBS                                                   15310000
153200         MOVE RC119-DEST-STORE-NBR  TO RECEIV-OPER-UNT-ID         15320000
153300                                       RECEIV-CRE-OPER-UNT-ID     15330000
153400         MOVE RC119-3RD-PRTY-DC-NBR                               15340000
153500                                    TO RECEIV-CURR-OPER-UNT-ID    15350000
153600                                                                  15360000
153700     ELSE                                                         15370000
153800         MOVE  RC119-STORE-SUPPORT-DC-NBR                         15380000
153900                                    TO RECEIV-OPER-UNT-ID         15390000
154000                                       RECEIV-CRE-OPER-UNT-ID     15400000
154100         MOVE  RC119-3RD-PRTY-DC-NBR TO RECEIV-CURR-OPER-UNT-ID   15410000
154200     END-IF.                                                      15420000
154300                                                                  15430000
154400     MOVE 1                       TO  RECEIV-EXPTED-CART-CNT      15440000
154500                                      RECEIV-ACTL-CART-CNT        15450000
154600     MOVE ZEROES                  TO  RECEIV-EXPTED-ITM-QTY       15460000
154700                                      RECEIV-ACTL-ITM-QTY         15470000
154800                                      RECEIV-RCVR-NBR             15480000
154900                                      RECEIV-IN-TRBL-MIN-CNT      15490000
155000                                      RECEIV-IN-TRBL-HOUR-CNT     15500000
155100                                      RECEIV-REFER-BACK-SEQ-NBR.  15510000
155200                                                                  15520000
155300     MOVE PC-DEFAULT-TMST         TO  RECEIV-ML-POST-TMST         15530000
155400                                      RECEIV-FS-POST-TMST         15540000
155500                                      RECEIV-IN-TRBL-TMST         15550000
155600                                      RECEIV-VERFYD-TMST          15560000
155700                                      RECEIV-MKNG-APRN-PRT-TMST.  15570000
155800                                                                  15580000
155900     MOVE PC-DEFAULT-DATE         TO  RECEIV-AP-PRC-DTE.          15590000
156000                                                                  15600000
156100     MOVE SPACES                  TO  RECEIV-AD-INFO-DESC         15610000
156200                                      RECEIV-RCVG-CLERK-INIT-ID   15620000
156300                                      RECEIV-AP-PRC-CDE           15630000
156400                                      RECEIV-UPD-UID              15640000
156500                                      RECEIV-UPD-PGM-ID           15650000
156600                                      RECEIV-MIS-DIRECT-IND       15660000
156700                                      RECEIV-IMPRT-IND.           15670000
156800                                                                  15680000
156900     IF  PS-ERROR-NO                                              15690000
157000         PERFORM 3220-CREATE-RECEIVER                             15700000
157100     END-IF.                                                      15710000
157200                                                                  15720000
157300                                                                  15730000
157400*----------------------------------------------------------------*15740000
157500*                                                                *15750000
157600*----------------------------------------------------------------*15760000
157700 4010-CREATE-NEW-PKSLIP.                                          15770000
157800     IF  PS-TEST-ONLY-DISPLAY-YES                                 15780000
157900         DISPLAY ' RCKUP075 - 4010-CREATE-NEW-PKSLIP'             15790000
158000     END-IF.                                                      15800000
158100                                                                  15810000
158200     INITIALIZE DCLTPKSLIP.                                       15820000
158300                                                                  15830000
158400     PERFORM 3240-GET-NEXT-PKSLIP-SEQ.                            15840000
158500                                                                  15850000
158600     IF  PS-PBS                                                   15860000
158700         MOVE RC119-DEST-STORE-NBR       TO DK-OPER-UNT-ID        15870000
158800                                            PKSLIP-OPER-UNT-ID    15880000
158900                                            PKSLIP-STR-DEST-NBR   15890000
159000     ELSE                                                         15900000
159100         MOVE RC119-STORE-SUPPORT-DC-NBR TO DK-OPER-UNT-ID        15910000
159200                                            PKSLIP-OPER-UNT-ID    15920000
159300                                            PKSLIP-STR-DEST-NBR   15930000
159400     END-IF.                                                      15940000
159500                                                                  15950000
159600     MOVE PC-FCLTY                 TO DK-FCLTY-ID.                15960000
159700     MOVE RC119-DEST-STORE-NBR     TO DK-STR-NBR.                 15970000
159800                                                                  15980000
159900     MOVE ZEROES                   TO PKSLIP-PKSL-PG-CNT          15990000
160000                                      PKSLIP-SHIPT-ID.            16000000
160100                                                                  16010000
160200     MOVE +0                       TO PKSLIP-EXPTED-PKG-QTY.      16020000
160300                                                                  16030000
160400     MOVE SPACES                   TO PKSLIP-OWNER-SCAC-ID        16040000
160500                                      PKSLIP-CRE-SRC-CDE.         16050000
160600                                                                  16060000
160700     MOVE RC119-KOHLS-PO-NBR       TO PKSLIP-PO-NBR.              16070000
160800     MOVE PC-ONE                   TO PKSLIP-FCLTY-ID.            16080000
160900     MOVE PV-NEW-REC-SEQ-NBR       TO PKSLIP-REC-SEQ-NBR.         16090000
161000     MOVE RC119-SHIP-BOL-NBR       TO PKSLIP-BOL-NBR.             16100000
161100     MOVE RC119-SHIP-PRO-NBR       TO PKSLIP-PRO-NBR.             16110000
161200     MOVE RC119-SHIP-DATE          TO PKSLIP-VEND-SHIP-DTE.       16120000
161300     MOVE SPACES                   TO PKSLIP-ASN-NBR.             16130000
161400     MOVE PC-AC                    TO PKSLIP-PKSL-STAT-CDE.       16140000
161500     MOVE PC-A                     TO PKSLIP-VER-STAT-CDE.        16150000
161600                                                                  16160000
161700     MOVE PC-THRDPRTY              TO PKSLIP-CRE-UID              16170000
161800     MOVE SPACES                   TO PKSLIP-PKSL-NBR.            16180000
161900                                                                  16190000
162000     MOVE ZEROES                   TO PKSLIP-ORIG-PKSL-SEQ-NBR.   16200000
162100                                                                  16210000
162200     MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR.          16220000
162300     MOVE PV-NEW-PKSLIP-SEQ-NBR    TO PKSLIP-SEQ-NBR              16230000
162400                                                                  16240000
162500     SET PS-PKSLIP-NOT-INSERTED    TO TRUE.                       16250000
162600     PERFORM 4015-GET-CURRENT-TMST.                               16260000
162700     PERFORM 3250-CREATE-NEW-PACKSLIP                             16270000
162800             UNTIL PS-PKSLIP-INSERTED.                            16280000
162900                                                                  16290000
163000                                                                  16300000
163100*----------------------------------------------------------------*16310000
163200*                                                                *16320000
163300*----------------------------------------------------------------*16330000
163400 4015-GET-CURRENT-TMST.                                           16340000
163500     IF  PS-TEST-ONLY-DISPLAY-YES                                 16350000
163600         DISPLAY ' RCKUP075 - 4015-GET-CURRENT-TMST'              16360000
163700     END-IF.                                                      16370000
163800                                                                  16380000
163900     EXEC SQL                                                     16390000
164000          SELECT  CURRENT TIMESTAMP                               16400000
164100            INTO :PV-DB2-TMST                                     16410000
164200            FROM SYSIBM.SYSDUMMY1                                 16420000
164300     END-EXEC.                                                    16430000
164400                                                                  16440000
164500     IF  PS-TEST-ONLY-DISPLAY-YES                                 16450000
164600         DISPLAY ' RCKUP075 - 4015-GET-CURRENT-TMST'              16460000
164700                 ' TMST: '    PV-DB2-TMST                         16470000
164800     END-IF.                                                      16480000
164900                                                                  16490000
165000     EVALUATE TRUE                                                16500000
165100         WHEN SQLCODE = ZERO                                      16510000
165200           SET PV-DB2-TMST-SS-01                                  16520000
165300               PV-DB2-TMST-MS-ZERO   TO  TRUE                     16530000
165400         WHEN SQLWARN0 NOT = SPACES                               16540000
165500         WHEN SQLCODE  NOT = ZERO                                 16550000
165600                                                                  16560000
165700              SET  PS-ERROR-YES         TO TRUE                   16570000
165800                                                                  16580000
165900              MOVE SQLCODE              TO PV-DISP-SQLCODE        16590000
166000              DISPLAY  ' RCKUP075-4015-'                          16600000
166100                       ' SQL:'             PV-DISP-SQLCODE        16610000
166200                       ' PO:'              RC119-KOHLS-PO-NBR     16620000
166300                       ' STR:'             RC119-DEST-STORE-NBR   16630000
166400                       ' SSCC:'            RC119-SML-NBR-NUM      16640000
166500              DISPLAY  ' RCKUP075-4015-'                          16650000
166600                       ' SML:'             RC119-SML-NBR-NUM      16660000
166700                                                                  16670000
166800                                                                  16680000
166900              DISPLAY '*****************************************' 16690000
167000              DISPLAY '*ABEND                                  *' 16700000
167100              DISPLAY '*PROGRAM   = RCKUP075                   *' 16710000
167200              DISPLAY '*DB2 OPER  = TIMESTAMP                  *' 16720000
167300              DISPLAY '*PARAGRAPH = 4015-GET-CURRENT-TMST      *' 16730000
167400              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               16740000
167500              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            16750000
167600              DISPLAY '*****************************************' 16760000
167700              PERFORM 9100-SQL-ABEND                              16770000
167800     END-EVALUATE.                                                16780000
167900                                                                  16790000
168000                                                                  16800000
168100*----------------------------------------------------------------*16810000
168200*                                                                *16820000
168300*----------------------------------------------------------------*16830000
168400 4500-PROCSS-PKSLIP.                                              16840000
168500     IF  PS-TEST-ONLY-DISPLAY-YES                                 16850000
168600         DISPLAY ' RCKUP075 - 4500-PROCSS-PKSLIP'                 16860000
168700                 ' PO:'  RC119-KOHLS-PO-NBR                       16870000
168800                 ' STR:' RC119-DEST-STORE-NBR                     16880000
168900                 ' 3RD:' RC119-3RD-PRTY-DC-NBR                    16890000
169000                 ' DC:'  RC119-STORE-SUPPORT-DC-NBR               16900000
169100     END-IF.                                                      16910000
169200                                                                  16920000
169300     EVALUATE TRUE                                                16930000
169400         WHEN PS-PBS                                              16940000
169500              MOVE RC119-DEST-STORE-NBR TO DK-STR-DEST-NBR        16950000
169600              PERFORM 5000-PROCESS-PBS                            16960000
169700         WHEN PS-BULK                                             16970000
169800         WHEN PS-PREPACK                                          16980000
169900              MOVE RC119-DEST-STORE-NBR TO DK-STR-DEST-NBR        16990000
170000              PERFORM 6000-PROCESS-BULK-PREPK                     17000000
170100     END-EVALUATE.                                                17010000
170200                                                                  17020000
170300                                                                  17030000
170400*----------------------------------------------------------------*17040000
170500* PROCESS PBS RECEIVER START                                      17050000
170600*----------------------------------------------------------------*17060000
170700 5000-PROCESS-PBS.                                                17070000
170800     IF  PS-TEST-ONLY-DISPLAY-YES                                 17080000
170900         DISPLAY ' RCKUP075 - 5000-PROCESS-PBS'                   17090000
171000     END-IF                                                       17100000
171100                                                                  17110000
171200      PERFORM 5100-SELECT-RECITM-RECDIS                           17120000
171300                                                                  17130000
171400     IF  PS-NEW-RECITM-FOUND                                      17140000
171500                                                                  17150000
171600         COMPUTE PV-EXPTED-ITM-UPD-QTY =                          17160000
171700             (RECDIS-EXPTED-ITM-QTY + RC119-SHIP-UNT-QTY)         17170000
171800                                                                  17180000
171900         COMPUTE PV-VERIFY-ITM-UPD-QTY =                          17190000
172000             (RECDIS-VERIFY-ITM-QTY + RC119-SHIP-UNT-QTY)         17200000
172100                                                                  17210000
172200         COMPUTE PV-AP-VERIFY-ITM-UPD-QTY =                       17220000
172300             (RECDIS-AP-VERIFY-ITM-QTY + RC119-SHIP-UNT-QTY)      17230000
172400                                                                  17240000
172500         COMPUTE RECDIS-PLAN-ITM-QTY   =                          17250000
172600             (RECDIS-PLAN-ITM-QTY      + RC119-SHIP-UNT-QTY)      17260000
172700                                                                  17270000
172800         COMPUTE PV-RECITM-ORIG-PKSL-ITM-QTY  =                   17280000
172900             (RECITM-ORIG-PKSL-ITM-QTY + RC119-SHIP-UNT-QTY)      17290000
173000                                                                  17300000
173100         COMPUTE PV-RECITM-PKSL-ITM-QTY  =                        17310000
173200             (RECITM-PKSL-ITM-QTY + RC119-SHIP-UNT-QTY)           17320000
173300                                                                  17330000
173400         ADD  1  TO  RECITM-EXPTED-CART-CNT                       17340000
173500         ADD  1  TO  RECITM-ACTL-CART-CNT                         17350000
173600         PERFORM 5110-UPDATE-TRECITM                              17360000
173700         PERFORM 5120-UPDATE-TRECDIS                              17370000
173800         MOVE ZEROES              TO PV-AP-VERIFY-ITM-UPD-QTY     17380000
173900                                                                  17390000
174000     ELSE                                                         17400000
174100                                                                  17410000
174200         MOVE RC119-SHIP-UNT-QTY  TO PV-EXPTED-ITM-UPD-QTY        17420000
174300                                                                  17430000
174400         MOVE RC119-SHIP-UNT-QTY  TO PV-VERIFY-ITM-UPD-QTY        17440000
174500                                                                  17450000
174600         MOVE RC119-SHIP-UNT-QTY  TO RECDIS-PLAN-ITM-QTY          17460000
174700                                                                  17470000
174800         MOVE RC119-SHIP-UNT-QTY  TO RECITM-ORIG-PKSL-ITM-QTY     17480000
174900                                                                  17490000
175000         MOVE RC119-SHIP-UNT-QTY  TO RECITM-PKSL-ITM-QTY          17500000
175100                                                                  17510000
175200         MOVE RC119-SHIP-UNT-QTY  TO PV-AP-VERIFY-ITM-UPD-QTY     17520000
175300                                                                  17530000
175400         PERFORM 5200-BUILD-ITEM-DISTRO                           17540000
175500         PERFORM 5210-NEW-TRECITM                                 17550000
175600         PERFORM 5220-NEW-TRECDIS                                 17560000
175700                                                                  17570000
175800     END-IF.                                                      17580000
175900                                                                  17590000
176000                                                                  17600000
176100*----------------------------------------------------------------*17610000
176200* UPDATE NEW RECEIVER - ITEM QUANTITIES                          *17620000
176300*----------------------------------------------------------------*17630000
176400 5100-SELECT-RECITM-RECDIS.                                       17640000
176500     IF  PS-TEST-ONLY-DISPLAY-YES                                 17650000
176600         MOVE DK-PO-NBR           TO  PV-DISP-PO                  17660000
176700         MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE                17670000
176800         MOVE PV-NEW-REC-SEQ-NBR  TO  PV-DISP-RCVR                17680000
176900         MOVE DK-STR-DEST-NBR     TO  PV-DISP-STR                 17690000
177000         DISPLAY ' RCKUP075 - 5100-SELECT-RECITM-RECDIS'          17700000
177100                 ' RCKUP075 - 5100-  '                            17710000
177200                   PV-DISP-PO   '-'                               17720000
177300                   PV-DISP-RCVR '-'                               17730000
177400                   PV-DISP-LINE '-'                               17740000
177500                   PV-DISP-STR  '-'                               17750000
177600     END-IF.                                                      17760000
177700                                                                  17770000
177800     MOVE 'N'  TO  PS-RECITM-YES-RECDIS-NO-SW                     17780000
177900                                                                  17790000
178000     EXEC SQL                                                     17800000
178100        SELECT B.STATUS_CDE                                       17810000
178200            ,  B.PKSL_ITM_QTY                                     17820000
178300            ,  B.EXPTED_CART_CNT                                  17830000
178400            ,  B.ACTL_CART_CNT                                    17840000
178500            ,  B.PREPK_ID                                         17850000
178600            ,  B.DTL_CK_ITM_QTY                                   17860000
178700            ,  A.EXPTED_ITM_QTY                                   17870000
178800            ,  A.VERIFY_ITM_QTY                                   17880000
178900            ,  A.AP_VERIFY_ITM_QTY                                17890000
179000            ,  B.PREPK_RATO_QTY                                   17900000
179100            ,  B.PREPK_ODD_UNT_QTY                                17910000
179200            ,  A.OPER_UNT_ID                                      17920000
179300            ,  B.ORIG_PKSL_ITM_QTY                                17930000
179400            ,  B.PKSL_ITM_QTY                                     17940000
179500            ,  A.PLAN_ITM_QTY                                     17950000
179600        INTO   :RECITM-STATUS-CDE                                 17960000
179700            ,  :RECITM-PKSL-ITM-QTY                               17970000
179800            ,  :RECITM-EXPTED-CART-CNT                            17980000
179900            ,  :RECITM-ACTL-CART-CNT                              17990000
180000            ,  :RECITM-PREPK-ID                                   18000000
180100            ,  :RECITM-DTL-CK-ITM-QTY                             18010000
180200            ,  :RECDIS-EXPTED-ITM-QTY                             18020000
180300            ,  :RECDIS-VERIFY-ITM-QTY                             18030000
180400            ,  :RECDIS-AP-VERIFY-ITM-QTY                          18040000
180500            ,  :RECITM-PREPK-RATO-QTY                             18050000
180600            ,  :RECITM-PREPK-ODD-UNT-QTY                          18060000
180700            ,  :RECDIS-OPER-UNT-ID                                18070000
180800            ,  :RECITM-ORIG-PKSL-ITM-QTY                          18080000
180900            ,  :RECITM-PKSL-ITM-QTY                               18090000
181000            ,  :RECDIS-PLAN-ITM-QTY                               18100000
181100          FROM TRECDIS A                                          18110000
181200            ,  TRECITM B                                          18120000
181300         WHERE A.ORD_NBR         =  :DK-PO-NBR                    18130000
181400           AND A.ORD_LNE_NBR     =  :DK-PO-LNE-NBR                18140000
181500           AND A.REC_SEQ_NBR     =  :PV-NEW-REC-SEQ-NBR           18150000
181600           AND A.STR_NBR         =  :DK-STR-DEST-NBR              18160000
181700           AND A.ORD_NBR         =  B.ORD_NBR                     18170000
181800           AND A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                 18180000
181900           AND A.REC_SEQ_NBR     =  B.REC_SEQ_NBR                 18190000
182000          WITH UR                                                 18200000
182100     END-EXEC.                                                    18210000
182200                                                                  18220000
182300     EVALUATE TRUE                                                18230000
182400         WHEN SQLCODE = ZERO                                      18240000
182500              SET  PS-NEW-RECITM-FOUND      TO  TRUE              18250000
182600                                                                  18260000
182700         WHEN SQLCODE = +100                                      18270000
182800              SET  PS-NEW-RECITM-NOT-FOUND  TO  TRUE              18280000
182900              PERFORM 5105-SELECT-RECITM-NOT-RECDIS               18290000
183000                                                                  18300000
183100         WHEN SQLWARN0 NOT = SPACES                               18310000
183200         WHEN SQLCODE NOT EQUAL ZERO                              18320000
183300                                                                  18330000
183400              SET  PS-ERROR-YES         TO TRUE                   18340000
183500                                                                  18350000
183600              MOVE SQLCODE              TO PV-DISP-SQLCODE        18360000
183700              DISPLAY  ' RCKUP075-5100-'                          18370000
183800                       ' SQL:'             PV-DISP-SQLCODE        18380000
183900                       ' PO:'              RC119-KOHLS-PO-NBR     18390000
184000                       ' STR:'             RC119-DEST-STORE-NBR   18400000
184100                       ' SSCC:'            RC119-SML-NBR-NUM      18410000
184200              DISPLAY  ' RCKUP075-5100-'                          18420000
184300                       ' SML:'             RC119-SML-NBR-NUM      18430000
184400                                                                  18440000
184500                                                                  18450000
184600              DISPLAY '*****************************************' 18460000
184700              DISPLAY '*ABEND                                  *' 18470000
184800              DISPLAY '*PROGRAM   = RCKUP075                   *' 18480000
184900              DISPLAY '*DB2 OPER  = SELECT NEW TRECITM TRECDIS *' 18490000
185000              DISPLAY '*PARAGRAPH = 5100-SELECT-RECITM-RECDIS  *' 18500000
185100              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               18510000
185200              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            18520000
185300              DISPLAY '*****************************************' 18530000
185400              PERFORM 9100-SQL-ABEND                              18540000
185500     END-EVALUATE.                                                18550000
185600                                                                  18560000
185700     IF  PS-TEST-ONLY-DISPLAY-YES                                 18570000
185800         MOVE SQLCODE              TO PV-DISP-SQLCODE             18580000
185900         DISPLAY ' RCKUP075 - 5100-   '                           18590000
186000                 ' SQL: '  PV-DISP-SQLCODE                        18600000
186100                 '  SW:'   PS-NEW-RECITM-FOUND-SW                 18610000
186200     END-IF.                                                      18620000
186300                                                                  18630000
186400                                                                  18640000
186500*----------------------------------------------------------------*18650000
186600* CHECK IF TRECITM NOT TRECDIS                                   *18660000
186700*----------------------------------------------------------------*18670000
186800 5105-SELECT-RECITM-NOT-RECDIS.                                   18680000
186900     IF  PS-TEST-ONLY-DISPLAY-YES                                 18690000
187000         MOVE DK-PO-NBR           TO  PV-DISP-PO                  18700000
187100         MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE                18710000
187200         MOVE PV-NEW-REC-SEQ-NBR  TO  PV-DISP-RCVR                18720000
187300         MOVE DK-STR-DEST-NBR     TO  PV-DISP-STR                 18730000
187400         DISPLAY ' RCKUP075 - 5105-SELECT-RECITM-NOT-RECDIS'      18740000
187500                 ' RCKUP075 - 5105-  '                            18750000
187600                   PV-DISP-PO   '-'                               18760000
187700                   PV-DISP-RCVR '-'                               18770000
187800                   PV-DISP-LINE '-'                               18780000
187900                   PV-DISP-STR  '-'                               18790000
188000     END-IF.                                                      18800000
188100                                                                  18810000
188200     MOVE 'N'  TO  PS-RECITM-YES-RECDIS-NO-SW                     18820000
188300                                                                  18830000
188400     EXEC SQL                                                     18840000
188500        SELECT B.STATUS_CDE                                       18850000
188600            ,  B.PKSL_ITM_QTY                                     18860000
188700            ,  B.EXPTED_CART_CNT                                  18870000
188800            ,  B.ACTL_CART_CNT                                    18880000
188900            ,  B.PREPK_ID                                         18890000
189000            ,  B.DTL_CK_ITM_QTY                                   18900000
189100            ,  B.PREPK_RATO_QTY                                   18910000
189200            ,  B.PREPK_ODD_UNT_QTY                                18920000
189300            ,  B.ORIG_PKSL_ITM_QTY                                18930000
189400            ,  B.PKSL_ITM_QTY                                     18940000
189500        INTO   :RECITM-STATUS-CDE                                 18950000
189600            ,  :RECITM-PKSL-ITM-QTY                               18960000
189700            ,  :RECITM-EXPTED-CART-CNT                            18970000
189800            ,  :RECITM-ACTL-CART-CNT                              18980000
189900            ,  :RECITM-PREPK-ID                                   18990000
190000            ,  :RECITM-DTL-CK-ITM-QTY                             19000000
190100            ,  :RECITM-PREPK-RATO-QTY                             19010000
190200            ,  :RECITM-PREPK-ODD-UNT-QTY                          19020000
190300            ,  :RECITM-ORIG-PKSL-ITM-QTY                          19030000
190400            ,  :RECITM-PKSL-ITM-QTY                               19040000
190500          FROM TRECITM B                                          19050000
190600         WHERE B.ORD_NBR         =  :DK-PO-NBR                    19060000
190700           AND B.ORD_LNE_NBR     =  :DK-PO-LNE-NBR                19070000
190800           AND B.REC_SEQ_NBR     =  :PV-NEW-REC-SEQ-NBR           19080000
190900          WITH UR                                                 19090000
191000     END-EXEC.                                                    19100000
191100                                                                  19110000
191200     EVALUATE TRUE                                                19120000
191300         WHEN SQLCODE = ZERO                                      19130000
191400              SET  PS-RECITM-YES-RECDIS-NO  TO  TRUE              19140000
191500                                                                  19150000
191600         WHEN SQLCODE = +100                                      19160000
191700              SET  PS-NEW-RECITM-NOT-FOUND  TO  TRUE              19170000
191800                                                                  19180000
191900         WHEN SQLWARN0 NOT = SPACES                               19190000
192000         WHEN SQLCODE NOT EQUAL ZERO                              19200000
192100                                                                  19210000
192200              SET  PS-ERROR-YES         TO TRUE                   19220000
192300                                                                  19230000
192400              MOVE SQLCODE              TO PV-DISP-SQLCODE        19240000
192500              DISPLAY  ' RCKUP075-5105-'                          19250000
192600                       ' SQL:'             PV-DISP-SQLCODE        19260000
192700                       ' PO:'              RC119-KOHLS-PO-NBR     19270000
192800                       ' STR:'             RC119-DEST-STORE-NBR   19280000
192900                       ' SSCC:'            RC119-SML-NBR-NUM      19290000
193000              DISPLAY  ' RCKUP075-5105-'                          19300000
193100                       ' SML:'             RC119-SML-NBR-NUM      19310000
193200                                                                  19320000
193300                                                                  19330000
193400              DISPLAY '*****************************************' 19340000
193500              DISPLAY '*ABEND                                  *' 19350000
193600              DISPLAY '*PROGRAM   = RCKUP075                   *' 19360000
193700              DISPLAY '*DB2 OPER  = SELECT NEW TRECITM TRECDIS *' 19370000
193800              DISPLAY '*PARAGRAPH = 5105-SELECT-RECITM-NOT-RECD*' 19380000
193900              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               19390000
194000              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            19400000
194100              DISPLAY '*****************************************' 19410000
194200              PERFORM 9100-SQL-ABEND                              19420000
194300     END-EVALUATE.                                                19430000
194400                                                                  19440000
194500     IF  PS-TEST-ONLY-DISPLAY-YES                                 19450000
194600         MOVE SQLCODE              TO PV-DISP-SQLCODE             19460000
194700         DISPLAY ' RCKUP075 - 5105-   '                           19470000
194800                 ' SQL: '  PV-DISP-SQLCODE                        19480000
194900                 '  SW:'   PS-NEW-RECITM-FOUND-SW                 19490000
195000     END-IF.                                                      19500000
195100                                                                  19510000
195200                                                                  19520000
195300*----------------------------------------------------------------*19530000
195400*  UPDATE RECEIVER ITEM - TRECITM - QUANTITIES                   *19540000
195500*----------------------------------------------------------------*19550000
195600 5110-UPDATE-TRECITM.                                             19560000
195700     IF  PS-TEST-ONLY-DISPLAY-YES                                 19570000
195800         DISPLAY ' RCKUP075 - 5110-UPDATE-TRECITM'                19580000
195900         MOVE DK-PO-NBR          TO PV-DISP-RECITM-ORD-NBR        19590000
196000         MOVE DK-PO-LNE-NBR      TO PV-DISP-RECITM-ORD-LNE-NBR    19600000
196100         MOVE RECEIV-OPER-UNT-ID TO PV-DISP-RECITM-REC-SEQ-NBR    19610000
196200         MOVE RECITM-ORIG-PKSL-ITM-QTY                            19620000
196300                                 TO PV-DISP-RECITM-PKSL-QTY       19630000
196400         MOVE RECITM-PREPK-ODD-UNT-QTY                            19640000
196500                                 TO PV-DISP-RECITM-ODD-QTY        19650000
196600         DISPLAY ' RCKUP075 - 5110-'                              19660000
196700                                    PV-DISP-RECITM-ORD-NBR        19670000
196800                      '-'           PV-DISP-RECITM-REC-SEQ-NBR    19680000
196900                      '-'           PV-DISP-RECITM-ORD-LNE-NBR    19690000
197000                  ' -PKSL:'         PV-DISP-RECITM-PKSL-QTY       19700000
197100                  ' -ODD:'          PV-DISP-RECITM-ODD-QTY        19710000
197200                                                                  19720000
197300     END-IF.                                                      19730000
197400                                                                  19740000
197500     EXEC SQL                                                     19750000
197600       UPDATE TRECITM                                             19760000
197700          SET                                                     19770000
197800              DTL_CK_ITM_QTY    = :PV-DTL-CK-ITM-QTY              19780000
197900            , UPD_TMST          = CURRENT TIMESTAMP               19790000
198000            , UPD_PGM_ID        = :PC-PROGRAM-NAME                19800000
198100            , UPD_UID           = :PC-THRDPRTY                    19810000
198200            , EXPTED_CART_CNT   = :RECITM-EXPTED-CART-CNT         19820000
198300            , ACTL_CART_CNT     = :RECITM-ACTL-CART-CNT           19830000
198400            , ORIG_PKSL_ITM_QTY = :RECITM-ORIG-PKSL-ITM-QTY       19840000
198500            , PREPK_ODD_UNT_QTY = :RECITM-PREPK-ODD-UNT-QTY       19850000
198600            , PKSL_ITM_QTY      = :RECITM-PKSL-ITM-QTY            19860000
198700        WHERE ORD_NBR           = :DK-PO-NBR                      19870000
198800          AND ORD_LNE_NBR       = :DK-PO-LNE-NBR                  19880000
198900          AND REC_SEQ_NBR       = :PV-NEW-REC-SEQ-NBR             19890000
199000     END-EXEC.                                                    19900000
199100                                                                  19910000
199200     EVALUATE TRUE                                                19920000
199300         WHEN SQLCODE = +0                                        19930000
199400             CONTINUE                                             19940000
199500         WHEN SQLWARN0 NOT = SPACES                               19950000
199600         WHEN SQLCODE < +0                                        19960000
199700         WHEN SQLCODE > +0                                        19970000
199800                                                                  19980000
199900              SET  PS-ERROR-YES         TO TRUE                   19990000
200000                                                                  20000000
200100              MOVE SQLCODE              TO PV-DISP-SQLCODE        20010000
200200              DISPLAY  ' RCKUP075-5110-'                          20020000
200300                       ' SQL:'             PV-DISP-SQLCODE        20030000
200400                       ' PO:'              RC119-KOHLS-PO-NBR     20040000
200500                       ' STR:'             RC119-DEST-STORE-NBR   20050000
200600                       ' SSCC:'            RC119-SML-NBR-NUM      20060000
200700              DISPLAY  ' RCKUP075-5110-'                          20070000
200800                       ' SML:'             RC119-SML-NBR-NUM      20080000
200900                                                                  20090000
201000              MOVE DK-PO-NBR     TO PV-DISP-RECITM-ORD-NBR        20100000
201100              MOVE DK-PO-LNE-NBR TO PV-DISP-RECITM-ORD-LNE-NBR    20110000
201200              MOVE PV-NEW-REC-SEQ-NBR                             20120000
201300                                 TO PV-DISP-RECITM-REC-SEQ-NBR    20130000
201400              MOVE RECITM-OPER-UNT-ID                             20140000
201500                                 TO PV-DISP-RECITM-OPER-UNT-ID    20150000
201600              MOVE RECITM-FCLTY-ID                                20160000
201700                                 TO PV-DISP-RECITM-FCLTY-ID       20170000
201800              DISPLAY ' RCKUP075 - 5110-'                         20180000
201900                                    PV-DISP-RECITM-ORD-NBR        20190000
202000                      '-'           PV-DISP-RECITM-REC-SEQ-NBR    20200000
202100                      '-'           PV-DISP-RECITM-ORD-LNE-NBR    20210000
202200                                                                  20220000
202300              DISPLAY '*****************************************' 20230000
202400              DISPLAY '*ABEND                                  *' 20240000
202500              DISPLAY '*PROGRAM   = RCKUP075                   *' 20250000
202600              DISPLAY '*DB2 OPER  = UPDATE NEW TRECITM         *' 20260000
202700              DISPLAY '*PARAGRAPH =  5110-UPDATE-TRECITM       *' 20270000
202800              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               20280000
202900              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            20290000
203000              DISPLAY '*****************************************' 20300000
203100              PERFORM 9100-SQL-ABEND                              20310000
203200     END-EVALUATE.                                                20320000
203300                                                                  20330000
203400                                                                  20340000
203500*----------------------------------------------------------------*20350000
203600*                                                                *20360000
203700*----------------------------------------------------------------*20370000
203800 5120-UPDATE-TRECDIS.                                             20380000
203900     IF  PS-TEST-ONLY-DISPLAY-YES                                 20390000
204000         DISPLAY ' RCKUP075 - 5120-UPDATE-TRECDIS'                20400000
204100         MOVE DK-PO-NBR          TO PV-DISP-RECDIS-PO-NBR         20410000
204200         MOVE DK-PO-LNE-NBR      TO PV-DISP-RECDIS-TRN-LNE-NBR    20420000
204300         MOVE PV-NEW-REC-SEQ-NBR TO PV-DISP-RECDIS-REC-SEQ-NBR    20430000
204400         MOVE DK-STR-DEST-NBR    TO PV-DISP-RECDIS-STR-NBR        20440000
204500         DISPLAY ' RCKUP075 - 5120-'                              20450000
204600                                    PV-DISP-RECDIS-PO-NBR         20460000
204700                 '-'                PV-DISP-RECDIS-REC-SEQ-NBR    20470000
204800                 '-'                PV-DISP-RECDIS-TRN-LNE-NBR    20480000
204900                 '-'                PV-DISP-RECDIS-STR-NBR        20490000
205000     END-IF.                                                      20500000
205100                                                                  20510000
205200     EXEC SQL                                                     20520000
205300       UPDATE TRECDIS                                             20530000
205400          SET EXPTED_ITM_QTY    = :PV-EXPTED-ITM-UPD-QTY          20540000
205500             ,VERIFY_ITM_QTY    = :PV-VERIFY-ITM-UPD-QTY          20550000
205600             ,AP_VERIFY_ITM_QTY = :PV-AP-VERIFY-ITM-UPD-QTY       20560000
205700             ,PLAN_ITM_QTY      = :RECDIS-PLAN-ITM-QTY            20570000
205800        WHERE ORD_NBR           = :DK-PO-NBR                      20580000
205900          AND ORD_LNE_NBR       = :DK-PO-LNE-NBR                  20590000
206000          AND REC_SEQ_NBR       = :PV-NEW-REC-SEQ-NBR             20600000
206100          AND STR_NBR           = :DK-STR-DEST-NBR                20610000
206200     END-EXEC.                                                    20620000
206300                                                                  20630000
206400     EVALUATE TRUE                                                20640000
206500         WHEN SQLCODE = +0                                        20650000
206600             CONTINUE                                             20660000
206700         WHEN SQLWARN0 NOT = SPACES                               20670000
206800         WHEN SQLCODE < +0                                        20680000
206900         WHEN SQLCODE > +0                                        20690000
207000                                                                  20700000
207100              SET  PS-ERROR-YES         TO TRUE                   20710000
207200                                                                  20720000
207300              MOVE SQLCODE              TO PV-DISP-SQLCODE        20730000
207400              DISPLAY  ' RCKUP075-5120-'                          20740000
207500                       ' SQL:'             PV-DISP-SQLCODE        20750000
207600                       ' PO:'              RC119-KOHLS-PO-NBR     20760000
207700                       ' STR:'             RC119-DEST-STORE-NBR   20770000
207800                       ' SSCC:'            RC119-SML-NBR-NUM      20780000
207900              DISPLAY  ' RCKUP075-5120-'                          20790000
208000                       ' SML:'             RC119-SML-NBR-NUM      20800000
208100                                                                  20810000
208200              MOVE DK-PO-NBR        TO PV-DISP-RECDIS-PO-NBR      20820000
208300              MOVE DK-PO-LNE-NBR    TO PV-DISP-RECDIS-TRN-LNE-NBR 20830000
208400              MOVE PV-NEW-REC-SEQ-NBR                             20840000
208500                                    TO PV-DISP-RECDIS-REC-SEQ-NBR 20850000
208600              MOVE DK-STR-DEST-NBR    TO PV-DISP-RECDIS-STR-NBR   20860000
208700              DISPLAY ' RCKUP075 - 5120-'                         20870000
208800                                    PV-DISP-RECDIS-PO-NBR         20880000
208900                      '-'           PV-DISP-RECDIS-REC-SEQ-NBR    20890000
209000                      '-'           PV-DISP-RECDIS-TRN-LNE-NBR    20900000
209100                      '-'           PV-DISP-RECDIS-STR-NBR        20910000
209200                                                                  20920000
209300                                                                  20930000
209400              DISPLAY '*****************************************' 20940000
209500              DISPLAY '*ABEND                                  *' 20950000
209600              DISPLAY '*PROGRAM   = RCKUP075                   *' 20960000
209700              DISPLAY '*DB2 OPER  = UPDATE NEW TRECDIS         *' 20970000
209800              DISPLAY '*PARAGRAPH = 5120-UPDATE-TRECDIS        *' 20980000
209900              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               20990000
210000              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            21000000
210100              DISPLAY '*****************************************' 21010000
210200              PERFORM 9100-SQL-ABEND                              21020000
210300     END-EVALUATE.                                                21030000
210400                                                                  21040000
210500                                                                  21050000
210600*----------------------------------------------------------------*21060000
210700*                                                                *21070000
210800*----------------------------------------------------------------*21080000
210900 5200-BUILD-ITEM-DISTRO.                                          21090000
211000     IF  PS-TEST-ONLY-DISPLAY-YES                                 21100000
211100         DISPLAY ' RCKUP075 - 5200-BUILD-ITEM-DISTRO'             21110000
211200         DISPLAY ' RCKUP075 -'                                    21120000
211300                 ' ODD:'  PS-ODD-UNT-CRTN-FOUND-SW                21130000
211400     END-IF.                                                      21140000
211500                                                                  21150000
211600     MOVE  SPACES               TO PV-TKT-FMT-ID                  21160000
211700     SET PS-NOT-PRETICKET       TO TRUE                           21170000
211800                                                                  21180000
211900     PERFORM 5230-GET-PURITM.                                     21190000
212000                                                                  21200000
212100     PERFORM 5235-CALL-XL-ITEM-MODULE.                            21210000
212200                                                                  21220000
212300     MOVE DK-PO-NBR             TO  RECITM-ORD-NBR.               21230000
212400     MOVE DK-PO-LNE-NBR         TO  RECITM-ORD-LNE-NBR.           21240000
212500     MOVE PV-NEW-REC-SEQ-NBR    TO  RECITM-REC-SEQ-NBR.           21250000
212600                                                                  21260000
212700     MOVE RECEIV-OPER-UNT-ID    TO  RECITM-OPER-UNT-ID.           21270000
212800                                                                  21280000
212900     MOVE PC-FCLTY              TO  RECITM-FCLTY-ID.              21290000
213000     MOVE PC-THRDPRTY           TO  RECITM-CRE-UID.               21300000
213100     MOVE PURITM-VER-NBR        TO  RECITM-PO-VER-NBR.            21310000
213200     MOVE PURITM-ITM-NBR        TO  RECITM-ITM-NBR.               21320000
213300     MOVE PC-N                  TO  RECITM-PRE-TKT-IND.           21330000
213400                                                                  21340000
213500     PERFORM 5245-SELECT-PRETICKET-TKT-TYPE.                      21350000
213600     IF  PS-PRETICKET                                             21360000
213700         PERFORM 5250-SELECT-TKT-FMT-ID                           21370000
213800     ELSE                                                         21380000
213900         MOVE XL001-TKT-TYP-DESC TO PV-TICKET-DESC                21390000
214000         PERFORM 5250-SELECT-TKT-FMT-ID                           21400000
214100     END-IF.                                                      21410000
214200     MOVE PV-TKT-FMT-ID         TO  RECITM-TKT-FMT-ID.            21420000
214300                                                                  21430000
214400     MOVE SPACE                 TO  RECITM-RTV-IND.               21440000
214500     MOVE PC-IP                 TO  RECITM-STATUS-CDE.            21450000
214600     MOVE PC-A                  TO  RECITM-VER-STATUS-CDE.        21460000
214700     MOVE PV-PKSL-ITM-UPD-QTY   TO  RECITM-PKSL-ITM-QTY.          21470000
214800     MOVE PV-DTL-CK-ITM-QTY     TO  RECITM-DTL-CK-ITM-QTY.        21480000
214900     MOVE PURITM-INNR-PK-QTY    TO  RECITM-INNR-PACK-QTY.         21490000
215000     MOVE PURITM-OUTR-PK-QTY    TO  RECITM-CASE-PACK-QTY.         21500000
215100     MOVE ZEROES                TO  RECITM-RTV-QTY.               21510000
215200     MOVE PC-ONE                TO  RECITM-EXPTED-CART-CNT.       21520000
215300     MOVE PC-ONE                TO  RECITM-ACTL-CART-CNT.         21530000
215400     MOVE PC-DEFAULT-TMST       TO  RECITM-MKING-APRON-TMST.      21540000
215500     MOVE PURITM-UNT-COST-AMT   TO  RECITM-UNT-COST-AMT.          21550000
215600     MOVE SPACES                TO  RECITM-COLOR-DESC.            21560000
215700     MOVE SPACES                TO  RECITM-SIZE-DESC.             21570000
215800     MOVE SPACES                TO  RECITM-VEND-STYL-NAME.        21580000
215900     MOVE SPACES                TO  RECITM-VEND-DESC.             21590000
216000     MOVE PC-DEFAULT-TMST       TO  RECITM-VERFYD-TMST.           21600000
216100     MOVE SPACES                TO  RECITM-PKSL-NBR.              21610000
216200     MOVE ZEROES                TO  RECITM-REC-INV-LNE-NBR.       21620000
216300     MOVE ZEROES                TO  RECITM-DMG-ITM-QTY.           21630000
216400     MOVE PC-THRDPRTY           TO  RECITM-UPD-UID                21640000
216500                                    RECITM-VRFD-USR-ID            21650000
216600                                    RECITM-LAST-TRSCP-USR-ID.     21660000
216700     MOVE PC-PROGRAM-NAME       TO  RECITM-UPD-PGM-ID.            21670000
216800     MOVE SPACES                TO  RECITM-RCPT-DISTR-UPD-CDE.    21680000
216900                                                                  21690000
217000     IF  PS-PREPACK                                               21700000
217100         MOVE PURITM-PO-PREPK-ID    TO  RECITM-PREPK-ID           21710000
217200         MOVE PURITM-PREPK-RATO-QTY TO  RECITM-PREPK-RATO-QTY     21720000
217300         IF  PS-ODD-UNT-CRTN-FOUND                                21730000
217400             MOVE PV-RECITM-PREPK-ODD-UNT-QTY                     21740000
217500                                    TO  RECITM-PREPK-ODD-UNT-QTY  21750000
217600         END-IF                                                   21760000
217700         IF  PS-FIRST-PREPK-LINE-YES                              21770000
217800             MOVE 'A'               TO  RECITM-PREPK-DRV-LNE-CDE  21780000
217900         ELSE                                                     21790000
218000             MOVE ' '               TO  RECITM-PREPK-DRV-LNE-CDE  21800000
218100         END-IF                                                   21810000
218200     ELSE                                                         21820000
218300         MOVE ZEROES                TO  RECITM-PREPK-ID           21830000
218400                                        RECITM-PREPK-RATO-QTY     21840000
218500                                        RECITM-PREPK-ODD-UNT-QTY  21850000
218600         MOVE SPACES                TO  RECITM-PREPK-DRV-LNE-CDE  21860000
218700     END-IF.                                                      21870000
218800                                                                  21880000
218900     MOVE PURITM-UNT-RTL-PR-AMT TO  RECITM-UNT-RTL-AMT.           21890000
219000     MOVE PURITM-GP-RTL-AMT     TO  RECITM-GP-RTL-AMT.            21900000
219100     MOVE PURITM-GP-QTY         TO  RECITM-GP-QTY.                21910000
219200     MOVE PV-RECITM-ORIG-PKSL-ITM-QTY                             21920000
219300                                TO  RECITM-PKSL-ITM-QTY           21930000
219400                                    RECITM-ORIG-PKSL-ITM-QTY.     21940000
219500                                                                  21950000
219600     MOVE DK-PO-NBR             TO  RECDIS-ORD-NBR.               21960000
219700     MOVE DK-PO-LNE-NBR         TO  RECDIS-ORD-LNE-NBR.           21970000
219800     MOVE PV-NEW-REC-SEQ-NBR    TO  RECDIS-REC-SEQ-NBR.           21980000
219900                                                                  21990000
220000     MOVE RECEIV-OPER-UNT-ID    TO RECDIS-OPER-UNT-ID.            22000000
220100                                                                  22010000
220200     MOVE PC-FCLTY              TO  RECDIS-FCLTY-ID.              22020000
220300     MOVE PC-THRDPRTY           TO  RECDIS-CRE-UID.               22030000
220400     MOVE PC-A                  TO  RECDIS-VER-STATUS-CDE.        22040000
220500     MOVE PV-EXPTED-ITM-UPD-QTY TO  RECDIS-EXPTED-ITM-QTY.        22050000
220600     MOVE PV-VERIFY-ITM-UPD-QTY TO  RECDIS-VERIFY-ITM-QTY         22060000
220700     MOVE PV-AP-VERIFY-ITM-UPD-QTY                                22070000
220800                                TO  RECDIS-AP-VERIFY-ITM-QTY.     22080000
220900     MOVE DK-STR-DEST-NBR       TO  RECDIS-STR-NBR.               22090000
221000     MOVE PC-FCLTY              TO  RECDIS-STR-FCLTY-ID.          22100000
221100     MOVE SPACES                TO  RECDIS-AP-PRC-CDE.            22110000
221200     MOVE PC-DEFAULT-DATE       TO  RECDIS-AP-PRC-DTE.            22120000
221300                                                                  22130000
221400                                                                  22140000
221500*----------------------------------------------------------------*22150000
221600*                                                                *22160000
221700*----------------------------------------------------------------*22170000
221800 5205-BUILD-ITEM-TRECDIS.                                         22180000
221900     IF  PS-TEST-ONLY-DISPLAY-YES                                 22190000
222000         DISPLAY ' RCKUP075 - 5205-BUILD-ITEM-TRECDIS'            22200000
222100         DISPLAY ' RCKUP075 -'                                    22210000
222200                 ' ODD:'  PS-ODD-UNT-CRTN-FOUND-SW                22220000
222300     END-IF.                                                      22230000
222400                                                                  22240000
222500     MOVE DK-PO-NBR             TO  RECDIS-ORD-NBR.               22250000
222600     MOVE DK-PO-LNE-NBR         TO  RECDIS-ORD-LNE-NBR.           22260000
222700     MOVE PV-NEW-REC-SEQ-NBR    TO  RECDIS-REC-SEQ-NBR.           22270000
222800                                                                  22280000
222900     MOVE RECEIV-OPER-UNT-ID    TO RECDIS-OPER-UNT-ID.            22290000
223000                                                                  22300000
223100     MOVE PC-FCLTY              TO  RECDIS-FCLTY-ID.              22310000
223200     MOVE PC-THRDPRTY           TO  RECDIS-CRE-UID.               22320000
223300     MOVE PC-A                  TO  RECDIS-VER-STATUS-CDE.        22330000
223400     MOVE PV-EXPTED-ITM-UPD-QTY TO  RECDIS-EXPTED-ITM-QTY.        22340000
223500     MOVE PV-VERIFY-ITM-UPD-QTY TO  RECDIS-VERIFY-ITM-QTY         22350000
223600                                    RECDIS-AP-VERIFY-ITM-QTY.     22360000
223700     MOVE DK-STR-DEST-NBR       TO  RECDIS-STR-NBR.               22370000
223800     MOVE PC-FCLTY              TO  RECDIS-STR-FCLTY-ID.          22380000
223900     MOVE SPACES                TO  RECDIS-AP-PRC-CDE.            22390000
224000     MOVE PC-DEFAULT-DATE       TO  RECDIS-AP-PRC-DTE.            22400000
224100                                                                  22410000
224200                                                                  22420000
224300*----------------------------------------------------------------*22430000
224400* INSERT THE NEW RECEIVER ITEM - TRECITM                         *22440000
224500*----------------------------------------------------------------*22450000
224600 5210-NEW-TRECITM.                                                22460000
224700     IF  PS-TEST-ONLY-DISPLAY-YES                                 22470000
224800         DISPLAY ' RCKUP075 - 5210-NEW-TRECITM'                   22480000
224900         MOVE RECITM-ORD-NBR     TO PV-DISP-RECITM-ORD-NBR        22490000
225000         MOVE RECITM-ORD-LNE-NBR TO PV-DISP-RECITM-ORD-LNE-NBR    22500000
225100         MOVE RECITM-REC-SEQ-NBR TO PV-DISP-RECITM-REC-SEQ-NBR    22510000
225200         MOVE RECITM-OPER-UNT-ID TO PV-DISP-RECITM-OPER-UNT-ID    22520000
225300         MOVE RECITM-FCLTY-ID    TO PV-DISP-RECITM-FCLTY-ID       22530000
225400         DISPLAY ' RCKUP075 - 5210-'                              22540000
225500                                    PV-DISP-RECITM-OPER-UNT-ID    22550000
225600                 '-'                PV-DISP-RECITM-FCLTY-ID       22560000
225700                 '-'                PV-DISP-RECITM-ORD-NBR        22570000
225800                 '-'                PV-DISP-RECITM-REC-SEQ-NBR    22580000
225900                 '-'                PV-DISP-RECITM-ORD-LNE-NBR    22590000
226000     END-IF.                                                      22600000
226100                                                                  22610000
226200     EXEC SQL                                                     22620000
226300          INSERT INTO TRECITM                                     22630000
226400                 ( ORD_NBR                                        22640000
226500                  ,ORD_LNE_NBR                                    22650000
226600                  ,REC_SEQ_NBR                                    22660000
226700                  ,OPER_UNT_ID                                    22670000
226800                  ,FCLTY_ID                                       22680000
226900                  ,CRE_TMST                                       22690000
227000                  ,CRE_UID                                        22700000
227100                  ,PO_VER_NBR                                     22710000
227200                  ,ITM_NBR                                        22720000
227300                  ,PRE_TKT_IND                                    22730000
227400                  ,TKT_FMT_ID                                     22740000
227500                  ,RTV_IND                                        22750000
227600                  ,STATUS_CDE                                     22760000
227700                  ,VER_STATUS_CDE                                 22770000
227800                  ,DTL_CK_ITM_QTY                                 22780000
227900                  ,INNR_PACK_QTY                                  22790000
228000                  ,CASE_PACK_QTY                                  22800000
228100                  ,RTV_QTY                                        22810000
228200                  ,EXPTED_CART_CNT                                22820000
228300                  ,ACTL_CART_CNT                                  22830000
228400                  ,MKING_APRON_TMST                               22840000
228500                  ,UNT_COST_AMT                                   22850000
228600                  ,COLOR_DESC                                     22860000
228700                  ,SIZE_DESC                                      22870000
228800                  ,VEND_STYL_NAME                                 22880000
228900                  ,VEND_DESC                                      22890000
229000                  ,VERFYD_TMST                                    22900000
229100                  ,PKSL_NBR                                       22910000
229200                  ,REC_INV_LNE_NBR                                22920000
229300                  ,DMG_ITM_QTY                                    22930000
229400                  ,UPD_TMST                                       22940000
229500                  ,UPD_UID                                        22950000
229600                  ,UPD_PGM_ID                                     22960000
229700                  ,RCPT_DISTR_UPD_CDE                             22970000
229800                  ,VRFD_USR_ID                                    22980000
229900                  ,LAST_TRSCP_TMST                                22990000
230000                  ,LAST_TRSCP_USR_ID                              23000000
230100                  ,PREPK_ID                                       23010000
230200                  ,PREPK_RATO_QTY                                 23020000
230300                  ,PREPK_ODD_UNT_QTY                              23030000
230400                  ,PREPK_DRV_LNE_CDE                              23040000
230500                  ,UNT_RTL_AMT                                    23050000
230600                  ,GP_RTL_AMT                                     23060000
230700                  ,GP_QTY                                         23070000
230800                  ,ORIG_PKSL_ITM_QTY                              23080000
230900                  ,PKSL_ITM_QTY                                   23090000
231000                 )                                                23100000
231100         VALUES  (                                                23110000
231200                   :RECITM-ORD-NBR                                23120000
231300                  ,:RECITM-ORD-LNE-NBR                            23130000
231400                  ,:RECITM-REC-SEQ-NBR                            23140000
231500                  ,:RECITM-OPER-UNT-ID                            23150000
231600                  ,:RECITM-FCLTY-ID                               23160000
231700                  , CURRENT TIMESTAMP                             23170000
231800                  ,:RECITM-CRE-UID                                23180000
231900                  ,:RECITM-PO-VER-NBR                             23190000
232000                  ,:RECITM-ITM-NBR                                23200000
232100                  ,:RECITM-PRE-TKT-IND                            23210000
232200                  ,:RECITM-TKT-FMT-ID                             23220000
232300                  ,:RECITM-RTV-IND                                23230000
232400                  ,:RECITM-STATUS-CDE                             23240000
232500                  ,:RECITM-VER-STATUS-CDE                         23250000
232600                  ,:RECITM-DTL-CK-ITM-QTY                         23260000
232700                  ,:RECITM-INNR-PACK-QTY                          23270000
232800                  ,:RECITM-CASE-PACK-QTY                          23280000
232900                  ,:RECITM-RTV-QTY                                23290000
233000                  ,:RECITM-EXPTED-CART-CNT                        23300000
233100                  ,:RECITM-ACTL-CART-CNT                          23310000
233200                  ,:RECITM-MKING-APRON-TMST                       23320000
233300                  ,:RECITM-UNT-COST-AMT                           23330000
233400                  ,:RECITM-COLOR-DESC                             23340000
233500                  ,:RECITM-SIZE-DESC                              23350000
233600                  ,:RECITM-VEND-STYL-NAME                         23360000
233700                  ,:RECITM-VEND-DESC                              23370000
233800                  ,:RECITM-VERFYD-TMST                            23380000
233900                  ,:RECITM-PKSL-NBR                               23390000
234000                  ,:RECITM-REC-INV-LNE-NBR                        23400000
234100                  ,:RECITM-DMG-ITM-QTY                            23410000
234200                  , CURRENT TIMESTAMP                             23420000
234300                  ,:RECITM-UPD-UID                                23430000
234400                  ,:RECITM-UPD-PGM-ID                             23440000
234500                  ,:RECITM-RCPT-DISTR-UPD-CDE                     23450000
234600                  ,:RECITM-VRFD-USR-ID                            23460000
234700                  , CURRENT TIMESTAMP                             23470000
234800                  ,:RECITM-LAST-TRSCP-USR-ID                      23480000
234900                  ,:RECITM-PREPK-ID                               23490000
235000                  ,:RECITM-PREPK-RATO-QTY                         23500000
235100                  ,:RECITM-PREPK-ODD-UNT-QTY                      23510000
235200                  ,:RECITM-PREPK-DRV-LNE-CDE                      23520000
235300                  ,:RECITM-UNT-RTL-AMT                            23530000
235400                  ,:RECITM-GP-RTL-AMT                             23540000
235500                  ,:RECITM-GP-QTY                                 23550000
235600                  ,:RECITM-ORIG-PKSL-ITM-QTY                      23560000
235700                  ,:RECITM-PKSL-ITM-QTY                           23570000
235800                 )                                                23580000
235900         END-EXEC                                                 23590000
236000                                                                  23600000
236100         EVALUATE TRUE                                            23610000
236200             WHEN SQLCODE = +0                                    23620000
236300                 CONTINUE                                         23630000
236400                                                                  23640000
236500             WHEN SQLWARN0 NOT = SPACE                            23650000
236600             WHEN SQLCODE < +0                                    23660000
236700             WHEN SQLCODE > +0                                    23670000
236800                                                                  23680000
236900              SET  PS-ERROR-YES         TO TRUE                   23690000
237000                                                                  23700000
237100              MOVE SQLCODE              TO PV-DISP-SQLCODE        23710000
237200              DISPLAY  ' RCKUP075-5210-'                          23720000
237300                       ' SQL:'             PV-DISP-SQLCODE        23730000
237400                       ' PO:'              RC119-KOHLS-PO-NBR     23740000
237500                       ' STR:'             RC119-DEST-STORE-NBR   23750000
237600                       ' SSCC:'            RC119-SML-NBR-NUM      23760000
237700              DISPLAY  ' RCKUP075-5210-'                          23770000
237800                       ' SML:'             RC119-SML-NBR-NUM      23780000
237900                                                                  23790000
238000              MOVE RECITM-ORD-NBR                                 23800000
238100                                 TO PV-DISP-RECITM-ORD-NBR        23810000
238200              MOVE RECITM-ORD-LNE-NBR                             23820000
238300                                 TO PV-DISP-RECITM-ORD-LNE-NBR    23830000
238400              MOVE RECITM-REC-SEQ-NBR                             23840000
238500                                 TO PV-DISP-RECITM-REC-SEQ-NBR    23850000
238600              MOVE RECITM-OPER-UNT-ID                             23860000
238700                                 TO PV-DISP-RECITM-OPER-UNT-ID    23870000
238800              MOVE RECITM-FCLTY-ID                                23880000
238900                                 TO PV-DISP-RECITM-FCLTY-ID       23890000
239000              DISPLAY ' RCKUP075 - 5210-'                         23900000
239100                               PV-DISP-RECITM-OPER-UNT-ID         23910000
239200                      '-'           PV-DISP-RECITM-FCLTY-ID       23920000
239300                      '-'           PV-DISP-RECITM-ORD-NBR        23930000
239400                      '-'           PV-DISP-RECITM-REC-SEQ-NBR    23940000
239500                      '-'           PV-DISP-RECITM-ORD-LNE-NBR    23950000
239600                                                                  23960000
239700              DISPLAY '*****************************************' 23970000
239800              DISPLAY '*ABEND                                  *' 23980000
239900              DISPLAY '*PROGRAM   = RCKUP075                   *' 23990000
240000              DISPLAY '*DB2 OPER  = INSERT NEW TRECITM         *' 24000000
240100              DISPLAY '*PARAGRAPH = 5210-NEW-TRECITM           *' 24010000
240200              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               24020000
240300              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            24030000
240400              DISPLAY '*****************************************' 24040000
240500              PERFORM 9100-SQL-ABEND                              24050000
240600     END-EVALUATE.                                                24060000
240700                                                                  24070000
240800                                                                  24080000
240900*----------------------------------------------------------------*24090000
241000* INSERT THE NEW RECEIVER ITEM STORE DISTRO - TRECDIS            *24100000
241100*----------------------------------------------------------------*24110000
241200 5220-NEW-TRECDIS.                                                24120000
241300     IF  PS-TEST-ONLY-DISPLAY-YES                                 24130000
241400         DISPLAY ' RCKUP075 - 5220-NEW-TRECDIS'                   24140000
241500         MOVE RECDIS-ORD-NBR     TO PV-DISP-RECDIS-PO-NBR         24150000
241600         MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-RECDIS-TRN-LNE-NBR    24160000
241700         MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-RECDIS-REC-SEQ-NBR    24170000
241800         MOVE RECDIS-OPER-UNT-ID TO PV-DISP-RECDIS-OPER           24180000
241900         MOVE RECDIS-STR-NBR     TO PV-DISP-RECDIS-STR-NBR        24190000
242000         DISPLAY ' RCKUP075 - 5220-'                              24200000
242100                                    PV-DISP-RECDIS-OPER           24210000
242200                 '-'                PV-DISP-RECDIS-PO-NBR         24220000
242300                 '-'                PV-DISP-RECDIS-REC-SEQ-NBR    24230000
242400                 '-'                PV-DISP-RECDIS-TRN-LNE-NBR    24240000
242500                 '-'                PV-DISP-RECDIS-STR-NBR        24250000
242600     END-IF.                                                      24260000
242700                                                                  24270000
242800     EXEC SQL                                                     24280000
242900          INSERT INTO TRECDIS                                     24290000
243000                 ( ORD_NBR                                        24300000
243100                  ,ORD_LNE_NBR                                    24310000
243200                  ,REC_SEQ_NBR                                    24320000
243300                  ,OPER_UNT_ID                                    24330000
243400                  ,FCLTY_ID                                       24340000
243500                  ,CRE_TMST                                       24350000
243600                  ,CRE_UID                                        24360000
243700                  ,VER_STATUS_CDE                                 24370000
243800                  ,EXPTED_ITM_QTY                                 24380000
243900                  ,VERIFY_ITM_QTY                                 24390000
244000                  ,AP_VERIFY_ITM_QTY                              24400000
244100                  ,STR_NBR                                        24410000
244200                  ,STR_FCLTY_ID                                   24420000
244300                  ,PLAN_ITM_QTY                                   24430000
244400                  ,AP_PRC_CDE                                     24440000
244500                  ,AP_PRC_DTE                                     24450000
244600                 )                                                24460000
244700         VALUES  (                                                24470000
244800                   :RECDIS-ORD-NBR                                24480000
244900                  ,:RECDIS-ORD-LNE-NBR                            24490000
245000                  ,:RECDIS-REC-SEQ-NBR                            24500000
245100                  ,:RECDIS-OPER-UNT-ID                            24510000
245200                  ,:RECDIS-FCLTY-ID                               24520000
245300                  , CURRENT TIMESTAMP                             24530000
245400                  ,:RECDIS-CRE-UID                                24540000
245500                  ,:RECDIS-VER-STATUS-CDE                         24550000
245600                  ,:RECDIS-EXPTED-ITM-QTY                         24560000
245700                  ,:RECDIS-VERIFY-ITM-QTY                         24570000
245800                  ,:RECDIS-AP-VERIFY-ITM-QTY                      24580000
245900                  ,:RECDIS-STR-NBR                                24590000
246000                  ,:RECDIS-STR-FCLTY-ID                           24600000
246100                  ,:RECDIS-PLAN-ITM-QTY                           24610000
246200                  ,:RECDIS-AP-PRC-CDE                             24620000
246300                  ,:RECDIS-AP-PRC-DTE                             24630000
246400                 )                                                24640000
246500         END-EXEC                                                 24650000
246600                                                                  24660000
246700         EVALUATE TRUE                                            24670000
246800             WHEN SQLCODE = +0                                    24680000
246900                 CONTINUE                                         24690000
247000                                                                  24700000
247100             WHEN SQLWARN0 NOT = SPACE                            24710000
247200             WHEN SQLCODE < +0                                    24720000
247300             WHEN SQLCODE > +0                                    24730000
247400                                                                  24740000
247500              SET  PS-ERROR-YES         TO TRUE                   24750000
247600                                                                  24760000
247700              MOVE SQLCODE              TO PV-DISP-SQLCODE        24770000
247800              DISPLAY  ' RCKUP075-5220-'                          24780000
247900                       ' SQL:'             PV-DISP-SQLCODE        24790000
248000                       ' PO:'              RC119-KOHLS-PO-NBR     24800000
248100                       ' STR:'             RC119-DEST-STORE-NBR   24810000
248200                       ' SSCC:'            RC119-SML-NBR-NUM      24820000
248300              DISPLAY  ' RCKUP075-5220-'                          24830000
248400                       ' SML:'             RC119-SML-NBR-NUM      24840000
248500                                                                  24850000
248600              MOVE RECDIS-ORD-NBR                                 24860000
248700                                 TO PV-DISP-RECDIS-PO-NBR         24870000
248800              MOVE RECDIS-ORD-LNE-NBR                             24880000
248900                                 TO PV-DISP-RECDIS-TRN-LNE-NBR    24890000
249000              MOVE RECDIS-REC-SEQ-NBR                             24900000
249100                                 TO PV-DISP-RECDIS-REC-SEQ-NBR    24910000
249200              MOVE RECDIS-OPER-UNT-ID                             24920000
249300                                 TO PV-DISP-RECDIS-OPER           24930000
249400              MOVE RECDIS-STR-NBR                                 24940000
249500                                 TO PV-DISP-RECDIS-STR-NBR        24950000
249600              DISPLAY ' RCKUP075 - 5220-'                         24960000
249700                                    PV-DISP-RECDIS-OPER           24970000
249800                      '-'           PV-DISP-RECDIS-PO-NBR         24980000
249900                      '-'           PV-DISP-RECDIS-REC-SEQ-NBR    24990000
250000                      '-'           PV-DISP-RECDIS-TRN-LNE-NBR    25000000
250100                      '-'           PV-DISP-RECDIS-STR-NBR        25010000
250200                                                                  25020000
250300                                                                  25030000
250400              DISPLAY '*****************************************' 25040000
250500              DISPLAY '*ABEND                                  *' 25050000
250600              DISPLAY '*PROGRAM   = RCKUP075                   *' 25060000
250700              DISPLAY '*DB2 OPER  = INSERT NEW TRECDIS         *' 25070000
250800              DISPLAY '*PARAGRAPH = 5220-NEW-TRECDIS           *' 25080000
250900              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               25090000
251000              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            25100000
251100              DISPLAY '*****************************************' 25110000
251200              PERFORM 9100-SQL-ABEND                              25120000
251300     END-EVALUATE.                                                25130000
251400                                                                  25140000
251500                                                                  25150000
251600*----------------------------------------------------------------*25160000
251700* GET INFORMATION FROM PURCHASE ORDER ITEM - TPURITM             *25170000
251800*----------------------------------------------------------------*25180000
251900 5230-GET-PURITM.                                                 25190000
252000     IF  PS-TEST-ONLY-DISPLAY-YES                                 25200000
252100         DISPLAY ' RCKUP075 - 5230-GET-PURITM'                    25210000
252200     END-IF.                                                      25220000
252300                                                                  25230000
252400     MOVE DK-PO-LNE-NBR        TO  PURITM-APP-PO-LNE-NBR          25240000
252500                                                                  25250000
252600     EXEC SQL                                                     25260000
252700          SELECT                                                  25270000
252800                  VER_NBR                                         25280000
252900               ,  ITM_NBR                                         25290000
253000               ,  PIC_ITM_IND                                     25300000
253100               ,  PO_LNE_NBR                                      25310000
253200               ,  VEND_STYL_NAME                                  25320000
253300               ,  SKU_SEQ_NBR                                     25330000
253400               ,   UNT_RTL_PR_AMT                                 25340000
253500               ,  UNT_COST_AMT                                    25350000
253600               ,  GP_RTL_AMT                                      25360000
253700               ,  GP_QTY                                          25370000
253800               ,  INNR_PK_QTY                                     25380000
253900               ,  OUTR_PK_QTY                                     25390000
254000               ,  PO_PREPK_ID                                     25400000
254100               ,  PREPK_RATO_QTY                                  25410000
254200            INTO                                                  25420000
254300                 :PURITM-VER-NBR                                  25430000
254400               , :PURITM-ITM-NBR                                  25440000
254500               , :PURITM-PIC-ITM-IND                              25450000
254600               , :PURITM-PO-LNE-NBR                               25460000
254700               , :PURITM-VEND-STYL-NAME                           25470000
254800               , :PURITM-SKU-SEQ-NBR                              25480000
254900               , :PURITM-UNT-RTL-PR-AMT                           25490000
255000               , :PURITM-UNT-COST-AMT                             25500000
255100               , :PURITM-GP-RTL-AMT                               25510000
255200               , :PURITM-GP-QTY                                   25520000
255300               , :PURITM-INNR-PK-QTY                              25530000
255400               , :PURITM-OUTR-PK-QTY                              25540000
255500               , :PURITM-PO-PREPK-ID                              25550000
255600               , :PURITM-PREPK-RATO-QTY                           25560000
255700            FROM TPURITM                                          25570000
255800           WHERE PO_NBR         = :DK-PO-NBR                      25580000
255900             AND APP_PO_LNE_NBR = :PURITM-APP-PO-LNE-NBR          25590000
256000             AND VER_STATUS_CDE = 'A'                             25600000
256100         END-EXEC                                                 25610000
256200                                                                  25620000
256300         EVALUATE TRUE                                            25630000
256400             WHEN SQLCODE = ZERO                                  25640000
256500                  CONTINUE                                        25650000
256600                                                                  25660000
256700             WHEN SQLWARN0 NOT = SPACE                            25670000
256800             WHEN SQLCODE < +0                                    25680000
256900             WHEN SQLCODE > +0                                    25690000
257000                                                                  25700000
257100              SET  PS-ERROR-YES         TO TRUE                   25710000
257200                                                                  25720000
257300              MOVE SQLCODE              TO PV-DISP-SQLCODE        25730000
257400              MOVE DK-PO-NBR              TO PV-DISP-PO           25740000
257500              MOVE PURITM-APP-PO-LNE-NBR  TO PV-DISP-LINE         25750000
257600              DISPLAY  ' RCKUP075-5230-'                          25760000
257700                       ' SQL:'             PV-DISP-SQLCODE        25770000
257800                       ' PO:'              RC119-KOHLS-PO-NBR     25780000
257900                       ' STR:'             RC119-DEST-STORE-NBR   25790000
258000                       ' SSCC:'            RC119-SML-NBR-NUM      25800000
258100              DISPLAY  ' RCKUP075-5230-'                          25810000
258200                       ' SML:'             RC119-SML-NBR-NUM      25820000
258300              DISPLAY  ' RCKUP075-5230-'                          25830000
258400                       ' PO:'              PV-DISP-PO             25840000
258500                       ' LINE:'            PV-DISP-LINE           25850000
258600                                                                  25860000
258700                                                                  25870000
258800              DISPLAY '*****************************************' 25880000
258900              DISPLAY '*ABEND                                  *' 25890000
259000              DISPLAY '*PROGRAM   = RCKUP075                   *' 25900000
259100              DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 25910000
259200              DISPLAY '*PARAGRAPH = 5230-GET-PURITMS           *' 25920000
259300              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               25930000
259400              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            25940000
259500              DISPLAY '*****************************************' 25950000
259600              PERFORM 9100-SQL-ABEND                              25960000
259700     END-EVALUATE.                                                25970000
259800                                                                  25980000
259900                                                                  25990000
260000*----------------------------------------------------------------*26000000
260100*                                                                *26010000
260200*----------------------------------------------------------------*26020000
260300 5235-CALL-XL-ITEM-MODULE.                                        26030000
260400     IF  PS-TEST-ONLY-DISPLAY-YES                                 26040000
260500         DISPLAY ' RCKUP075 - 5235-CALL-XL-ITEM-MODULE'           26050000
260600     END-IF.                                                      26060000
260700                                                                  26070000
260800     MOVE PURITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             26080000
260900                                                                  26090000
261000     SET  XL001-BY-ITEM                                           26100000
261100          XL001-SELECT-SKU                                        26110000
261200          XL001-SELECT-VND-STYL TO TRUE.                          26120000
261300                                                                  26130000
261400     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               26140000
261500                                                                  26150000
261600     EVALUATE TRUE                                                26160000
261700         WHEN XL001-SKU-SQLCODE = +0                              26170000
261800              PERFORM 5240-XLV-VND-STYL                           26180000
261900                                                                  26190000
262000         WHEN XL001-SKU-SQLCODE = +100                            26200000
262100              MOVE SPACES TO PV-TICKET-DESC                       26210000
262200                                                                  26220000
262300         WHEN OTHER                                               26230000
262400                                                                  26240000
262500              SET  PS-ERROR-YES         TO TRUE                   26250000
262600                                                                  26260000
262700              MOVE XL001-SKU-SQLCODE    TO PV-DISP-SQLCODE        26270000
262800              DISPLAY  ' RCKUP075-5235-'                          26280000
262900                       ' SQL:'             PV-DISP-SQLCODE        26290000
263000                       ' PO:'              RC119-KOHLS-PO-NBR     26300000
263100                       ' STR:'             RC119-DEST-STORE-NBR   26310000
263200                       ' SSCC:'            RC119-SML-NBR-NUM      26320000
263300              DISPLAY  ' RCKUP075-5235-'                          26330000
263400                       ' SML:'             RC119-SML-NBR-NUM      26340000
263500                                                                  26350000
263600              DISPLAY '*****************************************' 26360000
263700              DISPLAY '*ABEND                                  *' 26370000
263800              DISPLAY '*PROGRAM   = RCKUP075                   *' 26380000
263900              DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 26390000
264000              DISPLAY '*PARAGRAPH = 5230-GET-PURITMS           *' 26400000
264100              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               26410000
264200              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            26420000
264300              DISPLAY '*****************************************' 26430000
264400              PERFORM 9100-SQL-ABEND                              26440000
264500     END-EVALUATE.                                                26450000
264600                                                                  26460000
264700                                                                  26470000
264800*----------------------------------------------------------------*26480000
264900*                                                                *26490000
265000*----------------------------------------------------------------*26500000
265100 5240-XLV-VND-STYL.                                               26510000
265200     IF  PS-TEST-ONLY-DISPLAY-YES                                 26520000
265300         DISPLAY ' RCKUP075 - 5240-XLV-VND-STYL'                  26530000
265400     END-IF.                                                      26540000
265500                                                                  26550000
265600     EVALUATE TRUE                                                26560000
265700                                                                  26570000
265800         WHEN XL001-VND-STYL-SQLCODE = +0                         26580000
265900              CONTINUE                                            26590000
266000                                                                  26600000
266100         WHEN XL001-VND-STYL-SQLCODE = +100                       26610000
266200              MOVE SPACES TO PV-TICKET-DESC                       26620000
266300                                                                  26630000
266400         WHEN OTHER                                               26640000
266500                                                                  26650000
266600              SET  PS-ERROR-YES         TO TRUE                   26660000
266700                                                                  26670000
266800              MOVE SQLCODE              TO PV-DISP-SQLCODE        26680000
266900              DISPLAY  ' RCKUP075-5240-'                          26690000
267000                       ' SQL:'             PV-DISP-SQLCODE        26700000
267100                       ' PO:'              RC119-KOHLS-PO-NBR     26710000
267200                       ' STR:'             RC119-DEST-STORE-NBR   26720000
267300                       ' SSCC:'            RC119-SML-NBR-NUM      26730000
267400              DISPLAY  ' RCKUP075-5240-'                          26740000
267500                       ' SML:'             RC119-SML-NBR-NUM      26750000
267600                                                                  26760000
267700                                                                  26770000
267800              DISPLAY '*****************************************' 26780000
267900              DISPLAY '*ABEND                                  *' 26790000
268000              DISPLAY '*PROGRAM   = RCKUP075                   *' 26800000
268100              DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 26810000
268200              DISPLAY '*PARAGRAPH = 5230-GET-PURITMS           *' 26820000
268300              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               26830000
268400              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            26840000
268500              DISPLAY '*****************************************' 26850000
268600              PERFORM 9100-SQL-ABEND                              26860000
268700     END-EVALUATE.                                                26870000
268800                                                                  26880000
268900                                                                  26890000
269000*----------------------------------------------------------------*26900000
269100*                                                                *26910000
269200*----------------------------------------------------------------*26920000
269300 5245-SELECT-PRETICKET-TKT-TYPE.                                  26930000
269400     IF  PS-TEST-ONLY-DISPLAY-YES                                 26940000
269500         DISPLAY ' RCKUP075 - 5245-SELECT-PRETICKET-TKT-TYPE'     26950000
269600     END-IF.                                                      26960000
269700                                                                  26970000
269800     EXEC SQL                                                     26980000
269900          SELECT  B.TKT_DESC                                      26990000
270000               ,  A.ACTL_PRT_DTE                                  27000000
270100               ,  A.PRT_TM                                        27010000
270200            INTO :PTKLNE-TKT-DESC                                 27020000
270300               , :PTKREQ-ACTL-PRT-DTE                             27030000
270400               , :PTKREQ-PRT-TM                                   27040000
270500            FROM TPTKREQ  A                                       27050000
270600               , TPTKLNE  B                                       27060000
270700           WHERE A.PO_NBR     = :DK-PO-NBR                        27070000
270800             AND A.PO_REQ_NBR = B.PO_REQ_NBR                      27080000
270900             AND B.PO_LNE_NBR = :DK-PO-LNE-NBR                    27090000
271000         ORDER BY A.ACTL_PRT_DTE DESC, A.PRT_TM DESC              27100000
271100     END-EXEC.                                                    27110000
271200                                                                  27120000
271300     EVALUATE TRUE                                                27130000
271400         WHEN SQLCODE = +0                                        27140000
271500         WHEN SQLCODE = -811                                      27150000
271600              MOVE PTKLNE-TKT-DESC  TO   PV-TICKET-DESC           27160000
271700              SET PS-PRETICKET TO TRUE                            27170000
271800                                                                  27180000
271900         WHEN SQLCODE = +100                                      27190000
272000              SET PS-NOT-PRETICKET TO TRUE                        27200000
272100                                                                  27210000
272200         WHEN SQLWARN0 NOT = SPACE                                27220000
272300         WHEN SQLCODE NOT = ZERO                                  27230000
272400                                                                  27240000
272500              SET  PS-ERROR-YES         TO TRUE                   27250000
272600                                                                  27260000
272700              MOVE SQLCODE              TO PV-DISP-SQLCODE        27270000
272800              DISPLAY  ' RCKUP075-5245-'                          27280000
272900                       ' SQL:'             PV-DISP-SQLCODE        27290000
273000                       ' PO:'              RC119-KOHLS-PO-NBR     27300000
273100                       ' STR:'             RC119-DEST-STORE-NBR   27310000
273200                       ' SSCC:'            RC119-SML-NBR-NUM      27320000
273300              DISPLAY  ' RCKUP075-5245-'                          27330000
273400                       ' SML:'             RC119-SML-NBR-NUM      27340000
273500                                                                  27350000
273600              DISPLAY '*****************************************' 27360000
273700              DISPLAY '*ABEND                                  *' 27370000
273800              DISPLAY '*PROGRAM   = RCKUP075                   *' 27380000
273900              DISPLAY '*DB2 OPER  = SELECT TPTKREQ  TPTKLNE    *' 27390000
274000              DISPLAY '*PARAGRAPH = 5245-SELECT-PRETICKET-TKT  *' 27400000
274100              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               27410000
274200              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            27420000
274300              DISPLAY '*****************************************' 27430000
274400              PERFORM 9100-SQL-ABEND                              27440000
274500     END-EVALUATE.                                                27450000
274600                                                                  27460000
274700                                                                  27470000
274800*----------------------------------------------------------------*27480000
274900*                                                                *27490000
275000*----------------------------------------------------------------*27500000
275100 5250-SELECT-TKT-FMT-ID.                                          27510000
275200     IF  PS-TEST-ONLY-DISPLAY-YES                                 27520000
275300         DISPLAY ' RCKUP075 - 5250-SELECT-TKT-FMT-ID'             27530000
275400     END-IF.                                                      27540000
275500                                                                  27550000
275600      EXEC SQL                                                    27560000
275700          SELECT DISTINCT TKT_FMT_ID                              27570000
275800            INTO :TKTFMT-TKT-FMT-ID                               27580000
275900            FROM TTKTFMT                                          27590000
276000           WHERE TKT_FMT_DESC = :PV-TICKET-DESC                   27600000
276100     END-EXEC                                                     27610000
276200                                                                  27620000
276300     EVALUATE TRUE                                                27630000
276400         WHEN SQLCODE = +0                                        27640000
276500              MOVE TKTFMT-TKT-FMT-ID  TO PV-TKT-FMT-ID            27650000
276600                                                                  27660000
276700         WHEN SQLCODE = +100                                      27670000
276800              MOVE SPACES        TO PV-TKT-FMT-ID                 27680000
276900                                                                  27690000
277000         WHEN SQLWARN0 NOT = SPACES                               27700000
277100         WHEN SQLCODE  NOT = ZERO                                 27710000
277200                                                                  27720000
277300              SET  PS-ERROR-YES         TO TRUE                   27730000
277400                                                                  27740000
277500              MOVE SQLCODE              TO PV-DISP-SQLCODE        27750000
277600              DISPLAY  ' RCKUP075-5250-'                          27760000
277700                       ' SQL:'             PV-DISP-SQLCODE        27770000
277800                       ' PO:'              RC119-KOHLS-PO-NBR     27780000
277900                       ' STR:'             RC119-DEST-STORE-NBR   27790000
278000                       ' SSCC:'            RC119-SML-NBR-NUM      27800000
278100              DISPLAY  ' RCKUP075-5250-'                          27810000
278200                       ' SML:'             RC119-SML-NBR-NUM      27820000
278300                                                                  27830000
278400              DISPLAY '*****************************************' 27840000
278500              DISPLAY '*ABEND                                  *' 27850000
278600              DISPLAY '*PROGRAM   = RCKUP075                   *' 27860000
278700              DISPLAY '*DB2 OPER  = SELECT TTKTFMT             *' 27870000
278800              DISPLAY '*PARAGRAPH = 5250-SELECT-TKT-FMT-ID     *' 27880000
278900              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               27890000
279000              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            27900000
279100              DISPLAY '*****************************************' 27910000
279200              PERFORM 9100-SQL-ABEND                              27920000
279300                                                                  27930000
279400     END-EVALUATE.                                                27940000
279500                                                                  27950000
279600                                                                  27960000
279700*----------------------------------------------------------------*27970000
279800*                                                                *27980000
279900*----------------------------------------------------------------*27990000
280000 6000-PROCESS-BULK-PREPK.                                         28000000
280100     IF  PS-TEST-ONLY-DISPLAY-YES                                 28010000
280200         DISPLAY ' RCKUP075 - 6000-PROCESS-BULK-PREPK'            28020000
280300     END-IF.                                                      28030000
280400                                                                  28040000
280500     IF  PS-BULK                                                  28050000
280600         PERFORM 6010-BY-LINE-ROUTINE                             28060000
280700     ELSE                                                         28070000
280800         IF  PS-FIRST-PREPK-LINE-YES                              28080000
280900****         PERFORM 6300-CHECK-IF-ODD-UNIT-CARTON                28090000
281000             PERFORM 6010-BY-LINE-ROUTINE                         28100000
281100             SET PS-FIRST-PREPK-LINE-NO TO TRUE                   28110000
281200         ELSE                                                     28120000
281300             PERFORM 6010-BY-LINE-ROUTINE                         28130000
281400         END-IF                                                   28140000
281500     END-IF.                                                      28150000
281600                                                                  28160000
281700                                                                  28170000
281800*----------------------------------------------------------------*28180000
281900*                                                                *28190000
282000*----------------------------------------------------------------*28200000
282100 6010-BY-LINE-ROUTINE.                                            28210000
282200     IF  PS-TEST-ONLY-DISPLAY-YES                                 28220000
282300         DISPLAY ' RCKUP075 - 6010-BY-LINE-ROUTINE'               28230000
282400     END-IF.                                                      28240000
282500                                                                  28250000
282600     MOVE  ZEROES               TO  PV-OUTER-QTY                  28260000
282700                                    PV-TRN-LNE-NBR                28270000
282800                                    DK-PO-LNE-NBR                 28280000
282900                                    PV-HOLD-TRN-LNE-NBR.          28290000
283000                                                                  28300000
283100     MOVE RC119-KOHLS-PO-LINE-NBR  TO  DK-PO-LNE-NBR.             28310000
283200                                                                  28320000
283300     SET PS-NOT-FOUND-ON-CURSOR                                   28330000
283400         PS-FIRST-PO-LINE-FOR-CTN TO TRUE.                        28340000
283500                                                                  28350000
283600                                                                  28360000
283700     PERFORM 5100-SELECT-RECITM-RECDIS.                           28370000
283800                                                                  28380000
283900     IF  PS-NEW-RECITM-FOUND                                      28390000
284000         COMPUTE PV-EXPTED-ITM-UPD-QTY =                          28400000
284100             (RECDIS-EXPTED-ITM-QTY + RC119-SHIP-UNT-QTY)         28410000
284200                                                                  28420000
284300         COMPUTE PV-VERIFY-ITM-UPD-QTY =                          28430000
284400             (RECDIS-VERIFY-ITM-QTY + RC119-SHIP-UNT-QTY)         28440000
284500                                                                  28450000
284600         COMPUTE PV-AP-VERIFY-ITM-UPD-QTY =                       28460000
284700             (RECDIS-AP-VERIFY-ITM-QTY + RC119-SHIP-UNT-QTY)      28470000
284800                                                                  28480000
284900         COMPUTE RECDIS-PLAN-ITM-QTY   =                          28490000
285000             (RECDIS-PLAN-ITM-QTY      + RC119-SHIP-UNT-QTY)      28500000
285100                                                                  28510000
285200         IF  PS-TEST-ONLY-DISPLAY-YES                             28520000
285300             DISPLAY ' RCKUP075 - 6010-BY-LINE-ROUTINE'           28530000
285400             DISPLAY ' RCKUP075 - 6010-  PS-NEW-RECITM-FOUND'     28540000
285500             MOVE RECITM-PREPK-ODD-UNT-QTY                        28550000
285600                                 TO PV-DISP-RECITM-ODD-QTY        28560000
285700             MOVE PV-RECITM-PREPK-ODD-UNT-QTY                     28570000
285800                                 TO PV-DISP-PV-RECITM-ODD-QTY     28580000
285900             MOVE RC119-SHIP-UNT-QTY                              28590000
286000                                 TO PV-DISP-SHIP-UNT-QTY          28600000
286100             DISPLAY ' RCKUP075 - 6010-'                          28610000
286200                     ' ODD SW:'     PS-ODD-UNT-CRTN-FOUND-SW      28620000
286300             DISPLAY ' RECITM ODD:' PV-DISP-RECITM-ODD-QTY        28630000
286400             DISPLAY ' PV-ODD:' PV-DISP-PV-RECITM-ODD-QTY         28640000
286500             DISPLAY ' QTY:'    PV-DISP-SHIP-UNT-QTY              28650000
286600         END-IF                                                   28660000
286700                                                                  28670000
286800         IF  PS-ODD-UNT-CRTN-FOUND                                28680000
286900             MOVE ZEROES  TO  PV-VE-CARTON-LINE-ODD-UNITS         28690000
287000             PERFORM VARYING LINE-INX FROM 1 BY 1                 28700000
287100               UNTIL LINE-INX  >  PV-LINE-TABLE-ROWS              28710000
287200                  OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS          28720000
287300                     IF  RC119-KOHLS-PO-LINE-NBR                  28730000
287400                            = TBL-LINE-NBR(LINE-INX)              28740000
287500                         MOVE TBL-ODD-UNITS(LINE-INX)             28750000
287600                           TO PV-VE-CARTON-LINE-ODD-UNITS         28760000
287700                     END-IF                                       28770000
287800             END-PERFORM                                          28780000
287900                                                                  28790000
288000             COMPUTE PV-RECITM-PREPK-ODD-UNT-QTY  =               28800000
288100                 (RECITM-PREPK-ODD-UNT-QTY +                      28810000
288200                  PV-VE-CARTON-LINE-ODD-UNITS)                    28820000
288300         ELSE                                                     28830000
288400             COMPUTE PV-RECITM-ORIG-PKSL-ITM-QTY  =               28840000
288500                 (RECITM-ORIG-PKSL-ITM-QTY + RC119-SHIP-UNT-QTY)  28850000
288600             MOVE RECITM-PREPK-ODD-UNT-QTY                        28860000
288700               TO PV-RECITM-PREPK-ODD-UNT-QTY                     28870000
288800         END-IF                                                   28880000
288900                                                                  28890000
289000         IF  PS-TEST-ONLY-DISPLAY-YES                             28900000
289100             DISPLAY ' RCKUP075 - 6010-BY-LINE-ROUTINE'           28910000
289200             MOVE RECITM-PREPK-ODD-UNT-QTY                        28920000
289300                                 TO PV-DISP-RECITM-ODD-QTY        28930000
289400             MOVE PV-RECITM-PREPK-ODD-UNT-QTY                     28940000
289500                                 TO PV-DISP-PV-RECITM-ODD-QTY     28950000
289600             MOVE RC119-SHIP-UNT-QTY                              28960000
289700                                 TO PV-DISP-SHIP-UNT-QTY          28970000
289800             DISPLAY ' RCKUP075 - 6010-'                          28980000
289900                     ' ODD SW:'     PS-ODD-UNT-CRTN-FOUND-SW      28990000
290000             DISPLAY ' RECITM ODD:' PV-DISP-RECITM-ODD-QTY        29000000
290100             DISPLAY ' PV-ODD:' PV-DISP-PV-RECITM-ODD-QTY         29010000
290200             DISPLAY ' QTY:'    PV-DISP-SHIP-UNT-QTY              29020000
290300         END-IF                                                   29030000
290400                                                                  29040000
290500         MOVE  PV-RECITM-ORIG-PKSL-ITM-QTY                        29050000
290600                                   TO RECITM-ORIG-PKSL-ITM-QTY    29060000
290700         MOVE  PV-RECITM-PREPK-ODD-UNT-QTY                        29070000
290800                                   TO RECITM-PREPK-ODD-UNT-QTY    29080000
290900         MOVE  PV-RECITM-ORIG-PKSL-ITM-QTY                        29090000
291000                                   TO RECITM-PKSL-ITM-QTY         29100000
291100                                                                  29110000
291200         ADD  1  TO  RECITM-EXPTED-CART-CNT                       29120000
291300         ADD  1  TO  RECITM-ACTL-CART-CNT                         29130000
291400                                                                  29140000
291500                                                                  29150000
291600         PERFORM 5110-UPDATE-TRECITM                              29160000
291700         PERFORM 5120-UPDATE-TRECDIS                              29170000
291800                                                                  29180000
291900     ELSE                                                         29190000
292000     IF  PS-RECITM-YES-RECDIS-NO                                  29200000
292100*        UPDATE TRECITM                                           29210000
292200         IF  PS-TEST-ONLY-DISPLAY-YES                             29220000
292300             DISPLAY ' RCKUP075 - 6010-BY-LINE-ROUTINE'           29230000
292400             DISPLAY ' RCKUP075 - 6010-  PS-NEW-RECITM-FOUND'     29240000
292500                                      '  NO TRECDIS'              29250000
292600             MOVE RECITM-PREPK-ODD-UNT-QTY                        29260000
292700                                 TO PV-DISP-RECITM-ODD-QTY        29270000
292800             MOVE PV-RECITM-PREPK-ODD-UNT-QTY                     29280000
292900                                 TO PV-DISP-PV-RECITM-ODD-QTY     29290000
293000             MOVE RC119-SHIP-UNT-QTY                              29300000
293100                                 TO PV-DISP-SHIP-UNT-QTY          29310000
293200             DISPLAY ' RCKUP075 - 6010-'                          29320000
293300                     ' ODD SW:'     PS-ODD-UNT-CRTN-FOUND-SW      29330000
293400             DISPLAY ' RECITM ODD:' PV-DISP-RECITM-ODD-QTY        29340000
293500             DISPLAY ' PV-ODD:' PV-DISP-PV-RECITM-ODD-QTY         29350000
293600             DISPLAY ' QTY:'    PV-DISP-SHIP-UNT-QTY              29360000
293700         END-IF                                                   29370000
293800                                                                  29380000
293900         IF  PS-ODD-UNT-CRTN-FOUND                                29390000
294000             MOVE ZEROES  TO  PV-VE-CARTON-LINE-ODD-UNITS         29400000
294100             PERFORM VARYING LINE-INX FROM 1 BY 1                 29410000
294200               UNTIL LINE-INX  >  PV-LINE-TABLE-ROWS              29420000
294300                  OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS          29430000
294400                     IF  RC119-KOHLS-PO-LINE-NBR                  29440000
294500                            = TBL-LINE-NBR(LINE-INX)              29450000
294600                         MOVE TBL-ODD-UNITS(LINE-INX)             29460000
294700                           TO PV-VE-CARTON-LINE-ODD-UNITS         29470000
294800                     END-IF                                       29480000
294900             END-PERFORM                                          29490000
295000                                                                  29500000
295100             COMPUTE PV-RECITM-PREPK-ODD-UNT-QTY  =               29510000
295200                 (RECITM-PREPK-ODD-UNT-QTY +                      29520000
295300                  PV-VE-CARTON-LINE-ODD-UNITS)                    29530000
295400         ELSE                                                     29540000
295500             COMPUTE PV-RECITM-ORIG-PKSL-ITM-QTY  =               29550000
295600                 (RECITM-ORIG-PKSL-ITM-QTY + RC119-SHIP-UNT-QTY)  29560000
295700             MOVE RECITM-PREPK-ODD-UNT-QTY                        29570000
295800               TO PV-RECITM-PREPK-ODD-UNT-QTY                     29580000
295900         END-IF                                                   29590000
296000                                                                  29600000
296100         IF  PS-TEST-ONLY-DISPLAY-YES                             29610000
296200             DISPLAY ' RCKUP075 - 6010-BY-LINE-ROUTINE'           29620000
296300             MOVE RECITM-PREPK-ODD-UNT-QTY                        29630000
296400                                 TO PV-DISP-RECITM-ODD-QTY        29640000
296500             MOVE PV-RECITM-PREPK-ODD-UNT-QTY                     29650000
296600                                 TO PV-DISP-PV-RECITM-ODD-QTY     29660000
296700             MOVE RC119-SHIP-UNT-QTY                              29670000
296800                                 TO PV-DISP-SHIP-UNT-QTY          29680000
296900             DISPLAY ' RCKUP075 - 6010-'                          29690000
297000                     ' ODD SW:'     PS-ODD-UNT-CRTN-FOUND-SW      29700000
297100             DISPLAY ' RECITM ODD:' PV-DISP-RECITM-ODD-QTY        29710000
297200             DISPLAY ' PV-ODD:' PV-DISP-PV-RECITM-ODD-QTY         29720000
297300             DISPLAY ' QTY:'    PV-DISP-SHIP-UNT-QTY              29730000
297400         END-IF                                                   29740000
297500                                                                  29750000
297600         MOVE  PV-RECITM-ORIG-PKSL-ITM-QTY                        29760000
297700                                   TO RECITM-ORIG-PKSL-ITM-QTY    29770000
297800         MOVE  PV-RECITM-PREPK-ODD-UNT-QTY                        29780000
297900                                   TO RECITM-PREPK-ODD-UNT-QTY    29790000
298000         MOVE  PV-RECITM-ORIG-PKSL-ITM-QTY                        29800000
298100                                   TO RECITM-PKSL-ITM-QTY         29810000
298200                                                                  29820000
298300         ADD  1  TO  RECITM-EXPTED-CART-CNT                       29830000
298400         ADD  1  TO  RECITM-ACTL-CART-CNT                         29840000
298500                                                                  29850000
298600         PERFORM 5110-UPDATE-TRECITM                              29860000
298700                                                                  29870000
298800*        INSERT TRECDIS                                           29880000
298900         MOVE RC119-SHIP-UNT-QTY  TO PV-EXPTED-ITM-UPD-QTY        29890000
299000                                                                  29900000
299100         MOVE RC119-SHIP-UNT-QTY  TO PV-VERIFY-ITM-UPD-QTY        29910000
299200                                                                  29920000
299300         MOVE RC119-SHIP-UNT-QTY  TO RECDIS-PLAN-ITM-QTY          29930000
299400         PERFORM 5205-BUILD-ITEM-TRECDIS                          29940000
299500         PERFORM 5220-NEW-TRECDIS                                 29950000
299600                                                                  29960000
299700     ELSE                                                         29970000
299800                                                                  29980000
299900         MOVE RC119-SHIP-UNT-QTY  TO PV-EXPTED-ITM-UPD-QTY        29990000
300000                                                                  30000000
300100         MOVE RC119-SHIP-UNT-QTY  TO PV-VERIFY-ITM-UPD-QTY        30010000
300200                                                                  30020000
300300         MOVE RC119-SHIP-UNT-QTY  TO RECDIS-PLAN-ITM-QTY          30030000
300400                                                                  30040000
300500         IF  PS-ODD-UNT-CRTN-FOUND                                30050000
300600             MOVE RC119-SHIP-UNT-QTY                              30060000
300700                                  TO PV-RECITM-PREPK-ODD-UNT-QTY  30070000
300800         ELSE                                                     30080000
300900             MOVE RC119-SHIP-UNT-QTY                              30090000
301000                                  TO PV-RECITM-ORIG-PKSL-ITM-QTY  30100000
301100             MOVE ZEROES          TO PV-RECITM-PREPK-ODD-UNT-QTY  30110000
301200                                     RECITM-PREPK-ODD-UNT-QTY     30120000
301300         END-IF                                                   30130000
301400                                                                  30140000
301500         MOVE RC119-SHIP-UNT-QTY  TO PV-AP-VERIFY-ITM-UPD-QTY     30150000
301600                                                                  30160000
301700         PERFORM 5200-BUILD-ITEM-DISTRO                           30170000
301800         PERFORM 5210-NEW-TRECITM                                 30180000
301900         PERFORM 5220-NEW-TRECDIS                                 30190000
302000                                                                  30200000
302100     END-IF                                                       30210000
302200     END-IF.                                                      30220000
302300                                                                  30230000
302400                                                                  30240000
302500*----------------------------------------------------------------*30250000
302600*                                                                *30260000
302700*----------------------------------------------------------------*30270000
302800*6120-OPEN-PREPK-CSR.                                             30280000
302900*    IF  PS-TEST-ONLY-DISPLAY-YES                                 30290000
303000*        DISPLAY ' RCKUP075 - 6120-OPEN-PREPK-CSR'                30300000
303100*    END-IF.                                                      30310000
303200*                                                                 30320000
303300*    EXEC SQL                                                     30330000
303400*         OPEN PREPK-CSR                                          30340000
303500*    END-EXEC.                                                    30350000
303600*                                                                 30360000
303700*    EVALUATE TRUE                                                30370000
303800*        WHEN SQLCODE = ZERO                                      30380000
303900*            CONTINUE                                             30390000
304000*        WHEN SQLWARN0 NOT = SPACES                               30400000
304100*        WHEN SQLCODE NOT EQUAL ZERO                              30410000
304200*                                                                 30420000
304300*             SET  PS-ERROR-YES         TO TRUE                   30430000
304400*                                                                 30440000
304500*             MOVE SQLCODE              TO PV-DISP-SQLCODE        30450000
304600*             DISPLAY  ' RCKUP075-6120-'                          30460000
304700*                      ' SQL:'             PV-DISP-SQLCODE        30470000
304800*                      ' PO:'              RC119-KOHLS-PO-NBR     30480000
304900*                      ' STR:'             RC119-DEST-STORE-NBR   30490000
305000*                      ' SSCC:'            RC119-SML-NBR-NUM      30500000
305100*             DISPLAY  ' RCKUP075-6120-'                          30510000
305200*                      ' SML:'             RC119-SML-NBR-NUM      30520000
305300*                                                                 30530000
305400*             DISPLAY '*****************************************' 30540000
305500*             DISPLAY '*ABEND                                  *' 30550000
305600*             DISPLAY '*PROGRAM   = RCKUP075                   *' 30560000
305700*             DISPLAY '*DB2 OPER  = SELECT TSHUUPC             *' 30570000
305800*             DISPLAY '*DB2 OPER  = SELECT TINPKSU             *' 30580000
305900*             DISPLAY '*DB2 OPER  = SELECT TPKSLIP             *' 30590000
306000*             DISPLAY '*DB2 OPER  = SELECT TRECITM             *' 30600000
306100*             DISPLAY '*PARAGRAPH = 6120-OPEN-PREPK-CSR        *' 30610000
306200*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               30620000
306300*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            30630000
306400*             DISPLAY '*****************************************' 30640000
306500*             PERFORM 9100-SQL-ABEND                              30650000
306600*                                                                 30660000
306700*    END-EVALUATE.                                                30670000
306800*                                                                 30680000
306900*                                                                 30690000
307000*----------------------------------------------------------------*30700000
307100*                                                                *30710000
307200*----------------------------------------------------------------*30720000
307300*6125-FETCH-PREPK-CSR.                                            30730000
307400*    IF  PS-TEST-ONLY-DISPLAY-YES                                 30740000
307500*        DISPLAY ' RCKUP075 - 6125-FETCH-PREPK-CSR'               30750000
307600*    END-IF.                                                      30760000
307700*                                                                 30770000
307800*    EXEC SQL                                                     30780000
307900*         FETCH  PREPK-CSR                                        30790000
308000*          INTO :RECITM-PREPK-ID                                  30800000
308100*             , :RECITM-PREPK-RATO-QTY                            30810000
308200*             , :PV-SHUUPC-QTY-DR-LNE                             30820000
308300*    END-EXEC.                                                    30830000
308400*                                                                 30840000
308500*    EVALUATE TRUE                                                30850000
308600*      WHEN SQLCODE = ZEROS                                       30860000
308700*           SET PS-FOUND-ON-CURSOR TO TRUE                        30870000
308800*           DIVIDE PV-SHUUPC-QTY-DR-LNE                           30880000
308900*               BY RECITM-PREPK-RATO-QTY                          30890000
309000*           GIVING PV-MULTIPLE REMAINDER PV-REMAINDER             30900000
309100*           IF  PV-REMAINDER = 0                                  30910000
309200*               IF  PS-FIRST-PREPK                                30920000
309300*                   MOVE PV-MULTIPLE TO PV-HOLD-MULTIPLE          30930000
309400*                   SET PS-NOT-FIRST-PREPK TO TRUE                30940000
309500*               END-IF                                            30950000
309600*           ELSE                                                  30960000
309700*               SET PS-ODD-UNT-CRTN-FOUND TO TRUE                 30970000
309800*           END-IF                                                30980000
309900*           IF  PV-MULTIPLE NOT EQUAL PV-HOLD-MULTIPLE            30990000
310000*               SET PS-ODD-UNT-CRTN-FOUND TO TRUE                 31000000
310100*           END-IF                                                31010000
310200*                                                                 31020000
310300*      WHEN SQLCODE = +100                                        31030000
310400*           SET  PS-EO-PREPK-CSR TO TRUE                          31040000
310500*                                                                 31050000
310600*      WHEN OTHER                                                 31060000
310700*                                                                 31070000
310800*             SET  PS-ERROR-YES         TO TRUE                   31080000
310900*                                                                 31090000
311000*             MOVE SQLCODE              TO PV-DISP-SQLCODE        31100000
311100*             DISPLAY  ' RCKUP075-6125-'                          31110000
311200*                      ' SQL:'             PV-DISP-SQLCODE        31120000
311300*                      ' PO:'              RC119-KOHLS-PO-NBR     31130000
311400*                      ' STR:'             RC119-DEST-STORE-NBR   31140000
311500*                      ' SSCC:'            RC119-SML-NBR-NUM      31150000
311600*             DISPLAY  ' RCKUP075-6125-'                          31160000
311700*                      ' SML:'             RC119-SML-NBR-NUM      31170000
311800*                                                                 31180000
311900*             DISPLAY '*****************************************' 31190000
312000*             DISPLAY '*ABEND                                  *' 31200000
312100*             DISPLAY '*PROGRAM   = RCKUP075                   *' 31210000
312200*             DISPLAY '*DB2 OPER  = SELECT TSHUUPC             *' 31220000
312300*             DISPLAY '*DB2 OPER  = SELECT TINPKSU             *' 31230000
312400*             DISPLAY '*DB2 OPER  = SELECT TPKSLIP             *' 31240000
312500*             DISPLAY '*DB2 OPER  = SELECT TRECITM             *' 31250000
312600*             DISPLAY '*PARAGRAPH = 6125-FETCH-PREPK-CSR       *' 31260000
312700*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               31270000
312800*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            31280000
312900*             DISPLAY '*****************************************' 31290000
313000*             PERFORM 9100-SQL-ABEND                              31300000
313100*                                                                 31310000
313200*    END-EVALUATE.                                                31320000
313300*                                                                 31330000
313400*                                                                 31340000
313500*----------------------------------------------------------------*31350000
313600*                                                                *31360000
313700*----------------------------------------------------------------*31370000
313800*6130-CLOSE-PREPK-CSR.                                            31380000
313900*    IF  PS-TEST-ONLY-DISPLAY-YES                                 31390000
314000*        DISPLAY ' RCKUP075 - 6130-CLOSE-PREPK-CSR'               31400000
314100*    END-IF.                                                      31410000
314200*                                                                 31420000
314300*    EXEC SQL                                                     31430000
314400*         CLOSE PREPK-CSR                                         31440000
314500*    END-EXEC.                                                    31450000
314600*                                                                 31460000
314700*    EVALUATE TRUE                                                31470000
314800*        WHEN SQLCODE = ZERO                                      31480000
314900*            CONTINUE                                             31490000
315000*        WHEN SQLWARN0 NOT = SPACES                               31500000
315100*        WHEN SQLCODE NOT EQUAL ZERO                              31510000
315200*                                                                 31520000
315300*             SET  PS-ERROR-YES         TO TRUE                   31530000
315400*                                                                 31540000
315500*             MOVE SQLCODE              TO PV-DISP-SQLCODE        31550000
315600*             DISPLAY  ' RCKUP075-6130-'                          31560000
315700*                      ' SQL:'             PV-DISP-SQLCODE        31570000
315800*                      ' PO:'              RC119-KOHLS-PO-NBR     31580000
315900*                      ' STR:'             RC119-DEST-STORE-NBR   31590000
316000*                      ' SSCC:'            RC119-SML-NBR-NUM      31600000
316100*             DISPLAY  ' RCKUP075-6130-'                          31610000
316200*                      ' SML:'             RC119-SML-NBR-NUM      31620000
316300*                                                                 31630000
316400*             DISPLAY '*****************************************' 31640000
316500*             DISPLAY '*ABEND                                  *' 31650000
316600*             DISPLAY '*PROGRAM   = RCKUP075                   *' 31660000
316700*             DISPLAY '*DB2 OPER  = SELECT TSHUUPC             *' 31670000
316800*             DISPLAY '*DB2 OPER  = SELECT TINPKSU             *' 31680000
316900*             DISPLAY '*DB2 OPER  = SELECT TPKSLIP             *' 31690000
317000*             DISPLAY '*DB2 OPER  = SELECT TRECITM             *' 31700000
317100*             DISPLAY '*PARAGRAPH = 6130-CLOSE-PREPK-CSR       *' 31710000
317200*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               31720000
317300*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            31730000
317400*             DISPLAY '*****************************************' 31740000
317500*             PERFORM 9100-SQL-ABEND                              31750000
317600*    END-EVALUATE.                                                31760000
317700*                                                                 31770000
317800*                                                                 31780000
317900*----------------------------------------------------------------*31790000
318000* FOR PREPACK ORDER - CHECK IF THE CARTON IS AN ODD UNIT CARTON  *31800000
318100*----------------------------------------------------------------*31810000
318200*6300-CHECK-IF-ODD-UNIT-CARTON.                                   31820000
318300*    IF  PS-TEST-ONLY-DISPLAY-YES                                 31830000
318400*        DISPLAY ' RCKUP075 - 6300-CHECK-IF-ODD-UNIT-CARTON'      31840000
318500*    END-IF.                                                      31850000
318600*                                                                 31860000
318700*    SET PS-ODD-UNT-CRTN-FOUND-NO   TO  TRUE.                     31870000
318800*    PERFORM 6310-DETERMINE-PREPK-NBR.                            31880000
318900*                                                                 31890000
319000*    IF  PS-TEST-ONLY-DISPLAY-YES                                 31900000
319100*        MOVE  DK-PREPK-ID   TO  PV-DISP-PREPK-ID                 31910000
319200*        DISPLAY ' RCKUP075 - 6300-'                              31920000
319300*                ' PREPK:'       PV-DISP-PREPK-ID                 31930000
319400*    END-IF.                                                      31940000
319500*                                                                 31950000
319600*    IF  PS-ODD-UNT-CRTN-FOUND                                    31960000
319700*        CONTINUE                                                 31970000
319800*    ELSE                                                         31980000
319900*        PERFORM 6320-BUILD-PREPACK-LINE-TABLE                    31990000
320000*    END-IF.                                                      32000000
320100*                                                                 32010000
320200*    IF  PS-ODD-UNT-CRTN-FOUND                                    32020000
320300*        CONTINUE                                                 32030000
320400*    ELSE                                                         32040000
320500*        PERFORM 6360-CHECK-PACKS                                 32050000
320600*    END-IF.                                                      32060000
320700*                                                                 32070000
320800*                                                                 32080000
320900*                                                                 32090000
321000*----------------------------------------------------------------*32100000
321100* DETERMINE THE PREPACK THE CARTON IS FOR BASED ON THE CARTON    *32110000
321200* CONTENTS.  IF MULTIPLE PREPACK IDS ARE RETURNED FROM PURITM    *32120000
321300* THE CARTON IS AN ODD UNIT CARTON AND NO FURTHER CHECKING WILL  *32130000
321400* BE NEEDED                                                      *32140000
321500*----------------------------------------------------------------*32150000
321600*6310-DETERMINE-PREPK-NBR.                                        32160000
321700*    IF  PS-TEST-ONLY-DISPLAY-YES                                 32170000
321800*        DISPLAY ' RCKUP075 - 6310-DETERMINE-PREPK-NBR'           32180000
321900*    END-IF.                                                      32190000
322000*                                                                 32200000
322100*    MOVE  RC119-SML-NBR-NUM   TO  DK-SHIPT-UNT-ID.               32210000
322200*                                                                 32220000
322300*    EXEC SQL                                                     32230000
322400*         SELECT  DISTINCT(A.PO_PREPK_ID)                         32240000
322500*           INTO :DK-PREPK-ID                                     32250000
322600*           FROM  TPURITM A                                       32260000
322700*              ,  TSHUUPC B                                       32270000
322800*          WHERE  B.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              32280000
322900*            AND  B.TRN_NBR       = A.PO_NBR                      32290000
323000*            AND  B.TRN_LNE_NBR   = A.APP_PO_LNE_NBR              32300000
323100*           WITH UR                                               32310000
323200*    END-EXEC                                                     32320000
323300*                                                                 32330000
323400*    EVALUATE TRUE                                                32340000
323500*        WHEN SQLCODE = ZERO                                      32350000
323600*             CONTINUE                                            32360000
323700*        WHEN SQLCODE = -811                                      32370000
323800*             SET  PS-ODD-UNT-CRTN-FOUND   TO  TRUE               32380000
323900*        WHEN SQLWARN0 NOT = SPACES                               32390000
324000*        WHEN SQLCODE  < ZERO                                     32400000
324100*        WHEN SQLCODE  > ZERO                                     32410000
324200*                                                                 32420000
324300*             SET  PS-ERROR-YES         TO TRUE                   32430000
324400*                                                                 32440000
324500*             MOVE SQLCODE              TO PV-DISP-SQLCODE        32450000
324600*             DISPLAY  ' RCKUP075-6310-'                          32460000
324700*                      ' SQL:'             PV-DISP-SQLCODE        32470000
324800*                      ' PO:'              RC119-KOHLS-PO-NBR     32480000
324900*                      ' STR:'             RC119-DEST-STORE-NBR   32490000
325000*                      ' SSCC:'            RC119-SML-NBR-NUM      32500000
325100*             DISPLAY  ' RCKUP075-6310-'                          32510000
325200*                      ' SML:'             RC119-SML-NBR-NUM      32520000
325300*                                                                 32530000
325400*             DISPLAY '*****************************************' 32540000
325500*             DISPLAY '*ABEND                                  *' 32550000
325600*             DISPLAY '*PROGRAM   = RCKUP075                   *' 32560000
325700*             DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 32570000
325800*             DISPLAY '             SELECT TSHUUPC             *' 32580000
325900*             DISPLAY '*PARAGRAPH = 6310-DETERMINE-PREPK-NBR   *' 32590000
326000*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               32600000
326100*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            32610000
326200*             DISPLAY '*****************************************' 32620000
326300*             PERFORM 9100-SQL-ABEND                              32630000
326400*                                                                 32640000
326500*    END-EVALUATE.                                                32650000
326600*                                                                 32660000
326700*                                                                 32670000
326800*----------------------------------------------------------------*32680000
326900* FOR PREPACK ORDER - CHECK IF THE CARTON IS AN ODD UNIT CARTON  *32690000
327000*----------------------------------------------------------------*32700000
327100*6320-BUILD-PREPACK-LINE-TABLE.                                   32710000
327200*    IF  PS-TEST-ONLY-DISPLAY-YES                                 32720000
327300*        DISPLAY ' RCKUP075 - 6320-BUILD-PREPACK-LINE-TABLE'      32730000
327400*    END-IF.                                                      32740000
327500*                                                                 32750000
327600*                                                                 32760000
327700*** BUILD INTERNAL TABLE CONTAINING THE LINES THAT ARE IN THE     32770000
327800*** PREPACK                                                       32780000
327900*                                                                 32790000
328000*    SET  PS-EOF-PREPK-LINE-CSR-NO  TO  TRUE.                     32800000
328100*                                                                 32810000
328200*    CLEAR INTERNAL TABLE                                         32820000
328300*    PERFORM VARYING LINE-INX FROM 1 BY 1                         32830000
328400*      UNTIL LINE-INX  >  PV-LINE-TABLE-ROWS                      32840000
328500*         OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  32850000
328600*            MOVE  ZEROES  TO  TBL-PACKS(LINE-INX)                32860000
328700*                              TBL-ODD-UNITS(LINE-INX)            32870000
328800*            SET  TBL-RECEIVED-NO (LINE-INX)  TO  TRUE            32880000
328900*    END-PERFORM.                                                 32890000
329000*                                                                 32900000
329100*    MOVE  ZEROES                   TO  PV-LINE-TABLE-ROWS.       32910000
329200*    PERFORM 6325-OPEN-PREPK-LINE-CSR.                            32920000
329300*                                                                 32930000
329400*    PERFORM VARYING LINE-INX FROM 1 BY 1                         32940000
329500*              UNTIL PS-EOF-PREPK-LINE-CSR                        32950000
329600*                 OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS          32960000
329700*                 OR PS-ERROR-YES                                 32970000
329800*            PERFORM 6330-FETCH-PREPK-LINE-CSR                    32980000
329900*    END-PERFORM.                                                 32990000
330000*                                                                 33000000
330100*    PERFORM 6335-CLOSE-PREPK-LINE-CSR.                           33010000
330200*                                                                 33020000
330300*                                                                 33030000
330400*** MATCH THE LINES FROM TSHUUPC AND CALCULATE THE NUMBER OF      33040000
330500*** PREPACKS BY LINES IN THE PREPACK                              33050000
330600*** NOTE: IF THERE ARE ANY REMAINDERS IT IS AN ODD UNIT CARTON    33060000
330700*** NOTE: IF THE LINE FROM THE CARTON IS NOT ON THER PREPACK      33070000
330800***       THEN IT IS AN ODD UNIT CARTON                           33080000
330900*                                                                 33090000
331000*    SET  PS-EOF-PREPK-LINE-CSR-NO  TO  TRUE.                     33100000
331100*    SET  PS-ODD-UNT-CRTN-FOUND-NO  TO  TRUE                      33110000
331200*                                                                 33120000
331300*    PERFORM 6340-OPEN-SSCC-LINE-CSR.                             33130000
331400*                                                                 33140000
331500*    PERFORM 6345-FETCH-SSCC-LINE-CSR                             33150000
331600*       UNTIL PS-EOF-PREPK-LINE-CSR                               33160000
331700*          OR PS-ODD-UNT-CRTN-FOUND                               33170000
331800*          OR PS-ERROR-YES.                                       33180000
331900*                                                                 33190000
332000*    PERFORM 6355-CLOSE-SSCC-LINE-CSR.                            33200000
332100*                                                                 33210000
332200*DMH ODD UNITS - CALCULATE LEAST NUMBER OF PREPACKS               33220000
332300*    MOVE TBL-PACKS(1)  TO  PV-LEAST-NBR-OF-PKS                   33230000
332400*    PERFORM VARYING LINE-INX FROM 1 BY 1                         33240000
332500*      UNTIL LINE-INX  >  PV-LINE-TABLE-ROWS                      33250000
332600*         OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  33260000
332700*            IF  TBL-PACKS(LINE-INX) <                            33270000
332800*                             PV-LEAST-NBR-OF-PKS                 33280000
332900*                MOVE  TBL-PACKS(LINE-INX) TO                     33290000
333000*                             PV-LEAST-NBR-OF-PKS                 33300000
333100*            END-IF                                               33310000
333200*            IF  PS-TEST-ONLY-DISPLAY-YES                         33320000
333300*                DISPLAY ' RCKUP075 - 6320- TABLE'                33330000
333400*                        ' ' TBL-LINE-NBR(LINE-INX)               33340000
333500*                        ' ' TBL-RATIO(LINE-INX)                  33350000
333600*                        ' ' TBL-PACKS(LINE-INX)                  33360000
333700*                        ' ' TBL-ODD-UNITS(LINE-INX)              33370000
333800*                        ' ' TBL-RECEIVED(LINE-INX)               33380000
333900*                MOVE  PV-LEAST-NBR-OF-PKS                        33390000
334000*                              TO PV-DISP-LEAST-PKS               33400000
334100*                DISPLAY ' RCKUP075 - 6320-'                      33410000
334200*                        ' LEAST # OF PACKS:'                     33420000
334300*                                 PV-DISP-LEAST-PKS               33430000
334400*            END-IF                                               33440000
334500*    END-PERFORM                                                  33450000
334600*                                                                 33460000
334700*    IF  PS-TEST-ONLY-DISPLAY-YES                                 33470000
334800*        MOVE  PV-LEAST-NBR-OF-PKS TO PV-DISP-LEAST-PKS           33480000
334900*        DISPLAY ' RCKUP075 - 6320-'                              33490000
335000*                ' LEAST # OF PACKS:' PV-DISP-LEAST-PKS           33500000
335100*    END-IF.                                                      33510000
335200*                                                                 33520000
335300* CHECK TO MAKE SURE ALL LINES HAVE THE SAME NUMBER FOR PACKS     33530000
335400* ANY LINE THAT HAS MORE PACKS THEN PV-LEAST-NBR-OF-PKS           33540000
335500* THE PACK QUANTITY THAT IS OVER WILL NEED TO BE ADDED TO         33550000
335600* ODD UNIT                                                        33560000
335700*    PERFORM VARYING LINE-INX FROM 1 BY 1                         33570000
335800*              UNTIL LINE-INX  >  PC-MAX-LINE-TABLE-ROWS          33580000
335900*                 OR LINE-INX  >  PV-LINE-TABLE-ROWS              33590000
336000*                 OR PS-ERROR-YES                                 33600000
336100*            PERFORM 6365-CALCULATE-ODD-UNITS                     33610000
336200*    END-PERFORM.                                                 33620000
336300*                                                                 33630000
336400*                                                                 33640000
336500*----------------------------------------------------------------*33650000
336600*                                                                *33660000
336700*----------------------------------------------------------------*33670000
336800*6325-OPEN-PREPK-LINE-CSR.                                        33680000
336900*    IF  PS-TEST-ONLY-DISPLAY-YES                                 33690000
337000*        DISPLAY ' RCKUP075 - 6325-OPEN-PREPK-LINE-CSR'           33700000
337100*    END-IF.                                                      33710000
337200*                                                                 33720000
337300*    EXEC SQL                                                     33730000
337400*         OPEN PREPK-LINE-CSR                                     33740000
337500*    END-EXEC                                                     33750000
337600*                                                                 33760000
337700*    EVALUATE TRUE                                                33770000
337800*        WHEN SQLCODE = ZERO                                      33780000
337900*             CONTINUE                                            33790000
338000*        WHEN SQLWARN0 NOT = SPACES                               33800000
338100*        WHEN SQLCODE  < ZERO                                     33810000
338200*        WHEN SQLCODE  > ZERO                                     33820000
338300*                                                                 33830000
338400*             SET  PS-ERROR-YES         TO TRUE                   33840000
338500*                                                                 33850000
338600*             MOVE SQLCODE              TO PV-DISP-SQLCODE        33860000
338700*             DISPLAY  ' RCKUP075-6325-'                          33870000
338800*                      ' SQL:'             PV-DISP-SQLCODE        33880000
338900*                      ' PO:'              RC119-KOHLS-PO-NBR     33890000
339000*                      ' STR:'             RC119-DEST-STORE-NBR   33900000
339100*                      ' SSCC:'            RC119-SML-NBR-NUM      33910000
339200*             DISPLAY  ' RCKUP075-6325-'                          33920000
339300*                      ' SML:'             RC119-SML-NBR-NUM      33930000
339400*                                                                 33940000
339500*             DISPLAY '*****************************************' 33950000
339600*             DISPLAY '*ABEND                                  *' 33960000
339700*             DISPLAY '*PROGRAM   = RCKUP075                   *' 33970000
339800*             DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 33980000
339900*             DISPLAY '*PARAGRAPH = 6325-OPEN-PREPK-LINE-CSR   *' 33990000
340000*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               34000000
340100*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            34010000
340200*             DISPLAY '*****************************************' 34020000
340300*             PERFORM 9100-SQL-ABEND                              34030000
340400*                                                                 34040000
340500*    END-EVALUATE.                                                34050000
340600*                                                                 34060000
340700*                                                                 34070000
340800*----------------------------------------------------------------*34080000
340900*                                                                *34090000
341000*----------------------------------------------------------------*34100000
341100*6330-FETCH-PREPK-LINE-CSR.                                       34110000
341200*    IF  PS-TEST-ONLY-DISPLAY-YES                                 34120000
341300*        DISPLAY ' RCKUP075 - 6330-FETCH-PREPK-LINE-CSR'          34130000
341400*    END-IF.                                                      34140000
341500*                                                                 34150000
341600*    EXEC SQL                                                     34160000
341700*         FETCH PREPK-LINE-CSR                                    34170000
341800*          INTO  :PV-PURITM-PO-LNE-NBR                            34180000
341900*               ,:PV-PURITM-PREPK-RATO-QTY                        34190000
342000*    END-EXEC.                                                    34200000
342100*                                                                 34210000
342200*    EVALUATE TRUE                                                34220000
342300*        WHEN SQLCODE = ZERO                                      34230000
342400*             ADD  1  TO  PV-LINE-TABLE-ROWS                      34240000
342500*             MOVE PV-PURITM-PO-LNE-NBR                           34250000
342600*               TO TBL-LINE-NBR(LINE-INX)                         34260000
342700*             MOVE PV-PURITM-PREPK-RATO-QTY                       34270000
342800*               TO TBL-RATIO(LINE-INX)                            34280000
342900*             MOVE ZEROES                                         34290000
343000*               TO TBL-PACKS(LINE-INX)                            34300000
343100*                  TBL-ODD-UNITS(LINE-INX)                        34310000
343200*             SET  TBL-RECEIVED-NO(LINE-INX)  TO TRUE             34320000
343300*                                                                 34330000
343400*        IF  PS-TEST-ONLY-DISPLAY-YES                             34340000
343500*            DISPLAY ' RCKUP075 - 6330- TABLE'                    34350000
343600*                    ' ' TBL-LINE-NBR(LINE-INX)                   34360000
343700*                    ' ' TBL-RATIO(LINE-INX)                      34370000
343800*                    ' ' TBL-PACKS(LINE-INX)                      34380000
343900*                    ' ' TBL-ODD-UNITS(LINE-INX)                  34390000
344000*                    ' ' TBL-RECEIVED(LINE-INX)                   34400000
344100*        END-IF                                                   34410000
344200*                                                                 34420000
344300*        WHEN SQLCODE = +100                                      34430000
344400*             SET PS-EOF-PREPK-LINE-CSR    TO TRUE                34440000
344500*                                                                 34450000
344600*        WHEN SQLWARN0 NOT = SPACES                               34460000
344700*        WHEN SQLCODE NOT = ZERO                                  34470000
344800*                                                                 34480000
344900*             SET  PS-ERROR-YES         TO TRUE                   34490000
345000*                                                                 34500000
345100*             MOVE SQLCODE              TO PV-DISP-SQLCODE        34510000
345200*             DISPLAY  ' RCKUP075-6330-'                          34520000
345300*                      ' SQL:'             PV-DISP-SQLCODE        34530000
345400*                      ' PO:'              RC119-KOHLS-PO-NBR     34540000
345500*                      ' STR:'             RC119-DEST-STORE-NBR   34550000
345600*                      ' SSCC:'            RC119-SML-NBR-NUM      34560000
345700*             DISPLAY  ' RCKUP075-6330-'                          34570000
345800*                      ' SML:'             RC119-SML-NBR-NUM      34580000
345900*                                                                 34590000
346000*             DISPLAY '*****************************************' 34600000
346100*             DISPLAY '*ABEND                                  *' 34610000
346200*             DISPLAY '*PROGRAM   = RCKUP075                   *' 34620000
346300*             DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 34630000
346400*             DISPLAY '*PARAGRAPH = 6330-FETCH-PREPK-LINE-CSR  *' 34640000
346500*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               34650000
346600*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            34660000
346700*             DISPLAY '*****************************************' 34670000
346800*             PERFORM 9100-SQL-ABEND                              34680000
346900*                                                                 34690000
347000*    END-EVALUATE.                                                34700000
347100*                                                                 34710000
347200*                                                                 34720000
347300*----------------------------------------------------------------*34730000
347400*                                                                *34740000
347500*----------------------------------------------------------------*34750000
347600*6335-CLOSE-PREPK-LINE-CSR.                                       34760000
347700*    IF  PS-TEST-ONLY-DISPLAY-YES                                 34770000
347800*        DISPLAY ' RCKUP075 - 6335-CLOSE-PREPK-LINE-CSR'          34780000
347900*    END-IF.                                                      34790000
348000*                                                                 34800000
348100*    EXEC SQL                                                     34810000
348200*         CLOSE PREPK-LINE-CSR                                    34820000
348300*    END-EXEC                                                     34830000
348400*                                                                 34840000
348500*    EVALUATE TRUE                                                34850000
348600*        WHEN SQLCODE = ZERO                                      34860000
348700*             CONTINUE                                            34870000
348800*        WHEN SQLWARN0 NOT = SPACES                               34880000
348900*        WHEN SQLCODE  < ZERO                                     34890000
349000*        WHEN SQLCODE  > ZERO                                     34900000
349100*                                                                 34910000
349200*             SET  PS-ERROR-YES         TO TRUE                   34920000
349300*                                                                 34930000
349400*             MOVE SQLCODE              TO PV-DISP-SQLCODE        34940000
349500*             DISPLAY  ' RCKUP075-6335-'                          34950000
349600*                      ' SQL:'             PV-DISP-SQLCODE        34960000
349700*                      ' PO:'              RC119-KOHLS-PO-NBR     34970000
349800*                      ' STR:'             RC119-DEST-STORE-NBR   34980000
349900*                      ' SSCC:'            RC119-SML-NBR-NUM      34990000
350000*             DISPLAY  ' RCKUP075-6335-'                          35000000
350100*                      ' SML:'             RC119-SML-NBR-NUM      35010000
350200*                                                                 35020000
350300*             DISPLAY '*****************************************' 35030000
350400*             DISPLAY '*ABEND                                  *' 35040000
350500*             DISPLAY '*PROGRAM   = RCKUP075                   *' 35050000
350600*             DISPLAY '*DB2 OPER  = SELECT TPURITM             *' 35060000
350700*             DISPLAY '*PARAGRAPH = 6335-CLOSE-PREPK-LINE-CSR  *' 35070000
350800*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               35080000
350900*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            35090000
351000*             DISPLAY '*****************************************' 35100000
351100*             PERFORM 9100-SQL-ABEND                              35110000
351200*                                                                 35120000
351300*    END-EVALUATE.                                                35130000
351400*                                                                 35140000
351500*                                                                 35150000
351600*----------------------------------------------------------------*35160000
351700* CURSOR FOR LINES IN THE CARTONS - USED TO MATCH TO PREPK       *35170000
351800*----------------------------------------------------------------*35180000
351900*6340-OPEN-SSCC-LINE-CSR.                                         35190000
352000*    IF  PS-TEST-ONLY-DISPLAY-YES                                 35200000
352100*        DISPLAY ' RCKUP075 - 6340-OPEN-SSCC-LINE-CSR'            35210000
352200*    END-IF.                                                      35220000
352300*                                                                 35230000
352400*     EXEC SQL                                                    35240000
352500*          OPEN SSCC-LINE-CSR                                     35250000
352600*     END-EXEC                                                    35260000
352700*                                                                 35270000
352800*     EVALUATE TRUE                                               35280000
352900*         WHEN SQLCODE = ZERO                                     35290000
353000*         WHEN SQLCODE = -904                                     35300000
353100*         WHEN SQLCODE = -913                                     35310000
353200*              CONTINUE                                           35320000
353300*         WHEN SQLWARN0 NOT = SPACES                              35330000
353400*         WHEN SQLCODE  < ZERO                                    35340000
353500*         WHEN SQLCODE  > ZERO                                    35350000
353600*                                                                 35360000
353700*             SET  PS-ERROR-YES         TO TRUE                   35370000
353800*                                                                 35380000
353900*             MOVE SQLCODE              TO PV-DISP-SQLCODE        35390000
354000*             DISPLAY  ' RCKUP075-6340-'                          35400000
354100*                      ' SQL:'             PV-DISP-SQLCODE        35410000
354200*                      ' PO:'              RC119-KOHLS-PO-NBR     35420000
354300*                      ' STR:'             RC119-DEST-STORE-NBR   35430000
354400*                      ' SSCC:'            RC119-SML-NBR-NUM      35440000
354500*             DISPLAY  ' RCKUP075-6340-'                          35450000
354600*                      ' SML:'             RC119-SML-NBR-NUM      35460000
354700*                                                                 35470000
354800*             DISPLAY '*****************************************' 35480000
354900*             DISPLAY '*ABEND                                  *' 35490000
355000*             DISPLAY '*PROGRAM   = RCKUP075                   *' 35500000
355100*             DISPLAY '*DB2 OPER  = SELECT TSHUUPC             *' 35510000
355200*             DISPLAY '*PARAGRAPH = 6340-OPEN-SSCC-LINE-CSR    *' 35520000
355300*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               35530000
355400*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            35540000
355500*             DISPLAY '*****************************************' 35550000
355600*             PERFORM 9100-SQL-ABEND                              35560000
355700*                                                                 35570000
355800*     END-EVALUATE.                                               35580000
355900*                                                                 35590000
356000*                                                                 35600000
356100*----------------------------------------------------------------*35610000
356200*                                                                *35620000
356300*----------------------------------------------------------------*35630000
356400*6345-FETCH-SSCC-LINE-CSR.                                        35640000
356500*    IF  PS-TEST-ONLY-DISPLAY-YES                                 35650000
356600*        DISPLAY ' RCKUP075 - 6345-FETCH-SSCC-LINE-CSR'           35660000
356700*    END-IF.                                                      35670000
356800*                                                                 35680000
356900*     EXEC SQL                                                    35690000
357000*          FETCH SSCC-LINE-CSR                                    35700000
357100*           INTO :PV-SSCC-LINE-UPC-NBR                            35710000
357200*               ,:PV-SSCC-LINE-TRN-LNE-NBR                        35720000
357300*               ,:PV-SSCC-LINE-SHPD-QTY                           35730000
357400*     END-EXEC                                                    35740000
357500*                                                                 35750000
357600*     EVALUATE TRUE                                               35760000
357700*         WHEN SQLCODE = ZERO                                     35770000
357800*              IF  PV-SSCC-LINE-TRN-LNE-NBR = 0                   35780000
357900*                  SET  PS-ERROR-YES  TO  TRUE                    35790000
358000*              ELSE                                               35800000
358100*                  PERFORM 6350-CHECK-LINE-TABLE                  35810000
358200*              END-IF                                             35820000
358300*                                                                 35830000
358400*         WHEN SQLCODE = +100                                     35840000
358500*              SET PS-EOF-PREPK-LINE-CSR  TO  TRUE                35850000
358600*                                                                 35860000
358700*         WHEN SQLWARN0 NOT = SPACES                              35870000
358800*         WHEN SQLCODE NOT = ZERO                                 35880000
358900*                                                                 35890000
359000*             SET  PS-ERROR-YES         TO TRUE                   35900000
359100*                                                                 35910000
359200*             MOVE SQLCODE              TO PV-DISP-SQLCODE        35920000
359300*             DISPLAY  ' RCKUP075-6345-'                          35930000
359400*                      ' SQL:'             PV-DISP-SQLCODE        35940000
359500*                      ' PO:'              RC119-KOHLS-PO-NBR     35950000
359600*                      ' STR:'             RC119-DEST-STORE-NBR   35960000
359700*                      ' SSCC:'            RC119-SML-NBR-NUM      35970000
359800*             DISPLAY  ' RCKUP075-6345-'                          35980000
359900*                      ' SML:'             RC119-SML-NBR-NUM      35990000
360000*                                                                 36000000
360100*             DISPLAY '*****************************************' 36010000
360200*             DISPLAY '*ABEND                                  *' 36020000
360300*             DISPLAY '*PROGRAM   = RCKUP075                   *' 36030000
360400*             DISPLAY '*DB2 OPER  = SELECT TSHUUPC             *' 36040000
360500*             DISPLAY '*PARAGRAPH = 6345-FETCH-SSCC-LINE-CSR   *' 36050000
360600*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               36060000
360700*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            36070000
360800*             DISPLAY '*****************************************' 36080000
360900*             PERFORM 9100-SQL-ABEND                              36090000
361000*                                                                 36100000
361100*     END-EVALUATE.                                               36110000
361200*                                                                 36120000
361300*                                                                 36130000
361400*----------------------------------------------------------------*36140000
361500* CHECK TO SEE IF THE LINE NUMBER IN THE SSCC IS ON THE          *36150000
361600* INTERNAL PREPACK TABLE                                         *36160000
361700*----------------------------------------------------------------*36170000
361800*6350-CHECK-LINE-TABLE.                                           36180000
361900*    IF  PS-TEST-ONLY-DISPLAY-YES                                 36190000
362000*        DISPLAY ' RCKUP075 - 6350-CHECK-LINE-TABLE'              36200000
362100*    END-IF.                                                      36210000
362200*                                                                 36220000
362300*    SET  PS-VALID-LINE-NO  TO  TRUE.                             36230000
362400*                                                                 36240000
362500*    PERFORM VARYING LINE-INX FROM 1 BY 1                         36250000
362600*      UNTIL PS-VALID-LINE                                        36260000
362700*         OR LINE-INX  >  PV-LINE-TABLE-ROWS                      36270000
362800*         OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  36280000
362900*            IF  PV-SSCC-LINE-TRN-LNE-NBR                         36290000
363000*                           = TBL-LINE-NBR(LINE-INX)              36300000
363100*                SET  PS-VALID-LINE  TO  TRUE                     36310000
363200*                SET  TBL-RECEIVED-YES(LINE-INX)  TO  TRUE        36320000
363300*                IF  PV-SSCC-LINE-SHPD-QTY   >  0  AND            36330000
363400*                    TBL-RATIO(LINE-INX)     >  0                 36340000
363500*                    DIVIDE  PV-SSCC-LINE-SHPD-QTY                36350000
363600*                        BY  TBL-RATIO(LINE-INX)                  36360000
363700*                    GIVING  TBL-PACKS(LINE-INX)                  36370000
363800*                    REMAINDER  TBL-ODD-UNITS(LINE-INX)           36380000
363900*                ELSE                                             36390000
364000*                    MOVE  ZEROES  TO  TBL-PACKS(LINE-INX)        36400000
364100*                                      TBL-ODD-UNITS(LINE-INX)    36410000
364200*                END-IF                                           36420000
364300*            END-IF                                               36430000
364400*            IF  PS-TEST-ONLY-DISPLAY-YES                         36440000
364500*                MOVE  PV-SSCC-LINE-TRN-LNE-NBR                   36450000
364600*                                            TO PV-DISP-SSCC-LINE 36460000
364700*                MOVE  PV-SSCC-LINE-SHPD-QTY TO PV-DISP-SHPD-QTY  36470000
364800*                DISPLAY ' RCKUP075 - 6350-'                      36480000
364900*                        ' LINE:'             PV-DISP-SSCC-LINE   36490000
365000*                        ' QTY:'              PV-DISP-SHPD-QTY    36500000
365100*                        ' SW:'         PS-VALID-LINE-SW          36510000
365200*                        ' SW:'         PS-ODD-UNT-CRTN-FOUND-SW  36520000
365300*                DISPLAY ' RCKUP075 - 6350-TABLE'                 36530000
365400*                        ' ' TBL-LINE-NBR(LINE-INX)               36540000
365500*                        ' ' TBL-RATIO(LINE-INX)                  36550000
365600*                        ' ' TBL-PACKS(LINE-INX)                  36560000
365700*                        ' ' TBL-ODD-UNITS(LINE-INX)              36570000
365800*                        ' ' TBL-RECEIVED(LINE-INX)               36580000
365900*            END-IF                                               36590000
366000*    END-PERFORM.                                                 36600000
366100*                                                                 36610000
366200*                                                                 36620000
366300* IF THE SSCC LINE NUMBER IS NOT PART OF THE PREPACK              36630000
366400* THE CARTON IS DETERMINED TO HAVE ODD UNITS                      36640000
366500*                                                                 36650000
366600*    IF  PS-VALID-LINE-NO                                         36660000
366700*        SET  PS-ODD-UNT-CRTN-FOUND  TO  TRUE                     36670000
366800*    END-IF.                                                      36680000
366900*                                                                 36690000
367000*                                                                 36700000
367100*----------------------------------------------------------------*36710000
367200*                                                                *36720000
367300*----------------------------------------------------------------*36730000
367400*6355-CLOSE-SSCC-LINE-CSR.                                        36740000
367500*    IF  PS-TEST-ONLY-DISPLAY-YES                                 36750000
367600*        DISPLAY ' RCKUP075 - 6355-CLOSE-SSCC-LINE-CSR'           36760000
367700*    END-IF.                                                      36770000
367800*                                                                 36780000
367900*     EXEC SQL                                                    36790000
368000*          CLOSE SSCC-LINE-CSR                                    36800000
368100*     END-EXEC                                                    36810000
368200*                                                                 36820000
368300*     EVALUATE TRUE                                               36830000
368400*         WHEN SQLCODE = ZERO                                     36840000
368500*         WHEN SQLCODE = -904                                     36850000
368600*         WHEN SQLCODE = -913                                     36860000
368700*              CONTINUE                                           36870000
368800*         WHEN SQLWARN0 NOT = SPACES                              36880000
368900*         WHEN SQLCODE  < ZERO                                    36890000
369000*         WHEN SQLCODE  > ZERO                                    36900000
369100*                                                                 36910000
369200*             SET  PS-ERROR-YES         TO TRUE                   36920000
369300*                                                                 36930000
369400*             MOVE SQLCODE              TO PV-DISP-SQLCODE        36940000
369500*             DISPLAY  ' RCKUP075-6355-'                          36950000
369600*                      ' SQL:'             PV-DISP-SQLCODE        36960000
369700*                      ' PO:'              RC119-KOHLS-PO-NBR     36970000
369800*                      ' STR:'             RC119-DEST-STORE-NBR   36980000
369900*                      ' SSCC:'            RC119-SML-NBR-NUM      36990000
370000*             DISPLAY  ' RCKUP075-6355-'                          37000000
370100*                      ' SML:'             RC119-SML-NBR-NUM E    37010000
370200*                                                                 37020000
370300*             DISPLAY '*****************************************' 37030000
370400*             DISPLAY '*ABEND                                  *' 37040000
370500*             DISPLAY '*PROGRAM   = RCKUP075                   *' 37050000
370600*             DISPLAY '*DB2 OPER  = SELECT TSHUUPC             *' 37060000
370700*             DISPLAY '*PARAGRAPH = 6355-CLOSE-SSCC-LINE-CSR   *' 37070000
370800*             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               37080000
370900*             DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            37090000
371000*             DISPLAY '*****************************************' 37100000
371100*             PERFORM 9100-SQL-ABEND                              37110000
371200*                                                                 37120000
371300*     END-EVALUATE.                                               37130000
371400*                                                                 37140000
371500*                                                                 37150000
371600*----------------------------------------------------------------*37160000
371700*  ALL LINES IN THE PREPACK - MUST CONTAIN THE SAME NUMBER OF    *37170000
371800*  PACKS AND ODD UNITS                                           *37180000
371900*  IF NOT THEN IT IS AN ODD UNIT CARTON                          *37190000
372000*----------------------------------------------------------------*37200000
372100*6360-CHECK-PACKS.                                                37210000
372200*    IF  PS-TEST-ONLY-DISPLAY-YES                                 37220000
372300*        DISPLAY ' RCKUP075 - 6360-CHECK-PACKS'                   37230000
372400*    END-IF.                                                      37240000
372500*                                                                 37250000
372600*    MOVE TBL-PACKS(1)              TO  PV-TBL-PACKS.             37260000
372700*    MOVE TBL-ODD-UNITS(1)          TO  PV-TBL-UNITS.             37270000
372800*    SET  PS-MATCH-PACKS-YES        TO  TRUE.                     37280000
372900*    SET  PS-ODD-UNT-CRTN-FOUND-NO  TO  TRUE.                     37290000
373000*                                                                 37300000
373100*    PERFORM VARYING LINE-INX FROM 1 BY 1                         37310000
373200*      UNTIL PS-MATCH-PACKS-NO                                    37320000
373300*         OR LINE-INX  >  PV-LINE-TABLE-ROWS                      37330000
373400*         OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  37340000
373500*         OR PS-ODD-UNT-CRTN-FOUND                                37350000
373600*            IF  TBL-PACKS(LINE-INX)      =  PV-TBL-PACKS   AND   37360000
373700*                TBL-ODD-UNITS(LINE-INX)  =  PV-TBL-UNITS         37370000
373800*                CONTINUE                                         37380000
373900*            ELSE                                                 37390000
374000*                SET  PS-MATCH-PACKS-NO  TO  TRUE                 37400000
374100*                SET  PS-ODD-UNT-CRTN-FOUND  TO  TRUE             37410000
374200*            END-IF                                               37420000
374300*            IF  PS-TEST-ONLY-DISPLAY-YES                         37430000
374400*                DISPLAY ' RCKUP075 - 6360-'                      37440000
374500*                        ' UNITS:'           PV-TBL-UNITS         37450000
374600*                        ' PACKS:'           PV-TBL-PACKS         37460000
374700*                        ' SW:'         PS-MATCH-PACKS-SW         37470000
374800*                        ' SW:'         PS-ODD-UNT-CRTN-FOUND-SW  37480000
374900*                DISPLAY ' RCKUP075 - 6360-TABLE'                 37490000
375000*                        ' ' TBL-LINE-NBR(LINE-INX)               37500000
375100*                        ' ' TBL-RATIO(LINE-INX)                  37510000
375200*                        ' ' TBL-PACKS(LINE-INX)                  37520000
375300*                        ' ' TBL-ODD-UNITS(LINE-INX)              37530000
375400*                        ' ' TBL-RECEIVED(LINE-INX)               37540000
375500*            END-IF                                               37550000
375600*    END-PERFORM.                                                 37560000
375700*                                                                 37570000
375800*                                                                 37580000
375900*----------------------------------------------------------------*37590000
376000*                                                                *37600000
376100*----------------------------------------------------------------*37610000
376200*6365-CALCULATE-ODD-UNITS.                                        37620000
376300*    IF  PS-TEST-ONLY-DISPLAY-YES                                 37630000
376400*        DISPLAY ' RCKUP075 - 6365-CALCULATE-ODD-UNITS'           37640000
376500*    END-IF.                                                      37650000
376600*                                                                 37660000
376700*    IF  PV-LEAST-NBR-OF-PKS  =  TBL-PACKS(LINE-INX)              37670000
376800*        CONTINUE                                                 37680000
376900*    ELSE                                                         37690000
377000*        SUBTRACT  PV-LEAST-NBR-OF-PKS                            37700000
377100*            FROM  TBL-PACKS(LINE-INX)                            37710000
377200*          GIVING  PV-ODD-PACKS                                   37720000
377300*                                                                 37730000
377400*        MOVE PV-LEAST-NBR-OF-PKS  TO  TBL-PACKS(LINE-INX)        37740000
377500*                                                                 37750000
377600*        MULTIPLY  PV-ODD-PACKS                                   37760000
377700*              BY  TBL-RATIO(LINE-INX)                            37770000
377800*          GIVING  PV-ODD-PACKS-UNITS                             37780000
377900*                                                                 37790000
378000*        ADD  PV-ODD-PACKS-UNITS  TO  TBL-ODD-UNITS(LINE-INX)     37800000
378100*                                                                 37810000
378200*        SET  PS-ODD-UNT-CRTN-FOUND  TO  TRUE                     37820000
378300*    END-IF.                                                      37830000
378400*                                                                 37840000
378500*    IF  PS-TEST-ONLY-DISPLAY-YES                                 37850000
378600*        DISPLAY ' RCKUP075 - 6365-'                              37860000
378700*                ' ' TBL-LINE-NBR(LINE-INX)                       37870000
378800*                ' ' TBL-RATIO(LINE-INX)                          37880000
378900*                ' ' TBL-PACKS(LINE-INX)                          37890000
379000*                ' ' TBL-ODD-UNITS(LINE-INX)                      37900000
379100*                ' ' TBL-RECEIVED(LINE-INX)                       37910000
379200*    END-IF.                                                      37920000
379300*                                                                 37930000
379400*                                                                 37940000
379500*----------------------------------------------------------------*37950000
379600*  CREATE SML                                                    *37960000
379700*     - INSERT SUT_OTBND_CART                                    *37970000
379800*     - INSERT SUT_OTBND_UPC                                     *37980000
379900*     - INSERT SUT_OTBND_LOC                                     *37990000
380000*----------------------------------------------------------------*38000000
380100 6500-CREATE-SML.                                                 38010000
380200     IF  PS-TEST-ONLY-DISPLAY-YES                                 38020000
380300         DISPLAY ' RCKUP075 - 6500-CREATE-SML'                    38030000
380400                 ' SML: ' RC119-SML-NBR-NUM                       38040000
380500     END-IF.                                                      38050000
380600                                                                  38060000
380700     IF  RC119-SML-NBR-NUM  =  PV-PREV-SML                        38070000
380800         CONTINUE                                                 38080000
380900     ELSE                                                         38090000
381000         PERFORM 6550-INS-OTBND-CART                              38100000
381100         MOVE RC119-SML-NBR-NUM  TO  PV-PREV-SML                  38110000
381200     END-IF.                                                      38120000
381300                                                                  38130000
381400     PERFORM 6560-CREATE-OTBND-UPC.                               38140000
381500                                                                  38150000
381600                                                                  38160000
381700*----------------------------------------------------------------*38170000
381800*                                                                *38180000
381900*----------------------------------------------------------------*38190000
382000 6550-INS-OTBND-CART.                                             38200000
382100     IF  PS-TEST-ONLY-DISPLAY-YES                                 38210000
382200         DISPLAY ' RCKUP075 - 6550-INS-OTBND-CART'                38220000
382300                 ' SML: ' RC119-SML-NBR-NUM                       38230000
382400     END-IF.                                                      38240000
382500                                                                  38250000
382600     INITIALIZE DCLSUT00024.                                      38260000
382700     MOVE RC119-SML-NBR-NUM     TO SUT00024-SHIPT-UNT-ID.         38270000
382800     MOVE RC119-3RD-PRTY-DC-NBR TO SUT00024-ORGN-LOC-NBR.         38280000
382900     MOVE RC119-DEST-STORE-NBR  TO SUT00024-DEST-LOC-NBR.         38290000
383000     MOVE PC-3WD                TO SUT00024-CART-SRC-CDE.         38300000
383100     MOVE PC-THRDPRTY           TO SUT00024-CRE-USR-ID.           38310000
383200     MOVE PC-PROGRAM-NAME       TO SUT00024-CRE-PGM-NM.           38320000
383300     MOVE PC-N                  TO SUT00024-MSTR-CART-IND.        38330000
383400     MOVE RC119-SML-NBR-NUM     TO SUT00024-PRNT-CART-ID.         38340000
383500     MOVE RC119-SML-NBR-NUM     TO SUT00024-ORIG-CART-ID.         38350000
383600     MOVE 'S'                   TO SUT00024-CART-TYP-CDE.         38360000
383700     MOVE 0                     TO SUT00024-LBL-PRT-SEQ-NBR.      38370000
383800     MOVE 0                     TO SUT00024-CART-RVSN-NBR.        38380000
383900     MOVE 'Y'                   TO SUT00024-ACTV-IND.             38390000
384000                                                                  38400000
384100     IF  PS-ODD-UNT-CRTN-FOUND                                    38410000
384200         MOVE 'Y'               TO SUT00024-ODD-UNT-IND           38420000
384300     ELSE                                                         38430000
384400         MOVE 'N'               TO SUT00024-ODD-UNT-IND           38440000
384500     END-IF.                                                      38450000
384600                                                                  38460000
384700     MOVE 'N'                   TO SUT00024-EAS-TAG-IND.          38470000
384800                                                                  38480000
384900     EXEC SQL                                                     38490000
385000          INSERT INTO SUT_OTBND_CART                              38500000
385100              (SHIPT_UNT_ID                                       38510000
385200             , ORGN_LOC_NBR                                       38520000
385300             , DEST_LOC_NBR                                       38530000
385400             , CART_SRC_CDE                                       38540000
385500             , CRE_DTE                                            38550000
385600             , CRE_TM                                             38560000
385700             , CRE_USR_ID                                         38570000
385800             , CRE_PGM_NM                                         38580000
385900             , MSTR_CART_IND                                      38590000
386000             , PRNT_CART_ID                                       38600000
386100             , ORIG_CART_ID                                       38610000
386200             , CART_TYP_CDE                                       38620000
386300             , LBL_PRT_SEQ_NBR                                    38630000
386400             , CART_RVSN_NBR                                      38640000
386500             , OTBND_TRIP_ID                                      38650000
386600             , ACTV_IND                                           38660000
386700             , ODD_UNT_IND                                        38670000
386800             , EAS_TAG_IND)                                       38680000
386900          VALUES(                                                 38690000
387000               :SUT00024-SHIPT-UNT-ID                             38700000
387100             , :SUT00024-ORGN-LOC-NBR                             38710000
387200             , :SUT00024-DEST-LOC-NBR                             38720000
387300             , :SUT00024-CART-SRC-CDE                             38730000
387400             , CURRENT DATE                                       38740000
387500             , CURRENT TIME                                       38750000
387600             , :SUT00024-CRE-USR-ID                               38760000
387700             , :SUT00024-CRE-PGM-NM                               38770000
387800             , :SUT00024-MSTR-CART-IND                            38780000
387900             , :SUT00024-PRNT-CART-ID                             38790000
388000             , :SUT00024-ORIG-CART-ID                             38800000
388100             , :SUT00024-CART-TYP-CDE                             38810000
388200             , :SUT00024-LBL-PRT-SEQ-NBR                          38820000
388300             , :SUT00024-CART-RVSN-NBR                            38830000
388400             , NULL                                               38840000
388500             , :SUT00024-ACTV-IND                                 38850000
388600             , :SUT00024-ODD-UNT-IND                              38860000
388700             , :SUT00024-EAS-TAG-IND)                             38870000
388800     END-EXEC.                                                    38880000
388900                                                                  38890000
389000     EVALUATE TRUE                                                38900000
389100         WHEN SQLCODE = ZERO                                      38910000
389200              MOVE RC119-SML-NBR-NUM                              38920000
389300                TO PV-SML-BARCODE                                 38930000
389400              PERFORM 6585-INS-OTBND-LOC                          38940000
389500                                                                  38950000
389600         WHEN SQLCODE = -803                                      38960000
389700              MOVE RC119-SML-NBR-NUM                              38970000
389800                TO PV-SML-BARCODE                                 38980000
389900                                                                  38990000
390000         WHEN SQLCODE = -811                                      39000000
390100              CONTINUE                                            39010000
390200         WHEN SQLWARN0 NOT = SPACES                               39020000
390300         WHEN SQLCODE NOT = ZERO                                  39030000
390400                                                                  39040000
390500              SET  PS-ERROR-YES         TO TRUE                   39050000
390600                                                                  39060000
390700              MOVE SQLCODE              TO PV-DISP-SQLCODE        39070000
390800              DISPLAY  ' RCKUP075-6550-'                          39080000
390900                       ' SQL:'             PV-DISP-SQLCODE        39090000
391000                       ' PO:'              RC119-KOHLS-PO-NBR     39100000
391100                       ' STR:'             RC119-DEST-STORE-NBR   39110000
391200                       ' SSCC:'            RC119-SML-NBR-NUM      39120000
391300              DISPLAY  ' RCKUP075-6550-'                          39130000
391400                       ' SML:'             RC119-SML-NBR-NUM      39140000
391500                                                                  39150000
391600              DISPLAY '*****************************************' 39160000
391700              DISPLAY '*ABEND                                  *' 39170000
391800              DISPLAY '*PROGRAM   = RCKUP075                   *' 39180000
391900              DISPLAY '*DB2 OPER  = SUT_OTBND_CART             *' 39190000
392000              DISPLAY '*PARAGRAPH = 6550-INS-OTBND-CART        *' 39200000
392100              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               39210000
392200              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            39220000
392300              DISPLAY '*****************************************' 39230000
392400              PERFORM 9100-SQL-ABEND                              39240000
392500                                                                  39250000
392600     END-EVALUATE.                                                39260000
392700                                                                  39270000
392800                                                                  39280000
392900*----------------------------------------------------------------*39290000
393000*                                                                *39300000
393100*----------------------------------------------------------------*39310000
393200 6560-CREATE-OTBND-UPC.                                           39320000
393300     IF  PS-TEST-ONLY-DISPLAY-YES                                 39330000
393400         DISPLAY ' RCKUP075 - 6560-CREATE-OTBND-UPC'              39340000
393500                 ' SML: ' RC119-SML-NBR-NUM                       39350000
393600                 ' PO: '  RC119-KOHLS-PO-NBR                      39360000
393700                 ' LNE: ' RC119-KOHLS-PO-LINE-NBR                 39370000
393800     END-IF.                                                      39380000
393900                                                                  39390000
394000     INITIALIZE DCLSUT00028.                                      39400000
394100                                                                  39410000
394200     MOVE RC119-SML-NBR-NUM       TO SUT00028-SHIPT-UNT-ID.       39420000
394300     MOVE RC119-KOHLS-PO-NBR      TO SUT00028-TRN-NBR.            39430000
394400     MOVE RECEIV-REC-SEQ-NBR      TO SUT00028-RCVR-SEQ-NBR.       39440000
394500     MOVE RC119-KOHLS-PO-LINE-NBR TO SUT00028-TRN-LNE-NBR.        39450000
394600     MOVE PC-PO                   TO SUT00028-TRN-TYP-CDE.        39460000
394700     MOVE RC119-UPC-NBR           TO SUT00028-UPC-NBR.            39470000
394800     MOVE RC119-SHIP-UNT-QTY      TO SUT00028-SHPD-UNT-QTY.       39480000
394900                                                                  39490000
395000     EXEC SQL                                                     39500000
395100          INSERT INTO SUT_OTBND_UPC                               39510000
395200              (SHIPT_UNT_ID                                       39520000
395300             , TRN_NBR                                            39530000
395400             , RCVR_SEQ_NBR                                       39540000
395500             , TRN_LNE_NBR                                        39550000
395600             , TRN_TYP_CDE                                        39560000
395700             , UPC_NBR                                            39570000
395800             , SHPD_UNT_QTY)                                      39580000
395900          VALUES(                                                 39590000
396000               :SUT00028-SHIPT-UNT-ID                             39600000
396100             , :SUT00028-TRN-NBR                                  39610000
396200             , :SUT00028-RCVR-SEQ-NBR                             39620000
396300             , :SUT00028-TRN-LNE-NBR                              39630000
396400             , :SUT00028-TRN-TYP-CDE                              39640000
396500             , :SUT00028-UPC-NBR                                  39650000
396600             , :SUT00028-SHPD-UNT-QTY)                            39660000
396700     END-EXEC.                                                    39670000
396800                                                                  39680000
396900     EVALUATE TRUE                                                39690000
397000         WHEN SQLCODE = ZERO                                      39700000
397100              CONTINUE                                            39710000
397200                                                                  39720000
397300         WHEN SQLCODE = -811                                      39730000
397400              PERFORM 6565-UPDATE-OTBND-UPC                       39740000
397500                                                                  39750000
397600         WHEN SQLWARN0 NOT = SPACES                               39760000
397700         WHEN SQLCODE NOT = ZERO                                  39770000
397800                                                                  39780000
397900              SET  PS-ERROR-YES   TO  TRUE                        39790000
398000                                                                  39800000
398100              MOVE SQLCODE        TO PV-DISP-SQLCODE              39810000
398200              DISPLAY  ' RCKUP075-6560-'                          39820000
398300                       ' SQL:'       PV-DISP-SQLCODE              39830000
398400                       ' PO:'        RC119-KOHLS-PO-NBR           39840000
398500                       ' STR:'       RC119-DEST-STORE-NBR         39850000
398600                       ' SSCC:'      RC119-SML-NBR-NUM            39860000
398700              DISPLAY  ' RCKUP075-6560-'                          39870000
398800                       ' SML:'       RC119-SML-NBR-NUM            39880000
398900                                                                  39890000
399000              DISPLAY '***********************************'       39900000
399100              DISPLAY '*ABEND                            *'       39910000
399200              DISPLAY '*PROGRAM   = RCKUP075             *'       39920000
399300              DISPLAY '*DB2 OPER  = SUT_OTBND_UPC        *'       39930000
399400              DISPLAY '*PARAGRAPH = 6560-CREATE-OTBND-UPC*'       39940000
399500              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               39950000
399600              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            39960000
399700              DISPLAY '***********************************'       39970000
399800              PERFORM 9100-SQL-ABEND                              39980000
399900                                                                  39990000
400000     END-EVALUATE.                                                40000000
400100                                                                  40010000
400200                                                                  40020000
400300*----------------------------------------------------------------*40030000
400400*                                                                *40040000
400500*----------------------------------------------------------------*40050000
400600 6565-UPDATE-OTBND-UPC.                                           40060000
400700     IF  PS-TEST-ONLY-DISPLAY-YES                                 40070000
400800         DISPLAY ' RCKUP075 - 6565-UPDATE-OTBND-UPC'              40080000
400900     END-IF.                                                      40090000
401000                                                                  40100000
401100     MOVE  RC119-SHIP-UNT-QTY  TO  PV-SHIP-UNT-QTY.               40110000
401200                                                                  40120000
401300     EXEC SQL                                                     40130000
401400          UPDATE SUT_OTBND_UPC                                    40140000
401500             SET SHPD_UNT_QTY = (SHPD_UNT_QTY +                   40150000
401600                                 :PV-SHIP-UNT-QTY)                40160000
401700           WHERE SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID           40170000
401800             AND TRN_NBR       = :SUT00028-TRN-NBR                40180000
401900             AND RCVR_SEQ_NBR  = :SUT00028-RCVR-SEQ-NBR           40190000
402000             AND TRN_LNE_NBR   = :SUT00028-TRN-LNE-NBR            40200000
402100             AND TRN_TYP_CDE   = :SUT00028-TRN-TYP-CDE            40210000
402200             AND UPC_NBR       = :SUT00028-UPC-NBR                40220000
402300     END-EXEC.                                                    40230000
402400                                                                  40240000
402500     EVALUATE TRUE                                                40250000
402600         WHEN SQLCODE = ZERO                                      40260000
402700              CONTINUE                                            40270000
402800                                                                  40280000
402900         WHEN SQLWARN0 NOT = SPACES                               40290000
403000         WHEN SQLCODE NOT = ZERO                                  40300000
403100                                                                  40310000
403200              SET  PS-ERROR-YES   TO  TRUE                        40320000
403300                                                                  40330000
403400              MOVE SQLCODE        TO PV-DISP-SQLCODE              40340000
403500              DISPLAY  ' RCKUP075-6565-'                          40350000
403600                       ' SQL:'       PV-DISP-SQLCODE              40360000
403700                       ' PO:'        RC119-KOHLS-PO-NBR           40370000
403800                       ' STR:'       RC119-DEST-STORE-NBR         40380000
403900                       ' SSCC:'      RC119-SML-NBR-NUM            40390000
404000              DISPLAY  ' RCKUP075-6565-'                          40400000
404100                       ' SML:'       RC119-SML-NBR-NUM            40410000
404200                                                                  40420000
404300              DISPLAY '***********************************'       40430000
404400              DISPLAY '*ABEND                            *'       40440000
404500              DISPLAY '*PROGRAM   = RCKUP075             *'       40450000
404600              DISPLAY '*DB2 OPER  = SUT_OTBND_UPC        *'       40460000
404700              DISPLAY '*PARAGRAPH = 6565-UPDATE-OTBND-UPC*'       40470000
404800              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               40480000
404900              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            40490000
405000              DISPLAY '***********************************'       40500000
405100              PERFORM 9100-SQL-ABEND                              40510000
405200                                                                  40520000
405300     END-EVALUATE.                                                40530000
405400                                                                  40540000
405500                                                                  40550000
405600*----------------------------------------------------------------*40560000
405700*                                                                *40570000
405800*----------------------------------------------------------------*40580000
405900 6585-INS-OTBND-LOC.                                              40590000
406000     IF  PS-TEST-ONLY-DISPLAY-YES                                 40600000
406100         DISPLAY ' RCKUP075 - 6585-INS-OTBND-LOC'                 40610000
406200                 ' SML: ' PV-SML-BARCODE                          40620000
406300     END-IF.                                                      40630000
406400                                                                  40640000
406500     INITIALIZE DCLSUT00027.                                      40650000
406600     MOVE PV-SML-BARCODE        TO SUT00027-SHIPT-UNT-ID.         40660000
406700     MOVE RC119-3RD-PRTY-DC-NBR TO SUT00027-LOC-NBR.              40670000
406800     MOVE PC-RECV               TO SUT00027-SCN-CDE.              40680000
406900     MOVE PC-THRDPRTY           TO SUT00027-CRE-USR-ID.           40690000
407000     MOVE PC-A                  TO SUT00027-ACTV-CDE.             40700000
407100     MOVE ZERO                  TO SUT00027-INBD-TRIP-ID.         40710000
407200                                                                  40720000
407300     EXEC SQL                                                     40730000
407400          INSERT INTO SUT_OTBND_LOC                               40740000
407500               (                                                  40750000
407600                 SHIPT_UNT_ID                                     40760000
407700               , CRE_TMST                                         40770000
407800               , OTBND_TRIP_ID                                    40780000
407900               , LOC_NBR                                          40790000
408000               , SCN_CDE                                          40800000
408100               , CRE_USR_ID                                       40810000
408200               , ACTV_CDE                                         40820000
408300               , INBD_TRIP_ID                                     40830000
408400               )                                                  40840000
408500          VALUES                                                  40850000
408600               (                                                  40860000
408700                 :SUT00027-SHIPT-UNT-ID                           40870000
408800               ,  CURRENT TIMESTAMP                               40880000
408900               ,  NULL                                            40890000
409000               , :SUT00027-LOC-NBR                                40900000
409100               , :SUT00027-SCN-CDE                                40910000
409200               , :SUT00027-CRE-USR-ID                             40920000
409300               , :SUT00027-ACTV-CDE                               40930000
409400               , :SUT00027-INBD-TRIP-ID                           40940000
409500               )                                                  40950000
409600     END-EXEC.                                                    40960000
409700                                                                  40970000
409800     EVALUATE TRUE                                                40980000
409900        WHEN SQLCODE = ZERO                                       40990000
410000             CONTINUE                                             41000000
410100                                                                  41010000
410200         WHEN SQLWARN0 NOT = SPACES                               41020000
410300         WHEN SQLCODE NOT = ZERO                                  41030000
410400                                                                  41040000
410500              SET  PS-ERROR-YES         TO TRUE                   41050000
410600                                                                  41060000
410700              MOVE SQLCODE              TO PV-DISP-SQLCODE        41070000
410800              DISPLAY  ' RCKUP075-6585-'                          41080000
410900                       ' SQL:'             PV-DISP-SQLCODE        41090000
411000                       ' PO:'              RC119-KOHLS-PO-NBR     41100000
411100                       ' STR:'             RC119-DEST-STORE-NBR   41110000
411200                       ' SSCC:'            RC119-SML-NBR-NUM      41120000
411300              DISPLAY  ' RCKUP075-6585-'                          41130000
411400                       ' SML:'             RC119-SML-NBR-NUM      41140000
411500                                                                  41150000
411600              DISPLAY '*****************************************' 41160000
411700              DISPLAY '*ABEND                                  *' 41170000
411800              DISPLAY '*PROGRAM   = RCKUP075                   *' 41180000
411900              DISPLAY '*DB2 OPER  = SUT_OTBND_LOC              *' 41190000
412000              DISPLAY '*PARAGRAPH = 6585-INS-OTBND-LOC         *' 41200000
412100              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               41210000
412200              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            41220000
412300              DISPLAY '*****************************************' 41230000
412400              PERFORM 9100-SQL-ABEND                              41240000
412500                                                                  41250000
412600     END-EVALUATE.                                                41260000
412700                                                                  41270000
412800                                                                  41280000
412900*----------------------------------------------------------------*41290000
413000*                                                                *41300000
413100*----------------------------------------------------------------*41310000
413200 7000-READ-INPUT.                                                 41320000
413300     IF  PS-TEST-ONLY-DISPLAY-YES                                 41330000
413400         DISPLAY ' '                                              41340000
413500         DISPLAY ' RCKUP075 - 7000-READ-INPUT'                    41350000
413600         DISPLAY ' RCKUP075 - SWITCHES:' PS-PROGRAM-SWITCHES      41360000
413700     END-IF.                                                      41370000
413800                                                                  41380000
413920     READ THIRD-PARTY-OTBND-FILE                                  41392004
413921          INTO RC119-VALID-SHIPMENT-REC                           41392104
413930               AT END                                             41393004
413940                   SET PS-EOF-YES      TO TRUE                    41394004
413950               NOT AT END                                         41395004
413960                   ADD 1             TO PV-INPUT-COUNT            41396004
413961                   ADD RC119-SHIP-UNT-QTY                         41396122
413962                                     TO  PV-TOT-RC119-FILE-QTY    41396222
413970     END-READ.                                                    41397004
413980                                                                  41398004
413990                                                                  41399012
413991     IF  RC119-ABEND                                              41399112
413992         SET PS-ERROR-YES  TO   TRUE                              41399212
413993         MOVE +4013 TO ABEND-CODE                                 41399314
413994         CALL 'ILBOABN0' USING ABEND-CODE                         41399413
413995     END-IF.                                                      41399512
413996                                                                  41399612
414000                                                                  41400000
414100     SET  PS-FIRST-PREPK-LINE-YES                                 41410000
414200          PS-ODD-UNT-CRTN-FOUND-NO TO  TRUE                       41420000
414300                                                                  41430000
414400     IF  PS-TEST-ONLY-DISPLAY-YES                                 41440000
414500         DISPLAY ' RCKUP075 - INPUT:' RC119-VALID-SHIPMENT-REC    41450000
414600         DISPLAY ' '                                              41460000
414700     END-IF.                                                      41470000
414800                                                                  41480000
414801                                                                  41480104
414802*----------------------------------------------------------------*41480204
414803*                                                                *41480304
414804*----------------------------------------------------------------*41480404
414820 7010-READ-RESTART.                                               41482004
414821                                                                  41482104
414822     IF  PS-TEST-ONLY-DISPLAY-YES                                 41482204
414823         DISPLAY ' '                                              41482304
414824         DISPLAY ' RCKUP075 - 7010-READ-RESTART'                  41482418
414825         DISPLAY ' RCKUP075 - SWITCHES:' PS-PROGRAM-SWITCHES      41482504
414826     END-IF.                                                      41482604
414827                                                                  41482704
414828     READ THIRD-PARTY-OTBND-FILE                                  41482804
414829          INTO RC119-VALID-SHIPMENT-REC                           41482904
414830               AT END                                             41483004
414831                  SET PS-EOF-YES      TO TRUE                     41483104
414832               NOT AT END                                         41483204
414835                  ADD 1             TO PV-BYPASS-COUNT            41483504
414836     END-READ.                                                    41483604
414890                                                                  41489004
414891     ADD RC119-SHIP-UNT-QTY        TO  PV-TOT-RC119-FILE-QTY.     41489118
414892                                                                  41489218
414893     IF  PV-BYPASS-COUNT  = PV-RESTART-QTY                        41489318
414894         ADD  1  TO  PV-INPUT-COUNT                               41489418
414895     END-IF.                                                      41489518
414896                                                                  41489618
414897                                                                  41489718
414898     IF  PS-TEST-ONLY-DISPLAY-YES                                 41489818
414899         DISPLAY ' RCKUP075 - INPUT:' RC119-VALID-SHIPMENT-REC    41489918
414900         DISPLAY ' '                                              41490018
414901     END-IF.                                                      41490118
414902                                                                  41490218
414903                                                                  41490318
414904                                                                  41490418
414910*----------------------------------------------------------------*41491000
415000*                                                                *41500000
415100*----------------------------------------------------------------*41510000
415200 7100-WRITE-OUTPUT.                                               41520000
415300     IF  PS-TEST-ONLY-DISPLAY-YES                                 41530000
415400         DISPLAY ' '                                              41540000
415500         DISPLAY ' RCKUP075 - 7100-WRITE-OUTPUT'                  41550000
415600     END-IF.                                                      41560000
415700                                                                  41570000
415800     MOVE  PV-NEW-REC-SEQ-NBR  TO  RC119-REC-SEQ-NBR.             41580000
415900                                                                  41590000
416000                                                                  41600000
416100     WRITE OUT-PO-STR-SSCC-RECORD                                 41610000
416200      FROM RC119-VALID-SHIPMENT-REC.                              41620000
416300                                                                  41630000
416400     ADD  1  TO  PV-RCRD119-COUNT.                                41640017
416500                                                                  41650000
416600     IF  PS-TEST-ONLY-DISPLAY-YES                                 41660000
416700         DISPLAY ' RCKUP075 - OUTPUT:' RC119-VALID-SHIPMENT-REC   41670000
416800         DISPLAY ' '                                              41680000
416900     END-IF.                                                      41690000
417000                                                                  41700000
417100                                                                  41710000
417200*----------------------------------------------------------------*41720000
417300* WRITE STORE EXPECTED OUTPUT FILE                               *41730000
417400*----------------------------------------------------------------*41740000
417500 7110-WRITE-OUTPUT2.                                              41750000
417600                                                                  41760000
417700     IF  PS-TEST-ONLY-DISPLAY-YES                                 41770000
417800         DISPLAY ' '                                              41780000
417900         DISPLAY ' RCKUP075 - 7110-WRITE-OUTPUT2'                 41790000
418000     END-IF.                                                      41800000
418100                                                                  41810000
418200     INITIALIZE RC095-TRKG-REC.                                   41820000
418300     MOVE RC119-KOHLS-PO-NBR       TO  RC095-PO-NBR.              41830000
418400     MOVE RC119-DEST-STORE-NBR     TO  RC095-STR-NBR.             41840000
418500     MOVE RC119-SML-NBR-NUM        TO  RC095-SHIPT-UNT-ID.        41850000
418600     MOVE PV-NEW-REC-SEQ-NBR       TO  RC095-REC-SEQ-NBR.         41860000
418700     MOVE RC119-3RD-PRTY-DC-NBR    TO  RC095-CURR-OPER-UNT.       41870000
418800                                                                  41880000
418900                                                                  41890000
419000     WRITE OUT-PO-RCVR-OPER-SSCC-RECORD                           41900000
419100      FROM RC095-TRKG-REC.                                        41910000
419200                                                                  41920000
419300     ADD  1  TO  PV-RCRD095-COUNT.                                41930017
419400                                                                  41940000
419500     IF  PS-TEST-ONLY-DISPLAY-YES                                 41950000
419600         DISPLAY ' RCKUP064 - OUTPUT:' RC095-TRKG-REC             41960000
419700         DISPLAY ' '                                              41970000
419800     END-IF.                                                      41980000
419900                                                                  41990000
419910*----------------------------------------------------------------*41991003
419920* CHECK TO SEE IF THIS IS A RESTART RUN                          *41992003
419930*----------------------------------------------------------------*41993003
419940 7200-CHECK-RESTART.                                              41994003
419950                                                                  41995003
419960     IF  PS-TEST-ONLY-DISPLAY-YES                                 41996003
419970         DISPLAY ' '                                              41997003
419980         DISPLAY ' RCKUP075 - 7200-CHECK-RESTART'                 41998003
419990     END-IF.                                                      41999003
419991                                                                  41999103
419992     MOVE ZEROES  TO   PV-RESTART-QTY.                            41999203
419993                                                                  41999303
419994     EXEC SQL                                                     41999403
419995          SELECT FUNC_QTY                                         41999503
419996            INTO :PV-RESTART-QTY                                  41999603
419997            FROM TKRPRPM                                          41999703
419998           WHERE LOC_ID             = :PC-90                      41999803
419999             AND INTFC_SYS_CDE      = :PC-KHL                     41999903
420000             AND SYS_PRC_FUNC_CDE   = '3WDRST'                    42000003
420001             AND FUNC_PRC_STAT_CDE  = :PC-AC                      42000103
420002             AND FUNC_BEG_TMST     <= CURRENT TIMESTAMP           42000203
420003             AND FUNC_END_TMST     >= CURRENT TIMESTAMP           42000303
420004            WITH UR                                               42000403
420005     END-EXEC.                                                    42000503
420006                                                                  42000603
420007     EVALUATE TRUE                                                42000703
420008         WHEN SQLCODE = +0                                        42000803
420009              MOVE PV-RESTART-QTY  TO  PV-DISP-PARM-QTY           42000903
420010              IF  PV-RESTART-QTY > 0                              42001003
420011                  DISPLAY ' RCKUP075 - RESTART RUN'               42001103
420012                          '    PARM:  3WDRST'                     42001222
420013                  DISPLAY ' RECORD TO START AT:   '               42001322
420014                           PV-DISP-PARM-QTY                       42001422
420015                  DISPLAY ' '                                     42001523
420017              ELSE                                                42001722
420018                  DISPLAY ' RCKUP075 - FULL FILE TO BE PROCESSED' 42001822
420019                          '    PARM:  3WDRST'                     42001923
420020                  DISPLAY ' PARM VALUE:  '                        42002022
420021                           PV-DISP-PARM-QTY                       42002122
420022                  DISPLAY ' '                                     42002223
420023              END-IF                                              42002322
420024                                                                  42002403
420025         WHEN SQLCODE = +100                                      42002503
420026                  DISPLAY ' RCKUP075 - FULL FILE TO BE PROCESSED' 42002603
420027                                                                  42002703
420028         WHEN SQLWARN0 NOT = SPACES                               42002803
420029         WHEN SQLCODE < +0                                        42002903
420030         WHEN SQLCODE > +0                                        42003003
420031                                                                  42003103
420032              SET  PS-ERROR-YES         TO TRUE                   42003203
420033                                                                  42003303
420034              MOVE SQLCODE              TO PV-DISP-SQLCODE        42003403
420035              DISPLAY  ' RCKUP075-7200-'                          42003503
420036                       ' SQL:'             PV-DISP-SQLCODE        42003603
420037                                                                  42003703
420038              DISPLAY '*****************************************' 42003803
420039              DISPLAY '*ABEND                                  *' 42003903
420040              DISPLAY '*PROGRAM   = RCKUP075                   *' 42004003
420041              DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM          *' 42004103
420042              DISPLAY '*PARAGRAPH = 7200-CHECK-RESTART         *' 42004203
420043              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               42004303
420044              DISPLAY '*PARM:       3WDRST'                       42004404
420045              DISPLAY '*****************************************' 42004503
420046              PERFORM 9100-SQL-ABEND                              42004603
420047     END-EVALUATE.                                                42004703
420048                                                                  42004803
420049                                                                  42004903
420050*----------------------------------------------------------------*42005002
420051* RESET RESTART PARM TO 0                                        *42005103
420052*----------------------------------------------------------------*42005202
420053 7210-RESET-RESTART.                                              42005303
420054                                                                  42005402
420055     IF  PS-TEST-ONLY-DISPLAY-YES                                 42005502
420056         DISPLAY ' '                                              42005602
420057         DISPLAY ' RCKUP075 - 7210-RESET-RESTART'                 42005716
420058                  '   SET BACK TO 0             '                 42005816
420059     END-IF.                                                      42005916
420060                                                                  42006016
420061     MOVE ZEROES  TO   PV-RESTART-QTY.                            42006116
420062                                                                  42006216
420063     EXEC SQL                                                     42006302
420070          UPDATE TKRPRPM                                          42007003
420080             SET FUNC_QTY = :PV-RESTART-QTY                       42008003
420091           WHERE LOC_ID             = :PC-90                      42009102
420092             AND INTFC_SYS_CDE      = :PC-KHL                     42009202
420093             AND SYS_PRC_FUNC_CDE   = '3WDRST'                    42009302
420094             AND FUNC_PRC_STAT_CDE  = :PC-AC                      42009402
420095             AND FUNC_BEG_TMST     <= CURRENT TIMESTAMP           42009502
420096             AND FUNC_END_TMST     >= CURRENT TIMESTAMP           42009602
420098     END-EXEC.                                                    42009802
420099                                                                  42009902
420100     EVALUATE TRUE                                                42010002
420101         WHEN SQLCODE = +0                                        42010102
420104              DISPLAY ' '                                         42010423
420105              DISPLAY ' RCKUP075 - RESTART RECORD '               42010523
420106                          '    PARM:  3WDRST'                     42010623
420107              DISPLAY ' RECORD TO START AT:   NUMBER '            42010723
420108                      'SET BACK TO 0'                             42010823
420113                                                                  42011302
420114         WHEN SQLCODE = +100                                      42011402
420117         WHEN SQLWARN0 NOT = SPACES                               42011702
420118         WHEN SQLCODE < +0                                        42011802
420119         WHEN SQLCODE > +0                                        42011902
420120                                                                  42012002
420121              SET  PS-ERROR-YES         TO TRUE                   42012102
420122                                                                  42012202
420123              MOVE SQLCODE              TO PV-DISP-SQLCODE        42012302
420124              DISPLAY  ' RCKUP075-7210-'                          42012403
420125                       ' SQL:'             PV-DISP-SQLCODE        42012502
420131                                                                  42013102
420132              DISPLAY '*****************************************' 42013202
420133              DISPLAY '*ABEND                                  *' 42013302
420134              DISPLAY '*PROGRAM   = RCKUP075                   *' 42013402
420135              DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM          *' 42013502
420136              DISPLAY '*PARAGRAPH = 7210-RESET-RESTART         *' 42013603
420137              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               42013702
420138              DISPLAY '*PARM:       3WDRST'                       42013804
420139              DISPLAY '*****************************************' 42013902
420140              PERFORM 9100-SQL-ABEND                              42014002
420141     END-EVALUATE.                                                42014102
420142                                                                  42014202
420143                                                                  42014302
420144*----------------------------------------------------------------*42014403
420145* UPDATE RESTART PARM TO LAST RECORD PROCESSED FOR COMMIT        *42014503
420146*----------------------------------------------------------------*42014603
420147 7220-SET-COMMIT-RESTART.                                         42014703
420148                                                                  42014803
420149     IF  PS-TEST-ONLY-DISPLAY-YES                                 42014903
420150         DISPLAY ' '                                              42015003
420151         DISPLAY ' RCKUP075 - 7220-SET-COMMIT-RESTART'            42015103
420152     END-IF.                                                      42015203
420153                                                                  42015303
420154***  MOVE RC119-VALID-FILE-RECORD-NBR                             42015426
420155     MOVE RC119-SORT-OUT-RECORD-NBR                               42015526
420156       TO KRPRPM-FUNC-QTY                                         42015626
420157                                                                  42015726
420158     EXEC SQL                                                     42015826
420159          UPDATE TKRPRPM                                          42015926
420160             SET FUNC_QTY = :KRPRPM-FUNC-QTY                      42016026
420161           WHERE LOC_ID             = :PC-90                      42016104
420162             AND INTFC_SYS_CDE      = :PC-KHL                     42016204
420163             AND SYS_PRC_FUNC_CDE   = '3WDRST'                    42016304
420164             AND FUNC_PRC_STAT_CDE  = :PC-AC                      42016404
420165             AND FUNC_BEG_TMST     <= CURRENT TIMESTAMP           42016504
420166             AND FUNC_END_TMST     >= CURRENT TIMESTAMP           42016604
420168     END-EXEC.                                                    42016804
420169                                                                  42016904
420170     EVALUATE TRUE                                                42017004
420171         WHEN SQLCODE = +0                                        42017104
420172              CONTINUE                                            42017204
420181                                                                  42018104
420185         WHEN SQLWARN0 NOT = SPACES                               42018504
420186         WHEN SQLCODE < +0                                        42018604
420187         WHEN SQLCODE > +0                                        42018704
420188                                                                  42018804
420189              SET  PS-ERROR-YES         TO TRUE                   42018904
420190                                                                  42019004
420191              MOVE SQLCODE              TO PV-DISP-SQLCODE        42019104
420192              MOVE KRPRPM-FUNC-QTY      TO PV-DISP-COUNT          42019211
420193              DISPLAY  ' RCKUP075-7220-'                          42019304
420194                       ' SQL:'             PV-DISP-SQLCODE        42019404
420195              DISPLAY  ' RCKUP075-7220-'                          42019504
420196                       ' RECORD COUNT:'    PV-DISP-COUNT          42019604
420197                                                                  42019704
420198              DISPLAY '*****************************************' 42019804
420199              DISPLAY '*ABEND                                  *' 42019904
420200              DISPLAY '*PROGRAM   = RCKUP075                   *' 42020004
420201              DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM          *' 42020104
420202              DISPLAY '*PARAGRAPH = 7220-SET-COMMIT-RESTART    *' 42020204
420203              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               42020304
420204              DISPLAY '*PARM:       3WDRST'                       42020404
420205              DISPLAY '*****************************************' 42020504
420206              PERFORM 9100-SQL-ABEND                              42020604
420207     END-EVALUATE.                                                42020704
420208                                                                  42020804
420209                                                                  42020904
420210*----------------------------------------------------------------*42021004
420220*                                                                *42022000
420300*----------------------------------------------------------------*42030000
420400 8000-VERIFY-PREV-RCVR.                                           42040000
420410                                                                  42041004
420500     IF  PS-TEST-ONLY-DISPLAY-YES                                 42050000
420600         DISPLAY ' RCKUP075 - 8000-VERIFY-PREV-RCVR'              42060000
420700     END-IF.                                                      42070000
420800                                                                  42080000
420900     SET PS-EOF-VERIFY-RECITM-CSR-NO  TO  TRUE.                   42090000
421000                                                                  42100000
421100     MOVE PV-PREV-KOHLS-PO-NBR        TO  PV-VE-PO-NBR.           42110000
421200     MOVE PV-NEW-REC-SEQ-NBR          TO  PV-VE-RCVR-NBR.         42120000
421300                                                                  42130000
421400     IF  PS-TEST-ONLY-DISPLAY-YES                                 42140000
421500         MOVE PV-VE-PO-NBR            TO  PV-DISP-VE-PO-NBR       42150000
421600         MOVE PV-VE-RCVR-NBR          TO  PV-DISP-VE-RCVR-NBR     42160000
421700         DISPLAY ' RCKUP075 - 8000-'                              42170000
421800                 ' RCVR:'                 PV-DISP-VE-PO-NBR       42180000
421900                 '-'                      PV-DISP-VE-RCVR-NBR     42190000
422000     END-IF.                                                      42200000
422100                                                                  42210000
422200     PERFORM 8010-OPEN-VERIFY-RECITM-CSR.                         42220000
422300                                                                  42230000
422400     PERFORM 8015-FETCH-VERIFY-RECITM-CSR                         42240000
422500       UNTIL PS-EOF-VERIFY-RECITM-CSR                             42250000
422600          OR PS-ERROR-YES.                                        42260000
422700                                                                  42270000
422800     PERFORM 8020-CLOSE-VERIFY-RECITM-CSR.                        42280000
422900                                                                  42290000
423000     PERFORM 8110-UPDATE-RECEIVER-VE.                             42300000
423100                                                                  42310000
423200                                                                  42320000
423300*----------------------------------------------------------------*42330000
423400*                                                                *42340000
423500*----------------------------------------------------------------*42350000
423600 8010-OPEN-VERIFY-RECITM-CSR.                                     42360000
423610                                                                  42361004
423700     IF  PS-TEST-ONLY-DISPLAY-YES                                 42370000
423800         DISPLAY ' RCKUP075 -  8010-OPEN-VERIFY-RECITM-CSR'       42380000
423900     END-IF.                                                      42390000
424000                                                                  42400000
424100     EXEC SQL                                                     42410000
424200         OPEN PO-RCVR-VE-CSR                                      42420000
424300     END-EXEC.                                                    42430000
424400                                                                  42440000
424500     EVALUATE TRUE                                                42450000
424600       WHEN SQLCODE = ZERO                                        42460000
424700           SET PS-EOF-VERIFY-RECITM-CSR-NO TO TRUE                42470000
424800                                                                  42480000
424900       WHEN SQLWARN0 NOT = SPACES                                 42490000
425000       WHEN SQLCODE  NOT = ZERO                                   42500000
425100                                                                  42510000
425200              SET  PS-ERROR-YES         TO TRUE                   42520000
425300                                                                  42530000
425400              MOVE SQLCODE              TO PV-DISP-SQLCODE        42540000
425500              DISPLAY  ' RCKUP075-8010-'                          42550000
425600                       ' SQL:'             PV-DISP-SQLCODE        42560000
425700                       ' PO:'              RC119-KOHLS-PO-NBR     42570000
425800                       ' STR:'             RC119-DEST-STORE-NBR   42580000
425900                       ' SSCC:'            RC119-SML-NBR-NUM      42590000
426000              DISPLAY  ' RCKUP075-8010-'                          42600000
426100                       ' SML:'             RC119-SML-NBR-NUM      42610000
426200                                                                  42620000
426300             MOVE  PV-VE-PO-NBR         TO PV-DISP-VE-PO-NBR      42630000
426400             MOVE  PV-VE-RCVR-NBR       TO PV-DISP-VE-RCVR-NBR    42640000
426500             DISPLAY  ' RCKUP075-8010-'                           42650000
426600                       ' VE RCVR: ' PV-DISP-VE-PO-NBR             42660023
426700                       '-'          PV-DISP-VE-RCVR-NBR           42670023
426800                                                                  42680000
426900              DISPLAY '*****************************************' 42690000
427000              DISPLAY '*ABEND                                  *' 42700000
427100              DISPLAY '*PROGRAM   = RCKUP075                   *' 42710000
427200              DISPLAY '*DB2 OPER  = TRECEIV / TRECITM          *' 42720000
427300              DISPLAY '*PARAGRAPH = 8010-OPEN-VERIFY-RECITM-CSR*' 42730000
427400              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               42740000
427500              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            42750000
427600              DISPLAY '*****************************************' 42760000
427700              PERFORM 9100-SQL-ABEND                              42770000
427800     END-EVALUATE.                                                42780000
427900                                                                  42790000
428000                                                                  42800000
428100*----------------------------------------------------------------*42810000
428200*                                                                *42820000
428300*----------------------------------------------------------------*42830000
428400 8015-FETCH-VERIFY-RECITM-CSR.                                    42840000
428410                                                                  42841004
428500     IF  PS-TEST-ONLY-DISPLAY-YES                                 42850000
428600         DISPLAY ' RCKUP075 -  8015-FETCH-VERIFY-RECITM-CSR'      42860000
428700         MOVE  PV-VE-PO-NBR         TO PV-DISP-VE-PO-NBR          42870000
428800         MOVE  PV-VE-RCVR-NBR       TO PV-DISP-VE-RCVR-NBR        42880000
428900         MOVE  PV-VE-OPER-UNT-ID    TO PV-DISP-VE-OPER-UNT        42890000
429000         MOVE  PV-VE-FCLTY-ID       TO PV-DISP-VE-FCLTY-ID        42900000
429100         MOVE  PV-VE-LNE-NBR        TO PV-DISP-VE-LINE-NBR        42910000
429200         DISPLAY  ' RCKUP075-8015-'                               42920000
429300                  ' VE RCVR:'          PV-DISP-VE-OPER-UNT        42930000
429400                  '-'                  PV-DISP-VE-FCLTY-ID        42940000
429500                  '-'                  PV-DISP-VE-PO-NBR          42950000
429600                  '-'                  PV-DISP-VE-RCVR-NBR        42960000
429700                  '-'                  PV-DISP-VE-LINE-NBR        42970000
429800                  '-'                  PV-VE-STATUS               42980000
429900     END-IF.                                                      42990000
430000                                                                  43000000
430100     EXEC SQL                                                     43010000
430200         FETCH  PO-RCVR-VE-CSR                                    43020000
430300          INTO :PV-VE-OPER-UNT-ID                                 43030000
430400             , :PV-VE-FCLTY-ID                                    43040000
430500             , :PV-VE-LNE-NBR                                     43050000
430600             , :PV-VE-STATUS                                      43060000
430700             , :PV-VE-PREPK-ODD-UNT-QTY                           43070000
430800     END-EXEC.                                                    43080000
430900                                                                  43090000
431000     EVALUATE TRUE                                                43100000
431100       WHEN SQLCODE = ZERO                                        43110000
431200            PERFORM 8100-UPDATE-REC-ITEM-VE                       43120000
431300            IF  PV-VE-PREPK-ODD-UNT-QTY   >  0                    43130000
431400                PERFORM 8120-INSERT-VRFD-ODD-UNT                  43140000
431500            END-IF                                                43150000
431600                                                                  43160000
431700       WHEN SQLCODE = +100                                        43170000
431800            SET PS-EOF-VERIFY-RECITM-CSR      TO  TRUE            43180000
431900                                                                  43190000
432000       WHEN SQLWARN0 NOT = SPACES                                 43200000
432100       WHEN SQLCODE  NOT = ZERO                                   43210000
432200                                                                  43220000
432300              SET  PS-ERROR-YES         TO TRUE                   43230000
432400                                                                  43240000
432500              MOVE SQLCODE              TO PV-DISP-SQLCODE        43250000
432600              DISPLAY  ' RCKUP075-8015-'                          43260000
432700                       ' SQL:'             PV-DISP-SQLCODE        43270000
432800                       ' PO:'              RC119-KOHLS-PO-NBR     43280000
432900                       ' STR:'             RC119-DEST-STORE-NBR   43290000
433000                       ' SSCC:'            RC119-SML-NBR-NUM      43300000
433100              DISPLAY  ' RCKUP075-8015-'                          43310000
433200                       ' SML:'             RC119-SML-NBR-NUM      43320000
433300                                                                  43330000
433400             MOVE  PV-VE-PO-NBR         TO PV-DISP-VE-PO-NBR      43340000
433500             MOVE  PV-VE-RCVR-NBR       TO PV-DISP-VE-RCVR-NBR    43350000
433600             MOVE  PV-VE-OPER-UNT-ID    TO PV-DISP-VE-OPER-UNT    43360000
433700             MOVE  PV-VE-FCLTY-ID       TO PV-DISP-VE-FCLTY-ID    43370000
433800             MOVE  PV-VE-LNE-NBR        TO PV-DISP-VE-LINE-NBR    43380000
433900             DISPLAY  ' RCKUP075-8015-'                           43390000
434000                       ' VE RCVR:'         PV-DISP-VE-OPER-UNT    43400000
434100                       '-'                 PV-DISP-VE-FCLTY-ID    43410000
434200                       '-'                 PV-DISP-VE-PO-NBR      43420000
434300                       '-'                 PV-DISP-VE-RCVR-NBR    43430000
434400                       '-'                 PV-DISP-VE-LINE-NBR    43440000
434500                       '-'                 PV-VE-STATUS           43450000
434600                                                                  43460000
434700              DISPLAY '*****************************************' 43470000
434800              DISPLAY '*ABEND                                  *' 43480000
434900              DISPLAY '*PROGRAM   = RCKUP075                   *' 43490000
435000              DISPLAY '*DB2 OPER  = FETCH TRECEIV / TRECITM    *' 43500000
435100              DISPLAY '*PARAGRAPH = 8015-FETCH-VERIFY-RECITM-CSR' 43510000
435200              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               43520000
435300              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            43530000
435400              DISPLAY '*****************************************' 43540000
435500              PERFORM 9100-SQL-ABEND                              43550000
435600                                                                  43560000
435700     END-EVALUATE.                                                43570000
435800                                                                  43580000
435900                                                                  43590000
436000*----------------------------------------------------------------*43600000
436100*                                                                *43610000
436200*----------------------------------------------------------------*43620000
436300 8020-CLOSE-VERIFY-RECITM-CSR.                                    43630000
436400     IF  PS-TEST-ONLY-DISPLAY-YES                                 43640000
436500         DISPLAY ' RCKUP075 -  8020-CLOSE-VERIFY-RECITM-CSR'      43650000
436600     END-IF.                                                      43660000
436700                                                                  43670000
436800     EXEC SQL                                                     43680000
436900         CLOSE PO-RCVR-VE-CSR                                     43690000
437000     END-EXEC.                                                    43700000
437100                                                                  43710000
437200     EVALUATE TRUE                                                43720000
437300       WHEN SQLCODE = ZERO                                        43730000
437400           SET PS-EOF-VERIFY-RECITM-CSR      TO  TRUE             43740000
437500                                                                  43750000
437600       WHEN SQLWARN0 NOT = SPACES                                 43760000
437700       WHEN SQLCODE  NOT = ZERO                                   43770000
437800                                                                  43780000
437900              SET  PS-ERROR-YES         TO TRUE                   43790000
438000                                                                  43800000
438100              MOVE SQLCODE              TO PV-DISP-SQLCODE        43810000
438200              DISPLAY  ' RCKUP075-8020-'                          43820000
438300                       ' SQL:'             PV-DISP-SQLCODE        43830000
438400                       ' PO:'              RC119-KOHLS-PO-NBR     43840000
438500                       ' STR:'             RC119-DEST-STORE-NBR   43850000
438600                       ' SSCC:'            RC119-SML-NBR-NUM      43860000
438700              DISPLAY  ' RCKUP075-8020-'                          43870000
438800                       ' SML:'             RC119-SML-NBR-NUM      43880000
438900                                                                  43890000
439000             MOVE  PV-VE-PO-NBR         TO PV-DISP-VE-PO-NBR      43900000
439100             MOVE  PV-VE-RCVR-NBR       TO PV-DISP-VE-RCVR-NBR    43910000
439200             MOVE  PV-VE-OPER-UNT-ID    TO PV-DISP-VE-OPER-UNT    43920000
439300             MOVE  PV-VE-FCLTY-ID       TO PV-DISP-VE-FCLTY-ID    43930000
439400             MOVE  PV-VE-LNE-NBR        TO PV-DISP-VE-LINE-NBR    43940000
439500             DISPLAY  ' RCKUP075-8020-'                           43950000
439600                       ' VE RCVR:'         PV-DISP-VE-OPER-UNT    43960000
439700                       '-'                 PV-DISP-VE-FCLTY-ID    43970000
439800                       '-'                 PV-DISP-VE-PO-NBR      43980000
439900                       '-'                 PV-DISP-VE-RCVR-NBR    43990000
440000                       '-'                 PV-DISP-VE-LINE-NBR    44000000
440100                       '-'                 PV-VE-STATUS           44010000
440200                                                                  44020000
440300              DISPLAY '*****************************************' 44030000
440400              DISPLAY '*ABEND                                  *' 44040000
440500              DISPLAY '*PROGRAM   = RCKUP075                   *' 44050000
440600              DISPLAY '*DB2 OPER  = TRECEIV / TRECITM          *' 44060000
440700              DISPLAY '*PARAGRAPH = 8020-CLOSE-VERIFY-RECITM-CSR' 44070000
440800              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               44080000
440900              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            44090000
441000              DISPLAY '*****************************************' 44100000
441100              PERFORM 9100-SQL-ABEND                              44110000
441200     END-EVALUATE.                                                44120000
441300                                                                  44130000
441400                                                                  44140000
441500*----------------------------------------------------------------*44150000
441600*                                                                *44160000
441700*----------------------------------------------------------------*44170000
441800 8100-UPDATE-REC-ITEM-VE.                                         44180000
441900     IF  PS-TEST-ONLY-DISPLAY-YES                                 44190000
442000         DISPLAY ' RCKUP075 -  8100-UPDATE-REC-ITEM-VE'           44200000
442100     END-IF.                                                      44210000
442200                                                                  44220000
442300     EXEC SQL                                                     44230000
442400          UPDATE   TRECITM                                        44240000
442500             SET   STATUS_CDE         = :PC-VE                    44250000
442600                  ,VERFYD_TMST        =  CURRENT TIMESTAMP        44260000
442700                  ,VRFD_USR_ID        = :PC-THRDPRTY              44270000
442800             WHERE                                                44280000
442900                    ORD_NBR          =  :PV-VE-PO-NBR             44290000
443000             AND    ORD_LNE_NBR      =  :PV-VE-LNE-NBR            44300000
443100             AND    REC_SEQ_NBR      =  :PV-VE-RCVR-NBR           44310000
443200             AND    OPER_UNT_ID      =  :PV-VE-OPER-UNT-ID        44320000
443300             AND    FCLTY_ID         =  :PV-VE-FCLTY-ID           44330000
443400             AND    VER_STATUS_CDE   =  :PC-A                     44340000
443500     END-EXEC.                                                    44350000
443600                                                                  44360000
443700     EVALUATE TRUE                                                44370000
443800         WHEN SQLCODE = +0                                        44380000
443900             CONTINUE                                             44390000
444000         WHEN SQLWARN0 NOT = SPACES                               44400000
444100         WHEN SQLCODE < +0                                        44410000
444200         WHEN SQLCODE > +0                                        44420000
444300                                                                  44430000
444400              SET  PS-ERROR-YES         TO TRUE                   44440000
444500                                                                  44450000
444600              MOVE SQLCODE              TO PV-DISP-SQLCODE        44460000
444700              DISPLAY  ' RCKUP075-8100-'                          44470000
444800                       ' SQL:'             PV-DISP-SQLCODE        44480000
444900                       ' PO:'              RC119-KOHLS-PO-NBR     44490000
445000                       ' STR:'             RC119-DEST-STORE-NBR   44500000
445100                       ' SSCC:'            RC119-SML-NBR-NUM      44510000
445200              DISPLAY  ' RCKUP075-8100-'                          44520000
445300                       ' SML:'             RC119-SML-NBR-NUM      44530000
445400                                                                  44540000
445500              MOVE PV-VE-PO-NBR        TO  PV-DISP-VE-PO-NBR      44550000
445600              MOVE PV-VE-RCVR-NBR      TO  PV-DISP-VE-RCVR-NBR    44560000
445700              DISPLAY ' RCKUP075 - 8100-'                         44570000
445800                      ' RCVR:'             PV-DISP-VE-PO-NBR      44580000
445900                      '-'                  PV-DISP-VE-RCVR-NBR    44590000
446000                                                                  44600000
446100             MOVE  PV-VE-PO-NBR         TO PV-DISP-VE-PO-NBR      44610000
446200             MOVE  PV-VE-RCVR-NBR       TO PV-DISP-VE-RCVR-NBR    44620000
446300             MOVE  PV-VE-OPER-UNT-ID    TO PV-DISP-VE-OPER-UNT    44630000
446400             MOVE  PV-VE-FCLTY-ID       TO PV-DISP-VE-FCLTY-ID    44640000
446500             MOVE  PV-VE-LNE-NBR        TO PV-DISP-VE-LINE-NBR    44650000
446600             DISPLAY  ' RCKUP075-8100-'                           44660000
446700                       ' VE RCVR:'         PV-DISP-VE-OPER-UNT    44670000
446800                       '-'                 PV-DISP-VE-FCLTY-ID    44680000
446900                       '-'                 PV-DISP-VE-PO-NBR      44690000
447000                       '-'                 PV-DISP-VE-RCVR-NBR    44700000
447100                       '-'                 PV-DISP-VE-LINE-NBR    44710000
447200                       '-'                 PV-VE-STATUS           44720000
447300                                                                  44730000
447400              DISPLAY '*****************************************' 44740000
447500              DISPLAY '*ABEND                                  *' 44750000
447600              DISPLAY '*PROGRAM   = RCKUP075                   *' 44760000
447700              DISPLAY '*DB2 OPER  = UPDATE TRECITM             *' 44770000
447800              DISPLAY '*PARAGRAPH = 8100-UPDATE-REC-ITEM-VE    *' 44780000
447900              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               44790000
448000              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            44800000
448100              DISPLAY '*****************************************' 44810000
448200              PERFORM 9100-SQL-ABEND                              44820000
448300     END-EVALUATE.                                                44830000
448400                                                                  44840000
448500                                                                  44850000
448600*----------------------------------------------------------------*44860000
448700*                                                                *44870000
448800*----------------------------------------------------------------*44880000
448900 8110-UPDATE-RECEIVER-VE.                                         44890000
449000     IF  PS-TEST-ONLY-DISPLAY-YES                                 44900000
449100         DISPLAY ' RCKUP075 -  8110-UPDATE-RECEIVER-VE'           44910000
449200     END-IF.                                                      44920000
449300                                                                  44930000
449400     MOVE  PV-VE-RCVR-CARTON-CNT  TO  RECEIV-EXPTED-CART-CNT      44940000
449500     MOVE  PV-VE-RCVR-CARTON-CNT  TO  RECEIV-ACTL-CART-CNT        44950000
449600                                                                  44960000
449700     EXEC SQL                                                     44970000
449800          UPDATE   TRECEIV                                        44980000
449900             SET   STATUS_CDE         = :PC-VE                    44990000
450000                  ,VERFYD_TMST        =  CURRENT TIMESTAMP        45000000
450100                  ,VRFD_USR_ID        = :PC-THRDPRTY              45010000
450200                  ,UPD_TMST           =  CURRENT TIMESTAMP        45020000
450300                  ,UPD_UID            = :PC-THRDPRTY              45030000
450400                  ,UPD_PGM_ID         = :PC-PROGRAM-NAME          45040000
450500                  ,EXPTED_CART_CNT    = :RECEIV-EXPTED-CART-CNT   45050000
450600                  ,ACTL_CART_CNT      = :RECEIV-ACTL-CART-CNT     45060000
450700             WHERE                                                45070000
450800                    ORD_NBR          =  :PV-VE-PO-NBR             45080000
450900             AND    REC_SEQ_NBR      =  :PV-VE-RCVR-NBR           45090000
451000             AND    OPER_UNT_ID      =  :PV-VE-OPER-UNT-ID        45100000
451100             AND    FCLTY_ID         =  :PV-VE-FCLTY-ID           45110000
451200             AND    VER_STATUS_CDE   =  :PC-A                     45120000
451300     END-EXEC.                                                    45130000
451400                                                                  45140000
451500     EVALUATE TRUE                                                45150000
451600         WHEN SQLCODE = +0                                        45160000
451700             CONTINUE                                             45170000
451701             MOVE  PV-VE-OPER-UNT-ID  TO PV-DISP-VE-OPER-UNT      45170122
451710             MOVE  PV-VE-PO-NBR       TO PV-DISP-VE-PO-NBR        45171022
451720             MOVE  PV-VE-RCVR-NBR     TO PV-DISP-VE-RCVR-NBR      45172022
451770             DISPLAY ' COMMIT AT'                                 45177023
451780                     ' VE RCVR:'         PV-DISP-VE-OPER-UNT      45178023
451790                     '-'                 PV-DISP-VE-PO-NBR        45179022
451791                     '-'                 PV-DISP-VE-RCVR-NBR      45179122
451792***                  '    RECORD#: ' RC119-VALID-FILE-RECORD-NBR  45179226
451793                     '    RECORD#: ' RC119-SORT-OUT-RECORD-NBR    45179326
451794                                                                  45179426
451800         WHEN SQLWARN0 NOT = SPACES                               45180000
451900         WHEN SQLCODE < +0                                        45190000
452000         WHEN SQLCODE > +0                                        45200000
452100                                                                  45210000
452200              SET  PS-ERROR-YES         TO TRUE                   45220000
452300                                                                  45230000
452400              MOVE SQLCODE              TO PV-DISP-SQLCODE        45240000
452500              DISPLAY  ' RCKUP075-8110-'                          45250000
452600                       ' SQL:'             PV-DISP-SQLCODE        45260000
452700                       ' PO:'              RC119-KOHLS-PO-NBR     45270000
452800                       ' STR:'             RC119-DEST-STORE-NBR   45280000
452900                       ' SSCC:'            RC119-SML-NBR-NUM      45290000
453000              DISPLAY  ' RCKUP075-8110-'                          45300000
453100                       ' SML:'             RC119-SML-NBR-NUM      45310000
453200                                                                  45320000
453300             MOVE  PV-VE-PO-NBR         TO PV-DISP-VE-PO-NBR      45330000
453400             MOVE  PV-VE-RCVR-NBR       TO PV-DISP-VE-RCVR-NBR    45340000
453500             MOVE  PV-VE-OPER-UNT-ID    TO PV-DISP-VE-OPER-UNT    45350000
453600             MOVE  PV-VE-FCLTY-ID       TO PV-DISP-VE-FCLTY-ID    45360000
453700             MOVE  PV-VE-LNE-NBR        TO PV-DISP-VE-LINE-NBR    45370000
453800             DISPLAY  ' RCKUP075-8110-'                           45380000
453900                       ' VE RCVR:'         PV-DISP-VE-OPER-UNT    45390000
454000                       '-'                 PV-DISP-VE-FCLTY-ID    45400000
454100                       '-'                 PV-DISP-VE-PO-NBR      45410000
454200                       '-'                 PV-DISP-VE-RCVR-NBR    45420000
454300                       '-'                 PV-DISP-VE-LINE-NBR    45430000
454400                                                                  45440000
454500              DISPLAY '*****************************************' 45450000
454600              DISPLAY '*ABEND                                  *' 45460000
454700              DISPLAY '*PROGRAM   = RCKUP075                   *' 45470000
454800              DISPLAY '*DB2 OPER  = UPDATE TRECEIV             *' 45480000
454900              DISPLAY '*PARAGRAPH = 8110-UPDATE-RECEIVER-VE    *' 45490000
455000              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               45500000
455100              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            45510000
455200              DISPLAY '*****************************************' 45520000
455300              PERFORM 9100-SQL-ABEND                              45530000
455400     END-EVALUATE.                                                45540000
455500                                                                  45550000
455600                                                                  45560000
455700*----------------------------------------------------------------*45570000
455800*                                                                *45580000
455900*----------------------------------------------------------------*45590000
456000 8120-INSERT-VRFD-ODD-UNT.                                        45600000
456100      MOVE PV-VE-PO-NBR            TO  RCT00009-PO-NBR.           45610000
456200      MOVE PV-VE-LNE-NBR           TO  RCT00009-PO-LNE-NBR.       45620000
456300      MOVE PV-VE-RCVR-NBR          TO  RCT00009-RCVR-SEQ-NBR.     45630000
456400      MOVE PV-VE-OPER-UNT-ID       TO  RCT00009-STR-NBR.          45640000
456500      MOVE PV-VE-PREPK-ODD-UNT-QTY TO  RCT00009-DC-VRFY-ODU-QTY   45650000
456600                                       RCT00009-AP-VRFY-ODU-QTY.  45660000
456700                                                                  45670000
456800     IF  PS-TEST-ONLY-DISPLAY-YES                                 45680000
456900         DISPLAY ' RCKUP075 - 8120-INSERT-VRFD-ODD-UNT'           45690000
457000         MOVE RCT00009-PO-NBR       TO PV-DISP-RECITM-ORD-NBR     45700000
457100         MOVE RCT00009-PO-LNE-NBR   TO PV-DISP-RECITM-ORD-LNE-NBR 45710000
457200         MOVE RCT00009-RCVR-SEQ-NBR TO PV-DISP-RECITM-REC-SEQ-NBR 45720000
457300         MOVE RCT00009-STR-NBR      TO PV-DISP-RECITM-OPER-UNT-ID 45730000
457400         DISPLAY ' RCKUP075 - 8120-'                              45740000
457500                                    PV-DISP-RECITM-ORD-NBR        45750000
457600                 '-'                PV-DISP-RECITM-REC-SEQ-NBR    45760000
457700                 '-'                PV-DISP-RECITM-ORD-LNE-NBR    45770000
457800                 '-'                PV-DISP-RECITM-OPER-UNT-ID    45780000
457900     END-IF.                                                      45790000
458000                                                                  45800000
458100     EXEC SQL                                                     45810000
458200          INSERT INTO RCT_VRFD_ODD_UNT                            45820000
458300                 ( PO_NBR                                         45830000
458400                  ,PO_LNE_NBR                                     45840000
458500                  ,RCVR_SEQ_NBR                                   45850000
458600                  ,STR_NBR                                        45860000
458700                  ,DC_VRFY_ODU_QTY                                45870000
458800                  ,AP_VRFY_ODU_QTY                                45880000
458900                 )                                                45890000
459000         VALUES  (                                                45900000
459100                   :RCT00009-PO-NBR                               45910000
459200                  ,:RCT00009-PO-LNE-NBR                           45920000
459300                  ,:RCT00009-RCVR-SEQ-NBR                         45930000
459400                  ,:RCT00009-STR-NBR                              45940000
459500                  ,:RCT00009-DC-VRFY-ODU-QTY                      45950000
459600                  ,:RCT00009-AP-VRFY-ODU-QTY                      45960000
459700                 )                                                45970000
459800         END-EXEC                                                 45980000
459900                                                                  45990000
460000         EVALUATE TRUE                                            46000000
460100             WHEN SQLCODE = +0                                    46010000
460200                 CONTINUE                                         46020000
460300                                                                  46030000
460400             WHEN SQLWARN0 NOT = SPACE                            46040000
460500             WHEN SQLCODE < +0                                    46050000
460600             WHEN SQLCODE > +0                                    46060000
460700                                                                  46070000
460800              SET  PS-ERROR-YES         TO TRUE                   46080000
460900                                                                  46090000
461000              MOVE SQLCODE              TO PV-DISP-SQLCODE        46100000
461100              DISPLAY  ' RCKUP075-8120-'                          46110000
461200                       ' SQL:'             PV-DISP-SQLCODE        46120000
461300                       ' PO:'              RC119-KOHLS-PO-NBR     46130000
461400                       ' STR:'             RC119-DEST-STORE-NBR   46140000
461500                       ' SSCC:'            RC119-SML-NBR-NUM      46150000
461600              DISPLAY  ' RCKUP075-8120-'                          46160000
461700                       ' SML:'             RC119-SML-NBR-NUM      46170000
461800                                                                  46180000
461900              MOVE RCT00009-PO-NBR                                46190000
462000                                    TO PV-DISP-RECITM-ORD-NBR     46200000
462100              MOVE RCT00009-PO-LNE-NBR                            46210000
462200                                    TO PV-DISP-RECITM-ORD-LNE-NBR 46220000
462300              MOVE RCT00009-RCVR-SEQ-NBR                          46230000
462400                                    TO PV-DISP-RECITM-REC-SEQ-NBR 46240000
462500              MOVE RCT00009-STR-NBR                               46250000
462600                                    TO PV-DISP-RECITM-OPER-UNT-ID 46260000
462700              DISPLAY ' RCKUP075 - 8120-'                         46270000
462800                                    PV-DISP-RECITM-ORD-NBR        46280000
462900                 '-'                PV-DISP-RECITM-REC-SEQ-NBR    46290000
463000                 '-'                PV-DISP-RECITM-ORD-LNE-NBR    46300000
463100                 '-'                PV-DISP-RECITM-OPER-UNT-ID    46310000
463200                                                                  46320000
463300                                                                  46330000
463400              DISPLAY '*****************************************' 46340000
463500              DISPLAY '*ABEND                                  *' 46350000
463600              DISPLAY '*PROGRAM   = RCKUP075                   *' 46360000
463700              DISPLAY '*DB2 OPER  = INSERT NEW TRECITM         *' 46370000
463800              DISPLAY '*PARAGRAPH = 8120-INSERT-VRFD-ODD-UNT   *' 46380000
463900              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               46390000
464000              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            46400000
464100              DISPLAY '*****************************************' 46410000
464200              PERFORM 9100-SQL-ABEND                              46420000
464300     END-EVALUATE.                                                46430000
464400                                                                  46440000
464500                                                                  46450000
464510******************************************************************46451003
464520* DB2 COMMIT                                                      46452003
464530******************************************************************46453003
464540 8200-COMMIT-DB2.                                                 46454003
464541                                                                  46454103
464542     IF  PS-TEST-ONLY-DISPLAY-YES                                 46454203
464543         DISPLAY ' RCKUP075 -  8200-COMMIT-DB2    '               46454303
464544         DISPLAY ' '                                              46454403
464545     END-IF.                                                      46454503
464546                                                                  46454603
464560     EXEC SQL                                                     46456003
464570        COMMIT                                                    46457003
464580     END-EXEC.                                                    46458003
464590                                                                  46459003
464591     EVALUATE SQLCODE                                             46459103
464592         WHEN ZERO                                                46459203
464593             ADD +1 TO PV-COMMIT-COUNT                            46459303
464594         WHEN OTHER                                               46459403
464599              DISPLAY '*****************************************' 46459911
464600              DISPLAY '*ABEND                                  *' 46460011
464601              DISPLAY '*PROGRAM   = RCKUP075                   *' 46460111
464602              DISPLAY '*DB2 OPER  = COMMIT                     *' 46460211
464603              DISPLAY '*PARAGRAPH = 8200-COMMIT-DB2            *' 46460311
464604              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               46460411
464605              DISPLAY '*PO = '      RC119-KOHLS-PO-NBR            46460511
464606              DISPLAY '*****************************************' 46460611
464607              PERFORM 9100-SQL-ABEND                              46460711
464608     END-EVALUATE.                                                46460803
464609                                                                  46460903
464610                                                                  46461003
464620*----------------------------------------------------------------*46462000
464700*                                                                *46470000
464800*----------------------------------------------------------------*46480000
464900 9000-DISPLAY-TOTALS.                                             46490000
465000     IF  PS-TEST-ONLY-DISPLAY-YES                                 46500000
465100         DISPLAY ' RCKUP075 -  9000-DISPLAY-TOTALS'               46510000
465200     END-IF.                                                      46520000
465300                                                                  46530000
465400     MOVE PV-BYPASS-COUNT              TO  PV-DISP-COUNT.         46540023
465500     DISPLAY ' '.                                                 46550002
465510     DISPLAY '******************************'.                    46551002
465600     DISPLAY '*'.                                                 46560022
465700     DISPLAY '* START AT RECORD #:      ' PV-DISP-COUNT.          46570024
465800                                                                  46580000
465810     MOVE PV-INPUT-COUNT              TO  PV-DISP-COUNT.          46581023
465830     DISPLAY '*'.                                                 46583022
465840     DISPLAY '* PROCESSED RECORD COUNT: ' PV-DISP-COUNT.          46584023
465850                                                                  46585002
465900     MOVE PV-RCRD119-COUNT            TO  PV-DISP-COUNT.          46590023
466000     DISPLAY '*'.                                                 46600022
466100     DISPLAY '* OUTPUT RCRD119:         ' PV-DISP-COUNT.          46610023
466200                                                                  46620000
466210     MOVE PV-RCRD095-COUNT            TO  PV-DISP-COUNT.          46621023
466220     DISPLAY '*'.                                                 46622022
466230     DISPLAY '* OUTPUT RCRD095:         ' PV-DISP-COUNT.          46623023
466240                                                                  46624017
466300     MOVE PV-COMMIT-COUNT             TO  PV-DISP-COUNT.          46630023
466400     DISPLAY '*'.                                                 46640022
466500     DISPLAY '* COMMIT COUNT:           ' PV-DISP-COUNT.          46650023
466600                                                                  46660000
466610     MOVE PV-TOT-RC119-FILE-QTY       TO  PV-DISP-COUNT.          46661023
466620     DISPLAY '*'.                                                 46662022
466630     DISPLAY '* UNITS IN FILE:          ' PV-DISP-COUNT.          46663023
466640                                                                  46664018
466650     MOVE PV-TOT-RC119-PRCD-QTY       TO  PV-DISP-COUNT.          46665023
466660     DISPLAY '*'.                                                 46666022
466670     DISPLAY '* UNITS PROCESSED:        ' PV-DISP-COUNT.          46667023
466680                                                                  46668018
466691     DISPLAY '*'.                                                 46669122
466692     DISPLAY '* NOTE: UNITS IN FILE & UNITS PROCESSED WILL '.     46669218
466693     DISPLAY '*       BE DIFFERENT FOR A RESTART IF PROCESSING'.  46669318
466694     DISPLAY '*       IS NOT RESTARTING AT RECORD 1'.             46669418
466695                                                                  46669518
466700     DISPLAY '*'.                                                 46670022
466810     DISPLAY '******************************'.                    46681022
466820     DISPLAY '*                            *'.                    46682022
466830     DISPLAY '* RCKUP075 - END             *'.                    46683022
466840     DISPLAY '*                            *'.                    46684022
466850     DISPLAY '******************************'.                    46685022
466900                                                                  46690000
467000                                                                  46700000
467100*----------------------------------------------------------------*46710000
467200*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    46720000
467300*  ERROR OR WARNING CODE OCCURS.                                  46730000
467400*----------------------------------------------------------------*46740000
467500 9100-SQL-ABEND.                                                  46750000
467600     IF  PS-TEST-ONLY-DISPLAY-YES                                 46760000
467700         DISPLAY ' RCKUP075 -  9100-SQL-ABEND'                    46770000
467800     END-IF.                                                      46780000
467810                                                                  46781004
467900     DISPLAY '9100-SQL-ABEND'.                                    46790000
468000     DISPLAY '** ABEND     **'.                                   46800000
468100     DISPLAY '** PROGRAM   ** '     PC-PROGRAM-NAME.              46810000
468200     DISPLAY '**           ** '.                                  46820000
468300     MOVE SQLCODE                TO PV-DISP-SQLCODE               46830000
468400     DISPLAY '** SQL CODE  **  '    PV-DISP-SQLCODE               46840000
468410                                                                  46841004
468500******************************************************************46850000
468600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    46860000
468700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         46870000
468800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     46880000
468900* FORMAT.                                                         46890000
469000******************************************************************46900000
469100     COPY DPPD004.                                                46910000
469200                                                                  46920000
469300     MOVE +4013 TO ABEND-CODE.                                    46930000
469400     CALL 'ILBOABN0' USING ABEND-CODE.                            46940000
469500                                                                  46950000
