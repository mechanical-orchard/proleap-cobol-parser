       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.             MLKUT224.                                        
       AUTHOR.                 INFOSYS.                                         
       INSTALLATION.           KOHLS.                                           
       DATE-WRITTEN.           10-14-08.                                        
       DATE-COMPILED.                                                           
      *                                                                         
      ******************************************************************        
      *   REDISTRIBUTE UNKNOWN VENDOR AND UNKNOWN BRAND                *        
      ******************************************************************        
      * THIS PROGRAM PRORATES THE AMOUNTS OF UNKNOWN VENDOR AND UNKNOWN*        
      * BRAND AMONG KNOWN B/V COMBINATIONS RECEIVED WITHIN THE DEPT FOR*        
      * THAT WEEK.REMAINING INDIVIDUAL UNKNOWN AMOUNT WILL BE PRORATED *        
      * TO THE LARGEST KNOWN B/V AMOUNT.                               *        
      * THE PRORATED UNKNOWN RECORD WILL BE WRITTEN TO A REVERSAL FILE *        
      * WITH THE PRORATED AMOUNTS REVERSED. ANY UNKNOWN RECORDS NOT    *        
      * PRORATED OR ANY AMOUNT FIELDS NOT PRORATED WILL BE WRITTEN OUT *        
      * TO A NON-PRORATED FILE.                                        *        
      *                                                                *        
      * WR/PROJ DATE       PROGAMMER    DESCRIPTION OF CHANGES         *        
      * ------- ---------- ------------ -------------------------------*        
      * W34517  10-14-2008 INFOSYS      NEW PROGRAM                    *        
W37965* W37965  06-09-2010 SURENDAR B   BRAND VENDOR TRANSACTION AND   *        
W37965*                                 EXCEPTION MANAGEMENT           *        
W37965*                                 PROGRAM CHANGED TO WRITE DETAIL*        
W37965*                                 AUDIT FILE FOR PURCHASE        *        
W37965*                                 ADJUSTMENTS, SALES AND PRICE   *        
W37965*                                 CHANGES.                       *        
W37965*******************************************************************       
      *                                                                         
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
      *                                                                         
           SELECT KNOWN-FILE                 ASSIGN TO INP01.                   
           SELECT UNKNOWN-FILE               ASSIGN TO INP02.                   
           SELECT CNTL-JOB-FILE              ASSIGN TO INP03.                   
           SELECT CNTL-DATE-FILE             ASSIGN TO INP04.                   
           SELECT PRORATE-FILE               ASSIGN TO OUT01.                   
           SELECT NON-PRORATE-FILE           ASSIGN TO OUT02.                   
           SELECT REVERSAL-FILE              ASSIGN TO OUT03.                   
W37965     SELECT DTL-AUDIT-FILE             ASSIGN TO OUT04.                   
           SELECT PRORATE-RPT-FILE           ASSIGN TO RPT01.                   
      *                                                                         
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *                                                                         
       FD  KNOWN-FILE                                                           
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 450 CHARACTERS                                       
           DATA RECORD IS KWN-REC.                                              
       01  KNOWN-REC                  PIC X(450).                               
      *                                                                         
       FD  UNKNOWN-FILE                                                         
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 450 CHARACTERS                                       
           DATA RECORD IS UNKWN-REC.                                            
       01  UNKNOWN-REC                PIC X(450).                               
      *                                                                         
       FD  CNTL-DATE-FILE                                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CNTL-DATE-REC.                                                       
           05  FILLER                  PIC X(03).                               
           05  CC-PROC-DATE-ISO        PIC X(10).                               
           05  CC-PROC-DATE-RDF  REDEFINES                                      
               CC-PROC-DATE-ISO.                                                
               10  CC-PROC-DATE-CC     PIC X(02).                               
               10  CC-PROC-DATE-YY     PIC X(02).                               
               10  FILLER              PIC X(01).                               
               10  CC-PROC-DATE-MM     PIC X(02).                               
               10  FILLER              PIC X(01).                               
               10  CC-PROC-DATE-DD     PIC X(02).                               
           05  FILLER                  PIC X(67).                               
      *                                                                         
       FD  PRORATE-FILE                                                         
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 450 CHARACTERS                                       
           DATA RECORD IS OUT-REC.                                              
       01  PRORATE-REC                PIC X(450).                               
      *                                                                         
       FD  NON-PRORATE-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 450 CHARACTERS                                       
           DATA RECORD IS OUT-REC.                                              
       01  NON-PRORATE-REC            PIC X(450).                               
      *                                                                         
       FD  REVERSAL-FILE                                                        
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 450 CHARACTERS                                       
           DATA RECORD IS REVRSD-UNKWN-REC.                                     
       01  REVERSAL-REC               PIC X(450).                               
      *                                                                         
       FD  PRORATE-RPT-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 350 CHARACTERS                                       
           DATA RECORD IS PRORATE-RPT-RECORD.                                   
       01  PRORATE-RPT-RECORD         PIC X(350).                               
      *                                                                         
       FD  CNTL-JOB-FILE                                                        
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CNTL-JOB-REC.                                                        
           05  CC-JOB-NAME             PIC X(06) VALUE SPACES.                  
               88  CC-JOB-MLK321                 VALUE 'MLK321'.                
               88  CC-JOB-MLK322                 VALUE 'MLK322'.                
               88  CC-JOB-MLK323                 VALUE 'MLK323'.                
           05  FILLER                  PIC X(74).                               
                                                                                
W37965 FD  DTL-AUDIT-FILE                                                       
W37965     RECORDING MODE IS F                                                  
W37965     LABEL RECORDS ARE STANDARD                                           
W37965     BLOCK CONTAINS 0 RECORDS                                             
W37965     RECORD CONTAINS 200 CHARACTERS                                       
W37965     DATA RECORD IS DTL-AUDIT-REC.                                        
W37965 01  DTL-AUDIT-REC              PIC X(200).                               
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
      *                                                                         
      ******************************************************************        
      *   DBV TABLE LAYOUT.                                                     
      ******************************************************************        
      *                                                                         
       01  PT-DBV-SUM-TABLE.                                                    
           05 PT-DBV-SUM-TBL-ELE OCCURS 20000 TIMES.                            
              10 DBV-DEPT-NBR           PIC  S9(4)V COMP-3                      
                                               VALUE ZEROES.                    
              10 DBV-ENT-ID             PIC  S9(9) COMP                         
                                               VALUE ZEROES.                    
              10 DBV-LBL-SEQ-NBR        PIC  S9(9) COMP                         
                                               VALUE ZEROES.                    
              10 DBV-ML-LWST-ID         PIC  S9(9) COMP                         
                                               VALUE ZEROES.                    
              10 DBV-SLS-REG-RTL-AMT    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-REG-RTL-PCT    PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-SLS-REG-RTL-UNK    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-PROMO-RTL-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-PROMO-RTL-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-SLS-PROMO-RTL-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-PROCLR-RTL-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-PROCLR-RTL-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-SLS-PROCLR-RTL-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-CLR-RTL-AMT    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-CLR-RTL-PCT    PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-SLS-CLR-RTL-UNK    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-OTH-RTL-AMT    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-SLS-OTH-RTL-PCT    PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-SLS-OTH-RTL-UNK    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PLU-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PLU-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PLU-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PROMO-RTL-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PROMO-RTL-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PROMO-RTL-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-RGST-RTL-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-RGST-RTL-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-RGST-RTL-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-GLDST-RTL-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-GLDST-RTL-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-GLDST-RTL-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-UMTCH-RTL-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-UMTCH-RTL-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-UMTCH-RTL-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-BYR-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-BYR-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-BYR-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-STR-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-STR-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-STR-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PRPT-RTL-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PRPT-RTL-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-PRPT-RTL-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-OTH-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-OTH-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-OTH-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-RTL-AMT       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKDN-RTL-PCT       PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKDN-RTL-UNK       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKUP-RTL-AMT       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKUP-RTL-PCT       PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKUP-RTL-UNK       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-XFER-IN-RTL-AMT    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-XFER-IN-RTL-PCT    PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-XFER-IN-RTL-UNK    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-XFER-OUT-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-XFER-OUT-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-XFER-OUT-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-RTL-AMT       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-RTL-PCT       PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-RCPT-RTL-UNK       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-NET-COST-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-NET-COST-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-RCPT-NET-COST-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-GRO-COST-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-GRO-COST-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-RCPT-GRO-COST-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-FRGT-COST-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RCPT-FRGT-COST-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-RCPT-FRGT-COST-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTL-AMT       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTL-PCT       PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTL-UNK       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-FRGT-COST-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-FRGT-COST-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-FRGT-COST-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DISC-COST-AMT PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DISC-COST-PCT PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DISC-COST-UNK PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTV-COST-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTV-COST-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTV-COST-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTV-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTV-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-RTV-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DA-COST-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DA-COST-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DA-COST-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DA-RTL-AMT    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DA-RTL-PCT    PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-DA-RTL-UNK    PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-NET-COST-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-NET-COST-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-NET-COST-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-OTH-COST-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-OTH-COST-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-OTH-COST-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-OTH-RTL-AMT   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-OTH-RTL-PCT   PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-OTH-RTL-UNK   PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-GRO-COST-AMT  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-PADJ-GRO-COST-PCT  PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-PADJ-GRO-COST-UNK  PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-DR-ALW-RTL-AMT     PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-DR-ALW-RTL-PCT     PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-DR-ALW-RTL-UNK     PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RTV-RTL-AMT        PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-RTV-RTL-PCT        PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-RTV-RTL-UNK        PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKUP-INIT-AMT      PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKUP-INIT-PCT      PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKUP-INIT-UNK      PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKUP-NET-AMT       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
              10 DBV-MKUP-NET-PCT       PIC  9(03)V9(07)                        
                                               VALUE ZEROES.                    
              10 DBV-MKUP-NET-UNK       PIC  S9(11)V9(2) COMP-3                 
                                               VALUE ZEROES.                    
      *                                                                         
      ******************************************************************        
      *    VARIABLES ARE DECLARED HERE                                          
      ******************************************************************        
      *                                                                         
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PARAGRAPH-NAME          PIC  X(30) VALUE SPACES.              
           05  PA-COUNT-UNKNOWN-RECS      PIC  9(05) VALUE ZEROES.              
           05  PA-COUNT-REVERSAL-RECS     PIC  9(05) VALUE ZEROES.              
           05  PA-COUNT-PRORATE-RECS      PIC  9(05) VALUE ZEROES.              
           05  PA-COUNT-NON-PRORATE-RECS  PIC  9(05) VALUE ZEROES.              
W37965     05  PA-PRORATE-AUDIT-WRITTEN   PIC  9(05) VALUE ZEROES.              
W37965     05  PA-REVERSAL-AUDIT-WRITTEN  PIC  9(05) VALUE ZEROES.              
W37965     05  PA-SKU-NBR                 PIC  9(08) VALUE ZEROES.              
W37965     05  PV-WORK-AMOUNT             PIC  9(07)V99 COMP-3                  
W37965                                               VALUE ZEROES.              
           05  PA-COUNT-NON-PROR-REC-SPL-CASE                                   
                                          PIC  9(05) VALUE ZEROES.              
           05  HOLD-UNKWN-DEPT-NBR        PIC S9(4)V COMP-3                     
                                                     VALUE ZEROES.              
           05  PV-MISC-VARIABLES.                                               
               10  PV-INDX                    PIC  9(05) VALUE ZEROES.          
               10  PV-MAX-INDX                PIC  9(05) VALUE ZEROES.          
               10  BIG-SLS-REG-RTL-AMT-IDX    PIC  9(05) VALUE ZEROES.          
               10  BIG-SLS-PROMO-RTL-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-SLS-PROCLR-RTL-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-SLS-CLR-RTL-AMT-IDX    PIC  9(05) VALUE ZEROES.          
               10  BIG-SLS-OTH-RTL-AMT-IDX    PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-PLU-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-PROMO-RTL-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-RGST-RTL-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-GLDST-RTL-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-UMTCH-RTL-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-BYR-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-STR-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-PRPT-RTL-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-OTH-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-MKDN-RTL-AMT-IDX       PIC  9(05) VALUE ZEROES.          
               10  BIG-MKUP-RTL-AMT-IDX       PIC  9(05) VALUE ZEROES.          
               10  BIG-XFER-IN-RTL-AMT-IDX    PIC  9(05) VALUE ZEROES.          
               10  BIG-XFER-OUT-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-RCPT-RTL-AMT-IDX       PIC  9(05) VALUE ZEROES.          
               10  BIG-RCPT-NET-COST-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-RCPT-GRO-COST-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-RCPT-FRGT-COST-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-RTL-AMT-IDX       PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-FRGT-COST-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-DISC-COST-AMT-IDX PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-RTV-COST-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-RTV-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-DA-COST-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-DA-RTL-AMT-IDX    PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-NET-COST-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-OTH-COST-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-OTH-RTL-AMT-IDX   PIC  9(05) VALUE ZEROES.          
               10  BIG-PADJ-GRO-COST-AMT-IDX  PIC  9(05) VALUE ZEROES.          
               10  BIG-DR-ALW-RTL-AMT-IDX     PIC  9(05) VALUE ZEROES.          
               10  BIG-RTV-RTL-AMT-IDX        PIC  9(05) VALUE ZEROES.          
               10  BIG-MKUP-INIT-AMT-IDX      PIC  9(05) VALUE ZEROES.          
               10  BIG-MKUP-NET-AMT-IDX       PIC  9(05) VALUE ZEROES.          
      *                                                                         
           05  PV-CUM-UNKWN-MONEY-HOLDERS.                                      
               10 CUM-SLS-REG-RTL-UNK    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-PROMO-RTL-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-PROCLR-RTL-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-CLR-RTL-UNK    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-OTH-RTL-UNK    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PLU-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PROMO-RTL-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-RGST-RTL-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-GLDST-RTL-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-UMTCH-RTL-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-BYR-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-STR-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PRPT-RTL-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-OTH-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-RTL-UNK       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKUP-RTL-UNK       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-XFER-IN-RTL-UNK    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-XFER-OUT-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-RTL-UNK       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-NET-COST-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-GRO-COST-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-FRGT-COST-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTL-UNK       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-FRGT-COST-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DISC-COST-UNK PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTV-COST-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTV-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DA-COST-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DA-RTL-UNK    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-NET-COST-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-OTH-COST-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-OTH-RTL-UNK   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-GRO-COST-UNK  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-DR-ALW-RTL-UNK     PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RTV-RTL-UNK        PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKUP-INIT-UNK      PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKUP-NET-UNK       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
      *                                                                         
           05  PV-CUMULATIVE-VARIABLES.                                         
               10 CUM-SLS-REG-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-REG-RTL-PCT    PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 BIG-SLS-REG-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-PROMO-RTL-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-PROMO-RTL-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 BIG-SLS-PROMO-RTL-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-PROCLR-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-PROCLR-RTL-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 BIG-SLS-PROCLR-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-CLR-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-OTH-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PLU-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PROMO-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-RGST-RTL-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-GLDST-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-UMTCH-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-BYR-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-STR-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PRPT-RTL-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-OTH-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKDN-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKUP-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-XFER-IN-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-XFER-OUT-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-NET-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-GRO-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RCPT-FRGT-COST-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-FRGT-COST-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DISC-COST-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTV-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTV-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DA-COST-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DA-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-NET-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-OTH-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-OTH-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-PADJ-GRO-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-DR-ALW-RTL-AMT     PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-RTV-RTL-AMT        PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKUP-INIT-AMT      PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-MKUP-NET-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 CUM-SLS-CLR-RTL-PCT    PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-SLS-OTH-RTL-PCT    PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PLU-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PROMO-RTL-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-RGST-RTL-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-GLDST-RTL-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-UMTCH-RTL-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-BYR-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-STR-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-PRPT-RTL-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-OTH-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKDN-RTL-PCT       PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKUP-RTL-PCT       PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-XFER-IN-RTL-PCT    PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-XFER-OUT-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-RCPT-RTL-PCT       PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-RCPT-NET-COST-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-RCPT-GRO-COST-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-RCPT-FRGT-COST-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTL-PCT       PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-FRGT-COST-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DISC-COST-PCT PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTV-COST-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-RTV-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DA-COST-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-DA-RTL-PCT    PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-NET-COST-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-OTH-COST-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-OTH-RTL-PCT   PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-PADJ-GRO-COST-PCT  PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-DR-ALW-RTL-PCT     PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-RTV-RTL-PCT        PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKUP-INIT-PCT      PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 CUM-MKUP-NET-PCT       PIC  9(03)V9(07)                       
                                                    VALUE ZEROES.               
               10 BIG-SLS-CLR-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-SLS-OTH-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-PLU-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-PROMO-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-RGST-RTL-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-GLDST-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-UMTCH-RTL-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-BYR-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-STR-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-PRPT-RTL-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-OTH-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKDN-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKUP-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-XFER-IN-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-XFER-OUT-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-RCPT-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-RCPT-NET-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-RCPT-GRO-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-RCPT-FRGT-COST-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-RTL-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-FRGT-COST-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-DISC-COST-AMT PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-RTV-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-RTV-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-DA-COST-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-DA-RTL-AMT    PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-NET-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-OTH-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-OTH-RTL-AMT   PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-PADJ-GRO-COST-AMT  PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-DR-ALW-RTL-AMT     PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-RTV-RTL-AMT        PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKUP-INIT-AMT      PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
               10 BIG-MKUP-NET-AMT       PIC  S9(13)V9(2) COMP-3                
                                                    VALUE ZEROES.               
      *                                                                         
       01  PV-PROGRAM-REPT-VARS.                                                
                                                                                
           05 PV-LINE-COUNTER          PIC S9(15) COMP-3 VALUE 76.              
           05 PV-PAGE-COUNTER          PIC S9(05) COMP-3 VALUE ZEROS.           
           05 PV-REPORT-SELECTION      PIC X(06)  VALUE SPACES.                 
                                                                                
           05  PV-FISC-DATE-ISO.                                                
               10  PV-FISC-DATE-MM     PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  PV-FISC-DATE-DD     PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  PV-FISC-DATE-CC     PIC X(02) VALUE SPACES.                  
               10  PV-FISC-DATE-YY     PIC X(02) VALUE SPACES.                  
                                                                                
           05 PV-SLS-REG-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROMO-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROCLR-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-CLR-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-OTH-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-MKDN-PLU-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PROMO-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-RGST-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-GLDST-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-UMTCH-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-BYR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-STR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PRPT-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-INIT-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-NET-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-XFER-IN-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-XFER-OUT-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DISC-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTV-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTV-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-COST-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-DR-ALW-RTL-AMT        PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RTV-RTL-AMT           PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-SLS-REG-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROCLR-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-SLS-CLR-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-OTH-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-MKDN-PLU-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-MKDN-RGST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-GLDST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-MKDN-UMTCH-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-MKDN-BYR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-STR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PRPT-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-INIT-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-NET-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-XFER-IN-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-XFER-OUT-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-PADJ-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-PADJ-DISC-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-PADJ-RTV-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTV-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-COST-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-DR-ALW-RTL-AMT-PRO    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RTV-RTL-AMT-PRO       PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-SLS-REG-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROMO-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROCLR-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-CLR-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-OTH-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-MKDN-PLU-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PROMO-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-RGST-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-GLDST-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-UMTCH-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-BYR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-STR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PRPT-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-INIT-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-NET-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-XFER-IN-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-XFER-OUT-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DISC-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTV-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTV-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-COST-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-DR-ALW-RTL-AMT        PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RTV-RTL-AMT           PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-SLS-REG-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROCLR-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-SLS-CLR-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-OTH-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-MKDN-PLU-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-MKDN-RGST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-GLDST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-MKDN-UMTCH-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-MKDN-BYR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-STR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PRPT-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-INIT-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-NET-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-XFER-IN-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-XFER-OUT-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-PADJ-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-PADJ-DISC-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-PADJ-RTV-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTV-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-COST-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-DR-ALW-RTL-AMT-PRO    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RTV-RTL-AMT-PRO       PIC S9(13)V99 COMP-3 VALUE ZERO.         
      *                                                                         
      ******************************************************************        
      *    CONSTANTS ARE DECLARED HERE                                          
      ******************************************************************        
      *                                                                         
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'MLKUT224'.            
           05  PC-MAX-INDX             PIC S9(05)  VALUE +20000.                
           05  PC-MAX-LINES            PIC 9(02)   VALUE 70.                    
                                                                                
           05  PC-REPORT-SELECTION-PURCHASE  PIC X(06) VALUE 'MLK321'.          
           05  PC-REPORT-SELECTION-SALES     PIC X(06) VALUE 'MLK322'.          
           05  PC-REPORT-SELECTION-PRICE-CHG PIC X(06) VALUE 'MLK323'.          
      *                                                                         
       01  ABEND-CODE                  PIC S9(04) VALUE ZEROES                  
                                                    COMP SYNC.                  
      *                                                                         
      ******************************************************************        
      *    PROGRAM SWITCHES ARE DECLARED HERE                                   
      ******************************************************************        
      *                                                                         
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-KNOWN-FILE-EOF-SW           PIC X(01)  VALUE 'N'.             
               88  PS-KNOWN-FILE-EOF-NO                  VALUE 'N'.             
               88  PS-KNOWN-FILE-EOF-YES                 VALUE 'Y'.             
           05  PS-UNKNOWN-FILE-EOF-SW         PIC X(01)  VALUE 'N'.             
               88  PS-UNKNOWN-FILE-EOF-NO                VALUE 'N'.             
               88  PS-UNKNOWN-FILE-EOF-YES               VALUE 'Y'.             
           05  PS-ALL-MONEY-AMT-ZERO-SW       PIC X(01)  VALUE 'N'.             
               88  PS-ALL-MONEY-AMT-ZERO-YES             VALUE 'Y'.             
               88  PS-ALL-MONEY-AMT-ZERO-NO              VALUE 'N'.             
           05  PS-NEED-TO-WRT-NONPROR-REC-SW  PIC X(01)  VALUE 'N'.             
               88  PS-NEED-TO-WRT-NONPROR-REC-YES        VALUE 'Y'.             
               88  PS-NEED-TO-WRT-NONPROR-REC-NO         VALUE 'N'.             
           05  PS-CNTL-JOB-EOF-SW          PIC X(01)     VALUE 'N'.             
               88  PS-CNTL-JOB-EOF-YES                   VALUE 'Y'.             
               88  PS-CNTL-JOB-EOF-NO                    VALUE 'N'.             
           05  PS-CNTL-DATE-EOF-SW         PIC X(01)     VALUE 'N'.             
               88  PS-CNTL-DATE-EOF-YES                  VALUE 'Y'.             
               88  PS-CNTL-DATE-EOF-NO                   VALUE 'N'.             
      *                                                                         
      *****************************************************************         
      * COPYBOOKS ARE DECLARED HERE                                             
      *****************************************************************         
           COPY MLRD225.                                                        
      *                                                                         
W37965*****************************************************************         
W37965* DETAIL AUDIT RECORD LAYOUT                                              
W37965*****************************************************************         
W37965     COPY MLRD090.                                                        
W37965*                                                                         
      ******************************************************************        
      *  DETAILED MERCH LEDGER UPDATE TRANSACTION                      *        
      ******************************************************************        
      *                                                                         
           COPY MLRD254.                                                        
           COPY MLRD254 REPLACING ML254 BY UNKWN.                               
           COPY MLRD254 REPLACING ML254 BY KNOWN.                               
           COPY MLRD254 REPLACING ML254 BY PRORT.                               
           COPY MLRD254 REPLACING ML254 BY NOPRT.                               
           COPY MLRD254 REPLACING ML254 BY REVRS.                               
           COPY MLRD254 REPLACING ML254 BY REPRT.                               
      *                                                                         
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-MAIN-PROCESS                                            
             UNTIL PS-UNKNOWN-FILE-EOF-YES                                      
                                                                                
           PERFORM 9000-END-OF-JOB.                                             
                                                                                
           STOP RUN.                                                            
                                                                                
      ******************************************************************        
      * OPEN FILES. READ UNKNOWN FILE ONCE.READ KNOWN FILE ONCE.EITHER          
      * OF THEM EMPTY, NO PRORATION PERFORMED.                                  
      ******************************************************************        
       1000-INITIALIZE.                                                         
                                                                                
           OPEN INPUT  KNOWN-FILE                                               
                       UNKNOWN-FILE                                             
                       CNTL-JOB-FILE                                            
                       CNTL-DATE-FILE.                                          
           OPEN OUTPUT PRORATE-FILE                                             
                       NON-PRORATE-FILE                                         
                       REVERSAL-FILE                                            
                       PRORATE-RPT-FILE                                         
W37965                 DTL-AUDIT-FILE.                                          
                                                                                
           SET PS-KNOWN-FILE-EOF-NO    TO TRUE.                                 
           SET PS-UNKNOWN-FILE-EOF-NO  TO TRUE.                                 
           SET PS-CNTL-DATE-EOF-NO     TO TRUE.                                 
           SET PS-CNTL-JOB-EOF-NO      TO TRUE.                                 
                                                                                
           INITIALIZE PA-COUNT-UNKNOWN-RECS                                     
                      PA-COUNT-REVERSAL-RECS                                    
                      PA-COUNT-PRORATE-RECS                                     
                      PA-COUNT-NON-PRORATE-RECS                                 
                      PA-COUNT-NON-PROR-REC-SPL-CASE.                           
                                                                                
           PERFORM 8700-READ-CNTL-JOB.                                          
           IF  (PS-CNTL-JOB-EOF-NO                                              
           AND (CC-JOB-MLK321                                                   
           OR   CC-JOB-MLK322                                                   
           OR   CC-JOB-MLK323))                                                 
               MOVE CC-JOB-NAME TO PV-REPORT-SELECTION                          
           ELSE                                                                 
               DISPLAY '** CHECK JOB CONTROL FILE INP03 **'                     
               MOVE '1000-INITIALIZE' TO  PV-PARAGRAPH-NAME                     
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
           PERFORM 1100-GET-FISCAL-DATE.                                        
                                                                                
           PERFORM 5400-SELECT-HEADER-DTL.                                      
                                                                                
           PERFORM 8400-READ-UNKNOWN-FILE.                                      
                                                                                
           PERFORM 8500-READ-KNOWN-FILE.                                        
                                                                                
           IF PS-UNKNOWN-FILE-EOF-YES                                           
              DISPLAY 'EMPTY UNKNOWN FILE - NO PRORATION REQD'                  
           ELSE                                                                 
              IF PS-KNOWN-FILE-EOF-YES                                          
                 DISPLAY 'EMPTY KNOWN FILE - NO PRORATION REQD'                 
                 PERFORM 8000-WRITE-NON-PROR-EMPTYKNWN                          
                   UNTIL PS-UNKNOWN-FILE-EOF-YES                                
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *   GET THE PREVIOUS WEEK'S DATE                                 *        
      ******************************************************************        
       1100-GET-FISCAL-DATE.                                                    
                                                                                
           PERFORM 8800-READ-CNTL-DATE                                          
           IF  PS-CNTL-DATE-EOF-NO                                              
           AND CNTL-DATE-REC           NOT = SPACES                             
               DISPLAY 'DATE READ FROM CONTROL FILE : ' CC-PROC-DATE-ISO        
               MOVE CC-PROC-DATE-MM  TO PV-FISC-DATE-MM                         
               MOVE CC-PROC-DATE-DD  TO PV-FISC-DATE-DD                         
               MOVE CC-PROC-DATE-CC  TO PV-FISC-DATE-CC                         
               MOVE CC-PROC-DATE-YY  TO PV-FISC-DATE-YY                         
               MOVE PV-FISC-DATE-ISO TO RPT-FISCAL-DATE-PURCHASE                
                                        RPT-FISCAL-DATE-PRC-CHG                 
                                        RPT-FISCAL-DATE-SALES                   
           ELSE                                                                 
               DISPLAY '** EMPTY DATE CONTROL FILE **'                          
               MOVE '1100-GET-FISCAL-DATE' TO PV-PARAGRAPH-NAME                 
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * MAIN LOGIC                                                              
      ******************************************************************        
       2000-MAIN-PROCESS.                                                       
           IF UNKWN-DEPT-NBR GREATER THAN KNOWN-DEPT-NBR                        
              IF PS-KNOWN-FILE-EOF-YES                                          
                 PERFORM 8000-WRITE-NON-PROR-EMPTYKNWN                          
                   UNTIL PS-UNKNOWN-FILE-EOF-YES                                
              ELSE                                                              
                 PERFORM 8500-READ-KNOWN-FILE                                   
              END-IF                                                            
           ELSE                                                                 
              IF UNKWN-DEPT-NBR LESS THAN KNOWN-DEPT-NBR                        
              AND UNKWN-DEPT-NBR NOT EQUAL HOLD-UNKWN-DEPT-NBR                  
                 PERFORM 8100-WRITE-NON-PROR-FILE                               
                 PERFORM 8400-READ-UNKNOWN-FILE                                 
              ELSE                                                              
                 IF UNKWN-DEPT-NBR EQUAL KNOWN-DEPT-NBR                         
                 AND UNKWN-DEPT-NBR NOT EQUAL HOLD-UNKWN-DEPT-NBR               
                    INITIALIZE PT-DBV-SUM-TABLE                                 
                               PV-CUM-UNKWN-MONEY-HOLDERS                       
                               PV-CUMULATIVE-VARIABLES                          
                               PV-MISC-VARIABLES                                
                    SET PS-ALL-MONEY-AMT-ZERO-NO TO TRUE                        
                    PERFORM 8600-CHECK-UNKWN-MONEY-AMTS                         
                    IF PS-ALL-MONEY-AMT-ZERO-YES                                
                       PERFORM 8100-WRITE-NON-PROR-FILE                         
                    ELSE                                                        
                       PERFORM 2100-LOAD-TABLE                                  
                         UNTIL UNKWN-DEPT-NBR NOT EQUAL KNOWN-DEPT-NBR          
                            OR PS-KNOWN-FILE-EOF-YES                            
                       MOVE PV-INDX TO PV-MAX-INDX                              
                       MOVE ZEROS TO PV-INDX                                    
                       PERFORM 2200-CALC-PERCENTAGES                            
                               PV-MAX-INDX TIMES                                
                       PERFORM 2300-MAX-PERCENTAGES                             
                       MOVE ZEROS TO PV-INDX                                    
                       PERFORM 2400-PROCESS-MONEY-AMOUNTS                       
                               PV-MAX-INDX TIMES                                
                       PERFORM 2500-MAX-MONEY-AMTS                              
                       PERFORM 8300-WRITE-REVERSAL-FILE                         
                       PERFORM 4000-BUILD-REPORT-BEFORE                         
                       MOVE ZEROS TO PV-INDX                                    
                       PERFORM 8200-WRITE-PRORATE-FILE                          
                               PV-MAX-INDX TIMES                                
                       PERFORM 4200-BUILD-REPORT-TOTALS                         
                       MOVE UNKWN-DEPT-NBR                                      
                         TO HOLD-UNKWN-DEPT-NBR                                 
                    END-IF                                                      
                 ELSE                                                           
                    IF UNKWN-DEPT-NBR EQUAL HOLD-UNKWN-DEPT-NBR                 
                       MOVE ZEROS TO PV-INDX                                    
                       INITIALIZE PV-CUM-UNKWN-MONEY-HOLDERS                    
                       PERFORM 2400-PROCESS-MONEY-AMOUNTS                       
                               PV-MAX-INDX TIMES                                
                       PERFORM 2500-MAX-MONEY-AMTS                              
                       PERFORM 8300-WRITE-REVERSAL-FILE                         
                       PERFORM 4000-BUILD-REPORT-BEFORE                         
                       MOVE ZEROS TO PV-INDX                                    
                       PERFORM 8200-WRITE-PRORATE-FILE                          
                               PV-MAX-INDX TIMES                                
                       PERFORM 4200-BUILD-REPORT-TOTALS                         
                       MOVE UNKWN-DEPT-NBR                                      
                         TO HOLD-UNKWN-DEPT-NBR                                 
                    END-IF                                                      
                 END-IF                                                         
                 PERFORM 8400-READ-UNKNOWN-FILE                                 
              END-IF                                                            
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  LOAD DBV TABLE WITH INPUT RECORDS OF THE KNOWN FILE                    
      ******************************************************************        
       2100-LOAD-TABLE.                                                         
                                                                                
           IF PV-INDX IS GREATER THAN PC-MAX-INDX                               
               MOVE '2100-LOAD-TABLE' TO  PV-PARAGRAPH-NAME                     
               DISPLAY '*  ROWS EXCEEDED MAX OF    ' PC-MAX-INDX                
               PERFORM 9999-ABEND                                               
           END-IF                                                               
                                                                                
           ADD +1 TO PV-INDX.                                                   
                                                                                
           MOVE KNOWN-DEPT-NBR                                                  
             TO DBV-DEPT-NBR(PV-INDX).                                          
           MOVE KNOWN-ENT-ID                                                    
             TO DBV-ENT-ID(PV-INDX).                                            
           MOVE KNOWN-LBL-SEQ-NBR                                               
             TO DBV-LBL-SEQ-NBR(PV-INDX).                                       
           MOVE KNOWN-ML-LWST-ID                                                
             TO DBV-ML-LWST-ID(PV-INDX)                                         
                                                                                
           MOVE KNOWN-SLS-REG-RTL-AMT                                           
             TO DBV-SLS-REG-RTL-AMT(PV-INDX)                                    
            ADD DBV-SLS-REG-RTL-AMT(PV-INDX)                                    
             TO CUM-SLS-REG-RTL-AMT                                             
                                                                                
           IF DBV-SLS-REG-RTL-AMT(PV-INDX) NOT EQUAL ZERO                       
              IF BIG-SLS-REG-RTL-AMT EQUAL ZERO                                 
                 MOVE DBV-SLS-REG-RTL-AMT(PV-INDX)                              
                   TO BIG-SLS-REG-RTL-AMT                                       
                 MOVE PV-INDX                                                   
                   TO BIG-SLS-REG-RTL-AMT-IDX                                   
              ELSE                                                              
                 IF DBV-SLS-REG-RTL-AMT(PV-INDX) >                              
                    BIG-SLS-REG-RTL-AMT                                         
                    MOVE DBV-SLS-REG-RTL-AMT(PV-INDX)                           
                      TO BIG-SLS-REG-RTL-AMT                                    
                    MOVE PV-INDX                                                
                      TO BIG-SLS-REG-RTL-AMT-IDX                                
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-SLS-PROMO-RTL-AMT                                         
             TO DBV-SLS-PROMO-RTL-AMT(PV-INDX)                                  
            ADD DBV-SLS-PROMO-RTL-AMT(PV-INDX)                                  
             TO CUM-SLS-PROMO-RTL-AMT                                           
                                                                                
           IF DBV-SLS-PROMO-RTL-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-SLS-PROMO-RTL-AMT EQUAL ZERO                               
                 MOVE DBV-SLS-PROMO-RTL-AMT(PV-INDX)                            
                   TO BIG-SLS-PROMO-RTL-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-SLS-PROMO-RTL-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-SLS-PROMO-RTL-AMT(PV-INDX) >                            
                    BIG-SLS-PROMO-RTL-AMT                                       
                    MOVE DBV-SLS-PROMO-RTL-AMT(PV-INDX)                         
                      TO BIG-SLS-PROMO-RTL-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-SLS-PROMO-RTL-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-SLS-PROCLR-RTL-AMT                                        
             TO DBV-SLS-PROCLR-RTL-AMT(PV-INDX)                                 
            ADD KNOWN-SLS-PROCLR-RTL-AMT                                        
             TO CUM-SLS-PROCLR-RTL-AMT                                          
                                                                                
           IF DBV-SLS-PROCLR-RTL-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-SLS-PROCLR-RTL-AMT EQUAL ZERO                              
                 MOVE DBV-SLS-PROCLR-RTL-AMT(PV-INDX)                           
                   TO BIG-SLS-PROCLR-RTL-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-SLS-PROCLR-RTL-AMT-IDX                                
              ELSE                                                              
                 IF DBV-SLS-PROCLR-RTL-AMT(PV-INDX) >                           
                    BIG-SLS-PROCLR-RTL-AMT                                      
                    MOVE DBV-SLS-PROCLR-RTL-AMT(PV-INDX)                        
                      TO BIG-SLS-PROCLR-RTL-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-SLS-PROCLR-RTL-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-SLS-CLR-RTL-AMT                                           
             TO DBV-SLS-CLR-RTL-AMT(PV-INDX)                                    
            ADD KNOWN-SLS-CLR-RTL-AMT                                           
             TO CUM-SLS-CLR-RTL-AMT                                             
                                                                                
           IF DBV-SLS-CLR-RTL-AMT(PV-INDX) NOT EQUAL ZERO                       
              IF BIG-SLS-CLR-RTL-AMT EQUAL ZERO                                 
                 MOVE DBV-SLS-CLR-RTL-AMT(PV-INDX)                              
                   TO BIG-SLS-CLR-RTL-AMT                                       
                 MOVE PV-INDX                                                   
                   TO BIG-SLS-CLR-RTL-AMT-IDX                                   
              ELSE                                                              
                 IF DBV-SLS-CLR-RTL-AMT(PV-INDX) >                              
                    BIG-SLS-CLR-RTL-AMT                                         
                    MOVE DBV-SLS-CLR-RTL-AMT(PV-INDX)                           
                      TO BIG-SLS-CLR-RTL-AMT                                    
                    MOVE PV-INDX                                                
                      TO BIG-SLS-CLR-RTL-AMT-IDX                                
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-SLS-OTH-RTL-AMT                                           
             TO DBV-SLS-OTH-RTL-AMT(PV-INDX)                                    
            ADD KNOWN-SLS-OTH-RTL-AMT                                           
             TO CUM-SLS-OTH-RTL-AMT                                             
                                                                                
           IF DBV-SLS-OTH-RTL-AMT(PV-INDX) NOT EQUAL ZERO                       
              IF BIG-SLS-OTH-RTL-AMT EQUAL ZERO                                 
                 MOVE DBV-SLS-OTH-RTL-AMT(PV-INDX)                              
                   TO BIG-SLS-OTH-RTL-AMT                                       
                 MOVE PV-INDX                                                   
                   TO BIG-SLS-OTH-RTL-AMT-IDX                                   
              ELSE                                                              
                 IF DBV-SLS-OTH-RTL-AMT(PV-INDX) >                              
                    BIG-SLS-OTH-RTL-AMT                                         
                    MOVE DBV-SLS-OTH-RTL-AMT(PV-INDX)                           
                      TO BIG-SLS-OTH-RTL-AMT                                    
                    MOVE PV-INDX                                                
                      TO BIG-SLS-OTH-RTL-AMT-IDX                                
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-PLU-RTL-AMT                                          
             TO DBV-MKDN-PLU-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-MKDN-PLU-RTL-AMT                                          
             TO CUM-MKDN-PLU-RTL-AMT                                            
                                                                                
           IF DBV-MKDN-PLU-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-MKDN-PLU-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-MKDN-PLU-RTL-AMT(PV-INDX)                             
                   TO BIG-MKDN-PLU-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-PLU-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-MKDN-PLU-RTL-AMT(PV-INDX) >                             
                    BIG-MKDN-PLU-RTL-AMT                                        
                    MOVE DBV-MKDN-PLU-RTL-AMT(PV-INDX)                          
                      TO BIG-MKDN-PLU-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-PLU-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-PROMO-RTL-AMT                                        
             TO DBV-MKDN-PROMO-RTL-AMT(PV-INDX)                                 
            ADD KNOWN-MKDN-PROMO-RTL-AMT                                        
             TO CUM-MKDN-PROMO-RTL-AMT                                          
                                                                                
           IF DBV-MKDN-PROMO-RTL-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-MKDN-PROMO-RTL-AMT EQUAL ZERO                              
                 MOVE DBV-MKDN-PROMO-RTL-AMT(PV-INDX)                           
                   TO BIG-MKDN-PROMO-RTL-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-PROMO-RTL-AMT-IDX                                
              ELSE                                                              
                 IF DBV-MKDN-PROMO-RTL-AMT(PV-INDX) >                           
                    BIG-MKDN-PROMO-RTL-AMT                                      
                    MOVE DBV-MKDN-PROMO-RTL-AMT(PV-INDX)                        
                      TO BIG-MKDN-PROMO-RTL-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-PROMO-RTL-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-RGST-RTL-AMT                                         
             TO DBV-MKDN-RGST-RTL-AMT(PV-INDX)                                  
            ADD KNOWN-MKDN-RGST-RTL-AMT                                         
             TO CUM-MKDN-RGST-RTL-AMT                                           
                                                                                
           IF DBV-MKDN-RGST-RTL-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-MKDN-RGST-RTL-AMT EQUAL ZERO                               
                 MOVE DBV-MKDN-RGST-RTL-AMT(PV-INDX)                            
                   TO BIG-MKDN-RGST-RTL-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-RGST-RTL-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-MKDN-RGST-RTL-AMT(PV-INDX) >                            
                    BIG-MKDN-RGST-RTL-AMT                                       
                    MOVE DBV-MKDN-RGST-RTL-AMT(PV-INDX)                         
                      TO BIG-MKDN-RGST-RTL-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-RGST-RTL-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-GLDST-RTL-AMT                                        
             TO DBV-MKDN-GLDST-RTL-AMT(PV-INDX)                                 
            ADD KNOWN-MKDN-GLDST-RTL-AMT                                        
             TO CUM-MKDN-GLDST-RTL-AMT                                          
                                                                                
           IF DBV-MKDN-GLDST-RTL-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-MKDN-GLDST-RTL-AMT EQUAL ZERO                              
                 MOVE DBV-MKDN-GLDST-RTL-AMT(PV-INDX)                           
                   TO BIG-MKDN-GLDST-RTL-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-GLDST-RTL-AMT-IDX                                
              ELSE                                                              
                 IF DBV-MKDN-GLDST-RTL-AMT(PV-INDX) >                           
                    BIG-MKDN-GLDST-RTL-AMT                                      
                    MOVE DBV-MKDN-GLDST-RTL-AMT(PV-INDX)                        
                      TO BIG-MKDN-GLDST-RTL-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-GLDST-RTL-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-UMTCH-RTL-AMT                                        
             TO DBV-MKDN-UMTCH-RTL-AMT(PV-INDX)                                 
            ADD KNOWN-MKDN-UMTCH-RTL-AMT                                        
             TO CUM-MKDN-UMTCH-RTL-AMT                                          
                                                                                
           IF DBV-MKDN-UMTCH-RTL-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-MKDN-UMTCH-RTL-AMT EQUAL ZERO                              
                 MOVE DBV-MKDN-UMTCH-RTL-AMT(PV-INDX)                           
                   TO BIG-MKDN-UMTCH-RTL-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-UMTCH-RTL-AMT-IDX                                
              ELSE                                                              
                 IF DBV-MKDN-UMTCH-RTL-AMT(PV-INDX) >                           
                    BIG-MKDN-UMTCH-RTL-AMT                                      
                    MOVE DBV-MKDN-UMTCH-RTL-AMT(PV-INDX)                        
                      TO BIG-MKDN-UMTCH-RTL-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-UMTCH-RTL-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-BYR-RTL-AMT                                          
             TO DBV-MKDN-BYR-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-MKDN-BYR-RTL-AMT                                          
             TO CUM-MKDN-BYR-RTL-AMT                                            
                                                                                
           IF DBV-MKDN-BYR-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-MKDN-BYR-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-MKDN-BYR-RTL-AMT(PV-INDX)                             
                   TO BIG-MKDN-BYR-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-BYR-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-MKDN-BYR-RTL-AMT(PV-INDX) >                             
                    BIG-MKDN-BYR-RTL-AMT                                        
                    MOVE DBV-MKDN-BYR-RTL-AMT(PV-INDX)                          
                      TO BIG-MKDN-BYR-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-BYR-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-STR-RTL-AMT                                          
             TO DBV-MKDN-STR-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-MKDN-STR-RTL-AMT                                          
             TO CUM-MKDN-STR-RTL-AMT                                            
                                                                                
           IF DBV-MKDN-STR-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-MKDN-STR-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-MKDN-STR-RTL-AMT(PV-INDX)                             
                   TO BIG-MKDN-STR-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-STR-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-MKDN-STR-RTL-AMT(PV-INDX) >                             
                    BIG-MKDN-STR-RTL-AMT                                        
                    MOVE DBV-MKDN-STR-RTL-AMT(PV-INDX)                          
                      TO BIG-MKDN-STR-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-STR-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-PRPT-RTL-AMT                                         
             TO DBV-MKDN-PRPT-RTL-AMT(PV-INDX)                                  
            ADD KNOWN-MKDN-PRPT-RTL-AMT                                         
             TO CUM-MKDN-PRPT-RTL-AMT                                           
                                                                                
           IF DBV-MKDN-PRPT-RTL-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-MKDN-PRPT-RTL-AMT EQUAL ZERO                               
                 MOVE DBV-MKDN-PRPT-RTL-AMT(PV-INDX)                            
                   TO BIG-MKDN-PRPT-RTL-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-PRPT-RTL-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-MKDN-PRPT-RTL-AMT(PV-INDX) >                            
                    BIG-MKDN-PRPT-RTL-AMT                                       
                    MOVE DBV-MKDN-PRPT-RTL-AMT(PV-INDX)                         
                      TO BIG-MKDN-PRPT-RTL-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-PRPT-RTL-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-OTH-RTL-AMT                                          
             TO DBV-MKDN-OTH-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-MKDN-OTH-RTL-AMT                                          
             TO CUM-MKDN-OTH-RTL-AMT                                            
                                                                                
           IF DBV-MKDN-OTH-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-MKDN-OTH-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-MKDN-OTH-RTL-AMT(PV-INDX)                             
                   TO BIG-MKDN-OTH-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-OTH-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-MKDN-OTH-RTL-AMT(PV-INDX) >                             
                    BIG-MKDN-OTH-RTL-AMT                                        
                    MOVE DBV-MKDN-OTH-RTL-AMT(PV-INDX)                          
                      TO BIG-MKDN-OTH-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-OTH-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKDN-RTL-AMT                                              
             TO DBV-MKDN-RTL-AMT(PV-INDX)                                       
            ADD KNOWN-MKDN-RTL-AMT                                              
             TO CUM-MKDN-RTL-AMT                                                
                                                                                
           IF DBV-MKDN-RTL-AMT(PV-INDX) NOT EQUAL ZERO                          
              IF BIG-MKDN-RTL-AMT EQUAL ZERO                                    
                 MOVE DBV-MKDN-RTL-AMT(PV-INDX)                                 
                   TO BIG-MKDN-RTL-AMT                                          
                 MOVE PV-INDX                                                   
                   TO BIG-MKDN-RTL-AMT-IDX                                      
              ELSE                                                              
                 IF DBV-MKDN-RTL-AMT(PV-INDX) >                                 
                    BIG-MKDN-RTL-AMT                                            
                    MOVE DBV-MKDN-RTL-AMT(PV-INDX)                              
                      TO BIG-MKDN-RTL-AMT                                       
                    MOVE PV-INDX                                                
                      TO BIG-MKDN-RTL-AMT-IDX                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKUP-RTL-AMT                                              
             TO DBV-MKUP-RTL-AMT(PV-INDX)                                       
            ADD KNOWN-MKUP-RTL-AMT                                              
             TO CUM-MKUP-RTL-AMT                                                
                                                                                
           IF DBV-MKUP-RTL-AMT(PV-INDX) NOT EQUAL ZERO                          
              IF BIG-MKUP-RTL-AMT EQUAL ZERO                                    
                 MOVE DBV-MKUP-RTL-AMT(PV-INDX)                                 
                   TO BIG-MKUP-RTL-AMT                                          
                 MOVE PV-INDX                                                   
                   TO BIG-MKUP-RTL-AMT-IDX                                      
              ELSE                                                              
                 IF DBV-MKUP-RTL-AMT(PV-INDX) >                                 
                    BIG-MKUP-RTL-AMT                                            
                    MOVE DBV-MKUP-RTL-AMT(PV-INDX)                              
                      TO BIG-MKUP-RTL-AMT                                       
                    MOVE PV-INDX                                                
                      TO BIG-MKUP-RTL-AMT-IDX                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-XFER-IN-RTL-AMT                                           
             TO DBV-XFER-IN-RTL-AMT(PV-INDX)                                    
            ADD KNOWN-XFER-IN-RTL-AMT                                           
             TO CUM-XFER-IN-RTL-AMT                                             
                                                                                
           IF DBV-XFER-IN-RTL-AMT(PV-INDX) NOT EQUAL ZERO                       
              IF BIG-XFER-IN-RTL-AMT EQUAL ZERO                                 
                 MOVE DBV-XFER-IN-RTL-AMT(PV-INDX)                              
                   TO BIG-XFER-IN-RTL-AMT                                       
                 MOVE PV-INDX                                                   
                   TO BIG-XFER-IN-RTL-AMT-IDX                                   
              ELSE                                                              
                 IF DBV-XFER-IN-RTL-AMT(PV-INDX) >                              
                    BIG-XFER-IN-RTL-AMT                                         
                    MOVE DBV-XFER-IN-RTL-AMT(PV-INDX)                           
                      TO BIG-XFER-IN-RTL-AMT                                    
                    MOVE PV-INDX                                                
                      TO BIG-XFER-IN-RTL-AMT-IDX                                
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-XFER-OUT-RTL-AMT                                          
             TO DBV-XFER-OUT-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-XFER-OUT-RTL-AMT                                          
             TO CUM-XFER-OUT-RTL-AMT                                            
                                                                                
           IF DBV-XFER-OUT-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-XFER-OUT-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-XFER-OUT-RTL-AMT(PV-INDX)                             
                   TO BIG-XFER-OUT-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-XFER-OUT-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-XFER-OUT-RTL-AMT(PV-INDX) >                             
                    BIG-XFER-OUT-RTL-AMT                                        
                    MOVE DBV-XFER-OUT-RTL-AMT(PV-INDX)                          
                      TO BIG-XFER-OUT-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-XFER-OUT-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-RCPT-RTL-AMT                                              
             TO DBV-RCPT-RTL-AMT(PV-INDX)                                       
            ADD KNOWN-RCPT-RTL-AMT                                              
             TO CUM-RCPT-RTL-AMT                                                
                                                                                
           IF DBV-RCPT-RTL-AMT(PV-INDX) NOT EQUAL ZERO                          
              IF BIG-RCPT-RTL-AMT EQUAL ZERO                                    
                 MOVE DBV-RCPT-RTL-AMT(PV-INDX)                                 
                   TO BIG-RCPT-RTL-AMT                                          
                 MOVE PV-INDX                                                   
                   TO BIG-RCPT-RTL-AMT-IDX                                      
              ELSE                                                              
                 IF DBV-RCPT-RTL-AMT(PV-INDX) >                                 
                    BIG-RCPT-RTL-AMT                                            
                    MOVE DBV-RCPT-RTL-AMT(PV-INDX)                              
                      TO BIG-RCPT-RTL-AMT                                       
                    MOVE PV-INDX                                                
                      TO BIG-RCPT-RTL-AMT-IDX                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-RCPT-NET-COST-AMT                                         
             TO DBV-RCPT-NET-COST-AMT(PV-INDX)                                  
            ADD KNOWN-RCPT-NET-COST-AMT                                         
             TO CUM-RCPT-NET-COST-AMT                                           
                                                                                
           IF DBV-RCPT-NET-COST-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-RCPT-NET-COST-AMT EQUAL ZERO                               
                 MOVE DBV-RCPT-NET-COST-AMT(PV-INDX)                            
                   TO BIG-RCPT-NET-COST-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-RCPT-NET-COST-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-RCPT-NET-COST-AMT(PV-INDX) >                            
                    BIG-RCPT-NET-COST-AMT                                       
                    MOVE DBV-RCPT-NET-COST-AMT(PV-INDX)                         
                      TO BIG-RCPT-NET-COST-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-RCPT-NET-COST-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-RCPT-GRO-COST-AMT                                         
             TO DBV-RCPT-GRO-COST-AMT(PV-INDX)                                  
            ADD KNOWN-RCPT-GRO-COST-AMT                                         
             TO CUM-RCPT-GRO-COST-AMT                                           
                                                                                
           IF DBV-RCPT-GRO-COST-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-RCPT-GRO-COST-AMT EQUAL ZERO                               
                 MOVE DBV-RCPT-GRO-COST-AMT(PV-INDX)                            
                   TO BIG-RCPT-GRO-COST-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-RCPT-GRO-COST-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-RCPT-GRO-COST-AMT(PV-INDX) >                            
                    BIG-RCPT-GRO-COST-AMT                                       
                    MOVE DBV-RCPT-GRO-COST-AMT(PV-INDX)                         
                      TO BIG-RCPT-GRO-COST-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-RCPT-GRO-COST-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-RCPT-FRGT-COST-AMT                                        
             TO DBV-RCPT-FRGT-COST-AMT(PV-INDX)                                 
            ADD KNOWN-RCPT-FRGT-COST-AMT                                        
             TO CUM-RCPT-FRGT-COST-AMT                                          
                                                                                
           IF DBV-RCPT-FRGT-COST-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-RCPT-FRGT-COST-AMT EQUAL ZERO                              
                 MOVE DBV-RCPT-FRGT-COST-AMT(PV-INDX)                           
                   TO BIG-RCPT-FRGT-COST-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-RCPT-FRGT-COST-AMT-IDX                                
              ELSE                                                              
                 IF DBV-RCPT-FRGT-COST-AMT(PV-INDX) >                           
                    BIG-RCPT-FRGT-COST-AMT                                      
                    MOVE DBV-RCPT-FRGT-COST-AMT(PV-INDX)                        
                      TO BIG-RCPT-FRGT-COST-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-RCPT-FRGT-COST-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-RTL-AMT                                              
             TO DBV-PADJ-RTL-AMT(PV-INDX)                                       
            ADD KNOWN-PADJ-RTL-AMT                                              
             TO CUM-PADJ-RTL-AMT                                                
                                                                                
           IF DBV-PADJ-RTL-AMT(PV-INDX) NOT EQUAL ZERO                          
              IF BIG-PADJ-RTL-AMT EQUAL ZERO                                    
                 MOVE DBV-PADJ-RTL-AMT(PV-INDX)                                 
                   TO BIG-PADJ-RTL-AMT                                          
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-RTL-AMT-IDX                                      
              ELSE                                                              
                 IF DBV-PADJ-RTL-AMT(PV-INDX) >                                 
                    BIG-PADJ-RTL-AMT                                            
                    MOVE DBV-PADJ-RTL-AMT(PV-INDX)                              
                      TO BIG-PADJ-RTL-AMT                                       
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-RTL-AMT-IDX                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-FRGT-COST-AMT                                        
             TO DBV-PADJ-FRGT-COST-AMT(PV-INDX)                                 
            ADD KNOWN-PADJ-FRGT-COST-AMT                                        
             TO CUM-PADJ-FRGT-COST-AMT                                          
                                                                                
           IF DBV-PADJ-FRGT-COST-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-PADJ-FRGT-COST-AMT EQUAL ZERO                              
                 MOVE DBV-PADJ-FRGT-COST-AMT(PV-INDX)                           
                   TO BIG-PADJ-FRGT-COST-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-FRGT-COST-AMT-IDX                                
              ELSE                                                              
                 IF DBV-PADJ-FRGT-COST-AMT(PV-INDX) >                           
                    BIG-PADJ-FRGT-COST-AMT                                      
                    MOVE DBV-PADJ-FRGT-COST-AMT(PV-INDX)                        
                      TO BIG-PADJ-FRGT-COST-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-FRGT-COST-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-DISC-COST-AMT                                        
             TO DBV-PADJ-DISC-COST-AMT(PV-INDX)                                 
            ADD KNOWN-PADJ-DISC-COST-AMT                                        
             TO CUM-PADJ-DISC-COST-AMT                                          
                                                                                
           IF DBV-PADJ-DISC-COST-AMT(PV-INDX) NOT EQUAL ZERO                    
              IF BIG-PADJ-DISC-COST-AMT EQUAL ZERO                              
                 MOVE DBV-PADJ-DISC-COST-AMT(PV-INDX)                           
                   TO BIG-PADJ-DISC-COST-AMT                                    
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-DISC-COST-AMT-IDX                                
              ELSE                                                              
                 IF DBV-PADJ-DISC-COST-AMT(PV-INDX) >                           
                    BIG-PADJ-DISC-COST-AMT                                      
                    MOVE DBV-PADJ-DISC-COST-AMT(PV-INDX)                        
                      TO BIG-PADJ-DISC-COST-AMT                                 
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-DISC-COST-AMT-IDX                             
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-RTV-COST-AMT                                         
             TO DBV-PADJ-RTV-COST-AMT(PV-INDX)                                  
            ADD KNOWN-PADJ-RTV-COST-AMT                                         
             TO CUM-PADJ-RTV-COST-AMT                                           
                                                                                
           IF DBV-PADJ-RTV-COST-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-PADJ-RTV-COST-AMT EQUAL ZERO                               
                 MOVE DBV-PADJ-RTV-COST-AMT(PV-INDX)                            
                   TO BIG-PADJ-RTV-COST-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-RTV-COST-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-PADJ-RTV-COST-AMT(PV-INDX) >                            
                    BIG-PADJ-RTV-COST-AMT                                       
                    MOVE DBV-PADJ-RTV-COST-AMT(PV-INDX)                         
                      TO BIG-PADJ-RTV-COST-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-RTV-COST-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-RTV-RTL-AMT                                          
             TO DBV-PADJ-RTV-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-PADJ-RTV-RTL-AMT                                          
             TO CUM-PADJ-RTV-RTL-AMT                                            
                                                                                
           IF DBV-PADJ-RTV-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-PADJ-RTV-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-PADJ-RTV-RTL-AMT(PV-INDX)                             
                   TO BIG-PADJ-RTV-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-RTV-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-PADJ-RTV-RTL-AMT(PV-INDX) >                             
                    BIG-PADJ-RTV-RTL-AMT                                        
                    MOVE DBV-PADJ-RTV-RTL-AMT(PV-INDX)                          
                      TO BIG-PADJ-RTV-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-RTV-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-DA-COST-AMT                                          
             TO DBV-PADJ-DA-COST-AMT(PV-INDX)                                   
            ADD KNOWN-PADJ-DA-COST-AMT                                          
             TO CUM-PADJ-DA-COST-AMT                                            
                                                                                
           IF DBV-PADJ-DA-COST-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-PADJ-DA-COST-AMT EQUAL ZERO                                
                 MOVE DBV-PADJ-DA-COST-AMT(PV-INDX)                             
                   TO BIG-PADJ-DA-COST-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-DA-COST-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-PADJ-DA-COST-AMT(PV-INDX) >                             
                    BIG-PADJ-DA-COST-AMT                                        
                    MOVE DBV-PADJ-DA-COST-AMT(PV-INDX)                          
                      TO BIG-PADJ-DA-COST-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-DA-COST-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-DA-RTL-AMT                                           
             TO DBV-PADJ-DA-RTL-AMT(PV-INDX)                                    
            ADD KNOWN-PADJ-DA-RTL-AMT                                           
             TO CUM-PADJ-DA-RTL-AMT                                             
                                                                                
           IF DBV-PADJ-DA-RTL-AMT(PV-INDX) NOT EQUAL ZERO                       
              IF BIG-PADJ-DA-RTL-AMT EQUAL ZERO                                 
                 MOVE DBV-PADJ-DA-RTL-AMT(PV-INDX)                              
                   TO BIG-PADJ-DA-RTL-AMT                                       
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-DA-RTL-AMT-IDX                                   
              ELSE                                                              
                 IF DBV-PADJ-DA-RTL-AMT(PV-INDX) >                              
                    BIG-PADJ-DA-RTL-AMT                                         
                    MOVE DBV-PADJ-DA-RTL-AMT(PV-INDX)                           
                      TO BIG-PADJ-DA-RTL-AMT                                    
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-DA-RTL-AMT-IDX                                
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-NET-COST-AMT                                         
             TO DBV-PADJ-NET-COST-AMT(PV-INDX)                                  
            ADD KNOWN-PADJ-NET-COST-AMT                                         
             TO CUM-PADJ-NET-COST-AMT                                           
                                                                                
           IF DBV-PADJ-NET-COST-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-PADJ-NET-COST-AMT EQUAL ZERO                               
                 MOVE DBV-PADJ-NET-COST-AMT(PV-INDX)                            
                   TO BIG-PADJ-NET-COST-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-NET-COST-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-PADJ-NET-COST-AMT(PV-INDX) >                            
                    BIG-PADJ-NET-COST-AMT                                       
                    MOVE DBV-PADJ-NET-COST-AMT(PV-INDX)                         
                      TO BIG-PADJ-NET-COST-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-NET-COST-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-OTH-COST-AMT                                         
             TO DBV-PADJ-OTH-COST-AMT(PV-INDX)                                  
            ADD KNOWN-PADJ-OTH-COST-AMT                                         
             TO CUM-PADJ-OTH-COST-AMT                                           
                                                                                
           IF DBV-PADJ-OTH-COST-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-PADJ-OTH-COST-AMT EQUAL ZERO                               
                 MOVE DBV-PADJ-OTH-COST-AMT(PV-INDX)                            
                   TO BIG-PADJ-OTH-COST-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-OTH-COST-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-PADJ-OTH-COST-AMT(PV-INDX) >                            
                    BIG-PADJ-OTH-COST-AMT                                       
                    MOVE DBV-PADJ-OTH-COST-AMT(PV-INDX)                         
                      TO BIG-PADJ-OTH-COST-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-OTH-COST-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-OTH-RTL-AMT                                          
             TO DBV-PADJ-OTH-RTL-AMT(PV-INDX)                                   
            ADD KNOWN-PADJ-OTH-RTL-AMT                                          
             TO CUM-PADJ-OTH-RTL-AMT                                            
                                                                                
           IF DBV-PADJ-OTH-RTL-AMT(PV-INDX) NOT EQUAL ZERO                      
              IF BIG-PADJ-OTH-RTL-AMT EQUAL ZERO                                
                 MOVE DBV-PADJ-OTH-RTL-AMT(PV-INDX)                             
                   TO BIG-PADJ-OTH-RTL-AMT                                      
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-OTH-RTL-AMT-IDX                                  
              ELSE                                                              
                 IF DBV-PADJ-OTH-RTL-AMT(PV-INDX) >                             
                    BIG-PADJ-OTH-RTL-AMT                                        
                    MOVE DBV-PADJ-OTH-RTL-AMT(PV-INDX)                          
                      TO BIG-PADJ-OTH-RTL-AMT                                   
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-OTH-RTL-AMT-IDX                               
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-PADJ-GRO-COST-AMT                                         
             TO DBV-PADJ-GRO-COST-AMT(PV-INDX)                                  
            ADD KNOWN-PADJ-GRO-COST-AMT                                         
             TO CUM-PADJ-GRO-COST-AMT                                           
                                                                                
           IF DBV-PADJ-GRO-COST-AMT(PV-INDX) NOT EQUAL ZERO                     
              IF BIG-PADJ-GRO-COST-AMT EQUAL ZERO                               
                 MOVE DBV-PADJ-GRO-COST-AMT(PV-INDX)                            
                   TO BIG-PADJ-GRO-COST-AMT                                     
                 MOVE PV-INDX                                                   
                   TO BIG-PADJ-GRO-COST-AMT-IDX                                 
              ELSE                                                              
                 IF DBV-PADJ-GRO-COST-AMT(PV-INDX) >                            
                    BIG-PADJ-GRO-COST-AMT                                       
                    MOVE DBV-PADJ-GRO-COST-AMT(PV-INDX)                         
                      TO BIG-PADJ-GRO-COST-AMT                                  
                    MOVE PV-INDX                                                
                      TO BIG-PADJ-GRO-COST-AMT-IDX                              
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-DR-ALW-RTL-AMT                                            
             TO DBV-DR-ALW-RTL-AMT(PV-INDX)                                     
            ADD KNOWN-DR-ALW-RTL-AMT                                            
             TO CUM-DR-ALW-RTL-AMT                                              
                                                                                
           IF DBV-DR-ALW-RTL-AMT(PV-INDX) NOT EQUAL ZERO                        
              IF BIG-DR-ALW-RTL-AMT EQUAL ZERO                                  
                 MOVE DBV-DR-ALW-RTL-AMT(PV-INDX)                               
                   TO BIG-DR-ALW-RTL-AMT                                        
                 MOVE PV-INDX                                                   
                   TO BIG-DR-ALW-RTL-AMT-IDX                                    
              ELSE                                                              
                 IF DBV-DR-ALW-RTL-AMT(PV-INDX) >                               
                    BIG-DR-ALW-RTL-AMT                                          
                    MOVE DBV-DR-ALW-RTL-AMT(PV-INDX)                            
                      TO BIG-DR-ALW-RTL-AMT                                     
                    MOVE PV-INDX                                                
                      TO BIG-DR-ALW-RTL-AMT-IDX                                 
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-RTV-RTL-AMT                                               
             TO DBV-RTV-RTL-AMT(PV-INDX)                                        
            ADD KNOWN-RTV-RTL-AMT                                               
             TO CUM-RTV-RTL-AMT                                                 
                                                                                
           IF DBV-RTV-RTL-AMT(PV-INDX) NOT EQUAL ZERO                           
              IF BIG-RTV-RTL-AMT EQUAL ZERO                                     
                 MOVE DBV-RTV-RTL-AMT(PV-INDX)                                  
                   TO BIG-RTV-RTL-AMT                                           
                 MOVE PV-INDX                                                   
                   TO BIG-RTV-RTL-AMT-IDX                                       
              ELSE                                                              
                 IF DBV-RTV-RTL-AMT(PV-INDX) >                                  
                    BIG-RTV-RTL-AMT                                             
                    MOVE DBV-RTV-RTL-AMT(PV-INDX)                               
                      TO BIG-RTV-RTL-AMT                                        
                    MOVE PV-INDX                                                
                      TO BIG-RTV-RTL-AMT-IDX                                    
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKUP-INIT-AMT                                             
             TO DBV-MKUP-INIT-AMT(PV-INDX)                                      
            ADD KNOWN-MKUP-INIT-AMT                                             
             TO CUM-MKUP-INIT-AMT                                               
                                                                                
           IF DBV-MKUP-INIT-AMT(PV-INDX) NOT EQUAL ZERO                         
              IF BIG-MKUP-INIT-AMT EQUAL ZERO                                   
                 MOVE DBV-MKUP-INIT-AMT(PV-INDX)                                
                   TO BIG-MKUP-INIT-AMT                                         
                 MOVE PV-INDX                                                   
                   TO BIG-MKUP-INIT-AMT-IDX                                     
              ELSE                                                              
                 IF DBV-MKUP-INIT-AMT(PV-INDX) >                                
                    BIG-MKUP-INIT-AMT                                           
                    MOVE DBV-MKUP-INIT-AMT(PV-INDX)                             
                      TO BIG-MKUP-INIT-AMT                                      
                    MOVE PV-INDX                                                
                      TO BIG-MKUP-INIT-AMT-IDX                                  
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           MOVE KNOWN-MKUP-NET-AMT                                              
             TO DBV-MKUP-NET-AMT(PV-INDX)                                       
            ADD KNOWN-MKUP-NET-AMT                                              
             TO CUM-MKUP-NET-AMT                                                
                                                                                
           IF DBV-MKUP-NET-AMT(PV-INDX) NOT EQUAL ZERO                          
              IF BIG-MKUP-NET-AMT EQUAL ZERO                                    
                 MOVE DBV-MKUP-NET-AMT(PV-INDX)                                 
                   TO BIG-MKUP-NET-AMT                                          
                 MOVE PV-INDX                                                   
                   TO BIG-MKUP-NET-AMT-IDX                                      
              ELSE                                                              
                 IF DBV-MKUP-NET-AMT(PV-INDX) >                                 
                    BIG-MKUP-NET-AMT                                            
                    MOVE DBV-MKUP-NET-AMT(PV-INDX)                              
                      TO BIG-MKUP-NET-AMT                                       
                    MOVE PV-INDX                                                
                      TO BIG-MKUP-NET-AMT-IDX                                   
                 END-IF                                                         
              END-IF                                                            
           END-IF                                                               
                                                                                
           PERFORM 8500-READ-KNOWN-FILE.                                        
                                                                                
      ******************************************************************        
      *  PROCESS TO CALC PERCENTAGES                                            
      ******************************************************************        
       2200-CALC-PERCENTAGES.                                                   
                                                                                
           ADD 1 TO PV-INDX.                                                    
                                                                                
           IF BIG-SLS-REG-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
              IF CUM-SLS-REG-RTL-AMT NOT EQUAL ZERO                             
                 COMPUTE DBV-SLS-REG-RTL-PCT(PV-INDX) =                         
                    DBV-SLS-REG-RTL-AMT(PV-INDX) / CUM-SLS-REG-RTL-AMT          
                 ADD DBV-SLS-REG-RTL-PCT(PV-INDX)                               
                  TO CUM-SLS-REG-RTL-PCT                                        
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF BIG-SLS-PROMO-RTL-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              IF CUM-SLS-PROMO-RTL-AMT NOT EQUAL ZERO                           
                 COMPUTE DBV-SLS-PROMO-RTL-PCT(PV-INDX) =                       
                  DBV-SLS-PROMO-RTL-AMT(PV-INDX) / CUM-SLS-PROMO-RTL-AMT        
                 ADD DBV-SLS-PROMO-RTL-PCT(PV-INDX)                             
                  TO CUM-SLS-PROMO-RTL-PCT                                      
              END-IF                                                            
           END-IF                                                               
                                                                                
           IF BIG-SLS-PROCLR-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-SLS-PROCLR-RTL-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-SLS-PROCLR-RTL-PCT(PV-INDX) =                         
               DBV-SLS-PROCLR-RTL-AMT(PV-INDX) / CUM-SLS-PROCLR-RTL-AMT         
              ADD DBV-SLS-PROCLR-RTL-PCT(PV-INDX)                               
               TO CUM-SLS-PROCLR-RTL-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-SLS-CLR-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-SLS-CLR-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE DBV-SLS-CLR-RTL-PCT(PV-INDX) =                            
               DBV-SLS-CLR-RTL-AMT(PV-INDX) / CUM-SLS-CLR-RTL-AMT               
              ADD DBV-SLS-CLR-RTL-PCT(PV-INDX)                                  
               TO CUM-SLS-CLR-RTL-PCT                                           
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-SLS-OTH-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-SLS-OTH-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE DBV-SLS-OTH-RTL-PCT(PV-INDX) =                            
               DBV-SLS-OTH-RTL-AMT(PV-INDX) / CUM-SLS-OTH-RTL-AMT               
              ADD DBV-SLS-OTH-RTL-PCT(PV-INDX)                                  
               TO CUM-SLS-OTH-RTL-PCT                                           
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PLU-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-PLU-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-MKDN-PLU-RTL-PCT(PV-INDX) =                           
               DBV-MKDN-PLU-RTL-AMT(PV-INDX) / CUM-MKDN-PLU-RTL-AMT             
              ADD DBV-MKDN-PLU-RTL-PCT(PV-INDX)                                 
               TO CUM-MKDN-PLU-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PROMO-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-PROMO-RTL-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-MKDN-PROMO-RTL-PCT(PV-INDX) =                         
               DBV-MKDN-PROMO-RTL-AMT(PV-INDX) / CUM-MKDN-PROMO-RTL-AMT         
              ADD DBV-MKDN-PROMO-RTL-PCT(PV-INDX)                               
               TO CUM-MKDN-PROMO-RTL-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-RGST-RTL-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-RGST-RTL-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-MKDN-RGST-RTL-PCT(PV-INDX) =                          
               DBV-MKDN-RGST-RTL-AMT(PV-INDX) / CUM-MKDN-RGST-RTL-AMT           
              ADD DBV-MKDN-RGST-RTL-PCT(PV-INDX)                                
               TO CUM-MKDN-RGST-RTL-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-GLDST-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-GLDST-RTL-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-MKDN-GLDST-RTL-PCT(PV-INDX) =                         
               DBV-MKDN-GLDST-RTL-AMT(PV-INDX) / CUM-MKDN-GLDST-RTL-AMT         
              ADD DBV-MKDN-GLDST-RTL-PCT(PV-INDX)                               
               TO CUM-MKDN-GLDST-RTL-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-UMTCH-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-UMTCH-RTL-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-MKDN-UMTCH-RTL-PCT(PV-INDX) =                         
               DBV-MKDN-UMTCH-RTL-AMT(PV-INDX) / CUM-MKDN-UMTCH-RTL-AMT         
              ADD DBV-MKDN-UMTCH-RTL-PCT(PV-INDX)                               
               TO CUM-MKDN-UMTCH-RTL-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-BYR-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-BYR-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-MKDN-BYR-RTL-PCT(PV-INDX) =                           
               DBV-MKDN-BYR-RTL-AMT(PV-INDX) / CUM-MKDN-BYR-RTL-AMT             
              ADD DBV-MKDN-BYR-RTL-PCT(PV-INDX)                                 
               TO CUM-MKDN-BYR-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-STR-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-STR-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-MKDN-STR-RTL-PCT(PV-INDX) =                           
               DBV-MKDN-STR-RTL-AMT(PV-INDX) / CUM-MKDN-STR-RTL-AMT             
              ADD DBV-MKDN-STR-RTL-PCT(PV-INDX)                                 
               TO CUM-MKDN-STR-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PRPT-RTL-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-PRPT-RTL-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-MKDN-PRPT-RTL-PCT(PV-INDX) =                          
               DBV-MKDN-PRPT-RTL-AMT(PV-INDX) / CUM-MKDN-PRPT-RTL-AMT           
              ADD DBV-MKDN-PRPT-RTL-PCT(PV-INDX)                                
               TO CUM-MKDN-PRPT-RTL-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-OTH-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-OTH-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-MKDN-OTH-RTL-PCT(PV-INDX) =                           
               DBV-MKDN-OTH-RTL-AMT(PV-INDX) / CUM-MKDN-OTH-RTL-AMT             
              ADD DBV-MKDN-OTH-RTL-PCT(PV-INDX)                                 
               TO CUM-MKDN-OTH-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKDN-RTL-AMT NOT EQUAL ZERO                                 
              COMPUTE DBV-MKDN-RTL-PCT(PV-INDX) =                               
               DBV-MKDN-RTL-AMT(PV-INDX) / CUM-MKDN-RTL-AMT                     
              ADD DBV-MKDN-RTL-PCT(PV-INDX)                                     
               TO CUM-MKDN-RTL-PCT                                              
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKUP-RTL-AMT NOT EQUAL ZERO                                 
              COMPUTE DBV-MKUP-RTL-PCT(PV-INDX) =                               
               DBV-MKUP-RTL-AMT(PV-INDX) / CUM-MKUP-RTL-AMT                     
              ADD DBV-MKUP-RTL-PCT(PV-INDX)                                     
               TO CUM-MKUP-RTL-PCT                                              
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-XFER-IN-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-XFER-IN-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE DBV-XFER-IN-RTL-PCT(PV-INDX) =                            
               DBV-XFER-IN-RTL-AMT(PV-INDX) / CUM-XFER-IN-RTL-AMT               
              ADD DBV-XFER-IN-RTL-PCT(PV-INDX)                                  
               TO CUM-XFER-IN-RTL-PCT                                           
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-XFER-OUT-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-XFER-OUT-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-XFER-OUT-RTL-PCT(PV-INDX) =                           
               DBV-XFER-OUT-RTL-AMT(PV-INDX) / CUM-XFER-OUT-RTL-AMT             
              ADD DBV-XFER-OUT-RTL-PCT(PV-INDX)                                 
               TO CUM-XFER-OUT-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-RCPT-RTL-AMT NOT EQUAL ZERO                                 
              COMPUTE DBV-RCPT-RTL-PCT(PV-INDX) =                               
               DBV-RCPT-RTL-AMT(PV-INDX) / CUM-RCPT-RTL-AMT                     
              ADD DBV-RCPT-RTL-PCT(PV-INDX)                                     
               TO CUM-RCPT-RTL-PCT                                              
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-NET-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-RCPT-NET-COST-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-RCPT-NET-COST-PCT(PV-INDX) =                          
               DBV-RCPT-NET-COST-AMT(PV-INDX) / CUM-RCPT-NET-COST-AMT           
              ADD DBV-RCPT-NET-COST-PCT(PV-INDX)                                
               TO CUM-RCPT-NET-COST-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-GRO-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-RCPT-GRO-COST-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-RCPT-GRO-COST-PCT(PV-INDX) =                          
               DBV-RCPT-GRO-COST-AMT(PV-INDX) / CUM-RCPT-GRO-COST-AMT           
              ADD DBV-RCPT-GRO-COST-PCT(PV-INDX)                                
               TO CUM-RCPT-GRO-COST-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-FRGT-COST-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-RCPT-FRGT-COST-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-RCPT-FRGT-COST-PCT(PV-INDX) =                         
               DBV-RCPT-FRGT-COST-AMT(PV-INDX) / CUM-RCPT-FRGT-COST-AMT         
              ADD DBV-RCPT-FRGT-COST-PCT(PV-INDX)                               
               TO CUM-RCPT-FRGT-COST-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-RTL-AMT NOT EQUAL ZERO                                 
              COMPUTE DBV-PADJ-RTL-PCT(PV-INDX) =                               
               DBV-PADJ-RTL-AMT(PV-INDX) / CUM-PADJ-RTL-AMT                     
              ADD DBV-PADJ-RTL-PCT(PV-INDX)                                     
               TO CUM-PADJ-RTL-PCT                                              
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-FRGT-COST-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-FRGT-COST-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-PADJ-FRGT-COST-PCT(PV-INDX) =                         
               DBV-PADJ-FRGT-COST-AMT(PV-INDX) / CUM-PADJ-FRGT-COST-AMT         
              ADD DBV-PADJ-FRGT-COST-PCT(PV-INDX)                               
               TO CUM-PADJ-FRGT-COST-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DISC-COST-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-DISC-COST-AMT NOT EQUAL ZERO                           
              COMPUTE DBV-PADJ-DISC-COST-PCT(PV-INDX) =                         
               DBV-PADJ-DISC-COST-AMT(PV-INDX) / CUM-PADJ-DISC-COST-AMT         
              ADD DBV-PADJ-DISC-COST-PCT(PV-INDX)                               
               TO CUM-PADJ-DISC-COST-PCT                                        
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-RTV-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-RTV-COST-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-PADJ-RTV-COST-PCT(PV-INDX) =                          
               DBV-PADJ-RTV-COST-AMT(PV-INDX) / CUM-PADJ-RTV-COST-AMT           
              ADD DBV-PADJ-RTV-COST-PCT(PV-INDX)                                
               TO CUM-PADJ-RTV-COST-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-RTV-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-RTV-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-PADJ-RTV-RTL-PCT(PV-INDX) =                           
               DBV-PADJ-RTV-RTL-AMT(PV-INDX) / CUM-PADJ-RTV-RTL-AMT             
              ADD DBV-PADJ-RTV-RTL-PCT(PV-INDX)                                 
               TO CUM-PADJ-RTV-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DA-COST-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-DA-COST-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-PADJ-DA-COST-PCT(PV-INDX) =                           
               DBV-PADJ-DA-COST-AMT(PV-INDX) / CUM-PADJ-DA-COST-AMT             
              ADD DBV-PADJ-DA-COST-PCT(PV-INDX)                                 
               TO CUM-PADJ-DA-COST-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DA-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-DA-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE DBV-PADJ-DA-RTL-PCT(PV-INDX) =                            
               DBV-PADJ-DA-RTL-AMT(PV-INDX) / CUM-PADJ-DA-RTL-AMT               
              ADD DBV-PADJ-DA-RTL-PCT(PV-INDX)                                  
               TO CUM-PADJ-DA-RTL-PCT                                           
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-NET-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-NET-COST-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-PADJ-NET-COST-PCT(PV-INDX) =                          
               DBV-PADJ-NET-COST-AMT(PV-INDX) / CUM-PADJ-NET-COST-AMT           
              ADD DBV-PADJ-NET-COST-PCT(PV-INDX)                                
               TO CUM-PADJ-NET-COST-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-OTH-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-OTH-COST-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-PADJ-OTH-COST-PCT(PV-INDX) =                          
               DBV-PADJ-OTH-COST-AMT(PV-INDX) / CUM-PADJ-OTH-COST-AMT           
              ADD DBV-PADJ-OTH-COST-PCT(PV-INDX)                                
               TO CUM-PADJ-OTH-COST-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-OTH-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-OTH-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE DBV-PADJ-OTH-RTL-PCT(PV-INDX) =                           
               DBV-PADJ-OTH-RTL-AMT(PV-INDX) / CUM-PADJ-OTH-RTL-AMT             
              ADD DBV-PADJ-OTH-RTL-PCT(PV-INDX)                                 
               TO CUM-PADJ-OTH-RTL-PCT                                          
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-GRO-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-PADJ-GRO-COST-AMT NOT EQUAL ZERO                            
              COMPUTE DBV-PADJ-GRO-COST-PCT(PV-INDX) =                          
               DBV-PADJ-GRO-COST-AMT(PV-INDX) / CUM-PADJ-GRO-COST-AMT           
              ADD DBV-PADJ-GRO-COST-PCT(PV-INDX)                                
               TO CUM-PADJ-GRO-COST-PCT                                         
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-DR-ALW-RTL-AMT-IDX EQUAL PV-INDX                              
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-DR-ALW-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE DBV-DR-ALW-RTL-PCT(PV-INDX) =                             
               DBV-DR-ALW-RTL-AMT(PV-INDX) / CUM-DR-ALW-RTL-AMT                 
              ADD DBV-DR-ALW-RTL-PCT(PV-INDX)                                   
               TO CUM-DR-ALW-RTL-PCT                                            
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-RTV-RTL-AMT-IDX EQUAL PV-INDX                                 
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-RTV-RTL-AMT NOT EQUAL ZERO                                  
              COMPUTE DBV-RTV-RTL-PCT(PV-INDX) =                                
               DBV-RTV-RTL-AMT(PV-INDX) / CUM-RTV-RTL-AMT                       
              ADD DBV-RTV-RTL-PCT(PV-INDX)                                      
               TO CUM-RTV-RTL-PCT                                               
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-INIT-AMT-IDX EQUAL PV-INDX                               
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKUP-INIT-AMT NOT EQUAL ZERO                                
              COMPUTE DBV-MKUP-INIT-PCT(PV-INDX) =                              
               DBV-MKUP-INIT-AMT(PV-INDX) / CUM-MKUP-INIT-AMT                   
              ADD DBV-MKUP-INIT-PCT(PV-INDX)                                    
               TO CUM-MKUP-INIT-PCT                                             
             END-IF                                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-NET-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
             IF CUM-MKUP-NET-AMT NOT EQUAL ZERO                                 
              COMPUTE DBV-MKUP-NET-PCT(PV-INDX) =                               
               DBV-MKUP-NET-AMT(PV-INDX) / CUM-MKUP-NET-AMT                     
              ADD DBV-MKUP-NET-PCT(PV-INDX)                                     
               TO CUM-MKUP-NET-PCT                                              
             END-IF                                                             
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  PROCESS TO CALC THE PERCENTAGES OF THE LARGEST KNOWN AMOUNTS           
      ******************************************************************        
       2300-MAX-PERCENTAGES.                                                    
                                                                                
           IF BIG-SLS-REG-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-SLS-REG-RTL-PCT(BIG-SLS-REG-RTL-AMT-IDX) =               
                   1 - CUM-SLS-REG-RTL-PCT                                      
           END-IF                                                               
                                                                                
           IF BIG-SLS-PROMO-RTL-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-SLS-PROMO-RTL-PCT(BIG-SLS-PROMO-RTL-AMT-IDX) =           
                   1 - CUM-SLS-PROMO-RTL-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-SLS-PROCLR-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-SLS-PROCLR-RTL-PCT(BIG-SLS-PROCLR-RTL-AMT-IDX) =         
                   1 - CUM-SLS-PROCLR-RTL-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-SLS-CLR-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-SLS-CLR-RTL-PCT(BIG-SLS-CLR-RTL-AMT-IDX) =               
                   1 - CUM-SLS-CLR-RTL-PCT                                      
           END-IF                                                               
                                                                                
           IF BIG-SLS-OTH-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-SLS-OTH-RTL-PCT(BIG-SLS-OTH-RTL-AMT-IDX) =               
                   1 - CUM-SLS-OTH-RTL-PCT                                      
           END-IF                                                               
                                                                                
           IF BIG-MKDN-PLU-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-PLU-RTL-PCT(BIG-MKDN-PLU-RTL-AMT-IDX) =             
                   1 - CUM-MKDN-PLU-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-MKDN-PROMO-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-MKDN-PROMO-RTL-PCT(BIG-MKDN-PROMO-RTL-AMT-IDX) =         
                   1 - CUM-MKDN-PROMO-RTL-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-MKDN-GLDST-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-MKDN-GLDST-RTL-PCT(BIG-MKDN-GLDST-RTL-AMT-IDX) =         
                   1 - CUM-MKDN-GLDST-RTL-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-MKDN-UMTCH-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-MKDN-UMTCH-RTL-PCT(BIG-MKDN-UMTCH-RTL-AMT-IDX) =         
                   1 - CUM-MKDN-UMTCH-RTL-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-MKDN-BYR-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-BYR-RTL-PCT(BIG-MKDN-BYR-RTL-AMT-IDX) =             
                   1 - CUM-MKDN-BYR-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-MKDN-STR-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-STR-RTL-PCT(BIG-MKDN-STR-RTL-AMT-IDX) =             
                   1 - CUM-MKDN-STR-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-MKDN-PRPT-RTL-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-MKDN-PRPT-RTL-PCT(BIG-MKDN-PRPT-RTL-AMT-IDX) =           
                   1 - CUM-MKDN-PRPT-RTL-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-MKDN-OTH-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-OTH-RTL-PCT(BIG-MKDN-OTH-RTL-AMT-IDX) =             
                   1 - CUM-MKDN-OTH-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-MKDN-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-MKDN-RTL-PCT(BIG-MKDN-RTL-AMT-IDX) =                     
                   1 - CUM-MKDN-RTL-PCT                                         
           END-IF                                                               
                                                                                
           IF BIG-MKUP-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-MKUP-RTL-PCT(BIG-MKUP-RTL-AMT-IDX) =                     
                   1 - CUM-MKUP-RTL-PCT                                         
           END-IF                                                               
                                                                                
           IF BIG-XFER-IN-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-XFER-IN-RTL-PCT(BIG-XFER-IN-RTL-AMT-IDX) =               
                   1 - CUM-XFER-IN-RTL-PCT                                      
           END-IF                                                               
                                                                                
           IF BIG-XFER-OUT-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-XFER-OUT-RTL-PCT(BIG-XFER-OUT-RTL-AMT-IDX) =             
                   1 - CUM-XFER-OUT-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-RCPT-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-RCPT-RTL-PCT(BIG-RCPT-RTL-AMT-IDX) =                     
                   1 - CUM-RCPT-RTL-PCT                                         
           END-IF                                                               
                                                                                
           IF BIG-RCPT-NET-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-RCPT-NET-COST-PCT(BIG-RCPT-NET-COST-AMT-IDX) =           
                   1 - CUM-RCPT-NET-COST-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-RCPT-GRO-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-RCPT-GRO-COST-PCT(BIG-RCPT-GRO-COST-AMT-IDX) =           
                   1 - CUM-RCPT-GRO-COST-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-RCPT-FRGT-COST-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-RCPT-FRGT-COST-PCT(BIG-RCPT-FRGT-COST-AMT-IDX) =         
                   1 - CUM-RCPT-FRGT-COST-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-PADJ-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-PADJ-RTL-PCT(BIG-PADJ-RTL-AMT-IDX) =                     
                   1 - CUM-PADJ-RTL-PCT                                         
           END-IF                                                               
                                                                                
           IF BIG-PADJ-FRGT-COST-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-PADJ-FRGT-COST-PCT(BIG-PADJ-FRGT-COST-AMT-IDX) =         
                   1 - CUM-PADJ-FRGT-COST-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-PADJ-DISC-COST-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-PADJ-DISC-COST-PCT(BIG-PADJ-DISC-COST-AMT-IDX) =         
                   1 - CUM-PADJ-DISC-COST-PCT                                   
           END-IF                                                               
                                                                                
           IF BIG-PADJ-RTV-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-RTV-COST-PCT(BIG-PADJ-RTV-COST-AMT-IDX) =           
                   1 - CUM-PADJ-RTV-COST-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-PADJ-RTV-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-PADJ-RTV-RTL-PCT(BIG-PADJ-RTV-RTL-AMT-IDX) =             
                   1 - CUM-PADJ-RTV-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-PADJ-DA-COST-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-PADJ-DA-COST-PCT(BIG-PADJ-DA-COST-AMT-IDX) =             
                   1 - CUM-PADJ-DA-COST-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-PADJ-DA-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-PADJ-DA-RTL-PCT(BIG-PADJ-DA-RTL-AMT-IDX) =               
                   1 - CUM-PADJ-DA-RTL-PCT                                      
           END-IF                                                               
                                                                                
           IF BIG-PADJ-NET-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-NET-COST-PCT(BIG-PADJ-NET-COST-AMT-IDX) =           
                   1 - CUM-PADJ-NET-COST-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-PADJ-OTH-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-OTH-COST-PCT(BIG-PADJ-OTH-COST-AMT-IDX) =           
                   1 - CUM-PADJ-OTH-COST-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-PADJ-OTH-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-PADJ-OTH-RTL-PCT(BIG-PADJ-OTH-RTL-AMT-IDX) =             
                   1 - CUM-PADJ-OTH-RTL-PCT                                     
           END-IF                                                               
                                                                                
           IF BIG-PADJ-GRO-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-GRO-COST-PCT(BIG-PADJ-GRO-COST-AMT-IDX) =           
                   1 - CUM-PADJ-GRO-COST-PCT                                    
           END-IF                                                               
                                                                                
           IF BIG-DR-ALW-RTL-AMT-IDX NOT EQUAL ZERO                             
           COMPUTE DBV-DR-ALW-RTL-PCT(BIG-DR-ALW-RTL-AMT-IDX) =                 
                   1 - CUM-DR-ALW-RTL-PCT                                       
           END-IF                                                               
                                                                                
           IF BIG-RTV-RTL-AMT-IDX NOT EQUAL ZERO                                
           COMPUTE DBV-RTV-RTL-PCT(BIG-RTV-RTL-AMT-IDX) =                       
                   1 - CUM-RTV-RTL-PCT                                          
           END-IF                                                               
                                                                                
           IF BIG-MKUP-INIT-AMT-IDX NOT EQUAL ZERO                              
           COMPUTE DBV-MKUP-INIT-PCT(BIG-MKUP-INIT-AMT-IDX) =                   
                   1 - CUM-MKUP-INIT-PCT                                        
           END-IF                                                               
                                                                                
           IF BIG-MKUP-NET-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-MKUP-NET-PCT(BIG-MKUP-NET-AMT-IDX) =                     
                   1 - CUM-MKUP-NET-PCT                                         
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  PROCESS TO CALC AMOUNT OF UNKNOWN TO BE PRORATED AMONG KNOWN           
      *  AMOUNTS.                                                               
      ******************************************************************        
       2400-PROCESS-MONEY-AMOUNTS.                                              
                                                                                
           ADD +1 TO PV-INDX.                                                   
                                                                                
           IF BIG-SLS-REG-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-SLS-REG-RTL-UNK(PV-INDX) =                            
                 DBV-SLS-REG-RTL-PCT(PV-INDX) * UNKWN-SLS-REG-RTL-AMT           
              ADD DBV-SLS-REG-RTL-UNK(PV-INDX)                                  
               TO CUM-SLS-REG-RTL-UNK                                           
           END-IF                                                               
                                                                                
           IF BIG-SLS-PROMO-RTL-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-SLS-PROMO-RTL-UNK(PV-INDX) =                          
               DBV-SLS-PROMO-RTL-PCT(PV-INDX) * UNKWN-SLS-PROMO-RTL-AMT         
              ADD DBV-SLS-PROMO-RTL-UNK(PV-INDX)                                
               TO CUM-SLS-PROMO-RTL-UNK                                         
           END-IF                                                               
                                                                                
           IF BIG-SLS-PROCLR-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-SLS-PROCLR-RTL-UNK(PV-INDX) =                         
              DBV-SLS-PROCLR-RTL-PCT(PV-INDX) * UNKWN-SLS-PROCLR-RTL-AMT        
              ADD DBV-SLS-PROCLR-RTL-UNK(PV-INDX)                               
               TO CUM-SLS-PROCLR-RTL-UNK                                        
           END-IF.                                                              
                                                                                
           IF BIG-SLS-CLR-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-SLS-CLR-RTL-UNK(PV-INDX) =                            
              DBV-SLS-CLR-RTL-PCT(PV-INDX) * UNKWN-SLS-CLR-RTL-AMT              
              ADD DBV-SLS-CLR-RTL-UNK(PV-INDX)                                  
               TO CUM-SLS-CLR-RTL-UNK                                           
           END-IF.                                                              
                                                                                
           IF BIG-SLS-OTH-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-SLS-OTH-RTL-UNK(PV-INDX) =                            
                 DBV-SLS-OTH-RTL-PCT(PV-INDX) * UNKWN-SLS-OTH-RTL-AMT           
              ADD DBV-SLS-OTH-RTL-UNK(PV-INDX)                                  
               TO CUM-SLS-OTH-RTL-UNK                                           
           END-IF                                                               
                                                                                
           IF BIG-MKDN-PLU-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-PLU-RTL-UNK(PV-INDX) =                           
               DBV-MKDN-PLU-RTL-PCT(PV-INDX) * UNKWN-MKDN-PLU-RTL-AMT           
              ADD DBV-MKDN-PLU-RTL-UNK(PV-INDX)                                 
               TO CUM-MKDN-PLU-RTL-UNK                                          
           END-IF                                                               
                                                                                
           IF BIG-MKDN-PROMO-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-PROMO-RTL-UNK(PV-INDX) =                         
              DBV-MKDN-PROMO-RTL-PCT(PV-INDX) * UNKWN-MKDN-PROMO-RTL-AMT        
              ADD DBV-MKDN-PROMO-RTL-UNK(PV-INDX)                               
               TO CUM-MKDN-PROMO-RTL-UNK                                        
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-RGST-RTL-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-RGST-RTL-UNK(PV-INDX) =                          
              DBV-MKDN-RGST-RTL-PCT(PV-INDX) * UNKWN-MKDN-RGST-RTL-AMT          
              ADD DBV-MKDN-RGST-RTL-UNK(PV-INDX)                                
               TO CUM-MKDN-RGST-RTL-UNK                                         
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-GLDST-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-GLDST-RTL-UNK(PV-INDX) =                         
              DBV-MKDN-GLDST-RTL-PCT(PV-INDX) * UNKWN-MKDN-GLDST-RTL-AMT        
              ADD DBV-MKDN-GLDST-RTL-UNK(PV-INDX)                               
               TO CUM-MKDN-GLDST-RTL-UNK                                        
           END-IF                                                               
                                                                                
           IF BIG-MKDN-UMTCH-RTL-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-UMTCH-RTL-UNK(PV-INDX) =                         
              DBV-MKDN-UMTCH-RTL-PCT(PV-INDX) * UNKWN-MKDN-UMTCH-RTL-AMT        
              ADD DBV-MKDN-UMTCH-RTL-UNK(PV-INDX)                               
               TO CUM-MKDN-UMTCH-RTL-UNK                                        
           END-IF                                                               
                                                                                
           IF BIG-MKDN-BYR-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-BYR-RTL-UNK(PV-INDX) =                           
              DBV-MKDN-BYR-RTL-PCT(PV-INDX) * UNKWN-MKDN-BYR-RTL-AMT            
              ADD DBV-MKDN-BYR-RTL-UNK(PV-INDX)                                 
               TO CUM-MKDN-BYR-RTL-UNK                                          
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-STR-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-STR-RTL-UNK(PV-INDX) =                           
              DBV-MKDN-STR-RTL-PCT(PV-INDX) * UNKWN-MKDN-STR-RTL-AMT            
              ADD DBV-MKDN-STR-RTL-UNK(PV-INDX)                                 
               TO CUM-MKDN-STR-RTL-UNK                                          
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PRPT-RTL-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-PRPT-RTL-UNK(PV-INDX) =                          
                DBV-MKDN-PRPT-RTL-PCT(PV-INDX) * UNKWN-MKDN-PRPT-RTL-AMT        
              ADD DBV-MKDN-PRPT-RTL-UNK(PV-INDX)                                
               TO CUM-MKDN-PRPT-RTL-UNK                                         
           END-IF                                                               
                                                                                
           IF BIG-MKDN-OTH-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-OTH-RTL-UNK(PV-INDX) =                           
               DBV-MKDN-OTH-RTL-PCT(PV-INDX) * UNKWN-MKDN-OTH-RTL-AMT           
              ADD DBV-MKDN-OTH-RTL-UNK(PV-INDX)                                 
               TO CUM-MKDN-OTH-RTL-UNK                                          
           END-IF                                                               
                                                                                
           IF BIG-MKDN-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKDN-RTL-UNK(PV-INDX) =                               
              DBV-MKDN-RTL-PCT(PV-INDX) * UNKWN-MKDN-RTL-AMT                    
              ADD DBV-MKDN-RTL-UNK(PV-INDX)                                     
               TO CUM-MKDN-RTL-UNK                                              
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKUP-RTL-UNK(PV-INDX) =                               
              DBV-MKUP-RTL-PCT(PV-INDX) * UNKWN-MKUP-RTL-AMT                    
              ADD DBV-MKUP-RTL-UNK(PV-INDX)                                     
               TO CUM-MKUP-RTL-UNK                                              
           END-IF.                                                              
                                                                                
           IF BIG-XFER-IN-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-XFER-IN-RTL-UNK(PV-INDX) =                            
                 DBV-XFER-IN-RTL-PCT(PV-INDX) * UNKWN-XFER-IN-RTL-AMT           
              ADD DBV-XFER-IN-RTL-UNK(PV-INDX)                                  
               TO CUM-XFER-IN-RTL-UNK                                           
           END-IF                                                               
                                                                                
           IF BIG-XFER-OUT-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-XFER-OUT-RTL-UNK(PV-INDX) =                           
               DBV-XFER-OUT-RTL-PCT(PV-INDX) * UNKWN-XFER-OUT-RTL-AMT           
              ADD DBV-XFER-OUT-RTL-UNK(PV-INDX)                                 
               TO CUM-XFER-OUT-RTL-UNK                                          
           END-IF                                                               
                                                                                
           IF BIG-RCPT-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-RCPT-RTL-UNK(PV-INDX) =                               
              DBV-RCPT-RTL-PCT(PV-INDX) * UNKWN-RCPT-RTL-AMT                    
              ADD DBV-RCPT-RTL-UNK(PV-INDX)                                     
               TO CUM-RCPT-RTL-UNK                                              
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-NET-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-RCPT-NET-COST-UNK(PV-INDX) =                          
              DBV-RCPT-NET-COST-PCT(PV-INDX) * UNKWN-RCPT-NET-COST-AMT          
              ADD DBV-RCPT-NET-COST-UNK(PV-INDX)                                
               TO CUM-RCPT-NET-COST-UNK                                         
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-GRO-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-RCPT-GRO-COST-UNK(PV-INDX) =                          
                DBV-RCPT-GRO-COST-PCT(PV-INDX) * UNKWN-RCPT-GRO-COST-AMT        
              ADD DBV-RCPT-GRO-COST-UNK(PV-INDX)                                
               TO CUM-RCPT-GRO-COST-UNK                                         
           END-IF                                                               
                                                                                
           IF BIG-RCPT-FRGT-COST-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-RCPT-FRGT-COST-UNK(PV-INDX) =                         
              DBV-RCPT-FRGT-COST-PCT(PV-INDX) * UNKWN-RCPT-FRGT-COST-AMT        
              ADD DBV-RCPT-FRGT-COST-UNK(PV-INDX)                               
               TO CUM-RCPT-FRGT-COST-UNK                                        
           END-IF                                                               
                                                                                
           IF BIG-PADJ-RTL-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-RTL-UNK(PV-INDX) =                               
              DBV-PADJ-RTL-PCT(PV-INDX) * UNKWN-PADJ-RTL-AMT                    
              ADD DBV-PADJ-RTL-UNK(PV-INDX)                                     
               TO CUM-PADJ-RTL-UNK                                              
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-FRGT-COST-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-FRGT-COST-UNK(PV-INDX) =                         
              DBV-PADJ-FRGT-COST-PCT(PV-INDX) * UNKWN-PADJ-FRGT-COST-AMT        
              ADD DBV-PADJ-FRGT-COST-UNK(PV-INDX)                               
               TO CUM-PADJ-FRGT-COST-UNK                                        
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DISC-COST-AMT-IDX EQUAL PV-INDX                          
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-DISC-COST-UNK(PV-INDX) =                         
              DBV-PADJ-DISC-COST-PCT(PV-INDX) * UNKWN-PADJ-DISC-COST-AMT        
              ADD DBV-PADJ-DISC-COST-UNK(PV-INDX)                               
               TO CUM-PADJ-DISC-COST-UNK                                        
           END-IF                                                               
                                                                                
           IF BIG-PADJ-RTV-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-RTV-COST-UNK(PV-INDX) =                          
               DBV-PADJ-RTV-COST-PCT(PV-INDX) * UNKWN-PADJ-RTV-COST-AMT         
              ADD DBV-PADJ-RTV-COST-UNK(PV-INDX)                                
               TO CUM-PADJ-RTV-COST-UNK                                         
           END-IF                                                               
                                                                                
           IF BIG-PADJ-RTV-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-RTV-RTL-UNK(PV-INDX) =                           
              DBV-PADJ-RTV-RTL-PCT(PV-INDX) * UNKWN-PADJ-RTV-RTL-AMT            
              ADD DBV-PADJ-RTV-RTL-UNK(PV-INDX)                                 
               TO CUM-PADJ-RTV-RTL-UNK                                          
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DA-COST-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-DA-COST-UNK(PV-INDX) =                           
              DBV-PADJ-DA-COST-PCT(PV-INDX) * UNKWN-PADJ-DA-COST-AMT            
              ADD DBV-PADJ-DA-COST-UNK(PV-INDX)                                 
               TO CUM-PADJ-DA-COST-UNK                                          
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DA-RTL-AMT-IDX EQUAL PV-INDX                             
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-DA-RTL-UNK(PV-INDX) =                            
                 DBV-PADJ-DA-RTL-PCT(PV-INDX) * UNKWN-PADJ-DA-RTL-AMT           
              ADD DBV-PADJ-DA-RTL-UNK(PV-INDX)                                  
               TO CUM-PADJ-DA-RTL-UNK                                           
           END-IF                                                               
                                                                                
           IF BIG-PADJ-NET-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-NET-COST-UNK(PV-INDX) =                          
               DBV-PADJ-NET-COST-PCT(PV-INDX) * UNKWN-PADJ-NET-COST-AMT         
              ADD DBV-PADJ-NET-COST-UNK(PV-INDX)                                
               TO CUM-PADJ-NET-COST-UNK                                         
           END-IF                                                               
                                                                                
           IF BIG-PADJ-OTH-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-OTH-COST-UNK(PV-INDX) =                          
              DBV-PADJ-OTH-COST-PCT(PV-INDX) * UNKWN-PADJ-OTH-COST-AMT          
              ADD DBV-PADJ-OTH-COST-UNK(PV-INDX)                                
               TO CUM-PADJ-OTH-COST-UNK                                         
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-OTH-RTL-AMT-IDX EQUAL PV-INDX                            
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-OTH-RTL-UNK(PV-INDX) =                           
              DBV-PADJ-OTH-RTL-PCT(PV-INDX) * UNKWN-PADJ-OTH-RTL-AMT            
              ADD DBV-PADJ-OTH-RTL-UNK(PV-INDX)                                 
               TO CUM-PADJ-OTH-RTL-UNK                                          
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-GRO-COST-AMT-IDX EQUAL PV-INDX                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-PADJ-GRO-COST-UNK(PV-INDX) =                          
                DBV-PADJ-GRO-COST-PCT(PV-INDX) * UNKWN-PADJ-GRO-COST-AMT        
              ADD DBV-PADJ-GRO-COST-UNK(PV-INDX)                                
               TO CUM-PADJ-GRO-COST-UNK                                         
           END-IF                                                               
                                                                                
           IF BIG-DR-ALW-RTL-AMT-IDX EQUAL PV-INDX                              
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-DR-ALW-RTL-UNK(PV-INDX) =                             
               DBV-DR-ALW-RTL-PCT(PV-INDX) * UNKWN-DR-ALW-RTL-AMT               
              ADD DBV-DR-ALW-RTL-UNK(PV-INDX)                                   
               TO CUM-DR-ALW-RTL-UNK                                            
           END-IF                                                               
                                                                                
           IF BIG-RTV-RTL-AMT-IDX EQUAL PV-INDX                                 
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-RTV-RTL-UNK(PV-INDX) =                                
              DBV-RTV-RTL-PCT(PV-INDX) * UNKWN-RTV-RTL-AMT                      
              ADD DBV-RTV-RTL-UNK(PV-INDX)                                      
               TO CUM-RTV-RTL-UNK                                               
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-INIT-AMT-IDX EQUAL PV-INDX                               
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKUP-INIT-UNK(PV-INDX) =                              
              DBV-MKUP-INIT-PCT(PV-INDX) * UNKWN-MKUP-INIT-AMT                  
              ADD DBV-MKUP-INIT-UNK(PV-INDX)                                    
               TO CUM-MKUP-INIT-UNK                                             
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-NET-AMT-IDX EQUAL PV-INDX                                
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE DBV-MKUP-NET-UNK(PV-INDX) =                               
              DBV-MKUP-NET-PCT(PV-INDX) * UNKWN-MKUP-NET-AMT                    
              ADD DBV-MKUP-NET-UNK(PV-INDX)                                     
               TO CUM-MKUP-NET-UNK                                              
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  PROCESS TO CALC AMOUNT OF UNKNOWN TO BE PRORATED TO THE                
      *  LARGEST KNOWN AMOUNT.                                                  
      ******************************************************************        
       2500-MAX-MONEY-AMTS.                                                     
                                                                                
           IF BIG-SLS-REG-RTL-AMT-IDX      NOT EQUAL ZERO                       
           COMPUTE DBV-SLS-REG-RTL-UNK(BIG-SLS-REG-RTL-AMT-IDX) =               
             UNKWN-SLS-REG-RTL-AMT - CUM-SLS-REG-RTL-UNK                        
           END-IF.                                                              
                                                                                
           IF BIG-SLS-PROMO-RTL-AMT-IDX    NOT EQUAL ZERO                       
           COMPUTE DBV-SLS-PROMO-RTL-UNK(BIG-SLS-PROMO-RTL-AMT-IDX) =           
             UNKWN-SLS-PROMO-RTL-AMT - CUM-SLS-PROMO-RTL-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-SLS-PROCLR-RTL-AMT-IDX   NOT EQUAL ZERO                       
           COMPUTE DBV-SLS-PROCLR-RTL-UNK(BIG-SLS-PROCLR-RTL-AMT-IDX) =         
             UNKWN-SLS-PROCLR-RTL-AMT - CUM-SLS-PROCLR-RTL-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-SLS-CLR-RTL-AMT-IDX   NOT EQUAL ZERO                          
           COMPUTE DBV-SLS-CLR-RTL-UNK(BIG-SLS-CLR-RTL-AMT-IDX) =               
             UNKWN-SLS-CLR-RTL-AMT - CUM-SLS-CLR-RTL-UNK                        
           END-IF.                                                              
                                                                                
           IF BIG-SLS-OTH-RTL-AMT-IDX   NOT EQUAL ZERO                          
           COMPUTE DBV-SLS-OTH-RTL-UNK(BIG-SLS-OTH-RTL-AMT-IDX) =               
             UNKWN-SLS-OTH-RTL-AMT - CUM-SLS-OTH-RTL-UNK                        
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PLU-RTL-AMT-IDX  NOT EQUAL ZERO                          
           COMPUTE DBV-MKDN-PLU-RTL-UNK(BIG-MKDN-PLU-RTL-AMT-IDX) =             
             UNKWN-MKDN-PLU-RTL-AMT - CUM-MKDN-PLU-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PROMO-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-MKDN-PROMO-RTL-UNK(BIG-MKDN-PROMO-RTL-AMT-IDX) =         
             UNKWN-MKDN-PROMO-RTL-AMT - CUM-MKDN-PROMO-RTL-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-RGST-RTL-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-MKDN-RGST-RTL-UNK(BIG-MKDN-RGST-RTL-AMT-IDX) =           
             UNKWN-MKDN-RGST-RTL-AMT - CUM-MKDN-RGST-RTL-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-GLDST-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-MKDN-GLDST-RTL-UNK(BIG-MKDN-GLDST-RTL-AMT-IDX) =         
             UNKWN-MKDN-GLDST-RTL-AMT - CUM-MKDN-GLDST-RTL-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-UMTCH-RTL-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-MKDN-UMTCH-RTL-UNK(BIG-MKDN-UMTCH-RTL-AMT-IDX) =         
             UNKWN-MKDN-UMTCH-RTL-AMT - CUM-MKDN-UMTCH-RTL-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-BYR-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-BYR-RTL-UNK(BIG-MKDN-BYR-RTL-AMT-IDX) =             
             UNKWN-MKDN-BYR-RTL-AMT - CUM-MKDN-BYR-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-STR-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-STR-RTL-UNK(BIG-MKDN-STR-RTL-AMT-IDX) =             
             UNKWN-MKDN-STR-RTL-AMT - CUM-MKDN-STR-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-PRPT-RTL-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-MKDN-PRPT-RTL-UNK(BIG-MKDN-PRPT-RTL-AMT-IDX) =           
             UNKWN-MKDN-PRPT-RTL-AMT - CUM-MKDN-PRPT-RTL-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-OTH-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-MKDN-OTH-RTL-UNK(BIG-MKDN-OTH-RTL-AMT-IDX) =             
             UNKWN-MKDN-OTH-RTL-AMT - CUM-MKDN-OTH-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-MKDN-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-MKDN-RTL-UNK(BIG-MKDN-RTL-AMT-IDX) =                     
             UNKWN-MKDN-RTL-AMT - CUM-MKDN-RTL-UNK                              
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-MKUP-RTL-UNK(BIG-MKUP-RTL-AMT-IDX) =                     
             UNKWN-MKUP-RTL-AMT - CUM-MKUP-RTL-UNK                              
           END-IF.                                                              
                                                                                
           IF BIG-XFER-IN-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-XFER-IN-RTL-UNK(BIG-XFER-IN-RTL-AMT-IDX) =               
             UNKWN-XFER-IN-RTL-AMT - CUM-XFER-IN-RTL-UNK                        
           END-IF.                                                              
                                                                                
           IF BIG-XFER-OUT-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-XFER-OUT-RTL-UNK(BIG-XFER-OUT-RTL-AMT-IDX) =             
             UNKWN-XFER-OUT-RTL-AMT - CUM-XFER-OUT-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-RCPT-RTL-UNK(BIG-RCPT-RTL-AMT-IDX) =                     
             UNKWN-RCPT-RTL-AMT - CUM-RCPT-RTL-UNK                              
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-NET-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-RCPT-NET-COST-UNK(BIG-RCPT-NET-COST-AMT-IDX) =           
             UNKWN-RCPT-NET-COST-AMT - CUM-RCPT-NET-COST-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-GRO-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-RCPT-GRO-COST-UNK(BIG-RCPT-GRO-COST-AMT-IDX) =           
             UNKWN-RCPT-GRO-COST-AMT - CUM-RCPT-GRO-COST-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-RCPT-FRGT-COST-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-RCPT-FRGT-COST-UNK(BIG-RCPT-FRGT-COST-AMT-IDX) =         
             UNKWN-RCPT-FRGT-COST-AMT - CUM-RCPT-FRGT-COST-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-RTL-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-PADJ-RTL-UNK(BIG-PADJ-RTL-AMT-IDX) =                     
             UNKWN-PADJ-RTL-AMT - CUM-PADJ-RTL-UNK                              
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-FRGT-COST-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-PADJ-FRGT-COST-UNK(BIG-PADJ-FRGT-COST-AMT-IDX) =         
             UNKWN-PADJ-FRGT-COST-AMT - CUM-PADJ-FRGT-COST-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DISC-COST-AMT-IDX NOT EQUAL ZERO                         
           COMPUTE DBV-PADJ-DISC-COST-UNK(BIG-PADJ-DISC-COST-AMT-IDX) =         
             UNKWN-PADJ-DISC-COST-AMT - CUM-PADJ-DISC-COST-UNK                  
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-RTV-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-RTV-COST-UNK(BIG-PADJ-RTV-COST-AMT-IDX) =           
             UNKWN-PADJ-RTV-COST-AMT - CUM-PADJ-RTV-COST-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-RTV-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-PADJ-RTV-RTL-UNK(BIG-PADJ-RTV-RTL-AMT-IDX) =             
             UNKWN-PADJ-RTV-RTL-AMT - CUM-PADJ-RTV-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DA-COST-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-PADJ-DA-COST-UNK(BIG-PADJ-DA-COST-AMT-IDX) =             
             UNKWN-PADJ-DA-COST-AMT - CUM-PADJ-DA-COST-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-DA-RTL-AMT-IDX NOT EQUAL ZERO                            
           COMPUTE DBV-PADJ-DA-RTL-UNK(BIG-PADJ-DA-RTL-AMT-IDX) =               
             UNKWN-PADJ-DA-RTL-AMT - CUM-PADJ-DA-RTL-UNK                        
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-NET-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-NET-COST-UNK(BIG-PADJ-NET-COST-AMT-IDX) =           
             UNKWN-PADJ-NET-COST-AMT - CUM-PADJ-NET-COST-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-OTH-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-OTH-COST-UNK(BIG-PADJ-OTH-COST-AMT-IDX) =           
             UNKWN-PADJ-OTH-COST-AMT - CUM-PADJ-OTH-COST-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-OTH-RTL-AMT-IDX NOT EQUAL ZERO                           
           COMPUTE DBV-PADJ-OTH-RTL-UNK(BIG-PADJ-OTH-RTL-AMT-IDX) =             
             UNKWN-PADJ-OTH-RTL-AMT - CUM-PADJ-OTH-RTL-UNK                      
           END-IF.                                                              
                                                                                
           IF BIG-PADJ-GRO-COST-AMT-IDX NOT EQUAL ZERO                          
           COMPUTE DBV-PADJ-GRO-COST-UNK(BIG-PADJ-GRO-COST-AMT-IDX) =           
             UNKWN-PADJ-GRO-COST-AMT - CUM-PADJ-GRO-COST-UNK                    
           END-IF.                                                              
                                                                                
           IF BIG-DR-ALW-RTL-AMT-IDX NOT EQUAL ZERO                             
           COMPUTE DBV-DR-ALW-RTL-UNK(BIG-DR-ALW-RTL-AMT-IDX) =                 
             UNKWN-DR-ALW-RTL-AMT - CUM-DR-ALW-RTL-UNK                          
           END-IF.                                                              
                                                                                
           IF BIG-RTV-RTL-AMT-IDX NOT EQUAL ZERO                                
           COMPUTE DBV-RTV-RTL-UNK(BIG-RTV-RTL-AMT-IDX) =                       
             UNKWN-RTV-RTL-AMT - CUM-RTV-RTL-UNK                                
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-INIT-AMT-IDX NOT EQUAL ZERO                              
           COMPUTE DBV-MKUP-INIT-UNK(BIG-MKUP-INIT-AMT-IDX) =                   
             UNKWN-MKUP-INIT-AMT - CUM-MKUP-INIT-UNK                            
           END-IF.                                                              
                                                                                
           IF BIG-MKUP-NET-AMT-IDX NOT EQUAL ZERO                               
           COMPUTE DBV-MKUP-NET-UNK(BIG-MKUP-NET-AMT-IDX) =                     
             UNKWN-MKUP-NET-AMT - CUM-MKUP-NET-UNK                              
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * BUILD THE BEFORE PRORATION REPORT COLUMNS AT A KEY LEVEL.               
      ******************************************************************        
       4000-BUILD-REPORT-BEFORE.                                                
                                                                                
           INITIALIZE DL-KEY.                                                   
           INITIALIZE DL-VERBIAGE.                                              
                                                                                
           MOVE REPRT-DEPT-NBR      TO DL-DEPT-NBR.                             
           MOVE REPRT-SUB-CL-NBR    TO DL-SUB-CL-NBR.                           
           MOVE REPRT-LOC-NBR       TO DL-LOC-NBR.                              
           MOVE REPRT-TRN-TYP-CDE   TO DL-TRN-TYP-CDE.                          
           MOVE REPRT-ENT-ID        TO DL-ENT-ID-PURCHASE                       
                                       DL-ENT-ID-PRC-CHG                        
                                       DL-ENT-ID-SALES.                         
           MOVE REPRT-LBL-SEQ-NBR   TO DL-LBL-SEQ-NBR-PURCHASE                  
                                       DL-LBL-SEQ-NBR-PRC-CHG                   
                                       DL-LBL-SEQ-NBR-SALES.                    
           MOVE REPRT-ML-LWST-ID    TO DL-DKEY-PURCHASE                         
                                       DL-DKEY-PRC-CHG                          
                                       DL-DKEY-SALES.                           
           MOVE DL-KEY              TO DL-KEY-PURCHASE                          
                                       DL-KEY-PRC-CHG                           
                                       DL-KEY-SALES.                            
                                                                                
           MOVE REPRT-SLS-REG-RTL-AMT    TO DL-SLS-REG-RTL-AMT.                 
           MOVE REPRT-SLS-PROMO-RTL-AMT  TO DL-SLS-PROMO-RTL-AMT.               
           MOVE REPRT-SLS-PROCLR-RTL-AMT TO DL-SLS-PROCLR-RTL-AMT.              
           MOVE REPRT-SLS-CLR-RTL-AMT    TO DL-SLS-CLR-RTL-AMT.                 
           MOVE REPRT-SLS-OTH-RTL-AMT    TO DL-SLS-OTH-RTL-AMT.                 
           MOVE REPRT-MKDN-PLU-RTL-AMT   TO DL-MKDN-PLU-RTL-AMT.                
           MOVE REPRT-MKDN-PROMO-RTL-AMT TO DL-MKDN-PROMO-RTL-AMT.              
           MOVE REPRT-MKDN-RGST-RTL-AMT  TO DL-MKDN-RGST-RTL-AMT.               
           MOVE REPRT-MKDN-GLDST-RTL-AMT TO DL-MKDN-GLDST-RTL-AMT.              
           MOVE REPRT-MKDN-UMTCH-RTL-AMT TO DL-MKDN-UMTCH-RTL-AMT.              
           MOVE REPRT-MKDN-BYR-RTL-AMT   TO DL-MKDN-BYR-RTL-AMT.                
           MOVE REPRT-MKDN-STR-RTL-AMT   TO DL-MKDN-STR-RTL-AMT.                
           MOVE REPRT-MKDN-PRPT-RTL-AMT  TO DL-MKDN-PRPT-RTL-AMT.               
           MOVE REPRT-MKDN-OTH-RTL-AMT   TO DL-MKDN-OTH-RTL-AMT.                
           MOVE REPRT-MKDN-RTL-AMT       TO DL-MKDN-RTL-AMT.                    
           MOVE REPRT-MKUP-RTL-AMT       TO DL-MKUP-RTL-AMT.                    
           MOVE REPRT-MKUP-INIT-AMT      TO DL-MKUP-INIT-AMT.                   
           MOVE REPRT-MKUP-NET-AMT       TO DL-MKUP-NET-AMT.                    
           MOVE REPRT-XFER-IN-RTL-AMT    TO DL-XFER-IN-RTL-AMT.                 
           MOVE REPRT-XFER-OUT-RTL-AMT   TO DL-XFER-OUT-RTL-AMT.                
           MOVE REPRT-RCPT-RTL-AMT       TO DL-RCPT-RTL-AMT.                    
           MOVE REPRT-RCPT-NET-COST-AMT  TO DL-RCPT-NET-COST-AMT.               
           MOVE REPRT-RCPT-GRO-COST-AMT  TO DL-RCPT-GRO-COST-AMT.               
           MOVE REPRT-RCPT-FRGT-COST-AMT TO DL-RCPT-FRGT-COST-AMT.              
           MOVE REPRT-PADJ-RTL-AMT       TO DL-PADJ-RTL-AMT.                    
           MOVE REPRT-PADJ-FRGT-COST-AMT TO DL-PADJ-FRGT-COST-AMT.              
           MOVE REPRT-PADJ-DISC-COST-AMT TO DL-PADJ-DISC-COST-AMT.              
           MOVE REPRT-PADJ-RTV-COST-AMT  TO DL-PADJ-RTV-COST-AMT.               
           MOVE REPRT-PADJ-RTV-RTL-AMT   TO DL-PADJ-RTV-RTL-AMT.                
           MOVE REPRT-PADJ-DA-COST-AMT   TO DL-PADJ-DA-COST-AMT.                
           MOVE REPRT-PADJ-DA-RTL-AMT    TO DL-PADJ-DA-RTL-AMT.                 
           MOVE REPRT-PADJ-NET-COST-AMT  TO DL-PADJ-NET-COST-AMT.               
           MOVE REPRT-PADJ-OTH-COST-AMT  TO DL-PADJ-OTH-COST-AMT.               
           MOVE REPRT-PADJ-OTH-RTL-AMT   TO DL-PADJ-OTH-RTL-AMT.                
           MOVE REPRT-PADJ-GRO-COST-AMT  TO DL-PADJ-GRO-COST-AMT.               
           MOVE REPRT-DR-ALW-RTL-AMT     TO DL-DR-ALW-RTL-AMT.                  
           MOVE REPRT-RTV-RTL-AMT        TO DL-RTV-RTL-AMT.                     
                                                                                
           PERFORM 5000-PRINT-DETAIL-LINE.                                      
                                                                                
           ADD REPRT-SLS-REG-RTL-AMT    TO PV-SLS-REG-RTL-AMT.                  
           ADD REPRT-SLS-PROMO-RTL-AMT  TO PV-SLS-PROMO-RTL-AMT.                
           ADD REPRT-SLS-PROCLR-RTL-AMT TO PV-SLS-PROCLR-RTL-AMT.               
           ADD REPRT-SLS-CLR-RTL-AMT    TO PV-SLS-CLR-RTL-AMT.                  
           ADD REPRT-SLS-OTH-RTL-AMT    TO PV-SLS-OTH-RTL-AMT.                  
           ADD REPRT-MKDN-PLU-RTL-AMT   TO PV-MKDN-PLU-RTL-AMT.                 
           ADD REPRT-MKDN-PROMO-RTL-AMT TO PV-MKDN-PROMO-RTL-AMT.               
           ADD REPRT-MKDN-RGST-RTL-AMT  TO PV-MKDN-RGST-RTL-AMT.                
           ADD REPRT-MKDN-GLDST-RTL-AMT TO PV-MKDN-GLDST-RTL-AMT.               
           ADD REPRT-MKDN-UMTCH-RTL-AMT TO PV-MKDN-UMTCH-RTL-AMT.               
           ADD REPRT-MKDN-BYR-RTL-AMT   TO PV-MKDN-BYR-RTL-AMT.                 
           ADD REPRT-MKDN-STR-RTL-AMT   TO PV-MKDN-STR-RTL-AMT.                 
           ADD REPRT-MKDN-PRPT-RTL-AMT  TO PV-MKDN-PRPT-RTL-AMT.                
           ADD REPRT-MKDN-OTH-RTL-AMT   TO PV-MKDN-OTH-RTL-AMT.                 
           ADD REPRT-MKDN-RTL-AMT       TO PV-MKDN-RTL-AMT.                     
           ADD REPRT-MKUP-RTL-AMT       TO PV-MKUP-RTL-AMT.                     
           ADD REPRT-MKUP-INIT-AMT      TO PV-MKUP-INIT-AMT.                    
           ADD REPRT-MKUP-NET-AMT       TO PV-MKUP-NET-AMT.                     
           ADD REPRT-XFER-IN-RTL-AMT    TO PV-XFER-IN-RTL-AMT.                  
           ADD REPRT-XFER-OUT-RTL-AMT   TO PV-XFER-OUT-RTL-AMT.                 
           ADD REPRT-RCPT-RTL-AMT       TO PV-RCPT-RTL-AMT.                     
           ADD REPRT-RCPT-NET-COST-AMT  TO PV-RCPT-NET-COST-AMT.                
           ADD REPRT-RCPT-GRO-COST-AMT  TO PV-RCPT-GRO-COST-AMT.                
           ADD REPRT-RCPT-FRGT-COST-AMT TO PV-RCPT-FRGT-COST-AMT.               
           ADD REPRT-PADJ-RTL-AMT       TO PV-PADJ-RTL-AMT.                     
           ADD REPRT-PADJ-FRGT-COST-AMT TO PV-PADJ-FRGT-COST-AMT.               
           ADD REPRT-PADJ-DISC-COST-AMT TO PV-PADJ-DISC-COST-AMT.               
           ADD REPRT-PADJ-RTV-COST-AMT  TO PV-PADJ-RTV-COST-AMT.                
           ADD REPRT-PADJ-RTV-RTL-AMT   TO PV-PADJ-RTV-RTL-AMT.                 
           ADD REPRT-PADJ-DA-COST-AMT   TO PV-PADJ-DA-COST-AMT.                 
           ADD REPRT-PADJ-DA-RTL-AMT    TO PV-PADJ-DA-RTL-AMT.                  
           ADD REPRT-PADJ-NET-COST-AMT  TO PV-PADJ-NET-COST-AMT.                
           ADD REPRT-PADJ-OTH-COST-AMT  TO PV-PADJ-OTH-COST-AMT.                
           ADD REPRT-PADJ-OTH-RTL-AMT   TO PV-PADJ-OTH-RTL-AMT.                 
           ADD REPRT-PADJ-GRO-COST-AMT  TO PV-PADJ-GRO-COST-AMT.                
           ADD REPRT-DR-ALW-RTL-AMT     TO PV-DR-ALW-RTL-AMT.                   
           ADD REPRT-RTV-RTL-AMT        TO PV-RTV-RTL-AMT.                      
                                                                                
           ADD REPRT-SLS-REG-RTL-AMT    TO TV-SLS-REG-RTL-AMT.                  
           ADD REPRT-SLS-PROMO-RTL-AMT  TO TV-SLS-PROMO-RTL-AMT.                
           ADD REPRT-SLS-PROCLR-RTL-AMT TO TV-SLS-PROCLR-RTL-AMT.               
           ADD REPRT-SLS-CLR-RTL-AMT    TO TV-SLS-CLR-RTL-AMT.                  
           ADD REPRT-SLS-OTH-RTL-AMT    TO TV-SLS-OTH-RTL-AMT.                  
           ADD REPRT-MKDN-PLU-RTL-AMT   TO TV-MKDN-PLU-RTL-AMT.                 
           ADD REPRT-MKDN-PROMO-RTL-AMT TO TV-MKDN-PROMO-RTL-AMT.               
           ADD REPRT-MKDN-RGST-RTL-AMT  TO TV-MKDN-RGST-RTL-AMT.                
           ADD REPRT-MKDN-GLDST-RTL-AMT TO TV-MKDN-GLDST-RTL-AMT.               
           ADD REPRT-MKDN-UMTCH-RTL-AMT TO TV-MKDN-UMTCH-RTL-AMT.               
           ADD REPRT-MKDN-BYR-RTL-AMT   TO TV-MKDN-BYR-RTL-AMT.                 
           ADD REPRT-MKDN-STR-RTL-AMT   TO TV-MKDN-STR-RTL-AMT.                 
           ADD REPRT-MKDN-PRPT-RTL-AMT  TO TV-MKDN-PRPT-RTL-AMT.                
           ADD REPRT-MKDN-OTH-RTL-AMT   TO TV-MKDN-OTH-RTL-AMT.                 
           ADD REPRT-MKDN-RTL-AMT       TO TV-MKDN-RTL-AMT.                     
           ADD REPRT-MKUP-RTL-AMT       TO TV-MKUP-RTL-AMT.                     
           ADD REPRT-MKUP-INIT-AMT      TO TV-MKUP-INIT-AMT.                    
           ADD REPRT-MKUP-NET-AMT       TO TV-MKUP-NET-AMT.                     
           ADD REPRT-XFER-IN-RTL-AMT    TO TV-XFER-IN-RTL-AMT.                  
           ADD REPRT-XFER-OUT-RTL-AMT   TO TV-XFER-OUT-RTL-AMT.                 
           ADD REPRT-RCPT-RTL-AMT       TO TV-RCPT-RTL-AMT.                     
           ADD REPRT-RCPT-NET-COST-AMT  TO TV-RCPT-NET-COST-AMT.                
           ADD REPRT-RCPT-GRO-COST-AMT  TO TV-RCPT-GRO-COST-AMT.                
           ADD REPRT-RCPT-FRGT-COST-AMT TO TV-RCPT-FRGT-COST-AMT.               
           ADD REPRT-PADJ-RTL-AMT       TO TV-PADJ-RTL-AMT.                     
           ADD REPRT-PADJ-FRGT-COST-AMT TO TV-PADJ-FRGT-COST-AMT.               
           ADD REPRT-PADJ-DISC-COST-AMT TO TV-PADJ-DISC-COST-AMT.               
           ADD REPRT-PADJ-RTV-COST-AMT  TO TV-PADJ-RTV-COST-AMT.                
           ADD REPRT-PADJ-RTV-RTL-AMT   TO TV-PADJ-RTV-RTL-AMT.                 
           ADD REPRT-PADJ-DA-COST-AMT   TO TV-PADJ-DA-COST-AMT.                 
           ADD REPRT-PADJ-DA-RTL-AMT    TO TV-PADJ-DA-RTL-AMT.                  
           ADD REPRT-PADJ-NET-COST-AMT  TO TV-PADJ-NET-COST-AMT.                
           ADD REPRT-PADJ-OTH-COST-AMT  TO TV-PADJ-OTH-COST-AMT.                
           ADD REPRT-PADJ-OTH-RTL-AMT   TO TV-PADJ-OTH-RTL-AMT.                 
           ADD REPRT-PADJ-GRO-COST-AMT  TO TV-PADJ-GRO-COST-AMT.                
           ADD REPRT-DR-ALW-RTL-AMT     TO TV-DR-ALW-RTL-AMT.                   
           ADD REPRT-RTV-RTL-AMT        TO TV-RTV-RTL-AMT.                      
                                                                                
      ******************************************************************        
      * BUILD THE PRORATED REPORT COLUMNS AT A KEY LEVEL.                       
      ******************************************************************        
       4100-BUILD-REPORT-PRORTED.                                               
                                                                                
           INITIALIZE DL-KEY                                                    
           INITIALIZE DL-VERBIAGE                                               
           MOVE '  >>PRORATED:'         TO DL-PRO-VERBIAGE                      
           MOVE PRORT-ENT-ID            TO DL-ENT-ID-PURCHASE                   
                                           DL-ENT-ID-PRC-CHG                    
                                           DL-ENT-ID-SALES.                     
           MOVE PRORT-LBL-SEQ-NBR       TO DL-LBL-SEQ-NBR-PURCHASE              
                                           DL-LBL-SEQ-NBR-PRC-CHG               
                                           DL-LBL-SEQ-NBR-SALES.                
           MOVE PRORT-ML-LWST-ID        TO DL-DKEY-PURCHASE                     
                                           DL-DKEY-PRC-CHG                      
                                           DL-DKEY-SALES.                       
           MOVE DL-VERBIAGE             TO DL-VERBIAGE-PURCHASE                 
                                           DL-VERBIAGE-PRC-CHG                  
                                           DL-VERBIAGE-SALES.                   
                                                                                
           MOVE PRORT-SLS-REG-RTL-AMT    TO DL-SLS-REG-RTL-AMT.                 
           MOVE PRORT-SLS-PROMO-RTL-AMT  TO DL-SLS-PROMO-RTL-AMT.               
           MOVE PRORT-SLS-PROCLR-RTL-AMT TO DL-SLS-PROCLR-RTL-AMT.              
           MOVE PRORT-SLS-CLR-RTL-AMT    TO DL-SLS-CLR-RTL-AMT.                 
           MOVE PRORT-SLS-OTH-RTL-AMT    TO DL-SLS-OTH-RTL-AMT.                 
           MOVE PRORT-MKDN-PLU-RTL-AMT   TO DL-MKDN-PLU-RTL-AMT.                
           MOVE PRORT-MKDN-PROMO-RTL-AMT TO DL-MKDN-PROMO-RTL-AMT.              
           MOVE PRORT-MKDN-RGST-RTL-AMT  TO DL-MKDN-RGST-RTL-AMT.               
           MOVE PRORT-MKDN-GLDST-RTL-AMT TO DL-MKDN-GLDST-RTL-AMT.              
           MOVE PRORT-MKDN-UMTCH-RTL-AMT TO DL-MKDN-UMTCH-RTL-AMT.              
           MOVE PRORT-MKDN-BYR-RTL-AMT   TO DL-MKDN-BYR-RTL-AMT.                
           MOVE PRORT-MKDN-STR-RTL-AMT   TO DL-MKDN-STR-RTL-AMT.                
           MOVE PRORT-MKDN-PRPT-RTL-AMT  TO DL-MKDN-PRPT-RTL-AMT.               
           MOVE PRORT-MKDN-OTH-RTL-AMT   TO DL-MKDN-OTH-RTL-AMT.                
           MOVE PRORT-MKDN-RTL-AMT       TO DL-MKDN-RTL-AMT.                    
           MOVE PRORT-MKUP-RTL-AMT       TO DL-MKUP-RTL-AMT.                    
           MOVE PRORT-MKUP-INIT-AMT      TO DL-MKUP-INIT-AMT.                   
           MOVE PRORT-MKUP-NET-AMT       TO DL-MKUP-NET-AMT.                    
           MOVE PRORT-XFER-IN-RTL-AMT    TO DL-XFER-IN-RTL-AMT.                 
           MOVE PRORT-XFER-OUT-RTL-AMT   TO DL-XFER-OUT-RTL-AMT.                
           MOVE PRORT-RCPT-RTL-AMT       TO DL-RCPT-RTL-AMT.                    
           MOVE PRORT-RCPT-NET-COST-AMT  TO DL-RCPT-NET-COST-AMT.               
           MOVE PRORT-RCPT-GRO-COST-AMT  TO DL-RCPT-GRO-COST-AMT.               
           MOVE PRORT-RCPT-FRGT-COST-AMT TO DL-RCPT-FRGT-COST-AMT.              
           MOVE PRORT-PADJ-RTL-AMT       TO DL-PADJ-RTL-AMT.                    
           MOVE PRORT-PADJ-FRGT-COST-AMT TO DL-PADJ-FRGT-COST-AMT.              
           MOVE PRORT-PADJ-DISC-COST-AMT TO DL-PADJ-DISC-COST-AMT.              
           MOVE PRORT-PADJ-RTV-COST-AMT  TO DL-PADJ-RTV-COST-AMT.               
           MOVE PRORT-PADJ-RTV-RTL-AMT   TO DL-PADJ-RTV-RTL-AMT.                
           MOVE PRORT-PADJ-DA-COST-AMT   TO DL-PADJ-DA-COST-AMT.                
           MOVE PRORT-PADJ-DA-RTL-AMT    TO DL-PADJ-DA-RTL-AMT.                 
           MOVE PRORT-PADJ-NET-COST-AMT  TO DL-PADJ-NET-COST-AMT.               
           MOVE PRORT-PADJ-OTH-COST-AMT  TO DL-PADJ-OTH-COST-AMT.               
           MOVE PRORT-PADJ-OTH-RTL-AMT   TO DL-PADJ-OTH-RTL-AMT.                
           MOVE PRORT-PADJ-GRO-COST-AMT  TO DL-PADJ-GRO-COST-AMT.               
           MOVE PRORT-DR-ALW-RTL-AMT     TO DL-DR-ALW-RTL-AMT.                  
           MOVE PRORT-RTV-RTL-AMT        TO DL-RTV-RTL-AMT.                     
                                                                                
           PERFORM 5000-PRINT-DETAIL-LINE.                                      
                                                                                
           ADD PRORT-SLS-REG-RTL-AMT    TO PV-SLS-REG-RTL-AMT-PRO.              
           ADD PRORT-SLS-PROMO-RTL-AMT  TO PV-SLS-PROMO-RTL-AMT-PRO.            
           ADD PRORT-SLS-PROCLR-RTL-AMT TO PV-SLS-PROCLR-RTL-AMT-PRO.           
           ADD PRORT-SLS-CLR-RTL-AMT    TO PV-SLS-CLR-RTL-AMT-PRO.              
           ADD PRORT-SLS-OTH-RTL-AMT    TO PV-SLS-OTH-RTL-AMT-PRO.              
           ADD PRORT-MKDN-PLU-RTL-AMT   TO PV-MKDN-PLU-RTL-AMT-PRO.             
           ADD PRORT-MKDN-PROMO-RTL-AMT TO PV-MKDN-PROMO-RTL-AMT-PRO.           
           ADD PRORT-MKDN-RGST-RTL-AMT  TO PV-MKDN-RGST-RTL-AMT-PRO.            
           ADD PRORT-MKDN-GLDST-RTL-AMT TO PV-MKDN-GLDST-RTL-AMT-PRO.           
           ADD PRORT-MKDN-UMTCH-RTL-AMT TO PV-MKDN-UMTCH-RTL-AMT-PRO.           
           ADD PRORT-MKDN-BYR-RTL-AMT   TO PV-MKDN-BYR-RTL-AMT-PRO.             
           ADD PRORT-MKDN-STR-RTL-AMT   TO PV-MKDN-STR-RTL-AMT-PRO.             
           ADD PRORT-MKDN-PRPT-RTL-AMT  TO PV-MKDN-PRPT-RTL-AMT-PRO.            
           ADD PRORT-MKDN-OTH-RTL-AMT   TO PV-MKDN-OTH-RTL-AMT-PRO.             
           ADD PRORT-MKDN-RTL-AMT       TO PV-MKDN-RTL-AMT-PRO.                 
           ADD PRORT-MKUP-RTL-AMT       TO PV-MKUP-RTL-AMT-PRO.                 
           ADD PRORT-MKUP-INIT-AMT      TO PV-MKUP-INIT-AMT-PRO.                
           ADD PRORT-MKUP-NET-AMT       TO PV-MKUP-NET-AMT-PRO.                 
           ADD PRORT-XFER-IN-RTL-AMT    TO PV-XFER-IN-RTL-AMT-PRO.              
           ADD PRORT-XFER-OUT-RTL-AMT   TO PV-XFER-OUT-RTL-AMT-PRO.             
           ADD PRORT-RCPT-RTL-AMT       TO PV-RCPT-RTL-AMT-PRO.                 
           ADD PRORT-RCPT-NET-COST-AMT  TO PV-RCPT-NET-COST-AMT-PRO.            
           ADD PRORT-RCPT-GRO-COST-AMT  TO PV-RCPT-GRO-COST-AMT-PRO.            
           ADD PRORT-RCPT-FRGT-COST-AMT TO PV-RCPT-FRGT-COST-AMT-PRO.           
           ADD PRORT-PADJ-RTL-AMT       TO PV-PADJ-RTL-AMT-PRO.                 
           ADD PRORT-PADJ-FRGT-COST-AMT TO PV-PADJ-FRGT-COST-AMT-PRO.           
           ADD PRORT-PADJ-DISC-COST-AMT TO PV-PADJ-DISC-COST-AMT-PRO.           
           ADD PRORT-PADJ-RTV-COST-AMT  TO PV-PADJ-RTV-COST-AMT-PRO.            
           ADD PRORT-PADJ-RTV-RTL-AMT   TO PV-PADJ-RTV-RTL-AMT-PRO.             
           ADD PRORT-PADJ-DA-COST-AMT   TO PV-PADJ-DA-COST-AMT-PRO.             
           ADD PRORT-PADJ-DA-RTL-AMT    TO PV-PADJ-DA-RTL-AMT-PRO.              
           ADD PRORT-PADJ-NET-COST-AMT  TO PV-PADJ-NET-COST-AMT-PRO.            
           ADD PRORT-PADJ-OTH-COST-AMT  TO PV-PADJ-OTH-COST-AMT-PRO.            
           ADD PRORT-PADJ-OTH-RTL-AMT   TO PV-PADJ-OTH-RTL-AMT-PRO.             
           ADD PRORT-PADJ-GRO-COST-AMT  TO PV-PADJ-GRO-COST-AMT-PRO.            
           ADD PRORT-DR-ALW-RTL-AMT     TO PV-DR-ALW-RTL-AMT-PRO.               
           ADD PRORT-RTV-RTL-AMT        TO PV-RTV-RTL-AMT-PRO.                  
                                                                                
           ADD PRORT-SLS-REG-RTL-AMT    TO TV-SLS-REG-RTL-AMT-PRO.              
           ADD PRORT-SLS-PROMO-RTL-AMT  TO TV-SLS-PROMO-RTL-AMT-PRO.            
           ADD PRORT-SLS-PROCLR-RTL-AMT TO TV-SLS-PROCLR-RTL-AMT-PRO.           
           ADD PRORT-SLS-CLR-RTL-AMT    TO TV-SLS-CLR-RTL-AMT-PRO.              
           ADD PRORT-SLS-OTH-RTL-AMT    TO TV-SLS-OTH-RTL-AMT-PRO.              
           ADD PRORT-MKDN-PLU-RTL-AMT   TO TV-MKDN-PLU-RTL-AMT-PRO.             
           ADD PRORT-MKDN-PROMO-RTL-AMT TO TV-MKDN-PROMO-RTL-AMT-PRO.           
           ADD PRORT-MKDN-RGST-RTL-AMT  TO TV-MKDN-RGST-RTL-AMT-PRO.            
           ADD PRORT-MKDN-GLDST-RTL-AMT TO TV-MKDN-GLDST-RTL-AMT-PRO.           
           ADD PRORT-MKDN-UMTCH-RTL-AMT TO TV-MKDN-UMTCH-RTL-AMT-PRO.           
           ADD PRORT-MKDN-BYR-RTL-AMT   TO TV-MKDN-BYR-RTL-AMT-PRO.             
           ADD PRORT-MKDN-STR-RTL-AMT   TO TV-MKDN-STR-RTL-AMT-PRO.             
           ADD PRORT-MKDN-PRPT-RTL-AMT  TO TV-MKDN-PRPT-RTL-AMT-PRO.            
           ADD PRORT-MKDN-OTH-RTL-AMT   TO TV-MKDN-OTH-RTL-AMT-PRO.             
           ADD PRORT-MKDN-RTL-AMT       TO TV-MKDN-RTL-AMT-PRO.                 
           ADD PRORT-MKUP-RTL-AMT       TO TV-MKUP-RTL-AMT-PRO.                 
           ADD PRORT-MKUP-INIT-AMT      TO TV-MKUP-INIT-AMT-PRO.                
           ADD PRORT-MKUP-NET-AMT       TO TV-MKUP-NET-AMT-PRO.                 
           ADD PRORT-XFER-IN-RTL-AMT    TO TV-XFER-IN-RTL-AMT-PRO.              
           ADD PRORT-XFER-OUT-RTL-AMT   TO TV-XFER-OUT-RTL-AMT-PRO.             
           ADD PRORT-RCPT-RTL-AMT       TO TV-RCPT-RTL-AMT-PRO.                 
           ADD PRORT-RCPT-NET-COST-AMT  TO TV-RCPT-NET-COST-AMT-PRO.            
           ADD PRORT-RCPT-GRO-COST-AMT  TO TV-RCPT-GRO-COST-AMT-PRO.            
           ADD PRORT-RCPT-FRGT-COST-AMT TO TV-RCPT-FRGT-COST-AMT-PRO.           
           ADD PRORT-PADJ-RTL-AMT       TO TV-PADJ-RTL-AMT-PRO.                 
           ADD PRORT-PADJ-FRGT-COST-AMT TO TV-PADJ-FRGT-COST-AMT-PRO.           
           ADD PRORT-PADJ-DISC-COST-AMT TO TV-PADJ-DISC-COST-AMT-PRO.           
           ADD PRORT-PADJ-RTV-COST-AMT  TO TV-PADJ-RTV-COST-AMT-PRO.            
           ADD PRORT-PADJ-RTV-RTL-AMT   TO TV-PADJ-RTV-RTL-AMT-PRO.             
           ADD PRORT-PADJ-DA-COST-AMT   TO TV-PADJ-DA-COST-AMT-PRO.             
           ADD PRORT-PADJ-DA-RTL-AMT    TO TV-PADJ-DA-RTL-AMT-PRO.              
           ADD PRORT-PADJ-NET-COST-AMT  TO TV-PADJ-NET-COST-AMT-PRO.            
           ADD PRORT-PADJ-OTH-COST-AMT  TO TV-PADJ-OTH-COST-AMT-PRO.            
           ADD PRORT-PADJ-OTH-RTL-AMT   TO TV-PADJ-OTH-RTL-AMT-PRO.             
           ADD PRORT-PADJ-GRO-COST-AMT  TO TV-PADJ-GRO-COST-AMT-PRO.            
           ADD PRORT-DR-ALW-RTL-AMT     TO TV-DR-ALW-RTL-AMT-PRO.               
           ADD PRORT-RTV-RTL-AMT        TO TV-RTV-RTL-AMT-PRO.                  
                                                                                
      ******************************************************************        
      * BUILD THE TOTAL PRORATED REPORT COLUMNS AT A KEY LEVEL.                 
      ******************************************************************        
       4200-BUILD-REPORT-TOTALS.                                                
                                                                                
           IF PV-LINE-COUNTER > (PC-MAX-LINES + 4)                              
               PERFORM 5100-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           PERFORM 5300-PRINT-UL-LINE.                                          
                                                                                
           MOVE ' BEFORE TOTAL      ' TO TL-VERBIAGE-PURCHASE                   
                                         TL-VERBIAGE-PRC-CHG                    
                                         TL-VERBIAGE-SALES.                     
           MOVE PV-SLS-REG-RTL-AMT    TO TL-SLS-REG-RTL-AMT.                    
           MOVE PV-SLS-PROMO-RTL-AMT  TO TL-SLS-PROMO-RTL-AMT.                  
           MOVE PV-SLS-PROCLR-RTL-AMT TO TL-SLS-PROCLR-RTL-AMT.                 
           MOVE PV-SLS-CLR-RTL-AMT    TO TL-SLS-CLR-RTL-AMT.                    
           MOVE PV-SLS-OTH-RTL-AMT    TO TL-SLS-OTH-RTL-AMT.                    
           MOVE PV-MKDN-PLU-RTL-AMT   TO TL-MKDN-PLU-RTL-AMT.                   
           MOVE PV-MKDN-PROMO-RTL-AMT TO TL-MKDN-PROMO-RTL-AMT.                 
           MOVE PV-MKDN-RGST-RTL-AMT  TO TL-MKDN-RGST-RTL-AMT.                  
           MOVE PV-MKDN-GLDST-RTL-AMT TO TL-MKDN-GLDST-RTL-AMT.                 
           MOVE PV-MKDN-UMTCH-RTL-AMT TO TL-MKDN-UMTCH-RTL-AMT.                 
           MOVE PV-MKDN-BYR-RTL-AMT   TO TL-MKDN-BYR-RTL-AMT.                   
           MOVE PV-MKDN-STR-RTL-AMT   TO TL-MKDN-STR-RTL-AMT.                   
           MOVE PV-MKDN-PRPT-RTL-AMT  TO TL-MKDN-PRPT-RTL-AMT.                  
           MOVE PV-MKDN-OTH-RTL-AMT   TO TL-MKDN-OTH-RTL-AMT.                   
           MOVE PV-MKDN-RTL-AMT       TO TL-MKDN-RTL-AMT.                       
           MOVE PV-MKUP-RTL-AMT       TO TL-MKUP-RTL-AMT.                       
           MOVE PV-MKUP-INIT-AMT      TO TL-MKUP-INIT-AMT.                      
           MOVE PV-MKUP-NET-AMT       TO TL-MKUP-NET-AMT.                       
           MOVE PV-XFER-IN-RTL-AMT    TO TL-XFER-IN-RTL-AMT.                    
           MOVE PV-XFER-OUT-RTL-AMT   TO TL-XFER-OUT-RTL-AMT.                   
           MOVE PV-RCPT-RTL-AMT       TO TL-RCPT-RTL-AMT.                       
           MOVE PV-RCPT-NET-COST-AMT  TO TL-RCPT-NET-COST-AMT.                  
           MOVE PV-RCPT-GRO-COST-AMT  TO TL-RCPT-GRO-COST-AMT.                  
           MOVE PV-RCPT-FRGT-COST-AMT TO TL-RCPT-FRGT-COST-AMT.                 
           MOVE PV-PADJ-RTL-AMT       TO TL-PADJ-RTL-AMT.                       
           MOVE PV-PADJ-FRGT-COST-AMT TO TL-PADJ-FRGT-COST-AMT.                 
           MOVE PV-PADJ-DISC-COST-AMT TO TL-PADJ-DISC-COST-AMT.                 
           MOVE PV-PADJ-RTV-COST-AMT  TO TL-PADJ-RTV-COST-AMT.                  
           MOVE PV-PADJ-RTV-RTL-AMT   TO TL-PADJ-RTV-RTL-AMT.                   
           MOVE PV-PADJ-DA-COST-AMT   TO TL-PADJ-DA-COST-AMT.                   
           MOVE PV-PADJ-DA-RTL-AMT    TO TL-PADJ-DA-RTL-AMT.                    
           MOVE PV-PADJ-NET-COST-AMT  TO TL-PADJ-NET-COST-AMT.                  
           MOVE PV-PADJ-OTH-COST-AMT  TO TL-PADJ-OTH-COST-AMT.                  
           MOVE PV-PADJ-OTH-RTL-AMT   TO TL-PADJ-OTH-RTL-AMT.                   
           MOVE PV-PADJ-GRO-COST-AMT  TO TL-PADJ-GRO-COST-AMT.                  
           MOVE PV-DR-ALW-RTL-AMT     TO TL-DR-ALW-RTL-AMT.                     
           MOVE PV-RTV-RTL-AMT        TO TL-RTV-RTL-AMT.                        
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE '    PRORATED TOTAL:'     TO TL-VERBIAGE-PURCHASE               
                                             TL-VERBIAGE-PRC-CHG                
                                             TL-VERBIAGE-SALES.                 
           MOVE PV-SLS-REG-RTL-AMT-PRO    TO TL-SLS-REG-RTL-AMT.                
           MOVE PV-SLS-PROMO-RTL-AMT-PRO  TO TL-SLS-PROMO-RTL-AMT.              
           MOVE PV-SLS-PROCLR-RTL-AMT-PRO TO TL-SLS-PROCLR-RTL-AMT.             
           MOVE PV-SLS-CLR-RTL-AMT-PRO    TO TL-SLS-CLR-RTL-AMT.                
           MOVE PV-SLS-OTH-RTL-AMT-PRO    TO TL-SLS-OTH-RTL-AMT.                
           MOVE PV-MKDN-PLU-RTL-AMT-PRO   TO TL-MKDN-PLU-RTL-AMT.               
           MOVE PV-MKDN-PROMO-RTL-AMT-PRO TO TL-MKDN-PROMO-RTL-AMT.             
           MOVE PV-MKDN-RGST-RTL-AMT-PRO  TO TL-MKDN-RGST-RTL-AMT.              
           MOVE PV-MKDN-GLDST-RTL-AMT-PRO TO TL-MKDN-GLDST-RTL-AMT.             
           MOVE PV-MKDN-UMTCH-RTL-AMT-PRO TO TL-MKDN-UMTCH-RTL-AMT.             
           MOVE PV-MKDN-BYR-RTL-AMT-PRO   TO TL-MKDN-BYR-RTL-AMT.               
           MOVE PV-MKDN-STR-RTL-AMT-PRO   TO TL-MKDN-STR-RTL-AMT.               
           MOVE PV-MKDN-PRPT-RTL-AMT-PRO  TO TL-MKDN-PRPT-RTL-AMT.              
           MOVE PV-MKDN-OTH-RTL-AMT-PRO   TO TL-MKDN-OTH-RTL-AMT.               
           MOVE PV-MKDN-RTL-AMT-PRO       TO TL-MKDN-RTL-AMT.                   
           MOVE PV-MKUP-RTL-AMT-PRO       TO TL-MKUP-RTL-AMT.                   
           MOVE PV-MKUP-INIT-AMT-PRO      TO TL-MKUP-INIT-AMT.                  
           MOVE PV-MKUP-NET-AMT-PRO       TO TL-MKUP-NET-AMT.                   
           MOVE PV-XFER-IN-RTL-AMT-PRO    TO TL-XFER-IN-RTL-AMT.                
           MOVE PV-XFER-OUT-RTL-AMT-PRO   TO TL-XFER-OUT-RTL-AMT.               
           MOVE PV-RCPT-RTL-AMT-PRO       TO TL-RCPT-RTL-AMT.                   
           MOVE PV-RCPT-NET-COST-AMT-PRO  TO TL-RCPT-NET-COST-AMT.              
           MOVE PV-RCPT-GRO-COST-AMT-PRO  TO TL-RCPT-GRO-COST-AMT.              
           MOVE PV-RCPT-FRGT-COST-AMT-PRO TO TL-RCPT-FRGT-COST-AMT.             
           MOVE PV-PADJ-RTL-AMT-PRO       TO TL-PADJ-RTL-AMT.                   
           MOVE PV-PADJ-FRGT-COST-AMT-PRO TO TL-PADJ-FRGT-COST-AMT.             
           MOVE PV-PADJ-DISC-COST-AMT-PRO TO TL-PADJ-DISC-COST-AMT.             
           MOVE PV-PADJ-RTV-COST-AMT-PRO  TO TL-PADJ-RTV-COST-AMT.              
           MOVE PV-PADJ-RTV-RTL-AMT-PRO   TO TL-PADJ-RTV-RTL-AMT.               
           MOVE PV-PADJ-DA-COST-AMT-PRO   TO TL-PADJ-DA-COST-AMT.               
           MOVE PV-PADJ-DA-RTL-AMT-PRO    TO TL-PADJ-DA-RTL-AMT.                
           MOVE PV-PADJ-NET-COST-AMT-PRO  TO TL-PADJ-NET-COST-AMT.              
           MOVE PV-PADJ-OTH-COST-AMT-PRO  TO TL-PADJ-OTH-COST-AMT.              
           MOVE PV-PADJ-OTH-RTL-AMT-PRO   TO TL-PADJ-OTH-RTL-AMT.               
           MOVE PV-PADJ-GRO-COST-AMT-PRO  TO TL-PADJ-GRO-COST-AMT.              
           MOVE PV-DR-ALW-RTL-AMT-PRO     TO TL-DR-ALW-RTL-AMT.                 
           MOVE PV-RTV-RTL-AMT-PRO        TO TL-RTV-RTL-AMT.                    
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE SPACES                   TO PRORATE-RPT-RECORD.                 
           WRITE PRORATE-RPT-RECORD      AFTER ADVANCING 1 LINES.               
                                                                                
           ADD 4                        TO PV-LINE-COUNTER.                     
                                                                                
           MOVE ZEROS                   TO PV-SLS-REG-RTL-AMT.                  
           MOVE ZEROS                   TO PV-SLS-PROMO-RTL-AMT.                
           MOVE ZEROS                   TO PV-SLS-PROCLR-RTL-AMT.               
           MOVE ZEROS                   TO PV-SLS-CLR-RTL-AMT.                  
           MOVE ZEROS                   TO PV-SLS-OTH-RTL-AMT.                  
           MOVE ZEROS                   TO PV-MKDN-PLU-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-PROMO-RTL-AMT.               
           MOVE ZEROS                   TO PV-MKDN-RGST-RTL-AMT.                
           MOVE ZEROS                   TO PV-MKDN-GLDST-RTL-AMT.               
           MOVE ZEROS                   TO PV-MKDN-UMTCH-RTL-AMT.               
           MOVE ZEROS                   TO PV-MKDN-BYR-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-STR-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-PRPT-RTL-AMT.                
           MOVE ZEROS                   TO PV-MKDN-OTH-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-RTL-AMT.                     
           MOVE ZEROS                   TO PV-MKUP-RTL-AMT.                     
           MOVE ZEROS                   TO PV-MKUP-INIT-AMT.                    
           MOVE ZEROS                   TO PV-MKUP-NET-AMT.                     
           MOVE ZEROS                   TO PV-XFER-IN-RTL-AMT.                  
           MOVE ZEROS                   TO PV-XFER-OUT-RTL-AMT.                 
           MOVE ZEROS                   TO PV-RCPT-RTL-AMT.                     
           MOVE ZEROS                   TO PV-RCPT-NET-COST-AMT.                
           MOVE ZEROS                   TO PV-RCPT-GRO-COST-AMT.                
           MOVE ZEROS                   TO PV-RCPT-FRGT-COST-AMT.               
           MOVE ZEROS                   TO PV-PADJ-RTL-AMT.                     
           MOVE ZEROS                   TO PV-PADJ-FRGT-COST-AMT.               
           MOVE ZEROS                   TO PV-PADJ-DISC-COST-AMT.               
           MOVE ZEROS                   TO PV-PADJ-RTV-COST-AMT.                
           MOVE ZEROS                   TO PV-PADJ-RTV-RTL-AMT.                 
           MOVE ZEROS                   TO PV-PADJ-DA-COST-AMT.                 
           MOVE ZEROS                   TO PV-PADJ-DA-RTL-AMT.                  
           MOVE ZEROS                   TO PV-PADJ-NET-COST-AMT.                
           MOVE ZEROS                   TO PV-PADJ-OTH-COST-AMT.                
           MOVE ZEROS                   TO PV-PADJ-OTH-RTL-AMT.                 
           MOVE ZEROS                   TO PV-PADJ-GRO-COST-AMT.                
           MOVE ZEROS                   TO PV-DR-ALW-RTL-AMT.                   
           MOVE ZEROS                   TO PV-RTV-RTL-AMT.                      
                                                                                
           MOVE ZEROS                   TO PV-SLS-REG-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-SLS-PROMO-RTL-AMT-PRO.            
           MOVE ZEROS                   TO PV-SLS-PROCLR-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-SLS-CLR-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-SLS-OTH-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-MKDN-PLU-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-PROMO-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-MKDN-RGST-RTL-AMT-PRO.            
           MOVE ZEROS                   TO PV-MKDN-GLDST-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-MKDN-UMTCH-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-MKDN-BYR-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-STR-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-PRPT-RTL-AMT-PRO.            
           MOVE ZEROS                   TO PV-MKDN-OTH-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-MKUP-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-MKUP-INIT-AMT-PRO.                
           MOVE ZEROS                   TO PV-MKUP-NET-AMT-PRO.                 
           MOVE ZEROS                   TO PV-XFER-IN-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-XFER-OUT-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-RCPT-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-RCPT-NET-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-RCPT-GRO-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-RCPT-FRGT-COST-AMT-PRO.           
           MOVE ZEROS                   TO PV-PADJ-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-PADJ-FRGT-COST-AMT-PRO.           
           MOVE ZEROS                   TO PV-PADJ-DISC-COST-AMT-PRO.           
           MOVE ZEROS                   TO PV-PADJ-RTV-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-PADJ-RTV-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-PADJ-DA-COST-AMT-PRO.             
           MOVE ZEROS                   TO PV-PADJ-DA-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-PADJ-NET-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-PADJ-OTH-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-PADJ-OTH-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-PADJ-GRO-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-DR-ALW-RTL-AMT-PRO.               
           MOVE ZEROS                   TO PV-RTV-RTL-AMT-PRO.                  
                                                                                
      ******************************************************************        
      * BUILD THE GRAND TOTAL PRORATED REPORT COLUMNS AT A KEY LEVEL.           
      ******************************************************************        
       4300-BUILD-GRAND-TOTALS.                                                 
                                                                                
           IF PV-LINE-COUNTER > (PC-MAX-LINES + 4)                              
               PERFORM 5100-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           PERFORM 5300-PRINT-UL-LINE.                                          
                                                                                
           MOVE ' BEFORE GR TOTAL   ' TO TL-VERBIAGE-PURCHASE                   
                                         TL-VERBIAGE-PRC-CHG                    
                                         TL-VERBIAGE-SALES.                     
           MOVE TV-SLS-REG-RTL-AMT    TO TL-SLS-REG-RTL-AMT.                    
           MOVE TV-SLS-PROMO-RTL-AMT  TO TL-SLS-PROMO-RTL-AMT.                  
           MOVE TV-SLS-PROCLR-RTL-AMT TO TL-SLS-PROCLR-RTL-AMT.                 
           MOVE TV-SLS-CLR-RTL-AMT    TO TL-SLS-CLR-RTL-AMT.                    
           MOVE TV-SLS-OTH-RTL-AMT    TO TL-SLS-OTH-RTL-AMT.                    
           MOVE TV-MKDN-PLU-RTL-AMT   TO TL-MKDN-PLU-RTL-AMT.                   
           MOVE TV-MKDN-PROMO-RTL-AMT TO TL-MKDN-PROMO-RTL-AMT.                 
           MOVE TV-MKDN-RGST-RTL-AMT  TO TL-MKDN-RGST-RTL-AMT.                  
           MOVE TV-MKDN-GLDST-RTL-AMT TO TL-MKDN-GLDST-RTL-AMT.                 
           MOVE TV-MKDN-UMTCH-RTL-AMT TO TL-MKDN-UMTCH-RTL-AMT.                 
           MOVE TV-MKDN-BYR-RTL-AMT   TO TL-MKDN-BYR-RTL-AMT.                   
           MOVE TV-MKDN-STR-RTL-AMT   TO TL-MKDN-STR-RTL-AMT.                   
           MOVE TV-MKDN-PRPT-RTL-AMT  TO TL-MKDN-PRPT-RTL-AMT.                  
           MOVE TV-MKDN-OTH-RTL-AMT   TO TL-MKDN-OTH-RTL-AMT.                   
           MOVE TV-MKDN-RTL-AMT       TO TL-MKDN-RTL-AMT.                       
           MOVE TV-MKUP-RTL-AMT       TO TL-MKUP-RTL-AMT.                       
           MOVE TV-MKUP-INIT-AMT      TO TL-MKUP-INIT-AMT.                      
           MOVE TV-MKUP-NET-AMT       TO TL-MKUP-NET-AMT.                       
           MOVE TV-XFER-IN-RTL-AMT    TO TL-XFER-IN-RTL-AMT.                    
           MOVE TV-XFER-OUT-RTL-AMT   TO TL-XFER-OUT-RTL-AMT.                   
           MOVE TV-RCPT-RTL-AMT       TO TL-RCPT-RTL-AMT.                       
           MOVE TV-RCPT-NET-COST-AMT  TO TL-RCPT-NET-COST-AMT.                  
           MOVE TV-RCPT-GRO-COST-AMT  TO TL-RCPT-GRO-COST-AMT.                  
           MOVE TV-RCPT-FRGT-COST-AMT TO TL-RCPT-FRGT-COST-AMT.                 
           MOVE TV-PADJ-RTL-AMT       TO TL-PADJ-RTL-AMT.                       
           MOVE TV-PADJ-FRGT-COST-AMT TO TL-PADJ-FRGT-COST-AMT.                 
           MOVE TV-PADJ-DISC-COST-AMT TO TL-PADJ-DISC-COST-AMT.                 
           MOVE TV-PADJ-RTV-COST-AMT  TO TL-PADJ-RTV-COST-AMT.                  
           MOVE TV-PADJ-RTV-RTL-AMT   TO TL-PADJ-RTV-RTL-AMT.                   
           MOVE TV-PADJ-DA-COST-AMT   TO TL-PADJ-DA-COST-AMT.                   
           MOVE TV-PADJ-DA-RTL-AMT    TO TL-PADJ-DA-RTL-AMT.                    
           MOVE TV-PADJ-NET-COST-AMT  TO TL-PADJ-NET-COST-AMT.                  
           MOVE TV-PADJ-OTH-COST-AMT  TO TL-PADJ-OTH-COST-AMT.                  
           MOVE TV-PADJ-OTH-RTL-AMT   TO TL-PADJ-OTH-RTL-AMT.                   
           MOVE TV-PADJ-GRO-COST-AMT  TO TL-PADJ-GRO-COST-AMT.                  
           MOVE TV-DR-ALW-RTL-AMT     TO TL-DR-ALW-RTL-AMT.                     
           MOVE TV-RTV-RTL-AMT        TO TL-RTV-RTL-AMT.                        
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE '    PRORTED GR TOT:'    TO TL-VERBIAGE-PURCHASE                
                                            TL-VERBIAGE-PRC-CHG                 
                                            TL-VERBIAGE-SALES.                  
           MOVE TV-SLS-REG-RTL-AMT-PRO    TO TL-SLS-REG-RTL-AMT.                
           MOVE TV-SLS-PROMO-RTL-AMT-PRO  TO TL-SLS-PROMO-RTL-AMT.              
           MOVE TV-SLS-PROCLR-RTL-AMT-PRO TO TL-SLS-PROCLR-RTL-AMT.             
           MOVE TV-SLS-CLR-RTL-AMT-PRO    TO TL-SLS-CLR-RTL-AMT.                
           MOVE TV-SLS-OTH-RTL-AMT-PRO    TO TL-SLS-OTH-RTL-AMT.                
           MOVE TV-MKDN-PLU-RTL-AMT-PRO   TO TL-MKDN-PLU-RTL-AMT.               
           MOVE TV-MKDN-PROMO-RTL-AMT-PRO TO TL-MKDN-PROMO-RTL-AMT.             
           MOVE TV-MKDN-RGST-RTL-AMT-PRO  TO TL-MKDN-RGST-RTL-AMT.              
           MOVE TV-MKDN-GLDST-RTL-AMT-PRO TO TL-MKDN-GLDST-RTL-AMT.             
           MOVE TV-MKDN-UMTCH-RTL-AMT-PRO TO TL-MKDN-UMTCH-RTL-AMT.             
           MOVE TV-MKDN-BYR-RTL-AMT-PRO   TO TL-MKDN-BYR-RTL-AMT.               
           MOVE TV-MKDN-STR-RTL-AMT-PRO   TO TL-MKDN-STR-RTL-AMT.               
           MOVE TV-MKDN-PRPT-RTL-AMT-PRO  TO TL-MKDN-PRPT-RTL-AMT.              
           MOVE TV-MKDN-OTH-RTL-AMT-PRO   TO TL-MKDN-OTH-RTL-AMT.               
           MOVE TV-MKDN-RTL-AMT-PRO       TO TL-MKDN-RTL-AMT.                   
           MOVE TV-MKUP-RTL-AMT-PRO       TO TL-MKUP-RTL-AMT.                   
           MOVE TV-MKUP-INIT-AMT-PRO      TO TL-MKUP-INIT-AMT.                  
           MOVE TV-MKUP-NET-AMT-PRO       TO TL-MKUP-NET-AMT.                   
           MOVE TV-XFER-IN-RTL-AMT-PRO    TO TL-XFER-IN-RTL-AMT.                
           MOVE TV-XFER-OUT-RTL-AMT-PRO   TO TL-XFER-OUT-RTL-AMT.               
           MOVE TV-RCPT-RTL-AMT-PRO       TO TL-RCPT-RTL-AMT.                   
           MOVE TV-RCPT-NET-COST-AMT-PRO  TO TL-RCPT-NET-COST-AMT.              
           MOVE TV-RCPT-GRO-COST-AMT-PRO  TO TL-RCPT-GRO-COST-AMT.              
           MOVE TV-RCPT-FRGT-COST-AMT-PRO TO TL-RCPT-FRGT-COST-AMT.             
           MOVE TV-PADJ-RTL-AMT-PRO       TO TL-PADJ-RTL-AMT.                   
           MOVE TV-PADJ-FRGT-COST-AMT-PRO TO TL-PADJ-FRGT-COST-AMT.             
           MOVE TV-PADJ-DISC-COST-AMT-PRO TO TL-PADJ-DISC-COST-AMT.             
           MOVE TV-PADJ-RTV-COST-AMT-PRO  TO TL-PADJ-RTV-COST-AMT.              
           MOVE TV-PADJ-RTV-RTL-AMT-PRO   TO TL-PADJ-RTV-RTL-AMT.               
           MOVE TV-PADJ-DA-COST-AMT-PRO   TO TL-PADJ-DA-COST-AMT.               
           MOVE TV-PADJ-DA-RTL-AMT-PRO    TO TL-PADJ-DA-RTL-AMT.                
           MOVE TV-PADJ-NET-COST-AMT-PRO  TO TL-PADJ-NET-COST-AMT.              
           MOVE TV-PADJ-OTH-COST-AMT-PRO  TO TL-PADJ-OTH-COST-AMT.              
           MOVE TV-PADJ-OTH-RTL-AMT-PRO   TO TL-PADJ-OTH-RTL-AMT.               
           MOVE TV-PADJ-GRO-COST-AMT-PRO  TO TL-PADJ-GRO-COST-AMT.              
           MOVE TV-DR-ALW-RTL-AMT-PRO     TO TL-DR-ALW-RTL-AMT.                 
           MOVE TV-RTV-RTL-AMT-PRO        TO TL-RTV-RTL-AMT.                    
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE SPACES                   TO PRORATE-RPT-RECORD.                 
           WRITE PRORATE-RPT-RECORD      AFTER ADVANCING 1 LINES.               
                                                                                
           ADD 4                         TO PV-LINE-COUNTER.                    
                                                                                
      ******************************************************************        
      * 5000-PRINT-DETAIL-LINE.                                                 
      ******************************************************************        
       5000-PRINT-DETAIL-LINE.                                                  
                                                                                
           IF PV-LINE-COUNTER > PC-MAX-LINES                                    
               PERFORM 5100-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               WRITE PRORATE-RPT-RECORD                                         
                FROM REPORT-DETAIL-LINE-PURCHASE AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               WRITE PRORATE-RPT-RECORD                                         
                FROM REPORT-DETAIL-LINE-PRC-CHG  AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-SALES                                     
               WRITE PRORATE-RPT-RECORD                                         
                FROM REPORT-DETAIL-LINE-SALES    AFTER ADVANCING 1 LINES        
           END-EVALUATE.                                                        
                                                                                
           ADD 1                         TO PV-LINE-COUNTER.                    
                                                                                
      ******************************************************************        
      * 5100-PRINT-HEADINGS.                                                    
      ******************************************************************        
       5100-PRINT-HEADINGS.                                                     
                                                                                
           ADD 1                     TO PV-PAGE-COUNTER.                        
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               MOVE PV-PAGE-COUNTER      TO HD350O-PAGE-NUMBER                  
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM HD350O-STANDRD-HEADER-350-COLS                            
                                     AFTER ADVANCING PAGE                       
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TITLE-LINE-PURCHASE AFTER ADVANCING 1 LINE         
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PURCHASE1                             
                 AFTER ADVANCING 2 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PURCHASE2                             
                 AFTER ADVANCING 1 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PURCHASE                                   
                                     AFTER ADVANCING 2 LINES                    
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               MOVE PV-PAGE-COUNTER      TO HD254O-PAGE-NUMBER                  
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM HD254O-STANDRD-HEADER-254-COLS                            
                                     AFTER ADVANCING PAGE                       
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TITLE-LINE-PRC-CHG AFTER ADVANCING 1 LINE          
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PRC-CHG1                              
                 AFTER ADVANCING 2 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PRC-CHG2                              
                 AFTER ADVANCING 1 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PRC-CHG                                    
                                     AFTER ADVANCING 2 LINES                    
             WHEN PC-REPORT-SELECTION-SALES                                     
               MOVE PV-PAGE-COUNTER      TO HD126O-PAGE-NUMBER                  
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM HD126O-STANDRD-HEADER-126-COLS                            
                                     AFTER ADVANCING PAGE                       
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TITLE-LINE-SALES AFTER ADVANCING 1 LINE            
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-SALES1 AFTER ADVANCING 2 LINES        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-SALES2 AFTER ADVANCING 1 LINES        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-SALES                                      
                                     AFTER ADVANCING 2 LINES                    
           END-EVALUATE.                                                        
                                                                                
           MOVE 7                    TO PV-LINE-COUNTER.                        
                                                                                
      ******************************************************************        
      * 5200-PRINT-TOTAL-LINE.                                                  
      ******************************************************************        
       5200-PRINT-TOTAL-LINE.                                                   
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TOTAL-LINE-PURCHASE AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TOTAL-LINE-PRC-CHG  AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-SALES                                     
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TOTAL-LINE-SALES    AFTER ADVANCING 1 LINES        
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * 5300-PRINT-UL-LINE.                                                     
      ******************************************************************        
       5300-PRINT-UL-LINE.                                                      
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PURCHASE   AFTER ADVANCING 1 LINES         
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PRC-CHG    AFTER ADVANCING 1 LINES         
             WHEN PC-REPORT-SELECTION-SALES                                     
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-SALES      AFTER ADVANCING 1 LINES         
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * SELECT HEADER DETAILS FOR THE REPORT.                                   
      ******************************************************************        
       5400-SELECT-HEADER-DTL.                                                  
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               MOVE FUNCTION CURRENT-DATE (3:2)  TO HD350O-RUN-YEAR             
               MOVE FUNCTION CURRENT-DATE (5:2)  TO HD350O-RUN-MONTH            
               MOVE FUNCTION CURRENT-DATE (7:2)  TO HD350O-RUN-DAY              
               MOVE FUNCTION CURRENT-DATE (9:2)  TO HD350O-RUN-HOUR             
               MOVE FUNCTION CURRENT-DATE (11:2) TO HD350O-RUN-MINUTE           
               MOVE PC-PROGRAM-NAME              TO HD350O-PROGRAM-NAME         
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT-PURCHASE '          
                                            TO RTL-DESCRIPTION-PURCHASE         
               MOVE 1                       TO HD350O-REPORT-NUMBER             
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               MOVE FUNCTION CURRENT-DATE (3:2)  TO HD254O-RUN-YEAR             
               MOVE FUNCTION CURRENT-DATE (5:2)  TO HD254O-RUN-MONTH            
               MOVE FUNCTION CURRENT-DATE (7:2)  TO HD254O-RUN-DAY              
               MOVE FUNCTION CURRENT-DATE (9:2)  TO HD254O-RUN-HOUR             
               MOVE FUNCTION CURRENT-DATE (11:2) TO HD254O-RUN-MINUTE           
               MOVE PC-PROGRAM-NAME              TO HD254O-PROGRAM-NAME         
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT-PRICE CHG'          
                                            TO RTL-DESCRIPTION-PRC-CHG          
               MOVE 3                       TO HD254O-REPORT-NUMBER             
             WHEN PC-REPORT-SELECTION-SALES                                     
               MOVE FUNCTION CURRENT-DATE (3:2)  TO HD126O-RUN-YEAR             
               MOVE FUNCTION CURRENT-DATE (5:2)  TO HD126O-RUN-MONTH            
               MOVE FUNCTION CURRENT-DATE (7:2)  TO HD126O-RUN-DAY              
               MOVE FUNCTION CURRENT-DATE (9:2)  TO HD126O-RUN-HOUR             
               MOVE FUNCTION CURRENT-DATE (11:2) TO HD126O-RUN-MINUTE           
               MOVE PC-PROGRAM-NAME              TO HD126O-PROGRAM-NAME         
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT-SALES    '          
                                            TO RTL-DESCRIPTION-SALES            
               MOVE 2                       TO HD126O-REPORT-NUMBER             
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * IF THE KNOWN FILE IS EMPTY OR HAS REACHED ITS END WHILE THE             
      * UNKNOWN FILE STILL HAS RECORDS,WRITE OUT THE ENTIRE UNKNOWN FILE        
      *  TO THE NON-PRORATED OUTPUT FILE                                        
      ******************************************************************        
       8000-WRITE-NON-PROR-EMPTYKNWN.                                           
                                                                                
           MOVE  UNKWN-UPDATE-REC                                               
             TO  NOPRT-UPDATE-REC.                                              
           WRITE NON-PRORATE-REC FROM NOPRT-UPDATE-REC                          
                                                                                
           ADD +1 TO PA-COUNT-NON-PRORATE-RECS                                  
                                                                                
           PERFORM 8400-READ-UNKNOWN-FILE.                                      
                                                                                
      ******************************************************************        
      *  WRITE OUT TO THE NON PRORATED FILE                                     
      ******************************************************************        
       8100-WRITE-NON-PROR-FILE.                                                
                                                                                
           MOVE  UNKWN-UPDATE-REC                                               
             TO  NOPRT-UPDATE-REC.                                              
           WRITE NON-PRORATE-REC FROM NOPRT-UPDATE-REC.                         
                                                                                
           ADD +1 TO PA-COUNT-NON-PRORATE-RECS.                                 
                                                                                
      ******************************************************************        
      *  WRITE OUT TO THE PRORATED FILE                                         
      ******************************************************************        
       8200-WRITE-PRORATE-FILE.                                                 
                                                                                
           MOVE  UNKWN-UPDATE-REC                                               
             TO  PRORT-UPDATE-REC.                                              
                                                                                
           ADD +1 TO PV-INDX.                                                   
                                                                                
           MOVE DBV-DEPT-NBR(PV-INDX)                                           
             TO PRORT-DEPT-NBR.                                                 
           MOVE DBV-ENT-ID(PV-INDX)                                             
             TO PRORT-ENT-ID.                                                   
           MOVE DBV-LBL-SEQ-NBR(PV-INDX)                                        
             TO PRORT-LBL-SEQ-NBR.                                              
           MOVE DBV-ML-LWST-ID(PV-INDX)                                         
             TO PRORT-ML-LWST-ID.                                               
           MOVE DBV-SLS-REG-RTL-UNK(PV-INDX)                                    
             TO PRORT-SLS-REG-RTL-AMT.                                          
           MOVE DBV-SLS-PROMO-RTL-UNK(PV-INDX)                                  
             TO PRORT-SLS-PROMO-RTL-AMT.                                        
           MOVE DBV-SLS-PROCLR-RTL-UNK(PV-INDX)                                 
             TO PRORT-SLS-PROCLR-RTL-AMT.                                       
           MOVE DBV-SLS-CLR-RTL-UNK(PV-INDX)                                    
             TO PRORT-SLS-CLR-RTL-AMT.                                          
           MOVE DBV-SLS-OTH-RTL-UNK(PV-INDX)                                    
             TO PRORT-SLS-OTH-RTL-AMT.                                          
           MOVE DBV-MKDN-PLU-RTL-UNK(PV-INDX)                                   
             TO PRORT-MKDN-PLU-RTL-AMT.                                         
           MOVE DBV-MKDN-PROMO-RTL-UNK(PV-INDX)                                 
             TO PRORT-MKDN-PROMO-RTL-AMT.                                       
           MOVE DBV-MKDN-RGST-RTL-UNK(PV-INDX)                                  
             TO PRORT-MKDN-RGST-RTL-AMT.                                        
           MOVE DBV-MKDN-GLDST-RTL-UNK(PV-INDX)                                 
             TO PRORT-MKDN-GLDST-RTL-AMT.                                       
           MOVE DBV-MKDN-UMTCH-RTL-UNK(PV-INDX)                                 
             TO PRORT-MKDN-UMTCH-RTL-AMT.                                       
           MOVE DBV-MKDN-BYR-RTL-UNK(PV-INDX)                                   
             TO PRORT-MKDN-BYR-RTL-AMT.                                         
           MOVE DBV-MKDN-STR-RTL-UNK(PV-INDX)                                   
             TO PRORT-MKDN-STR-RTL-AMT.                                         
           MOVE DBV-MKDN-PRPT-RTL-UNK(PV-INDX)                                  
             TO PRORT-MKDN-PRPT-RTL-AMT.                                        
           MOVE DBV-MKDN-OTH-RTL-UNK(PV-INDX)                                   
             TO PRORT-MKDN-OTH-RTL-AMT.                                         
           MOVE DBV-MKDN-RTL-UNK(PV-INDX)                                       
             TO PRORT-MKDN-RTL-AMT.                                             
           MOVE DBV-MKUP-RTL-UNK(PV-INDX)                                       
             TO PRORT-MKUP-RTL-AMT.                                             
           MOVE DBV-XFER-IN-RTL-UNK(PV-INDX)                                    
             TO PRORT-XFER-IN-RTL-AMT.                                          
           MOVE DBV-XFER-OUT-RTL-UNK(PV-INDX)                                   
             TO PRORT-XFER-OUT-RTL-AMT.                                         
           MOVE DBV-RCPT-RTL-UNK(PV-INDX)                                       
             TO PRORT-RCPT-RTL-AMT.                                             
           MOVE DBV-RCPT-NET-COST-UNK(PV-INDX)                                  
             TO PRORT-RCPT-NET-COST-AMT.                                        
           MOVE DBV-RCPT-GRO-COST-UNK(PV-INDX)                                  
             TO PRORT-RCPT-GRO-COST-AMT.                                        
           MOVE DBV-RCPT-FRGT-COST-UNK(PV-INDX)                                 
             TO PRORT-RCPT-FRGT-COST-AMT.                                       
           MOVE DBV-PADJ-RTL-UNK(PV-INDX)                                       
             TO PRORT-PADJ-RTL-AMT.                                             
           MOVE DBV-PADJ-FRGT-COST-UNK(PV-INDX)                                 
             TO PRORT-PADJ-FRGT-COST-AMT.                                       
           MOVE DBV-PADJ-DISC-COST-UNK(PV-INDX)                                 
             TO PRORT-PADJ-DISC-COST-AMT.                                       
           MOVE DBV-PADJ-RTV-COST-UNK(PV-INDX)                                  
             TO PRORT-PADJ-RTV-COST-AMT.                                        
           MOVE DBV-PADJ-RTV-RTL-UNK(PV-INDX)                                   
             TO PRORT-PADJ-RTV-RTL-AMT.                                         
           MOVE DBV-PADJ-DA-COST-UNK(PV-INDX)                                   
             TO PRORT-PADJ-DA-COST-AMT.                                         
           MOVE DBV-PADJ-DA-RTL-UNK(PV-INDX)                                    
             TO PRORT-PADJ-DA-RTL-AMT.                                          
           MOVE DBV-PADJ-NET-COST-UNK(PV-INDX)                                  
             TO PRORT-PADJ-NET-COST-AMT.                                        
           MOVE DBV-PADJ-OTH-COST-UNK(PV-INDX)                                  
             TO PRORT-PADJ-OTH-COST-AMT.                                        
           MOVE DBV-PADJ-OTH-RTL-UNK(PV-INDX)                                   
             TO PRORT-PADJ-OTH-RTL-AMT.                                         
           MOVE DBV-PADJ-GRO-COST-UNK(PV-INDX)                                  
             TO PRORT-PADJ-GRO-COST-AMT.                                        
           MOVE DBV-DR-ALW-RTL-UNK(PV-INDX)                                     
             TO PRORT-DR-ALW-RTL-AMT.                                           
           MOVE DBV-RTV-RTL-UNK(PV-INDX)                                        
             TO PRORT-RTV-RTL-AMT.                                              
           MOVE DBV-MKUP-INIT-UNK(PV-INDX)                                      
             TO PRORT-MKUP-INIT-AMT.                                            
           MOVE DBV-MKUP-NET-UNK(PV-INDX)                                       
             TO PRORT-MKUP-NET-AMT.                                             
W37965     SET PRORT-PRORATE-ALLOCATE TO TRUE.                                  
                                                                                
           WRITE PRORATE-REC FROM PRORT-UPDATE-REC.                             
                                                                                
           ADD +1 TO PA-COUNT-PRORATE-RECS.                                     
                                                                                
W37965     PERFORM 8210-WRITE-AUDIT-DTL.                                        
                                                                                
           PERFORM 4100-BUILD-REPORT-PRORTED.                                   
                                                                                
W37965******************************************************************        
W37965*  WRITE PRORATED RECORDS OUT TO THE DETAIL AUDIT FILE                    
W37965******************************************************************        
W37965 8210-WRITE-AUDIT-DTL.                                                    
W37965                                                                          
W37965     INITIALIZE ML090-AUDIT-REC                                           
W37965     MOVE PRORT-FSCL-WK-END-DTE     TO ML090-FSCL-WK-END-DTE              
W37965     MOVE PRORT-FSCL-WK-END-DTE     TO ML090-PRCG-DTE                     
W37965     MOVE 'BVUNPR'                  TO ML090-FINCL-PRC-GP-CDE             
W37965     MOVE 9                         TO ML090-SRC-SYS-ID                   
W37965     MOVE PRORT-DEPT-NBR            TO ML090-DEPT-NBR                     
W37965     MOVE PRORT-MAJ-CL-NBR          TO ML090-MAJ-CL-NBR                   
W37965     MOVE PRORT-SUB-CL-NBR          TO ML090-SUB-CL-NBR                   
W37965     MOVE PRORT-LOC-NBR             TO ML090-LOC-NBR                      
W37965     MOVE PRORT-ML-LWST-ID          TO ML090-ML-LO-MDSE-LVL-ID            
W37965     MOVE PRORT-ENT-ID              TO ML090-ORIG-ENT-ID                  
W37965     MOVE PRORT-LBL-SEQ-NBR         TO ML090-ORIG-LBL-SEQ-NBR             
W37965     MOVE 0                         TO ML090-TRN-TYP-CDE (1:1)            
W37965     MOVE PRORT-TRN-TYP-CDE         TO ML090-TRN-TYP-CDE (2:2)            
W37965     MOVE PRORT-AP-TRANS-CDE        TO ML090-AP-TRN-CDE                   
W37965     MOVE '01'                      TO ML090-DR-CR-CDE                    
W37965     MOVE PRORT-SLS-TYP-CDE         TO ML090-SLS-TYP-CDE                  
W37965     MOVE PRORT-PRCHG-RSN-CDE       TO ML090-PRCHG-RSN-CDE                
W37965     MOVE PRORT-PRCHG-CTG-CDE       TO ML090-PRCHG-CTG-CDE                
W37965     MOVE PRORT-SKU-NBR             TO PA-SKU-NBR                         
W37965     IF PA-SKU-NBR = ZEROES OR                                            
W37965        PA-SKU-NBR = SPACES OR                                            
W37965        PA-SKU-NBR (6:3) = '000' OR                                       
W37965        PA-SKU-NBR (6:3) = '999'                                          
W37965            MOVE 'Y'   TO ML090-DUMMY-SKU-IND                             
W37965     ELSE                                                                 
W37965            MOVE 'N'   TO ML090-DUMMY-SKU-IND                             
W37965     END-IF                                                               
W37965     MOVE PRORT-ENT-ID              TO ML090-ENT-ID                       
W37965     MOVE PRORT-LBL-SEQ-NBR         TO ML090-LBL-SEQ-NBR                  
W37965     IF PRORT-PADJ-NET-COST-AMT  NOT = ZERO OR                            
W37965         PRORT-PADJ-GRO-COST-AMT NOT = ZERO OR                            
W37965         PRORT-PADJ-RTL-AMT      NOT = ZERO                               
W37965            MOVE 15                 TO ML090-TRN-TYP-CDE (2:2)            
W37965     END-IF                                                               
W37965     MOVE PRORT-PADJ-NET-COST-AMT   TO ML090-PADJ-NET-COST-AMT            
W37965     MOVE PRORT-PADJ-GRO-COST-AMT   TO ML090-PADJ-GRO-COST-AMT            
W37965     MOVE PRORT-PADJ-DISC-COST-AMT  TO ML090-PADJ-DISC-COST-AMT           
W37965     MOVE PRORT-PADJ-RTL-AMT        TO ML090-PADJ-RTL-AMT                 
W37965     COMPUTE PV-WORK-AMOUNT     =   PRORT-SLS-REG-RTL-AMT                 
W37965                                   +   PRORT-SLS-PROMO-RTL-AMT            
W37965                                   +   PRORT-SLS-PROCLR-RTL-AMT           
W37965                                   +   PRORT-SLS-CLR-RTL-AMT              
W37965                                   +   PRORT-SLS-OTH-RTL-AMT              
W37965     MOVE PV-WORK-AMOUNT            TO ML090-SLS-RTL-AMT                  
W37965*    IF PRORT-MKDN-RTL-AMT NOT = ZERO                                     
W37965*          MOVE PRORT-MKDN-RTL-AMT  TO ML090-PRCHG-RTL-AMT                
W37965*    ELSE                                                                 
W37965*          MOVE PRORT-MKUP-RTL-AMT  TO ML090-PRCHG-RTL-AMT                
W37965*    END-IF.                                                              
W37965*    WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC.                            
W37965*    ADD 1                          TO PA-PRORATE-AUDIT-WRITTEN.          
W37965     IF PRORT-SLS-REG-RTL-AMT     NOT = ZERO                              
W37965         MOVE PRORT-SLS-REG-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'R'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN               
W37965     END-IF.                                                              
W37965     IF PRORT-SLS-PROMO-RTL-AMT NOT = ZERO                                
W37965         MOVE PRORT-SLS-PROMO-RTL-AMT     TO ML090-SLS-RTL-AMT            
W37965         MOVE 'P'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN               
W37965     END-IF.                                                              
W37965     IF PRORT-SLS-PROCLR-RTL-AMT NOT = ZERO                               
W37965         MOVE PRORT-SLS-PROCLR-RTL-AMT    TO ML090-SLS-RTL-AMT            
W37965         MOVE 'G'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN               
W37965     END-IF.                                                              
W37965     IF PRORT-SLS-CLR-RTL-AMT NOT = ZERO                                  
W37965         MOVE PRORT-SLS-CLR-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'C'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN               
W37965     END-IF.                                                              
W37965     IF PRORT-SLS-OTH-RTL-AMT NOT = ZERO                                  
W37965         MOVE PRORT-SLS-OTH-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'N'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN               
W37965     END-IF.                                                              
W37965     IF PRORT-MKDN-RTL-AMT NOT = ZERO                             02026900
W37965         MOVE PRORT-MKDN-RTL-AMT          TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                 02027300
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN       02027400
W37965     END-IF.                                                      02027500
W37965     IF PRORT-MKUP-RTL-AMT NOT = ZERO                             02026900
W37965         MOVE PRORT-MKUP-RTL-AMT          TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                 02027300
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN       02027400
W37965     END-IF.                                                      02027500
W37965     IF PRORT-SLS-REG-RTL-AMT     = ZERO AND                              
W37965        PRORT-SLS-PROMO-RTL-AMT   = ZERO AND                              
W37965        PRORT-SLS-PROCLR-RTL-AMT  = ZERO AND                              
W37965        PRORT-SLS-CLR-RTL-AMT     = ZERO AND                              
W37965        PRORT-SLS-OTH-RTL-AMT     = ZERO AND                              
W37965        PRORT-MKDN-RTL-AMT        = ZERO AND                              
W37965        PRORT-MKUP-RTL-AMT        = ZERO                                  
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-PRORATE-AUDIT-WRITTEN               
W37965     END-IF.                                                              
                                                                                
      ******************************************************************        
      *  WRITE OUT TO THE REVERSAL FILE                                         
      ******************************************************************        
       8300-WRITE-REVERSAL-FILE.                                                
                                                                                
           MOVE  UNKWN-UPDATE-REC                                               
             TO  REVRS-UPDATE-REC                                               
                 NOPRT-UPDATE-REC.                                              
                                                                                
           INITIALIZE NOPRT-UPDATE-REC(65:259)                                  
                                                                                
           IF CUM-SLS-REG-RTL-AMT NOT EQUAL ZERO                                
              COMPUTE REVRS-SLS-REG-RTL-AMT =                                   
                      REVRS-SLS-REG-RTL-AMT * -1                                
           ELSE                                                                 
                 MOVE ZEROS TO REVRS-SLS-REG-RTL-AMT                            
                               REPRT-SLS-REG-RTL-AMT                            
                 SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                     
                 MOVE UNKWN-SLS-REG-RTL-AMT                                     
                   TO NOPRT-SLS-REG-RTL-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-SLS-PROMO-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-SLS-PROMO-RTL-AMT =                                 
                      REVRS-SLS-PROMO-RTL-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-SLS-PROMO-RTL-AMT                             
                            REPRT-SLS-PROMO-RTL-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-SLS-PROMO-RTL-AMT                                      
                TO NOPRT-SLS-PROMO-RTL-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-SLS-PROCLR-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-SLS-PROCLR-RTL-AMT =                                
                      REVRS-SLS-PROCLR-RTL-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-SLS-PROCLR-RTL-AMT                            
                            REPRT-SLS-PROCLR-RTL-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-SLS-PROCLR-RTL-AMT                                     
                TO NOPRT-SLS-PROCLR-RTL-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-SLS-CLR-RTL-AMT NOT EQUAL ZERO                                
              COMPUTE REVRS-SLS-CLR-RTL-AMT =                                   
                      REVRS-SLS-CLR-RTL-AMT * -1                                
           ELSE                                                                 
              MOVE ZEROS TO REVRS-SLS-CLR-RTL-AMT                               
                            REPRT-SLS-CLR-RTL-AMT                               
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-SLS-CLR-RTL-AMT                                        
                TO NOPRT-SLS-CLR-RTL-AMT                                        
           END-IF                                                               
                                                                                
           IF CUM-SLS-OTH-RTL-AMT NOT EQUAL ZERO                                
              COMPUTE REVRS-SLS-OTH-RTL-AMT =                                   
                      REVRS-SLS-OTH-RTL-AMT * -1                                
           ELSE                                                                 
              MOVE ZEROS TO REVRS-SLS-OTH-RTL-AMT                               
                            REPRT-SLS-OTH-RTL-AMT                               
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-SLS-OTH-RTL-AMT                                        
                TO NOPRT-SLS-OTH-RTL-AMT                                        
           END-IF                                                               
                                                                                
           IF CUM-MKDN-PLU-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-MKDN-PLU-RTL-AMT =                                  
                      REVRS-MKDN-PLU-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-PLU-RTL-AMT                              
                            REPRT-MKDN-PLU-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-PLU-RTL-AMT                                       
                TO NOPRT-MKDN-PLU-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-MKDN-PROMO-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-MKDN-PROMO-RTL-AMT =                                
                      REVRS-MKDN-PROMO-RTL-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-PROMO-RTL-AMT                            
                            REPRT-MKDN-PROMO-RTL-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-PROMO-RTL-AMT                                     
                TO NOPRT-MKDN-PROMO-RTL-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-MKDN-RGST-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-MKDN-RGST-RTL-AMT =                                 
                      REVRS-MKDN-RGST-RTL-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-RGST-RTL-AMT                             
                            REPRT-MKDN-RGST-RTL-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-RGST-RTL-AMT                                      
                TO NOPRT-MKDN-RGST-RTL-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-MKDN-GLDST-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-MKDN-GLDST-RTL-AMT =                                
                      REVRS-MKDN-GLDST-RTL-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-GLDST-RTL-AMT                            
                            REPRT-MKDN-GLDST-RTL-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-GLDST-RTL-AMT                                     
                TO NOPRT-MKDN-GLDST-RTL-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-MKDN-UMTCH-RTL-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-MKDN-UMTCH-RTL-AMT =                                
                      REVRS-MKDN-UMTCH-RTL-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-UMTCH-RTL-AMT                            
                            REPRT-MKDN-UMTCH-RTL-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-UMTCH-RTL-AMT                                     
                TO NOPRT-MKDN-UMTCH-RTL-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-MKDN-BYR-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-MKDN-BYR-RTL-AMT =                                  
                      REVRS-MKDN-BYR-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-BYR-RTL-AMT                              
                            REPRT-MKDN-BYR-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-BYR-RTL-AMT                                       
                TO NOPRT-MKDN-BYR-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-MKDN-STR-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-MKDN-STR-RTL-AMT =                                  
                      REVRS-MKDN-STR-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-STR-RTL-AMT                              
                            REPRT-MKDN-STR-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-STR-RTL-AMT                                       
                TO NOPRT-MKDN-STR-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-MKDN-PRPT-RTL-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-MKDN-PRPT-RTL-AMT =                                 
                      REVRS-MKDN-PRPT-RTL-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-PRPT-RTL-AMT                             
                            REPRT-MKDN-PRPT-RTL-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-PRPT-RTL-AMT                                      
                TO NOPRT-MKDN-PRPT-RTL-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-MKDN-OTH-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-MKDN-OTH-RTL-AMT =                                  
                      REVRS-MKDN-OTH-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-OTH-RTL-AMT                              
                            REPRT-MKDN-OTH-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-OTH-RTL-AMT                                       
                TO NOPRT-MKDN-OTH-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-MKDN-RTL-AMT NOT EQUAL ZERO                                   
              COMPUTE REVRS-MKDN-RTL-AMT =                                      
                      REVRS-MKDN-RTL-AMT * -1                                   
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKDN-RTL-AMT                                  
                            REPRT-MKDN-RTL-AMT                                  
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKDN-RTL-AMT                                           
                TO NOPRT-MKDN-RTL-AMT                                           
           END-IF                                                               
                                                                                
           IF CUM-MKUP-RTL-AMT NOT EQUAL ZERO                                   
              COMPUTE REVRS-MKUP-RTL-AMT =                                      
                      REVRS-MKUP-RTL-AMT * -1                                   
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKUP-RTL-AMT                                  
                            REPRT-MKUP-RTL-AMT                                  
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKUP-RTL-AMT                                           
                TO NOPRT-MKUP-RTL-AMT                                           
           END-IF                                                               
                                                                                
           IF CUM-XFER-IN-RTL-AMT NOT EQUAL ZERO                                
              COMPUTE REVRS-XFER-IN-RTL-AMT =                                   
                      REVRS-XFER-IN-RTL-AMT * -1                                
           ELSE                                                                 
              MOVE ZEROS TO REVRS-XFER-IN-RTL-AMT                               
                            REPRT-XFER-IN-RTL-AMT                               
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-XFER-IN-RTL-AMT                                        
                TO NOPRT-XFER-IN-RTL-AMT                                        
           END-IF                                                               
                                                                                
           IF CUM-XFER-OUT-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-XFER-OUT-RTL-AMT =                                  
                      REVRS-XFER-OUT-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-XFER-OUT-RTL-AMT                              
                            REPRT-XFER-OUT-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-XFER-OUT-RTL-AMT                                       
                TO NOPRT-XFER-OUT-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-RCPT-RTL-AMT NOT EQUAL ZERO                                   
              COMPUTE REVRS-RCPT-RTL-AMT =                                      
                      REVRS-RCPT-RTL-AMT * -1                                   
           ELSE                                                                 
              MOVE ZEROS TO REVRS-RCPT-RTL-AMT                                  
                            REPRT-RCPT-RTL-AMT                                  
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-RCPT-RTL-AMT                                           
                TO NOPRT-RCPT-RTL-AMT                                           
           END-IF                                                               
                                                                                
           IF CUM-RCPT-NET-COST-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-RCPT-NET-COST-AMT =                                 
                      REVRS-RCPT-NET-COST-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-RCPT-NET-COST-AMT                             
                            REPRT-RCPT-NET-COST-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-RCPT-NET-COST-AMT                                      
                TO NOPRT-RCPT-NET-COST-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-RCPT-GRO-COST-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-RCPT-GRO-COST-AMT =                                 
                      REVRS-RCPT-GRO-COST-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-RCPT-GRO-COST-AMT                             
                            REPRT-RCPT-GRO-COST-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-RCPT-GRO-COST-AMT                                      
                TO NOPRT-RCPT-GRO-COST-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-RCPT-FRGT-COST-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-RCPT-FRGT-COST-AMT =                                
                      REVRS-RCPT-FRGT-COST-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-RCPT-FRGT-COST-AMT                            
                            REPRT-RCPT-FRGT-COST-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-RCPT-FRGT-COST-AMT                                     
                TO NOPRT-RCPT-FRGT-COST-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-PADJ-RTL-AMT NOT EQUAL ZERO                                   
              COMPUTE REVRS-PADJ-RTL-AMT =                                      
                      REVRS-PADJ-RTL-AMT * -1                                   
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-RTL-AMT                                  
                            REPRT-PADJ-RTL-AMT                                  
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-RTL-AMT                                           
                TO NOPRT-PADJ-RTL-AMT                                           
           END-IF                                                               
                                                                                
           IF CUM-PADJ-FRGT-COST-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-PADJ-FRGT-COST-AMT =                                
                      REVRS-PADJ-FRGT-COST-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-FRGT-COST-AMT                            
                            REPRT-PADJ-FRGT-COST-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-FRGT-COST-AMT                                     
                TO NOPRT-PADJ-FRGT-COST-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-PADJ-DISC-COST-AMT NOT EQUAL ZERO                             
              COMPUTE REVRS-PADJ-DISC-COST-AMT =                                
                      REVRS-PADJ-DISC-COST-AMT * -1                             
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-DISC-COST-AMT                            
                            REPRT-PADJ-DISC-COST-AMT                            
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-DISC-COST-AMT                                     
                TO NOPRT-PADJ-DISC-COST-AMT                                     
           END-IF                                                               
                                                                                
           IF CUM-PADJ-RTV-COST-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-PADJ-RTV-COST-AMT =                                 
                      REVRS-PADJ-RTV-COST-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-RTV-COST-AMT                             
                            REPRT-PADJ-RTV-COST-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-RTV-COST-AMT                                      
                TO NOPRT-PADJ-RTV-COST-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-PADJ-RTV-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-PADJ-RTV-RTL-AMT =                                  
                      REVRS-PADJ-RTV-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-RTV-RTL-AMT                              
                            REPRT-PADJ-RTV-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-RTV-RTL-AMT                                       
                TO NOPRT-PADJ-RTV-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-PADJ-DA-COST-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-PADJ-DA-COST-AMT =                                  
                      REVRS-PADJ-DA-COST-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-DA-COST-AMT                              
                            REPRT-PADJ-DA-COST-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-DA-COST-AMT                                       
                TO NOPRT-PADJ-DA-COST-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-PADJ-DA-RTL-AMT NOT EQUAL ZERO                                
              COMPUTE REVRS-PADJ-DA-RTL-AMT =                                   
                      REVRS-PADJ-DA-RTL-AMT * -1                                
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-DA-RTL-AMT                               
                            REPRT-PADJ-DA-RTL-AMT                               
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-DA-RTL-AMT                                        
                TO NOPRT-PADJ-DA-RTL-AMT                                        
           END-IF                                                               
                                                                                
           IF CUM-PADJ-NET-COST-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-PADJ-NET-COST-AMT =                                 
                      REVRS-PADJ-NET-COST-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-NET-COST-AMT                             
                            REPRT-PADJ-NET-COST-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-NET-COST-AMT                                      
                TO NOPRT-PADJ-NET-COST-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-PADJ-OTH-COST-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-PADJ-OTH-COST-AMT =                                 
                      REVRS-PADJ-OTH-COST-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-OTH-COST-AMT                             
                            REPRT-PADJ-OTH-COST-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-OTH-COST-AMT                                      
                TO NOPRT-PADJ-OTH-COST-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-PADJ-OTH-RTL-AMT NOT EQUAL ZERO                               
              COMPUTE REVRS-PADJ-OTH-RTL-AMT =                                  
                      REVRS-PADJ-OTH-RTL-AMT * -1                               
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-OTH-RTL-AMT                              
                            REPRT-PADJ-OTH-RTL-AMT                              
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-OTH-RTL-AMT                                       
                TO NOPRT-PADJ-OTH-RTL-AMT                                       
           END-IF                                                               
                                                                                
           IF CUM-PADJ-GRO-COST-AMT NOT EQUAL ZERO                              
              COMPUTE REVRS-PADJ-GRO-COST-AMT =                                 
                      REVRS-PADJ-GRO-COST-AMT * -1                              
           ELSE                                                                 
              MOVE ZEROS TO REVRS-PADJ-GRO-COST-AMT                             
                            REPRT-PADJ-GRO-COST-AMT                             
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-PADJ-GRO-COST-AMT                                      
                TO NOPRT-PADJ-GRO-COST-AMT                                      
           END-IF                                                               
                                                                                
           IF CUM-DR-ALW-RTL-AMT NOT EQUAL ZERO                                 
              COMPUTE REVRS-DR-ALW-RTL-AMT =                                    
                      REVRS-DR-ALW-RTL-AMT * -1                                 
           ELSE                                                                 
              MOVE ZEROS TO REVRS-DR-ALW-RTL-AMT                                
                            REPRT-DR-ALW-RTL-AMT                                
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-DR-ALW-RTL-AMT                                         
                TO NOPRT-DR-ALW-RTL-AMT                                         
           END-IF                                                               
                                                                                
           IF CUM-RTV-RTL-AMT NOT EQUAL ZERO                                    
              COMPUTE REVRS-RTV-RTL-AMT =                                       
                      REVRS-RTV-RTL-AMT * -1                                    
           ELSE                                                                 
              MOVE ZEROS TO REVRS-RTV-RTL-AMT                                   
                            REPRT-RTV-RTL-AMT                                   
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-RTV-RTL-AMT                                            
                TO NOPRT-RTV-RTL-AMT                                            
           END-IF                                                               
                                                                                
           IF CUM-MKUP-INIT-AMT NOT EQUAL ZERO                                  
              COMPUTE REVRS-MKUP-INIT-AMT =                                     
                      REVRS-MKUP-INIT-AMT * -1                                  
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKUP-INIT-AMT                                 
                            REPRT-MKUP-INIT-AMT                                 
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKUP-INIT-AMT                                          
                TO NOPRT-MKUP-INIT-AMT                                          
           END-IF                                                               
                                                                                
           IF CUM-MKUP-NET-AMT NOT EQUAL ZERO                                   
              COMPUTE REVRS-MKUP-NET-AMT =                                      
                      REVRS-MKUP-NET-AMT * -1                                   
           ELSE                                                                 
              MOVE ZEROS TO REVRS-MKUP-NET-AMT                                  
                            REPRT-MKUP-NET-AMT                                  
              SET PS-NEED-TO-WRT-NONPROR-REC-YES TO TRUE                        
              MOVE UNKWN-MKUP-NET-AMT                                           
                TO NOPRT-MKUP-NET-AMT                                           
           END-IF                                                               
W37965     SET  REVRS-PRORATE-REVERSAL           TO TRUE                        
           WRITE REVERSAL-REC FROM REVRS-UPDATE-REC.                            
                                                                                
           ADD +1 TO PA-COUNT-REVERSAL-RECS.                                    
                                                                                
W37965     PERFORM 8310-WRITE-AUDIT-DTL.                                        
                                                                                
           IF PS-NEED-TO-WRT-NONPROR-REC-YES                                    
              WRITE NON-PRORATE-REC FROM NOPRT-UPDATE-REC                       
              ADD +1 TO PA-COUNT-NON-PROR-REC-SPL-CASE                          
              SET PS-NEED-TO-WRT-NONPROR-REC-NO TO TRUE                         
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  THIS PARAGRAPH WRITES THE DETAIL AUDIT RECORD.                         
      ******************************************************************        
W37965 8310-WRITE-AUDIT-DTL.                                                    
W37965                                                                          
W37965      INITIALIZE ML090-AUDIT-REC                                          
W37965      MOVE REVRS-FSCL-WK-END-DTE     TO ML090-FSCL-WK-END-DTE             
W37965      MOVE REVRS-FSCL-WK-END-DTE     TO ML090-PRCG-DTE                    
W37965      MOVE 'BVUNPR'                  TO ML090-FINCL-PRC-GP-CDE            
W37965      MOVE 9                         TO ML090-SRC-SYS-ID                  
W37965      MOVE REVRS-DEPT-NBR            TO ML090-DEPT-NBR                    
W37965      MOVE REVRS-MAJ-CL-NBR          TO ML090-MAJ-CL-NBR                  
W37965      MOVE REVRS-SUB-CL-NBR          TO ML090-SUB-CL-NBR                  
W37965      MOVE REVRS-LOC-NBR             TO ML090-LOC-NBR                     
W37965      MOVE REVRS-ML-LWST-ID          TO ML090-ML-LO-MDSE-LVL-ID           
W37965      MOVE REVRS-ENT-ID              TO ML090-ORIG-ENT-ID                 
W37965      MOVE REVRS-LBL-SEQ-NBR         TO ML090-ORIG-LBL-SEQ-NBR            
W37965      MOVE 0                         TO ML090-TRN-TYP-CDE (1:1)           
W37965      MOVE REVRS-TRN-TYP-CDE         TO ML090-TRN-TYP-CDE (2:2)           
W37965      MOVE REVRS-AP-TRANS-CDE        TO ML090-AP-TRN-CDE                  
W37965      MOVE '02'                      TO ML090-DR-CR-CDE                   
W37965      MOVE REVRS-SLS-TYP-CDE         TO ML090-SLS-TYP-CDE                 
W37965      MOVE REVRS-PRCHG-RSN-CDE       TO ML090-PRCHG-RSN-CDE               
W37965      MOVE REVRS-PRCHG-CTG-CDE       TO ML090-PRCHG-CTG-CDE               
W37965      MOVE REVRS-SKU-NBR             TO PA-SKU-NBR                        
W37965      IF PA-SKU-NBR = ZEROES OR                                           
W37965         PA-SKU-NBR = SPACES OR                                           
W37965         PA-SKU-NBR (6:3) = '000' OR                                      
W37965         PA-SKU-NBR (6:3) = '999'                                         
W37965              MOVE 'Y'   TO ML090-DUMMY-SKU-IND                           
W37965      ELSE                                                                
W37965              MOVE 'N'   TO ML090-DUMMY-SKU-IND                           
W37965      END-IF                                                              
W37965      MOVE REVRS-ENT-ID              TO ML090-ENT-ID                      
W37965      MOVE REVRS-LBL-SEQ-NBR         TO ML090-LBL-SEQ-NBR                 
W37965      IF REVRS-PADJ-NET-COST-AMT  NOT = ZERO OR                           
W37965          REVRS-PADJ-GRO-COST-AMT NOT = ZERO OR                           
W37965          REVRS-PADJ-RTL-AMT      NOT = ZERO                              
W37965             MOVE 15                 TO ML090-TRN-TYP-CDE (2:2)           
W37965      END-IF                                                              
W37965      MOVE REVRS-PADJ-NET-COST-AMT   TO ML090-PADJ-NET-COST-AMT           
W37965      MOVE REVRS-PADJ-GRO-COST-AMT   TO ML090-PADJ-GRO-COST-AMT           
W37965      MOVE REVRS-PADJ-DISC-COST-AMT  TO ML090-PADJ-DISC-COST-AMT          
W37965      MOVE REVRS-PADJ-RTL-AMT        TO ML090-PADJ-RTL-AMT                
W37965      COMPUTE PV-WORK-AMOUNT =   REVRS-SLS-REG-RTL-AMT                    
W37965                                  +   REVRS-SLS-PROMO-RTL-AMT             
W37965                                  +   REVRS-SLS-PROCLR-RTL-AMT            
W37965                                  +   REVRS-SLS-CLR-RTL-AMT               
W37965                                  +   REVRS-SLS-OTH-RTL-AMT               
W37965      MOVE PV-WORK-AMOUNT            TO ML090-SLS-RTL-AMT                 
W37965*     IF REVRS-MKDN-RTL-AMT NOT = ZERO                                    
W37965*            MOVE REVRS-MKDN-RTL-AMT TO ML090-PRCHG-RTL-AMT               
W37965*     ELSE                                                                
W37965*            MOVE REVRS-MKUP-RTL-AMT TO ML090-PRCHG-RTL-AMT               
W37965*     END-IF                                                              
W37965*     WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                            
W37965*     ADD 1                          TO PA-REVERSAL-AUDIT-WRITTEN.        
W37965     IF REVRS-SLS-REG-RTL-AMT     NOT = ZERO                              
W37965         MOVE REVRS-SLS-REG-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'R'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN              
W37965     END-IF.                                                              
W37965     IF REVRS-SLS-PROMO-RTL-AMT NOT = ZERO                                
W37965         MOVE REVRS-SLS-PROMO-RTL-AMT     TO ML090-SLS-RTL-AMT            
W37965         MOVE 'P'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN              
W37965     END-IF.                                                              
W37965     IF REVRS-SLS-PROCLR-RTL-AMT NOT = ZERO                               
W37965         MOVE REVRS-SLS-PROCLR-RTL-AMT    TO ML090-SLS-RTL-AMT            
W37965         MOVE 'G'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN              
W37965     END-IF.                                                              
W37965     IF REVRS-SLS-CLR-RTL-AMT NOT = ZERO                                  
W37965         MOVE REVRS-SLS-CLR-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'C'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN              
W37965     END-IF.                                                              
W37965     IF REVRS-SLS-OTH-RTL-AMT NOT = ZERO                                  
W37965         MOVE REVRS-SLS-OTH-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'N'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN              
W37965     END-IF.                                                              
W37965     IF REVRS-MKDN-RTL-AMT NOT = ZERO                             02026900
W37965         MOVE REVRS-MKDN-RTL-AMT          TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                 02027300
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN      02027400
W37965     END-IF.                                                      02027500
W37965     IF REVRS-MKUP-RTL-AMT NOT = ZERO                             02026900
W37965         MOVE REVRS-MKUP-RTL-AMT          TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                 02027300
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN      02027400
W37965     END-IF.                                                      02027500
W37965     IF REVRS-SLS-REG-RTL-AMT     = ZERO AND                              
W37965        REVRS-SLS-PROMO-RTL-AMT   = ZERO AND                              
W37965        REVRS-SLS-PROCLR-RTL-AMT  = ZERO AND                              
W37965        REVRS-SLS-CLR-RTL-AMT     = ZERO AND                              
W37965        REVRS-SLS-OTH-RTL-AMT     = ZERO AND                              
W37965        REVRS-MKDN-RTL-AMT        = ZERO AND                              
W37965        REVRS-MKUP-RTL-AMT        = ZERO                                  
W37965         WRITE DTL-AUDIT-REC FROM ML090-AUDIT-REC                         
W37965         ADD 1                  TO PA-REVERSAL-AUDIT-WRITTEN              
W37965     END-IF.                                                              
                                                                                
      ******************************************************************        
      *  THIS PARAGRAPH READS UNKNOWN VENDOR AND UNKNOWN BRAND FILE.            
      ******************************************************************        
       8400-READ-UNKNOWN-FILE.                                                  
                                                                                
           READ UNKNOWN-FILE INTO UNKWN-UPDATE-REC                              
              AT END                                                            
                 SET PS-UNKNOWN-FILE-EOF-YES TO TRUE                            
              NOT AT END                                                        
                 ADD 1                     TO PA-COUNT-UNKNOWN-RECS             
                 MOVE UNKWN-UPDATE-REC     TO REPRT-UPDATE-REC                  
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *  THIS PARAGRAPH READS KNOWN VENDOR AND KNOWN BRAND FILE.                
      ******************************************************************        
       8500-READ-KNOWN-FILE.                                                    
                                                                                
           READ KNOWN-FILE INTO KNOWN-UPDATE-REC                                
              AT END                                                            
                 SET PS-KNOWN-FILE-EOF-YES TO TRUE                              
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *  THIS PARAGRAPH CHECKS IF ALL MONEY AMTS ARE ZEROS                      
      ******************************************************************        
       8600-CHECK-UNKWN-MONEY-AMTS.                                             
                                                                                
           IF (UNKWN-SLS-REG-RTL-AMT    EQUAL ZERO AND                          
               UNKWN-SLS-PROMO-RTL-AMT  EQUAL ZERO AND                          
               UNKWN-SLS-PROCLR-RTL-AMT EQUAL ZERO AND                          
               UNKWN-SLS-CLR-RTL-AMT    EQUAL ZERO AND                          
               UNKWN-SLS-OTH-RTL-AMT    EQUAL ZERO AND                          
               UNKWN-MKDN-PLU-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-MKDN-PROMO-RTL-AMT EQUAL ZERO AND                          
               UNKWN-MKDN-RGST-RTL-AMT  EQUAL ZERO AND                          
               UNKWN-MKDN-GLDST-RTL-AMT EQUAL ZERO AND                          
               UNKWN-MKDN-UMTCH-RTL-AMT EQUAL ZERO AND                          
               UNKWN-MKDN-BYR-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-MKDN-STR-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-MKDN-PRPT-RTL-AMT  EQUAL ZERO AND                          
               UNKWN-MKDN-OTH-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-MKDN-RTL-AMT       EQUAL ZERO AND                          
               UNKWN-MKUP-RTL-AMT       EQUAL ZERO AND                          
               UNKWN-XFER-IN-RTL-AMT    EQUAL ZERO AND                          
               UNKWN-XFER-OUT-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-RCPT-RTL-AMT       EQUAL ZERO AND                          
               UNKWN-RCPT-NET-COST-AMT  EQUAL ZERO AND                          
               UNKWN-RCPT-GRO-COST-AMT  EQUAL ZERO AND                          
               UNKWN-RCPT-FRGT-COST-AMT EQUAL ZERO AND                          
               UNKWN-PADJ-RTL-AMT       EQUAL ZERO AND                          
               UNKWN-PADJ-FRGT-COST-AMT EQUAL ZERO AND                          
               UNKWN-PADJ-DISC-COST-AMT EQUAL ZERO AND                          
               UNKWN-PADJ-RTV-COST-AMT  EQUAL ZERO AND                          
               UNKWN-PADJ-RTV-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-PADJ-DA-COST-AMT   EQUAL ZERO AND                          
               UNKWN-PADJ-DA-RTL-AMT    EQUAL ZERO AND                          
               UNKWN-PADJ-NET-COST-AMT  EQUAL ZERO AND                          
               UNKWN-PADJ-OTH-COST-AMT  EQUAL ZERO AND                          
               UNKWN-PADJ-OTH-RTL-AMT   EQUAL ZERO AND                          
               UNKWN-PADJ-GRO-COST-AMT  EQUAL ZERO AND                          
               UNKWN-DR-ALW-RTL-AMT     EQUAL ZERO AND                          
               UNKWN-RTV-RTL-AMT        EQUAL ZERO AND                          
               UNKWN-MKUP-INIT-AMT      EQUAL ZERO AND                          
               UNKWN-MKUP-NET-AMT       EQUAL ZERO)                             
               SET PS-ALL-MONEY-AMT-ZERO-YES TO TRUE                            
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *   READS THE JOB NAME FROM THE JOB CONTROL CARD                 *        
      ******************************************************************        
       8700-READ-CNTL-JOB.                                                      
                                                                                
           READ CNTL-JOB-FILE                                                   
               AT END                                                           
               SET PS-CNTL-JOB-EOF-YES TO  TRUE                                 
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *   READS THE DATE FROM CONTROL CARD                             *        
      ******************************************************************        
       8800-READ-CNTL-DATE.                                                     
                                                                                
           READ CNTL-DATE-FILE                                                  
               AT END                                                           
               SET PS-CNTL-DATE-EOF-YES TO  TRUE                                
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *    PERFORM CLOSING OF CURSOR AND FINAL COMMIT BEFORE END OF JOB         
      *    CLOSE ALL FILES.                                                     
      ******************************************************************        
       9000-END-OF-JOB.                                                         
                                                                                
           PERFORM 4300-BUILD-GRAND-TOTALS.                                     
                                                                                
           CLOSE KNOWN-FILE                                                     
                 UNKNOWN-FILE                                                   
                 PRORATE-FILE                                                   
                 NON-PRORATE-FILE                                               
                 REVERSAL-FILE                                                  
                 PRORATE-RPT-FILE                                               
                 CNTL-JOB-FILE                                                  
                 CNTL-DATE-FILE                                                 
W37965           DTL-AUDIT-FILE.                                                
                                                                                
           DISPLAY '******************* END OF JOB STATISTICS ********'.        
           DISPLAY 'NUMBER OF RECORDS READ FROM UNKNOWN FILE:'                  
                   PA-COUNT-UNKNOWN-RECS.                                       
           DISPLAY 'NUMBER OF RECORDS WRITTEN TO NON-PRORATE-FILE:'             
                   PA-COUNT-NON-PRORATE-RECS.                                   
           DISPLAY 'NUMBER OF RECORDS WRITTEN TO PRORATE-FILE:'                 
                   PA-COUNT-PRORATE-RECS.                                       
           DISPLAY 'NUMBER OF RECORDS WRITTEN TO REVERSAL-FILE:'                
                   PA-COUNT-REVERSAL-RECS.                                      
           DISPLAY 'NUMBER OF RECORDS WRITTEN TO NON-PRORATE-FILE FOR'          
           DISPLAY 'SPECIFIC NON-PRORATED AMOUNT FIELDS:'                       
                   PA-COUNT-NON-PROR-REC-SPL-CASE.                              
           DISPLAY 'NUMBER OF PRORATE RECORDS WRITTEN TO AUDIT FILE:'           
                   PA-PRORATE-AUDIT-WRITTEN.                                    
           DISPLAY 'NUMBER OF REVERSEL RECORDS WRITTEN TO AUDIT FILE:'          
                   PA-REVERSAL-AUDIT-WRITTEN.                                   
           DISPLAY '**************************************************'.        
                                                                                
      ******************************************************************        
      *   ABEND PARAGRAPH                                                       
      ******************************************************************        
       9999-ABEND.                                                              
                                                                                
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   **  = ' PC-PROGRAM-NAME.                      
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.                    
                                                                                
           MOVE +4013             TO ABEND-CODE.                                
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
                                                                                
      ******************************************************************        
      *                 END OF PROGRAM MLKUT224                        *        
      ******************************************************************        
