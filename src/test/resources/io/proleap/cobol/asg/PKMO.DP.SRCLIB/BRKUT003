000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     BRKUT003.                                        00020036
000300 AUTHOR.         KRYSTEN LEARY.                                   00030036
000400 DATE-WRITTEN.   MARCH 2005.                                      00040036
000500*************************************************************     00050000
000600*   COBOL 2                                                 *     00060025
000700*-----------------------------------------------------------*     00070037
000800*   CREATE LOSS PREVENTION REFUND CHECKS FILE FOR IMPORT    *     00080037
000810*   INTO T-RECS                                             *     00081037
000900*-----------------------------------------------------------*     00090037
001000* PROGRAM OVERVIEW:                                         *     00100021
001010* THIS PROGRAM WILL READ IN THE LOSS PREVENTION REFUND      *     00101037
001011* CHECK FILE AND FORMAT THE DATA TO THE BANK RECONCILIATION *     00101137
001012* T-RECS APPLICATION RECORD LAYOUT.  THIS DATA WILL THEN BE *     00101237
001013* FTP'D TO THE LAN FOR IMPORT INTO T-RECS.                  *     00101337
001600*-----------------------------------------------------------*     00160047
001800* INPUT:                                                    *     00180000
001900*  1. LOSS PREVENTION FILE             (RDRD040)            *     00190036
002100*                                                           *     00210000
002200* OUTPUT:                                                   *     00220000
002300*  1. BANK RECON FILE                  (APRD085)            *     00230007
002400*  2. SUMMARY FILE                     (APRD085)            *     00240029
002500*  3. BANK FILE                        (BRRD003)            *     00250051
002600*-----------------------------------------------------------*     00260047
002700* CHANGE LOG:                                               *     00270000
002800*                                                           *     00280000
002810* DATE  03/09/2005                                          *     00281046
002820*   CHANGE MADE: BANK RECONCILIATION -- LOSS PREVENTION     *     00282046
002821*   IMPORT                                                  *     00282146
002830*   INITIAL VERSION.                                        *     00283046
002840*   MADE BY: KRYSTEN LEARY           WR/IR #: WR28454       *     00284046
002850*                                                           *     00285051
002860* DATE  04/26/2010                                          *     00286052
002870*   CHANGE MADE: ADDED A FILE THAT IS SENT TO THE BANK      *     00287048
002900*   MADE BY: BARB SCHULTZ            WR/IR #: WR37444       *     00290048
003900*************************************************************     00390002
004000                                                                  00400002
004100 ENVIRONMENT DIVISION.                                            00410002
004200                                                                  00420002
004300 INPUT-OUTPUT SECTION.                                            00430002
004400                                                                  00440002
004500 FILE-CONTROL.                                                    00450002
004600     SELECT LOSS-PREVENT-FILE       ASSIGN TO INP01.              00460038
004700     SELECT RECON-FILE              ASSIGN TO OUT01.              00470008
004800     SELECT SUMMARY-FILE            ASSIGN TO OUT02.              00480029
004810     SELECT BANK-FILE               ASSIGN TO OUT03.              00481048
004900                                                                  00490047
005100 DATA DIVISION.                                                   00510002
005300 FILE SECTION.                                                    00530002
005400                                                                  00540047
005500 FD  LOSS-PREVENT-FILE                                            00550038
005600     RECORDING MODE IS F                                          00560002
005700     LABEL RECORDS ARE STANDARD                                   00570002
005900     BLOCK CONTAINS 0 RECORDS                                     00590037
006000     DATA RECORD IS LOSS-PREVENT-RECORD.                          00600038
006100 01  LOSS-PREVENT-RECORD         PIC  X(80).                      00610038
006200                                                                  00620047
006300 FD  RECON-FILE                                                   00630007
006400     RECORDING MODE IS F                                          00640007
006500     LABEL RECORDS ARE STANDARD                                   00650007
006600     DATA RECORD IS RECON-RECORD.                                 00660045
006700 01  RECON-RECORD                PIC  X(775).                     00670045
006800                                                                  00680047
006900 FD  SUMMARY-FILE                                                 00690029
007000     RECORDING MODE IS F                                          00700029
007100     LABEL RECORDS ARE STANDARD                                   00710029
007200     DATA RECORD IS SUMMARY-RECORD.                               00720045
007300 01  SUMMARY-RECORD              PIC  X(775).                     00730045
007400                                                                  00740047
007500 FD  BANK-FILE                                                    00750048
007600     RECORDING MODE IS F                                          00760048
007610     LABEL RECORDS ARE STANDARD                                   00761048
007620     DATA RECORD IS SUMMARY-RECORD.                               00762048
007630 01  BANK-RECORD                 PIC  X(200).                     00763048
007640                                                                  00764048
007700 WORKING-STORAGE SECTION.                                         00770002
007710*----------------------------------------------------------------*00771047
007720* LOSS PREVENTION FILE COPYBOOK (INPUT)                          *00772047
007730*----------------------------------------------------------------*00773047
007740     COPY RDRD040.                                                00774047
007750                                                                  00775047
007760*----------------------------------------------------------------*00776047
007770* BANK RECON FILE COPYBOOK (OUTPUT)                              *00777047
007780*----------------------------------------------------------------*00778047
007790     COPY APRD085.                                                00779047
007800                                                                  00780002
007810*----------------------------------------------------------------*00781048
007820* BANK FILE COPYBOOK (OUTPUT)                                    *00782048
007830*----------------------------------------------------------------*00783048
007840     COPY BRRD003.                                                00784051
007850                                                                  00785048
007900 01  FILLER                        PIC X(25)  VALUE               00790002
008000                             'WS FOR BRKUT003 BEGINS==>'.         00800036
009100                                                                  00910047
009700 01  WS-SWITCH-AREA.                                              00970002
009800     05  WS-END-OF-INPUT-SW        PIC X(03)  VALUE 'NO '.        00980002
009900         88  WS-END-OF-INPUT                  VALUE 'YES'.        00990002
010000         88  WS-NOT-END-OF-INPUT              VALUE 'NO '.        01000002
010100                                                                  01010038
010200 01  WS-PROGRAM-COUNTERS.                                         01020002
010300     05  WS-INPUT-COUNT            PIC  9(09) VALUE ZEROS.        01030002
010400     05  WS-OUTPUT-COUNT           PIC  9(09) VALUE ZEROS.        01040002
010500     05  WS-SUMMARY-COUNT          PIC  9(09) VALUE ZEROS.        01050029
010510     05  WS-BANK-COUNT             PIC  9(09) VALUE ZEROS.        01051049
010600                                                                  01060002
010700 01  DATE-IN.                                                     01070040
010800     05  DATE-IN-YY                PIC X(02).                     01080041
010900     05  DATE-IN-MM                PIC X(02).                     01090041
011000     05  DATE-IN-DD                PIC X(02).                     01100041
011100                                                                  01110040
011200 01  PV-DATE                       PIC X(08).                     01120041
011300 01  PV-DATE-RED REDEFINES PV-DATE.                               01130010
011400     05  PV-DATE-CC                PIC X(02).                     01140041
011500     05  PV-DATE-YY                PIC X(02).                     01150041
011600     05  PV-DATE-MM                PIC X(02).                     01160041
011700     05  PV-DATE-DD                PIC X(02).                     01170041
011710                                                                  01171043
011720 01  PV-CK-DATE                    PIC X(08).                     01172044
011730 01  PV-CK-DATE-RED REDEFINES PV-CK-DATE.                         01173043
011740     05  PV-CK-DATE-CC             PIC X(02).                     01174043
011750     05  PV-CK-DATE-YY             PIC X(02).                     01175043
011760     05  PV-CK-DATE-MM             PIC X(02).                     01176043
011770     05  PV-CK-DATE-DD             PIC X(02).                     01177043
011800                                                                  01180002
011900 01  PV-TOT-PAYT-AMT               PIC 9(18)V99999                01190026
012000                                              VALUE ZEROS.        01200026
012001                                                                  01200148
012010 01  PV-ACCT-NBR.                                                 01201048
012020     05  PV-ZEROES                 PIC 9(12)  VALUE ZEROS.        01202048
012030     05  PV-ACCOUNT-NUMBER         PIC 9(08)  VALUE ZEROS.        01203048
012031                                                                  01203148
012032 01  PV-CHK-NBR.                                                  01203248
012033     05  PV-ZEROES-1               PIC 9(12)  VALUE ZEROS.        01203348
012034     05  PV-CHECK-NUMBER           PIC 9(06)  VALUE ZEROS.        01203448
012100                                                                  01210026
012110 01  PV-CHK-AMT.                                                  01211048
012120     05  PV-ZEROES-2               PIC 9(09)  VALUE ZEROS.        01212048
012130     05  PV-CHECK-AMOUNT           PIC 9(07)V99 VALUE ZEROS.      01213048
012140                                                                  01214048
015000 01  FILLER                        PIC X(25) VALUE                01500026
015100          '<====WS FOR BRKUT003 ENDS'.                            01510036
015101                                                                  01510138
015200*--------------------------------------                           01520047
015300 PROCEDURE DIVISION.                                              01530026
015400*--------------------------------------                           01540047
016000 A100-MAINLINE.                                                   01600026
016100                                                                  01610026
016200     PERFORM B100-HOUSEKEEPING.                                   01620026
016400     PERFORM B200-CREATE-BANK-RECON-REC                           01640026
016500          UNTIL WS-END-OF-INPUT.                                  01650047
016700     PERFORM B300-CREATE-DEBIT-SUM-REC.                           01670036
016900     PERFORM B400-END-OF-JOB.                                     01690026
017000                                                                  01700026
017100     STOP RUN.                                                    01710047
017400                                                                  01740047
017500*---------------------------------------------------------------* 01750047
017600*  INITIALIZATION                                               * 01760037
017700*---------------------------------------------------------------* 01770047
017900 B100-HOUSEKEEPING.                                               01790026
018000                                                                  01800026
019600     OPEN INPUT LOSS-PREVENT-FILE                                 01960038
019700         OUTPUT RECON-FILE                                        01970029
019800                SUMMARY-FILE                                      01980048
019810                BANK-FILE.                                        01981048
019900                                                                  01990029
019910     PERFORM R100-READ-LOSS-PREVENT-FILE.                         01991037
021200                                                                  02120029
021300     IF WS-END-OF-INPUT                                           02130029
021400        DISPLAY '***********************************************' 02140029
021500        DISPLAY '* NO PAYROLL RECORDS WERE FOUND FOR THIS JOB  *' 02150029
021600        DISPLAY '* RUN.                                        *' 02160029
021700        DISPLAY '***********************************************' 02170029
021800     END-IF.                                                      02180029
021810                                                                  02181040
021820     ACCEPT DATE-IN    FROM DATE.                                 02182040
021830     MOVE '20'         TO PV-DATE-CC.                             02183040
021840     MOVE DATE-IN-YY   TO PV-DATE-YY.                             02184040
021850     MOVE DATE-IN-MM   TO PV-DATE-MM.                             02185040
021860     MOVE DATE-IN-DD   TO PV-DATE-DD.                             02186040
021900                                                                  02190029
022700*---------------------------------------------------------------* 02270047
022800*  CREATE THE BANK RECON RECORD                                 * 02280038
022900*---------------------------------------------------------------* 02290047
023100 B200-CREATE-BANK-RECON-REC.                                      02310029
023200                                                                  02320029
023300     PERFORM M100-MOVE-FIELDS.                                    02330029
023400     PERFORM R100-READ-LOSS-PREVENT-FILE.                         02340037
023410                                                                  02341037
024500*---------------------------------------------------------------* 02450047
024600*  CREATE THE BANK RECON DEBIT SUMMARY RECORD                   * 02460038
024700*---------------------------------------------------------------* 02470047
024900 B300-CREATE-DEBIT-SUM-REC.                                       02490039
025000                                                                  02500029
025100     MOVE SPACES TO AP085-DETAIL-RECORD.                          02510029
025110     MOVE 'D'                          TO AP085-REC-TYP.          02511037
025120     MOVE 'LP1'                        TO AP085-IMPRT-ACCT-ID.    02512037
025130     MOVE PV-DATE                      TO AP085-POST-DTE.         02513043
025140     MOVE '20'                         TO PV-CK-DATE-CC.          02514043
025141     MOVE RD040-FULL-YEAR              TO PV-CK-DATE-YY.          02514143
025142     MOVE RD040-FULL-MONTH             TO PV-CK-DATE-MM.          02514243
025143     MOVE RD040-FULL-DAY               TO PV-CK-DATE-DD.          02514343
025144     MOVE PV-CK-DATE                   TO AP085-EFF-DTE.          02514448
025150     MOVE 'LS'                         TO AP085-TRN-TYP.          02515037
025160     MOVE 'D'                          TO AP085-DR-CR.            02516037
025170     MOVE PV-TOT-PAYT-AMT              TO AP085-PAYT-AMT.         02517037
025180     MOVE '0000'                       TO AP085-CK-NBR.           02518037
025190     MOVE SPACES                       TO AP085-VND-NBR           02519038
025191                                          AP085-CK-STAT           02519138
025192                                          AP085-VND-NM.           02519238
027300                                                                  02730029
027400     PERFORM W200-WRITE-SUMMARY-OUTPUT.                           02740029
027500                                                                  02750029
027700*---------------------------------------------------------------* 02770047
027800*  END OF PROGRAM PROCESSING                                    * 02780038
027900*---------------------------------------------------------------* 02790047
028100 B400-END-OF-JOB.                                                 02810029
028200                                                                  02820029
028300     CLOSE LOSS-PREVENT-FILE                                      02830038
028400           RECON-FILE                                             02840029
028500           SUMMARY-FILE                                           02850048
028510           BANK-FILE.                                             02851048
028600                                                                  02860029
028700     DISPLAY '**********************************************'.    02870029
028800     DISPLAY '---- BRKUT003 RECORD COUNTS ----'.                  02880036
028900     DISPLAY '**********************************************'.    02890029
029000     DISPLAY 'RECORDS READ         = ' WS-INPUT-COUNT.            02900029
029100     DISPLAY 'RECORDS WRITTEN      = ' WS-OUTPUT-COUNT.           02910029
029200     DISPLAY 'SUMMARY REC WRITTEN  = ' WS-SUMMARY-COUNT.          02920029
029210     DISPLAY 'SUMMARY REC WRITTEN  = ' WS-SUMMARY-COUNT.          02921051
029211     DISPLAY 'BANK RECORDS WRITTEN = ' WS-BANK-COUNT.             02921151
029300                                                                  02930029
029500*----------------------------------------------------------------*02950047
029600* MOVE THE INPUT LOSS PREVENTION FIELDS TO THE BANK RECON FIELDS *02960037
029700*----------------------------------------------------------------*02970047
029900 M100-MOVE-FIELDS.                                                02990029
030000                                                                  03000029
030010     MOVE 'D'                          TO AP085-REC-TYP.          03001037
030020     MOVE 'LP1'                        TO AP085-IMPRT-ACCT-ID.    03002037
030021     MOVE PV-DATE                      TO AP085-POST-DTE.         03002143
030030     MOVE '20'                         TO PV-CK-DATE-CC.          03003043
030040     MOVE RD040-FULL-YEAR              TO PV-CK-DATE-YY.          03004043
030041     MOVE RD040-FULL-MONTH             TO PV-CK-DATE-MM.          03004143
030042     MOVE RD040-FULL-DAY               TO PV-CK-DATE-DD.          03004243
030043     MOVE PV-CK-DATE                   TO AP085-EFF-DTE.          03004343
030050     MOVE 'LP'                         TO AP085-TRN-TYP.          03005037
030060     MOVE 'C'                          TO AP085-DR-CR.            03006038
030070     MOVE RD040-CHECK-AMOUNT           TO AP085-PAYT-AMT.         03007037
030080     MOVE RD040-CHECK-NUMBER           TO AP085-CK-NBR.           03008037
030090     MOVE SPACES                       TO AP085-VND-NBR           03009038
030091                                          AP085-CK-STAT           03009138
030092                                          AP085-VND-NM.           03009238
030093                                                                  03009337
030094     ADD RD040-CHECK-AMOUNT            TO PV-TOT-PAYT-AMT.        03009437
030096     PERFORM W100-WRITE-OUTPUT.                                   03009637
030097                                                                  03009737
030098     INITIALIZE BR003-DETAIL-RECORD.                              03009851
030099     MOVE 'I'                          TO BR003-RECORD-TYPE.      03009951
030100     MOVE RD040-ACCOUNT-NUMBER         TO PV-ACCOUNT-NUMBER.      03010048
030110     MOVE PV-ACCT-NBR                  TO BR003-ACCOUNT-NUMBER.   03011051
030200     MOVE RD040-CHECK-NUMBER           TO PV-CHECK-NUMBER.        03020048
030300     MOVE PV-CHK-NBR                   TO BR003-CHECK-NUMBER.     03030051
030400     MOVE RD040-CHECK-AMOUNT           TO PV-CHECK-AMOUNT.        03040048
030500     MOVE PV-CHK-AMT                   TO BR003-CHECK-AMOUNT.     03050051
030600     MOVE '20'                         TO PV-CK-DATE-CC.          03060048
030700     MOVE RD040-FULL-YEAR              TO PV-CK-DATE-YY.          03070048
030800     MOVE RD040-FULL-MONTH             TO PV-CK-DATE-MM.          03080048
030900     MOVE RD040-FULL-DAY               TO PV-CK-DATE-DD.          03090048
031000     MOVE PV-CK-DATE                   TO BR003-ISSUE-DATE.       03100051
031100     MOVE RD040-VENDOR-NAME            TO BR003-NAME.             03110051
031110     MOVE SPACES                       TO BR-SPACE-1              03111053
031120                                          BR-SPACE-2              03112053
031130                                          BR-SPACE-3              03113053
031140                                          BR-SPACE-4              03114053
031150                                          BR-SPACE-5              03115053
031160                                          BR-SPACE-6.             03116053
031200                                                                  03120048
031300     PERFORM W300-WRITE-BANK-FILE.                                03130049
031400                                                                  03140048
039220*----------------------------------------------------------------*03922047
039230*  READ THE INPUT FILE INTO THE LOSS PREVENTION LAYOUT           *03923037
039240*----------------------------------------------------------------*03924047
039260 R100-READ-LOSS-PREVENT-FILE.                                     03926037
039270                                                                  03927037
039280     READ LOSS-PREVENT-FILE INTO RD040-DETAIL-RECORD              03928038
039290          AT END                                                  03929037
039291             SET WS-END-OF-INPUT TO TRUE.                         03929137
039292                                                                  03929237
039293     IF WS-NOT-END-OF-INPUT                                       03929337
039294        ADD 1 TO WS-INPUT-COUNT                                   03929437
039295     END-IF.                                                      03929537
039296                                                                  03929637
040800*----------------------------------------------------------------*04080047
040900*  WRITE THE RECON RECORD TO THE RECON FILE                      *04090038
041000*----------------------------------------------------------------*04100047
041200 W100-WRITE-OUTPUT.                                               04120029
041300                                                                  04130029
041400     WRITE RECON-RECORD FROM AP085-DETAIL-RECORD.                 04140045
041600     ADD 1 TO WS-OUTPUT-COUNT.                                    04160029
041700                                                                  04170029
041900*----------------------------------------------------------------*04190047
042000*  WRITE THE DEBIT RECORD TO THE SUMMARY FILE                    *04200038
042100*----------------------------------------------------------------*04210047
042300 W200-WRITE-SUMMARY-OUTPUT.                                       04230029
042400                                                                  04240029
042500     WRITE SUMMARY-RECORD FROM AP085-DETAIL-RECORD.               04250045
042700     ADD 1 TO WS-SUMMARY-COUNT.                                   04270029
042710                                                                  04271049
042800*----------------------------------------------------------------*04280048
042900*  WRITE THE BANK RECORD TO THE BANK FILE                        *04290049
043000*----------------------------------------------------------------*04300048
043100 W300-WRITE-BANK-FILE.                                            04310048
043200                                                                  04320048
043300     WRITE BANK-RECORD FROM BR003-DETAIL-RECORD.                  04330051
043400     ADD 1 TO WS-BANK-COUNT.                                      04340049
